\doxysection{libraries/yubihsm/src/main.c File Reference}
\hypertarget{src_2main_8c}{}\label{src_2main_8c}\index{libraries/yubihsm/src/main.c@{libraries/yubihsm/src/main.c}}
{\ttfamily \#include $<$yubihsm.\+h$>$}\newline
{\ttfamily \#include $<$errno.\+h$>$}\newline
{\ttfamily \#include $<$limits.\+h$>$}\newline
{\ttfamily \#include $<$signal.\+h$>$}\newline
{\ttfamily \#include $<$stdbool.\+h$>$}\newline
{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include $<$string.\+h$>$}\newline
{\ttfamily \#include $<$strings.\+h$>$}\newline
{\ttfamily \#include $<$sys/stat.\+h$>$}\newline
{\ttfamily \#include $<$sys/types.\+h$>$}\newline
{\ttfamily \#include $<$unistd.\+h$>$}\newline
{\ttfamily \#include $<$sys/time.\+h$>$}\newline
{\ttfamily \#include "{}util.\+h"{}}\newline
{\ttfamily \#include "{}commands.\+h"{}}\newline
{\ttfamily \#include $<$openssl/evp.\+h$>$}\newline
{\ttfamily \#include "{}yubihsm-\/shell.\+h"{}}\newline
{\ttfamily \#include $<$editline/readline.\+h$>$}\newline
{\ttfamily \#include $<$histedit.\+h$>$}\newline
Include dependency graph for main.\+c\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{src_2main_8c__incl}
\end{center}
\end{figure}
\doxysubsubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{struct_command}{Command}}
\end{DoxyCompactItemize}
\doxysubsubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{src_2main_8c_accdbea14ea06c15e271784368bd993e8}{PROMPT}}~"{}yubihsm$>$ "{}
\item 
\#define \mbox{\hyperlink{src_2main_8c_ad9514bbc324b3ddd5f2ad47dcf4aa5e3}{ARGS\+\_\+\+BUFFER\+\_\+\+SIZE}}~4096
\item 
\#define \mbox{\hyperlink{src_2main_8c_a434d0cee117e46ec9f75d36f95a24b02}{COMPLETION\+\_\+\+CANDIDATES}}~256
\item 
\#define \mbox{\hyperlink{src_2main_8c_a866387736d29c2363110c4ed0c0fad59}{MAX\+\_\+\+COMMAND\+\_\+\+NAME}}~32
\item 
\#define \mbox{\hyperlink{src_2main_8c_a0edb60dab8dbc580a40d8d987492631f}{MAX\+\_\+\+ARGUMENTS}}~32
\item 
\#define \mbox{\hyperlink{src_2main_8c_aba7329f0650bdd9406cf710150dc6ac7}{LOCAL\+\_\+\+CONNECTOR\+\_\+\+URL}}~"{}http\+://127.\+0.\+0.\+1\+:12345"{}
\item 
\#define \mbox{\hyperlink{src_2main_8c_a1a9b6f40de4cd7ffb57dd5abf8ec1f03}{SPACES}}~"{} \textbackslash{}f\textbackslash{}n\textbackslash{}r\textbackslash{}t\textbackslash{}v"{}
\item 
\#define \mbox{\hyperlink{src_2main_8c_a125cc1cf3137b795bc39ed2e9143ac6d}{LIB\+\_\+\+SUCCEED\+\_\+\+OR\+\_\+\+DIE}}(x,  \mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}})
\item 
\#define \mbox{\hyperlink{src_2main_8c_abab93648e3320de2ad5d42dfe693547b}{COM\+\_\+\+SUCCEED\+\_\+\+OR\+\_\+\+DIE}}(x,  \mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}})
\end{DoxyCompactItemize}
\doxysubsubsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef struct Command \mbox{\hyperlink{src_2main_8c_a62d1747f225814325ab32d45082a23c1}{Command}}
\item 
typedef \mbox{\hyperlink{struct_command}{Command}} \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{src_2main_8c_aee65fcec74905101a0241282bb06d451}{Command\+List}}
\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \mbox{\hyperlink{src_2main_8c_a0f55f786bda19a4380614a719cf93faf}{yh\+\_\+com\+\_\+help}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{src_2main_8c_ad91b275691b905cdc54d7add2a5b06e3}{yh\+\_\+com\+\_\+history}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{src_2main_8c_aaec43efb95baeb7ec8f2854ffa2cb673}{yh\+\_\+com\+\_\+quit}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{src_2main_8c_ab7843da8250a79bc61b9cb1439558842}{yh\+\_\+com\+\_\+set\+\_\+informat}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{src_2main_8c_a6d565f5c80947a15c3210e48a20e8836}{yh\+\_\+com\+\_\+set\+\_\+outformat}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
\mbox{\hyperlink{struct_command}{Command}} \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{src_2main_8c_adf60c5d85f9b442e0c7a42235207a241}{register\+\_\+command}} (\mbox{\hyperlink{src_2main_8c_aee65fcec74905101a0241282bb06d451}{Command\+List}} list, \mbox{\hyperlink{struct_command}{Command}} command)
\item 
void \mbox{\hyperlink{src_2main_8c_aee871967a1e47d3fca17a36cf48e6da6}{register\+\_\+subcommand}} (\mbox{\hyperlink{struct_command}{Command}} \texorpdfstring{$\ast$}{*}parent, \mbox{\hyperlink{struct_command}{Command}} command)
\item 
\mbox{\hyperlink{src_2main_8c_aee65fcec74905101a0241282bb06d451}{Command\+List}} \mbox{\hyperlink{src_2main_8c_a00235bf23b429c75a52c7996e53e590d}{msort\+\_\+list}} (\mbox{\hyperlink{src_2main_8c_aee65fcec74905101a0241282bb06d451}{Command\+List}} list)
\item 
void \mbox{\hyperlink{src_2main_8c_a34a9e8c400dcf19e771e884636316060}{create\+\_\+command\+\_\+list}} (\mbox{\hyperlink{src_2main_8c_aee65fcec74905101a0241282bb06d451}{Command\+List}} \texorpdfstring{$\ast$}{*}c)
\item 
int \mbox{\hyperlink{src_2main_8c_a5530032f495d88f8b95a38f8fcd50da8}{yh\+\_\+com\+\_\+keepalive\+\_\+on}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{src_2main_8c_a934ab7f3227caf21c22153c3981f8d41}{yh\+\_\+com\+\_\+keepalive\+\_\+off}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
void \mbox{\hyperlink{src_2main_8c_af1203fbe672161a7e1185578d249959a}{find\+\_\+lcp}} (const char \texorpdfstring{$\ast$}{*}items\mbox{[}$\,$\mbox{]}, int n\+\_\+items, const char \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}lcp, int \texorpdfstring{$\ast$}{*}lcp\+\_\+len)
\item 
int \mbox{\hyperlink{src_2main_8c_a2324bfd26dadd085f211c969ccfcabf2}{tokenize}} (char \texorpdfstring{$\ast$}{*}line, char \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}toks, int max\+\_\+toks, int \texorpdfstring{$\ast$}{*}cursorc, int \texorpdfstring{$\ast$}{*}cursoro, const char \texorpdfstring{$\ast$}{*}space)
\item 
unsigned char \mbox{\hyperlink{src_2main_8c_a7f5a0a815226228ed913b8c8afe19a51}{complete\+\_\+arg}} (Edit\+Line \texorpdfstring{$\ast$}{*}el, const char \texorpdfstring{$\ast$}{*}arg, char \texorpdfstring{$\ast$}{*}line, int cursoro)
\item 
unsigned char \mbox{\hyperlink{src_2main_8c_a2cc07cef63c0cb85fa153a5ee8f3688d}{complete\+\_\+command}} (Edit\+Line \texorpdfstring{$\ast$}{*}el, \mbox{\hyperlink{struct_command}{Command}} \texorpdfstring{$\ast$}{*}to\+\_\+complete, const char \texorpdfstring{$\ast$}{*}line, int cursoro)
\item 
unsigned char \mbox{\hyperlink{src_2main_8c_addae6d2b1863758ac22b845a1fada92b}{yubihsm\+\_\+complete}} (Edit\+Line \texorpdfstring{$\ast$}{*}el, int ch)
\item 
int \mbox{\hyperlink{src_2main_8c_a4f0deecffa91ccb37fdf866d83789e8c}{validate\+\_\+arg}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, char type, const char \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{pkcs11_8h_a32aff7c6c4cd253fdf6563677afab5ce}{value}}, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}parsed, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{src_2main_8c_a29146144eaaaf11f5b49e85d4fe2bd4c}{validate\+\_\+and\+\_\+call}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{src_2main_8c_aee65fcec74905101a0241282bb06d451}{Command\+List}} \mbox{\hyperlink{yubihsm__pkcs11_8c_a89606eca6b563ec68d2da2e84657736f}{l}}, const char \texorpdfstring{$\ast$}{*}line)
\item 
int \mbox{\hyperlink{src_2main_8c_a0ddf1224851353fc92bfbff6f499fa97}{main}} (int argc, char \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}\mbox{[}$\,$\mbox{]})
\end{DoxyCompactItemize}
\doxysubsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
History \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{src_2main_8c_abea0297d4e2a28933bdb9ccc03c51ebb}{g\+\_\+hist}}
\item 
\mbox{\hyperlink{src_2main_8c_aee65fcec74905101a0241282bb06d451}{Command\+List}} \mbox{\hyperlink{src_2main_8c_a872d1e0eb3ee3fb13c651a1a0a8fbeb3}{g\+\_\+commands}}
\item 
bool \mbox{\hyperlink{src_2main_8c_a82d33897ce200eadf132e93031f0e595}{g\+\_\+running}} = true
\end{DoxyCompactItemize}


\doxysubsection{Macro Definition Documentation}
\Hypertarget{src_2main_8c_ad9514bbc324b3ddd5f2ad47dcf4aa5e3}\index{main.c@{main.c}!ARGS\_BUFFER\_SIZE@{ARGS\_BUFFER\_SIZE}}
\index{ARGS\_BUFFER\_SIZE@{ARGS\_BUFFER\_SIZE}!main.c@{main.c}}
\doxysubsubsection{\texorpdfstring{ARGS\_BUFFER\_SIZE}{ARGS\_BUFFER\_SIZE}}
{\footnotesize\ttfamily \label{src_2main_8c_ad9514bbc324b3ddd5f2ad47dcf4aa5e3} 
\#define ARGS\+\_\+\+BUFFER\+\_\+\+SIZE~4096}



Definition at line \mbox{\hyperlink{src_2main_8c_source_l00041}{41}} of file \mbox{\hyperlink{src_2main_8c_source}{main.\+c}}.

\Hypertarget{src_2main_8c_abab93648e3320de2ad5d42dfe693547b}\index{main.c@{main.c}!COM\_SUCCEED\_OR\_DIE@{COM\_SUCCEED\_OR\_DIE}}
\index{COM\_SUCCEED\_OR\_DIE@{COM\_SUCCEED\_OR\_DIE}!main.c@{main.c}}
\doxysubsubsection{\texorpdfstring{COM\_SUCCEED\_OR\_DIE}{COM\_SUCCEED\_OR\_DIE}}
{\footnotesize\ttfamily \label{src_2main_8c_abab93648e3320de2ad5d42dfe693547b} 
\#define COM\+\_\+\+SUCCEED\+\_\+\+OR\+\_\+\+DIE(\begin{DoxyParamCaption}\item[{}]{x}{, }\item[{}]{\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}}}{}\end{DoxyParamCaption})}

{\bfseries Value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{\ \ \textcolor{keywordflow}{if}\ ((x)\ !=\ 0)\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ fprintf(stderr,\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}}\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}});\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a97917e1d5a9fa5e8b7a4495dc9234ac7}{rc}}\ =\ EXIT\_FAILURE;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordflow}{break};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}
\DoxyCodeLine{\ \ \}}

\end{DoxyCode}


Definition at line \mbox{\hyperlink{src_2main_8c_source_l00072}{72}} of file \mbox{\hyperlink{src_2main_8c_source}{main.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00072\ \textcolor{preprocessor}{\#define\ COM\_SUCCEED\_OR\_DIE(x,\ s)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00073\ \textcolor{preprocessor}{\ \ if\ ((x)\ !=\ 0)\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00074\ \textcolor{preprocessor}{\ \ \ \ fprintf(stderr,\ s\ "{}\(\backslash\)n"{});\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00075\ \textcolor{preprocessor}{\ \ \ \ rc\ =\ EXIT\_FAILURE;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00076\ \textcolor{preprocessor}{\ \ \ \ break;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00077\ \textcolor{preprocessor}{\ \ \}}}

\end{DoxyCode}
\Hypertarget{src_2main_8c_a434d0cee117e46ec9f75d36f95a24b02}\index{main.c@{main.c}!COMPLETION\_CANDIDATES@{COMPLETION\_CANDIDATES}}
\index{COMPLETION\_CANDIDATES@{COMPLETION\_CANDIDATES}!main.c@{main.c}}
\doxysubsubsection{\texorpdfstring{COMPLETION\_CANDIDATES}{COMPLETION\_CANDIDATES}}
{\footnotesize\ttfamily \label{src_2main_8c_a434d0cee117e46ec9f75d36f95a24b02} 
\#define COMPLETION\+\_\+\+CANDIDATES~256}



Definition at line \mbox{\hyperlink{src_2main_8c_source_l00043}{43}} of file \mbox{\hyperlink{src_2main_8c_source}{main.\+c}}.

\Hypertarget{src_2main_8c_a125cc1cf3137b795bc39ed2e9143ac6d}\index{main.c@{main.c}!LIB\_SUCCEED\_OR\_DIE@{LIB\_SUCCEED\_OR\_DIE}}
\index{LIB\_SUCCEED\_OR\_DIE@{LIB\_SUCCEED\_OR\_DIE}!main.c@{main.c}}
\doxysubsubsection{\texorpdfstring{LIB\_SUCCEED\_OR\_DIE}{LIB\_SUCCEED\_OR\_DIE}}
{\footnotesize\ttfamily \label{src_2main_8c_a125cc1cf3137b795bc39ed2e9143ac6d} 
\#define LIB\+\_\+\+SUCCEED\+\_\+\+OR\+\_\+\+DIE(\begin{DoxyParamCaption}\item[{}]{x}{, }\item[{}]{\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}}}{}\end{DoxyParamCaption})}

{\bfseries Value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{\ \ \textcolor{keywordflow}{if}\ ((x)\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ fprintf(stderr,\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}}\ \textcolor{stringliteral}{"{}\%s\(\backslash\)n"{}},\ \mbox{\hyperlink{lib_2error_8c_a238eedb1e27dbff2a0ab9a3932eb3f8b}{yh\_strerror}}(x));\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a97917e1d5a9fa5e8b7a4495dc9234ac7}{rc}}\ =\ EXIT\_FAILURE;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordflow}{break};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}
\DoxyCodeLine{\ \ \}}

\end{DoxyCode}


Definition at line \mbox{\hyperlink{src_2main_8c_source_l00065}{65}} of file \mbox{\hyperlink{src_2main_8c_source}{main.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00065\ \textcolor{preprocessor}{\#define\ LIB\_SUCCEED\_OR\_DIE(x,\ s)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00066\ \textcolor{preprocessor}{\ \ if\ ((x)\ !=\ YHR\_SUCCESS)\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00067\ \textcolor{preprocessor}{\ \ \ \ fprintf(stderr,\ s\ "{}\%s\(\backslash\)n"{},\ yh\_strerror(x));\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00068\ \textcolor{preprocessor}{\ \ \ \ rc\ =\ EXIT\_FAILURE;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00069\ \textcolor{preprocessor}{\ \ \ \ break;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00070\ \textcolor{preprocessor}{\ \ \}}}

\end{DoxyCode}
\Hypertarget{src_2main_8c_aba7329f0650bdd9406cf710150dc6ac7}\index{main.c@{main.c}!LOCAL\_CONNECTOR\_URL@{LOCAL\_CONNECTOR\_URL}}
\index{LOCAL\_CONNECTOR\_URL@{LOCAL\_CONNECTOR\_URL}!main.c@{main.c}}
\doxysubsubsection{\texorpdfstring{LOCAL\_CONNECTOR\_URL}{LOCAL\_CONNECTOR\_URL}}
{\footnotesize\ttfamily \label{src_2main_8c_aba7329f0650bdd9406cf710150dc6ac7} 
\#define LOCAL\+\_\+\+CONNECTOR\+\_\+\+URL~"{}http\+://127.\+0.\+0.\+1\+:12345"{}}



Definition at line \mbox{\hyperlink{src_2main_8c_source_l00047}{47}} of file \mbox{\hyperlink{src_2main_8c_source}{main.\+c}}.

\Hypertarget{src_2main_8c_a0edb60dab8dbc580a40d8d987492631f}\index{main.c@{main.c}!MAX\_ARGUMENTS@{MAX\_ARGUMENTS}}
\index{MAX\_ARGUMENTS@{MAX\_ARGUMENTS}!main.c@{main.c}}
\doxysubsubsection{\texorpdfstring{MAX\_ARGUMENTS}{MAX\_ARGUMENTS}}
{\footnotesize\ttfamily \label{src_2main_8c_a0edb60dab8dbc580a40d8d987492631f} 
\#define MAX\+\_\+\+ARGUMENTS~32}



Definition at line \mbox{\hyperlink{src_2main_8c_source_l00045}{45}} of file \mbox{\hyperlink{src_2main_8c_source}{main.\+c}}.

\Hypertarget{src_2main_8c_a866387736d29c2363110c4ed0c0fad59}\index{main.c@{main.c}!MAX\_COMMAND\_NAME@{MAX\_COMMAND\_NAME}}
\index{MAX\_COMMAND\_NAME@{MAX\_COMMAND\_NAME}!main.c@{main.c}}
\doxysubsubsection{\texorpdfstring{MAX\_COMMAND\_NAME}{MAX\_COMMAND\_NAME}}
{\footnotesize\ttfamily \label{src_2main_8c_a866387736d29c2363110c4ed0c0fad59} 
\#define MAX\+\_\+\+COMMAND\+\_\+\+NAME~32}



Definition at line \mbox{\hyperlink{src_2main_8c_source_l00044}{44}} of file \mbox{\hyperlink{src_2main_8c_source}{main.\+c}}.

\Hypertarget{src_2main_8c_accdbea14ea06c15e271784368bd993e8}\index{main.c@{main.c}!PROMPT@{PROMPT}}
\index{PROMPT@{PROMPT}!main.c@{main.c}}
\doxysubsubsection{\texorpdfstring{PROMPT}{PROMPT}}
{\footnotesize\ttfamily \label{src_2main_8c_accdbea14ea06c15e271784368bd993e8} 
\#define PROMPT~"{}yubihsm$>$ "{}}



Definition at line \mbox{\hyperlink{src_2main_8c_source_l00039}{39}} of file \mbox{\hyperlink{src_2main_8c_source}{main.\+c}}.

\Hypertarget{src_2main_8c_a1a9b6f40de4cd7ffb57dd5abf8ec1f03}\index{main.c@{main.c}!SPACES@{SPACES}}
\index{SPACES@{SPACES}!main.c@{main.c}}
\doxysubsubsection{\texorpdfstring{SPACES}{SPACES}}
{\footnotesize\ttfamily \label{src_2main_8c_a1a9b6f40de4cd7ffb57dd5abf8ec1f03} 
\#define SPACES~"{} \textbackslash{}f\textbackslash{}n\textbackslash{}r\textbackslash{}t\textbackslash{}v"{}}



Definition at line \mbox{\hyperlink{src_2main_8c_source_l00051}{51}} of file \mbox{\hyperlink{src_2main_8c_source}{main.\+c}}.



\doxysubsection{Typedef Documentation}
\Hypertarget{src_2main_8c_a62d1747f225814325ab32d45082a23c1}\index{main.c@{main.c}!Command@{Command}}
\index{Command@{Command}!main.c@{main.c}}
\doxysubsubsection{\texorpdfstring{Command}{Command}}
{\footnotesize\ttfamily \label{src_2main_8c_a62d1747f225814325ab32d45082a23c1} 
typedef struct Command Command}



Definition at line \mbox{\hyperlink{src_2main_8c_source_l00088}{88}} of file \mbox{\hyperlink{src_2main_8c_source}{main.\+c}}.

\Hypertarget{src_2main_8c_aee65fcec74905101a0241282bb06d451}\index{main.c@{main.c}!CommandList@{CommandList}}
\index{CommandList@{CommandList}!main.c@{main.c}}
\doxysubsubsection{\texorpdfstring{CommandList}{CommandList}}
{\footnotesize\ttfamily \label{src_2main_8c_aee65fcec74905101a0241282bb06d451} 
typedef \mbox{\hyperlink{struct_command}{Command}}\texorpdfstring{$\ast$}{*} \mbox{\hyperlink{src_2main_8c_aee65fcec74905101a0241282bb06d451}{Command\+List}}}



Definition at line \mbox{\hyperlink{src_2main_8c_source_l00109}{109}} of file \mbox{\hyperlink{src_2main_8c_source}{main.\+c}}.



\doxysubsection{Function Documentation}
\Hypertarget{src_2main_8c_a7f5a0a815226228ed913b8c8afe19a51}\index{main.c@{main.c}!complete\_arg@{complete\_arg}}
\index{complete\_arg@{complete\_arg}!main.c@{main.c}}
\doxysubsubsection{\texorpdfstring{complete\_arg()}{complete\_arg()}}
{\footnotesize\ttfamily \label{src_2main_8c_a7f5a0a815226228ed913b8c8afe19a51} 
unsigned char complete\+\_\+arg (\begin{DoxyParamCaption}\item[{Edit\+Line \texorpdfstring{$\ast$}{*}}]{el}{, }\item[{const char \texorpdfstring{$\ast$}{*}}]{arg}{, }\item[{char \texorpdfstring{$\ast$}{*}}]{line}{, }\item[{int}]{cursoro}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{src_2main_8c_source_l00925}{925}} of file \mbox{\hyperlink{src_2main_8c_source}{main.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00926\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00927\ }
\DoxyCodeLine{00928\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *candidates[\mbox{\hyperlink{src_2main_8c_a434d0cee117e46ec9f75d36f95a24b02}{COMPLETION\_CANDIDATES}}];}
\DoxyCodeLine{00929\ \ \ \textcolor{keywordtype}{int}\ n\_candidates\ =\ 0;}
\DoxyCodeLine{00930\ \ \ \textcolor{keyword}{struct\ }winsize\ w;}
\DoxyCodeLine{00931\ \ \ \textcolor{keyword}{const}\ LineInfo\ *li\ =\ el\_line(el);}
\DoxyCodeLine{00932\ \ \ ioctl(fileno(stdout),\ TIOCGWINSZ,\ \&w);}
\DoxyCodeLine{00933\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{301-_gen-_map_type_conversion_8cpp_a1c6a4102d247bdd583751f5a9e2e72f6}{lines}}\ =\ (li-\/>cursor\ -\/\ li-\/>buffer\ +\ strlen(\mbox{\hyperlink{src_2main_8c_accdbea14ea06c15e271784368bd993e8}{PROMPT}}))\ /\ w.ws\_col;}
\DoxyCodeLine{00934\ }
\DoxyCodeLine{00935\ \ \ \textcolor{keywordflow}{switch}\ (arg[0])\ \{}
\DoxyCodeLine{00936\ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'u'}:}
\DoxyCodeLine{00937\ \ \ \ \ \ \ \mbox{\hyperlink{namespace_log_a83926634a3916d0927abca4aca58a60a}{printf}}(\textcolor{stringliteral}{"{}\(\backslash\)nnumber"{}});}
\DoxyCodeLine{00938\ }
\DoxyCodeLine{00939\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00940\ }
\DoxyCodeLine{00941\ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'w'}:}
\DoxyCodeLine{00942\ \ \ \ \ \ \ \mbox{\hyperlink{namespace_log_a83926634a3916d0927abca4aca58a60a}{printf}}(\textcolor{stringliteral}{"{}\(\backslash\)nword"{}});}
\DoxyCodeLine{00943\ }
\DoxyCodeLine{00944\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00945\ }
\DoxyCodeLine{00946\ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'b'}:}
\DoxyCodeLine{00947\ \ \ \ \ \ \ \mbox{\hyperlink{namespace_log_a83926634a3916d0927abca4aca58a60a}{printf}}(\textcolor{stringliteral}{"{}\(\backslash\)nbyte"{}});}
\DoxyCodeLine{00948\ }
\DoxyCodeLine{00949\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00950\ }
\DoxyCodeLine{00951\ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'i'}:}
\DoxyCodeLine{00952\ \ \ \ \ \ \ \mbox{\hyperlink{namespace_log_a83926634a3916d0927abca4aca58a60a}{printf}}(\textcolor{stringliteral}{"{}\(\backslash\)ninput\ data"{}});}
\DoxyCodeLine{00953\ }
\DoxyCodeLine{00954\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00955\ }
\DoxyCodeLine{00956\ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'F'}:}
\DoxyCodeLine{00957\ \ \ \ \ \ \ \mbox{\hyperlink{namespace_log_a83926634a3916d0927abca4aca58a60a}{printf}}(\textcolor{stringliteral}{"{}\(\backslash\)noutput\ filename"{}});}
\DoxyCodeLine{00958\ }
\DoxyCodeLine{00959\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00960\ }
\DoxyCodeLine{00961\ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'s'}:}
\DoxyCodeLine{00962\ \ \ \ \ \ \ \mbox{\hyperlink{namespace_log_a83926634a3916d0927abca4aca58a60a}{printf}}(\textcolor{stringliteral}{"{}\(\backslash\)nstring"{}});}
\DoxyCodeLine{00963\ }
\DoxyCodeLine{00964\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00965\ }
\DoxyCodeLine{00966\ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'k'}:}
\DoxyCodeLine{00967\ \ \ \ \ \ \ \mbox{\hyperlink{namespace_log_a83926634a3916d0927abca4aca58a60a}{printf}}(\textcolor{stringliteral}{"{}\(\backslash\)nkey"{}});}
\DoxyCodeLine{00968\ }
\DoxyCodeLine{00969\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00970\ }
\DoxyCodeLine{00971\ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'e'}:}
\DoxyCodeLine{00972\ \ \ \ \ \ \ \mbox{\hyperlink{namespace_log_a83926634a3916d0927abca4aca58a60a}{printf}}(\textcolor{stringliteral}{"{}\(\backslash\)nsession"{}});}
\DoxyCodeLine{00973\ }
\DoxyCodeLine{00974\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00975\ }
\DoxyCodeLine{00976\ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'d'}:}
\DoxyCodeLine{00977\ \ \ \ \ \ \ \mbox{\hyperlink{namespace_log_a83926634a3916d0927abca4aca58a60a}{printf}}(\textcolor{stringliteral}{"{}\(\backslash\)ndomains"{}});}
\DoxyCodeLine{00978\ }
\DoxyCodeLine{00979\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00980\ }
\DoxyCodeLine{00981\ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'c'}:\ \{}
\DoxyCodeLine{00982\ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ *toks[\mbox{\hyperlink{src_2main_8c_a434d0cee117e46ec9f75d36f95a24b02}{COMPLETION\_CANDIDATES}}];}
\DoxyCodeLine{00983\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ cursorc\ =\ cursoro;}
\DoxyCodeLine{00984\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ num\_toks\ =}
\DoxyCodeLine{00985\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_a2324bfd26dadd085f211c969ccfcabf2}{tokenize}}(line,\ toks,\ \mbox{\hyperlink{src_2main_8c_a434d0cee117e46ec9f75d36f95a24b02}{COMPLETION\_CANDIDATES}},\ \&cursorc,\ \&cursoro,\ \textcolor{stringliteral}{"{}:,;|"{}});}
\DoxyCodeLine{00986\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (cursorc\ ==\ num\_toks)\ \{}
\DoxyCodeLine{00987\ \ \ \ \ \ \ \ \ toks[cursorc]\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{00988\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00989\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ \textcolor{keyword}{sizeof}(yh\_capability)\ /\ \textcolor{keyword}{sizeof}(yh\_capability[0]);}
\DoxyCodeLine{00990\ \ \ \ \ \ \ \ \ \ \ \ i++)\ \{}
\DoxyCodeLine{00991\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (strncasecmp(toks[cursorc],\ yh\_capability[i].\mbox{\hyperlink{catch__reporter__console_8cpp_a9b45b3e13bd9167aab02e17e08916231}{name}},}
\DoxyCodeLine{00992\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ strlen(toks[cursorc]))\ ==\ 0)\ \{}
\DoxyCodeLine{00993\ \ \ \ \ \ \ \ \ \ \ candidates[n\_candidates++]\ =\ yh\_capability[i].name;}
\DoxyCodeLine{00994\ \ \ \ \ \ \ \ \ \ \ assert(n\_candidates\ <\ \mbox{\hyperlink{src_2main_8c_a434d0cee117e46ec9f75d36f95a24b02}{COMPLETION\_CANDIDATES}});}
\DoxyCodeLine{00995\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00996\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00997\ \ \ \ \ \}\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00998\ }
\DoxyCodeLine{00999\ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'a'}:}
\DoxyCodeLine{01000\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t}}\ i\ =\ 0;\ i\ <\ \textcolor{keyword}{sizeof}(yh\_algorithms)\ /\ \textcolor{keyword}{sizeof}(yh\_algorithms[0]);}
\DoxyCodeLine{01001\ \ \ \ \ \ \ \ \ \ \ \ i++)\ \{}
\DoxyCodeLine{01002\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (strncasecmp(line,\ yh\_algorithms[i].\mbox{\hyperlink{catch__reporter__console_8cpp_a9b45b3e13bd9167aab02e17e08916231}{name}},\ strlen(line))\ ==\ 0)\ \{}
\DoxyCodeLine{01003\ \ \ \ \ \ \ \ \ \ \ candidates[n\_candidates++]\ =\ yh\_algorithms[i].name;}
\DoxyCodeLine{01004\ \ \ \ \ \ \ \ \ \ \ assert(n\_candidates\ <\ \mbox{\hyperlink{src_2main_8c_a434d0cee117e46ec9f75d36f95a24b02}{COMPLETION\_CANDIDATES}});}
\DoxyCodeLine{01005\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01006\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01007\ }
\DoxyCodeLine{01008\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01009\ }
\DoxyCodeLine{01010\ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'t'}:}
\DoxyCodeLine{01011\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t}}\ i\ =\ 0;\ i\ <\ \textcolor{keyword}{sizeof}(yh\_types)\ /\ \textcolor{keyword}{sizeof}(yh\_types[0]);\ i++)\ \{}
\DoxyCodeLine{01012\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (strncasecmp(line,\ yh\_types[i].\mbox{\hyperlink{catch__reporter__console_8cpp_a9b45b3e13bd9167aab02e17e08916231}{name}},\ strlen(line))\ ==\ 0)\ \{}
\DoxyCodeLine{01013\ \ \ \ \ \ \ \ \ \ \ candidates[n\_candidates++]\ =\ yh\_types[i].name;}
\DoxyCodeLine{01014\ \ \ \ \ \ \ \ \ \ \ assert(n\_candidates\ <\ \mbox{\hyperlink{src_2main_8c_a434d0cee117e46ec9f75d36f95a24b02}{COMPLETION\_CANDIDATES}});}
\DoxyCodeLine{01015\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01016\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01017\ }
\DoxyCodeLine{01018\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01019\ }
\DoxyCodeLine{01020\ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'o'}:}
\DoxyCodeLine{01021\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t}}\ i\ =\ 0;\ i\ <\ \textcolor{keyword}{sizeof}(yh\_options)\ /\ \textcolor{keyword}{sizeof}(yh\_options[0]);}
\DoxyCodeLine{01022\ \ \ \ \ \ \ \ \ \ \ \ i++)\ \{}
\DoxyCodeLine{01023\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (strncasecmp(line,\ yh\_options[i].\mbox{\hyperlink{catch__reporter__console_8cpp_a9b45b3e13bd9167aab02e17e08916231}{name}},\ strlen(line))\ ==\ 0)\ \{}
\DoxyCodeLine{01024\ \ \ \ \ \ \ \ \ \ \ candidates[n\_candidates++]\ =\ yh\_options[i].name;}
\DoxyCodeLine{01025\ \ \ \ \ \ \ \ \ \ \ assert(n\_candidates\ <\ \mbox{\hyperlink{src_2main_8c_a434d0cee117e46ec9f75d36f95a24b02}{COMPLETION\_CANDIDATES}});}
\DoxyCodeLine{01026\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01027\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01028\ }
\DoxyCodeLine{01029\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01030\ }
\DoxyCodeLine{01031\ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'I'}:}
\DoxyCodeLine{01032\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t}}\ i\ =\ 0;\ i\ <\ \textcolor{keyword}{sizeof}(formats)\ /\ \textcolor{keyword}{sizeof}(formats[0]);\ i++)\ \{}
\DoxyCodeLine{01033\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (strncasecmp(line,\ formats[i].\mbox{\hyperlink{catch__reporter__console_8cpp_a9b45b3e13bd9167aab02e17e08916231}{name}},\ strlen(line))\ ==\ 0)\ \{}
\DoxyCodeLine{01034\ \ \ \ \ \ \ \ \ \ \ candidates[n\_candidates++]\ =\ formats[i].name;}
\DoxyCodeLine{01035\ \ \ \ \ \ \ \ \ \ \ assert(n\_candidates\ <\ \mbox{\hyperlink{src_2main_8c_a434d0cee117e46ec9f75d36f95a24b02}{COMPLETION\_CANDIDATES}});}
\DoxyCodeLine{01036\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01037\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01038\ }
\DoxyCodeLine{01039\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01040\ }
\DoxyCodeLine{01041\ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'\(\backslash\)0'}:}
\DoxyCodeLine{01042\ \ \ \ \ \ \ \textcolor{comment}{//\ NOTE(adma):\ completing\ an\ empty\ string,\ we\ reached\ the\ end,\ do}}
\DoxyCodeLine{01043\ \ \ \ \ \ \ \textcolor{comment}{//\ nothing}}
\DoxyCodeLine{01044\ }
\DoxyCodeLine{01045\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ CC\_ERROR;}
\DoxyCodeLine{01046\ }
\DoxyCodeLine{01047\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{01048\ }
\DoxyCodeLine{01049\ \ \ \ \ \ \ \mbox{\hyperlink{namespace_log_a83926634a3916d0927abca4aca58a60a}{printf}}(\textcolor{stringliteral}{"{}\(\backslash\)nunknown\ type"{}});}
\DoxyCodeLine{01050\ }
\DoxyCodeLine{01051\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01052\ \ \ \}}
\DoxyCodeLine{01053\ }
\DoxyCodeLine{01054\ \ \ \textcolor{keywordflow}{switch}\ (n\_candidates)\ \{}
\DoxyCodeLine{01055\ \ \ \ \ \textcolor{keywordflow}{case}\ 0:\ \{}
\DoxyCodeLine{01056\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ i\ =\ 1;}
\DoxyCodeLine{01057\ }
\DoxyCodeLine{01058\ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (arg[i]\ !=\ \textcolor{charliteral}{'\(\backslash\)0'}\ \&\&\ arg[i]\ !=\ \textcolor{charliteral}{','})\ \{}
\DoxyCodeLine{01059\ \ \ \ \ \ \ \ \ i++;}
\DoxyCodeLine{01060\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01061\ }
\DoxyCodeLine{01062\ \ \ \ \ \ \ \mbox{\hyperlink{namespace_log_a83926634a3916d0927abca4aca58a60a}{printf}}(\textcolor{stringliteral}{"{}\%*.*s\(\backslash\)n"{}},\ i,\ i\ -\/\ 1,\ arg\ +\ 1);}
\DoxyCodeLine{01063\ \ \ \ \ \}\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01064\ }
\DoxyCodeLine{01065\ \ \ \ \ \textcolor{keywordflow}{case}\ 1:}
\DoxyCodeLine{01066\ \ \ \ \ \ \ el\_insertstr(el,\ candidates[0]\ +\ cursoro);}
\DoxyCodeLine{01067\ }
\DoxyCodeLine{01068\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ CC\_REDISPLAY;}
\DoxyCodeLine{01069\ }
\DoxyCodeLine{01070\ \ \ \ \ \textcolor{keywordflow}{default}:\ \{}
\DoxyCodeLine{01071\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *lcp;}
\DoxyCodeLine{01072\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ lcp\_len;}
\DoxyCodeLine{01073\ }
\DoxyCodeLine{01074\ \ \ \ \ \ \ qsort(candidates,\ n\_candidates,\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{char}\ *),\ compare\_strings);}
\DoxyCodeLine{01075\ }
\DoxyCodeLine{01076\ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_af1203fbe672161a7e1185578d249959a}{find\_lcp}}(candidates,\ n\_candidates,\ \&lcp,\ \&lcp\_len);}
\DoxyCodeLine{01077\ }
\DoxyCodeLine{01078\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (cursoro\ ==\ lcp\_len)\ \{}
\DoxyCodeLine{01079\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ NOTE(adma):\ we\ already\ have\ lcp\_len\ characters\ typed\ on}}
\DoxyCodeLine{01080\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ the\ prompt,\ display\ all\ the\ possible\ matches}}
\DoxyCodeLine{01081\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_log_a83926634a3916d0927abca4aca58a60a}{printf}}(\textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{01082\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ n\_candidates;\ i++)\ \{}
\DoxyCodeLine{01083\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_log_a83926634a3916d0927abca4aca58a60a}{printf}}(\textcolor{stringliteral}{"{}\%s\(\backslash\)n"{}},\ candidates[i]);}
\DoxyCodeLine{01084\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01085\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01086\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ NOTE(adma):\ we\ found\ an\ lcp,\ autocomplete\ with\ that}}
\DoxyCodeLine{01087\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ prefix[\mbox{\hyperlink{src_2main_8c_a866387736d29c2363110c4ed0c0fad59}{MAX\_COMMAND\_NAME}}];}
\DoxyCodeLine{01088\ \ \ \ \ \ \ \ \ strcpy(prefix,\ lcp\ +\ cursoro);}
\DoxyCodeLine{01089\ \ \ \ \ \ \ \ \ prefix[lcp\_len\ -\/\ cursoro]\ =\ \textcolor{charliteral}{'\(\backslash\)0'};}
\DoxyCodeLine{01090\ }
\DoxyCodeLine{01091\ \ \ \ \ \ \ \ \ el\_insertstr(el,\ prefix);}
\DoxyCodeLine{01092\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ CC\_REDISPLAY;}
\DoxyCodeLine{01093\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01094\ \ \ \ \ \}}
\DoxyCodeLine{01095\ \ \ \}}
\DoxyCodeLine{01096\ }
\DoxyCodeLine{01097\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{301-_gen-_map_type_conversion_8cpp_a1c6a4102d247bdd583751f5a9e2e72f6}{lines}};\ i++)\ \{}
\DoxyCodeLine{01098\ \ \ \ \ \mbox{\hyperlink{namespace_log_a83926634a3916d0927abca4aca58a60a}{printf}}(\textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{01099\ \ \ \}}
\DoxyCodeLine{01100\ \ \ \textcolor{keywordflow}{return}\ CC\_REDISPLAY;}
\DoxyCodeLine{01101\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=243pt]{src_2main_8c_a7f5a0a815226228ed913b8c8afe19a51_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{src_2main_8c_a7f5a0a815226228ed913b8c8afe19a51_icgraph}
\end{center}
\end{figure}
\Hypertarget{src_2main_8c_a2cc07cef63c0cb85fa153a5ee8f3688d}\index{main.c@{main.c}!complete\_command@{complete\_command}}
\index{complete\_command@{complete\_command}!main.c@{main.c}}
\doxysubsubsection{\texorpdfstring{complete\_command()}{complete\_command()}}
{\footnotesize\ttfamily \label{src_2main_8c_a2cc07cef63c0cb85fa153a5ee8f3688d} 
unsigned char complete\+\_\+command (\begin{DoxyParamCaption}\item[{Edit\+Line \texorpdfstring{$\ast$}{*}}]{el}{, }\item[{\mbox{\hyperlink{struct_command}{Command}} \texorpdfstring{$\ast$}{*}}]{to\+\_\+complete}{, }\item[{const char \texorpdfstring{$\ast$}{*}}]{line}{, }\item[{int}]{cursoro}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{src_2main_8c_source_l01103}{1103}} of file \mbox{\hyperlink{src_2main_8c_source}{main.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01104\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01105\ }
\DoxyCodeLine{01106\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *candidates[\mbox{\hyperlink{src_2main_8c_a434d0cee117e46ec9f75d36f95a24b02}{COMPLETION\_CANDIDATES}}];}
\DoxyCodeLine{01107\ \ \ \textcolor{keywordtype}{int}\ n\_candidates\ =\ 0;}
\DoxyCodeLine{01108\ }
\DoxyCodeLine{01109\ \ \ \textcolor{comment}{//\ NOTE(adma):\ try\ to\ autocomplete\ the\ current\ command/subcomand}}
\DoxyCodeLine{01110\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{struct_command}{Command}}\ *command\ =\ to\_complete;\ command;\ command\ =\ command-\/>\mbox{\hyperlink{struct_command_af9c9ea6f57adad15eb7af71d6834d0b4}{next}})\ \{}
\DoxyCodeLine{01111\ \ \ \ \ \textcolor{keywordflow}{if}\ (strncmp(line,\ command-\/>name,\ strlen(line))\ ==\ 0)\ \{}
\DoxyCodeLine{01112\ \ \ \ \ \ \ \textcolor{comment}{//\ printf("{}\%s\(\backslash\)n"{},\ command-\/>name);}}
\DoxyCodeLine{01113\ }
\DoxyCodeLine{01114\ \ \ \ \ \ \ candidates[n\_candidates++]\ =\ command-\/>name;}
\DoxyCodeLine{01115\ \ \ \ \ \ \ assert(n\_candidates\ <\ \mbox{\hyperlink{src_2main_8c_a434d0cee117e46ec9f75d36f95a24b02}{COMPLETION\_CANDIDATES}});}
\DoxyCodeLine{01116\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (n\_candidates\ !=\ 0)\ \{}
\DoxyCodeLine{01117\ \ \ \ \ \ \ \textcolor{comment}{//\ NOTE(adma):\ the\ list\ is\ sorted\ no\ point\ in\ continuing,}}
\DoxyCodeLine{01118\ \ \ \ \ \ \ \textcolor{comment}{//\ bail\ out}}
\DoxyCodeLine{01119\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01120\ \ \ \ \ \}}
\DoxyCodeLine{01121\ \ \ \}}
\DoxyCodeLine{01122\ \ \ \textcolor{comment}{//\ printf("{}Found\ \%d\ candidates\(\backslash\)n"{},\ n\_candidates);}}
\DoxyCodeLine{01123\ \ \ \textcolor{keywordflow}{switch}\ (n\_candidates)\ \{}
\DoxyCodeLine{01124\ \ \ \ \ \textcolor{keywordflow}{case}\ 0:}
\DoxyCodeLine{01125\ \ \ \ \ \ \ \textcolor{comment}{//\ NOTE(adma):\ no\ matches,\ do\ nothing}}
\DoxyCodeLine{01126\ }
\DoxyCodeLine{01127\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ CC\_ERROR;}
\DoxyCodeLine{01128\ }
\DoxyCodeLine{01129\ \ \ \ \ \textcolor{keywordflow}{case}\ 1:}
\DoxyCodeLine{01130\ \ \ \ \ \ \ \textcolor{comment}{//\ NOTE(adma):\ only\ one\ match,\ autocomplete!}}
\DoxyCodeLine{01131\ \ \ \ \ \ \ el\_insertstr(el,\ candidates[0]\ +\ cursoro);}
\DoxyCodeLine{01132\ \ \ \ \ \ \ el\_insertstr(el,\ \textcolor{stringliteral}{"{}\ "{}});}
\DoxyCodeLine{01133\ }
\DoxyCodeLine{01134\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ CC\_REDISPLAY;}
\DoxyCodeLine{01135\ }
\DoxyCodeLine{01136\ \ \ \ \ \textcolor{keywordflow}{default}:\ \{}
\DoxyCodeLine{01137\ \ \ \ \ \ \ \textcolor{comment}{//\ NOTE(adma):\ several\ matches,\ find\ longest\ common\ prefix}}
\DoxyCodeLine{01138\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *lcp;}
\DoxyCodeLine{01139\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ lcp\_len;}
\DoxyCodeLine{01140\ }
\DoxyCodeLine{01141\ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_af1203fbe672161a7e1185578d249959a}{find\_lcp}}(candidates,\ n\_candidates,\ \&lcp,\ \&lcp\_len);}
\DoxyCodeLine{01142\ }
\DoxyCodeLine{01143\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (cursoro\ ==\ lcp\_len)\ \{}
\DoxyCodeLine{01144\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ NOTE(adma):\ we\ already\ have\ lcp\_len\ characters\ typed\ on}}
\DoxyCodeLine{01145\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ the\ prompt,\ display\ all\ the\ possible\ matches}}
\DoxyCodeLine{01146\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_log_a83926634a3916d0927abca4aca58a60a}{printf}}(\textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{01147\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ n\_candidates;\ i++)\ \{}
\DoxyCodeLine{01148\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_log_a83926634a3916d0927abca4aca58a60a}{printf}}(\textcolor{stringliteral}{"{}\%s\(\backslash\)n"{}},\ candidates[i]);}
\DoxyCodeLine{01149\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01150\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01151\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ NOTE(adma):\ we\ found\ an\ lcp,\ autocomplete\ with\ that}}
\DoxyCodeLine{01152\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ prefix[\mbox{\hyperlink{src_2main_8c_a866387736d29c2363110c4ed0c0fad59}{MAX\_COMMAND\_NAME}}];}
\DoxyCodeLine{01153\ \ \ \ \ \ \ \ \ strcpy(prefix,\ lcp\ +\ cursoro);}
\DoxyCodeLine{01154\ \ \ \ \ \ \ \ \ prefix[lcp\_len\ -\/\ cursoro]\ =\ \textcolor{charliteral}{'\(\backslash\)0'};}
\DoxyCodeLine{01155\ }
\DoxyCodeLine{01156\ \ \ \ \ \ \ \ \ el\_insertstr(el,\ prefix);}
\DoxyCodeLine{01157\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01158\ \ \ \ \ \}}
\DoxyCodeLine{01159\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ CC\_REDISPLAY;}
\DoxyCodeLine{01160\ \ \ \}}
\DoxyCodeLine{01161\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=270pt]{src_2main_8c_a2cc07cef63c0cb85fa153a5ee8f3688d_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{src_2main_8c_a2cc07cef63c0cb85fa153a5ee8f3688d_icgraph}
\end{center}
\end{figure}
\Hypertarget{src_2main_8c_a34a9e8c400dcf19e771e884636316060}\index{main.c@{main.c}!create\_command\_list@{create\_command\_list}}
\index{create\_command\_list@{create\_command\_list}!main.c@{main.c}}
\doxysubsubsection{\texorpdfstring{create\_command\_list()}{create\_command\_list()}}
{\footnotesize\ttfamily \label{src_2main_8c_a34a9e8c400dcf19e771e884636316060} 
void create\+\_\+command\+\_\+list (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{src_2main_8c_aee65fcec74905101a0241282bb06d451}{Command\+List}} \texorpdfstring{$\ast$}{*}}]{c}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{src_2main_8c_source_l00221}{221}} of file \mbox{\hyperlink{src_2main_8c_source}{main.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00221\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00222\ }
\DoxyCodeLine{00223\ \ \ \textcolor{comment}{//\ NOTE(adma):\ initialize}}
\DoxyCodeLine{00224\ \ \ *c\ =\ NULL;}
\DoxyCodeLine{00225\ }
\DoxyCodeLine{00226\ \ \ *c\ =\ \mbox{\hyperlink{src_2main_8c_adf60c5d85f9b442e0c7a42235207a241}{register\_command}}(*c,\ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}audit"{}},\ \mbox{\hyperlink{commands_8c_a39d9fd4501c5547cb11e00a3ca37be7e}{yh\_com\_noop}},\ NULL,\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},}
\DoxyCodeLine{00227\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},\ \textcolor{stringliteral}{"{}Deal\ with\ audit\ log"{}},\ NULL,}
\DoxyCodeLine{00228\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ NULL\});}
\DoxyCodeLine{00229\ \ \ \mbox{\hyperlink{src_2main_8c_aee871967a1e47d3fca17a36cf48e6da6}{register\_subcommand}}(*c,\ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}get"{}},\ \mbox{\hyperlink{commands_8c_a3c600843ccdac7af506983bc67cb0bc3}{yh\_com\_audit}},\ \textcolor{stringliteral}{"{}e:session,F:file=-\/"{}},}
\DoxyCodeLine{00230\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a4fff5e64ffe63c6c03b00438c0b09282}{fmt\_ASCII}},\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},\ \textcolor{stringliteral}{"{}Extract\ log\ entries"{}},}
\DoxyCodeLine{00231\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ NULL,\ NULL\});}
\DoxyCodeLine{00232\ \ \ \mbox{\hyperlink{src_2main_8c_aee871967a1e47d3fca17a36cf48e6da6}{register\_subcommand}}(*c,\ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}set"{}},\ \mbox{\hyperlink{commands_8c_aeb72c881aa2699aea40f45fa65cf069b}{yh\_com\_set\_log\_index}},}
\DoxyCodeLine{00233\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}e:session,w:index"{}},\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},}
\DoxyCodeLine{00234\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Set\ the\ log\ index"{}},\ NULL,\ NULL\});}
\DoxyCodeLine{00235\ \ \ *c\ =\ \mbox{\hyperlink{src_2main_8c_adf60c5d85f9b442e0c7a42235207a241}{register\_command}}(*c,\ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}connect"{}},\ \mbox{\hyperlink{commands_8c_a9155cc4306ad97e58a03ead18637f33b}{yh\_com\_connect}},\ NULL,}
\DoxyCodeLine{00236\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},}
\DoxyCodeLine{00237\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Connect\ to\ a\ connector"{}},\ NULL,\ NULL\});}
\DoxyCodeLine{00238\ \ \ *c\ =\ \mbox{\hyperlink{src_2main_8c_adf60c5d85f9b442e0c7a42235207a241}{register\_command}}(*c,\ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}debug"{}},\ \mbox{\hyperlink{commands_8c_a39d9fd4501c5547cb11e00a3ca37be7e}{yh\_com\_noop}},\ NULL,\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},}
\DoxyCodeLine{00239\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},\ \textcolor{stringliteral}{"{}Change\ debug\ settings"{}},\ NULL,}
\DoxyCodeLine{00240\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ NULL\});}
\DoxyCodeLine{00241\ \ \ \mbox{\hyperlink{src_2main_8c_aee871967a1e47d3fca17a36cf48e6da6}{register\_subcommand}}(*c,\ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}all"{}},\ \mbox{\hyperlink{commands_8c_ad8a6eb16c04ad3e525f8be152062ff24}{yh\_com\_debug\_all}},\ NULL,\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},}
\DoxyCodeLine{00242\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},\ \textcolor{stringliteral}{"{}Enable\ all\ debug\ messages"{}},}
\DoxyCodeLine{00243\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ NULL,\ NULL\});}
\DoxyCodeLine{00244\ \ \ \mbox{\hyperlink{src_2main_8c_aee871967a1e47d3fca17a36cf48e6da6}{register\_subcommand}}(*c,}
\DoxyCodeLine{00245\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}crypto"{}},\ \mbox{\hyperlink{commands_8c_af5cc531118346eb9389b42149112acdc}{yh\_com\_debug\_crypto}},\ NULL,\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},}
\DoxyCodeLine{00246\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},\ \textcolor{stringliteral}{"{}Toggle\ crypto\ debug\ messages"{}},\ NULL,}
\DoxyCodeLine{00247\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ NULL\});}
\DoxyCodeLine{00248\ \ \ \mbox{\hyperlink{src_2main_8c_aee871967a1e47d3fca17a36cf48e6da6}{register\_subcommand}}(*c,\ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}error"{}},\ \mbox{\hyperlink{commands_8c_af045c2e8a570dc8fed3d339e75d26feb}{yh\_com\_debug\_error}},\ NULL,}
\DoxyCodeLine{00249\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},}
\DoxyCodeLine{00250\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Toggle\ error\ debug\ messages"{}},\ NULL,\ NULL\});}
\DoxyCodeLine{00251\ \ \ \mbox{\hyperlink{src_2main_8c_aee871967a1e47d3fca17a36cf48e6da6}{register\_subcommand}}(*c,\ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}info"{}},\ \mbox{\hyperlink{commands_8c_a774b8dbc4c8d855527e518270206bb52}{yh\_com\_debug\_info}},\ NULL,\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},}
\DoxyCodeLine{00252\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},\ \textcolor{stringliteral}{"{}Toggle\ info\ debug\ messages"{}},}
\DoxyCodeLine{00253\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ NULL,\ NULL\});}
\DoxyCodeLine{00254\ \ \ \mbox{\hyperlink{src_2main_8c_aee871967a1e47d3fca17a36cf48e6da6}{register\_subcommand}}(*c,\ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}intermediate"{}},\ \mbox{\hyperlink{commands_8c_ad621ced8cc22f103e049f17717d0b3d8}{yh\_com\_debug\_intermediate}},}
\DoxyCodeLine{00255\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ NULL,\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},}
\DoxyCodeLine{00256\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Toggle\ intermediate\ debug\ messages"{}},\ NULL,}
\DoxyCodeLine{00257\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ NULL\});}
\DoxyCodeLine{00258\ \ \ \mbox{\hyperlink{src_2main_8c_aee871967a1e47d3fca17a36cf48e6da6}{register\_subcommand}}(*c,\ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}none"{}},\ \mbox{\hyperlink{commands_8c_ac8470d4c5dc4fa0d300bcf171a16140b}{yh\_com\_debug\_none}},\ NULL,\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},}
\DoxyCodeLine{00259\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},\ \textcolor{stringliteral}{"{}Disable\ all\ debug\ messages"{}},}
\DoxyCodeLine{00260\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ NULL,\ NULL\});}
\DoxyCodeLine{00261\ \ \ \mbox{\hyperlink{src_2main_8c_aee871967a1e47d3fca17a36cf48e6da6}{register\_subcommand}}(*c,\ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}raw"{}},\ \mbox{\hyperlink{commands_8c_ac67abff009407dcfe773a32d8273969a}{yh\_com\_debug\_raw}},\ NULL,\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},}
\DoxyCodeLine{00262\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},\ \textcolor{stringliteral}{"{}Toggle\ raw\ debug\ messages"{}},}
\DoxyCodeLine{00263\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ NULL,\ NULL\});}
\DoxyCodeLine{00264\ \ \ *c\ =\ \mbox{\hyperlink{src_2main_8c_adf60c5d85f9b442e0c7a42235207a241}{register\_command}}(*c,\ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}decrypt"{}},\ \mbox{\hyperlink{commands_8c_a39d9fd4501c5547cb11e00a3ca37be7e}{yh\_com\_noop}},\ NULL,\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},}
\DoxyCodeLine{00265\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},\ \textcolor{stringliteral}{"{}Decrypt\ data"{}},\ NULL,\ NULL\});}
\DoxyCodeLine{00266\ \ \ \mbox{\hyperlink{src_2main_8c_aee871967a1e47d3fca17a36cf48e6da6}{register\_subcommand}}(*c,\ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}pkcs1v1\_5"{}},\ \mbox{\hyperlink{commands_8c_aea9c5cab32280dc06d4681c02f1b5ccb}{yh\_com\_decrypt\_pkcs1v1\_5}},}
\DoxyCodeLine{00267\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}e:session,w:key\_id,i:data=-\/"{}},\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a701725c70fb214e14a2feee390939a09}{fmt\_binary}},}
\DoxyCodeLine{00268\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708add674d756d2c6341a834a330a874b550}{fmt\_base64}},}
\DoxyCodeLine{00269\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Decrypt\ data\ using\ RSAES-\/PKCS\#1v1.5"{}},\ NULL,}
\DoxyCodeLine{00270\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ NULL\});}
\DoxyCodeLine{00271\ \ \ \mbox{\hyperlink{src_2main_8c_aee871967a1e47d3fca17a36cf48e6da6}{register\_subcommand}}(}
\DoxyCodeLine{00272\ \ \ \ \ *c,}
\DoxyCodeLine{00273\ \ \ \ \ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}oaep"{}},\ \mbox{\hyperlink{commands_8c_a38efe7b63355b641f9489d4f95106589}{yh\_com\_decrypt\_oaep}},}
\DoxyCodeLine{00274\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}e:session,w:key\_id,a:algorithm,i:data=-\/,s:label="{}},\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a701725c70fb214e14a2feee390939a09}{fmt\_binary}},}
\DoxyCodeLine{00275\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708add674d756d2c6341a834a330a874b550}{fmt\_base64}},\ \textcolor{stringliteral}{"{}Decrypt\ data\ using\ RSAES-\/OAEP"{}},\ NULL,\ NULL\});}
\DoxyCodeLine{00276\ \ \ \mbox{\hyperlink{src_2main_8c_aee871967a1e47d3fca17a36cf48e6da6}{register\_subcommand}}(*c,}
\DoxyCodeLine{00277\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}aesccm"{}},\ \mbox{\hyperlink{commands_8c_a4a18ed75272b213eea9b2ebec190b8c1}{yh\_com\_decrypt\_aesccm}},}
\DoxyCodeLine{00278\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}e:session,w:key\_id,i:data=-\/"{}},\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708add674d756d2c6341a834a330a874b550}{fmt\_base64}},}
\DoxyCodeLine{00279\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a701725c70fb214e14a2feee390939a09}{fmt\_binary}},\ \textcolor{stringliteral}{"{}Decrypt\ data\ using\ Yubico-\/AES-\/CCM"{}},}
\DoxyCodeLine{00280\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ NULL,\ NULL\});}
\DoxyCodeLine{00281\ \ \ *c\ =\ \mbox{\hyperlink{src_2main_8c_adf60c5d85f9b442e0c7a42235207a241}{register\_command}}(*c,\ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}derive"{}},\ \mbox{\hyperlink{commands_8c_a39d9fd4501c5547cb11e00a3ca37be7e}{yh\_com\_noop}},\ NULL,\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},}
\DoxyCodeLine{00282\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},\ \textcolor{stringliteral}{"{}Drive\ data"{}},\ NULL,\ NULL\});}
\DoxyCodeLine{00283\ \ \ \mbox{\hyperlink{src_2main_8c_aee871967a1e47d3fca17a36cf48e6da6}{register\_subcommand}}(*c,\ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}ecdh"{}},\ \mbox{\hyperlink{commands_8c_a0f6792710fe36e1bf00cb839f286d473}{yh\_com\_derive\_ecdh}},}
\DoxyCodeLine{00284\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}e:session,w:key\_id,i:pubkey=-\/"{}},\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708aa8908f2c651567ae288c587240e71d3e}{fmt\_PEM}},}
\DoxyCodeLine{00285\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708acce29e9764c448874d69cb6c90b02401}{fmt\_hex}},\ \textcolor{stringliteral}{"{}Perform\ a\ ECDH\ key\ exchange"{}},}
\DoxyCodeLine{00286\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ NULL,\ NULL\});}
\DoxyCodeLine{00287\ }
\DoxyCodeLine{00288\ \ \ *c\ =\ \mbox{\hyperlink{src_2main_8c_adf60c5d85f9b442e0c7a42235207a241}{register\_command}}(*c,\ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}encrypt"{}},\ \mbox{\hyperlink{commands_8c_a39d9fd4501c5547cb11e00a3ca37be7e}{yh\_com\_noop}},\ NULL,\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},}
\DoxyCodeLine{00289\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},\ \textcolor{stringliteral}{"{}Encrypt\ data"{}},\ NULL,\ NULL\});}
\DoxyCodeLine{00290\ \ \ \mbox{\hyperlink{src_2main_8c_aee871967a1e47d3fca17a36cf48e6da6}{register\_subcommand}}(*c,}
\DoxyCodeLine{00291\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}aesccm"{}},\ \mbox{\hyperlink{commands_8c_a115ebd6b436229c152141f64a2405e70}{yh\_com\_encrypt\_aesccm}},}
\DoxyCodeLine{00292\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}e:session,w:key\_id,i:data=-\/"{}},\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a701725c70fb214e14a2feee390939a09}{fmt\_binary}},}
\DoxyCodeLine{00293\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708add674d756d2c6341a834a330a874b550}{fmt\_base64}},\ \textcolor{stringliteral}{"{}Encrypt\ data\ using\ Yubico-\/AES-\/CCM"{}},}
\DoxyCodeLine{00294\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ NULL,\ NULL\});}
\DoxyCodeLine{00295\ \ \ *c\ =}
\DoxyCodeLine{00296\ \ \ \ \ \mbox{\hyperlink{src_2main_8c_adf60c5d85f9b442e0c7a42235207a241}{register\_command}}(*c,\ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}disconnect"{}},\ \mbox{\hyperlink{commands_8c_ac388fd67865728ed4f4267a8a13b248e}{yh\_com\_disconnect}},\ NULL,}
\DoxyCodeLine{00297\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},}
\DoxyCodeLine{00298\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Disconnect\ from\ a\ connector"{}},\ NULL,\ NULL\});}
\DoxyCodeLine{00299\ \ \ *c\ =}
\DoxyCodeLine{00300\ \ \ \ \ \mbox{\hyperlink{src_2main_8c_adf60c5d85f9b442e0c7a42235207a241}{register\_command}}(*c,}
\DoxyCodeLine{00301\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}echo"{}},\ \mbox{\hyperlink{commands_8c_af764906e585805991dd84ec5dc2c060a}{yh\_com\_echo}},\ \textcolor{stringliteral}{"{}e:session,b:byte,w:count"{}},}
\DoxyCodeLine{00302\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},}
\DoxyCodeLine{00303\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Send\ an\ ECHO\ command\ over\ a\ given\ session"{}},}
\DoxyCodeLine{00304\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ NULL,\ NULL\});}
\DoxyCodeLine{00305\ \ \ *c\ =\ \mbox{\hyperlink{src_2main_8c_adf60c5d85f9b442e0c7a42235207a241}{register\_command}}(*c,\ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}generate"{}},\ \mbox{\hyperlink{commands_8c_a39d9fd4501c5547cb11e00a3ca37be7e}{yh\_com\_noop}},\ NULL,\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},}
\DoxyCodeLine{00306\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},\ \textcolor{stringliteral}{"{}Generate\ key"{}},\ NULL,\ NULL\});}
\DoxyCodeLine{00307\ \ \ \mbox{\hyperlink{src_2main_8c_aee871967a1e47d3fca17a36cf48e6da6}{register\_subcommand}}(*c,\ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}asymmetric"{}},\ \mbox{\hyperlink{commands_8c_aa1c71ebc2b3f298b6522ab090393c73e}{yh\_com\_generate\_asymmetric}},}
\DoxyCodeLine{00308\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}e:session,w:key\_id,s:label,d:domains,c:"{}}}
\DoxyCodeLine{00309\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}capabilities,a:algorithm"{}},}
\DoxyCodeLine{00310\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},}
\DoxyCodeLine{00311\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Generate\ an\ asymmetric\ key"{}},\ NULL,\ NULL\});}
\DoxyCodeLine{00312\ \ \ \mbox{\hyperlink{src_2main_8c_aee871967a1e47d3fca17a36cf48e6da6}{register\_subcommand}}(*c,\ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}hmackey"{}},\ \mbox{\hyperlink{commands_8c_a2be1be0e0a454965f5a378e4ecb483f0}{yh\_com\_generate\_hmac}},}
\DoxyCodeLine{00313\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}e:session,w:key\_id,s:label,d:domains,c:"{}}}
\DoxyCodeLine{00314\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}capabilities,a:algorithm"{}},}
\DoxyCodeLine{00315\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},\ \textcolor{stringliteral}{"{}Generate\ HMAC\ key"{}},}
\DoxyCodeLine{00316\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ NULL,\ NULL\});}
\DoxyCodeLine{00317\ \ \ \mbox{\hyperlink{src_2main_8c_aee871967a1e47d3fca17a36cf48e6da6}{register\_subcommand}}(}
\DoxyCodeLine{00318\ \ \ \ \ *c,\ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}wrapkey"{}},\ \mbox{\hyperlink{commands_8c_a43d7d9dd1659838d79f875e61e59ce52}{yh\_com\_generate\_wrap}},}
\DoxyCodeLine{00319\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}e:session,w:key\_id,s:label,d:domains,c:"{}}}
\DoxyCodeLine{00320\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}capabilities,c:delegated\_capabilities,a:algorithm"{}},}
\DoxyCodeLine{00321\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},\ \textcolor{stringliteral}{"{}Generate\ wrap\ key"{}},\ NULL,\ NULL\});}
\DoxyCodeLine{00322\ \ \ \mbox{\hyperlink{src_2main_8c_aee871967a1e47d3fca17a36cf48e6da6}{register\_subcommand}}(*c,\ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}otpaeadkey"{}},\ \mbox{\hyperlink{commands_8c_a13416d261c1a92415525cbfa63a2dc0c}{yh\_com\_generate\_otp\_aead\_key}},}
\DoxyCodeLine{00323\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}e:session,w:key\_id,s:label,d:domains,c:"{}}}
\DoxyCodeLine{00324\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}capabilities,a:algorithm,u:nonce\_id"{}},}
\DoxyCodeLine{00325\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},}
\DoxyCodeLine{00326\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Generate\ OTP\ AEAD\ key"{}},\ NULL,\ NULL\});}
\DoxyCodeLine{00327\ \ \ *c\ =\ \mbox{\hyperlink{src_2main_8c_adf60c5d85f9b442e0c7a42235207a241}{register\_command}}(*c,\ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}get"{}},\ \mbox{\hyperlink{commands_8c_a39d9fd4501c5547cb11e00a3ca37be7e}{yh\_com\_noop}},\ NULL,\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},}
\DoxyCodeLine{00328\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},\ \textcolor{stringliteral}{"{}Retrieve\ data"{}},\ NULL,\ NULL\});}
\DoxyCodeLine{00329\ \ \ \mbox{\hyperlink{src_2main_8c_aee871967a1e47d3fca17a36cf48e6da6}{register\_subcommand}}(*c,\ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}opaque"{}},\ \mbox{\hyperlink{commands_8c_ad8a4781a26be12a87848234cc184a3bb}{yh\_com\_get\_opaque}},}
\DoxyCodeLine{00330\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}e:session,w:object\_id,F:file=-\/"{}},\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},}
\DoxyCodeLine{00331\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a701725c70fb214e14a2feee390939a09}{fmt\_binary}},\ \textcolor{stringliteral}{"{}Get\ an\ opaque\ object"{}},\ NULL,}
\DoxyCodeLine{00332\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ NULL\});}
\DoxyCodeLine{00333\ \ \ \mbox{\hyperlink{src_2main_8c_aee871967a1e47d3fca17a36cf48e6da6}{register\_subcommand}}(*c,\ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}option"{}},\ \mbox{\hyperlink{commands_8c_aaafb1f743869a0068a7d7b6ed1bafb01}{yh\_com\_get\_option}},}
\DoxyCodeLine{00334\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}e:session,o:option"{}},\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},}
\DoxyCodeLine{00335\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},\ \textcolor{comment}{//\ FIXME:\ output}}
\DoxyCodeLine{00336\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Get\ a\ global\ option\ value"{}},\ NULL,\ NULL\});}
\DoxyCodeLine{00337\ \ \ \mbox{\hyperlink{src_2main_8c_aee871967a1e47d3fca17a36cf48e6da6}{register\_subcommand}}(*c,}
\DoxyCodeLine{00338\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}random"{}},\ \mbox{\hyperlink{commands_8c_af32a8f10f2d022ca8b7816e6f4809a24}{yh\_com\_get\_random}},}
\DoxyCodeLine{00339\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}e:session,w:count,F:out=-\/"{}},\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708acce29e9764c448874d69cb6c90b02401}{fmt\_hex}},}
\DoxyCodeLine{00340\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Get\ pseudo-\/random\ bytes"{}},\ NULL,\ NULL\});}
\DoxyCodeLine{00341\ \ \ \mbox{\hyperlink{src_2main_8c_aee871967a1e47d3fca17a36cf48e6da6}{register\_subcommand}}(*c,\ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}storage"{}},\ \mbox{\hyperlink{commands_8c_a408c9e43b8ccb159acb178f2b20f3f77}{yh\_com\_get\_storage}},\ \textcolor{stringliteral}{"{}e:session"{}},}
\DoxyCodeLine{00342\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},\ \textcolor{stringliteral}{"{}Get\ storages\ stats"{}},}
\DoxyCodeLine{00343\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ NULL,\ NULL\});}
\DoxyCodeLine{00344\ \ \ \mbox{\hyperlink{src_2main_8c_aee871967a1e47d3fca17a36cf48e6da6}{register\_subcommand}}(*c,\ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}pubkey"{}},\ \mbox{\hyperlink{commands_8c_aa1c9a933f4601dae48cd64f911d297aa}{yh\_com\_get\_pubkey}},}
\DoxyCodeLine{00345\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}e:session,w:key\_id,F:file=-\/"{}},\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},}
\DoxyCodeLine{00346\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708aa8908f2c651567ae288c587240e71d3e}{fmt\_PEM}},\ \textcolor{stringliteral}{"{}Get\ a\ public\ key"{}},\ NULL,\ NULL\});}
\DoxyCodeLine{00347\ \ \ \mbox{\hyperlink{src_2main_8c_aee871967a1e47d3fca17a36cf48e6da6}{register\_subcommand}}(*c,}
\DoxyCodeLine{00348\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}objectinfo"{}},\ \mbox{\hyperlink{commands_8c_afa7330c81148ba6f4d5c53f7c370ed41}{yh\_com\_get\_object\_info}},}
\DoxyCodeLine{00349\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}e:session,w:id,t:type"{}},\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},}
\DoxyCodeLine{00350\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Get\ information\ about\ an\ object"{}},\ NULL,\ NULL\});}
\DoxyCodeLine{00351\ \ \ \mbox{\hyperlink{src_2main_8c_aee871967a1e47d3fca17a36cf48e6da6}{register\_subcommand}}(*c,}
\DoxyCodeLine{00352\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}wrapped"{}},\ \mbox{\hyperlink{commands_8c_ac221d587381b78c747d8290320ee4c0a}{yh\_com\_get\_wrapped}},}
\DoxyCodeLine{00353\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}e:session,w:wrapkey\_id,t:type,w:id,F:file=-\/"{}},}
\DoxyCodeLine{00354\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708add674d756d2c6341a834a330a874b550}{fmt\_base64}},}
\DoxyCodeLine{00355\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Get\ an\ object\ under\ wrap"{}},\ NULL,\ NULL\});}
\DoxyCodeLine{00356\ \ \ \mbox{\hyperlink{src_2main_8c_aee871967a1e47d3fca17a36cf48e6da6}{register\_subcommand}}(*c,\ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}deviceinfo"{}},\ \mbox{\hyperlink{commands_8c_aca833cbc2ca7673b00a4f6cb320c97b6}{yh\_com\_get\_device\_info}},\ NULL,}
\DoxyCodeLine{00357\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},}
\DoxyCodeLine{00358\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Extract\ the\ version\ number,\ serial\ number\ "{}}}
\DoxyCodeLine{00359\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}and\ supported\ algorithms"{}},}
\DoxyCodeLine{00360\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ NULL,\ NULL\});}
\DoxyCodeLine{00361\ \ \ \mbox{\hyperlink{src_2main_8c_aee871967a1e47d3fca17a36cf48e6da6}{register\_subcommand}}(*c,\ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}template"{}},\ \mbox{\hyperlink{commands_8c_ac8e5bb8ba179bc997ddc73e03423782d}{yh\_com\_get\_template}},}
\DoxyCodeLine{00362\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}e:session,w:object\_id,F:out=-\/"{}},\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},}
\DoxyCodeLine{00363\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708add674d756d2c6341a834a330a874b550}{fmt\_base64}},\ \textcolor{stringliteral}{"{}Get\ a\ template\ object"{}},\ NULL,}
\DoxyCodeLine{00364\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ NULL\});}
\DoxyCodeLine{00365\ }
\DoxyCodeLine{00366\ \ \ *c\ =}
\DoxyCodeLine{00367\ \ \ \ \ \mbox{\hyperlink{src_2main_8c_adf60c5d85f9b442e0c7a42235207a241}{register\_command}}(*c,\ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}help"{}},\ \mbox{\hyperlink{src_2main_8c_a0f55f786bda19a4380614a719cf93faf}{yh\_com\_help}},\ \textcolor{stringliteral}{"{}s:command="{}},\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},}
\DoxyCodeLine{00368\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},\ \textcolor{stringliteral}{"{}Display\ help\ text"{}},\ NULL,\ NULL\});}
\DoxyCodeLine{00369\ \ \ *c\ =}
\DoxyCodeLine{00370\ \ \ \ \ \mbox{\hyperlink{src_2main_8c_adf60c5d85f9b442e0c7a42235207a241}{register\_command}}(*c,\ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}history"{}},\ \mbox{\hyperlink{src_2main_8c_ad91b275691b905cdc54d7add2a5b06e3}{yh\_com\_history}},\ NULL,\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},}
\DoxyCodeLine{00371\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},\ \textcolor{stringliteral}{"{}Display\ the\ command\ history"{}},}
\DoxyCodeLine{00372\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ NULL,\ NULL\});}
\DoxyCodeLine{00373\ \ \ *c\ =}
\DoxyCodeLine{00374\ \ \ \ \ \mbox{\hyperlink{src_2main_8c_adf60c5d85f9b442e0c7a42235207a241}{register\_command}}(*c,\ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}list"{}},\ \mbox{\hyperlink{commands_8c_a39d9fd4501c5547cb11e00a3ca37be7e}{yh\_com\_noop}},\ NULL,\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},}
\DoxyCodeLine{00375\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},\ \textcolor{stringliteral}{"{}List\ information"{}},\ NULL,\ NULL\});}
\DoxyCodeLine{00376\ \ \ \mbox{\hyperlink{src_2main_8c_aee871967a1e47d3fca17a36cf48e6da6}{register\_subcommand}}(*c,\ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}capabilities"{}},\ \mbox{\hyperlink{commands_8c_ab7355f80935fb819c440a21d56f181e4}{yh\_com\_list\_capabilities}},}
\DoxyCodeLine{00377\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ NULL,\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},}
\DoxyCodeLine{00378\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Prints\ a\ list\ of\ possible\ capabilities"{}},}
\DoxyCodeLine{00379\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ NULL,\ NULL\});}
\DoxyCodeLine{00380\ \ \ \mbox{\hyperlink{src_2main_8c_aee871967a1e47d3fca17a36cf48e6da6}{register\_subcommand}}(*c,\ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}algorithms"{}},\ \mbox{\hyperlink{commands_8c_ac981267ad1d570af845289dfb0733b8b}{yh\_com\_list\_algorithms}},\ NULL,}
\DoxyCodeLine{00381\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},}
\DoxyCodeLine{00382\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Prints\ a\ list\ of\ possible\ algorithms"{}},}
\DoxyCodeLine{00383\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ NULL,\ NULL\});}
\DoxyCodeLine{00384\ \ \ \mbox{\hyperlink{src_2main_8c_aee871967a1e47d3fca17a36cf48e6da6}{register\_subcommand}}(*c,}
\DoxyCodeLine{00385\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}types"{}},\ \mbox{\hyperlink{commands_8c_a65ff18ca1fb6f1b4da386071e1c1a505}{yh\_com\_list\_types}},\ NULL,\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},}
\DoxyCodeLine{00386\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},\ \textcolor{stringliteral}{"{}Prints\ a\ list\ of\ possible\ types"{}},}
\DoxyCodeLine{00387\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ NULL,\ NULL\});}
\DoxyCodeLine{00388\ \ \ \mbox{\hyperlink{src_2main_8c_aee871967a1e47d3fca17a36cf48e6da6}{register\_subcommand}}(*c,\ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}sessions"{}},\ \mbox{\hyperlink{commands_8c_ab98950b39a19499a22ec6b2e874525a5}{yh\_com\_list\_sessions}},\ NULL,}
\DoxyCodeLine{00389\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},}
\DoxyCodeLine{00390\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}List\ the\ open\ session"{}},\ NULL,\ NULL\});}
\DoxyCodeLine{00391\ \ \ \mbox{\hyperlink{src_2main_8c_aee871967a1e47d3fca17a36cf48e6da6}{register\_subcommand}}(*c,\ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}objects"{}},\ \mbox{\hyperlink{commands_8c_a2b752129687a9ca758661e0b6625b59c}{yh\_com\_list\_objects}},}
\DoxyCodeLine{00392\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}e:session,w:id=0,t:type=any,d:domains=0,c:"{}}}
\DoxyCodeLine{00393\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}capabilities=0,a:algorithm=any,s:label="{}},}
\DoxyCodeLine{00394\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},}
\DoxyCodeLine{00395\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}List\ objects\ according\ to\ filter"{}},\ NULL,}
\DoxyCodeLine{00396\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ NULL\});}
\DoxyCodeLine{00397\ \ \ *c\ =}
\DoxyCodeLine{00398\ \ \ \ \ \mbox{\hyperlink{src_2main_8c_adf60c5d85f9b442e0c7a42235207a241}{register\_command}}(*c,}
\DoxyCodeLine{00399\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}plain"{}},\ \mbox{\hyperlink{commands_8c_a39d9fd4501c5547cb11e00a3ca37be7e}{yh\_com\_noop}},\ NULL,\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},}
\DoxyCodeLine{00400\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Send\ unencrypted\ and\ unauthenticated\ commands"{}},}
\DoxyCodeLine{00401\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ NULL,\ NULL\});}
\DoxyCodeLine{00402\ \ \ \mbox{\hyperlink{src_2main_8c_aee871967a1e47d3fca17a36cf48e6da6}{register\_subcommand}}(*c,\ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}echo"{}},\ \mbox{\hyperlink{commands_8c_a95d970cdea5162be25cac2a7f5c420ed}{yh\_com\_pecho}},\ \textcolor{stringliteral}{"{}b:byte,w:count"{}},}
\DoxyCodeLine{00403\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},}
\DoxyCodeLine{00404\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Send\ a\ plain\ echo\ command"{}},\ NULL,\ NULL\});}
\DoxyCodeLine{00405\ \ \ *c\ =\ \mbox{\hyperlink{src_2main_8c_adf60c5d85f9b442e0c7a42235207a241}{register\_command}}(*c,\ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}put"{}},\ \mbox{\hyperlink{commands_8c_a39d9fd4501c5547cb11e00a3ca37be7e}{yh\_com\_noop}},\ NULL,\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},}
\DoxyCodeLine{00406\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},\ \textcolor{stringliteral}{"{}Store\ data"{}},\ NULL,\ NULL\});}
\DoxyCodeLine{00407\ \ \ \mbox{\hyperlink{src_2main_8c_aee871967a1e47d3fca17a36cf48e6da6}{register\_subcommand}}(*c,\ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}asymmetric"{}},\ \mbox{\hyperlink{commands_8c_a0abe95eb37069022ed341835938de103}{yh\_com\_put\_asymmetric}},}
\DoxyCodeLine{00408\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}e:session,w:key\_id,s:label,d:domains,c:"{}}}
\DoxyCodeLine{00409\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}capabilities,i:key=-\/"{}},}
\DoxyCodeLine{00410\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708aa8908f2c651567ae288c587240e71d3e}{fmt\_PEM}},\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},}
\DoxyCodeLine{00411\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Store\ an\ asymmetric\ key"{}},\ NULL,\ NULL\});}
\DoxyCodeLine{00412\ \ \ \mbox{\hyperlink{src_2main_8c_aee871967a1e47d3fca17a36cf48e6da6}{register\_subcommand}}(*c,\ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}authkey"{}},\ \mbox{\hyperlink{commands_8c_a3bd17c302789958013e50a2ad9738aea}{yh\_com\_put\_authentication}},}
\DoxyCodeLine{00413\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}e:session,w:key\_id,s:label,d:domains,c:"{}}}
\DoxyCodeLine{00414\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}capabilities,c:delegated\_capabilities,i:"{}}}
\DoxyCodeLine{00415\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}password=-\/"{}},}
\DoxyCodeLine{00416\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708ad58942468b13601c21c14f2269dbca57}{fmt\_password}},\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},}
\DoxyCodeLine{00417\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Store\ an\ authentication\ key"{}},\ NULL,\ NULL\});}
\DoxyCodeLine{00418\ \ \ \mbox{\hyperlink{src_2main_8c_aee871967a1e47d3fca17a36cf48e6da6}{register\_subcommand}}(*c,\ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}opaque"{}},\ \mbox{\hyperlink{commands_8c_a2be40cf6e90d80392d7aa5e291660f65}{yh\_com\_put\_opaque}},}
\DoxyCodeLine{00419\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}e:session,w:object\_id,s:label,d:domains,c:"{}}}
\DoxyCodeLine{00420\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}capabilities,a:algorithm,i:data=-\/"{}},}
\DoxyCodeLine{00421\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a701725c70fb214e14a2feee390939a09}{fmt\_binary}},\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},}
\DoxyCodeLine{00422\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Store\ an\ opaque\ object"{}},\ NULL,\ NULL\});}
\DoxyCodeLine{00423\ \ \ \mbox{\hyperlink{src_2main_8c_aee871967a1e47d3fca17a36cf48e6da6}{register\_subcommand}}(*c,}
\DoxyCodeLine{00424\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}option"{}},\ \mbox{\hyperlink{commands_8c_ae400ec3fdd83a82b3c08dd7106c516b9}{yh\_com\_put\_option}},}
\DoxyCodeLine{00425\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}e:session,o:option,i:data"{}},\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708acce29e9764c448874d69cb6c90b02401}{fmt\_hex}},\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},}
\DoxyCodeLine{00426\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Set\ a\ global\ option\ value"{}},\ NULL,\ NULL\});}
\DoxyCodeLine{00427\ \ \ \mbox{\hyperlink{src_2main_8c_aee871967a1e47d3fca17a36cf48e6da6}{register\_subcommand}}(*c,\ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}hmackey"{}},\ \mbox{\hyperlink{commands_8c_aed17eea0c4eb877cd1097fbcd8e8e5d0}{yh\_com\_put\_hmac}},}
\DoxyCodeLine{00428\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}e:session,w:key\_id,s:label,d:domains,c:"{}}}
\DoxyCodeLine{00429\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}capabilities,a:algorithm,i:key"{}},}
\DoxyCodeLine{00430\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708acce29e9764c448874d69cb6c90b02401}{fmt\_hex}},\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},\ \textcolor{stringliteral}{"{}Store\ a\ HMAC\ key"{}},}
\DoxyCodeLine{00431\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ NULL,\ NULL\});}
\DoxyCodeLine{00432\ \ \ \mbox{\hyperlink{src_2main_8c_aee871967a1e47d3fca17a36cf48e6da6}{register\_subcommand}}(*c,}
\DoxyCodeLine{00433\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}wrapkey"{}},\ \mbox{\hyperlink{commands_8c_ab2eb73abfe6f6d5a7f17752b3cab227a}{yh\_com\_put\_wrapkey}},}
\DoxyCodeLine{00434\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}e:session,w:key\_id,s:label,d:domains,c:"{}}}
\DoxyCodeLine{00435\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}capabilities,c:delegated\_capabilities,i:key"{}},}
\DoxyCodeLine{00436\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708acce29e9764c448874d69cb6c90b02401}{fmt\_hex}},\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},\ \textcolor{stringliteral}{"{}Store\ a\ wrapping\ key"{}},}
\DoxyCodeLine{00437\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ NULL,\ NULL\});}
\DoxyCodeLine{00438\ \ \ \mbox{\hyperlink{src_2main_8c_aee871967a1e47d3fca17a36cf48e6da6}{register\_subcommand}}(*c,\ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}wrapped"{}},\ \mbox{\hyperlink{commands_8c_a6b74f2d2d47796c2432a15cd63183dd1}{yh\_com\_put\_wrapped}},}
\DoxyCodeLine{00439\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}e:session,w:wrapkey\_id,i:data=-\/"{}},}
\DoxyCodeLine{00440\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708add674d756d2c6341a834a330a874b550}{fmt\_base64}},\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},}
\DoxyCodeLine{00441\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Store\ a\ wrapped\ object"{}},\ NULL,\ NULL\});}
\DoxyCodeLine{00442\ \ \ \mbox{\hyperlink{src_2main_8c_aee871967a1e47d3fca17a36cf48e6da6}{register\_subcommand}}(*c,\ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}template"{}},\ \mbox{\hyperlink{commands_8c_ad1629b955c1d718c65f137c9df3b3332}{yh\_com\_put\_template}},}
\DoxyCodeLine{00443\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}e:session,w:object\_id,s:label,d:domains,c:"{}}}
\DoxyCodeLine{00444\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}capabilities,a:algorithm,i:data=-\/"{}},}
\DoxyCodeLine{00445\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708add674d756d2c6341a834a330a874b550}{fmt\_base64}},\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},}
\DoxyCodeLine{00446\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Store\ a\ template\ object"{}},\ NULL,\ NULL\});}
\DoxyCodeLine{00447\ \ \ \mbox{\hyperlink{src_2main_8c_aee871967a1e47d3fca17a36cf48e6da6}{register\_subcommand}}(*c,\ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}otpaeadkey"{}},\ \mbox{\hyperlink{commands_8c_a7ef84380bc19536e4ba9bf62fd44ba93}{yh\_com\_put\_otp\_aead\_key}},}
\DoxyCodeLine{00448\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}e:session,w:key\_id,s:label,d:domains,c:"{}}}
\DoxyCodeLine{00449\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}capabilities,u:nonce\_id,i:key"{}},}
\DoxyCodeLine{00450\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708acce29e9764c448874d69cb6c90b02401}{fmt\_hex}},\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},\ \textcolor{stringliteral}{"{}Store\ a\ OTP\ AEAD\ key"{}},}
\DoxyCodeLine{00451\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ NULL,\ NULL\});}
\DoxyCodeLine{00452\ \ \ *c\ =\ \mbox{\hyperlink{src_2main_8c_adf60c5d85f9b442e0c7a42235207a241}{register\_command}}(*c,}
\DoxyCodeLine{00453\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}quit"{}},\ \mbox{\hyperlink{src_2main_8c_aaec43efb95baeb7ec8f2854ffa2cb673}{yh\_com\_quit}},\ NULL,\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},}
\DoxyCodeLine{00454\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},\ \textcolor{stringliteral}{"{}Quit\ yubihsm-\/shell"{}},\ NULL,\ NULL\});}
\DoxyCodeLine{00455\ \ \ *c\ =\ \mbox{\hyperlink{src_2main_8c_adf60c5d85f9b442e0c7a42235207a241}{register\_command}}(*c,}
\DoxyCodeLine{00456\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}exit"{}},\ \mbox{\hyperlink{src_2main_8c_aaec43efb95baeb7ec8f2854ffa2cb673}{yh\_com\_quit}},\ NULL,\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},}
\DoxyCodeLine{00457\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},\ \textcolor{stringliteral}{"{}Quit\ yubihsm-\/shell"{}},\ NULL,\ NULL\});}
\DoxyCodeLine{00458\ \ \ *c\ =}
\DoxyCodeLine{00459\ \ \ \ \ \mbox{\hyperlink{src_2main_8c_adf60c5d85f9b442e0c7a42235207a241}{register\_command}}(*c,\ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}session"{}},\ \mbox{\hyperlink{commands_8c_a39d9fd4501c5547cb11e00a3ca37be7e}{yh\_com\_noop}},\ NULL,\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},}
\DoxyCodeLine{00460\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},\ \textcolor{stringliteral}{"{}Manage\ sessions"{}},\ NULL,\ NULL\});}
\DoxyCodeLine{00461\ \ \ \mbox{\hyperlink{src_2main_8c_aee871967a1e47d3fca17a36cf48e6da6}{register\_subcommand}}(*c,\ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}close"{}},\ \mbox{\hyperlink{commands_8c_aabb06b0c16a19b4b22478cb753d8f599}{yh\_com\_close\_session}},\ \textcolor{stringliteral}{"{}e:session"{}},}
\DoxyCodeLine{00462\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},}
\DoxyCodeLine{00463\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Close\ a\ session\ with\ a\ connector"{}},\ NULL,}
\DoxyCodeLine{00464\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ NULL\});}
\DoxyCodeLine{00465\ \ \ \mbox{\hyperlink{src_2main_8c_aee871967a1e47d3fca17a36cf48e6da6}{register\_subcommand}}(*c,\ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}open"{}},\ \mbox{\hyperlink{commands_8c_a22f22a25151b12c7573f80563a341368}{yh\_com\_open\_session}},}
\DoxyCodeLine{00466\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}w:authkey,i:password=-\/"{}},\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708ad58942468b13601c21c14f2269dbca57}{fmt\_password}},}
\DoxyCodeLine{00467\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},}
\DoxyCodeLine{00468\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Open\ a\ session\ with\ a\ device\ using\ a\ "{}}}
\DoxyCodeLine{00469\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}specific\ Authentication\ Key"{}},}
\DoxyCodeLine{00470\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ NULL,\ NULL\});}
\DoxyCodeLine{00471\ \ \ *c\ =\ \mbox{\hyperlink{src_2main_8c_adf60c5d85f9b442e0c7a42235207a241}{register\_command}}(*c,\ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}sign"{}},\ \mbox{\hyperlink{commands_8c_a39d9fd4501c5547cb11e00a3ca37be7e}{yh\_com\_noop}},\ NULL,\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},}
\DoxyCodeLine{00472\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},\ \textcolor{stringliteral}{"{}Sign\ data"{}},\ NULL,\ NULL\});}
\DoxyCodeLine{00473\ \ \ \mbox{\hyperlink{src_2main_8c_aee871967a1e47d3fca17a36cf48e6da6}{register\_subcommand}}(}
\DoxyCodeLine{00474\ \ \ \ \ *c,\ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}ecdsa"{}},\ \mbox{\hyperlink{commands_8c_a982058963f9ff020c357030be09e79fc}{yh\_com\_sign\_ecdsa}},}
\DoxyCodeLine{00475\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}e:session,w:key\_id,a:algorithm,i:data=-\/,F:out=-\/"{}},\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a701725c70fb214e14a2feee390939a09}{fmt\_binary}},}
\DoxyCodeLine{00476\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708add674d756d2c6341a834a330a874b550}{fmt\_base64}},\ \textcolor{stringliteral}{"{}Sign\ data\ using\ ECDSA"{}},\ NULL,\ NULL\});}
\DoxyCodeLine{00477\ \ \ \mbox{\hyperlink{src_2main_8c_aee871967a1e47d3fca17a36cf48e6da6}{register\_subcommand}}(}
\DoxyCodeLine{00478\ \ \ \ \ *c,\ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}eddsa"{}},\ \mbox{\hyperlink{commands_8c_ac867ca0fc75e87da1a8d924fc587f5b9}{yh\_com\_sign\_eddsa}},}
\DoxyCodeLine{00479\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}e:session,w:key\_id,a:algorithm,i:data=-\/,F:out=-\/"{}},\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a701725c70fb214e14a2feee390939a09}{fmt\_binary}},}
\DoxyCodeLine{00480\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708add674d756d2c6341a834a330a874b550}{fmt\_base64}},\ \textcolor{stringliteral}{"{}Sign\ data\ using\ EDDSA"{}},\ NULL,\ NULL\});}
\DoxyCodeLine{00481\ \ \ \mbox{\hyperlink{src_2main_8c_aee871967a1e47d3fca17a36cf48e6da6}{register\_subcommand}}(}
\DoxyCodeLine{00482\ \ \ \ \ *c,\ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}pkcs1v1\_5"{}},\ \mbox{\hyperlink{commands_8c_a98cf5e35ce2e4fd5881d8b6e7a890357}{yh\_com\_sign\_pkcs1v1\_5}},}
\DoxyCodeLine{00483\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}e:session,w:key\_id,a:algorithm,i:data=-\/,F:out=-\/"{}},\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a701725c70fb214e14a2feee390939a09}{fmt\_binary}},}
\DoxyCodeLine{00484\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708add674d756d2c6341a834a330a874b550}{fmt\_base64}},\ \textcolor{stringliteral}{"{}Sign\ data\ using\ RSASSA-\/PKCS\#1v1.5"{}},\ NULL,\ NULL\});}
\DoxyCodeLine{00485\ \ \ \mbox{\hyperlink{src_2main_8c_aee871967a1e47d3fca17a36cf48e6da6}{register\_subcommand}}(}
\DoxyCodeLine{00486\ \ \ \ \ *c,\ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}pss"{}},\ \mbox{\hyperlink{commands_8c_a1dcbe3dfaa3722ae6e9246527b889627}{yh\_com\_sign\_pss}},}
\DoxyCodeLine{00487\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}e:session,w:key\_id,a:algorithm,i:data=-\/,F:out=-\/"{}},\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a701725c70fb214e14a2feee390939a09}{fmt\_binary}},}
\DoxyCodeLine{00488\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708add674d756d2c6341a834a330a874b550}{fmt\_base64}},\ \textcolor{stringliteral}{"{}Sign\ data\ using\ RSASSA-\/PSS"{}},\ NULL,\ NULL\});}
\DoxyCodeLine{00489\ \ \ *c\ =}
\DoxyCodeLine{00490\ \ \ \ \ \mbox{\hyperlink{src_2main_8c_adf60c5d85f9b442e0c7a42235207a241}{register\_command}}(*c,\ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}hmac"{}},\ \mbox{\hyperlink{commands_8c_a8de2999193b4caa2d0d1fd2e8451dba1}{yh\_com\_hmac}},}
\DoxyCodeLine{00491\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}e:session,w:key\_id,i:data=-\/,F:out=-\/"{}},}
\DoxyCodeLine{00492\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708acce29e9764c448874d69cb6c90b02401}{fmt\_hex}},\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708acce29e9764c448874d69cb6c90b02401}{fmt\_hex}},\ \textcolor{stringliteral}{"{}Hmac\ data"{}},\ NULL,\ NULL\});}
\DoxyCodeLine{00493\ \ \ *c\ =\ \mbox{\hyperlink{src_2main_8c_adf60c5d85f9b442e0c7a42235207a241}{register\_command}}(*c,}
\DoxyCodeLine{00494\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}reset"{}},\ \mbox{\hyperlink{commands_8c_a5947d870ac856de3880f8b80981e6355}{yh\_com\_reset}},\ \textcolor{stringliteral}{"{}e:session"{}},\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},}
\DoxyCodeLine{00495\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},\ \textcolor{stringliteral}{"{}Reset\ device"{}},\ NULL,\ NULL\});}
\DoxyCodeLine{00496\ \ \ *c\ =\ \mbox{\hyperlink{src_2main_8c_adf60c5d85f9b442e0c7a42235207a241}{register\_command}}(*c,\ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}delete"{}},\ \mbox{\hyperlink{commands_8c_ad490f0e89d33c1300a44bd095eb5562c}{yh\_com\_delete}},}
\DoxyCodeLine{00497\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}e:session,w:id,t:type"{}},\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},}
\DoxyCodeLine{00498\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},\ \textcolor{stringliteral}{"{}Delete\ data"{}},\ NULL,\ NULL\});}
\DoxyCodeLine{00499\ \ \ *c\ =}
\DoxyCodeLine{00500\ \ \ \ \ \mbox{\hyperlink{src_2main_8c_adf60c5d85f9b442e0c7a42235207a241}{register\_command}}(*c,\ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}certify"{}},\ \mbox{\hyperlink{commands_8c_a03581158b5703a0ffe866d50d8a3982d}{yh\_com\_sign\_ssh\_certificate}},}
\DoxyCodeLine{00501\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}e:session,w:key\_id,w:template\_id,a:"{}}}
\DoxyCodeLine{00502\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}algorithm,i:infile=-\/,F:outfile=-\/"{}},}
\DoxyCodeLine{00503\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a701725c70fb214e14a2feee390939a09}{fmt\_binary}},}
\DoxyCodeLine{00504\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a701725c70fb214e14a2feee390939a09}{fmt\_binary}},\ \textcolor{comment}{//\ TODO:\ correct\ default\ formats?}}
\DoxyCodeLine{00505\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Sign\ SSH\ certificates"{}},\ NULL,\ NULL\});}
\DoxyCodeLine{00506\ \ \ *c\ =}
\DoxyCodeLine{00507\ \ \ \ \ \mbox{\hyperlink{src_2main_8c_adf60c5d85f9b442e0c7a42235207a241}{register\_command}}(*c,}
\DoxyCodeLine{00508\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}benchmark"{}},\ \mbox{\hyperlink{commands_8c_ae2e50929acc6085cd395d0bd4ddb02db}{yh\_com\_benchmark}},}
\DoxyCodeLine{00509\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}e:session,u:count,w:key\_id=0,a:algorithm=any"{}},}
\DoxyCodeLine{00510\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},\ \textcolor{stringliteral}{"{}Run\ a\ set\ of\ benchmarks"{}},}
\DoxyCodeLine{00511\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ NULL,\ NULL\});}
\DoxyCodeLine{00512\ \ \ *c\ =\ \mbox{\hyperlink{src_2main_8c_adf60c5d85f9b442e0c7a42235207a241}{register\_command}}(*c,\ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}otp"{}},\ \mbox{\hyperlink{commands_8c_a39d9fd4501c5547cb11e00a3ca37be7e}{yh\_com\_noop}},\ NULL,\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},}
\DoxyCodeLine{00513\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},\ \textcolor{stringliteral}{"{}OTP\ commands"{}},\ NULL,\ NULL\});}
\DoxyCodeLine{00514\ \ \ \mbox{\hyperlink{src_2main_8c_aee871967a1e47d3fca17a36cf48e6da6}{register\_subcommand}}(*c,}
\DoxyCodeLine{00515\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}aead\_create"{}},\ \mbox{\hyperlink{commands_8c_ae716e54fae7ba83cb44fe966fbcad9cb}{yh\_com\_otp\_aead\_create}},}
\DoxyCodeLine{00516\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}e:session,w:key\_id,i:key,i:private\_id,F:aead"{}},}
\DoxyCodeLine{00517\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708acce29e9764c448874d69cb6c90b02401}{fmt\_hex}},\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a701725c70fb214e14a2feee390939a09}{fmt\_binary}},\ \textcolor{stringliteral}{"{}Create\ an\ OTP\ AEAD"{}},\ NULL,}
\DoxyCodeLine{00518\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ NULL\});}
\DoxyCodeLine{00519\ \ \ \mbox{\hyperlink{src_2main_8c_aee871967a1e47d3fca17a36cf48e6da6}{register\_subcommand}}(*c,\ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}aead\_random"{}},\ \mbox{\hyperlink{commands_8c_a533707756dfe3a35c9aadf4d288b73d4}{yh\_com\_otp\_aead\_random}},}
\DoxyCodeLine{00520\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}e:session,w:key\_id,F:aead"{}},\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},}
\DoxyCodeLine{00521\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a701725c70fb214e14a2feee390939a09}{fmt\_binary}},\ \textcolor{stringliteral}{"{}Create\ a\ random\ OTP\ AEAD"{}},}
\DoxyCodeLine{00522\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ NULL,\ NULL\});}
\DoxyCodeLine{00523\ \ \ \mbox{\hyperlink{src_2main_8c_aee871967a1e47d3fca17a36cf48e6da6}{register\_subcommand}}(*c,\ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}decrypt"{}},\ \mbox{\hyperlink{commands_8c_ad676312a3ed43f6a3ece63851780aeff}{yh\_com\_otp\_decrypt}},}
\DoxyCodeLine{00524\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}e:session,w:key\_id,s:otp,i:aead"{}},}
\DoxyCodeLine{00525\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a701725c70fb214e14a2feee390939a09}{fmt\_binary}},\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},}
\DoxyCodeLine{00526\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Decrypt\ an\ OTP\ with\ AEAD"{}},\ NULL,\ NULL\});}
\DoxyCodeLine{00527\ \ \ *c\ =\ \mbox{\hyperlink{src_2main_8c_adf60c5d85f9b442e0c7a42235207a241}{register\_command}}(*c,\ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}attest"{}},\ \mbox{\hyperlink{commands_8c_a39d9fd4501c5547cb11e00a3ca37be7e}{yh\_com\_noop}},\ NULL,\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},}
\DoxyCodeLine{00528\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},\ \textcolor{stringliteral}{"{}Attest\ device\ objects"{}},\ NULL,}
\DoxyCodeLine{00529\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ NULL\});}
\DoxyCodeLine{00530\ \ \ \mbox{\hyperlink{src_2main_8c_aee871967a1e47d3fca17a36cf48e6da6}{register\_subcommand}}(*c,}
\DoxyCodeLine{00531\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}asymmetric"{}},}
\DoxyCodeLine{00532\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{commands_8c_af224308de5cdf8e20cbbdcaa6cf7598c}{yh\_com\_sign\_attestation\_certificate}},}
\DoxyCodeLine{00533\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}e:session,w:key\_id,w:attest\_id=0"{}},\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},}
\DoxyCodeLine{00534\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708aa8908f2c651567ae288c587240e71d3e}{fmt\_PEM}},\ \textcolor{stringliteral}{"{}Sign\ attestation\ certificate"{}},\ NULL,}
\DoxyCodeLine{00535\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ NULL\});}
\DoxyCodeLine{00536\ \ \ *c\ =\ \mbox{\hyperlink{src_2main_8c_adf60c5d85f9b442e0c7a42235207a241}{register\_command}}(*c,\ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}keepalive"{}},\ \mbox{\hyperlink{commands_8c_a39d9fd4501c5547cb11e00a3ca37be7e}{yh\_com\_noop}},\ NULL,\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},}
\DoxyCodeLine{00537\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},\ \textcolor{stringliteral}{"{}Change\ keepalive\ settings"{}},}
\DoxyCodeLine{00538\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ NULL,\ NULL\});}
\DoxyCodeLine{00539\ }
\DoxyCodeLine{00540\ \ \ \mbox{\hyperlink{src_2main_8c_aee871967a1e47d3fca17a36cf48e6da6}{register\_subcommand}}(*c,\ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}on"{}},\ \mbox{\hyperlink{src_2main_8c_a5530032f495d88f8b95a38f8fcd50da8}{yh\_com\_keepalive\_on}},\ NULL,\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},}
\DoxyCodeLine{00541\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},\ \textcolor{stringliteral}{"{}Enable\ keepalive"{}},\ NULL,\ NULL\});}
\DoxyCodeLine{00542\ \ \ \mbox{\hyperlink{src_2main_8c_aee871967a1e47d3fca17a36cf48e6da6}{register\_subcommand}}(*c,}
\DoxyCodeLine{00543\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}off"{}},\ \mbox{\hyperlink{src_2main_8c_a934ab7f3227caf21c22153c3981f8d41}{yh\_com\_keepalive\_off}},\ NULL,\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},}
\DoxyCodeLine{00544\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},\ \textcolor{stringliteral}{"{}Disable\ keepalive"{}},\ NULL,\ NULL\});}
\DoxyCodeLine{00545\ }
\DoxyCodeLine{00546\ \ \ *c\ =}
\DoxyCodeLine{00547\ \ \ \ \ \mbox{\hyperlink{src_2main_8c_adf60c5d85f9b442e0c7a42235207a241}{register\_command}}(*c,\ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}set"{}},\ \mbox{\hyperlink{commands_8c_a39d9fd4501c5547cb11e00a3ca37be7e}{yh\_com\_noop}},\ NULL,\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},}
\DoxyCodeLine{00548\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},\ \textcolor{stringliteral}{"{}Set\ preferences"{}},\ NULL,\ NULL\});}
\DoxyCodeLine{00549\ }
\DoxyCodeLine{00550\ \ \ \mbox{\hyperlink{src_2main_8c_aee871967a1e47d3fca17a36cf48e6da6}{register\_subcommand}}(*c,\ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}informat"{}},\ \mbox{\hyperlink{src_2main_8c_ab7843da8250a79bc61b9cb1439558842}{yh\_com\_set\_informat}},\ \textcolor{stringliteral}{"{}I:format"{}},}
\DoxyCodeLine{00551\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},\ \textcolor{stringliteral}{"{}Set\ input\ format"{}},}
\DoxyCodeLine{00552\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ NULL,\ NULL\});}
\DoxyCodeLine{00553\ \ \ \mbox{\hyperlink{src_2main_8c_aee871967a1e47d3fca17a36cf48e6da6}{register\_subcommand}}(*c,\ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}outformat"{}},\ \mbox{\hyperlink{src_2main_8c_a6d565f5c80947a15c3210e48a20e8836}{yh\_com\_set\_outformat}},}
\DoxyCodeLine{00554\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}I:format"{}},\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},}
\DoxyCodeLine{00555\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Set\ output\ format"{}},\ NULL,\ NULL\});}
\DoxyCodeLine{00556\ \ \ \mbox{\hyperlink{src_2main_8c_aee871967a1e47d3fca17a36cf48e6da6}{register\_subcommand}}(*c,\ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}cacert"{}},\ \mbox{\hyperlink{commands_8c_ada05a561c71aebab8f0a53c0d552e027}{yh\_com\_set\_cacert}},\ \textcolor{stringliteral}{"{}s:file"{}},}
\DoxyCodeLine{00557\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},}
\DoxyCodeLine{00558\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Set\ CA\ cert\ to\ use\ for\ https\ to\ connector"{}},}
\DoxyCodeLine{00559\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ NULL,\ NULL\});}
\DoxyCodeLine{00560\ \ \ \mbox{\hyperlink{src_2main_8c_aee871967a1e47d3fca17a36cf48e6da6}{register\_subcommand}}(*c,\ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}proxy"{}},\ \mbox{\hyperlink{commands_8c_a264ec5c469bd0517814525ef59c8e69e}{yh\_com\_set\_proxy}},\ \textcolor{stringliteral}{"{}s:proxy"{}},}
\DoxyCodeLine{00561\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},}
\DoxyCodeLine{00562\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Set\ proxyserver\ to\ use\ for\ connector"{}},}
\DoxyCodeLine{00563\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ NULL,\ NULL\});}
\DoxyCodeLine{00564\ \ \ *c\ =}
\DoxyCodeLine{00565\ \ \ \ \ \mbox{\hyperlink{src_2main_8c_adf60c5d85f9b442e0c7a42235207a241}{register\_command}}(*c,\ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}blink"{}},\ \mbox{\hyperlink{commands_8c_a1d821476693df49671598a98e7d6dbca}{yh\_com\_blink}},}
\DoxyCodeLine{00566\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}e:session,b:seconds=10"{}},\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},}
\DoxyCodeLine{00567\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},\ \textcolor{stringliteral}{"{}Blink\ the\ device"{}},\ NULL,\ NULL\});}
\DoxyCodeLine{00568\ }
\DoxyCodeLine{00569\ \ \ *c\ =\ \mbox{\hyperlink{src_2main_8c_adf60c5d85f9b442e0c7a42235207a241}{register\_command}}(*c,\ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}change"{}},\ \mbox{\hyperlink{commands_8c_a39d9fd4501c5547cb11e00a3ca37be7e}{yh\_com\_noop}},\ NULL,\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},}
\DoxyCodeLine{00570\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},\ \textcolor{stringliteral}{"{}Change\ objects"{}},\ NULL,\ NULL\});}
\DoxyCodeLine{00571\ }
\DoxyCodeLine{00572\ \ \ \mbox{\hyperlink{src_2main_8c_aee871967a1e47d3fca17a36cf48e6da6}{register\_subcommand}}(*c,}
\DoxyCodeLine{00573\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\mbox{\hyperlink{struct_command}{Command}})\{\textcolor{stringliteral}{"{}authkey"{}},\ \mbox{\hyperlink{commands_8c_a0691ab03bd0e40402b2ad5f9a378a541}{yh\_com\_change\_authentication\_key}},}
\DoxyCodeLine{00574\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}e:session,w:key\_id,i:password=-\/"{}},\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708ad58942468b13601c21c14f2269dbca57}{fmt\_password}},}
\DoxyCodeLine{00575\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}},\ \textcolor{stringliteral}{"{}Change\ an\ authentication\ key"{}},\ NULL,}
\DoxyCodeLine{00576\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ NULL\});}
\DoxyCodeLine{00577\ }
\DoxyCodeLine{00578\ \ \ *c\ =\ \mbox{\hyperlink{src_2main_8c_a00235bf23b429c75a52c7996e53e590d}{msort\_list}}(*c);}
\DoxyCodeLine{00579\ }
\DoxyCodeLine{00580\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{struct_command}{Command}}\ *t\ =\ *c;\ t\ !=\ NULL;\ t\ =\ t-\/>\mbox{\hyperlink{struct_command_af9c9ea6f57adad15eb7af71d6834d0b4}{next}})\ \{}
\DoxyCodeLine{00581\ \ \ \ \ \textcolor{keywordflow}{if}\ (t-\/>subcommands\ !=\ NULL)\ \{}
\DoxyCodeLine{00582\ \ \ \ \ \ \ t-\/>subcommands\ =\ \mbox{\hyperlink{src_2main_8c_a00235bf23b429c75a52c7996e53e590d}{msort\_list}}(t-\/>subcommands);}
\DoxyCodeLine{00583\ \ \ \ \ \}}
\DoxyCodeLine{00584\ \ \ \}}
\DoxyCodeLine{00585\ \}}

\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=262pt]{src_2main_8c_a34a9e8c400dcf19e771e884636316060_icgraph}
\end{center}
\end{figure}
\Hypertarget{src_2main_8c_af1203fbe672161a7e1185578d249959a}\index{main.c@{main.c}!find\_lcp@{find\_lcp}}
\index{find\_lcp@{find\_lcp}!main.c@{main.c}}
\doxysubsubsection{\texorpdfstring{find\_lcp()}{find\_lcp()}}
{\footnotesize\ttfamily \label{src_2main_8c_af1203fbe672161a7e1185578d249959a} 
void find\+\_\+lcp (\begin{DoxyParamCaption}\item[{const char \texorpdfstring{$\ast$}{*}}]{items}{\mbox{[}$\,$\mbox{]}, }\item[{int}]{n\+\_\+items}{, }\item[{const char \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}}]{lcp}{, }\item[{int \texorpdfstring{$\ast$}{*}}]{lcp\+\_\+len}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{src_2main_8c_source_l00820}{820}} of file \mbox{\hyperlink{src_2main_8c_source}{main.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00821\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00822\ }
\DoxyCodeLine{00823\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{namespacefc_aa3ea11c18de71ec23b19c3cc571fb8ff}{min}}\ =\ 0;}
\DoxyCodeLine{00824\ \ \ \textcolor{keywordtype}{int}\ max\ =\ 0;}
\DoxyCodeLine{00825\ }
\DoxyCodeLine{00826\ \ \ \textcolor{keywordflow}{if}\ (items\ ==\ NULL\ ||\ n\_items\ ==\ 0)\ \{}
\DoxyCodeLine{00827\ \ \ \ \ *lcp\ =\ NULL;}
\DoxyCodeLine{00828\ \ \ \ \ *lcp\_len\ =\ 0;}
\DoxyCodeLine{00829\ \ \ \}}
\DoxyCodeLine{00830\ }
\DoxyCodeLine{00831\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 1;\ i\ <\ n\_items;\ i++)\ \{}
\DoxyCodeLine{00832\ \ \ \ \ \textcolor{keywordflow}{if}\ (strcmp(items[i],\ items[min])\ <\ 0)\ \{}
\DoxyCodeLine{00833\ \ \ \ \ \ \ \mbox{\hyperlink{namespacefc_aa3ea11c18de71ec23b19c3cc571fb8ff}{min}}\ =\ i;}
\DoxyCodeLine{00834\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (strcmp(items[i],\ items[max])\ >\ 0)\ \{}
\DoxyCodeLine{00835\ \ \ \ \ \ \ max\ =\ i;}
\DoxyCodeLine{00836\ \ \ \ \ \}}
\DoxyCodeLine{00837\ \ \ \}}
\DoxyCodeLine{00838\ }
\DoxyCodeLine{00839\ \ \ *lcp\ =\ items[\mbox{\hyperlink{namespacefc_aa3ea11c18de71ec23b19c3cc571fb8ff}{min}}];}
\DoxyCodeLine{00840\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ strlen(items[min])\ \&\&\ i\ <\ strlen(items[max]);}
\DoxyCodeLine{00841\ \ \ \ \ \ \ \ i++)\ \{}
\DoxyCodeLine{00842\ \ \ \ \ \textcolor{keywordflow}{if}\ (items[min][i]\ !=\ items[max][i])\ \{}
\DoxyCodeLine{00843\ \ \ \ \ \ \ *lcp\_len\ =\ i;}
\DoxyCodeLine{00844\ }
\DoxyCodeLine{00845\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00846\ \ \ \ \ \}}
\DoxyCodeLine{00847\ \ \ \}}
\DoxyCodeLine{00848\ }
\DoxyCodeLine{00849\ \ \ *lcp\_len\ =\ strlen(items[min]);}
\DoxyCodeLine{00850\ \}}

\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{src_2main_8c_af1203fbe672161a7e1185578d249959a_icgraph}
\end{center}
\end{figure}
\Hypertarget{src_2main_8c_a0ddf1224851353fc92bfbff6f499fa97}\index{main.c@{main.c}!main@{main}}
\index{main@{main}!main.c@{main.c}}
\doxysubsubsection{\texorpdfstring{main()}{main()}}
{\footnotesize\ttfamily \label{src_2main_8c_a0ddf1224851353fc92bfbff6f499fa97} 
int main (\begin{DoxyParamCaption}\item[{int}]{argc}{, }\item[{char \texorpdfstring{$\ast$}{*}}]{argv}{\mbox{[}$\,$\mbox{]}}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{src_2main_8c_source_l01699}{1699}} of file \mbox{\hyperlink{src_2main_8c_source}{main.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01699\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01700\ }
\DoxyCodeLine{01701\ \ \ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366}{yh\_rc}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}};}
\DoxyCodeLine{01702\ \ \ \textcolor{keywordtype}{int}\ comrc;}
\DoxyCodeLine{01703\ }
\DoxyCodeLine{01704\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a97917e1d5a9fa5e8b7a4495dc9234ac7}{rc}}\ =\ EXIT\_SUCCESS;}
\DoxyCodeLine{01705\ }
\DoxyCodeLine{01706\ \ \ \textcolor{keyword}{struct\ }gengetopt\_args\_info\ args\_info;}
\DoxyCodeLine{01707\ }
\DoxyCodeLine{01708\ \ \ \textcolor{keyword}{struct\ }stat\ sb;}
\DoxyCodeLine{01709\ \ \ \textcolor{keyword}{struct\ }cmdline\_parser\_params\ \mbox{\hyperlink{test__account__query__db_8cpp_aedc91aab307c8fb7ad822c3e16a6dd73}{params}};}
\DoxyCodeLine{01710\ }
\DoxyCodeLine{01711\ \ \ ctx.\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}}\ =\ stdout;}
\DoxyCodeLine{01712\ }
\DoxyCodeLine{01713\ \ \ cmdline\_parser\_params\_init(\&\mbox{\hyperlink{test__account__query__db_8cpp_aedc91aab307c8fb7ad822c3e16a6dd73}{params}});}
\DoxyCodeLine{01714\ \ \ \mbox{\hyperlink{test__account__query__db_8cpp_aedc91aab307c8fb7ad822c3e16a6dd73}{params}}.initialize\ =\ 1;}
\DoxyCodeLine{01715\ \ \ \mbox{\hyperlink{test__account__query__db_8cpp_aedc91aab307c8fb7ad822c3e16a6dd73}{params}}.check\_required\ =\ 0;}
\DoxyCodeLine{01716\ }
\DoxyCodeLine{01717\ \ \ \textcolor{keywordflow}{if}\ (cmdline\_parser(argc,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}},\ \&args\_info)\ !=\ 0)\ \{}
\DoxyCodeLine{01718\ \ \ \ \ \textcolor{keywordflow}{return}\ EXIT\_FAILURE;}
\DoxyCodeLine{01719\ \ \ \}}
\DoxyCodeLine{01720\ }
\DoxyCodeLine{01721\ \ \ \textcolor{keywordflow}{if}\ (stat(args\_info.config\_file\_arg,\ \&sb)\ ==\ 0)\ \{}
\DoxyCodeLine{01722\ \ \ \ \ \textcolor{keywordflow}{if}\ (S\_ISREG(sb.st\_mode)\ ||\ S\_ISLNK(sb.st\_mode))\ \{}
\DoxyCodeLine{01723\ \ \ \ \ \ \ \mbox{\hyperlink{test__account__query__db_8cpp_aedc91aab307c8fb7ad822c3e16a6dd73}{params}}.initialize\ =\ 0;}
\DoxyCodeLine{01724\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (cmdline\_parser\_config\_file(args\_info.config\_file\_arg,\ \&args\_info,}
\DoxyCodeLine{01725\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\mbox{\hyperlink{test__account__query__db_8cpp_aedc91aab307c8fb7ad822c3e16a6dd73}{params}})\ !=\ 0)\ \{}
\DoxyCodeLine{01726\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ EXIT\_FAILURE;}
\DoxyCodeLine{01727\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01728\ \ \ \ \ \}}
\DoxyCodeLine{01729\ \ \ \}}
\DoxyCodeLine{01730\ }
\DoxyCodeLine{01731\ \ \ \textcolor{keywordflow}{if}\ (cmdline\_parser\_required(\&args\_info,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0])\ !=\ 0)\ \{}
\DoxyCodeLine{01732\ \ \ \ \ \textcolor{keywordflow}{return}\ EXIT\_FAILURE;}
\DoxyCodeLine{01733\ \ \ \}}
\DoxyCodeLine{01734\ }
\DoxyCodeLine{01735\ \ \ \textcolor{keywordflow}{if}\ (parse\_configured\_connectors(\&ctx,\ args\_info.connector\_arg,}
\DoxyCodeLine{01736\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ args\_info.connector\_given)\ ==\ -\/1)\ \{}
\DoxyCodeLine{01737\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Unable\ to\ parse\ connector\ list"{}});}
\DoxyCodeLine{01738\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a97917e1d5a9fa5e8b7a4495dc9234ac7}{rc}}\ =\ EXIT\_FAILURE;}
\DoxyCodeLine{01739\ \ \ \ \ \textcolor{keywordflow}{goto}\ main\_exit;}
\DoxyCodeLine{01740\ \ \ \}}
\DoxyCodeLine{01741\ }
\DoxyCodeLine{01742\ \ \ \textcolor{keywordflow}{if}\ (getenv(\textcolor{stringliteral}{"{}DEBUG"{}})\ !=\ NULL)\ \{}
\DoxyCodeLine{01743\ \ \ \ \ args\_info.verbose\_arg\ =\ \mbox{\hyperlink{yubihsm_8h_a15dbe0ac973691939ca6e9148b181ccd}{YH\_VERB\_ALL}};}
\DoxyCodeLine{01744\ \ \ \}}
\DoxyCodeLine{01745\ \ \ \mbox{\hyperlink{yubihsm_8c_a24c3146e51242256af505961e763f417}{yh\_set\_verbosity}}(ctx.\mbox{\hyperlink{structyubihsm__context_a8c52c1a89cd4334a0225a1fbfba9a930}{connector}},\ args\_info.verbose\_arg);}
\DoxyCodeLine{01746\ }
\DoxyCodeLine{01747\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a5392844a98c6220c69fe08d3dcf8f1bc}{yh\_init}}();}
\DoxyCodeLine{01748\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{01749\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ initialize\ libyubihsm\(\backslash\)n"{}});}
\DoxyCodeLine{01750\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a97917e1d5a9fa5e8b7a4495dc9234ac7}{rc}}\ =\ EXIT\_FAILURE;}
\DoxyCodeLine{01751\ \ \ \ \ \textcolor{keywordflow}{goto}\ main\_exit;}
\DoxyCodeLine{01752\ \ \ \}}
\DoxyCodeLine{01753\ }
\DoxyCodeLine{01754\ \textcolor{preprocessor}{\#ifdef\ USE\_YKYH}}
\DoxyCodeLine{01755\ \ \ \mbox{\hyperlink{ykyh_8h_a93aafaa60a79c75641302448631ea112}{ykyh\_rc}}\ ykyhrc;}
\DoxyCodeLine{01756\ \ \ ykyhrc\ =\ \mbox{\hyperlink{ykyh_8c_aaf8c4d6e022e4363c006d9066991776b}{ykyh\_init}}(\&ctx.\mbox{\hyperlink{structyubihsm__context_a2477a831d6082f899d49df85611e6e52}{state}},\ 1);\ \textcolor{comment}{//\ TODO(adma):\ do\ something\ about\ verbosity}}
\DoxyCodeLine{01757\ \ \ \textcolor{keywordflow}{if}\ (ykyhrc\ !=\ \mbox{\hyperlink{ykyh_8h_a93aafaa60a79c75641302448631ea112a40500f2b4bd15d31f1348475e35f2459}{YKYHR\_SUCCESS}})\ \{}
\DoxyCodeLine{01758\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ initialize\ libykyh\(\backslash\)n"{}});}
\DoxyCodeLine{01759\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a97917e1d5a9fa5e8b7a4495dc9234ac7}{rc}}\ =\ EXIT\_FAILURE;}
\DoxyCodeLine{01760\ \ \ \ \ \textcolor{keywordflow}{goto}\ main\_exit;}
\DoxyCodeLine{01761\ \ \ \}}
\DoxyCodeLine{01762\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01763\ }
\DoxyCodeLine{01764\ \ \ \textcolor{keywordflow}{if}\ (ctx.\mbox{\hyperlink{structyubihsm__context_a260f9000b86a557d5d758d498f8e0f51}{n\_connectors}}\ ==\ 0)\ \{}
\DoxyCodeLine{01765\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Using\ default\ connector\ URL:\ \%s\(\backslash\)n"{}},\ \mbox{\hyperlink{src_2main_8c_aba7329f0650bdd9406cf710150dc6ac7}{LOCAL\_CONNECTOR\_URL}});}
\DoxyCodeLine{01766\ }
\DoxyCodeLine{01767\ \ \ \ \ ctx.\mbox{\hyperlink{structyubihsm__context_ae6f60d6cb3833712a87ecdb42088ccc1}{connector\_list}}\ =\ calloc(1,\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{char}\ *));}
\DoxyCodeLine{01768\ \ \ \ \ \textcolor{keywordflow}{if}\ (ctx.\mbox{\hyperlink{structyubihsm__context_ae6f60d6cb3833712a87ecdb42088ccc1}{connector\_list}}\ ==\ NULL)\ \{}
\DoxyCodeLine{01769\ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ allocate\ memory\(\backslash\)n"{}});}
\DoxyCodeLine{01770\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a97917e1d5a9fa5e8b7a4495dc9234ac7}{rc}}\ =\ EXIT\_FAILURE;}
\DoxyCodeLine{01771\ \ \ \ \ \ \ \textcolor{keywordflow}{goto}\ main\_exit;}
\DoxyCodeLine{01772\ \ \ \ \ \}}
\DoxyCodeLine{01773\ }
\DoxyCodeLine{01774\ \ \ \ \ ctx.\mbox{\hyperlink{structyubihsm__context_ae6f60d6cb3833712a87ecdb42088ccc1}{connector\_list}}[0]\ =\ strdup(\mbox{\hyperlink{src_2main_8c_aba7329f0650bdd9406cf710150dc6ac7}{LOCAL\_CONNECTOR\_URL}});}
\DoxyCodeLine{01775\ \ \ \ \ \textcolor{keywordflow}{if}\ (ctx.\mbox{\hyperlink{structyubihsm__context_ae6f60d6cb3833712a87ecdb42088ccc1}{connector\_list}}[0]\ ==\ NULL)\ \{}
\DoxyCodeLine{01776\ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ allocate\ memory\(\backslash\)n"{}});}
\DoxyCodeLine{01777\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a97917e1d5a9fa5e8b7a4495dc9234ac7}{rc}}\ =\ EXIT\_FAILURE;}
\DoxyCodeLine{01778\ \ \ \ \ \ \ \textcolor{keywordflow}{goto}\ main\_exit;}
\DoxyCodeLine{01779\ \ \ \ \ \}}
\DoxyCodeLine{01780\ }
\DoxyCodeLine{01781\ \ \ \ \ ctx.\mbox{\hyperlink{structyubihsm__context_a260f9000b86a557d5d758d498f8e0f51}{n\_connectors}}\ =\ 1;}
\DoxyCodeLine{01782\ \ \ \}}
\DoxyCodeLine{01783\ }
\DoxyCodeLine{01784\ \ \ \textcolor{keywordflow}{if}\ (args\_info.cacert\_given)\ \{}
\DoxyCodeLine{01785\ \ \ \ \ ctx.\mbox{\hyperlink{structyubihsm__context_a97d98362b0e43b749a9cb75da4793932}{cacert}}\ =\ strdup(args\_info.cacert\_arg);}
\DoxyCodeLine{01786\ \ \ \}}
\DoxyCodeLine{01787\ \ \ \textcolor{keywordflow}{if}\ (args\_info.proxy\_given)\ \{}
\DoxyCodeLine{01788\ \ \ \ \ ctx.\mbox{\hyperlink{structyubihsm__context_aa2578fc399603af54de958824179cae4}{proxy}}\ =\ strdup(args\_info.proxy\_arg);}
\DoxyCodeLine{01789\ \ \ \}}
\DoxyCodeLine{01790\ }
\DoxyCodeLine{01791\ \textcolor{preprocessor}{\#ifndef\ \_\_WIN32}}
\DoxyCodeLine{01792\ \ \ \textcolor{keyword}{struct\ }sigaction\ act;}
\DoxyCodeLine{01793\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_adc4bd59a60361844aa0e852efa210105}{memset}}(\&act,\ 0,\ \textcolor{keyword}{sizeof}(act));}
\DoxyCodeLine{01794\ \ \ act.sa\_handler\ =\ \mbox{\hyperlink{namespacewebsocketpp_1_1transport_a946cc56ff41139f3002149c15fd87bc9}{timer\_handler}};}
\DoxyCodeLine{01795\ \ \ act.sa\_flags\ =\ SA\_RESTART;}
\DoxyCodeLine{01796\ \ \ sigaction(SIGALRM,\ \&act,\ NULL);}
\DoxyCodeLine{01797\ }
\DoxyCodeLine{01798\ \ \ sigset\_t\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a893468abdce45d586a5b659094a25e6c}{set}};}
\DoxyCodeLine{01799\ \ \ sigemptyset(\&set);}
\DoxyCodeLine{01800\ \ \ sigaddset(\&set,\ SIGALRM);}
\DoxyCodeLine{01801\ \ \ sigprocmask(SIG\_UNBLOCK,\ \&set,\ NULL);}
\DoxyCodeLine{01802\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01803\ }
\DoxyCodeLine{01804\ \ \ \textcolor{keywordflow}{if}\ (args\_info.action\_given)\ \{}
\DoxyCodeLine{01805\ \ \ \ \ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a855e99b645b13e7905d074d02fe0bff5}{buf}}[4096]\ =\ \{0\};}
\DoxyCodeLine{01806\ }
\DoxyCodeLine{01807\ \ \ \ \ ctx.\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}}\ =\ open\_file(args\_info.out\_arg,\ \textcolor{keyword}{false});}
\DoxyCodeLine{01808\ \ \ \ \ \textcolor{keywordflow}{if}\ (ctx.\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}}\ ==\ NULL)\ \{}
\DoxyCodeLine{01809\ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Unable\ to\ open\ output\ file\ \%s\(\backslash\)n"{}},\ args\_info.out\_arg);}
\DoxyCodeLine{01810\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a97917e1d5a9fa5e8b7a4495dc9234ac7}{rc}}\ =\ EXIT\_FAILURE;}
\DoxyCodeLine{01811\ \ \ \ \ \ \ \textcolor{keywordflow}{goto}\ main\_exit;}
\DoxyCodeLine{01812\ \ \ \ \ \}}
\DoxyCodeLine{01813\ }
\DoxyCodeLine{01814\ \ \ \ \ \mbox{\hyperlink{commands_8c_a9155cc4306ad97e58a03ead18637f33b}{yh\_com\_connect}}(\&ctx,\ NULL,\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}});}
\DoxyCodeLine{01815\ }
\DoxyCodeLine{01816\ \ \ \ \ \textcolor{keywordtype}{bool}\ requires\_session\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01817\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ i\ =\ 0;\ i\ <\ args\_info.action\_given;\ i++)\ \{}
\DoxyCodeLine{01818\ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (args\_info.action\_arg[i])\ \{}
\DoxyCodeLine{01819\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ action\_arg\_getMINUS\_deviceMINUS\_info:}
\DoxyCodeLine{01820\ \ \ \ \ \ \ \ \ \ \ requires\_session\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01821\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01822\ }
\DoxyCodeLine{01823\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{01824\ \ \ \ \ \ \ \ \ \ \ requires\_session\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01825\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01826\ }
\DoxyCodeLine{01827\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (requires\_session\ ==\ \textcolor{keyword}{true})\ \{}
\DoxyCodeLine{01828\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01829\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01830\ \ \ \ \ \}}
\DoxyCodeLine{01831\ }
\DoxyCodeLine{01832\ \ \ \ \ \mbox{\hyperlink{struct_argument}{Argument}}\ arg[7];}
\DoxyCodeLine{01833\ }
\DoxyCodeLine{01834\ \ \ \ \ \textcolor{keywordflow}{if}\ (requires\_session\ ==\ \textcolor{keyword}{true})\ \{}
\DoxyCodeLine{01835\ \ \ \ \ \ \ arg[0].\mbox{\hyperlink{struct_argument_aeb48fdf58cd895afedcbf817845d2a77}{w}}\ =\ args\_info.authkey\_arg;}
\DoxyCodeLine{01836\ \ \ \ \ \ \ arg[1].\mbox{\hyperlink{struct_argument_a988ffa3a53329017f0fdc315cc61dc49}{x}}\ =\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a855e99b645b13e7905d074d02fe0bff5}{buf}};}
\DoxyCodeLine{01837\ \ \ \ \ \ \ arg[1].\mbox{\hyperlink{struct_argument_ac33038cf0ca57abb4caed3dbdf4b9e86}{len}}\ =\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a855e99b645b13e7905d074d02fe0bff5}{buf}});}
\DoxyCodeLine{01838\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (get\_input\_data(args\_info.password\_given\ ?\ args\_info.password\_arg\ :\ \textcolor{stringliteral}{"{}-\/"{}},}
\DoxyCodeLine{01839\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ arg[1].x,\ \&arg[1].len,\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708ad58942468b13601c21c14f2269dbca57}{fmt\_password}})\ ==\ \textcolor{keyword}{false})\ \{}
\DoxyCodeLine{01840\ \ \ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ get\ password\(\backslash\)n"{}});}
\DoxyCodeLine{01841\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a97917e1d5a9fa5e8b7a4495dc9234ac7}{rc}}\ =\ EXIT\_FAILURE;}
\DoxyCodeLine{01842\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{goto}\ main\_exit;}
\DoxyCodeLine{01843\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01844\ }
\DoxyCodeLine{01845\ \ \ \ \ \ \ comrc\ =\ \mbox{\hyperlink{commands_8c_a22f22a25151b12c7573f80563a341368}{yh\_com\_open\_session}}(\&ctx,\ arg,\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}});}
\DoxyCodeLine{01846\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (comrc\ !=\ 0)\ \{}
\DoxyCodeLine{01847\ \ \ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ open\ session\(\backslash\)n"{}});}
\DoxyCodeLine{01848\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a97917e1d5a9fa5e8b7a4495dc9234ac7}{rc}}\ =\ EXIT\_FAILURE;}
\DoxyCodeLine{01849\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{goto}\ main\_exit;}
\DoxyCodeLine{01850\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01851\ \ \ \ \ \}}
\DoxyCodeLine{01852\ }
\DoxyCodeLine{01853\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{yubihsm_8h_add4e5963a36bd6c9b06c717d705f4c2f}{YH\_MAX\_SESSIONS}};\ i++)\ \{}
\DoxyCodeLine{01854\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (ctx.\mbox{\hyperlink{structyubihsm__context_a7a959752fa285fb4a7a75921bbfa00fe}{sessions}}[i]\ !=\ NULL)\ \{}
\DoxyCodeLine{01855\ \ \ \ \ \ \ \ \ arg[0].\mbox{\hyperlink{struct_argument_af3cc3b22da3a07b8f6854d9745d6db55}{e}}\ =\ ctx.\mbox{\hyperlink{structyubihsm__context_a7a959752fa285fb4a7a75921bbfa00fe}{sessions}}[i];}
\DoxyCodeLine{01856\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01857\ \ \ \ \ \}}
\DoxyCodeLine{01858\ }
\DoxyCodeLine{01859\ \ \ \ \ \textcolor{keywordflow}{switch}\ (args\_info.informat\_arg)\ \{}
\DoxyCodeLine{01860\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ informat\_arg\_base64:}
\DoxyCodeLine{01861\ \ \ \ \ \ \ \ \ ctx.\mbox{\hyperlink{structyubihsm__context_a44a581dfcadf23981c3b9b7af51711a0}{in\_fmt}}\ =\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708add674d756d2c6341a834a330a874b550}{fmt\_base64}};}
\DoxyCodeLine{01862\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01863\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ informat\_arg\_binary:}
\DoxyCodeLine{01864\ \ \ \ \ \ \ \ \ ctx.\mbox{\hyperlink{structyubihsm__context_a44a581dfcadf23981c3b9b7af51711a0}{in\_fmt}}\ =\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a701725c70fb214e14a2feee390939a09}{fmt\_binary}};}
\DoxyCodeLine{01865\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01866\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ informat\_arg\_PEM:}
\DoxyCodeLine{01867\ \ \ \ \ \ \ \ \ ctx.\mbox{\hyperlink{structyubihsm__context_a44a581dfcadf23981c3b9b7af51711a0}{in\_fmt}}\ =\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708aa8908f2c651567ae288c587240e71d3e}{fmt\_PEM}};}
\DoxyCodeLine{01868\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01869\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ informat\_arg\_password:}
\DoxyCodeLine{01870\ \ \ \ \ \ \ \ \ ctx.\mbox{\hyperlink{structyubihsm__context_a44a581dfcadf23981c3b9b7af51711a0}{in\_fmt}}\ =\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708ad58942468b13601c21c14f2269dbca57}{fmt\_password}};}
\DoxyCodeLine{01871\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01872\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ informat\_arg\_hex:}
\DoxyCodeLine{01873\ \ \ \ \ \ \ \ \ ctx.\mbox{\hyperlink{structyubihsm__context_a44a581dfcadf23981c3b9b7af51711a0}{in\_fmt}}\ =\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708acce29e9764c448874d69cb6c90b02401}{fmt\_hex}};}
\DoxyCodeLine{01874\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01875\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ informat\_\_NULL:}
\DoxyCodeLine{01876\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ informat\_arg\_default:}
\DoxyCodeLine{01877\ \ \ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{01878\ \ \ \ \ \ \ \ \ ctx.\mbox{\hyperlink{structyubihsm__context_a44a581dfcadf23981c3b9b7af51711a0}{in\_fmt}}\ =\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}};}
\DoxyCodeLine{01879\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01880\ \ \ \ \ \}}
\DoxyCodeLine{01881\ }
\DoxyCodeLine{01882\ \ \ \ \ \textcolor{keywordflow}{switch}\ (args\_info.outformat\_arg)\ \{}
\DoxyCodeLine{01883\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ outformat\_arg\_base64:}
\DoxyCodeLine{01884\ \ \ \ \ \ \ \ \ ctx.\mbox{\hyperlink{structyubihsm__context_addfaa9a6a08f58bdb5b5a93f2e89ccc2}{out\_fmt}}\ =\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708add674d756d2c6341a834a330a874b550}{fmt\_base64}};}
\DoxyCodeLine{01885\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01886\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ outformat\_arg\_binary:}
\DoxyCodeLine{01887\ \ \ \ \ \ \ \ \ ctx.\mbox{\hyperlink{structyubihsm__context_addfaa9a6a08f58bdb5b5a93f2e89ccc2}{out\_fmt}}\ =\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a701725c70fb214e14a2feee390939a09}{fmt\_binary}};}
\DoxyCodeLine{01888\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01889\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ outformat\_arg\_PEM:}
\DoxyCodeLine{01890\ \ \ \ \ \ \ \ \ ctx.\mbox{\hyperlink{structyubihsm__context_addfaa9a6a08f58bdb5b5a93f2e89ccc2}{out\_fmt}}\ =\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708aa8908f2c651567ae288c587240e71d3e}{fmt\_PEM}};}
\DoxyCodeLine{01891\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01892\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ outformat\_arg\_hex:}
\DoxyCodeLine{01893\ \ \ \ \ \ \ \ \ ctx.\mbox{\hyperlink{structyubihsm__context_addfaa9a6a08f58bdb5b5a93f2e89ccc2}{out\_fmt}}\ =\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708acce29e9764c448874d69cb6c90b02401}{fmt\_hex}};}
\DoxyCodeLine{01894\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01895\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ outformat\_\_NULL:}
\DoxyCodeLine{01896\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ outformat\_arg\_default:}
\DoxyCodeLine{01897\ \ \ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{01898\ \ \ \ \ \ \ \ \ ctx.\mbox{\hyperlink{structyubihsm__context_addfaa9a6a08f58bdb5b5a93f2e89ccc2}{out\_fmt}}\ =\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}};}
\DoxyCodeLine{01899\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01900\ \ \ \ \ \}}
\DoxyCodeLine{01901\ }
\DoxyCodeLine{01902\ \ \ \ \ calling\_device\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01903\ }
\DoxyCodeLine{01904\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ i\ =\ 0;\ i\ <\ args\_info.action\_given;\ i++)\ \{}
\DoxyCodeLine{01905\ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (args\_info.action\_arg[i])\ \{}
\DoxyCodeLine{01906\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ action\_arg\_decryptMINUS\_pkcs1v15:\ \{}
\DoxyCodeLine{01907\ \ \ \ \ \ \ \ \ \ \ arg[1].\mbox{\hyperlink{struct_argument_aeb48fdf58cd895afedcbf817845d2a77}{w}}\ =\ args\_info.object\_id\_arg;}
\DoxyCodeLine{01908\ \ \ \ \ \ \ \ \ \ \ arg[2].\mbox{\hyperlink{struct_argument_a988ffa3a53329017f0fdc315cc61dc49}{x}}\ =\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a855e99b645b13e7905d074d02fe0bff5}{buf}};}
\DoxyCodeLine{01909\ \ \ \ \ \ \ \ \ \ \ arg[2].\mbox{\hyperlink{struct_argument_ac33038cf0ca57abb4caed3dbdf4b9e86}{len}}\ =\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a855e99b645b13e7905d074d02fe0bff5}{buf}});}
\DoxyCodeLine{01910\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (get\_input\_data(args\_info.in\_arg,\ arg[2].x,\ \&arg[2].len,}
\DoxyCodeLine{01911\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ctx.\mbox{\hyperlink{structyubihsm__context_a44a581dfcadf23981c3b9b7af51711a0}{in\_fmt}}\ ==\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}}\ ?\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a701725c70fb214e14a2feee390939a09}{fmt\_binary}}}
\DoxyCodeLine{01912\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ ctx.\mbox{\hyperlink{structyubihsm__context_a44a581dfcadf23981c3b9b7af51711a0}{in\_fmt}})\ ==\ \textcolor{keyword}{false})\ \{}
\DoxyCodeLine{01913\ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ get\ input\ data\(\backslash\)n"{}});}
\DoxyCodeLine{01914\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a97917e1d5a9fa5e8b7a4495dc9234ac7}{rc}}\ =\ EXIT\_FAILURE;}
\DoxyCodeLine{01915\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01916\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01917\ \ \ \ \ \ \ \ \ \ \ comrc\ =}
\DoxyCodeLine{01918\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{commands_8c_aea9c5cab32280dc06d4681c02f1b5ccb}{yh\_com\_decrypt\_pkcs1v1\_5}}(\&ctx,\ arg,}
\DoxyCodeLine{01919\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ctx.\mbox{\hyperlink{structyubihsm__context_addfaa9a6a08f58bdb5b5a93f2e89ccc2}{out\_fmt}}\ ==\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}}\ ?\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a701725c70fb214e14a2feee390939a09}{fmt\_binary}}}
\DoxyCodeLine{01920\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ ctx.\mbox{\hyperlink{structyubihsm__context_addfaa9a6a08f58bdb5b5a93f2e89ccc2}{out\_fmt}});}
\DoxyCodeLine{01921\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_abab93648e3320de2ad5d42dfe693547b}{COM\_SUCCEED\_OR\_DIE}}(comrc,\ \textcolor{stringliteral}{"{}Unable\ to\ decrypt\ data"{}});}
\DoxyCodeLine{01922\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01923\ }
\DoxyCodeLine{01924\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ action\_arg\_deriveMINUS\_ecdh:\ \{}
\DoxyCodeLine{01925\ \ \ \ \ \ \ \ \ \ \ arg[1].\mbox{\hyperlink{struct_argument_aeb48fdf58cd895afedcbf817845d2a77}{w}}\ =\ args\_info.object\_id\_arg;}
\DoxyCodeLine{01926\ \ \ \ \ \ \ \ \ \ \ arg[2].\mbox{\hyperlink{struct_argument_a988ffa3a53329017f0fdc315cc61dc49}{x}}\ =\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a855e99b645b13e7905d074d02fe0bff5}{buf}};}
\DoxyCodeLine{01927\ \ \ \ \ \ \ \ \ \ \ arg[2].\mbox{\hyperlink{struct_argument_ac33038cf0ca57abb4caed3dbdf4b9e86}{len}}\ =\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a855e99b645b13e7905d074d02fe0bff5}{buf}});}
\DoxyCodeLine{01928\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (get\_input\_data(args\_info.in\_arg,\ arg[2].x,\ \&arg[2].len,}
\DoxyCodeLine{01929\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ctx.\mbox{\hyperlink{structyubihsm__context_a44a581dfcadf23981c3b9b7af51711a0}{in\_fmt}}\ ==\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}}\ ?\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a701725c70fb214e14a2feee390939a09}{fmt\_binary}}}
\DoxyCodeLine{01930\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ ctx.\mbox{\hyperlink{structyubihsm__context_a44a581dfcadf23981c3b9b7af51711a0}{in\_fmt}})\ ==\ \textcolor{keyword}{false})\ \{}
\DoxyCodeLine{01931\ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ get\ input\ data\(\backslash\)n"{}});}
\DoxyCodeLine{01932\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a97917e1d5a9fa5e8b7a4495dc9234ac7}{rc}}\ =\ EXIT\_FAILURE;}
\DoxyCodeLine{01933\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01934\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01935\ \ \ \ \ \ \ \ \ \ \ comrc\ =\ \mbox{\hyperlink{commands_8c_a0f6792710fe36e1bf00cb839f286d473}{yh\_com\_derive\_ecdh}}(\&ctx,\ arg,}
\DoxyCodeLine{01936\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ctx.\mbox{\hyperlink{structyubihsm__context_addfaa9a6a08f58bdb5b5a93f2e89ccc2}{out\_fmt}}\ ==\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}}\ ?\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708acce29e9764c448874d69cb6c90b02401}{fmt\_hex}}}
\DoxyCodeLine{01937\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ ctx.\mbox{\hyperlink{structyubihsm__context_addfaa9a6a08f58bdb5b5a93f2e89ccc2}{out\_fmt}});}
\DoxyCodeLine{01938\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_abab93648e3320de2ad5d42dfe693547b}{COM\_SUCCEED\_OR\_DIE}}(comrc,\ \textcolor{stringliteral}{"{}Unable\ to\ perform\ ECDH\ key\ exchange"{}});}
\DoxyCodeLine{01939\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01940\ }
\DoxyCodeLine{01941\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ action\_arg\_decryptMINUS\_oaep:}
\DoxyCodeLine{01942\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ action\_arg\_decryptMINUS\_aesccm:}
\DoxyCodeLine{01943\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ action\_arg\_encryptMINUS\_aesccm:}
\DoxyCodeLine{01944\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_a125cc1cf3137b795bc39ed2e9143ac6d}{LIB\_SUCCEED\_OR\_DIE}}(\mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a39fbc5bce29b178582419ae9d31ad252}{YHR\_GENERIC\_ERROR}},\ \textcolor{stringliteral}{"{}Command\ not\ implemented:\ "{}});}
\DoxyCodeLine{01945\ }
\DoxyCodeLine{01946\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ action\_arg\_generateMINUS\_asymmetricMINUS\_key:\ \{}
\DoxyCodeLine{01947\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (args\_info.algorithm\_given\ ==\ 0)\ \{}
\DoxyCodeLine{01948\ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Missing\ argument\ algorithm\(\backslash\)n"{}});}
\DoxyCodeLine{01949\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a97917e1d5a9fa5e8b7a4495dc9234ac7}{rc}}\ =\ EXIT\_FAILURE;}
\DoxyCodeLine{01950\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01951\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01952\ }
\DoxyCodeLine{01953\ \ \ \ \ \ \ \ \ \ \ arg[1].\mbox{\hyperlink{struct_argument_aeb48fdf58cd895afedcbf817845d2a77}{w}}\ =\ args\_info.object\_id\_arg;}
\DoxyCodeLine{01954\ \ \ \ \ \ \ \ \ \ \ arg[2].\mbox{\hyperlink{struct_argument_a5054bf8f827d48bc83f9763d5e78b786}{s}}\ =\ args\_info.label\_arg;}
\DoxyCodeLine{01955\ \ \ \ \ \ \ \ \ \ \ arg[2].\mbox{\hyperlink{struct_argument_ac33038cf0ca57abb4caed3dbdf4b9e86}{len}}\ =\ strlen(args\_info.label\_arg);}
\DoxyCodeLine{01956\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a96a4c751a281515d5610adb8fd779438}{yh\_string\_to\_domains}}(args\_info.domains\_arg,\ \&arg[3].w);}
\DoxyCodeLine{01957\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_a125cc1cf3137b795bc39ed2e9143ac6d}{LIB\_SUCCEED\_OR\_DIE}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}},\ \textcolor{stringliteral}{"{}Unable\ to\ parse\ domains:\ "{}});}
\DoxyCodeLine{01958\ }
\DoxyCodeLine{01959\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_adc4bd59a60361844aa0e852efa210105}{memset}}(\&arg[4].c,\ 0,\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structyh__capabilities}{yh\_capabilities}}));}
\DoxyCodeLine{01960\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =}
\DoxyCodeLine{01961\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm_8c_aab440e1cb671d9ba7a2e7d1243960e42}{yh\_string\_to\_capabilities}}(args\_info.capabilities\_arg,\ \&arg[4].c);}
\DoxyCodeLine{01962\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_a125cc1cf3137b795bc39ed2e9143ac6d}{LIB\_SUCCEED\_OR\_DIE}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}},\ \textcolor{stringliteral}{"{}Unable\ to\ parse\ capabilities:\ "{}});}
\DoxyCodeLine{01963\ }
\DoxyCodeLine{01964\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_aad9943d12261cc0f0cada93cbd6d0704}{yh\_string\_to\_algo}}(args\_info.algorithm\_arg,\ \&arg[5].a);}
\DoxyCodeLine{01965\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_a125cc1cf3137b795bc39ed2e9143ac6d}{LIB\_SUCCEED\_OR\_DIE}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}},\ \textcolor{stringliteral}{"{}Unable\ to\ parse\ algorithm:\ "{}});}
\DoxyCodeLine{01966\ }
\DoxyCodeLine{01967\ \ \ \ \ \ \ \ \ \ \ comrc\ =\ \mbox{\hyperlink{commands_8c_aa1c71ebc2b3f298b6522ab090393c73e}{yh\_com\_generate\_asymmetric}}(\&ctx,\ arg,\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}});}
\DoxyCodeLine{01968\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_abab93648e3320de2ad5d42dfe693547b}{COM\_SUCCEED\_OR\_DIE}}(comrc,\ \textcolor{stringliteral}{"{}Unable\ to\ generate\ asymmetric\ key"{}});}
\DoxyCodeLine{01969\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01970\ }
\DoxyCodeLine{01971\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ action\_arg\_generateMINUS\_hmacMINUS\_key:\ \{}
\DoxyCodeLine{01972\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (args\_info.algorithm\_given\ ==\ 0)\ \{}
\DoxyCodeLine{01973\ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Missing\ argument\ algorithm\(\backslash\)n"{}});}
\DoxyCodeLine{01974\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a97917e1d5a9fa5e8b7a4495dc9234ac7}{rc}}\ =\ EXIT\_FAILURE;}
\DoxyCodeLine{01975\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01976\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01977\ }
\DoxyCodeLine{01978\ \ \ \ \ \ \ \ \ \ \ arg[1].\mbox{\hyperlink{struct_argument_aeb48fdf58cd895afedcbf817845d2a77}{w}}\ =\ args\_info.object\_id\_arg;}
\DoxyCodeLine{01979\ \ \ \ \ \ \ \ \ \ \ arg[2].\mbox{\hyperlink{struct_argument_a5054bf8f827d48bc83f9763d5e78b786}{s}}\ =\ args\_info.label\_arg;}
\DoxyCodeLine{01980\ \ \ \ \ \ \ \ \ \ \ arg[2].\mbox{\hyperlink{struct_argument_ac33038cf0ca57abb4caed3dbdf4b9e86}{len}}\ =\ strlen(args\_info.label\_arg);}
\DoxyCodeLine{01981\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a96a4c751a281515d5610adb8fd779438}{yh\_string\_to\_domains}}(args\_info.domains\_arg,\ \&arg[3].w);}
\DoxyCodeLine{01982\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_a125cc1cf3137b795bc39ed2e9143ac6d}{LIB\_SUCCEED\_OR\_DIE}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}},\ \textcolor{stringliteral}{"{}Unable\ to\ parse\ domains:\ "{}});}
\DoxyCodeLine{01983\ }
\DoxyCodeLine{01984\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_adc4bd59a60361844aa0e852efa210105}{memset}}(\&arg[4].c,\ 0,\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structyh__capabilities}{yh\_capabilities}}));}
\DoxyCodeLine{01985\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =}
\DoxyCodeLine{01986\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm_8c_aab440e1cb671d9ba7a2e7d1243960e42}{yh\_string\_to\_capabilities}}(args\_info.capabilities\_arg,\ \&arg[4].c);}
\DoxyCodeLine{01987\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_a125cc1cf3137b795bc39ed2e9143ac6d}{LIB\_SUCCEED\_OR\_DIE}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}},\ \textcolor{stringliteral}{"{}Unable\ to\ parse\ capabilities:\ "{}});}
\DoxyCodeLine{01988\ }
\DoxyCodeLine{01989\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_aad9943d12261cc0f0cada93cbd6d0704}{yh\_string\_to\_algo}}(args\_info.algorithm\_arg,\ \&arg[5].a);}
\DoxyCodeLine{01990\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_a125cc1cf3137b795bc39ed2e9143ac6d}{LIB\_SUCCEED\_OR\_DIE}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}},\ \textcolor{stringliteral}{"{}Unable\ to\ parse\ algorithm:\ "{}});}
\DoxyCodeLine{01991\ }
\DoxyCodeLine{01992\ \ \ \ \ \ \ \ \ \ \ comrc\ =\ \mbox{\hyperlink{commands_8c_a2be1be0e0a454965f5a378e4ecb483f0}{yh\_com\_generate\_hmac}}(\&ctx,\ arg,\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}});}
\DoxyCodeLine{01993\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_abab93648e3320de2ad5d42dfe693547b}{COM\_SUCCEED\_OR\_DIE}}(comrc,\ \textcolor{stringliteral}{"{}Unable\ to\ generate\ hmac\ key"{}});}
\DoxyCodeLine{01994\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01995\ }
\DoxyCodeLine{01996\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ action\_arg\_generateMINUS\_wrapMINUS\_key:\ \{}
\DoxyCodeLine{01997\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (args\_info.algorithm\_given\ ==\ 0)\ \{}
\DoxyCodeLine{01998\ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Missing\ argument\ algorithm\(\backslash\)n"{}});}
\DoxyCodeLine{01999\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a97917e1d5a9fa5e8b7a4495dc9234ac7}{rc}}\ =\ EXIT\_FAILURE;}
\DoxyCodeLine{02000\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02001\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02002\ }
\DoxyCodeLine{02003\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (args\_info.delegated\_given\ ==\ 0)\ \{}
\DoxyCodeLine{02004\ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Missing\ delegated\ capabilities\(\backslash\)n"{}});}
\DoxyCodeLine{02005\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a97917e1d5a9fa5e8b7a4495dc9234ac7}{rc}}\ =\ EXIT\_FAILURE;}
\DoxyCodeLine{02006\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02007\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02008\ }
\DoxyCodeLine{02009\ \ \ \ \ \ \ \ \ \ \ arg[1].\mbox{\hyperlink{struct_argument_aeb48fdf58cd895afedcbf817845d2a77}{w}}\ =\ args\_info.object\_id\_arg;}
\DoxyCodeLine{02010\ \ \ \ \ \ \ \ \ \ \ arg[2].\mbox{\hyperlink{struct_argument_a5054bf8f827d48bc83f9763d5e78b786}{s}}\ =\ args\_info.label\_arg;}
\DoxyCodeLine{02011\ \ \ \ \ \ \ \ \ \ \ arg[2].\mbox{\hyperlink{struct_argument_ac33038cf0ca57abb4caed3dbdf4b9e86}{len}}\ =\ strlen(args\_info.label\_arg);}
\DoxyCodeLine{02012\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a96a4c751a281515d5610adb8fd779438}{yh\_string\_to\_domains}}(args\_info.domains\_arg,\ \&arg[3].w);}
\DoxyCodeLine{02013\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_a125cc1cf3137b795bc39ed2e9143ac6d}{LIB\_SUCCEED\_OR\_DIE}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}},\ \textcolor{stringliteral}{"{}Unable\ to\ parse\ domains:\ "{}});}
\DoxyCodeLine{02014\ }
\DoxyCodeLine{02015\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_adc4bd59a60361844aa0e852efa210105}{memset}}(\&arg[4].c,\ 0,\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structyh__capabilities}{yh\_capabilities}}));}
\DoxyCodeLine{02016\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =}
\DoxyCodeLine{02017\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm_8c_aab440e1cb671d9ba7a2e7d1243960e42}{yh\_string\_to\_capabilities}}(args\_info.capabilities\_arg,\ \&arg[4].c);}
\DoxyCodeLine{02018\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_a125cc1cf3137b795bc39ed2e9143ac6d}{LIB\_SUCCEED\_OR\_DIE}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}},\ \textcolor{stringliteral}{"{}Unable\ to\ parse\ capabilities:\ "{}});}
\DoxyCodeLine{02019\ }
\DoxyCodeLine{02020\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_aad9943d12261cc0f0cada93cbd6d0704}{yh\_string\_to\_algo}}(args\_info.algorithm\_arg,\ \&arg[5].a);}
\DoxyCodeLine{02021\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_a125cc1cf3137b795bc39ed2e9143ac6d}{LIB\_SUCCEED\_OR\_DIE}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}},\ \textcolor{stringliteral}{"{}Unable\ to\ parse\ algorithm:\ "{}});}
\DoxyCodeLine{02022\ }
\DoxyCodeLine{02023\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_adc4bd59a60361844aa0e852efa210105}{memset}}(\&arg[6].c,\ 0,\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structyh__capabilities}{yh\_capabilities}}));}
\DoxyCodeLine{02024\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_aab440e1cb671d9ba7a2e7d1243960e42}{yh\_string\_to\_capabilities}}(args\_info.delegated\_arg,\ \&arg[6].c);}
\DoxyCodeLine{02025\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_a125cc1cf3137b795bc39ed2e9143ac6d}{LIB\_SUCCEED\_OR\_DIE}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}},\ \textcolor{stringliteral}{"{}Unable\ to\ parse\ capabilities:\ "{}});}
\DoxyCodeLine{02026\ }
\DoxyCodeLine{02027\ \ \ \ \ \ \ \ \ \ \ comrc\ =\ \mbox{\hyperlink{commands_8c_a43d7d9dd1659838d79f875e61e59ce52}{yh\_com\_generate\_wrap}}(\&ctx,\ arg,\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}});}
\DoxyCodeLine{02028\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_abab93648e3320de2ad5d42dfe693547b}{COM\_SUCCEED\_OR\_DIE}}(comrc,\ \textcolor{stringliteral}{"{}Unable\ to\ generate\ wrap\ key"{}});}
\DoxyCodeLine{02029\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02030\ }
\DoxyCodeLine{02031\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ action\_arg\_generateMINUS\_otpMINUS\_aeadMINUS\_key:\ \{}
\DoxyCodeLine{02032\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (args\_info.algorithm\_given\ ==\ 0)\ \{}
\DoxyCodeLine{02033\ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Missing\ argument\ algorithm\(\backslash\)n"{}});}
\DoxyCodeLine{02034\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a97917e1d5a9fa5e8b7a4495dc9234ac7}{rc}}\ =\ EXIT\_FAILURE;}
\DoxyCodeLine{02035\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02036\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02037\ }
\DoxyCodeLine{02038\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (args\_info.nonce\_given\ ==\ 0)\ \{}
\DoxyCodeLine{02039\ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Missing\ argument\ nonce\(\backslash\)n"{}});}
\DoxyCodeLine{02040\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a97917e1d5a9fa5e8b7a4495dc9234ac7}{rc}}\ =\ EXIT\_FAILURE;}
\DoxyCodeLine{02041\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02042\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02043\ }
\DoxyCodeLine{02044\ \ \ \ \ \ \ \ \ \ \ arg[1].\mbox{\hyperlink{struct_argument_aeb48fdf58cd895afedcbf817845d2a77}{w}}\ =\ args\_info.object\_id\_arg;}
\DoxyCodeLine{02045\ \ \ \ \ \ \ \ \ \ \ arg[2].\mbox{\hyperlink{struct_argument_a5054bf8f827d48bc83f9763d5e78b786}{s}}\ =\ args\_info.label\_arg;}
\DoxyCodeLine{02046\ \ \ \ \ \ \ \ \ \ \ arg[2].\mbox{\hyperlink{struct_argument_ac33038cf0ca57abb4caed3dbdf4b9e86}{len}}\ =\ strlen(args\_info.label\_arg);}
\DoxyCodeLine{02047\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a96a4c751a281515d5610adb8fd779438}{yh\_string\_to\_domains}}(args\_info.domains\_arg,\ \&arg[3].w);}
\DoxyCodeLine{02048\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_a125cc1cf3137b795bc39ed2e9143ac6d}{LIB\_SUCCEED\_OR\_DIE}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}},\ \textcolor{stringliteral}{"{}Unable\ to\ parse\ domains:\ "{}});}
\DoxyCodeLine{02049\ }
\DoxyCodeLine{02050\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_adc4bd59a60361844aa0e852efa210105}{memset}}(\&arg[4].c,\ 0,\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structyh__capabilities}{yh\_capabilities}}));}
\DoxyCodeLine{02051\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =}
\DoxyCodeLine{02052\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm_8c_aab440e1cb671d9ba7a2e7d1243960e42}{yh\_string\_to\_capabilities}}(args\_info.capabilities\_arg,\ \&arg[4].c);}
\DoxyCodeLine{02053\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_a125cc1cf3137b795bc39ed2e9143ac6d}{LIB\_SUCCEED\_OR\_DIE}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}},\ \textcolor{stringliteral}{"{}Unable\ to\ parse\ capabilities:\ "{}});}
\DoxyCodeLine{02054\ }
\DoxyCodeLine{02055\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_aad9943d12261cc0f0cada93cbd6d0704}{yh\_string\_to\_algo}}(args\_info.algorithm\_arg,\ \&arg[5].a);}
\DoxyCodeLine{02056\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_a125cc1cf3137b795bc39ed2e9143ac6d}{LIB\_SUCCEED\_OR\_DIE}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}},\ \textcolor{stringliteral}{"{}Unable\ to\ parse\ algorithm:\ "{}});}
\DoxyCodeLine{02057\ }
\DoxyCodeLine{02058\ \ \ \ \ \ \ \ \ \ \ arg[6].\mbox{\hyperlink{struct_argument_af1d31453ebb9b694f291fef3b04b7021}{d}}\ =\ args\_info.nonce\_arg;}
\DoxyCodeLine{02059\ }
\DoxyCodeLine{02060\ \ \ \ \ \ \ \ \ \ \ comrc\ =\ \mbox{\hyperlink{commands_8c_a13416d261c1a92415525cbfa63a2dc0c}{yh\_com\_generate\_otp\_aead\_key}}(\&ctx,\ arg,\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}});}
\DoxyCodeLine{02061\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_abab93648e3320de2ad5d42dfe693547b}{COM\_SUCCEED\_OR\_DIE}}(comrc,\ \textcolor{stringliteral}{"{}Unable\ to\ generate\ otp\ key"{}});}
\DoxyCodeLine{02062\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02063\ }
\DoxyCodeLine{02064\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ action\_arg\_getMINUS\_opaque:\ \{}
\DoxyCodeLine{02065\ \ \ \ \ \ \ \ \ \ \ arg[1].\mbox{\hyperlink{struct_argument_aeb48fdf58cd895afedcbf817845d2a77}{w}}\ =\ args\_info.object\_id\_arg;}
\DoxyCodeLine{02066\ }
\DoxyCodeLine{02067\ \ \ \ \ \ \ \ \ \ \ comrc\ =\ \mbox{\hyperlink{commands_8c_ad8a4781a26be12a87848234cc184a3bb}{yh\_com\_get\_opaque}}(\&ctx,\ arg,}
\DoxyCodeLine{02068\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ctx.\mbox{\hyperlink{structyubihsm__context_addfaa9a6a08f58bdb5b5a93f2e89ccc2}{out\_fmt}}\ ==\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}}\ ?\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a701725c70fb214e14a2feee390939a09}{fmt\_binary}}}
\DoxyCodeLine{02069\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ ctx.\mbox{\hyperlink{structyubihsm__context_addfaa9a6a08f58bdb5b5a93f2e89ccc2}{out\_fmt}});}
\DoxyCodeLine{02070\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_abab93648e3320de2ad5d42dfe693547b}{COM\_SUCCEED\_OR\_DIE}}(comrc,\ \textcolor{stringliteral}{"{}Unable\ to\ get\ opaque\ object"{}});}
\DoxyCodeLine{02071\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02072\ }
\DoxyCodeLine{02073\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ action\_arg\_getMINUS\_pseudoMINUS\_random:\ \{}
\DoxyCodeLine{02074\ \ \ \ \ \ \ \ \ \ \ arg[1].\mbox{\hyperlink{struct_argument_aeb48fdf58cd895afedcbf817845d2a77}{w}}\ =\ args\_info.count\_arg;}
\DoxyCodeLine{02075\ }
\DoxyCodeLine{02076\ \ \ \ \ \ \ \ \ \ \ comrc\ =}
\DoxyCodeLine{02077\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{commands_8c_af32a8f10f2d022ca8b7816e6f4809a24}{yh\_com\_get\_random}}(\&ctx,\ arg,}
\DoxyCodeLine{02078\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ctx.\mbox{\hyperlink{structyubihsm__context_addfaa9a6a08f58bdb5b5a93f2e89ccc2}{out\_fmt}}\ ==\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}}\ ?\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708acce29e9764c448874d69cb6c90b02401}{fmt\_hex}}\ :\ ctx.\mbox{\hyperlink{structyubihsm__context_addfaa9a6a08f58bdb5b5a93f2e89ccc2}{out\_fmt}});}
\DoxyCodeLine{02079\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_abab93648e3320de2ad5d42dfe693547b}{COM\_SUCCEED\_OR\_DIE}}(comrc,\ \textcolor{stringliteral}{"{}Unable\ to\ get\ random\ bytes"{}});}
\DoxyCodeLine{02080\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02081\ }
\DoxyCodeLine{02082\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ action\_arg\_getMINUS\_storageMINUS\_info:}
\DoxyCodeLine{02083\ \ \ \ \ \ \ \ \ \ \ comrc\ =\ \mbox{\hyperlink{commands_8c_a408c9e43b8ccb159acb178f2b20f3f77}{yh\_com\_get\_storage}}(\&ctx,\ arg,\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}});}
\DoxyCodeLine{02084\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_abab93648e3320de2ad5d42dfe693547b}{COM\_SUCCEED\_OR\_DIE}}(comrc,\ \textcolor{stringliteral}{"{}Unable\ to\ get\ storage\ stats"{}});}
\DoxyCodeLine{02085\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02086\ }
\DoxyCodeLine{02087\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ action\_arg\_getMINUS\_publicMINUS\_key:\ \{}
\DoxyCodeLine{02088\ \ \ \ \ \ \ \ \ \ \ arg[1].\mbox{\hyperlink{struct_argument_aeb48fdf58cd895afedcbf817845d2a77}{w}}\ =\ args\_info.object\_id\_arg;}
\DoxyCodeLine{02089\ \ \ \ \ \ \ \ \ \ \ arg[2].\mbox{\hyperlink{struct_argument_a5054bf8f827d48bc83f9763d5e78b786}{s}}\ =\ args\_info.out\_arg;}
\DoxyCodeLine{02090\ \ \ \ \ \ \ \ \ \ \ arg[2].\mbox{\hyperlink{struct_argument_ac33038cf0ca57abb4caed3dbdf4b9e86}{len}}\ =\ strlen(args\_info.out\_arg);}
\DoxyCodeLine{02091\ }
\DoxyCodeLine{02092\ \ \ \ \ \ \ \ \ \ \ comrc\ =}
\DoxyCodeLine{02093\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{commands_8c_aa1c9a933f4601dae48cd64f911d297aa}{yh\_com\_get\_pubkey}}(\&ctx,\ arg,}
\DoxyCodeLine{02094\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ctx.\mbox{\hyperlink{structyubihsm__context_addfaa9a6a08f58bdb5b5a93f2e89ccc2}{out\_fmt}}\ ==\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}}\ ?\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708aa8908f2c651567ae288c587240e71d3e}{fmt\_PEM}}\ :\ ctx.\mbox{\hyperlink{structyubihsm__context_addfaa9a6a08f58bdb5b5a93f2e89ccc2}{out\_fmt}});}
\DoxyCodeLine{02095\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_abab93648e3320de2ad5d42dfe693547b}{COM\_SUCCEED\_OR\_DIE}}(comrc,\ \textcolor{stringliteral}{"{}Unable\ to\ get\ public\ key"{}});}
\DoxyCodeLine{02096\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02097\ }
\DoxyCodeLine{02098\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ action\_arg\_getMINUS\_objectMINUS\_info:\ \{}
\DoxyCodeLine{02099\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (args\_info.object\_type\_given\ ==\ 0)\ \{}
\DoxyCodeLine{02100\ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Missing\ argument\ object\ type\(\backslash\)n"{}});}
\DoxyCodeLine{02101\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a97917e1d5a9fa5e8b7a4495dc9234ac7}{rc}}\ =\ EXIT\_FAILURE;}
\DoxyCodeLine{02102\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02103\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02104\ }
\DoxyCodeLine{02105\ \ \ \ \ \ \ \ \ \ \ arg[1].\mbox{\hyperlink{struct_argument_aeb48fdf58cd895afedcbf817845d2a77}{w}}\ =\ args\_info.object\_id\_arg;}
\DoxyCodeLine{02106\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a57cdfa4b6224bd2c4a8bab24513475d8}{yh\_string\_to\_type}}(args\_info.object\_type\_arg,\ \&arg[2].t);}
\DoxyCodeLine{02107\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_a125cc1cf3137b795bc39ed2e9143ac6d}{LIB\_SUCCEED\_OR\_DIE}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}},\ \textcolor{stringliteral}{"{}Unable\ to\ parse\ type:\ "{}});}
\DoxyCodeLine{02108\ }
\DoxyCodeLine{02109\ \ \ \ \ \ \ \ \ \ \ comrc\ =\ \mbox{\hyperlink{commands_8c_afa7330c81148ba6f4d5c53f7c370ed41}{yh\_com\_get\_object\_info}}(\&ctx,\ arg,\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}});}
\DoxyCodeLine{02110\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_abab93648e3320de2ad5d42dfe693547b}{COM\_SUCCEED\_OR\_DIE}}(comrc,\ \textcolor{stringliteral}{"{}Unable\ to\ get\ object\ info"{}});}
\DoxyCodeLine{02111\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02112\ }
\DoxyCodeLine{02113\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ action\_arg\_getMINUS\_wrapped:\ \{}
\DoxyCodeLine{02114\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (args\_info.object\_type\_given\ ==\ 0)\ \{}
\DoxyCodeLine{02115\ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Missing\ argument\ object-\/type\(\backslash\)n"{}});}
\DoxyCodeLine{02116\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a97917e1d5a9fa5e8b7a4495dc9234ac7}{rc}}\ =\ EXIT\_FAILURE;}
\DoxyCodeLine{02117\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02118\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02119\ }
\DoxyCodeLine{02120\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (args\_info.wrap\_id\_given\ ==\ 0)\ \{}
\DoxyCodeLine{02121\ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Missing\ argument\ wrap-\/id\(\backslash\)n"{}});}
\DoxyCodeLine{02122\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a97917e1d5a9fa5e8b7a4495dc9234ac7}{rc}}\ =\ EXIT\_FAILURE;}
\DoxyCodeLine{02123\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02124\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02125\ }
\DoxyCodeLine{02126\ \ \ \ \ \ \ \ \ \ \ arg[1].\mbox{\hyperlink{struct_argument_aeb48fdf58cd895afedcbf817845d2a77}{w}}\ =\ args\_info.object\_id\_arg;}
\DoxyCodeLine{02127\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a57cdfa4b6224bd2c4a8bab24513475d8}{yh\_string\_to\_type}}(args\_info.object\_type\_arg,\ \&arg[2].t);}
\DoxyCodeLine{02128\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_a125cc1cf3137b795bc39ed2e9143ac6d}{LIB\_SUCCEED\_OR\_DIE}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}},\ \textcolor{stringliteral}{"{}Unable\ to\ parse\ type:\ "{}});}
\DoxyCodeLine{02129\ }
\DoxyCodeLine{02130\ \ \ \ \ \ \ \ \ \ \ arg[3].\mbox{\hyperlink{struct_argument_aeb48fdf58cd895afedcbf817845d2a77}{w}}\ =\ args\_info.wrap\_id\_arg;}
\DoxyCodeLine{02131\ }
\DoxyCodeLine{02132\ \ \ \ \ \ \ \ \ \ \ arg[4].\mbox{\hyperlink{struct_argument_a5054bf8f827d48bc83f9763d5e78b786}{s}}\ =\ args\_info.out\_arg;}
\DoxyCodeLine{02133\ \ \ \ \ \ \ \ \ \ \ arg[4].\mbox{\hyperlink{struct_argument_ac33038cf0ca57abb4caed3dbdf4b9e86}{len}}\ =\ strlen(args\_info.out\_arg);}
\DoxyCodeLine{02134\ }
\DoxyCodeLine{02135\ \ \ \ \ \ \ \ \ \ \ comrc\ =\ \mbox{\hyperlink{commands_8c_ac221d587381b78c747d8290320ee4c0a}{yh\_com\_get\_wrapped}}(\&ctx,\ arg,}
\DoxyCodeLine{02136\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ctx.\mbox{\hyperlink{structyubihsm__context_addfaa9a6a08f58bdb5b5a93f2e89ccc2}{out\_fmt}}\ ==\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}}\ ?\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708add674d756d2c6341a834a330a874b550}{fmt\_base64}}}
\DoxyCodeLine{02137\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ ctx.\mbox{\hyperlink{structyubihsm__context_addfaa9a6a08f58bdb5b5a93f2e89ccc2}{out\_fmt}});}
\DoxyCodeLine{02138\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_abab93648e3320de2ad5d42dfe693547b}{COM\_SUCCEED\_OR\_DIE}}(comrc,\ \textcolor{stringliteral}{"{}Unable\ to\ get\ wrapped\ object"{}});}
\DoxyCodeLine{02139\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02140\ }
\DoxyCodeLine{02141\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ action\_arg\_getMINUS\_deviceMINUS\_info:}
\DoxyCodeLine{02142\ \ \ \ \ \ \ \ \ \ \ comrc\ =\ \mbox{\hyperlink{commands_8c_aca833cbc2ca7673b00a4f6cb320c97b6}{yh\_com\_get\_device\_info}}(\&ctx,\ arg,\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}});}
\DoxyCodeLine{02143\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_abab93648e3320de2ad5d42dfe693547b}{COM\_SUCCEED\_OR\_DIE}}(comrc,\ \textcolor{stringliteral}{"{}Unable\ to\ get\ device\ info"{}});}
\DoxyCodeLine{02144\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02145\ }
\DoxyCodeLine{02146\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ action\_arg\_getMINUS\_template:\ \{}
\DoxyCodeLine{02147\ \ \ \ \ \ \ \ \ \ \ arg[1].\mbox{\hyperlink{struct_argument_aeb48fdf58cd895afedcbf817845d2a77}{w}}\ =\ args\_info.object\_id\_arg;}
\DoxyCodeLine{02148\ }
\DoxyCodeLine{02149\ \ \ \ \ \ \ \ \ \ \ comrc\ =\ \mbox{\hyperlink{commands_8c_ac8e5bb8ba179bc997ddc73e03423782d}{yh\_com\_get\_template}}(\&ctx,\ arg,}
\DoxyCodeLine{02150\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ctx.\mbox{\hyperlink{structyubihsm__context_addfaa9a6a08f58bdb5b5a93f2e89ccc2}{out\_fmt}}\ ==\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}}\ ?\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708add674d756d2c6341a834a330a874b550}{fmt\_base64}}}
\DoxyCodeLine{02151\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ ctx.\mbox{\hyperlink{structyubihsm__context_addfaa9a6a08f58bdb5b5a93f2e89ccc2}{out\_fmt}});}
\DoxyCodeLine{02152\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_abab93648e3320de2ad5d42dfe693547b}{COM\_SUCCEED\_OR\_DIE}}(comrc,\ \textcolor{stringliteral}{"{}Unable\ to\ get\ template\ object"{}});}
\DoxyCodeLine{02153\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02154\ }
\DoxyCodeLine{02155\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ action\_arg\_listMINUS\_objects:\ \{}
\DoxyCodeLine{02156\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (args\_info.algorithm\_given\ ==\ 0)\ \{}
\DoxyCodeLine{02157\ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Missing\ argument\ algorithm\(\backslash\)n"{}});}
\DoxyCodeLine{02158\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a97917e1d5a9fa5e8b7a4495dc9234ac7}{rc}}\ =\ EXIT\_FAILURE;}
\DoxyCodeLine{02159\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02160\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02161\ }
\DoxyCodeLine{02162\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (args\_info.object\_type\_given\ ==\ 0)\ \{}
\DoxyCodeLine{02163\ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Missing\ argument\ object-\/type\(\backslash\)n"{}});}
\DoxyCodeLine{02164\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a97917e1d5a9fa5e8b7a4495dc9234ac7}{rc}}\ =\ EXIT\_FAILURE;}
\DoxyCodeLine{02165\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02166\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02167\ }
\DoxyCodeLine{02168\ \ \ \ \ \ \ \ \ \ \ arg[1].\mbox{\hyperlink{struct_argument_aeb48fdf58cd895afedcbf817845d2a77}{w}}\ =\ args\_info.object\_id\_arg;}
\DoxyCodeLine{02169\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a57cdfa4b6224bd2c4a8bab24513475d8}{yh\_string\_to\_type}}(args\_info.object\_type\_arg,\ \&arg[2].t);}
\DoxyCodeLine{02170\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_a125cc1cf3137b795bc39ed2e9143ac6d}{LIB\_SUCCEED\_OR\_DIE}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}},\ \textcolor{stringliteral}{"{}Unable\ to\ parse\ type:\ "{}});}
\DoxyCodeLine{02171\ }
\DoxyCodeLine{02172\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a96a4c751a281515d5610adb8fd779438}{yh\_string\_to\_domains}}(args\_info.domains\_arg,\ \&arg[3].w);}
\DoxyCodeLine{02173\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_a125cc1cf3137b795bc39ed2e9143ac6d}{LIB\_SUCCEED\_OR\_DIE}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}},\ \textcolor{stringliteral}{"{}Unable\ to\ parse\ domains:\ "{}});}
\DoxyCodeLine{02174\ }
\DoxyCodeLine{02175\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_adc4bd59a60361844aa0e852efa210105}{memset}}(\&arg[4].c,\ 0,\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structyh__capabilities}{yh\_capabilities}}));}
\DoxyCodeLine{02176\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =}
\DoxyCodeLine{02177\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm_8c_aab440e1cb671d9ba7a2e7d1243960e42}{yh\_string\_to\_capabilities}}(args\_info.capabilities\_arg,\ \&arg[4].c);}
\DoxyCodeLine{02178\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_a125cc1cf3137b795bc39ed2e9143ac6d}{LIB\_SUCCEED\_OR\_DIE}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}},\ \textcolor{stringliteral}{"{}Unable\ to\ parse\ capabilities:\ "{}});}
\DoxyCodeLine{02179\ }
\DoxyCodeLine{02180\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_aad9943d12261cc0f0cada93cbd6d0704}{yh\_string\_to\_algo}}(args\_info.algorithm\_arg,\ \&arg[5].a);}
\DoxyCodeLine{02181\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_a125cc1cf3137b795bc39ed2e9143ac6d}{LIB\_SUCCEED\_OR\_DIE}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}},\ \textcolor{stringliteral}{"{}Unable\ to\ parse\ algorithm:\ "{}});}
\DoxyCodeLine{02182\ }
\DoxyCodeLine{02183\ \ \ \ \ \ \ \ \ \ \ arg[6].\mbox{\hyperlink{struct_argument_a5054bf8f827d48bc83f9763d5e78b786}{s}}\ =\ args\_info.label\_arg;}
\DoxyCodeLine{02184\ \ \ \ \ \ \ \ \ \ \ arg[6].\mbox{\hyperlink{struct_argument_ac33038cf0ca57abb4caed3dbdf4b9e86}{len}}\ =\ strlen(args\_info.label\_arg);}
\DoxyCodeLine{02185\ }
\DoxyCodeLine{02186\ \ \ \ \ \ \ \ \ \ \ comrc\ =\ \mbox{\hyperlink{commands_8c_a2b752129687a9ca758661e0b6625b59c}{yh\_com\_list\_objects}}(\&ctx,\ arg,\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}});}
\DoxyCodeLine{02187\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_abab93648e3320de2ad5d42dfe693547b}{COM\_SUCCEED\_OR\_DIE}}(comrc,\ \textcolor{stringliteral}{"{}Unable\ to\ list\ objects"{}});}
\DoxyCodeLine{02188\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02189\ }
\DoxyCodeLine{02190\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ action\_arg\_putMINUS\_authenticationMINUS\_key:\ \{}
\DoxyCodeLine{02191\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (args\_info.new\_password\_given\ ==\ 0)\ \{}
\DoxyCodeLine{02192\ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Missing\ argument\ new-\/password\(\backslash\)n"{}});}
\DoxyCodeLine{02193\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a97917e1d5a9fa5e8b7a4495dc9234ac7}{rc}}\ =\ EXIT\_FAILURE;}
\DoxyCodeLine{02194\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02195\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02196\ }
\DoxyCodeLine{02197\ \ \ \ \ \ \ \ \ \ \ arg[1].\mbox{\hyperlink{struct_argument_aeb48fdf58cd895afedcbf817845d2a77}{w}}\ =\ args\_info.object\_id\_arg;}
\DoxyCodeLine{02198\ \ \ \ \ \ \ \ \ \ \ arg[2].\mbox{\hyperlink{struct_argument_a5054bf8f827d48bc83f9763d5e78b786}{s}}\ =\ args\_info.label\_arg;}
\DoxyCodeLine{02199\ \ \ \ \ \ \ \ \ \ \ arg[2].\mbox{\hyperlink{struct_argument_ac33038cf0ca57abb4caed3dbdf4b9e86}{len}}\ =\ strlen(args\_info.label\_arg);}
\DoxyCodeLine{02200\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a96a4c751a281515d5610adb8fd779438}{yh\_string\_to\_domains}}(args\_info.domains\_arg,\ \&arg[3].w);}
\DoxyCodeLine{02201\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_a125cc1cf3137b795bc39ed2e9143ac6d}{LIB\_SUCCEED\_OR\_DIE}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}},\ \textcolor{stringliteral}{"{}Unable\ to\ parse\ domains:\ "{}});}
\DoxyCodeLine{02202\ }
\DoxyCodeLine{02203\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_adc4bd59a60361844aa0e852efa210105}{memset}}(\&arg[4].c,\ 0,\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structyh__capabilities}{yh\_capabilities}}));}
\DoxyCodeLine{02204\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =}
\DoxyCodeLine{02205\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm_8c_aab440e1cb671d9ba7a2e7d1243960e42}{yh\_string\_to\_capabilities}}(args\_info.capabilities\_arg,\ \&arg[4].c);}
\DoxyCodeLine{02206\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_a125cc1cf3137b795bc39ed2e9143ac6d}{LIB\_SUCCEED\_OR\_DIE}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}},\ \textcolor{stringliteral}{"{}Unable\ to\ parse\ capabilities:\ "{}});}
\DoxyCodeLine{02207\ }
\DoxyCodeLine{02208\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_adc4bd59a60361844aa0e852efa210105}{memset}}(\&arg[5].c,\ 0,\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structyh__capabilities}{yh\_capabilities}}));}
\DoxyCodeLine{02209\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_aab440e1cb671d9ba7a2e7d1243960e42}{yh\_string\_to\_capabilities}}(args\_info.delegated\_arg,\ \&arg[5].c);}
\DoxyCodeLine{02210\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_a125cc1cf3137b795bc39ed2e9143ac6d}{LIB\_SUCCEED\_OR\_DIE}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}},\ \textcolor{stringliteral}{"{}Unable\ to\ parse\ capabilities:\ "{}});}
\DoxyCodeLine{02211\ }
\DoxyCodeLine{02212\ \ \ \ \ \ \ \ \ \ \ arg[6].\mbox{\hyperlink{struct_argument_a988ffa3a53329017f0fdc315cc61dc49}{x}}\ =\ (\mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ *)\ args\_info.new\_password\_arg;}
\DoxyCodeLine{02213\ \ \ \ \ \ \ \ \ \ \ arg[6].\mbox{\hyperlink{struct_argument_ac33038cf0ca57abb4caed3dbdf4b9e86}{len}}\ =\ strlen(args\_info.new\_password\_arg);}
\DoxyCodeLine{02214\ }
\DoxyCodeLine{02215\ \ \ \ \ \ \ \ \ \ \ comrc\ =\ \mbox{\hyperlink{commands_8c_a3bd17c302789958013e50a2ad9738aea}{yh\_com\_put\_authentication}}(\&ctx,\ arg,\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}});}
\DoxyCodeLine{02216\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_abab93648e3320de2ad5d42dfe693547b}{COM\_SUCCEED\_OR\_DIE}}(comrc,\ \textcolor{stringliteral}{"{}Unable\ to\ store\ authentication\ key"{}});}
\DoxyCodeLine{02217\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02218\ }
\DoxyCodeLine{02219\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ action\_arg\_putMINUS\_asymmetricMINUS\_key:\ \{}
\DoxyCodeLine{02220\ \ \ \ \ \ \ \ \ \ \ arg[1].\mbox{\hyperlink{struct_argument_aeb48fdf58cd895afedcbf817845d2a77}{w}}\ =\ args\_info.object\_id\_arg;}
\DoxyCodeLine{02221\ \ \ \ \ \ \ \ \ \ \ arg[2].\mbox{\hyperlink{struct_argument_a5054bf8f827d48bc83f9763d5e78b786}{s}}\ =\ args\_info.label\_arg;}
\DoxyCodeLine{02222\ \ \ \ \ \ \ \ \ \ \ arg[2].\mbox{\hyperlink{struct_argument_ac33038cf0ca57abb4caed3dbdf4b9e86}{len}}\ =\ strlen(args\_info.label\_arg);}
\DoxyCodeLine{02223\ }
\DoxyCodeLine{02224\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a96a4c751a281515d5610adb8fd779438}{yh\_string\_to\_domains}}(args\_info.domains\_arg,\ \&arg[3].w);}
\DoxyCodeLine{02225\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_a125cc1cf3137b795bc39ed2e9143ac6d}{LIB\_SUCCEED\_OR\_DIE}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}},\ \textcolor{stringliteral}{"{}Unable\ to\ parse\ domains:\ "{}});}
\DoxyCodeLine{02226\ }
\DoxyCodeLine{02227\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_adc4bd59a60361844aa0e852efa210105}{memset}}(\&arg[4].c,\ 0,\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structyh__capabilities}{yh\_capabilities}}));}
\DoxyCodeLine{02228\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =}
\DoxyCodeLine{02229\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm_8c_aab440e1cb671d9ba7a2e7d1243960e42}{yh\_string\_to\_capabilities}}(args\_info.capabilities\_arg,\ \&arg[4].c);}
\DoxyCodeLine{02230\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_a125cc1cf3137b795bc39ed2e9143ac6d}{LIB\_SUCCEED\_OR\_DIE}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}},\ \textcolor{stringliteral}{"{}Unable\ to\ parse\ capabilities:\ "{}});}
\DoxyCodeLine{02231\ }
\DoxyCodeLine{02232\ \ \ \ \ \ \ \ \ \ \ arg[5].\mbox{\hyperlink{struct_argument_a988ffa3a53329017f0fdc315cc61dc49}{x}}\ =\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a855e99b645b13e7905d074d02fe0bff5}{buf}};}
\DoxyCodeLine{02233\ \ \ \ \ \ \ \ \ \ \ arg[5].\mbox{\hyperlink{struct_argument_ac33038cf0ca57abb4caed3dbdf4b9e86}{len}}\ =\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a855e99b645b13e7905d074d02fe0bff5}{buf}});}
\DoxyCodeLine{02234\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (get\_input\_data(args\_info.in\_arg,\ arg[5].x,\ \&arg[5].len,}
\DoxyCodeLine{02235\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ctx.\mbox{\hyperlink{structyubihsm__context_a44a581dfcadf23981c3b9b7af51711a0}{in\_fmt}}\ ==\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}}\ ?\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708aa8908f2c651567ae288c587240e71d3e}{fmt\_PEM}}\ :\ ctx.\mbox{\hyperlink{structyubihsm__context_a44a581dfcadf23981c3b9b7af51711a0}{in\_fmt}})\ ==}
\DoxyCodeLine{02236\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{false})\ \{}
\DoxyCodeLine{02237\ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ get\ input\ data\(\backslash\)n"{}});}
\DoxyCodeLine{02238\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a97917e1d5a9fa5e8b7a4495dc9234ac7}{rc}}\ =\ EXIT\_FAILURE;}
\DoxyCodeLine{02239\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02240\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02241\ \ \ \ \ \ \ \ \ \ \ comrc\ =\ \mbox{\hyperlink{commands_8c_a0abe95eb37069022ed341835938de103}{yh\_com\_put\_asymmetric}}(\&ctx,\ arg,\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}});}
\DoxyCodeLine{02242\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_abab93648e3320de2ad5d42dfe693547b}{COM\_SUCCEED\_OR\_DIE}}(comrc,\ \textcolor{stringliteral}{"{}Unable\ to\ store\ asymmetric\ key"{}});}
\DoxyCodeLine{02243\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02244\ }
\DoxyCodeLine{02245\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ action\_arg\_putMINUS\_opaque:\ \{}
\DoxyCodeLine{02246\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (args\_info.algorithm\_given\ ==\ 0)\ \{}
\DoxyCodeLine{02247\ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Missing\ argument\ algorithm\(\backslash\)n"{}});}
\DoxyCodeLine{02248\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a97917e1d5a9fa5e8b7a4495dc9234ac7}{rc}}\ =\ EXIT\_FAILURE;}
\DoxyCodeLine{02249\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02250\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02251\ }
\DoxyCodeLine{02252\ \ \ \ \ \ \ \ \ \ \ arg[1].\mbox{\hyperlink{struct_argument_aeb48fdf58cd895afedcbf817845d2a77}{w}}\ =\ args\_info.object\_id\_arg;}
\DoxyCodeLine{02253\ \ \ \ \ \ \ \ \ \ \ arg[2].\mbox{\hyperlink{struct_argument_a5054bf8f827d48bc83f9763d5e78b786}{s}}\ =\ args\_info.label\_arg;}
\DoxyCodeLine{02254\ \ \ \ \ \ \ \ \ \ \ arg[2].\mbox{\hyperlink{struct_argument_ac33038cf0ca57abb4caed3dbdf4b9e86}{len}}\ =\ strlen(args\_info.label\_arg);}
\DoxyCodeLine{02255\ }
\DoxyCodeLine{02256\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a96a4c751a281515d5610adb8fd779438}{yh\_string\_to\_domains}}(args\_info.domains\_arg,\ \&arg[3].w);}
\DoxyCodeLine{02257\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_a125cc1cf3137b795bc39ed2e9143ac6d}{LIB\_SUCCEED\_OR\_DIE}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}},\ \textcolor{stringliteral}{"{}Unable\ to\ parse\ domains:\ "{}});}
\DoxyCodeLine{02258\ }
\DoxyCodeLine{02259\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_adc4bd59a60361844aa0e852efa210105}{memset}}(\&arg[4].c,\ 0,\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structyh__capabilities}{yh\_capabilities}}));}
\DoxyCodeLine{02260\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =}
\DoxyCodeLine{02261\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm_8c_aab440e1cb671d9ba7a2e7d1243960e42}{yh\_string\_to\_capabilities}}(args\_info.capabilities\_arg,\ \&arg[4].c);}
\DoxyCodeLine{02262\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_a125cc1cf3137b795bc39ed2e9143ac6d}{LIB\_SUCCEED\_OR\_DIE}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}},\ \textcolor{stringliteral}{"{}Unable\ to\ parse\ capabilities:\ "{}});}
\DoxyCodeLine{02263\ }
\DoxyCodeLine{02264\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_aad9943d12261cc0f0cada93cbd6d0704}{yh\_string\_to\_algo}}(args\_info.algorithm\_arg,\ \&arg[5].a);}
\DoxyCodeLine{02265\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_a125cc1cf3137b795bc39ed2e9143ac6d}{LIB\_SUCCEED\_OR\_DIE}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}},\ \textcolor{stringliteral}{"{}Unable\ to\ parse\ algorithm:\ "{}});}
\DoxyCodeLine{02266\ }
\DoxyCodeLine{02267\ \ \ \ \ \ \ \ \ \ \ arg[6].\mbox{\hyperlink{struct_argument_a988ffa3a53329017f0fdc315cc61dc49}{x}}\ =\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a855e99b645b13e7905d074d02fe0bff5}{buf}};}
\DoxyCodeLine{02268\ \ \ \ \ \ \ \ \ \ \ arg[6].\mbox{\hyperlink{struct_argument_ac33038cf0ca57abb4caed3dbdf4b9e86}{len}}\ =\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a855e99b645b13e7905d074d02fe0bff5}{buf}});}
\DoxyCodeLine{02269\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (get\_input\_data(args\_info.in\_arg,\ arg[6].x,\ \&arg[6].len,}
\DoxyCodeLine{02270\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ctx.\mbox{\hyperlink{structyubihsm__context_a44a581dfcadf23981c3b9b7af51711a0}{in\_fmt}}\ ==\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}}\ ?\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a701725c70fb214e14a2feee390939a09}{fmt\_binary}}}
\DoxyCodeLine{02271\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ ctx.\mbox{\hyperlink{structyubihsm__context_a44a581dfcadf23981c3b9b7af51711a0}{in\_fmt}})\ ==\ \textcolor{keyword}{false})\ \{}
\DoxyCodeLine{02272\ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ get\ input\ data\(\backslash\)n"{}});}
\DoxyCodeLine{02273\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a97917e1d5a9fa5e8b7a4495dc9234ac7}{rc}}\ =\ EXIT\_FAILURE;}
\DoxyCodeLine{02274\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02275\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02276\ }
\DoxyCodeLine{02277\ \ \ \ \ \ \ \ \ \ \ comrc\ =\ \mbox{\hyperlink{commands_8c_a2be40cf6e90d80392d7aa5e291660f65}{yh\_com\_put\_opaque}}(\&ctx,\ arg,\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}});}
\DoxyCodeLine{02278\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_abab93648e3320de2ad5d42dfe693547b}{COM\_SUCCEED\_OR\_DIE}}(comrc,\ \textcolor{stringliteral}{"{}Unable\ to\ store\ opaque\ object"{}});}
\DoxyCodeLine{02279\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02280\ }
\DoxyCodeLine{02281\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ action\_arg\_setMINUS\_option:}
\DoxyCodeLine{02282\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_a125cc1cf3137b795bc39ed2e9143ac6d}{LIB\_SUCCEED\_OR\_DIE}}(\mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a39fbc5bce29b178582419ae9d31ad252}{YHR\_GENERIC\_ERROR}},\ \textcolor{stringliteral}{"{}Command\ not\ implemented:\ "{}});}
\DoxyCodeLine{02283\ }
\DoxyCodeLine{02284\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ action\_arg\_putMINUS\_hmacMINUS\_key:}
\DoxyCodeLine{02285\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_a125cc1cf3137b795bc39ed2e9143ac6d}{LIB\_SUCCEED\_OR\_DIE}}(\mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a39fbc5bce29b178582419ae9d31ad252}{YHR\_GENERIC\_ERROR}},\ \textcolor{stringliteral}{"{}Command\ not\ implemented:\ "{}});}
\DoxyCodeLine{02286\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ TODO(adma):\ this\ requires\ a\ hex\ parser}}
\DoxyCodeLine{02287\ }
\DoxyCodeLine{02288\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ action\_arg\_putMINUS\_wrapMINUS\_key:\ \{}
\DoxyCodeLine{02289\ }
\DoxyCodeLine{02290\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (args\_info.delegated\_given\ ==\ 0)\ \{}
\DoxyCodeLine{02291\ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Missing\ delegated\ capabilities\(\backslash\)n"{}});}
\DoxyCodeLine{02292\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a97917e1d5a9fa5e8b7a4495dc9234ac7}{rc}}\ =\ EXIT\_FAILURE;}
\DoxyCodeLine{02293\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02294\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02295\ }
\DoxyCodeLine{02296\ \ \ \ \ \ \ \ \ \ \ arg[1].\mbox{\hyperlink{struct_argument_aeb48fdf58cd895afedcbf817845d2a77}{w}}\ =\ args\_info.object\_id\_arg;}
\DoxyCodeLine{02297\ }
\DoxyCodeLine{02298\ \ \ \ \ \ \ \ \ \ \ arg[2].\mbox{\hyperlink{struct_argument_a5054bf8f827d48bc83f9763d5e78b786}{s}}\ =\ args\_info.label\_arg;}
\DoxyCodeLine{02299\ \ \ \ \ \ \ \ \ \ \ arg[2].\mbox{\hyperlink{struct_argument_ac33038cf0ca57abb4caed3dbdf4b9e86}{len}}\ =\ strlen(args\_info.label\_arg);}
\DoxyCodeLine{02300\ }
\DoxyCodeLine{02301\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a96a4c751a281515d5610adb8fd779438}{yh\_string\_to\_domains}}(args\_info.domains\_arg,\ \&arg[3].w);}
\DoxyCodeLine{02302\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_a125cc1cf3137b795bc39ed2e9143ac6d}{LIB\_SUCCEED\_OR\_DIE}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}},\ \textcolor{stringliteral}{"{}Unable\ to\ parse\ domains:\ "{}});}
\DoxyCodeLine{02303\ }
\DoxyCodeLine{02304\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_adc4bd59a60361844aa0e852efa210105}{memset}}(\&arg[4].c,\ 0,\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structyh__capabilities}{yh\_capabilities}}));}
\DoxyCodeLine{02305\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =}
\DoxyCodeLine{02306\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm_8c_aab440e1cb671d9ba7a2e7d1243960e42}{yh\_string\_to\_capabilities}}(args\_info.capabilities\_arg,\ \&arg[4].c);}
\DoxyCodeLine{02307\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_a125cc1cf3137b795bc39ed2e9143ac6d}{LIB\_SUCCEED\_OR\_DIE}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}},\ \textcolor{stringliteral}{"{}Unable\ to\ parse\ capabilities:\ "{}});}
\DoxyCodeLine{02308\ }
\DoxyCodeLine{02309\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_adc4bd59a60361844aa0e852efa210105}{memset}}(\&arg[5].c,\ 0,\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structyh__capabilities}{yh\_capabilities}}));}
\DoxyCodeLine{02310\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_aab440e1cb671d9ba7a2e7d1243960e42}{yh\_string\_to\_capabilities}}(args\_info.delegated\_arg,\ \&arg[5].c);}
\DoxyCodeLine{02311\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_a125cc1cf3137b795bc39ed2e9143ac6d}{LIB\_SUCCEED\_OR\_DIE}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}},\ \textcolor{stringliteral}{"{}Unable\ to\ parse\ capabilities:\ "{}});}
\DoxyCodeLine{02312\ }
\DoxyCodeLine{02313\ \ \ \ \ \ \ \ \ \ \ arg[6].\mbox{\hyperlink{struct_argument_a988ffa3a53329017f0fdc315cc61dc49}{x}}\ =\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a855e99b645b13e7905d074d02fe0bff5}{buf}};}
\DoxyCodeLine{02314\ \ \ \ \ \ \ \ \ \ \ arg[6].\mbox{\hyperlink{struct_argument_ac33038cf0ca57abb4caed3dbdf4b9e86}{len}}\ =\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a855e99b645b13e7905d074d02fe0bff5}{buf}});}
\DoxyCodeLine{02315\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (get\_input\_data(args\_info.in\_arg,\ arg[6].x,\ \&arg[6].len,}
\DoxyCodeLine{02316\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ctx.\mbox{\hyperlink{structyubihsm__context_a44a581dfcadf23981c3b9b7af51711a0}{in\_fmt}}\ ==\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}}\ ?\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708acce29e9764c448874d69cb6c90b02401}{fmt\_hex}}\ :\ ctx.\mbox{\hyperlink{structyubihsm__context_a44a581dfcadf23981c3b9b7af51711a0}{in\_fmt}})\ ==}
\DoxyCodeLine{02317\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{false})\ \{}
\DoxyCodeLine{02318\ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ get\ input\ data\(\backslash\)n"{}});}
\DoxyCodeLine{02319\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a97917e1d5a9fa5e8b7a4495dc9234ac7}{rc}}\ =\ EXIT\_FAILURE;}
\DoxyCodeLine{02320\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02321\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02322\ }
\DoxyCodeLine{02323\ \ \ \ \ \ \ \ \ \ \ comrc\ =\ \mbox{\hyperlink{commands_8c_ab2eb73abfe6f6d5a7f17752b3cab227a}{yh\_com\_put\_wrapkey}}(\&ctx,\ arg,\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}});}
\DoxyCodeLine{02324\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_abab93648e3320de2ad5d42dfe693547b}{COM\_SUCCEED\_OR\_DIE}}(comrc,\ \textcolor{stringliteral}{"{}Unable\ to\ put\ wrapkey"{}});}
\DoxyCodeLine{02325\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02326\ }
\DoxyCodeLine{02327\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ action\_arg\_putMINUS\_wrapped:\ \{}
\DoxyCodeLine{02328\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (args\_info.wrap\_id\_given\ ==\ 0)\ \{}
\DoxyCodeLine{02329\ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Missing\ argument\ wrap-\/id\(\backslash\)n"{}});}
\DoxyCodeLine{02330\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a97917e1d5a9fa5e8b7a4495dc9234ac7}{rc}}\ =\ EXIT\_FAILURE;}
\DoxyCodeLine{02331\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02332\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02333\ }
\DoxyCodeLine{02334\ \ \ \ \ \ \ \ \ \ \ arg[1].\mbox{\hyperlink{struct_argument_aeb48fdf58cd895afedcbf817845d2a77}{w}}\ =\ args\_info.wrap\_id\_arg;}
\DoxyCodeLine{02335\ \ \ \ \ \ \ \ \ \ \ arg[2].\mbox{\hyperlink{struct_argument_a988ffa3a53329017f0fdc315cc61dc49}{x}}\ =\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a855e99b645b13e7905d074d02fe0bff5}{buf}};}
\DoxyCodeLine{02336\ \ \ \ \ \ \ \ \ \ \ arg[2].\mbox{\hyperlink{struct_argument_ac33038cf0ca57abb4caed3dbdf4b9e86}{len}}\ =\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a855e99b645b13e7905d074d02fe0bff5}{buf}});}
\DoxyCodeLine{02337\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (get\_input\_data(args\_info.in\_arg,\ arg[2].x,\ \&arg[2].len,}
\DoxyCodeLine{02338\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ctx.\mbox{\hyperlink{structyubihsm__context_a44a581dfcadf23981c3b9b7af51711a0}{in\_fmt}}\ ==\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}}\ ?\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708add674d756d2c6341a834a330a874b550}{fmt\_base64}}}
\DoxyCodeLine{02339\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ ctx.\mbox{\hyperlink{structyubihsm__context_a44a581dfcadf23981c3b9b7af51711a0}{in\_fmt}})\ ==\ \textcolor{keyword}{false})\ \{}
\DoxyCodeLine{02340\ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ get\ input\ data\(\backslash\)n"{}});}
\DoxyCodeLine{02341\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a97917e1d5a9fa5e8b7a4495dc9234ac7}{rc}}\ =\ EXIT\_FAILURE;}
\DoxyCodeLine{02342\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02343\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02344\ }
\DoxyCodeLine{02345\ \ \ \ \ \ \ \ \ \ \ comrc\ =\ \mbox{\hyperlink{commands_8c_a6b74f2d2d47796c2432a15cd63183dd1}{yh\_com\_put\_wrapped}}(\&ctx,\ arg,\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}});}
\DoxyCodeLine{02346\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_abab93648e3320de2ad5d42dfe693547b}{COM\_SUCCEED\_OR\_DIE}}(comrc,\ \textcolor{stringliteral}{"{}Unable\ to\ store\ wrapped\ object"{}});}
\DoxyCodeLine{02347\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02348\ }
\DoxyCodeLine{02349\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ action\_arg\_putMINUS\_template:\ \{}
\DoxyCodeLine{02350\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (args\_info.algorithm\_given\ ==\ 0)\ \{}
\DoxyCodeLine{02351\ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Missing\ argument\ algorithm\(\backslash\)n"{}});}
\DoxyCodeLine{02352\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a97917e1d5a9fa5e8b7a4495dc9234ac7}{rc}}\ =\ EXIT\_FAILURE;}
\DoxyCodeLine{02353\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02354\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02355\ }
\DoxyCodeLine{02356\ \ \ \ \ \ \ \ \ \ \ arg[1].\mbox{\hyperlink{struct_argument_aeb48fdf58cd895afedcbf817845d2a77}{w}}\ =\ args\_info.object\_id\_arg;}
\DoxyCodeLine{02357\ \ \ \ \ \ \ \ \ \ \ arg[2].\mbox{\hyperlink{struct_argument_a5054bf8f827d48bc83f9763d5e78b786}{s}}\ =\ args\_info.label\_arg;}
\DoxyCodeLine{02358\ \ \ \ \ \ \ \ \ \ \ arg[2].\mbox{\hyperlink{struct_argument_ac33038cf0ca57abb4caed3dbdf4b9e86}{len}}\ =\ strlen(args\_info.label\_arg);}
\DoxyCodeLine{02359\ }
\DoxyCodeLine{02360\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a96a4c751a281515d5610adb8fd779438}{yh\_string\_to\_domains}}(args\_info.domains\_arg,\ \&arg[3].w);}
\DoxyCodeLine{02361\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_a125cc1cf3137b795bc39ed2e9143ac6d}{LIB\_SUCCEED\_OR\_DIE}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}},\ \textcolor{stringliteral}{"{}Unable\ to\ parse\ domains:\ "{}});}
\DoxyCodeLine{02362\ }
\DoxyCodeLine{02363\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_adc4bd59a60361844aa0e852efa210105}{memset}}(\&arg[4].c,\ 0,\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structyh__capabilities}{yh\_capabilities}}));}
\DoxyCodeLine{02364\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =}
\DoxyCodeLine{02365\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm_8c_aab440e1cb671d9ba7a2e7d1243960e42}{yh\_string\_to\_capabilities}}(args\_info.capabilities\_arg,\ \&arg[4].c);}
\DoxyCodeLine{02366\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_a125cc1cf3137b795bc39ed2e9143ac6d}{LIB\_SUCCEED\_OR\_DIE}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}},\ \textcolor{stringliteral}{"{}Unable\ to\ parse\ capabilities:\ "{}});}
\DoxyCodeLine{02367\ }
\DoxyCodeLine{02368\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_aad9943d12261cc0f0cada93cbd6d0704}{yh\_string\_to\_algo}}(args\_info.algorithm\_arg,\ \&arg[5].a);}
\DoxyCodeLine{02369\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_a125cc1cf3137b795bc39ed2e9143ac6d}{LIB\_SUCCEED\_OR\_DIE}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}},\ \textcolor{stringliteral}{"{}Unable\ to\ parse\ algorithm:\ "{}});}
\DoxyCodeLine{02370\ }
\DoxyCodeLine{02371\ \ \ \ \ \ \ \ \ \ \ arg[6].\mbox{\hyperlink{struct_argument_a988ffa3a53329017f0fdc315cc61dc49}{x}}\ =\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a855e99b645b13e7905d074d02fe0bff5}{buf}};}
\DoxyCodeLine{02372\ \ \ \ \ \ \ \ \ \ \ arg[6].\mbox{\hyperlink{struct_argument_ac33038cf0ca57abb4caed3dbdf4b9e86}{len}}\ =\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a855e99b645b13e7905d074d02fe0bff5}{buf}});}
\DoxyCodeLine{02373\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (get\_input\_data(args\_info.in\_arg,\ arg[6].x,\ \&arg[6].len,}
\DoxyCodeLine{02374\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ctx.\mbox{\hyperlink{structyubihsm__context_a44a581dfcadf23981c3b9b7af51711a0}{in\_fmt}}\ ==\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}}\ ?\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a701725c70fb214e14a2feee390939a09}{fmt\_binary}}}
\DoxyCodeLine{02375\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ ctx.\mbox{\hyperlink{structyubihsm__context_a44a581dfcadf23981c3b9b7af51711a0}{in\_fmt}})\ ==\ \textcolor{keyword}{false})\ \{}
\DoxyCodeLine{02376\ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ get\ input\ data\(\backslash\)n"{}});}
\DoxyCodeLine{02377\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a97917e1d5a9fa5e8b7a4495dc9234ac7}{rc}}\ =\ EXIT\_FAILURE;}
\DoxyCodeLine{02378\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02379\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02380\ }
\DoxyCodeLine{02381\ \ \ \ \ \ \ \ \ \ \ comrc\ =\ \mbox{\hyperlink{commands_8c_ad1629b955c1d718c65f137c9df3b3332}{yh\_com\_put\_template}}(\&ctx,\ arg,\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}});}
\DoxyCodeLine{02382\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_abab93648e3320de2ad5d42dfe693547b}{COM\_SUCCEED\_OR\_DIE}}(comrc,\ \textcolor{stringliteral}{"{}Unable\ to\ store\ template\ object"{}});}
\DoxyCodeLine{02383\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02384\ }
\DoxyCodeLine{02385\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ action\_arg\_putMINUS\_otpMINUS\_aeadMINUS\_key:}
\DoxyCodeLine{02386\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_a125cc1cf3137b795bc39ed2e9143ac6d}{LIB\_SUCCEED\_OR\_DIE}}(\mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a39fbc5bce29b178582419ae9d31ad252}{YHR\_GENERIC\_ERROR}},\ \textcolor{stringliteral}{"{}Command\ not\ implemented:\ "{}});}
\DoxyCodeLine{02387\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ TODO(adma):\ this\ requires\ a\ hex\ parser}}
\DoxyCodeLine{02388\ }
\DoxyCodeLine{02389\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ action\_arg\_signMINUS\_eddsa:}
\DoxyCodeLine{02390\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ action\_arg\_signMINUS\_ecdsa:\ \{}
\DoxyCodeLine{02391\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (args\_info.algorithm\_given\ ==\ 0)\ \{}
\DoxyCodeLine{02392\ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Missing\ argument\ algorithm\(\backslash\)n"{}});}
\DoxyCodeLine{02393\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a97917e1d5a9fa5e8b7a4495dc9234ac7}{rc}}\ =\ EXIT\_FAILURE;}
\DoxyCodeLine{02394\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02395\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02396\ }
\DoxyCodeLine{02397\ \ \ \ \ \ \ \ \ \ \ arg[1].\mbox{\hyperlink{struct_argument_aeb48fdf58cd895afedcbf817845d2a77}{w}}\ =\ args\_info.object\_id\_arg;}
\DoxyCodeLine{02398\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_aad9943d12261cc0f0cada93cbd6d0704}{yh\_string\_to\_algo}}(args\_info.algorithm\_arg,\ \&arg[2].a);}
\DoxyCodeLine{02399\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_a125cc1cf3137b795bc39ed2e9143ac6d}{LIB\_SUCCEED\_OR\_DIE}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}},\ \textcolor{stringliteral}{"{}Unable\ to\ parse\ algorithm:\ "{}});}
\DoxyCodeLine{02400\ }
\DoxyCodeLine{02401\ \ \ \ \ \ \ \ \ \ \ arg[3].\mbox{\hyperlink{struct_argument_a988ffa3a53329017f0fdc315cc61dc49}{x}}\ =\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a855e99b645b13e7905d074d02fe0bff5}{buf}};}
\DoxyCodeLine{02402\ \ \ \ \ \ \ \ \ \ \ arg[3].\mbox{\hyperlink{struct_argument_ac33038cf0ca57abb4caed3dbdf4b9e86}{len}}\ =\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a855e99b645b13e7905d074d02fe0bff5}{buf}});}
\DoxyCodeLine{02403\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (get\_input\_data(args\_info.in\_arg,\ arg[3].x,\ \&arg[3].len,}
\DoxyCodeLine{02404\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ctx.\mbox{\hyperlink{structyubihsm__context_a44a581dfcadf23981c3b9b7af51711a0}{in\_fmt}}\ ==\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}}\ ?\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a701725c70fb214e14a2feee390939a09}{fmt\_binary}}}
\DoxyCodeLine{02405\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ ctx.\mbox{\hyperlink{structyubihsm__context_a44a581dfcadf23981c3b9b7af51711a0}{in\_fmt}})\ ==\ \textcolor{keyword}{false})\ \{}
\DoxyCodeLine{02406\ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ get\ input\ data\(\backslash\)n"{}});}
\DoxyCodeLine{02407\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a97917e1d5a9fa5e8b7a4495dc9234ac7}{rc}}\ =\ EXIT\_FAILURE;}
\DoxyCodeLine{02408\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02409\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02410\ }
\DoxyCodeLine{02411\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (args\_info.action\_arg[i]\ ==\ action\_arg\_signMINUS\_ecdsa)\ \{}
\DoxyCodeLine{02412\ \ \ \ \ \ \ \ \ \ \ \ \ comrc\ =\ \mbox{\hyperlink{commands_8c_a982058963f9ff020c357030be09e79fc}{yh\_com\_sign\_ecdsa}}(\&ctx,\ arg,}
\DoxyCodeLine{02413\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ctx.\mbox{\hyperlink{structyubihsm__context_addfaa9a6a08f58bdb5b5a93f2e89ccc2}{out\_fmt}}\ ==\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}}\ ?\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708add674d756d2c6341a834a330a874b550}{fmt\_base64}}}
\DoxyCodeLine{02414\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ ctx.\mbox{\hyperlink{structyubihsm__context_addfaa9a6a08f58bdb5b5a93f2e89ccc2}{out\_fmt}});}
\DoxyCodeLine{02415\ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02416\ \ \ \ \ \ \ \ \ \ \ \ \ comrc\ =\ \mbox{\hyperlink{commands_8c_ac867ca0fc75e87da1a8d924fc587f5b9}{yh\_com\_sign\_eddsa}}(\&ctx,\ arg,}
\DoxyCodeLine{02417\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ctx.\mbox{\hyperlink{structyubihsm__context_addfaa9a6a08f58bdb5b5a93f2e89ccc2}{out\_fmt}}\ ==\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}}\ ?\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708add674d756d2c6341a834a330a874b550}{fmt\_base64}}}
\DoxyCodeLine{02418\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ ctx.\mbox{\hyperlink{structyubihsm__context_addfaa9a6a08f58bdb5b5a93f2e89ccc2}{out\_fmt}});}
\DoxyCodeLine{02419\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02420\ }
\DoxyCodeLine{02421\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_abab93648e3320de2ad5d42dfe693547b}{COM\_SUCCEED\_OR\_DIE}}(comrc,\ \textcolor{stringliteral}{"{}Unable\ to\ sign\ data"{}});}
\DoxyCodeLine{02422\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02423\ }
\DoxyCodeLine{02424\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ action\_arg\_signMINUS\_pkcs1v15:\ \{}
\DoxyCodeLine{02425\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (args\_info.algorithm\_given\ ==\ 0)\ \{}
\DoxyCodeLine{02426\ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Missing\ argument\ algorithm\(\backslash\)n"{}});}
\DoxyCodeLine{02427\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a97917e1d5a9fa5e8b7a4495dc9234ac7}{rc}}\ =\ EXIT\_FAILURE;}
\DoxyCodeLine{02428\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02429\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02430\ }
\DoxyCodeLine{02431\ \ \ \ \ \ \ \ \ \ \ arg[1].\mbox{\hyperlink{struct_argument_aeb48fdf58cd895afedcbf817845d2a77}{w}}\ =\ args\_info.object\_id\_arg;}
\DoxyCodeLine{02432\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_aad9943d12261cc0f0cada93cbd6d0704}{yh\_string\_to\_algo}}(args\_info.algorithm\_arg,\ \&arg[2].a);}
\DoxyCodeLine{02433\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_a125cc1cf3137b795bc39ed2e9143ac6d}{LIB\_SUCCEED\_OR\_DIE}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}},\ \textcolor{stringliteral}{"{}Unable\ to\ parse\ algorithm:\ "{}});}
\DoxyCodeLine{02434\ }
\DoxyCodeLine{02435\ \ \ \ \ \ \ \ \ \ \ arg[3].\mbox{\hyperlink{struct_argument_a988ffa3a53329017f0fdc315cc61dc49}{x}}\ =\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a855e99b645b13e7905d074d02fe0bff5}{buf}};}
\DoxyCodeLine{02436\ \ \ \ \ \ \ \ \ \ \ arg[3].\mbox{\hyperlink{struct_argument_ac33038cf0ca57abb4caed3dbdf4b9e86}{len}}\ =\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a855e99b645b13e7905d074d02fe0bff5}{buf}});}
\DoxyCodeLine{02437\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (get\_input\_data(args\_info.in\_arg,\ arg[3].x,\ \&arg[3].len,}
\DoxyCodeLine{02438\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ctx.\mbox{\hyperlink{structyubihsm__context_a44a581dfcadf23981c3b9b7af51711a0}{in\_fmt}}\ ==\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}}\ ?\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a701725c70fb214e14a2feee390939a09}{fmt\_binary}}}
\DoxyCodeLine{02439\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ ctx.\mbox{\hyperlink{structyubihsm__context_a44a581dfcadf23981c3b9b7af51711a0}{in\_fmt}})\ ==\ \textcolor{keyword}{false})\ \{}
\DoxyCodeLine{02440\ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ get\ input\ data\(\backslash\)n"{}});}
\DoxyCodeLine{02441\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a97917e1d5a9fa5e8b7a4495dc9234ac7}{rc}}\ =\ EXIT\_FAILURE;}
\DoxyCodeLine{02442\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02443\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02444\ }
\DoxyCodeLine{02445\ \ \ \ \ \ \ \ \ \ \ comrc\ =\ \mbox{\hyperlink{commands_8c_a98cf5e35ce2e4fd5881d8b6e7a890357}{yh\_com\_sign\_pkcs1v1\_5}}(\&ctx,\ arg,}
\DoxyCodeLine{02446\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ctx.\mbox{\hyperlink{structyubihsm__context_addfaa9a6a08f58bdb5b5a93f2e89ccc2}{out\_fmt}}\ ==\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}}\ ?\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708add674d756d2c6341a834a330a874b550}{fmt\_base64}}}
\DoxyCodeLine{02447\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ ctx.\mbox{\hyperlink{structyubihsm__context_addfaa9a6a08f58bdb5b5a93f2e89ccc2}{out\_fmt}});}
\DoxyCodeLine{02448\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_abab93648e3320de2ad5d42dfe693547b}{COM\_SUCCEED\_OR\_DIE}}(comrc,\ \textcolor{stringliteral}{"{}Unable\ to\ sign\ data"{}});}
\DoxyCodeLine{02449\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02450\ }
\DoxyCodeLine{02451\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ action\_arg\_signMINUS\_pss:\ \{}
\DoxyCodeLine{02452\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (args\_info.algorithm\_given\ ==\ 0)\ \{}
\DoxyCodeLine{02453\ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Missing\ argument\ algorithm\(\backslash\)n"{}});}
\DoxyCodeLine{02454\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a97917e1d5a9fa5e8b7a4495dc9234ac7}{rc}}\ =\ EXIT\_FAILURE;}
\DoxyCodeLine{02455\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02456\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02457\ }
\DoxyCodeLine{02458\ \ \ \ \ \ \ \ \ \ \ arg[1].\mbox{\hyperlink{struct_argument_aeb48fdf58cd895afedcbf817845d2a77}{w}}\ =\ args\_info.object\_id\_arg;}
\DoxyCodeLine{02459\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_aad9943d12261cc0f0cada93cbd6d0704}{yh\_string\_to\_algo}}(args\_info.algorithm\_arg,\ \&arg[2].a);}
\DoxyCodeLine{02460\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_a125cc1cf3137b795bc39ed2e9143ac6d}{LIB\_SUCCEED\_OR\_DIE}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}},\ \textcolor{stringliteral}{"{}Unable\ to\ parse\ algorithm:\ "{}});}
\DoxyCodeLine{02461\ }
\DoxyCodeLine{02462\ \ \ \ \ \ \ \ \ \ \ arg[3].\mbox{\hyperlink{struct_argument_a988ffa3a53329017f0fdc315cc61dc49}{x}}\ =\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a855e99b645b13e7905d074d02fe0bff5}{buf}};}
\DoxyCodeLine{02463\ \ \ \ \ \ \ \ \ \ \ arg[3].\mbox{\hyperlink{struct_argument_ac33038cf0ca57abb4caed3dbdf4b9e86}{len}}\ =\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a855e99b645b13e7905d074d02fe0bff5}{buf}});}
\DoxyCodeLine{02464\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (get\_input\_data(args\_info.in\_arg,\ arg[3].x,\ \&arg[3].len,}
\DoxyCodeLine{02465\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ctx.\mbox{\hyperlink{structyubihsm__context_a44a581dfcadf23981c3b9b7af51711a0}{in\_fmt}}\ ==\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}}\ ?\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a701725c70fb214e14a2feee390939a09}{fmt\_binary}}}
\DoxyCodeLine{02466\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ ctx.\mbox{\hyperlink{structyubihsm__context_a44a581dfcadf23981c3b9b7af51711a0}{in\_fmt}})\ ==\ \textcolor{keyword}{false})\ \{}
\DoxyCodeLine{02467\ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ get\ input\ data\(\backslash\)n"{}});}
\DoxyCodeLine{02468\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a97917e1d5a9fa5e8b7a4495dc9234ac7}{rc}}\ =\ EXIT\_FAILURE;}
\DoxyCodeLine{02469\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02470\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02471\ }
\DoxyCodeLine{02472\ \ \ \ \ \ \ \ \ \ \ comrc\ =\ \mbox{\hyperlink{commands_8c_a1dcbe3dfaa3722ae6e9246527b889627}{yh\_com\_sign\_pss}}(\&ctx,\ arg,}
\DoxyCodeLine{02473\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ctx.\mbox{\hyperlink{structyubihsm__context_addfaa9a6a08f58bdb5b5a93f2e89ccc2}{out\_fmt}}\ ==\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}}\ ?\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708add674d756d2c6341a834a330a874b550}{fmt\_base64}}}
\DoxyCodeLine{02474\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ ctx.\mbox{\hyperlink{structyubihsm__context_addfaa9a6a08f58bdb5b5a93f2e89ccc2}{out\_fmt}});}
\DoxyCodeLine{02475\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_abab93648e3320de2ad5d42dfe693547b}{COM\_SUCCEED\_OR\_DIE}}(comrc,\ \textcolor{stringliteral}{"{}Unable\ to\ sign\ data"{}});}
\DoxyCodeLine{02476\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02477\ }
\DoxyCodeLine{02478\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ action\_arg\_signMINUS\_hmac:}
\DoxyCodeLine{02479\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_a125cc1cf3137b795bc39ed2e9143ac6d}{LIB\_SUCCEED\_OR\_DIE}}(\mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a39fbc5bce29b178582419ae9d31ad252}{YHR\_GENERIC\_ERROR}},\ \textcolor{stringliteral}{"{}Command\ not\ implemented:\ "{}});}
\DoxyCodeLine{02480\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ TODO(adma):\ this\ requires\ a\ hex\ parser}}
\DoxyCodeLine{02481\ }
\DoxyCodeLine{02482\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ action\_arg\_reset:\ \{}
\DoxyCodeLine{02483\ \ \ \ \ \ \ \ \ \ \ comrc\ =\ \mbox{\hyperlink{commands_8c_a5947d870ac856de3880f8b80981e6355}{yh\_com\_reset}}(\&ctx,\ arg,\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}});}
\DoxyCodeLine{02484\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_abab93648e3320de2ad5d42dfe693547b}{COM\_SUCCEED\_OR\_DIE}}(comrc,\ \textcolor{stringliteral}{"{}Unable\ to\ reset\ device"{}});}
\DoxyCodeLine{02485\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02486\ }
\DoxyCodeLine{02487\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ action\_arg\_deleteMINUS\_object:\ \{}
\DoxyCodeLine{02488\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (args\_info.object\_type\_given\ ==\ 0)\ \{}
\DoxyCodeLine{02489\ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Missing\ argument\ object\ type\(\backslash\)n"{}});}
\DoxyCodeLine{02490\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a97917e1d5a9fa5e8b7a4495dc9234ac7}{rc}}\ =\ EXIT\_FAILURE;}
\DoxyCodeLine{02491\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02492\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02493\ }
\DoxyCodeLine{02494\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a57cdfa4b6224bd2c4a8bab24513475d8}{yh\_string\_to\_type}}(args\_info.object\_type\_arg,\ \&arg[2].t);}
\DoxyCodeLine{02495\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_a125cc1cf3137b795bc39ed2e9143ac6d}{LIB\_SUCCEED\_OR\_DIE}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}},\ \textcolor{stringliteral}{"{}Unable\ to\ parse\ type:\ "{}});}
\DoxyCodeLine{02496\ \ \ \ \ \ \ \ \ \ \ arg[1].\mbox{\hyperlink{struct_argument_aeb48fdf58cd895afedcbf817845d2a77}{w}}\ =\ args\_info.object\_id\_arg;}
\DoxyCodeLine{02497\ }
\DoxyCodeLine{02498\ \ \ \ \ \ \ \ \ \ \ comrc\ =\ \mbox{\hyperlink{commands_8c_ad490f0e89d33c1300a44bd095eb5562c}{yh\_com\_delete}}(\&ctx,\ arg,\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}});}
\DoxyCodeLine{02499\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_abab93648e3320de2ad5d42dfe693547b}{COM\_SUCCEED\_OR\_DIE}}(comrc,\ \textcolor{stringliteral}{"{}Unable\ to\ delete\ object"{}});}
\DoxyCodeLine{02500\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02501\ }
\DoxyCodeLine{02502\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ action\_arg\_signMINUS\_sshMINUS\_certificate:\ \{}
\DoxyCodeLine{02503\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (args\_info.template\_id\_given\ ==\ 0)\ \{}
\DoxyCodeLine{02504\ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Missing\ argument\ template-\/id\(\backslash\)n"{}});}
\DoxyCodeLine{02505\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a97917e1d5a9fa5e8b7a4495dc9234ac7}{rc}}\ =\ EXIT\_FAILURE;}
\DoxyCodeLine{02506\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02507\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02508\ }
\DoxyCodeLine{02509\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (args\_info.algorithm\_given\ ==\ 0)\ \{}
\DoxyCodeLine{02510\ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Missing\ argument\ algorithm\(\backslash\)n"{}});}
\DoxyCodeLine{02511\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a97917e1d5a9fa5e8b7a4495dc9234ac7}{rc}}\ =\ EXIT\_FAILURE;}
\DoxyCodeLine{02512\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02513\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02514\ }
\DoxyCodeLine{02515\ \ \ \ \ \ \ \ \ \ \ arg[1].\mbox{\hyperlink{struct_argument_aeb48fdf58cd895afedcbf817845d2a77}{w}}\ =\ args\_info.object\_id\_arg;}
\DoxyCodeLine{02516\ \ \ \ \ \ \ \ \ \ \ arg[2].\mbox{\hyperlink{struct_argument_aeb48fdf58cd895afedcbf817845d2a77}{w}}\ =\ args\_info.template\_id\_arg;}
\DoxyCodeLine{02517\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_aad9943d12261cc0f0cada93cbd6d0704}{yh\_string\_to\_algo}}(args\_info.algorithm\_arg,\ \&arg[3].a);}
\DoxyCodeLine{02518\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_a125cc1cf3137b795bc39ed2e9143ac6d}{LIB\_SUCCEED\_OR\_DIE}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}},\ \textcolor{stringliteral}{"{}Unable\ to\ parse\ algorithm:\ "{}});}
\DoxyCodeLine{02519\ }
\DoxyCodeLine{02520\ \ \ \ \ \ \ \ \ \ \ arg[4].\mbox{\hyperlink{struct_argument_a988ffa3a53329017f0fdc315cc61dc49}{x}}\ =\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a855e99b645b13e7905d074d02fe0bff5}{buf}};}
\DoxyCodeLine{02521\ \ \ \ \ \ \ \ \ \ \ arg[4].\mbox{\hyperlink{struct_argument_ac33038cf0ca57abb4caed3dbdf4b9e86}{len}}\ =\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a855e99b645b13e7905d074d02fe0bff5}{buf}});}
\DoxyCodeLine{02522\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (get\_input\_data(args\_info.in\_arg,\ arg[4].x,\ \&arg[4].len,}
\DoxyCodeLine{02523\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ctx.\mbox{\hyperlink{structyubihsm__context_a44a581dfcadf23981c3b9b7af51711a0}{in\_fmt}}\ ==\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}}\ ?\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a701725c70fb214e14a2feee390939a09}{fmt\_binary}}}
\DoxyCodeLine{02524\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ ctx.\mbox{\hyperlink{structyubihsm__context_a44a581dfcadf23981c3b9b7af51711a0}{in\_fmt}})\ ==}
\DoxyCodeLine{02525\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{false})\ \{\ \textcolor{comment}{//\ TODO:\ correct\ format?}}
\DoxyCodeLine{02526\ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ get\ input\ data\(\backslash\)n"{}});}
\DoxyCodeLine{02527\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a97917e1d5a9fa5e8b7a4495dc9234ac7}{rc}}\ =\ EXIT\_FAILURE;}
\DoxyCodeLine{02528\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02529\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02530\ }
\DoxyCodeLine{02531\ \ \ \ \ \ \ \ \ \ \ comrc\ =}
\DoxyCodeLine{02532\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{commands_8c_a03581158b5703a0ffe866d50d8a3982d}{yh\_com\_sign\_ssh\_certificate}}(\&ctx,\ arg,}
\DoxyCodeLine{02533\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ctx.\mbox{\hyperlink{structyubihsm__context_addfaa9a6a08f58bdb5b5a93f2e89ccc2}{out\_fmt}}\ ==\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}}\ ?\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a701725c70fb214e14a2feee390939a09}{fmt\_binary}}}
\DoxyCodeLine{02534\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ ctx.\mbox{\hyperlink{structyubihsm__context_addfaa9a6a08f58bdb5b5a93f2e89ccc2}{out\_fmt}});}
\DoxyCodeLine{02535\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_abab93648e3320de2ad5d42dfe693547b}{COM\_SUCCEED\_OR\_DIE}}(comrc,\ \textcolor{stringliteral}{"{}Unable\ to\ get\ ssh\ certificate"{}});}
\DoxyCodeLine{02536\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02537\ }
\DoxyCodeLine{02538\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ action\_arg\_benchmark:}
\DoxyCodeLine{02539\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_a125cc1cf3137b795bc39ed2e9143ac6d}{LIB\_SUCCEED\_OR\_DIE}}(\mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a39fbc5bce29b178582419ae9d31ad252}{YHR\_GENERIC\_ERROR}},\ \textcolor{stringliteral}{"{}Command\ not\ implemented:\ "{}});}
\DoxyCodeLine{02540\ }
\DoxyCodeLine{02541\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ action\_arg\_createMINUS\_otpMINUS\_aead:}
\DoxyCodeLine{02542\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_a125cc1cf3137b795bc39ed2e9143ac6d}{LIB\_SUCCEED\_OR\_DIE}}(\mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a39fbc5bce29b178582419ae9d31ad252}{YHR\_GENERIC\_ERROR}},\ \textcolor{stringliteral}{"{}Command\ not\ implemented:\ "{}});}
\DoxyCodeLine{02543\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ TODO(adma):\ this\ requires\ a\ hex\ parser}}
\DoxyCodeLine{02544\ }
\DoxyCodeLine{02545\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ action\_arg\_randomizeMINUS\_otpMINUS\_aead:\ \{}
\DoxyCodeLine{02546\ \ \ \ \ \ \ \ \ \ \ arg[1].\mbox{\hyperlink{struct_argument_aeb48fdf58cd895afedcbf817845d2a77}{w}}\ =\ args\_info.object\_id\_arg;}
\DoxyCodeLine{02547\ \ \ \ \ \ \ \ \ \ \ arg[2].\mbox{\hyperlink{struct_argument_a5054bf8f827d48bc83f9763d5e78b786}{s}}\ =\ args\_info.out\_arg;}
\DoxyCodeLine{02548\ \ \ \ \ \ \ \ \ \ \ arg[2].\mbox{\hyperlink{struct_argument_ac33038cf0ca57abb4caed3dbdf4b9e86}{len}}\ =\ strlen(args\_info.out\_arg);}
\DoxyCodeLine{02549\ }
\DoxyCodeLine{02550\ \ \ \ \ \ \ \ \ \ \ comrc\ =}
\DoxyCodeLine{02551\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{commands_8c_a533707756dfe3a35c9aadf4d288b73d4}{yh\_com\_otp\_aead\_random}}(\&ctx,\ arg,}
\DoxyCodeLine{02552\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ctx.\mbox{\hyperlink{structyubihsm__context_addfaa9a6a08f58bdb5b5a93f2e89ccc2}{out\_fmt}}\ ==\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}}\ ?\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a701725c70fb214e14a2feee390939a09}{fmt\_binary}}}
\DoxyCodeLine{02553\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ ctx.\mbox{\hyperlink{structyubihsm__context_addfaa9a6a08f58bdb5b5a93f2e89ccc2}{out\_fmt}});}
\DoxyCodeLine{02554\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_abab93648e3320de2ad5d42dfe693547b}{COM\_SUCCEED\_OR\_DIE}}(comrc,\ \textcolor{stringliteral}{"{}Unable\ to\ get\ aead\ from\ random"{}});}
\DoxyCodeLine{02555\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02556\ }
\DoxyCodeLine{02557\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ action\_arg\_decryptMINUS\_otp:}
\DoxyCodeLine{02558\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_a125cc1cf3137b795bc39ed2e9143ac6d}{LIB\_SUCCEED\_OR\_DIE}}(\mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a39fbc5bce29b178582419ae9d31ad252}{YHR\_GENERIC\_ERROR}},\ \textcolor{stringliteral}{"{}Command\ not\ implemented:\ "{}});}
\DoxyCodeLine{02559\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ TODO(adma):\ this\ requires\ a\ hex\ parser}}
\DoxyCodeLine{02560\ }
\DoxyCodeLine{02561\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ action\_arg\_signMINUS\_attestationMINUS\_certificate:\ \{}
\DoxyCodeLine{02562\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (args\_info.attestation\_id\_given\ ==\ 0)\ \{}
\DoxyCodeLine{02563\ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Missing\ argument\ attestation-\/id\(\backslash\)n"{}});}
\DoxyCodeLine{02564\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a97917e1d5a9fa5e8b7a4495dc9234ac7}{rc}}\ =\ EXIT\_FAILURE;}
\DoxyCodeLine{02565\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02566\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02567\ }
\DoxyCodeLine{02568\ \ \ \ \ \ \ \ \ \ \ arg[1].\mbox{\hyperlink{struct_argument_aeb48fdf58cd895afedcbf817845d2a77}{w}}\ =\ args\_info.object\_id\_arg;}
\DoxyCodeLine{02569\ \ \ \ \ \ \ \ \ \ \ arg[2].\mbox{\hyperlink{struct_argument_aeb48fdf58cd895afedcbf817845d2a77}{w}}\ =\ args\_info.attestation\_id\_arg;}
\DoxyCodeLine{02570\ }
\DoxyCodeLine{02571\ \ \ \ \ \ \ \ \ \ \ comrc\ =\ \mbox{\hyperlink{commands_8c_af224308de5cdf8e20cbbdcaa6cf7598c}{yh\_com\_sign\_attestation\_certificate}}(\&ctx,\ arg,}
\DoxyCodeLine{02572\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ctx.\mbox{\hyperlink{structyubihsm__context_addfaa9a6a08f58bdb5b5a93f2e89ccc2}{out\_fmt}}\ ==\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}}}
\DoxyCodeLine{02573\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ?\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708aa8908f2c651567ae288c587240e71d3e}{fmt\_PEM}}}
\DoxyCodeLine{02574\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ ctx.\mbox{\hyperlink{structyubihsm__context_addfaa9a6a08f58bdb5b5a93f2e89ccc2}{out\_fmt}});}
\DoxyCodeLine{02575\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_abab93648e3320de2ad5d42dfe693547b}{COM\_SUCCEED\_OR\_DIE}}(comrc,\ \textcolor{stringliteral}{"{}Unable\ to\ attest\ asymmetric\ key"{}});}
\DoxyCodeLine{02576\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02577\ }
\DoxyCodeLine{02578\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ action\_arg\_getMINUS\_logs:\ \{}
\DoxyCodeLine{02579\ \ \ \ \ \ \ \ \ \ \ comrc\ =}
\DoxyCodeLine{02580\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{commands_8c_a3c600843ccdac7af506983bc67cb0bc3}{yh\_com\_audit}}(\&ctx,\ arg,}
\DoxyCodeLine{02581\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ctx.\mbox{\hyperlink{structyubihsm__context_addfaa9a6a08f58bdb5b5a93f2e89ccc2}{out\_fmt}}\ ==\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}}\ ?\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a4fff5e64ffe63c6c03b00438c0b09282}{fmt\_ASCII}}\ :\ ctx.\mbox{\hyperlink{structyubihsm__context_addfaa9a6a08f58bdb5b5a93f2e89ccc2}{out\_fmt}});}
\DoxyCodeLine{02582\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_abab93648e3320de2ad5d42dfe693547b}{COM\_SUCCEED\_OR\_DIE}}(comrc,\ \textcolor{stringliteral}{"{}Unable\ to\ extract\ logs"{}});}
\DoxyCodeLine{02583\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02584\ }
\DoxyCodeLine{02585\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ action\_arg\_setMINUS\_logMINUS\_index:\ \{}
\DoxyCodeLine{02586\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (args\_info.log\_index\_given\ ==\ 0)\ \{}
\DoxyCodeLine{02587\ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Missing\ argument\ log-\/index\(\backslash\)n"{}});}
\DoxyCodeLine{02588\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a97917e1d5a9fa5e8b7a4495dc9234ac7}{rc}}\ =\ EXIT\_FAILURE;}
\DoxyCodeLine{02589\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02590\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02591\ }
\DoxyCodeLine{02592\ \ \ \ \ \ \ \ \ \ \ arg[1].\mbox{\hyperlink{struct_argument_aeb48fdf58cd895afedcbf817845d2a77}{w}}\ =\ args\_info.log\_index\_arg;}
\DoxyCodeLine{02593\ }
\DoxyCodeLine{02594\ \ \ \ \ \ \ \ \ \ \ comrc\ =\ \mbox{\hyperlink{commands_8c_aeb72c881aa2699aea40f45fa65cf069b}{yh\_com\_set\_log\_index}}(\&ctx,\ arg,}
\DoxyCodeLine{02595\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ctx.\mbox{\hyperlink{structyubihsm__context_addfaa9a6a08f58bdb5b5a93f2e89ccc2}{out\_fmt}}\ ==\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}}\ ?\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a4fff5e64ffe63c6c03b00438c0b09282}{fmt\_ASCII}}}
\DoxyCodeLine{02596\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ ctx.\mbox{\hyperlink{structyubihsm__context_addfaa9a6a08f58bdb5b5a93f2e89ccc2}{out\_fmt}});}
\DoxyCodeLine{02597\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_abab93648e3320de2ad5d42dfe693547b}{COM\_SUCCEED\_OR\_DIE}}(comrc,\ \textcolor{stringliteral}{"{}Unable\ to\ set\ log\ index"{}});}
\DoxyCodeLine{02598\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02599\ }
\DoxyCodeLine{02600\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ action\_arg\_blinkMINUS\_device:\ \{}
\DoxyCodeLine{02601\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(args\_info.duration\_arg\ <\ 0\ ||\ args\_info.duration\_arg\ >\ 0xff)\ \{}
\DoxyCodeLine{02602\ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Duration\ must\ be\ in\ [0,\ 256]\(\backslash\)n"{}});}
\DoxyCodeLine{02603\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a97917e1d5a9fa5e8b7a4495dc9234ac7}{rc}}\ =\ EXIT\_FAILURE;}
\DoxyCodeLine{02604\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02605\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02606\ }
\DoxyCodeLine{02607\ \ \ \ \ \ \ \ \ \ \ arg[1].\mbox{\hyperlink{struct_argument_aeb48fdf58cd895afedcbf817845d2a77}{w}}\ =\ args\_info.duration\_arg;}
\DoxyCodeLine{02608\ }
\DoxyCodeLine{02609\ \ \ \ \ \ \ \ \ \ \ comrc\ =\ \mbox{\hyperlink{commands_8c_a1d821476693df49671598a98e7d6dbca}{yh\_com\_blink}}(\&ctx,\ arg,\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}});}
\DoxyCodeLine{02610\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_abab93648e3320de2ad5d42dfe693547b}{COM\_SUCCEED\_OR\_DIE}}(comrc,\ \textcolor{stringliteral}{"{}Unable\ to\ blink\ device"{}});}
\DoxyCodeLine{02611\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02612\ }
\DoxyCodeLine{02613\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ action\_\_NULL:}
\DoxyCodeLine{02614\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_log_a83926634a3916d0927abca4aca58a60a}{printf}}(\textcolor{stringliteral}{"{}ERROR\ !\%u\ \(\backslash\)n"{}},\ args\_info.action\_given);}
\DoxyCodeLine{02615\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a97917e1d5a9fa5e8b7a4495dc9234ac7}{rc}}\ =\ EXIT\_FAILURE;}
\DoxyCodeLine{02616\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02617\ }
\DoxyCodeLine{02618\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a97917e1d5a9fa5e8b7a4495dc9234ac7}{rc}}\ ==\ EXIT\_FAILURE)\ \{}
\DoxyCodeLine{02619\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02620\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02621\ \ \ \ \ \}}
\DoxyCodeLine{02622\ }
\DoxyCodeLine{02623\ \ \ \ \ calling\_device\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02624\ }
\DoxyCodeLine{02625\ \ \ \ \ \textcolor{keywordflow}{if}\ (requires\_session\ ==\ \textcolor{keyword}{true})\ \{}
\DoxyCodeLine{02626\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm_8c_a61ab8dbab67b1cceb49cd306f8c3f4b1}{yh\_util\_close\_session}}(arg[0].e);}
\DoxyCodeLine{02627\ \ \ \ \ \}}
\DoxyCodeLine{02628\ }
\DoxyCodeLine{02629\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02630\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{namespace_i_r_aa1afcba889279fa935b76ba278be7fd6a0fc3cfbc27e91ea60a787de13dae3e3c}{num}};}
\DoxyCodeLine{02631\ \textcolor{preprocessor}{\#ifndef\ \_\_WIN32}}
\DoxyCodeLine{02632\ \ \ \ \ EditLine\ *el;}
\DoxyCodeLine{02633\ }
\DoxyCodeLine{02634\ \ \ \ \ HistEvent\ ev;}
\DoxyCodeLine{02635\ }
\DoxyCodeLine{02636\ \ \ \ \ \mbox{\hyperlink{src_2main_8c_abea0297d4e2a28933bdb9ccc03c51ebb}{g\_hist}}\ =\ history\_init();}
\DoxyCodeLine{02637\ }
\DoxyCodeLine{02638\ \ \ \ \ history(\mbox{\hyperlink{src_2main_8c_abea0297d4e2a28933bdb9ccc03c51ebb}{g\_hist}},\ \&ev,\ H\_SETSIZE,\ 100);\ \textcolor{comment}{//\ NOTE(adma):\ 100\ history\ items}}
\DoxyCodeLine{02639\ }
\DoxyCodeLine{02640\ \ \ \ \ el\ =\ el\_init(*\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}},\ stdin,\ stdout,\ stderr);}
\DoxyCodeLine{02641\ }
\DoxyCodeLine{02642\ \ \ \ \ el\_set(el,\ EL\_EDITOR,\ \textcolor{stringliteral}{"{}emacs"{}});}
\DoxyCodeLine{02643\ }
\DoxyCodeLine{02644\ \textcolor{preprocessor}{\#ifdef\ EL\_PROMPT\_ESC}}
\DoxyCodeLine{02645\ \ \ \ \ el\_set(el,\ EL\_PROMPT\_ESC,\ prompt,\ \textcolor{charliteral}{'\(\backslash\)1'});\ \textcolor{comment}{/*\ Set\ the\ prompt\ function\ */}}
\DoxyCodeLine{02646\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{02647\ \ \ \ \ el\_set(el,\ EL\_PROMPT,\ prompt);\ \textcolor{comment}{/*\ Set\ the\ prompt\ function\ */}}
\DoxyCodeLine{02648\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{/*\ EL\_PROMPT\_ESC\ */}\textcolor{preprocessor}{}}
\DoxyCodeLine{02649\ }
\DoxyCodeLine{02650\ \ \ \ \ el\_set(el,\ EL\_HIST,\ history,\ \mbox{\hyperlink{src_2main_8c_abea0297d4e2a28933bdb9ccc03c51ebb}{g\_hist}});}
\DoxyCodeLine{02651\ }
\DoxyCodeLine{02652\ \ \ \ \ \textcolor{comment}{/*\ Add\ a\ user-\/defined\ function\ \ \ \ */}}
\DoxyCodeLine{02653\ \ \ \ \ el\_set(el,\ EL\_ADDFN,\ \textcolor{stringliteral}{"{}yh\_complete"{}},\ \textcolor{stringliteral}{"{}Complete\ argument"{}},\ \mbox{\hyperlink{src_2main_8c_addae6d2b1863758ac22b845a1fada92b}{yubihsm\_complete}});}
\DoxyCodeLine{02654\ }
\DoxyCodeLine{02655\ \ \ \ \ \textcolor{comment}{/*\ Bind\ tab\ to\ it\ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{02656\ \ \ \ \ el\_set(el,\ EL\_BIND,\ \textcolor{stringliteral}{"{}\string^I"{}},\ \textcolor{stringliteral}{"{}yh\_complete"{}},\ NULL);}
\DoxyCodeLine{02657\ }
\DoxyCodeLine{02658\ \ \ \ \ el\_source(el,\ NULL);\ \textcolor{comment}{//\ NOTE(adma):\ source\ the\ user's\ defaults\ file}}
\DoxyCodeLine{02659\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02660\ }
\DoxyCodeLine{02661\ \ \ \ \ \mbox{\hyperlink{src_2main_8c_a34a9e8c400dcf19e771e884636316060}{create\_command\_list}}(\&\mbox{\hyperlink{src_2main_8c_a872d1e0eb3ee3fb13c651a1a0a8fbeb3}{g\_commands}});}
\DoxyCodeLine{02662\ }
\DoxyCodeLine{02663\ \ \ \ \ \textcolor{keywordflow}{while}\ (\mbox{\hyperlink{src_2main_8c_a82d33897ce200eadf132e93031f0e595}{g\_running}}\ ==\ \textcolor{keyword}{true})\ \{}
\DoxyCodeLine{02664\ \textcolor{preprocessor}{\#ifdef\ \_\_WIN32}}
\DoxyCodeLine{02665\ \ \ \ \ \ \ fprintf(stdout,\ \mbox{\hyperlink{src_2main_8c_accdbea14ea06c15e271784368bd993e8}{PROMPT}});}
\DoxyCodeLine{02666\ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ data[1025];}
\DoxyCodeLine{02667\ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ *\mbox{\hyperlink{yubihsm__pkcs11_8c_a855e99b645b13e7905d074d02fe0bff5}{buf}}\ =\ fgets(data,\ \textcolor{keyword}{sizeof}(data),\ stdin);}
\DoxyCodeLine{02668\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a855e99b645b13e7905d074d02fe0bff5}{buf}})\ \{}
\DoxyCodeLine{02669\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_i_r_aa1afcba889279fa935b76ba278be7fd6a0fc3cfbc27e91ea60a787de13dae3e3c}{num}}\ =\ strlen(\mbox{\hyperlink{yubihsm__pkcs11_8c_a855e99b645b13e7905d074d02fe0bff5}{buf}});}
\DoxyCodeLine{02670\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02671\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{02672\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *\mbox{\hyperlink{yubihsm__pkcs11_8c_a855e99b645b13e7905d074d02fe0bff5}{buf}}\ =\ el\_gets(el,\ \&num);}
\DoxyCodeLine{02673\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02674\ }
\DoxyCodeLine{02675\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a855e99b645b13e7905d074d02fe0bff5}{buf}}\ ==\ NULL)\ \{}
\DoxyCodeLine{02676\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ NOTE(adma):\ got\ Ctrl-\/D}}
\DoxyCodeLine{02677\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_aaec43efb95baeb7ec8f2854ffa2cb673}{yh\_com\_quit}}(NULL,\ NULL,\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}});}
\DoxyCodeLine{02678\ \ \ \ \ \ \ \ \ fprintf(stdout,\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{02679\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (num\ >\ 0\ \&\&\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a855e99b645b13e7905d074d02fe0bff5}{buf}}[0]\ !=\ \textcolor{charliteral}{'\(\backslash\)n'}\ \&\&\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a855e99b645b13e7905d074d02fe0bff5}{buf}}[0]\ !=\ \textcolor{charliteral}{'\(\backslash\)r'})\ \{}
\DoxyCodeLine{02680\ \textcolor{preprocessor}{\#ifndef\ \_\_WIN32}}
\DoxyCodeLine{02681\ \ \ \ \ \ \ \ \ history(\mbox{\hyperlink{src_2main_8c_abea0297d4e2a28933bdb9ccc03c51ebb}{g\_hist}},\ \&ev,\ H\_ENTER,\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a855e99b645b13e7905d074d02fe0bff5}{buf}});}
\DoxyCodeLine{02682\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02683\ \ \ \ \ \ \ \ \ calling\_device\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{02684\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_a29146144eaaaf11f5b49e85d4fe2bd4c}{validate\_and\_call}}(\&ctx,\ \mbox{\hyperlink{src_2main_8c_a872d1e0eb3ee3fb13c651a1a0a8fbeb3}{g\_commands}},\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a855e99b645b13e7905d074d02fe0bff5}{buf}});}
\DoxyCodeLine{02685\ \ \ \ \ \ \ \ \ calling\_device\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02686\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02687\ \ \ \ \ \}}
\DoxyCodeLine{02688\ }
\DoxyCodeLine{02689\ \textcolor{preprocessor}{\#ifndef\ \_\_WIN32}}
\DoxyCodeLine{02690\ \ \ \ \ el\_end(el);}
\DoxyCodeLine{02691\ \ \ \ \ history\_end(\mbox{\hyperlink{src_2main_8c_abea0297d4e2a28933bdb9ccc03c51ebb}{g\_hist}});}
\DoxyCodeLine{02692\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02693\ \ \ \}}
\DoxyCodeLine{02694\ }
\DoxyCodeLine{02695\ main\_exit:}
\DoxyCodeLine{02696\ }
\DoxyCodeLine{02697\ \ \ cmdline\_parser\_free(\&args\_info);}
\DoxyCodeLine{02698\ }
\DoxyCodeLine{02699\ \ \ \textcolor{keywordflow}{if}\ (ctx.\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}}\ !=\ stdout\ \&\&\ ctx.\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}}\ !=\ NULL)\ \{}
\DoxyCodeLine{02700\ \ \ \ \ fclose(ctx.\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}});}
\DoxyCodeLine{02701\ \ \ \}}
\DoxyCodeLine{02702\ }
\DoxyCodeLine{02703\ \ \ \textcolor{keywordflow}{if}\ (ctx.\mbox{\hyperlink{structyubihsm__context_a97d98362b0e43b749a9cb75da4793932}{cacert}})\ \{}
\DoxyCodeLine{02704\ \ \ \ \ free(ctx.\mbox{\hyperlink{structyubihsm__context_a97d98362b0e43b749a9cb75da4793932}{cacert}});}
\DoxyCodeLine{02705\ \ \ \}}
\DoxyCodeLine{02706\ \ \ \textcolor{keywordflow}{if}\ (ctx.\mbox{\hyperlink{structyubihsm__context_aa2578fc399603af54de958824179cae4}{proxy}})\ \{}
\DoxyCodeLine{02707\ \ \ \ \ free(ctx.\mbox{\hyperlink{structyubihsm__context_aa2578fc399603af54de958824179cae4}{proxy}});}
\DoxyCodeLine{02708\ \ \ \}}
\DoxyCodeLine{02709\ }
\DoxyCodeLine{02710\ \ \ \mbox{\hyperlink{yubihsm_8c_a36e3d9a07c6689e14a9339ca1ebb7259}{yh\_exit}}();}
\DoxyCodeLine{02711\ }
\DoxyCodeLine{02712\ \textcolor{preprocessor}{\#ifdef\ USE\_YKYH}}
\DoxyCodeLine{02713\ \ \ \mbox{\hyperlink{ykyh_8c_a6833a1e74b0e7494cc904dc94cf276c0}{ykyh\_done}}(ctx.\mbox{\hyperlink{structyubihsm__context_a2477a831d6082f899d49df85611e6e52}{state}});\ \textcolor{comment}{//\ TODO(adma):\ more\ consistent\ naming}}
\DoxyCodeLine{02714\ \ \ ctx.\mbox{\hyperlink{structyubihsm__context_a2477a831d6082f899d49df85611e6e52}{state}}\ =\ NULL;}
\DoxyCodeLine{02715\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02716\ }
\DoxyCodeLine{02717\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a97917e1d5a9fa5e8b7a4495dc9234ac7}{rc}};}
\DoxyCodeLine{02718\ \}}

\end{DoxyCode}
\Hypertarget{src_2main_8c_a00235bf23b429c75a52c7996e53e590d}\index{main.c@{main.c}!msort\_list@{msort\_list}}
\index{msort\_list@{msort\_list}!main.c@{main.c}}
\doxysubsubsection{\texorpdfstring{msort\_list()}{msort\_list()}}
{\footnotesize\ttfamily \label{src_2main_8c_a00235bf23b429c75a52c7996e53e590d} 
\mbox{\hyperlink{src_2main_8c_aee65fcec74905101a0241282bb06d451}{Command\+List}} msort\+\_\+list (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{src_2main_8c_aee65fcec74905101a0241282bb06d451}{Command\+List}}}]{list}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{src_2main_8c_source_l00137}{137}} of file \mbox{\hyperlink{src_2main_8c_source}{main.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00137\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00138\ }
\DoxyCodeLine{00139\ \ \ \mbox{\hyperlink{struct_command}{Command}}\ *left;}
\DoxyCodeLine{00140\ \ \ \mbox{\hyperlink{struct_command}{Command}}\ *right;}
\DoxyCodeLine{00141\ \ \ \mbox{\hyperlink{struct_command}{Command}}\ *e;}
\DoxyCodeLine{00142\ }
\DoxyCodeLine{00143\ \ \ \textcolor{keywordtype}{int}\ in\_size;}
\DoxyCodeLine{00144\ \ \ \textcolor{keywordtype}{int}\ left\_size;}
\DoxyCodeLine{00145\ \ \ \textcolor{keywordtype}{int}\ right\_size;}
\DoxyCodeLine{00146\ }
\DoxyCodeLine{00147\ \ \ \textcolor{comment}{//\ NOTE(adma):\ do\ nothing\ on\ an\ empty\ list}}
\DoxyCodeLine{00148\ \ \ \textcolor{keywordflow}{if}\ (!list)\ \{}
\DoxyCodeLine{00149\ \ \ \ \ \textcolor{keywordflow}{return}\ NULL;}
\DoxyCodeLine{00150\ \ \ \}}
\DoxyCodeLine{00151\ }
\DoxyCodeLine{00152\ \ \ in\_size\ =\ 1;}
\DoxyCodeLine{00153\ }
\DoxyCodeLine{00154\ \ \ \textcolor{keywordflow}{while}\ (1)\ \{}
\DoxyCodeLine{00155\ \ \ \ \ \mbox{\hyperlink{struct_command}{Command}}\ *tail\ =\ NULL;}
\DoxyCodeLine{00156\ \ \ \ \ left\ =\ list;}
\DoxyCodeLine{00157\ \ \ \ \ list\ =\ NULL;}
\DoxyCodeLine{00158\ }
\DoxyCodeLine{00159\ \ \ \ \ \textcolor{keywordtype}{int}\ n\_merges\ =\ 0;}
\DoxyCodeLine{00160\ }
\DoxyCodeLine{00161\ \ \ \ \ \textcolor{keywordflow}{while}\ (left\ !=\ NULL)\ \{}
\DoxyCodeLine{00162\ \ \ \ \ \ \ n\_merges++;}
\DoxyCodeLine{00163\ }
\DoxyCodeLine{00164\ \ \ \ \ \ \ right\ =\ left;}
\DoxyCodeLine{00165\ \ \ \ \ \ \ left\_size\ =\ 0;}
\DoxyCodeLine{00166\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ in\_size;\ i++)\ \{}
\DoxyCodeLine{00167\ \ \ \ \ \ \ \ \ left\_size++;}
\DoxyCodeLine{00168\ \ \ \ \ \ \ \ \ right\ =\ right-\/>\mbox{\hyperlink{struct_command_af9c9ea6f57adad15eb7af71d6834d0b4}{next}};}
\DoxyCodeLine{00169\ }
\DoxyCodeLine{00170\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (right\ ==\ NULL)\ \{}
\DoxyCodeLine{00171\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00172\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00173\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00174\ }
\DoxyCodeLine{00175\ \ \ \ \ \ \ right\_size\ =\ in\_size;}
\DoxyCodeLine{00176\ }
\DoxyCodeLine{00177\ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (left\_size\ >\ 0\ ||\ (right\_size\ >\ 0\ \&\&\ right))\ \{}
\DoxyCodeLine{00178\ }
\DoxyCodeLine{00179\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (left\_size\ ==\ 0)\ \{}
\DoxyCodeLine{00180\ \ \ \ \ \ \ \ \ \ \ e\ =\ right;}
\DoxyCodeLine{00181\ \ \ \ \ \ \ \ \ \ \ right\ =\ right-\/>\mbox{\hyperlink{struct_command_af9c9ea6f57adad15eb7af71d6834d0b4}{next}};}
\DoxyCodeLine{00182\ \ \ \ \ \ \ \ \ \ \ right\_size-\/-\/;}
\DoxyCodeLine{00183\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (right\_size\ ==\ 0\ ||\ !right)\ \{}
\DoxyCodeLine{00184\ \ \ \ \ \ \ \ \ \ \ e\ =\ left;}
\DoxyCodeLine{00185\ \ \ \ \ \ \ \ \ \ \ left\ =\ left-\/>\mbox{\hyperlink{struct_command_af9c9ea6f57adad15eb7af71d6834d0b4}{next}};}
\DoxyCodeLine{00186\ \ \ \ \ \ \ \ \ \ \ left\_size-\/-\/;}
\DoxyCodeLine{00187\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (strcmp(left-\/>\mbox{\hyperlink{struct_command_aac61810b8e87055d1648ec142086eb0e}{name}},\ right-\/>\mbox{\hyperlink{struct_command_aac61810b8e87055d1648ec142086eb0e}{name}})\ <=\ 0)\ \{}
\DoxyCodeLine{00188\ \ \ \ \ \ \ \ \ \ \ e\ =\ left;}
\DoxyCodeLine{00189\ \ \ \ \ \ \ \ \ \ \ left\ =\ left-\/>\mbox{\hyperlink{struct_command_af9c9ea6f57adad15eb7af71d6834d0b4}{next}};}
\DoxyCodeLine{00190\ \ \ \ \ \ \ \ \ \ \ left\_size-\/-\/;}
\DoxyCodeLine{00191\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00192\ \ \ \ \ \ \ \ \ \ \ e\ =\ right;}
\DoxyCodeLine{00193\ \ \ \ \ \ \ \ \ \ \ right\ =\ right-\/>\mbox{\hyperlink{struct_command_af9c9ea6f57adad15eb7af71d6834d0b4}{next}};}
\DoxyCodeLine{00194\ \ \ \ \ \ \ \ \ \ \ right\_size-\/-\/;}
\DoxyCodeLine{00195\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00196\ }
\DoxyCodeLine{00197\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (tail)\ \{}
\DoxyCodeLine{00198\ \ \ \ \ \ \ \ \ \ \ tail-\/>\mbox{\hyperlink{struct_command_af9c9ea6f57adad15eb7af71d6834d0b4}{next}}\ =\ e;}
\DoxyCodeLine{00199\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00200\ \ \ \ \ \ \ \ \ \ \ list\ =\ e;}
\DoxyCodeLine{00201\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00202\ }
\DoxyCodeLine{00203\ \ \ \ \ \ \ \ \ tail\ =\ e;}
\DoxyCodeLine{00204\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00205\ }
\DoxyCodeLine{00206\ \ \ \ \ \ \ left\ =\ right;}
\DoxyCodeLine{00207\ \ \ \ \ \}}
\DoxyCodeLine{00208\ }
\DoxyCodeLine{00209\ \ \ \ \ \textcolor{keywordflow}{if}\ (tail\ !=\ NULL)\ \{}
\DoxyCodeLine{00210\ \ \ \ \ \ \ tail-\/>\mbox{\hyperlink{struct_command_af9c9ea6f57adad15eb7af71d6834d0b4}{next}}\ =\ NULL;}
\DoxyCodeLine{00211\ \ \ \ \ \}}
\DoxyCodeLine{00212\ }
\DoxyCodeLine{00213\ \ \ \ \ \textcolor{keywordflow}{if}\ (n\_merges\ <=\ 1)\ \{}
\DoxyCodeLine{00214\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ list;}
\DoxyCodeLine{00215\ \ \ \ \ \}}
\DoxyCodeLine{00216\ }
\DoxyCodeLine{00217\ \ \ \ \ in\_size\ *=\ 2;}
\DoxyCodeLine{00218\ \ \ \}}
\DoxyCodeLine{00219\ \}}

\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{src_2main_8c_a00235bf23b429c75a52c7996e53e590d_icgraph}
\end{center}
\end{figure}
\Hypertarget{src_2main_8c_adf60c5d85f9b442e0c7a42235207a241}\index{main.c@{main.c}!register\_command@{register\_command}}
\index{register\_command@{register\_command}!main.c@{main.c}}
\doxysubsubsection{\texorpdfstring{register\_command()}{register\_command()}}
{\footnotesize\ttfamily \label{src_2main_8c_adf60c5d85f9b442e0c7a42235207a241} 
\mbox{\hyperlink{struct_command}{Command}} \texorpdfstring{$\ast$}{*} register\+\_\+command (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{src_2main_8c_aee65fcec74905101a0241282bb06d451}{Command\+List}}}]{list}{, }\item[{\mbox{\hyperlink{struct_command}{Command}}}]{command}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{src_2main_8c_source_l00112}{112}} of file \mbox{\hyperlink{src_2main_8c_source}{main.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00112\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00113\ }
\DoxyCodeLine{00114\ \ \ \mbox{\hyperlink{struct_command}{Command}}\ *c\ =\ calloc(1,\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{struct_command}{Command}}));}
\DoxyCodeLine{00115\ }
\DoxyCodeLine{00116\ \ \ assert(strlen(command.\mbox{\hyperlink{struct_command_aac61810b8e87055d1648ec142086eb0e}{name}})\ <=\ \mbox{\hyperlink{src_2main_8c_a866387736d29c2363110c4ed0c0fad59}{MAX\_COMMAND\_NAME}});}
\DoxyCodeLine{00117\ }
\DoxyCodeLine{00118\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(c,\ \&command,\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{struct_command}{Command}}));}
\DoxyCodeLine{00119\ \ \ c-\/>\mbox{\hyperlink{struct_command_af9c9ea6f57adad15eb7af71d6834d0b4}{next}}\ =\ list;}
\DoxyCodeLine{00120\ }
\DoxyCodeLine{00121\ \ \ \textcolor{keywordflow}{return}\ c;}
\DoxyCodeLine{00122\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=266pt]{src_2main_8c_adf60c5d85f9b442e0c7a42235207a241_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{src_2main_8c_adf60c5d85f9b442e0c7a42235207a241_icgraph}
\end{center}
\end{figure}
\Hypertarget{src_2main_8c_aee871967a1e47d3fca17a36cf48e6da6}\index{main.c@{main.c}!register\_subcommand@{register\_subcommand}}
\index{register\_subcommand@{register\_subcommand}!main.c@{main.c}}
\doxysubsubsection{\texorpdfstring{register\_subcommand()}{register\_subcommand()}}
{\footnotesize\ttfamily \label{src_2main_8c_aee871967a1e47d3fca17a36cf48e6da6} 
void register\+\_\+subcommand (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{struct_command}{Command}} \texorpdfstring{$\ast$}{*}}]{parent}{, }\item[{\mbox{\hyperlink{struct_command}{Command}}}]{command}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{src_2main_8c_source_l00124}{124}} of file \mbox{\hyperlink{src_2main_8c_source}{main.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00124\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00125\ }
\DoxyCodeLine{00126\ \ \ \mbox{\hyperlink{struct_command}{Command}}\ *c\ =\ malloc(\textcolor{keyword}{sizeof}(\mbox{\hyperlink{struct_command}{Command}}));}
\DoxyCodeLine{00127\ }
\DoxyCodeLine{00128\ \ \ \textcolor{keywordflow}{if}\ (c\ ==\ NULL)\ \{}
\DoxyCodeLine{00129\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ allocate\ memory\(\backslash\)n"{}});}
\DoxyCodeLine{00130\ \ \ \ \ exit(EXIT\_FAILURE);}
\DoxyCodeLine{00131\ \ \ \}}
\DoxyCodeLine{00132\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(c,\ \&command,\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{struct_command}{Command}}));}
\DoxyCodeLine{00133\ \ \ c-\/>\mbox{\hyperlink{struct_command_af9c9ea6f57adad15eb7af71d6834d0b4}{next}}\ =\ parent-\/>\mbox{\hyperlink{struct_command_ad9daf42f96efe8bfbad34fb534f1546d}{subcommands}};}
\DoxyCodeLine{00134\ \ \ parent-\/>\mbox{\hyperlink{struct_command_ad9daf42f96efe8bfbad34fb534f1546d}{subcommands}}\ =\ c;}
\DoxyCodeLine{00135\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=282pt]{src_2main_8c_aee871967a1e47d3fca17a36cf48e6da6_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{src_2main_8c_aee871967a1e47d3fca17a36cf48e6da6_icgraph}
\end{center}
\end{figure}
\Hypertarget{src_2main_8c_a2324bfd26dadd085f211c969ccfcabf2}\index{main.c@{main.c}!tokenize@{tokenize}}
\index{tokenize@{tokenize}!main.c@{main.c}}
\doxysubsubsection{\texorpdfstring{tokenize()}{tokenize()}}
{\footnotesize\ttfamily \label{src_2main_8c_a2324bfd26dadd085f211c969ccfcabf2} 
int tokenize (\begin{DoxyParamCaption}\item[{char \texorpdfstring{$\ast$}{*}}]{line}{, }\item[{char \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}}]{toks}{, }\item[{int}]{max\+\_\+toks}{, }\item[{int \texorpdfstring{$\ast$}{*}}]{cursorc}{, }\item[{int \texorpdfstring{$\ast$}{*}}]{cursoro}{, }\item[{const char \texorpdfstring{$\ast$}{*}}]{space}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{src_2main_8c_source_l00852}{852}} of file \mbox{\hyperlink{src_2main_8c_source}{main.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00853\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00854\ \ \ \textcolor{keywordtype}{int}\ i;}
\DoxyCodeLine{00855\ \ \ \textcolor{keywordtype}{int}\ tok\ =\ 0;}
\DoxyCodeLine{00856\ \ \ \textcolor{keywordtype}{int}\ length\ =\ strlen(line);}
\DoxyCodeLine{00857\ \ \ \textcolor{keywordtype}{int}\ start\_of\_word\ =\ 0;}
\DoxyCodeLine{00858\ \ \ \textcolor{keyword}{enum}\ states\ \{\ SPACE,\ WORD,\ QUOTE\ \}\ \mbox{\hyperlink{structstate}{state}}\ =\ SPACE;}
\DoxyCodeLine{00859\ \ \ toks[0]\ =\ \mbox{\hyperlink{namespacevalidate__reflection_a54d4e98ade8417b88a7e3859a693630a}{line}};\ \textcolor{comment}{//\ set\ up\ as\ fall-\/through}}
\DoxyCodeLine{00860\ }
\DoxyCodeLine{00861\ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0;\ i\ <=\ length;\ i++)\ \{}
\DoxyCodeLine{00862\ \ \ \ \ \textcolor{keywordtype}{char}\ c\ =\ \mbox{\hyperlink{namespacevalidate__reflection_a54d4e98ade8417b88a7e3859a693630a}{line}}[i];}
\DoxyCodeLine{00863\ \ \ \ \ \textcolor{keywordflow}{if}\ (cursorc\ \&\&\ i\ ==\ *cursorc\ \&\&\ tok\ >\ 0)\ \{}
\DoxyCodeLine{00864\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{structstate}{state}}\ ==\ SPACE)\ \{}
\DoxyCodeLine{00865\ \ \ \ \ \ \ \ \ *cursoro\ =\ 0;}
\DoxyCodeLine{00866\ \ \ \ \ \ \ \ \ *cursorc\ =\ tok;}
\DoxyCodeLine{00867\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00868\ \ \ \ \ \ \ \ \ *cursoro\ =\ i\ -\/\ start\_of\_word;}
\DoxyCodeLine{00869\ \ \ \ \ \ \ \ \ *cursorc\ =\ tok\ -\/\ 1;}
\DoxyCodeLine{00870\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00871\ \ \ \ \ \}}
\DoxyCodeLine{00872\ \ \ \ \ \textcolor{keywordflow}{if}\ (c\ ==\ \textcolor{charliteral}{'\(\backslash\)0'})\ \{}
\DoxyCodeLine{00873\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00874\ \ \ \ \ \}}
\DoxyCodeLine{00875\ \ \ \ \ \textcolor{keywordflow}{if}\ (tok\ >=\ max\_toks)\ \{}
\DoxyCodeLine{00876\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{00877\ \ \ \ \ \}}
\DoxyCodeLine{00878\ \ \ \ \ \textcolor{keywordflow}{switch}\ (\mbox{\hyperlink{structstate}{state}})\ \{}
\DoxyCodeLine{00879\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ SPACE:\ \{}
\DoxyCodeLine{00880\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ found\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00881\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a538d097420e725c4dad63c3caa9e55bd}{j}}\ =\ 0;\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a538d097420e725c4dad63c3caa9e55bd}{j}}\ <\ strlen(space);\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a538d097420e725c4dad63c3caa9e55bd}{j}}++)\ \{}
\DoxyCodeLine{00882\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (c\ ==\ space[\mbox{\hyperlink{yubihsm__pkcs11_8c_a538d097420e725c4dad63c3caa9e55bd}{j}}])\ \{}
\DoxyCodeLine{00883\ \ \ \ \ \ \ \ \ \ \ \ \ found\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00884\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00885\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00886\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00887\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (found)\ \{}
\DoxyCodeLine{00888\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00889\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00890\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (c\ ==\ \textcolor{charliteral}{'"{}'})\ \{}
\DoxyCodeLine{00891\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structstate}{state}}\ =\ QUOTE;}
\DoxyCodeLine{00892\ \ \ \ \ \ \ \ \ \ \ start\_of\_word\ =\ i\ +\ 1;}
\DoxyCodeLine{00893\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (c\ ==\ \textcolor{charliteral}{'\#'})\ \{}
\DoxyCodeLine{00894\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ tok;}
\DoxyCodeLine{00895\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00896\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structstate}{state}}\ =\ WORD;}
\DoxyCodeLine{00897\ \ \ \ \ \ \ \ \ \ \ start\_of\_word\ =\ i;}
\DoxyCodeLine{00898\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00899\ \ \ \ \ \ \ \ \ toks[tok++]\ =\ \mbox{\hyperlink{namespacevalidate__reflection_a54d4e98ade8417b88a7e3859a693630a}{line}}\ +\ start\_of\_word;}
\DoxyCodeLine{00900\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00901\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ QUOTE:}
\DoxyCodeLine{00902\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (c\ ==\ \textcolor{charliteral}{'"{}'})\ \{}
\DoxyCodeLine{00903\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacevalidate__reflection_a54d4e98ade8417b88a7e3859a693630a}{line}}[i]\ =\ \textcolor{charliteral}{'\(\backslash\)0'};}
\DoxyCodeLine{00904\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structstate}{state}}\ =\ SPACE;}
\DoxyCodeLine{00905\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00906\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00907\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ WORD:}
\DoxyCodeLine{00908\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a538d097420e725c4dad63c3caa9e55bd}{j}}\ =\ 0;\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a538d097420e725c4dad63c3caa9e55bd}{j}}\ <\ strlen(space);\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a538d097420e725c4dad63c3caa9e55bd}{j}}++)\ \{}
\DoxyCodeLine{00909\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (c\ ==\ space[\mbox{\hyperlink{yubihsm__pkcs11_8c_a538d097420e725c4dad63c3caa9e55bd}{j}}])\ \{}
\DoxyCodeLine{00910\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacevalidate__reflection_a54d4e98ade8417b88a7e3859a693630a}{line}}[i]\ =\ \textcolor{charliteral}{'\(\backslash\)0'};}
\DoxyCodeLine{00911\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structstate}{state}}\ =\ SPACE;}
\DoxyCodeLine{00912\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00913\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00914\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00915\ \ \ \ \ \}}
\DoxyCodeLine{00916\ \ \ \}}
\DoxyCodeLine{00917\ \ \ \textcolor{keywordflow}{return}\ tok;}
\DoxyCodeLine{00918\ \}}

\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{src_2main_8c_a2324bfd26dadd085f211c969ccfcabf2_icgraph}
\end{center}
\end{figure}
\Hypertarget{src_2main_8c_a29146144eaaaf11f5b49e85d4fe2bd4c}\index{main.c@{main.c}!validate\_and\_call@{validate\_and\_call}}
\index{validate\_and\_call@{validate\_and\_call}!main.c@{main.c}}
\doxysubsubsection{\texorpdfstring{validate\_and\_call()}{validate\_and\_call()}}
{\footnotesize\ttfamily \label{src_2main_8c_a29146144eaaaf11f5b49e85d4fe2bd4c} 
int validate\+\_\+and\+\_\+call (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{src_2main_8c_aee65fcec74905101a0241282bb06d451}{Command\+List}}}]{l}{, }\item[{const char \texorpdfstring{$\ast$}{*}}]{line}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{src_2main_8c_source_l01507}{1507}} of file \mbox{\hyperlink{src_2main_8c_source}{main.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01507\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01508\ }
\DoxyCodeLine{01509\ \ \ \textcolor{keywordtype}{int}\ argc\ =\ 0;}
\DoxyCodeLine{01510\ \ \ \textcolor{keywordtype}{char}\ *\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[64];}
\DoxyCodeLine{01511\ \ \ \textcolor{keywordtype}{int}\ i\ =\ 0;}
\DoxyCodeLine{01512\ }
\DoxyCodeLine{01513\ \ \ \textcolor{keywordtype}{char}\ data[\mbox{\hyperlink{src_2main_8c_ad9514bbc324b3ddd5f2ad47dcf4aa5e3}{ARGS\_BUFFER\_SIZE}}\ +\ 1];}
\DoxyCodeLine{01514\ }
\DoxyCodeLine{01515\ \ \ \textcolor{keywordtype}{char}\ arg\_data[\mbox{\hyperlink{src_2main_8c_ad9514bbc324b3ddd5f2ad47dcf4aa5e3}{ARGS\_BUFFER\_SIZE}}\ +\ 1]\ =\ \{0\};}
\DoxyCodeLine{01516\ }
\DoxyCodeLine{01517\ \ \ \mbox{\hyperlink{struct_command}{Command}}\ *command\ =\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a89606eca6b563ec68d2da2e84657736f}{l}};}
\DoxyCodeLine{01518\ }
\DoxyCodeLine{01519\ \ \ \textcolor{keywordtype}{bool}\ completing\_args\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01520\ }
\DoxyCodeLine{01521\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *\mbox{\hyperlink{namespacebenchmark_compile_ad0ed96ae1454e4347ca61ac3887c379e}{args}}\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{01522\ }
\DoxyCodeLine{01523\ \ \ \mbox{\hyperlink{struct_argument}{Argument}}\ arguments[\mbox{\hyperlink{src_2main_8c_a0edb60dab8dbc580a40d8d987492631f}{MAX\_ARGUMENTS}}]\ =\ \{\{\{0\},\ 0,\ 0\}\};}
\DoxyCodeLine{01524\ \ \ \textcolor{keywordtype}{int}\ n\_arguments\ =\ 0;}
\DoxyCodeLine{01525\ }
\DoxyCodeLine{01526\ \ \ \textcolor{keywordtype}{bool}\ invalid\_arg\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01527\ }
\DoxyCodeLine{01528\ \ \ \textcolor{keywordtype}{int}\ match;}
\DoxyCodeLine{01529\ }
\DoxyCodeLine{01530\ \ \ \textcolor{keywordtype}{bool}\ found\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01531\ }
\DoxyCodeLine{01532\ \ \ \mbox{\hyperlink{commands_8h_ade4d2f5e7e712bfda5f5d7a664b13460}{CommandFunction}}\ *\mbox{\hyperlink{namespacesysio_1_1vm_aea2b0c85e98f4073b07115a97b46ae55a6b56c53a1b24e55124ff7f71bb9817d2}{func}}\ =\ NULL;}
\DoxyCodeLine{01533\ }
\DoxyCodeLine{01534\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_adc4bd59a60361844aa0e852efa210105}{memset}}(data,\ 0x0,\ \textcolor{keyword}{sizeof}(data));}
\DoxyCodeLine{01535\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_adc4bd59a60361844aa0e852efa210105}{memset}}(arg\_data,\ 0x0,\ \textcolor{keyword}{sizeof}(data));}
\DoxyCodeLine{01536\ }
\DoxyCodeLine{01537\ \ \ \textcolor{keywordflow}{if}\ (strlen(line)\ >\ \mbox{\hyperlink{src_2main_8c_ad9514bbc324b3ddd5f2ad47dcf4aa5e3}{ARGS\_BUFFER\_SIZE}})\ \{}
\DoxyCodeLine{01538\ \ \ \ \ \mbox{\hyperlink{namespace_log_a83926634a3916d0927abca4aca58a60a}{printf}}(\textcolor{stringliteral}{"{}Command\ too\ long\(\backslash\)n"{}});}
\DoxyCodeLine{01539\ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{01540\ \ \ \}}
\DoxyCodeLine{01541\ }
\DoxyCodeLine{01542\ \ \ strcpy(data,\ line);}
\DoxyCodeLine{01543\ }
\DoxyCodeLine{01544\ \ \ argc\ =\ \mbox{\hyperlink{src_2main_8c_a2324bfd26dadd085f211c969ccfcabf2}{tokenize}}(data,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}},\ 64,\ NULL,\ NULL,\ \mbox{\hyperlink{src_2main_8c_a1a9b6f40de4cd7ffb57dd5abf8ec1f03}{SPACES}});}
\DoxyCodeLine{01545\ }
\DoxyCodeLine{01546\ \ \ \textcolor{keywordflow}{while}\ (i\ <\ argc)\ \{}
\DoxyCodeLine{01547\ \ \ \ \ \textcolor{comment}{//\ NOTE(adma):\ match\ the\ first\ n-\/1\ items}}
\DoxyCodeLine{01548\ \ \ \ \ \textcolor{keywordflow}{if}\ (completing\_args\ ==\ \textcolor{keyword}{false})\ \{}
\DoxyCodeLine{01549\ \ \ \ \ \ \ \textcolor{comment}{//\ NOTE(adma):\ match\ subcommands}}
\DoxyCodeLine{01550\ \ \ \ \ \ \ match\ =\ strncmp(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[i],\ command-\/>\mbox{\hyperlink{struct_command_aac61810b8e87055d1648ec142086eb0e}{name}},\ strlen(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[i]));}
\DoxyCodeLine{01551\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (match\ ==\ 0)\ \{}
\DoxyCodeLine{01552\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (command-\/>\mbox{\hyperlink{struct_command_ad9daf42f96efe8bfbad34fb534f1546d}{subcommands}}\ !=\ NULL)\ \{}
\DoxyCodeLine{01553\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ NOTE(adma):\ if\ we\ were\ matching\ subcommands,\ keep}}
\DoxyCodeLine{01554\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ matching\ subcommands\ if\ any}}
\DoxyCodeLine{01555\ \ \ \ \ \ \ \ \ \ \ command\ =\ command-\/>\mbox{\hyperlink{struct_command_ad9daf42f96efe8bfbad34fb534f1546d}{subcommands}};}
\DoxyCodeLine{01556\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01557\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ NOTE(adma):\ start\ matching\ arguments\ otherwise.\ Also\ keep}}
\DoxyCodeLine{01558\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ track\ of\ the\ function\ because\ that's\ the\ one\ we\ want\ to}}
\DoxyCodeLine{01559\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ call\ later\ on}}
\DoxyCodeLine{01560\ \ \ \ \ \ \ \ \ \ \ completing\_args\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01561\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesysio_1_1vm_aea2b0c85e98f4073b07115a97b46ae55a6b56c53a1b24e55124ff7f71bb9817d2}{func}}\ =\ command-\/>\mbox{\hyperlink{struct_command_a8a971242e14fd48eee7def6e96139772}{func}};}
\DoxyCodeLine{01562\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (command-\/>\mbox{\hyperlink{struct_command_a07afbf564c2e3b7b8d310e22a301dfba}{args}}\ !=\ NULL)\ \{}
\DoxyCodeLine{01563\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ *arg\_toks[64];}
\DoxyCodeLine{01564\ }
\DoxyCodeLine{01565\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacebenchmark_compile_ad0ed96ae1454e4347ca61ac3887c379e}{args}}\ =\ command-\/>\mbox{\hyperlink{struct_command_a07afbf564c2e3b7b8d310e22a301dfba}{args}};}
\DoxyCodeLine{01566\ \ \ \ \ \ \ \ \ \ \ \ \ strncpy(arg\_data,\ args,}
\DoxyCodeLine{01567\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_ad9514bbc324b3ddd5f2ad47dcf4aa5e3}{ARGS\_BUFFER\_SIZE}});\ \textcolor{comment}{//\ since\ tokenize()\ modifies\ the\ buffer..}}
\DoxyCodeLine{01568\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ num\_args\ =\ \mbox{\hyperlink{src_2main_8c_a2324bfd26dadd085f211c969ccfcabf2}{tokenize}}(arg\_data,\ arg\_toks,\ 64,\ NULL,\ NULL,\ \textcolor{stringliteral}{"{},"{}});}
\DoxyCodeLine{01569\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (num\_args\ +\ 1\ +\ i\ !=}
\DoxyCodeLine{01570\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ argc)\ \{\ \textcolor{comment}{//\ some\ arguments\ might\ have\ default\ values}}
\DoxyCodeLine{01571\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a538d097420e725c4dad63c3caa9e55bd}{j}}\ =\ 0;\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a538d097420e725c4dad63c3caa9e55bd}{j}}\ <\ num\_args;\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a538d097420e725c4dad63c3caa9e55bd}{j}}++)\ \{}
\DoxyCodeLine{01572\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a538d097420e725c4dad63c3caa9e55bd}{j}}\ <\ argc\ -\/\ 1\ -\/\ i)\ \{}
\DoxyCodeLine{01573\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{01574\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01575\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ *\mbox{\hyperlink{namespace_c_l_i_1_1detail_ab4542375c903302c3876ce0403d55596}{str}}\ =\ strchr(arg\_toks[\mbox{\hyperlink{yubihsm__pkcs11_8c_a538d097420e725c4dad63c3caa9e55bd}{j}}],\ \textcolor{charliteral}{'='});}
\DoxyCodeLine{01576\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (str\ ==\ NULL)\ \{}
\DoxyCodeLine{01577\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01578\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01579\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_c_l_i_1_1detail_ab4542375c903302c3876ce0403d55596}{str}}++;}
\DoxyCodeLine{01580\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[\mbox{\hyperlink{yubihsm__pkcs11_8c_a538d097420e725c4dad63c3caa9e55bd}{j}}\ +\ 1\ +\ i]\ =\ \mbox{\hyperlink{namespace_c_l_i_1_1detail_ab4542375c903302c3876ce0403d55596}{str}};}
\DoxyCodeLine{01581\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ argc++;}
\DoxyCodeLine{01582\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01583\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01584\ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01585\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ NOTE(adma):\ there\ are\ no\ args\ for\ this\ command}}
\DoxyCodeLine{01586\ \ \ \ \ \ \ \ \ \ \ \ \ found\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01587\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01588\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01589\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01590\ \ \ \ \ \ \ \ \ i++;\ \textcolor{comment}{//\ NOTE(adma):\ next\ word}}
\DoxyCodeLine{01591\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01592\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ NOTE(adma):\ command\ not\ found}}
\DoxyCodeLine{01593\ \ \ \ \ \ \ \ \ command\ =\ command-\/>\mbox{\hyperlink{struct_command_af9c9ea6f57adad15eb7af71d6834d0b4}{next}};}
\DoxyCodeLine{01594\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (match\ <\ 0\ ||\ command\ ==\ NULL)\ \{}
\DoxyCodeLine{01595\ \ \ \ \ \ \ \ \ \ \ command\ =\ NULL;}
\DoxyCodeLine{01596\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01597\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01598\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01599\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01600\ \ \ \ \ \ \ \textcolor{comment}{//\ NOTE(adma):\ match\ arguments}}
\DoxyCodeLine{01601\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{src_2main_8c_a4f0deecffa91ccb37fdf866d83789e8c}{validate\_arg}}(ctx,\ *args,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[i],\ arguments\ +\ n\_arguments++,}
\DoxyCodeLine{01602\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ctx-\/>\mbox{\hyperlink{structyubihsm__context_a44a581dfcadf23981c3b9b7af51711a0}{in\_fmt}}\ !=\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}}\ ?\ ctx-\/>\mbox{\hyperlink{structyubihsm__context_a44a581dfcadf23981c3b9b7af51711a0}{in\_fmt}}}
\DoxyCodeLine{01603\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ command-\/>\mbox{\hyperlink{struct_command_abad30cca1f06998227b93d202e663d06}{in\_fmt}})\ !=\ 0)\ \{}
\DoxyCodeLine{01604\ \ \ \ \ \ \ \ \ invalid\_arg\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01605\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01606\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01607\ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (*args\ !=\ \textcolor{charliteral}{'\(\backslash\)0'}\ \&\&\ *args\ !=\ \textcolor{charliteral}{','})\ \{}
\DoxyCodeLine{01608\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacebenchmark_compile_ad0ed96ae1454e4347ca61ac3887c379e}{args}}++;}
\DoxyCodeLine{01609\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01610\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (*args\ ==\ \textcolor{charliteral}{','})\ \{}
\DoxyCodeLine{01611\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacebenchmark_compile_ad0ed96ae1454e4347ca61ac3887c379e}{args}}++;}
\DoxyCodeLine{01612\ \ \ \ \ \ \ \ \ i++;\ \textcolor{comment}{//\ NOTE(adma):\ next\ word}}
\DoxyCodeLine{01613\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01614\ \ \ \ \ \ \ \ \ found\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01615\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01616\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01617\ \ \ \ \ \}}
\DoxyCodeLine{01618\ \ \ \}}
\DoxyCodeLine{01619\ }
\DoxyCodeLine{01620\ \ \ \textcolor{keywordflow}{if}\ (found\ ==\ \textcolor{keyword}{true})\ \{}
\DoxyCodeLine{01621\ \ \ \ \ \mbox{\hyperlink{namespacesysio_1_1vm_aea2b0c85e98f4073b07115a97b46ae55a6b56c53a1b24e55124ff7f71bb9817d2}{func}}(ctx,\ arguments,}
\DoxyCodeLine{01622\ \ \ \ \ \ \ \ \ \ ctx-\/>\mbox{\hyperlink{structyubihsm__context_addfaa9a6a08f58bdb5b5a93f2e89ccc2}{out\_fmt}}\ ==\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}}\ ?\ command-\/>\mbox{\hyperlink{struct_command_ad55d0a6b1d2d67a2094b401a88d8007c}{out\_fmt}}\ :\ ctx-\/>\mbox{\hyperlink{structyubihsm__context_addfaa9a6a08f58bdb5b5a93f2e89ccc2}{out\_fmt}});}
\DoxyCodeLine{01623\ }
\DoxyCodeLine{01624\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ n\_arguments;\ i++)\ \{}
\DoxyCodeLine{01625\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (arguments[i].x\ !=\ NULL)\ \{}
\DoxyCodeLine{01626\ \ \ \ \ \ \ \ \ free(arguments[i].x);}
\DoxyCodeLine{01627\ \ \ \ \ \ \ \ \ arguments[i].\mbox{\hyperlink{struct_argument_a988ffa3a53329017f0fdc315cc61dc49}{x}}\ =\ NULL;}
\DoxyCodeLine{01628\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01629\ \ \ \ \ \}}
\DoxyCodeLine{01630\ \ \ \ \ \textcolor{comment}{//\ NOTE:\ if\ ctx-\/>in\ or\ ctx-\/>out\ is\ changed,\ close\ and\ return\ state,}}
\DoxyCodeLine{01631\ \ \ \ \ \textcolor{comment}{//\ otherwise\ the\ next\ command\ that\ needs\ a\ file\ might\ get\ sad.}}
\DoxyCodeLine{01632\ \ \ \ \ \textcolor{keywordflow}{if}\ (ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}}\ !=\ stdout)\ \{}
\DoxyCodeLine{01633\ \ \ \ \ \ \ fclose(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}});}
\DoxyCodeLine{01634\ \ \ \ \ \ \ ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}}\ =\ stdout;}
\DoxyCodeLine{01635\ \ \ \ \ \}}
\DoxyCodeLine{01636\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01637\ \ \ \ \ \textcolor{keywordflow}{if}\ (invalid\_arg\ ==\ \textcolor{keyword}{true})\ \{}
\DoxyCodeLine{01638\ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ arg[\mbox{\hyperlink{src_2main_8c_ad9514bbc324b3ddd5f2ad47dcf4aa5e3}{ARGS\_BUFFER\_SIZE}}\ +\ 1];}
\DoxyCodeLine{01639\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_adc4bd59a60361844aa0e852efa210105}{memset}}(arg,\ 0x0,\ \textcolor{keyword}{sizeof}(arg));}
\DoxyCodeLine{01640\ \ \ \ \ \ \ strncpy(arg,\ args,\ \mbox{\hyperlink{src_2main_8c_ad9514bbc324b3ddd5f2ad47dcf4aa5e3}{ARGS\_BUFFER\_SIZE}});}
\DoxyCodeLine{01641\ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ *end\ =\ strchr(args,\ \textcolor{charliteral}{','});}
\DoxyCodeLine{01642\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (end)\ \{}
\DoxyCodeLine{01643\ \ \ \ \ \ \ \ \ arg[end\ -\/\ \mbox{\hyperlink{namespacebenchmark_compile_ad0ed96ae1454e4347ca61ac3887c379e}{args}}]\ =\ \textcolor{charliteral}{'\(\backslash\)0'};}
\DoxyCodeLine{01644\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01645\ \ \ \ \ \ \ \mbox{\hyperlink{namespace_log_a83926634a3916d0927abca4aca58a60a}{printf}}(\textcolor{stringliteral}{"{}Invalid\ argument\ \%d:\ \%s\ (\%s)\(\backslash\)n"{}},\ i,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[i],\ arg);}
\DoxyCodeLine{01646\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (command\ ==\ NULL)\ \{}
\DoxyCodeLine{01647\ \ \ \ \ \ \ \mbox{\hyperlink{namespace_log_a83926634a3916d0927abca4aca58a60a}{printf}}(\textcolor{stringliteral}{"{}Command\ \%s\%s\%s\ not\ found\(\backslash\)n"{}},\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0],\ i\ ?\ \textcolor{stringliteral}{"{}\ "{}}\ :\ \textcolor{stringliteral}{"{}"{}},}
\DoxyCodeLine{01648\ \ \ \ \ \ \ \ \ \ \ \ \ \ i\ ?\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1]\ :\ \textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{01649\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (*args\ !=\ \textcolor{charliteral}{'\(\backslash\)0'}\ ||\ argc\ -\/\ 1\ ==\ 0)\ \{}
\DoxyCodeLine{01650\ \ \ \ \ \ \ \mbox{\hyperlink{namespace_log_a83926634a3916d0927abca4aca58a60a}{printf}}(\textcolor{stringliteral}{"{}Incomplete\ command\(\backslash\)n"{}});}
\DoxyCodeLine{01651\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ argc;\ i++)\ \{}
\DoxyCodeLine{01652\ \ \ \ \ \ \ \ \ arguments[i].\mbox{\hyperlink{struct_argument_a5054bf8f827d48bc83f9763d5e78b786}{s}}\ =\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[i];}
\DoxyCodeLine{01653\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01654\ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8c_a0f55f786bda19a4380614a719cf93faf}{yh\_com\_help}}(NULL,\ arguments,\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}});}
\DoxyCodeLine{01655\ \ \ \ \ \}}
\DoxyCodeLine{01656\ \ \ \}}
\DoxyCodeLine{01657\ }
\DoxyCodeLine{01658\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{01659\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{src_2main_8c_a29146144eaaaf11f5b49e85d4fe2bd4c_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=244pt]{src_2main_8c_a29146144eaaaf11f5b49e85d4fe2bd4c_icgraph}
\end{center}
\end{figure}
\Hypertarget{src_2main_8c_a4f0deecffa91ccb37fdf866d83789e8c}\index{main.c@{main.c}!validate\_arg@{validate\_arg}}
\index{validate\_arg@{validate\_arg}!main.c@{main.c}}
\doxysubsubsection{\texorpdfstring{validate\_arg()}{validate\_arg()}}
{\footnotesize\ttfamily \label{src_2main_8c_a4f0deecffa91ccb37fdf866d83789e8c} 
int validate\+\_\+arg (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{char}]{type}{, }\item[{const char \texorpdfstring{$\ast$}{*}}]{value}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{parsed}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{src_2main_8c_source_l01383}{1383}} of file \mbox{\hyperlink{src_2main_8c_source}{main.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01384\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01385\ }
\DoxyCodeLine{01386\ \ \ \textcolor{keywordtype}{char}\ buffer[\mbox{\hyperlink{src_2main_8c_ad9514bbc324b3ddd5f2ad47dcf4aa5e3}{ARGS\_BUFFER\_SIZE}}\ +\ 1];}
\DoxyCodeLine{01387\ }
\DoxyCodeLine{01388\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_adc4bd59a60361844aa0e852efa210105}{memset}}(buffer,\ 0x0,\ \textcolor{keyword}{sizeof}(buffer));}
\DoxyCodeLine{01389\ }
\DoxyCodeLine{01390\ \ \ \textcolor{keywordflow}{switch}\ (type)\ \{}
\DoxyCodeLine{01391\ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'b'}:\ \ \ \textcolor{comment}{//\ byte}}
\DoxyCodeLine{01392\ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'w'}:\ \ \ \textcolor{comment}{//\ word}}
\DoxyCodeLine{01393\ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'e'}:\ \ \ \textcolor{comment}{//\ session}}
\DoxyCodeLine{01394\ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'u'}:\ \{\ \textcolor{comment}{//\ unsigned\ long}}
\DoxyCodeLine{01395\ \ \ \ \ \ \ \mbox{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t}}\ max\ =\ 0;}
\DoxyCodeLine{01396\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (type\ ==\ \textcolor{charliteral}{'b'})\ \{}
\DoxyCodeLine{01397\ \ \ \ \ \ \ \ \ max\ =\ UCHAR\_MAX;}
\DoxyCodeLine{01398\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (type\ ==\ \textcolor{charliteral}{'w'}\ ||\ type\ ==\ \textcolor{charliteral}{'e'})\ \{}
\DoxyCodeLine{01399\ \ \ \ \ \ \ \ \ max\ =\ USHRT\_MAX;}
\DoxyCodeLine{01400\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (type\ ==\ \textcolor{charliteral}{'u'})\ \{}
\DoxyCodeLine{01401\ \ \ \ \ \ \ \ \ max\ =\ UINT\_MAX;}
\DoxyCodeLine{01402\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01403\ \ \ \ \ \ \ \textcolor{comment}{//\ NOTE(adma):\ check\ that\ is\ a\ positive\ number\ in\ dec,\ hex\ or\ oct}}
\DoxyCodeLine{01404\ \ \ \ \ \ \ errno\ =\ 0;}
\DoxyCodeLine{01405\ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ *endptr;}
\DoxyCodeLine{01406\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{long}\ \mbox{\hyperlink{namespace_i_r_aa1afcba889279fa935b76ba278be7fd6a0fc3cfbc27e91ea60a787de13dae3e3c}{num}}\ =\ strtoul(\mbox{\hyperlink{pkcs11_8h_a32aff7c6c4cd253fdf6563677afab5ce}{value}},\ \&endptr,\ 0);}
\DoxyCodeLine{01407\ }
\DoxyCodeLine{01408\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((errno\ ==\ ERANGE\ ||\ num\ >\ max)\ ||\ (errno\ !=\ 0\ \&\&\ num\ ==\ 0))\ \{}
\DoxyCodeLine{01409\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{01410\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01411\ }
\DoxyCodeLine{01412\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (endptr\ ==\ \mbox{\hyperlink{pkcs11_8h_a32aff7c6c4cd253fdf6563677afab5ce}{value}})\ \{}
\DoxyCodeLine{01413\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{01414\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01415\ }
\DoxyCodeLine{01416\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (type\ ==\ \textcolor{charliteral}{'b'})\ \{}
\DoxyCodeLine{01417\ \ \ \ \ \ \ \ \ parsed-\/>\mbox{\hyperlink{struct_argument_ab604ca4c98b43b4f304994d98643fb7b}{b}}\ =\ (\mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}})\ num;}
\DoxyCodeLine{01418\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (type\ ==\ \textcolor{charliteral}{'e'})\ \{}
\DoxyCodeLine{01419\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (num\ >=\ \mbox{\hyperlink{yubihsm_8h_add4e5963a36bd6c9b06c717d705f4c2f}{YH\_MAX\_SESSIONS}}\ ||\ !probe\_session(ctx,\ num))\ \{}
\DoxyCodeLine{01420\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{01421\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01422\ \ \ \ \ \ \ \ \ parsed-\/>\mbox{\hyperlink{struct_argument_af3cc3b22da3a07b8f6854d9745d6db55}{e}}\ =\ ctx-\/>\mbox{\hyperlink{structyubihsm__context_a7a959752fa285fb4a7a75921bbfa00fe}{sessions}}[\mbox{\hyperlink{namespace_i_r_aa1afcba889279fa935b76ba278be7fd6a0fc3cfbc27e91ea60a787de13dae3e3c}{num}}];}
\DoxyCodeLine{01423\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (type\ ==\ \textcolor{charliteral}{'w'})\ \{}
\DoxyCodeLine{01424\ \ \ \ \ \ \ \ \ parsed-\/>\mbox{\hyperlink{struct_argument_aeb48fdf58cd895afedcbf817845d2a77}{w}}\ =\ (\mbox{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t}})\ num;}
\DoxyCodeLine{01425\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (type\ ==\ \textcolor{charliteral}{'u'})\ \{}
\DoxyCodeLine{01426\ \ \ \ \ \ \ \ \ parsed-\/>\mbox{\hyperlink{struct_argument_af1d31453ebb9b694f291fef3b04b7021}{d}}\ =\ (\mbox{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t}})\ num;}
\DoxyCodeLine{01427\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01428\ \ \ \ \ \ \ parsed-\/>\mbox{\hyperlink{struct_argument_ac33038cf0ca57abb4caed3dbdf4b9e86}{len}}\ =\ 1;\ \textcolor{comment}{//\ NOTE(adma):\ doesn't\ really\ have\ a\ meaning}}
\DoxyCodeLine{01429\ }
\DoxyCodeLine{01430\ \ \ \ \ \}\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01431\ }
\DoxyCodeLine{01432\ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'F'}:}
\DoxyCodeLine{01433\ \ \ \ \ \ \ parsed-\/>\mbox{\hyperlink{struct_argument_a5054bf8f827d48bc83f9763d5e78b786}{s}}\ =\ \mbox{\hyperlink{pkcs11_8h_a32aff7c6c4cd253fdf6563677afab5ce}{value}};}
\DoxyCodeLine{01434\ \ \ \ \ \ \ parsed-\/>\mbox{\hyperlink{struct_argument_ac33038cf0ca57abb4caed3dbdf4b9e86}{len}}\ =\ strlen(\mbox{\hyperlink{pkcs11_8h_a32aff7c6c4cd253fdf6563677afab5ce}{value}});}
\DoxyCodeLine{01435\ }
\DoxyCodeLine{01436\ \ \ \ \ \ \ ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}}\ =\ open\_file(\mbox{\hyperlink{pkcs11_8h_a32aff7c6c4cd253fdf6563677afab5ce}{value}},\ \textcolor{keyword}{false});}
\DoxyCodeLine{01437\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}})\ \{}
\DoxyCodeLine{01438\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{01439\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01440\ }
\DoxyCodeLine{01441\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01442\ }
\DoxyCodeLine{01443\ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'i'}:}
\DoxyCodeLine{01444\ \ \ \ \ \ \ parsed-\/>\mbox{\hyperlink{struct_argument_a988ffa3a53329017f0fdc315cc61dc49}{x}}\ =\ calloc(\mbox{\hyperlink{src_2main_8c_ad9514bbc324b3ddd5f2ad47dcf4aa5e3}{ARGS\_BUFFER\_SIZE}}\ +\ 1,\ 1);}
\DoxyCodeLine{01445\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (parsed-\/>\mbox{\hyperlink{struct_argument_a988ffa3a53329017f0fdc315cc61dc49}{x}}\ ==\ NULL)\ \{}
\DoxyCodeLine{01446\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{01447\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01448\ \ \ \ \ \ \ parsed-\/>\mbox{\hyperlink{struct_argument_ac33038cf0ca57abb4caed3dbdf4b9e86}{len}}\ =\ \mbox{\hyperlink{src_2main_8c_ad9514bbc324b3ddd5f2ad47dcf4aa5e3}{ARGS\_BUFFER\_SIZE}};}
\DoxyCodeLine{01449\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (get\_input\_data(\mbox{\hyperlink{pkcs11_8h_a32aff7c6c4cd253fdf6563677afab5ce}{value}},\ parsed-\/>\mbox{\hyperlink{struct_argument_a988ffa3a53329017f0fdc315cc61dc49}{x}},\ \&parsed-\/>\mbox{\hyperlink{struct_argument_ac33038cf0ca57abb4caed3dbdf4b9e86}{len}},\ fmt)\ ==\ \textcolor{keyword}{false})\ \{}
\DoxyCodeLine{01450\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{01451\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01452\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01453\ }
\DoxyCodeLine{01454\ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'I'}:}
\DoxyCodeLine{01455\ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'s'}:}
\DoxyCodeLine{01456\ \ \ \ \ \ \ \textcolor{comment}{//\ NOTE(adma):\ strings\ are\ pretty\ much\ always\ OK}}
\DoxyCodeLine{01457\ \ \ \ \ \ \ parsed-\/>\mbox{\hyperlink{struct_argument_a5054bf8f827d48bc83f9763d5e78b786}{s}}\ =\ \mbox{\hyperlink{pkcs11_8h_a32aff7c6c4cd253fdf6563677afab5ce}{value}};}
\DoxyCodeLine{01458\ \ \ \ \ \ \ parsed-\/>\mbox{\hyperlink{struct_argument_ac33038cf0ca57abb4caed3dbdf4b9e86}{len}}\ =\ strlen(\mbox{\hyperlink{pkcs11_8h_a32aff7c6c4cd253fdf6563677afab5ce}{value}});}
\DoxyCodeLine{01459\ }
\DoxyCodeLine{01460\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01461\ }
\DoxyCodeLine{01462\ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'k'}:}
\DoxyCodeLine{01463\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (strcmp(\mbox{\hyperlink{pkcs11_8h_a32aff7c6c4cd253fdf6563677afab5ce}{value}},\ \textcolor{stringliteral}{"{}stdin:"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{01464\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (EVP\_read\_pw\_string(buffer,\ \mbox{\hyperlink{src_2main_8c_ad9514bbc324b3ddd5f2ad47dcf4aa5e3}{ARGS\_BUFFER\_SIZE}},}
\DoxyCodeLine{01465\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Enter\ hex\ key:\ "{}},\ 0)\ !=\ 0)\ \{}
\DoxyCodeLine{01466\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{01467\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01468\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{pkcs11_8h_a32aff7c6c4cd253fdf6563677afab5ce}{value}}\ =\ buffer;}
\DoxyCodeLine{01469\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01470\ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'d'}:}
\DoxyCodeLine{01471\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm_8c_a96a4c751a281515d5610adb8fd779438}{yh\_string\_to\_domains}}(\mbox{\hyperlink{pkcs11_8h_a32aff7c6c4cd253fdf6563677afab5ce}{value}},\ \&parsed-\/>\mbox{\hyperlink{struct_argument_aeb48fdf58cd895afedcbf817845d2a77}{w}})\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{01472\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{01473\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01474\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01475\ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'c'}:}
\DoxyCodeLine{01476\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm_8c_aab440e1cb671d9ba7a2e7d1243960e42}{yh\_string\_to\_capabilities}}(\mbox{\hyperlink{pkcs11_8h_a32aff7c6c4cd253fdf6563677afab5ce}{value}},\ \&parsed-\/>\mbox{\hyperlink{struct_argument_a47f11889bc7a9a2b34f2264f6ffdcf49}{c}})\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{01477\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{01478\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01479\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01480\ }
\DoxyCodeLine{01481\ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'a'}:}
\DoxyCodeLine{01482\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm_8c_aad9943d12261cc0f0cada93cbd6d0704}{yh\_string\_to\_algo}}(\mbox{\hyperlink{pkcs11_8h_a32aff7c6c4cd253fdf6563677afab5ce}{value}},\ \&parsed-\/>\mbox{\hyperlink{struct_argument_ae96c150fbce65402ddf86af6366c42f7}{a}})\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{01483\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{01484\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01485\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01486\ }
\DoxyCodeLine{01487\ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'t'}:}
\DoxyCodeLine{01488\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm_8c_a57cdfa4b6224bd2c4a8bab24513475d8}{yh\_string\_to\_type}}(\mbox{\hyperlink{pkcs11_8h_a32aff7c6c4cd253fdf6563677afab5ce}{value}},\ \&parsed-\/>\mbox{\hyperlink{struct_argument_ab4e4ddb680ed3435acb5fdeb9b95150f}{t}})\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{01489\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{01490\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01491\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01492\ }
\DoxyCodeLine{01493\ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'o'}:}
\DoxyCodeLine{01494\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm_8c_a5464c7a6ad858c1e4e42e588b406c2d3}{yh\_string\_to\_option}}(\mbox{\hyperlink{pkcs11_8h_a32aff7c6c4cd253fdf6563677afab5ce}{value}},\ \&parsed-\/>\mbox{\hyperlink{struct_argument_a20a9eb12dcb776aa3a74bb6b9ad4a1c2}{o}})\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{01495\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{01496\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01497\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01498\ }
\DoxyCodeLine{01499\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{01500\ \ \ \ \ \ \ \textcolor{comment}{//\ NOTE(adma):\ unknown\ type}}
\DoxyCodeLine{01501\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{01502\ \ \ \}}
\DoxyCodeLine{01503\ }
\DoxyCodeLine{01504\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{01505\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{src_2main_8c_a4f0deecffa91ccb37fdf866d83789e8c_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=349pt]{src_2main_8c_a4f0deecffa91ccb37fdf866d83789e8c_icgraph}
\end{center}
\end{figure}
\Hypertarget{src_2main_8c_a0f55f786bda19a4380614a719cf93faf}\index{main.c@{main.c}!yh\_com\_help@{yh\_com\_help}}
\index{yh\_com\_help@{yh\_com\_help}!main.c@{main.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_help()}{yh\_com\_help()}}
{\footnotesize\ttfamily \label{src_2main_8c_a0f55f786bda19a4380614a719cf93faf} 
int yh\+\_\+com\+\_\+help (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{src_2main_8c_source_l00628}{628}} of file \mbox{\hyperlink{src_2main_8c_source}{main.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00628\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00629\ }
\DoxyCodeLine{00630\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(fmt);}
\DoxyCodeLine{00631\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(ctx);}
\DoxyCodeLine{00632\ \ \ \textcolor{keywordtype}{bool}\ match\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00633\ }
\DoxyCodeLine{00634\ \ \ \textcolor{comment}{//\ TODO(adma):\ once\ we\ have\ optional\ commands\ we\ can\ have\ a\ real\ help}}
\DoxyCodeLine{00635\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{struct_command}{Command}}\ *command\ =\ \mbox{\hyperlink{src_2main_8c_a872d1e0eb3ee3fb13c651a1a0a8fbeb3}{g\_commands}};\ command;\ command\ =\ command-\/>\mbox{\hyperlink{struct_command_af9c9ea6f57adad15eb7af71d6834d0b4}{next}})\ \{}
\DoxyCodeLine{00636\ \ \ \ \ \textcolor{keywordflow}{if}\ (strncmp(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}},\ command-\/>name,\ strlen(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}}))\ ==\ 0)\ \{}
\DoxyCodeLine{00637\ \ \ \ \ \ \ match\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00638\ \ \ \ \ \ \ \mbox{\hyperlink{namespace_log_a83926634a3916d0927abca4aca58a60a}{printf}}(\textcolor{stringliteral}{"{}\%-\/25s\%s\(\backslash\)n"{}},\ command-\/>name,\ command-\/>doc);}
\DoxyCodeLine{00639\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (strlen(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}}))\ \{}
\DoxyCodeLine{00640\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (command-\/>args)\ \{}
\DoxyCodeLine{00641\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_log_a83926634a3916d0927abca4aca58a60a}{printf}}(\textcolor{stringliteral}{"{}\%-\/5s\%s"{}},\ \textcolor{stringliteral}{"{}"{}},\ command-\/>args);}
\DoxyCodeLine{00642\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (command-\/>in\_fmt\ !=\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}})\ \{}
\DoxyCodeLine{00643\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_log_a83926634a3916d0927abca4aca58a60a}{printf}}(\textcolor{stringliteral}{"{}\ (default\ input\ format:\ \%s)"{}},}
\DoxyCodeLine{00644\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ fmt\_to\_string(command-\/>in\_fmt));}
\DoxyCodeLine{00645\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00646\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_log_a83926634a3916d0927abca4aca58a60a}{printf}}(\textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{00647\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00648\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{struct_command}{Command}}\ *subcommand\ =\ command-\/>\mbox{\hyperlink{struct_command_ad9daf42f96efe8bfbad34fb534f1546d}{subcommands}};\ subcommand;}
\DoxyCodeLine{00649\ \ \ \ \ \ \ \ \ \ \ \ \ \ subcommand\ =\ subcommand-\/>\mbox{\hyperlink{struct_command_af9c9ea6f57adad15eb7af71d6834d0b4}{next}})\ \{}
\DoxyCodeLine{00650\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_log_a83926634a3916d0927abca4aca58a60a}{printf}}(\textcolor{stringliteral}{"{}\%-\/5s\%-\/25s\%s"{}},\ \textcolor{stringliteral}{"{}"{}},\ subcommand-\/>name,\ subcommand-\/>doc);}
\DoxyCodeLine{00651\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (subcommand-\/>args)\ \{}
\DoxyCodeLine{00652\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (subcommand-\/>in\_fmt\ !=\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}})\ \{}
\DoxyCodeLine{00653\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_log_a83926634a3916d0927abca4aca58a60a}{printf}}(\textcolor{stringliteral}{"{}\ (default\ input\ format:\ \%s)"{}},}
\DoxyCodeLine{00654\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ fmt\_to\_string(subcommand-\/>in\_fmt));}
\DoxyCodeLine{00655\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00656\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_log_a83926634a3916d0927abca4aca58a60a}{printf}}(\textcolor{stringliteral}{"{}\(\backslash\)n\%-\/30s\%s\(\backslash\)n"{}},\ \textcolor{stringliteral}{"{}"{}},\ subcommand-\/>args);}
\DoxyCodeLine{00657\ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00658\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_log_a83926634a3916d0927abca4aca58a60a}{printf}}(\textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{00659\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00660\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00661\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00662\ \ \ \ \ \}}
\DoxyCodeLine{00663\ \ \ \}}
\DoxyCodeLine{00664\ }
\DoxyCodeLine{00665\ \ \ \textcolor{keywordflow}{if}\ (match\ ==\ \textcolor{keyword}{false})\ \{}
\DoxyCodeLine{00666\ \ \ \ \ \mbox{\hyperlink{namespace_log_a83926634a3916d0927abca4aca58a60a}{printf}}(\textcolor{stringliteral}{"{}Help\ for\ command\ \%s\ not\ found\(\backslash\)n"{}},\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}});}
\DoxyCodeLine{00667\ \ \ \}}
\DoxyCodeLine{00668\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00669\ \}}

\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{src_2main_8c_a0f55f786bda19a4380614a719cf93faf_icgraph}
\end{center}
\end{figure}
\Hypertarget{src_2main_8c_ad91b275691b905cdc54d7add2a5b06e3}\index{main.c@{main.c}!yh\_com\_history@{yh\_com\_history}}
\index{yh\_com\_history@{yh\_com\_history}!main.c@{main.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_history()}{yh\_com\_history()}}
{\footnotesize\ttfamily \label{src_2main_8c_ad91b275691b905cdc54d7add2a5b06e3} 
int yh\+\_\+com\+\_\+history (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{src_2main_8c_source_l00595}{595}} of file \mbox{\hyperlink{src_2main_8c_source}{main.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00595\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00596\ }
\DoxyCodeLine{00597\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(fmt);}
\DoxyCodeLine{00598\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(ctx);}
\DoxyCodeLine{00599\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}});}
\DoxyCodeLine{00600\ }
\DoxyCodeLine{00601\ \textcolor{preprocessor}{\#ifndef\ \_\_WIN32}}
\DoxyCodeLine{00602\ \ \ HistEvent\ ev;}
\DoxyCodeLine{00603\ }
\DoxyCodeLine{00604\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}};}
\DoxyCodeLine{00605\ }
\DoxyCodeLine{00606\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}}\ =\ history(\mbox{\hyperlink{src_2main_8c_abea0297d4e2a28933bdb9ccc03c51ebb}{g\_hist}},\ \&ev,\ H\_LAST);\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}}\ !=\ -\/1;}
\DoxyCodeLine{00607\ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}}\ =\ history(\mbox{\hyperlink{src_2main_8c_abea0297d4e2a28933bdb9ccc03c51ebb}{g\_hist}},\ \&ev,\ H\_PREV))\ \{}
\DoxyCodeLine{00608\ \ \ \ \ fprintf(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}},\ \textcolor{stringliteral}{"{}\%4d\ \%s"{}},\ ev.num,\ ev.str);}
\DoxyCodeLine{00609\ \ \ \}}
\DoxyCodeLine{00610\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00611\ }
\DoxyCodeLine{00612\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00613\ \}}

\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{src_2main_8c_ad91b275691b905cdc54d7add2a5b06e3_icgraph}
\end{center}
\end{figure}
\Hypertarget{src_2main_8c_a934ab7f3227caf21c22153c3981f8d41}\index{main.c@{main.c}!yh\_com\_keepalive\_off@{yh\_com\_keepalive\_off}}
\index{yh\_com\_keepalive\_off@{yh\_com\_keepalive\_off}!main.c@{main.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_keepalive\_off()}{yh\_com\_keepalive\_off()}}
{\footnotesize\ttfamily \label{src_2main_8c_a934ab7f3227caf21c22153c3981f8d41} 
int yh\+\_\+com\+\_\+keepalive\+\_\+off (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{src_2main_8c_source_l00774}{774}} of file \mbox{\hyperlink{src_2main_8c_source}{main.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00774\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00775\ }
\DoxyCodeLine{00776\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(ctx);}
\DoxyCodeLine{00777\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}});}
\DoxyCodeLine{00778\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(fmt);}
\DoxyCodeLine{00779\ }
\DoxyCodeLine{00780\ \ \ \textcolor{keywordflow}{return}\ set\_keepalive(0);}
\DoxyCodeLine{00781\ \}}

\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{src_2main_8c_a934ab7f3227caf21c22153c3981f8d41_icgraph}
\end{center}
\end{figure}
\Hypertarget{src_2main_8c_a5530032f495d88f8b95a38f8fcd50da8}\index{main.c@{main.c}!yh\_com\_keepalive\_on@{yh\_com\_keepalive\_on}}
\index{yh\_com\_keepalive\_on@{yh\_com\_keepalive\_on}!main.c@{main.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_keepalive\_on()}{yh\_com\_keepalive\_on()}}
{\footnotesize\ttfamily \label{src_2main_8c_a5530032f495d88f8b95a38f8fcd50da8} 
int yh\+\_\+com\+\_\+keepalive\+\_\+on (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{src_2main_8c_source_l00763}{763}} of file \mbox{\hyperlink{src_2main_8c_source}{main.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00763\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00764\ }
\DoxyCodeLine{00765\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(ctx);}
\DoxyCodeLine{00766\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}});}
\DoxyCodeLine{00767\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(fmt);}
\DoxyCodeLine{00768\ }
\DoxyCodeLine{00769\ \ \ \textcolor{keywordflow}{return}\ set\_keepalive(15);}
\DoxyCodeLine{00770\ \}}

\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{src_2main_8c_a5530032f495d88f8b95a38f8fcd50da8_icgraph}
\end{center}
\end{figure}
\Hypertarget{src_2main_8c_aaec43efb95baeb7ec8f2854ffa2cb673}\index{main.c@{main.c}!yh\_com\_quit@{yh\_com\_quit}}
\index{yh\_com\_quit@{yh\_com\_quit}!main.c@{main.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_quit()}{yh\_com\_quit()}}
{\footnotesize\ttfamily \label{src_2main_8c_aaec43efb95baeb7ec8f2854ffa2cb673} 
int yh\+\_\+com\+\_\+quit (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{src_2main_8c_source_l00673}{673}} of file \mbox{\hyperlink{src_2main_8c_source}{main.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00673\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00674\ }
\DoxyCodeLine{00675\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(fmt);}
\DoxyCodeLine{00676\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(ctx);}
\DoxyCodeLine{00677\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}});}
\DoxyCodeLine{00678\ }
\DoxyCodeLine{00679\ \ \ \mbox{\hyperlink{src_2main_8c_a82d33897ce200eadf132e93031f0e595}{g\_running}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00680\ }
\DoxyCodeLine{00681\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00682\ \}}

\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{src_2main_8c_aaec43efb95baeb7ec8f2854ffa2cb673_icgraph}
\end{center}
\end{figure}
\Hypertarget{src_2main_8c_ab7843da8250a79bc61b9cb1439558842}\index{main.c@{main.c}!yh\_com\_set\_informat@{yh\_com\_set\_informat}}
\index{yh\_com\_set\_informat@{yh\_com\_set\_informat}!main.c@{main.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_set\_informat()}{yh\_com\_set\_informat()}}
{\footnotesize\ttfamily \label{src_2main_8c_ab7843da8250a79bc61b9cb1439558842} 
int yh\+\_\+com\+\_\+set\+\_\+informat (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{src_2main_8c_source_l00783}{783}} of file \mbox{\hyperlink{src_2main_8c_source}{main.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00783\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00784\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(fmt);}
\DoxyCodeLine{00785\ }
\DoxyCodeLine{00786\ \ \ \textcolor{keywordflow}{if}\ (strcasecmp(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}},\ \textcolor{stringliteral}{"{}default"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{00787\ \ \ \ \ ctx-\/>\mbox{\hyperlink{structyubihsm__context_a44a581dfcadf23981c3b9b7af51711a0}{in\_fmt}}\ =\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}};}
\DoxyCodeLine{00788\ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00789\ \ \ \}}
\DoxyCodeLine{00790\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ \textcolor{keyword}{sizeof}(formats)\ /\ \textcolor{keyword}{sizeof}(formats[0]);\ i++)\ \{}
\DoxyCodeLine{00791\ \ \ \ \ \textcolor{keywordflow}{if}\ (strcasecmp(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}},\ formats[i].\mbox{\hyperlink{catch__reporter__console_8cpp_a9b45b3e13bd9167aab02e17e08916231}{name}})\ ==\ 0)\ \{}
\DoxyCodeLine{00792\ \ \ \ \ \ \ ctx-\/>\mbox{\hyperlink{structyubihsm__context_a44a581dfcadf23981c3b9b7af51711a0}{in\_fmt}}\ =\ formats[i].format;}
\DoxyCodeLine{00793\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00794\ \ \ \ \ \}}
\DoxyCodeLine{00795\ \ \ \}}
\DoxyCodeLine{00796\ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ parse\ input\ format\(\backslash\)n"{}});}
\DoxyCodeLine{00797\ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{00798\ \}}

\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{src_2main_8c_ab7843da8250a79bc61b9cb1439558842_icgraph}
\end{center}
\end{figure}
\Hypertarget{src_2main_8c_a6d565f5c80947a15c3210e48a20e8836}\index{main.c@{main.c}!yh\_com\_set\_outformat@{yh\_com\_set\_outformat}}
\index{yh\_com\_set\_outformat@{yh\_com\_set\_outformat}!main.c@{main.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_set\_outformat()}{yh\_com\_set\_outformat()}}
{\footnotesize\ttfamily \label{src_2main_8c_a6d565f5c80947a15c3210e48a20e8836} 
int yh\+\_\+com\+\_\+set\+\_\+outformat (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{src_2main_8c_source_l00800}{800}} of file \mbox{\hyperlink{src_2main_8c_source}{main.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00800\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00801\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(fmt);}
\DoxyCodeLine{00802\ }
\DoxyCodeLine{00803\ \ \ \textcolor{keywordflow}{if}\ (strcasecmp(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}},\ \textcolor{stringliteral}{"{}default"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{00804\ \ \ \ \ ctx-\/>\mbox{\hyperlink{structyubihsm__context_addfaa9a6a08f58bdb5b5a93f2e89ccc2}{out\_fmt}}\ =\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}};}
\DoxyCodeLine{00805\ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00806\ \ \ \}}
\DoxyCodeLine{00807\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ \textcolor{keyword}{sizeof}(formats)\ /\ \textcolor{keyword}{sizeof}(formats[0]);\ i++)\ \{}
\DoxyCodeLine{00808\ \ \ \ \ \textcolor{keywordflow}{if}\ (strcasecmp(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}},\ formats[i].\mbox{\hyperlink{catch__reporter__console_8cpp_a9b45b3e13bd9167aab02e17e08916231}{name}})\ ==\ 0)\ \{}
\DoxyCodeLine{00809\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (formats[i].\mbox{\hyperlink{yubihsm-shell_8h_ae425c09a4c40409de33790765339cb97}{format}}\ ==\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708ad58942468b13601c21c14f2269dbca57}{fmt\_password}})\ \{}
\DoxyCodeLine{00810\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00811\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00812\ \ \ \ \ \ \ ctx-\/>\mbox{\hyperlink{structyubihsm__context_addfaa9a6a08f58bdb5b5a93f2e89ccc2}{out\_fmt}}\ =\ formats[i].format;}
\DoxyCodeLine{00813\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00814\ \ \ \ \ \}}
\DoxyCodeLine{00815\ \ \ \}}
\DoxyCodeLine{00816\ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ parse\ output\ format\(\backslash\)n"{}});}
\DoxyCodeLine{00817\ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{00818\ \}}

\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{src_2main_8c_a6d565f5c80947a15c3210e48a20e8836_icgraph}
\end{center}
\end{figure}
\Hypertarget{src_2main_8c_addae6d2b1863758ac22b845a1fada92b}\index{main.c@{main.c}!yubihsm\_complete@{yubihsm\_complete}}
\index{yubihsm\_complete@{yubihsm\_complete}!main.c@{main.c}}
\doxysubsubsection{\texorpdfstring{yubihsm\_complete()}{yubihsm\_complete()}}
{\footnotesize\ttfamily \label{src_2main_8c_addae6d2b1863758ac22b845a1fada92b} 
unsigned char yubihsm\+\_\+complete (\begin{DoxyParamCaption}\item[{Edit\+Line \texorpdfstring{$\ast$}{*}}]{el}{, }\item[{int}]{ch}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{src_2main_8c_source_l01163}{1163}} of file \mbox{\hyperlink{src_2main_8c_source}{main.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01163\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01164\ }
\DoxyCodeLine{01165\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(ch);}
\DoxyCodeLine{01166\ }
\DoxyCodeLine{01167\ \ \ \textcolor{keyword}{const}\ LineInfo\ *li;}
\DoxyCodeLine{01168\ }
\DoxyCodeLine{01169\ \ \ \textcolor{keywordtype}{int}\ argc,\ cursorc,\ cursoro;}
\DoxyCodeLine{01170\ \ \ \textcolor{keywordtype}{char}\ *\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[64];}
\DoxyCodeLine{01171\ \ \ \textcolor{keywordtype}{char}\ data[\mbox{\hyperlink{src_2main_8c_ad9514bbc324b3ddd5f2ad47dcf4aa5e3}{ARGS\_BUFFER\_SIZE}}\ +\ 1]\ =\ \{0\};}
\DoxyCodeLine{01172\ }
\DoxyCodeLine{01173\ \ \ li\ =\ el\_line(el);}
\DoxyCodeLine{01174\ }
\DoxyCodeLine{01175\ \ \ cursorc\ =\ li-\/>cursor\ -\/\ li-\/>buffer;}
\DoxyCodeLine{01176\ \ \ \textcolor{keywordflow}{if}\ (li-\/>lastchar\ -\/\ li-\/>buffer\ >\ 1024)\ \{}
\DoxyCodeLine{01177\ \ \ \ \ \textcolor{keywordflow}{return}\ CC\_REDISPLAY;}
\DoxyCodeLine{01178\ \ \ \}}
\DoxyCodeLine{01179\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(data,\ li-\/>buffer,\ li-\/>lastchar\ -\/\ li-\/>buffer);}
\DoxyCodeLine{01180\ }
\DoxyCodeLine{01181\ \ \ argc\ =\ \mbox{\hyperlink{src_2main_8c_a2324bfd26dadd085f211c969ccfcabf2}{tokenize}}(data,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}},\ 64,\ \&cursorc,\ \&cursoro,\ \mbox{\hyperlink{src_2main_8c_a1a9b6f40de4cd7ffb57dd5abf8ec1f03}{SPACES}});}
\DoxyCodeLine{01182\ }
\DoxyCodeLine{01183\ \ \ \textcolor{comment}{//\ printf("{}\(\backslash\)nargc\ \%d,\ cursorc:\ \%d,\ cursoro:\ \%d\(\backslash\)n"{},\ argc,\ cursorc,\ cursoro);}}
\DoxyCodeLine{01184\ }
\DoxyCodeLine{01185\ \ \ \textcolor{keywordflow}{if}\ (argc\ ==\ 0)\ \{}
\DoxyCodeLine{01186\ \ \ \ \ \textcolor{comment}{//\ NOTE(adma):\ no\ prompt,\ don't\ even\ bother\ with\ finding\ a\ match,}}
\DoxyCodeLine{01187\ \ \ \ \ \textcolor{comment}{//\ just\ show\ all\ commands,\ one\ per\ line}}
\DoxyCodeLine{01188\ \ \ \ \ \mbox{\hyperlink{namespace_log_a83926634a3916d0927abca4aca58a60a}{printf}}(\textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{01189\ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{struct_command}{Command}}\ *command\ =\ \mbox{\hyperlink{src_2main_8c_a872d1e0eb3ee3fb13c651a1a0a8fbeb3}{g\_commands}};\ command;\ command\ =\ command-\/>\mbox{\hyperlink{struct_command_af9c9ea6f57adad15eb7af71d6834d0b4}{next}})\ \{}
\DoxyCodeLine{01190\ \ \ \ \ \ \ \mbox{\hyperlink{namespace_log_a83926634a3916d0927abca4aca58a60a}{printf}}(\textcolor{stringliteral}{"{}\%s\(\backslash\)n"{}},\ command-\/>name);}
\DoxyCodeLine{01191\ \ \ \ \ \}}
\DoxyCodeLine{01192\ \ \ \ \ \textcolor{keywordflow}{return}\ CC\_REDISPLAY;}
\DoxyCodeLine{01193\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01194\ \ \ \ \ \textcolor{keywordtype}{int}\ i\ =\ 0;}
\DoxyCodeLine{01195\ \ \ \ \ \mbox{\hyperlink{struct_command}{Command}}\ *command\ =\ \mbox{\hyperlink{src_2main_8c_a872d1e0eb3ee3fb13c651a1a0a8fbeb3}{g\_commands}};}
\DoxyCodeLine{01196\ \ \ \ \ \mbox{\hyperlink{struct_command}{Command}}\ *to\_complete\ =\ NULL;}
\DoxyCodeLine{01197\ \ \ \ \ \textcolor{keywordtype}{char}\ *\mbox{\hyperlink{namespacebenchmark_compile_ad0ed96ae1454e4347ca61ac3887c379e}{args}}\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{01198\ }
\DoxyCodeLine{01199\ \ \ \ \ \textcolor{keywordtype}{bool}\ completing\_args\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01200\ }
\DoxyCodeLine{01201\ \ \ \ \ \textcolor{keywordflow}{while}\ (i\ <\ cursorc)\ \{}
\DoxyCodeLine{01202\ \ \ \ \ \ \ \textcolor{comment}{//\ NOTE(adma):\ match\ the\ first\ n-\/1\ items}}
\DoxyCodeLine{01203\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (completing\_args\ ==\ \textcolor{keyword}{false})\ \{}
\DoxyCodeLine{01204\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ NOTE(adma):\ match\ subcommands}}
\DoxyCodeLine{01205\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (strncmp(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[i],\ command-\/>\mbox{\hyperlink{struct_command_aac61810b8e87055d1648ec142086eb0e}{name}},\ strlen(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[i]))\ ==\ 0)\ \{}
\DoxyCodeLine{01206\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ printf("{}\(\backslash\)nmatched\ \%s\(\backslash\)n"{},\ command-\/>name);}}
\DoxyCodeLine{01207\ \ \ \ \ \ \ \ \ \ \ to\_complete\ =\ command;}
\DoxyCodeLine{01208\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ to\_complete\_position\ =\ i;}}
\DoxyCodeLine{01209\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (command-\/>\mbox{\hyperlink{struct_command_ad9daf42f96efe8bfbad34fb534f1546d}{subcommands}}\ !=\ NULL)\ \{}
\DoxyCodeLine{01210\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ NOTE(adma):\ if\ we\ were\ matching\ subcommands,\ keep}}
\DoxyCodeLine{01211\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ matching\ subcommands\ if\ any}}
\DoxyCodeLine{01212\ \ \ \ \ \ \ \ \ \ \ \ \ command\ =\ command-\/>\mbox{\hyperlink{struct_command_ad9daf42f96efe8bfbad34fb534f1546d}{subcommands}};}
\DoxyCodeLine{01213\ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01214\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ NOTE(adma):\ start\ matching\ arguments\ otherwise}}
\DoxyCodeLine{01215\ \ \ \ \ \ \ \ \ \ \ \ \ completing\_args\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01216\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (command-\/>\mbox{\hyperlink{struct_command_a07afbf564c2e3b7b8d310e22a301dfba}{args}}\ !=\ NULL)\ \{}
\DoxyCodeLine{01217\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacebenchmark_compile_ad0ed96ae1454e4347ca61ac3887c379e}{args}}\ =\ command-\/>\mbox{\hyperlink{struct_command_a07afbf564c2e3b7b8d310e22a301dfba}{args}};}
\DoxyCodeLine{01218\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01219\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ NOTE(adma):\ there\ are\ no\ args\ for\ this\ command}}
\DoxyCodeLine{01220\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01221\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01222\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01223\ \ \ \ \ \ \ \ \ \ \ i++;\ \textcolor{comment}{//\ NOTE(adma):\ next\ word}}
\DoxyCodeLine{01224\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01225\ \ \ \ \ \ \ \ \ \ \ command\ =\ command-\/>\mbox{\hyperlink{struct_command_af9c9ea6f57adad15eb7af71d6834d0b4}{next}};}
\DoxyCodeLine{01226\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (command\ ==\ NULL)\ \{}
\DoxyCodeLine{01227\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ NOTE(adma):\ command\ not\ found}}
\DoxyCodeLine{01228\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01229\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01230\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01231\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01232\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ NOTE(adma):\ match\ arguments}}
\DoxyCodeLine{01233\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (*args\ !=\ \textcolor{charliteral}{'\(\backslash\)0'}\ \&\&\ *args\ !=\ \textcolor{charliteral}{','})\ \{}
\DoxyCodeLine{01234\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacebenchmark_compile_ad0ed96ae1454e4347ca61ac3887c379e}{args}}++;}
\DoxyCodeLine{01235\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01236\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (*args\ ==\ \textcolor{charliteral}{','})\ \{}
\DoxyCodeLine{01237\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacebenchmark_compile_ad0ed96ae1454e4347ca61ac3887c379e}{args}}++;}
\DoxyCodeLine{01238\ \ \ \ \ \ \ \ \ \ \ i++;\ \textcolor{comment}{//\ NOTE(adma):\ next\ word}}
\DoxyCodeLine{01239\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01240\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01241\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01242\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01243\ \ \ \ \ \}}
\DoxyCodeLine{01244\ }
\DoxyCodeLine{01245\ \ \ \ \ \textcolor{keywordflow}{if}\ (to\_complete\ \&\&\ cursorc\ !=\ 0)\ \{}
\DoxyCodeLine{01246\ \ \ \ \ \ \ \textcolor{comment}{//\ NOTE(adma):\ 0\ has\ a\ bit\ of\ a\ special\ meaning\ since\ the\ cursor}}
\DoxyCodeLine{01247\ \ \ \ \ \ \ \textcolor{comment}{//\ is\ after\ the\ last\ letter\ of\ the\ first\ word\ and\ we\ still\ want}}
\DoxyCodeLine{01248\ \ \ \ \ \ \ \textcolor{comment}{//\ to\ autocomplete\ commands\ and\ not\ subcommands\ nor\ args\ in\ that}}
\DoxyCodeLine{01249\ \ \ \ \ \ \ \textcolor{comment}{//\ case}}
\DoxyCodeLine{01250\ \ \ \ \ \ \ to\_complete\ =\ to\_complete-\/>\mbox{\hyperlink{struct_command_ad9daf42f96efe8bfbad34fb534f1546d}{subcommands}};}
\DoxyCodeLine{01251\ \ \ \ \ \}}
\DoxyCodeLine{01252\ }
\DoxyCodeLine{01253\ \ \ \ \ \textcolor{keywordflow}{if}\ (argc\ ==\ cursorc)\ \{}
\DoxyCodeLine{01254\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (to\_complete\ \&\&\ completing\_args\ ==\ \textcolor{keyword}{false})\ \{}
\DoxyCodeLine{01255\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ NOTE(adma):\ cursor\ is\ after\ a\ command\ but\ there\ is\ no\ more}}
\DoxyCodeLine{01256\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ text\ to\ match,\ show\ all\ subcommands}}
\DoxyCodeLine{01257\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_log_a83926634a3916d0927abca4aca58a60a}{printf}}(\textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{01258\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{struct_command}{Command}}\ *command\ =\ to\_complete;\ command;\ command\ =\ command-\/>\mbox{\hyperlink{struct_command_af9c9ea6f57adad15eb7af71d6834d0b4}{next}})\ \{}
\DoxyCodeLine{01259\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_log_a83926634a3916d0927abca4aca58a60a}{printf}}(\textcolor{stringliteral}{"{}\%s\(\backslash\)n"{}},\ command-\/>\mbox{\hyperlink{struct_command_aac61810b8e87055d1648ec142086eb0e}{name}});}
\DoxyCodeLine{01260\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01261\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ CC\_REDISPLAY;}
\DoxyCodeLine{01262\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01263\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ NOTE(adma):\ or\ show\ the\ current\ argument}}
\DoxyCodeLine{01264\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{src_2main_8c_a7f5a0a815226228ed913b8c8afe19a51}{complete\_arg}}(el,\ args,\ \textcolor{stringliteral}{"{}"{}},\ 0);}
\DoxyCodeLine{01265\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01266\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01267\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (completing\_args\ ==\ \textcolor{keyword}{false})\ \{}
\DoxyCodeLine{01268\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (to\_complete\ ==\ NULL)\ \{}
\DoxyCodeLine{01269\ \ \ \ \ \ \ \ \ \ \ to\_complete\ =\ \mbox{\hyperlink{src_2main_8c_a872d1e0eb3ee3fb13c651a1a0a8fbeb3}{g\_commands}};}
\DoxyCodeLine{01270\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01271\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{src_2main_8c_a2cc07cef63c0cb85fa153a5ee8f3688d}{complete\_command}}(el,\ to\_complete,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[i],\ cursoro);}
\DoxyCodeLine{01272\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01273\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{src_2main_8c_a7f5a0a815226228ed913b8c8afe19a51}{complete\_arg}}(el,\ args,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[i],\ cursoro);}
\DoxyCodeLine{01274\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01275\ \ \ \ \ \}}
\DoxyCodeLine{01276\ \ \ \}}
\DoxyCodeLine{01277\ }
\DoxyCodeLine{01278\ \ \ \textcolor{keywordflow}{return}\ CC\_ERROR;}
\DoxyCodeLine{01279\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{src_2main_8c_addae6d2b1863758ac22b845a1fada92b_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=251pt]{src_2main_8c_addae6d2b1863758ac22b845a1fada92b_icgraph}
\end{center}
\end{figure}


\doxysubsection{Variable Documentation}
\Hypertarget{src_2main_8c_a872d1e0eb3ee3fb13c651a1a0a8fbeb3}\index{main.c@{main.c}!g\_commands@{g\_commands}}
\index{g\_commands@{g\_commands}!main.c@{main.c}}
\doxysubsubsection{\texorpdfstring{g\_commands}{g\_commands}}
{\footnotesize\ttfamily \label{src_2main_8c_a872d1e0eb3ee3fb13c651a1a0a8fbeb3} 
\mbox{\hyperlink{src_2main_8c_aee65fcec74905101a0241282bb06d451}{Command\+List}} g\+\_\+commands}



Definition at line \mbox{\hyperlink{src_2main_8c_source_l00589}{589}} of file \mbox{\hyperlink{src_2main_8c_source}{main.\+c}}.

\Hypertarget{src_2main_8c_abea0297d4e2a28933bdb9ccc03c51ebb}\index{main.c@{main.c}!g\_hist@{g\_hist}}
\index{g\_hist@{g\_hist}!main.c@{main.c}}
\doxysubsubsection{\texorpdfstring{g\_hist}{g\_hist}}
{\footnotesize\ttfamily \label{src_2main_8c_abea0297d4e2a28933bdb9ccc03c51ebb} 
History\texorpdfstring{$\ast$}{*} g\+\_\+hist}



Definition at line \mbox{\hyperlink{src_2main_8c_source_l00062}{62}} of file \mbox{\hyperlink{src_2main_8c_source}{main.\+c}}.

\Hypertarget{src_2main_8c_a82d33897ce200eadf132e93031f0e595}\index{main.c@{main.c}!g\_running@{g\_running}}
\index{g\_running@{g\_running}!main.c@{main.c}}
\doxysubsubsection{\texorpdfstring{g\_running}{g\_running}}
{\footnotesize\ttfamily \label{src_2main_8c_a82d33897ce200eadf132e93031f0e595} 
bool g\+\_\+running = true}



Definition at line \mbox{\hyperlink{src_2main_8c_source_l00591}{591}} of file \mbox{\hyperlink{src_2main_8c_source}{main.\+c}}.

