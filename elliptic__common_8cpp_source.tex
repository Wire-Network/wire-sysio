\doxysection{elliptic\+\_\+common.\+cpp}
\hypertarget{elliptic__common_8cpp_source}{}\label{elliptic__common_8cpp_source}\index{libraries/fc/src/crypto/elliptic\_common.cpp@{libraries/fc/src/crypto/elliptic\_common.cpp}}
\mbox{\hyperlink{elliptic__common_8cpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00001}00001\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{base58_8hpp}{fc/crypto/base58.hpp}}>}}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00002}00002\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{elliptic_8hpp}{fc/crypto/elliptic.hpp}}>}}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00003}00003\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{raw_8hpp}{fc/io/raw.hpp}}>}}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00004}00004\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{hmac_8hpp}{fc/crypto/hmac.hpp}}>}}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00005}00005\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{openssl_8hpp}{fc/crypto/openssl.hpp}}>}}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00006}00006\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{ripemd160_8hpp}{fc/crypto/ripemd160.hpp}}>}}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00007}00007\ }
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00008}00008\ \textcolor{preprocessor}{\#ifdef\ \_WIN32}}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00009}00009\ \textcolor{preprocessor}{\#\ include\ <malloc.h>}}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00010}00010\ \textcolor{preprocessor}{\#elif\ defined(\_\_FreeBSD\_\_)}}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00011}00011\ \textcolor{preprocessor}{\#\ include\ <stdlib.h>}}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00012}00012\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00013}00013\ \textcolor{preprocessor}{\#\ include\ <alloca.h>}}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00014}00014\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00015}00015\ }
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00016}00016\ \textcolor{comment}{/*\ stuff\ common\ to\ all\ ecc\ implementations\ */}}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00017}00017\ }
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00018}\mbox{\hyperlink{elliptic__common_8cpp_aecf069285f56d4ea910d77b70a8c5843}{00018}}\ \textcolor{preprocessor}{\#define\ BTC\_EXT\_PUB\_MAGIC\ \ \ (0x0488B21E)}}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00019}\mbox{\hyperlink{elliptic__common_8cpp_aba9bcacbfb7b867ec3157c72644229ca}{00019}}\ \textcolor{preprocessor}{\#define\ BTC\_EXT\_PRIV\_MAGIC\ \ (0x0488ADE4)}}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00020}00020\ }
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00021}00021\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacefc}{fc}}\ \{\ \textcolor{keyword}{namespace\ }ecc\ \{}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00022}00022\ }
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00023}00023\ \ \ \ \ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacedetail}{detail}}\ \{}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00024}\mbox{\hyperlink{namespacefc_1_1ecc_1_1detail_ad0a35e1b7223a56e37957a6caf59b40d}{00024}}\ \ \ \ \ \ \ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{classfc_1_1array}{fc::array<char,37>}}\ \mbox{\hyperlink{namespacefc_1_1ecc_1_1detail_ad0a35e1b7223a56e37957a6caf59b40d}{chr37}};}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00025}00025\ }
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00026}\mbox{\hyperlink{namespacefc_1_1ecc_1_1detail_ab7363d849635fb8ae78b79d30da3f81f}{00026}}\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classfc_1_1sha256}{fc::sha256}}\ \mbox{\hyperlink{namespacefc_1_1ecc_1_1detail_ab7363d849635fb8ae78b79d30da3f81f}{\_left}}(\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classfc_1_1sha512}{fc::sha512}}\&\ v\ )}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00027}00027\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00028}00028\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classfc_1_1sha256}{fc::sha256}}\ result;}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00029}00029\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(\ result.data(),\ v.\mbox{\hyperlink{classfc_1_1sha512_ad8e5e86882db16c32ceea6516d7c9f14}{data}}(),\ 32\ );}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00030}00030\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00031}00031\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00032}00032\ }
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00033}\mbox{\hyperlink{namespacefc_1_1ecc_1_1detail_a87091140a69385a95d2c4adf833cc0c3}{00033}}\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classfc_1_1sha256}{fc::sha256}}\ \mbox{\hyperlink{namespacefc_1_1ecc_1_1detail_a87091140a69385a95d2c4adf833cc0c3}{\_right}}(\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classfc_1_1sha512}{fc::sha512}}\&\ v\ )}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00034}00034\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00035}00035\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classfc_1_1sha256}{fc::sha256}}\ result;}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00036}00036\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(\ result.data(),\ v.\mbox{\hyperlink{classfc_1_1sha512_ad8e5e86882db16c32ceea6516d7c9f14}{data}}()\ +\ 32,\ 32\ );}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00037}00037\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00038}00038\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00039}00039\ }
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00040}00040\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ \_put(\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}**\ dest,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i)}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00041}00041\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00042}00042\ \ \ \ \ \ \ \ \ \ \ \ \ *(*dest)++\ =\ (i\ >>\ 24)\ \&\ 0xff;}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00043}00043\ \ \ \ \ \ \ \ \ \ \ \ \ *(*dest)++\ =\ (i\ >>\ 16)\ \&\ 0xff;}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00044}00044\ \ \ \ \ \ \ \ \ \ \ \ \ *(*dest)++\ =\ (i\ >>\ \ 8)\ \&\ 0xff;}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00045}00045\ \ \ \ \ \ \ \ \ \ \ \ \ *(*dest)++\ =\ \ i\ \ \ \ \ \ \ \ \&\ 0xff;}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00046}00046\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00047}00047\ }
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00048}00048\ }
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00049}00049\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{namespacefc_1_1ecc_1_1detail_ad0a35e1b7223a56e37957a6caf59b40d}{chr37}}\ \_derive\_message(\ \textcolor{keywordtype}{char}\ first,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ key32,\ \textcolor{keywordtype}{int}\ i\ )}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00050}00050\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00051}00051\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacefc_1_1ecc_1_1detail_ad0a35e1b7223a56e37957a6caf59b40d}{chr37}}\ result;}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00052}00052\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*\ dest\ =\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*)\ result.begin();}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00053}00053\ \ \ \ \ \ \ \ \ \ \ \ \ *dest++\ =\ first;}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00054}00054\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(\ dest,\ key32,\ 32\ );\ dest\ +=\ 32;}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00055}00055\ \ \ \ \ \ \ \ \ \ \ \ \ \_put(\ \&dest,\ i\ );}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00056}00056\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00057}00057\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00058}00058\ }
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00059}\mbox{\hyperlink{namespacefc_1_1ecc_1_1detail_a16acb379a6eab07fd47f36da4ca3f7a8}{00059}}\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classfc_1_1array}{chr37}}\ \_derive\_message(\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classfc_1_1array}{public\_key\_data}}\&\ key,\ \textcolor{keywordtype}{int}\ i\ )}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00060}00060\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00061}00061\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \_derive\_message(\ *key.begin(),\ key.begin()\ +\ 1,\ i\ );}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00062}00062\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00063}00063\ }
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00064}00064\ }
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00065}\mbox{\hyperlink{namespacefc_1_1ecc_1_1detail_a0367eb3e2e8d3c9df370ec2d62e78d64}{00065}}\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ ec\_group\&\ \mbox{\hyperlink{namespacefc_1_1ecc_1_1detail_a0367eb3e2e8d3c9df370ec2d62e78d64}{get\_curve}}()}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00066}00066\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00067}00067\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ ec\_group\ secp256k1(\ EC\_GROUP\_new\_by\_curve\_name(\ NID\_secp256k1\ )\ );}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00068}00068\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ secp256k1;}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00069}00069\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00070}00070\ }
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00071}00071\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{classfc_1_1sha256}{private\_key\_secret}}\ \_get\_curve\_order()}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00072}00072\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00073}00073\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ ec\_group\&\ group\ =\ \mbox{\hyperlink{namespacefc_1_1ecc_1_1detail_a0367eb3e2e8d3c9df370ec2d62e78d64}{get\_curve}}();}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00074}00074\ \ \ \ \ \ \ \ \ \ \ \ \ bn\_ctx\ ctx(BN\_CTX\_new());}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00075}00075\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structfc_1_1ssl__bignum}{ssl\_bignum}}\ order;}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00076}00076\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{exception_8hpp_abed525eeff3ae581be7e4e2fcd3b7bf4}{FC\_ASSERT}}(\ EC\_GROUP\_get\_order(\ group,\ order,\ ctx\ )\ );}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00077}00077\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classfc_1_1sha256}{private\_key\_secret}}\ bin;}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00078}00078\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{exception_8hpp_abed525eeff3ae581be7e4e2fcd3b7bf4}{FC\_ASSERT}}(\ BN\_num\_bytes(\ order\ )\ ==\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(bin.\mbox{\hyperlink{classfc_1_1sha256_ac7722b7428b1db345f1b7fab7f4d5774}{data\_size}}())\ );}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00079}00079\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{exception_8hpp_abed525eeff3ae581be7e4e2fcd3b7bf4}{FC\_ASSERT}}(\ BN\_bn2bin(\ order,\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*)\ bin.\mbox{\hyperlink{classfc_1_1sha256_ab897537f6c524085b28049be51ed370d}{data}}()\ )\ ==\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(bin.\mbox{\hyperlink{classfc_1_1sha256_ac7722b7428b1db345f1b7fab7f4d5774}{data\_size}}())\ );}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00080}00080\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ bin;}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00081}00081\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00082}00082\ }
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00083}\mbox{\hyperlink{namespacefc_1_1ecc_1_1detail_a5d3c23a148b0c76d429302dd5ea9392d}{00083}}\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classfc_1_1sha256}{private\_key\_secret}}\&\ \mbox{\hyperlink{namespacefc_1_1ecc_1_1detail_a5d3c23a148b0c76d429302dd5ea9392d}{get\_curve\_order}}()}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00084}00084\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00085}00085\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{classfc_1_1sha256}{private\_key\_secret}}\ order\ =\ \_get\_curve\_order();}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00086}00086\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ order;}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00087}00087\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00088}00088\ }
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00089}00089\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{classfc_1_1sha256}{private\_key\_secret}}\ \_get\_half\_curve\_order()}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00090}00090\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00091}00091\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ ec\_group\&\ group\ =\ \mbox{\hyperlink{namespacefc_1_1ecc_1_1detail_a0367eb3e2e8d3c9df370ec2d62e78d64}{get\_curve}}();}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00092}00092\ \ \ \ \ \ \ \ \ \ \ \ \ bn\_ctx\ ctx(BN\_CTX\_new());}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00093}00093\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structfc_1_1ssl__bignum}{ssl\_bignum}}\ order;}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00094}00094\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{exception_8hpp_abed525eeff3ae581be7e4e2fcd3b7bf4}{FC\_ASSERT}}(\ EC\_GROUP\_get\_order(\ group,\ order,\ ctx\ )\ );}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00095}00095\ \ \ \ \ \ \ \ \ \ \ \ \ BN\_rshift1(\ order,\ order\ );}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00096}00096\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classfc_1_1sha256}{private\_key\_secret}}\ bin;}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00097}00097\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{exception_8hpp_abed525eeff3ae581be7e4e2fcd3b7bf4}{FC\_ASSERT}}(\ BN\_num\_bytes(\ order\ )\ ==\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(bin.\mbox{\hyperlink{classfc_1_1sha256_ac7722b7428b1db345f1b7fab7f4d5774}{data\_size}}())\ );}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00098}00098\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{exception_8hpp_abed525eeff3ae581be7e4e2fcd3b7bf4}{FC\_ASSERT}}(\ BN\_bn2bin(\ order,\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*)\ bin.\mbox{\hyperlink{classfc_1_1sha256_ab897537f6c524085b28049be51ed370d}{data}}()\ )\ ==\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(bin.\mbox{\hyperlink{classfc_1_1sha256_ac7722b7428b1db345f1b7fab7f4d5774}{data\_size}}())\ );}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00099}00099\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ bin;}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00100}00100\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00101}00101\ }
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00102}\mbox{\hyperlink{namespacefc_1_1ecc_1_1detail_ae9379c81933688e390e45efbe0a75d43}{00102}}\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classfc_1_1sha256}{private\_key\_secret}}\&\ \mbox{\hyperlink{namespacefc_1_1ecc_1_1detail_ae9379c81933688e390e45efbe0a75d43}{get\_half\_curve\_order}}()}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00103}00103\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00104}00104\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{classfc_1_1sha256}{private\_key\_secret}}\ half\_order\ =\ \_get\_half\_curve\_order();}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00105}00105\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ half\_order;}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00106}00106\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00107}00107\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00108}00108\ }
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00109}00109\ \ \ \ \ \mbox{\hyperlink{classfc_1_1public__key}{public\_key}}\ public\_key::from\_key\_data(\ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespacefc_1_1ecc_a86376367df56783963d35795bebddce6}{public\_key\_data}}\ \&data\ )\ \{}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00110}00110\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classfc_1_1ecc_1_1public__key_a36809db96f0dd7c702da3d80d512a24c}{public\_key}}(data);}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00111}00111\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00112}00112\ }
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00113}\mbox{\hyperlink{classfc_1_1ecc_1_1private__key_a40b27d62eab21bdff688d45b4ef2b6a1}{00113}}\ \ \ \ \ \mbox{\hyperlink{classfc_1_1ecc_1_1private__key}{private\_key}}\ \mbox{\hyperlink{classfc_1_1ecc_1_1private__key_a40b27d62eab21bdff688d45b4ef2b6a1}{private\_key::child}}(\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classfc_1_1sha256}{fc::sha256}}\&\ offset\ )\textcolor{keyword}{const}}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00114}00114\ \textcolor{keyword}{\ \ \ \ }\{}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00115}00115\ \ \ \ \ \ \ \ \mbox{\hyperlink{classfc_1_1sha256_1_1encoder}{fc::sha256::encoder}}\ enc;}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00116}00116\ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacefc_1_1raw_a3a18d8161aa5b4f4f02b6fcfdff5e5d1}{fc::raw::pack}}(\ enc,\ \mbox{\hyperlink{classfc_1_1ecc_1_1private__key_a11ee154d3fd6f6e4c882fe965dee3d89}{get\_public\_key}}()\ );}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00117}00117\ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacefc_1_1raw_a3a18d8161aa5b4f4f02b6fcfdff5e5d1}{fc::raw::pack}}(\ enc,\ offset\ );}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00118}00118\ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classfc_1_1ecc_1_1private__key_a748751090ea736a761cd3af9633eb7de}{generate\_from\_seed}}(\ \mbox{\hyperlink{classfc_1_1ecc_1_1private__key_a24fb0ebbb99a8404323387fd06d5145f}{get\_secret}}(),\ enc.\mbox{\hyperlink{classfc_1_1sha256_1_1encoder_a4d8b8181e912194cf98a56164671adf8}{result}}()\ );}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00119}00119\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00120}00120\ }
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00121}\mbox{\hyperlink{classfc_1_1ecc_1_1public__key_a83b654848353a7b8a76c1d8ffc99f72d}{00121}}\ \ \ \ \ std::string\ \mbox{\hyperlink{classfc_1_1ecc_1_1public__key_a21a7c7923e874f8e93410fdc6301a205}{public\_key::to\_base58}}(\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classfc_1_1array}{public\_key\_data}}\ \&key\ )}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00122}00122\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00123}00123\ \ \ \ \ \ \ \mbox{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t}}\ check\ =\ (\mbox{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t}})\mbox{\hyperlink{classfc_1_1sha256_a474784de7d6213b855abd7e952df5e36}{sha256::hash}}(key.data,\ \textcolor{keyword}{sizeof}(key)).\mbox{\hyperlink{classfc_1_1sha256_ac933820516182c134a6473227db0e7da}{\_hash}}[0];}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00124}00124\ \ \ \ \ \ \ \textcolor{keyword}{static\_assert}(\textcolor{keyword}{sizeof}(\mbox{\hyperlink{yubico__otp_8c_a9246c20bb98ad2b4c60313c053c70f08}{key}})\ +\ \textcolor{keyword}{sizeof}(check)\ ==\ 37,\ \textcolor{stringliteral}{"{}"{}});\ \textcolor{comment}{//\ hack\ around\ gcc\ bug:\ key.size()\ should\ be\ constexpr,\ but\ isn't}}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00125}00125\ \ \ \ \ \ \ \mbox{\hyperlink{classfc_1_1array}{array<char,\ 37>}}\ data;}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00126}00126\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(data.data,\ key.begin(),\ key.size());}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00127}00127\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(data.begin()\ +\ key.size(),\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*)\&check,\ \textcolor{keyword}{sizeof}(check));}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00128}00128\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacefc_a0dd6c1e5792e0823aa1987e06513a4ce}{fc::to\_base58}}(data.begin(),\ data.size(),\ \mbox{\hyperlink{classfc_1_1optional__delegate}{fc::yield\_function\_t}}());}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00129}00129\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00130}00130\ }
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00131}\mbox{\hyperlink{classfc_1_1ecc_1_1public__key_a9671dae78f391e2d1d6e8243432c8cb9}{00131}}\ \ \ \ \ \mbox{\hyperlink{classfc_1_1ecc_1_1public__key}{public\_key}}\ \mbox{\hyperlink{classfc_1_1ecc_1_1public__key_a9671dae78f391e2d1d6e8243432c8cb9}{public\_key::from\_base58}}(\ \textcolor{keyword}{const}\ std::string\&\ b58\ )}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00132}00132\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00133}00133\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classfc_1_1array}{array<char,\ 37>}}\ data;}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00134}00134\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}}\ =\ \mbox{\hyperlink{namespacefc_ab9aa48ceb035b5fc4b0ff9e48b40bc1d}{fc::from\_base58}}(b58,\ (\textcolor{keywordtype}{char}*)\&data,\ \textcolor{keyword}{sizeof}(data)\ );}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00135}00135\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{exception_8hpp_abed525eeff3ae581be7e4e2fcd3b7bf4}{FC\_ASSERT}}(\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}}\ ==\ \textcolor{keyword}{sizeof}(data)\ );}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00136}00136\ }
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00137}00137\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classfc_1_1array}{public\_key\_data}}\ \mbox{\hyperlink{yubico__otp_8c_a9246c20bb98ad2b4c60313c053c70f08}{key}};}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00138}00138\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t}}\ check\ =\ (\mbox{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t}})\mbox{\hyperlink{classfc_1_1sha256_a474784de7d6213b855abd7e952df5e36}{sha256::hash}}(data.data,\ \textcolor{keyword}{sizeof}(key)).\mbox{\hyperlink{classfc_1_1sha256_ac933820516182c134a6473227db0e7da}{\_hash}}[0];}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00139}00139\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{exception_8hpp_abed525eeff3ae581be7e4e2fcd3b7bf4}{FC\_ASSERT}}(\ memcmp(\ (\textcolor{keywordtype}{char}*)\&check,\ data.data\ +\ \textcolor{keyword}{sizeof}(key),\ \textcolor{keyword}{sizeof}(check)\ )\ ==\ 0\ );}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00140}00140\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(\ (\textcolor{keywordtype}{char}*)key.data,\ data.data,\ \textcolor{keyword}{sizeof}(key)\ );}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00141}00141\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ from\_key\_data(key);}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00142}00142\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00143}00143\ }
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00144}\mbox{\hyperlink{classfc_1_1ecc_1_1public__key_a3d7851242d88d7927653efcc3cd8c0ca}{00144}}\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classfc_1_1ecc_1_1public__key_a3d7851242d88d7927653efcc3cd8c0ca}{public\_key::fingerprint}}()\textcolor{keyword}{\ const}}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00145}00145\ \textcolor{keyword}{\ \ \ \ }\{}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00146}00146\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classfc_1_1array}{public\_key\_data}}\ key\ =\ \mbox{\hyperlink{classfc_1_1ecc_1_1public__key_a066502d87da28f82ccc3c6942491cd48}{serialize}}();}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00147}00147\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classfc_1_1ripemd160}{ripemd160}}\ hash\ =\ \mbox{\hyperlink{classfc_1_1ripemd160_a7d43ada80e62a7a73ca472365138f863}{ripemd160::hash}}(\ \mbox{\hyperlink{classfc_1_1sha256_a474784de7d6213b855abd7e952df5e36}{sha256::hash}}(\ key.begin(),\ key.size()\ )\ );}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00148}00148\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*\ fp\ =\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*)\ hash.\_hash;}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00149}00149\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (fp[0]\ <<\ 24)\ |\ (fp[1]\ <<\ 16)\ |\ (fp[2]\ <<\ 8)\ |\ fp[3];}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00150}00150\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00151}00151\ }
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00152}00152\ \ \ \ \ \textcolor{keywordtype}{bool}\ public\_key::is\_canonical(\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classfc_1_1array}{compact\_signature}}\&\ c\ )\ \{}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00153}00153\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ !(c.\mbox{\hyperlink{classfc_1_1array_ad01e4627be17148ee922c37944c48626}{data}}[1]\ \&\ 0x80)}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00154}00154\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\&\ !(c.\mbox{\hyperlink{classfc_1_1array_ad01e4627be17148ee922c37944c48626}{data}}[1]\ ==\ 0\ \&\&\ !(c.\mbox{\hyperlink{classfc_1_1array_ad01e4627be17148ee922c37944c48626}{data}}[2]\ \&\ 0x80))}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00155}00155\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\&\ !(c.\mbox{\hyperlink{classfc_1_1array_ad01e4627be17148ee922c37944c48626}{data}}[33]\ \&\ 0x80)}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00156}00156\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\&\ !(c.\mbox{\hyperlink{classfc_1_1array_ad01e4627be17148ee922c37944c48626}{data}}[33]\ ==\ 0\ \&\&\ !(c.\mbox{\hyperlink{classfc_1_1array_ad01e4627be17148ee922c37944c48626}{data}}[34]\ \&\ 0x80));}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00157}00157\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00158}00158\ }
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00159}\mbox{\hyperlink{classfc_1_1ecc_1_1private__key_a748751090ea736a761cd3af9633eb7de}{00159}}\ \ \ \ \ \mbox{\hyperlink{classfc_1_1ecc_1_1private__key}{private\_key}}\ \mbox{\hyperlink{classfc_1_1ecc_1_1private__key_a748751090ea736a761cd3af9633eb7de}{private\_key::generate\_from\_seed}}(\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classfc_1_1sha256}{fc::sha256}}\&\ seed,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classfc_1_1sha256}{fc::sha256}}\&\ offset\ )}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00160}00160\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00161}00161\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structfc_1_1ssl__bignum}{ssl\_bignum}}\ z;}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00162}00162\ \ \ \ \ \ \ \ \ BN\_bin2bn((\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*)\&offset,\ \textcolor{keyword}{sizeof}(offset),\ z);}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00163}00163\ }
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00164}00164\ \ \ \ \ \ \ \ \ ec\_group\ group(EC\_GROUP\_new\_by\_curve\_name(NID\_secp256k1));}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00165}00165\ \ \ \ \ \ \ \ \ bn\_ctx\ ctx(BN\_CTX\_new());}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00166}00166\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structfc_1_1ssl__bignum}{ssl\_bignum}}\ order;}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00167}00167\ \ \ \ \ \ \ \ \ EC\_GROUP\_get\_order(group,\ order,\ ctx);}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00168}00168\ }
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00169}00169\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ secexp\ =\ (seed\ +\ z)\ \%\ order}}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00170}00170\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structfc_1_1ssl__bignum}{ssl\_bignum}}\ secexp;}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00171}00171\ \ \ \ \ \ \ \ \ BN\_bin2bn((\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*)\&seed,\ \textcolor{keyword}{sizeof}(seed),\ secexp);}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00172}00172\ \ \ \ \ \ \ \ \ BN\_add(secexp,\ secexp,\ z);}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00173}00173\ \ \ \ \ \ \ \ \ BN\_mod(secexp,\ secexp,\ order,\ ctx);}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00174}00174\ }
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00175}00175\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classfc_1_1sha256}{fc::sha256}}\ secret;}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00176}00176\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{exception_8hpp_abed525eeff3ae581be7e4e2fcd3b7bf4}{FC\_ASSERT}}(BN\_num\_bytes(secexp)\ <=\ \mbox{\hyperlink{stdint_8h_a414156feea104f8f75b4ed9e3121b2f6}{int64\_t}}(\textcolor{keyword}{sizeof}(secret)));}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00177}00177\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ shift\ =\ \textcolor{keyword}{sizeof}(secret)\ -\/\ BN\_num\_bytes(secexp);}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00178}00178\ \ \ \ \ \ \ \ \ BN\_bn2bin(secexp,\ ((\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*)\&secret)+shift);}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00179}00179\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classfc_1_1ecc_1_1private__key_abcc5312450e72cd78f78b7d2feb6c899}{regenerate}}(\ secret\ );}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00180}00180\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00181}00181\ }
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00182}00182\ \ \ \ \ \mbox{\hyperlink{classfc_1_1sha256}{fc::sha256}}\ \mbox{\hyperlink{classfc_1_1ecc_1_1private__key_a24fb0ebbb99a8404323387fd06d5145f}{private\_key::get\_secret}}(\ \textcolor{keyword}{const}\ EC\_KEY\ *\ \textcolor{keyword}{const}\ k\ )}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00183}00183\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00184}00184\ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ !k\ )}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00185}00185\ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00186}00186\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classfc_1_1sha256}{fc::sha256}}();}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00187}00187\ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00188}00188\ }
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00189}00189\ \ \ \ \ \ \ \ \mbox{\hyperlink{classfc_1_1sha256}{fc::sha256}}\ sec;}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00190}00190\ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{include_2fc_2crypto_2bigint_8hpp_a62125ea4e1d748a4a9c1aed9766f451a}{BIGNUM}}*\ \mbox{\hyperlink{namespacebn}{bn}}\ =\ EC\_KEY\_get0\_private\_key(k);}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00191}00191\ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ \mbox{\hyperlink{namespacebn}{bn}}\ ==\ NULL\ )}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00192}00192\ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00193}00193\ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{exception_8hpp_a7590ddac4f181b661c3eeaf5feccc6ac}{FC\_THROW\_EXCEPTION}}(\ \mbox{\hyperlink{classfc_1_1exception}{exception}},\ \textcolor{stringliteral}{"{}get\ private\ key\ failed"{}}\ );}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00194}00194\ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00195}00195\ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ nbytes\ =\ BN\_num\_bytes(\mbox{\hyperlink{namespacebn}{bn}});}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00196}00196\ \ \ \ \ \ \ \ BN\_bn2bin(\mbox{\hyperlink{namespacebn}{bn}},\ \&((\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*)\&sec)[32-\/nbytes]\ );}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00197}00197\ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ sec;}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00198}00198\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00199}00199\ }
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00200}\mbox{\hyperlink{classfc_1_1ecc_1_1private__key_a047e701b70d0fcdcd3cd54a73c0af5a4}{00200}}\ \ \ \ \ \mbox{\hyperlink{classfc_1_1ecc_1_1private__key}{private\_key}}\ \mbox{\hyperlink{classfc_1_1ecc_1_1private__key_a047e701b70d0fcdcd3cd54a73c0af5a4}{private\_key::generate}}()}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00201}00201\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00202}00202\ \ \ \ \ \ \ \ EC\_KEY*\ k\ =\ EC\_KEY\_new\_by\_curve\_name(\ NID\_secp256k1\ );}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00203}00203\ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ !k\ )\ \mbox{\hyperlink{exception_8hpp_a7590ddac4f181b661c3eeaf5feccc6ac}{FC\_THROW\_EXCEPTION}}(\ \mbox{\hyperlink{classfc_1_1exception}{exception}},\ \textcolor{stringliteral}{"{}Unable\ to\ generate\ EC\ key"{}}\ );}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00204}00204\ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ !EC\_KEY\_generate\_key(\ k\ )\ )}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00205}00205\ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00206}00206\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{exception_8hpp_a7590ddac4f181b661c3eeaf5feccc6ac}{FC\_THROW\_EXCEPTION}}(\ \mbox{\hyperlink{classfc_1_1exception}{exception}},\ \textcolor{stringliteral}{"{}ecc\ key\ generation\ error"{}}\ );}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00207}00207\ }
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00208}00208\ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00209}00209\ }
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00210}00210\ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classfc_1_1ecc_1_1private__key_aee641a197bfa93b96eca0c79a348b4f4}{private\_key}}(\ k\ );}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00211}00211\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00212}00212\ }
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00213}00213\ }
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00214}00214\ \}}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00215}00215\ }
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00216}\mbox{\hyperlink{namespacefc_a9330aaa2d3512be0c8bd703f596dbae2}{00216}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespacefc_adea61f2343de94d0fbcb920a32332ad9}{to\_variant}}(\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classfc_1_1ecc_1_1private__key}{ecc::private\_key}}\&\ var,\ \ \mbox{\hyperlink{classfc_1_1variant}{variant}}\&\ vo\ )}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00217}00217\ \{}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00218}00218\ \ \ \ \ vo\ =\ var.\mbox{\hyperlink{classfc_1_1ecc_1_1private__key_a24fb0ebbb99a8404323387fd06d5145f}{get\_secret}}();}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00219}00219\ \}}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00220}00220\ }
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00221}\mbox{\hyperlink{namespacefc_a6e2ea4fbc5ca8914b51b1051bf6b7d7e}{00221}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespacefc_accef08adf4ee05c36ccc550d8101b08f}{from\_variant}}(\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classfc_1_1variant}{variant}}\&\ var,\ \ \mbox{\hyperlink{classfc_1_1ecc_1_1private__key}{ecc::private\_key}}\&\ vo\ )}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00222}00222\ \{}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00223}00223\ \ \ \ \ \mbox{\hyperlink{classfc_1_1sha256}{fc::sha256}}\ sec;}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00224}00224\ \ \ \ \ \mbox{\hyperlink{namespacefc_accef08adf4ee05c36ccc550d8101b08f}{from\_variant}}(\ var,\ sec\ );}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00225}00225\ \ \ \ \ vo\ =\ \mbox{\hyperlink{classfc_1_1ecc_1_1private__key_abcc5312450e72cd78f78b7d2feb6c899}{ecc::private\_key::regenerate}}(sec);}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00226}00226\ \}}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00227}00227\ }
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00228}\mbox{\hyperlink{namespacefc_a2efa4277a8711d153a5b4b84aab9d0c1}{00228}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespacefc_adea61f2343de94d0fbcb920a32332ad9}{to\_variant}}(\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classfc_1_1ecc_1_1public__key}{ecc::public\_key}}\&\ var,\ \ \mbox{\hyperlink{classfc_1_1variant}{variant}}\&\ vo\ )}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00229}00229\ \{}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00230}00230\ \ \ \ \ vo\ =\ var.\mbox{\hyperlink{classfc_1_1ecc_1_1public__key_a066502d87da28f82ccc3c6942491cd48}{serialize}}();}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00231}00231\ \}}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00232}00232\ }
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00233}\mbox{\hyperlink{namespacefc_a8b226663d63ffa4a1de81b8b0166e097}{00233}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespacefc_accef08adf4ee05c36ccc550d8101b08f}{from\_variant}}(\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classfc_1_1variant}{variant}}\&\ var,\ \ \mbox{\hyperlink{classfc_1_1ecc_1_1public__key}{ecc::public\_key}}\&\ vo\ )}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00234}00234\ \{}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00235}00235\ \ \ \ \ \mbox{\hyperlink{classfc_1_1array}{ecc::public\_key\_data}}\ dat;}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00236}00236\ \ \ \ \ \mbox{\hyperlink{namespacefc_accef08adf4ee05c36ccc550d8101b08f}{from\_variant}}(\ var,\ dat\ );}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00237}00237\ \ \ \ \ vo\ =\ \mbox{\hyperlink{classfc_1_1ecc_1_1public__key}{ecc::public\_key}}(dat);}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00238}00238\ \}}
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00239}00239\ }
\DoxyCodeLine{\Hypertarget{elliptic__common_8cpp_source_l00240}00240\ \}}

\end{DoxyCode}
