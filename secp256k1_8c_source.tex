\doxysection{secp256k1.\+c}
\hypertarget{secp256k1_8c_source}{}\label{secp256k1_8c_source}\index{libraries/fc/secp256k1/secp256k1/src/secp256k1.c@{libraries/fc/secp256k1/secp256k1/src/secp256k1.c}}
\mbox{\hyperlink{secp256k1_8c}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00001}00001\ \textcolor{comment}{/***********************************************************************}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00002}00002\ \textcolor{comment}{\ *\ Copyright\ (c)\ 2013-\/2015\ Pieter\ Wuille\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00003}00003\ \textcolor{comment}{\ *\ Distributed\ under\ the\ MIT\ software\ license,\ see\ the\ accompanying\ \ \ \ *}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00004}00004\ \textcolor{comment}{\ *\ file\ COPYING\ or\ https://www.opensource.org/licenses/mit-\/license.php.*}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00005}00005\ \textcolor{comment}{\ ***********************************************************************/}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00006}00006\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00007}\mbox{\hyperlink{secp256k1_8c_a1c49db739b76634ccbd0db4233e6cd8a}{00007}}\ \textcolor{preprocessor}{\#define\ SECP256K1\_BUILD}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00008}00008\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00009}00009\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{secp256k1_8h}{../include/secp256k1.h}}"{}}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00010}00010\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{secp256k1__preallocated_8h}{../include/secp256k1\_preallocated.h}}"{}}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00011}00011\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00012}00012\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{assumptions_8h}{assumptions.h}}"{}}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00013}00013\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{fc_2secp256k1_2secp256k1_2src_2util_8h}{util.h}}"{}}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00014}00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{field__impl_8h}{field\_impl.h}}"{}}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00015}00015\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{scalar__impl_8h}{scalar\_impl.h}}"{}}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00016}00016\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{group__impl_8h}{group\_impl.h}}"{}}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00017}00017\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{ecmult__impl_8h}{ecmult\_impl.h}}"{}}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00018}00018\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{ecmult__const__impl_8h}{ecmult\_const\_impl.h}}"{}}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00019}00019\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{ecmult__gen__impl_8h}{ecmult\_gen\_impl.h}}"{}}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00020}00020\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{ecdsa__impl_8h}{ecdsa\_impl.h}}"{}}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00021}00021\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{eckey__impl_8h}{eckey\_impl.h}}"{}}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00022}00022\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{hash__impl_8h}{hash\_impl.h}}"{}}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00023}00023\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{scratch__impl_8h}{scratch\_impl.h}}"{}}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00024}00024\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{selftest_8h}{selftest.h}}"{}}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00025}00025\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00026}00026\ \textcolor{preprocessor}{\#ifdef\ SECP256K1\_NO\_BUILD}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00027}00027\ \textcolor{preprocessor}{\#\ error\ "{}secp256k1.h\ processed\ without\ SECP256K1\_BUILD\ defined\ while\ building\ secp256k1.c"{}}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00028}00028\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00029}00029\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00030}00030\ \textcolor{preprocessor}{\#if\ defined(VALGRIND)}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00031}00031\ \textcolor{preprocessor}{\#\ include\ <valgrind/memcheck.h>}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00032}00032\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00033}00033\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00034}\mbox{\hyperlink{secp256k1_8c_a6e1f88c6ce07376501097b42a2b40727}{00034}}\ \textcolor{preprocessor}{\#define\ ARG\_CHECK(cond)\ do\ \{\ \(\backslash\)}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00035}00035\ \textcolor{preprocessor}{\ \ \ \ if\ (EXPECT(!(cond),\ 0))\ \{\ \(\backslash\)}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00036}00036\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ secp256k1\_callback\_call(\&ctx-\/>illegal\_callback,\ \#cond);\ \(\backslash\)}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00037}00037\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ return\ 0;\ \(\backslash\)}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00038}00038\ \textcolor{preprocessor}{\ \ \ \ \}\ \(\backslash\)}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00039}00039\ \textcolor{preprocessor}{\}\ while(0)}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00040}00040\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00041}\mbox{\hyperlink{secp256k1_8c_aab3587a00b3cf74369ea1bbbaeb1c3fb}{00041}}\ \textcolor{preprocessor}{\#define\ ARG\_CHECK\_NO\_RETURN(cond)\ do\ \{\ \(\backslash\)}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00042}00042\ \textcolor{preprocessor}{\ \ \ \ if\ (EXPECT(!(cond),\ 0))\ \{\ \(\backslash\)}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00043}00043\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ secp256k1\_callback\_call(\&ctx-\/>illegal\_callback,\ \#cond);\ \(\backslash\)}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00044}00044\ \textcolor{preprocessor}{\ \ \ \ \}\ \(\backslash\)}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00045}00045\ \textcolor{preprocessor}{\}\ while(0)}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00046}00046\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00047}\mbox{\hyperlink{structsecp256k1__context__struct}{00047}}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structsecp256k1__context__struct}{secp256k1\_context\_struct}}\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00048}\mbox{\hyperlink{structsecp256k1__context__struct_aacc2071a68f9c5a6c05eb783f523b9eb}{00048}}\ \ \ \ \ \mbox{\hyperlink{structsecp256k1__ecmult__gen__context}{secp256k1\_ecmult\_gen\_context}}\ \mbox{\hyperlink{structsecp256k1__context__struct_aacc2071a68f9c5a6c05eb783f523b9eb}{ecmult\_gen\_ctx}};}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00049}\mbox{\hyperlink{structsecp256k1__context__struct_a6f73572b18e62b306c5699e9e1470ab5}{00049}}\ \ \ \ \ \mbox{\hyperlink{structsecp256k1__callback}{secp256k1\_callback}}\ \mbox{\hyperlink{structsecp256k1__context__struct_a6f73572b18e62b306c5699e9e1470ab5}{illegal\_callback}};}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00050}\mbox{\hyperlink{structsecp256k1__context__struct_aa34a996f869676899e8625adfb6c6f1d}{00050}}\ \ \ \ \ \mbox{\hyperlink{structsecp256k1__callback}{secp256k1\_callback}}\ \mbox{\hyperlink{structsecp256k1__context__struct_aa34a996f869676899e8625adfb6c6f1d}{error\_callback}};}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00051}\mbox{\hyperlink{structsecp256k1__context__struct_a8f0e90c07ace9b7a63626b768fea6b51}{00051}}\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{structsecp256k1__context__struct_a8f0e90c07ace9b7a63626b768fea6b51}{declassify}};}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00052}00052\ \};}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00053}00053\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00054}00054\ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structsecp256k1__context__struct}{secp256k1\_context}}\ secp256k1\_context\_no\_precomp\_\ =\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00055}00055\ \ \ \ \ \{\ 0\ \},}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00056}00056\ \ \ \ \ \{\ secp256k1\_default\_illegal\_callback\_fn,\ 0\ \},}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00057}00057\ \ \ \ \ \{\ secp256k1\_default\_error\_callback\_fn,\ 0\ \},}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00058}00058\ \ \ \ \ 0}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00059}00059\ \};}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00060}\mbox{\hyperlink{secp256k1_8h_a16a0e7ca1212220590374d1a9d17c77d}{00060}}\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structsecp256k1__context__struct}{secp256k1\_context}}\ *\mbox{\hyperlink{secp256k1_8c_a608b4988c34455c40bb91eb38033db1a}{secp256k1\_context\_no\_precomp}}\ =\ \&secp256k1\_context\_no\_precomp\_;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00061}00061\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00062}\mbox{\hyperlink{secp256k1__preallocated_8h_af6942b255e9715e64af285bcf0bafe4b}{00062}}\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{secp256k1_8c_a9f5faeec85b85bdaccd7ddda899dbfa2}{secp256k1\_context\_preallocated\_size}}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae0ed371842ace71a7886a6134ecbcb62}{flags}})\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00063}00063\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}}\ =\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{secp256k1_8h_a282ec9e6dfec8c35955c3eb2f7476e5e}{secp256k1\_context}});}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00064}00064\ \ \ \ \ \textcolor{comment}{/*\ A\ return\ value\ of\ 0\ is\ reserved\ as\ an\ indicator\ for\ errors\ when\ we\ call\ this\ function\ internally.\ */}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00065}00065\ \ \ \ \ \mbox{\hyperlink{fc_2secp256k1_2secp256k1_2src_2util_8h_aca8ac5ae73fd966db106de59160a178b}{VERIFY\_CHECK}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}}\ !=\ 0);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00066}00066\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00067}00067\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{fc_2secp256k1_2secp256k1_2src_2util_8h_a76e8a689f16456e44a2cc438a6821025}{EXPECT}}((\mbox{\hyperlink{yubihsm__pkcs11_8c_ae0ed371842ace71a7886a6134ecbcb62}{flags}}\ \&\ \mbox{\hyperlink{secp256k1_8h_ab2572c9f38f9a644f2933f7b74a5072f}{SECP256K1\_FLAGS\_TYPE\_MASK}})\ !=\ \mbox{\hyperlink{secp256k1_8h_ad96f13de52c4c94f5d11d53fd04c529f}{SECP256K1\_FLAGS\_TYPE\_CONTEXT}},\ 0))\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00068}00068\ \ \ \ \ \ \ \ \ \ \ \ \ secp256k1\_callback\_call(\&default\_illegal\_callback,}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00069}00069\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Invalid\ flags"{}});}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00070}00070\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00071}00071\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00072}00072\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00073}00073\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}};}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00074}00074\ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00075}00075\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00076}\mbox{\hyperlink{secp256k1__preallocated_8h_a7bb1e7240fc9ffabe07e565603a4dfee}{00076}}\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{secp256k1_8c_a5665930bf606d6a7262cebc936eda949}{secp256k1\_context\_preallocated\_clone\_size}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structsecp256k1__context__struct}{secp256k1\_context}}*\ ctx)\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00077}00077\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}}\ =\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{secp256k1_8h_a282ec9e6dfec8c35955c3eb2f7476e5e}{secp256k1\_context}});}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00078}00078\ \ \ \ \ \mbox{\hyperlink{fc_2secp256k1_2secp256k1_2src_2util_8h_aca8ac5ae73fd966db106de59160a178b}{VERIFY\_CHECK}}(ctx\ !=\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00079}00079\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}};}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00080}00080\ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00081}00081\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00082}\mbox{\hyperlink{secp256k1__preallocated_8h_ae5490f09b147364c44bf1129b624405f}{00082}}\ \mbox{\hyperlink{structsecp256k1__context__struct}{secp256k1\_context}}*\ \mbox{\hyperlink{secp256k1_8c_af4866e9619f06679358fe6338ed42cd0}{secp256k1\_context\_preallocated\_create}}(\textcolor{keywordtype}{void}*\ prealloc,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae0ed371842ace71a7886a6134ecbcb62}{flags}})\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00083}00083\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ prealloc\_size;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00084}00084\ \ \ \ \ \mbox{\hyperlink{structsecp256k1__context__struct}{secp256k1\_context}}*\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}};}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00085}00085\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00086}00086\ \ \ \ \ \textcolor{keywordflow}{if}\ (!secp256k1\_selftest())\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00087}00087\ \ \ \ \ \ \ \ \ secp256k1\_callback\_call(\&default\_error\_callback,\ \textcolor{stringliteral}{"{}self\ test\ failed"{}});}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00088}00088\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00089}00089\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00090}00090\ \ \ \ \ prealloc\_size\ =\ \mbox{\hyperlink{secp256k1_8c_a9f5faeec85b85bdaccd7ddda899dbfa2}{secp256k1\_context\_preallocated\_size}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_ae0ed371842ace71a7886a6134ecbcb62}{flags}});}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00091}00091\ \ \ \ \ \textcolor{keywordflow}{if}\ (prealloc\_size\ ==\ 0)\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00092}00092\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ NULL;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00093}00093\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00094}00094\ \ \ \ \ \mbox{\hyperlink{fc_2secp256k1_2secp256k1_2src_2util_8h_aca8ac5ae73fd966db106de59160a178b}{VERIFY\_CHECK}}(prealloc\ !=\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00095}00095\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}}\ =\ (\mbox{\hyperlink{structsecp256k1__context__struct}{secp256k1\_context}}*)prealloc;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00096}00096\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}}-\/>illegal\_callback\ =\ default\_illegal\_callback;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00097}00097\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}}-\/>error\_callback\ =\ default\_error\_callback;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00098}00098\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00099}00099\ \ \ \ \ \textcolor{comment}{/*\ Flags\ have\ been\ checked\ by\ secp256k1\_context\_preallocated\_size.\ */}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00100}00100\ \ \ \ \ \mbox{\hyperlink{fc_2secp256k1_2secp256k1_2src_2util_8h_aca8ac5ae73fd966db106de59160a178b}{VERIFY\_CHECK}}((\mbox{\hyperlink{yubihsm__pkcs11_8c_ae0ed371842ace71a7886a6134ecbcb62}{flags}}\ \&\ \mbox{\hyperlink{secp256k1_8h_ab2572c9f38f9a644f2933f7b74a5072f}{SECP256K1\_FLAGS\_TYPE\_MASK}})\ ==\ \mbox{\hyperlink{secp256k1_8h_ad96f13de52c4c94f5d11d53fd04c529f}{SECP256K1\_FLAGS\_TYPE\_CONTEXT}});}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00101}00101\ \ \ \ \ secp256k1\_ecmult\_gen\_context\_build(\&\mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}}-\/>ecmult\_gen\_ctx);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00102}00102\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}}-\/>declassify\ =\ !!(\mbox{\hyperlink{yubihsm__pkcs11_8c_ae0ed371842ace71a7886a6134ecbcb62}{flags}}\ \&\ \mbox{\hyperlink{secp256k1_8h_a459a70e8b474694c71f238f91a0d7921}{SECP256K1\_FLAGS\_BIT\_CONTEXT\_DECLASSIFY}});}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00103}00103\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00104}00104\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}};}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00105}00105\ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00106}00106\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00107}\mbox{\hyperlink{secp256k1_8h_a3aaa9fcc3ab67bc8f841779a049069c5}{00107}}\ \mbox{\hyperlink{structsecp256k1__context__struct}{secp256k1\_context}}*\ \mbox{\hyperlink{secp256k1_8c_a861ce6fc7ee5e9fc346a5fee7093adb1}{secp256k1\_context\_create}}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae0ed371842ace71a7886a6134ecbcb62}{flags}})\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00108}00108\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \textcolor{keyword}{const}\ prealloc\_size\ =\ \mbox{\hyperlink{secp256k1_8c_a9f5faeec85b85bdaccd7ddda899dbfa2}{secp256k1\_context\_preallocated\_size}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_ae0ed371842ace71a7886a6134ecbcb62}{flags}});}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00109}00109\ \ \ \ \ \mbox{\hyperlink{structsecp256k1__context__struct}{secp256k1\_context}}*\ ctx\ =\ (\mbox{\hyperlink{structsecp256k1__context__struct}{secp256k1\_context}}*)checked\_malloc(\&default\_error\_callback,\ prealloc\_size);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00110}00110\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{fc_2secp256k1_2secp256k1_2src_2util_8h_a76e8a689f16456e44a2cc438a6821025}{EXPECT}}(\mbox{\hyperlink{secp256k1_8c_af4866e9619f06679358fe6338ed42cd0}{secp256k1\_context\_preallocated\_create}}(ctx,\ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae0ed371842ace71a7886a6134ecbcb62}{flags}})\ ==\ NULL,\ 0))\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00111}00111\ \ \ \ \ \ \ \ \ free(ctx);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00112}00112\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ NULL;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00113}00113\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00114}00114\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00115}00115\ \ \ \ \ \textcolor{keywordflow}{return}\ ctx;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00116}00116\ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00117}00117\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00118}\mbox{\hyperlink{secp256k1__preallocated_8h_afbe046709184f275b585435091ddb5c3}{00118}}\ \mbox{\hyperlink{structsecp256k1__context__struct}{secp256k1\_context}}*\ \mbox{\hyperlink{secp256k1_8c_a2a2e39dbcd6d55d8e6faaad194261a71}{secp256k1\_context\_preallocated\_clone}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structsecp256k1__context__struct}{secp256k1\_context}}*\ ctx,\ \textcolor{keywordtype}{void}*\ prealloc)\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00119}00119\ \ \ \ \ \mbox{\hyperlink{structsecp256k1__context__struct}{secp256k1\_context}}*\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}};}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00120}00120\ \ \ \ \ \mbox{\hyperlink{fc_2secp256k1_2secp256k1_2src_2util_8h_aca8ac5ae73fd966db106de59160a178b}{VERIFY\_CHECK}}(ctx\ !=\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00121}00121\ \ \ \ \ \mbox{\hyperlink{secp256k1_8c_a6e1f88c6ce07376501097b42a2b40727}{ARG\_CHECK}}(prealloc\ !=\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00122}00122\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00123}00123\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}}\ =\ (\mbox{\hyperlink{structsecp256k1__context__struct}{secp256k1\_context}}*)prealloc;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00124}00124\ \ \ \ \ *\mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}}\ =\ *ctx;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00125}00125\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}};}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00126}00126\ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00127}00127\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00128}\mbox{\hyperlink{secp256k1_8h_aa999f2e6f81210fc8970af81cf75bef8}{00128}}\ \mbox{\hyperlink{structsecp256k1__context__struct}{secp256k1\_context}}*\ \mbox{\hyperlink{secp256k1_8c_adb5e8056701518fc6aac1738ff58fec1}{secp256k1\_context\_clone}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structsecp256k1__context__struct}{secp256k1\_context}}*\ ctx)\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00129}00129\ \ \ \ \ \mbox{\hyperlink{structsecp256k1__context__struct}{secp256k1\_context}}*\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}};}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00130}00130\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ prealloc\_size;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00131}00131\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00132}00132\ \ \ \ \ \mbox{\hyperlink{fc_2secp256k1_2secp256k1_2src_2util_8h_aca8ac5ae73fd966db106de59160a178b}{VERIFY\_CHECK}}(ctx\ !=\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00133}00133\ \ \ \ \ prealloc\_size\ =\ \mbox{\hyperlink{secp256k1_8c_a5665930bf606d6a7262cebc936eda949}{secp256k1\_context\_preallocated\_clone\_size}}(ctx);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00134}00134\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}}\ =\ (\mbox{\hyperlink{structsecp256k1__context__struct}{secp256k1\_context}}*)checked\_malloc(\&ctx-\/>\mbox{\hyperlink{structsecp256k1__context__struct_aa34a996f869676899e8625adfb6c6f1d}{error\_callback}},\ prealloc\_size);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00135}00135\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}}\ =\ \mbox{\hyperlink{secp256k1_8c_a2a2e39dbcd6d55d8e6faaad194261a71}{secp256k1\_context\_preallocated\_clone}}(ctx,\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}});}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00136}00136\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}};}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00137}00137\ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00138}00138\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00139}\mbox{\hyperlink{secp256k1__preallocated_8h_ae51bf3c2ed533998dab9c7b2ce180664}{00139}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{secp256k1_8c_a62b32b6a46f53b6aef01d3888496a79f}{secp256k1\_context\_preallocated\_destroy}}(\mbox{\hyperlink{structsecp256k1__context__struct}{secp256k1\_context}}*\ ctx)\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00140}00140\ \ \ \ \ \mbox{\hyperlink{secp256k1_8c_aab3587a00b3cf74369ea1bbbaeb1c3fb}{ARG\_CHECK\_NO\_RETURN}}(ctx\ !=\ \mbox{\hyperlink{secp256k1_8c_a608b4988c34455c40bb91eb38033db1a}{secp256k1\_context\_no\_precomp}});}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00141}00141\ \ \ \ \ \textcolor{keywordflow}{if}\ (ctx\ !=\ NULL)\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00142}00142\ \ \ \ \ \ \ \ \ secp256k1\_ecmult\_gen\_context\_clear(\&ctx-\/>\mbox{\hyperlink{structsecp256k1__context__struct_aacc2071a68f9c5a6c05eb783f523b9eb}{ecmult\_gen\_ctx}});}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00143}00143\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00144}00144\ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00145}00145\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00146}\mbox{\hyperlink{secp256k1_8h_a026db914e3723531825ecf25a0cbd699}{00146}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{secp256k1_8c_ac80c186f8ff22d87441240267a2c8100}{secp256k1\_context\_destroy}}(\mbox{\hyperlink{structsecp256k1__context__struct}{secp256k1\_context}}*\ ctx)\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00147}00147\ \ \ \ \ \textcolor{keywordflow}{if}\ (ctx\ !=\ NULL)\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00148}00148\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{secp256k1_8c_a62b32b6a46f53b6aef01d3888496a79f}{secp256k1\_context\_preallocated\_destroy}}(ctx);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00149}00149\ \ \ \ \ \ \ \ \ free(ctx);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00150}00150\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00151}00151\ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00152}00152\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00153}\mbox{\hyperlink{secp256k1_8h_a3ec29bece9974f9535337eb7d91b351c}{00153}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{secp256k1_8c_a947ba36e0fe0bced91d4c9a7ef3b1f09}{secp256k1\_context\_set\_illegal\_callback}}(\mbox{\hyperlink{structsecp256k1__context__struct}{secp256k1\_context}}*\ ctx,\ \textcolor{keywordtype}{void}\ (*fun)(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ message,\ \textcolor{keywordtype}{void}*\ data),\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}*\ data)\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00154}00154\ \ \ \ \ \mbox{\hyperlink{secp256k1_8c_aab3587a00b3cf74369ea1bbbaeb1c3fb}{ARG\_CHECK\_NO\_RETURN}}(ctx\ !=\ \mbox{\hyperlink{secp256k1_8c_a608b4988c34455c40bb91eb38033db1a}{secp256k1\_context\_no\_precomp}});}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00155}00155\ \ \ \ \ \textcolor{keywordflow}{if}\ (fun\ ==\ NULL)\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00156}00156\ \ \ \ \ \ \ \ \ fun\ =\ secp256k1\_default\_illegal\_callback\_fn;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00157}00157\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00158}00158\ \ \ \ \ ctx-\/>\mbox{\hyperlink{structsecp256k1__context__struct_a6f73572b18e62b306c5699e9e1470ab5}{illegal\_callback}}.\mbox{\hyperlink{structsecp256k1__callback_ab53dda8f586b668b302a0955de4de44c}{fn}}\ =\ fun;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00159}00159\ \ \ \ \ ctx-\/>\mbox{\hyperlink{structsecp256k1__context__struct_a6f73572b18e62b306c5699e9e1470ab5}{illegal\_callback}}.\mbox{\hyperlink{structsecp256k1__callback_acd5a72114709ca9841ad31f88c1744bc}{data}}\ =\ data;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00160}00160\ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00161}00161\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00162}\mbox{\hyperlink{secp256k1_8h_a35106efb325f03468bcf5faa524c1cc4}{00162}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{secp256k1_8c_a7384d60163d08fae0c5e8d1e1fdef60a}{secp256k1\_context\_set\_error\_callback}}(\mbox{\hyperlink{structsecp256k1__context__struct}{secp256k1\_context}}*\ ctx,\ \textcolor{keywordtype}{void}\ (*fun)(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ message,\ \textcolor{keywordtype}{void}*\ data),\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}*\ data)\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00163}00163\ \ \ \ \ \mbox{\hyperlink{secp256k1_8c_aab3587a00b3cf74369ea1bbbaeb1c3fb}{ARG\_CHECK\_NO\_RETURN}}(ctx\ !=\ \mbox{\hyperlink{secp256k1_8c_a608b4988c34455c40bb91eb38033db1a}{secp256k1\_context\_no\_precomp}});}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00164}00164\ \ \ \ \ \textcolor{keywordflow}{if}\ (fun\ ==\ NULL)\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00165}00165\ \ \ \ \ \ \ \ \ fun\ =\ secp256k1\_default\_error\_callback\_fn;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00166}00166\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00167}00167\ \ \ \ \ ctx-\/>\mbox{\hyperlink{structsecp256k1__context__struct_aa34a996f869676899e8625adfb6c6f1d}{error\_callback}}.\mbox{\hyperlink{structsecp256k1__callback_ab53dda8f586b668b302a0955de4de44c}{fn}}\ =\ fun;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00168}00168\ \ \ \ \ ctx-\/>\mbox{\hyperlink{structsecp256k1__context__struct_aa34a996f869676899e8625adfb6c6f1d}{error\_callback}}.\mbox{\hyperlink{structsecp256k1__callback_acd5a72114709ca9841ad31f88c1744bc}{data}}\ =\ data;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00169}00169\ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00170}00170\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00171}\mbox{\hyperlink{secp256k1_8h_a0ff055dc909a6a4e4272097fe71870ef}{00171}}\ \mbox{\hyperlink{structsecp256k1__scratch__space__struct}{secp256k1\_scratch\_space}}*\ \mbox{\hyperlink{secp256k1_8c_aba5c99ecba24dd041f23c4cdebf6d7c9}{secp256k1\_scratch\_space\_create}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structsecp256k1__context__struct}{secp256k1\_context}}*\ ctx,\ \textcolor{keywordtype}{size\_t}\ max\_size)\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00172}00172\ \ \ \ \ \mbox{\hyperlink{fc_2secp256k1_2secp256k1_2src_2util_8h_aca8ac5ae73fd966db106de59160a178b}{VERIFY\_CHECK}}(ctx\ !=\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00173}00173\ \ \ \ \ \textcolor{keywordflow}{return}\ secp256k1\_scratch\_create(\&ctx-\/>\mbox{\hyperlink{structsecp256k1__context__struct_aa34a996f869676899e8625adfb6c6f1d}{error\_callback}},\ max\_size);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00174}00174\ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00175}00175\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00176}\mbox{\hyperlink{secp256k1_8h_ad6ebf73791ba271fd801a4deeba36780}{00176}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{secp256k1_8c_addc63f28c7f69289736875fae7ac429f}{secp256k1\_scratch\_space\_destroy}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structsecp256k1__context__struct}{secp256k1\_context}}\ *ctx,\ \mbox{\hyperlink{structsecp256k1__scratch__space__struct}{secp256k1\_scratch\_space}}*\ scratch)\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00177}00177\ \ \ \ \ \mbox{\hyperlink{fc_2secp256k1_2secp256k1_2src_2util_8h_aca8ac5ae73fd966db106de59160a178b}{VERIFY\_CHECK}}(ctx\ !=\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00178}00178\ \ \ \ \ secp256k1\_scratch\_destroy(\&ctx-\/>\mbox{\hyperlink{structsecp256k1__context__struct_aa34a996f869676899e8625adfb6c6f1d}{error\_callback}},\ scratch);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00179}00179\ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00180}00180\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00181}00181\ \textcolor{comment}{/*\ Mark\ memory\ as\ no-\/longer-\/secret\ for\ the\ purpose\ of\ analysing\ constant-\/time\ behaviour}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00182}00182\ \textcolor{comment}{\ *\ \ of\ the\ software.\ This\ is\ setup\ for\ use\ with\ valgrind\ but\ could\ be\ substituted\ with}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00183}00183\ \textcolor{comment}{\ *\ \ the\ appropriate\ instrumentation\ for\ other\ analysis\ tools.}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00184}00184\ \textcolor{comment}{\ */}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00185}00185\ \textcolor{keyword}{static}\ \mbox{\hyperlink{secp256k1_8h_a7ddc487fd46aee88f21cabedb7268b1e}{SECP256K1\_INLINE}}\ \textcolor{keywordtype}{void}\ secp256k1\_declassify(\textcolor{keyword}{const}\ \mbox{\hyperlink{structsecp256k1__context__struct}{secp256k1\_context}}*\ ctx,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *\mbox{\hyperlink{bn_8cpp_a8b0eadcc506862e9d751ab45185053aa}{p}},\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a7360b55975153b822efc5217b7734e6a}{len}})\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00186}00186\ \textcolor{preprocessor}{\#if\ defined(VALGRIND)}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00187}00187\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{fc_2secp256k1_2secp256k1_2src_2util_8h_a76e8a689f16456e44a2cc438a6821025}{EXPECT}}(ctx-\/>\mbox{\hyperlink{structsecp256k1__context__struct_a8f0e90c07ace9b7a63626b768fea6b51}{declassify}},0))\ VALGRIND\_MAKE\_MEM\_DEFINED(\mbox{\hyperlink{bn_8cpp_a8b0eadcc506862e9d751ab45185053aa}{p}},\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a7360b55975153b822efc5217b7734e6a}{len}});}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00188}00188\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00189}00189\ \ \ \ \ (void)ctx;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00190}00190\ \ \ \ \ (void)\mbox{\hyperlink{bn_8cpp_a8b0eadcc506862e9d751ab45185053aa}{p}};}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00191}00191\ \ \ \ \ (void)\mbox{\hyperlink{yubihsm__pkcs11_8c_a7360b55975153b822efc5217b7734e6a}{len}};}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00192}00192\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00193}00193\ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00194}00194\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00195}00195\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{int}\ secp256k1\_pubkey\_load(\textcolor{keyword}{const}\ \mbox{\hyperlink{structsecp256k1__context__struct}{secp256k1\_context}}*\ ctx,\ \mbox{\hyperlink{structsecp256k1__ge}{secp256k1\_ge}}*\ ge,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structsecp256k1__pubkey}{secp256k1\_pubkey}}*\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a931987c85fd408a620505ee9a1aa6f58}{pubkey}})\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00196}00196\ \ \ \ \ \textcolor{keywordflow}{if}\ (\textcolor{keyword}{sizeof}(\mbox{\hyperlink{structsecp256k1__ge__storage}{secp256k1\_ge\_storage}})\ ==\ 64)\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00197}00197\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ When\ the\ secp256k1\_ge\_storage\ type\ is\ exactly\ 64\ byte,\ use\ its}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00198}00198\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ representation\ inside\ secp256k1\_pubkey,\ as\ conversion\ is\ very\ fast.}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00199}00199\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ Note\ that\ secp256k1\_pubkey\_save\ must\ use\ the\ same\ representation.\ */}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00200}00200\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structsecp256k1__ge__storage}{secp256k1\_ge\_storage}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}};}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00201}00201\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(\&\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}},\ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a931987c85fd408a620505ee9a1aa6f58}{pubkey}}-\/>data[0],\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}}));}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00202}00202\ \ \ \ \ \ \ \ \ secp256k1\_ge\_from\_storage(ge,\ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}});}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00203}00203\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00204}00204\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Otherwise,\ fall\ back\ to\ 32-\/byte\ big\ endian\ for\ X\ and\ Y.\ */}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00205}00205\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structsecp256k1__fe}{secp256k1\_fe}}\ x,\ \mbox{\hyperlink{namespacefc_ab199a7c94624123911206db59ebe45da}{y}};}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00206}00206\ \ \ \ \ \ \ \ \ secp256k1\_fe\_set\_b32(\&x,\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a931987c85fd408a620505ee9a1aa6f58}{pubkey}}-\/>data);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00207}00207\ \ \ \ \ \ \ \ \ secp256k1\_fe\_set\_b32(\&y,\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a931987c85fd408a620505ee9a1aa6f58}{pubkey}}-\/>data\ +\ 32);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00208}00208\ \ \ \ \ \ \ \ \ secp256k1\_ge\_set\_xy(ge,\ \&x,\ \&y);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00209}00209\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00210}00210\ \ \ \ \ \mbox{\hyperlink{secp256k1_8c_a6e1f88c6ce07376501097b42a2b40727}{ARG\_CHECK}}(!secp256k1\_fe\_is\_zero(\&ge-\/>\mbox{\hyperlink{structsecp256k1__ge_a3c04a97b606c82ea87e55d4a06f06b6e}{x}}));}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00211}00211\ \ \ \ \ \textcolor{keywordflow}{return}\ 1;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00212}00212\ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00213}00213\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00214}00214\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ secp256k1\_pubkey\_save(\mbox{\hyperlink{structsecp256k1__pubkey}{secp256k1\_pubkey}}*\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a931987c85fd408a620505ee9a1aa6f58}{pubkey}},\ \mbox{\hyperlink{structsecp256k1__ge}{secp256k1\_ge}}*\ ge)\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00215}00215\ \ \ \ \ \textcolor{keywordflow}{if}\ (\textcolor{keyword}{sizeof}(\mbox{\hyperlink{structsecp256k1__ge__storage}{secp256k1\_ge\_storage}})\ ==\ 64)\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00216}00216\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structsecp256k1__ge__storage}{secp256k1\_ge\_storage}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}};}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00217}00217\ \ \ \ \ \ \ \ \ secp256k1\_ge\_to\_storage(\&\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}},\ ge);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00218}00218\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(\&\mbox{\hyperlink{yubihsm__pkcs11_8c_a931987c85fd408a620505ee9a1aa6f58}{pubkey}}-\/>data[0],\ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}},\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}}));}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00219}00219\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00220}00220\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{fc_2secp256k1_2secp256k1_2src_2util_8h_aca8ac5ae73fd966db106de59160a178b}{VERIFY\_CHECK}}(!secp256k1\_ge\_is\_infinity(ge));}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00221}00221\ \ \ \ \ \ \ \ \ secp256k1\_fe\_normalize\_var(\&ge-\/>\mbox{\hyperlink{structsecp256k1__ge_a3c04a97b606c82ea87e55d4a06f06b6e}{x}});}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00222}00222\ \ \ \ \ \ \ \ \ secp256k1\_fe\_normalize\_var(\&ge-\/>\mbox{\hyperlink{structsecp256k1__ge_a604295983a1f4aa6e8b5b0f1e46f9ee0}{y}});}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00223}00223\ \ \ \ \ \ \ \ \ secp256k1\_fe\_get\_b32(\mbox{\hyperlink{yubihsm__pkcs11_8c_a931987c85fd408a620505ee9a1aa6f58}{pubkey}}-\/>data,\ \&ge-\/>\mbox{\hyperlink{structsecp256k1__ge_a3c04a97b606c82ea87e55d4a06f06b6e}{x}});}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00224}00224\ \ \ \ \ \ \ \ \ secp256k1\_fe\_get\_b32(\mbox{\hyperlink{yubihsm__pkcs11_8c_a931987c85fd408a620505ee9a1aa6f58}{pubkey}}-\/>data\ +\ 32,\ \&ge-\/>\mbox{\hyperlink{structsecp256k1__ge_a604295983a1f4aa6e8b5b0f1e46f9ee0}{y}});}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00225}00225\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00226}00226\ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00227}00227\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00228}\mbox{\hyperlink{secp256k1_8h_a4e5dc8952c9a7e791376505ef2023ca1}{00228}}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{secp256k1_8c_a4a359778a7faf65fba9d34db17642d20}{secp256k1\_ec\_pubkey\_parse}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structsecp256k1__context__struct}{secp256k1\_context}}*\ ctx,\ \mbox{\hyperlink{structsecp256k1__pubkey}{secp256k1\_pubkey}}*\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a931987c85fd408a620505ee9a1aa6f58}{pubkey}},\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *input,\ \textcolor{keywordtype}{size\_t}\ inputlen)\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00229}00229\ \ \ \ \ \mbox{\hyperlink{structsecp256k1__ge}{secp256k1\_ge}}\ Q;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00230}00230\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00231}00231\ \ \ \ \ \mbox{\hyperlink{fc_2secp256k1_2secp256k1_2src_2util_8h_aca8ac5ae73fd966db106de59160a178b}{VERIFY\_CHECK}}(ctx\ !=\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00232}00232\ \ \ \ \ \mbox{\hyperlink{secp256k1_8c_a6e1f88c6ce07376501097b42a2b40727}{ARG\_CHECK}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a931987c85fd408a620505ee9a1aa6f58}{pubkey}}\ !=\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00233}00233\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_adc4bd59a60361844aa0e852efa210105}{memset}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a931987c85fd408a620505ee9a1aa6f58}{pubkey}},\ 0,\ \textcolor{keyword}{sizeof}(*\mbox{\hyperlink{yubihsm__pkcs11_8c_a931987c85fd408a620505ee9a1aa6f58}{pubkey}}));}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00234}00234\ \ \ \ \ \mbox{\hyperlink{secp256k1_8c_a6e1f88c6ce07376501097b42a2b40727}{ARG\_CHECK}}(input\ !=\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00235}00235\ \ \ \ \ \textcolor{keywordflow}{if}\ (!secp256k1\_eckey\_pubkey\_parse(\&Q,\ input,\ inputlen))\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00236}00236\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00237}00237\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00238}00238\ \ \ \ \ \textcolor{keywordflow}{if}\ (!secp256k1\_ge\_is\_in\_correct\_subgroup(\&Q))\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00239}00239\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00240}00240\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00241}00241\ \ \ \ \ secp256k1\_pubkey\_save(\mbox{\hyperlink{yubihsm__pkcs11_8c_a931987c85fd408a620505ee9a1aa6f58}{pubkey}},\ \&Q);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00242}00242\ \ \ \ \ secp256k1\_ge\_clear(\&Q);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00243}00243\ \ \ \ \ \textcolor{keywordflow}{return}\ 1;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00244}00244\ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00245}00245\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00246}\mbox{\hyperlink{secp256k1_8h_a34977bf00322e510e881160c421836d7}{00246}}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{secp256k1_8c_a3b0440ba2ccd06e9262b94b41b680df1}{secp256k1\_ec\_pubkey\_serialize}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structsecp256k1__context__struct}{secp256k1\_context}}*\ ctx,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *output,\ \textcolor{keywordtype}{size\_t}\ *outputlen,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structsecp256k1__pubkey}{secp256k1\_pubkey}}*\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a931987c85fd408a620505ee9a1aa6f58}{pubkey}},\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae0ed371842ace71a7886a6134ecbcb62}{flags}})\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00247}00247\ \ \ \ \ \mbox{\hyperlink{structsecp256k1__ge}{secp256k1\_ge}}\ Q;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00248}00248\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a7360b55975153b822efc5217b7734e6a}{len}};}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00249}00249\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}}\ =\ 0;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00250}00250\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00251}00251\ \ \ \ \ \mbox{\hyperlink{fc_2secp256k1_2secp256k1_2src_2util_8h_aca8ac5ae73fd966db106de59160a178b}{VERIFY\_CHECK}}(ctx\ !=\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00252}00252\ \ \ \ \ \mbox{\hyperlink{secp256k1_8c_a6e1f88c6ce07376501097b42a2b40727}{ARG\_CHECK}}(outputlen\ !=\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00253}00253\ \ \ \ \ \mbox{\hyperlink{secp256k1_8c_a6e1f88c6ce07376501097b42a2b40727}{ARG\_CHECK}}(*outputlen\ >=\ ((\mbox{\hyperlink{yubihsm__pkcs11_8c_ae0ed371842ace71a7886a6134ecbcb62}{flags}}\ \&\ \mbox{\hyperlink{secp256k1_8h_ac26f7c3f665e6422a651d2eb910f1a03}{SECP256K1\_FLAGS\_BIT\_COMPRESSION}})\ ?\ 33u\ :\ 65u));}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00254}00254\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a7360b55975153b822efc5217b7734e6a}{len}}\ =\ *outputlen;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00255}00255\ \ \ \ \ *outputlen\ =\ 0;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00256}00256\ \ \ \ \ \mbox{\hyperlink{secp256k1_8c_a6e1f88c6ce07376501097b42a2b40727}{ARG\_CHECK}}(output\ !=\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00257}00257\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_adc4bd59a60361844aa0e852efa210105}{memset}}(output,\ 0,\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a7360b55975153b822efc5217b7734e6a}{len}});}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00258}00258\ \ \ \ \ \mbox{\hyperlink{secp256k1_8c_a6e1f88c6ce07376501097b42a2b40727}{ARG\_CHECK}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a931987c85fd408a620505ee9a1aa6f58}{pubkey}}\ !=\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00259}00259\ \ \ \ \ \mbox{\hyperlink{secp256k1_8c_a6e1f88c6ce07376501097b42a2b40727}{ARG\_CHECK}}((\mbox{\hyperlink{yubihsm__pkcs11_8c_ae0ed371842ace71a7886a6134ecbcb62}{flags}}\ \&\ \mbox{\hyperlink{secp256k1_8h_ab2572c9f38f9a644f2933f7b74a5072f}{SECP256K1\_FLAGS\_TYPE\_MASK}})\ ==\ \mbox{\hyperlink{secp256k1_8h_af8d4e9ca93634062735b7f998ef9f68a}{SECP256K1\_FLAGS\_TYPE\_COMPRESSION}});}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00260}00260\ \ \ \ \ \textcolor{keywordflow}{if}\ (secp256k1\_pubkey\_load(ctx,\ \&Q,\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a931987c85fd408a620505ee9a1aa6f58}{pubkey}}))\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00261}00261\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}}\ =\ secp256k1\_eckey\_pubkey\_serialize(\&Q,\ output,\ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a7360b55975153b822efc5217b7734e6a}{len}},\ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae0ed371842ace71a7886a6134ecbcb62}{flags}}\ \&\ \mbox{\hyperlink{secp256k1_8h_ac26f7c3f665e6422a651d2eb910f1a03}{SECP256K1\_FLAGS\_BIT\_COMPRESSION}});}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00262}00262\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}})\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00263}00263\ \ \ \ \ \ \ \ \ \ \ \ \ *outputlen\ =\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a7360b55975153b822efc5217b7734e6a}{len}};}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00264}00264\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00265}00265\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00266}00266\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}};}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00267}00267\ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00268}00268\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00269}\mbox{\hyperlink{secp256k1_8h_a3607442049a415a5f649f53b089e766a}{00269}}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{secp256k1_8c_a88fd105847bf65f59db29fed819570c6}{secp256k1\_ec\_pubkey\_cmp}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structsecp256k1__context__struct}{secp256k1\_context}}*\ ctx,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structsecp256k1__pubkey}{secp256k1\_pubkey}}*\ pubkey0,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structsecp256k1__pubkey}{secp256k1\_pubkey}}*\ pubkey1)\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00270}00270\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ out[2][33];}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00271}00271\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structsecp256k1__pubkey}{secp256k1\_pubkey}}*\ pk[2];}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00272}00272\ \ \ \ \ \textcolor{keywordtype}{int}\ i;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00273}00273\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00274}00274\ \ \ \ \ \mbox{\hyperlink{fc_2secp256k1_2secp256k1_2src_2util_8h_aca8ac5ae73fd966db106de59160a178b}{VERIFY\_CHECK}}(ctx\ !=\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00275}00275\ \ \ \ \ pk[0]\ =\ pubkey0;\ pk[1]\ =\ pubkey1;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00276}00276\ \ \ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0;\ i\ <\ 2;\ i++)\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00277}00277\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ out\_size\ =\ \textcolor{keyword}{sizeof}(out[i]);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00278}00278\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ If\ the\ public\ key\ is\ NULL\ or\ invalid,\ ec\_pubkey\_serialize\ will\ call}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00279}00279\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ the\ illegal\_callback\ and\ return\ 0.\ In\ that\ case\ we\ will\ serialize\ the}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00280}00280\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ key\ as\ all\ zeros\ which\ is\ less\ than\ any\ valid\ public\ key.\ This}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00281}00281\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ results\ in\ consistent\ comparisons\ even\ if\ NULL\ or\ invalid\ pubkeys\ are}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00282}00282\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ involved\ and\ prevents\ edge\ cases\ such\ as\ sorting\ algorithms\ that\ use}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00283}00283\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ this\ function\ and\ do\ not\ terminate\ as\ a\ result.\ */}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00284}00284\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{secp256k1_8c_a3b0440ba2ccd06e9262b94b41b680df1}{secp256k1\_ec\_pubkey\_serialize}}(ctx,\ out[i],\ \&out\_size,\ pk[i],\ \mbox{\hyperlink{secp256k1_8h_a7b8f642c65e8b5c81fa4421b7c42ab57}{SECP256K1\_EC\_COMPRESSED}}))\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00285}00285\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Note\ that\ ec\_pubkey\_serialize\ should\ already\ set\ the\ output\ to}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00286}00286\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ *\ zero\ in\ that\ case,\ but\ it's\ not\ guaranteed\ by\ the\ API,\ we\ can't}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00287}00287\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ *\ test\ it\ and\ writing\ a\ VERIFY\_CHECK\ is\ more\ complex\ than}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00288}00288\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ *\ explicitly\ memsetting\ (again).\ */}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00289}00289\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_adc4bd59a60361844aa0e852efa210105}{memset}}(out[i],\ 0,\ \textcolor{keyword}{sizeof}(out[i]));}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00290}00290\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00291}00291\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00292}00292\ \ \ \ \ \textcolor{keywordflow}{return}\ secp256k1\_memcmp\_var(out[0],\ out[1],\ \textcolor{keyword}{sizeof}(out[0]));}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00293}00293\ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00294}00294\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00295}00295\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ secp256k1\_ecdsa\_signature\_load(\textcolor{keyword}{const}\ \mbox{\hyperlink{structsecp256k1__context__struct}{secp256k1\_context}}*\ ctx,\ \mbox{\hyperlink{structsecp256k1__scalar}{secp256k1\_scalar}}*\ \mbox{\hyperlink{bn_8cpp_af0a5201ca8846f05f25435b41d7f39f7}{r}},\ \mbox{\hyperlink{structsecp256k1__scalar}{secp256k1\_scalar}}*\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}},\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structsecp256k1__ecdsa__signature}{secp256k1\_ecdsa\_signature}}*\ sig)\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00296}00296\ \ \ \ \ (void)ctx;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00297}00297\ \ \ \ \ \textcolor{keywordflow}{if}\ (\textcolor{keyword}{sizeof}(\mbox{\hyperlink{structsecp256k1__scalar}{secp256k1\_scalar}})\ ==\ 32)\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00298}00298\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ When\ the\ secp256k1\_scalar\ type\ is\ exactly\ 32\ byte,\ use\ its}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00299}00299\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ representation\ inside\ secp256k1\_ecdsa\_signature,\ as\ conversion\ is\ very\ fast.}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00300}00300\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ Note\ that\ secp256k1\_ecdsa\_signature\_save\ must\ use\ the\ same\ representation.\ */}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00301}00301\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(\mbox{\hyperlink{bn_8cpp_af0a5201ca8846f05f25435b41d7f39f7}{r}},\ \&sig-\/>\mbox{\hyperlink{structsecp256k1__ecdsa__signature_a80f750e6d473a8d43c77e53757893f15}{data}}[0],\ 32);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00302}00302\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}},\ \&sig-\/>\mbox{\hyperlink{structsecp256k1__ecdsa__signature_a80f750e6d473a8d43c77e53757893f15}{data}}[32],\ 32);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00303}00303\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00304}00304\ \ \ \ \ \ \ \ \ secp256k1\_scalar\_set\_b32(\mbox{\hyperlink{bn_8cpp_af0a5201ca8846f05f25435b41d7f39f7}{r}},\ \&sig-\/>\mbox{\hyperlink{structsecp256k1__ecdsa__signature_a80f750e6d473a8d43c77e53757893f15}{data}}[0],\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00305}00305\ \ \ \ \ \ \ \ \ secp256k1\_scalar\_set\_b32(\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}},\ \&sig-\/>\mbox{\hyperlink{structsecp256k1__ecdsa__signature_a80f750e6d473a8d43c77e53757893f15}{data}}[32],\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00306}00306\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00307}00307\ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00308}00308\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00309}00309\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ secp256k1\_ecdsa\_signature\_save(\mbox{\hyperlink{structsecp256k1__ecdsa__signature}{secp256k1\_ecdsa\_signature}}*\ sig,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structsecp256k1__scalar}{secp256k1\_scalar}}*\ \mbox{\hyperlink{bn_8cpp_af0a5201ca8846f05f25435b41d7f39f7}{r}},\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structsecp256k1__scalar}{secp256k1\_scalar}}*\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}})\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00310}00310\ \ \ \ \ \textcolor{keywordflow}{if}\ (\textcolor{keyword}{sizeof}(\mbox{\hyperlink{structsecp256k1__scalar}{secp256k1\_scalar}})\ ==\ 32)\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00311}00311\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(\&sig-\/>\mbox{\hyperlink{structsecp256k1__ecdsa__signature_a80f750e6d473a8d43c77e53757893f15}{data}}[0],\ \mbox{\hyperlink{bn_8cpp_af0a5201ca8846f05f25435b41d7f39f7}{r}},\ 32);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00312}00312\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(\&sig-\/>\mbox{\hyperlink{structsecp256k1__ecdsa__signature_a80f750e6d473a8d43c77e53757893f15}{data}}[32],\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}},\ 32);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00313}00313\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00314}00314\ \ \ \ \ \ \ \ \ secp256k1\_scalar\_get\_b32(\&sig-\/>\mbox{\hyperlink{structsecp256k1__ecdsa__signature_a80f750e6d473a8d43c77e53757893f15}{data}}[0],\ \mbox{\hyperlink{bn_8cpp_af0a5201ca8846f05f25435b41d7f39f7}{r}});}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00315}00315\ \ \ \ \ \ \ \ \ secp256k1\_scalar\_get\_b32(\&sig-\/>\mbox{\hyperlink{structsecp256k1__ecdsa__signature_a80f750e6d473a8d43c77e53757893f15}{data}}[32],\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}});}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00316}00316\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00317}00317\ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00318}00318\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00319}\mbox{\hyperlink{secp256k1_8h_a57d390dd5baa54855b0cb20628034b90}{00319}}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{secp256k1_8c_a7bd08fb7f758494d5011849b6ca0ef13}{secp256k1\_ecdsa\_signature\_parse\_der}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structsecp256k1__context__struct}{secp256k1\_context}}*\ ctx,\ \mbox{\hyperlink{structsecp256k1__ecdsa__signature}{secp256k1\_ecdsa\_signature}}*\ sig,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *input,\ \textcolor{keywordtype}{size\_t}\ inputlen)\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00320}00320\ \ \ \ \ \mbox{\hyperlink{structsecp256k1__scalar}{secp256k1\_scalar}}\ \mbox{\hyperlink{bn_8cpp_af0a5201ca8846f05f25435b41d7f39f7}{r}},\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}};}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00321}00321\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00322}00322\ \ \ \ \ \mbox{\hyperlink{fc_2secp256k1_2secp256k1_2src_2util_8h_aca8ac5ae73fd966db106de59160a178b}{VERIFY\_CHECK}}(ctx\ !=\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00323}00323\ \ \ \ \ \mbox{\hyperlink{secp256k1_8c_a6e1f88c6ce07376501097b42a2b40727}{ARG\_CHECK}}(sig\ !=\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00324}00324\ \ \ \ \ \mbox{\hyperlink{secp256k1_8c_a6e1f88c6ce07376501097b42a2b40727}{ARG\_CHECK}}(input\ !=\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00325}00325\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00326}00326\ \ \ \ \ \textcolor{keywordflow}{if}\ (secp256k1\_ecdsa\_sig\_parse(\&\mbox{\hyperlink{bn_8cpp_af0a5201ca8846f05f25435b41d7f39f7}{r}},\ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}},\ input,\ inputlen))\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00327}00327\ \ \ \ \ \ \ \ \ secp256k1\_ecdsa\_signature\_save(sig,\ \&\mbox{\hyperlink{bn_8cpp_af0a5201ca8846f05f25435b41d7f39f7}{r}},\ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}});}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00328}00328\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 1;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00329}00329\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00330}00330\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_adc4bd59a60361844aa0e852efa210105}{memset}}(sig,\ 0,\ \textcolor{keyword}{sizeof}(*sig));}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00331}00331\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00332}00332\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00333}00333\ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00334}00334\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00335}\mbox{\hyperlink{secp256k1_8h_a2aff2802eca3d15ec54298e879579897}{00335}}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{secp256k1_8c_a933083356e7171e174bc958b8233f758}{secp256k1\_ecdsa\_signature\_parse\_compact}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structsecp256k1__context__struct}{secp256k1\_context}}*\ ctx,\ \mbox{\hyperlink{structsecp256k1__ecdsa__signature}{secp256k1\_ecdsa\_signature}}*\ sig,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *input64)\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00336}00336\ \ \ \ \ \mbox{\hyperlink{structsecp256k1__scalar}{secp256k1\_scalar}}\ \mbox{\hyperlink{bn_8cpp_af0a5201ca8846f05f25435b41d7f39f7}{r}},\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}};}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00337}00337\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}}\ =\ 1;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00338}00338\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a49aa97067a36875627e1380c3fb3833d}{overflow}}\ =\ 0;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00339}00339\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00340}00340\ \ \ \ \ \mbox{\hyperlink{fc_2secp256k1_2secp256k1_2src_2util_8h_aca8ac5ae73fd966db106de59160a178b}{VERIFY\_CHECK}}(ctx\ !=\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00341}00341\ \ \ \ \ \mbox{\hyperlink{secp256k1_8c_a6e1f88c6ce07376501097b42a2b40727}{ARG\_CHECK}}(sig\ !=\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00342}00342\ \ \ \ \ \mbox{\hyperlink{secp256k1_8c_a6e1f88c6ce07376501097b42a2b40727}{ARG\_CHECK}}(input64\ !=\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00343}00343\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00344}00344\ \ \ \ \ secp256k1\_scalar\_set\_b32(\&\mbox{\hyperlink{bn_8cpp_af0a5201ca8846f05f25435b41d7f39f7}{r}},\ \&input64[0],\ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a49aa97067a36875627e1380c3fb3833d}{overflow}});}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00345}00345\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}}\ \&=\ !\mbox{\hyperlink{yubihsm__pkcs11_8c_a49aa97067a36875627e1380c3fb3833d}{overflow}};}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00346}00346\ \ \ \ \ secp256k1\_scalar\_set\_b32(\&\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}},\ \&input64[32],\ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a49aa97067a36875627e1380c3fb3833d}{overflow}});}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00347}00347\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}}\ \&=\ !\mbox{\hyperlink{yubihsm__pkcs11_8c_a49aa97067a36875627e1380c3fb3833d}{overflow}};}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00348}00348\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}})\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00349}00349\ \ \ \ \ \ \ \ \ secp256k1\_ecdsa\_signature\_save(sig,\ \&\mbox{\hyperlink{bn_8cpp_af0a5201ca8846f05f25435b41d7f39f7}{r}},\ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}});}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00350}00350\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00351}00351\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_adc4bd59a60361844aa0e852efa210105}{memset}}(sig,\ 0,\ \textcolor{keyword}{sizeof}(*sig));}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00352}00352\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00353}00353\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}};}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00354}00354\ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00355}00355\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00356}\mbox{\hyperlink{secp256k1_8h_ac07809ca872ec967ab4d3b1a95eafe0b}{00356}}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{secp256k1_8c_a3f1fbd9cfe9bd6b6303bdd8f6c0687ba}{secp256k1\_ecdsa\_signature\_serialize\_der}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structsecp256k1__context__struct}{secp256k1\_context}}*\ ctx,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *output,\ \textcolor{keywordtype}{size\_t}\ *outputlen,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structsecp256k1__ecdsa__signature}{secp256k1\_ecdsa\_signature}}*\ sig)\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00357}00357\ \ \ \ \ \mbox{\hyperlink{structsecp256k1__scalar}{secp256k1\_scalar}}\ \mbox{\hyperlink{bn_8cpp_af0a5201ca8846f05f25435b41d7f39f7}{r}},\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}};}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00358}00358\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00359}00359\ \ \ \ \ \mbox{\hyperlink{fc_2secp256k1_2secp256k1_2src_2util_8h_aca8ac5ae73fd966db106de59160a178b}{VERIFY\_CHECK}}(ctx\ !=\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00360}00360\ \ \ \ \ \mbox{\hyperlink{secp256k1_8c_a6e1f88c6ce07376501097b42a2b40727}{ARG\_CHECK}}(output\ !=\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00361}00361\ \ \ \ \ \mbox{\hyperlink{secp256k1_8c_a6e1f88c6ce07376501097b42a2b40727}{ARG\_CHECK}}(outputlen\ !=\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00362}00362\ \ \ \ \ \mbox{\hyperlink{secp256k1_8c_a6e1f88c6ce07376501097b42a2b40727}{ARG\_CHECK}}(sig\ !=\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00363}00363\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00364}00364\ \ \ \ \ secp256k1\_ecdsa\_signature\_load(ctx,\ \&\mbox{\hyperlink{bn_8cpp_af0a5201ca8846f05f25435b41d7f39f7}{r}},\ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}},\ sig);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00365}00365\ \ \ \ \ \textcolor{keywordflow}{return}\ secp256k1\_ecdsa\_sig\_serialize(output,\ outputlen,\ \&\mbox{\hyperlink{bn_8cpp_af0a5201ca8846f05f25435b41d7f39f7}{r}},\ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}});}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00366}00366\ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00367}00367\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00368}\mbox{\hyperlink{secp256k1_8h_af8571ca8dcfb7f892519b337504dc700}{00368}}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{secp256k1_8c_ac369bdcc5f8d5ced129e84895bf739db}{secp256k1\_ecdsa\_signature\_serialize\_compact}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structsecp256k1__context__struct}{secp256k1\_context}}*\ ctx,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *output64,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structsecp256k1__ecdsa__signature}{secp256k1\_ecdsa\_signature}}*\ sig)\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00369}00369\ \ \ \ \ \mbox{\hyperlink{structsecp256k1__scalar}{secp256k1\_scalar}}\ \mbox{\hyperlink{bn_8cpp_af0a5201ca8846f05f25435b41d7f39f7}{r}},\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}};}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00370}00370\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00371}00371\ \ \ \ \ \mbox{\hyperlink{fc_2secp256k1_2secp256k1_2src_2util_8h_aca8ac5ae73fd966db106de59160a178b}{VERIFY\_CHECK}}(ctx\ !=\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00372}00372\ \ \ \ \ \mbox{\hyperlink{secp256k1_8c_a6e1f88c6ce07376501097b42a2b40727}{ARG\_CHECK}}(output64\ !=\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00373}00373\ \ \ \ \ \mbox{\hyperlink{secp256k1_8c_a6e1f88c6ce07376501097b42a2b40727}{ARG\_CHECK}}(sig\ !=\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00374}00374\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00375}00375\ \ \ \ \ secp256k1\_ecdsa\_signature\_load(ctx,\ \&\mbox{\hyperlink{bn_8cpp_af0a5201ca8846f05f25435b41d7f39f7}{r}},\ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}},\ sig);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00376}00376\ \ \ \ \ secp256k1\_scalar\_get\_b32(\&output64[0],\ \&\mbox{\hyperlink{bn_8cpp_af0a5201ca8846f05f25435b41d7f39f7}{r}});}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00377}00377\ \ \ \ \ secp256k1\_scalar\_get\_b32(\&output64[32],\ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}});}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00378}00378\ \ \ \ \ \textcolor{keywordflow}{return}\ 1;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00379}00379\ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00380}00380\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00381}\mbox{\hyperlink{secp256k1_8h_a93ec36a19229f08acc5ff1ca613ab3a1}{00381}}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{secp256k1_8c_a6ebd89d119f3da65e165947573ebd3ce}{secp256k1\_ecdsa\_signature\_normalize}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structsecp256k1__context__struct}{secp256k1\_context}}*\ ctx,\ \mbox{\hyperlink{structsecp256k1__ecdsa__signature}{secp256k1\_ecdsa\_signature}}\ *sigout,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structsecp256k1__ecdsa__signature}{secp256k1\_ecdsa\_signature}}\ *sigin)\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00382}00382\ \ \ \ \ \mbox{\hyperlink{structsecp256k1__scalar}{secp256k1\_scalar}}\ \mbox{\hyperlink{bn_8cpp_af0a5201ca8846f05f25435b41d7f39f7}{r}},\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}};}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00383}00383\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}}\ =\ 0;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00384}00384\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00385}00385\ \ \ \ \ \mbox{\hyperlink{fc_2secp256k1_2secp256k1_2src_2util_8h_aca8ac5ae73fd966db106de59160a178b}{VERIFY\_CHECK}}(ctx\ !=\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00386}00386\ \ \ \ \ \mbox{\hyperlink{secp256k1_8c_a6e1f88c6ce07376501097b42a2b40727}{ARG\_CHECK}}(sigin\ !=\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00387}00387\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00388}00388\ \ \ \ \ secp256k1\_ecdsa\_signature\_load(ctx,\ \&\mbox{\hyperlink{bn_8cpp_af0a5201ca8846f05f25435b41d7f39f7}{r}},\ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}},\ sigin);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00389}00389\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}}\ =\ secp256k1\_scalar\_is\_high(\&\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}});}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00390}00390\ \ \ \ \ \textcolor{keywordflow}{if}\ (sigout\ !=\ NULL)\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00391}00391\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}})\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00392}00392\ \ \ \ \ \ \ \ \ \ \ \ \ secp256k1\_scalar\_negate(\&\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}},\ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}});}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00393}00393\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00394}00394\ \ \ \ \ \ \ \ \ secp256k1\_ecdsa\_signature\_save(sigout,\ \&\mbox{\hyperlink{bn_8cpp_af0a5201ca8846f05f25435b41d7f39f7}{r}},\ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}});}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00395}00395\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00396}00396\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00397}00397\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}};}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00398}00398\ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00399}00399\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00400}\mbox{\hyperlink{secp256k1_8h_a7dd6acb7ef7100a6aebff91ecb7ede30}{00400}}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{secp256k1_8c_abd11af3da8d88984e87ec8f06fb0087a}{secp256k1\_ecdsa\_verify}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structsecp256k1__context__struct}{secp256k1\_context}}*\ ctx,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structsecp256k1__ecdsa__signature}{secp256k1\_ecdsa\_signature}}\ *sig,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *msghash32,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structsecp256k1__pubkey}{secp256k1\_pubkey}}\ *\mbox{\hyperlink{yubihsm__pkcs11_8c_a931987c85fd408a620505ee9a1aa6f58}{pubkey}})\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00401}00401\ \ \ \ \ \mbox{\hyperlink{structsecp256k1__ge}{secp256k1\_ge}}\ q;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00402}00402\ \ \ \ \ \mbox{\hyperlink{structsecp256k1__scalar}{secp256k1\_scalar}}\ \mbox{\hyperlink{bn_8cpp_af0a5201ca8846f05f25435b41d7f39f7}{r}},\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}};}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00403}00403\ \ \ \ \ \mbox{\hyperlink{structsecp256k1__scalar}{secp256k1\_scalar}}\ m;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00404}00404\ \ \ \ \ \mbox{\hyperlink{fc_2secp256k1_2secp256k1_2src_2util_8h_aca8ac5ae73fd966db106de59160a178b}{VERIFY\_CHECK}}(ctx\ !=\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00405}00405\ \ \ \ \ \mbox{\hyperlink{secp256k1_8c_a6e1f88c6ce07376501097b42a2b40727}{ARG\_CHECK}}(msghash32\ !=\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00406}00406\ \ \ \ \ \mbox{\hyperlink{secp256k1_8c_a6e1f88c6ce07376501097b42a2b40727}{ARG\_CHECK}}(sig\ !=\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00407}00407\ \ \ \ \ \mbox{\hyperlink{secp256k1_8c_a6e1f88c6ce07376501097b42a2b40727}{ARG\_CHECK}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a931987c85fd408a620505ee9a1aa6f58}{pubkey}}\ !=\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00408}00408\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00409}00409\ \ \ \ \ secp256k1\_scalar\_set\_b32(\&m,\ msghash32,\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00410}00410\ \ \ \ \ secp256k1\_ecdsa\_signature\_load(ctx,\ \&\mbox{\hyperlink{bn_8cpp_af0a5201ca8846f05f25435b41d7f39f7}{r}},\ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}},\ sig);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00411}00411\ \ \ \ \ \textcolor{keywordflow}{return}\ (!secp256k1\_scalar\_is\_high(\&\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}})\ \&\&}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00412}00412\ \ \ \ \ \ \ \ \ \ \ \ \ secp256k1\_pubkey\_load(ctx,\ \&q,\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a931987c85fd408a620505ee9a1aa6f58}{pubkey}})\ \&\&}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00413}00413\ \ \ \ \ \ \ \ \ \ \ \ \ secp256k1\_ecdsa\_sig\_verify(\&\mbox{\hyperlink{bn_8cpp_af0a5201ca8846f05f25435b41d7f39f7}{r}},\ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}},\ \&q,\ \&m));}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00414}00414\ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00415}00415\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00416}00416\ \textcolor{keyword}{static}\ \mbox{\hyperlink{secp256k1_8h_a7ddc487fd46aee88f21cabedb7268b1e}{SECP256K1\_INLINE}}\ \textcolor{keywordtype}{void}\ buffer\_append(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *\mbox{\hyperlink{yubihsm__pkcs11_8c_a855e99b645b13e7905d074d02fe0bff5}{buf}},\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ *offset,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *data,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a7360b55975153b822efc5217b7734e6a}{len}})\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00417}00417\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a855e99b645b13e7905d074d02fe0bff5}{buf}}\ +\ *offset,\ data,\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a7360b55975153b822efc5217b7734e6a}{len}});}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00418}00418\ \ \ \ \ *offset\ +=\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a7360b55975153b822efc5217b7734e6a}{len}};}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00419}00419\ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00420}00420\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00421}00421\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{int}\ nonce\_function\_rfc6979(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *nonce32,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *msg32,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *key32,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *algo16,\ \textcolor{keywordtype}{void}\ *data,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ counter)\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00422}00422\ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ keydata[112];}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00423}00423\ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ offset\ =\ 0;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00424}00424\ \ \ \ \mbox{\hyperlink{structsecp256k1__rfc6979__hmac__sha256}{secp256k1\_rfc6979\_hmac\_sha256}}\ \mbox{\hyperlink{namespace_catch_adf13e77187ae9bc5d7cd1bb29c1ba7e9}{rng}};}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00425}00425\ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00426}00426\ \ \ \ \mbox{\hyperlink{structsecp256k1__scalar}{secp256k1\_scalar}}\ msg;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00427}00427\ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ msgmod32[32];}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00428}00428\ \ \ \ secp256k1\_scalar\_set\_b32(\&msg,\ msg32,\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00429}00429\ \ \ \ secp256k1\_scalar\_get\_b32(msgmod32,\ \&msg);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00430}00430\ \ \ \ \textcolor{comment}{/*\ We\ feed\ a\ byte\ array\ to\ the\ PRNG\ as\ input,\ consisting\ of:}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00431}00431\ \textcolor{comment}{\ \ \ \ *\ -\/\ the\ private\ key\ (32\ bytes)\ and\ reduced\ message\ (32\ bytes),\ see\ RFC\ 6979\ 3.2d.}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00432}00432\ \textcolor{comment}{\ \ \ \ *\ -\/\ optionally\ 32\ extra\ bytes\ of\ data,\ see\ RFC\ 6979\ 3.6\ Additional\ Data.}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00433}00433\ \textcolor{comment}{\ \ \ \ *\ -\/\ optionally\ 16\ extra\ bytes\ with\ the\ algorithm\ name.}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00434}00434\ \textcolor{comment}{\ \ \ \ *\ Because\ the\ arguments\ have\ distinct\ fixed\ lengths\ it\ is\ not\ possible\ for}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00435}00435\ \textcolor{comment}{\ \ \ \ *\ \ different\ argument\ mixtures\ to\ emulate\ each\ other\ and\ result\ in\ the\ same}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00436}00436\ \textcolor{comment}{\ \ \ \ *\ \ nonces.}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00437}00437\ \textcolor{comment}{\ \ \ \ */}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00438}00438\ \ \ \ buffer\_append(keydata,\ \&offset,\ key32,\ 32);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00439}00439\ \ \ \ buffer\_append(keydata,\ \&offset,\ msgmod32,\ 32);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00440}00440\ \ \ \ \textcolor{keywordflow}{if}\ (data\ !=\ NULL)\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00441}00441\ \ \ \ \ \ \ \ buffer\_append(keydata,\ \&offset,\ data,\ 32);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00442}00442\ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00443}00443\ \ \ \ \textcolor{keywordflow}{if}\ (algo16\ !=\ NULL)\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00444}00444\ \ \ \ \ \ \ \ buffer\_append(keydata,\ \&offset,\ algo16,\ 16);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00445}00445\ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00446}00446\ \ \ \ secp256k1\_rfc6979\_hmac\_sha256\_initialize(\&rng,\ keydata,\ offset);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00447}00447\ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_adc4bd59a60361844aa0e852efa210105}{memset}}(keydata,\ 0,\ \textcolor{keyword}{sizeof}(keydata));}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00448}00448\ \ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0;\ i\ <=\ counter;\ i++)\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00449}00449\ \ \ \ \ \ \ \ secp256k1\_rfc6979\_hmac\_sha256\_generate(\&rng,\ nonce32,\ 32);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00450}00450\ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00451}00451\ \ \ \ secp256k1\_rfc6979\_hmac\_sha256\_finalize(\&rng);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00452}00452\ \ \ \ \textcolor{keywordflow}{return}\ 1;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00453}00453\ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00454}00454\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00455}\mbox{\hyperlink{secp256k1_8h_ac03ab067f194eb561175a6b522def2d8}{00455}}\ \textcolor{keyword}{const}\ \mbox{\hyperlink{secp256k1_8h_a539882fd91bff672712fa19a4cfaeb98}{secp256k1\_nonce\_function}}\ \mbox{\hyperlink{secp256k1_8c_a2ac052a733aac60ef5c19f1f79e3c1dd}{secp256k1\_nonce\_function\_rfc6979}}\ =\ nonce\_function\_rfc6979;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00456}\mbox{\hyperlink{secp256k1_8h_a22f44df7786a1be5ad93aadfed75b932}{00456}}\ \textcolor{keyword}{const}\ \mbox{\hyperlink{secp256k1_8h_a539882fd91bff672712fa19a4cfaeb98}{secp256k1\_nonce\_function}}\ \mbox{\hyperlink{secp256k1_8c_a28fc3fe2c4a63199be2fea7303f012a0}{secp256k1\_nonce\_function\_default}}\ =\ nonce\_function\_rfc6979;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00457}00457\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00458}00458\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{int}\ secp256k1\_ecdsa\_sign\_inner(\textcolor{keyword}{const}\ \mbox{\hyperlink{structsecp256k1__context__struct}{secp256k1\_context}}*\ ctx,\ \mbox{\hyperlink{structsecp256k1__scalar}{secp256k1\_scalar}}*\ \mbox{\hyperlink{bn_8cpp_af0a5201ca8846f05f25435b41d7f39f7}{r}},\ \mbox{\hyperlink{structsecp256k1__scalar}{secp256k1\_scalar}}*\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}},\ \textcolor{keywordtype}{int}*\ recid,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *msg32,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *seckey,\ \mbox{\hyperlink{secp256k1_8h_a539882fd91bff672712fa19a4cfaeb98}{secp256k1\_nonce\_function}}\ noncefp,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}*\ noncedata)\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00459}00459\ \ \ \ \ \mbox{\hyperlink{structsecp256k1__scalar}{secp256k1\_scalar}}\ sec,\ non,\ msg;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00460}00460\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}}\ =\ 0;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00461}00461\ \ \ \ \ \textcolor{keywordtype}{int}\ is\_sec\_valid;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00462}00462\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ nonce32[32];}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00463}00463\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{gmock__stress__test_8cc_afd9db40e3361ae09188795e8cbe19752}{count}}\ =\ 0;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00464}00464\ \ \ \ \ \textcolor{comment}{/*\ Default\ initialization\ here\ is\ important\ so\ we\ won't\ pass\ uninit\ values\ to\ the\ cmov\ in\ the\ end\ */}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00465}00465\ \ \ \ \ *\mbox{\hyperlink{bn_8cpp_af0a5201ca8846f05f25435b41d7f39f7}{r}}\ =\ secp256k1\_scalar\_zero;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00466}00466\ \ \ \ \ *\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}}\ =\ secp256k1\_scalar\_zero;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00467}00467\ \ \ \ \ \textcolor{keywordflow}{if}\ (recid)\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00468}00468\ \ \ \ \ \ \ \ \ *recid\ =\ 0;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00469}00469\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00470}00470\ \ \ \ \ \textcolor{keywordflow}{if}\ (noncefp\ ==\ NULL)\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00471}00471\ \ \ \ \ \ \ \ \ noncefp\ =\ \mbox{\hyperlink{secp256k1_8c_a28fc3fe2c4a63199be2fea7303f012a0}{secp256k1\_nonce\_function\_default}};}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00472}00472\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00473}00473\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00474}00474\ \ \ \ \ \textcolor{comment}{/*\ Fail\ if\ the\ secret\ key\ is\ invalid.\ */}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00475}00475\ \ \ \ \ is\_sec\_valid\ =\ secp256k1\_scalar\_set\_b32\_seckey(\&sec,\ seckey);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00476}00476\ \ \ \ \ secp256k1\_scalar\_cmov(\&sec,\ \&secp256k1\_scalar\_one,\ !is\_sec\_valid);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00477}00477\ \ \ \ \ secp256k1\_scalar\_set\_b32(\&msg,\ msg32,\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00478}00478\ \ \ \ \ \textcolor{keywordflow}{while}\ (1)\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00479}00479\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ is\_nonce\_valid;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00480}00480\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}}\ =\ !!noncefp(nonce32,\ msg32,\ seckey,\ NULL,\ (\textcolor{keywordtype}{void}*)noncedata,\ \mbox{\hyperlink{gmock__stress__test_8cc_afd9db40e3361ae09188795e8cbe19752}{count}});}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00481}00481\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}})\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00482}00482\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00483}00483\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00484}00484\ \ \ \ \ \ \ \ \ is\_nonce\_valid\ =\ secp256k1\_scalar\_set\_b32\_seckey(\&non,\ nonce32);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00485}00485\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ The\ nonce\ is\ still\ secret\ here,\ but\ it\ being\ invalid\ is\ is\ less\ likely\ than\ 1:2\string^255.\ */}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00486}00486\ \ \ \ \ \ \ \ \ secp256k1\_declassify(ctx,\ \&is\_nonce\_valid,\ \textcolor{keyword}{sizeof}(is\_nonce\_valid));}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00487}00487\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (is\_nonce\_valid)\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00488}00488\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}}\ =\ secp256k1\_ecdsa\_sig\_sign(\&ctx-\/>\mbox{\hyperlink{structsecp256k1__context__struct_aacc2071a68f9c5a6c05eb783f523b9eb}{ecmult\_gen\_ctx}},\ \mbox{\hyperlink{bn_8cpp_af0a5201ca8846f05f25435b41d7f39f7}{r}},\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}},\ \&sec,\ \&msg,\ \&non,\ recid);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00489}00489\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ The\ final\ signature\ is\ no\ longer\ a\ secret,\ nor\ is\ the\ fact\ that\ we\ were\ successful\ or\ not.\ */}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00490}00490\ \ \ \ \ \ \ \ \ \ \ \ \ secp256k1\_declassify(ctx,\ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}},\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}}));}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00491}00491\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}})\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00492}00492\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00493}00493\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00494}00494\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00495}00495\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{gmock__stress__test_8cc_afd9db40e3361ae09188795e8cbe19752}{count}}++;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00496}00496\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00497}00497\ \ \ \ \ \textcolor{comment}{/*\ We\ don't\ want\ to\ declassify\ is\_sec\_valid\ and\ therefore\ the\ range\ of}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00498}00498\ \textcolor{comment}{\ \ \ \ \ *\ seckey.\ As\ a\ result\ is\_sec\_valid\ is\ included\ in\ ret\ only\ after\ ret\ was}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00499}00499\ \textcolor{comment}{\ \ \ \ \ *\ used\ as\ a\ branching\ variable.\ */}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00500}00500\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}}\ \&=\ is\_sec\_valid;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00501}00501\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_adc4bd59a60361844aa0e852efa210105}{memset}}(nonce32,\ 0,\ 32);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00502}00502\ \ \ \ \ secp256k1\_scalar\_clear(\&msg);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00503}00503\ \ \ \ \ secp256k1\_scalar\_clear(\&non);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00504}00504\ \ \ \ \ secp256k1\_scalar\_clear(\&sec);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00505}00505\ \ \ \ \ secp256k1\_scalar\_cmov(\mbox{\hyperlink{bn_8cpp_af0a5201ca8846f05f25435b41d7f39f7}{r}},\ \&secp256k1\_scalar\_zero,\ !\mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}});}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00506}00506\ \ \ \ \ secp256k1\_scalar\_cmov(\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}},\ \&secp256k1\_scalar\_zero,\ !\mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}});}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00507}00507\ \ \ \ \ \textcolor{keywordflow}{if}\ (recid)\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00508}00508\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ zero\ =\ 0;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00509}00509\ \ \ \ \ \ \ \ \ secp256k1\_int\_cmov(recid,\ \&zero,\ !\mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}});}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00510}00510\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00511}00511\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}};}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00512}00512\ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00513}00513\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00514}\mbox{\hyperlink{secp256k1_8h_a4185cc9a9de502e52cfe5350f7dc8438}{00514}}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{secp256k1_8c_af5ff5bb2cad5c58e90c653092648c63a}{secp256k1\_ecdsa\_sign}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structsecp256k1__context__struct}{secp256k1\_context}}*\ ctx,\ \mbox{\hyperlink{structsecp256k1__ecdsa__signature}{secp256k1\_ecdsa\_signature}}\ *signature,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *msghash32,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *seckey,\ \mbox{\hyperlink{secp256k1_8h_a539882fd91bff672712fa19a4cfaeb98}{secp256k1\_nonce\_function}}\ noncefp,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}*\ noncedata)\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00515}00515\ \ \ \ \ \mbox{\hyperlink{structsecp256k1__scalar}{secp256k1\_scalar}}\ \mbox{\hyperlink{bn_8cpp_af0a5201ca8846f05f25435b41d7f39f7}{r}},\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}};}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00516}00516\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}};}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00517}00517\ \ \ \ \ \mbox{\hyperlink{fc_2secp256k1_2secp256k1_2src_2util_8h_aca8ac5ae73fd966db106de59160a178b}{VERIFY\_CHECK}}(ctx\ !=\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00518}00518\ \ \ \ \ \mbox{\hyperlink{secp256k1_8c_a6e1f88c6ce07376501097b42a2b40727}{ARG\_CHECK}}(secp256k1\_ecmult\_gen\_context\_is\_built(\&ctx-\/>\mbox{\hyperlink{structsecp256k1__context__struct_aacc2071a68f9c5a6c05eb783f523b9eb}{ecmult\_gen\_ctx}}));}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00519}00519\ \ \ \ \ \mbox{\hyperlink{secp256k1_8c_a6e1f88c6ce07376501097b42a2b40727}{ARG\_CHECK}}(msghash32\ !=\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00520}00520\ \ \ \ \ \mbox{\hyperlink{secp256k1_8c_a6e1f88c6ce07376501097b42a2b40727}{ARG\_CHECK}}(signature\ !=\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00521}00521\ \ \ \ \ \mbox{\hyperlink{secp256k1_8c_a6e1f88c6ce07376501097b42a2b40727}{ARG\_CHECK}}(seckey\ !=\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00522}00522\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00523}00523\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}}\ =\ secp256k1\_ecdsa\_sign\_inner(ctx,\ \&\mbox{\hyperlink{bn_8cpp_af0a5201ca8846f05f25435b41d7f39f7}{r}},\ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}},\ NULL,\ msghash32,\ seckey,\ noncefp,\ noncedata);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00524}00524\ \ \ \ \ secp256k1\_ecdsa\_signature\_save(signature,\ \&\mbox{\hyperlink{bn_8cpp_af0a5201ca8846f05f25435b41d7f39f7}{r}},\ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}});}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00525}00525\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}};}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00526}00526\ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00527}00527\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00528}\mbox{\hyperlink{secp256k1_8h_a366f922fc0c787351e82ff8e3a95f652}{00528}}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{secp256k1_8c_a6015346bdaee22c65e5ebca71693d9b1}{secp256k1\_ec\_seckey\_verify}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structsecp256k1__context__struct}{secp256k1\_context}}*\ ctx,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *seckey)\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00529}00529\ \ \ \ \ \mbox{\hyperlink{structsecp256k1__scalar}{secp256k1\_scalar}}\ sec;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00530}00530\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}};}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00531}00531\ \ \ \ \ \mbox{\hyperlink{fc_2secp256k1_2secp256k1_2src_2util_8h_aca8ac5ae73fd966db106de59160a178b}{VERIFY\_CHECK}}(ctx\ !=\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00532}00532\ \ \ \ \ \mbox{\hyperlink{secp256k1_8c_a6e1f88c6ce07376501097b42a2b40727}{ARG\_CHECK}}(seckey\ !=\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00533}00533\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00534}00534\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}}\ =\ secp256k1\_scalar\_set\_b32\_seckey(\&sec,\ seckey);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00535}00535\ \ \ \ \ secp256k1\_scalar\_clear(\&sec);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00536}00536\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}};}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00537}00537\ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00538}00538\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00539}00539\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{int}\ secp256k1\_ec\_pubkey\_create\_helper(\textcolor{keyword}{const}\ \mbox{\hyperlink{structsecp256k1__ecmult__gen__context}{secp256k1\_ecmult\_gen\_context}}\ *ecmult\_gen\_ctx,\ \mbox{\hyperlink{structsecp256k1__scalar}{secp256k1\_scalar}}\ *seckey\_scalar,\ \mbox{\hyperlink{structsecp256k1__ge}{secp256k1\_ge}}\ *\mbox{\hyperlink{bn_8cpp_a8b0eadcc506862e9d751ab45185053aa}{p}},\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *seckey)\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00540}00540\ \ \ \ \ \mbox{\hyperlink{structsecp256k1__gej}{secp256k1\_gej}}\ pj;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00541}00541\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}};}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00542}00542\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00543}00543\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}}\ =\ secp256k1\_scalar\_set\_b32\_seckey(seckey\_scalar,\ seckey);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00544}00544\ \ \ \ \ secp256k1\_scalar\_cmov(seckey\_scalar,\ \&secp256k1\_scalar\_one,\ !\mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}});}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00545}00545\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00546}00546\ \ \ \ \ secp256k1\_ecmult\_gen(ecmult\_gen\_ctx,\ \&pj,\ seckey\_scalar);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00547}00547\ \ \ \ \ secp256k1\_ge\_set\_gej(\mbox{\hyperlink{bn_8cpp_a8b0eadcc506862e9d751ab45185053aa}{p}},\ \&pj);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00548}00548\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}};}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00549}00549\ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00550}00550\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00551}\mbox{\hyperlink{secp256k1_8h_a7438071aa8a6dc4697abe4f4659f2161}{00551}}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{secp256k1_8c_ac5806cffd3278e64f863027eaa8e1284}{secp256k1\_ec\_pubkey\_create}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structsecp256k1__context__struct}{secp256k1\_context}}*\ ctx,\ \mbox{\hyperlink{structsecp256k1__pubkey}{secp256k1\_pubkey}}\ *\mbox{\hyperlink{yubihsm__pkcs11_8c_a931987c85fd408a620505ee9a1aa6f58}{pubkey}},\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *seckey)\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00552}00552\ \ \ \ \ \mbox{\hyperlink{structsecp256k1__ge}{secp256k1\_ge}}\ \mbox{\hyperlink{bn_8cpp_a8b0eadcc506862e9d751ab45185053aa}{p}};}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00553}00553\ \ \ \ \ \mbox{\hyperlink{structsecp256k1__scalar}{secp256k1\_scalar}}\ seckey\_scalar;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00554}00554\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}}\ =\ 0;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00555}00555\ \ \ \ \ \mbox{\hyperlink{fc_2secp256k1_2secp256k1_2src_2util_8h_aca8ac5ae73fd966db106de59160a178b}{VERIFY\_CHECK}}(ctx\ !=\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00556}00556\ \ \ \ \ \mbox{\hyperlink{secp256k1_8c_a6e1f88c6ce07376501097b42a2b40727}{ARG\_CHECK}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a931987c85fd408a620505ee9a1aa6f58}{pubkey}}\ !=\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00557}00557\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_adc4bd59a60361844aa0e852efa210105}{memset}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a931987c85fd408a620505ee9a1aa6f58}{pubkey}},\ 0,\ \textcolor{keyword}{sizeof}(*\mbox{\hyperlink{yubihsm__pkcs11_8c_a931987c85fd408a620505ee9a1aa6f58}{pubkey}}));}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00558}00558\ \ \ \ \ \mbox{\hyperlink{secp256k1_8c_a6e1f88c6ce07376501097b42a2b40727}{ARG\_CHECK}}(secp256k1\_ecmult\_gen\_context\_is\_built(\&ctx-\/>\mbox{\hyperlink{structsecp256k1__context__struct_aacc2071a68f9c5a6c05eb783f523b9eb}{ecmult\_gen\_ctx}}));}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00559}00559\ \ \ \ \ \mbox{\hyperlink{secp256k1_8c_a6e1f88c6ce07376501097b42a2b40727}{ARG\_CHECK}}(seckey\ !=\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00560}00560\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00561}00561\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}}\ =\ secp256k1\_ec\_pubkey\_create\_helper(\&ctx-\/>\mbox{\hyperlink{structsecp256k1__context__struct_aacc2071a68f9c5a6c05eb783f523b9eb}{ecmult\_gen\_ctx}},\ \&seckey\_scalar,\ \&\mbox{\hyperlink{bn_8cpp_a8b0eadcc506862e9d751ab45185053aa}{p}},\ seckey);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00562}00562\ \ \ \ \ secp256k1\_pubkey\_save(\mbox{\hyperlink{yubihsm__pkcs11_8c_a931987c85fd408a620505ee9a1aa6f58}{pubkey}},\ \&\mbox{\hyperlink{bn_8cpp_a8b0eadcc506862e9d751ab45185053aa}{p}});}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00563}00563\ \ \ \ \ secp256k1\_memczero(\mbox{\hyperlink{yubihsm__pkcs11_8c_a931987c85fd408a620505ee9a1aa6f58}{pubkey}},\ \textcolor{keyword}{sizeof}(*\mbox{\hyperlink{yubihsm__pkcs11_8c_a931987c85fd408a620505ee9a1aa6f58}{pubkey}}),\ !\mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}});}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00564}00564\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00565}00565\ \ \ \ \ secp256k1\_scalar\_clear(\&seckey\_scalar);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00566}00566\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}};}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00567}00567\ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00568}00568\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00569}\mbox{\hyperlink{secp256k1_8h_a1eb33149d14095c8480319441b2477a8}{00569}}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{secp256k1_8c_a877d2d85643148d932a95868f5660e26}{secp256k1\_ec\_seckey\_negate}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structsecp256k1__context__struct}{secp256k1\_context}}*\ ctx,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *seckey)\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00570}00570\ \ \ \ \ \mbox{\hyperlink{structsecp256k1__scalar}{secp256k1\_scalar}}\ sec;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00571}00571\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}}\ =\ 0;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00572}00572\ \ \ \ \ \mbox{\hyperlink{fc_2secp256k1_2secp256k1_2src_2util_8h_aca8ac5ae73fd966db106de59160a178b}{VERIFY\_CHECK}}(ctx\ !=\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00573}00573\ \ \ \ \ \mbox{\hyperlink{secp256k1_8c_a6e1f88c6ce07376501097b42a2b40727}{ARG\_CHECK}}(seckey\ !=\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00574}00574\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00575}00575\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}}\ =\ secp256k1\_scalar\_set\_b32\_seckey(\&sec,\ seckey);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00576}00576\ \ \ \ \ secp256k1\_scalar\_cmov(\&sec,\ \&secp256k1\_scalar\_zero,\ !\mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}});}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00577}00577\ \ \ \ \ secp256k1\_scalar\_negate(\&sec,\ \&sec);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00578}00578\ \ \ \ \ secp256k1\_scalar\_get\_b32(seckey,\ \&sec);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00579}00579\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00580}00580\ \ \ \ \ secp256k1\_scalar\_clear(\&sec);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00581}00581\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}};}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00582}00582\ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00583}00583\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00584}\mbox{\hyperlink{secp256k1_8h_adf92ed0e5dfd46c1aaca6764104285d2}{00584}}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{secp256k1_8c_a1f302f1c75085b4070f04e5a347ef9e6}{secp256k1\_ec\_privkey\_negate}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structsecp256k1__context__struct}{secp256k1\_context}}*\ ctx,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *seckey)\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00585}00585\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{secp256k1_8c_a877d2d85643148d932a95868f5660e26}{secp256k1\_ec\_seckey\_negate}}(ctx,\ seckey);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00586}00586\ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00587}00587\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00588}\mbox{\hyperlink{secp256k1_8h_ac4720d4ffc9919429787f1a806dae288}{00588}}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{secp256k1_8c_afb380139bce6f6722e35add4c375debb}{secp256k1\_ec\_pubkey\_negate}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structsecp256k1__context__struct}{secp256k1\_context}}*\ ctx,\ \mbox{\hyperlink{structsecp256k1__pubkey}{secp256k1\_pubkey}}\ *\mbox{\hyperlink{yubihsm__pkcs11_8c_a931987c85fd408a620505ee9a1aa6f58}{pubkey}})\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00589}00589\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}}\ =\ 0;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00590}00590\ \ \ \ \ \mbox{\hyperlink{structsecp256k1__ge}{secp256k1\_ge}}\ \mbox{\hyperlink{bn_8cpp_a8b0eadcc506862e9d751ab45185053aa}{p}};}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00591}00591\ \ \ \ \ \mbox{\hyperlink{fc_2secp256k1_2secp256k1_2src_2util_8h_aca8ac5ae73fd966db106de59160a178b}{VERIFY\_CHECK}}(ctx\ !=\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00592}00592\ \ \ \ \ \mbox{\hyperlink{secp256k1_8c_a6e1f88c6ce07376501097b42a2b40727}{ARG\_CHECK}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a931987c85fd408a620505ee9a1aa6f58}{pubkey}}\ !=\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00593}00593\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00594}00594\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}}\ =\ secp256k1\_pubkey\_load(ctx,\ \&\mbox{\hyperlink{bn_8cpp_a8b0eadcc506862e9d751ab45185053aa}{p}},\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a931987c85fd408a620505ee9a1aa6f58}{pubkey}});}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00595}00595\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_adc4bd59a60361844aa0e852efa210105}{memset}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a931987c85fd408a620505ee9a1aa6f58}{pubkey}},\ 0,\ \textcolor{keyword}{sizeof}(*\mbox{\hyperlink{yubihsm__pkcs11_8c_a931987c85fd408a620505ee9a1aa6f58}{pubkey}}));}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00596}00596\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}})\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00597}00597\ \ \ \ \ \ \ \ \ secp256k1\_ge\_neg(\&\mbox{\hyperlink{bn_8cpp_a8b0eadcc506862e9d751ab45185053aa}{p}},\ \&\mbox{\hyperlink{bn_8cpp_a8b0eadcc506862e9d751ab45185053aa}{p}});}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00598}00598\ \ \ \ \ \ \ \ \ secp256k1\_pubkey\_save(\mbox{\hyperlink{yubihsm__pkcs11_8c_a931987c85fd408a620505ee9a1aa6f58}{pubkey}},\ \&\mbox{\hyperlink{bn_8cpp_a8b0eadcc506862e9d751ab45185053aa}{p}});}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00599}00599\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00600}00600\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}};}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00601}00601\ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00602}00602\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00603}00603\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00604}00604\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{int}\ secp256k1\_ec\_seckey\_tweak\_add\_helper(\mbox{\hyperlink{structsecp256k1__scalar}{secp256k1\_scalar}}\ *sec,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *tweak32)\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00605}00605\ \ \ \ \ \mbox{\hyperlink{structsecp256k1__scalar}{secp256k1\_scalar}}\ term;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00606}00606\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a49aa97067a36875627e1380c3fb3833d}{overflow}}\ =\ 0;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00607}00607\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}}\ =\ 0;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00608}00608\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00609}00609\ \ \ \ \ secp256k1\_scalar\_set\_b32(\&term,\ tweak32,\ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a49aa97067a36875627e1380c3fb3833d}{overflow}});}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00610}00610\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}}\ =\ (!\mbox{\hyperlink{yubihsm__pkcs11_8c_a49aa97067a36875627e1380c3fb3833d}{overflow}})\ \&\ secp256k1\_eckey\_privkey\_tweak\_add(sec,\ \&term);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00611}00611\ \ \ \ \ secp256k1\_scalar\_clear(\&term);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00612}00612\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}};}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00613}00613\ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00614}00614\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00615}\mbox{\hyperlink{secp256k1_8h_af190f597732ce69f0829c40cda6854b8}{00615}}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{secp256k1_8c_a615cecca9de98d5f67333c76564ed6bf}{secp256k1\_ec\_seckey\_tweak\_add}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structsecp256k1__context__struct}{secp256k1\_context}}*\ ctx,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *seckey,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *tweak32)\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00616}00616\ \ \ \ \ \mbox{\hyperlink{structsecp256k1__scalar}{secp256k1\_scalar}}\ sec;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00617}00617\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}}\ =\ 0;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00618}00618\ \ \ \ \ \mbox{\hyperlink{fc_2secp256k1_2secp256k1_2src_2util_8h_aca8ac5ae73fd966db106de59160a178b}{VERIFY\_CHECK}}(ctx\ !=\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00619}00619\ \ \ \ \ \mbox{\hyperlink{secp256k1_8c_a6e1f88c6ce07376501097b42a2b40727}{ARG\_CHECK}}(seckey\ !=\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00620}00620\ \ \ \ \ \mbox{\hyperlink{secp256k1_8c_a6e1f88c6ce07376501097b42a2b40727}{ARG\_CHECK}}(tweak32\ !=\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00621}00621\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00622}00622\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}}\ =\ secp256k1\_scalar\_set\_b32\_seckey(\&sec,\ seckey);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00623}00623\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}}\ \&=\ secp256k1\_ec\_seckey\_tweak\_add\_helper(\&sec,\ tweak32);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00624}00624\ \ \ \ \ secp256k1\_scalar\_cmov(\&sec,\ \&secp256k1\_scalar\_zero,\ !\mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}});}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00625}00625\ \ \ \ \ secp256k1\_scalar\_get\_b32(seckey,\ \&sec);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00626}00626\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00627}00627\ \ \ \ \ secp256k1\_scalar\_clear(\&sec);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00628}00628\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}};}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00629}00629\ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00630}00630\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00631}\mbox{\hyperlink{secp256k1_8h_ad52f8c2da1a1a49e6206412b600d688a}{00631}}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{secp256k1_8c_a0c0adfadb899c6a150f0351d57b7a55f}{secp256k1\_ec\_privkey\_tweak\_add}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structsecp256k1__context__struct}{secp256k1\_context}}*\ ctx,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *seckey,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *tweak32)\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00632}00632\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{secp256k1_8c_a615cecca9de98d5f67333c76564ed6bf}{secp256k1\_ec\_seckey\_tweak\_add}}(ctx,\ seckey,\ tweak32);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00633}00633\ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00634}00634\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00635}00635\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{int}\ secp256k1\_ec\_pubkey\_tweak\_add\_helper(\mbox{\hyperlink{structsecp256k1__ge}{secp256k1\_ge}}\ *\mbox{\hyperlink{bn_8cpp_a8b0eadcc506862e9d751ab45185053aa}{p}},\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *tweak32)\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00636}00636\ \ \ \ \ \mbox{\hyperlink{structsecp256k1__scalar}{secp256k1\_scalar}}\ term;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00637}00637\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a49aa97067a36875627e1380c3fb3833d}{overflow}}\ =\ 0;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00638}00638\ \ \ \ \ secp256k1\_scalar\_set\_b32(\&term,\ tweak32,\ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a49aa97067a36875627e1380c3fb3833d}{overflow}});}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00639}00639\ \ \ \ \ \textcolor{keywordflow}{return}\ !\mbox{\hyperlink{yubihsm__pkcs11_8c_a49aa97067a36875627e1380c3fb3833d}{overflow}}\ \&\&\ secp256k1\_eckey\_pubkey\_tweak\_add(\mbox{\hyperlink{bn_8cpp_a8b0eadcc506862e9d751ab45185053aa}{p}},\ \&term);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00640}00640\ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00641}00641\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00642}\mbox{\hyperlink{secp256k1_8h_aaac0a0211f7ebfa1af55ab571cd57751}{00642}}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{secp256k1_8c_a37cae594daf23e05431eda1b20610f73}{secp256k1\_ec\_pubkey\_tweak\_add}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structsecp256k1__context__struct}{secp256k1\_context}}*\ ctx,\ \mbox{\hyperlink{structsecp256k1__pubkey}{secp256k1\_pubkey}}\ *\mbox{\hyperlink{yubihsm__pkcs11_8c_a931987c85fd408a620505ee9a1aa6f58}{pubkey}},\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *tweak32)\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00643}00643\ \ \ \ \ \mbox{\hyperlink{structsecp256k1__ge}{secp256k1\_ge}}\ \mbox{\hyperlink{bn_8cpp_a8b0eadcc506862e9d751ab45185053aa}{p}};}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00644}00644\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}}\ =\ 0;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00645}00645\ \ \ \ \ \mbox{\hyperlink{fc_2secp256k1_2secp256k1_2src_2util_8h_aca8ac5ae73fd966db106de59160a178b}{VERIFY\_CHECK}}(ctx\ !=\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00646}00646\ \ \ \ \ \mbox{\hyperlink{secp256k1_8c_a6e1f88c6ce07376501097b42a2b40727}{ARG\_CHECK}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a931987c85fd408a620505ee9a1aa6f58}{pubkey}}\ !=\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00647}00647\ \ \ \ \ \mbox{\hyperlink{secp256k1_8c_a6e1f88c6ce07376501097b42a2b40727}{ARG\_CHECK}}(tweak32\ !=\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00648}00648\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00649}00649\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}}\ =\ secp256k1\_pubkey\_load(ctx,\ \&\mbox{\hyperlink{bn_8cpp_a8b0eadcc506862e9d751ab45185053aa}{p}},\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a931987c85fd408a620505ee9a1aa6f58}{pubkey}});}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00650}00650\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_adc4bd59a60361844aa0e852efa210105}{memset}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a931987c85fd408a620505ee9a1aa6f58}{pubkey}},\ 0,\ \textcolor{keyword}{sizeof}(*\mbox{\hyperlink{yubihsm__pkcs11_8c_a931987c85fd408a620505ee9a1aa6f58}{pubkey}}));}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00651}00651\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}}\ =\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}}\ \&\&\ secp256k1\_ec\_pubkey\_tweak\_add\_helper(\&\mbox{\hyperlink{bn_8cpp_a8b0eadcc506862e9d751ab45185053aa}{p}},\ tweak32);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00652}00652\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}})\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00653}00653\ \ \ \ \ \ \ \ \ secp256k1\_pubkey\_save(\mbox{\hyperlink{yubihsm__pkcs11_8c_a931987c85fd408a620505ee9a1aa6f58}{pubkey}},\ \&\mbox{\hyperlink{bn_8cpp_a8b0eadcc506862e9d751ab45185053aa}{p}});}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00654}00654\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00655}00655\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00656}00656\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}};}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00657}00657\ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00658}00658\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00659}\mbox{\hyperlink{secp256k1_8h_a034600fa5f0174c0d11a991a842e4edc}{00659}}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{secp256k1_8c_a42895c7fad28c83d4373a40ba49323f1}{secp256k1\_ec\_seckey\_tweak\_mul}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structsecp256k1__context__struct}{secp256k1\_context}}*\ ctx,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *seckey,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *tweak32)\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00660}00660\ \ \ \ \ \mbox{\hyperlink{structsecp256k1__scalar}{secp256k1\_scalar}}\ factor;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00661}00661\ \ \ \ \ \mbox{\hyperlink{structsecp256k1__scalar}{secp256k1\_scalar}}\ sec;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00662}00662\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}}\ =\ 0;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00663}00663\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a49aa97067a36875627e1380c3fb3833d}{overflow}}\ =\ 0;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00664}00664\ \ \ \ \ \mbox{\hyperlink{fc_2secp256k1_2secp256k1_2src_2util_8h_aca8ac5ae73fd966db106de59160a178b}{VERIFY\_CHECK}}(ctx\ !=\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00665}00665\ \ \ \ \ \mbox{\hyperlink{secp256k1_8c_a6e1f88c6ce07376501097b42a2b40727}{ARG\_CHECK}}(seckey\ !=\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00666}00666\ \ \ \ \ \mbox{\hyperlink{secp256k1_8c_a6e1f88c6ce07376501097b42a2b40727}{ARG\_CHECK}}(tweak32\ !=\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00667}00667\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00668}00668\ \ \ \ \ secp256k1\_scalar\_set\_b32(\&factor,\ tweak32,\ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a49aa97067a36875627e1380c3fb3833d}{overflow}});}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00669}00669\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}}\ =\ secp256k1\_scalar\_set\_b32\_seckey(\&sec,\ seckey);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00670}00670\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}}\ \&=\ (!\mbox{\hyperlink{yubihsm__pkcs11_8c_a49aa97067a36875627e1380c3fb3833d}{overflow}})\ \&\ secp256k1\_eckey\_privkey\_tweak\_mul(\&sec,\ \&factor);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00671}00671\ \ \ \ \ secp256k1\_scalar\_cmov(\&sec,\ \&secp256k1\_scalar\_zero,\ !\mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}});}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00672}00672\ \ \ \ \ secp256k1\_scalar\_get\_b32(seckey,\ \&sec);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00673}00673\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00674}00674\ \ \ \ \ secp256k1\_scalar\_clear(\&sec);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00675}00675\ \ \ \ \ secp256k1\_scalar\_clear(\&factor);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00676}00676\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}};}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00677}00677\ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00678}00678\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00679}\mbox{\hyperlink{secp256k1_8h_af9fe9e1f43fb71ff12e4119235e19e27}{00679}}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{secp256k1_8c_afc4a7b9d8e9fca8c8b12b3706329f6b2}{secp256k1\_ec\_privkey\_tweak\_mul}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structsecp256k1__context__struct}{secp256k1\_context}}*\ ctx,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *seckey,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *tweak32)\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00680}00680\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{secp256k1_8c_a42895c7fad28c83d4373a40ba49323f1}{secp256k1\_ec\_seckey\_tweak\_mul}}(ctx,\ seckey,\ tweak32);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00681}00681\ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00682}00682\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00683}\mbox{\hyperlink{secp256k1_8h_af64066f6c9fdb64070569f37a6cc025d}{00683}}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{secp256k1_8c_aef753193bf672b7c5e6156daa962bf55}{secp256k1\_ec\_pubkey\_tweak\_mul}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structsecp256k1__context__struct}{secp256k1\_context}}*\ ctx,\ \mbox{\hyperlink{structsecp256k1__pubkey}{secp256k1\_pubkey}}\ *\mbox{\hyperlink{yubihsm__pkcs11_8c_a931987c85fd408a620505ee9a1aa6f58}{pubkey}},\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *tweak32)\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00684}00684\ \ \ \ \ \mbox{\hyperlink{structsecp256k1__ge}{secp256k1\_ge}}\ \mbox{\hyperlink{bn_8cpp_a8b0eadcc506862e9d751ab45185053aa}{p}};}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00685}00685\ \ \ \ \ \mbox{\hyperlink{structsecp256k1__scalar}{secp256k1\_scalar}}\ factor;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00686}00686\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}}\ =\ 0;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00687}00687\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a49aa97067a36875627e1380c3fb3833d}{overflow}}\ =\ 0;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00688}00688\ \ \ \ \ \mbox{\hyperlink{fc_2secp256k1_2secp256k1_2src_2util_8h_aca8ac5ae73fd966db106de59160a178b}{VERIFY\_CHECK}}(ctx\ !=\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00689}00689\ \ \ \ \ \mbox{\hyperlink{secp256k1_8c_a6e1f88c6ce07376501097b42a2b40727}{ARG\_CHECK}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a931987c85fd408a620505ee9a1aa6f58}{pubkey}}\ !=\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00690}00690\ \ \ \ \ \mbox{\hyperlink{secp256k1_8c_a6e1f88c6ce07376501097b42a2b40727}{ARG\_CHECK}}(tweak32\ !=\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00691}00691\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00692}00692\ \ \ \ \ secp256k1\_scalar\_set\_b32(\&factor,\ tweak32,\ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a49aa97067a36875627e1380c3fb3833d}{overflow}});}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00693}00693\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}}\ =\ !\mbox{\hyperlink{yubihsm__pkcs11_8c_a49aa97067a36875627e1380c3fb3833d}{overflow}}\ \&\&\ secp256k1\_pubkey\_load(ctx,\ \&\mbox{\hyperlink{bn_8cpp_a8b0eadcc506862e9d751ab45185053aa}{p}},\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a931987c85fd408a620505ee9a1aa6f58}{pubkey}});}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00694}00694\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_adc4bd59a60361844aa0e852efa210105}{memset}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a931987c85fd408a620505ee9a1aa6f58}{pubkey}},\ 0,\ \textcolor{keyword}{sizeof}(*\mbox{\hyperlink{yubihsm__pkcs11_8c_a931987c85fd408a620505ee9a1aa6f58}{pubkey}}));}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00695}00695\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}})\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00696}00696\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (secp256k1\_eckey\_pubkey\_tweak\_mul(\&\mbox{\hyperlink{bn_8cpp_a8b0eadcc506862e9d751ab45185053aa}{p}},\ \&factor))\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00697}00697\ \ \ \ \ \ \ \ \ \ \ \ \ secp256k1\_pubkey\_save(\mbox{\hyperlink{yubihsm__pkcs11_8c_a931987c85fd408a620505ee9a1aa6f58}{pubkey}},\ \&\mbox{\hyperlink{bn_8cpp_a8b0eadcc506862e9d751ab45185053aa}{p}});}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00698}00698\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00699}00699\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}}\ =\ 0;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00700}00700\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00701}00701\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00702}00702\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00703}00703\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}};}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00704}00704\ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00705}00705\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00706}\mbox{\hyperlink{secp256k1_8h_a1b81d70feb6ed24dc902cbbd5ba569e7}{00706}}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{secp256k1_8c_aba25f5f986a05a1cd06f5452b26ff868}{secp256k1\_context\_randomize}}(\mbox{\hyperlink{structsecp256k1__context__struct}{secp256k1\_context}}*\ ctx,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *seed32)\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00707}00707\ \ \ \ \ \mbox{\hyperlink{fc_2secp256k1_2secp256k1_2src_2util_8h_aca8ac5ae73fd966db106de59160a178b}{VERIFY\_CHECK}}(ctx\ !=\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00708}00708\ \ \ \ \ \textcolor{keywordflow}{if}\ (secp256k1\_ecmult\_gen\_context\_is\_built(\&ctx-\/>\mbox{\hyperlink{structsecp256k1__context__struct_aacc2071a68f9c5a6c05eb783f523b9eb}{ecmult\_gen\_ctx}}))\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00709}00709\ \ \ \ \ \ \ \ \ secp256k1\_ecmult\_gen\_blind(\&ctx-\/>\mbox{\hyperlink{structsecp256k1__context__struct_aacc2071a68f9c5a6c05eb783f523b9eb}{ecmult\_gen\_ctx}},\ seed32);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00710}00710\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00711}00711\ \ \ \ \ \textcolor{keywordflow}{return}\ 1;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00712}00712\ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00713}00713\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00714}\mbox{\hyperlink{secp256k1_8h_a1cb5a7cf0d89b1f8eb9e7881a9cdd6eb}{00714}}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{secp256k1_8c_a92498665c38198fc1943e463c017c140}{secp256k1\_ec\_pubkey\_combine}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structsecp256k1__context__struct}{secp256k1\_context}}*\ ctx,\ \mbox{\hyperlink{structsecp256k1__pubkey}{secp256k1\_pubkey}}\ *pubnonce,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structsecp256k1__pubkey}{secp256k1\_pubkey}}\ *\ \textcolor{keyword}{const}\ *pubnonces,\ \textcolor{keywordtype}{size\_t}\ n)\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00715}00715\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ i;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00716}00716\ \ \ \ \ \mbox{\hyperlink{structsecp256k1__gej}{secp256k1\_gej}}\ Qj;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00717}00717\ \ \ \ \ \mbox{\hyperlink{structsecp256k1__ge}{secp256k1\_ge}}\ Q;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00718}00718\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00719}00719\ \ \ \ \ \mbox{\hyperlink{fc_2secp256k1_2secp256k1_2src_2util_8h_aca8ac5ae73fd966db106de59160a178b}{VERIFY\_CHECK}}(ctx\ !=\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00720}00720\ \ \ \ \ \mbox{\hyperlink{secp256k1_8c_a6e1f88c6ce07376501097b42a2b40727}{ARG\_CHECK}}(pubnonce\ !=\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00721}00721\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_adc4bd59a60361844aa0e852efa210105}{memset}}(pubnonce,\ 0,\ \textcolor{keyword}{sizeof}(*pubnonce));}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00722}00722\ \ \ \ \ \mbox{\hyperlink{secp256k1_8c_a6e1f88c6ce07376501097b42a2b40727}{ARG\_CHECK}}(n\ >=\ 1);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00723}00723\ \ \ \ \ \mbox{\hyperlink{secp256k1_8c_a6e1f88c6ce07376501097b42a2b40727}{ARG\_CHECK}}(pubnonces\ !=\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00724}00724\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00725}00725\ \ \ \ \ secp256k1\_gej\_set\_infinity(\&Qj);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00726}00726\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00727}00727\ \ \ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0;\ i\ <\ n;\ i++)\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00728}00728\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{secp256k1_8c_a6e1f88c6ce07376501097b42a2b40727}{ARG\_CHECK}}(pubnonces[i]\ !=\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00729}00729\ \ \ \ \ \ \ \ \ secp256k1\_pubkey\_load(ctx,\ \&Q,\ pubnonces[i]);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00730}00730\ \ \ \ \ \ \ \ \ secp256k1\_gej\_add\_ge(\&Qj,\ \&Qj,\ \&Q);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00731}00731\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00732}00732\ \ \ \ \ \textcolor{keywordflow}{if}\ (secp256k1\_gej\_is\_infinity(\&Qj))\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00733}00733\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00734}00734\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00735}00735\ \ \ \ \ secp256k1\_ge\_set\_gej(\&Q,\ \&Qj);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00736}00736\ \ \ \ \ secp256k1\_pubkey\_save(pubnonce,\ \&Q);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00737}00737\ \ \ \ \ \textcolor{keywordflow}{return}\ 1;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00738}00738\ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00739}00739\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00740}\mbox{\hyperlink{secp256k1_8h_a797aef211241f7f6edbb60dcc81c6036}{00740}}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{secp256k1_8c_a364d53929192054916b1207a22e701ec}{secp256k1\_tagged\_sha256}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structsecp256k1__context__struct}{secp256k1\_context}}*\ ctx,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *hash32,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *tag,\ \textcolor{keywordtype}{size\_t}\ taglen,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *msg,\ \textcolor{keywordtype}{size\_t}\ msglen)\ \{}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00741}00741\ \ \ \ \ \mbox{\hyperlink{structsecp256k1__sha256}{secp256k1\_sha256}}\ sha;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00742}00742\ \ \ \ \ \mbox{\hyperlink{fc_2secp256k1_2secp256k1_2src_2util_8h_aca8ac5ae73fd966db106de59160a178b}{VERIFY\_CHECK}}(ctx\ !=\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00743}00743\ \ \ \ \ \mbox{\hyperlink{secp256k1_8c_a6e1f88c6ce07376501097b42a2b40727}{ARG\_CHECK}}(hash32\ !=\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00744}00744\ \ \ \ \ \mbox{\hyperlink{secp256k1_8c_a6e1f88c6ce07376501097b42a2b40727}{ARG\_CHECK}}(tag\ !=\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00745}00745\ \ \ \ \ \mbox{\hyperlink{secp256k1_8c_a6e1f88c6ce07376501097b42a2b40727}{ARG\_CHECK}}(msg\ !=\ NULL);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00746}00746\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00747}00747\ \ \ \ \ secp256k1\_sha256\_initialize\_tagged(\&sha,\ tag,\ taglen);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00748}00748\ \ \ \ \ secp256k1\_sha256\_write(\&sha,\ msg,\ msglen);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00749}00749\ \ \ \ \ secp256k1\_sha256\_finalize(\&sha,\ hash32);}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00750}00750\ \ \ \ \ \textcolor{keywordflow}{return}\ 1;}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00751}00751\ \}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00752}00752\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00753}00753\ \textcolor{preprocessor}{\#ifdef\ ENABLE\_MODULE\_ECDH}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00754}00754\ \textcolor{preprocessor}{\#\ include\ "{}\mbox{\hyperlink{ecdh_2main__impl_8h}{modules/ecdh/main\_impl.h}}"{}}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00755}00755\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00756}00756\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00757}00757\ \textcolor{preprocessor}{\#ifdef\ ENABLE\_MODULE\_RECOVERY}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00758}00758\ \textcolor{preprocessor}{\#\ include\ "{}\mbox{\hyperlink{recovery_2main__impl_8h}{modules/recovery/main\_impl.h}}"{}}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00759}00759\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00760}00760\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00761}00761\ \textcolor{preprocessor}{\#ifdef\ ENABLE\_MODULE\_EXTRAKEYS}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00762}00762\ \textcolor{preprocessor}{\#\ include\ "{}\mbox{\hyperlink{extrakeys_2main__impl_8h}{modules/extrakeys/main\_impl.h}}"{}}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00763}00763\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00764}00764\ }
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00765}00765\ \textcolor{preprocessor}{\#ifdef\ ENABLE\_MODULE\_SCHNORRSIG}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00766}00766\ \textcolor{preprocessor}{\#\ include\ "{}\mbox{\hyperlink{schnorrsig_2main__impl_8h}{modules/schnorrsig/main\_impl.h}}"{}}}
\DoxyCodeLine{\Hypertarget{secp256k1_8c_source_l00767}00767\ \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
