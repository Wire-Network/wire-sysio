<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Wire Sysio: libraries/fc/secp256k1/secp256k1/src/modules/recovery/tests_impl.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Wire Sysio<span id="projectnumber">&#160;Wire Sysion 1.0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('recovery_2tests__impl_8h.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">tests_impl.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p><a href="recovery_2tests__impl_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a0966a428c1c43743711ce59cb9da75b3" id="r_a0966a428c1c43743711ce59cb9da75b3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0966a428c1c43743711ce59cb9da75b3">test_ecdsa_recovery_api</a> (void)</td></tr>
<tr class="separator:a0966a428c1c43743711ce59cb9da75b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70649882936497184992dfaa06b1106f" id="r_a70649882936497184992dfaa06b1106f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a70649882936497184992dfaa06b1106f">test_ecdsa_recovery_end_to_end</a> (void)</td></tr>
<tr class="separator:a70649882936497184992dfaa06b1106f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6d3138600637a7c940bc40a22795e46" id="r_ad6d3138600637a7c940bc40a22795e46"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad6d3138600637a7c940bc40a22795e46">test_ecdsa_recovery_edge_cases</a> (void)</td></tr>
<tr class="separator:ad6d3138600637a7c940bc40a22795e46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a06f71955483e9502f3c408857407f2" id="r_a3a06f71955483e9502f3c408857407f2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3a06f71955483e9502f3c408857407f2">run_recovery_tests</a> (void)</td></tr>
<tr class="separator:a3a06f71955483e9502f3c408857407f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a3a06f71955483e9502f3c408857407f2" name="a3a06f71955483e9502f3c408857407f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a06f71955483e9502f3c408857407f2">&#9670;&#160;</a></span>run_recovery_tests()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void run_recovery_tests </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="recovery_2tests__impl_8h_source.html#l00388">388</a> of file <a class="el" href="recovery_2tests__impl_8h_source.html">tests_impl.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  388</span>                              {</div>
<div class="line"><span class="lineno">  389</span>    <span class="keywordtype">int</span> i;</div>
<div class="line"><span class="lineno">  390</span>    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code hl_variable" href="gmock__stress__test_8cc.html#afd9db40e3361ae09188795e8cbe19752">count</a>; i++) {</div>
<div class="line"><span class="lineno">  391</span>        <a class="code hl_function" href="#a0966a428c1c43743711ce59cb9da75b3">test_ecdsa_recovery_api</a>();</div>
<div class="line"><span class="lineno">  392</span>    }</div>
<div class="line"><span class="lineno">  393</span>    <span class="keywordflow">for</span> (i = 0; i &lt; 64*<a class="code hl_variable" href="gmock__stress__test_8cc.html#afd9db40e3361ae09188795e8cbe19752">count</a>; i++) {</div>
<div class="line"><span class="lineno">  394</span>        <a class="code hl_function" href="#a70649882936497184992dfaa06b1106f">test_ecdsa_recovery_end_to_end</a>();</div>
<div class="line"><span class="lineno">  395</span>    }</div>
<div class="line"><span class="lineno">  396</span>    <a class="code hl_function" href="#ad6d3138600637a7c940bc40a22795e46">test_ecdsa_recovery_edge_cases</a>();</div>
<div class="line"><span class="lineno">  397</span>}</div>
<div class="ttc" id="agmock__stress__test_8cc_html_afd9db40e3361ae09188795e8cbe19752"><div class="ttname"><a href="gmock__stress__test_8cc.html#afd9db40e3361ae09188795e8cbe19752">count</a></div><div class="ttdeci">int * count</div><div class="ttdef"><b>Definition</b> <a href="gmock__stress__test_8cc_source.html#l00177">gmock_stress_test.cc:177</a></div></div>
<div class="ttc" id="arecovery_2tests__impl_8h_html_a0966a428c1c43743711ce59cb9da75b3"><div class="ttname"><a href="#a0966a428c1c43743711ce59cb9da75b3">test_ecdsa_recovery_api</a></div><div class="ttdeci">void test_ecdsa_recovery_api(void)</div><div class="ttdef"><b>Definition</b> <a href="recovery_2tests__impl_8h_source.html#l00031">tests_impl.h:31</a></div></div>
<div class="ttc" id="arecovery_2tests__impl_8h_html_a70649882936497184992dfaa06b1106f"><div class="ttname"><a href="#a70649882936497184992dfaa06b1106f">test_ecdsa_recovery_end_to_end</a></div><div class="ttdeci">void test_ecdsa_recovery_end_to_end(void)</div><div class="ttdef"><b>Definition</b> <a href="recovery_2tests__impl_8h_source.html#l00156">tests_impl.h:156</a></div></div>
<div class="ttc" id="arecovery_2tests__impl_8h_html_ad6d3138600637a7c940bc40a22795e46"><div class="ttname"><a href="#ad6d3138600637a7c940bc40a22795e46">test_ecdsa_recovery_edge_cases</a></div><div class="ttdeci">void test_ecdsa_recovery_edge_cases(void)</div><div class="ttdef"><b>Definition</b> <a href="recovery_2tests__impl_8h_source.html#l00215">tests_impl.h:215</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="recovery_2tests__impl_8h_a3a06f71955483e9502f3c408857407f2_cgraph.png" border="0" usemap="#arecovery_2tests__impl_8h_a3a06f71955483e9502f3c408857407f2_cgraph" alt=""/></div>
<map name="arecovery_2tests__impl_8h_a3a06f71955483e9502f3c408857407f2_cgraph" id="arecovery_2tests__impl_8h_a3a06f71955483e9502f3c408857407f2_cgraph">
<area shape="rect" title=" " alt="" coords="5,692,138,717"/>
<area shape="rect" href="recovery_2tests__impl_8h.html#a0966a428c1c43743711ce59cb9da75b3" title=" " alt="" coords="186,446,352,472"/>
<area shape="poly" title=" " alt="" coords="81,689,246,482,250,485,85,693"/>
<area shape="rect" href="recovery_2tests__impl_8h.html#ad6d3138600637a7c940bc40a22795e46" title=" " alt="" coords="198,905,340,946"/>
<area shape="poly" title=" " alt="" coords="86,716,242,892,238,896,82,719"/>
<area shape="rect" href="recovery_2tests__impl_8h.html#a70649882936497184992dfaa06b1106f" title=" " alt="" coords="198,684,340,725"/>
<area shape="poly" title=" " alt="" coords="138,702,182,702,182,707,138,707"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="464,37,536,62"/>
<area shape="poly" title=" " alt="" coords="268,445,272,379,290,278,306,222,329,167,359,116,398,72,422,57,449,49,450,55,424,62,402,76,364,119,334,170,311,224,295,279,278,379,273,446"/>
<area shape="rect" href="secp256k1_8c.html#adb5e8056701518fc6aac1738ff58fec1" title=" " alt="" coords="414,86,586,112"/>
<area shape="poly" title=" " alt="" coords="269,445,278,388,299,303,316,257,337,210,365,167,398,129,415,117,418,121,402,133,369,170,342,213,320,259,304,305,283,389,274,446"/>
<area shape="rect" href="secp256k1_8c.html#a861ce6fc7ee5e9fc346a5fee7093adb1" title=" " alt="" coords="412,144,589,169"/>
<area shape="poly" title=" " alt="" coords="270,446,280,395,303,323,320,284,341,245,367,209,398,178,402,175,406,179,402,182,371,213,346,248,325,286,308,325,285,397,275,447"/>
<area shape="rect" href="secp256k1_8c.html#ac80c186f8ff22d87441240267a2c8100" title=" " alt="" coords="408,193,592,218"/>
<area shape="poly" title=" " alt="" coords="271,445,285,403,310,344,347,282,371,254,398,229,406,224,409,228,402,233,375,257,352,285,315,347,290,405,276,447"/>
<area shape="rect" href="secp256k1_8c.html#a7384d60163d08fae0c5e8d1e1fdef60a" title=" " alt="" coords="420,243,580,283"/>
<area shape="poly" title=" " alt="" coords="275,444,320,374,356,331,398,294,407,289,410,293,402,298,360,335,325,377,279,447"/>
<area shape="rect" href="secp256k1_8c.html#a947ba36e0fe0bced91d4c9a7ef3b1f09" title=" " alt="" coords="420,308,580,349"/>
<area shape="poly" title=" " alt="" coords="283,444,332,403,399,359,413,352,415,357,401,364,335,407,286,448"/>
<area shape="rect" href="secp256k1_8c.html#ac5806cffd3278e64f863027eaa8e1284" title=" " alt="" coords="423,439,577,479"/>
<area shape="poly" title=" " alt="" coords="352,456,407,456,407,462,352,462"/>
<area shape="rect" href="secp256k1_8c.html#a6015346bdaee22c65e5ebca71693d9b1" title=" " alt="" coords="423,619,577,659"/>
<area shape="poly" title=" " alt="" coords="281,471,327,534,362,571,402,603,411,609,408,614,398,608,358,575,323,538,276,474"/>
<area shape="rect" href="recovery_2main__impl_8h.html#aa87f5523141f798e963300ccd975141d" title=" " alt="" coords="412,913,588,938"/>
<area shape="poly" title=" " alt="" coords="279,471,313,555,355,672,362,707,364,740,363,796,363,822,369,847,381,873,402,900,403,901,400,905,398,903,376,876,364,849,358,823,357,796,359,740,357,708,349,673,308,557,274,473"/>
<area shape="rect" href="recovery_2main__impl_8h.html#a16ddfc800140d761bc783e571c34548c" title=" " alt="" coords="400,684,600,725"/>
<area shape="poly" title=" " alt="" coords="277,471,292,510,318,563,355,620,377,646,402,669,408,674,405,678,398,673,373,650,350,623,313,566,287,512,272,473"/>
<area shape="rect" href="recovery_2main__impl_8h.html#a37101568f72e98d7b29de6c6a825a289" title=" " alt="" coords="400,799,600,839"/>
<area shape="poly" title=" " alt="" coords="277,471,292,518,318,585,355,662,402,735,428,763,457,787,454,791,425,767,398,738,351,664,314,587,287,519,272,473"/>
<area shape="rect" href="recovery_2main__impl_8h.html#ac122392fa6ff6264a7a110875af164b0" title=" " alt="" coords="400,373,600,414"/>
<area shape="poly" title=" " alt="" coords="316,443,410,416,412,421,318,448"/>
<area shape="rect" href="secp256k1_8c.html#af5ff5bb2cad5c58e90c653092648c63a" title=" " alt="" coords="422,504,579,529"/>
<area shape="poly" title=" " alt="" coords="324,470,431,497,430,502,323,475"/>
<area shape="rect" href="recovery_2main__impl_8h.html#a8c69d8d94dcf300ec40684a12f77092b" title=" " alt="" coords="422,553,579,594"/>
<area shape="poly" title=" " alt="" coords="289,470,338,504,401,539,414,545,412,550,399,544,336,508,286,475"/>
<area shape="rect" href="secp256k1_8c.html#a2a2e39dbcd6d55d8e6faaad194261a71" title=" " alt="" coords="648,5,860,46"/>
<area shape="poly" title=" " alt="" coords="560,83,600,72,648,56,672,49,673,54,649,62,601,78,561,88"/>
<area shape="rect" href="secp256k1_8c.html#a5665930bf606d6a7262cebc936eda949" title=" " alt="" coords="648,71,860,111"/>
<area shape="poly" title=" " alt="" coords="587,94,633,92,633,97,587,99"/>
<area shape="rect" href="secp256k1_8c.html#af4866e9619f06679358fe6338ed42cd0" title=" " alt="" coords="648,136,860,177"/>
<area shape="poly" title=" " alt="" coords="589,154,633,154,633,159,589,159"/>
<area shape="rect" href="secp256k1_8c.html#a9f5faeec85b85bdaccd7ddda899dbfa2" title=" " alt="" coords="908,173,1150,198"/>
<area shape="poly" title=" " alt="" coords="558,167,649,186,773,193,892,191,892,197,773,198,648,191,557,172"/>
<area shape="poly" title=" " alt="" coords="860,165,892,168,892,174,860,170"/>
<area shape="rect" href="secp256k1_8c.html#a62b32b6a46f53b6aef01d3888496a79f" title=" " alt="" coords="648,251,860,291"/>
<area shape="poly" title=" " alt="" coords="555,217,601,228,659,244,658,249,600,234,554,222"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="720,806,788,832"/>
<area shape="poly" title=" " alt="" coords="579,474,602,489,635,524,663,563,687,605,707,648,735,728,750,790,745,792,730,730,702,650,682,607,659,566,631,527,599,493,576,479"/>
<area shape="poly" title=" " alt="" coords="566,910,599,899,663,869,718,838,721,843,666,874,601,904,568,915"/>
<area shape="poly" title=" " alt="" coords="601,816,704,816,704,822,601,822"/>
<area shape="poly" title=" " alt="" coords="341,923,397,923,397,928,341,928"/>
<area shape="poly" title=" " alt="" coords="301,902,346,875,399,849,413,843,415,848,401,853,349,880,304,907"/>
<area shape="rect" href="secp256k1_8c.html#a7bd08fb7f758494d5011849b6ca0ef13" title=" " alt="" coords="407,1012,593,1053"/>
<area shape="poly" title=" " alt="" coords="304,944,349,971,401,998,415,1004,413,1009,399,1003,346,976,301,949"/>
<area shape="rect" href="secp256k1_8c.html#abd11af3da8d88984e87ec8f06fb0087a" title=" " alt="" coords="418,962,583,988"/>
<area shape="poly" title=" " alt="" coords="341,938,422,956,421,961,340,943"/>
<area shape="poly" title=" " alt="" coords="579,1009,599,998,643,962,681,920,735,843,740,846,685,923,647,966,602,1003,581,1014"/>
<area shape="poly" title=" " alt="" coords="275,682,291,642,317,590,353,536,374,511,398,489,408,482,411,487,402,493,378,515,357,539,322,592,296,644,280,684"/>
<area shape="poly" title=" " alt="" coords="341,719,401,734,705,805,704,811,399,739,340,724"/>
<area shape="poly" title=" " alt="" coords="340,682,410,661,412,667,341,687"/>
<area shape="poly" title=" " alt="" coords="280,724,297,762,323,810,358,859,378,881,402,900,408,904,405,908,398,904,375,884,353,862,318,813,292,764,275,726"/>
<area shape="poly" title=" " alt="" coords="341,702,385,702,385,707,341,707"/>
<area shape="poly" title=" " alt="" coords="304,723,401,778,428,790,425,795,399,783,301,727"/>
<area shape="poly" title=" " alt="" coords="275,682,329,546,364,473,382,445,398,425,404,421,407,425,402,429,386,448,369,476,333,548,280,684"/>
<area shape="poly" title=" " alt="" coords="278,682,324,612,358,573,398,539,409,534,412,538,402,544,362,576,328,615,283,685"/>
<area shape="poly" title=" " alt="" coords="291,682,339,643,399,605,413,598,415,603,401,609,342,647,295,686"/>
<area shape="poly" title=" " alt="" coords="281,724,335,845,370,909,386,933,402,949,406,952,403,957,398,953,382,936,365,912,330,848,276,726"/>
<area shape="rect" href="tests_8c.html#a51e09e6745e0afdb0d596ee0f4b3c3f7" title=" " alt="" coords="414,864,586,889"/>
<area shape="poly" title=" " alt="" coords="285,723,331,786,364,820,401,849,413,855,410,860,399,853,360,824,327,789,280,726"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="recovery_2tests__impl_8h_a3a06f71955483e9502f3c408857407f2_icgraph.png" border="0" usemap="#arecovery_2tests__impl_8h_a3a06f71955483e9502f3c408857407f2_icgraph" alt=""/></div>
<map name="arecovery_2tests__impl_8h_a3a06f71955483e9502f3c408857407f2_icgraph" id="arecovery_2tests__impl_8h_a3a06f71955483e9502f3c408857407f2_icgraph">
<area shape="rect" title=" " alt="" coords="103,5,235,31"/>
<area shape="rect" href="tests_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title=" " alt="" coords="5,5,55,31"/>
<area shape="poly" title=" " alt="" coords="87,21,55,21,55,16,87,16"/>
</map>
</div>

</div>
</div>
<a id="a0966a428c1c43743711ce59cb9da75b3" name="a0966a428c1c43743711ce59cb9da75b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0966a428c1c43743711ce59cb9da75b3">&#9670;&#160;</a></span>test_ecdsa_recovery_api()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void test_ecdsa_recovery_api </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="recovery_2tests__impl_8h_source.html#l00031">31</a> of file <a class="el" href="recovery_2tests__impl_8h_source.html">tests_impl.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   31</span>                                   {</div>
<div class="line"><span class="lineno">   32</span>    <span class="comment">/* Setup contexts that just count errors */</span></div>
<div class="line"><span class="lineno">   33</span>    <a class="code hl_struct" href="structsecp256k1__context__struct.html">secp256k1_context</a> *<a class="code hl_typedef" href="namespace_native_types.html#a56927845fa87e6f37216943792d64073">none</a> = <a class="code hl_function" href="secp256k1_8h.html#a3aaa9fcc3ab67bc8f841779a049069c5">secp256k1_context_create</a>(<a class="code hl_define" href="secp256k1_8h.html#a4f7b286aa714c2e0fb279c180f67e9b3">SECP256K1_CONTEXT_NONE</a>);</div>
<div class="line"><span class="lineno">   34</span>    <a class="code hl_struct" href="structsecp256k1__context__struct.html">secp256k1_context</a> *sign = <a class="code hl_function" href="secp256k1_8h.html#a3aaa9fcc3ab67bc8f841779a049069c5">secp256k1_context_create</a>(<a class="code hl_define" href="secp256k1_8h.html#a0d34fe6baa73d3145f2e376e43de0b15">SECP256K1_CONTEXT_SIGN</a>);</div>
<div class="line"><span class="lineno">   35</span>    <a class="code hl_struct" href="structsecp256k1__context__struct.html">secp256k1_context</a> *vrfy = <a class="code hl_function" href="secp256k1_8h.html#a3aaa9fcc3ab67bc8f841779a049069c5">secp256k1_context_create</a>(<a class="code hl_define" href="secp256k1_8h.html#add20a6c320e247ca7bd524cbc4259d64">SECP256K1_CONTEXT_VERIFY</a>);</div>
<div class="line"><span class="lineno">   36</span>    <a class="code hl_struct" href="structsecp256k1__context__struct.html">secp256k1_context</a> *both = <a class="code hl_function" href="secp256k1_8h.html#a3aaa9fcc3ab67bc8f841779a049069c5">secp256k1_context_create</a>(<a class="code hl_define" href="secp256k1_8h.html#a0d34fe6baa73d3145f2e376e43de0b15">SECP256K1_CONTEXT_SIGN</a> | <a class="code hl_define" href="secp256k1_8h.html#add20a6c320e247ca7bd524cbc4259d64">SECP256K1_CONTEXT_VERIFY</a>);</div>
<div class="line"><span class="lineno">   37</span>    <a class="code hl_struct" href="structsecp256k1__context__struct.html">secp256k1_context</a> *sttc = <a class="code hl_function" href="secp256k1_8h.html#aa999f2e6f81210fc8970af81cf75bef8">secp256k1_context_clone</a>(<a class="code hl_variable" href="secp256k1_8h.html#a16a0e7ca1212220590374d1a9d17c77d">secp256k1_context_no_precomp</a>);</div>
<div class="line"><span class="lineno">   38</span>    <a class="code hl_struct" href="structsecp256k1__pubkey.html">secp256k1_pubkey</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a931987c85fd408a620505ee9a1aa6f58">pubkey</a>;</div>
<div class="line"><span class="lineno">   39</span>    <a class="code hl_struct" href="structsecp256k1__pubkey.html">secp256k1_pubkey</a> recpubkey;</div>
<div class="line"><span class="lineno">   40</span>    <a class="code hl_struct" href="structsecp256k1__ecdsa__signature.html">secp256k1_ecdsa_signature</a> normal_sig;</div>
<div class="line"><span class="lineno">   41</span>    <a class="code hl_struct" href="structsecp256k1__ecdsa__recoverable__signature.html">secp256k1_ecdsa_recoverable_signature</a> recsig;</div>
<div class="line"><span class="lineno">   42</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> privkey[32] = { 1 };</div>
<div class="line"><span class="lineno">   43</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> message[32] = { 2 };</div>
<div class="line"><span class="lineno">   44</span>    <a class="code hl_typedef" href="stdint_8h.html#ab1967d8591af1a4e48c37fd2b0f184d0">int32_t</a> ecount = 0;</div>
<div class="line"><span class="lineno">   45</span>    <span class="keywordtype">int</span> recid = 0;</div>
<div class="line"><span class="lineno">   46</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> sig[74];</div>
<div class="line"><span class="lineno">   47</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> zero_privkey[32] = { 0 };</div>
<div class="line"><span class="lineno">   48</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> over_privkey[32] = { 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,</div>
<div class="line"><span class="lineno">   49</span>                                       0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,</div>
<div class="line"><span class="lineno">   50</span>                                       0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,</div>
<div class="line"><span class="lineno">   51</span>                                       0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff };</div>
<div class="line"><span class="lineno">   52</span> </div>
<div class="line"><span class="lineno">   53</span>    <a class="code hl_function" href="secp256k1_8h.html#a35106efb325f03468bcf5faa524c1cc4">secp256k1_context_set_error_callback</a>(none, counting_illegal_callback_fn, &amp;ecount);</div>
<div class="line"><span class="lineno">   54</span>    <a class="code hl_function" href="secp256k1_8h.html#a35106efb325f03468bcf5faa524c1cc4">secp256k1_context_set_error_callback</a>(sign, counting_illegal_callback_fn, &amp;ecount);</div>
<div class="line"><span class="lineno">   55</span>    <a class="code hl_function" href="secp256k1_8h.html#a35106efb325f03468bcf5faa524c1cc4">secp256k1_context_set_error_callback</a>(vrfy, counting_illegal_callback_fn, &amp;ecount);</div>
<div class="line"><span class="lineno">   56</span>    <a class="code hl_function" href="secp256k1_8h.html#a35106efb325f03468bcf5faa524c1cc4">secp256k1_context_set_error_callback</a>(both, counting_illegal_callback_fn, &amp;ecount);</div>
<div class="line"><span class="lineno">   57</span>    <a class="code hl_function" href="secp256k1_8h.html#a35106efb325f03468bcf5faa524c1cc4">secp256k1_context_set_error_callback</a>(sttc, counting_illegal_callback_fn, &amp;ecount);</div>
<div class="line"><span class="lineno">   58</span>    <a class="code hl_function" href="secp256k1_8h.html#a3ec29bece9974f9535337eb7d91b351c">secp256k1_context_set_illegal_callback</a>(none, counting_illegal_callback_fn, &amp;ecount);</div>
<div class="line"><span class="lineno">   59</span>    <a class="code hl_function" href="secp256k1_8h.html#a3ec29bece9974f9535337eb7d91b351c">secp256k1_context_set_illegal_callback</a>(sign, counting_illegal_callback_fn, &amp;ecount);</div>
<div class="line"><span class="lineno">   60</span>    <a class="code hl_function" href="secp256k1_8h.html#a3ec29bece9974f9535337eb7d91b351c">secp256k1_context_set_illegal_callback</a>(vrfy, counting_illegal_callback_fn, &amp;ecount);</div>
<div class="line"><span class="lineno">   61</span>    <a class="code hl_function" href="secp256k1_8h.html#a3ec29bece9974f9535337eb7d91b351c">secp256k1_context_set_illegal_callback</a>(both, counting_illegal_callback_fn, &amp;ecount);</div>
<div class="line"><span class="lineno">   62</span>    <a class="code hl_function" href="secp256k1_8h.html#a3ec29bece9974f9535337eb7d91b351c">secp256k1_context_set_illegal_callback</a>(sttc, counting_illegal_callback_fn, &amp;ecount);</div>
<div class="line"><span class="lineno">   63</span> </div>
<div class="line"><span class="lineno">   64</span>    <span class="comment">/* Construct and verify corresponding public key. */</span></div>
<div class="line"><span class="lineno">   65</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1_8h.html#a366f922fc0c787351e82ff8e3a95f652">secp256k1_ec_seckey_verify</a>(ctx, privkey) == 1);</div>
<div class="line"><span class="lineno">   66</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1_8h.html#a7438071aa8a6dc4697abe4f4659f2161">secp256k1_ec_pubkey_create</a>(ctx, &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a931987c85fd408a620505ee9a1aa6f58">pubkey</a>, privkey) == 1);</div>
<div class="line"><span class="lineno">   67</span> </div>
<div class="line"><span class="lineno">   68</span>    <span class="comment">/* Check bad contexts and NULLs for signing */</span></div>
<div class="line"><span class="lineno">   69</span>    ecount = 0;</div>
<div class="line"><span class="lineno">   70</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1__recovery_8h.html#a7868accd4760afcaeaa0ff3d239afc2a">secp256k1_ecdsa_sign_recoverable</a>(none, &amp;recsig, message, privkey, NULL, NULL) == 1);</div>
<div class="line"><span class="lineno">   71</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(ecount == 0);</div>
<div class="line"><span class="lineno">   72</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1__recovery_8h.html#a7868accd4760afcaeaa0ff3d239afc2a">secp256k1_ecdsa_sign_recoverable</a>(sign, &amp;recsig, message, privkey, NULL, NULL) == 1);</div>
<div class="line"><span class="lineno">   73</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(ecount == 0);</div>
<div class="line"><span class="lineno">   74</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1__recovery_8h.html#a7868accd4760afcaeaa0ff3d239afc2a">secp256k1_ecdsa_sign_recoverable</a>(vrfy, &amp;recsig, message, privkey, NULL, NULL) == 1);</div>
<div class="line"><span class="lineno">   75</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(ecount == 0);</div>
<div class="line"><span class="lineno">   76</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1__recovery_8h.html#a7868accd4760afcaeaa0ff3d239afc2a">secp256k1_ecdsa_sign_recoverable</a>(both, &amp;recsig, message, privkey, NULL, NULL) == 1);</div>
<div class="line"><span class="lineno">   77</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(ecount == 0);</div>
<div class="line"><span class="lineno">   78</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1__recovery_8h.html#a7868accd4760afcaeaa0ff3d239afc2a">secp256k1_ecdsa_sign_recoverable</a>(both, NULL, message, privkey, NULL, NULL) == 0);</div>
<div class="line"><span class="lineno">   79</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(ecount == 1);</div>
<div class="line"><span class="lineno">   80</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1__recovery_8h.html#a7868accd4760afcaeaa0ff3d239afc2a">secp256k1_ecdsa_sign_recoverable</a>(both, &amp;recsig, NULL, privkey, NULL, NULL) == 0);</div>
<div class="line"><span class="lineno">   81</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(ecount == 2);</div>
<div class="line"><span class="lineno">   82</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1__recovery_8h.html#a7868accd4760afcaeaa0ff3d239afc2a">secp256k1_ecdsa_sign_recoverable</a>(both, &amp;recsig, message, NULL, NULL, NULL) == 0);</div>
<div class="line"><span class="lineno">   83</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(ecount == 3);</div>
<div class="line"><span class="lineno">   84</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1__recovery_8h.html#a7868accd4760afcaeaa0ff3d239afc2a">secp256k1_ecdsa_sign_recoverable</a>(sttc, &amp;recsig, message, privkey, NULL, NULL) == 0);</div>
<div class="line"><span class="lineno">   85</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(ecount == 4);</div>
<div class="line"><span class="lineno">   86</span>    <span class="comment">/* This will fail or succeed randomly, and in either case will not ARG_CHECK failure */</span></div>
<div class="line"><span class="lineno">   87</span>    <a class="code hl_function" href="secp256k1__recovery_8h.html#a7868accd4760afcaeaa0ff3d239afc2a">secp256k1_ecdsa_sign_recoverable</a>(both, &amp;recsig, message, privkey, recovery_test_nonce_function, NULL);</div>
<div class="line"><span class="lineno">   88</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(ecount == 4);</div>
<div class="line"><span class="lineno">   89</span>    <span class="comment">/* These will all fail, but not in ARG_CHECK way */</span></div>
<div class="line"><span class="lineno">   90</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1__recovery_8h.html#a7868accd4760afcaeaa0ff3d239afc2a">secp256k1_ecdsa_sign_recoverable</a>(both, &amp;recsig, message, zero_privkey, NULL, NULL) == 0);</div>
<div class="line"><span class="lineno">   91</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1__recovery_8h.html#a7868accd4760afcaeaa0ff3d239afc2a">secp256k1_ecdsa_sign_recoverable</a>(both, &amp;recsig, message, over_privkey, NULL, NULL) == 0);</div>
<div class="line"><span class="lineno">   92</span>    <span class="comment">/* This one will succeed. */</span></div>
<div class="line"><span class="lineno">   93</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1__recovery_8h.html#a7868accd4760afcaeaa0ff3d239afc2a">secp256k1_ecdsa_sign_recoverable</a>(both, &amp;recsig, message, privkey, NULL, NULL) == 1);</div>
<div class="line"><span class="lineno">   94</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(ecount == 4);</div>
<div class="line"><span class="lineno">   95</span> </div>
<div class="line"><span class="lineno">   96</span>    <span class="comment">/* Check signing with a goofy nonce function */</span></div>
<div class="line"><span class="lineno">   97</span> </div>
<div class="line"><span class="lineno">   98</span>    <span class="comment">/* Check bad contexts and NULLs for recovery */</span></div>
<div class="line"><span class="lineno">   99</span>    ecount = 0;</div>
<div class="line"><span class="lineno">  100</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1__recovery_8h.html#af9f2082776bf8ebdb4c38161a211a02b">secp256k1_ecdsa_recover</a>(none, &amp;recpubkey, &amp;recsig, message) == 1);</div>
<div class="line"><span class="lineno">  101</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(ecount == 0);</div>
<div class="line"><span class="lineno">  102</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1__recovery_8h.html#af9f2082776bf8ebdb4c38161a211a02b">secp256k1_ecdsa_recover</a>(sign, &amp;recpubkey, &amp;recsig, message) == 1);</div>
<div class="line"><span class="lineno">  103</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(ecount == 0);</div>
<div class="line"><span class="lineno">  104</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1__recovery_8h.html#af9f2082776bf8ebdb4c38161a211a02b">secp256k1_ecdsa_recover</a>(vrfy, &amp;recpubkey, &amp;recsig, message) == 1);</div>
<div class="line"><span class="lineno">  105</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(ecount == 0);</div>
<div class="line"><span class="lineno">  106</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1__recovery_8h.html#af9f2082776bf8ebdb4c38161a211a02b">secp256k1_ecdsa_recover</a>(both, &amp;recpubkey, &amp;recsig, message) == 1);</div>
<div class="line"><span class="lineno">  107</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(ecount == 0);</div>
<div class="line"><span class="lineno">  108</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1__recovery_8h.html#af9f2082776bf8ebdb4c38161a211a02b">secp256k1_ecdsa_recover</a>(both, NULL, &amp;recsig, message) == 0);</div>
<div class="line"><span class="lineno">  109</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(ecount == 1);</div>
<div class="line"><span class="lineno">  110</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1__recovery_8h.html#af9f2082776bf8ebdb4c38161a211a02b">secp256k1_ecdsa_recover</a>(both, &amp;recpubkey, NULL, message) == 0);</div>
<div class="line"><span class="lineno">  111</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(ecount == 2);</div>
<div class="line"><span class="lineno">  112</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1__recovery_8h.html#af9f2082776bf8ebdb4c38161a211a02b">secp256k1_ecdsa_recover</a>(both, &amp;recpubkey, &amp;recsig, NULL) == 0);</div>
<div class="line"><span class="lineno">  113</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(ecount == 3);</div>
<div class="line"><span class="lineno">  114</span> </div>
<div class="line"><span class="lineno">  115</span>    <span class="comment">/* Check NULLs for conversion */</span></div>
<div class="line"><span class="lineno">  116</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1_8h.html#a4185cc9a9de502e52cfe5350f7dc8438">secp256k1_ecdsa_sign</a>(both, &amp;normal_sig, message, privkey, NULL, NULL) == 1);</div>
<div class="line"><span class="lineno">  117</span>    ecount = 0;</div>
<div class="line"><span class="lineno">  118</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1__recovery_8h.html#ad7a20c9f7ccd9fc6d75a19a3b4195aa5">secp256k1_ecdsa_recoverable_signature_convert</a>(both, NULL, &amp;recsig) == 0);</div>
<div class="line"><span class="lineno">  119</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(ecount == 1);</div>
<div class="line"><span class="lineno">  120</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1__recovery_8h.html#ad7a20c9f7ccd9fc6d75a19a3b4195aa5">secp256k1_ecdsa_recoverable_signature_convert</a>(both, &amp;normal_sig, NULL) == 0);</div>
<div class="line"><span class="lineno">  121</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(ecount == 2);</div>
<div class="line"><span class="lineno">  122</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1__recovery_8h.html#ad7a20c9f7ccd9fc6d75a19a3b4195aa5">secp256k1_ecdsa_recoverable_signature_convert</a>(both, &amp;normal_sig, &amp;recsig) == 1);</div>
<div class="line"><span class="lineno">  123</span> </div>
<div class="line"><span class="lineno">  124</span>    <span class="comment">/* Check NULLs for de/serialization */</span></div>
<div class="line"><span class="lineno">  125</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1__recovery_8h.html#a7868accd4760afcaeaa0ff3d239afc2a">secp256k1_ecdsa_sign_recoverable</a>(both, &amp;recsig, message, privkey, NULL, NULL) == 1);</div>
<div class="line"><span class="lineno">  126</span>    ecount = 0;</div>
<div class="line"><span class="lineno">  127</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1__recovery_8h.html#a12f08c89ceb61949c6a4ec6eb2511185">secp256k1_ecdsa_recoverable_signature_serialize_compact</a>(both, NULL, &amp;recid, &amp;recsig) == 0);</div>
<div class="line"><span class="lineno">  128</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(ecount == 1);</div>
<div class="line"><span class="lineno">  129</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1__recovery_8h.html#a12f08c89ceb61949c6a4ec6eb2511185">secp256k1_ecdsa_recoverable_signature_serialize_compact</a>(both, sig, NULL, &amp;recsig) == 0);</div>
<div class="line"><span class="lineno">  130</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(ecount == 2);</div>
<div class="line"><span class="lineno">  131</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1__recovery_8h.html#a12f08c89ceb61949c6a4ec6eb2511185">secp256k1_ecdsa_recoverable_signature_serialize_compact</a>(both, sig, &amp;recid, NULL) == 0);</div>
<div class="line"><span class="lineno">  132</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(ecount == 3);</div>
<div class="line"><span class="lineno">  133</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1__recovery_8h.html#a12f08c89ceb61949c6a4ec6eb2511185">secp256k1_ecdsa_recoverable_signature_serialize_compact</a>(both, sig, &amp;recid, &amp;recsig) == 1);</div>
<div class="line"><span class="lineno">  134</span> </div>
<div class="line"><span class="lineno">  135</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1__recovery_8h.html#a6699b45dc75be70f028ac7d8ffaba46e">secp256k1_ecdsa_recoverable_signature_parse_compact</a>(both, NULL, sig, recid) == 0);</div>
<div class="line"><span class="lineno">  136</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(ecount == 4);</div>
<div class="line"><span class="lineno">  137</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1__recovery_8h.html#a6699b45dc75be70f028ac7d8ffaba46e">secp256k1_ecdsa_recoverable_signature_parse_compact</a>(both, &amp;recsig, NULL, recid) == 0);</div>
<div class="line"><span class="lineno">  138</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(ecount == 5);</div>
<div class="line"><span class="lineno">  139</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1__recovery_8h.html#a6699b45dc75be70f028ac7d8ffaba46e">secp256k1_ecdsa_recoverable_signature_parse_compact</a>(both, &amp;recsig, sig, -1) == 0);</div>
<div class="line"><span class="lineno">  140</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(ecount == 6);</div>
<div class="line"><span class="lineno">  141</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1__recovery_8h.html#a6699b45dc75be70f028ac7d8ffaba46e">secp256k1_ecdsa_recoverable_signature_parse_compact</a>(both, &amp;recsig, sig, 5) == 0);</div>
<div class="line"><span class="lineno">  142</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(ecount == 7);</div>
<div class="line"><span class="lineno">  143</span>    <span class="comment">/* overflow in signature will fail but not affect ecount */</span></div>
<div class="line"><span class="lineno">  144</span>    <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(sig, over_privkey, 32);</div>
<div class="line"><span class="lineno">  145</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1__recovery_8h.html#a6699b45dc75be70f028ac7d8ffaba46e">secp256k1_ecdsa_recoverable_signature_parse_compact</a>(both, &amp;recsig, sig, recid) == 0);</div>
<div class="line"><span class="lineno">  146</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(ecount == 7);</div>
<div class="line"><span class="lineno">  147</span> </div>
<div class="line"><span class="lineno">  148</span>    <span class="comment">/* cleanup */</span></div>
<div class="line"><span class="lineno">  149</span>    <a class="code hl_function" href="secp256k1_8h.html#a026db914e3723531825ecf25a0cbd699">secp256k1_context_destroy</a>(none);</div>
<div class="line"><span class="lineno">  150</span>    <a class="code hl_function" href="secp256k1_8h.html#a026db914e3723531825ecf25a0cbd699">secp256k1_context_destroy</a>(sign);</div>
<div class="line"><span class="lineno">  151</span>    <a class="code hl_function" href="secp256k1_8h.html#a026db914e3723531825ecf25a0cbd699">secp256k1_context_destroy</a>(vrfy);</div>
<div class="line"><span class="lineno">  152</span>    <a class="code hl_function" href="secp256k1_8h.html#a026db914e3723531825ecf25a0cbd699">secp256k1_context_destroy</a>(both);</div>
<div class="line"><span class="lineno">  153</span>    <a class="code hl_function" href="secp256k1_8h.html#a026db914e3723531825ecf25a0cbd699">secp256k1_context_destroy</a>(sttc);</div>
<div class="line"><span class="lineno">  154</span>}</div>
<div class="ttc" id="afc_2secp256k1_2secp256k1_2src_2util_8h_html_aba1590ff86288c886c47dc8a27b30467"><div class="ttname"><a href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a></div><div class="ttdeci">#define CHECK(cond)</div><div class="ttdef"><b>Definition</b> <a href="fc_2secp256k1_2secp256k1_2src_2util_8h_source.html#l00080">util.h:80</a></div></div>
<div class="ttc" id="anamespace_native_types_html_a56927845fa87e6f37216943792d64073"><div class="ttname"><a href="namespace_native_types.html#a56927845fa87e6f37216943792d64073">NativeTypes::none</a></div><div class="ttdeci">void none</div><div class="ttdef"><b>Definition</b> <a href="_intrinsics_8h_source.html#l00034">Intrinsics.h:34</a></div></div>
<div class="ttc" id="asecp256k1_8h_html_a026db914e3723531825ecf25a0cbd699"><div class="ttname"><a href="secp256k1_8h.html#a026db914e3723531825ecf25a0cbd699">secp256k1_context_destroy</a></div><div class="ttdeci">SECP256K1_API void secp256k1_context_destroy(secp256k1_context *ctx) SECP256K1_ARG_NONNULL(1)</div><div class="ttdef"><b>Definition</b> <a href="secp256k1_8c_source.html#l00146">secp256k1.c:146</a></div></div>
<div class="ttc" id="asecp256k1_8h_html_a0d34fe6baa73d3145f2e376e43de0b15"><div class="ttname"><a href="secp256k1_8h.html#a0d34fe6baa73d3145f2e376e43de0b15">SECP256K1_CONTEXT_SIGN</a></div><div class="ttdeci">#define SECP256K1_CONTEXT_SIGN</div><div class="ttdef"><b>Definition</b> <a href="secp256k1_8h_source.html#l00196">secp256k1.h:196</a></div></div>
<div class="ttc" id="asecp256k1_8h_html_a16a0e7ca1212220590374d1a9d17c77d"><div class="ttname"><a href="secp256k1_8h.html#a16a0e7ca1212220590374d1a9d17c77d">secp256k1_context_no_precomp</a></div><div class="ttdeci">SECP256K1_API const secp256k1_context * secp256k1_context_no_precomp</div><div class="ttdef"><b>Definition</b> <a href="secp256k1_8c_source.html#l00060">secp256k1.c:60</a></div></div>
<div class="ttc" id="asecp256k1_8h_html_a35106efb325f03468bcf5faa524c1cc4"><div class="ttname"><a href="secp256k1_8h.html#a35106efb325f03468bcf5faa524c1cc4">secp256k1_context_set_error_callback</a></div><div class="ttdeci">SECP256K1_API void secp256k1_context_set_error_callback(secp256k1_context *ctx, void(*fun)(const char *message, void *data), const void *data) SECP256K1_ARG_NONNULL(1)</div><div class="ttdef"><b>Definition</b> <a href="secp256k1_8c_source.html#l00162">secp256k1.c:162</a></div></div>
<div class="ttc" id="asecp256k1_8h_html_a366f922fc0c787351e82ff8e3a95f652"><div class="ttname"><a href="secp256k1_8h.html#a366f922fc0c787351e82ff8e3a95f652">secp256k1_ec_seckey_verify</a></div><div class="ttdeci">SECP256K1_API SECP256K1_WARN_UNUSED_RESULT int secp256k1_ec_seckey_verify(const secp256k1_context *ctx, const unsigned char *seckey) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2)</div><div class="ttdef"><b>Definition</b> <a href="secp256k1_8c_source.html#l00528">secp256k1.c:528</a></div></div>
<div class="ttc" id="asecp256k1_8h_html_a3aaa9fcc3ab67bc8f841779a049069c5"><div class="ttname"><a href="secp256k1_8h.html#a3aaa9fcc3ab67bc8f841779a049069c5">secp256k1_context_create</a></div><div class="ttdeci">SECP256K1_API secp256k1_context * secp256k1_context_create(unsigned int flags) SECP256K1_WARN_UNUSED_RESULT</div><div class="ttdef"><b>Definition</b> <a href="secp256k1_8c_source.html#l00107">secp256k1.c:107</a></div></div>
<div class="ttc" id="asecp256k1_8h_html_a3ec29bece9974f9535337eb7d91b351c"><div class="ttname"><a href="secp256k1_8h.html#a3ec29bece9974f9535337eb7d91b351c">secp256k1_context_set_illegal_callback</a></div><div class="ttdeci">SECP256K1_API void secp256k1_context_set_illegal_callback(secp256k1_context *ctx, void(*fun)(const char *message, void *data), const void *data) SECP256K1_ARG_NONNULL(1)</div><div class="ttdef"><b>Definition</b> <a href="secp256k1_8c_source.html#l00153">secp256k1.c:153</a></div></div>
<div class="ttc" id="asecp256k1_8h_html_a4185cc9a9de502e52cfe5350f7dc8438"><div class="ttname"><a href="secp256k1_8h.html#a4185cc9a9de502e52cfe5350f7dc8438">secp256k1_ecdsa_sign</a></div><div class="ttdeci">SECP256K1_API int secp256k1_ecdsa_sign(const secp256k1_context *ctx, secp256k1_ecdsa_signature *sig, const unsigned char *msghash32, const unsigned char *seckey, secp256k1_nonce_function noncefp, const void *ndata) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3) SECP256K1_ARG_NONNULL(4)</div><div class="ttdef"><b>Definition</b> <a href="secp256k1_8c_source.html#l00514">secp256k1.c:514</a></div></div>
<div class="ttc" id="asecp256k1_8h_html_a4f7b286aa714c2e0fb279c180f67e9b3"><div class="ttname"><a href="secp256k1_8h.html#a4f7b286aa714c2e0fb279c180f67e9b3">SECP256K1_CONTEXT_NONE</a></div><div class="ttdeci">#define SECP256K1_CONTEXT_NONE</div><div class="ttdef"><b>Definition</b> <a href="secp256k1_8h_source.html#l00198">secp256k1.h:198</a></div></div>
<div class="ttc" id="asecp256k1_8h_html_a7438071aa8a6dc4697abe4f4659f2161"><div class="ttname"><a href="secp256k1_8h.html#a7438071aa8a6dc4697abe4f4659f2161">secp256k1_ec_pubkey_create</a></div><div class="ttdeci">SECP256K1_API SECP256K1_WARN_UNUSED_RESULT int secp256k1_ec_pubkey_create(const secp256k1_context *ctx, secp256k1_pubkey *pubkey, const unsigned char *seckey) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3)</div><div class="ttdef"><b>Definition</b> <a href="secp256k1_8c_source.html#l00551">secp256k1.c:551</a></div></div>
<div class="ttc" id="asecp256k1_8h_html_aa999f2e6f81210fc8970af81cf75bef8"><div class="ttname"><a href="secp256k1_8h.html#aa999f2e6f81210fc8970af81cf75bef8">secp256k1_context_clone</a></div><div class="ttdeci">SECP256K1_API secp256k1_context * secp256k1_context_clone(const secp256k1_context *ctx) SECP256K1_ARG_NONNULL(1) SECP256K1_WARN_UNUSED_RESULT</div><div class="ttdef"><b>Definition</b> <a href="secp256k1_8c_source.html#l00128">secp256k1.c:128</a></div></div>
<div class="ttc" id="asecp256k1_8h_html_add20a6c320e247ca7bd524cbc4259d64"><div class="ttname"><a href="secp256k1_8h.html#add20a6c320e247ca7bd524cbc4259d64">SECP256K1_CONTEXT_VERIFY</a></div><div class="ttdeci">#define SECP256K1_CONTEXT_VERIFY</div><div class="ttdef"><b>Definition</b> <a href="secp256k1_8h_source.html#l00195">secp256k1.h:195</a></div></div>
<div class="ttc" id="asecp256k1__recovery_8h_html_a12f08c89ceb61949c6a4ec6eb2511185"><div class="ttname"><a href="secp256k1__recovery_8h.html#a12f08c89ceb61949c6a4ec6eb2511185">secp256k1_ecdsa_recoverable_signature_serialize_compact</a></div><div class="ttdeci">SECP256K1_API int secp256k1_ecdsa_recoverable_signature_serialize_compact(const secp256k1_context *ctx, unsigned char *output64, int *recid, const secp256k1_ecdsa_recoverable_signature *sig) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3) SECP256K1_ARG_NONNULL(4)</div><div class="ttdef"><b>Definition</b> <a href="recovery_2main__impl_8h_source.html#l00060">main_impl.h:60</a></div></div>
<div class="ttc" id="asecp256k1__recovery_8h_html_a6699b45dc75be70f028ac7d8ffaba46e"><div class="ttname"><a href="secp256k1__recovery_8h.html#a6699b45dc75be70f028ac7d8ffaba46e">secp256k1_ecdsa_recoverable_signature_parse_compact</a></div><div class="ttdeci">SECP256K1_API int secp256k1_ecdsa_recoverable_signature_parse_compact(const secp256k1_context *ctx, secp256k1_ecdsa_recoverable_signature *sig, const unsigned char *input64, int recid) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3)</div><div class="ttdef"><b>Definition</b> <a href="recovery_2main__impl_8h_source.html#l00038">main_impl.h:38</a></div></div>
<div class="ttc" id="asecp256k1__recovery_8h_html_a7868accd4760afcaeaa0ff3d239afc2a"><div class="ttname"><a href="secp256k1__recovery_8h.html#a7868accd4760afcaeaa0ff3d239afc2a">secp256k1_ecdsa_sign_recoverable</a></div><div class="ttdeci">SECP256K1_API int secp256k1_ecdsa_sign_recoverable(const secp256k1_context *ctx, secp256k1_ecdsa_recoverable_signature *sig, const unsigned char *msghash32, const unsigned char *seckey, secp256k1_nonce_function noncefp, const void *ndata) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3) SECP256K1_ARG_NONNULL(4)</div><div class="ttdef"><b>Definition</b> <a href="recovery_2main__impl_8h_source.html#l00123">main_impl.h:123</a></div></div>
<div class="ttc" id="asecp256k1__recovery_8h_html_ad7a20c9f7ccd9fc6d75a19a3b4195aa5"><div class="ttname"><a href="secp256k1__recovery_8h.html#ad7a20c9f7ccd9fc6d75a19a3b4195aa5">secp256k1_ecdsa_recoverable_signature_convert</a></div><div class="ttdeci">SECP256K1_API int secp256k1_ecdsa_recoverable_signature_convert(const secp256k1_context *ctx, secp256k1_ecdsa_signature *sig, const secp256k1_ecdsa_recoverable_signature *sigin) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3)</div><div class="ttdef"><b>Definition</b> <a href="recovery_2main__impl_8h_source.html#l00074">main_impl.h:74</a></div></div>
<div class="ttc" id="asecp256k1__recovery_8h_html_af9f2082776bf8ebdb4c38161a211a02b"><div class="ttname"><a href="secp256k1__recovery_8h.html#af9f2082776bf8ebdb4c38161a211a02b">secp256k1_ecdsa_recover</a></div><div class="ttdeci">SECP256K1_API SECP256K1_WARN_UNUSED_RESULT int secp256k1_ecdsa_recover(const secp256k1_context *ctx, secp256k1_pubkey *pubkey, const secp256k1_ecdsa_recoverable_signature *sig, const unsigned char *msghash32) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3) SECP256K1_ARG_NONNULL(4)</div><div class="ttdef"><b>Definition</b> <a href="recovery_2main__impl_8h_source.html#l00137">main_impl.h:137</a></div></div>
<div class="ttc" id="astdint_8h_html_ab1967d8591af1a4e48c37fd2b0f184d0"><div class="ttname"><a href="stdint_8h.html#ab1967d8591af1a4e48c37fd2b0f184d0">int32_t</a></div><div class="ttdeci">signed int int32_t</div><div class="ttdef"><b>Definition</b> <a href="stdint_8h_source.html#l00123">stdint.h:123</a></div></div>
<div class="ttc" id="astructsecp256k1__context__struct_html"><div class="ttname"><a href="structsecp256k1__context__struct.html">secp256k1_context_struct</a></div><div class="ttdef"><b>Definition</b> <a href="secp256k1_8c_source.html#l00047">secp256k1.c:47</a></div></div>
<div class="ttc" id="astructsecp256k1__ecdsa__recoverable__signature_html"><div class="ttname"><a href="structsecp256k1__ecdsa__recoverable__signature.html">secp256k1_ecdsa_recoverable_signature</a></div><div class="ttdef"><b>Definition</b> <a href="secp256k1__recovery_8h_source.html#l00024">secp256k1_recovery.h:24</a></div></div>
<div class="ttc" id="astructsecp256k1__ecdsa__signature_html"><div class="ttname"><a href="structsecp256k1__ecdsa__signature.html">secp256k1_ecdsa_signature</a></div><div class="ttdef"><b>Definition</b> <a href="secp256k1_8h_source.html#l00083">secp256k1.h:83</a></div></div>
<div class="ttc" id="astructsecp256k1__pubkey_html"><div class="ttname"><a href="structsecp256k1__pubkey.html">secp256k1_pubkey</a></div><div class="ttdef"><b>Definition</b> <a href="secp256k1_8h_source.html#l00070">secp256k1.h:70</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a931987c85fd408a620505ee9a1aa6f58"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a931987c85fd408a620505ee9a1aa6f58">pubkey</a></div><div class="ttdeci">CK_BYTE_PTR pubkey</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l04984">yubihsm_pkcs11.c:4984</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_ae785d5badbf1f08b491af31f32a135a1"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a></div><div class="ttdeci">memcpy((char *) pInfo-&gt;slotDescription, s, l)</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="recovery_2tests__impl_8h_a0966a428c1c43743711ce59cb9da75b3_cgraph.png" border="0" usemap="#arecovery_2tests__impl_8h_a0966a428c1c43743711ce59cb9da75b3_cgraph" alt=""/></div>
<map name="arecovery_2tests__impl_8h_a0966a428c1c43743711ce59cb9da75b3_cgraph" id="arecovery_2tests__impl_8h_a0966a428c1c43743711ce59cb9da75b3_cgraph">
<area shape="rect" title=" " alt="" coords="5,414,172,440"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="284,37,356,62"/>
<area shape="poly" title=" " alt="" coords="88,413,94,352,113,259,130,209,152,159,181,112,218,72,242,57,268,50,270,55,244,62,221,76,186,115,157,161,135,211,119,261,100,352,93,414"/>
<area shape="rect" href="secp256k1_8c.html#adb5e8056701518fc6aac1738ff58fec1" title=" " alt="" coords="234,86,406,112"/>
<area shape="poly" title=" " alt="" coords="89,413,100,361,122,284,139,243,161,202,187,163,218,129,236,116,239,121,221,133,191,166,165,204,144,245,127,286,105,362,94,414"/>
<area shape="rect" href="secp256k1_8c.html#a861ce6fc7ee5e9fc346a5fee7093adb1" title=" " alt="" coords="231,144,408,169"/>
<area shape="poly" title=" " alt="" coords="90,413,103,368,127,304,165,236,189,205,218,178,223,175,226,179,221,182,193,209,169,239,132,306,108,370,95,415"/>
<area shape="rect" href="secp256k1_8c.html#ac80c186f8ff22d87441240267a2c8100" title=" " alt="" coords="228,193,412,218"/>
<area shape="poly" title=" " alt="" coords="92,413,108,376,134,326,171,273,193,250,218,229,227,223,230,228,221,233,197,253,175,277,139,329,113,378,97,415"/>
<area shape="rect" href="secp256k1_8c.html#a7384d60163d08fae0c5e8d1e1fdef60a" title=" " alt="" coords="240,243,400,283"/>
<area shape="poly" title=" " alt="" coords="97,412,145,356,180,323,218,294,229,288,232,293,221,299,183,327,149,360,101,416"/>
<area shape="rect" href="secp256k1_8c.html#a947ba36e0fe0bced91d4c9a7ef3b1f09" title=" " alt="" coords="240,308,400,349"/>
<area shape="poly" title=" " alt="" coords="113,411,219,359,237,352,239,357,221,364,115,416"/>
<area shape="rect" href="secp256k1_8c.html#ac5806cffd3278e64f863027eaa8e1284" title=" " alt="" coords="243,373,397,414"/>
<area shape="poly" title=" " alt="" coords="171,412,227,404,227,410,172,418"/>
<area shape="rect" href="secp256k1_8c.html#a6015346bdaee22c65e5ebca71693d9b1" title=" " alt="" coords="243,439,397,479"/>
<area shape="poly" title=" " alt="" coords="172,436,227,444,227,449,171,441"/>
<area shape="rect" href="recovery_2main__impl_8h.html#aa87f5523141f798e963300ccd975141d" title=" " alt="" coords="232,504,408,529"/>
<area shape="poly" title=" " alt="" coords="114,438,163,463,221,489,244,496,242,501,219,493,160,468,112,443"/>
<area shape="rect" href="recovery_2main__impl_8h.html#a16ddfc800140d761bc783e571c34548c" title=" " alt="" coords="220,553,420,594"/>
<area shape="poly" title=" " alt="" coords="103,438,152,487,185,515,221,539,230,544,227,549,218,544,182,519,148,491,99,442"/>
<area shape="rect" href="recovery_2main__impl_8h.html#a37101568f72e98d7b29de6c6a825a289" title=" " alt="" coords="220,619,420,659"/>
<area shape="poly" title=" " alt="" coords="98,439,115,472,142,517,178,563,221,604,229,609,226,613,218,608,174,567,138,520,111,475,94,442"/>
<area shape="rect" href="recovery_2main__impl_8h.html#ac122392fa6ff6264a7a110875af164b0" title=" " alt="" coords="220,684,420,725"/>
<area shape="poly" title=" " alt="" coords="96,440,109,483,134,545,171,611,194,642,221,669,227,674,224,678,218,673,190,646,166,614,129,547,104,485,91,441"/>
<area shape="rect" href="secp256k1_8c.html#af5ff5bb2cad5c58e90c653092648c63a" title=" " alt="" coords="241,749,398,774"/>
<area shape="poly" title=" " alt="" coords="94,440,103,494,124,574,141,618,162,660,189,700,221,734,229,740,226,744,218,738,185,703,158,663,136,620,119,576,98,495,89,440"/>
<area shape="rect" href="recovery_2main__impl_8h.html#a8c69d8d94dcf300ec40684a12f77092b" title=" " alt="" coords="241,799,398,839"/>
<area shape="poly" title=" " alt="" coords="93,440,100,502,120,594,136,645,158,696,186,744,222,785,229,792,226,796,218,789,182,747,153,699,131,647,115,596,95,503,88,441"/>
<area shape="rect" href="secp256k1_8c.html#a2a2e39dbcd6d55d8e6faaad194261a71" title=" " alt="" coords="468,5,679,46"/>
<area shape="poly" title=" " alt="" coords="379,83,419,72,467,56,491,49,493,54,469,62,421,78,381,88"/>
<area shape="rect" href="secp256k1_8c.html#a5665930bf606d6a7262cebc936eda949" title=" " alt="" coords="468,71,679,111"/>
<area shape="poly" title=" " alt="" coords="406,94,453,92,453,97,407,99"/>
<area shape="rect" href="secp256k1_8c.html#af4866e9619f06679358fe6338ed42cd0" title=" " alt="" coords="468,136,679,177"/>
<area shape="poly" title=" " alt="" coords="409,154,453,154,453,159,409,159"/>
<area shape="rect" href="secp256k1_8c.html#a9f5faeec85b85bdaccd7ddda899dbfa2" title=" " alt="" coords="727,173,970,198"/>
<area shape="poly" title=" " alt="" coords="377,167,468,186,593,193,712,191,712,197,593,198,468,191,376,172"/>
<area shape="poly" title=" " alt="" coords="680,165,712,168,712,174,680,170"/>
<area shape="rect" href="secp256k1_8c.html#a62b32b6a46f53b6aef01d3888496a79f" title=" " alt="" coords="468,251,679,291"/>
<area shape="poly" title=" " alt="" coords="375,217,421,228,479,244,478,249,419,234,373,222"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="540,504,608,529"/>
<area shape="poly" title=" " alt="" coords="390,412,421,425,486,459,542,493,539,497,484,463,419,429,388,417"/>
<area shape="poly" title=" " alt="" coords="409,514,524,514,524,519,409,519"/>
<area shape="poly" title=" " alt="" coords="388,616,419,603,484,569,539,536,542,540,486,574,421,608,390,621"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="recovery_2tests__impl_8h_a0966a428c1c43743711ce59cb9da75b3_icgraph.png" border="0" usemap="#arecovery_2tests__impl_8h_a0966a428c1c43743711ce59cb9da75b3_icgraph" alt=""/></div>
<map name="arecovery_2tests__impl_8h_a0966a428c1c43743711ce59cb9da75b3_icgraph" id="arecovery_2tests__impl_8h_a0966a428c1c43743711ce59cb9da75b3_icgraph">
<area shape="rect" title=" " alt="" coords="283,5,449,31"/>
<area shape="rect" href="recovery_2tests__impl_8h.html#a3a06f71955483e9502f3c408857407f2" title=" " alt="" coords="103,5,235,31"/>
<area shape="poly" title=" " alt="" coords="268,21,236,21,236,16,268,16"/>
<area shape="rect" href="tests_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title=" " alt="" coords="5,5,55,31"/>
<area shape="poly" title=" " alt="" coords="87,21,55,21,55,16,87,16"/>
</map>
</div>

</div>
</div>
<a id="ad6d3138600637a7c940bc40a22795e46" name="ad6d3138600637a7c940bc40a22795e46"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad6d3138600637a7c940bc40a22795e46">&#9670;&#160;</a></span>test_ecdsa_recovery_edge_cases()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void test_ecdsa_recovery_edge_cases </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="recovery_2tests__impl_8h_source.html#l00215">215</a> of file <a class="el" href="recovery_2tests__impl_8h_source.html">tests_impl.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  215</span>                                          {</div>
<div class="line"><span class="lineno">  216</span>    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> msg32[32] = {</div>
<div class="line"><span class="lineno">  217</span>        <span class="charliteral">&#39;T&#39;</span>, <span class="charliteral">&#39;h&#39;</span>, <span class="charliteral">&#39;i&#39;</span>, <span class="charliteral">&#39;s&#39;</span>, <span class="charliteral">&#39; &#39;</span>, <span class="charliteral">&#39;i&#39;</span>, <span class="charliteral">&#39;s&#39;</span>, <span class="charliteral">&#39; &#39;</span>,</div>
<div class="line"><span class="lineno">  218</span>        <span class="charliteral">&#39;a&#39;</span>, <span class="charliteral">&#39; &#39;</span>, <span class="charliteral">&#39;v&#39;</span>, <span class="charliteral">&#39;e&#39;</span>, <span class="charliteral">&#39;r&#39;</span>, <span class="charliteral">&#39;y&#39;</span>, <span class="charliteral">&#39; &#39;</span>, <span class="charliteral">&#39;s&#39;</span>,</div>
<div class="line"><span class="lineno">  219</span>        <span class="charliteral">&#39;e&#39;</span>, <span class="charliteral">&#39;c&#39;</span>, <span class="charliteral">&#39;r&#39;</span>, <span class="charliteral">&#39;e&#39;</span>, <span class="charliteral">&#39;t&#39;</span>, <span class="charliteral">&#39; &#39;</span>, <span class="charliteral">&#39;m&#39;</span>, <span class="charliteral">&#39;e&#39;</span>,</div>
<div class="line"><span class="lineno">  220</span>        <span class="charliteral">&#39;s&#39;</span>, <span class="charliteral">&#39;s&#39;</span>, <span class="charliteral">&#39;a&#39;</span>, <span class="charliteral">&#39;g&#39;</span>, <span class="charliteral">&#39;e&#39;</span>, <span class="charliteral">&#39;.&#39;</span>, <span class="charliteral">&#39;.&#39;</span>, <span class="charliteral">&#39;.&#39;</span></div>
<div class="line"><span class="lineno">  221</span>    };</div>
<div class="line"><span class="lineno">  222</span>    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> sig64[64] = {</div>
<div class="line"><span class="lineno">  223</span>        <span class="comment">/* Generated by signing the above message with nonce &#39;This is the nonce we will use...&#39;</span></div>
<div class="line"><span class="lineno">  224</span><span class="comment">         * and secret key 0 (which is not valid), resulting in recid 1. */</span></div>
<div class="line"><span class="lineno">  225</span>        0x67, 0xCB, 0x28, 0x5F, 0x9C, 0xD1, 0x94, 0xE8,</div>
<div class="line"><span class="lineno">  226</span>        0x40, 0xD6, 0x29, 0x39, 0x7A, 0xF5, 0x56, 0x96,</div>
<div class="line"><span class="lineno">  227</span>        0x62, 0xFD, 0xE4, 0x46, 0x49, 0x99, 0x59, 0x63,</div>
<div class="line"><span class="lineno">  228</span>        0x17, 0x9A, 0x7D, 0xD1, 0x7B, 0xD2, 0x35, 0x32,</div>
<div class="line"><span class="lineno">  229</span>        0x4B, 0x1B, 0x7D, 0xF3, 0x4C, 0xE1, 0xF6, 0x8E,</div>
<div class="line"><span class="lineno">  230</span>        0x69, 0x4F, 0xF6, 0xF1, 0x1A, 0xC7, 0x51, 0xDD,</div>
<div class="line"><span class="lineno">  231</span>        0x7D, 0xD7, 0x3E, 0x38, 0x7E, 0xE4, 0xFC, 0x86,</div>
<div class="line"><span class="lineno">  232</span>        0x6E, 0x1B, 0xE8, 0xEC, 0xC7, 0xDD, 0x95, 0x57</div>
<div class="line"><span class="lineno">  233</span>    };</div>
<div class="line"><span class="lineno">  234</span>    <a class="code hl_struct" href="structsecp256k1__pubkey.html">secp256k1_pubkey</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a931987c85fd408a620505ee9a1aa6f58">pubkey</a>;</div>
<div class="line"><span class="lineno">  235</span>    <span class="comment">/* signature (r,s) = (4,4), which can be recovered with all 4 recids. */</span></div>
<div class="line"><span class="lineno">  236</span>    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> sigb64[64] = {</div>
<div class="line"><span class="lineno">  237</span>        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</div>
<div class="line"><span class="lineno">  238</span>        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</div>
<div class="line"><span class="lineno">  239</span>        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</div>
<div class="line"><span class="lineno">  240</span>        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x04,</div>
<div class="line"><span class="lineno">  241</span>        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</div>
<div class="line"><span class="lineno">  242</span>        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</div>
<div class="line"><span class="lineno">  243</span>        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</div>
<div class="line"><span class="lineno">  244</span>        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x04,</div>
<div class="line"><span class="lineno">  245</span>    };</div>
<div class="line"><span class="lineno">  246</span>    <a class="code hl_struct" href="structsecp256k1__pubkey.html">secp256k1_pubkey</a> pubkeyb;</div>
<div class="line"><span class="lineno">  247</span>    <a class="code hl_struct" href="structsecp256k1__ecdsa__recoverable__signature.html">secp256k1_ecdsa_recoverable_signature</a> rsig;</div>
<div class="line"><span class="lineno">  248</span>    <a class="code hl_struct" href="structsecp256k1__ecdsa__signature.html">secp256k1_ecdsa_signature</a> sig;</div>
<div class="line"><span class="lineno">  249</span>    <span class="keywordtype">int</span> recid;</div>
<div class="line"><span class="lineno">  250</span> </div>
<div class="line"><span class="lineno">  251</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1__recovery_8h.html#a6699b45dc75be70f028ac7d8ffaba46e">secp256k1_ecdsa_recoverable_signature_parse_compact</a>(ctx, &amp;rsig, sig64, 0));</div>
<div class="line"><span class="lineno">  252</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(!<a class="code hl_function" href="secp256k1__recovery_8h.html#af9f2082776bf8ebdb4c38161a211a02b">secp256k1_ecdsa_recover</a>(ctx, &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a931987c85fd408a620505ee9a1aa6f58">pubkey</a>, &amp;rsig, msg32));</div>
<div class="line"><span class="lineno">  253</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1__recovery_8h.html#a6699b45dc75be70f028ac7d8ffaba46e">secp256k1_ecdsa_recoverable_signature_parse_compact</a>(ctx, &amp;rsig, sig64, 1));</div>
<div class="line"><span class="lineno">  254</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1__recovery_8h.html#af9f2082776bf8ebdb4c38161a211a02b">secp256k1_ecdsa_recover</a>(ctx, &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a931987c85fd408a620505ee9a1aa6f58">pubkey</a>, &amp;rsig, msg32));</div>
<div class="line"><span class="lineno">  255</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1__recovery_8h.html#a6699b45dc75be70f028ac7d8ffaba46e">secp256k1_ecdsa_recoverable_signature_parse_compact</a>(ctx, &amp;rsig, sig64, 2));</div>
<div class="line"><span class="lineno">  256</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(!<a class="code hl_function" href="secp256k1__recovery_8h.html#af9f2082776bf8ebdb4c38161a211a02b">secp256k1_ecdsa_recover</a>(ctx, &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a931987c85fd408a620505ee9a1aa6f58">pubkey</a>, &amp;rsig, msg32));</div>
<div class="line"><span class="lineno">  257</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1__recovery_8h.html#a6699b45dc75be70f028ac7d8ffaba46e">secp256k1_ecdsa_recoverable_signature_parse_compact</a>(ctx, &amp;rsig, sig64, 3));</div>
<div class="line"><span class="lineno">  258</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(!<a class="code hl_function" href="secp256k1__recovery_8h.html#af9f2082776bf8ebdb4c38161a211a02b">secp256k1_ecdsa_recover</a>(ctx, &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a931987c85fd408a620505ee9a1aa6f58">pubkey</a>, &amp;rsig, msg32));</div>
<div class="line"><span class="lineno">  259</span> </div>
<div class="line"><span class="lineno">  260</span>    <span class="keywordflow">for</span> (recid = 0; recid &lt; 4; recid++) {</div>
<div class="line"><span class="lineno">  261</span>        <span class="keywordtype">int</span> i;</div>
<div class="line"><span class="lineno">  262</span>        <span class="keywordtype">int</span> recid2;</div>
<div class="line"><span class="lineno">  263</span>        <span class="comment">/* (4,4) encoded in DER. */</span></div>
<div class="line"><span class="lineno">  264</span>        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> sigbder[8] = {0x30, 0x06, 0x02, 0x01, 0x04, 0x02, 0x01, 0x04};</div>
<div class="line"><span class="lineno">  265</span>        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> sigcder_zr[7] = {0x30, 0x05, 0x02, 0x00, 0x02, 0x01, 0x01};</div>
<div class="line"><span class="lineno">  266</span>        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> sigcder_zs[7] = {0x30, 0x05, 0x02, 0x01, 0x01, 0x02, 0x00};</div>
<div class="line"><span class="lineno">  267</span>        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> sigbderalt1[39] = {</div>
<div class="line"><span class="lineno">  268</span>            0x30, 0x25, 0x02, 0x20, 0x00, 0x00, 0x00, 0x00,</div>
<div class="line"><span class="lineno">  269</span>            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</div>
<div class="line"><span class="lineno">  270</span>            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</div>
<div class="line"><span class="lineno">  271</span>            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</div>
<div class="line"><span class="lineno">  272</span>            0x00, 0x00, 0x00, 0x04, 0x02, 0x01, 0x04,</div>
<div class="line"><span class="lineno">  273</span>        };</div>
<div class="line"><span class="lineno">  274</span>        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> sigbderalt2[39] = {</div>
<div class="line"><span class="lineno">  275</span>            0x30, 0x25, 0x02, 0x01, 0x04, 0x02, 0x20, 0x00,</div>
<div class="line"><span class="lineno">  276</span>            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</div>
<div class="line"><span class="lineno">  277</span>            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</div>
<div class="line"><span class="lineno">  278</span>            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</div>
<div class="line"><span class="lineno">  279</span>            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x04,</div>
<div class="line"><span class="lineno">  280</span>        };</div>
<div class="line"><span class="lineno">  281</span>        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> sigbderalt3[40] = {</div>
<div class="line"><span class="lineno">  282</span>            0x30, 0x26, 0x02, 0x21, 0x00, 0x00, 0x00, 0x00,</div>
<div class="line"><span class="lineno">  283</span>            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</div>
<div class="line"><span class="lineno">  284</span>            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</div>
<div class="line"><span class="lineno">  285</span>            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</div>
<div class="line"><span class="lineno">  286</span>            0x00, 0x00, 0x00, 0x00, 0x04, 0x02, 0x01, 0x04,</div>
<div class="line"><span class="lineno">  287</span>        };</div>
<div class="line"><span class="lineno">  288</span>        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> sigbderalt4[40] = {</div>
<div class="line"><span class="lineno">  289</span>            0x30, 0x26, 0x02, 0x01, 0x04, 0x02, 0x21, 0x00,</div>
<div class="line"><span class="lineno">  290</span>            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</div>
<div class="line"><span class="lineno">  291</span>            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</div>
<div class="line"><span class="lineno">  292</span>            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</div>
<div class="line"><span class="lineno">  293</span>            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x04,</div>
<div class="line"><span class="lineno">  294</span>        };</div>
<div class="line"><span class="lineno">  295</span>        <span class="comment">/* (order + r,4) encoded in DER. */</span></div>
<div class="line"><span class="lineno">  296</span>        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> sigbderlong[40] = {</div>
<div class="line"><span class="lineno">  297</span>            0x30, 0x26, 0x02, 0x21, 0x00, 0xFF, 0xFF, 0xFF,</div>
<div class="line"><span class="lineno">  298</span>            0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,</div>
<div class="line"><span class="lineno">  299</span>            0xFF, 0xFF, 0xFF, 0xFF, 0xFE, 0xBA, 0xAE, 0xDC,</div>
<div class="line"><span class="lineno">  300</span>            0xE6, 0xAF, 0x48, 0xA0, 0x3B, 0xBF, 0xD2, 0x5E,</div>
<div class="line"><span class="lineno">  301</span>            0x8C, 0xD0, 0x36, 0x41, 0x45, 0x02, 0x01, 0x04</div>
<div class="line"><span class="lineno">  302</span>        };</div>
<div class="line"><span class="lineno">  303</span>        <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1__recovery_8h.html#a6699b45dc75be70f028ac7d8ffaba46e">secp256k1_ecdsa_recoverable_signature_parse_compact</a>(ctx, &amp;rsig, sigb64, recid) == 1);</div>
<div class="line"><span class="lineno">  304</span>        <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1__recovery_8h.html#af9f2082776bf8ebdb4c38161a211a02b">secp256k1_ecdsa_recover</a>(ctx, &amp;pubkeyb, &amp;rsig, msg32) == 1);</div>
<div class="line"><span class="lineno">  305</span>        <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1_8h.html#a57d390dd5baa54855b0cb20628034b90">secp256k1_ecdsa_signature_parse_der</a>(ctx, &amp;sig, sigbder, <span class="keyword">sizeof</span>(sigbder)) == 1);</div>
<div class="line"><span class="lineno">  306</span>        <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1_8h.html#a7dd6acb7ef7100a6aebff91ecb7ede30">secp256k1_ecdsa_verify</a>(ctx, &amp;sig, msg32, &amp;pubkeyb) == 1);</div>
<div class="line"><span class="lineno">  307</span>        <span class="keywordflow">for</span> (recid2 = 0; recid2 &lt; 4; recid2++) {</div>
<div class="line"><span class="lineno">  308</span>            <a class="code hl_struct" href="structsecp256k1__pubkey.html">secp256k1_pubkey</a> pubkey2b;</div>
<div class="line"><span class="lineno">  309</span>            <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1__recovery_8h.html#a6699b45dc75be70f028ac7d8ffaba46e">secp256k1_ecdsa_recoverable_signature_parse_compact</a>(ctx, &amp;rsig, sigb64, recid2) == 1);</div>
<div class="line"><span class="lineno">  310</span>            <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1__recovery_8h.html#af9f2082776bf8ebdb4c38161a211a02b">secp256k1_ecdsa_recover</a>(ctx, &amp;pubkey2b, &amp;rsig, msg32) == 1);</div>
<div class="line"><span class="lineno">  311</span>            <span class="comment">/* Verifying with (order + r,4) should always fail. */</span></div>
<div class="line"><span class="lineno">  312</span>            <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1_8h.html#a57d390dd5baa54855b0cb20628034b90">secp256k1_ecdsa_signature_parse_der</a>(ctx, &amp;sig, sigbderlong, <span class="keyword">sizeof</span>(sigbderlong)) == 1);</div>
<div class="line"><span class="lineno">  313</span>            <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1_8h.html#a7dd6acb7ef7100a6aebff91ecb7ede30">secp256k1_ecdsa_verify</a>(ctx, &amp;sig, msg32, &amp;pubkeyb) == 0);</div>
<div class="line"><span class="lineno">  314</span>        }</div>
<div class="line"><span class="lineno">  315</span>        <span class="comment">/* DER parsing tests. */</span></div>
<div class="line"><span class="lineno">  316</span>        <span class="comment">/* Zero length r/s. */</span></div>
<div class="line"><span class="lineno">  317</span>        <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1_8h.html#a57d390dd5baa54855b0cb20628034b90">secp256k1_ecdsa_signature_parse_der</a>(ctx, &amp;sig, sigcder_zr, <span class="keyword">sizeof</span>(sigcder_zr)) == 0);</div>
<div class="line"><span class="lineno">  318</span>        <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1_8h.html#a57d390dd5baa54855b0cb20628034b90">secp256k1_ecdsa_signature_parse_der</a>(ctx, &amp;sig, sigcder_zs, <span class="keyword">sizeof</span>(sigcder_zs)) == 0);</div>
<div class="line"><span class="lineno">  319</span>        <span class="comment">/* Leading zeros. */</span></div>
<div class="line"><span class="lineno">  320</span>        <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1_8h.html#a57d390dd5baa54855b0cb20628034b90">secp256k1_ecdsa_signature_parse_der</a>(ctx, &amp;sig, sigbderalt1, <span class="keyword">sizeof</span>(sigbderalt1)) == 0);</div>
<div class="line"><span class="lineno">  321</span>        <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1_8h.html#a57d390dd5baa54855b0cb20628034b90">secp256k1_ecdsa_signature_parse_der</a>(ctx, &amp;sig, sigbderalt2, <span class="keyword">sizeof</span>(sigbderalt2)) == 0);</div>
<div class="line"><span class="lineno">  322</span>        <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1_8h.html#a57d390dd5baa54855b0cb20628034b90">secp256k1_ecdsa_signature_parse_der</a>(ctx, &amp;sig, sigbderalt3, <span class="keyword">sizeof</span>(sigbderalt3)) == 0);</div>
<div class="line"><span class="lineno">  323</span>        <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1_8h.html#a57d390dd5baa54855b0cb20628034b90">secp256k1_ecdsa_signature_parse_der</a>(ctx, &amp;sig, sigbderalt4, <span class="keyword">sizeof</span>(sigbderalt4)) == 0);</div>
<div class="line"><span class="lineno">  324</span>        sigbderalt3[4] = 1;</div>
<div class="line"><span class="lineno">  325</span>        <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1_8h.html#a57d390dd5baa54855b0cb20628034b90">secp256k1_ecdsa_signature_parse_der</a>(ctx, &amp;sig, sigbderalt3, <span class="keyword">sizeof</span>(sigbderalt3)) == 1);</div>
<div class="line"><span class="lineno">  326</span>        <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1_8h.html#a7dd6acb7ef7100a6aebff91ecb7ede30">secp256k1_ecdsa_verify</a>(ctx, &amp;sig, msg32, &amp;pubkeyb) == 0);</div>
<div class="line"><span class="lineno">  327</span>        sigbderalt4[7] = 1;</div>
<div class="line"><span class="lineno">  328</span>        <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1_8h.html#a57d390dd5baa54855b0cb20628034b90">secp256k1_ecdsa_signature_parse_der</a>(ctx, &amp;sig, sigbderalt4, <span class="keyword">sizeof</span>(sigbderalt4)) == 1);</div>
<div class="line"><span class="lineno">  329</span>        <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1_8h.html#a7dd6acb7ef7100a6aebff91ecb7ede30">secp256k1_ecdsa_verify</a>(ctx, &amp;sig, msg32, &amp;pubkeyb) == 0);</div>
<div class="line"><span class="lineno">  330</span>        <span class="comment">/* Damage signature. */</span></div>
<div class="line"><span class="lineno">  331</span>        sigbder[7]++;</div>
<div class="line"><span class="lineno">  332</span>        <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1_8h.html#a57d390dd5baa54855b0cb20628034b90">secp256k1_ecdsa_signature_parse_der</a>(ctx, &amp;sig, sigbder, <span class="keyword">sizeof</span>(sigbder)) == 1);</div>
<div class="line"><span class="lineno">  333</span>        <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1_8h.html#a7dd6acb7ef7100a6aebff91ecb7ede30">secp256k1_ecdsa_verify</a>(ctx, &amp;sig, msg32, &amp;pubkeyb) == 0);</div>
<div class="line"><span class="lineno">  334</span>        sigbder[7]--;</div>
<div class="line"><span class="lineno">  335</span>        <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1_8h.html#a57d390dd5baa54855b0cb20628034b90">secp256k1_ecdsa_signature_parse_der</a>(ctx, &amp;sig, sigbder, 6) == 0);</div>
<div class="line"><span class="lineno">  336</span>        <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1_8h.html#a57d390dd5baa54855b0cb20628034b90">secp256k1_ecdsa_signature_parse_der</a>(ctx, &amp;sig, sigbder, <span class="keyword">sizeof</span>(sigbder) - 1) == 0);</div>
<div class="line"><span class="lineno">  337</span>        <span class="keywordflow">for</span>(i = 0; i &lt; 8; i++) {</div>
<div class="line"><span class="lineno">  338</span>            <span class="keywordtype">int</span> c;</div>
<div class="line"><span class="lineno">  339</span>            <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> orig = sigbder[i];</div>
<div class="line"><span class="lineno">  340</span>            <span class="comment">/*Try every single-byte change.*/</span></div>
<div class="line"><span class="lineno">  341</span>            <span class="keywordflow">for</span> (c = 0; c &lt; 256; c++) {</div>
<div class="line"><span class="lineno">  342</span>                <span class="keywordflow">if</span> (c == orig ) {</div>
<div class="line"><span class="lineno">  343</span>                    <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  344</span>                }</div>
<div class="line"><span class="lineno">  345</span>                sigbder[i] = c;</div>
<div class="line"><span class="lineno">  346</span>                <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1_8h.html#a57d390dd5baa54855b0cb20628034b90">secp256k1_ecdsa_signature_parse_der</a>(ctx, &amp;sig, sigbder, <span class="keyword">sizeof</span>(sigbder)) == 0 || <a class="code hl_function" href="secp256k1_8h.html#a7dd6acb7ef7100a6aebff91ecb7ede30">secp256k1_ecdsa_verify</a>(ctx, &amp;sig, msg32, &amp;pubkeyb) == 0);</div>
<div class="line"><span class="lineno">  347</span>            }</div>
<div class="line"><span class="lineno">  348</span>            sigbder[i] = orig;</div>
<div class="line"><span class="lineno">  349</span>        }</div>
<div class="line"><span class="lineno">  350</span>    }</div>
<div class="line"><span class="lineno">  351</span> </div>
<div class="line"><span class="lineno">  352</span>    <span class="comment">/* Test r/s equal to zero */</span></div>
<div class="line"><span class="lineno">  353</span>    {</div>
<div class="line"><span class="lineno">  354</span>        <span class="comment">/* (1,1) encoded in DER. */</span></div>
<div class="line"><span class="lineno">  355</span>        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> sigcder[8] = {0x30, 0x06, 0x02, 0x01, 0x01, 0x02, 0x01, 0x01};</div>
<div class="line"><span class="lineno">  356</span>        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> sigc64[64] = {</div>
<div class="line"><span class="lineno">  357</span>            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</div>
<div class="line"><span class="lineno">  358</span>            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</div>
<div class="line"><span class="lineno">  359</span>            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</div>
<div class="line"><span class="lineno">  360</span>            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01,</div>
<div class="line"><span class="lineno">  361</span>            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</div>
<div class="line"><span class="lineno">  362</span>            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</div>
<div class="line"><span class="lineno">  363</span>            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</div>
<div class="line"><span class="lineno">  364</span>            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01,</div>
<div class="line"><span class="lineno">  365</span>        };</div>
<div class="line"><span class="lineno">  366</span>        <a class="code hl_struct" href="structsecp256k1__pubkey.html">secp256k1_pubkey</a> pubkeyc;</div>
<div class="line"><span class="lineno">  367</span>        <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1__recovery_8h.html#a6699b45dc75be70f028ac7d8ffaba46e">secp256k1_ecdsa_recoverable_signature_parse_compact</a>(ctx, &amp;rsig, sigc64, 0) == 1);</div>
<div class="line"><span class="lineno">  368</span>        <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1__recovery_8h.html#af9f2082776bf8ebdb4c38161a211a02b">secp256k1_ecdsa_recover</a>(ctx, &amp;pubkeyc, &amp;rsig, msg32) == 1);</div>
<div class="line"><span class="lineno">  369</span>        <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1_8h.html#a57d390dd5baa54855b0cb20628034b90">secp256k1_ecdsa_signature_parse_der</a>(ctx, &amp;sig, sigcder, <span class="keyword">sizeof</span>(sigcder)) == 1);</div>
<div class="line"><span class="lineno">  370</span>        <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1_8h.html#a7dd6acb7ef7100a6aebff91ecb7ede30">secp256k1_ecdsa_verify</a>(ctx, &amp;sig, msg32, &amp;pubkeyc) == 1);</div>
<div class="line"><span class="lineno">  371</span>        sigcder[4] = 0;</div>
<div class="line"><span class="lineno">  372</span>        sigc64[31] = 0;</div>
<div class="line"><span class="lineno">  373</span>        <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1__recovery_8h.html#a6699b45dc75be70f028ac7d8ffaba46e">secp256k1_ecdsa_recoverable_signature_parse_compact</a>(ctx, &amp;rsig, sigc64, 0) == 1);</div>
<div class="line"><span class="lineno">  374</span>        <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1__recovery_8h.html#af9f2082776bf8ebdb4c38161a211a02b">secp256k1_ecdsa_recover</a>(ctx, &amp;pubkeyb, &amp;rsig, msg32) == 0);</div>
<div class="line"><span class="lineno">  375</span>        <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1_8h.html#a57d390dd5baa54855b0cb20628034b90">secp256k1_ecdsa_signature_parse_der</a>(ctx, &amp;sig, sigcder, <span class="keyword">sizeof</span>(sigcder)) == 1);</div>
<div class="line"><span class="lineno">  376</span>        <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1_8h.html#a7dd6acb7ef7100a6aebff91ecb7ede30">secp256k1_ecdsa_verify</a>(ctx, &amp;sig, msg32, &amp;pubkeyc) == 0);</div>
<div class="line"><span class="lineno">  377</span>        sigcder[4] = 1;</div>
<div class="line"><span class="lineno">  378</span>        sigcder[7] = 0;</div>
<div class="line"><span class="lineno">  379</span>        sigc64[31] = 1;</div>
<div class="line"><span class="lineno">  380</span>        sigc64[63] = 0;</div>
<div class="line"><span class="lineno">  381</span>        <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1__recovery_8h.html#a6699b45dc75be70f028ac7d8ffaba46e">secp256k1_ecdsa_recoverable_signature_parse_compact</a>(ctx, &amp;rsig, sigc64, 0) == 1);</div>
<div class="line"><span class="lineno">  382</span>        <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1__recovery_8h.html#af9f2082776bf8ebdb4c38161a211a02b">secp256k1_ecdsa_recover</a>(ctx, &amp;pubkeyb, &amp;rsig, msg32) == 0);</div>
<div class="line"><span class="lineno">  383</span>        <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1_8h.html#a57d390dd5baa54855b0cb20628034b90">secp256k1_ecdsa_signature_parse_der</a>(ctx, &amp;sig, sigcder, <span class="keyword">sizeof</span>(sigcder)) == 1);</div>
<div class="line"><span class="lineno">  384</span>        <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1_8h.html#a7dd6acb7ef7100a6aebff91ecb7ede30">secp256k1_ecdsa_verify</a>(ctx, &amp;sig, msg32, &amp;pubkeyc) == 0);</div>
<div class="line"><span class="lineno">  385</span>    }</div>
<div class="line"><span class="lineno">  386</span>}</div>
<div class="ttc" id="asecp256k1_8h_html_a57d390dd5baa54855b0cb20628034b90"><div class="ttname"><a href="secp256k1_8h.html#a57d390dd5baa54855b0cb20628034b90">secp256k1_ecdsa_signature_parse_der</a></div><div class="ttdeci">SECP256K1_API int secp256k1_ecdsa_signature_parse_der(const secp256k1_context *ctx, secp256k1_ecdsa_signature *sig, const unsigned char *input, size_t inputlen) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3)</div><div class="ttdef"><b>Definition</b> <a href="secp256k1_8c_source.html#l00319">secp256k1.c:319</a></div></div>
<div class="ttc" id="asecp256k1_8h_html_a7dd6acb7ef7100a6aebff91ecb7ede30"><div class="ttname"><a href="secp256k1_8h.html#a7dd6acb7ef7100a6aebff91ecb7ede30">secp256k1_ecdsa_verify</a></div><div class="ttdeci">SECP256K1_API SECP256K1_WARN_UNUSED_RESULT int secp256k1_ecdsa_verify(const secp256k1_context *ctx, const secp256k1_ecdsa_signature *sig, const unsigned char *msghash32, const secp256k1_pubkey *pubkey) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3) SECP256K1_ARG_NONNULL(4)</div><div class="ttdef"><b>Definition</b> <a href="secp256k1_8c_source.html#l00400">secp256k1.c:400</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="recovery_2tests__impl_8h_ad6d3138600637a7c940bc40a22795e46_cgraph.png" border="0" usemap="#arecovery_2tests__impl_8h_ad6d3138600637a7c940bc40a22795e46_cgraph" alt=""/></div>
<map name="arecovery_2tests__impl_8h_ad6d3138600637a7c940bc40a22795e46_cgraph" id="arecovery_2tests__impl_8h_ad6d3138600637a7c940bc40a22795e46_cgraph">
<area shape="rect" title=" " alt="" coords="5,88,148,129"/>
<area shape="rect" href="recovery_2main__impl_8h.html#aa87f5523141f798e963300ccd975141d" title=" " alt="" coords="208,5,384,31"/>
<area shape="poly" title=" " alt="" coords="109,86,149,63,195,41,217,33,218,38,197,46,152,67,112,90"/>
<area shape="rect" href="recovery_2main__impl_8h.html#a37101568f72e98d7b29de6c6a825a289" title=" " alt="" coords="196,55,396,96"/>
<area shape="poly" title=" " alt="" coords="148,95,180,90,181,96,149,101"/>
<area shape="rect" href="secp256k1_8c.html#a7bd08fb7f758494d5011849b6ca0ef13" title=" " alt="" coords="203,120,389,161"/>
<area shape="poly" title=" " alt="" coords="149,117,188,122,187,128,148,122"/>
<area shape="rect" href="secp256k1_8c.html#abd11af3da8d88984e87ec8f06fb0087a" title=" " alt="" coords="213,185,378,211"/>
<area shape="poly" title=" " alt="" coords="112,127,152,150,197,170,219,178,217,183,195,175,149,154,109,132"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="444,63,512,88"/>
<area shape="poly" title=" " alt="" coords="355,29,397,41,433,54,431,59,395,46,354,34"/>
<area shape="poly" title=" " alt="" coords="396,73,429,73,429,78,396,78"/>
<area shape="poly" title=" " alt="" coords="360,117,395,105,429,92,431,97,397,110,361,122"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="recovery_2tests__impl_8h_ad6d3138600637a7c940bc40a22795e46_icgraph.png" border="0" usemap="#arecovery_2tests__impl_8h_ad6d3138600637a7c940bc40a22795e46_icgraph" alt=""/></div>
<map name="arecovery_2tests__impl_8h_ad6d3138600637a7c940bc40a22795e46_icgraph" id="arecovery_2tests__impl_8h_ad6d3138600637a7c940bc40a22795e46_icgraph">
<area shape="rect" title=" " alt="" coords="283,5,425,46"/>
<area shape="rect" href="recovery_2tests__impl_8h.html#a3a06f71955483e9502f3c408857407f2" title=" " alt="" coords="103,13,235,38"/>
<area shape="poly" title=" " alt="" coords="268,28,236,28,236,23,268,23"/>
<area shape="rect" href="tests_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title=" " alt="" coords="5,13,55,38"/>
<area shape="poly" title=" " alt="" coords="87,28,55,28,55,23,87,23"/>
</map>
</div>

</div>
</div>
<a id="a70649882936497184992dfaa06b1106f" name="a70649882936497184992dfaa06b1106f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a70649882936497184992dfaa06b1106f">&#9670;&#160;</a></span>test_ecdsa_recovery_end_to_end()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void test_ecdsa_recovery_end_to_end </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="recovery_2tests__impl_8h_source.html#l00156">156</a> of file <a class="el" href="recovery_2tests__impl_8h_source.html">tests_impl.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  156</span>                                          {</div>
<div class="line"><span class="lineno">  157</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> extra[32] = {0x00};</div>
<div class="line"><span class="lineno">  158</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> privkey[32];</div>
<div class="line"><span class="lineno">  159</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> message[32];</div>
<div class="line"><span class="lineno">  160</span>    <a class="code hl_struct" href="structsecp256k1__ecdsa__signature.html">secp256k1_ecdsa_signature</a> <a class="code hl_typedef" href="namespacefc_1_1ecc.html#a7c10bdf37d2fad7c122133f284e47f3e">signature</a>[5];</div>
<div class="line"><span class="lineno">  161</span>    <a class="code hl_struct" href="structsecp256k1__ecdsa__recoverable__signature.html">secp256k1_ecdsa_recoverable_signature</a> rsignature[5];</div>
<div class="line"><span class="lineno">  162</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> sig[74];</div>
<div class="line"><span class="lineno">  163</span>    <a class="code hl_struct" href="structsecp256k1__pubkey.html">secp256k1_pubkey</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a931987c85fd408a620505ee9a1aa6f58">pubkey</a>;</div>
<div class="line"><span class="lineno">  164</span>    <a class="code hl_struct" href="structsecp256k1__pubkey.html">secp256k1_pubkey</a> recpubkey;</div>
<div class="line"><span class="lineno">  165</span>    <span class="keywordtype">int</span> recid = 0;</div>
<div class="line"><span class="lineno">  166</span> </div>
<div class="line"><span class="lineno">  167</span>    <span class="comment">/* Generate a random key and message. */</span></div>
<div class="line"><span class="lineno">  168</span>    {</div>
<div class="line"><span class="lineno">  169</span>        <a class="code hl_struct" href="structsecp256k1__scalar.html">secp256k1_scalar</a> msg, <a class="code hl_variable" href="yubico__otp_8c.html#a9246c20bb98ad2b4c60313c053c70f08">key</a>;</div>
<div class="line"><span class="lineno">  170</span>        <a class="code hl_function" href="tests_8c.html#a51e09e6745e0afdb0d596ee0f4b3c3f7">random_scalar_order_test</a>(&amp;msg);</div>
<div class="line"><span class="lineno">  171</span>        <a class="code hl_function" href="tests_8c.html#a51e09e6745e0afdb0d596ee0f4b3c3f7">random_scalar_order_test</a>(&amp;key);</div>
<div class="line"><span class="lineno">  172</span>        secp256k1_scalar_get_b32(privkey, &amp;key);</div>
<div class="line"><span class="lineno">  173</span>        secp256k1_scalar_get_b32(message, &amp;msg);</div>
<div class="line"><span class="lineno">  174</span>    }</div>
<div class="line"><span class="lineno">  175</span> </div>
<div class="line"><span class="lineno">  176</span>    <span class="comment">/* Construct and verify corresponding public key. */</span></div>
<div class="line"><span class="lineno">  177</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1_8h.html#a366f922fc0c787351e82ff8e3a95f652">secp256k1_ec_seckey_verify</a>(ctx, privkey) == 1);</div>
<div class="line"><span class="lineno">  178</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1_8h.html#a7438071aa8a6dc4697abe4f4659f2161">secp256k1_ec_pubkey_create</a>(ctx, &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a931987c85fd408a620505ee9a1aa6f58">pubkey</a>, privkey) == 1);</div>
<div class="line"><span class="lineno">  179</span> </div>
<div class="line"><span class="lineno">  180</span>    <span class="comment">/* Serialize/parse compact and verify/recover. */</span></div>
<div class="line"><span class="lineno">  181</span>    extra[0] = 0;</div>
<div class="line"><span class="lineno">  182</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1__recovery_8h.html#a7868accd4760afcaeaa0ff3d239afc2a">secp256k1_ecdsa_sign_recoverable</a>(ctx, &amp;rsignature[0], message, privkey, NULL, NULL) == 1);</div>
<div class="line"><span class="lineno">  183</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1_8h.html#a4185cc9a9de502e52cfe5350f7dc8438">secp256k1_ecdsa_sign</a>(ctx, &amp;signature[0], message, privkey, NULL, NULL) == 1);</div>
<div class="line"><span class="lineno">  184</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1__recovery_8h.html#a7868accd4760afcaeaa0ff3d239afc2a">secp256k1_ecdsa_sign_recoverable</a>(ctx, &amp;rsignature[4], message, privkey, NULL, NULL) == 1);</div>
<div class="line"><span class="lineno">  185</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1__recovery_8h.html#a7868accd4760afcaeaa0ff3d239afc2a">secp256k1_ecdsa_sign_recoverable</a>(ctx, &amp;rsignature[1], message, privkey, NULL, extra) == 1);</div>
<div class="line"><span class="lineno">  186</span>    extra[31] = 1;</div>
<div class="line"><span class="lineno">  187</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1__recovery_8h.html#a7868accd4760afcaeaa0ff3d239afc2a">secp256k1_ecdsa_sign_recoverable</a>(ctx, &amp;rsignature[2], message, privkey, NULL, extra) == 1);</div>
<div class="line"><span class="lineno">  188</span>    extra[31] = 0;</div>
<div class="line"><span class="lineno">  189</span>    extra[0] = 1;</div>
<div class="line"><span class="lineno">  190</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1__recovery_8h.html#a7868accd4760afcaeaa0ff3d239afc2a">secp256k1_ecdsa_sign_recoverable</a>(ctx, &amp;rsignature[3], message, privkey, NULL, extra) == 1);</div>
<div class="line"><span class="lineno">  191</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1__recovery_8h.html#a12f08c89ceb61949c6a4ec6eb2511185">secp256k1_ecdsa_recoverable_signature_serialize_compact</a>(ctx, sig, &amp;recid, &amp;rsignature[4]) == 1);</div>
<div class="line"><span class="lineno">  192</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1__recovery_8h.html#ad7a20c9f7ccd9fc6d75a19a3b4195aa5">secp256k1_ecdsa_recoverable_signature_convert</a>(ctx, &amp;signature[4], &amp;rsignature[4]) == 1);</div>
<div class="line"><span class="lineno">  193</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(secp256k1_memcmp_var(&amp;signature[4], &amp;signature[0], 64) == 0);</div>
<div class="line"><span class="lineno">  194</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1_8h.html#a7dd6acb7ef7100a6aebff91ecb7ede30">secp256k1_ecdsa_verify</a>(ctx, &amp;signature[4], message, &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a931987c85fd408a620505ee9a1aa6f58">pubkey</a>) == 1);</div>
<div class="line"><span class="lineno">  195</span>    <a class="code hl_function" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105">memset</a>(&amp;rsignature[4], 0, <span class="keyword">sizeof</span>(rsignature[4]));</div>
<div class="line"><span class="lineno">  196</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1__recovery_8h.html#a6699b45dc75be70f028ac7d8ffaba46e">secp256k1_ecdsa_recoverable_signature_parse_compact</a>(ctx, &amp;rsignature[4], sig, recid) == 1);</div>
<div class="line"><span class="lineno">  197</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1__recovery_8h.html#ad7a20c9f7ccd9fc6d75a19a3b4195aa5">secp256k1_ecdsa_recoverable_signature_convert</a>(ctx, &amp;signature[4], &amp;rsignature[4]) == 1);</div>
<div class="line"><span class="lineno">  198</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1_8h.html#a7dd6acb7ef7100a6aebff91ecb7ede30">secp256k1_ecdsa_verify</a>(ctx, &amp;signature[4], message, &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a931987c85fd408a620505ee9a1aa6f58">pubkey</a>) == 1);</div>
<div class="line"><span class="lineno">  199</span>    <span class="comment">/* Parse compact (with recovery id) and recover. */</span></div>
<div class="line"><span class="lineno">  200</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1__recovery_8h.html#a6699b45dc75be70f028ac7d8ffaba46e">secp256k1_ecdsa_recoverable_signature_parse_compact</a>(ctx, &amp;rsignature[4], sig, recid) == 1);</div>
<div class="line"><span class="lineno">  201</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1__recovery_8h.html#af9f2082776bf8ebdb4c38161a211a02b">secp256k1_ecdsa_recover</a>(ctx, &amp;recpubkey, &amp;rsignature[4], message) == 1);</div>
<div class="line"><span class="lineno">  202</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(secp256k1_memcmp_var(&amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a931987c85fd408a620505ee9a1aa6f58">pubkey</a>, &amp;recpubkey, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a931987c85fd408a620505ee9a1aa6f58">pubkey</a>)) == 0);</div>
<div class="line"><span class="lineno">  203</span>    <span class="comment">/* Serialize/destroy/parse signature and verify again. */</span></div>
<div class="line"><span class="lineno">  204</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1__recovery_8h.html#a12f08c89ceb61949c6a4ec6eb2511185">secp256k1_ecdsa_recoverable_signature_serialize_compact</a>(ctx, sig, &amp;recid, &amp;rsignature[4]) == 1);</div>
<div class="line"><span class="lineno">  205</span>    sig[secp256k1_testrand_bits(6)] += 1 + secp256k1_testrand_int(255);</div>
<div class="line"><span class="lineno">  206</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1__recovery_8h.html#a6699b45dc75be70f028ac7d8ffaba46e">secp256k1_ecdsa_recoverable_signature_parse_compact</a>(ctx, &amp;rsignature[4], sig, recid) == 1);</div>
<div class="line"><span class="lineno">  207</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1__recovery_8h.html#ad7a20c9f7ccd9fc6d75a19a3b4195aa5">secp256k1_ecdsa_recoverable_signature_convert</a>(ctx, &amp;signature[4], &amp;rsignature[4]) == 1);</div>
<div class="line"><span class="lineno">  208</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1_8h.html#a7dd6acb7ef7100a6aebff91ecb7ede30">secp256k1_ecdsa_verify</a>(ctx, &amp;signature[4], message, &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a931987c85fd408a620505ee9a1aa6f58">pubkey</a>) == 0);</div>
<div class="line"><span class="lineno">  209</span>    <span class="comment">/* Recover again */</span></div>
<div class="line"><span class="lineno">  210</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="secp256k1__recovery_8h.html#af9f2082776bf8ebdb4c38161a211a02b">secp256k1_ecdsa_recover</a>(ctx, &amp;recpubkey, &amp;rsignature[4], message) == 0 ||</div>
<div class="line"><span class="lineno">  211</span>          secp256k1_memcmp_var(&amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a931987c85fd408a620505ee9a1aa6f58">pubkey</a>, &amp;recpubkey, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a931987c85fd408a620505ee9a1aa6f58">pubkey</a>)) != 0);</div>
<div class="line"><span class="lineno">  212</span>}</div>
<div class="ttc" id="anamespacefc_1_1ecc_html_a7c10bdf37d2fad7c122133f284e47f3e"><div class="ttname"><a href="namespacefc_1_1ecc.html#a7c10bdf37d2fad7c122133f284e47f3e">fc::ecc::signature</a></div><div class="ttdeci">fc::array&lt; char, 72 &gt; signature</div><div class="ttdef"><b>Definition</b> <a href="elliptic_8hpp_source.html#l00025">elliptic.hpp:25</a></div></div>
<div class="ttc" id="astructsecp256k1__scalar_html"><div class="ttname"><a href="structsecp256k1__scalar.html">secp256k1_scalar</a></div><div class="ttdef"><b>Definition</b> <a href="scalar__4x64_8h_source.html#l00013">scalar_4x64.h:13</a></div></div>
<div class="ttc" id="atests_8c_html_a51e09e6745e0afdb0d596ee0f4b3c3f7"><div class="ttname"><a href="tests_8c.html#a51e09e6745e0afdb0d596ee0f4b3c3f7">random_scalar_order_test</a></div><div class="ttdeci">void random_scalar_order_test(secp256k1_scalar *num)</div><div class="ttdef"><b>Definition</b> <a href="tests_8c_source.html#l00111">tests.c:111</a></div></div>
<div class="ttc" id="ayubico__otp_8c_html_a9246c20bb98ad2b4c60313c053c70f08"><div class="ttname"><a href="yubico__otp_8c.html#a9246c20bb98ad2b4c60313c053c70f08">key</a></div><div class="ttdeci">uint8_t key[16]</div><div class="ttdef"><b>Definition</b> <a href="yubico__otp_8c_source.html#l00041">yubico_otp.c:41</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_adc4bd59a60361844aa0e852efa210105"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105">memset</a></div><div class="ttdeci">memset(pInfo-&gt;slotDescription, ' ', 64)</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="recovery_2tests__impl_8h_a70649882936497184992dfaa06b1106f_cgraph.png" border="0" usemap="#arecovery_2tests__impl_8h_a70649882936497184992dfaa06b1106f_cgraph" alt=""/></div>
<map name="arecovery_2tests__impl_8h_a70649882936497184992dfaa06b1106f_cgraph" id="arecovery_2tests__impl_8h_a70649882936497184992dfaa06b1106f_cgraph">
<area shape="rect" title=" " alt="" coords="5,283,148,323"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="444,172,512,197"/>
<area shape="poly" title=" " alt="" coords="77,282,86,230,105,162,121,127,140,93,164,63,194,38,247,11,271,5,295,3,319,5,344,12,397,38,426,63,448,94,463,126,473,156,468,157,458,128,443,96,422,66,395,43,342,17,318,11,295,8,272,10,249,16,197,43,168,67,144,96,125,129,110,164,91,231,82,283"/>
<area shape="rect" href="tests_8c.html#a51e09e6745e0afdb0d596ee0f4b3c3f7" title=" " alt="" coords="210,53,382,79"/>
<area shape="poly" title=" " alt="" coords="81,282,94,241,117,189,150,135,171,110,194,89,202,84,205,88,197,93,174,114,154,138,122,191,99,243,86,283"/>
<area shape="rect" href="secp256k1_8c.html#ac5806cffd3278e64f863027eaa8e1284" title=" " alt="" coords="219,103,373,143"/>
<area shape="poly" title=" " alt="" coords="87,281,129,219,159,184,194,154,203,148,206,153,197,159,163,188,133,222,91,284"/>
<area shape="rect" href="secp256k1_8c.html#a6015346bdaee22c65e5ebca71693d9b1" title=" " alt="" coords="219,168,373,209"/>
<area shape="poly" title=" " alt="" coords="101,280,143,249,194,218,206,213,208,218,197,223,146,253,104,285"/>
<area shape="rect" href="recovery_2main__impl_8h.html#aa87f5523141f798e963300ccd975141d" title=" " alt="" coords="208,233,384,259"/>
<area shape="poly" title=" " alt="" coords="148,281,195,269,226,260,228,266,196,274,149,286"/>
<area shape="rect" href="recovery_2main__impl_8h.html#a16ddfc800140d761bc783e571c34548c" title=" " alt="" coords="196,283,396,323"/>
<area shape="poly" title=" " alt="" coords="148,300,180,300,180,306,148,306"/>
<area shape="rect" href="recovery_2main__impl_8h.html#a37101568f72e98d7b29de6c6a825a289" title=" " alt="" coords="196,348,396,389"/>
<area shape="poly" title=" " alt="" coords="148,321,211,341,210,346,146,327"/>
<area shape="rect" href="recovery_2main__impl_8h.html#ac122392fa6ff6264a7a110875af164b0" title=" " alt="" coords="196,413,396,454"/>
<area shape="poly" title=" " alt="" coords="100,322,143,360,197,398,210,405,208,409,194,403,139,365,96,326"/>
<area shape="rect" href="secp256k1_8c.html#af5ff5bb2cad5c58e90c653092648c63a" title=" " alt="" coords="217,478,374,504"/>
<area shape="poly" title=" " alt="" coords="89,322,106,354,129,392,160,431,197,464,207,469,204,474,194,468,156,435,125,395,101,357,85,325"/>
<area shape="rect" href="recovery_2main__impl_8h.html#a8c69d8d94dcf300ec40684a12f77092b" title=" " alt="" coords="217,528,374,569"/>
<area shape="poly" title=" " alt="" coords="86,323,100,364,123,415,155,469,175,493,197,514,205,520,202,524,194,518,171,497,151,472,118,418,95,366,81,325"/>
<area shape="rect" href="secp256k1_8c.html#abd11af3da8d88984e87ec8f06fb0087a" title=" " alt="" coords="213,593,378,619"/>
<area shape="poly" title=" " alt="" coords="83,323,93,375,113,444,128,481,147,517,170,550,197,578,203,583,200,587,194,582,166,553,142,520,123,483,108,446,88,376,78,324"/>
<area shape="poly" title=" " alt="" coords="360,142,397,154,430,165,428,170,395,159,359,147"/>
<area shape="poly" title=" " alt="" coords="355,230,395,218,435,202,437,207,397,223,357,235"/>
<area shape="poly" title=" " alt="" coords="376,345,394,333,420,305,440,273,466,211,471,213,445,275,424,308,398,337,379,350"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="recovery_2tests__impl_8h_a70649882936497184992dfaa06b1106f_icgraph.png" border="0" usemap="#arecovery_2tests__impl_8h_a70649882936497184992dfaa06b1106f_icgraph" alt=""/></div>
<map name="arecovery_2tests__impl_8h_a70649882936497184992dfaa06b1106f_icgraph" id="arecovery_2tests__impl_8h_a70649882936497184992dfaa06b1106f_icgraph">
<area shape="rect" title=" " alt="" coords="283,5,425,46"/>
<area shape="rect" href="recovery_2tests__impl_8h.html#a3a06f71955483e9502f3c408857407f2" title=" " alt="" coords="103,13,235,38"/>
<area shape="poly" title=" " alt="" coords="268,28,236,28,236,23,268,23"/>
<area shape="rect" href="tests_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title=" " alt="" coords="5,13,55,38"/>
<area shape="poly" title=" " alt="" coords="87,28,55,28,55,23,87,23"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_428556e0652617aa37d2f7d8bcaf7fdf.html">libraries</a></li><li class="navelem"><a class="el" href="dir_71436f1774b2d89f0b80ac9efd482f1f.html">fc</a></li><li class="navelem"><a class="el" href="dir_a52e6239a5b2b3d02315cec608665301.html">secp256k1</a></li><li class="navelem"><a class="el" href="dir_d7bc7c582256a3e7079a332367360a08.html">secp256k1</a></li><li class="navelem"><a class="el" href="dir_161a7c3b899da95666bc0894eb81449b.html">src</a></li><li class="navelem"><a class="el" href="dir_61a25fd2e6e959c1219ac7fc9980d17d.html">modules</a></li><li class="navelem"><a class="el" href="dir_7098ef9b115f266c8f199c2187e635ee.html">recovery</a></li><li class="navelem"><a class="el" href="recovery_2tests__impl_8h.html">tests_impl.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0 </li>
  </ul>
</div>
</body>
</html>
