\doxysection{create\+\_\+deltas.\+cpp}
\hypertarget{create__deltas_8cpp_source}{}\label{create__deltas_8cpp_source}\index{libraries/state\_history/create\_deltas.cpp@{libraries/state\_history/create\_deltas.cpp}}
\mbox{\hyperlink{create__deltas_8cpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00001}00001\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{create__deltas_8hpp}{sysio/state\_history/create\_deltas.hpp}}>}}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00002}00002\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{state__history_2include_2sysio_2state__history_2serialization_8hpp}{sysio/state\_history/serialization.hpp}}>}}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00003}00003\ }
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00004}00004\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacesysio}{sysio}}\ \{}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00005}00005\ \textcolor{keyword}{namespace\ }state\_history\ \{}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00006}00006\ }
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00007}00007\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00008}\mbox{\hyperlink{namespacesysio_1_1state__history_a7297e6b09d82cabc24f7231b09fdf14a}{00008}}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{namespacesysio_1_1state__history_a7297e6b09d82cabc24f7231b09fdf14a}{include\_delta}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{prettywritertest_8cpp_a6283df8c4e365cc8a01727e2d7ad44bf}{T}}\&\ old,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{prettywritertest_8cpp_a6283df8c4e365cc8a01727e2d7ad44bf}{T}}\&\ curr)\ \{}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00009}00009\ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00010}00010\ \}}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00011}00011\ }
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00012}\mbox{\hyperlink{namespacesysio_1_1state__history_a9aa62de9d68ebae6a40816a55b928e07}{00012}}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{namespacesysio_1_1state__history_a7297e6b09d82cabc24f7231b09fdf14a}{include\_delta}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classsysio_1_1chain_1_1table__id__object}{chain::table\_id\_object}}\&\ old,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classsysio_1_1chain_1_1table__id__object}{chain::table\_id\_object}}\&\ curr)\ \{}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00013}00013\ \ \ \ \textcolor{keywordflow}{return}\ old.payer\ !=\ curr.payer;}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00014}00014\ \}}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00015}00015\ }
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00016}\mbox{\hyperlink{namespacesysio_1_1state__history_ab398df574c5103e7fd21debde64ec0ee}{00016}}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{namespacesysio_1_1state__history_a7297e6b09d82cabc24f7231b09fdf14a}{include\_delta}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structsysio_1_1chain_1_1resource__limits_1_1resource__limits__object}{chain::resource\_limits::resource\_limits\_object}}\&\ old,}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00017}00017\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structsysio_1_1chain_1_1resource__limits_1_1resource__limits__object}{chain::resource\_limits::resource\_limits\_object}}\&\ curr)\ \{}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00018}00018\ \ \ \ \textcolor{keywordflow}{return}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00019}00019\ \ \ \ \ \ \ \ old.\mbox{\hyperlink{structsysio_1_1chain_1_1resource__limits_1_1resource__limits__object_a9eaec91376588de2dd82766e23750f87}{net\_weight}}\ !=\ curr.\mbox{\hyperlink{structsysio_1_1chain_1_1resource__limits_1_1resource__limits__object_a9eaec91376588de2dd82766e23750f87}{net\_weight}}\ ||\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00020}00020\ \ \ \ \ \ \ \ old.\mbox{\hyperlink{structsysio_1_1chain_1_1resource__limits_1_1resource__limits__object_aaeaa8f4c3c9e4cd8c823ecb22cc3f982}{cpu\_weight}}\ !=\ curr.\mbox{\hyperlink{structsysio_1_1chain_1_1resource__limits_1_1resource__limits__object_aaeaa8f4c3c9e4cd8c823ecb22cc3f982}{cpu\_weight}}\ ||\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00021}00021\ \ \ \ \ \ \ \ old.\mbox{\hyperlink{structsysio_1_1chain_1_1resource__limits_1_1resource__limits__object_a7e7945f847d9e441e69f938921270836}{ram\_bytes}}\ !=\ curr.\mbox{\hyperlink{structsysio_1_1chain_1_1resource__limits_1_1resource__limits__object_a7e7945f847d9e441e69f938921270836}{ram\_bytes}};}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00022}00022\ \}}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00023}00023\ }
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00024}\mbox{\hyperlink{namespacesysio_1_1state__history_ab354d08ce3577c51e35780853ec6b25f}{00024}}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{namespacesysio_1_1state__history_a7297e6b09d82cabc24f7231b09fdf14a}{include\_delta}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classsysio_1_1chain_1_1resource__limits_1_1resource__limits__state__object}{chain::resource\_limits::resource\_limits\_state\_object}}\&\ old,}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00025}00025\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classsysio_1_1chain_1_1resource__limits_1_1resource__limits__state__object}{chain::resource\_limits::resource\_limits\_state\_object}}\&\ curr)\ \{}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00026}00026\ \ \ \ \textcolor{keywordflow}{return}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00027}00027\ \ \ \ \ \ \ \ old.average\_block\_net\_usage.\mbox{\hyperlink{structsysio_1_1chain_1_1resource__limits_1_1impl_1_1exponential__moving__average__accumulator_a71318b93d001293944aa2edb7413e30f}{last\_ordinal}}\ !=\ curr.average\_block\_net\_usage.\mbox{\hyperlink{structsysio_1_1chain_1_1resource__limits_1_1impl_1_1exponential__moving__average__accumulator_a71318b93d001293944aa2edb7413e30f}{last\_ordinal}}\ ||\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00028}00028\ \ \ \ \ \ \ \ old.average\_block\_net\_usage.\mbox{\hyperlink{structsysio_1_1chain_1_1resource__limits_1_1impl_1_1exponential__moving__average__accumulator_a287aeeff9e2c62aae2ea1f2860e50a32}{value\_ex}}\ !=\ curr.average\_block\_net\_usage.\mbox{\hyperlink{structsysio_1_1chain_1_1resource__limits_1_1impl_1_1exponential__moving__average__accumulator_a287aeeff9e2c62aae2ea1f2860e50a32}{value\_ex}}\ ||\ \ \ \ \ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00029}00029\ \ \ \ \ \ \ \ old.average\_block\_net\_usage.\mbox{\hyperlink{structsysio_1_1chain_1_1resource__limits_1_1impl_1_1exponential__moving__average__accumulator_a10942e33869aa60d5b644aa3da2e366b}{consumed}}\ !=\ curr.average\_block\_net\_usage.\mbox{\hyperlink{structsysio_1_1chain_1_1resource__limits_1_1impl_1_1exponential__moving__average__accumulator_a10942e33869aa60d5b644aa3da2e366b}{consumed}}\ ||\ \ \ \ \ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00030}00030\ \ \ \ \ \ \ \ old.average\_block\_cpu\_usage.\mbox{\hyperlink{structsysio_1_1chain_1_1resource__limits_1_1impl_1_1exponential__moving__average__accumulator_a71318b93d001293944aa2edb7413e30f}{last\_ordinal}}\ !=\ curr.average\_block\_cpu\_usage.\mbox{\hyperlink{structsysio_1_1chain_1_1resource__limits_1_1impl_1_1exponential__moving__average__accumulator_a71318b93d001293944aa2edb7413e30f}{last\_ordinal}}\ ||\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00031}00031\ \ \ \ \ \ \ \ old.average\_block\_cpu\_usage.\mbox{\hyperlink{structsysio_1_1chain_1_1resource__limits_1_1impl_1_1exponential__moving__average__accumulator_a287aeeff9e2c62aae2ea1f2860e50a32}{value\_ex}}\ !=\ curr.average\_block\_cpu\_usage.\mbox{\hyperlink{structsysio_1_1chain_1_1resource__limits_1_1impl_1_1exponential__moving__average__accumulator_a287aeeff9e2c62aae2ea1f2860e50a32}{value\_ex}}\ ||\ \ \ \ \ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00032}00032\ \ \ \ \ \ \ \ old.average\_block\_cpu\_usage.\mbox{\hyperlink{structsysio_1_1chain_1_1resource__limits_1_1impl_1_1exponential__moving__average__accumulator_a10942e33869aa60d5b644aa3da2e366b}{consumed}}\ !=\ curr.average\_block\_cpu\_usage.\mbox{\hyperlink{structsysio_1_1chain_1_1resource__limits_1_1impl_1_1exponential__moving__average__accumulator_a10942e33869aa60d5b644aa3da2e366b}{consumed}}\ ||\ \ \ \ \ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00033}00033\ \ \ \ \ \ \ \ old.total\_net\_weight\ !=\ curr.total\_net\_weight\ ||\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00034}00034\ \ \ \ \ \ \ \ old.total\_cpu\_weight\ !=\ curr.total\_cpu\_weight\ ||\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00035}00035\ \ \ \ \ \ \ \ old.total\_ram\_bytes\ !=\ curr.total\_ram\_bytes\ ||\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00036}00036\ \ \ \ \ \ \ \ old.virtual\_net\_limit\ !=\ curr.virtual\_net\_limit\ ||\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00037}00037\ \ \ \ \ \ \ \ old.virtual\_cpu\_limit\ !=\ curr.virtual\_cpu\_limit;}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00038}00038\ \}}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00039}00039\ }
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00040}\mbox{\hyperlink{namespacesysio_1_1state__history_a58921fbf0e9665770c7b3a695d2df8cd}{00040}}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{namespacesysio_1_1state__history_a7297e6b09d82cabc24f7231b09fdf14a}{include\_delta}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classsysio_1_1chain_1_1account__metadata__object}{chain::account\_metadata\_object}}\&\ old,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classsysio_1_1chain_1_1account__metadata__object}{chain::account\_metadata\_object}}\&\ curr)\ \{}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00041}00041\ \ \ \ \textcolor{keywordflow}{return}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00042}00042\ \ \ \ \ \ \ \ old.name\ !=\ curr.name\ ||\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00043}00043\ \ \ \ \ \ \ \ old.is\_privileged()\ !=\ curr.is\_privileged()\ ||\ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00044}00044\ \ \ \ \ \ \ \ old.last\_code\_update\ !=\ curr.last\_code\_update\ ||\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00045}00045\ \ \ \ \ \ \ \ old.vm\_type\ !=\ curr.vm\_type\ ||\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00046}00046\ \ \ \ \ \ \ \ old.vm\_version\ !=\ curr.vm\_version\ ||\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00047}00047\ \ \ \ \ \ \ \ old.code\_hash\ !=\ curr.code\_hash;}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00048}00048\ \}}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00049}00049\ }
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00050}\mbox{\hyperlink{namespacesysio_1_1state__history_a0a3e79f324afc8a501a9778d80cec968}{00050}}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{namespacesysio_1_1state__history_a7297e6b09d82cabc24f7231b09fdf14a}{include\_delta}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classsysio_1_1chain_1_1code__object}{chain::code\_object}}\&\ old,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classsysio_1_1chain_1_1code__object}{chain::code\_object}}\&\ curr)\ \{\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00051}00051\ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00052}00052\ \}}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00053}00053\ }
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00054}\mbox{\hyperlink{namespacesysio_1_1state__history_ad7e684e78494225a5ea390d4a2cb88db}{00054}}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{namespacesysio_1_1state__history_a7297e6b09d82cabc24f7231b09fdf14a}{include\_delta}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classsysio_1_1chain_1_1protocol__state__object}{chain::protocol\_state\_object}}\&\ old,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classsysio_1_1chain_1_1protocol__state__object}{chain::protocol\_state\_object}}\&\ curr)\ \{}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00055}00055\ \ \ \ \textcolor{keywordflow}{return}\ old.\mbox{\hyperlink{classsysio_1_1chain_1_1protocol__state__object_ae9694b005b07756cdb14eadf6f09a0af}{activated\_protocol\_features}}\ !=\ curr.\mbox{\hyperlink{classsysio_1_1chain_1_1protocol__state__object_ae9694b005b07756cdb14eadf6f09a0af}{activated\_protocol\_features}};}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00056}00056\ \}}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00057}00057\ }
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00058}\mbox{\hyperlink{namespacesysio_1_1state__history_a4672b7cf25419ada24cf1366ef85687d}{00058}}\ std::vector<table\_delta>\ \mbox{\hyperlink{namespacesysio_1_1state__history_a4672b7cf25419ada24cf1366ef85687d}{create\_deltas}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classchainbase_1_1database}{chainbase::database}}\&\ db,\ \textcolor{keywordtype}{bool}\ full\_snapshot)\ \{}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00059}00059\ \ \ \ std::vector<table\_delta>\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ deltas;}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00060}00060\ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ table\_id\_index\ =\ db.\mbox{\hyperlink{classchainbase_1_1database_a4d5297635dcf70be481d9b600da9bc13}{get\_index}}<\mbox{\hyperlink{namespacesysio_1_1chain_aacd8d660fd83146e0a5d6a9cb7b19a29}{chain::table\_id\_multi\_index}}>();}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00061}00061\ \ \ \ std::map<uint64\_t,\ const\ chain::table\_id\_object*>\ removed\_table\_id;}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00062}00062\ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\&\ rem\ :\ table\_id\_index.last\_undo\_session().removed\_values)}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00063}00063\ \ \ \ \ \ \ removed\_table\_id[rem.id.\_id]\ =\ \&rem;}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00064}00064\ }
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00065}00065\ \ \ \ \textcolor{keyword}{auto}\ get\_table\_id\ =\ [\&](\mbox{\hyperlink{stdint_8h_aec6fcb673ff035718c238c8c9d544c47}{uint64\_t}}\ tid)\ -\/>\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classsysio_1_1chain_1_1table__id__object}{chain::table\_id\_object}}\&\ \{}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00066}00066\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ obj\ =\ table\_id\_index.find(tid);}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00067}00067\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (obj)}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00068}00068\ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ *obj;}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00069}00069\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ it\ =\ removed\_table\_id.find(tid);}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00070}00070\ \ \ \ \ \ \ \mbox{\hyperlink{chain_2include_2sysio_2chain_2exceptions_8hpp_a40c2826a6fba35c1ffbf912bdf559792}{SYS\_ASSERT}}(it\ !=\ removed\_table\_id.end(),\ chain::plugin\_exception,\ \textcolor{stringliteral}{"{}can\ not\ found\ table\ id\ \$\{tid\}"{}},\ (\textcolor{stringliteral}{"{}tid"{}},\ tid));}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00071}00071\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ *it-\/>second;}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00072}00072\ \ \ \ \};}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00073}00073\ }
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00074}00074\ \ \ \ \textcolor{keyword}{auto}\ pack\_row\ \ \ \ \ \ \ \ \ \ =\ [\&](\textcolor{keyword}{auto}\&\ row)\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacefc_1_1raw_a3a18d8161aa5b4f4f02b6fcfdff5e5d1}{fc::raw::pack}}(\mbox{\hyperlink{state__history_2include_2sysio_2state__history_2serialization_8hpp_aeef58505371e2c7f9376d471c9719fa1}{make\_history\_serial\_wrapper}}(db,\ row));\ \};}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00075}00075\ \ \ \ \textcolor{keyword}{auto}\ pack\_contract\_row\ =\ [\&](\textcolor{keyword}{auto}\&\ row)\ \{}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00076}00076\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacefc_1_1raw_a3a18d8161aa5b4f4f02b6fcfdff5e5d1}{fc::raw::pack}}(\mbox{\hyperlink{state__history_2include_2sysio_2state__history_2serialization_8hpp_a8919e19ccc221814a4ea1632ee94d0fc}{make\_history\_context\_wrapper}}(db,\ get\_table\_id(row.t\_id.\_id),\ row));}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00077}00077\ \ \ \ \};}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00078}00078\ }
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00079}00079\ \ \ \ \textcolor{keyword}{auto}\ process\_table\ =\ [\&](\textcolor{keyword}{auto}*\ \mbox{\hyperlink{catch__reporter__console_8cpp_a9b45b3e13bd9167aab02e17e08916231}{name}},\ \textcolor{keyword}{auto}\&\ index,\ \textcolor{keyword}{auto}\&\ pack\_row)\ \{}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00080}00080\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (full\_snapshot)\ \{}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00081}00081\ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (index.indices().empty())}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00082}00082\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00083}00083\ \ \ \ \ \ \ \ \ \ deltas.push\_back(\{\});}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00084}00084\ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\&\ delta\ =\ deltas.back();}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00085}00085\ \ \ \ \ \ \ \ \ \ delta.name\ \ =\ \mbox{\hyperlink{catch__reporter__console_8cpp_a9b45b3e13bd9167aab02e17e08916231}{name}};}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00086}00086\ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\&\ row\ :\ index.indices())}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00087}00087\ \ \ \ \ \ \ \ \ \ \ \ \ delta.rows.obj.emplace\_back(\textcolor{keyword}{true},\ pack\_row(row));}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00088}00088\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00089}00089\ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ undo\ =\ index.last\_undo\_session();}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00090}00090\ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (undo.old\_values.empty()\ \&\&\ undo.new\_values.empty()\ \&\&\ undo.removed\_values.empty())}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00091}00091\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00092}00092\ \ \ \ \ \ \ \ \ \ deltas.push\_back(\{\});}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00093}00093\ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\&\ delta\ =\ deltas.back();}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00094}00094\ \ \ \ \ \ \ \ \ \ delta.name\ \ =\ \mbox{\hyperlink{catch__reporter__console_8cpp_a9b45b3e13bd9167aab02e17e08916231}{name}};}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00095}00095\ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\&\ old\ :\ undo.old\_values)\ \{}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00096}00096\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\&\ row\ =\ index.get(old.id);}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00097}00097\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesysio_1_1state__history_a7297e6b09d82cabc24f7231b09fdf14a}{include\_delta}}(old,\ row))}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00098}00098\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ delta.rows.obj.emplace\_back(\textcolor{keyword}{true},\ pack\_row(row));}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00099}00099\ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00100}00100\ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\&\ old\ :\ undo.removed\_values)}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00101}00101\ \ \ \ \ \ \ \ \ \ \ \ \ delta.rows.obj.emplace\_back(\textcolor{keyword}{false},\ pack\_row(old));}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00102}00102\ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\&\ row\ :\ undo.new\_values)\ \{}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00103}00103\ \ \ \ \ \ \ \ \ \ \ \ \ delta.rows.obj.emplace\_back(\textcolor{keyword}{true},\ pack\_row(row));}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00104}00104\ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00105}00105\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00106}00106\ \ \ \ \};}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00107}00107\ }
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00108}00108\ \ \ \ process\_table(\textcolor{stringliteral}{"{}account"{}},\ db.\mbox{\hyperlink{classchainbase_1_1database_a4d5297635dcf70be481d9b600da9bc13}{get\_index}}<\mbox{\hyperlink{namespacesysio_1_1chain_a1736163b16f1771314cd01a1208621c7}{chain::account\_index}}>(),\ pack\_row);}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00109}00109\ \ \ \ process\_table(\textcolor{stringliteral}{"{}account\_metadata"{}},\ db.\mbox{\hyperlink{classchainbase_1_1database_a4d5297635dcf70be481d9b600da9bc13}{get\_index}}<\mbox{\hyperlink{namespacesysio_1_1chain_aeced8cdafcddda68b18c6c579dea0cc1}{chain::account\_metadata\_index}}>(),\ pack\_row);}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00110}00110\ \ \ \ process\_table(\textcolor{stringliteral}{"{}code"{}},\ db.\mbox{\hyperlink{classchainbase_1_1database_a4d5297635dcf70be481d9b600da9bc13}{get\_index}}<\mbox{\hyperlink{namespacesysio_1_1chain_a0f69872bbb285f6f90ff8b5e30ef6aa8}{chain::code\_index}}>(),\ pack\_row);}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00111}00111\ }
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00112}00112\ \ \ \ process\_table(\textcolor{stringliteral}{"{}contract\_table"{}},\ db.\mbox{\hyperlink{classchainbase_1_1database_a4d5297635dcf70be481d9b600da9bc13}{get\_index}}<\mbox{\hyperlink{namespacesysio_1_1chain_aacd8d660fd83146e0a5d6a9cb7b19a29}{chain::table\_id\_multi\_index}}>(),\ pack\_row);}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00113}00113\ \ \ \ process\_table(\textcolor{stringliteral}{"{}contract\_row"{}},\ db.\mbox{\hyperlink{classchainbase_1_1database_a4d5297635dcf70be481d9b600da9bc13}{get\_index}}<\mbox{\hyperlink{namespacesysio_1_1chain_aac1a2c1330fcb6c8002d59d4d1de5858}{chain::key\_value\_index}}>(),\ pack\_contract\_row);}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00114}00114\ \ \ \ process\_table(\textcolor{stringliteral}{"{}contract\_index64"{}},\ db.\mbox{\hyperlink{classchainbase_1_1database_a4d5297635dcf70be481d9b600da9bc13}{get\_index}}<\mbox{\hyperlink{namespacesysio_1_1chain_a6575ee303f00a9488efc0e9c0614c62e}{chain::index64\_index}}>(),\ pack\_contract\_row);}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00115}00115\ \ \ \ process\_table(\textcolor{stringliteral}{"{}contract\_index128"{}},\ db.\mbox{\hyperlink{classchainbase_1_1database_a4d5297635dcf70be481d9b600da9bc13}{get\_index}}<\mbox{\hyperlink{namespacesysio_1_1chain_a3aa50d622507be5b1de392b4aae55b0d}{chain::index128\_index}}>(),\ pack\_contract\_row);}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00116}00116\ \ \ \ process\_table(\textcolor{stringliteral}{"{}contract\_index256"{}},\ db.\mbox{\hyperlink{classchainbase_1_1database_a4d5297635dcf70be481d9b600da9bc13}{get\_index}}<\mbox{\hyperlink{namespacesysio_1_1chain_a8e9186f3a170838216f0535ee44b6d7b}{chain::index256\_index}}>(),\ pack\_contract\_row);}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00117}00117\ \ \ \ process\_table(\textcolor{stringliteral}{"{}contract\_index\_double"{}},\ db.\mbox{\hyperlink{classchainbase_1_1database_a4d5297635dcf70be481d9b600da9bc13}{get\_index}}<\mbox{\hyperlink{namespacesysio_1_1chain_a613ce5969969e88f01eba861173d2b1b}{chain::index\_double\_index}}>(),\ pack\_contract\_row);}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00118}00118\ \ \ \ process\_table(\textcolor{stringliteral}{"{}contract\_index\_long\_double"{}},\ db.\mbox{\hyperlink{classchainbase_1_1database_a4d5297635dcf70be481d9b600da9bc13}{get\_index}}<\mbox{\hyperlink{namespacesysio_1_1chain_afd7252a1e9677ed6c7762531cc275f41}{chain::index\_long\_double\_index}}>(),\ pack\_contract\_row);}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00119}00119\ }
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00120}00120\ \ \ \ process\_table(\textcolor{stringliteral}{"{}global\_property"{}},\ db.\mbox{\hyperlink{classchainbase_1_1database_a4d5297635dcf70be481d9b600da9bc13}{get\_index}}<\mbox{\hyperlink{namespacesysio_1_1chain_a0612ad4956bca2a7b23f9a14e2b32106}{chain::global\_property\_multi\_index}}>(),\ pack\_row);}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00121}00121\ \ \ \ process\_table(\textcolor{stringliteral}{"{}generated\_transaction"{}},\ db.\mbox{\hyperlink{classchainbase_1_1database_a4d5297635dcf70be481d9b600da9bc13}{get\_index}}<\mbox{\hyperlink{namespacesysio_1_1chain_a9e9842ee49526c2423e014a696edc602}{chain::generated\_transaction\_multi\_index}}>(),\ pack\_row);}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00122}00122\ \ \ \ process\_table(\textcolor{stringliteral}{"{}protocol\_state"{}},\ db.\mbox{\hyperlink{classchainbase_1_1database_a4d5297635dcf70be481d9b600da9bc13}{get\_index}}<\mbox{\hyperlink{namespacesysio_1_1chain_ab03689aa0bc2fbf321d7644f838f23a5}{chain::protocol\_state\_multi\_index}}>(),\ pack\_row);}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00123}00123\ }
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00124}00124\ \ \ \ process\_table(\textcolor{stringliteral}{"{}permission"{}},\ db.\mbox{\hyperlink{classchainbase_1_1database_a4d5297635dcf70be481d9b600da9bc13}{get\_index}}<\mbox{\hyperlink{namespacesysio_1_1chain_a4e24a1668746342d40487d1019880986}{chain::permission\_index}}>(),\ pack\_row);}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00125}00125\ \ \ \ process\_table(\textcolor{stringliteral}{"{}permission\_link"{}},\ db.\mbox{\hyperlink{classchainbase_1_1database_a4d5297635dcf70be481d9b600da9bc13}{get\_index}}<\mbox{\hyperlink{namespacesysio_1_1chain_a255011fa21760c6c73a1187a23d0afd1}{chain::permission\_link\_index}}>(),\ pack\_row);}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00126}00126\ }
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00127}00127\ \ \ \ process\_table(\textcolor{stringliteral}{"{}resource\_limits"{}},\ db.\mbox{\hyperlink{classchainbase_1_1database_a4d5297635dcf70be481d9b600da9bc13}{get\_index}}<\mbox{\hyperlink{namespacesysio_1_1chain_1_1resource__limits_a46a650001834ee5948b425f2e83cf948}{chain::resource\_limits::resource\_limits\_index}}>(),\ pack\_row);}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00128}00128\ \ \ \ process\_table(\textcolor{stringliteral}{"{}resource\_usage"{}},\ db.\mbox{\hyperlink{classchainbase_1_1database_a4d5297635dcf70be481d9b600da9bc13}{get\_index}}<\mbox{\hyperlink{namespacesysio_1_1chain_1_1resource__limits_a0b3297439198d69fd3b3bb4cb9eefa6d}{chain::resource\_limits::resource\_usage\_index}}>(),\ pack\_row);}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00129}00129\ \ \ \ process\_table(\textcolor{stringliteral}{"{}resource\_limits\_state"{}},\ db.\mbox{\hyperlink{classchainbase_1_1database_a4d5297635dcf70be481d9b600da9bc13}{get\_index}}<\mbox{\hyperlink{namespacesysio_1_1chain_1_1resource__limits_ac8c3fe48e6c4c00d12cb2f55913798ca}{chain::resource\_limits::resource\_limits\_state\_index}}>(),}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00130}00130\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pack\_row);}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00131}00131\ \ \ \ process\_table(\textcolor{stringliteral}{"{}resource\_limits\_config"{}},\ db.\mbox{\hyperlink{classchainbase_1_1database_a4d5297635dcf70be481d9b600da9bc13}{get\_index}}<\mbox{\hyperlink{namespacesysio_1_1chain_1_1resource__limits_af0e92e61b12c4eb0ff352f44ca9fbe09}{chain::resource\_limits::resource\_limits\_config\_index}}>(),}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00132}00132\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pack\_row);}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00133}00133\ }
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00134}00134\ \ \ \ \textcolor{keywordflow}{return}\ deltas;}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00135}00135\ \}}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00136}00136\ }
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00137}00137\ \}\ \textcolor{comment}{//\ namespace\ state\_history}}
\DoxyCodeLine{\Hypertarget{create__deltas_8cpp_source_l00138}00138\ \}\ \textcolor{comment}{//\ namespace\ sysio}}

\end{DoxyCode}
