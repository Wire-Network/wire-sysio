\doxysection{websocketpp\+::processor Namespace Reference}
\hypertarget{namespacewebsocketpp_1_1processor}{}\label{namespacewebsocketpp_1_1processor}\index{websocketpp::processor@{websocketpp::processor}}


Processors encapsulate the protocol rules specific to each Web\+Socket version.  


\doxysubsubsection*{Namespaces}
\begin{DoxyCompactItemize}
\item 
namespace \mbox{\hyperlink{namespacewebsocketpp_1_1processor_1_1constants}{constants}}
\begin{DoxyCompactList}\small\item\em Constants related to processing Web\+Socket connections. \end{DoxyCompactList}\item 
namespace \mbox{\hyperlink{namespacewebsocketpp_1_1processor_1_1error}{error}}
\begin{DoxyCompactList}\small\item\em Error code category and codes used by all processor types. \end{DoxyCompactList}\item 
namespace \mbox{\hyperlink{namespacewebsocketpp_1_1processor_1_1error__cat}{error\+\_\+cat}}
\begin{DoxyCompactList}\small\item\em Processor class related error codes. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class \mbox{\hyperlink{classwebsocketpp_1_1processor_1_1hybi00}{hybi00}}
\begin{DoxyCompactList}\small\item\em Processor for Hybi Draft version 00. \end{DoxyCompactList}\item 
class \mbox{\hyperlink{classwebsocketpp_1_1processor_1_1hybi07}{hybi07}}
\begin{DoxyCompactList}\small\item\em Processor for Hybi Draft version 07. \end{DoxyCompactList}\item 
class \mbox{\hyperlink{classwebsocketpp_1_1processor_1_1hybi08}{hybi08}}
\begin{DoxyCompactList}\small\item\em Processor for Hybi Draft version 08. \end{DoxyCompactList}\item 
class \mbox{\hyperlink{classwebsocketpp_1_1processor_1_1hybi13}{hybi13}}
\begin{DoxyCompactList}\small\item\em Processor for Hybi version 13 (RFC6455) \end{DoxyCompactList}\item 
class \mbox{\hyperlink{classwebsocketpp_1_1processor_1_1processor}{processor}}
\begin{DoxyCompactList}\small\item\em Web\+Socket protocol processor abstract base class. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
{\footnotesize template$<$typename request\+\_\+type $>$ }\\bool \mbox{\hyperlink{namespacewebsocketpp_1_1processor_a9ff3159b48cf4be2e7cb79c81b155d53}{is\+\_\+websocket\+\_\+handshake}} (request\+\_\+type \&\mbox{\hyperlink{bn_8cpp_af0a5201ca8846f05f25435b41d7f39f7}{r}})
\begin{DoxyCompactList}\small\item\em Determine whether or not a generic HTTP request is a Web\+Socket handshake. \end{DoxyCompactList}\item 
{\footnotesize template$<$typename request\+\_\+type $>$ }\\int \mbox{\hyperlink{namespacewebsocketpp_1_1processor_a1a0e5e7b10b24ff5ab836dc543826934}{get\+\_\+websocket\+\_\+version}} (request\+\_\+type \&\mbox{\hyperlink{bn_8cpp_af0a5201ca8846f05f25435b41d7f39f7}{r}})
\begin{DoxyCompactList}\small\item\em Extract the version from a Web\+Socket handshake request. \end{DoxyCompactList}\item 
{\footnotesize template$<$typename request\+\_\+type $>$ }\\\mbox{\hyperlink{namespacewebsocketpp_aae370ea5ac83a8ece7712cb39fc23f5b}{uri\+\_\+ptr}} \mbox{\hyperlink{namespacewebsocketpp_1_1processor_a5fa80687521dc24678e773fc3e71e0ce}{get\+\_\+uri\+\_\+from\+\_\+host}} (request\+\_\+type \&request, std\+::string scheme)
\begin{DoxyCompactList}\small\item\em Extract a URI ptr from the host header of the request. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
The processors namespace includes a number of free functions that operate on various Web\+Socket related data structures and perform processing that is not related to specific versions of the protocol.

It also includes the abstract interface for the protocol specific processing engines. These engines wrap all of the logic necessary for parsing and validating Web\+Socket handshakes and messages of specific protocol version and set of allowed extensions.

An instance of a processor represents the state of a single Web\+Socket connection of the associated version. One processor instance is needed per logical Web\+Socket connection. 

\doxysubsection{Function Documentation}
\Hypertarget{namespacewebsocketpp_1_1processor_a5fa80687521dc24678e773fc3e71e0ce}\index{websocketpp::processor@{websocketpp::processor}!get\_uri\_from\_host@{get\_uri\_from\_host}}
\index{get\_uri\_from\_host@{get\_uri\_from\_host}!websocketpp::processor@{websocketpp::processor}}
\doxysubsubsection{\texorpdfstring{get\_uri\_from\_host()}{get\_uri\_from\_host()}}
{\footnotesize\ttfamily \label{namespacewebsocketpp_1_1processor_a5fa80687521dc24678e773fc3e71e0ce} 
template$<$typename request\+\_\+type $>$ \\
\mbox{\hyperlink{namespacewebsocketpp_aae370ea5ac83a8ece7712cb39fc23f5b}{uri\+\_\+ptr}} websocketpp\+::processor\+::get\+\_\+uri\+\_\+from\+\_\+host (\begin{DoxyParamCaption}\item[{request\+\_\+type \&}]{request}{, }\item[{std\+::string}]{scheme}{}\end{DoxyParamCaption})}


\begin{DoxyParams}{Parameters}
{\em request} & The request to extract the Host header from.\\
\hline
{\em scheme} & The scheme under which this request was received (ws, wss, http, https, etc)\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\doxylink{struct_a}{A} uri\+\_\+pointer that encodes the value of the host header. 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{processor_8hpp_source_l00136}{136}} of file \mbox{\hyperlink{processor_8hpp_source}{processor.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00136\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00137\ \ \ \ \ std::string\ h\ =\ request.get\_header(\textcolor{stringliteral}{"{}Host"{}});}
\DoxyCodeLine{00138\ }
\DoxyCodeLine{00139\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ last\_colon\ =\ h.rfind(\textcolor{stringliteral}{"{}:"{}});}
\DoxyCodeLine{00140\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ last\_sbrace\ =\ h.rfind(\textcolor{stringliteral}{"{}]"{}});}
\DoxyCodeLine{00141\ }
\DoxyCodeLine{00142\ \ \ \ \ \textcolor{comment}{//\ no\ :\ =\ hostname\ with\ no\ port}}
\DoxyCodeLine{00143\ \ \ \ \ \textcolor{comment}{//\ last\ :\ before\ ]\ =\ ipv6\ literal\ with\ no\ port}}
\DoxyCodeLine{00144\ \ \ \ \ \textcolor{comment}{//\ :\ with\ no\ ]\ =\ hostname\ with\ port}}
\DoxyCodeLine{00145\ \ \ \ \ \textcolor{comment}{//\ :\ after\ ]\ =\ ipv6\ literal\ with\ port}}
\DoxyCodeLine{00146\ \ \ \ \ \textcolor{keywordflow}{if}\ (last\_colon\ ==\ std::string::npos\ ||}
\DoxyCodeLine{00147\ \ \ \ \ \ \ \ \ (last\_sbrace\ !=\ std::string::npos\ \&\&\ last\_sbrace\ >\ last\_colon))}
\DoxyCodeLine{00148\ \ \ \ \ \{}
\DoxyCodeLine{00149\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ lib::make\_shared<uri>(scheme,\ h,\ request.get\_uri());}
\DoxyCodeLine{00150\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00151\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ lib::make\_shared<uri>(scheme,}
\DoxyCodeLine{00152\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ h.substr(0,last\_colon),}
\DoxyCodeLine{00153\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ h.substr(last\_colon+1),}
\DoxyCodeLine{00154\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ request.get\_uri());}
\DoxyCodeLine{00155\ \ \ \ \ \}}
\DoxyCodeLine{00156\ \}}

\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacewebsocketpp_1_1processor_a5fa80687521dc24678e773fc3e71e0ce_icgraph}
\end{center}
\end{figure}
\Hypertarget{namespacewebsocketpp_1_1processor_a1a0e5e7b10b24ff5ab836dc543826934}\index{websocketpp::processor@{websocketpp::processor}!get\_websocket\_version@{get\_websocket\_version}}
\index{get\_websocket\_version@{get\_websocket\_version}!websocketpp::processor@{websocketpp::processor}}
\doxysubsubsection{\texorpdfstring{get\_websocket\_version()}{get\_websocket\_version()}}
{\footnotesize\ttfamily \label{namespacewebsocketpp_1_1processor_a1a0e5e7b10b24ff5ab836dc543826934} 
template$<$typename request\+\_\+type $>$ \\
int websocketpp\+::processor\+::get\+\_\+websocket\+\_\+version (\begin{DoxyParamCaption}\item[{request\+\_\+type \&}]{r}{}\end{DoxyParamCaption})}

\doxylink{struct_a}{A} blank version header indicates a spec before versions were introduced. The only such versions in shipping products are Hixie Draft 75 and Hixie Draft 76. Draft 75 is present in Chrome 4-\/5 and Safari 5.\+0.\+0, Draft 76 (also known as hybi 00 is present in Chrome 6-\/13 and Safari 5.\+0.\+1+. As differentiating between these two sets of browsers is very difficult and Safari 5.\+0.\+1+ accounts for the vast majority of cases in the wild this function assumes that all handshakes without a valid version header are Hybi 00.


\begin{DoxyParams}{Parameters}
{\em r} & The Web\+Socket handshake request to read.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The Web\+Socket handshake version or -\/1 if there was an extraction error. 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{processor_8hpp_source_l00107}{107}} of file \mbox{\hyperlink{processor_8hpp_source}{processor.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00107\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00108\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{bn_8cpp_af0a5201ca8846f05f25435b41d7f39f7}{r}}.ready())\ \{}
\DoxyCodeLine{00109\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ -\/2;}
\DoxyCodeLine{00110\ \ \ \ \ \}}
\DoxyCodeLine{00111\ \ \ \ \ }
\DoxyCodeLine{00112\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{bn_8cpp_af0a5201ca8846f05f25435b41d7f39f7}{r}}.get\_header(\textcolor{stringliteral}{"{}Sec-\/WebSocket-\/Version"{}}).empty())\ \{}
\DoxyCodeLine{00113\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00114\ \ \ \ \ \}}
\DoxyCodeLine{00115\ }
\DoxyCodeLine{00116\ \ \ \ \ \textcolor{keywordtype}{int}\ version;}
\DoxyCodeLine{00117\ \ \ \ \ std::istringstream\ ss(\mbox{\hyperlink{bn_8cpp_af0a5201ca8846f05f25435b41d7f39f7}{r}}.get\_header(\textcolor{stringliteral}{"{}Sec-\/WebSocket-\/Version"{}}));}
\DoxyCodeLine{00118\ }
\DoxyCodeLine{00119\ \ \ \ \ \textcolor{keywordflow}{if}\ ((ss\ >>\ version).fail())\ \{}
\DoxyCodeLine{00120\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{00121\ \ \ \ \ \}}
\DoxyCodeLine{00122\ }
\DoxyCodeLine{00123\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacewebsocketpp_1_1http_1_1parser_1_1state_a12f378e0c6dbf373781e7988ee4a0853a08c88a938bc459c7997b48f74248752f}{version}};}
\DoxyCodeLine{00124\ \}}

\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacewebsocketpp_1_1processor_a1a0e5e7b10b24ff5ab836dc543826934_icgraph}
\end{center}
\end{figure}
\Hypertarget{namespacewebsocketpp_1_1processor_a9ff3159b48cf4be2e7cb79c81b155d53}\index{websocketpp::processor@{websocketpp::processor}!is\_websocket\_handshake@{is\_websocket\_handshake}}
\index{is\_websocket\_handshake@{is\_websocket\_handshake}!websocketpp::processor@{websocketpp::processor}}
\doxysubsubsection{\texorpdfstring{is\_websocket\_handshake()}{is\_websocket\_handshake()}}
{\footnotesize\ttfamily \label{namespacewebsocketpp_1_1processor_a9ff3159b48cf4be2e7cb79c81b155d53} 
template$<$typename request\+\_\+type $>$ \\
bool websocketpp\+::processor\+::is\+\_\+websocket\+\_\+handshake (\begin{DoxyParamCaption}\item[{request\+\_\+type \&}]{r}{}\end{DoxyParamCaption})}


\begin{DoxyParams}{Parameters}
{\em r} & The HTTP request to read.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
True if the request is a Web\+Socket handshake, false otherwise 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{processor_8hpp_source_l00068}{68}} of file \mbox{\hyperlink{processor_8hpp_source}{processor.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00069\ \ \ \ \ \textcolor{keyword}{using\ }utility::ci\_find\_substr;}
\DoxyCodeLine{00070\ }
\DoxyCodeLine{00071\ \ \ \ \ std::string\ \textcolor{keyword}{const}\ \&\ upgrade\_header\ =\ \mbox{\hyperlink{bn_8cpp_af0a5201ca8846f05f25435b41d7f39f7}{r}}.get\_header(\textcolor{stringliteral}{"{}Upgrade"{}});}
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00073\ \ \ \ \ \textcolor{keywordflow}{if}\ (ci\_find\_substr(upgrade\_header,\ constants::upgrade\_token,}
\DoxyCodeLine{00074\ \ \ \ \ \ \ \ \ \textcolor{keyword}{sizeof}(constants::upgrade\_token)-\/1)\ ==\ upgrade\_header.end())}
\DoxyCodeLine{00075\ \ \ \ \ \{}
\DoxyCodeLine{00076\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00077\ \ \ \ \ \}}
\DoxyCodeLine{00078\ }
\DoxyCodeLine{00079\ \ \ \ \ std::string\ \textcolor{keyword}{const}\ \&\ con\_header\ =\ \mbox{\hyperlink{bn_8cpp_af0a5201ca8846f05f25435b41d7f39f7}{r}}.get\_header(\textcolor{stringliteral}{"{}Connection"{}});}
\DoxyCodeLine{00080\ }
\DoxyCodeLine{00081\ \ \ \ \ \textcolor{keywordflow}{if}\ (ci\_find\_substr(con\_header,\ constants::connection\_token,}
\DoxyCodeLine{00082\ \ \ \ \ \ \ \ \ \textcolor{keyword}{sizeof}(constants::connection\_token)-\/1)\ ==\ con\_header.end())}
\DoxyCodeLine{00083\ \ \ \ \ \{}
\DoxyCodeLine{00084\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00085\ \ \ \ \ \}}
\DoxyCodeLine{00086\ }
\DoxyCodeLine{00087\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00088\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacewebsocketpp_1_1processor_a9ff3159b48cf4be2e7cb79c81b155d53_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacewebsocketpp_1_1processor_a9ff3159b48cf4be2e7cb79c81b155d53_icgraph}
\end{center}
\end{figure}
