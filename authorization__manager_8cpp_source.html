<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Wire Sysio: libraries/chain/authorization_manager.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Wire Sysio<span id="projectnumber">&#160;Wire Sysion 1.0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('authorization__manager_8cpp_source.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">authorization_manager.cpp</div></div>
</div><!--header-->
<div class="contents">
<a href="authorization__manager_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="preprocessor">#include &lt;<a class="code" href="authorization__manager_8hpp.html">sysio/chain/authorization_manager.hpp</a>&gt;</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="preprocessor">#include &lt;<a class="code" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html">sysio/chain/exceptions.hpp</a>&gt;</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="preprocessor">#include &lt;<a class="code" href="permission__object_8hpp.html">sysio/chain/permission_object.hpp</a>&gt;</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="preprocessor">#include &lt;<a class="code" href="permission__link__object_8hpp.html">sysio/chain/permission_link_object.hpp</a>&gt;</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="preprocessor">#include &lt;<a class="code" href="authority__checker_8hpp.html">sysio/chain/authority_checker.hpp</a>&gt;</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="preprocessor">#include &lt;<a class="code" href="controller_8hpp.html">sysio/chain/controller.hpp</a>&gt;</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="preprocessor">#include &lt;<a class="code" href="global__property__object_8hpp.html">sysio/chain/global_property_object.hpp</a>&gt;</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="preprocessor">#include &lt;<a class="code" href="contract__types_8hpp.html">sysio/chain/contract_types.hpp</a>&gt;</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="preprocessor">#include &lt;<a class="code" href="generated__transaction__object_8hpp.html">sysio/chain/generated_transaction_object.hpp</a>&gt;</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="preprocessor">#include &lt;boost/tuple/tuple_io.hpp&gt;</span></div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="preprocessor">#include &lt;<a class="code" href="database__utils_8hpp.html">sysio/chain/database_utils.hpp</a>&gt;</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="preprocessor">#include &lt;<a class="code" href="protocol__state__object_8hpp.html">sysio/chain/protocol_state_object.hpp</a>&gt;</span></div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="preprocessor">#include &lt;<a class="code" href="deep__mind_8hpp.html">sysio/chain/deep_mind.hpp</a>&gt;</span></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span> </div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span> </div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="keyword">namespace </span><a class="code hl_namespace" href="namespacesysio.html">sysio</a> { <span class="keyword">namespace </span>chain {</div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span> </div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno"><a class="line" href="namespacesysio_1_1chain.html#ac3f9d7d38aaf6d65c84a280e5ed40477">   18</a></span>   <span class="keyword">using </span><a class="code hl_class" href="classsysio_1_1chain_1_1index__set.html">authorization_index_set</a> = <a class="code hl_class" href="classsysio_1_1chain_1_1index__set.html">index_set</a>&lt;</div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span>      <a class="code hl_typedef" href="namespacesysio_1_1chain.html#a4e24a1668746342d40487d1019880986">permission_index</a>,</div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span>      <a class="code hl_typedef" href="namespacesysio_1_1chain.html#ad2f4ad05ff8f6e64102bf097f596589e">permission_usage_index</a>,</div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span>      <a class="code hl_typedef" href="namespacesysio_1_1chain.html#a255011fa21760c6c73a1187a23d0afd1">permission_link_index</a></div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span>   &gt;;</div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span> </div>
<div class="foldopen" id="foldopen00024" data-start="{" data-end="}">
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1authorization__manager.html#a00571cdbafaf86b7de83655d89229280">   24</a></span>   <a class="code hl_function" href="classsysio_1_1chain_1_1authorization__manager.html#a00571cdbafaf86b7de83655d89229280">authorization_manager::authorization_manager</a>(<a class="code hl_class" href="classsysio_1_1chain_1_1controller.html">controller</a>&amp; c, <a class="code hl_class" href="classchainbase_1_1database.html">database</a>&amp; d)</div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span>   :_control(c),_db(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a107648633008a7f2d872b4b3d98c2f96">d</a>){}</div>
</div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span> </div>
<div class="foldopen" id="foldopen00027" data-start="{" data-end="}">
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1authorization__manager.html#a112c1fae696fe6f53103076e9afa5a16">   27</a></span>   <span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1chain_1_1authorization__manager.html#a112c1fae696fe6f53103076e9afa5a16">authorization_manager::add_indices</a>() {</div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span>      authorization_index_set::add_indices(_db);</div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span>   }</div>
</div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span> </div>
<div class="foldopen" id="foldopen00031" data-start="{" data-end="}">
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1authorization__manager.html#a27cfd5f70c12c10a9939e7bf6b3a52e4">   31</a></span>   <span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1chain_1_1authorization__manager.html#a27cfd5f70c12c10a9939e7bf6b3a52e4">authorization_manager::initialize_database</a>() {</div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span>      _db.<a class="code hl_function" href="classchainbase_1_1database.html#adc8f336b33d7013d1b0400399b16c5a7">create</a>&lt;<a class="code hl_class" href="classsysio_1_1chain_1_1permission__object.html">permission_object</a>&gt;([](<span class="keyword">auto</span>&amp;){}); </div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span>   }</div>
</div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span> </div>
<div class="foldopen" id="foldopen00035" data-start="{" data-end="}">
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno"><a class="line" href="namespacesysio_1_1chain_1_1detail.html">   35</a></span>   <span class="keyword">namespace </span><a class="code hl_namespace" href="namespacedetail.html">detail</a> {</div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span>      <span class="keyword">template</span>&lt;&gt;</div>
<div class="foldopen" id="foldopen00037" data-start="{" data-end="};">
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1detail_1_1snapshot__row__traits_3_01permission__object_01_4.html">   37</a></span>      <span class="keyword">struct </span><a class="code hl_struct" href="structsysio_1_1chain_1_1detail_1_1snapshot__row__traits.html">snapshot_row_traits</a>&lt;<a class="code hl_class" href="classsysio_1_1chain_1_1permission__object.html">permission_object</a>&gt; {</div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1detail_1_1snapshot__row__traits_3_01permission__object_01_4.html#a0753180733352ef97bff8af354db0628">   38</a></span>         <span class="keyword">using </span><a class="code hl_class" href="classsysio_1_1chain_1_1permission__object.html">value_type</a> = <a class="code hl_class" href="classsysio_1_1chain_1_1permission__object.html">permission_object</a>;</div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1detail_1_1snapshot__row__traits_3_01permission__object_01_4.html#ab457384ceefd63ab4f150d39f3d9c6f0">   39</a></span>         <span class="keyword">using </span><a class="code hl_struct" href="structsysio_1_1chain_1_1snapshot__permission__object.html">snapshot_type</a> = <a class="code hl_struct" href="structsysio_1_1chain_1_1snapshot__permission__object.html">snapshot_permission_object</a>;</div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span> </div>
<div class="foldopen" id="foldopen00041" data-start="{" data-end="}">
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1detail_1_1snapshot__row__traits_3_01permission__object_01_4.html#a9e45fd801cd6f077e1025fb092a18223">   41</a></span>         <span class="keyword">static</span> <a class="code hl_struct" href="structsysio_1_1chain_1_1snapshot__permission__object.html">snapshot_permission_object</a> <a class="code hl_function" href="structsysio_1_1chain_1_1detail_1_1snapshot__row__traits_3_01permission__object_01_4.html#a9e45fd801cd6f077e1025fb092a18223">to_snapshot_row</a>(<span class="keyword">const</span> <a class="code hl_class" href="classsysio_1_1chain_1_1permission__object.html">permission_object</a>&amp; <a class="code hl_define" href="pkcs11_8h.html#a32aff7c6c4cd253fdf6563677afab5ce">value</a>, <span class="keyword">const</span> <a class="code hl_class" href="classchainbase_1_1database.html">chainbase::database</a>&amp; db) {</div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span>            <a class="code hl_struct" href="structsysio_1_1chain_1_1snapshot__permission__object.html">snapshot_permission_object</a> res;</div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span>            res.<a class="code hl_variable" href="structsysio_1_1chain_1_1snapshot__permission__object.html#ab717b57132e2b8c47442468be92bd167">name</a> = <a class="code hl_define" href="pkcs11_8h.html#a32aff7c6c4cd253fdf6563677afab5ce">value</a>.<a class="code hl_function" href="structsysio_1_1chain_1_1name.html#a8847252c767dea5c3e8b60cc9d78505f">name</a>;</div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span>            res.<a class="code hl_variable" href="structsysio_1_1chain_1_1snapshot__permission__object.html#aabb140f7580c588302dc3038e7ed83b8">owner</a> = <a class="code hl_define" href="pkcs11_8h.html#a32aff7c6c4cd253fdf6563677afab5ce">value</a>.owner;</div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span>            res.<a class="code hl_variable" href="structsysio_1_1chain_1_1snapshot__permission__object.html#a6252fb98de04b0a812b044bf78552386">last_updated</a> = <a class="code hl_define" href="pkcs11_8h.html#a32aff7c6c4cd253fdf6563677afab5ce">value</a>.last_updated;</div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span>            res.<a class="code hl_variable" href="structsysio_1_1chain_1_1snapshot__permission__object.html#a08632f1e4dd62a964d83f81cdbf7b522">auth</a> = <a class="code hl_define" href="pkcs11_8h.html#a32aff7c6c4cd253fdf6563677afab5ce">value</a>.auth.to_authority();</div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span> </div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span>            <span class="comment">// lookup parent name</span></div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span>            <span class="keyword">const</span> <span class="keyword">auto</span>&amp; parent = db.<a class="code hl_function" href="classchainbase_1_1database.html#afcfe00f81a526c1376d4f51197dd3a9a">get</a>(<a class="code hl_define" href="pkcs11_8h.html#a32aff7c6c4cd253fdf6563677afab5ce">value</a>.parent);</div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span>            res.<a class="code hl_variable" href="structsysio_1_1chain_1_1snapshot__permission__object.html#a369423725eb667c68b10d2653e07872e">parent</a> = parent.<a class="code hl_function" href="structsysio_1_1chain_1_1name.html#a8847252c767dea5c3e8b60cc9d78505f">name</a>;</div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span> </div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span>            <span class="comment">// lookup the usage object</span></div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span>            <span class="keyword">const</span> <span class="keyword">auto</span>&amp; usage = db.<a class="code hl_function" href="classchainbase_1_1database.html#afcfe00f81a526c1376d4f51197dd3a9a">get</a>&lt;<a class="code hl_class" href="classsysio_1_1chain_1_1permission__usage__object.html">permission_usage_object</a>&gt;(<a class="code hl_define" href="pkcs11_8h.html#a32aff7c6c4cd253fdf6563677afab5ce">value</a>.usage_id);</div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span>            res.<a class="code hl_variable" href="structsysio_1_1chain_1_1snapshot__permission__object.html#ae88d394c8874eed2f4366c6aaa4b9803">last_used</a> = usage.last_used;</div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span> </div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span>            <span class="keywordflow">return</span> res;</div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span>         };</div>
</div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span> </div>
<div class="foldopen" id="foldopen00059" data-start="{" data-end="}">
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1detail_1_1snapshot__row__traits_3_01permission__object_01_4.html#ac900d123e7677aff1cbe872b65b04ee5">   59</a></span>         <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code hl_function" href="structsysio_1_1chain_1_1detail_1_1snapshot__row__traits_3_01permission__object_01_4.html#ac900d123e7677aff1cbe872b65b04ee5">from_snapshot_row</a>(<a class="code hl_struct" href="structsysio_1_1chain_1_1snapshot__permission__object.html">snapshot_permission_object</a>&amp;&amp; row, <a class="code hl_class" href="classsysio_1_1chain_1_1permission__object.html">permission_object</a>&amp; <a class="code hl_define" href="pkcs11_8h.html#a32aff7c6c4cd253fdf6563677afab5ce">value</a>, <a class="code hl_class" href="classchainbase_1_1database.html">chainbase::database</a>&amp; db) {</div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>            <a class="code hl_define" href="pkcs11_8h.html#a32aff7c6c4cd253fdf6563677afab5ce">value</a>.name = row.name;</div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span>            <a class="code hl_define" href="pkcs11_8h.html#a32aff7c6c4cd253fdf6563677afab5ce">value</a>.owner = row.owner;</div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span>            <a class="code hl_define" href="pkcs11_8h.html#a32aff7c6c4cd253fdf6563677afab5ce">value</a>.last_updated = row.last_updated;</div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span>            <a class="code hl_define" href="pkcs11_8h.html#a32aff7c6c4cd253fdf6563677afab5ce">value</a>.auth = row.auth;</div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span> </div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span>            <a class="code hl_define" href="pkcs11_8h.html#a32aff7c6c4cd253fdf6563677afab5ce">value</a>.parent = 0;</div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span>            <span class="keywordflow">if</span> (<a class="code hl_define" href="pkcs11_8h.html#a32aff7c6c4cd253fdf6563677afab5ce">value</a>.id == 0) {</div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span>               <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>(row.parent == <a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">permission_name</a>(), snapshot_exception, <span class="stringliteral">&quot;Unexpected parent name on reserved permission 0&quot;</span>);</div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span>               <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>(row.name == <a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">permission_name</a>(), snapshot_exception, <span class="stringliteral">&quot;Unexpected permission name on reserved permission 0&quot;</span>);</div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span>               <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>(row.owner == <a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">name</a>(), snapshot_exception, <span class="stringliteral">&quot;Unexpected owner name on reserved permission 0&quot;</span>);</div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>               <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>(row.auth.accounts.size() == 0,  snapshot_exception, <span class="stringliteral">&quot;Unexpected auth accounts on reserved permission 0&quot;</span>);</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span>               <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>(row.auth.keys.size() == 0,  snapshot_exception, <span class="stringliteral">&quot;Unexpected auth keys on reserved permission 0&quot;</span>);</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span>               <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>(row.auth.waits.size() == 0,  snapshot_exception, <span class="stringliteral">&quot;Unexpected auth waits on reserved permission 0&quot;</span>);</div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span>               <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>(row.auth.threshold == 0,  snapshot_exception, <span class="stringliteral">&quot;Unexpected auth threshold on reserved permission 0&quot;</span>);</div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>               <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>(row.last_updated == <a class="code hl_class" href="classfc_1_1time__point.html">time_point</a>(),  snapshot_exception, <span class="stringliteral">&quot;Unexpected auth last updated on reserved permission 0&quot;</span>);</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span>               <a class="code hl_define" href="pkcs11_8h.html#a32aff7c6c4cd253fdf6563677afab5ce">value</a>.parent = 0;</div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span>            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( row.parent != <a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">permission_name</a>()){</div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span>               <span class="keyword">const</span> <span class="keyword">auto</span>&amp; parent = db.<a class="code hl_function" href="classchainbase_1_1database.html#afcfe00f81a526c1376d4f51197dd3a9a">get</a>&lt;<a class="code hl_class" href="classsysio_1_1chain_1_1permission__object.html">permission_object</a>, by_owner&gt;(boost::make_tuple(row.owner, row.parent));</div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span> </div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span>               <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>(parent.id != 0, snapshot_exception, <span class="stringliteral">&quot;Unexpected mapping to reserved permission 0&quot;</span>);</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span>               <a class="code hl_define" href="pkcs11_8h.html#a32aff7c6c4cd253fdf6563677afab5ce">value</a>.parent = parent.id;</div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>            }</div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span> </div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>            <span class="keywordflow">if</span> (<a class="code hl_define" href="pkcs11_8h.html#a32aff7c6c4cd253fdf6563677afab5ce">value</a>.id != 0) {</div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span>               <span class="comment">// create the usage object</span></div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>               <span class="keyword">const</span> <span class="keyword">auto</span>&amp; usage = db.<a class="code hl_function" href="classchainbase_1_1database.html#adc8f336b33d7013d1b0400399b16c5a7">create</a>&lt;<a class="code hl_class" href="classsysio_1_1chain_1_1permission__usage__object.html">permission_usage_object</a>&gt;([&amp;](<span class="keyword">auto</span>&amp; <a class="code hl_variable" href="bn_8cpp.html#a8b0eadcc506862e9d751ab45185053aa">p</a>) {</div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span>                  <a class="code hl_variable" href="bn_8cpp.html#a8b0eadcc506862e9d751ab45185053aa">p</a>.last_used = row.last_used;</div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span>               });</div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>               <a class="code hl_define" href="pkcs11_8h.html#a32aff7c6c4cd253fdf6563677afab5ce">value</a>.usage_id = usage.id;</div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span>               <a class="code hl_define" href="pkcs11_8h.html#a32aff7c6c4cd253fdf6563677afab5ce">value</a>.usage_id = 0;</div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span>            }</div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span>         }</div>
</div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span>      };</div>
</div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>   }</div>
</div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span> </div>
<div class="foldopen" id="foldopen00096" data-start="{" data-end="}">
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1authorization__manager.html#a24e23281d4ccfdddcc761c83e14a4080">   96</a></span>   <span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1chain_1_1authorization__manager.html#a24e23281d4ccfdddcc761c83e14a4080">authorization_manager::add_to_snapshot</a>( <span class="keyword">const</span> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#a80afaa06d96e661a0f93e0ba4b09c8dc">snapshot_writer_ptr</a>&amp; snapshot )<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>      authorization_index_set::walk_indices([<span class="keyword">this</span>, &amp;snapshot]( <span class="keyword">auto</span> utils ){</div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span>         <span class="keyword">using </span>section_t = <span class="keyword">typename</span> <span class="keyword">decltype</span>(utils)::index_t::value_type;</div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span> </div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span>         <span class="comment">// skip the permission_usage_index as its inlined with permission_index</span></div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span>         <span class="keywordflow">if</span> (std::is_same&lt;section_t, permission_usage_object&gt;::value) {</div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span>         }</div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span> </div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span>         snapshot-&gt;write_section&lt;section_t&gt;([<span class="keyword">this</span>]( <span class="keyword">auto</span>&amp; section ){</div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span>            <span class="keyword">decltype</span>(utils)::walk(_db, [<span class="keyword">this</span>, &amp;section]( <span class="keyword">const</span> <span class="keyword">auto</span> &amp;row ) {</div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span>               section.add_row(row, _db);</div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span>            });</div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span>         });</div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span>      });</div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span>   }</div>
</div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span> </div>
<div class="foldopen" id="foldopen00113" data-start="{" data-end="}">
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1authorization__manager.html#a7a4d84d47bcd9069ab0c8d8f9f9ac5f3">  113</a></span>   <span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1chain_1_1authorization__manager.html#a7a4d84d47bcd9069ab0c8d8f9f9ac5f3">authorization_manager::read_from_snapshot</a>( <span class="keyword">const</span> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#aaa27dacddc54cea475602788c8e7a02c">snapshot_reader_ptr</a>&amp; snapshot ) {</div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>      authorization_index_set::walk_indices([<span class="keyword">this</span>, &amp;snapshot]( <span class="keyword">auto</span> utils ){</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>         <span class="keyword">using </span>section_t = <span class="keyword">typename</span> <span class="keyword">decltype</span>(utils)::index_t::value_type;</div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span> </div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span>         <span class="comment">// skip the permission_usage_index as its inlined with permission_index</span></div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>         <span class="keywordflow">if</span> (std::is_same&lt;section_t, permission_usage_object&gt;::value) {</div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>         }</div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span> </div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span>         snapshot-&gt;read_section&lt;section_t&gt;([<span class="keyword">this</span>]( <span class="keyword">auto</span>&amp; section ) {</div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span>            <span class="keywordtype">bool</span> more = !section.empty();</div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span>            <span class="keywordflow">while</span>(more) {</div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span>               <span class="keyword">decltype</span>(utils)::create(_db, [<span class="keyword">this</span>, &amp;section, &amp;more]( <span class="keyword">auto</span> &amp;row ) {</div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span>                  more = section.read_row(row, _db);</div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span>               });</div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span>            }</div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span>         });</div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span>      });</div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span>   }</div>
</div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span> </div>
<div class="foldopen" id="foldopen00133" data-start="{" data-end="}">
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1authorization__manager.html#aac57733c5aa05c1c78a023a80b2f447f">  133</a></span>   <span class="keyword">const</span> <a class="code hl_class" href="classsysio_1_1chain_1_1permission__object.html">permission_object</a>&amp; <a class="code hl_function" href="classsysio_1_1chain_1_1authorization__manager.html#aac57733c5aa05c1c78a023a80b2f447f">authorization_manager::create_permission</a>( <a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">account_name</a> account,</div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span>                                                                      <a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">permission_name</a> <a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">name</a>,</div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>                                                                      <a class="code hl_typedef" href="classsysio_1_1chain_1_1authorization__manager.html#add79267df1f466480b18703845327a78">permission_id_type</a> parent,</div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>                                                                      <span class="keyword">const</span> <a class="code hl_struct" href="structsysio_1_1chain_1_1authority.html">authority</a>&amp; auth,</div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span>                                                                      <a class="code hl_class" href="classfc_1_1time__point.html">time_point</a> initial_creation_time</div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>                                                                    )</div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>   {</div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>      <span class="keywordflow">for</span>(<span class="keyword">const</span> <a class="code hl_struct" href="structsysio_1_1chain_1_1key__weight.html">key_weight</a>&amp; k: auth.<a class="code hl_variable" href="structsysio_1_1chain_1_1authority.html#ae43c8d325b117257317c793fbb248770">keys</a>)</div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>         <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>(k.<a class="code hl_variable" href="structsysio_1_1chain_1_1key__weight.html#ac0d64507dc98ab3078451bf7675b59e9">key</a>.<a class="code hl_function" href="classfc_1_1crypto_1_1public__key.html#aa96a2da856cbba914572aa8629c06c09">which</a>() &lt; _db.<a class="code hl_function" href="classchainbase_1_1database.html#afcfe00f81a526c1376d4f51197dd3a9a">get</a>&lt;<a class="code hl_class" href="classsysio_1_1chain_1_1protocol__state__object.html">protocol_state_object</a>&gt;().<a class="code hl_variable" href="classsysio_1_1chain_1_1protocol__state__object.html#af0f14fd2383a20afd49de85013402cdc">num_supported_key_types</a>, unactivated_key_type,</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>           <span class="stringliteral">&quot;Unactivated key type used when creating permission&quot;</span>);</div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span> </div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>      <span class="keyword">auto</span> creation_time = initial_creation_time;</div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span>      <span class="keywordflow">if</span>( creation_time == <a class="code hl_class" href="classfc_1_1time__point.html">time_point</a>() ) {</div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span>         creation_time = _control.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#abb1d81f96986df3bce46bd37caaf6a69">pending_block_time</a>();</div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>      }</div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span> </div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; perm_usage = _db.<a class="code hl_function" href="classchainbase_1_1database.html#adc8f336b33d7013d1b0400399b16c5a7">create</a>&lt;<a class="code hl_class" href="classsysio_1_1chain_1_1permission__usage__object.html">permission_usage_object</a>&gt;([&amp;](<span class="keyword">auto</span>&amp; <a class="code hl_variable" href="bn_8cpp.html#a8b0eadcc506862e9d751ab45185053aa">p</a>) {</div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>         <a class="code hl_variable" href="bn_8cpp.html#a8b0eadcc506862e9d751ab45185053aa">p</a>.last_used = creation_time;</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>      });</div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span> </div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; perm = _db.<a class="code hl_function" href="classchainbase_1_1database.html#adc8f336b33d7013d1b0400399b16c5a7">create</a>&lt;<a class="code hl_class" href="classsysio_1_1chain_1_1permission__object.html">permission_object</a>&gt;([&amp;](<span class="keyword">auto</span>&amp; <a class="code hl_variable" href="bn_8cpp.html#a8b0eadcc506862e9d751ab45185053aa">p</a>) {</div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>         <a class="code hl_variable" href="bn_8cpp.html#a8b0eadcc506862e9d751ab45185053aa">p</a>.usage_id     = perm_usage.id;</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>         <a class="code hl_variable" href="bn_8cpp.html#a8b0eadcc506862e9d751ab45185053aa">p</a>.parent       = parent;</div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span>         <a class="code hl_variable" href="bn_8cpp.html#a8b0eadcc506862e9d751ab45185053aa">p</a>.owner        = account;</div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>         <a class="code hl_variable" href="bn_8cpp.html#a8b0eadcc506862e9d751ab45185053aa">p</a>.name         = <a class="code hl_variable" href="catch__reporter__console_8cpp.html#a9b45b3e13bd9167aab02e17e08916231">name</a>;</div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>         <a class="code hl_variable" href="bn_8cpp.html#a8b0eadcc506862e9d751ab45185053aa">p</a>.last_updated = creation_time;</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>         <a class="code hl_variable" href="bn_8cpp.html#a8b0eadcc506862e9d751ab45185053aa">p</a>.auth         = auth;</div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span> </div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>         <span class="keywordflow">if</span> (<span class="keyword">auto</span> dm_logger = _control.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a4f6404b355a3a4bf7fb60c92e85443d1">get_deep_mind_logger</a>()) {</div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>            dm_logger-&gt;on_create_permission(<a class="code hl_variable" href="bn_8cpp.html#a8b0eadcc506862e9d751ab45185053aa">p</a>);</div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>         }</div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>      });</div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>      <span class="keywordflow">return</span> perm;</div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>   }</div>
</div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span> </div>
<div class="foldopen" id="foldopen00168" data-start="{" data-end="}">
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1authorization__manager.html#a258e0daa2cd72440bfe34a2aa92c9104">  168</a></span>   <span class="keyword">const</span> <a class="code hl_class" href="classsysio_1_1chain_1_1permission__object.html">permission_object</a>&amp; <a class="code hl_function" href="classsysio_1_1chain_1_1authorization__manager.html#aac57733c5aa05c1c78a023a80b2f447f">authorization_manager::create_permission</a>( <a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">account_name</a> account,</div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span>                                                                      <a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">permission_name</a> <a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">name</a>,</div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span>                                                                      <a class="code hl_typedef" href="classsysio_1_1chain_1_1authorization__manager.html#add79267df1f466480b18703845327a78">permission_id_type</a> parent,</div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span>                                                                      <a class="code hl_struct" href="structsysio_1_1chain_1_1authority.html">authority</a>&amp;&amp; auth,</div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span>                                                                      <a class="code hl_class" href="classfc_1_1time__point.html">time_point</a> initial_creation_time</div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>                                                                    )</div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span>   {</div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>      <span class="keywordflow">for</span>(<span class="keyword">const</span> <a class="code hl_struct" href="structsysio_1_1chain_1_1key__weight.html">key_weight</a>&amp; k: auth.keys)</div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span>         <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>(k.<a class="code hl_variable" href="structsysio_1_1chain_1_1key__weight.html#ac0d64507dc98ab3078451bf7675b59e9">key</a>.<a class="code hl_function" href="classfc_1_1crypto_1_1public__key.html#aa96a2da856cbba914572aa8629c06c09">which</a>() &lt; _db.<a class="code hl_function" href="classchainbase_1_1database.html#afcfe00f81a526c1376d4f51197dd3a9a">get</a>&lt;<a class="code hl_class" href="classsysio_1_1chain_1_1protocol__state__object.html">protocol_state_object</a>&gt;().<a class="code hl_variable" href="classsysio_1_1chain_1_1protocol__state__object.html#af0f14fd2383a20afd49de85013402cdc">num_supported_key_types</a>, unactivated_key_type,</div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span>           <span class="stringliteral">&quot;Unactivated key type used when creating permission&quot;</span>);</div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span> </div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span>      <span class="keyword">auto</span> creation_time = initial_creation_time;</div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>      <span class="keywordflow">if</span>( creation_time == <a class="code hl_class" href="classfc_1_1time__point.html">time_point</a>() ) {</div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>         creation_time = _control.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#abb1d81f96986df3bce46bd37caaf6a69">pending_block_time</a>();</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>      }</div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span> </div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span>      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; perm_usage = _db.<a class="code hl_function" href="classchainbase_1_1database.html#adc8f336b33d7013d1b0400399b16c5a7">create</a>&lt;<a class="code hl_class" href="classsysio_1_1chain_1_1permission__usage__object.html">permission_usage_object</a>&gt;([&amp;](<span class="keyword">auto</span>&amp; <a class="code hl_variable" href="bn_8cpp.html#a8b0eadcc506862e9d751ab45185053aa">p</a>) {</div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span>         <a class="code hl_variable" href="bn_8cpp.html#a8b0eadcc506862e9d751ab45185053aa">p</a>.last_used = creation_time;</div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>      });</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span> </div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span>      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; perm = _db.<a class="code hl_function" href="classchainbase_1_1database.html#adc8f336b33d7013d1b0400399b16c5a7">create</a>&lt;<a class="code hl_class" href="classsysio_1_1chain_1_1permission__object.html">permission_object</a>&gt;([&amp;](<span class="keyword">auto</span>&amp; <a class="code hl_variable" href="bn_8cpp.html#a8b0eadcc506862e9d751ab45185053aa">p</a>) {</div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span>         <a class="code hl_variable" href="bn_8cpp.html#a8b0eadcc506862e9d751ab45185053aa">p</a>.usage_id     = perm_usage.id;</div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>         <a class="code hl_variable" href="bn_8cpp.html#a8b0eadcc506862e9d751ab45185053aa">p</a>.parent       = parent;</div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span>         <a class="code hl_variable" href="bn_8cpp.html#a8b0eadcc506862e9d751ab45185053aa">p</a>.owner        = account;</div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span>         <a class="code hl_variable" href="bn_8cpp.html#a8b0eadcc506862e9d751ab45185053aa">p</a>.name         = <a class="code hl_variable" href="catch__reporter__console_8cpp.html#a9b45b3e13bd9167aab02e17e08916231">name</a>;</div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span>         <a class="code hl_variable" href="bn_8cpp.html#a8b0eadcc506862e9d751ab45185053aa">p</a>.last_updated = creation_time;</div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span>         <a class="code hl_variable" href="bn_8cpp.html#a8b0eadcc506862e9d751ab45185053aa">p</a>.auth         = std::move(auth);</div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span> </div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span>         <span class="keywordflow">if</span> (<span class="keyword">auto</span> dm_logger = _control.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a4f6404b355a3a4bf7fb60c92e85443d1">get_deep_mind_logger</a>()) {</div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span>            dm_logger-&gt;on_create_permission(<a class="code hl_variable" href="bn_8cpp.html#a8b0eadcc506862e9d751ab45185053aa">p</a>);</div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>         }</div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span>      });</div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>      <span class="keywordflow">return</span> perm;</div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span>   }</div>
</div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span> </div>
<div class="foldopen" id="foldopen00203" data-start="{" data-end="}">
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1authorization__manager.html#abf01ddda4cd475bf2530ad1d28c72dfb">  203</a></span>   <span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1chain_1_1authorization__manager.html#abf01ddda4cd475bf2530ad1d28c72dfb">authorization_manager::modify_permission</a>( <span class="keyword">const</span> <a class="code hl_class" href="classsysio_1_1chain_1_1permission__object.html">permission_object</a>&amp; permission, <span class="keyword">const</span> <a class="code hl_struct" href="structsysio_1_1chain_1_1authority.html">authority</a>&amp; auth ) {</div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span>      <span class="keywordflow">for</span>(<span class="keyword">const</span> <a class="code hl_struct" href="structsysio_1_1chain_1_1key__weight.html">key_weight</a>&amp; k: auth.<a class="code hl_variable" href="structsysio_1_1chain_1_1authority.html#ae43c8d325b117257317c793fbb248770">keys</a>)</div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>         <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>(k.<a class="code hl_variable" href="structsysio_1_1chain_1_1key__weight.html#ac0d64507dc98ab3078451bf7675b59e9">key</a>.<a class="code hl_function" href="classfc_1_1crypto_1_1public__key.html#aa96a2da856cbba914572aa8629c06c09">which</a>() &lt; _db.<a class="code hl_function" href="classchainbase_1_1database.html#afcfe00f81a526c1376d4f51197dd3a9a">get</a>&lt;<a class="code hl_class" href="classsysio_1_1chain_1_1protocol__state__object.html">protocol_state_object</a>&gt;().<a class="code hl_variable" href="classsysio_1_1chain_1_1protocol__state__object.html#af0f14fd2383a20afd49de85013402cdc">num_supported_key_types</a>, unactivated_key_type,</div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span>           <span class="stringliteral">&quot;Unactivated key type used when modifying permission&quot;</span>);</div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span> </div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>      _db.<a class="code hl_function" href="classchainbase_1_1database.html#a9ebc006075e8fc2e84357a0e068b58d4">modify</a>( permission, [&amp;](<a class="code hl_class" href="classsysio_1_1chain_1_1permission__object.html">permission_object</a>&amp; po) {</div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>         <span class="keyword">auto</span> dm_logger = _control.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a4f6404b355a3a4bf7fb60c92e85443d1">get_deep_mind_logger</a>();</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span> </div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>         std::optional&lt;permission_object&gt; old_permission;</div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>         <span class="keywordflow">if</span> (dm_logger) {</div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>            old_permission = po;</div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>         }</div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span> </div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span>         po.auth = auth;</div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span>         po.last_updated = _control.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#abb1d81f96986df3bce46bd37caaf6a69">pending_block_time</a>();</div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span> </div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>         <span class="keywordflow">if</span> (<span class="keyword">auto</span> dm_logger = _control.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a4f6404b355a3a4bf7fb60c92e85443d1">get_deep_mind_logger</a>()) {</div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span>            dm_logger-&gt;on_modify_permission(*old_permission, po);</div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span>         }</div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span>      });</div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>   }</div>
</div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span> </div>
<div class="foldopen" id="foldopen00225" data-start="{" data-end="}">
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1authorization__manager.html#a9c889c94c63b7c53a5b4919738d6166b">  225</a></span>   <span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1chain_1_1authorization__manager.html#a9c889c94c63b7c53a5b4919738d6166b">authorization_manager::remove_permission</a>( <span class="keyword">const</span> <a class="code hl_class" href="classsysio_1_1chain_1_1permission__object.html">permission_object</a>&amp; permission ) {</div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; index = _db.template <a class="code hl_function" href="namespacefc.html#ae009b19d1fecf5979996e9f326cd98c3">get_index&lt;permission_index, by_parent&gt;</a>();</div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span>      <span class="keyword">auto</span> range = index.equal_range(permission.id);</div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>      <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( range.first == range.second, <a class="code hl_variable" href="namespacesysio_1_1chain.html#a764b50974b9b72a0e233e72176913d6b">action_validate_exception</a>,</div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span>                  <span class="stringliteral">&quot;Cannot remove a permission which has children. Remove the children first.&quot;</span>);</div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span> </div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span>      _db.<a class="code hl_function" href="classchainbase_1_1database.html#afaea057692a8bbbf3f506b64c60308b6">get_mutable_index</a>&lt;<a class="code hl_typedef" href="namespacesysio_1_1chain.html#ad2f4ad05ff8f6e64102bf097f596589e">permission_usage_index</a>&gt;().remove_object( permission.usage_id._id );</div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span> </div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>      <span class="keywordflow">if</span> (<span class="keyword">auto</span> dm_logger = _control.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a4f6404b355a3a4bf7fb60c92e85443d1">get_deep_mind_logger</a>()) {</div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span>         dm_logger-&gt;on_remove_permission(permission);</div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>      }</div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span> </div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>      _db.<a class="code hl_function" href="classchainbase_1_1database.html#ac6bb29708e4fdfb6899028e3c351fe0b">remove</a>( permission );</div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>   }</div>
</div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span> </div>
<div class="foldopen" id="foldopen00240" data-start="{" data-end="}">
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1authorization__manager.html#a6755c0b39298b2933eb4e74649a36442">  240</a></span>   <span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1chain_1_1authorization__manager.html#a6755c0b39298b2933eb4e74649a36442">authorization_manager::update_permission_usage</a>( <span class="keyword">const</span> <a class="code hl_class" href="classsysio_1_1chain_1_1permission__object.html">permission_object</a>&amp; permission ) {</div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; puo = _db.<a class="code hl_function" href="classchainbase_1_1database.html#afcfe00f81a526c1376d4f51197dd3a9a">get</a>&lt;<a class="code hl_class" href="classsysio_1_1chain_1_1permission__usage__object.html">permission_usage_object</a>, by_id&gt;( permission.usage_id );</div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span>      _db.<a class="code hl_function" href="classchainbase_1_1database.html#a9ebc006075e8fc2e84357a0e068b58d4">modify</a>( puo, [&amp;](<a class="code hl_class" href="classsysio_1_1chain_1_1permission__usage__object.html">permission_usage_object</a>&amp; <a class="code hl_variable" href="bn_8cpp.html#a8b0eadcc506862e9d751ab45185053aa">p</a>) {</div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span>         <a class="code hl_variable" href="bn_8cpp.html#a8b0eadcc506862e9d751ab45185053aa">p</a>.last_used = _control.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#abb1d81f96986df3bce46bd37caaf6a69">pending_block_time</a>();</div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span>      });</div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>   }</div>
</div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span> </div>
<div class="foldopen" id="foldopen00247" data-start="{" data-end="}">
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1authorization__manager.html#a0909c7f81928fd8ffc4269861d12ad3f">  247</a></span>   <a class="code hl_class" href="classfc_1_1time__point.html">fc::time_point</a> <a class="code hl_function" href="classsysio_1_1chain_1_1authorization__manager.html#a0909c7f81928fd8ffc4269861d12ad3f">authorization_manager::get_permission_last_used</a>( <span class="keyword">const</span> <a class="code hl_class" href="classsysio_1_1chain_1_1permission__object.html">permission_object</a>&amp; permission )<span class="keyword">const </span>{</div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>      <span class="keywordflow">return</span> _db.<a class="code hl_function" href="classchainbase_1_1database.html#afcfe00f81a526c1376d4f51197dd3a9a">get</a>&lt;<a class="code hl_class" href="classsysio_1_1chain_1_1permission__usage__object.html">permission_usage_object</a>, by_id&gt;( permission.usage_id ).last_used;</div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span>   }</div>
</div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span> </div>
<div class="foldopen" id="foldopen00251" data-start="{" data-end="}">
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1authorization__manager.html#ab0acfec50b75044030d082d1aa3fbf5c">  251</a></span>   <span class="keyword">const</span> <a class="code hl_class" href="classsysio_1_1chain_1_1permission__object.html">permission_object</a>*  <a class="code hl_function" href="classsysio_1_1chain_1_1authorization__manager.html#ab0acfec50b75044030d082d1aa3fbf5c">authorization_manager::find_permission</a>( <span class="keyword">const</span> <a class="code hl_struct" href="structsysio_1_1chain_1_1permission__level.html">permission_level</a>&amp; level )<span class="keyword">const</span></div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span><span class="keyword">   </span>{ <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span>      <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( !level.actor.empty() &amp;&amp; !level.permission.empty(), invalid_permission, <span class="stringliteral">&quot;Invalid permission&quot;</span> );</div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span>      <span class="keywordflow">return</span> _db.<a class="code hl_function" href="classchainbase_1_1database.html#aa5a2ca0da0092693ac49b36b7ec6817a">find</a>&lt;<a class="code hl_class" href="classsysio_1_1chain_1_1permission__object.html">permission_object</a>, by_owner&gt;( boost::make_tuple(level.actor,level.permission) );</div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span>   } <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a43bd817895cb757183fcecafc6ae7dc1">SYS_RETHROW_EXCEPTIONS</a>( chain::permission_query_exception, <span class="stringliteral">&quot;Failed to retrieve permission: ${level}&quot;</span>, (<span class="stringliteral">&quot;level&quot;</span>, level) ) }</div>
</div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span> </div>
<div class="foldopen" id="foldopen00257" data-start="{" data-end="}">
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1authorization__manager.html#a96924f6aca32a602e24d991d12278a69">  257</a></span>   <span class="keyword">const</span> <a class="code hl_class" href="classsysio_1_1chain_1_1permission__object.html">permission_object</a>&amp;  <a class="code hl_function" href="classsysio_1_1chain_1_1authorization__manager.html#a96924f6aca32a602e24d991d12278a69">authorization_manager::get_permission</a>( <span class="keyword">const</span> <a class="code hl_struct" href="structsysio_1_1chain_1_1permission__level.html">permission_level</a>&amp; level )<span class="keyword">const</span></div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span><span class="keyword">   </span>{ <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span>      <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( !level.actor.empty() &amp;&amp; !level.permission.empty(), invalid_permission, <span class="stringliteral">&quot;Invalid permission&quot;</span> );</div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span>      <span class="keywordflow">return</span> _db.<a class="code hl_function" href="classchainbase_1_1database.html#afcfe00f81a526c1376d4f51197dd3a9a">get</a>&lt;<a class="code hl_class" href="classsysio_1_1chain_1_1permission__object.html">permission_object</a>, by_owner&gt;( boost::make_tuple(level.actor,level.permission) );</div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span>   } <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a43bd817895cb757183fcecafc6ae7dc1">SYS_RETHROW_EXCEPTIONS</a>( chain::permission_query_exception, <span class="stringliteral">&quot;Failed to retrieve permission: ${level}&quot;</span>, (<span class="stringliteral">&quot;level&quot;</span>, level) ) }</div>
</div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span> </div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span>   std::optional&lt;permission_name&gt; authorization_manager::lookup_linked_permission( <a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">account_name</a> authorizer_account,</div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span>                                                                                   <a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">account_name</a> scope,</div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span>                                                                                   <a class="code hl_typedef" href="namespacesysio_1_1chain.html#a7a1685bcc352cda9e45f055932069428">action_name</a> act_name</div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span>                                                                                 )<span class="keyword">const</span></div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span><span class="keyword">   </span>{</div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span>      <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>         <span class="comment">// First look up a specific link for this message act_name</span></div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span>         <span class="keyword">auto</span> key = boost::make_tuple(authorizer_account, scope, act_name);</div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span>         <span class="keyword">auto</span> link = _db.<a class="code hl_function" href="classchainbase_1_1database.html#aa5a2ca0da0092693ac49b36b7ec6817a">find</a>&lt;<a class="code hl_class" href="classsysio_1_1chain_1_1permission__link__object.html">permission_link_object</a>, by_action_name&gt;(<a class="code hl_variable" href="yubico__otp_8c.html#a9246c20bb98ad2b4c60313c053c70f08">key</a>);</div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span>         <span class="comment">// If no specific link found, check for a contract-wide default</span></div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span>         <span class="keywordflow">if</span> (link == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>            boost::get&lt;2&gt;(key) = {};</div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span>            link = _db.<a class="code hl_function" href="classchainbase_1_1database.html#aa5a2ca0da0092693ac49b36b7ec6817a">find</a>&lt;<a class="code hl_class" href="classsysio_1_1chain_1_1permission__link__object.html">permission_link_object</a>, by_action_name&gt;(<a class="code hl_variable" href="yubico__otp_8c.html#a9246c20bb98ad2b4c60313c053c70f08">key</a>);</div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span>         }</div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span> </div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span>         <span class="comment">// If no specific or default link found, use active permission</span></div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span>         <span class="keywordflow">if</span> (link != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span>            <span class="keywordflow">return</span> link-&gt;required_permission;</div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>         }</div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span>         <span class="keywordflow">return</span> std::optional&lt;permission_name&gt;();</div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span>      } <a class="code hl_define" href="exception_8hpp.html#a094902280cad82ad6529ebbd12a697eb">FC_CAPTURE_AND_RETHROW</a>((authorizer_account)(scope)(act_name))</div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span>   }</div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span> </div>
<div class="foldopen" id="foldopen00286" data-start="{" data-end="}">
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1authorization__manager.html#a6193726fcf21c9b75f460696a67b6839">  286</a></span>   std::optional&lt;permission_name&gt; <a class="code hl_function" href="classsysio_1_1chain_1_1authorization__manager.html#a6193726fcf21c9b75f460696a67b6839">authorization_manager::lookup_minimum_permission</a>( <a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">account_name</a> authorizer_account,</div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span>                                                                                    <a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">account_name</a> scope,</div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span>                                                                                    <a class="code hl_typedef" href="namespacesysio_1_1chain.html#a7a1685bcc352cda9e45f055932069428">action_name</a> act_name</div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span>                                                                                  )<span class="keyword">const</span></div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span><span class="keyword">   </span>{</div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span>      <span class="comment">// Special case native actions cannot be linked to a minimum permission, so there is no need to check.</span></div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span>      <span class="keywordflow">if</span>( scope == config::system_account_name ) {</div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span>          <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( act_name != <a class="code hl_function" href="structsysio_1_1chain_1_1updateauth.html#afc31c0680242885924f64fc347780814">updateauth::get_name</a>() &amp;&amp;</div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span>                     act_name != <a class="code hl_function" href="structsysio_1_1chain_1_1deleteauth.html#add712cbf63b55d0e2db2b874dca6576d">deleteauth::get_name</a>() &amp;&amp;</div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span>                     act_name != <a class="code hl_function" href="structsysio_1_1chain_1_1linkauth.html#a41eafdd131f5b3c8a8b7688449986f2b">linkauth::get_name</a>() &amp;&amp;</div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span>                     act_name != <a class="code hl_function" href="structsysio_1_1chain_1_1unlinkauth.html#a438dbc3c8575ab1f129c0fdd5c074327">unlinkauth::get_name</a>() &amp;&amp;</div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span>                     act_name != <a class="code hl_function" href="structsysio_1_1chain_1_1canceldelay.html#a23c3d201f9917509b74001716daf254f">canceldelay::get_name</a>(),</div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span>                     unlinkable_min_permission_action,</div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span>                     <span class="stringliteral">&quot;cannot call lookup_minimum_permission on native actions that are not allowed to be linked to minimum permissions&quot;</span> );</div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span>      }</div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span> </div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span>      <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span>         std::optional&lt;permission_name&gt; linked_permission = lookup_linked_permission(authorizer_account, scope, act_name);</div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span>         <span class="keywordflow">if</span>( !linked_permission )</div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span>            <span class="keywordflow">return</span> config::active_name;</div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span> </div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span>         <span class="keywordflow">if</span>( *linked_permission == config::sysio_any_name )</div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span>            <span class="keywordflow">return</span> std::optional&lt;permission_name&gt;();</div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span> </div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span>         <span class="keywordflow">return</span> linked_permission;</div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span>      } <a class="code hl_define" href="exception_8hpp.html#a094902280cad82ad6529ebbd12a697eb">FC_CAPTURE_AND_RETHROW</a>((authorizer_account)(scope)(act_name))</div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span>   }</div>
</div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span> </div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span>   <span class="keywordtype">void</span> authorization_manager::check_updateauth_authorization( <span class="keyword">const</span> <a class="code hl_struct" href="structsysio_1_1chain_1_1updateauth.html">updateauth</a>&amp; update,</div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span>                                                               <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1vector.html">vector&lt;permission_level&gt;</a>&amp; auths</div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span>                                                             )<span class="keyword">const</span></div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span><span class="keyword">   </span>{</div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span>      <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( auths.size() == 1, irrelevant_auth_exception,</div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span>                  <span class="stringliteral">&quot;updateauth action should only have one declared authorization&quot;</span> );</div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span>      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; auth = auths[0];</div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span> </div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span>      <span class="comment">// ** OR statement is custom, added to allow for sysio to add &#39;auth.ext&#39; and &#39;auth.session&#39; to users via our custom &#39;onlinkauth&#39; from system contract.</span></div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span>      <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( (auth.actor == update.<a class="code hl_variable" href="structsysio_1_1chain_1_1updateauth.html#a7ee3ebcba6271b4c675f1fedbed1a27e">account</a> || auth.actor == <a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">name</a>(<span class="stringliteral">&quot;sysio&quot;</span>)), irrelevant_auth_exception,</div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span>                  <span class="stringliteral">&quot;the owner of the affected permission needs to be the actor of the declared authorization&quot;</span> );</div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span> </div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span>      <span class="comment">// ** New: Prevents users from updating / adding &#39;auth.ext&#39; and &#39;auth.session&#39; special permissions.</span></div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span>      <span class="keywordflow">if</span>(update.<a class="code hl_variable" href="structsysio_1_1chain_1_1updateauth.html#a6a6754666f37b5dc06165b954bc6c4fc">permission</a> == <a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">name</a>(<span class="stringliteral">&quot;auth.ext&quot;</span>) || update.<a class="code hl_variable" href="structsysio_1_1chain_1_1updateauth.html#a6a6754666f37b5dc06165b954bc6c4fc">permission</a> == <a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">name</a>(<span class="stringliteral">&quot;auth.session&quot;</span>)) {</div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span>         <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( auth.actor == <a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">name</a>(<span class="stringliteral">&quot;sysio&quot;</span>), invalid_permission, <span class="stringliteral">&quot;Special permission, only assignable by &#39;sysio&#39; as a result of &#39;onlinkauth&#39;&quot;</span> );</div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span>         <span class="keyword">const</span> <span class="keyword">auto</span>* min_permission = <a class="code hl_function" href="classsysio_1_1chain_1_1authorization__manager.html#ab0acfec50b75044030d082d1aa3fbf5c">find_permission</a>({update.<a class="code hl_variable" href="structsysio_1_1chain_1_1updateauth.html#a7ee3ebcba6271b4c675f1fedbed1a27e">account</a>, update.<a class="code hl_variable" href="structsysio_1_1chain_1_1updateauth.html#a6a6754666f37b5dc06165b954bc6c4fc">permission</a>});</div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span>         <span class="keywordflow">if</span>( !min_permission ) { <span class="comment">// creating a new permission</span></div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span>            min_permission = &amp;<a class="code hl_function" href="classsysio_1_1chain_1_1authorization__manager.html#a96924f6aca32a602e24d991d12278a69">get_permission</a>({update.<a class="code hl_variable" href="structsysio_1_1chain_1_1updateauth.html#a7ee3ebcba6271b4c675f1fedbed1a27e">account</a>, update.<a class="code hl_variable" href="structsysio_1_1chain_1_1updateauth.html#a63fdeac4d73b22271c0dae827f3eae48">parent</a>});</div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span>         }</div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span> </div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span>         <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( <a class="code hl_function" href="classsysio_1_1chain_1_1authorization__manager.html#a96924f6aca32a602e24d991d12278a69">get_permission</a>(auth).satisfies( *min_permission,</div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span>                                                   _db.<a class="code hl_function" href="classchainbase_1_1database.html#a4d5297635dcf70be481d9b600da9bc13">get_index</a>&lt;<a class="code hl_typedef" href="namespacesysio_1_1chain.html#a4e24a1668746342d40487d1019880986">permission_index</a>&gt;().indices() ),</div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span>                     irrelevant_auth_exception,</div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span>                     <span class="stringliteral">&quot;updateauth action declares irrelevant authority &#39;${auth}&#39;; minimum authority is ${min}&quot;</span>,</div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span>                     (<span class="stringliteral">&quot;auth&quot;</span>, auth)(<span class="stringliteral">&quot;min&quot;</span>, permission_level{update.account, min_permission-&gt;name}) );</div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span>      }</div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span>   }</div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span> </div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span>   <span class="keywordtype">void</span> authorization_manager::check_deleteauth_authorization( <span class="keyword">const</span> deleteauth&amp; del,</div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span>                                                               <span class="keyword">const</span> vector&lt;permission_level&gt;&amp; auths</div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span>                                                             )<span class="keyword">const</span></div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span><span class="keyword">   </span>{</div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span>      <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( auths.size() == 1, irrelevant_auth_exception,</div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span>                  <span class="stringliteral">&quot;deleteauth action should only have one declared authorization&quot;</span> );</div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span>      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; auth = auths[0];</div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span>      <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( auth.actor == del.account, irrelevant_auth_exception,</div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span>                  <span class="stringliteral">&quot;the owner of the permission to delete needs to be the actor of the declared authorization&quot;</span> );</div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span> </div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span>      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; min_permission = <a class="code hl_function" href="classsysio_1_1chain_1_1authorization__manager.html#a96924f6aca32a602e24d991d12278a69">get_permission</a>({del.account, del.permission});</div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span> </div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span>      <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( <a class="code hl_function" href="classsysio_1_1chain_1_1authorization__manager.html#a96924f6aca32a602e24d991d12278a69">get_permission</a>(auth).satisfies( min_permission,</div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span>                                                  _db.<a class="code hl_function" href="classchainbase_1_1database.html#a4d5297635dcf70be481d9b600da9bc13">get_index</a>&lt;<a class="code hl_typedef" href="namespacesysio_1_1chain.html#a4e24a1668746342d40487d1019880986">permission_index</a>&gt;().indices() ),</div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span>                  irrelevant_auth_exception,</div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span>                  <span class="stringliteral">&quot;updateauth action declares irrelevant authority &#39;${auth}&#39;; minimum authority is ${min}&quot;</span>,</div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span>                  (<span class="stringliteral">&quot;auth&quot;</span>, auth)(<span class="stringliteral">&quot;min&quot;</span>, permission_level{min_permission.owner, min_permission.name}) );</div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span>   }</div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span> </div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span>   <span class="keywordtype">void</span> authorization_manager::check_linkauth_authorization( <span class="keyword">const</span> linkauth&amp; link,</div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span>                                                             <span class="keyword">const</span> vector&lt;permission_level&gt;&amp; auths</div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span>                                                           )<span class="keyword">const</span></div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span><span class="keyword">   </span>{</div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span>      <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( auths.size() == 1, irrelevant_auth_exception,</div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span>                  <span class="stringliteral">&quot;link action should only have one declared authorization&quot;</span> );</div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span>      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; auth = auths[0];</div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span>      <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( auth.actor == link.account, irrelevant_auth_exception,</div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span>                  <span class="stringliteral">&quot;the owner of the linked permission needs to be the actor of the declared authorization&quot;</span> );</div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span> </div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span>      <span class="keywordflow">if</span>( link.code == config::system_account_name</div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span>            || !_control.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#aa808acf858e93c567ff983ccbf8fb6d3">is_builtin_activated</a>( <a class="code hl_enumvalue" href="namespacesysio_1_1chain.html#a406d45a184cdba0af316b5bf34bf56cfaa1c8246337a0813da762617fa567c3e5">builtin_protocol_feature_t::fix_linkauth_restriction</a> ) ) </div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span>      {</div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span>         <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( link.type != <a class="code hl_function" href="structsysio_1_1chain_1_1updateauth.html#afc31c0680242885924f64fc347780814">updateauth::get_name</a>(),  <a class="code hl_variable" href="namespacesysio_1_1chain.html#a764b50974b9b72a0e233e72176913d6b">action_validate_exception</a>,</div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span>                     <span class="stringliteral">&quot;Cannot link sysio::updateauth to a minimum permission&quot;</span> );</div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span>         <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( link.type != <a class="code hl_function" href="structsysio_1_1chain_1_1deleteauth.html#add712cbf63b55d0e2db2b874dca6576d">deleteauth::get_name</a>(),  <a class="code hl_variable" href="namespacesysio_1_1chain.html#a764b50974b9b72a0e233e72176913d6b">action_validate_exception</a>,</div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span>                     <span class="stringliteral">&quot;Cannot link sysio::deleteauth to a minimum permission&quot;</span> );</div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span>         <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( link.type != <a class="code hl_function" href="structsysio_1_1chain_1_1linkauth.html#a41eafdd131f5b3c8a8b7688449986f2b">linkauth::get_name</a>(),    <a class="code hl_variable" href="namespacesysio_1_1chain.html#a764b50974b9b72a0e233e72176913d6b">action_validate_exception</a>,</div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span>                     <span class="stringliteral">&quot;Cannot link sysio::linkauth to a minimum permission&quot;</span> );</div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span>         <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( link.type != <a class="code hl_function" href="structsysio_1_1chain_1_1unlinkauth.html#a438dbc3c8575ab1f129c0fdd5c074327">unlinkauth::get_name</a>(),  <a class="code hl_variable" href="namespacesysio_1_1chain.html#a764b50974b9b72a0e233e72176913d6b">action_validate_exception</a>,</div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span>                     <span class="stringliteral">&quot;Cannot link sysio::unlinkauth to a minimum permission&quot;</span> );</div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span>         <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( link.type != <a class="code hl_function" href="structsysio_1_1chain_1_1canceldelay.html#a23c3d201f9917509b74001716daf254f">canceldelay::get_name</a>(), <a class="code hl_variable" href="namespacesysio_1_1chain.html#a764b50974b9b72a0e233e72176913d6b">action_validate_exception</a>,</div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span>                     <span class="stringliteral">&quot;Cannot link sysio::canceldelay to a minimum permission&quot;</span> );</div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span>      }</div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span> </div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span>      <span class="keyword">const</span> <span class="keyword">auto</span> linked_permission_name = <a class="code hl_function" href="classsysio_1_1chain_1_1authorization__manager.html#a6193726fcf21c9b75f460696a67b6839">lookup_minimum_permission</a>(link.account, link.code, link.type);</div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span> </div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span>      <span class="keywordflow">if</span>( !linked_permission_name ) <span class="comment">// if action is linked to sysio.any permission</span></div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span>         <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span> </div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span>      <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( <a class="code hl_function" href="classsysio_1_1chain_1_1authorization__manager.html#a96924f6aca32a602e24d991d12278a69">get_permission</a>(auth).satisfies( <a class="code hl_function" href="classsysio_1_1chain_1_1authorization__manager.html#a96924f6aca32a602e24d991d12278a69">get_permission</a>({link.account, *linked_permission_name}),</div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span>                                                  _db.<a class="code hl_function" href="classchainbase_1_1database.html#a4d5297635dcf70be481d9b600da9bc13">get_index</a>&lt;<a class="code hl_typedef" href="namespacesysio_1_1chain.html#a4e24a1668746342d40487d1019880986">permission_index</a>&gt;().indices()              ),</div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span>                  irrelevant_auth_exception,</div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span>                  <span class="stringliteral">&quot;link action declares irrelevant authority &#39;${auth}&#39;; minimum authority is ${min}&quot;</span>,</div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span>                  (<span class="stringliteral">&quot;auth&quot;</span>, auth)(<span class="stringliteral">&quot;min&quot;</span>, permission_level{link.account, *linked_permission_name}) );</div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span>   }</div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span> </div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span>   <span class="keywordtype">void</span> authorization_manager::check_unlinkauth_authorization( <span class="keyword">const</span> unlinkauth&amp; unlink,</div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span>                                                               <span class="keyword">const</span> vector&lt;permission_level&gt;&amp; auths</div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span>                                                             )<span class="keyword">const</span></div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span><span class="keyword">   </span>{</div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span>      <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( auths.size() == 1, irrelevant_auth_exception,</div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span>                  <span class="stringliteral">&quot;unlink action should only have one declared authorization&quot;</span> );</div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span>      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; auth = auths[0];</div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span>      <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( auth.actor == unlink.account, irrelevant_auth_exception,</div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span>                  <span class="stringliteral">&quot;the owner of the linked permission needs to be the actor of the declared authorization&quot;</span> );</div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span> </div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span>      <span class="keyword">const</span> <span class="keyword">auto</span> unlinked_permission_name = lookup_linked_permission(unlink.account, unlink.code, unlink.type);</div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span>      <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( unlinked_permission_name, <a class="code hl_variable" href="namespacesysio_1_1chain.html#a5dfe17906469eaf079c180c1afb4ad94">transaction_exception</a>,</div>
<div class="line"><a id="l00411" name="l00411"></a><span class="lineno">  411</span>                  <span class="stringliteral">&quot;cannot unlink non-existent permission link of account &#39;${account}&#39; for actions matching &#39;${code}::${action}&#39;&quot;</span>,</div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno">  412</span>                  (<span class="stringliteral">&quot;account&quot;</span>, unlink.account)(<span class="stringliteral">&quot;code&quot;</span>, unlink.code)(<span class="stringliteral">&quot;action&quot;</span>, unlink.type) );</div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span> </div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span>      <span class="keywordflow">if</span>( *unlinked_permission_name == config::sysio_any_name )</div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span>         <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span> </div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span>      <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( <a class="code hl_function" href="classsysio_1_1chain_1_1authorization__manager.html#a96924f6aca32a602e24d991d12278a69">get_permission</a>(auth).satisfies( <a class="code hl_function" href="classsysio_1_1chain_1_1authorization__manager.html#a96924f6aca32a602e24d991d12278a69">get_permission</a>({unlink.account, *unlinked_permission_name}),</div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span>                                                  _db.<a class="code hl_function" href="classchainbase_1_1database.html#a4d5297635dcf70be481d9b600da9bc13">get_index</a>&lt;<a class="code hl_typedef" href="namespacesysio_1_1chain.html#a4e24a1668746342d40487d1019880986">permission_index</a>&gt;().indices()                  ),</div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span>                  irrelevant_auth_exception,</div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span>                  <span class="stringliteral">&quot;unlink action declares irrelevant authority &#39;${auth}&#39;; minimum authority is ${min}&quot;</span>,</div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span>                  (<span class="stringliteral">&quot;auth&quot;</span>, auth)(<span class="stringliteral">&quot;min&quot;</span>, permission_level{unlink.account, *unlinked_permission_name}) );</div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span>   }</div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span> </div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno">  424</span>   <a class="code hl_class" href="classfc_1_1microseconds.html">fc::microseconds</a> authorization_manager::check_canceldelay_authorization( <span class="keyword">const</span> canceldelay&amp; cancel,</div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span>                                                                            <span class="keyword">const</span> vector&lt;permission_level&gt;&amp; auths</div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span>                                                                          )<span class="keyword">const</span></div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span><span class="keyword">   </span>{</div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span>      <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( auths.size() == 1, irrelevant_auth_exception,</div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span>                  <span class="stringliteral">&quot;canceldelay action should only have one declared authorization&quot;</span> );</div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span>      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; auth = auths[0];</div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span> </div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span>      <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( <a class="code hl_function" href="classsysio_1_1chain_1_1authorization__manager.html#a96924f6aca32a602e24d991d12278a69">get_permission</a>(auth).satisfies( <a class="code hl_function" href="classsysio_1_1chain_1_1authorization__manager.html#a96924f6aca32a602e24d991d12278a69">get_permission</a>(cancel.canceling_auth),</div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span>                                                  _db.<a class="code hl_function" href="classchainbase_1_1database.html#a4d5297635dcf70be481d9b600da9bc13">get_index</a>&lt;<a class="code hl_typedef" href="namespacesysio_1_1chain.html#a4e24a1668746342d40487d1019880986">permission_index</a>&gt;().indices() ),</div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span>                  irrelevant_auth_exception,</div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span>                  <span class="stringliteral">&quot;canceldelay action declares irrelevant authority &#39;${auth}&#39;; specified authority to satisfy is ${min}&quot;</span>,</div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span>                  (<span class="stringliteral">&quot;auth&quot;</span>, auth)(<span class="stringliteral">&quot;min&quot;</span>, cancel.canceling_auth) );</div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span> </div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span>      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; trx_id = cancel.trx_id;</div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span> </div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span>      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; generated_transaction_idx = _control.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a0c79d00dae8c0d90efc18f4d091b2391">db</a>().<a class="code hl_function" href="classchainbase_1_1database.html#a4d5297635dcf70be481d9b600da9bc13">get_index</a>&lt;<a class="code hl_typedef" href="namespacesysio_1_1chain.html#a9e9842ee49526c2423e014a696edc602">generated_transaction_multi_index</a>&gt;();</div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span>      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; generated_index = generated_transaction_idx.indices().get&lt;by_trx_id&gt;();</div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span>      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; itr = generated_index.lower_bound(trx_id);</div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span>      <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( itr != generated_index.end() &amp;&amp; itr-&gt;sender == <a class="code hl_typedef" href="namespacesysio_1_1chain.html#ac32ce8e75243f2b3f76aff0c1984f11b">account_name</a>() &amp;&amp; itr-&gt;trx_id == trx_id,</div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span>                  tx_not_found,</div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno">  445</span>                 <span class="stringliteral">&quot;cannot cancel trx_id=${tid}, there is no deferred transaction with that transaction id&quot;</span>,</div>
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno">  446</span>                 (<span class="stringliteral">&quot;tid&quot;</span>, trx_id) );</div>
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno">  447</span> </div>
<div class="line"><a id="l00448" name="l00448"></a><span class="lineno">  448</span>      <span class="keyword">auto</span> trx = <a class="code hl_function" href="namespacefc_1_1raw.html#a0b442d98ceb22dd5a6ae84745e43ffab">fc::raw::unpack&lt;transaction&gt;</a>(itr-&gt;packed_trx.data(), itr-&gt;packed_trx.size());</div>
<div class="line"><a id="l00449" name="l00449"></a><span class="lineno">  449</span>      <span class="keywordtype">bool</span> found = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00450" name="l00450"></a><span class="lineno">  450</span>      <span class="keywordflow">for</span>( <span class="keyword">const</span> <span class="keyword">auto</span>&amp; act : trx.actions ) {</div>
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno">  451</span>         <span class="keywordflow">for</span>( <span class="keyword">const</span> <span class="keyword">auto</span>&amp; auth : act.authorization ) {</div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno">  452</span>            <span class="keywordflow">if</span>( auth == cancel.canceling_auth ) {</div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span>               found = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span>               <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno">  455</span>            }</div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span>         }</div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span>         <span class="keywordflow">if</span>( found ) <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span>      }</div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span> </div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span>      <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( found, <a class="code hl_variable" href="namespacesysio_1_1chain.html#a764b50974b9b72a0e233e72176913d6b">action_validate_exception</a>,</div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span>                  <span class="stringliteral">&quot;canceling_auth in canceldelay action was not found as authorization in the original delayed transaction&quot;</span> );</div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span> </div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span>      <span class="keywordflow">return</span> (itr-&gt;delay_until - itr-&gt;published);</div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno">  464</span>   }</div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span> </div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno"><a class="line" href="namespacesysio_1_1chain.html#a057ec53a1f8d23b2fb89de6c19b41c32">  466</a></span>   <span class="keywordtype">void</span> <a class="code hl_function" href="namespacesysio_1_1chain.html#a057ec53a1f8d23b2fb89de6c19b41c32">noop_checktime</a>() {}</div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno">  467</span> </div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno">  468</span>   std::function&lt;void()&gt; <a class="code hl_variable" href="classsysio_1_1chain_1_1authorization__manager.html#a1e4aa0f280bcaa3057bc2970063f74b8">authorization_manager::_noop_checktime</a>{&amp;<a class="code hl_function" href="namespacesysio_1_1chain.html#a057ec53a1f8d23b2fb89de6c19b41c32">noop_checktime</a>};</div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno">  469</span> </div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span>   <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00471" data-start="{" data-end="}">
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1authorization__manager.html#a8566f4407e33eb1e4029455e4feae2f1">  471</a></span>   <a class="code hl_function" href="classsysio_1_1chain_1_1authorization__manager.html#a8566f4407e33eb1e4029455e4feae2f1">authorization_manager::check_authorization</a>( <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1vector.html">vector&lt;action&gt;</a>&amp;                actions,</div>
<div class="line"><a id="l00472" name="l00472"></a><span class="lineno">  472</span>                                               <span class="keyword">const</span> flat_set&lt;public_key_type&gt;&amp;     provided_keys,</div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno">  473</span>                                               <span class="keyword">const</span> flat_set&lt;permission_level&gt;&amp;    provided_permissions,</div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno">  474</span>                                               <a class="code hl_class" href="classfc_1_1microseconds.html">fc::microseconds</a>                     provided_delay,</div>
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno">  475</span>                                               <span class="keyword">const</span> std::function&lt;<span class="keywordtype">void</span>()&gt;&amp;         _checktime,</div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span>                                               <span class="keywordtype">bool</span>                                 allow_unused_keys,</div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno">  477</span>                                               <span class="keywordtype">bool</span>                                 check_but_dont_fail,</div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno">  478</span>                                               <span class="keyword">const</span> flat_set&lt;permission_level&gt;&amp;    satisfied_authorizations</div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno">  479</span>                                             )<span class="keyword">const</span></div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno">  480</span><span class="keyword">   </span>{</div>
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno">  481</span>      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; checktime = ( <span class="keyword">static_cast&lt;</span><span class="keywordtype">bool</span><span class="keyword">&gt;</span>(_checktime) ? _checktime : <a class="code hl_variable" href="classsysio_1_1chain_1_1authorization__manager.html#a1e4aa0f280bcaa3057bc2970063f74b8">_noop_checktime</a> );</div>
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno">  482</span> </div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span>      <span class="keyword">auto</span> delay_max_limit = <a class="code hl_function" href="namespacefc.html#a9623b8cae3f48bbed6aa1fc2afe9b174">fc::seconds</a>( _control.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a0bb11e832a05b6437c79bf81758b1b7d">get_global_properties</a>().<a class="code hl_variable" href="classsysio_1_1chain_1_1global__property__object.html#a7f149fcf87034217c899838eb4430496">configuration</a>.<a class="code hl_variable" href="structsysio_1_1chain_1_1chain__config__v0.html#ad98015ab0842f0258be2df72e7ace5e3">max_transaction_delay</a> );</div>
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno">  484</span> </div>
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno">  485</span>      <span class="keyword">auto</span> effective_provided_delay =  (provided_delay &gt;= delay_max_limit) ? <a class="code hl_function" href="classfc_1_1microseconds.html#afc3eb0bfd792c7b1cda062e559e30c2e">fc::microseconds::maximum</a>() : provided_delay;</div>
<div class="line"><a id="l00486" name="l00486"></a><span class="lineno">  486</span> </div>
<div class="line"><a id="l00487" name="l00487"></a><span class="lineno">  487</span>      <span class="keyword">auto</span> checker = <a class="code hl_function" href="namespacesysio_1_1chain.html#a9935b13f160accddca2509476a2cad8b">make_auth_checker</a>( [&amp;](<span class="keyword">const</span> <a class="code hl_struct" href="structsysio_1_1chain_1_1permission__level.html">permission_level</a>&amp; <a class="code hl_variable" href="bn_8cpp.html#a8b0eadcc506862e9d751ab45185053aa">p</a>){ <span class="keywordflow">return</span> <a class="code hl_function" href="classsysio_1_1chain_1_1authorization__manager.html#a96924f6aca32a602e24d991d12278a69">get_permission</a>(<a class="code hl_variable" href="bn_8cpp.html#a8b0eadcc506862e9d751ab45185053aa">p</a>).auth; },</div>
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno">  488</span>                                        _control.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a0bb11e832a05b6437c79bf81758b1b7d">get_global_properties</a>().configuration.max_authority_depth,</div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno">  489</span>                                        provided_keys,</div>
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno">  490</span>                                        provided_permissions,</div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno">  491</span>                                        effective_provided_delay,</div>
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno">  492</span>                                        checktime</div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno">  493</span>                                      );</div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span> </div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno">  495</span>      map&lt;permission_level, fc::microseconds&gt; permissions_to_satisfy;</div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno">  496</span> </div>
<div class="line"><a id="l00497" name="l00497"></a><span class="lineno">  497</span>      <span class="keywordflow">for</span>( <span class="keyword">const</span> <span class="keyword">auto</span>&amp; act : actions ) {</div>
<div class="line"><a id="l00498" name="l00498"></a><span class="lineno">  498</span>         <span class="keywordtype">bool</span> special_case = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00499" name="l00499"></a><span class="lineno">  499</span>         <a class="code hl_class" href="classfc_1_1microseconds.html">fc::microseconds</a> delay = effective_provided_delay;</div>
<div class="line"><a id="l00500" name="l00500"></a><span class="lineno">  500</span> </div>
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno">  501</span>         <span class="keywordflow">if</span>( act.account == config::system_account_name ) {</div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno">  502</span>            special_case = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span> </div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span>            <span class="keywordflow">if</span>( act.name == <a class="code hl_function" href="structsysio_1_1chain_1_1updateauth.html#afc31c0680242885924f64fc347780814">updateauth::get_name</a>() ) {</div>
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno">  505</span>               check_updateauth_authorization( act.data_as&lt;<a class="code hl_struct" href="structsysio_1_1chain_1_1updateauth.html">updateauth</a>&gt;(), act.authorization );</div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno">  506</span>            } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( act.name == <a class="code hl_function" href="structsysio_1_1chain_1_1deleteauth.html#add712cbf63b55d0e2db2b874dca6576d">deleteauth::get_name</a>() ) {</div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span>               check_deleteauth_authorization( act.data_as&lt;<a class="code hl_struct" href="structsysio_1_1chain_1_1deleteauth.html">deleteauth</a>&gt;(), act.authorization );</div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span>            } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( act.name == <a class="code hl_function" href="structsysio_1_1chain_1_1linkauth.html#a41eafdd131f5b3c8a8b7688449986f2b">linkauth::get_name</a>() ) {</div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno">  509</span>               check_linkauth_authorization( act.data_as&lt;<a class="code hl_struct" href="structsysio_1_1chain_1_1linkauth.html">linkauth</a>&gt;(), act.authorization );</div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span>            } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( act.name == <a class="code hl_function" href="structsysio_1_1chain_1_1unlinkauth.html#a438dbc3c8575ab1f129c0fdd5c074327">unlinkauth::get_name</a>() ) {</div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span>               check_unlinkauth_authorization( act.data_as&lt;<a class="code hl_struct" href="structsysio_1_1chain_1_1unlinkauth.html">unlinkauth</a>&gt;(), act.authorization );</div>
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno">  512</span>            } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( act.name ==  <a class="code hl_function" href="structsysio_1_1chain_1_1canceldelay.html#a23c3d201f9917509b74001716daf254f">canceldelay::get_name</a>() ) {</div>
<div class="line"><a id="l00513" name="l00513"></a><span class="lineno">  513</span>               delay = std::max( delay, check_canceldelay_authorization(act.data_as&lt;<a class="code hl_struct" href="structsysio_1_1chain_1_1canceldelay.html">canceldelay</a>&gt;(), act.authorization) );</div>
<div class="line"><a id="l00514" name="l00514"></a><span class="lineno">  514</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno">  515</span>               special_case = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span>            }</div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span>         }</div>
<div class="line"><a id="l00518" name="l00518"></a><span class="lineno">  518</span> </div>
<div class="line"><a id="l00519" name="l00519"></a><span class="lineno">  519</span>         <span class="keywordflow">for</span>( <span class="keyword">const</span> <span class="keyword">auto</span>&amp; declared_auth : act.authorization ) {</div>
<div class="line"><a id="l00520" name="l00520"></a><span class="lineno">  520</span> </div>
<div class="line"><a id="l00521" name="l00521"></a><span class="lineno">  521</span>            checktime();</div>
<div class="line"><a id="l00522" name="l00522"></a><span class="lineno">  522</span> </div>
<div class="line"><a id="l00523" name="l00523"></a><span class="lineno">  523</span>            <span class="keywordflow">if</span>( !special_case ) {</div>
<div class="line"><a id="l00524" name="l00524"></a><span class="lineno">  524</span>               <span class="keyword">auto</span> min_permission_name = <a class="code hl_function" href="classsysio_1_1chain_1_1authorization__manager.html#a6193726fcf21c9b75f460696a67b6839">lookup_minimum_permission</a>(declared_auth.actor, act.account, act.name);</div>
<div class="line"><a id="l00525" name="l00525"></a><span class="lineno">  525</span>               <span class="keywordflow">if</span>( min_permission_name ) { <span class="comment">// since special cases were already handled, it should only be false if the permission is sysio.any</span></div>
<div class="line"><a id="l00526" name="l00526"></a><span class="lineno">  526</span>                  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; min_permission = <a class="code hl_function" href="classsysio_1_1chain_1_1authorization__manager.html#a96924f6aca32a602e24d991d12278a69">get_permission</a>({declared_auth.actor, *min_permission_name});</div>
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno">  527</span>                  <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( <a class="code hl_function" href="classsysio_1_1chain_1_1authorization__manager.html#a96924f6aca32a602e24d991d12278a69">get_permission</a>(declared_auth).satisfies( min_permission,</div>
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno">  528</span>                                                                       _db.<a class="code hl_function" href="classchainbase_1_1database.html#a4d5297635dcf70be481d9b600da9bc13">get_index</a>&lt;<a class="code hl_typedef" href="namespacesysio_1_1chain.html#a4e24a1668746342d40487d1019880986">permission_index</a>&gt;().indices() ),</div>
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno">  529</span>                              irrelevant_auth_exception,</div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span>                              <span class="stringliteral">&quot;action declares irrelevant authority &#39;${auth}&#39;; minimum authority is ${min}&quot;</span>,</div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span>                              (<span class="stringliteral">&quot;auth&quot;</span>, declared_auth)(<span class="stringliteral">&quot;min&quot;</span>, <a class="code hl_struct" href="structsysio_1_1chain_1_1permission__level.html">permission_level</a>{min_permission.owner, min_permission.name}) );</div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno">  532</span>               }</div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span>            }</div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span> </div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno">  535</span>            <span class="keywordflow">if</span>( satisfied_authorizations.find( declared_auth ) == satisfied_authorizations.end() ) {</div>
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno">  536</span>               <span class="keyword">auto</span> res = permissions_to_satisfy.emplace( declared_auth, delay );</div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span>               <span class="keywordflow">if</span>( !res.second &amp;&amp; res.first-&gt;second &gt; delay) { <span class="comment">// if the declared_auth was already in the map and with a higher delay</span></div>
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno">  538</span>                  res.first-&gt;second = <a class="code hl_function" href="integration_8cpp.html#a6e9635897de7740b7389a391f613626b">delay</a>;</div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span>               }</div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span>            }</div>
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno">  541</span>         }</div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno">  542</span>      }</div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span> </div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno">  544</span>      <span class="comment">// Now verify that all the declared authorizations are satisfied:</span></div>
<div class="line"><a id="l00545" name="l00545"></a><span class="lineno">  545</span> </div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno">  546</span>      <span class="comment">// Although this can be made parallel (especially for input transactions) with the optimistic assumption that the</span></div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno">  547</span>      <span class="comment">// CPU limit is not reached, because of the CPU limit the protocol must officially specify a sequential algorithm</span></div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno">  548</span>      <span class="comment">// for checking the set of declared authorizations.</span></div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno">  549</span>      <span class="comment">// The permission_levels are traversed in ascending order, which is:</span></div>
<div class="line"><a id="l00550" name="l00550"></a><span class="lineno">  550</span>      <span class="comment">// ascending order of the actor name with ties broken by ascending order of the permission name.</span></div>
<div class="line"><a id="l00551" name="l00551"></a><span class="lineno">  551</span>      <span class="keywordflow">for</span>( <span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code hl_variable" href="bn_8cpp.html#a8b0eadcc506862e9d751ab45185053aa">p</a> : permissions_to_satisfy ) {</div>
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno">  552</span>         checktime(); <span class="comment">// TODO: this should eventually move into authority_checker instead</span></div>
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno">  553</span>         <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( checker.satisfied( <a class="code hl_variable" href="bn_8cpp.html#a8b0eadcc506862e9d751ab45185053aa">p</a>.first, <a class="code hl_variable" href="bn_8cpp.html#a8b0eadcc506862e9d751ab45185053aa">p</a>.second ) || check_but_dont_fail, unsatisfied_authorization,</div>
<div class="line"><a id="l00554" name="l00554"></a><span class="lineno">  554</span>                     <span class="stringliteral">&quot;transaction declares authority &#39;${auth}&#39;, &quot;</span></div>
<div class="line"><a id="l00555" name="l00555"></a><span class="lineno">  555</span>                     <span class="stringliteral">&quot;but does not have signatures for it under a provided delay of ${provided_delay} ms, &quot;</span></div>
<div class="line"><a id="l00556" name="l00556"></a><span class="lineno">  556</span>                     <span class="stringliteral">&quot;provided permissions ${provided_permissions}, provided keys ${provided_keys}, &quot;</span></div>
<div class="line"><a id="l00557" name="l00557"></a><span class="lineno">  557</span>                     <span class="stringliteral">&quot;and a delay max limit of ${delay_max_limit_ms} ms&quot;</span>,</div>
<div class="line"><a id="l00558" name="l00558"></a><span class="lineno">  558</span>                     (<span class="stringliteral">&quot;auth&quot;</span>, <a class="code hl_variable" href="bn_8cpp.html#a8b0eadcc506862e9d751ab45185053aa">p</a>.first)</div>
<div class="line"><a id="l00559" name="l00559"></a><span class="lineno">  559</span>                     (<span class="stringliteral">&quot;provided_delay&quot;</span>, provided_delay.<a class="code hl_function" href="classfc_1_1microseconds.html#a20fba59ec7e1f50c6b8f2c9443cc9b92">count</a>()/1000)</div>
<div class="line"><a id="l00560" name="l00560"></a><span class="lineno">  560</span>                     (<span class="stringliteral">&quot;provided_permissions&quot;</span>, provided_permissions)</div>
<div class="line"><a id="l00561" name="l00561"></a><span class="lineno">  561</span>                     (<span class="stringliteral">&quot;provided_keys&quot;</span>, provided_keys)</div>
<div class="line"><a id="l00562" name="l00562"></a><span class="lineno">  562</span>                     (<span class="stringliteral">&quot;delay_max_limit_ms&quot;</span>, delay_max_limit.count()/1000)</div>
<div class="line"><a id="l00563" name="l00563"></a><span class="lineno">  563</span>                   );</div>
<div class="line"><a id="l00564" name="l00564"></a><span class="lineno">  564</span> </div>
<div class="line"><a id="l00565" name="l00565"></a><span class="lineno">  565</span>      }</div>
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno">  566</span> </div>
<div class="line"><a id="l00567" name="l00567"></a><span class="lineno">  567</span>      <span class="keywordflow">if</span>( !allow_unused_keys  || check_but_dont_fail) {</div>
<div class="line"><a id="l00568" name="l00568"></a><span class="lineno">  568</span>         <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( checker.all_keys_used(), tx_irrelevant_sig,</div>
<div class="line"><a id="l00569" name="l00569"></a><span class="lineno">  569</span>                     <span class="stringliteral">&quot;transaction bears irrelevant signatures from these keys: ${keys}&quot;</span>,</div>
<div class="line"><a id="l00570" name="l00570"></a><span class="lineno">  570</span>                     (<span class="stringliteral">&quot;keys&quot;</span>, checker.unused_keys()) );</div>
<div class="line"><a id="l00571" name="l00571"></a><span class="lineno">  571</span>      }</div>
<div class="line"><a id="l00572" name="l00572"></a><span class="lineno">  572</span>   }</div>
</div>
<div class="line"><a id="l00573" name="l00573"></a><span class="lineno">  573</span> </div>
<div class="line"><a id="l00574" name="l00574"></a><span class="lineno">  574</span>   <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00575" data-start="{" data-end="}">
<div class="line"><a id="l00575" name="l00575"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1authorization__manager.html#a9f6cf6c813f4a578fddc10cf24aa396a">  575</a></span>   <a class="code hl_function" href="classsysio_1_1chain_1_1authorization__manager.html#a8566f4407e33eb1e4029455e4feae2f1">authorization_manager::check_authorization</a>( <a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">account_name</a>                         account,</div>
<div class="line"><a id="l00576" name="l00576"></a><span class="lineno">  576</span>                                               <a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">permission_name</a>                      permission,</div>
<div class="line"><a id="l00577" name="l00577"></a><span class="lineno">  577</span>                                               <span class="keyword">const</span> flat_set&lt;public_key_type&gt;&amp;     provided_keys,</div>
<div class="line"><a id="l00578" name="l00578"></a><span class="lineno">  578</span>                                               <span class="keyword">const</span> flat_set&lt;permission_level&gt;&amp;    provided_permissions,</div>
<div class="line"><a id="l00579" name="l00579"></a><span class="lineno">  579</span>                                               <a class="code hl_class" href="classfc_1_1microseconds.html">fc::microseconds</a>                     provided_delay,</div>
<div class="line"><a id="l00580" name="l00580"></a><span class="lineno">  580</span>                                               <span class="keyword">const</span> std::function&lt;<span class="keywordtype">void</span>()&gt;&amp;         _checktime,</div>
<div class="line"><a id="l00581" name="l00581"></a><span class="lineno">  581</span>                                               <span class="keywordtype">bool</span>                                 allow_unused_keys</div>
<div class="line"><a id="l00582" name="l00582"></a><span class="lineno">  582</span>                                             )<span class="keyword">const</span></div>
<div class="line"><a id="l00583" name="l00583"></a><span class="lineno">  583</span><span class="keyword">   </span>{</div>
<div class="line"><a id="l00584" name="l00584"></a><span class="lineno">  584</span>      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; checktime = ( <span class="keyword">static_cast&lt;</span><span class="keywordtype">bool</span><span class="keyword">&gt;</span>(_checktime) ? _checktime : <a class="code hl_variable" href="classsysio_1_1chain_1_1authorization__manager.html#a1e4aa0f280bcaa3057bc2970063f74b8">_noop_checktime</a> );</div>
<div class="line"><a id="l00585" name="l00585"></a><span class="lineno">  585</span> </div>
<div class="line"><a id="l00586" name="l00586"></a><span class="lineno">  586</span>      <span class="keyword">auto</span> delay_max_limit = <a class="code hl_function" href="namespacefc.html#a9623b8cae3f48bbed6aa1fc2afe9b174">fc::seconds</a>( _control.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a0bb11e832a05b6437c79bf81758b1b7d">get_global_properties</a>().<a class="code hl_variable" href="classsysio_1_1chain_1_1global__property__object.html#a7f149fcf87034217c899838eb4430496">configuration</a>.<a class="code hl_variable" href="structsysio_1_1chain_1_1chain__config__v0.html#ad98015ab0842f0258be2df72e7ace5e3">max_transaction_delay</a> );</div>
<div class="line"><a id="l00587" name="l00587"></a><span class="lineno">  587</span> </div>
<div class="line"><a id="l00588" name="l00588"></a><span class="lineno">  588</span>      <span class="keyword">auto</span> checker = <a class="code hl_function" href="namespacesysio_1_1chain.html#a9935b13f160accddca2509476a2cad8b">make_auth_checker</a>( [&amp;](<span class="keyword">const</span> <a class="code hl_struct" href="structsysio_1_1chain_1_1permission__level.html">permission_level</a>&amp; <a class="code hl_variable" href="bn_8cpp.html#a8b0eadcc506862e9d751ab45185053aa">p</a>){ <span class="keywordflow">return</span> <a class="code hl_function" href="classsysio_1_1chain_1_1authorization__manager.html#a96924f6aca32a602e24d991d12278a69">get_permission</a>(<a class="code hl_variable" href="bn_8cpp.html#a8b0eadcc506862e9d751ab45185053aa">p</a>).auth; },</div>
<div class="line"><a id="l00589" name="l00589"></a><span class="lineno">  589</span>                                        _control.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a0bb11e832a05b6437c79bf81758b1b7d">get_global_properties</a>().configuration.max_authority_depth,</div>
<div class="line"><a id="l00590" name="l00590"></a><span class="lineno">  590</span>                                        provided_keys,</div>
<div class="line"><a id="l00591" name="l00591"></a><span class="lineno">  591</span>                                        provided_permissions,</div>
<div class="line"><a id="l00592" name="l00592"></a><span class="lineno">  592</span>                                        ( provided_delay &gt;= delay_max_limit ) ? <a class="code hl_function" href="classfc_1_1microseconds.html#afc3eb0bfd792c7b1cda062e559e30c2e">fc::microseconds::maximum</a>() : provided_delay,</div>
<div class="line"><a id="l00593" name="l00593"></a><span class="lineno">  593</span>                                        checktime</div>
<div class="line"><a id="l00594" name="l00594"></a><span class="lineno">  594</span>                                      );</div>
<div class="line"><a id="l00595" name="l00595"></a><span class="lineno">  595</span> </div>
<div class="line"><a id="l00596" name="l00596"></a><span class="lineno">  596</span>      <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( checker.satisfied({account, permission}), unsatisfied_authorization,</div>
<div class="line"><a id="l00597" name="l00597"></a><span class="lineno">  597</span>                  <span class="stringliteral">&quot;permission &#39;${auth}&#39; was not satisfied under a provided delay of ${provided_delay} ms, &quot;</span></div>
<div class="line"><a id="l00598" name="l00598"></a><span class="lineno">  598</span>                  <span class="stringliteral">&quot;provided permissions ${provided_permissions}, provided keys ${provided_keys}, &quot;</span></div>
<div class="line"><a id="l00599" name="l00599"></a><span class="lineno">  599</span>                  <span class="stringliteral">&quot;and a delay max limit of ${delay_max_limit_ms} ms&quot;</span>,</div>
<div class="line"><a id="l00600" name="l00600"></a><span class="lineno">  600</span>                  (<span class="stringliteral">&quot;auth&quot;</span>, <a class="code hl_struct" href="structsysio_1_1chain_1_1permission__level.html">permission_level</a>{account, permission})</div>
<div class="line"><a id="l00601" name="l00601"></a><span class="lineno">  601</span>                  (<span class="stringliteral">&quot;provided_delay&quot;</span>, provided_delay.<a class="code hl_function" href="classfc_1_1microseconds.html#a20fba59ec7e1f50c6b8f2c9443cc9b92">count</a>()/1000)</div>
<div class="line"><a id="l00602" name="l00602"></a><span class="lineno">  602</span>                  (<span class="stringliteral">&quot;provided_permissions&quot;</span>, provided_permissions)</div>
<div class="line"><a id="l00603" name="l00603"></a><span class="lineno">  603</span>                  (<span class="stringliteral">&quot;provided_keys&quot;</span>, provided_keys)</div>
<div class="line"><a id="l00604" name="l00604"></a><span class="lineno">  604</span>                  (<span class="stringliteral">&quot;delay_max_limit_ms&quot;</span>, delay_max_limit.count()/1000)</div>
<div class="line"><a id="l00605" name="l00605"></a><span class="lineno">  605</span>                );</div>
<div class="line"><a id="l00606" name="l00606"></a><span class="lineno">  606</span> </div>
<div class="line"><a id="l00607" name="l00607"></a><span class="lineno">  607</span>      <span class="keywordflow">if</span>( !allow_unused_keys ) {</div>
<div class="line"><a id="l00608" name="l00608"></a><span class="lineno">  608</span>         <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( checker.all_keys_used(), tx_irrelevant_sig,</div>
<div class="line"><a id="l00609" name="l00609"></a><span class="lineno">  609</span>                     <span class="stringliteral">&quot;irrelevant keys provided: ${keys}&quot;</span>,</div>
<div class="line"><a id="l00610" name="l00610"></a><span class="lineno">  610</span>                     (<span class="stringliteral">&quot;keys&quot;</span>, checker.unused_keys()) );</div>
<div class="line"><a id="l00611" name="l00611"></a><span class="lineno">  611</span>      }</div>
<div class="line"><a id="l00612" name="l00612"></a><span class="lineno">  612</span>   }</div>
</div>
<div class="line"><a id="l00613" name="l00613"></a><span class="lineno">  613</span> </div>
<div class="foldopen" id="foldopen00614" data-start="{" data-end="}">
<div class="line"><a id="l00614" name="l00614"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1authorization__manager.html#ac1e69cb344bd39871d1c92993a491e95">  614</a></span>   flat_set&lt;public_key_type&gt; <a class="code hl_function" href="classsysio_1_1chain_1_1authorization__manager.html#ac1e69cb344bd39871d1c92993a491e95">authorization_manager::get_required_keys</a>( <span class="keyword">const</span> <a class="code hl_struct" href="structsysio_1_1chain_1_1transaction.html">transaction</a>&amp; trx,</div>
<div class="line"><a id="l00615" name="l00615"></a><span class="lineno">  615</span>                                                                       <span class="keyword">const</span> flat_set&lt;public_key_type&gt;&amp; candidate_keys,</div>
<div class="line"><a id="l00616" name="l00616"></a><span class="lineno">  616</span>                                                                       <a class="code hl_class" href="classfc_1_1microseconds.html">fc::microseconds</a> provided_delay</div>
<div class="line"><a id="l00617" name="l00617"></a><span class="lineno">  617</span>                                                                     )<span class="keyword">const</span></div>
<div class="line"><a id="l00618" name="l00618"></a><span class="lineno">  618</span><span class="keyword">   </span>{</div>
<div class="line"><a id="l00619" name="l00619"></a><span class="lineno">  619</span>      <span class="keyword">auto</span> checker = <a class="code hl_function" href="namespacesysio_1_1chain.html#a9935b13f160accddca2509476a2cad8b">make_auth_checker</a>( [&amp;](<span class="keyword">const</span> <a class="code hl_struct" href="structsysio_1_1chain_1_1permission__level.html">permission_level</a>&amp; <a class="code hl_variable" href="bn_8cpp.html#a8b0eadcc506862e9d751ab45185053aa">p</a>){ <span class="keywordflow">return</span> <a class="code hl_function" href="classsysio_1_1chain_1_1authorization__manager.html#a96924f6aca32a602e24d991d12278a69">get_permission</a>(<a class="code hl_variable" href="bn_8cpp.html#a8b0eadcc506862e9d751ab45185053aa">p</a>).auth; },</div>
<div class="line"><a id="l00620" name="l00620"></a><span class="lineno">  620</span>                                        _control.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a0bb11e832a05b6437c79bf81758b1b7d">get_global_properties</a>().configuration.max_authority_depth,</div>
<div class="line"><a id="l00621" name="l00621"></a><span class="lineno">  621</span>                                        candidate_keys,</div>
<div class="line"><a id="l00622" name="l00622"></a><span class="lineno">  622</span>                                        {},</div>
<div class="line"><a id="l00623" name="l00623"></a><span class="lineno">  623</span>                                        provided_delay,</div>
<div class="line"><a id="l00624" name="l00624"></a><span class="lineno">  624</span>                                        <a class="code hl_variable" href="classsysio_1_1chain_1_1authorization__manager.html#a1e4aa0f280bcaa3057bc2970063f74b8">_noop_checktime</a></div>
<div class="line"><a id="l00625" name="l00625"></a><span class="lineno">  625</span>                                      );</div>
<div class="line"><a id="l00626" name="l00626"></a><span class="lineno">  626</span> </div>
<div class="line"><a id="l00627" name="l00627"></a><span class="lineno">  627</span>      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; act : trx.<a class="code hl_variable" href="structsysio_1_1chain_1_1transaction.html#a407fcf1868b81bb30b85f80d388bbac2">actions</a> ) {</div>
<div class="line"><a id="l00628" name="l00628"></a><span class="lineno">  628</span>         <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; declared_auth : act.authorization) {</div>
<div class="line"><a id="l00629" name="l00629"></a><span class="lineno">  629</span>            <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( checker.satisfied(declared_auth), unsatisfied_authorization,</div>
<div class="line"><a id="l00630" name="l00630"></a><span class="lineno">  630</span>                        <span class="stringliteral">&quot;transaction declares authority &#39;${auth}&#39;, but does not have signatures for it.&quot;</span>,</div>
<div class="line"><a id="l00631" name="l00631"></a><span class="lineno">  631</span>                        (<span class="stringliteral">&quot;auth&quot;</span>, declared_auth) );</div>
<div class="line"><a id="l00632" name="l00632"></a><span class="lineno">  632</span>         }</div>
<div class="line"><a id="l00633" name="l00633"></a><span class="lineno">  633</span>      }</div>
<div class="line"><a id="l00634" name="l00634"></a><span class="lineno">  634</span> </div>
<div class="line"><a id="l00635" name="l00635"></a><span class="lineno">  635</span>      <span class="keywordflow">return</span> checker.used_keys();</div>
<div class="line"><a id="l00636" name="l00636"></a><span class="lineno">  636</span>   }</div>
</div>
<div class="line"><a id="l00637" name="l00637"></a><span class="lineno">  637</span> </div>
<div class="line"><a id="l00638" name="l00638"></a><span class="lineno">  638</span>} } </div>
<div class="ttc" id="aauthority__checker_8hpp_html"><div class="ttname"><a href="authority__checker_8hpp.html">authority_checker.hpp</a></div></div>
<div class="ttc" id="aauthorization__manager_8hpp_html"><div class="ttname"><a href="authorization__manager_8hpp.html">authorization_manager.hpp</a></div></div>
<div class="ttc" id="abn_8cpp_html_a8b0eadcc506862e9d751ab45185053aa"><div class="ttname"><a href="bn_8cpp.html#a8b0eadcc506862e9d751ab45185053aa">p</a></div><div class="ttdeci">const mie::Vuint &amp; p</div><div class="ttdef"><b>Definition</b> <a href="bn_8cpp_source.html#l00027">bn.cpp:27</a></div></div>
<div class="ttc" id="acatch__reporter__console_8cpp_html_a9b45b3e13bd9167aab02e17e08916231"><div class="ttname"><a href="catch__reporter__console_8cpp.html#a9b45b3e13bd9167aab02e17e08916231">name</a></div><div class="ttdeci">std::string name</div><div class="ttdef"><b>Definition</b> <a href="catch__reporter__console_8cpp_source.html#l00186">catch_reporter_console.cpp:186</a></div></div>
<div class="ttc" id="achain_2include_2sysio_2chain_2exceptions_8hpp_html"><div class="ttname"><a href="chain_2include_2sysio_2chain_2exceptions_8hpp.html">exceptions.hpp</a></div></div>
<div class="ttc" id="achain_2include_2sysio_2chain_2exceptions_8hpp_html_a40c2826a6fba35c1ffbf912bdf559792"><div class="ttname"><a href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a></div><div class="ttdeci">#define SYS_ASSERT(expr, exc_type, FORMAT,...)</div><div class="ttdef"><b>Definition</b> <a href="chain_2include_2sysio_2chain_2exceptions_8hpp_source.html#l00007">exceptions.hpp:7</a></div></div>
<div class="ttc" id="achain_2include_2sysio_2chain_2exceptions_8hpp_html_a43bd817895cb757183fcecafc6ae7dc1"><div class="ttname"><a href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a43bd817895cb757183fcecafc6ae7dc1">SYS_RETHROW_EXCEPTIONS</a></div><div class="ttdeci">#define SYS_RETHROW_EXCEPTIONS(exception_type, FORMAT,...)</div><div class="ttdef"><b>Definition</b> <a href="chain_2include_2sysio_2chain_2exceptions_8hpp_source.html#l00021">exceptions.hpp:21</a></div></div>
<div class="ttc" id="aclasschainbase_1_1database_html"><div class="ttname"><a href="classchainbase_1_1database.html">chainbase::database</a></div><div class="ttdef"><b>Definition</b> <a href="chainbase_8hpp_source.html#l00252">chainbase.hpp:253</a></div></div>
<div class="ttc" id="aclasschainbase_1_1database_html_a4d5297635dcf70be481d9b600da9bc13"><div class="ttname"><a href="classchainbase_1_1database.html#a4d5297635dcf70be481d9b600da9bc13">chainbase::database::get_index</a></div><div class="ttdeci">const generic_index&lt; MultiIndexType &gt; &amp; get_index() const</div><div class="ttdef"><b>Definition</b> <a href="chainbase_8hpp_source.html#l00425">chainbase.hpp:425</a></div></div>
<div class="ttc" id="aclasschainbase_1_1database_html_a9ebc006075e8fc2e84357a0e068b58d4"><div class="ttname"><a href="classchainbase_1_1database.html#a9ebc006075e8fc2e84357a0e068b58d4">chainbase::database::modify</a></div><div class="ttdeci">void modify(const ObjectType &amp;obj, Modifier &amp;&amp;m)</div><div class="ttdef"><b>Definition</b> <a href="chainbase_8hpp_source.html#l00503">chainbase.hpp:503</a></div></div>
<div class="ttc" id="aclasschainbase_1_1database_html_aa5a2ca0da0092693ac49b36b7ec6817a"><div class="ttname"><a href="classchainbase_1_1database.html#aa5a2ca0da0092693ac49b36b7ec6817a">chainbase::database::find</a></div><div class="ttdeci">const ObjectType * find(CompatibleKey &amp;&amp;key) const</div><div class="ttdef"><b>Definition</b> <a href="chainbase_8hpp_source.html#l00458">chainbase.hpp:458</a></div></div>
<div class="ttc" id="aclasschainbase_1_1database_html_ac6bb29708e4fdfb6899028e3c351fe0b"><div class="ttname"><a href="classchainbase_1_1database.html#ac6bb29708e4fdfb6899028e3c351fe0b">chainbase::database::remove</a></div><div class="ttdeci">void remove(const ObjectType &amp;obj)</div><div class="ttdef"><b>Definition</b> <a href="chainbase_8hpp_source.html#l00511">chainbase.hpp:511</a></div></div>
<div class="ttc" id="aclasschainbase_1_1database_html_adc8f336b33d7013d1b0400399b16c5a7"><div class="ttname"><a href="classchainbase_1_1database.html#adc8f336b33d7013d1b0400399b16c5a7">chainbase::database::create</a></div><div class="ttdeci">const ObjectType &amp; create(Constructor &amp;&amp;con)</div><div class="ttdef"><b>Definition</b> <a href="chainbase_8hpp_source.html#l00519">chainbase.hpp:519</a></div></div>
<div class="ttc" id="aclasschainbase_1_1database_html_afaea057692a8bbbf3f506b64c60308b6"><div class="ttname"><a href="classchainbase_1_1database.html#afaea057692a8bbbf3f506b64c60308b6">chainbase::database::get_mutable_index</a></div><div class="ttdeci">generic_index&lt; MultiIndexType &gt; &amp; get_mutable_index()</div><div class="ttdef"><b>Definition</b> <a href="chainbase_8hpp_source.html#l00447">chainbase.hpp:447</a></div></div>
<div class="ttc" id="aclasschainbase_1_1database_html_afcfe00f81a526c1376d4f51197dd3a9a"><div class="ttname"><a href="classchainbase_1_1database.html#afcfe00f81a526c1376d4f51197dd3a9a">chainbase::database::get</a></div><div class="ttdeci">const ObjectType &amp; get(CompatibleKey &amp;&amp;key) const</div><div class="ttdef"><b>Definition</b> <a href="chainbase_8hpp_source.html#l00477">chainbase.hpp:477</a></div></div>
<div class="ttc" id="aclassfc_1_1crypto_1_1public__key_html_aa96a2da856cbba914572aa8629c06c09"><div class="ttname"><a href="classfc_1_1crypto_1_1public__key.html#aa96a2da856cbba914572aa8629c06c09">fc::crypto::public_key::which</a></div><div class="ttdeci">size_t which() const</div><div class="ttdef"><b>Definition</b> <a href="public__key_8cpp_source.html#l00027">public_key.cpp:27</a></div></div>
<div class="ttc" id="aclassfc_1_1microseconds_html"><div class="ttname"><a href="classfc_1_1microseconds.html">fc::microseconds</a></div><div class="ttdef"><b>Definition</b> <a href="include_2fc_2time_8hpp_source.html#l00011">time.hpp:11</a></div></div>
<div class="ttc" id="aclassfc_1_1microseconds_html_a20fba59ec7e1f50c6b8f2c9443cc9b92"><div class="ttname"><a href="classfc_1_1microseconds.html#a20fba59ec7e1f50c6b8f2c9443cc9b92">fc::microseconds::count</a></div><div class="ttdeci">constexpr int64_t count() const</div><div class="ttdef"><b>Definition</b> <a href="include_2fc_2time_8hpp_source.html#l00026">time.hpp:26</a></div></div>
<div class="ttc" id="aclassfc_1_1microseconds_html_afc3eb0bfd792c7b1cda062e559e30c2e"><div class="ttname"><a href="classfc_1_1microseconds.html#afc3eb0bfd792c7b1cda062e559e30c2e">fc::microseconds::maximum</a></div><div class="ttdeci">static constexpr microseconds maximum()</div><div class="ttdef"><b>Definition</b> <a href="include_2fc_2time_8hpp_source.html#l00014">time.hpp:14</a></div></div>
<div class="ttc" id="aclassfc_1_1time__point_html"><div class="ttname"><a href="classfc_1_1time__point.html">fc::time_point</a></div><div class="ttdef"><b>Definition</b> <a href="include_2fc_2time_8hpp_source.html#l00042">time.hpp:42</a></div></div>
<div class="ttc" id="aclassfc_1_1vector_html"><div class="ttname"><a href="classfc_1_1vector.html">fc::vector</a></div><div class="ttdef"><b>Definition</b> <a href="vector__fwd_8hpp_source.html#l00007">vector_fwd.hpp:7</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1authorization__manager_html_a00571cdbafaf86b7de83655d89229280"><div class="ttname"><a href="classsysio_1_1chain_1_1authorization__manager.html#a00571cdbafaf86b7de83655d89229280">sysio::chain::authorization_manager::authorization_manager</a></div><div class="ttdeci">authorization_manager(controller &amp;c, chainbase::database &amp;d)</div><div class="ttdef"><b>Definition</b> <a href="#l00024">authorization_manager.cpp:24</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1authorization__manager_html_a0909c7f81928fd8ffc4269861d12ad3f"><div class="ttname"><a href="classsysio_1_1chain_1_1authorization__manager.html#a0909c7f81928fd8ffc4269861d12ad3f">sysio::chain::authorization_manager::get_permission_last_used</a></div><div class="ttdeci">fc::time_point get_permission_last_used(const permission_object &amp;permission) const</div><div class="ttdef"><b>Definition</b> <a href="#l00247">authorization_manager.cpp:247</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1authorization__manager_html_a112c1fae696fe6f53103076e9afa5a16"><div class="ttname"><a href="classsysio_1_1chain_1_1authorization__manager.html#a112c1fae696fe6f53103076e9afa5a16">sysio::chain::authorization_manager::add_indices</a></div><div class="ttdeci">void add_indices()</div><div class="ttdef"><b>Definition</b> <a href="#l00027">authorization_manager.cpp:27</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1authorization__manager_html_a1e4aa0f280bcaa3057bc2970063f74b8"><div class="ttname"><a href="classsysio_1_1chain_1_1authorization__manager.html#a1e4aa0f280bcaa3057bc2970063f74b8">sysio::chain::authorization_manager::_noop_checktime</a></div><div class="ttdeci">static std::function&lt; void()&gt; _noop_checktime</div><div class="ttdef"><b>Definition</b> <a href="authorization__manager_8hpp_source.html#l00116">authorization_manager.hpp:116</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1authorization__manager_html_a24e23281d4ccfdddcc761c83e14a4080"><div class="ttname"><a href="classsysio_1_1chain_1_1authorization__manager.html#a24e23281d4ccfdddcc761c83e14a4080">sysio::chain::authorization_manager::add_to_snapshot</a></div><div class="ttdeci">void add_to_snapshot(const snapshot_writer_ptr &amp;snapshot) const</div><div class="ttdef"><b>Definition</b> <a href="#l00096">authorization_manager.cpp:96</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1authorization__manager_html_a27cfd5f70c12c10a9939e7bf6b3a52e4"><div class="ttname"><a href="classsysio_1_1chain_1_1authorization__manager.html#a27cfd5f70c12c10a9939e7bf6b3a52e4">sysio::chain::authorization_manager::initialize_database</a></div><div class="ttdeci">void initialize_database()</div><div class="ttdef"><b>Definition</b> <a href="#l00031">authorization_manager.cpp:31</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1authorization__manager_html_a6193726fcf21c9b75f460696a67b6839"><div class="ttname"><a href="classsysio_1_1chain_1_1authorization__manager.html#a6193726fcf21c9b75f460696a67b6839">sysio::chain::authorization_manager::lookup_minimum_permission</a></div><div class="ttdeci">std::optional&lt; permission_name &gt; lookup_minimum_permission(account_name authorizer_account, scope_name code_account, action_name type) const</div><div class="ttdoc">Find the lowest authority level required for authorizer_account to authorize a message of the specifi...</div><div class="ttdef"><b>Definition</b> <a href="#l00286">authorization_manager.cpp:286</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1authorization__manager_html_a6755c0b39298b2933eb4e74649a36442"><div class="ttname"><a href="classsysio_1_1chain_1_1authorization__manager.html#a6755c0b39298b2933eb4e74649a36442">sysio::chain::authorization_manager::update_permission_usage</a></div><div class="ttdeci">void update_permission_usage(const permission_object &amp;permission)</div><div class="ttdef"><b>Definition</b> <a href="#l00240">authorization_manager.cpp:240</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1authorization__manager_html_a7a4d84d47bcd9069ab0c8d8f9f9ac5f3"><div class="ttname"><a href="classsysio_1_1chain_1_1authorization__manager.html#a7a4d84d47bcd9069ab0c8d8f9f9ac5f3">sysio::chain::authorization_manager::read_from_snapshot</a></div><div class="ttdeci">void read_from_snapshot(const snapshot_reader_ptr &amp;snapshot)</div><div class="ttdef"><b>Definition</b> <a href="#l00113">authorization_manager.cpp:113</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1authorization__manager_html_a8566f4407e33eb1e4029455e4feae2f1"><div class="ttname"><a href="classsysio_1_1chain_1_1authorization__manager.html#a8566f4407e33eb1e4029455e4feae2f1">sysio::chain::authorization_manager::check_authorization</a></div><div class="ttdeci">void check_authorization(const vector&lt; action &gt; &amp;actions, const flat_set&lt; public_key_type &gt; &amp;provided_keys, const flat_set&lt; permission_level &gt; &amp;provided_permissions=flat_set&lt; permission_level &gt;(), fc::microseconds provided_delay=fc::microseconds(0), const std::function&lt; void()&gt; &amp;checktime=std::function&lt; void()&gt;(), bool allow_unused_keys=false, bool check_but_dont_fail=false, const flat_set&lt; permission_level &gt; &amp;satisfied_authorizations=flat_set&lt; permission_level &gt;()) const</div><div class="ttdoc">Check authorizations of a vector of actions with provided keys, permission levels,...</div><div class="ttdef"><b>Definition</b> <a href="#l00471">authorization_manager.cpp:471</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1authorization__manager_html_a96924f6aca32a602e24d991d12278a69"><div class="ttname"><a href="classsysio_1_1chain_1_1authorization__manager.html#a96924f6aca32a602e24d991d12278a69">sysio::chain::authorization_manager::get_permission</a></div><div class="ttdeci">const permission_object &amp; get_permission(const permission_level &amp;level) const</div><div class="ttdef"><b>Definition</b> <a href="#l00257">authorization_manager.cpp:257</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1authorization__manager_html_a9c889c94c63b7c53a5b4919738d6166b"><div class="ttname"><a href="classsysio_1_1chain_1_1authorization__manager.html#a9c889c94c63b7c53a5b4919738d6166b">sysio::chain::authorization_manager::remove_permission</a></div><div class="ttdeci">void remove_permission(const permission_object &amp;permission)</div><div class="ttdef"><b>Definition</b> <a href="#l00225">authorization_manager.cpp:225</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1authorization__manager_html_aac57733c5aa05c1c78a023a80b2f447f"><div class="ttname"><a href="classsysio_1_1chain_1_1authorization__manager.html#aac57733c5aa05c1c78a023a80b2f447f">sysio::chain::authorization_manager::create_permission</a></div><div class="ttdeci">const permission_object &amp; create_permission(account_name account, permission_name name, permission_id_type parent, const authority &amp;auth, time_point initial_creation_time=time_point())</div><div class="ttdef"><b>Definition</b> <a href="#l00133">authorization_manager.cpp:133</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1authorization__manager_html_ab0acfec50b75044030d082d1aa3fbf5c"><div class="ttname"><a href="classsysio_1_1chain_1_1authorization__manager.html#ab0acfec50b75044030d082d1aa3fbf5c">sysio::chain::authorization_manager::find_permission</a></div><div class="ttdeci">const permission_object * find_permission(const permission_level &amp;level) const</div><div class="ttdef"><b>Definition</b> <a href="#l00251">authorization_manager.cpp:251</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1authorization__manager_html_abf01ddda4cd475bf2530ad1d28c72dfb"><div class="ttname"><a href="classsysio_1_1chain_1_1authorization__manager.html#abf01ddda4cd475bf2530ad1d28c72dfb">sysio::chain::authorization_manager::modify_permission</a></div><div class="ttdeci">void modify_permission(const permission_object &amp;permission, const authority &amp;auth)</div><div class="ttdef"><b>Definition</b> <a href="#l00203">authorization_manager.cpp:203</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1authorization__manager_html_ac1e69cb344bd39871d1c92993a491e95"><div class="ttname"><a href="classsysio_1_1chain_1_1authorization__manager.html#ac1e69cb344bd39871d1c92993a491e95">sysio::chain::authorization_manager::get_required_keys</a></div><div class="ttdeci">flat_set&lt; public_key_type &gt; get_required_keys(const transaction &amp;trx, const flat_set&lt; public_key_type &gt; &amp;candidate_keys, fc::microseconds provided_delay=fc::microseconds(0)) const</div><div class="ttdef"><b>Definition</b> <a href="#l00614">authorization_manager.cpp:614</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1authorization__manager_html_add79267df1f466480b18703845327a78"><div class="ttname"><a href="classsysio_1_1chain_1_1authorization__manager.html#add79267df1f466480b18703845327a78">sysio::chain::authorization_manager::permission_id_type</a></div><div class="ttdeci">permission_object::id_type permission_id_type</div><div class="ttdef"><b>Definition</b> <a href="authorization__manager_8hpp_source.html#l00021">authorization_manager.hpp:21</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html">sysio::chain::controller</a></div><div class="ttdef"><b>Definition</b> <a href="controller_8hpp_source.html#l00063">controller.hpp:63</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a0bb11e832a05b6437c79bf81758b1b7d"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a0bb11e832a05b6437c79bf81758b1b7d">sysio::chain::controller::get_global_properties</a></div><div class="ttdeci">const global_property_object &amp; get_global_properties() const</div><div class="ttdef"><b>Definition</b> <a href="controller_8cpp_source.html#l03062">controller.cpp:3062</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a0c79d00dae8c0d90efc18f4d091b2391"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a0c79d00dae8c0d90efc18f4d091b2391">sysio::chain::controller::db</a></div><div class="ttdeci">const chainbase::database &amp; db() const</div><div class="ttdef"><b>Definition</b> <a href="controller_8cpp_source.html#l02646">controller.cpp:2646</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a4f6404b355a3a4bf7fb60c92e85443d1"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a4f6404b355a3a4bf7fb60c92e85443d1">sysio::chain::controller::get_deep_mind_logger</a></div><div class="ttdeci">deep_mind_handler * get_deep_mind_logger() const</div><div class="ttdef"><b>Definition</b> <a href="controller_8cpp_source.html#l03460">controller.cpp:3460</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_aa808acf858e93c567ff983ccbf8fb6d3"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#aa808acf858e93c567ff983ccbf8fb6d3">sysio::chain::controller::is_builtin_activated</a></div><div class="ttdeci">bool is_builtin_activated(builtin_protocol_feature_t f) const</div><div class="ttdef"><b>Definition</b> <a href="controller_8cpp_source.html#l03385">controller.cpp:3385</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_abb1d81f96986df3bce46bd37caaf6a69"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#abb1d81f96986df3bce46bd37caaf6a69">sysio::chain::controller::pending_block_time</a></div><div class="ttdeci">time_point pending_block_time() const</div><div class="ttdef"><b>Definition</b> <a href="controller_8cpp_source.html#l03000">controller.cpp:3000</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1global__property__object_html_a7f149fcf87034217c899838eb4430496"><div class="ttname"><a href="classsysio_1_1chain_1_1global__property__object.html#a7f149fcf87034217c899838eb4430496">sysio::chain::global_property_object::configuration</a></div><div class="ttdeci">chain_config configuration</div><div class="ttdef"><b>Definition</b> <a href="global__property__object_8hpp_source.html#l00071">global_property_object.hpp:71</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1index__set_html"><div class="ttname"><a href="classsysio_1_1chain_1_1index__set.html">sysio::chain::index_set</a></div><div class="ttdef"><b>Definition</b> <a href="database__utils_8hpp_source.html#l00010">database_utils.hpp:10</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1permission__link__object_html"><div class="ttname"><a href="classsysio_1_1chain_1_1permission__link__object.html">sysio::chain::permission_link_object</a></div><div class="ttdoc">The permission_link_object class assigns permission_objects to message types.</div><div class="ttdef"><b>Definition</b> <a href="permission__link__object_8hpp_source.html#l00026">permission_link_object.hpp:26</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1permission__object_html"><div class="ttname"><a href="classsysio_1_1chain_1_1permission__object.html">sysio::chain::permission_object</a></div><div class="ttdef"><b>Definition</b> <a href="permission__object_8hpp_source.html#l00025">permission_object.hpp:25</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1permission__usage__object_html"><div class="ttname"><a href="classsysio_1_1chain_1_1permission__usage__object.html">sysio::chain::permission_usage_object</a></div><div class="ttdef"><b>Definition</b> <a href="permission__object_8hpp_source.html#l00009">permission_object.hpp:9</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1protocol__state__object_html"><div class="ttname"><a href="classsysio_1_1chain_1_1protocol__state__object.html">sysio::chain::protocol_state_object</a></div><div class="ttdoc">Maintains global state information about consensus protocol rules.</div><div class="ttdef"><b>Definition</b> <a href="protocol__state__object_8hpp_source.html#l00017">protocol_state_object.hpp:18</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1protocol__state__object_html_af0f14fd2383a20afd49de85013402cdc"><div class="ttname"><a href="classsysio_1_1chain_1_1protocol__state__object.html#af0f14fd2383a20afd49de85013402cdc">sysio::chain::protocol_state_object::num_supported_key_types</a></div><div class="ttdeci">uint32_t num_supported_key_types</div><div class="ttdef"><b>Definition</b> <a href="protocol__state__object_8hpp_source.html#l00043">protocol_state_object.hpp:43</a></div></div>
<div class="ttc" id="acontract__types_8hpp_html"><div class="ttname"><a href="contract__types_8hpp.html">contract_types.hpp</a></div></div>
<div class="ttc" id="acontroller_8hpp_html"><div class="ttname"><a href="controller_8hpp.html">controller.hpp</a></div></div>
<div class="ttc" id="adatabase__utils_8hpp_html"><div class="ttname"><a href="database__utils_8hpp.html">database_utils.hpp</a></div></div>
<div class="ttc" id="adeep__mind_8hpp_html"><div class="ttname"><a href="deep__mind_8hpp.html">deep_mind.hpp</a></div></div>
<div class="ttc" id="aexception_8hpp_html_a094902280cad82ad6529ebbd12a697eb"><div class="ttname"><a href="exception_8hpp.html#a094902280cad82ad6529ebbd12a697eb">FC_CAPTURE_AND_RETHROW</a></div><div class="ttdeci">#define FC_CAPTURE_AND_RETHROW(...)</div><div class="ttdef"><b>Definition</b> <a href="exception_8hpp_source.html#l00523">exception.hpp:523</a></div></div>
<div class="ttc" id="agenerated__transaction__object_8hpp_html"><div class="ttname"><a href="generated__transaction__object_8hpp.html">generated_transaction_object.hpp</a></div></div>
<div class="ttc" id="aglobal__property__object_8hpp_html"><div class="ttname"><a href="global__property__object_8hpp.html">global_property_object.hpp</a></div></div>
<div class="ttc" id="aintegration_8cpp_html_a6e9635897de7740b7389a391f613626b"><div class="ttname"><a href="integration_8cpp.html#a6e9635897de7740b7389a391f613626b">delay</a></div><div class="ttdeci">void delay(websocketpp::connection_hdl, long duration)</div><div class="ttdef"><b>Definition</b> <a href="integration_8cpp_source.html#l00318">integration.cpp:318</a></div></div>
<div class="ttc" id="anamespacedetail_html"><div class="ttname"><a href="namespacedetail.html">detail</a></div><div class="ttdef"><b>Definition</b> <a href="programs_2nodeop_2main_8cpp_source.html#l00023">main.cpp:23</a></div></div>
<div class="ttc" id="anamespacefc_1_1raw_html_a0b442d98ceb22dd5a6ae84745e43ffab"><div class="ttname"><a href="namespacefc_1_1raw.html#a0b442d98ceb22dd5a6ae84745e43ffab">fc::raw::unpack</a></div><div class="ttdeci">void unpack(Stream &amp;s, std::deque&lt; T &gt; &amp;value)</div><div class="ttdef"><b>Definition</b> <a href="raw_8hpp_source.html#l00540">raw.hpp:540</a></div></div>
<div class="ttc" id="anamespacefc_html_a9623b8cae3f48bbed6aa1fc2afe9b174"><div class="ttname"><a href="namespacefc.html#a9623b8cae3f48bbed6aa1fc2afe9b174">fc::seconds</a></div><div class="ttdeci">constexpr microseconds seconds(int64_t s)</div><div class="ttdef"><b>Definition</b> <a href="include_2fc_2time_8hpp_source.html#l00032">time.hpp:32</a></div></div>
<div class="ttc" id="anamespacefc_html_ae009b19d1fecf5979996e9f326cd98c3"><div class="ttname"><a href="namespacefc.html#ae009b19d1fecf5979996e9f326cd98c3">fc::get_index</a></div><div class="ttdeci">constexpr std::size_t get_index()</div><div class="ttdef"><b>Definition</b> <a href="static__variant_8hpp_source.html#l00033">static_variant.hpp:33</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_a057ec53a1f8d23b2fb89de6c19b41c32"><div class="ttname"><a href="namespacesysio_1_1chain.html#a057ec53a1f8d23b2fb89de6c19b41c32">sysio::chain::noop_checktime</a></div><div class="ttdeci">void noop_checktime()</div><div class="ttdef"><b>Definition</b> <a href="#l00466">authorization_manager.cpp:466</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_a255011fa21760c6c73a1187a23d0afd1"><div class="ttname"><a href="namespacesysio_1_1chain.html#a255011fa21760c6c73a1187a23d0afd1">sysio::chain::permission_link_index</a></div><div class="ttdeci">chainbase::shared_multi_index_container&lt; permission_link_object, indexed_by&lt; ordered_unique&lt; tag&lt; by_id &gt;, &gt;, ordered_unique&lt; tag&lt; by_action_name &gt;, composite_key&lt; permission_link_object, BOOST_MULTI_INDEX_MEMBER(permission_link_object, account_name, account), BOOST_MULTI_INDEX_MEMBER(permission_link_object, account_name, code), &gt; &gt;, ordered_unique&lt; tag&lt; by_permission_name &gt;, composite_key&lt; permission_link_object, BOOST_MULTI_INDEX_MEMBER(permission_link_object, account_name, account), BOOST_MULTI_INDEX_MEMBER(permission_link_object, permission_name, required_permission), &gt; &gt; &gt; &gt; permission_link_index</div><div class="ttdef"><b>Definition</b> <a href="permission__link__object_8hpp_source.html#l00044">permission_link_object.hpp:44</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_a406d45a184cdba0af316b5bf34bf56cfaa1c8246337a0813da762617fa567c3e5"><div class="ttname"><a href="namespacesysio_1_1chain.html#a406d45a184cdba0af316b5bf34bf56cfaa1c8246337a0813da762617fa567c3e5">sysio::chain::builtin_protocol_feature_t::fix_linkauth_restriction</a></div><div class="ttdeci">@ fix_linkauth_restriction</div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_a4e24a1668746342d40487d1019880986"><div class="ttname"><a href="namespacesysio_1_1chain.html#a4e24a1668746342d40487d1019880986">sysio::chain::permission_index</a></div><div class="ttdeci">chainbase::shared_multi_index_container&lt; permission_object, indexed_by&lt; ordered_unique&lt; tag&lt; by_id &gt;, member&lt; permission_object, permission_object::id_type, &amp;permission_object::id &gt; &gt;, ordered_unique&lt; tag&lt; by_parent &gt;, composite_key&lt; permission_object, member&lt; permission_object, permission_object::id_type, &amp;permission_object::parent &gt;, member&lt; permission_object, permission_object::id_type, &amp;permission_object::id &gt; &gt; &gt;, ordered_unique&lt; tag&lt; by_owner &gt;, composite_key&lt; permission_object, member&lt; permission_object, account_name, &amp;permission_object::owner &gt;, member&lt; permission_object, permission_name, &amp;permission_object::name &gt; &gt; &gt;, ordered_unique&lt; tag&lt; by_name &gt;, composite_key&lt; permission_object, member&lt; permission_object, permission_name, &amp;permission_object::name &gt;, member&lt; permission_object, permission_object::id_type, &amp;permission_object::id &gt; &gt; &gt; &gt; &gt; permission_index</div><div class="ttdef"><b>Definition</b> <a href="permission__object_8hpp_source.html#l00086">permission_object.hpp:86</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_a5dfe17906469eaf079c180c1afb4ad94"><div class="ttname"><a href="namespacesysio_1_1chain.html#a5dfe17906469eaf079c180c1afb4ad94">sysio::chain::transaction_exception</a></div><div class="ttdeci">key Invalid authority Invalid transaction Invalid block ID Invalid packed transaction Invalid chain ID Invalid symbol Signature type is not a currently activated type Block can not be found Unlinkable block Block does not guarantee concurrent execution without conflicts Block exhausted allowed resources Block is from the future Block is not signed by expected producer Block includes an ill formed protocol feature activation extension Block includes an ill formed additional block signature extension transaction_exception</div><div class="ttdef"><b>Definition</b> <a href="chain_2include_2sysio_2chain_2exceptions_8hpp_source.html#l00243">exceptions.hpp:243</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_a764b50974b9b72a0e233e72176913d6b"><div class="ttname"><a href="namespacesysio_1_1chain.html#a764b50974b9b72a0e233e72176913d6b">sysio::chain::action_validate_exception</a></div><div class="ttdeci">key Invalid authority Invalid transaction Invalid block ID Invalid packed transaction Invalid chain ID Invalid symbol Signature type is not a currently activated type Block can not be found Unlinkable block Block does not guarantee concurrent execution without conflicts Block exhausted allowed resources Block is from the future Block is not signed by expected producer Block includes an ill formed protocol feature activation extension Block includes an ill formed additional block signature extension Error decompressing transaction Transaction should have at least one required authority Expired Transaction Invalid Reference Block Duplicate deferred transaction The transaction can not be found Transaction is too big Invalid transaction extension Transaction includes disallowed Transaction exceeded transient resource limit action_validate_exception</div><div class="ttdef"><b>Definition</b> <a href="chain_2include_2sysio_2chain_2exceptions_8hpp_source.html#l00284">exceptions.hpp:284</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_a7a1685bcc352cda9e45f055932069428"><div class="ttname"><a href="namespacesysio_1_1chain.html#a7a1685bcc352cda9e45f055932069428">sysio::chain::action_name</a></div><div class="ttdeci">sysio::chain::action_name action_name</div><div class="ttdef"><b>Definition</b> <a href="contract__types_8hpp_source.html#l00008">contract_types.hpp:8</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_a80afaa06d96e661a0f93e0ba4b09c8dc"><div class="ttname"><a href="namespacesysio_1_1chain.html#a80afaa06d96e661a0f93e0ba4b09c8dc">sysio::chain::snapshot_writer_ptr</a></div><div class="ttdeci">std::shared_ptr&lt; snapshot_writer &gt; snapshot_writer_ptr</div><div class="ttdef"><b>Definition</b> <a href="snapshot_8hpp_source.html#l00155">snapshot.hpp:155</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_a9935b13f160accddca2509476a2cad8b"><div class="ttname"><a href="namespacesysio_1_1chain.html#a9935b13f160accddca2509476a2cad8b">sysio::chain::make_auth_checker</a></div><div class="ttdeci">auto make_auth_checker(PermissionToAuthorityFunc &amp;&amp;pta, uint16_t recursion_depth_limit, const flat_set&lt; public_key_type &gt; &amp;provided_keys, const flat_set&lt; permission_level &gt; &amp;provided_permissions=flat_set&lt; permission_level &gt;(), fc::microseconds provided_delay=fc::microseconds(0), const std::function&lt; void()&gt; &amp;_checktime=std::function&lt; void()&gt;())</div><div class="ttdoc">authority_checker</div><div class="ttdef"><b>Definition</b> <a href="authority__checker_8hpp_source.html#l00259">authority_checker.hpp:259</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_a9e9842ee49526c2423e014a696edc602"><div class="ttname"><a href="namespacesysio_1_1chain.html#a9e9842ee49526c2423e014a696edc602">sysio::chain::generated_transaction_multi_index</a></div><div class="ttdeci">chainbase::shared_multi_index_container&lt; generated_transaction_object, indexed_by&lt; ordered_unique&lt; tag&lt; by_id &gt;, BOOST_MULTI_INDEX_MEMBER(generated_transaction_object, generated_transaction_object::id_type, id)&gt;, ordered_unique&lt; tag&lt; by_trx_id &gt;, BOOST_MULTI_INDEX_MEMBER(generated_transaction_object, transaction_id_type, trx_id)&gt;, ordered_unique&lt; tag&lt; by_expiration &gt;, composite_key&lt; generated_transaction_object, BOOST_MULTI_INDEX_MEMBER(generated_transaction_object, time_point, expiration), &gt; &gt;, ordered_unique&lt; tag&lt; by_delay &gt;, composite_key&lt; generated_transaction_object, BOOST_MULTI_INDEX_MEMBER(generated_transaction_object, time_point, delay_until), &gt; &gt;, ordered_unique&lt; tag&lt; by_sender_id &gt;, composite_key&lt; generated_transaction_object, BOOST_MULTI_INDEX_MEMBER(generated_transaction_object, account_name, sender), &gt; &gt; &gt; &gt; generated_transaction_multi_index</div><div class="ttdef"><b>Definition</b> <a href="generated__transaction__object_8hpp_source.html#l00052">generated_transaction_object.hpp:52</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_aaa27dacddc54cea475602788c8e7a02c"><div class="ttname"><a href="namespacesysio_1_1chain.html#aaa27dacddc54cea475602788c8e7a02c">sysio::chain::snapshot_reader_ptr</a></div><div class="ttdeci">std::shared_ptr&lt; snapshot_reader &gt; snapshot_reader_ptr</div><div class="ttdef"><b>Definition</b> <a href="snapshot_8hpp_source.html#l00294">snapshot.hpp:294</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_ac32ce8e75243f2b3f76aff0c1984f11b"><div class="ttname"><a href="namespacesysio_1_1chain.html#ac32ce8e75243f2b3f76aff0c1984f11b">sysio::chain::account_name</a></div><div class="ttdeci">name account_name</div><div class="ttdef"><b>Definition</b> <a href="chain_2include_2sysio_2chain_2types_8hpp_source.html#l00120">types.hpp:120</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_ad2f4ad05ff8f6e64102bf097f596589e"><div class="ttname"><a href="namespacesysio_1_1chain.html#ad2f4ad05ff8f6e64102bf097f596589e">sysio::chain::permission_usage_index</a></div><div class="ttdeci">chainbase::shared_multi_index_container&lt; permission_usage_object, indexed_by&lt; ordered_unique&lt; tag&lt; by_id &gt;, member&lt; permission_usage_object, permission_usage_object::id_type, &amp;permission_usage_object::id &gt; &gt; &gt; &gt; permission_usage_index</div><div class="ttdef"><b>Definition</b> <a href="permission__object_8hpp_source.html#l00017">permission_object.hpp:17</a></div></div>
<div class="ttc" id="anamespacesysio_html"><div class="ttname"><a href="namespacesysio.html">sysio</a></div><div class="ttdef"><b>Definition</b> <a href="abi__serializer_8cpp_source.html#l00008">abi_serializer.cpp:8</a></div></div>
<div class="ttc" id="apermission__link__object_8hpp_html"><div class="ttname"><a href="permission__link__object_8hpp.html">permission_link_object.hpp</a></div></div>
<div class="ttc" id="apermission__object_8hpp_html"><div class="ttname"><a href="permission__object_8hpp.html">permission_object.hpp</a></div></div>
<div class="ttc" id="apkcs11_8h_html_a32aff7c6c4cd253fdf6563677afab5ce"><div class="ttname"><a href="pkcs11_8h.html#a32aff7c6c4cd253fdf6563677afab5ce">value</a></div><div class="ttdeci">#define value</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00157">pkcs11.h:157</a></div></div>
<div class="ttc" id="aprotocol__state__object_8hpp_html"><div class="ttname"><a href="protocol__state__object_8hpp.html">protocol_state_object.hpp</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1authority_html"><div class="ttname"><a href="structsysio_1_1chain_1_1authority.html">sysio::chain::authority</a></div><div class="ttdef"><b>Definition</b> <a href="authority_8hpp_source.html#l00165">authority.hpp:165</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1authority_html_ae43c8d325b117257317c793fbb248770"><div class="ttname"><a href="structsysio_1_1chain_1_1authority.html#ae43c8d325b117257317c793fbb248770">sysio::chain::authority::keys</a></div><div class="ttdeci">vector&lt; key_weight &gt; keys</div><div class="ttdef"><b>Definition</b> <a href="authority_8hpp_source.html#l00189">authority.hpp:189</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1canceldelay_html"><div class="ttname"><a href="structsysio_1_1chain_1_1canceldelay.html">sysio::chain::canceldelay</a></div><div class="ttdef"><b>Definition</b> <a href="contract__types_8hpp_source.html#l00126">contract_types.hpp:126</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1canceldelay_html_a23c3d201f9917509b74001716daf254f"><div class="ttname"><a href="structsysio_1_1chain_1_1canceldelay.html#a23c3d201f9917509b74001716daf254f">sysio::chain::canceldelay::get_name</a></div><div class="ttdeci">static action_name get_name()</div><div class="ttdef"><b>Definition</b> <a href="contract__types_8hpp_source.html#l00134">contract_types.hpp:134</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1chain__config__v0_html_ad98015ab0842f0258be2df72e7ace5e3"><div class="ttname"><a href="structsysio_1_1chain_1_1chain__config__v0.html#ad98015ab0842f0258be2df72e7ace5e3">sysio::chain::chain_config_v0::max_transaction_delay</a></div><div class="ttdeci">uint32_t max_transaction_delay</div><div class="ttdoc">the maximum number of seconds that can be imposed as a delay requirement by authorization checks</div><div class="ttdef"><b>Definition</b> <a href="chain__config_8hpp_source.html#l00055">chain_config.hpp:55</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1deleteauth_html"><div class="ttname"><a href="structsysio_1_1chain_1_1deleteauth.html">sysio::chain::deleteauth</a></div><div class="ttdef"><b>Definition</b> <a href="contract__types_8hpp_source.html#l00069">contract_types.hpp:69</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1deleteauth_html_add712cbf63b55d0e2db2b874dca6576d"><div class="ttname"><a href="structsysio_1_1chain_1_1deleteauth.html#add712cbf63b55d0e2db2b874dca6576d">sysio::chain::deleteauth::get_name</a></div><div class="ttdeci">static action_name get_name()</div><div class="ttdef"><b>Definition</b> <a href="contract__types_8hpp_source.html#l00082">contract_types.hpp:82</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1detail_1_1snapshot__row__traits_3_01permission__object_01_4_html_a9e45fd801cd6f077e1025fb092a18223"><div class="ttname"><a href="structsysio_1_1chain_1_1detail_1_1snapshot__row__traits_3_01permission__object_01_4.html#a9e45fd801cd6f077e1025fb092a18223">sysio::chain::detail::snapshot_row_traits&lt; permission_object &gt;::to_snapshot_row</a></div><div class="ttdeci">static snapshot_permission_object to_snapshot_row(const permission_object &amp;value, const chainbase::database &amp;db)</div><div class="ttdef"><b>Definition</b> <a href="#l00041">authorization_manager.cpp:41</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1detail_1_1snapshot__row__traits_3_01permission__object_01_4_html_ac900d123e7677aff1cbe872b65b04ee5"><div class="ttname"><a href="structsysio_1_1chain_1_1detail_1_1snapshot__row__traits_3_01permission__object_01_4.html#ac900d123e7677aff1cbe872b65b04ee5">sysio::chain::detail::snapshot_row_traits&lt; permission_object &gt;::from_snapshot_row</a></div><div class="ttdeci">static void from_snapshot_row(snapshot_permission_object &amp;&amp;row, permission_object &amp;value, chainbase::database &amp;db)</div><div class="ttdef"><b>Definition</b> <a href="#l00059">authorization_manager.cpp:59</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1detail_1_1snapshot__row__traits_html"><div class="ttname"><a href="structsysio_1_1chain_1_1detail_1_1snapshot__row__traits.html">sysio::chain::detail::snapshot_row_traits</a></div><div class="ttdef"><b>Definition</b> <a href="snapshot_8hpp_source.html#l00025">snapshot.hpp:25</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1key__weight_html"><div class="ttname"><a href="structsysio_1_1chain_1_1key__weight.html">sysio::chain::key_weight</a></div><div class="ttdef"><b>Definition</b> <a href="authority_8hpp_source.html#l00095">authority.hpp:95</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1key__weight_html_ac0d64507dc98ab3078451bf7675b59e9"><div class="ttname"><a href="structsysio_1_1chain_1_1key__weight.html#ac0d64507dc98ab3078451bf7675b59e9">sysio::chain::key_weight::key</a></div><div class="ttdeci">public_key_type key</div><div class="ttdef"><b>Definition</b> <a href="authority_8hpp_source.html#l00096">authority.hpp:96</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1linkauth_html"><div class="ttname"><a href="structsysio_1_1chain_1_1linkauth.html">sysio::chain::linkauth</a></div><div class="ttdef"><b>Definition</b> <a href="contract__types_8hpp_source.html#l00087">contract_types.hpp:87</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1linkauth_html_a41eafdd131f5b3c8a8b7688449986f2b"><div class="ttname"><a href="structsysio_1_1chain_1_1linkauth.html#a41eafdd131f5b3c8a8b7688449986f2b">sysio::chain::linkauth::get_name</a></div><div class="ttdeci">static action_name get_name()</div><div class="ttdef"><b>Definition</b> <a href="contract__types_8hpp_source.html#l00102">contract_types.hpp:102</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1name_html"><div class="ttname"><a href="structsysio_1_1chain_1_1name.html">sysio::chain::name</a></div><div class="ttdoc">Immutable except for fc::from_variant.</div><div class="ttdef"><b>Definition</b> <a href="name_8hpp_source.html#l00043">name.hpp:43</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1name_html_a8847252c767dea5c3e8b60cc9d78505f"><div class="ttname"><a href="structsysio_1_1chain_1_1name.html#a8847252c767dea5c3e8b60cc9d78505f">sysio::chain::name::name</a></div><div class="ttdeci">name(std::string_view str)</div><div class="ttdef"><b>Definition</b> <a href="name_8hpp_source.html#l00056">name.hpp:56</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1permission__level_html"><div class="ttname"><a href="structsysio_1_1chain_1_1permission__level.html">sysio::chain::permission_level</a></div><div class="ttdef"><b>Definition</b> <a href="action_8hpp_source.html#l00008">action.hpp:8</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1snapshot__permission__object_html"><div class="ttname"><a href="structsysio_1_1chain_1_1snapshot__permission__object.html">sysio::chain::snapshot_permission_object</a></div><div class="ttdef"><b>Definition</b> <a href="permission__object_8hpp_source.html#l00073">permission_object.hpp:73</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1snapshot__permission__object_html_a08632f1e4dd62a964d83f81cdbf7b522"><div class="ttname"><a href="structsysio_1_1chain_1_1snapshot__permission__object.html#a08632f1e4dd62a964d83f81cdbf7b522">sysio::chain::snapshot_permission_object::auth</a></div><div class="ttdeci">authority auth</div><div class="ttdoc">authority required to execute this permission</div><div class="ttdef"><b>Definition</b> <a href="permission__object_8hpp_source.html#l00079">permission_object.hpp:79</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1snapshot__permission__object_html_a369423725eb667c68b10d2653e07872e"><div class="ttname"><a href="structsysio_1_1chain_1_1snapshot__permission__object.html#a369423725eb667c68b10d2653e07872e">sysio::chain::snapshot_permission_object::parent</a></div><div class="ttdeci">permission_name parent</div><div class="ttdoc">parent permission</div><div class="ttdef"><b>Definition</b> <a href="permission__object_8hpp_source.html#l00074">permission_object.hpp:74</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1snapshot__permission__object_html_a6252fb98de04b0a812b044bf78552386"><div class="ttname"><a href="structsysio_1_1chain_1_1snapshot__permission__object.html#a6252fb98de04b0a812b044bf78552386">sysio::chain::snapshot_permission_object::last_updated</a></div><div class="ttdeci">time_point last_updated</div><div class="ttdoc">the last time this authority was updated</div><div class="ttdef"><b>Definition</b> <a href="permission__object_8hpp_source.html#l00077">permission_object.hpp:77</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1snapshot__permission__object_html_aabb140f7580c588302dc3038e7ed83b8"><div class="ttname"><a href="structsysio_1_1chain_1_1snapshot__permission__object.html#aabb140f7580c588302dc3038e7ed83b8">sysio::chain::snapshot_permission_object::owner</a></div><div class="ttdeci">account_name owner</div><div class="ttdoc">the account this permission belongs to</div><div class="ttdef"><b>Definition</b> <a href="permission__object_8hpp_source.html#l00075">permission_object.hpp:75</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1snapshot__permission__object_html_ab717b57132e2b8c47442468be92bd167"><div class="ttname"><a href="structsysio_1_1chain_1_1snapshot__permission__object.html#ab717b57132e2b8c47442468be92bd167">sysio::chain::snapshot_permission_object::name</a></div><div class="ttdeci">permission_name name</div><div class="ttdoc">human-readable name for the permission</div><div class="ttdef"><b>Definition</b> <a href="permission__object_8hpp_source.html#l00076">permission_object.hpp:76</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1snapshot__permission__object_html_ae88d394c8874eed2f4366c6aaa4b9803"><div class="ttname"><a href="structsysio_1_1chain_1_1snapshot__permission__object.html#ae88d394c8874eed2f4366c6aaa4b9803">sysio::chain::snapshot_permission_object::last_used</a></div><div class="ttdeci">time_point last_used</div><div class="ttdoc">when this permission was last used</div><div class="ttdef"><b>Definition</b> <a href="permission__object_8hpp_source.html#l00078">permission_object.hpp:78</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1transaction_html"><div class="ttname"><a href="structsysio_1_1chain_1_1transaction.html">sysio::chain::transaction</a></div><div class="ttdef"><b>Definition</b> <a href="transaction_8hpp_source.html#l00083">transaction.hpp:83</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1transaction_html_a407fcf1868b81bb30b85f80d388bbac2"><div class="ttname"><a href="structsysio_1_1chain_1_1transaction.html#a407fcf1868b81bb30b85f80d388bbac2">sysio::chain::transaction::actions</a></div><div class="ttdeci">vector&lt; action &gt; actions</div><div class="ttdef"><b>Definition</b> <a href="transaction_8hpp_source.html#l00085">transaction.hpp:85</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1unlinkauth_html"><div class="ttname"><a href="structsysio_1_1chain_1_1unlinkauth.html">sysio::chain::unlinkauth</a></div><div class="ttdef"><b>Definition</b> <a href="contract__types_8hpp_source.html#l00107">contract_types.hpp:107</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1unlinkauth_html_a438dbc3c8575ab1f129c0fdd5c074327"><div class="ttname"><a href="structsysio_1_1chain_1_1unlinkauth.html#a438dbc3c8575ab1f129c0fdd5c074327">sysio::chain::unlinkauth::get_name</a></div><div class="ttdeci">static action_name get_name()</div><div class="ttdef"><b>Definition</b> <a href="contract__types_8hpp_source.html#l00121">contract_types.hpp:121</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1updateauth_html"><div class="ttname"><a href="structsysio_1_1chain_1_1updateauth.html">sysio::chain::updateauth</a></div><div class="ttdef"><b>Definition</b> <a href="contract__types_8hpp_source.html#l00054">contract_types.hpp:54</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1updateauth_html_a63fdeac4d73b22271c0dae827f3eae48"><div class="ttname"><a href="structsysio_1_1chain_1_1updateauth.html#a63fdeac4d73b22271c0dae827f3eae48">sysio::chain::updateauth::parent</a></div><div class="ttdeci">permission_name parent</div><div class="ttdef"><b>Definition</b> <a href="contract__types_8hpp_source.html#l00057">contract_types.hpp:57</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1updateauth_html_a6a6754666f37b5dc06165b954bc6c4fc"><div class="ttname"><a href="structsysio_1_1chain_1_1updateauth.html#a6a6754666f37b5dc06165b954bc6c4fc">sysio::chain::updateauth::permission</a></div><div class="ttdeci">permission_name permission</div><div class="ttdef"><b>Definition</b> <a href="contract__types_8hpp_source.html#l00056">contract_types.hpp:56</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1updateauth_html_a7ee3ebcba6271b4c675f1fedbed1a27e"><div class="ttname"><a href="structsysio_1_1chain_1_1updateauth.html#a7ee3ebcba6271b4c675f1fedbed1a27e">sysio::chain::updateauth::account</a></div><div class="ttdeci">account_name account</div><div class="ttdef"><b>Definition</b> <a href="contract__types_8hpp_source.html#l00055">contract_types.hpp:55</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1updateauth_html_afc31c0680242885924f64fc347780814"><div class="ttname"><a href="structsysio_1_1chain_1_1updateauth.html#afc31c0680242885924f64fc347780814">sysio::chain::updateauth::get_name</a></div><div class="ttdeci">static action_name get_name()</div><div class="ttdef"><b>Definition</b> <a href="contract__types_8hpp_source.html#l00064">contract_types.hpp:64</a></div></div>
<div class="ttc" id="ayubico__otp_8c_html_a9246c20bb98ad2b4c60313c053c70f08"><div class="ttname"><a href="yubico__otp_8c.html#a9246c20bb98ad2b4c60313c053c70f08">key</a></div><div class="ttdeci">uint8_t key[16]</div><div class="ttdef"><b>Definition</b> <a href="yubico__otp_8c_source.html#l00041">yubico_otp.c:41</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a107648633008a7f2d872b4b3d98c2f96"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a107648633008a7f2d872b4b3d98c2f96">d</a></div><div class="ttdeci">CK_ULONG d</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l01238">yubihsm_pkcs11.c:1238</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_428556e0652617aa37d2f7d8bcaf7fdf.html">libraries</a></li><li class="navelem"><a class="el" href="dir_0d4aba5c25a4be0a24c819a636048cb8.html">chain</a></li><li class="navelem"><a class="el" href="authorization__manager_8cpp.html">authorization_manager.cpp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0 </li>
  </ul>
</div>
</body>
</html>
