\doxysection{elliptic\+\_\+em\+\_\+common.\+cpp}
\hypertarget{elliptic__em__common_8cpp_source}{}\label{elliptic__em__common_8cpp_source}\index{libraries/fc/src/crypto/elliptic\_em\_common.cpp@{libraries/fc/src/crypto/elliptic\_em\_common.cpp}}
\mbox{\hyperlink{elliptic__em__common_8cpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00001}00001\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{base58_8hpp}{fc/crypto/base58.hpp}}>}}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00002}00002\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{elliptic_8hpp}{fc/crypto/elliptic.hpp}}>}}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00003}00003\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{elliptic__em_8hpp}{fc/crypto/elliptic\_em.hpp}}>}}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00004}00004\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{raw_8hpp}{fc/io/raw.hpp}}>}}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00005}00005\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{hmac_8hpp}{fc/crypto/hmac.hpp}}>}}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00006}00006\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{openssl_8hpp}{fc/crypto/openssl.hpp}}>}}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00007}00007\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{ripemd160_8hpp}{fc/crypto/ripemd160.hpp}}>}}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00008}00008\ }
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00009}00009\ \textcolor{preprocessor}{\#ifdef\ \_WIN32}}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00010}00010\ \textcolor{preprocessor}{\#\ include\ <malloc.h>}}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00011}00011\ \textcolor{preprocessor}{\#elif\ defined(\_\_FreeBSD\_\_)}}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00012}00012\ \textcolor{preprocessor}{\#\ include\ <stdlib.h>}}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00013}00013\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00014}00014\ \textcolor{preprocessor}{\#\ include\ <alloca.h>}}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00015}00015\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00016}00016\ }
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00017}00017\ \textcolor{comment}{/*\ stuff\ common\ to\ all\ ecc\ implementations\ */}}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00018}00018\ }
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00019}\mbox{\hyperlink{elliptic__em__common_8cpp_aecf069285f56d4ea910d77b70a8c5843}{00019}}\ \textcolor{preprocessor}{\#define\ BTC\_EXT\_PUB\_MAGIC\ \ \ (0x0488B21E)}}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00020}\mbox{\hyperlink{elliptic__em__common_8cpp_aba9bcacbfb7b867ec3157c72644229ca}{00020}}\ \textcolor{preprocessor}{\#define\ BTC\_EXT\_PRIV\_MAGIC\ \ (0x0488ADE4)}}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00021}00021\ }
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00022}00022\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacefc}{fc}}\ \{\ \textcolor{keyword}{namespace\ }em\ \{}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00023}00023\ }
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00024}00024\ \ \ \ \ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacedetail}{detail}}\ \{}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00025}00025\ \ \ \ \ \ \ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{classfc_1_1array}{fc::array<char,37>}}\ \mbox{\hyperlink{namespacefc_1_1em_1_1detail_a9c0569f79125636061ea2de8ce7e72e4}{chr37}};}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00026}00026\ }
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00027}\mbox{\hyperlink{namespacefc_1_1em_1_1detail_a93ee9919f6873935e98b8b4e6a0a6d2b}{00027}}\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classfc_1_1sha256}{fc::sha256}}\ \mbox{\hyperlink{namespacefc_1_1em_1_1detail_a93ee9919f6873935e98b8b4e6a0a6d2b}{\_left}}(\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classfc_1_1sha512}{fc::sha512}}\&\ v\ )}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00028}00028\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00029}00029\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classfc_1_1sha256}{fc::sha256}}\ result;}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00030}00030\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(\ result.data(),\ v.\mbox{\hyperlink{classfc_1_1sha512_ad8e5e86882db16c32ceea6516d7c9f14}{data}}(),\ 32\ );}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00031}00031\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00032}00032\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00033}00033\ }
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00034}\mbox{\hyperlink{namespacefc_1_1em_1_1detail_aba71216ae4f9ef97c6fc369da4c73949}{00034}}\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classfc_1_1sha256}{fc::sha256}}\ \mbox{\hyperlink{namespacefc_1_1em_1_1detail_aba71216ae4f9ef97c6fc369da4c73949}{\_right}}(\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classfc_1_1sha512}{fc::sha512}}\&\ v\ )}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00035}00035\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00036}00036\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classfc_1_1sha256}{fc::sha256}}\ result;}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00037}00037\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(\ result.data(),\ v.\mbox{\hyperlink{classfc_1_1sha512_ad8e5e86882db16c32ceea6516d7c9f14}{data}}()\ +\ 32,\ 32\ );}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00038}00038\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00039}00039\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00040}00040\ }
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00041}00041\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ \_put(\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}**\ dest,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i)}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00042}00042\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00043}00043\ \ \ \ \ \ \ \ \ \ \ \ \ *(*dest)++\ =\ (i\ >>\ 24)\ \&\ 0xff;}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00044}00044\ \ \ \ \ \ \ \ \ \ \ \ \ *(*dest)++\ =\ (i\ >>\ 16)\ \&\ 0xff;}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00045}00045\ \ \ \ \ \ \ \ \ \ \ \ \ *(*dest)++\ =\ (i\ >>\ \ 8)\ \&\ 0xff;}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00046}00046\ \ \ \ \ \ \ \ \ \ \ \ \ *(*dest)++\ =\ \ i\ \ \ \ \ \ \ \ \&\ 0xff;}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00047}00047\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00048}00048\ }
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00049}00049\ }
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00050}00050\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{namespacefc_1_1em_1_1detail_a9c0569f79125636061ea2de8ce7e72e4}{chr37}}\ \mbox{\hyperlink{namespacefc_1_1em_1_1detail_a93816298a63426acda0480565941ae0f}{\_derive\_message}}(\ \textcolor{keywordtype}{char}\ first,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ key32,\ \textcolor{keywordtype}{int}\ i\ )}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00051}00051\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00052}00052\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacefc_1_1em_1_1detail_a9c0569f79125636061ea2de8ce7e72e4}{chr37}}\ result;}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00053}00053\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*\ dest\ =\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*)\ result.begin();}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00054}00054\ \ \ \ \ \ \ \ \ \ \ \ \ *dest++\ =\ first;}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00055}00055\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(\ dest,\ key32,\ 32\ );\ dest\ +=\ 32;}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00056}00056\ \ \ \ \ \ \ \ \ \ \ \ \ \_put(\ \&dest,\ i\ );}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00057}00057\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00058}00058\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00059}00059\ }
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00060}\mbox{\hyperlink{namespacefc_1_1em_1_1detail_a93816298a63426acda0480565941ae0f}{00060}}\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classfc_1_1array}{chr37}}\ \mbox{\hyperlink{namespacefc_1_1em_1_1detail_a93816298a63426acda0480565941ae0f}{\_derive\_message}}(\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classfc_1_1array}{public\_key\_data}}\&\ key,\ \textcolor{keywordtype}{int}\ i\ )}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00061}00061\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00062}00062\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacefc_1_1em_1_1detail_a93816298a63426acda0480565941ae0f}{\_derive\_message}}(\ *key.begin(),\ key.begin()\ +\ 1,\ i\ );}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00063}00063\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00064}00064\ }
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00065}00065\ }
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00066}\mbox{\hyperlink{namespacefc_1_1em_1_1detail_a9202ff2d16099cd15727f70839b339bf}{00066}}\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ ec\_group\&\ \mbox{\hyperlink{namespacefc_1_1em_1_1detail_a9202ff2d16099cd15727f70839b339bf}{get\_curve}}()}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00067}00067\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00068}00068\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ ec\_group\ secp256k1(\ EC\_GROUP\_new\_by\_curve\_name(\ NID\_secp256k1\ )\ );}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00069}00069\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ secp256k1;}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00070}00070\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00071}00071\ }
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00072}00072\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ private\_key\_secret\ \_get\_curve\_order()}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00073}00073\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00074}00074\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ ec\_group\&\ group\ =\ \mbox{\hyperlink{namespacefc_1_1em_1_1detail_a9202ff2d16099cd15727f70839b339bf}{get\_curve}}();}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00075}00075\ \ \ \ \ \ \ \ \ \ \ \ \ bn\_ctx\ ctx(BN\_CTX\_new());}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00076}00076\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structfc_1_1ssl__bignum}{ssl\_bignum}}\ order;}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00077}00077\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{exception_8hpp_abed525eeff3ae581be7e4e2fcd3b7bf4}{FC\_ASSERT}}(\ EC\_GROUP\_get\_order(\ group,\ order,\ ctx\ )\ );}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00078}00078\ \ \ \ \ \ \ \ \ \ \ \ \ private\_key\_secret\ bin;}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00079}00079\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{exception_8hpp_abed525eeff3ae581be7e4e2fcd3b7bf4}{FC\_ASSERT}}(\ BN\_num\_bytes(\ order\ )\ ==\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(bin.data\_size())\ );}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00080}00080\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{exception_8hpp_abed525eeff3ae581be7e4e2fcd3b7bf4}{FC\_ASSERT}}(\ BN\_bn2bin(\ order,\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*)\ bin.data()\ )\ ==\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(bin.data\_size())\ );}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00081}00081\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ bin;}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00082}00082\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00083}00083\ }
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00084}\mbox{\hyperlink{namespacefc_1_1em_1_1detail_a65fd8894fa465fa022db3d60c3a5a896}{00084}}\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ private\_key\_secret\&\ \mbox{\hyperlink{namespacefc_1_1em_1_1detail_a65fd8894fa465fa022db3d60c3a5a896}{get\_curve\_order}}()}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00085}00085\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00086}00086\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ private\_key\_secret\ order\ =\ \_get\_curve\_order();}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00087}00087\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ order;}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00088}00088\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00089}00089\ }
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00090}00090\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ private\_key\_secret\ \_get\_half\_curve\_order()}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00091}00091\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00092}00092\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ ec\_group\&\ group\ =\ \mbox{\hyperlink{namespacefc_1_1em_1_1detail_a9202ff2d16099cd15727f70839b339bf}{get\_curve}}();}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00093}00093\ \ \ \ \ \ \ \ \ \ \ \ \ bn\_ctx\ ctx(BN\_CTX\_new());}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00094}00094\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structfc_1_1ssl__bignum}{ssl\_bignum}}\ order;}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00095}00095\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{exception_8hpp_abed525eeff3ae581be7e4e2fcd3b7bf4}{FC\_ASSERT}}(\ EC\_GROUP\_get\_order(\ group,\ order,\ ctx\ )\ );}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00096}00096\ \ \ \ \ \ \ \ \ \ \ \ \ BN\_rshift1(\ order,\ order\ );}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00097}00097\ \ \ \ \ \ \ \ \ \ \ \ \ private\_key\_secret\ bin;}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00098}00098\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{exception_8hpp_abed525eeff3ae581be7e4e2fcd3b7bf4}{FC\_ASSERT}}(\ BN\_num\_bytes(\ order\ )\ ==\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(bin.data\_size())\ );}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00099}00099\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{exception_8hpp_abed525eeff3ae581be7e4e2fcd3b7bf4}{FC\_ASSERT}}(\ BN\_bn2bin(\ order,\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*)\ bin.data()\ )\ ==\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(bin.data\_size())\ );}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00100}00100\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ bin;}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00101}00101\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00102}00102\ }
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00103}\mbox{\hyperlink{namespacefc_1_1em_1_1detail_af64d3f2a7d95222e4791e20b73c89855}{00103}}\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ private\_key\_secret\&\ \mbox{\hyperlink{namespacefc_1_1em_1_1detail_af64d3f2a7d95222e4791e20b73c89855}{get\_half\_curve\_order}}()}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00104}00104\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00105}00105\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ private\_key\_secret\ half\_order\ =\ \_get\_half\_curve\_order();}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00106}00106\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ half\_order;}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00107}00107\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00108}00108\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00109}00109\ }
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00110}00110\ \ \ \ \ \mbox{\hyperlink{classfc_1_1public__key}{public\_key}}\ public\_key::from\_key\_data(\ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespacefc_1_1em_a1627d67937daf81f9156f8e630b6578c}{public\_key\_data}}\ \&data\ )\ \{}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00111}00111\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classfc_1_1em_1_1public__key_a8eed30372185ba8bbca72bc3d54ea3a5}{public\_key}}(data);}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00112}00112\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00113}00113\ }
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00114}\mbox{\hyperlink{classfc_1_1em_1_1private__key_adaae621cc354967dd104354d9cf5087f}{00114}}\ \ \ \ \ \mbox{\hyperlink{classfc_1_1em_1_1private__key}{private\_key}}\ \mbox{\hyperlink{classfc_1_1em_1_1private__key_adaae621cc354967dd104354d9cf5087f}{private\_key::child}}(\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classfc_1_1sha256}{fc::sha256}}\&\ offset\ )\textcolor{keyword}{const}}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00115}00115\ \textcolor{keyword}{\ \ \ \ }\{}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00116}00116\ \ \ \ \ \ \ \ \mbox{\hyperlink{classfc_1_1sha256_1_1encoder}{fc::sha256::encoder}}\ enc;}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00117}00117\ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacefc_1_1raw_a3a18d8161aa5b4f4f02b6fcfdff5e5d1}{fc::raw::pack}}(\ enc,\ \mbox{\hyperlink{classfc_1_1em_1_1private__key_a5457c40e282065ba380abd52cb08114f}{get\_public\_key}}()\ );}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00118}00118\ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacefc_1_1raw_a3a18d8161aa5b4f4f02b6fcfdff5e5d1}{fc::raw::pack}}(\ enc,\ offset\ );}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00119}00119\ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classfc_1_1em_1_1private__key_a03a2665fa3a319f162e9bec5fc055c48}{generate\_from\_seed}}(\ \mbox{\hyperlink{classfc_1_1em_1_1private__key_a5b4aa27bb36f2e617c07838e1dab24ea}{get\_secret}}(),\ enc.\mbox{\hyperlink{classfc_1_1sha256_1_1encoder_a4d8b8181e912194cf98a56164671adf8}{result}}()\ );}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00120}00120\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00121}00121\ }
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00122}\mbox{\hyperlink{classfc_1_1em_1_1public__key_aa1ce66a0a2ee8cab3b42fe9a6793eb87}{00122}}\ \ \ \ \ std::string\ \mbox{\hyperlink{classfc_1_1em_1_1public__key_a5e1d683d88f1aacb7eed1a1fb2ef5155}{public\_key::to\_base58}}(\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classfc_1_1array}{public\_key\_data}}\ \&key\ )}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00123}00123\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00124}00124\ \ \ \ \ \ \ \mbox{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t}}\ check\ =\ (\mbox{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t}})\mbox{\hyperlink{classfc_1_1sha256_a474784de7d6213b855abd7e952df5e36}{sha256::hash}}(key.data,\ \textcolor{keyword}{sizeof}(key)).\mbox{\hyperlink{classfc_1_1sha256_ac933820516182c134a6473227db0e7da}{\_hash}}[0];}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00125}00125\ \ \ \ \ \ \ \textcolor{keyword}{static\_assert}(\textcolor{keyword}{sizeof}(\mbox{\hyperlink{yubico__otp_8c_a9246c20bb98ad2b4c60313c053c70f08}{key}})\ +\ \textcolor{keyword}{sizeof}(check)\ ==\ 37,\ \textcolor{stringliteral}{"{}"{}});\ \textcolor{comment}{//\ hack\ around\ gcc\ bug:\ key.size()\ should\ be\ constexpr,\ but\ isn't}}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00126}00126\ \ \ \ \ \ \ \mbox{\hyperlink{classfc_1_1array}{array<char,\ 37>}}\ data;}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00127}00127\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(data.data,\ key.begin(),\ key.size());}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00128}00128\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(data.begin()\ +\ key.size(),\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*)\&check,\ \textcolor{keyword}{sizeof}(check));}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00129}00129\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacefc_a0dd6c1e5792e0823aa1987e06513a4ce}{fc::to\_base58}}(data.begin(),\ data.size(),\ \mbox{\hyperlink{classfc_1_1optional__delegate}{fc::yield\_function\_t}}());}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00130}00130\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00131}00131\ }
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00132}\mbox{\hyperlink{classfc_1_1em_1_1public__key_a64e4b80211327d21f832bcd3a54b4ee0}{00132}}\ \ \ \ \ \mbox{\hyperlink{classfc_1_1em_1_1public__key}{public\_key}}\ \mbox{\hyperlink{classfc_1_1em_1_1public__key_a64e4b80211327d21f832bcd3a54b4ee0}{public\_key::from\_base58}}(\ \textcolor{keyword}{const}\ std::string\&\ b58\ )}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00133}00133\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00134}00134\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classfc_1_1array}{array<char,\ 37>}}\ data;}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00135}00135\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}}\ =\ \mbox{\hyperlink{namespacefc_ab9aa48ceb035b5fc4b0ff9e48b40bc1d}{fc::from\_base58}}(b58,\ (\textcolor{keywordtype}{char}*)\&data,\ \textcolor{keyword}{sizeof}(data)\ );}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00136}00136\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{exception_8hpp_abed525eeff3ae581be7e4e2fcd3b7bf4}{FC\_ASSERT}}(\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}}\ ==\ \textcolor{keyword}{sizeof}(data)\ );}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00137}00137\ }
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00138}00138\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classfc_1_1array}{public\_key\_data}}\ \mbox{\hyperlink{yubico__otp_8c_a9246c20bb98ad2b4c60313c053c70f08}{key}};}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00139}00139\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t}}\ check\ =\ (\mbox{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t}})\mbox{\hyperlink{classfc_1_1sha256_a474784de7d6213b855abd7e952df5e36}{sha256::hash}}(data.data,\ \textcolor{keyword}{sizeof}(key)).\mbox{\hyperlink{classfc_1_1sha256_ac933820516182c134a6473227db0e7da}{\_hash}}[0];}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00140}00140\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{exception_8hpp_abed525eeff3ae581be7e4e2fcd3b7bf4}{FC\_ASSERT}}(\ memcmp(\ (\textcolor{keywordtype}{char}*)\&check,\ data.data\ +\ \textcolor{keyword}{sizeof}(key),\ \textcolor{keyword}{sizeof}(check)\ )\ ==\ 0\ );}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00141}00141\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(\ (\textcolor{keywordtype}{char}*)key.data,\ data.data,\ \textcolor{keyword}{sizeof}(key)\ );}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00142}00142\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ from\_key\_data(key);}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00143}00143\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00144}00144\ }
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00145}\mbox{\hyperlink{classfc_1_1em_1_1public__key_a19484f3cb6590ef4db5fdd22c5ae3b2c}{00145}}\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classfc_1_1em_1_1public__key_a19484f3cb6590ef4db5fdd22c5ae3b2c}{public\_key::fingerprint}}()\textcolor{keyword}{\ const}}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00146}00146\ \textcolor{keyword}{\ \ \ \ }\{}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00147}00147\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classfc_1_1array}{public\_key\_data}}\ key\ =\ \mbox{\hyperlink{classfc_1_1em_1_1public__key_aed654142e816c546dfafd79f806c7bef}{serialize}}();}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00148}00148\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classfc_1_1ripemd160}{ripemd160}}\ hash\ =\ \mbox{\hyperlink{classfc_1_1ripemd160_a7d43ada80e62a7a73ca472365138f863}{ripemd160::hash}}(\ \mbox{\hyperlink{classfc_1_1sha256_a474784de7d6213b855abd7e952df5e36}{sha256::hash}}(\ key.begin(),\ key.size()\ )\ );}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00149}00149\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*\ fp\ =\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*)\ hash.\_hash;}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00150}00150\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (fp[0]\ <<\ 24)\ |\ (fp[1]\ <<\ 16)\ |\ (fp[2]\ <<\ 8)\ |\ fp[3];}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00151}00151\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00152}00152\ }
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00153}00153\ \ \ \ \ \textcolor{keywordtype}{bool}\ public\_key::is\_canonical(\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classfc_1_1array}{compact\_signature}}\&\ c\ )\ \{}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00154}00154\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ !(c.\mbox{\hyperlink{classfc_1_1array_ad01e4627be17148ee922c37944c48626}{data}}[1]\ \&\ 0x80)}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00155}00155\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\&\ !(c.\mbox{\hyperlink{classfc_1_1array_ad01e4627be17148ee922c37944c48626}{data}}[1]\ ==\ 0\ \&\&\ !(c.\mbox{\hyperlink{classfc_1_1array_ad01e4627be17148ee922c37944c48626}{data}}[2]\ \&\ 0x80))}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00156}00156\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\&\ !(c.\mbox{\hyperlink{classfc_1_1array_ad01e4627be17148ee922c37944c48626}{data}}[33]\ \&\ 0x80)}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00157}00157\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\&\ !(c.\mbox{\hyperlink{classfc_1_1array_ad01e4627be17148ee922c37944c48626}{data}}[33]\ ==\ 0\ \&\&\ !(c.\mbox{\hyperlink{classfc_1_1array_ad01e4627be17148ee922c37944c48626}{data}}[34]\ \&\ 0x80));}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00158}00158\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00159}00159\ }
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00160}\mbox{\hyperlink{classfc_1_1em_1_1private__key_a03a2665fa3a319f162e9bec5fc055c48}{00160}}\ \ \ \ \ \mbox{\hyperlink{classfc_1_1em_1_1private__key}{private\_key}}\ \mbox{\hyperlink{classfc_1_1em_1_1private__key_a03a2665fa3a319f162e9bec5fc055c48}{private\_key::generate\_from\_seed}}(\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classfc_1_1sha256}{fc::sha256}}\&\ seed,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classfc_1_1sha256}{fc::sha256}}\&\ offset\ )}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00161}00161\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00162}00162\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structfc_1_1ssl__bignum}{ssl\_bignum}}\ z;}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00163}00163\ \ \ \ \ \ \ \ \ BN\_bin2bn((\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*)\&offset,\ \textcolor{keyword}{sizeof}(offset),\ z);}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00164}00164\ }
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00165}00165\ \ \ \ \ \ \ \ \ ec\_group\ group(EC\_GROUP\_new\_by\_curve\_name(NID\_secp256k1));}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00166}00166\ \ \ \ \ \ \ \ \ bn\_ctx\ ctx(BN\_CTX\_new());}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00167}00167\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structfc_1_1ssl__bignum}{ssl\_bignum}}\ order;}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00168}00168\ \ \ \ \ \ \ \ \ EC\_GROUP\_get\_order(group,\ order,\ ctx);}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00169}00169\ }
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00170}00170\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ secexp\ =\ (seed\ +\ z)\ \%\ order}}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00171}00171\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structfc_1_1ssl__bignum}{ssl\_bignum}}\ secexp;}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00172}00172\ \ \ \ \ \ \ \ \ BN\_bin2bn((\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*)\&seed,\ \textcolor{keyword}{sizeof}(seed),\ secexp);}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00173}00173\ \ \ \ \ \ \ \ \ BN\_add(secexp,\ secexp,\ z);}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00174}00174\ \ \ \ \ \ \ \ \ BN\_mod(secexp,\ secexp,\ order,\ ctx);}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00175}00175\ }
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00176}00176\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classfc_1_1sha256}{fc::sha256}}\ secret;}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00177}00177\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{exception_8hpp_abed525eeff3ae581be7e4e2fcd3b7bf4}{FC\_ASSERT}}(BN\_num\_bytes(secexp)\ <=\ \mbox{\hyperlink{stdint_8h_a414156feea104f8f75b4ed9e3121b2f6}{int64\_t}}(\textcolor{keyword}{sizeof}(secret)));}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00178}00178\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ shift\ =\ \textcolor{keyword}{sizeof}(secret)\ -\/\ BN\_num\_bytes(secexp);}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00179}00179\ \ \ \ \ \ \ \ \ BN\_bn2bin(secexp,\ ((\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*)\&secret)+shift);}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00180}00180\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classfc_1_1em_1_1private__key_a64ed3a33735ac67ecf15d65be9a0a4ae}{regenerate}}(\ secret\ );}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00181}00181\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00182}00182\ }
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00183}00183\ \ \ \ \ \mbox{\hyperlink{classfc_1_1sha256}{fc::sha256}}\ \mbox{\hyperlink{classfc_1_1em_1_1private__key_a5b4aa27bb36f2e617c07838e1dab24ea}{private\_key::get\_secret}}(\ \textcolor{keyword}{const}\ EC\_KEY\ *\ \textcolor{keyword}{const}\ k\ )}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00184}00184\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00185}00185\ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ !k\ )}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00186}00186\ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00187}00187\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classfc_1_1sha256}{fc::sha256}}();}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00188}00188\ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00189}00189\ }
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00190}00190\ \ \ \ \ \ \ \ \mbox{\hyperlink{classfc_1_1sha256}{fc::sha256}}\ sec;}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00191}00191\ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{include_2fc_2crypto_2bigint_8hpp_a62125ea4e1d748a4a9c1aed9766f451a}{BIGNUM}}*\ \mbox{\hyperlink{namespacebn}{bn}}\ =\ EC\_KEY\_get0\_private\_key(k);}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00192}00192\ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ \mbox{\hyperlink{namespacebn}{bn}}\ ==\ NULL\ )}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00193}00193\ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00194}00194\ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{exception_8hpp_a7590ddac4f181b661c3eeaf5feccc6ac}{FC\_THROW\_EXCEPTION}}(\ \mbox{\hyperlink{classfc_1_1exception}{exception}},\ \textcolor{stringliteral}{"{}get\ private\ key\ failed"{}}\ );}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00195}00195\ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00196}00196\ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ nbytes\ =\ BN\_num\_bytes(\mbox{\hyperlink{namespacebn}{bn}});}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00197}00197\ \ \ \ \ \ \ \ BN\_bn2bin(\mbox{\hyperlink{namespacebn}{bn}},\ \&((\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*)\&sec)[32-\/nbytes]\ );}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00198}00198\ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ sec;}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00199}00199\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00200}00200\ }
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00201}\mbox{\hyperlink{classfc_1_1em_1_1private__key_a9cbdc5885be8c15f09556645c80c807a}{00201}}\ \ \ \ \ \mbox{\hyperlink{classfc_1_1em_1_1private__key}{private\_key}}\ \mbox{\hyperlink{classfc_1_1em_1_1private__key_a9cbdc5885be8c15f09556645c80c807a}{private\_key::generate}}()}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00202}00202\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00203}00203\ \ \ \ \ \ \ \ EC\_KEY*\ k\ =\ EC\_KEY\_new\_by\_curve\_name(\ NID\_secp256k1\ );}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00204}00204\ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ !k\ )\ \mbox{\hyperlink{exception_8hpp_a7590ddac4f181b661c3eeaf5feccc6ac}{FC\_THROW\_EXCEPTION}}(\ \mbox{\hyperlink{classfc_1_1exception}{exception}},\ \textcolor{stringliteral}{"{}Unable\ to\ generate\ EC\ key"{}}\ );}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00205}00205\ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ !EC\_KEY\_generate\_key(\ k\ )\ )}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00206}00206\ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00207}00207\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{exception_8hpp_a7590ddac4f181b661c3eeaf5feccc6ac}{FC\_THROW\_EXCEPTION}}(\ \mbox{\hyperlink{classfc_1_1exception}{exception}},\ \textcolor{stringliteral}{"{}ecc\ key\ generation\ error"{}}\ );}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00208}00208\ }
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00209}00209\ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00210}00210\ }
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00211}00211\ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classfc_1_1em_1_1private__key_a6d58a02b981b44d4b992f1748d18948c}{private\_key}}(\ k\ );}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00212}00212\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00213}00213\ }
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00214}00214\ }
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00215}00215\ \}}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00216}00216\ }
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00217}\mbox{\hyperlink{namespacefc_a61d89d3b2913f40f8a94aed7c241011a}{00217}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespacefc_adea61f2343de94d0fbcb920a32332ad9}{to\_variant}}(\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classfc_1_1em_1_1private__key}{em::private\_key}}\&\ var,\ \ \mbox{\hyperlink{classfc_1_1variant}{variant}}\&\ vo\ )}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00218}00218\ \{}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00219}00219\ \ \ \ \ vo\ =\ var.\mbox{\hyperlink{classfc_1_1em_1_1private__key_a5b4aa27bb36f2e617c07838e1dab24ea}{get\_secret}}();}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00220}00220\ \}}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00221}00221\ }
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00222}\mbox{\hyperlink{namespacefc_aaf71cf15f468f78447911bc96f281f03}{00222}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespacefc_accef08adf4ee05c36ccc550d8101b08f}{from\_variant}}(\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classfc_1_1variant}{variant}}\&\ var,\ \ \mbox{\hyperlink{classfc_1_1em_1_1private__key}{em::private\_key}}\&\ vo\ )}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00223}00223\ \{}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00224}00224\ \ \ \ \ \mbox{\hyperlink{classfc_1_1sha256}{fc::sha256}}\ sec;}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00225}00225\ \ \ \ \ \mbox{\hyperlink{namespacefc_accef08adf4ee05c36ccc550d8101b08f}{from\_variant}}(\ var,\ sec\ );}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00226}00226\ \ \ \ \ vo\ =\ \mbox{\hyperlink{classfc_1_1em_1_1private__key_a64ed3a33735ac67ecf15d65be9a0a4ae}{em::private\_key::regenerate}}(sec);}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00227}00227\ \}}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00228}00228\ }
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00229}\mbox{\hyperlink{namespacefc_a38400bca4e54bbb859ad1c9aaaf0a6e8}{00229}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespacefc_adea61f2343de94d0fbcb920a32332ad9}{to\_variant}}(\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classfc_1_1em_1_1public__key}{em::public\_key}}\&\ var,\ \ \mbox{\hyperlink{classfc_1_1variant}{variant}}\&\ vo\ )}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00230}00230\ \{}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00231}00231\ \ \ \ \ vo\ =\ var.\mbox{\hyperlink{classfc_1_1em_1_1public__key_aed654142e816c546dfafd79f806c7bef}{serialize}}();}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00232}00232\ \}}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00233}00233\ }
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00234}\mbox{\hyperlink{namespacefc_aafd2377171149c102be2b1b693ea8787}{00234}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespacefc_accef08adf4ee05c36ccc550d8101b08f}{from\_variant}}(\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classfc_1_1variant}{variant}}\&\ var,\ \ \mbox{\hyperlink{classfc_1_1em_1_1public__key}{em::public\_key}}\&\ vo\ )}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00235}00235\ \{}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00236}00236\ \ \ \ \ \mbox{\hyperlink{classfc_1_1array}{em::public\_key\_data}}\ dat;}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00237}00237\ \ \ \ \ \mbox{\hyperlink{namespacefc_accef08adf4ee05c36ccc550d8101b08f}{from\_variant}}(\ var,\ dat\ );}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00238}00238\ \ \ \ \ vo\ =\ \mbox{\hyperlink{classfc_1_1em_1_1public__key}{em::public\_key}}(dat);}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00239}00239\ \}}
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00240}00240\ }
\DoxyCodeLine{\Hypertarget{elliptic__em__common_8cpp_source_l00241}00241\ \}}

\end{DoxyCode}
