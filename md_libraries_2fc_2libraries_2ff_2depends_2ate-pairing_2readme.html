<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Wire Sysio: High-Speed Software Implementation of the Optimal Ate Pairing over Barreto-Naehrig Curves</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Wire Sysio<span id="projectnumber">&#160;Wire Sysion 1.0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('md_libraries_2fc_2libraries_2ff_2depends_2ate-pairing_2readme.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">High-Speed Software Implementation of the Optimal Ate Pairing over Barreto-Naehrig Curves</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This library provides functionality to compute the optimal ate pairing over Barreto-Naehrig (BN) curves. It is released under the <a href="http://opensource.org/licenses/BSD-3-Clause">BSD 3-Clause License</a>.</p>
<p>Now I'm developing a new pairing library <a href="https://github.com/herumi/mcl/">mcl</a>, which is more portable and supports larger primes than this library though it is a little slower.</p>
<h1>History </h1>
<ul>
<li>2015/May/15: add <a class="el" href="md_libraries_2fc_2libraries_2ff_2depends_2ate-pairing_2java_2java.html">java api</a></li>
<li>2014/Jun/15: support a BN curve for SNARKs, incorporating code from <a href="https://github.com/scipr-lab/libsnark">libsnark</a></li>
<li>2013/Jun/02: support <code>mulx</code> on <a href="http://en.wikipedia.org/wiki/Haswell_%28microarchitecture%29">Haswell</a></li>
<li>2013/Mar/08: add elliptic curve class</li>
<li>2012/Jan/30: rewrite ate pairing according to <a href="http://www.patricklonga.bravehost.com/speed_pairing.html">Faster explicit formulas for computing pairings over ordinary curves</a></li>
<li>2010/Sep/8: change twist xi from u + 12 to u</li>
<li>2010/Jul/15: use cyclotomic squaring for final exponentiation</li>
<li>2010/Jun/18: first release</li>
</ul>
<h1>Overview </h1>
<p>The following two BN curves are supported:</p>
<ol type="1">
<li>a BN curve over the 254-bit prime p = 36z^4 + 36z^3 + 24z^2 + 6z + 1 where z = -(2^62 + 2^55 + 1); and</li>
<li>a BN curve over a 254-bit prime p such that n := p + 1 - t has high 2-adicity.</li>
</ol>
<p>By default, the first curve (we call it as CurveFp254BNb) is used; when setting the flag <code>SUPPORT_SNARK</code>, the second curve (we call it as CurveSNARK) is used instead.</p>
<ul>
<li><b>CurveFp254BNb</b> The value of z is found by <a href="http://dx.doi.org/10.1007/978-3-540-85538-5_13">[NASKM]</a> first. The curve instantiated by z is investigated by <a href="http://eprint.iacr.org/2010/429">[PSNB]</a> for an efficient implementation. Our library implements a fast algorithm, which is proposed by <a href="http://eprint.iacr.org/2010/526">[AKLGL]</a> for this curve. The performance of this library is competitive to the state-of-the-art implementation report in <a href="http://sac2013.irmacs.sfu.ca/slides/s1.pdf">[ABLR]</a>.</li>
<li><b>CurveSNARK</b> Support for the second curve builds on code provided by <a href="http://www.scipr-lab.org/">SCIPR Lab</a> in <a href="https://github.com/scipr-lab/libsnark">libsnark</a>. The curve was specifically selected for speeding up <b>Succinct Non-interactive ARguments of Knowledge</b> (SNARKs), which benefit from its high 2-adicity (see <a href="http://eprint.iacr.org/2013/507">[BCGTV13]</a> and <a href="http://eprint.iacr.org/2013/879">[BCTV14]</a>).</li>
</ul>
<p>Pairing computations on the first curve are more efficient, and the performance numbers reported below (and in our papers) are achieved using this curve (which is prefered for applications that do not benefit from high 2-adicity). Note that the old parameters in [BDMOHT] are not used now.</p>
<h1>Parameters </h1>
<p>The curve equation for a BN curve is: </p><pre class="fragment">E/Fp: y^2 = x^3 + b .
</pre><p>The two supported BN curves have the following parameters:</p>
<ol type="1">
<li>b = 2 and p = 16798108731015832284940804142231733909889187121439069848933715426072753864723; and</li>
<li>b = 3 and p = 21888242871839275222246405745257275088696311157297823662689037894645226208583.</li>
</ol>
<p>As usual,</p>
<ul>
<li>the cyclic group G1 (aka <a class="el" href="class_ec1.html">Ec1</a>) is instantiated as E(Fp)[n] where n := p + 1 - t;</li>
<li>the cyclic group <a class="el" href="struct_g2.html">G2</a> (aka <a class="el" href="class_ec2.html">Ec2</a>) is instantiated as the inverse image of E'(Fp^2)[n] under a twisting isomorphism from E' to E; and</li>
<li>the pairing e: G1 x <a class="el" href="struct_g2.html">G2</a> -&gt; <a class="el" href="class_fp12.html">Fp12</a> is the optimal ate pairing.</li>
</ul>
<p>The field <a class="el" href="class_fp12.html">Fp12</a> is constructed via the following tower:</p>
<ul>
<li><a class="el" href="class_fp2.html">Fp2</a> = <a class="el" href="class_fp.html">Fp</a>[u] / (u^2 + 1)</li>
<li>Fp6 = <a class="el" href="class_fp2.html">Fp2</a>[v] / (v^3 - Xi) where Xi = u + 1</li>
<li><a class="el" href="class_fp12.html">Fp12</a> = Fp6[w] / (w^2 - v)</li>
</ul>
<h1>Requirements </h1>
<ul>
<li>OS: 64-bit Windows; 64-bit Linux; Mac OS X</li>
<li>CPU: x64 Intel; AMD processor</li>
<li>C++ compiler: Visual Studio 2012; gcc 4.4.1 or later</li>
</ul>
<h1>Build instructions </h1>
<h2>Windows</h2>
<pre class="fragment">&gt; git clone git://github.com/herumi/xbyak.git
&gt; git clone git://github.com/herumi/ate-pairing.git
&gt; git clone git://github.com/herumi/cybozulib-ext.git ; compiled binary of mpir
</pre><p>Open <code>ate/ate.sln</code> and compile <code>test_bn</code> with Release mode. The produced binary is <code>ate/x64/Release/test_bn.exe</code>.</p>
<h2>Cygwin</h2>
<p>Install <code>mingw64-x86_64-gcc-g++</code> (run Cygwin setup and search <code>mingw64</code>). Then use the following commands: </p><pre class="fragment">PATH=/usr/x86_64-w64-mingw32/sys-root/mingw/bin/:$PATH
make -j
test/bn.exe
</pre><p>Note that <code>test/bn.exe</code> uses <code>mulx</code> if possible; if you do not want to use it, run the executable as <code>test/bn.exe -mulx 0</code>. (This allows you to verify the difference with/without mulx on Haswell.)</p>
<h2>Linux</h2>
<p>Use the following commands: </p><pre class="fragment">$ git clone git://github.com/herumi/xbyak.git
$ git clone git://github.com/herumi/ate-pairing.git
$ cd ate-pairing
$ make -j
$ test/bn
</pre><p>The library <a href="https://github.com/herumi/xbyak">xbyak</a> is a x86/x86-64 JIT assembler for C++, developed for efficient pairing implementations. (See also <a href="http://homepage1.nifty.com/herumi/soft/xbyak_e.html">this webpage</a>.) Note that binaries other than <code>test/bn</code> are used for testing purposes only.</p>
<ul>
<li>This implementation uses dynamically-generated code, so you will get the error <code>zmInit ERR:can't protect</code> if execution of code on the heap is disallowed by some modern systems. For example, on Fedora 20, run <code>sudo setsebool -P allow_execheap 1</code> to allow execution to solve this.</li>
</ul>
<p>By the default, the first BN curve is used. If instead you want to use the second BN curve (specialized to SNARKs), modify the fourth line above to: </p><pre class="fragment">$ make -j SUPPORT_SNARK=1
</pre><ul>
<li>REMARK. You <em>defined</em> <code>BN_SUPPORT_SNARK</code> macro for a compile when if you use a library(libzm.a) made by <code>SUPPORT_SNARK=1</code>.</li>
</ul>
<h1>Usage </h1>
<p>See the function <code><a class="el" href="sample_8cpp.html#ab3c0ff110d2d351b57056b5c79f8f4fa">sample2()</a></code> in <a href="https://github.com/herumi/ate-pairing/blob/master/test/sample.cpp">sample.cpp</a>. Also, use can use <code>mpz_class</code> for scalar multiplication of points on the elliptic curves, if <code>MIE_ATE_USE_GMP</code> is defined. For instance: </p><pre class="fragment">using namespace bn;
Param::init();
const Ec2 g2(...);
const Ec1 g1(...);
mpz_class a("123456789");
mpz_class b("98765432");
Ec1 g1a = g1 * a;
Ec2 g2b = g2 * b;
Fp12 e;
opt_atePairing(e, g2b, g1a);
</pre><h1>Usage for Java </h1>
<p>See <a class="el" href="md_libraries_2fc_2libraries_2ff_2depends_2ate-pairing_2java_2java.html">java.md</a>. <a class="el" href="struct_a.html">A</a> sample code is <a href="java/BN254Test.java">BN254Test.java</a>.</p>
<h1>Operation costs </h1>
<p>Let mu be the cost of <em>unreduced multiplication</em> producing double-precision result (i.e., 256-bit int x 256-bit int to 512-bit int); and let r be the cost of <em>modular reduction</em> of double-precision integers (i.e., 512-bit int to 256-bit int in <a class="el" href="class_fp.html">Fp</a>). Then, for us,</p>
<ul>
<li><a class="el" href="class_fp.html#aadceb26f8ffc93073e770c183c3f9b68">Fp::mul</a> = mu + r</li>
<li><a class="el" href="class_fp2.html#a2c1c38beb6f006778112096fc2aac7f2">Fp2::mul</a> = 3mu + 2r</li>
<li>Fp2::square = 2mu + 2r</li>
</ul>
<p>Next, we compare the costs of our library with the one of <a href="http://eprint.iacr.org/2010/526">[AKLGL10]</a>:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Phase   </th><th class="markdownTableHeadNone">[AKLGL10]   </th><th class="markdownTableHeadNone">This work    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Miller loop   </td><td class="markdownTableBodyNone">6792mu + 3022r   </td><td class="markdownTableBodyNone">6785mu + 3022r    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Final exponentiation   </td><td class="markdownTableBodyNone">3753mu + 2006r   </td><td class="markdownTableBodyNone">3526mu + 1932r    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Optimal ate pairing   </td><td class="markdownTableBodyNone">10545mu + 5028r   </td><td class="markdownTableBodyNone">10311mu + 4954r   </td></tr>
</table>
<p>Note: <a href="http://eprint.iacr.org/2010/526">[Table 2 in p. 17, AKLGL10]</a> does not contain the cost of (m, r) so we have added the costs of (282m + 6mu + 4r) and (30m + 75mu + 50r) to ML and FE respectively.</p>
<p>Finally, at the moment, our implementation does not support the algorithm in <a href="https://eprint.iacr.org/2010/429">PSNB10</a>.</p>
<h1>Benchmark </h1>
<p>The cost of a pairing is <b>1.17M</b> clock cycles on Core i7 4700MQ (Haswell) 2.4GHz processor with TurboBoost disabled. Below, we also include clock cycle counts on Core i7 2600 3.4GHz, Xeon X5650 2.6GHz, and Core i7 4700MQ 2.4GHz. The formal benchmark is written in [ZPMRTH]. </p><pre class="fragment">% sudo sh -c "echo 0 &gt; /sys/devices/system/cpu/cpufreq/boost"
% cat /sys/devices/system/cpu/cpufreq/boost
0
</pre><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">operation   </th><th class="markdownTableHeadNone">i7 2600   </th><th class="markdownTableHeadNone">Xeon X5650   </th><th class="markdownTableHeadNone">Haswell   </th><th class="markdownTableHeadNone">Haswell with mulx    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">TurboBoost   </td><td class="markdownTableBodyNone">on   </td><td class="markdownTableBodyNone">on   </td><td class="markdownTableBodyNone">off   </td><td class="markdownTableBodyNone">off   </td></tr>
</table>
<p>| | | | mu | 50 |60 |42 |38 r | 80 |98 |69 |65 <a class="el" href="class_fp.html">Fp</a>:mul |124 |146 |98 |90 <a class="el" href="class_fp2.html">Fp2</a>:mul |360 |412 | | <a class="el" href="class_fp2.html">Fp2</a>:square |288 |335 | | | | | | G1::double |1150 |1300 | | G1::add |2200 |2600 | | G2::double |2500 |2900 | | G2::add |5650 |6500 | | Fp12::square|4500 |5150 | | <a class="el" href="class_fp12.html#a120decc9bc6a64401de37f6cf2b3337e">Fp12::mul</a> |6150 |7000 | | | | | | Miller loop |0.83M |0.97M |0.82M |0.71M final_exp |0.53M |0.63M |0.51M |0.46M | | | | pairing |1.36M |1.60M |1.33M |1.17M</p>
<h1>References </h1>
<ul>
<li>[ABLR] <a href="http://dx.doi.org/10.1007/978-3-662-43414-7_1"><em>The Realm of the Pairings</em></a> (Invited Talk), Diego F. Aranha, Paulo <a class="el" href="struct_s.html">S</a>. L. M. Barreto, Patrick Longa, and Jefferson E. Ricardini, SAC 2013, (<a href="http://eprint.iacr.org/2013/722">preprint</a>, <a href="http://sac2013.irmacs.sfu.ca/slides/s1.pdf">slide</a>)</li>
<li>[NASKM] <a href="http://dx.doi.org/10.1007/978-3-540-85538-5_13"><em>Integer Variable chi-Based Ate Pairing</em></a>, Y. Nogami, M. Akane, Y. Sakemi, H. Kato, and Y. Morikawa, Pairing 2008</li>
<li>[PSNB] <a href="http://dx.doi.org/10.1016/j.jss.2011.03.083"><em>A Family of Implementation-Friendly BN Elliptic Curves</em></a>, G.C.C.F. Pereira, M.A. Simplicio Jr, M. Naehrig, P.S.L.M. Barreto, J. Systems and Software 2011, (<a href="http://eprint.iacr.org/2010/429">preprint</a>)</li>
<li>[AKLGL] <a href="http://dx.doi.org/10.1007/978-3-642-20465-4_5"><em>Faster Explicit Formulas for Computing Pairings over Ordinary Curves</em></a>, D.F. Aranha, K. Karabina, P. Longa, C.H. Gebotys, J. Lopez, EUROCRYPTO 2011, (<a href="http://eprint.iacr.org/2010/526">preprint</a>)</li>
<li>[BDMOHT] <a href="http://dx.doi.org/10.1007/978-3-642-17455-1_2"><em>High-Speed Software Implementation of the Optimal Ate Pairing over Barreto-Naehrig Curves</em></a>, Jean-Luc Beuchat, Jorge Enrique González Díaz, Shigeo Mitsunari, Eiji Okamoto, Francisco Rodríguez-Henríquez, Tadanori Teruya, Pairing 2010, (<a href="http://eprint.iacr.org/2010/354">preprint</a>)</li>
<li><a href="http://eprint.iacr.org/2013/362"><em>A Fast Implementation of the Optimal Ate Pairing over BN curve on Intel Haswell Processor</em></a>, Shigeo Mitsunari, IACR ePrint 2013/362</li>
<li><a href="http://eprint.iacr.org/2013/879"><em>Succinct Non-Interactive Zero Knowledge for a von Neumann Architecture</em></a>, Eli Ben-Sasson, Alessandro Chiesa, Eran Tromer, Madars Virza, USENIX Security 2014</li>
<li>[ZPMRTH] <a href="http://dx.doi.org/10.1109/TC.2014.2329681"><em>Software implementation of an Attribute-Based Encryption scheme</em></a>, Eric Zavattoni and Luis J. Dominguez Perez and Shigeo Mitsunari and Ana H. Sanchez-Ramirez and Tadanori Teruya and Francisco Rodriguez-Henriquez, IEEE Transactions on Computers, To appear, (<a href="https://eprint.iacr.org/2014/401">preprint</a>, <a href="http://sandia.cs.cinvestav.mx/index.php?n=Site.CPABE">project Web page and source code</a>)</li>
<li><a href="http://homepage1.nifty.com/herumi/crypt/ate-pairing.html">This library's old webpage</a></li>
</ul>
<h1>Authors </h1>
<ul>
<li>MITSUNARI Shigeo (<code>herumi@nifty.com</code>)</li>
<li>TERUYA Tadanori (<code>tadanori.teruya@gmail.com</code>)</li>
</ul>
<h1>Contributors </h1>
<ul>
<li>Alessandro Chiesa (<code>alexch@mit.edu</code>)</li>
<li>Madars Virza (<code>madars@mit.edu</code>) </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0 </li>
  </ul>
</div>
</body>
</html>
