<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Wire Sysio: libraries/fc/secp256k1/secp256k1/src/modules/schnorrsig/main_impl.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Wire Sysio<span id="projectnumber">&#160;Wire Sysion 1.0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('schnorrsig_2main__impl_8h.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">main_impl.h File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="secp256k1_8h_source.html">../../../include/secp256k1.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="secp256k1__schnorrsig_8h_source.html">../../../include/secp256k1_schnorrsig.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="fc_2secp256k1_2secp256k1_2src_2hash_8h_source.html">../../hash.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for main_impl.h:</div>
<div class="dyncontent">
<div class="center"><img src="schnorrsig_2main__impl_8h__incl.png" border="0" usemap="#alibraries_2fc_2secp256k1_2secp256k1_2src_2modules_2schnorrsig_2main__impl_8h" alt=""/></div>
<map name="alibraries_2fc_2secp256k1_2secp256k1_2src_2modules_2schnorrsig_2main__impl_8h" id="alibraries_2fc_2secp256k1_2secp256k1_2src_2modules_2schnorrsig_2main__impl_8h">
<area shape="rect" title=" " alt="" coords="98,5,262,61"/>
<area shape="rect" href="secp256k1_8h.html" title=" " alt="" coords="5,271,182,297"/>
<area shape="poly" title=" " alt="" coords="131,63,107,84,88,110,77,148,75,187,80,225,87,256,82,257,75,226,70,188,72,147,83,108,103,81,128,59"/>
<area shape="rect" href="secp256k1__schnorrsig_8h.html" title=" " alt="" coords="98,109,263,150"/>
<area shape="poly" title=" " alt="" coords="183,62,183,94,178,94,178,62"/>
<area shape="rect" href="fc_2secp256k1_2secp256k1_2src_2hash_8h.html" title=" " alt="" coords="305,116,389,142"/>
<area shape="poly" title=" " alt="" coords="230,59,314,106,311,111,227,64"/>
<area shape="rect" title=" " alt="" coords="59,345,128,371"/>
<area shape="poly" title=" " alt="" coords="96,297,96,329,91,329,91,297"/>
<area shape="poly" title=" " alt="" coords="160,152,139,173,121,199,109,228,101,257,96,256,104,226,117,196,135,170,156,148"/>
<area shape="rect" href="secp256k1__extrakeys_8h.html" title=" " alt="" coords="131,198,290,223"/>
<area shape="poly" title=" " alt="" coords="190,149,203,182,198,184,185,151"/>
<area shape="poly" title=" " alt="" coords="192,226,128,265,125,261,190,222"/>
<area shape="rect" title=" " alt="" coords="315,198,378,223"/>
<area shape="poly" title=" " alt="" coords="350,143,350,182,344,182,344,143"/>
<area shape="rect" href="stdint_8h.html" title=" " alt="" coords="403,198,467,223"/>
<area shape="poly" title=" " alt="" coords="362,141,412,185,408,189,358,145"/>
<area shape="rect" title=" " alt="" coords="358,271,421,297"/>
<area shape="poly" title=" " alt="" coords="430,225,407,260,403,257,425,222"/>
<area shape="rect" title=" " alt="" coords="446,271,512,297"/>
<area shape="poly" title=" " alt="" coords="444,222,466,256,461,259,440,225"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="schnorrsig_2main__impl_8h__dep__incl.png" border="0" usemap="#alibraries_2fc_2secp256k1_2secp256k1_2src_2modules_2schnorrsig_2main__impl_8hdep" alt=""/></div>
<map name="alibraries_2fc_2secp256k1_2secp256k1_2src_2modules_2schnorrsig_2main__impl_8hdep" id="alibraries_2fc_2secp256k1_2secp256k1_2src_2modules_2schnorrsig_2main__impl_8hdep">
<area shape="rect" title=" " alt="" coords="39,5,202,61"/>
<area shape="rect" href="schnorrsig_2tests__exhaustive__impl_8h.html" title=" " alt="" coords="5,109,236,165"/>
<area shape="poly" title=" " alt="" coords="123,77,123,108,118,108,118,77"/>
</map>
</div>
</div>
<p><a href="schnorrsig_2main__impl_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a5bc69eb5f207ec82d3331594b2b9151e" id="r_a5bc69eb5f207ec82d3331594b2b9151e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5bc69eb5f207ec82d3331594b2b9151e">secp256k1_schnorrsig_sign32</a> (const <a class="el" href="secp256k1_8h.html#a282ec9e6dfec8c35955c3eb2f7476e5e">secp256k1_context</a> *ctx, unsigned char *sig64, const unsigned char *msg32, const <a class="el" href="structsecp256k1__keypair.html">secp256k1_keypair</a> *keypair, const unsigned char *aux_rand32)</td></tr>
<tr class="separator:a5bc69eb5f207ec82d3331594b2b9151e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a221c526a09b8faa406e15824eb92cf1b" id="r_a221c526a09b8faa406e15824eb92cf1b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a221c526a09b8faa406e15824eb92cf1b">secp256k1_schnorrsig_sign</a> (const <a class="el" href="secp256k1_8h.html#a282ec9e6dfec8c35955c3eb2f7476e5e">secp256k1_context</a> *ctx, unsigned char *sig64, const unsigned char *msg32, const <a class="el" href="structsecp256k1__keypair.html">secp256k1_keypair</a> *keypair, const unsigned char *aux_rand32)</td></tr>
<tr class="separator:a221c526a09b8faa406e15824eb92cf1b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b12030197ede3e4cef1e2118c40fd33" id="r_a4b12030197ede3e4cef1e2118c40fd33"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4b12030197ede3e4cef1e2118c40fd33">secp256k1_schnorrsig_sign_custom</a> (const <a class="el" href="secp256k1_8h.html#a282ec9e6dfec8c35955c3eb2f7476e5e">secp256k1_context</a> *ctx, unsigned char *sig64, const unsigned char *msg, size_t msglen, const <a class="el" href="structsecp256k1__keypair.html">secp256k1_keypair</a> *keypair, <a class="el" href="structsecp256k1__schnorrsig__extraparams.html">secp256k1_schnorrsig_extraparams</a> *extraparams)</td></tr>
<tr class="separator:a4b12030197ede3e4cef1e2118c40fd33"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4b9ea2608b3c6e0dadad4c42a48d85f" id="r_ab4b9ea2608b3c6e0dadad4c42a48d85f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab4b9ea2608b3c6e0dadad4c42a48d85f">secp256k1_schnorrsig_verify</a> (const <a class="el" href="secp256k1_8h.html#a282ec9e6dfec8c35955c3eb2f7476e5e">secp256k1_context</a> *ctx, const unsigned char *sig64, const unsigned char *msg, size_t msglen, const <a class="el" href="structsecp256k1__xonly__pubkey.html">secp256k1_xonly_pubkey</a> *<a class="el" href="yubihsm__pkcs11_8c.html#a931987c85fd408a620505ee9a1aa6f58">pubkey</a>)</td></tr>
<tr class="separator:ab4b9ea2608b3c6e0dadad4c42a48d85f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:aa1fa704630945408ebce25083c7977e1" id="r_aa1fa704630945408ebce25083c7977e1"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="secp256k1__schnorrsig_8h.html#a134d980bb4432c6d70e3298979c8f5ec">secp256k1_nonce_function_hardened</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa1fa704630945408ebce25083c7977e1">secp256k1_nonce_function_bip340</a> = nonce_function_bip340</td></tr>
<tr class="separator:aa1fa704630945408ebce25083c7977e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a221c526a09b8faa406e15824eb92cf1b" name="a221c526a09b8faa406e15824eb92cf1b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a221c526a09b8faa406e15824eb92cf1b">&#9670;&#160;</a></span>secp256k1_schnorrsig_sign()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int secp256k1_schnorrsig_sign </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="secp256k1_8h.html#a282ec9e6dfec8c35955c3eb2f7476e5e">secp256k1_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *</td>          <td class="paramname"><span class="paramname"><em>sig64</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *</td>          <td class="paramname"><span class="paramname"><em>msg32</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structsecp256k1__keypair.html">secp256k1_keypair</a> *</td>          <td class="paramname"><span class="paramname"><em>keypair</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *</td>          <td class="paramname"><span class="paramname"><em>aux_rand32</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Same as secp256k1_schnorrsig_sign32, but DEPRECATED. Will be removed in future versions. </p>

<p class="definition">Definition at line <a class="el" href="schnorrsig_2main__impl_8h_source.html#l00200">200</a> of file <a class="el" href="schnorrsig_2main__impl_8h_source.html">main_impl.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  200</span>                                                                                                                                                                                 {</div>
<div class="line"><span class="lineno">  201</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="#a5bc69eb5f207ec82d3331594b2b9151e">secp256k1_schnorrsig_sign32</a>(ctx, sig64, msg32, keypair, aux_rand32);</div>
<div class="line"><span class="lineno">  202</span>}</div>
<div class="ttc" id="aschnorrsig_2main__impl_8h_html_a5bc69eb5f207ec82d3331594b2b9151e"><div class="ttname"><a href="#a5bc69eb5f207ec82d3331594b2b9151e">secp256k1_schnorrsig_sign32</a></div><div class="ttdeci">int secp256k1_schnorrsig_sign32(const secp256k1_context *ctx, unsigned char *sig64, const unsigned char *msg32, const secp256k1_keypair *keypair, const unsigned char *aux_rand32)</div><div class="ttdef"><b>Definition</b> <a href="schnorrsig_2main__impl_8h_source.html#l00195">main_impl.h:195</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="schnorrsig_2main__impl_8h_a221c526a09b8faa406e15824eb92cf1b_cgraph.png" border="0" usemap="#aschnorrsig_2main__impl_8h_a221c526a09b8faa406e15824eb92cf1b_cgraph" alt=""/></div>
<map name="aschnorrsig_2main__impl_8h_a221c526a09b8faa406e15824eb92cf1b_cgraph" id="aschnorrsig_2main__impl_8h_a221c526a09b8faa406e15824eb92cf1b_cgraph">
<area shape="rect" title=" " alt="" coords="5,13,188,38"/>
<area shape="rect" href="schnorrsig_2main__impl_8h.html#a5bc69eb5f207ec82d3331594b2b9151e" title=" " alt="" coords="236,5,387,46"/>
<area shape="poly" title=" " alt="" coords="188,23,220,23,220,28,188,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="schnorrsig_2main__impl_8h_a221c526a09b8faa406e15824eb92cf1b_icgraph.png" border="0" usemap="#aschnorrsig_2main__impl_8h_a221c526a09b8faa406e15824eb92cf1b_icgraph" alt=""/></div>
<map name="aschnorrsig_2main__impl_8h_a221c526a09b8faa406e15824eb92cf1b_icgraph" id="aschnorrsig_2main__impl_8h_a221c526a09b8faa406e15824eb92cf1b_icgraph">
<area shape="rect" title=" " alt="" coords="482,5,665,31"/>
<area shape="rect" href="schnorrsig_2tests__impl_8h.html#a12bd744ae085199a91c835561c1638f5" title=" " alt="" coords="293,5,434,31"/>
<area shape="poly" title=" " alt="" coords="467,21,434,21,434,16,467,16"/>
<area shape="rect" href="schnorrsig_2tests__impl_8h.html#ac157ab3450c7cca7e46cdc65e8019392" title=" " alt="" coords="103,5,245,31"/>
<area shape="poly" title=" " alt="" coords="278,21,246,21,246,16,278,16"/>
<area shape="rect" href="tests_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title=" " alt="" coords="5,5,55,31"/>
<area shape="poly" title=" " alt="" coords="87,21,55,21,55,16,87,16"/>
</map>
</div>

</div>
</div>
<a id="a5bc69eb5f207ec82d3331594b2b9151e" name="a5bc69eb5f207ec82d3331594b2b9151e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5bc69eb5f207ec82d3331594b2b9151e">&#9670;&#160;</a></span>secp256k1_schnorrsig_sign32()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int secp256k1_schnorrsig_sign32 </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="secp256k1_8h.html#a282ec9e6dfec8c35955c3eb2f7476e5e">secp256k1_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *</td>          <td class="paramname"><span class="paramname"><em>sig64</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *</td>          <td class="paramname"><span class="paramname"><em>msg32</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structsecp256k1__keypair.html">secp256k1_keypair</a> *</td>          <td class="paramname"><span class="paramname"><em>keypair</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *</td>          <td class="paramname"><span class="paramname"><em>aux_rand32</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create a Schnorr signature.</p>
<p>Does <em>not</em> strictly follow BIP-340 because it does not verify the resulting signature. Instead, you can manually use secp256k1_schnorrsig_verify and abort if it fails.</p>
<p>This function only signs 32-byte messages. If you have messages of a different size (or the same size but without a context-specific tag prefix), it is recommended to create a 32-byte message hash with secp256k1_tagged_sha256 and then sign the hash. Tagged hashing allows providing an context-specific tag for domain separation. This prevents signatures from being valid in multiple contexts by accident.</p>
<p>Returns 1 on success, 0 on failure. Args: ctx: pointer to a context object, initialized for signing. Out: sig64: pointer to a 64-byte array to store the serialized signature. In: msg32: the 32-byte message being signed. keypair: pointer to an initialized keypair. aux_rand32: 32 bytes of fresh randomness. While recommended to provide this, it is only supplemental to security and can be NULL. <a class="el" href="struct_a.html">A</a> NULL argument is treated the same as an all-zero one. See BIP-340 "Default Signing" for a full explanation of this argument and for guidance if randomness is expensive. </p>

<p class="definition">Definition at line <a class="el" href="schnorrsig_2main__impl_8h_source.html#l00195">195</a> of file <a class="el" href="schnorrsig_2main__impl_8h_source.html">main_impl.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  195</span>                                                                                                                                                                                   {</div>
<div class="line"><span class="lineno">  196</span>    <span class="comment">/* We cast away const from the passed aux_rand32 argument since we know the default nonce function does not modify it. */</span></div>
<div class="line"><span class="lineno">  197</span>    <span class="keywordflow">return</span> secp256k1_schnorrsig_sign_internal(ctx, sig64, msg32, 32, keypair, <a class="code hl_variable" href="#aa1fa704630945408ebce25083c7977e1">secp256k1_nonce_function_bip340</a>, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)aux_rand32);</div>
<div class="line"><span class="lineno">  198</span>}</div>
<div class="ttc" id="aschnorrsig_2main__impl_8h_html_aa1fa704630945408ebce25083c7977e1"><div class="ttname"><a href="#aa1fa704630945408ebce25083c7977e1">secp256k1_nonce_function_bip340</a></div><div class="ttdeci">const secp256k1_nonce_function_hardened secp256k1_nonce_function_bip340</div><div class="ttdef"><b>Definition</b> <a href="schnorrsig_2main__impl_8h_source.html#l00099">main_impl.h:99</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="schnorrsig_2main__impl_8h_a5bc69eb5f207ec82d3331594b2b9151e_icgraph.png" border="0" usemap="#aschnorrsig_2main__impl_8h_a5bc69eb5f207ec82d3331594b2b9151e_icgraph" alt=""/></div>
<map name="aschnorrsig_2main__impl_8h_a5bc69eb5f207ec82d3331594b2b9151e_icgraph" id="aschnorrsig_2main__impl_8h_a5bc69eb5f207ec82d3331594b2b9151e_icgraph">
<area shape="rect" title=" " alt="" coords="729,172,880,213"/>
<area shape="rect" href="schnorr_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="565,5,614,31"/>
<area shape="poly" title=" " alt="" coords="782,161,740,101,712,70,679,44,646,30,614,23,615,18,648,25,682,40,715,66,744,97,787,158"/>
<area shape="rect" href="valgrind__ctime__test_8c.html#af23de73dba8dc1c56af0f46f6af3f2de" title=" " alt="" coords="552,55,627,80"/>
<area shape="poly" title=" " alt="" coords="771,163,730,127,679,94,653,83,627,76,628,71,655,78,682,89,733,123,775,159"/>
<area shape="rect" href="schnorrsig_2main__impl_8h.html#a221c526a09b8faa406e15824eb92cf1b" title=" " alt="" coords="498,104,681,130"/>
<area shape="poly" title=" " alt="" coords="730,169,680,151,628,133,629,128,682,146,732,164"/>
<area shape="rect" href="schnorrsig_2tests__impl_8h.html#a12bd744ae085199a91c835561c1638f5" title=" " alt="" coords="301,155,442,180"/>
<area shape="poly" title=" " alt="" coords="713,190,443,174,443,169,713,185"/>
<area shape="rect" href="schnorrsig_2tests__impl_8h.html#afbcc12169b7558d9bd9cbbad8174ac06" title=" " alt="" coords="304,205,439,231"/>
<area shape="poly" title=" " alt="" coords="713,201,439,217,439,212,713,195"/>
<area shape="rect" href="schnorrsig_2tests__impl_8h.html#a3da78c8240bed7f834cde952569d440a" title=" " alt="" coords="509,255,670,296"/>
<area shape="poly" title=" " alt="" coords="736,222,646,257,644,252,735,217"/>
<area shape="rect" href="schnorrsig_2tests__impl_8h.html#abb22271ab74be54de7b405f2729467e8" title=" " alt="" coords="519,320,660,361"/>
<area shape="poly" title=" " alt="" coords="777,227,735,269,682,310,658,322,655,318,679,305,731,265,774,223"/>
<area shape="rect" href="schnorrsig_2tests__impl_8h.html#a6c1382ba9264d73d3daa0b3a059b7c6d" title=" " alt="" coords="293,381,450,407"/>
<area shape="poly" title=" " alt="" coords="793,228,776,265,752,305,721,344,682,375,625,399,564,410,504,413,450,409,451,404,504,407,564,405,624,393,679,371,717,340,748,302,772,262,788,226"/>
<area shape="rect" href="valgrind__ctime__test_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="347,55,396,80"/>
<area shape="poly" title=" " alt="" coords="536,70,397,70,397,65,536,65"/>
<area shape="poly" title=" " alt="" coords="517,136,431,157,429,151,516,131"/>
<area shape="rect" href="schnorrsig_2tests__impl_8h.html#ac157ab3450c7cca7e46cdc65e8019392" title=" " alt="" coords="103,263,245,288"/>
<area shape="poly" title=" " alt="" coords="309,189,294,195,237,230,193,264,189,260,234,226,292,190,307,184"/>
<area shape="rect" href="tests_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title=" " alt="" coords="5,263,55,288"/>
<area shape="poly" title=" " alt="" coords="87,278,55,278,55,273,87,273"/>
<area shape="poly" title=" " alt="" coords="311,238,222,265,220,259,309,233"/>
<area shape="rect" href="schnorrsig_2tests__impl_8h.html#a0866fca54a0356a508e7ecfaf7ba68ea" title=" " alt="" coords="304,255,439,296"/>
<area shape="poly" title=" " alt="" coords="494,278,439,278,439,273,494,273"/>
<area shape="poly" title=" " alt="" coords="289,278,246,278,246,273,289,273"/>
<area shape="poly" title=" " alt="" coords="503,337,402,327,292,310,218,292,219,286,294,305,403,322,504,332"/>
<area shape="poly" title=" " alt="" coords="327,377,292,358,192,291,195,287,294,353,329,372"/>
</map>
</div>

</div>
</div>
<a id="a4b12030197ede3e4cef1e2118c40fd33" name="a4b12030197ede3e4cef1e2118c40fd33"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b12030197ede3e4cef1e2118c40fd33">&#9670;&#160;</a></span>secp256k1_schnorrsig_sign_custom()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int secp256k1_schnorrsig_sign_custom </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="secp256k1_8h.html#a282ec9e6dfec8c35955c3eb2f7476e5e">secp256k1_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *</td>          <td class="paramname"><span class="paramname"><em>sig64</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *</td>          <td class="paramname"><span class="paramname"><em>msg</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>msglen</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structsecp256k1__keypair.html">secp256k1_keypair</a> *</td>          <td class="paramname"><span class="paramname"><em>keypair</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structsecp256k1__schnorrsig__extraparams.html">secp256k1_schnorrsig_extraparams</a> *</td>          <td class="paramname"><span class="paramname"><em>extraparams</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create a Schnorr signature with a more flexible API.</p>
<p>Same arguments as secp256k1_schnorrsig_sign except that it allows signing variable length messages and accepts a pointer to an extraparams object that allows customizing signing by passing additional arguments.</p>
<p>Creates the same signatures as schnorrsig_sign if msglen is 32 and the extraparams.ndata is the same as aux_rand32.</p>
<p>In: msg: the message being signed. Can only be NULL if msglen is 0. msglen: length of the message extraparams: pointer to a extraparams object (can be NULL) </p>

<p class="definition">Definition at line <a class="el" href="schnorrsig_2main__impl_8h_source.html#l00204">204</a> of file <a class="el" href="schnorrsig_2main__impl_8h_source.html">main_impl.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  204</span>                                                                                                                                                                                                                   {</div>
<div class="line"><span class="lineno">  205</span>    <a class="code hl_typedef" href="secp256k1__schnorrsig_8h.html#a134d980bb4432c6d70e3298979c8f5ec">secp256k1_nonce_function_hardened</a> noncefp = NULL;</div>
<div class="line"><span class="lineno">  206</span>    <span class="keywordtype">void</span> *ndata = NULL;</div>
<div class="line"><span class="lineno">  207</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aca8ac5ae73fd966db106de59160a178b">VERIFY_CHECK</a>(ctx != NULL);</div>
<div class="line"><span class="lineno">  208</span> </div>
<div class="line"><span class="lineno">  209</span>    <span class="keywordflow">if</span> (extraparams != NULL) {</div>
<div class="line"><span class="lineno">  210</span>        <a class="code hl_define" href="secp256k1_8c.html#a6e1f88c6ce07376501097b42a2b40727">ARG_CHECK</a>(secp256k1_memcmp_var(extraparams-&gt;<a class="code hl_variable" href="structsecp256k1__schnorrsig__extraparams.html#ad90ca666fb9cee5fb047d83bea870798">magic</a>,</div>
<div class="line"><span class="lineno">  211</span>                                       schnorrsig_extraparams_magic,</div>
<div class="line"><span class="lineno">  212</span>                                       <span class="keyword">sizeof</span>(extraparams-&gt;<a class="code hl_variable" href="structsecp256k1__schnorrsig__extraparams.html#ad90ca666fb9cee5fb047d83bea870798">magic</a>)) == 0);</div>
<div class="line"><span class="lineno">  213</span>        noncefp = extraparams-&gt;<a class="code hl_variable" href="structsecp256k1__schnorrsig__extraparams.html#a2077f4d9419810e53d252d9d91de33e4">noncefp</a>;</div>
<div class="line"><span class="lineno">  214</span>        ndata = extraparams-&gt;<a class="code hl_variable" href="structsecp256k1__schnorrsig__extraparams.html#a2b41a75d3d43b71f1f8e04703c1a857d">ndata</a>;</div>
<div class="line"><span class="lineno">  215</span>    }</div>
<div class="line"><span class="lineno">  216</span>    <span class="keywordflow">return</span> secp256k1_schnorrsig_sign_internal(ctx, sig64, msg, msglen, keypair, noncefp, ndata);</div>
<div class="line"><span class="lineno">  217</span>}</div>
<div class="ttc" id="afc_2secp256k1_2secp256k1_2src_2util_8h_html_aca8ac5ae73fd966db106de59160a178b"><div class="ttname"><a href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aca8ac5ae73fd966db106de59160a178b">VERIFY_CHECK</a></div><div class="ttdeci">#define VERIFY_CHECK(cond)</div><div class="ttdef"><b>Definition</b> <a href="fc_2secp256k1_2secp256k1_2src_2util_8h_source.html#l00095">util.h:95</a></div></div>
<div class="ttc" id="asecp256k1_8c_html_a6e1f88c6ce07376501097b42a2b40727"><div class="ttname"><a href="secp256k1_8c.html#a6e1f88c6ce07376501097b42a2b40727">ARG_CHECK</a></div><div class="ttdeci">#define ARG_CHECK(cond)</div><div class="ttdef"><b>Definition</b> <a href="secp256k1_8c_source.html#l00034">secp256k1.c:34</a></div></div>
<div class="ttc" id="asecp256k1__schnorrsig_8h_html_a134d980bb4432c6d70e3298979c8f5ec"><div class="ttname"><a href="secp256k1__schnorrsig_8h.html#a134d980bb4432c6d70e3298979c8f5ec">secp256k1_nonce_function_hardened</a></div><div class="ttdeci">int(* secp256k1_nonce_function_hardened)(unsigned char *nonce32, const unsigned char *msg, size_t msglen, const unsigned char *key32, const unsigned char *xonly_pk32, const unsigned char *algo, size_t algolen, void *data)</div><div class="ttdef"><b>Definition</b> <a href="secp256k1__schnorrsig_8h_source.html#l00041">secp256k1_schnorrsig.h:41</a></div></div>
<div class="ttc" id="astructsecp256k1__schnorrsig__extraparams_html_a2077f4d9419810e53d252d9d91de33e4"><div class="ttname"><a href="structsecp256k1__schnorrsig__extraparams.html#a2077f4d9419810e53d252d9d91de33e4">secp256k1_schnorrsig_extraparams::noncefp</a></div><div class="ttdeci">secp256k1_nonce_function_hardened noncefp</div><div class="ttdef"><b>Definition</b> <a href="secp256k1__schnorrsig_8h_source.html#l00084">secp256k1_schnorrsig.h:84</a></div></div>
<div class="ttc" id="astructsecp256k1__schnorrsig__extraparams_html_a2b41a75d3d43b71f1f8e04703c1a857d"><div class="ttname"><a href="structsecp256k1__schnorrsig__extraparams.html#a2b41a75d3d43b71f1f8e04703c1a857d">secp256k1_schnorrsig_extraparams::ndata</a></div><div class="ttdeci">void * ndata</div><div class="ttdef"><b>Definition</b> <a href="secp256k1__schnorrsig_8h_source.html#l00085">secp256k1_schnorrsig.h:85</a></div></div>
<div class="ttc" id="astructsecp256k1__schnorrsig__extraparams_html_ad90ca666fb9cee5fb047d83bea870798"><div class="ttname"><a href="structsecp256k1__schnorrsig__extraparams.html#ad90ca666fb9cee5fb047d83bea870798">secp256k1_schnorrsig_extraparams::magic</a></div><div class="ttdeci">unsigned char magic[4]</div><div class="ttdef"><b>Definition</b> <a href="secp256k1__schnorrsig_8h_source.html#l00083">secp256k1_schnorrsig.h:83</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="schnorrsig_2main__impl_8h_a4b12030197ede3e4cef1e2118c40fd33_icgraph.png" border="0" usemap="#aschnorrsig_2main__impl_8h_a4b12030197ede3e4cef1e2118c40fd33_icgraph" alt=""/></div>
<map name="aschnorrsig_2main__impl_8h_a4b12030197ede3e4cef1e2118c40fd33_icgraph" id="aschnorrsig_2main__impl_8h_a4b12030197ede3e4cef1e2118c40fd33_icgraph">
<area shape="rect" title=" " alt="" coords="501,99,653,140"/>
<area shape="rect" href="schnorrsig_2bench__impl_8h.html#a6195d286e02f462b28abf8c10d149800" title=" " alt="" coords="299,5,453,31"/>
<area shape="poly" title=" " alt="" coords="528,94,452,53,410,34,413,29,455,48,530,89"/>
<area shape="rect" href="schnorrsig_2bench__impl_8h.html#af4b484aa697df8bb3e5dff5c5b12f06b" title=" " alt="" coords="103,31,251,56"/>
<area shape="poly" title=" " alt="" coords="485,103,453,97,251,59,252,54,454,92,486,98"/>
<area shape="rect" href="schnorrsig_2tests__impl_8h.html#afbcc12169b7558d9bd9cbbad8174ac06" title=" " alt="" coords="309,107,443,132"/>
<area shape="poly" title=" " alt="" coords="486,122,443,122,443,117,486,117"/>
<area shape="rect" href="schnorrsig_2tests__impl_8h.html#a12bd744ae085199a91c835561c1638f5" title=" " alt="" coords="306,156,447,182"/>
<area shape="poly" title=" " alt="" coords="487,144,432,158,431,153,485,139"/>
<area shape="rect" href="schnorrsig_2tests__impl_8h.html#abb22271ab74be54de7b405f2729467e8" title=" " alt="" coords="306,206,447,246"/>
<area shape="poly" title=" " alt="" coords="533,151,455,197,431,208,429,203,452,192,530,146"/>
<area shape="poly" title=" " alt="" coords="284,33,252,37,251,31,283,27"/>
<area shape="rect" href="bench_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title=" " alt="" coords="5,31,55,56"/>
<area shape="poly" title=" " alt="" coords="87,46,55,46,55,41,87,41"/>
<area shape="rect" href="schnorrsig_2tests__impl_8h.html#ac157ab3450c7cca7e46cdc65e8019392" title=" " alt="" coords="106,156,248,182"/>
<area shape="poly" title=" " alt="" coords="307,139,232,158,231,153,306,134"/>
<area shape="rect" href="tests_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title=" " alt="" coords="5,156,55,182"/>
<area shape="poly" title=" " alt="" coords="90,172,55,172,55,166,90,166"/>
<area shape="poly" title=" " alt="" coords="290,172,248,172,248,166,290,166"/>
<area shape="poly" title=" " alt="" coords="290,204,224,185,225,180,291,199"/>
</map>
</div>

</div>
</div>
<a id="ab4b9ea2608b3c6e0dadad4c42a48d85f" name="ab4b9ea2608b3c6e0dadad4c42a48d85f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4b9ea2608b3c6e0dadad4c42a48d85f">&#9670;&#160;</a></span>secp256k1_schnorrsig_verify()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int secp256k1_schnorrsig_verify </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="secp256k1_8h.html#a282ec9e6dfec8c35955c3eb2f7476e5e">secp256k1_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *</td>          <td class="paramname"><span class="paramname"><em>sig64</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *</td>          <td class="paramname"><span class="paramname"><em>msg</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>msglen</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structsecp256k1__xonly__pubkey.html">secp256k1_xonly_pubkey</a> *</td>          <td class="paramname"><span class="paramname"><em>pubkey</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Verify a Schnorr signature.</p>
<p>Returns: 1: correct signature 0: incorrect signature Args: ctx: a secp256k1 context object, initialized for verification. In: sig64: pointer to the 64-byte signature to verify. msg: the message being verified. Can only be NULL if msglen is 0. msglen: length of the message pubkey: pointer to an x-only public key to verify with (cannot be NULL) </p>

<p class="definition">Definition at line <a class="el" href="schnorrsig_2main__impl_8h_source.html#l00219">219</a> of file <a class="el" href="schnorrsig_2main__impl_8h_source.html">main_impl.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  219</span>                                                                                                                                                                         {</div>
<div class="line"><span class="lineno">  220</span>    <a class="code hl_struct" href="structsecp256k1__scalar.html">secp256k1_scalar</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a>;</div>
<div class="line"><span class="lineno">  221</span>    <a class="code hl_struct" href="structsecp256k1__scalar.html">secp256k1_scalar</a> e;</div>
<div class="line"><span class="lineno">  222</span>    <a class="code hl_struct" href="structsecp256k1__gej.html">secp256k1_gej</a> rj;</div>
<div class="line"><span class="lineno">  223</span>    <a class="code hl_struct" href="structsecp256k1__ge.html">secp256k1_ge</a> pk;</div>
<div class="line"><span class="lineno">  224</span>    <a class="code hl_struct" href="structsecp256k1__gej.html">secp256k1_gej</a> pkj;</div>
<div class="line"><span class="lineno">  225</span>    <a class="code hl_struct" href="structsecp256k1__fe.html">secp256k1_fe</a> rx;</div>
<div class="line"><span class="lineno">  226</span>    <a class="code hl_struct" href="structsecp256k1__ge.html">secp256k1_ge</a> <a class="code hl_variable" href="bn_8cpp.html#af0a5201ca8846f05f25435b41d7f39f7">r</a>;</div>
<div class="line"><span class="lineno">  227</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a855e99b645b13e7905d074d02fe0bff5">buf</a>[32];</div>
<div class="line"><span class="lineno">  228</span>    <span class="keywordtype">int</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a49aa97067a36875627e1380c3fb3833d">overflow</a>;</div>
<div class="line"><span class="lineno">  229</span> </div>
<div class="line"><span class="lineno">  230</span>    <a class="code hl_define" href="fc_2secp256k1_2secp256k1_2src_2util_8h.html#aca8ac5ae73fd966db106de59160a178b">VERIFY_CHECK</a>(ctx != NULL);</div>
<div class="line"><span class="lineno">  231</span>    <a class="code hl_define" href="secp256k1_8c.html#a6e1f88c6ce07376501097b42a2b40727">ARG_CHECK</a>(sig64 != NULL);</div>
<div class="line"><span class="lineno">  232</span>    <a class="code hl_define" href="secp256k1_8c.html#a6e1f88c6ce07376501097b42a2b40727">ARG_CHECK</a>(msg != NULL || msglen == 0);</div>
<div class="line"><span class="lineno">  233</span>    <a class="code hl_define" href="secp256k1_8c.html#a6e1f88c6ce07376501097b42a2b40727">ARG_CHECK</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a931987c85fd408a620505ee9a1aa6f58">pubkey</a> != NULL);</div>
<div class="line"><span class="lineno">  234</span> </div>
<div class="line"><span class="lineno">  235</span>    <span class="keywordflow">if</span> (!secp256k1_fe_set_b32(&amp;rx, &amp;sig64[0])) {</div>
<div class="line"><span class="lineno">  236</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  237</span>    }</div>
<div class="line"><span class="lineno">  238</span> </div>
<div class="line"><span class="lineno">  239</span>    secp256k1_scalar_set_b32(&amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a>, &amp;sig64[32], &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a49aa97067a36875627e1380c3fb3833d">overflow</a>);</div>
<div class="line"><span class="lineno">  240</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a49aa97067a36875627e1380c3fb3833d">overflow</a>) {</div>
<div class="line"><span class="lineno">  241</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  242</span>    }</div>
<div class="line"><span class="lineno">  243</span> </div>
<div class="line"><span class="lineno">  244</span>    <span class="keywordflow">if</span> (!secp256k1_xonly_pubkey_load(ctx, &amp;pk, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a931987c85fd408a620505ee9a1aa6f58">pubkey</a>)) {</div>
<div class="line"><span class="lineno">  245</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  246</span>    }</div>
<div class="line"><span class="lineno">  247</span> </div>
<div class="line"><span class="lineno">  248</span>    <span class="comment">/* Compute e. */</span></div>
<div class="line"><span class="lineno">  249</span>    secp256k1_fe_get_b32(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a855e99b645b13e7905d074d02fe0bff5">buf</a>, &amp;pk.<a class="code hl_variable" href="structsecp256k1__ge.html#a3c04a97b606c82ea87e55d4a06f06b6e">x</a>);</div>
<div class="line"><span class="lineno">  250</span>    secp256k1_schnorrsig_challenge(&amp;e, &amp;sig64[0], msg, msglen, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a855e99b645b13e7905d074d02fe0bff5">buf</a>);</div>
<div class="line"><span class="lineno">  251</span> </div>
<div class="line"><span class="lineno">  252</span>    <span class="comment">/* Compute rj =  s*G + (-e)*pkj */</span></div>
<div class="line"><span class="lineno">  253</span>    secp256k1_scalar_negate(&amp;e, &amp;e);</div>
<div class="line"><span class="lineno">  254</span>    secp256k1_gej_set_ge(&amp;pkj, &amp;pk);</div>
<div class="line"><span class="lineno">  255</span>    secp256k1_ecmult(&amp;rj, &amp;pkj, &amp;e, &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a>);</div>
<div class="line"><span class="lineno">  256</span> </div>
<div class="line"><span class="lineno">  257</span>    secp256k1_ge_set_gej_var(&amp;<a class="code hl_variable" href="bn_8cpp.html#af0a5201ca8846f05f25435b41d7f39f7">r</a>, &amp;rj);</div>
<div class="line"><span class="lineno">  258</span>    <span class="keywordflow">if</span> (secp256k1_ge_is_infinity(&amp;<a class="code hl_variable" href="bn_8cpp.html#af0a5201ca8846f05f25435b41d7f39f7">r</a>)) {</div>
<div class="line"><span class="lineno">  259</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  260</span>    }</div>
<div class="line"><span class="lineno">  261</span> </div>
<div class="line"><span class="lineno">  262</span>    secp256k1_fe_normalize_var(&amp;<a class="code hl_variable" href="bn_8cpp.html#af0a5201ca8846f05f25435b41d7f39f7">r</a>.y);</div>
<div class="line"><span class="lineno">  263</span>    <span class="keywordflow">return</span> !secp256k1_fe_is_odd(&amp;<a class="code hl_variable" href="bn_8cpp.html#af0a5201ca8846f05f25435b41d7f39f7">r</a>.y) &amp;&amp;</div>
<div class="line"><span class="lineno">  264</span>           secp256k1_fe_equal_var(&amp;rx, &amp;<a class="code hl_variable" href="bn_8cpp.html#af0a5201ca8846f05f25435b41d7f39f7">r</a>.x);</div>
<div class="line"><span class="lineno">  265</span>}</div>
<div class="ttc" id="abn_8cpp_html_af0a5201ca8846f05f25435b41d7f39f7"><div class="ttname"><a href="bn_8cpp.html#af0a5201ca8846f05f25435b41d7f39f7">r</a></div><div class="ttdeci">const mie::Vuint &amp; r</div><div class="ttdef"><b>Definition</b> <a href="bn_8cpp_source.html#l00028">bn.cpp:28</a></div></div>
<div class="ttc" id="astructsecp256k1__fe_html"><div class="ttname"><a href="structsecp256k1__fe.html">secp256k1_fe</a></div><div class="ttdef"><b>Definition</b> <a href="field__10x26_8h_source.html#l00012">field_10x26.h:12</a></div></div>
<div class="ttc" id="astructsecp256k1__ge_html"><div class="ttname"><a href="structsecp256k1__ge.html">secp256k1_ge</a></div><div class="ttdef"><b>Definition</b> <a href="group_8h_source.html#l00016">group.h:16</a></div></div>
<div class="ttc" id="astructsecp256k1__ge_html_a3c04a97b606c82ea87e55d4a06f06b6e"><div class="ttname"><a href="structsecp256k1__ge.html#a3c04a97b606c82ea87e55d4a06f06b6e">secp256k1_ge::x</a></div><div class="ttdeci">secp256k1_fe x</div><div class="ttdef"><b>Definition</b> <a href="group_8h_source.html#l00017">group.h:17</a></div></div>
<div class="ttc" id="astructsecp256k1__gej_html"><div class="ttname"><a href="structsecp256k1__gej.html">secp256k1_gej</a></div><div class="ttdef"><b>Definition</b> <a href="group_8h_source.html#l00028">group.h:28</a></div></div>
<div class="ttc" id="astructsecp256k1__scalar_html"><div class="ttname"><a href="structsecp256k1__scalar.html">secp256k1_scalar</a></div><div class="ttdef"><b>Definition</b> <a href="scalar__4x64_8h_source.html#l00013">scalar_4x64.h:13</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a49aa97067a36875627e1380c3fb3833d"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a49aa97067a36875627e1380c3fb3833d">overflow</a></div><div class="ttdeci">bool overflow</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l00467">yubihsm_pkcs11.c:467</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a506da415c9307c897ca9be93acfe1d0f"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a></div><div class="ttdeci">char * s</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l00524">yubihsm_pkcs11.c:524</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a855e99b645b13e7905d074d02fe0bff5"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a855e99b645b13e7905d074d02fe0bff5">buf</a></div><div class="ttdeci">uint8_t buf[2048]</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l04770">yubihsm_pkcs11.c:4770</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a931987c85fd408a620505ee9a1aa6f58"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a931987c85fd408a620505ee9a1aa6f58">pubkey</a></div><div class="ttdeci">CK_BYTE_PTR pubkey</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l04984">yubihsm_pkcs11.c:4984</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="schnorrsig_2main__impl_8h_ab4b9ea2608b3c6e0dadad4c42a48d85f_icgraph.png" border="0" usemap="#aschnorrsig_2main__impl_8h_ab4b9ea2608b3c6e0dadad4c42a48d85f_icgraph" alt=""/></div>
<map name="aschnorrsig_2main__impl_8h_ab4b9ea2608b3c6e0dadad4c42a48d85f_icgraph" id="aschnorrsig_2main__impl_8h_ab4b9ea2608b3c6e0dadad4c42a48d85f_icgraph">
<area shape="rect" title=" " alt="" coords="709,189,860,229"/>
<area shape="rect" href="schnorrsig_2bench__impl_8h.html#aea3512ac27e2d636d3004a9507dc2ff9" title=" " alt="" coords="498,5,661,31"/>
<area shape="poly" title=" " alt="" coords="764,176,722,109,693,74,659,44,640,34,642,29,662,40,697,70,727,106,769,173"/>
<area shape="rect" href="schnorr_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="555,55,604,80"/>
<area shape="poly" title=" " alt="" coords="752,179,710,139,659,102,631,87,604,77,606,72,633,83,662,97,713,135,755,175"/>
<area shape="rect" href="schnorrsig_2tests__impl_8h.html#afbcc12169b7558d9bd9cbbad8174ac06" title=" " alt="" coords="304,137,439,163"/>
<area shape="poly" title=" " alt="" coords="740,182,702,162,660,146,603,136,544,134,439,141,439,136,544,129,603,131,661,141,704,157,743,178"/>
<area shape="rect" href="schnorrsig_2tests__impl_8h.html#a3da78c8240bed7f834cde952569d440a" title=" " alt="" coords="499,155,660,196"/>
<area shape="poly" title=" " alt="" coords="693,197,660,191,661,186,694,191"/>
<area shape="rect" href="schnorrsig_2tests__impl_8h.html#a40bf8f20fa4a04a544e177feef693980" title=" " alt="" coords="503,221,656,261"/>
<area shape="poly" title=" " alt="" coords="694,226,657,232,656,226,693,220"/>
<area shape="rect" href="schnorrsig_2tests__impl_8h.html#a12bd744ae085199a91c835561c1638f5" title=" " alt="" coords="301,285,442,311"/>
<area shape="poly" title=" " alt="" coords="740,239,703,259,661,275,605,288,547,297,443,302,443,297,547,291,604,283,660,270,701,254,738,235"/>
<area shape="rect" href="schnorrsig_2tests__impl_8h.html#abb22271ab74be54de7b405f2729467e8" title=" " alt="" coords="509,335,650,376"/>
<area shape="poly" title=" " alt="" coords="754,242,712,281,662,319,631,337,628,332,659,315,708,277,750,238"/>
<area shape="rect" href="schnorrsig_2tests__impl_8h.html#a6c1382ba9264d73d3daa0b3a059b7c6d" title=" " alt="" coords="293,396,450,422"/>
<area shape="poly" title=" " alt="" coords="773,245,756,281,732,321,701,359,662,390,610,411,555,422,501,425,451,423,451,418,501,420,555,417,609,406,659,385,697,355,728,318,751,278,768,242"/>
<area shape="rect" href="schnorrsig_2bench__impl_8h.html#af4b484aa697df8bb3e5dff5c5b12f06b" title=" " alt="" coords="298,5,446,31"/>
<area shape="poly" title=" " alt="" coords="483,21,446,21,446,16,483,16"/>
<area shape="rect" href="bench_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title=" " alt="" coords="149,5,198,31"/>
<area shape="poly" title=" " alt="" coords="282,21,199,21,199,16,282,16"/>
<area shape="rect" href="schnorrsig_2tests__impl_8h.html#ac157ab3450c7cca7e46cdc65e8019392" title=" " alt="" coords="103,285,245,311"/>
<area shape="poly" title=" " alt="" coords="342,175,194,287,191,283,339,171"/>
<area shape="rect" href="tests_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title=" " alt="" coords="5,285,55,311"/>
<area shape="poly" title=" " alt="" coords="87,301,55,301,55,296,87,296"/>
<area shape="rect" href="schnorrsig_2tests__impl_8h.html#a0866fca54a0356a508e7ecfaf7ba68ea" title=" " alt="" coords="304,221,439,261"/>
<area shape="poly" title=" " alt="" coords="499,203,440,222,438,217,498,198"/>
<area shape="poly" title=" " alt="" coords="291,267,222,287,220,282,289,262"/>
<area shape="poly" title=" " alt="" coords="488,244,439,244,439,238,488,238"/>
<area shape="poly" title=" " alt="" coords="285,301,245,301,245,296,285,296"/>
<area shape="poly" title=" " alt="" coords="493,351,293,326,231,314,232,309,293,321,493,346"/>
<area shape="poly" title=" " alt="" coords="327,391,292,372,194,314,197,309,294,368,330,386"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="aa1fa704630945408ebce25083c7977e1" name="aa1fa704630945408ebce25083c7977e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa1fa704630945408ebce25083c7977e1">&#9670;&#160;</a></span>secp256k1_nonce_function_bip340</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="secp256k1__schnorrsig_8h.html#a134d980bb4432c6d70e3298979c8f5ec">secp256k1_nonce_function_hardened</a> secp256k1_nonce_function_bip340 = nonce_function_bip340</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>An implementation of the nonce generation function as defined in Bitcoin Improvement Proposal 340 "Schnorr Signatures for secp256k1" (<a href="https://github.com/bitcoin/bips/blob/master/bip-0340.mediawiki">https://github.com/bitcoin/bips/blob/master/bip-0340.mediawiki</a>).</p>
<p>If a data pointer is passed, it is assumed to be a pointer to 32 bytes of auxiliary random data as defined in BIP-340. If the data pointer is NULL, the nonce derivation procedure follows BIP-340 by setting the auxiliary random data to zero. The algo argument must be non-NULL, otherwise the function will fail and return 0. The hash will be tagged with algo. Therefore, to create BIP-340 compliant signatures, algo must be set to "BIP0340/nonce" and algolen to 13. </p>

<p class="definition">Definition at line <a class="el" href="schnorrsig_2main__impl_8h_source.html#l00099">99</a> of file <a class="el" href="schnorrsig_2main__impl_8h_source.html">main_impl.h</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_428556e0652617aa37d2f7d8bcaf7fdf.html">libraries</a></li><li class="navelem"><a class="el" href="dir_71436f1774b2d89f0b80ac9efd482f1f.html">fc</a></li><li class="navelem"><a class="el" href="dir_a52e6239a5b2b3d02315cec608665301.html">secp256k1</a></li><li class="navelem"><a class="el" href="dir_d7bc7c582256a3e7079a332367360a08.html">secp256k1</a></li><li class="navelem"><a class="el" href="dir_161a7c3b899da95666bc0894eb81449b.html">src</a></li><li class="navelem"><a class="el" href="dir_61a25fd2e6e959c1219ac7fc9980d17d.html">modules</a></li><li class="navelem"><a class="el" href="dir_26960b3449882e6d1e404c9e84cd54a2.html">schnorrsig</a></li><li class="navelem"><a class="el" href="schnorrsig_2main__impl_8h.html">main_impl.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0 </li>
  </ul>
</div>
</body>
</html>
