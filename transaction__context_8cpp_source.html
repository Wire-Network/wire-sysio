<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Wire Sysio: libraries/chain/transaction_context.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Wire Sysio<span id="projectnumber">&#160;Wire Sysion 1.0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('transaction__context_8cpp_source.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">transaction_context.cpp</div></div>
</div><!--header-->
<div class="contents">
<a href="transaction__context_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="preprocessor">#include &lt;<a class="code" href="apply__context_8hpp.html">sysio/chain/apply_context.hpp</a>&gt;</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="preprocessor">#include &lt;<a class="code" href="transaction__context_8hpp.html">sysio/chain/transaction_context.hpp</a>&gt;</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="preprocessor">#include &lt;<a class="code" href="authorization__manager_8hpp.html">sysio/chain/authorization_manager.hpp</a>&gt;</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="preprocessor">#include &lt;<a class="code" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html">sysio/chain/exceptions.hpp</a>&gt;</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="preprocessor">#include &lt;<a class="code" href="resource__limits_8hpp.html">sysio/chain/resource_limits.hpp</a>&gt;</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="preprocessor">#include &lt;<a class="code" href="generated__transaction__object_8hpp.html">sysio/chain/generated_transaction_object.hpp</a>&gt;</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="preprocessor">#include &lt;<a class="code" href="transaction__object_8hpp.html">sysio/chain/transaction_object.hpp</a>&gt;</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="preprocessor">#include &lt;<a class="code" href="global__property__object_8hpp.html">sysio/chain/global_property_object.hpp</a>&gt;</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="preprocessor">#include &lt;<a class="code" href="deep__mind_8hpp.html">sysio/chain/deep_mind.hpp</a>&gt;</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span> </div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="preprocessor">#pragma push_macro(&quot;N&quot;)</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="preprocessor">#undef N</span></div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="preprocessor">#include &lt;boost/accumulators/accumulators.hpp&gt;</span></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="preprocessor">#include &lt;boost/accumulators/statistics/stats.hpp&gt;</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span><span class="preprocessor">#include &lt;boost/accumulators/statistics/min.hpp&gt;</span></div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="preprocessor">#include &lt;boost/accumulators/statistics/max.hpp&gt;</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="preprocessor">#include &lt;boost/accumulators/statistics/weighted_mean.hpp&gt;</span></div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span><span class="preprocessor">#include &lt;boost/accumulators/statistics/weighted_variance.hpp&gt;</span></div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span><span class="preprocessor">#pragma pop_macro(&quot;N&quot;)</span></div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span> </div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span><span class="preprocessor">#include &lt;chrono&gt;</span></div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span> </div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span><span class="keyword">namespace </span><a class="code hl_namespace" href="namespacesysio.html">sysio</a> { <span class="keyword">namespace </span>chain {</div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span> </div>
<div class="foldopen" id="foldopen00025" data-start="{" data-end="}">
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1transaction__checktime__timer.html#a5ade074ca4ee80878f7ea74383264b66">   25</a></span>   <a class="code hl_function" href="structsysio_1_1chain_1_1transaction__checktime__timer.html#ae2b6276397aaf3de6730a0e1db06f4c2">transaction_checktime_timer::transaction_checktime_timer</a>(<a class="code hl_struct" href="structsysio_1_1chain_1_1platform__timer.html">platform_timer</a>&amp; timer)</div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span>         : expired(timer.expired), <a class="code hl_variable" href="sys-vm_8cpp.html#a32ff5901c3a451a048ff45b692591ba3">_timer</a>(timer) {</div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span>      <a class="code hl_variable" href="structsysio_1_1chain_1_1transaction__checktime__timer.html#a957951b0f382670abeac7531d35924c1">expired</a> = 0;</div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span>   }</div>
</div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span> </div>
<div class="foldopen" id="foldopen00030" data-start="{" data-end="}">
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1transaction__checktime__timer.html#aef90525b3674b77efd2bb44da3405fc6">   30</a></span>   <span class="keywordtype">void</span> <a class="code hl_function" href="structsysio_1_1chain_1_1transaction__checktime__timer.html#aef90525b3674b77efd2bb44da3405fc6">transaction_checktime_timer::start</a>(<a class="code hl_class" href="classfc_1_1time__point.html">fc::time_point</a> tp) {</div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span>      _timer.<a class="code hl_function" href="structsysio_1_1chain_1_1platform__timer.html#a8396e86c6a626dd2632cb075bd254ad4">start</a>(tp);</div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span>   }</div>
</div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span> </div>
<div class="foldopen" id="foldopen00034" data-start="{" data-end="}">
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1transaction__checktime__timer.html#ad84002d0816f8b4b6aa3c2dd3772d1fe">   34</a></span>   <span class="keywordtype">void</span> <a class="code hl_function" href="structsysio_1_1chain_1_1transaction__checktime__timer.html#ad84002d0816f8b4b6aa3c2dd3772d1fe">transaction_checktime_timer::stop</a>() {</div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span>      _timer.<a class="code hl_function" href="structsysio_1_1chain_1_1platform__timer.html#a5cb70a095755d00bf02d37d31b6e46af">stop</a>();</div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span>   }</div>
</div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span> </div>
<div class="foldopen" id="foldopen00038" data-start="{" data-end="}">
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1transaction__checktime__timer.html#a8d521e32027600dda6369c50f01a10c9">   38</a></span>   <span class="keywordtype">void</span> <a class="code hl_function" href="structsysio_1_1chain_1_1transaction__checktime__timer.html#a8d521e32027600dda6369c50f01a10c9">transaction_checktime_timer::set_expiration_callback</a>(<span class="keywordtype">void</span>(*func)(<span class="keywordtype">void</span>*), <span class="keywordtype">void</span>* user) {</div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span>      _timer.<a class="code hl_function" href="structsysio_1_1chain_1_1platform__timer.html#a5fd5d9852eeb86bed7975076db770b10">set_expiration_callback</a>(func, user);</div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span>   }</div>
</div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span> </div>
<div class="foldopen" id="foldopen00042" data-start="{" data-end="}">
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1transaction__checktime__timer.html#a05ca36147adfd661c6a20101244bc16f">   42</a></span>   <a class="code hl_function" href="structsysio_1_1chain_1_1transaction__checktime__timer.html#a05ca36147adfd661c6a20101244bc16f">transaction_checktime_timer::~transaction_checktime_timer</a>() {</div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span>      <a class="code hl_function" href="structsysio_1_1chain_1_1transaction__checktime__timer.html#ad84002d0816f8b4b6aa3c2dd3772d1fe">stop</a>();</div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span>      _timer.<a class="code hl_function" href="structsysio_1_1chain_1_1platform__timer.html#a5fd5d9852eeb86bed7975076db770b10">set_expiration_callback</a>(<span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>);</div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span>   }</div>
</div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span> </div>
<div class="foldopen" id="foldopen00047" data-start="{" data-end="}">
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1transaction__context.html#a642c586e04091f30df003a71847f35f3">   47</a></span>   <a class="code hl_function" href="classsysio_1_1chain_1_1transaction__context.html#a642c586e04091f30df003a71847f35f3">transaction_context::transaction_context</a>( <a class="code hl_class" href="classsysio_1_1chain_1_1controller.html">controller</a>&amp; c,</div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span>                                             <span class="keyword">const</span> <a class="code hl_struct" href="structsysio_1_1chain_1_1packed__transaction.html">packed_transaction</a>&amp; t,</div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span>                                             <a class="code hl_struct" href="structsysio_1_1chain_1_1transaction__checktime__timer.html">transaction_checktime_timer</a>&amp;&amp; tmr,</div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span>                                             <a class="code hl_class" href="classfc_1_1time__point.html">fc::time_point</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a>,</div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span>                                             <span class="keywordtype">bool</span> <a class="code hl_enumvalue" href="namespacefc.html#a3d8a2be677709cc41f09aa7925f2d55fad6bcd1364809e1b881bb22334d14cd56">read_only</a>)</div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span>   :control(c)</div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span>   ,packed_trx(t)</div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span>   ,undo_session()</div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span>   ,trace(<a class="code hl_namespace" href="namespacestd.html">std</a>::make_shared&lt;<a class="code hl_struct" href="structsysio_1_1chain_1_1transaction__trace.html">transaction_trace</a>&gt;())</div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span>   ,start(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a>)</div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span>   ,transaction_timer(<a class="code hl_namespace" href="namespacestd.html">std</a>::move(tmr))</div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span>   ,is_read_only(<a class="code hl_enumvalue" href="namespacefc.html#a3d8a2be677709cc41f09aa7925f2d55fad6bcd1364809e1b881bb22334d14cd56">read_only</a>)</div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span>   ,net_usage(trace-&gt;net_usage)</div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>   ,pseudo_start(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a>)</div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span>   {</div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span>      <span class="keywordflow">if</span> (!c.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#ac8eea0639eeef0fc0d304f645b80d884">skip_db_sessions</a>()) {</div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span>         undo_session.emplace(c.mutable_db().start_undo_session(true));</div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span>      }</div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span>      <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a7211fab425e4375e247c2a3d1924e63f">trace</a>-&gt;id = <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a08e9cf6a4b8ce2f6211ce9d8de1b4da3">packed_trx</a>.<a class="code hl_function" href="structsysio_1_1chain_1_1packed__transaction.html#acc706e72aa422ee3e3c02f73871609cb">id</a>();</div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span>      <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a7211fab425e4375e247c2a3d1924e63f">trace</a>-&gt;block_num = c.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a33704b4936bb9bbd2ea6b0874ca521b4">head_block_num</a>() + 1;</div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span>      <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a7211fab425e4375e247c2a3d1924e63f">trace</a>-&gt;block_time = c.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#abb1d81f96986df3bce46bd37caaf6a69">pending_block_time</a>();</div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span>      <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a7211fab425e4375e247c2a3d1924e63f">trace</a>-&gt;producer_block_id = c.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a8ad92bdf81057887fdc4b732cb864bc4">pending_producer_block_id</a>();</div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span> </div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>      <span class="keywordflow">if</span>(<span class="keyword">auto</span> dm_logger = <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#af52efad2c5859002ad3bedad5834cb7f">control</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a4f6404b355a3a4bf7fb60c92e85443d1">get_deep_mind_logger</a>())</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span>      {</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span>         dm_logger-&gt;on_start_transaction();</div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span>      }</div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>   }</div>
</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span> </div>
<div class="foldopen" id="foldopen00076" data-start="{" data-end="}">
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1transaction__context.html#ae449b02626b4cd23a0aeb8b091f582ab">   76</a></span>   <a class="code hl_function" href="classsysio_1_1chain_1_1transaction__context.html#ae449b02626b4cd23a0aeb8b091f582ab">transaction_context::~transaction_context</a>()</div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span>   {</div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span>      <span class="keywordflow">if</span>(<span class="keyword">auto</span> dm_logger = <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#af52efad2c5859002ad3bedad5834cb7f">control</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a4f6404b355a3a4bf7fb60c92e85443d1">get_deep_mind_logger</a>())</div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span>      {</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span>         dm_logger-&gt;on_end_transaction();</div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>      }</div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>   }</div>
</div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span> </div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span>   <span class="keywordtype">void</span> transaction_context::disallow_transaction_extensions( <span class="keyword">const</span> <span class="keywordtype">char</span>* error_msg )<span class="keyword">const </span>{</div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>      <span class="keywordflow">if</span>( <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#af52efad2c5859002ad3bedad5834cb7f">control</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a0fcc85a590581560765686050fe105a8">is_producing_block</a>() ) {</div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span>         <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a1bfa656552ea0534b2c91ee0fe33f850">SYS_THROW</a>( subjective_block_production_exception, error_msg );</div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>         <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a1bfa656552ea0534b2c91ee0fe33f850">SYS_THROW</a>( disallowed_transaction_extensions_bad_block_exception, error_msg );</div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>      }</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span>   }</div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span> </div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span>   <span class="keywordtype">void</span> transaction_context::init(<a class="code hl_typedef" href="stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a> initial_net_usage)</div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span>   {</div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>      <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( !is_initialized, <a class="code hl_variable" href="namespacesysio_1_1chain.html#a5dfe17906469eaf079c180c1afb4ad94">transaction_exception</a>, <span class="stringliteral">&quot;cannot initialize twice&quot;</span> );</div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span> </div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span>      <span class="comment">// set maximum to a semi-valid deadline to allow for pause math and conversion to dates for logging</span></div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>      <span class="keywordflow">if</span>( <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a708229aea669816e99b0039d716c3ed5">block_deadline</a> == <a class="code hl_function" href="classfc_1_1time__point.html#aeccf1b70aa34b132c5269313b8a50573">fc::time_point::maximum</a>() ) <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a708229aea669816e99b0039d716c3ed5">block_deadline</a> = <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a9c12181bd0bd8a5aea0200c80e7b00e7">start</a> + <a class="code hl_function" href="namespacefc.html#a6e85a2de1275728bcc4a3d01f14d9172">fc::hours</a>(24*7*52);</div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span> </div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span>      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; cfg = <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#af52efad2c5859002ad3bedad5834cb7f">control</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a0bb11e832a05b6437c79bf81758b1b7d">get_global_properties</a>().<a class="code hl_variable" href="classsysio_1_1chain_1_1global__property__object.html#a7f149fcf87034217c899838eb4430496">configuration</a>;</div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span>      <span class="keyword">auto</span>&amp; rl = <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#af52efad2c5859002ad3bedad5834cb7f">control</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#add2453cf4d0208ca9f277337c9a5ed7a">get_mutable_resource_limits_manager</a>();</div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span> </div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span>      net_limit = rl.get_block_net_limit();</div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span> </div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span>      objective_duration_limit = <a class="code hl_class" href="classfc_1_1microseconds.html">fc::microseconds</a>( rl.get_block_cpu_limit() );</div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span>      _deadline = <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a9c12181bd0bd8a5aea0200c80e7b00e7">start</a> + objective_duration_limit;</div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span> </div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span>      <span class="comment">// Possibly lower net_limit to the maximum net usage a transaction is allowed to be billed</span></div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span>      <span class="comment">// if( cfg.max_transaction_net_usage &lt;= net_limit ) {</span></div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span>      <span class="comment">//    net_limit = cfg.max_transaction_net_usage;</span></div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span>      <span class="comment">//    net_limit_due_to_block = false;</span></div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span>      <span class="comment">// }</span></div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span>      <span class="keywordflow">if</span>( cfg.max_transaction_net_usage &gt; 0 &amp;&amp; cfg.max_transaction_net_usage &lt;= net_limit ) {</div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>         net_limit = cfg.max_transaction_net_usage;</div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>         net_limit_due_to_block = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>      }</div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span> </div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span>      <span class="comment">// Possibly lower objective_duration_limit to the maximum cpu usage a transaction is allowed to be billed</span></div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>      <span class="comment">// if( cfg.max_transaction_cpu_usage &lt;= objective_duration_limit.count() ) {</span></div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span>      <span class="comment">//    objective_duration_limit = fc::microseconds(cfg.max_transaction_cpu_usage);</span></div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>      <span class="comment">//    billing_timer_exception_code = tx_cpu_usage_exceeded::code_value;</span></div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span>      <span class="comment">//    _deadline = start + objective_duration_limit;</span></div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span>      <span class="comment">// }</span></div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span>      <span class="keywordflow">if</span>( cfg.max_transaction_cpu_usage &gt; 0 &amp;&amp; cfg.max_transaction_cpu_usage &lt;= objective_duration_limit.count() ) {</div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span>         objective_duration_limit = <a class="code hl_class" href="classfc_1_1microseconds.html">fc::microseconds</a>(cfg.max_transaction_cpu_usage);</div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span>         billing_timer_exception_code = tx_cpu_usage_exceeded::code_value;</div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span>         _deadline = <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a9c12181bd0bd8a5aea0200c80e7b00e7">start</a> + objective_duration_limit;</div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span>      }</div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span> </div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span>      <span class="comment">// ** ADDED NEW ** If the configuration values are zero, set net_limit and objective_duration_limit to default maximum values to prevent them from being zero</span></div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span>      <span class="keywordflow">if</span>( net_limit == 0 ) {</div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span>         net_limit = cfg.max_block_net_usage;</div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span>      }</div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span>      <span class="keywordflow">if</span>( objective_duration_limit.count() == 0 ) {</div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span>         objective_duration_limit = <a class="code hl_class" href="classfc_1_1microseconds.html">fc::microseconds</a>(cfg.max_block_cpu_usage);</div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>      }</div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span> </div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span>      eager_net_limit = net_limit;</div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span> </div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>      <span class="keyword">const</span> transaction&amp; trx = <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a08e9cf6a4b8ce2f6211ce9d8de1b4da3">packed_trx</a>.<a class="code hl_function" href="structsysio_1_1chain_1_1packed__transaction.html#ad193d26eb97cfd5b3f7d8b957eaa35a2">get_transaction</a>();</div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>      <span class="comment">// Possibly lower net_limit to optional limit set in the transaction header</span></div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>      <a class="code hl_typedef" href="stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a> trx_specified_net_usage_limit = <span class="keyword">static_cast&lt;</span><a class="code hl_typedef" href="stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a><span class="keyword">&gt;</span>(trx.max_net_usage_words.value) * 8;</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>      <span class="keywordflow">if</span>( trx_specified_net_usage_limit &gt; 0 &amp;&amp; trx_specified_net_usage_limit &lt;= net_limit ) {</div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span>         net_limit = trx_specified_net_usage_limit;</div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>         net_limit_due_to_block = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span>      }</div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span> </div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>      <span class="comment">// Possibly lower objective_duration_limit to optional limit set in transaction header</span></div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span>      <span class="keywordflow">if</span>( trx.max_cpu_usage_ms &gt; 0 ) {</div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>         <span class="keyword">auto</span> trx_specified_cpu_usage_limit = <a class="code hl_function" href="namespacefc.html#a76ae235ec7e9b8862e70740058d7eb1b">fc::milliseconds</a>(trx.max_cpu_usage_ms);</div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>         <span class="keywordflow">if</span>( trx_specified_cpu_usage_limit &lt;= objective_duration_limit ) {</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>            objective_duration_limit = trx_specified_cpu_usage_limit;</div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>            billing_timer_exception_code = tx_cpu_usage_exceeded::code_value;</div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>            _deadline = <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a9c12181bd0bd8a5aea0200c80e7b00e7">start</a> + objective_duration_limit;</div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>         }</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>      }</div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span> </div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>      initial_objective_duration_limit = objective_duration_limit;</div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span> </div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>      <span class="comment">// if( explicit_billed_cpu_time )</span></div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>      <span class="comment">//    validate_cpu_usage_to_bill( billed_cpu_time_us, std::numeric_limits&lt;int64_t&gt;::max(), false ); // Fail early if the amount to be billed is too high</span></div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span> </div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>      <span class="comment">// Record accounts to be billed for network and CPU usage</span></div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>      <span class="comment">// if( control.is_builtin_activated(builtin_protocol_feature_t::only_bill_first_authorizer) ) {</span></div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>      <span class="comment">//    bill_to_accounts.insert( trx.first_authorizer() );</span></div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>      <span class="comment">// } else {</span></div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>      <span class="comment">//    for( const auto&amp; act : trx.actions ) {</span></div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>      <span class="comment">//       for( const auto&amp; auth : act.authorization ) {</span></div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span>      <span class="comment">//          bill_to_accounts.insert( auth.actor );</span></div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span>      <span class="comment">//       }</span></div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span>      <span class="comment">//    }</span></div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span>      <span class="comment">// }</span></div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span>      <span class="comment">// validate_ram_usage.reserve( bill_to_accounts.size() );</span></div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span> </div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span>      <span class="comment">// // Update usage values of accounts to reflect new time</span></div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>      <span class="comment">// rl.update_account_usage( bill_to_accounts, block_timestamp_type(control.pending_block_time()).slot );</span></div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span> </div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span>      <span class="comment">// // Calculate the highest network usage and CPU time that all of the billed accounts can afford to be billed</span></div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span>      <span class="comment">// int64_t account_net_limit = 0;</span></div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span>      <span class="comment">// int64_t account_cpu_limit = 0;</span></div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>      <span class="comment">// bool greylisted_net = false, greylisted_cpu = false;</span></div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>      <span class="comment">// std::tie( account_net_limit, account_cpu_limit, greylisted_net, greylisted_cpu) = max_bandwidth_billed_accounts_can_pay();</span></div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>      <span class="comment">// net_limit_due_to_greylist |= greylisted_net;</span></div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>      <span class="comment">// cpu_limit_due_to_greylist |= greylisted_cpu;</span></div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span> </div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span>      <span class="comment">// eager_net_limit = net_limit;</span></div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span> </div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>      <span class="comment">// // Possibly lower eager_net_limit to what the billed accounts can pay plus some (objective) leeway</span></div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span>      <span class="comment">// auto new_eager_net_limit = std::min( eager_net_limit, static_cast&lt;uint64_t&gt;(account_net_limit + cfg.net_usage_leeway) );</span></div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span>      <span class="comment">// if( new_eager_net_limit &lt; eager_net_limit ) {</span></div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>      <span class="comment">//    eager_net_limit = new_eager_net_limit;</span></div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span>      <span class="comment">//    net_limit_due_to_block = false;</span></div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span>      <span class="comment">// }</span></div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span> </div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span>      <span class="comment">// // Possibly limit deadline if the duration accounts can be billed for (+ a subjective leeway) does not exceed current delta</span></div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span>      <span class="comment">// if( (fc::microseconds(account_cpu_limit) + leeway) &lt;= (_deadline - start) ) {</span></div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span>      <span class="comment">//    _deadline = start + fc::microseconds(account_cpu_limit) + leeway;</span></div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span>      <span class="comment">//    billing_timer_exception_code = leeway_deadline_exception::code_value;</span></div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>      <span class="comment">// }</span></div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span> </div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>      <span class="comment">// Possibly limit deadline to subjective max_transaction_time</span></div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span>      <span class="keywordflow">if</span>( max_transaction_time_subjective != <a class="code hl_function" href="classfc_1_1microseconds.html#afc3eb0bfd792c7b1cda062e559e30c2e">fc::microseconds::maximum</a>() &amp;&amp; (<a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a9c12181bd0bd8a5aea0200c80e7b00e7">start</a> + max_transaction_time_subjective) &lt;= _deadline ) {</div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span>         _deadline = <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a9c12181bd0bd8a5aea0200c80e7b00e7">start</a> + max_transaction_time_subjective;</div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>         billing_timer_exception_code = tx_cpu_usage_exceeded::code_value;</div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span>      }</div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span> </div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span>      <span class="comment">// Possibly limit deadline to caller provided wall clock block deadline</span></div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>      <span class="keywordflow">if</span>( <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a708229aea669816e99b0039d716c3ed5">block_deadline</a> &lt; _deadline ) {</div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>         _deadline = <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a708229aea669816e99b0039d716c3ed5">block_deadline</a>;</div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>         billing_timer_exception_code = deadline_exception::code_value;</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span>      }</div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span> </div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>      <span class="comment">// Explicit billed_cpu_time_us should be used, block_deadline will be maximum unless in test code</span></div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>      <span class="keywordflow">if</span>( <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a05dbab6e9e0d4f3e30fa1392ac4430a1">explicit_billed_cpu_time</a> ) {</div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>         _deadline = <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a708229aea669816e99b0039d716c3ed5">block_deadline</a>;</div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span>         deadline_exception_code = deadline_exception::code_value;</div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span>         deadline_exception_code = billing_timer_exception_code;</div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span>      }</div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span> </div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span>      <span class="comment">// if( !explicit_billed_cpu_time ) {</span></div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span>      <span class="comment">//    // Fail early if amount of the previous speculative execution is within 10% of remaining account cpu available</span></div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span>      <span class="comment">//    int64_t validate_account_cpu_limit = account_cpu_limit - subjective_cpu_bill_us + leeway.count(); // Add leeway to allow powerup</span></div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>      <span class="comment">//    if( validate_account_cpu_limit &gt; 0 )</span></div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span>      <span class="comment">//       validate_account_cpu_limit -= SYS_PERCENT( validate_account_cpu_limit, 10 * config::percent_1 );</span></div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>      <span class="comment">//    if( validate_account_cpu_limit &lt; 0 ) validate_account_cpu_limit = 0;</span></div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>      <span class="comment">//    validate_account_cpu_usage_estimate( billed_cpu_time_us, validate_account_cpu_limit );</span></div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span>      <span class="comment">// }</span></div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span> </div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span>      eager_net_limit = (eager_net_limit/8)*8; <span class="comment">// Round down to nearest multiple of word size (8 bytes) so check_net_usage can be efficient</span></div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span> </div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span>      <span class="keywordflow">if</span>( initial_net_usage &gt; 0 )</div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>         <a class="code hl_function" href="classsysio_1_1chain_1_1transaction__context.html#a62b3defb107a356551a01d2c78e80b4b">add_net_usage</a>( initial_net_usage );  <span class="comment">// Fail early if current net usage is already greater than the calculated limit</span></div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span> </div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span>      <span class="keywordflow">if</span>(<a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#af52efad2c5859002ad3bedad5834cb7f">control</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#afc8b0aff5d6f215c336a682c83badf6e">skip_trx_checks</a>()) {</div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>         <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a346ee8df9ed43ccebf9ec1455facfc8d">transaction_timer</a>.<a class="code hl_function" href="structsysio_1_1chain_1_1transaction__checktime__timer.html#aef90525b3674b77efd2bb44da3405fc6">start</a>( <a class="code hl_function" href="classfc_1_1time__point.html#aeccf1b70aa34b132c5269313b8a50573">fc::time_point::maximum</a>() );</div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>         <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a346ee8df9ed43ccebf9ec1455facfc8d">transaction_timer</a>.<a class="code hl_function" href="structsysio_1_1chain_1_1transaction__checktime__timer.html#aef90525b3674b77efd2bb44da3405fc6">start</a>( _deadline );</div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>         <a class="code hl_function" href="classsysio_1_1chain_1_1transaction__context.html#ac47cac1e2ac5625a8589686503dd1261">checktime</a>(); <span class="comment">// Fail early if deadline has already been exceeded</span></div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>      }</div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span> </div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>      is_initialized = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span>   }</div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span> </div>
<div class="foldopen" id="foldopen00244" data-start="{" data-end="}">
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1transaction__context.html#a5d3d1260b6f77fdc4b6a8cef3417e94c">  244</a></span>   <span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1chain_1_1transaction__context.html#a5d3d1260b6f77fdc4b6a8cef3417e94c">transaction_context::init_for_implicit_trx</a>( <a class="code hl_typedef" href="stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a> initial_net_usage  )</div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>   {</div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span>      <span class="keyword">const</span> <a class="code hl_struct" href="structsysio_1_1chain_1_1transaction.html">transaction</a>&amp; trx = <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a08e9cf6a4b8ce2f6211ce9d8de1b4da3">packed_trx</a>.<a class="code hl_function" href="structsysio_1_1chain_1_1packed__transaction.html#ad193d26eb97cfd5b3f7d8b957eaa35a2">get_transaction</a>();</div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>      <span class="keywordflow">if</span>( trx.<a class="code hl_variable" href="structsysio_1_1chain_1_1transaction.html#a9514bad03e7dd6a8fee1204611bcce6b">transaction_extensions</a>.size() &gt; 0 ) {</div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>         disallow_transaction_extensions( <span class="stringliteral">&quot;no transaction extensions supported yet for implicit transactions&quot;</span> );</div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span>      }</div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span> </div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span>      <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#ab8e1aaec319ed2ae90b6a6f499919c89">published</a> = <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#af52efad2c5859002ad3bedad5834cb7f">control</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#abb1d81f96986df3bce46bd37caaf6a69">pending_block_time</a>();</div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span>      <a class="code hl_function" href="lib_8h.html#a02fd73d861ef2e4aabb38c0c9ff82947">init</a>( initial_net_usage);</div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span>   }</div>
</div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span> </div>
<div class="foldopen" id="foldopen00255" data-start="{" data-end="}">
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1transaction__context.html#adbf0d6f8a8a8d3b4544fafe24cd0a135">  255</a></span>   <span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1chain_1_1transaction__context.html#adbf0d6f8a8a8d3b4544fafe24cd0a135">transaction_context::init_for_input_trx</a>( <a class="code hl_typedef" href="stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a> packed_trx_unprunable_size,</div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span>                                                 <a class="code hl_typedef" href="stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a> packed_trx_prunable_size )</div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span>   {</div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span>      <span class="keyword">const</span> <a class="code hl_struct" href="structsysio_1_1chain_1_1transaction.html">transaction</a>&amp; trx = <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a08e9cf6a4b8ce2f6211ce9d8de1b4da3">packed_trx</a>.<a class="code hl_function" href="structsysio_1_1chain_1_1packed__transaction.html#ad193d26eb97cfd5b3f7d8b957eaa35a2">get_transaction</a>();</div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span>      <span class="keywordflow">if</span>( trx.<a class="code hl_variable" href="structsysio_1_1chain_1_1transaction.html#a9514bad03e7dd6a8fee1204611bcce6b">transaction_extensions</a>.size() &gt; 0 ) {</div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span>         disallow_transaction_extensions( <span class="stringliteral">&quot;no transaction extensions supported yet for input transactions&quot;</span> );</div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span>      }</div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span> </div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span>      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; cfg = <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#af52efad2c5859002ad3bedad5834cb7f">control</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a0bb11e832a05b6437c79bf81758b1b7d">get_global_properties</a>().<a class="code hl_variable" href="classsysio_1_1chain_1_1global__property__object.html#a7f149fcf87034217c899838eb4430496">configuration</a>;</div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span> </div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span>      <a class="code hl_typedef" href="stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a> discounted_size_for_pruned_data = packed_trx_prunable_size;</div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span>      <span class="keywordflow">if</span>( cfg.context_free_discount_net_usage_den &gt; 0</div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span>          &amp;&amp; cfg.context_free_discount_net_usage_num &lt; cfg.context_free_discount_net_usage_den )</div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span>      {</div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>         discounted_size_for_pruned_data *= cfg.context_free_discount_net_usage_num;</div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span>         discounted_size_for_pruned_data =  ( discounted_size_for_pruned_data + cfg.context_free_discount_net_usage_den - 1)</div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span>                                                                                    / cfg.context_free_discount_net_usage_den; <span class="comment">// rounds up</span></div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span>      }</div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span> </div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>      <a class="code hl_typedef" href="stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a> initial_net_usage = <span class="keyword">static_cast&lt;</span><a class="code hl_typedef" href="stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a><span class="keyword">&gt;</span>(cfg.base_per_transaction_net_usage)</div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span>                                    + packed_trx_unprunable_size + discounted_size_for_pruned_data;</div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span> </div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span> </div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span>      <span class="keywordflow">if</span>( trx.<a class="code hl_variable" href="structsysio_1_1chain_1_1transaction__header.html#a349b11695387e3dbe91f918ee759d4b4">delay_sec</a>.<a class="code hl_variable" href="structfc_1_1unsigned__int.html#ac54ac972d3e38a5852616aaee955ff3f">value</a> &gt; 0 ) {</div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span>          <span class="comment">// If delayed, also charge ahead of time for the additional net usage needed to retire the delayed transaction</span></div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span>          <span class="comment">// whether that be by successfully executing, soft failure, hard failure, or expiration.</span></div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>         initial_net_usage += <span class="keyword">static_cast&lt;</span><a class="code hl_typedef" href="stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a><span class="keyword">&gt;</span>(cfg.base_per_transaction_net_usage)</div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span>                               + <span class="keyword">static_cast&lt;</span><a class="code hl_typedef" href="stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a><span class="keyword">&gt;</span>(config::transaction_id_net_usage);</div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span>      }</div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span> </div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>      <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#ab8e1aaec319ed2ae90b6a6f499919c89">published</a> = <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#af52efad2c5859002ad3bedad5834cb7f">control</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#abb1d81f96986df3bce46bd37caaf6a69">pending_block_time</a>();</div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span>      <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#ad22e57171587ed29b371184a7be4529a">is_input</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span>      <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#af52efad2c5859002ad3bedad5834cb7f">control</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#afc8b0aff5d6f215c336a682c83badf6e">skip_trx_checks</a>()) {</div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span>         <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#af52efad2c5859002ad3bedad5834cb7f">control</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a3c9f983e8d4aba41afbb0a473feca18f">validate_expiration</a>(trx);</div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span>         <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#af52efad2c5859002ad3bedad5834cb7f">control</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a92e84ef71388fa365bcf17a4fbcce047">validate_tapos</a>(trx);</div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span>         <a class="code hl_function" href="classsysio_1_1chain_1_1transaction__context.html#a7ecbfbb3d05a6a0b128feeb0a469878c">validate_referenced_accounts</a>( trx, <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a799e9208ec6d2ea3d1dfccfd4eb97cec">enforce_whiteblacklist</a> &amp;&amp; <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#af52efad2c5859002ad3bedad5834cb7f">control</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a0fcc85a590581560765686050fe105a8">is_producing_block</a>() );</div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span>      }</div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span>      <a class="code hl_function" href="lib_8h.html#a02fd73d861ef2e4aabb38c0c9ff82947">init</a>( initial_net_usage);</div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span>      record_transaction( <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a08e9cf6a4b8ce2f6211ce9d8de1b4da3">packed_trx</a>.<a class="code hl_function" href="structsysio_1_1chain_1_1packed__transaction.html#acc706e72aa422ee3e3c02f73871609cb">id</a>(), trx.<a class="code hl_variable" href="structsysio_1_1chain_1_1transaction__header.html#ad1ed2586e8ace769fdb9a54d09a752ce">expiration</a> ); </div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span>   }</div>
</div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span> </div>
<div class="foldopen" id="foldopen00296" data-start="{" data-end="}">
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1transaction__context.html#a03f76febe2160f0f23a5f60dae262184">  296</a></span>   <span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1chain_1_1transaction__context.html#a03f76febe2160f0f23a5f60dae262184">transaction_context::init_for_deferred_trx</a>( <a class="code hl_class" href="classfc_1_1time__point.html">fc::time_point</a> <a class="code hl_variable" href="bn_8cpp.html#a8b0eadcc506862e9d751ab45185053aa">p</a> )</div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span>   {</div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span>      <span class="keyword">const</span> <a class="code hl_struct" href="structsysio_1_1chain_1_1transaction.html">transaction</a>&amp; trx = <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a08e9cf6a4b8ce2f6211ce9d8de1b4da3">packed_trx</a>.<a class="code hl_function" href="structsysio_1_1chain_1_1packed__transaction.html#ad193d26eb97cfd5b3f7d8b957eaa35a2">get_transaction</a>();</div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span>      <span class="keywordflow">if</span>( (trx.<a class="code hl_variable" href="structsysio_1_1chain_1_1transaction__header.html#ad1ed2586e8ace769fdb9a54d09a752ce">expiration</a>.<a class="code hl_function" href="classfc_1_1time__point__sec.html#ab537213a0f1caf331b0c43cee6297b3f">sec_since_epoch</a>() != 0) &amp;&amp; (trx.<a class="code hl_variable" href="structsysio_1_1chain_1_1transaction.html#a9514bad03e7dd6a8fee1204611bcce6b">transaction_extensions</a>.size() &gt; 0) ) {</div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span>         disallow_transaction_extensions( <span class="stringliteral">&quot;no transaction extensions supported yet for deferred transactions&quot;</span> );</div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span>      }</div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span>      <span class="comment">// If (trx.expiration.sec_since_epoch() == 0) then it was created after NO_DUPLICATE_DEFERRED_ID activation,</span></div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span>      <span class="comment">// and so validation of its extensions was done either in:</span></div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span>      <span class="comment">//   * apply_context::schedule_deferred_transaction for contract-generated transactions;</span></div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span>      <span class="comment">//   * or transaction_context::init_for_input_trx for delayed input transactions.</span></div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span> </div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span>      <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#ab8e1aaec319ed2ae90b6a6f499919c89">published</a> = <a class="code hl_variable" href="bn_8cpp.html#a8b0eadcc506862e9d751ab45185053aa">p</a>;</div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span>      <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a7211fab425e4375e247c2a3d1924e63f">trace</a>-&gt;scheduled = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span>      <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a8cb5a958083512d7ff0bff751db87dd9">apply_context_free</a> = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span>      <a class="code hl_function" href="lib_8h.html#a02fd73d861ef2e4aabb38c0c9ff82947">init</a>( 0 );</div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span>   }</div>
</div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span> </div>
<div class="foldopen" id="foldopen00313" data-start="{" data-end="}">
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1transaction__context.html#a01f9fd71b2b5511311c8817a8b32c845">  313</a></span>   <span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1chain_1_1transaction__context.html#a01f9fd71b2b5511311c8817a8b32c845">transaction_context::exec</a>() {</div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span>      <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( is_initialized, <a class="code hl_variable" href="namespacesysio_1_1chain.html#a5dfe17906469eaf079c180c1afb4ad94">transaction_exception</a>, <span class="stringliteral">&quot;must first initialize&quot;</span> );</div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span> </div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span>      <span class="keyword">const</span> <a class="code hl_struct" href="structsysio_1_1chain_1_1transaction.html">transaction</a>&amp; trx = <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a08e9cf6a4b8ce2f6211ce9d8de1b4da3">packed_trx</a>.<a class="code hl_function" href="structsysio_1_1chain_1_1packed__transaction.html#ad193d26eb97cfd5b3f7d8b957eaa35a2">get_transaction</a>();</div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span>      <span class="keywordflow">if</span>( <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a8cb5a958083512d7ff0bff751db87dd9">apply_context_free</a> ) {</div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span>         <span class="keywordflow">for</span>( <span class="keyword">const</span> <span class="keyword">auto</span>&amp; act : trx.<a class="code hl_variable" href="structsysio_1_1chain_1_1transaction.html#a926f2528e0af9f17521fcf92282c5806">context_free_actions</a> ) {</div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span>            schedule_action( act, act.account, <span class="keyword">true</span>, 0, 0 );</div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span>         }</div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span>      }</div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span> </div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span>      <span class="keywordflow">if</span>( delay == <a class="code hl_class" href="classfc_1_1microseconds.html">fc::microseconds</a>() ) {</div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span>         <span class="keywordflow">for</span>( <span class="keyword">const</span> <span class="keyword">auto</span>&amp; act : trx.<a class="code hl_variable" href="structsysio_1_1chain_1_1transaction.html#a407fcf1868b81bb30b85f80d388bbac2">actions</a> ) {</div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span>            schedule_action( act, act.account, <span class="keyword">false</span>, 0, 0 );</div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span>         }</div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span>      }</div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span> </div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span>      <span class="keyword">auto</span>&amp; action_traces = <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a7211fab425e4375e247c2a3d1924e63f">trace</a>-&gt;action_traces;</div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span>      <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> num_original_actions_to_execute = action_traces.size();</div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span>      <span class="keywordflow">for</span>( <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> i = 1; i &lt;= num_original_actions_to_execute; ++i ) {</div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span>         execute_action( i, 0 );</div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span>      }</div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span> </div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span>      <span class="keywordflow">if</span>( delay != <a class="code hl_class" href="classfc_1_1microseconds.html">fc::microseconds</a>() ) {</div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span>         schedule_transaction();</div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span>      }</div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span>   }</div>
</div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span> </div>
<div class="foldopen" id="foldopen00340" data-start="{" data-end="}">
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1transaction__context.html#a300b3d2c25e7de11562c579c41f43dda">  340</a></span>   <span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1chain_1_1transaction__context.html#a300b3d2c25e7de11562c579c41f43dda">transaction_context::finalize</a>() {</div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span>      <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( is_initialized, <a class="code hl_variable" href="namespacesysio_1_1chain.html#a5dfe17906469eaf079c180c1afb4ad94">transaction_exception</a>, <span class="stringliteral">&quot;must first initialize&quot;</span> );</div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span> </div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span>      <span class="keywordflow">if</span>( <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#ad22e57171587ed29b371184a7be4529a">is_input</a> ) {</div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span>         <span class="keyword">const</span> <a class="code hl_struct" href="structsysio_1_1chain_1_1transaction.html">transaction</a>&amp; trx = <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a08e9cf6a4b8ce2f6211ce9d8de1b4da3">packed_trx</a>.<a class="code hl_function" href="structsysio_1_1chain_1_1packed__transaction.html#ad193d26eb97cfd5b3f7d8b957eaa35a2">get_transaction</a>();</div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span>         <span class="keyword">auto</span>&amp; am = <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#af52efad2c5859002ad3bedad5834cb7f">control</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a4c7e83b4e4c21205b0fb9b2e4b7fb227">get_mutable_authorization_manager</a>();</div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span>         <span class="keywordflow">for</span>( <span class="keyword">const</span> <span class="keyword">auto</span>&amp; act : trx.<a class="code hl_variable" href="structsysio_1_1chain_1_1transaction.html#a407fcf1868b81bb30b85f80d388bbac2">actions</a> ) {</div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span>            <span class="keywordflow">for</span>( <span class="keyword">const</span> <span class="keyword">auto</span>&amp; auth : act.authorization ) {</div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span>               am.update_permission_usage( am.get_permission(auth) );</div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span>            }</div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span>         }</div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span>      }</div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span> </div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span>      <span class="comment">// auto&amp; rl = control.get_mutable_resource_limits_manager();</span></div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span>      <span class="comment">// for( auto a : validate_ram_usage ) {</span></div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span>      <span class="comment">//    rl.verify_account_ram_usage( a );</span></div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span>      <span class="comment">// }</span></div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span> </div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span>      <span class="comment">// // Calculate the new highest network usage and CPU time that all of the billed accounts can afford to be billed</span></div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span>      <span class="comment">// int64_t account_net_limit = 0;</span></div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span>      <span class="comment">// int64_t account_cpu_limit = 0;</span></div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span>      <span class="comment">// bool greylisted_net = false, greylisted_cpu = false;</span></div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span>      <span class="comment">// std::tie( account_net_limit, account_cpu_limit, greylisted_net, greylisted_cpu) = max_bandwidth_billed_accounts_can_pay();</span></div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span>      <span class="comment">// net_limit_due_to_greylist |= greylisted_net;</span></div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span>      <span class="comment">// cpu_limit_due_to_greylist |= greylisted_cpu;</span></div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span> </div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span>      <span class="comment">// // Possibly lower net_limit to what the billed accounts can pay</span></div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span>      <span class="comment">// if( static_cast&lt;uint64_t&gt;(account_net_limit) &lt;= net_limit ) {</span></div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span>      <span class="comment">//    // NOTE: net_limit may possibly not be objective anymore due to net greylisting, but it should still be no greater than the truly objective net_limit</span></div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span>      <span class="comment">//    net_limit = static_cast&lt;uint64_t&gt;(account_net_limit);</span></div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span>      <span class="comment">//    net_limit_due_to_block = false;</span></div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span>      <span class="comment">// }</span></div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span> </div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span>      <span class="comment">// // Possibly lower objective_duration_limit to what the billed accounts can pay</span></div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span>      <span class="comment">// if( account_cpu_limit &lt;= objective_duration_limit.count() ) {</span></div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span>      <span class="comment">//    // NOTE: objective_duration_limit may possibly not be objective anymore due to cpu greylisting, but it should still be no greater than the truly objective objective_duration_limit</span></div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span>      <span class="comment">//    objective_duration_limit = fc::microseconds(account_cpu_limit);</span></div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span>      <span class="comment">//    billing_timer_exception_code = tx_cpu_usage_exceeded::code_value;</span></div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span>      <span class="comment">// }</span></div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span> </div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span>      net_usage = ((net_usage + 7)/8)*8; <span class="comment">// Round up to nearest multiple of word size (8 bytes)</span></div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span> </div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span>      eager_net_limit = net_limit;</div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span>      <a class="code hl_function" href="classsysio_1_1chain_1_1transaction__context.html#ac2563020d92f69f6fe9a0b878f5a86f3">check_net_usage</a>();</div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span> </div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span>      <span class="keyword">auto</span> now = <a class="code hl_function" href="classfc_1_1time__point.html#aa164ff1268a16d4b32afcff181f6100e">fc::time_point::now</a>();</div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span>      <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a7211fab425e4375e247c2a3d1924e63f">trace</a>-&gt;elapsed = now - <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a9c12181bd0bd8a5aea0200c80e7b00e7">start</a>;</div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span> </div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span>      <a class="code hl_function" href="classsysio_1_1chain_1_1transaction__context.html#a2f8dc57cb2e3562de132326b0d06e15d">update_billed_cpu_time</a>( now );</div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span> </div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span>      <span class="comment">// validate_cpu_usage_to_bill( billed_cpu_time_us, account_cpu_limit, true );</span></div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span>      <span class="comment">// auto&amp; rl = control.get_mutable_resource_limits_manager();</span></div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span>      <span class="comment">// rl.add_transaction_usage( bill_to_accounts, static_cast&lt;uint64_t&gt;(billed_cpu_time_us), net_usage,</span></div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span>      <span class="comment">//                           block_timestamp_type(control.pending_block_time()).slot ); // Should never fail</span></div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span>   }</div>
</div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span> </div>
<div class="foldopen" id="foldopen00396" data-start="{" data-end="}">
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1transaction__context.html#a558e8aff8e48deb61fae7407e10e8788">  396</a></span>   <span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1chain_1_1transaction__context.html#a558e8aff8e48deb61fae7407e10e8788">transaction_context::squash</a>() {</div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span>      <span class="keywordflow">if</span> (<a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a90144b543cf9fd4e5ed08fc2a4cd75ff">undo_session</a>) <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a90144b543cf9fd4e5ed08fc2a4cd75ff">undo_session</a>-&gt;squash();</div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span>   }</div>
</div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span> </div>
<div class="foldopen" id="foldopen00400" data-start="{" data-end="}">
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1transaction__context.html#a5631f6c990c61c078e0de6f0e53171be">  400</a></span>   <span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1chain_1_1transaction__context.html#a5631f6c990c61c078e0de6f0e53171be">transaction_context::undo</a>() {</div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span>      <span class="keywordflow">if</span> (<a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a90144b543cf9fd4e5ed08fc2a4cd75ff">undo_session</a>) <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a90144b543cf9fd4e5ed08fc2a4cd75ff">undo_session</a>-&gt;undo();</div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span>   }</div>
</div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span> </div>
<div class="foldopen" id="foldopen00404" data-start="{" data-end="}">
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1transaction__context.html#ac2563020d92f69f6fe9a0b878f5a86f3">  404</a></span>   <span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1chain_1_1transaction__context.html#ac2563020d92f69f6fe9a0b878f5a86f3">transaction_context::check_net_usage</a>()<span class="keyword">const </span>{</div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span>      <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#af52efad2c5859002ad3bedad5834cb7f">control</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#afc8b0aff5d6f215c336a682c83badf6e">skip_trx_checks</a>()) {</div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span>         <span class="keywordflow">if</span>( BOOST_UNLIKELY(net_usage &gt; eager_net_limit) ) {</div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span>            <span class="keywordflow">if</span> ( net_limit_due_to_block ) {</div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span>               <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a1bfa656552ea0534b2c91ee0fe33f850">SYS_THROW</a>( block_net_usage_exceeded,</div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span>                          <span class="stringliteral">&quot;not enough space left in block: ${net_usage} &gt; ${net_limit}&quot;</span>,</div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span>                          (<span class="stringliteral">&quot;net_usage&quot;</span>, net_usage)(<span class="stringliteral">&quot;net_limit&quot;</span>, eager_net_limit) );</div>
<div class="line"><a id="l00411" name="l00411"></a><span class="lineno">  411</span>            }  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (net_limit_due_to_greylist) {</div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno">  412</span>               <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a1bfa656552ea0534b2c91ee0fe33f850">SYS_THROW</a>( greylist_net_usage_exceeded,</div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span>                          <span class="stringliteral">&quot;greylisted transaction net usage is too high: ${net_usage} &gt; ${net_limit}&quot;</span>,</div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span>                          (<span class="stringliteral">&quot;net_usage&quot;</span>, net_usage)(<span class="stringliteral">&quot;net_limit&quot;</span>, eager_net_limit) );</div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span>               <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a1bfa656552ea0534b2c91ee0fe33f850">SYS_THROW</a>( tx_net_usage_exceeded,</div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span>                          <span class="stringliteral">&quot;transaction net usage is too high: ${net_usage} &gt; ${net_limit}&quot;</span>,</div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span>                          (<span class="stringliteral">&quot;net_usage&quot;</span>, net_usage)(<span class="stringliteral">&quot;net_limit&quot;</span>, eager_net_limit) );</div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span>            }</div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span>         }</div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span>      }</div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span>   }</div>
</div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span> </div>
<div class="foldopen" id="foldopen00424" data-start="{" data-end="}">
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1transaction__context.html#ac47cac1e2ac5625a8589686503dd1261">  424</a></span>   <span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1chain_1_1transaction__context.html#ac47cac1e2ac5625a8589686503dd1261">transaction_context::checktime</a>()<span class="keyword">const </span>{</div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span>      <span class="keywordflow">if</span>(BOOST_LIKELY(<a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a346ee8df9ed43ccebf9ec1455facfc8d">transaction_timer</a>.<a class="code hl_variable" href="structsysio_1_1chain_1_1transaction__checktime__timer.html#a957951b0f382670abeac7531d35924c1">expired</a> == <span class="keyword">false</span>))</div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span>         <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span> </div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span>      <span class="keyword">auto</span> now = <a class="code hl_function" href="classfc_1_1time__point.html#aa164ff1268a16d4b32afcff181f6100e">fc::time_point::now</a>();</div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span>      <span class="keywordflow">if</span>( <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a05dbab6e9e0d4f3e30fa1392ac4430a1">explicit_billed_cpu_time</a> || deadline_exception_code == deadline_exception::code_value ) {</div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span>         <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a1bfa656552ea0534b2c91ee0fe33f850">SYS_THROW</a>( deadline_exception, <span class="stringliteral">&quot;deadline exceeded ${billing_timer}us&quot;</span>,</div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span>                     (<span class="stringliteral">&quot;billing_timer&quot;</span>, now - pseudo_start)(<span class="stringliteral">&quot;now&quot;</span>, now)(<span class="stringliteral">&quot;deadline&quot;</span>, _deadline)(<span class="stringliteral">&quot;start&quot;</span>, <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a9c12181bd0bd8a5aea0200c80e7b00e7">start</a>) );</div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span>      } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( deadline_exception_code == block_cpu_usage_exceeded::code_value ) {</div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span>         <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a1bfa656552ea0534b2c91ee0fe33f850">SYS_THROW</a>( block_cpu_usage_exceeded,</div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span>                     <span class="stringliteral">&quot;not enough time left in block to complete executing transaction ${billing_timer}us&quot;</span>,</div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span>                     (<span class="stringliteral">&quot;now&quot;</span>, now)(<span class="stringliteral">&quot;deadline&quot;</span>, _deadline)(<span class="stringliteral">&quot;start&quot;</span>, <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a9c12181bd0bd8a5aea0200c80e7b00e7">start</a>)(<span class="stringliteral">&quot;billing_timer&quot;</span>, now - pseudo_start) );</div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span>      } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( deadline_exception_code == tx_cpu_usage_exceeded::code_value ) {</div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span>         <span class="keywordflow">if</span> (cpu_limit_due_to_greylist) {</div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span>            <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a1bfa656552ea0534b2c91ee0fe33f850">SYS_THROW</a>( greylist_cpu_usage_exceeded,</div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span>                     <span class="stringliteral">&quot;greylisted transaction was executing for too long ${billing_timer}us&quot;</span>,</div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span>                     (<span class="stringliteral">&quot;now&quot;</span>, now)(<span class="stringliteral">&quot;deadline&quot;</span>, _deadline)(<span class="stringliteral">&quot;start&quot;</span>, <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a9c12181bd0bd8a5aea0200c80e7b00e7">start</a>)(<span class="stringliteral">&quot;billing_timer&quot;</span>, now - pseudo_start) );</div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span>         } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span>            <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a1bfa656552ea0534b2c91ee0fe33f850">SYS_THROW</a>( tx_cpu_usage_exceeded,</div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span>                     <span class="stringliteral">&quot;transaction was executing for too long ${billing_timer}us&quot;</span>,</div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span>                     (<span class="stringliteral">&quot;now&quot;</span>, now)(<span class="stringliteral">&quot;deadline&quot;</span>, _deadline)(<span class="stringliteral">&quot;start&quot;</span>, <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a9c12181bd0bd8a5aea0200c80e7b00e7">start</a>)(<span class="stringliteral">&quot;billing_timer&quot;</span>, now - pseudo_start) );</div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno">  445</span>         }</div>
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno">  446</span>      } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( deadline_exception_code == leeway_deadline_exception::code_value ) {</div>
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno">  447</span>         <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a1bfa656552ea0534b2c91ee0fe33f850">SYS_THROW</a>( leeway_deadline_exception,</div>
<div class="line"><a id="l00448" name="l00448"></a><span class="lineno">  448</span>                     <span class="stringliteral">&quot;the transaction was unable to complete by deadline, &quot;</span></div>
<div class="line"><a id="l00449" name="l00449"></a><span class="lineno">  449</span>                     <span class="stringliteral">&quot;but it is possible it could have succeeded if it were allowed to run to completion ${billing_timer}&quot;</span>,</div>
<div class="line"><a id="l00450" name="l00450"></a><span class="lineno">  450</span>                     (<span class="stringliteral">&quot;now&quot;</span>, now)(<span class="stringliteral">&quot;deadline&quot;</span>, _deadline)(<span class="stringliteral">&quot;start&quot;</span>, <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a9c12181bd0bd8a5aea0200c80e7b00e7">start</a>)(<span class="stringliteral">&quot;billing_timer&quot;</span>, now - pseudo_start) );</div>
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno">  451</span>      }</div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno">  452</span>      <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( <span class="keyword">false</span>,  <a class="code hl_variable" href="namespacesysio_1_1chain.html#a5dfe17906469eaf079c180c1afb4ad94">transaction_exception</a>, <span class="stringliteral">&quot;unexpected deadline exception code ${code}&quot;</span>, (<span class="stringliteral">&quot;code&quot;</span>, deadline_exception_code) );</div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span>   }</div>
</div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span> </div>
<div class="foldopen" id="foldopen00455" data-start="{" data-end="}">
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1transaction__context.html#a26ad1d103e9f47c69dce0a8a85f76039">  455</a></span>   <span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1chain_1_1transaction__context.html#a26ad1d103e9f47c69dce0a8a85f76039">transaction_context::pause_billing_timer</a>() {</div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span>      <span class="keywordflow">if</span>( <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a05dbab6e9e0d4f3e30fa1392ac4430a1">explicit_billed_cpu_time</a> || pseudo_start == <a class="code hl_class" href="classfc_1_1time__point.html">fc::time_point</a>() ) <span class="keywordflow">return</span>; <span class="comment">// either irrelevant or already paused</span></div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span> </div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span>      paused_time = <a class="code hl_function" href="classfc_1_1time__point.html#aa164ff1268a16d4b32afcff181f6100e">fc::time_point::now</a>();</div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span>      billed_time = paused_time - pseudo_start;</div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span>      pseudo_start = <a class="code hl_class" href="classfc_1_1time__point.html">fc::time_point</a>();</div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span>      <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a346ee8df9ed43ccebf9ec1455facfc8d">transaction_timer</a>.<a class="code hl_function" href="structsysio_1_1chain_1_1transaction__checktime__timer.html#ad84002d0816f8b4b6aa3c2dd3772d1fe">stop</a>();</div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span>   }</div>
</div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span> </div>
<div class="foldopen" id="foldopen00464" data-start="{" data-end="}">
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1transaction__context.html#a5ca7a519fb084bc4ad8c692a81f69277">  464</a></span>   <span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1chain_1_1transaction__context.html#a5ca7a519fb084bc4ad8c692a81f69277">transaction_context::resume_billing_timer</a>() {</div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span>      <span class="keywordflow">if</span>( <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a05dbab6e9e0d4f3e30fa1392ac4430a1">explicit_billed_cpu_time</a> || pseudo_start != <a class="code hl_class" href="classfc_1_1time__point.html">fc::time_point</a>() ) <span class="keywordflow">return</span>; <span class="comment">// either irrelevant or already running</span></div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno">  466</span> </div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno">  467</span>      <span class="keyword">auto</span> now = <a class="code hl_function" href="classfc_1_1time__point.html#aa164ff1268a16d4b32afcff181f6100e">fc::time_point::now</a>();</div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno">  468</span>      <span class="keyword">auto</span> paused = now - paused_time;</div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno">  469</span> </div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span>      pseudo_start = now - billed_time;</div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno">  471</span>      _deadline += paused;</div>
<div class="line"><a id="l00472" name="l00472"></a><span class="lineno">  472</span> </div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno">  473</span>      <span class="comment">// do not allow to go past block wall clock deadline</span></div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno">  474</span>      <span class="keywordflow">if</span>( <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a708229aea669816e99b0039d716c3ed5">block_deadline</a> &lt; _deadline ) {</div>
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno">  475</span>         deadline_exception_code = deadline_exception::code_value;</div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span>         _deadline = <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a708229aea669816e99b0039d716c3ed5">block_deadline</a>;</div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno">  477</span>      }</div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno">  478</span> </div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno">  479</span>      <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a346ee8df9ed43ccebf9ec1455facfc8d">transaction_timer</a>.<a class="code hl_function" href="structsysio_1_1chain_1_1transaction__checktime__timer.html#aef90525b3674b77efd2bb44da3405fc6">start</a>(_deadline);</div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno">  480</span>   }</div>
</div>
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno">  481</span> </div>
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno">  482</span>   <span class="keywordtype">void</span> transaction_context::validate_cpu_usage_to_bill( <a class="code hl_typedef" href="stdint_8h.html#a414156feea104f8f75b4ed9e3121b2f6">int64_t</a> billed_us, <a class="code hl_typedef" href="stdint_8h.html#a414156feea104f8f75b4ed9e3121b2f6">int64_t</a> account_cpu_limit, <span class="keywordtype">bool</span> check_minimum )<span class="keyword">const </span>{</div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span>      <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#af52efad2c5859002ad3bedad5834cb7f">control</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#afc8b0aff5d6f215c336a682c83badf6e">skip_trx_checks</a>()) {</div>
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno">  484</span>         <span class="keywordflow">if</span>( check_minimum ) {</div>
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno">  485</span>            <span class="keyword">const</span> <span class="keyword">auto</span>&amp; cfg = <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#af52efad2c5859002ad3bedad5834cb7f">control</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a0bb11e832a05b6437c79bf81758b1b7d">get_global_properties</a>().<a class="code hl_variable" href="classsysio_1_1chain_1_1global__property__object.html#a7f149fcf87034217c899838eb4430496">configuration</a>;</div>
<div class="line"><a id="l00486" name="l00486"></a><span class="lineno">  486</span>            <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( billed_us &gt;= cfg.min_transaction_cpu_usage, <a class="code hl_variable" href="namespacesysio_1_1chain.html#a5dfe17906469eaf079c180c1afb4ad94">transaction_exception</a>,</div>
<div class="line"><a id="l00487" name="l00487"></a><span class="lineno">  487</span>                        <span class="stringliteral">&quot;cannot bill CPU time less than the minimum of ${min_billable} us&quot;</span>,</div>
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno">  488</span>                        (<span class="stringliteral">&quot;min_billable&quot;</span>, cfg.min_transaction_cpu_usage)(<span class="stringliteral">&quot;billed_cpu_time_us&quot;</span>, billed_us)</div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno">  489</span>                      );</div>
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno">  490</span>         }</div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno">  491</span> </div>
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno">  492</span>         validate_account_cpu_usage( billed_us, account_cpu_limit );</div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno">  493</span>      }</div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span>   }</div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno">  495</span> </div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno">  496</span>   <span class="keywordtype">void</span> transaction_context::validate_account_cpu_usage( <a class="code hl_typedef" href="stdint_8h.html#a414156feea104f8f75b4ed9e3121b2f6">int64_t</a> billed_us, <a class="code hl_typedef" href="stdint_8h.html#a414156feea104f8f75b4ed9e3121b2f6">int64_t</a> account_cpu_limit )<span class="keyword">const </span>{</div>
<div class="line"><a id="l00497" name="l00497"></a><span class="lineno">  497</span>      <span class="keywordflow">if</span>( (billed_us &gt; 0) &amp;&amp; !<a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#af52efad2c5859002ad3bedad5834cb7f">control</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#afc8b0aff5d6f215c336a682c83badf6e">skip_trx_checks</a>() ) {</div>
<div class="line"><a id="l00498" name="l00498"></a><span class="lineno">  498</span>         <span class="keyword">const</span> <span class="keywordtype">bool</span> cpu_limited_by_account = (account_cpu_limit &lt;= objective_duration_limit.count());</div>
<div class="line"><a id="l00499" name="l00499"></a><span class="lineno">  499</span> </div>
<div class="line"><a id="l00500" name="l00500"></a><span class="lineno">  500</span>         <span class="keywordflow">if</span>( !cpu_limited_by_account &amp;&amp; (billing_timer_exception_code == block_cpu_usage_exceeded::code_value) ) {</div>
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno">  501</span>            <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( billed_us &lt;= objective_duration_limit.count(),</div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno">  502</span>                        block_cpu_usage_exceeded,</div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span>                        <span class="stringliteral">&quot;billed CPU time (${billed} us) is greater than the billable CPU time left in the block (${billable} us)&quot;</span>,</div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span>                        (<span class="stringliteral">&quot;billed&quot;</span>, billed_us)( <span class="stringliteral">&quot;billable&quot;</span>, objective_duration_limit.count() )</div>
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno">  505</span>            );</div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno">  506</span>         } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span>            <span class="keywordflow">if</span>( cpu_limit_due_to_greylist &amp;&amp; cpu_limited_by_account ) {</div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span>               <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( billed_us &lt;= account_cpu_limit,</div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno">  509</span>                           greylist_cpu_usage_exceeded,</div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span>                           <span class="stringliteral">&quot;billed CPU time (${billed} us) is greater than the maximum greylisted billable CPU time for the transaction (${billable} us)&quot;</span>,</div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span>                           (<span class="stringliteral">&quot;billed&quot;</span>, billed_us)( <span class="stringliteral">&quot;billable&quot;</span>, account_cpu_limit )</div>
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno">  512</span>               );</div>
<div class="line"><a id="l00513" name="l00513"></a><span class="lineno">  513</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00514" name="l00514"></a><span class="lineno">  514</span>               <span class="comment">// exceeds trx.max_cpu_usage_ms or cfg.max_transaction_cpu_usage if objective_duration_limit is greater</span></div>
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno">  515</span>               <span class="keyword">const</span> <a class="code hl_typedef" href="stdint_8h.html#a414156feea104f8f75b4ed9e3121b2f6">int64_t</a> cpu_limit = (cpu_limited_by_account ? account_cpu_limit : objective_duration_limit.count());</div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span>               <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( billed_us &lt;= cpu_limit,</div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span>                           tx_cpu_usage_exceeded,</div>
<div class="line"><a id="l00518" name="l00518"></a><span class="lineno">  518</span>                           <span class="stringliteral">&quot;billed CPU time (${billed} us) is greater than the maximum billable CPU time for the transaction (${billable} us)&quot;</span>,</div>
<div class="line"><a id="l00519" name="l00519"></a><span class="lineno">  519</span>                           (<span class="stringliteral">&quot;billed&quot;</span>, billed_us)( <span class="stringliteral">&quot;billable&quot;</span>, cpu_limit )</div>
<div class="line"><a id="l00520" name="l00520"></a><span class="lineno">  520</span>               );</div>
<div class="line"><a id="l00521" name="l00521"></a><span class="lineno">  521</span>            }</div>
<div class="line"><a id="l00522" name="l00522"></a><span class="lineno">  522</span>         }</div>
<div class="line"><a id="l00523" name="l00523"></a><span class="lineno">  523</span>      }</div>
<div class="line"><a id="l00524" name="l00524"></a><span class="lineno">  524</span>   }</div>
<div class="line"><a id="l00525" name="l00525"></a><span class="lineno">  525</span> </div>
<div class="line"><a id="l00526" name="l00526"></a><span class="lineno">  526</span>   <span class="keywordtype">void</span> transaction_context::validate_account_cpu_usage_estimate( <a class="code hl_typedef" href="stdint_8h.html#a414156feea104f8f75b4ed9e3121b2f6">int64_t</a> prev_billed_us, <a class="code hl_typedef" href="stdint_8h.html#a414156feea104f8f75b4ed9e3121b2f6">int64_t</a> account_cpu_limit )<span class="keyword">const </span>{</div>
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno">  527</span>      <span class="comment">// prev_billed_us can be 0, but so can account_cpu_limit</span></div>
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno">  528</span>      <span class="keywordflow">if</span>( (prev_billed_us &gt;= 0) &amp;&amp; !<a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#af52efad2c5859002ad3bedad5834cb7f">control</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#afc8b0aff5d6f215c336a682c83badf6e">skip_trx_checks</a>() ) {</div>
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno">  529</span>         <span class="keyword">const</span> <span class="keywordtype">bool</span> cpu_limited_by_account = (account_cpu_limit &lt;= objective_duration_limit.count());</div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span> </div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span>         <span class="keywordflow">if</span>( !cpu_limited_by_account &amp;&amp; (billing_timer_exception_code == block_cpu_usage_exceeded::code_value) ) {</div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno">  532</span>            <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( prev_billed_us &lt; objective_duration_limit.count(),</div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span>                        block_cpu_usage_exceeded,</div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span>                        <span class="stringliteral">&quot;estimated CPU time (${billed} us) is not less than the billable CPU time left in the block (${billable} us)&quot;</span>,</div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno">  535</span>                        (<span class="stringliteral">&quot;billed&quot;</span>, prev_billed_us)( <span class="stringliteral">&quot;billable&quot;</span>, objective_duration_limit.count() )</div>
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno">  536</span>            );</div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span>         } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno">  538</span>            <span class="keywordflow">if</span>( cpu_limit_due_to_greylist &amp;&amp; cpu_limited_by_account ) {</div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span>               <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( prev_billed_us &lt; account_cpu_limit,</div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span>                           greylist_cpu_usage_exceeded,</div>
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno">  541</span>                           <span class="stringliteral">&quot;estimated CPU time (${billed} us) is not less than the maximum greylisted billable CPU time for the transaction (${billable} us)&quot;</span>,</div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno">  542</span>                           (<span class="stringliteral">&quot;billed&quot;</span>, prev_billed_us)( <span class="stringliteral">&quot;billable&quot;</span>, account_cpu_limit )</div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span>               );</div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno">  544</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00545" name="l00545"></a><span class="lineno">  545</span>               <span class="comment">// exceeds trx.max_cpu_usage_ms or cfg.max_transaction_cpu_usage if objective_duration_limit is greater</span></div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno">  546</span>               <span class="keyword">const</span> <a class="code hl_typedef" href="stdint_8h.html#a414156feea104f8f75b4ed9e3121b2f6">int64_t</a> cpu_limit = (cpu_limited_by_account ? account_cpu_limit : objective_duration_limit.count());</div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno">  547</span>               <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( prev_billed_us &lt; cpu_limit,</div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno">  548</span>                           tx_cpu_usage_exceeded,</div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno">  549</span>                           <span class="stringliteral">&quot;estimated CPU time (${billed} us) is not less than the maximum billable CPU time for the transaction (${billable} us)&quot;</span>,</div>
<div class="line"><a id="l00550" name="l00550"></a><span class="lineno">  550</span>                           (<span class="stringliteral">&quot;billed&quot;</span>, prev_billed_us)( <span class="stringliteral">&quot;billable&quot;</span>, cpu_limit )</div>
<div class="line"><a id="l00551" name="l00551"></a><span class="lineno">  551</span>               );</div>
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno">  552</span>            }</div>
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno">  553</span>         }</div>
<div class="line"><a id="l00554" name="l00554"></a><span class="lineno">  554</span>      }</div>
<div class="line"><a id="l00555" name="l00555"></a><span class="lineno">  555</span>   }</div>
<div class="line"><a id="l00556" name="l00556"></a><span class="lineno">  556</span> </div>
<div class="line"><a id="l00557" name="l00557"></a><span class="lineno">  557</span>   <span class="keywordtype">void</span> transaction_context::add_ram_usage( <a class="code hl_typedef" href="namespacesysio_1_1chain.html#ac32ce8e75243f2b3f76aff0c1984f11b">account_name</a> account, <a class="code hl_typedef" href="stdint_8h.html#a414156feea104f8f75b4ed9e3121b2f6">int64_t</a> ram_delta ) {</div>
<div class="line"><a id="l00558" name="l00558"></a><span class="lineno">  558</span>      <span class="keyword">auto</span>&amp; rl = <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#af52efad2c5859002ad3bedad5834cb7f">control</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#add2453cf4d0208ca9f277337c9a5ed7a">get_mutable_resource_limits_manager</a>();</div>
<div class="line"><a id="l00559" name="l00559"></a><span class="lineno">  559</span>      rl.<a class="code hl_function" href="classsysio_1_1chain_1_1resource__limits_1_1resource__limits__manager.html#a7fea1de6a3806590de0bda86e53c7995">add_pending_ram_usage</a>( account, ram_delta );</div>
<div class="line"><a id="l00560" name="l00560"></a><span class="lineno">  560</span>      <span class="keywordflow">if</span>( ram_delta &gt; 0 ) {</div>
<div class="line"><a id="l00561" name="l00561"></a><span class="lineno">  561</span>         <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a5bcfb17b8688258f7287ad7c99567fad">validate_ram_usage</a>.insert( account );</div>
<div class="line"><a id="l00562" name="l00562"></a><span class="lineno">  562</span>      }</div>
<div class="line"><a id="l00563" name="l00563"></a><span class="lineno">  563</span>   }</div>
<div class="line"><a id="l00564" name="l00564"></a><span class="lineno">  564</span> </div>
<div class="foldopen" id="foldopen00565" data-start="{" data-end="}">
<div class="line"><a id="l00565" name="l00565"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1transaction__context.html#a2f8dc57cb2e3562de132326b0d06e15d">  565</a></span>   <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="code hl_function" href="classsysio_1_1chain_1_1transaction__context.html#a2f8dc57cb2e3562de132326b0d06e15d">transaction_context::update_billed_cpu_time</a>( <a class="code hl_class" href="classfc_1_1time__point.html">fc::time_point</a> now ) {</div>
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno">  566</span>      <span class="keywordflow">if</span>( <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a05dbab6e9e0d4f3e30fa1392ac4430a1">explicit_billed_cpu_time</a> ) <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a><span class="keyword">&gt;</span>(<a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a08b550fccea696363035c6736c146436">billed_cpu_time_us</a>);</div>
<div class="line"><a id="l00567" name="l00567"></a><span class="lineno">  567</span> </div>
<div class="line"><a id="l00568" name="l00568"></a><span class="lineno">  568</span>      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; cfg = <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#af52efad2c5859002ad3bedad5834cb7f">control</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a0bb11e832a05b6437c79bf81758b1b7d">get_global_properties</a>().<a class="code hl_variable" href="classsysio_1_1chain_1_1global__property__object.html#a7f149fcf87034217c899838eb4430496">configuration</a>;</div>
<div class="line"><a id="l00569" name="l00569"></a><span class="lineno">  569</span>      <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a08b550fccea696363035c6736c146436">billed_cpu_time_us</a> = std::max( (now - pseudo_start).<a class="code hl_variable" href="gmock__stress__test_8cc.html#afd9db40e3361ae09188795e8cbe19752">count</a>(), <span class="keyword">static_cast&lt;</span><a class="code hl_typedef" href="stdint_8h.html#a414156feea104f8f75b4ed9e3121b2f6">int64_t</a><span class="keyword">&gt;</span>(cfg.min_transaction_cpu_usage) );</div>
<div class="line"><a id="l00570" name="l00570"></a><span class="lineno">  570</span> </div>
<div class="line"><a id="l00571" name="l00571"></a><span class="lineno">  571</span>      <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a><span class="keyword">&gt;</span>(<a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a08b550fccea696363035c6736c146436">billed_cpu_time_us</a>);</div>
<div class="line"><a id="l00572" name="l00572"></a><span class="lineno">  572</span>   }</div>
</div>
<div class="line"><a id="l00573" name="l00573"></a><span class="lineno">  573</span> </div>
<div class="foldopen" id="foldopen00574" data-start="{" data-end="}">
<div class="line"><a id="l00574" name="l00574"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1transaction__context.html#ad525fafe1ffad93dc767bf2b5b9ea0cc">  574</a></span>   std::tuple&lt;int64_t, int64_t, bool, bool&gt; <a class="code hl_function" href="classsysio_1_1chain_1_1transaction__context.html#ad525fafe1ffad93dc767bf2b5b9ea0cc">transaction_context::max_bandwidth_billed_accounts_can_pay</a>( <span class="keywordtype">bool</span> force_elastic_limits )<span class="keyword"> const</span>{</div>
<div class="line"><a id="l00575" name="l00575"></a><span class="lineno">  575</span>      <span class="comment">// Assumes rl.update_account_usage( bill_to_accounts, block_timestamp_type(control.pending_block_time()).slot ) was already called prior</span></div>
<div class="line"><a id="l00576" name="l00576"></a><span class="lineno">  576</span> </div>
<div class="line"><a id="l00577" name="l00577"></a><span class="lineno">  577</span>      <span class="comment">// Calculate the new highest network usage and CPU time that all of the billed accounts can afford to be billed</span></div>
<div class="line"><a id="l00578" name="l00578"></a><span class="lineno">  578</span>      <span class="keyword">auto</span>&amp; rl = <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#af52efad2c5859002ad3bedad5834cb7f">control</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#add2453cf4d0208ca9f277337c9a5ed7a">get_mutable_resource_limits_manager</a>();</div>
<div class="line"><a id="l00579" name="l00579"></a><span class="lineno">  579</span>      <span class="keyword">const</span> <span class="keyword">static</span> <a class="code hl_typedef" href="stdint_8h.html#a414156feea104f8f75b4ed9e3121b2f6">int64_t</a> large_number_no_overflow = std::numeric_limits&lt;int64_t&gt;::max()/2;</div>
<div class="line"><a id="l00580" name="l00580"></a><span class="lineno">  580</span>      <a class="code hl_typedef" href="stdint_8h.html#a414156feea104f8f75b4ed9e3121b2f6">int64_t</a> account_net_limit = large_number_no_overflow;</div>
<div class="line"><a id="l00581" name="l00581"></a><span class="lineno">  581</span>      <a class="code hl_typedef" href="stdint_8h.html#a414156feea104f8f75b4ed9e3121b2f6">int64_t</a> account_cpu_limit = large_number_no_overflow;</div>
<div class="line"><a id="l00582" name="l00582"></a><span class="lineno">  582</span>      <span class="keywordtype">bool</span> greylisted_net = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00583" name="l00583"></a><span class="lineno">  583</span>      <span class="keywordtype">bool</span> greylisted_cpu = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00584" name="l00584"></a><span class="lineno">  584</span> </div>
<div class="line"><a id="l00585" name="l00585"></a><span class="lineno">  585</span>      <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> specified_greylist_limit = <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#af52efad2c5859002ad3bedad5834cb7f">control</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a9d7c53697f9d587b6f2e583af9f7e712">get_greylist_limit</a>();</div>
<div class="line"><a id="l00586" name="l00586"></a><span class="lineno">  586</span>      <span class="keywordflow">for</span>( <span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code hl_variable" href="pointer_8h.html#aeeddce917cf130d62c370b8f216026dd">a</a> : <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#ac178b3a7e2ef905025ae4e2f262422ff">bill_to_accounts</a> ) {</div>
<div class="line"><a id="l00587" name="l00587"></a><span class="lineno">  587</span>         <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> greylist_limit = config::maximum_elastic_resource_multiplier;</div>
<div class="line"><a id="l00588" name="l00588"></a><span class="lineno">  588</span>         <span class="keywordflow">if</span>( !force_elastic_limits &amp;&amp; <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#af52efad2c5859002ad3bedad5834cb7f">control</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a0fcc85a590581560765686050fe105a8">is_producing_block</a>() ) {</div>
<div class="line"><a id="l00589" name="l00589"></a><span class="lineno">  589</span>            <span class="keywordflow">if</span>( <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#af52efad2c5859002ad3bedad5834cb7f">control</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#aa1c6dcfae09e0e0ea50ba3fda8915114">is_resource_greylisted</a>(<a class="code hl_variable" href="pointer_8h.html#aeeddce917cf130d62c370b8f216026dd">a</a>) ) {</div>
<div class="line"><a id="l00590" name="l00590"></a><span class="lineno">  590</span>               greylist_limit = 1;</div>
<div class="line"><a id="l00591" name="l00591"></a><span class="lineno">  591</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00592" name="l00592"></a><span class="lineno">  592</span>               greylist_limit = specified_greylist_limit;</div>
<div class="line"><a id="l00593" name="l00593"></a><span class="lineno">  593</span>            }</div>
<div class="line"><a id="l00594" name="l00594"></a><span class="lineno">  594</span>         }</div>
<div class="line"><a id="l00595" name="l00595"></a><span class="lineno">  595</span>         <span class="keyword">auto</span> [net_limit, net_was_greylisted] = rl.get_account_net_limit(<a class="code hl_variable" href="pointer_8h.html#aeeddce917cf130d62c370b8f216026dd">a</a>, greylist_limit);</div>
<div class="line"><a id="l00596" name="l00596"></a><span class="lineno">  596</span>         <span class="keywordflow">if</span>( net_limit &gt;= 0 ) {</div>
<div class="line"><a id="l00597" name="l00597"></a><span class="lineno">  597</span>            account_net_limit = std::min( account_net_limit, net_limit );</div>
<div class="line"><a id="l00598" name="l00598"></a><span class="lineno">  598</span>            greylisted_net |= net_was_greylisted;</div>
<div class="line"><a id="l00599" name="l00599"></a><span class="lineno">  599</span>         }</div>
<div class="line"><a id="l00600" name="l00600"></a><span class="lineno">  600</span>         <span class="keyword">auto</span> [cpu_limit, cpu_was_greylisted] = rl.get_account_cpu_limit(<a class="code hl_variable" href="pointer_8h.html#aeeddce917cf130d62c370b8f216026dd">a</a>, greylist_limit);</div>
<div class="line"><a id="l00601" name="l00601"></a><span class="lineno">  601</span>         <span class="keywordflow">if</span>( cpu_limit &gt;= 0 ) {</div>
<div class="line"><a id="l00602" name="l00602"></a><span class="lineno">  602</span>            account_cpu_limit = std::min( account_cpu_limit, cpu_limit );</div>
<div class="line"><a id="l00603" name="l00603"></a><span class="lineno">  603</span>            greylisted_cpu |= cpu_was_greylisted;</div>
<div class="line"><a id="l00604" name="l00604"></a><span class="lineno">  604</span>         }</div>
<div class="line"><a id="l00605" name="l00605"></a><span class="lineno">  605</span>      }</div>
<div class="line"><a id="l00606" name="l00606"></a><span class="lineno">  606</span> </div>
<div class="line"><a id="l00607" name="l00607"></a><span class="lineno">  607</span>      <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( (!force_elastic_limits &amp;&amp; <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#af52efad2c5859002ad3bedad5834cb7f">control</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a0fcc85a590581560765686050fe105a8">is_producing_block</a>()) || (!greylisted_cpu &amp;&amp; !greylisted_net),</div>
<div class="line"><a id="l00608" name="l00608"></a><span class="lineno">  608</span>                  <a class="code hl_variable" href="namespacesysio_1_1chain.html#a5dfe17906469eaf079c180c1afb4ad94">transaction_exception</a>, <span class="stringliteral">&quot;greylisted when not producing block&quot;</span> );</div>
<div class="line"><a id="l00609" name="l00609"></a><span class="lineno">  609</span> </div>
<div class="line"><a id="l00610" name="l00610"></a><span class="lineno">  610</span>      <span class="keywordflow">return</span> std::make_tuple(account_net_limit, account_cpu_limit, greylisted_net, greylisted_cpu);</div>
<div class="line"><a id="l00611" name="l00611"></a><span class="lineno">  611</span>   }</div>
</div>
<div class="line"><a id="l00612" name="l00612"></a><span class="lineno">  612</span> </div>
<div class="line"><a id="l00613" name="l00613"></a><span class="lineno">  613</span>   <a class="code hl_struct" href="structsysio_1_1chain_1_1action__trace.html">action_trace</a>&amp; transaction_context::get_action_trace( <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> action_ordinal ) {</div>
<div class="line"><a id="l00614" name="l00614"></a><span class="lineno">  614</span>      <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( 0 &lt; action_ordinal &amp;&amp; action_ordinal &lt;= trace-&gt;action_traces.size() ,</div>
<div class="line"><a id="l00615" name="l00615"></a><span class="lineno">  615</span>                  <a class="code hl_variable" href="namespacesysio_1_1chain.html#a5dfe17906469eaf079c180c1afb4ad94">transaction_exception</a>,</div>
<div class="line"><a id="l00616" name="l00616"></a><span class="lineno">  616</span>                  <span class="stringliteral">&quot;action_ordinal ${ordinal} is outside allowed range [1,${max}]&quot;</span>,</div>
<div class="line"><a id="l00617" name="l00617"></a><span class="lineno">  617</span>                  (<span class="stringliteral">&quot;ordinal&quot;</span>, action_ordinal)(<span class="stringliteral">&quot;max&quot;</span>, <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a7211fab425e4375e247c2a3d1924e63f">trace</a>-&gt;action_traces.size())</div>
<div class="line"><a id="l00618" name="l00618"></a><span class="lineno">  618</span>      );</div>
<div class="line"><a id="l00619" name="l00619"></a><span class="lineno">  619</span>      <span class="keywordflow">return</span> <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a7211fab425e4375e247c2a3d1924e63f">trace</a>-&gt;action_traces[action_ordinal-1];</div>
<div class="line"><a id="l00620" name="l00620"></a><span class="lineno">  620</span>   }</div>
<div class="line"><a id="l00621" name="l00621"></a><span class="lineno">  621</span> </div>
<div class="line"><a id="l00622" name="l00622"></a><span class="lineno">  622</span>   <span class="keyword">const</span> <a class="code hl_struct" href="structsysio_1_1chain_1_1action__trace.html">action_trace</a>&amp; transaction_context::get_action_trace( <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> action_ordinal )<span class="keyword">const </span>{</div>
<div class="line"><a id="l00623" name="l00623"></a><span class="lineno">  623</span>      <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( 0 &lt; action_ordinal &amp;&amp; action_ordinal &lt;= trace-&gt;action_traces.size() ,</div>
<div class="line"><a id="l00624" name="l00624"></a><span class="lineno">  624</span>                  <a class="code hl_variable" href="namespacesysio_1_1chain.html#a5dfe17906469eaf079c180c1afb4ad94">transaction_exception</a>,</div>
<div class="line"><a id="l00625" name="l00625"></a><span class="lineno">  625</span>                  <span class="stringliteral">&quot;action_ordinal ${ordinal} is outside allowed range [1,${max}]&quot;</span>,</div>
<div class="line"><a id="l00626" name="l00626"></a><span class="lineno">  626</span>                  (<span class="stringliteral">&quot;ordinal&quot;</span>, action_ordinal)(<span class="stringliteral">&quot;max&quot;</span>, <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a7211fab425e4375e247c2a3d1924e63f">trace</a>-&gt;action_traces.size())</div>
<div class="line"><a id="l00627" name="l00627"></a><span class="lineno">  627</span>      );</div>
<div class="line"><a id="l00628" name="l00628"></a><span class="lineno">  628</span>      <span class="keywordflow">return</span> <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a7211fab425e4375e247c2a3d1924e63f">trace</a>-&gt;action_traces[action_ordinal-1];</div>
<div class="line"><a id="l00629" name="l00629"></a><span class="lineno">  629</span>   }</div>
<div class="line"><a id="l00630" name="l00630"></a><span class="lineno">  630</span> </div>
<div class="line"><a id="l00631" name="l00631"></a><span class="lineno">  631</span>   <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> transaction_context::schedule_action( <span class="keyword">const</span> <a class="code hl_struct" href="structaction.html">action</a>&amp; act, <a class="code hl_typedef" href="namespacesysio_1_1chain.html#ac32ce8e75243f2b3f76aff0c1984f11b">account_name</a> receiver, <span class="keywordtype">bool</span> context_free,</div>
<div class="line"><a id="l00632" name="l00632"></a><span class="lineno">  632</span>                                                  <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> creator_action_ordinal,</div>
<div class="line"><a id="l00633" name="l00633"></a><span class="lineno">  633</span>                                                  <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> closest_unnotified_ancestor_action_ordinal )</div>
<div class="line"><a id="l00634" name="l00634"></a><span class="lineno">  634</span>   {</div>
<div class="line"><a id="l00635" name="l00635"></a><span class="lineno">  635</span>      <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> new_action_ordinal = <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a7211fab425e4375e247c2a3d1924e63f">trace</a>-&gt;action_traces.size() + 1;</div>
<div class="line"><a id="l00636" name="l00636"></a><span class="lineno">  636</span> </div>
<div class="line"><a id="l00637" name="l00637"></a><span class="lineno">  637</span>      <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a7211fab425e4375e247c2a3d1924e63f">trace</a>-&gt;action_traces.emplace_back( *<a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a7211fab425e4375e247c2a3d1924e63f">trace</a>, act, receiver, context_free,</div>
<div class="line"><a id="l00638" name="l00638"></a><span class="lineno">  638</span>                                         new_action_ordinal, creator_action_ordinal,</div>
<div class="line"><a id="l00639" name="l00639"></a><span class="lineno">  639</span>                                         closest_unnotified_ancestor_action_ordinal );</div>
<div class="line"><a id="l00640" name="l00640"></a><span class="lineno">  640</span> </div>
<div class="line"><a id="l00641" name="l00641"></a><span class="lineno">  641</span>      <span class="keywordflow">return</span> new_action_ordinal;</div>
<div class="line"><a id="l00642" name="l00642"></a><span class="lineno">  642</span>   }</div>
<div class="line"><a id="l00643" name="l00643"></a><span class="lineno">  643</span> </div>
<div class="line"><a id="l00644" name="l00644"></a><span class="lineno">  644</span>   <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> transaction_context::schedule_action( <a class="code hl_struct" href="structaction.html">action</a>&amp;&amp; act, <a class="code hl_typedef" href="namespacesysio_1_1chain.html#ac32ce8e75243f2b3f76aff0c1984f11b">account_name</a> receiver, <span class="keywordtype">bool</span> context_free,</div>
<div class="line"><a id="l00645" name="l00645"></a><span class="lineno">  645</span>                                                  <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> creator_action_ordinal,</div>
<div class="line"><a id="l00646" name="l00646"></a><span class="lineno">  646</span>                                                  <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> closest_unnotified_ancestor_action_ordinal )</div>
<div class="line"><a id="l00647" name="l00647"></a><span class="lineno">  647</span>   {</div>
<div class="line"><a id="l00648" name="l00648"></a><span class="lineno">  648</span>      <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> new_action_ordinal = <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a7211fab425e4375e247c2a3d1924e63f">trace</a>-&gt;action_traces.size() + 1;</div>
<div class="line"><a id="l00649" name="l00649"></a><span class="lineno">  649</span> </div>
<div class="line"><a id="l00650" name="l00650"></a><span class="lineno">  650</span>      <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a7211fab425e4375e247c2a3d1924e63f">trace</a>-&gt;action_traces.emplace_back( *<a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a7211fab425e4375e247c2a3d1924e63f">trace</a>, std::move(act), receiver, context_free,</div>
<div class="line"><a id="l00651" name="l00651"></a><span class="lineno">  651</span>                                         new_action_ordinal, creator_action_ordinal,</div>
<div class="line"><a id="l00652" name="l00652"></a><span class="lineno">  652</span>                                         closest_unnotified_ancestor_action_ordinal );</div>
<div class="line"><a id="l00653" name="l00653"></a><span class="lineno">  653</span> </div>
<div class="line"><a id="l00654" name="l00654"></a><span class="lineno">  654</span>      <span class="keywordflow">return</span> new_action_ordinal;</div>
<div class="line"><a id="l00655" name="l00655"></a><span class="lineno">  655</span>   }</div>
<div class="line"><a id="l00656" name="l00656"></a><span class="lineno">  656</span> </div>
<div class="line"><a id="l00657" name="l00657"></a><span class="lineno">  657</span>   <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> transaction_context::schedule_action( <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> action_ordinal, <a class="code hl_typedef" href="namespacesysio_1_1chain.html#ac32ce8e75243f2b3f76aff0c1984f11b">account_name</a> receiver, <span class="keywordtype">bool</span> context_free,</div>
<div class="line"><a id="l00658" name="l00658"></a><span class="lineno">  658</span>                                                  <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> creator_action_ordinal,</div>
<div class="line"><a id="l00659" name="l00659"></a><span class="lineno">  659</span>                                                  <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> closest_unnotified_ancestor_action_ordinal )</div>
<div class="line"><a id="l00660" name="l00660"></a><span class="lineno">  660</span>   {</div>
<div class="line"><a id="l00661" name="l00661"></a><span class="lineno">  661</span>      <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> new_action_ordinal = <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a7211fab425e4375e247c2a3d1924e63f">trace</a>-&gt;action_traces.size() + 1;</div>
<div class="line"><a id="l00662" name="l00662"></a><span class="lineno">  662</span> </div>
<div class="line"><a id="l00663" name="l00663"></a><span class="lineno">  663</span>      <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a7211fab425e4375e247c2a3d1924e63f">trace</a>-&gt;action_traces.reserve( new_action_ordinal );</div>
<div class="line"><a id="l00664" name="l00664"></a><span class="lineno">  664</span> </div>
<div class="line"><a id="l00665" name="l00665"></a><span class="lineno">  665</span>      <span class="keyword">const</span> <a class="code hl_struct" href="structaction.html">action</a>&amp; provided_action = get_action_trace( action_ordinal ).<a class="code hl_variable" href="structsysio_1_1chain_1_1action__trace.html#a2aa19858e0762797685b9ec46e820656">act</a>;</div>
<div class="line"><a id="l00666" name="l00666"></a><span class="lineno">  666</span> </div>
<div class="line"><a id="l00667" name="l00667"></a><span class="lineno">  667</span>      <span class="comment">// The reserve above is required so that the emplace_back below does not invalidate the provided_action reference.</span></div>
<div class="line"><a id="l00668" name="l00668"></a><span class="lineno">  668</span> </div>
<div class="line"><a id="l00669" name="l00669"></a><span class="lineno">  669</span>      <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a7211fab425e4375e247c2a3d1924e63f">trace</a>-&gt;action_traces.emplace_back( *<a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a7211fab425e4375e247c2a3d1924e63f">trace</a>, provided_action, receiver, context_free,</div>
<div class="line"><a id="l00670" name="l00670"></a><span class="lineno">  670</span>                                         new_action_ordinal, creator_action_ordinal,</div>
<div class="line"><a id="l00671" name="l00671"></a><span class="lineno">  671</span>                                         closest_unnotified_ancestor_action_ordinal );</div>
<div class="line"><a id="l00672" name="l00672"></a><span class="lineno">  672</span> </div>
<div class="line"><a id="l00673" name="l00673"></a><span class="lineno">  673</span>      <span class="keywordflow">return</span> new_action_ordinal;</div>
<div class="line"><a id="l00674" name="l00674"></a><span class="lineno">  674</span>   }</div>
<div class="line"><a id="l00675" name="l00675"></a><span class="lineno">  675</span> </div>
<div class="line"><a id="l00676" name="l00676"></a><span class="lineno">  676</span>   <span class="keywordtype">void</span> transaction_context::execute_action( <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> action_ordinal, <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> recurse_depth ) {</div>
<div class="line"><a id="l00677" name="l00677"></a><span class="lineno">  677</span>      <a class="code hl_friend" href="classsysio_1_1chain_1_1transaction__context.html#a7b669aea7e7e49e2cd5f5eff2e8ca927">apply_context</a> acontext( <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#af52efad2c5859002ad3bedad5834cb7f">control</a>, *<span class="keyword">this</span>, action_ordinal, recurse_depth );</div>
<div class="line"><a id="l00678" name="l00678"></a><span class="lineno">  678</span> </div>
<div class="line"><a id="l00679" name="l00679"></a><span class="lineno">  679</span>      <span class="keywordflow">if</span> (recurse_depth == 0) {</div>
<div class="line"><a id="l00680" name="l00680"></a><span class="lineno">  680</span>         <span class="keywordflow">if</span> (<span class="keyword">auto</span> dm_logger = <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#af52efad2c5859002ad3bedad5834cb7f">control</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a4f6404b355a3a4bf7fb60c92e85443d1">get_deep_mind_logger</a>()) {</div>
<div class="line"><a id="l00681" name="l00681"></a><span class="lineno">  681</span>            dm_logger-&gt;on_input_action();</div>
<div class="line"><a id="l00682" name="l00682"></a><span class="lineno">  682</span>         }</div>
<div class="line"><a id="l00683" name="l00683"></a><span class="lineno">  683</span>      }</div>
<div class="line"><a id="l00684" name="l00684"></a><span class="lineno">  684</span> </div>
<div class="line"><a id="l00685" name="l00685"></a><span class="lineno">  685</span>      acontext.exec();</div>
<div class="line"><a id="l00686" name="l00686"></a><span class="lineno">  686</span>   }</div>
<div class="line"><a id="l00687" name="l00687"></a><span class="lineno">  687</span> </div>
<div class="line"><a id="l00688" name="l00688"></a><span class="lineno">  688</span> </div>
<div class="line"><a id="l00689" name="l00689"></a><span class="lineno">  689</span>   <span class="keywordtype">void</span> transaction_context::schedule_transaction() {</div>
<div class="line"><a id="l00690" name="l00690"></a><span class="lineno">  690</span>      <span class="comment">// Charge ahead of time for the additional net usage needed to retire the delayed transaction</span></div>
<div class="line"><a id="l00691" name="l00691"></a><span class="lineno">  691</span>      <span class="comment">// whether that be by successfully executing, soft failure, hard failure, or expiration.</span></div>
<div class="line"><a id="l00692" name="l00692"></a><span class="lineno">  692</span>      <span class="keyword">const</span> transaction&amp; trx = <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a08e9cf6a4b8ce2f6211ce9d8de1b4da3">packed_trx</a>.<a class="code hl_function" href="structsysio_1_1chain_1_1packed__transaction.html#ad193d26eb97cfd5b3f7d8b957eaa35a2">get_transaction</a>();</div>
<div class="line"><a id="l00693" name="l00693"></a><span class="lineno">  693</span>      <span class="keywordflow">if</span>( trx.delay_sec.value == 0 ) { <span class="comment">// Do not double bill. Only charge if we have not already charged for the delay.</span></div>
<div class="line"><a id="l00694" name="l00694"></a><span class="lineno">  694</span>         <span class="keyword">const</span> <span class="keyword">auto</span>&amp; cfg = <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#af52efad2c5859002ad3bedad5834cb7f">control</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a0bb11e832a05b6437c79bf81758b1b7d">get_global_properties</a>().<a class="code hl_variable" href="classsysio_1_1chain_1_1global__property__object.html#a7f149fcf87034217c899838eb4430496">configuration</a>;</div>
<div class="line"><a id="l00695" name="l00695"></a><span class="lineno">  695</span>         <a class="code hl_function" href="classsysio_1_1chain_1_1transaction__context.html#a62b3defb107a356551a01d2c78e80b4b">add_net_usage</a>( <span class="keyword">static_cast&lt;</span><a class="code hl_typedef" href="stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a><span class="keyword">&gt;</span>(cfg.base_per_transaction_net_usage)</div>
<div class="line"><a id="l00696" name="l00696"></a><span class="lineno">  696</span>                         + <span class="keyword">static_cast&lt;</span><a class="code hl_typedef" href="stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a><span class="keyword">&gt;</span>(config::transaction_id_net_usage) ); <span class="comment">// Will exit early if net usage cannot be payed.</span></div>
<div class="line"><a id="l00697" name="l00697"></a><span class="lineno">  697</span>      }</div>
<div class="line"><a id="l00698" name="l00698"></a><span class="lineno">  698</span> </div>
<div class="line"><a id="l00699" name="l00699"></a><span class="lineno">  699</span>      <span class="keyword">auto</span> first_auth = trx.<a class="code hl_function" href="structsysio_1_1chain_1_1transaction.html#a98cfda9267a92091fb3e7b73163406c2">first_authorizer</a>();</div>
<div class="line"><a id="l00700" name="l00700"></a><span class="lineno">  700</span> </div>
<div class="line"><a id="l00701" name="l00701"></a><span class="lineno">  701</span>      <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> trx_size = 0;</div>
<div class="line"><a id="l00702" name="l00702"></a><span class="lineno">  702</span>      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; cgto = <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#af52efad2c5859002ad3bedad5834cb7f">control</a>.mutable_db().<a class="code hl_function" href="classchainbase_1_1database.html#adc8f336b33d7013d1b0400399b16c5a7">create</a>&lt;generated_transaction_object&gt;( [&amp;]( <span class="keyword">auto</span>&amp; gto ) {</div>
<div class="line"><a id="l00703" name="l00703"></a><span class="lineno">  703</span>        gto.trx_id      = <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a08e9cf6a4b8ce2f6211ce9d8de1b4da3">packed_trx</a>.<a class="code hl_function" href="structsysio_1_1chain_1_1packed__transaction.html#acc706e72aa422ee3e3c02f73871609cb">id</a>();</div>
<div class="line"><a id="l00704" name="l00704"></a><span class="lineno">  704</span>        gto.payer       = first_auth;</div>
<div class="line"><a id="l00705" name="l00705"></a><span class="lineno">  705</span>        gto.sender      = <a class="code hl_typedef" href="namespacesysio_1_1chain.html#ac32ce8e75243f2b3f76aff0c1984f11b">account_name</a>(); </div>
<div class="line"><a id="l00706" name="l00706"></a><span class="lineno">  706</span>        gto.sender_id   = <a class="code hl_function" href="namespacesysio_1_1chain.html#aae2c9fe44a33a7568fb2b6a709112b9f">transaction_id_to_sender_id</a>( gto.trx_id );</div>
<div class="line"><a id="l00707" name="l00707"></a><span class="lineno">  707</span>        gto.published   = <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#af52efad2c5859002ad3bedad5834cb7f">control</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#abb1d81f96986df3bce46bd37caaf6a69">pending_block_time</a>();</div>
<div class="line"><a id="l00708" name="l00708"></a><span class="lineno">  708</span>        gto.delay_until = gto.published + <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a73f4035fab7271fec7fcac5aa01bd461">delay</a>;</div>
<div class="line"><a id="l00709" name="l00709"></a><span class="lineno">  709</span>        gto.expiration  = gto.delay_until + <a class="code hl_function" href="namespacefc.html#a9623b8cae3f48bbed6aa1fc2afe9b174">fc::seconds</a>(<a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#af52efad2c5859002ad3bedad5834cb7f">control</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a0bb11e832a05b6437c79bf81758b1b7d">get_global_properties</a>().<a class="code hl_variable" href="classsysio_1_1chain_1_1global__property__object.html#a7f149fcf87034217c899838eb4430496">configuration</a>.<a class="code hl_variable" href="structsysio_1_1chain_1_1chain__config__v0.html#a6ab303c6326dc33d1280e0b8d13eed68">deferred_trx_expiration_window</a>);</div>
<div class="line"><a id="l00710" name="l00710"></a><span class="lineno">  710</span>        trx_size = gto.set( trx );</div>
<div class="line"><a id="l00711" name="l00711"></a><span class="lineno">  711</span> </div>
<div class="line"><a id="l00712" name="l00712"></a><span class="lineno">  712</span>        <span class="keywordflow">if</span> (<span class="keyword">auto</span> dm_logger = <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#af52efad2c5859002ad3bedad5834cb7f">control</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a4f6404b355a3a4bf7fb60c92e85443d1">get_deep_mind_logger</a>()) {</div>
<div class="line"><a id="l00713" name="l00713"></a><span class="lineno">  713</span>           std::string event_id = <a class="code hl_define" href="deep__mind_8hpp.html#aaaa2f1dbd522de03ccbaa73f01db5f50">RAM_EVENT_ID</a>(<span class="stringliteral">&quot;${id}&quot;</span>, (<span class="stringliteral">&quot;id&quot;</span>, gto.id));</div>
<div class="line"><a id="l00714" name="l00714"></a><span class="lineno">  714</span> </div>
<div class="line"><a id="l00715" name="l00715"></a><span class="lineno">  715</span>           dm_logger-&gt;on_create_deferred(<a class="code hl_enumvalue" href="classsysio_1_1chain_1_1deep__mind__handler.html#a78bf0c79493a90c71cb28aa761f44fd2a21a361d96e3e13f5f109748c2a9d2434">deep_mind_handler::operation_qualifier::push</a>, gto, <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a08e9cf6a4b8ce2f6211ce9d8de1b4da3">packed_trx</a>);</div>
<div class="line"><a id="l00716" name="l00716"></a><span class="lineno">  716</span>           dm_logger-&gt;on_ram_trace(std::move(event_id), <span class="stringliteral">&quot;deferred_trx&quot;</span>, <span class="stringliteral">&quot;push&quot;</span>, <span class="stringliteral">&quot;deferred_trx_pushed&quot;</span>);</div>
<div class="line"><a id="l00717" name="l00717"></a><span class="lineno">  717</span>        }</div>
<div class="line"><a id="l00718" name="l00718"></a><span class="lineno">  718</span>      });</div>
<div class="line"><a id="l00719" name="l00719"></a><span class="lineno">  719</span> </div>
<div class="line"><a id="l00720" name="l00720"></a><span class="lineno">  720</span>      <a class="code hl_typedef" href="stdint_8h.html#a414156feea104f8f75b4ed9e3121b2f6">int64_t</a> ram_delta = (<a class="code hl_variable" href="namespacesysio_1_1chain_1_1config.html#a2772c77657b1f6fda680bbe8f7282d13">config::billable_size_v&lt;generated_transaction_object&gt;</a> + trx_size);</div>
<div class="line"><a id="l00721" name="l00721"></a><span class="lineno">  721</span>      add_ram_usage( cgto.payer, ram_delta );</div>
<div class="line"><a id="l00722" name="l00722"></a><span class="lineno">  722</span>      <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a7211fab425e4375e247c2a3d1924e63f">trace</a>-&gt;account_ram_delta = account_delta( cgto.payer, ram_delta );</div>
<div class="line"><a id="l00723" name="l00723"></a><span class="lineno">  723</span>   }</div>
<div class="line"><a id="l00724" name="l00724"></a><span class="lineno">  724</span> </div>
<div class="line"><a id="l00725" name="l00725"></a><span class="lineno">  725</span>   <span class="keywordtype">void</span> transaction_context::record_transaction( <span class="keyword">const</span> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#aa85a3b49b3b219d1e3840567579e7e63">transaction_id_type</a>&amp; <span class="keywordtype">id</span>, <a class="code hl_class" href="classfc_1_1time__point__sec.html">fc::time_point_sec</a> expire ) {</div>
<div class="line"><a id="l00726" name="l00726"></a><span class="lineno">  726</span>      <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l00727" name="l00727"></a><span class="lineno">  727</span>          <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#af52efad2c5859002ad3bedad5834cb7f">control</a>.mutable_db().<a class="code hl_function" href="classchainbase_1_1database.html#adc8f336b33d7013d1b0400399b16c5a7">create</a>&lt;transaction_object&gt;([&amp;](transaction_object&amp; transaction) {</div>
<div class="line"><a id="l00728" name="l00728"></a><span class="lineno">  728</span>              transaction.trx_id = <a class="code hl_variable" href="code__cache_8cpp.html#aa0efefe21f4700d78692edc823e763be">id</a>;</div>
<div class="line"><a id="l00729" name="l00729"></a><span class="lineno">  729</span>              transaction.expiration = expire;</div>
<div class="line"><a id="l00730" name="l00730"></a><span class="lineno">  730</span>          });</div>
<div class="line"><a id="l00731" name="l00731"></a><span class="lineno">  731</span>      } <span class="keywordflow">catch</span>( <span class="keyword">const</span> boost::interprocess::bad_alloc&amp; ) {</div>
<div class="line"><a id="l00732" name="l00732"></a><span class="lineno">  732</span>         <span class="keywordflow">throw</span>;</div>
<div class="line"><a id="l00733" name="l00733"></a><span class="lineno">  733</span>      } <span class="keywordflow">catch</span> ( ... ) {</div>
<div class="line"><a id="l00734" name="l00734"></a><span class="lineno">  734</span>          <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( <span class="keyword">false</span>, tx_duplicate,</div>
<div class="line"><a id="l00735" name="l00735"></a><span class="lineno">  735</span>                     <span class="stringliteral">&quot;duplicate transaction ${id}&quot;</span>, (<span class="stringliteral">&quot;id&quot;</span>, <span class="keywordtype">id</span> ) );</div>
<div class="line"><a id="l00736" name="l00736"></a><span class="lineno">  736</span>      }</div>
<div class="line"><a id="l00737" name="l00737"></a><span class="lineno">  737</span>   } </div>
<div class="line"><a id="l00738" name="l00738"></a><span class="lineno">  738</span> </div>
<div class="foldopen" id="foldopen00739" data-start="{" data-end="}">
<div class="line"><a id="l00739" name="l00739"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1transaction__context.html#a7ecbfbb3d05a6a0b128feeb0a469878c">  739</a></span>   <span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1chain_1_1transaction__context.html#a7ecbfbb3d05a6a0b128feeb0a469878c">transaction_context::validate_referenced_accounts</a>( <span class="keyword">const</span> <a class="code hl_struct" href="structsysio_1_1chain_1_1transaction.html">transaction</a>&amp; trx, <span class="keywordtype">bool</span> enforce_actor_whitelist_blacklist )<span class="keyword">const </span>{</div>
<div class="line"><a id="l00740" name="l00740"></a><span class="lineno">  740</span>      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; db = <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#af52efad2c5859002ad3bedad5834cb7f">control</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a0c79d00dae8c0d90efc18f4d091b2391">db</a>();</div>
<div class="line"><a id="l00741" name="l00741"></a><span class="lineno">  741</span>      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; auth_manager = <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#af52efad2c5859002ad3bedad5834cb7f">control</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a8f7456b81f2657ccf6c39b35afb16af4">get_authorization_manager</a>();</div>
<div class="line"><a id="l00742" name="l00742"></a><span class="lineno">  742</span> </div>
<div class="line"><a id="l00743" name="l00743"></a><span class="lineno">  743</span>      <span class="keywordflow">for</span>( <span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code hl_variable" href="pointer_8h.html#aeeddce917cf130d62c370b8f216026dd">a</a> : trx.<a class="code hl_variable" href="structsysio_1_1chain_1_1transaction.html#a926f2528e0af9f17521fcf92282c5806">context_free_actions</a> ) {</div>
<div class="line"><a id="l00744" name="l00744"></a><span class="lineno">  744</span>         <span class="keyword">auto</span>* code = db.find&lt;<a class="code hl_class" href="classsysio_1_1chain_1_1account__object.html">account_object</a>, by_name&gt;(<a class="code hl_variable" href="pointer_8h.html#aeeddce917cf130d62c370b8f216026dd">a</a>.account);</div>
<div class="line"><a id="l00745" name="l00745"></a><span class="lineno">  745</span>         <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( code != <span class="keyword">nullptr</span>, <a class="code hl_variable" href="namespacesysio_1_1chain.html#a5dfe17906469eaf079c180c1afb4ad94">transaction_exception</a>,</div>
<div class="line"><a id="l00746" name="l00746"></a><span class="lineno">  746</span>                     <span class="stringliteral">&quot;action&#39;s code account &#39;${account}&#39; does not exist&quot;</span>, (<span class="stringliteral">&quot;account&quot;</span>, <a class="code hl_variable" href="pointer_8h.html#aeeddce917cf130d62c370b8f216026dd">a</a>.account) );</div>
<div class="line"><a id="l00747" name="l00747"></a><span class="lineno">  747</span>         <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( <a class="code hl_variable" href="pointer_8h.html#aeeddce917cf130d62c370b8f216026dd">a</a>.authorization.size() == 0, <a class="code hl_variable" href="namespacesysio_1_1chain.html#a5dfe17906469eaf079c180c1afb4ad94">transaction_exception</a>,</div>
<div class="line"><a id="l00748" name="l00748"></a><span class="lineno">  748</span>                     <span class="stringliteral">&quot;context-free actions cannot have authorizations&quot;</span> );</div>
<div class="line"><a id="l00749" name="l00749"></a><span class="lineno">  749</span>      }</div>
<div class="line"><a id="l00750" name="l00750"></a><span class="lineno">  750</span> </div>
<div class="line"><a id="l00751" name="l00751"></a><span class="lineno">  751</span>      flat_set&lt;account_name&gt; actors;</div>
<div class="line"><a id="l00752" name="l00752"></a><span class="lineno">  752</span> </div>
<div class="line"><a id="l00753" name="l00753"></a><span class="lineno">  753</span>      <span class="keywordtype">bool</span> one_auth = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00754" name="l00754"></a><span class="lineno">  754</span>      <span class="keywordflow">for</span>( <span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code hl_variable" href="pointer_8h.html#aeeddce917cf130d62c370b8f216026dd">a</a> : trx.<a class="code hl_variable" href="structsysio_1_1chain_1_1transaction.html#a407fcf1868b81bb30b85f80d388bbac2">actions</a> ) {</div>
<div class="line"><a id="l00755" name="l00755"></a><span class="lineno">  755</span>         <span class="keyword">auto</span>* code = db.find&lt;<a class="code hl_class" href="classsysio_1_1chain_1_1account__object.html">account_object</a>, by_name&gt;(<a class="code hl_variable" href="pointer_8h.html#aeeddce917cf130d62c370b8f216026dd">a</a>.account);</div>
<div class="line"><a id="l00756" name="l00756"></a><span class="lineno">  756</span>         <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( code != <span class="keyword">nullptr</span>, <a class="code hl_variable" href="namespacesysio_1_1chain.html#a5dfe17906469eaf079c180c1afb4ad94">transaction_exception</a>,</div>
<div class="line"><a id="l00757" name="l00757"></a><span class="lineno">  757</span>                     <span class="stringliteral">&quot;action&#39;s code account &#39;${account}&#39; does not exist&quot;</span>, (<span class="stringliteral">&quot;account&quot;</span>, <a class="code hl_variable" href="pointer_8h.html#aeeddce917cf130d62c370b8f216026dd">a</a>.account) );</div>
<div class="line"><a id="l00758" name="l00758"></a><span class="lineno">  758</span>         <span class="keywordflow">for</span>( <span class="keyword">const</span> <span class="keyword">auto</span>&amp; auth : <a class="code hl_variable" href="pointer_8h.html#aeeddce917cf130d62c370b8f216026dd">a</a>.authorization ) {</div>
<div class="line"><a id="l00759" name="l00759"></a><span class="lineno">  759</span>            one_auth = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00760" name="l00760"></a><span class="lineno">  760</span>            <span class="keyword">auto</span>* <a class="code hl_class" href="classfc_1_1actor.html">actor</a> = db.find&lt;<a class="code hl_class" href="classsysio_1_1chain_1_1account__object.html">account_object</a>, by_name&gt;(auth.actor);</div>
<div class="line"><a id="l00761" name="l00761"></a><span class="lineno">  761</span>            <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( <a class="code hl_class" href="classfc_1_1actor.html">actor</a>  != <span class="keyword">nullptr</span>, <a class="code hl_variable" href="namespacesysio_1_1chain.html#a5dfe17906469eaf079c180c1afb4ad94">transaction_exception</a>,</div>
<div class="line"><a id="l00762" name="l00762"></a><span class="lineno">  762</span>                        <span class="stringliteral">&quot;action&#39;s authorizing actor &#39;${account}&#39; does not exist&quot;</span>, (<span class="stringliteral">&quot;account&quot;</span>, auth.actor) );</div>
<div class="line"><a id="l00763" name="l00763"></a><span class="lineno">  763</span>            <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( auth_manager.find_permission(auth) != <span class="keyword">nullptr</span>, <a class="code hl_variable" href="namespacesysio_1_1chain.html#a5dfe17906469eaf079c180c1afb4ad94">transaction_exception</a>,</div>
<div class="line"><a id="l00764" name="l00764"></a><span class="lineno">  764</span>                        <span class="stringliteral">&quot;action&#39;s authorizations include a non-existent permission: ${permission}&quot;</span>,</div>
<div class="line"><a id="l00765" name="l00765"></a><span class="lineno">  765</span>                        (<span class="stringliteral">&quot;permission&quot;</span>, auth) );</div>
<div class="line"><a id="l00766" name="l00766"></a><span class="lineno">  766</span>            <span class="keywordflow">if</span>( enforce_actor_whitelist_blacklist )</div>
<div class="line"><a id="l00767" name="l00767"></a><span class="lineno">  767</span>               actors.insert( auth.actor );</div>
<div class="line"><a id="l00768" name="l00768"></a><span class="lineno">  768</span>         }</div>
<div class="line"><a id="l00769" name="l00769"></a><span class="lineno">  769</span>      }</div>
<div class="line"><a id="l00770" name="l00770"></a><span class="lineno">  770</span>      <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( one_auth || <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#acd4137f1354209bb1237e5a1f26fdbcd">is_read_only</a>, tx_no_auths, <span class="stringliteral">&quot;transaction must have at least one authorization&quot;</span> );</div>
<div class="line"><a id="l00771" name="l00771"></a><span class="lineno">  771</span> </div>
<div class="line"><a id="l00772" name="l00772"></a><span class="lineno">  772</span>      <span class="keywordflow">if</span>( enforce_actor_whitelist_blacklist ) {</div>
<div class="line"><a id="l00773" name="l00773"></a><span class="lineno">  773</span>         <a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#af52efad2c5859002ad3bedad5834cb7f">control</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#aa378f4265708c1bc41e4ee058ed71e6a">check_actor_list</a>( actors );</div>
<div class="line"><a id="l00774" name="l00774"></a><span class="lineno">  774</span>      }</div>
<div class="line"><a id="l00775" name="l00775"></a><span class="lineno">  775</span>   }</div>
</div>
<div class="line"><a id="l00776" name="l00776"></a><span class="lineno">  776</span> </div>
<div class="line"><a id="l00777" name="l00777"></a><span class="lineno">  777</span> </div>
<div class="line"><a id="l00778" name="l00778"></a><span class="lineno">  778</span>} } </div>
<div class="ttc" id="aapply__context_8hpp_html"><div class="ttname"><a href="apply__context_8hpp.html">apply_context.hpp</a></div></div>
<div class="ttc" id="aauthorization__manager_8hpp_html"><div class="ttname"><a href="authorization__manager_8hpp.html">authorization_manager.hpp</a></div></div>
<div class="ttc" id="abn_8cpp_html_a8b0eadcc506862e9d751ab45185053aa"><div class="ttname"><a href="bn_8cpp.html#a8b0eadcc506862e9d751ab45185053aa">p</a></div><div class="ttdeci">const mie::Vuint &amp; p</div><div class="ttdef"><b>Definition</b> <a href="bn_8cpp_source.html#l00027">bn.cpp:27</a></div></div>
<div class="ttc" id="achain_2include_2sysio_2chain_2exceptions_8hpp_html"><div class="ttname"><a href="chain_2include_2sysio_2chain_2exceptions_8hpp.html">exceptions.hpp</a></div></div>
<div class="ttc" id="achain_2include_2sysio_2chain_2exceptions_8hpp_html_a1bfa656552ea0534b2c91ee0fe33f850"><div class="ttname"><a href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a1bfa656552ea0534b2c91ee0fe33f850">SYS_THROW</a></div><div class="ttdeci">#define SYS_THROW(exc_type, FORMAT,...)</div><div class="ttdef"><b>Definition</b> <a href="chain_2include_2sysio_2chain_2exceptions_8hpp_source.html#l00013">exceptions.hpp:13</a></div></div>
<div class="ttc" id="achain_2include_2sysio_2chain_2exceptions_8hpp_html_a40c2826a6fba35c1ffbf912bdf559792"><div class="ttname"><a href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a></div><div class="ttdeci">#define SYS_ASSERT(expr, exc_type, FORMAT,...)</div><div class="ttdef"><b>Definition</b> <a href="chain_2include_2sysio_2chain_2exceptions_8hpp_source.html#l00007">exceptions.hpp:7</a></div></div>
<div class="ttc" id="aclasschainbase_1_1database_html_adc8f336b33d7013d1b0400399b16c5a7"><div class="ttname"><a href="classchainbase_1_1database.html#adc8f336b33d7013d1b0400399b16c5a7">chainbase::database::create</a></div><div class="ttdeci">const ObjectType &amp; create(Constructor &amp;&amp;con)</div><div class="ttdef"><b>Definition</b> <a href="chainbase_8hpp_source.html#l00519">chainbase.hpp:519</a></div></div>
<div class="ttc" id="aclassfc_1_1actor_html"><div class="ttname"><a href="classfc_1_1actor.html">fc::actor</a></div><div class="ttdef"><b>Definition</b> <a href="actor_8hpp_source.html#l00053">actor.hpp:53</a></div></div>
<div class="ttc" id="aclassfc_1_1microseconds_html"><div class="ttname"><a href="classfc_1_1microseconds.html">fc::microseconds</a></div><div class="ttdef"><b>Definition</b> <a href="include_2fc_2time_8hpp_source.html#l00011">time.hpp:11</a></div></div>
<div class="ttc" id="aclassfc_1_1microseconds_html_afc3eb0bfd792c7b1cda062e559e30c2e"><div class="ttname"><a href="classfc_1_1microseconds.html#afc3eb0bfd792c7b1cda062e559e30c2e">fc::microseconds::maximum</a></div><div class="ttdeci">static constexpr microseconds maximum()</div><div class="ttdef"><b>Definition</b> <a href="include_2fc_2time_8hpp_source.html#l00014">time.hpp:14</a></div></div>
<div class="ttc" id="aclassfc_1_1time__point__sec_html"><div class="ttname"><a href="classfc_1_1time__point__sec.html">fc::time_point_sec</a></div><div class="ttdef"><b>Definition</b> <a href="include_2fc_2time_8hpp_source.html#l00072">time.hpp:73</a></div></div>
<div class="ttc" id="aclassfc_1_1time__point__sec_html_ab537213a0f1caf331b0c43cee6297b3f"><div class="ttname"><a href="classfc_1_1time__point__sec.html#ab537213a0f1caf331b0c43cee6297b3f">fc::time_point_sec::sec_since_epoch</a></div><div class="ttdeci">constexpr uint32_t sec_since_epoch() const</div><div class="ttdef"><b>Definition</b> <a href="include_2fc_2time_8hpp_source.html#l00088">time.hpp:88</a></div></div>
<div class="ttc" id="aclassfc_1_1time__point_html"><div class="ttname"><a href="classfc_1_1time__point.html">fc::time_point</a></div><div class="ttdef"><b>Definition</b> <a href="include_2fc_2time_8hpp_source.html#l00042">time.hpp:42</a></div></div>
<div class="ttc" id="aclassfc_1_1time__point_html_aa164ff1268a16d4b32afcff181f6100e"><div class="ttname"><a href="classfc_1_1time__point.html#aa164ff1268a16d4b32afcff181f6100e">fc::time_point::now</a></div><div class="ttdeci">static time_point now()</div><div class="ttdef"><b>Definition</b> <a href="time_8cpp_source.html#l00014">time.cpp:14</a></div></div>
<div class="ttc" id="aclassfc_1_1time__point_html_aeccf1b70aa34b132c5269313b8a50573"><div class="ttname"><a href="classfc_1_1time__point.html#aeccf1b70aa34b132c5269313b8a50573">fc::time_point::maximum</a></div><div class="ttdeci">static constexpr time_point maximum()</div><div class="ttdef"><b>Definition</b> <a href="include_2fc_2time_8hpp_source.html#l00046">time.hpp:46</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1account__object_html"><div class="ttname"><a href="classsysio_1_1chain_1_1account__object.html">sysio::chain::account_object</a></div><div class="ttdef"><b>Definition</b> <a href="account__object_8hpp_source.html#l00012">account_object.hpp:12</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html">sysio::chain::controller</a></div><div class="ttdef"><b>Definition</b> <a href="controller_8hpp_source.html#l00063">controller.hpp:63</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a0bb11e832a05b6437c79bf81758b1b7d"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a0bb11e832a05b6437c79bf81758b1b7d">sysio::chain::controller::get_global_properties</a></div><div class="ttdeci">const global_property_object &amp; get_global_properties() const</div><div class="ttdef"><b>Definition</b> <a href="controller_8cpp_source.html#l03062">controller.cpp:3062</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a0c79d00dae8c0d90efc18f4d091b2391"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a0c79d00dae8c0d90efc18f4d091b2391">sysio::chain::controller::db</a></div><div class="ttdeci">const chainbase::database &amp; db() const</div><div class="ttdef"><b>Definition</b> <a href="controller_8cpp_source.html#l02646">controller.cpp:2646</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a0fcc85a590581560765686050fe105a8"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a0fcc85a590581560765686050fe105a8">sysio::chain::controller::is_producing_block</a></div><div class="ttdeci">bool is_producing_block() const</div><div class="ttdef"><b>Definition</b> <a href="controller_8cpp_source.html#l03332">controller.cpp:3332</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a33704b4936bb9bbd2ea6b0874ca521b4"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a33704b4936bb9bbd2ea6b0874ca521b4">sysio::chain::controller::head_block_num</a></div><div class="ttdeci">uint32_t head_block_num() const</div><div class="ttdef"><b>Definition</b> <a href="controller_8cpp_source.html#l02949">controller.cpp:2949</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a3c9f983e8d4aba41afbb0a473feca18f"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a3c9f983e8d4aba41afbb0a473feca18f">sysio::chain::controller::validate_expiration</a></div><div class="ttdeci">void validate_expiration(const transaction &amp;t) const</div><div class="ttdef"><b>Definition</b> <a href="controller_8cpp_source.html#l03346">controller.cpp:3346</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a4c7e83b4e4c21205b0fb9b2e4b7fb227"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a4c7e83b4e4c21205b0fb9b2e4b7fb227">sysio::chain::controller::get_mutable_authorization_manager</a></div><div class="ttdeci">authorization_manager &amp; get_mutable_authorization_manager()</div><div class="ttdef"><b>Definition</b> <a href="controller_8cpp_source.html#l02595">controller.cpp:2595</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a4f6404b355a3a4bf7fb60c92e85443d1"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a4f6404b355a3a4bf7fb60c92e85443d1">sysio::chain::controller::get_deep_mind_logger</a></div><div class="ttdeci">deep_mind_handler * get_deep_mind_logger() const</div><div class="ttdef"><b>Definition</b> <a href="controller_8cpp_source.html#l03460">controller.cpp:3460</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a8ad92bdf81057887fdc4b732cb864bc4"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a8ad92bdf81057887fdc4b732cb864bc4">sysio::chain::controller::pending_producer_block_id</a></div><div class="ttdeci">std::optional&lt; block_id_type &gt; pending_producer_block_id() const</div><div class="ttdef"><b>Definition</b> <a href="controller_8cpp_source.html#l03036">controller.cpp:3036</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a8f7456b81f2657ccf6c39b35afb16af4"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a8f7456b81f2657ccf6c39b35afb16af4">sysio::chain::controller::get_authorization_manager</a></div><div class="ttdeci">const authorization_manager &amp; get_authorization_manager() const</div><div class="ttdef"><b>Definition</b> <a href="controller_8cpp_source.html#l02591">controller.cpp:2591</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a92e84ef71388fa365bcf17a4fbcce047"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a92e84ef71388fa365bcf17a4fbcce047">sysio::chain::controller::validate_tapos</a></div><div class="ttdeci">void validate_tapos(const transaction &amp;t) const</div><div class="ttdef"><b>Definition</b> <a href="controller_8cpp_source.html#l03362">controller.cpp:3362</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a9d7c53697f9d587b6f2e583af9f7e712"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a9d7c53697f9d587b6f2e583af9f7e712">sysio::chain::controller::get_greylist_limit</a></div><div class="ttdeci">uint32_t get_greylist_limit() const</div><div class="ttdef"><b>Definition</b> <a href="controller_8cpp_source.html#l03417">controller.cpp:3417</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_aa1c6dcfae09e0e0ea50ba3fda8915114"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#aa1c6dcfae09e0e0ea50ba3fda8915114">sysio::chain::controller::is_resource_greylisted</a></div><div class="ttdeci">bool is_resource_greylisted(const account_name &amp;name) const</div><div class="ttdef"><b>Definition</b> <a href="controller_8cpp_source.html#l03429">controller.cpp:3429</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_aa378f4265708c1bc41e4ee058ed71e6a"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#aa378f4265708c1bc41e4ee058ed71e6a">sysio::chain::controller::check_actor_list</a></div><div class="ttdeci">void check_actor_list(const flat_set&lt; account_name &gt; &amp;actors) const</div><div class="ttdef"><b>Definition</b> <a href="controller_8cpp_source.html#l03312">controller.cpp:3312</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_abb1d81f96986df3bce46bd37caaf6a69"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#abb1d81f96986df3bce46bd37caaf6a69">sysio::chain::controller::pending_block_time</a></div><div class="ttdeci">time_point pending_block_time() const</div><div class="ttdef"><b>Definition</b> <a href="controller_8cpp_source.html#l03000">controller.cpp:3000</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_ac8eea0639eeef0fc0d304f645b80d884"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#ac8eea0639eeef0fc0d304f645b80d884">sysio::chain::controller::skip_db_sessions</a></div><div class="ttdeci">bool skip_db_sessions() const</div><div class="ttdef"><b>Definition</b> <a href="controller_8cpp_source.html#l03253">controller.cpp:3253</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_add2453cf4d0208ca9f277337c9a5ed7a"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#add2453cf4d0208ca9f277337c9a5ed7a">sysio::chain::controller::get_mutable_resource_limits_manager</a></div><div class="ttdeci">resource_limits_manager &amp; get_mutable_resource_limits_manager()</div><div class="ttdef"><b>Definition</b> <a href="controller_8cpp_source.html#l02586">controller.cpp:2586</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_afc8b0aff5d6f215c336a682c83badf6e"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#afc8b0aff5d6f215c336a682c83badf6e">sysio::chain::controller::skip_trx_checks</a></div><div class="ttdeci">bool skip_trx_checks() const</div><div class="ttdef"><b>Definition</b> <a href="controller_8cpp_source.html#l03242">controller.cpp:3242</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1deep__mind__handler_html_a78bf0c79493a90c71cb28aa761f44fd2a21a361d96e3e13f5f109748c2a9d2434"><div class="ttname"><a href="classsysio_1_1chain_1_1deep__mind__handler.html#a78bf0c79493a90c71cb28aa761f44fd2a21a361d96e3e13f5f109748c2a9d2434">sysio::chain::deep_mind_handler::operation_qualifier::push</a></div><div class="ttdeci">@ push</div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1global__property__object_html_a7f149fcf87034217c899838eb4430496"><div class="ttname"><a href="classsysio_1_1chain_1_1global__property__object.html#a7f149fcf87034217c899838eb4430496">sysio::chain::global_property_object::configuration</a></div><div class="ttdeci">chain_config configuration</div><div class="ttdef"><b>Definition</b> <a href="global__property__object_8hpp_source.html#l00071">global_property_object.hpp:71</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1resource__limits_1_1resource__limits__manager_html_a7fea1de6a3806590de0bda86e53c7995"><div class="ttname"><a href="classsysio_1_1chain_1_1resource__limits_1_1resource__limits__manager.html#a7fea1de6a3806590de0bda86e53c7995">sysio::chain::resource_limits::resource_limits_manager::add_pending_ram_usage</a></div><div class="ttdeci">void add_pending_ram_usage(const account_name account, int64_t ram_delta)</div><div class="ttdef"><b>Definition</b> <a href="resource__limits_8cpp_source.html#l00206">resource_limits.cpp:206</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1transaction__context_html_a01f9fd71b2b5511311c8817a8b32c845"><div class="ttname"><a href="classsysio_1_1chain_1_1transaction__context.html#a01f9fd71b2b5511311c8817a8b32c845">sysio::chain::transaction_context::exec</a></div><div class="ttdeci">void exec()</div><div class="ttdef"><b>Definition</b> <a href="#l00313">transaction_context.cpp:313</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1transaction__context_html_a03f76febe2160f0f23a5f60dae262184"><div class="ttname"><a href="classsysio_1_1chain_1_1transaction__context.html#a03f76febe2160f0f23a5f60dae262184">sysio::chain::transaction_context::init_for_deferred_trx</a></div><div class="ttdeci">void init_for_deferred_trx(fc::time_point published)</div><div class="ttdef"><b>Definition</b> <a href="#l00296">transaction_context.cpp:296</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1transaction__context_html_a05dbab6e9e0d4f3e30fa1392ac4430a1"><div class="ttname"><a href="classsysio_1_1chain_1_1transaction__context.html#a05dbab6e9e0d4f3e30fa1392ac4430a1">sysio::chain::transaction_context::explicit_billed_cpu_time</a></div><div class="ttdeci">bool explicit_billed_cpu_time</div><div class="ttdef"><b>Definition</b> <a href="transaction__context_8hpp_source.html#l00147">transaction_context.hpp:147</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1transaction__context_html_a08b550fccea696363035c6736c146436"><div class="ttname"><a href="classsysio_1_1chain_1_1transaction__context.html#a08b550fccea696363035c6736c146436">sysio::chain::transaction_context::billed_cpu_time_us</a></div><div class="ttdeci">int64_t billed_cpu_time_us</div><div class="ttdef"><b>Definition</b> <a href="transaction__context_8hpp_source.html#l00145">transaction_context.hpp:145</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1transaction__context_html_a08e9cf6a4b8ce2f6211ce9d8de1b4da3"><div class="ttname"><a href="classsysio_1_1chain_1_1transaction__context.html#a08e9cf6a4b8ce2f6211ce9d8de1b4da3">sysio::chain::transaction_context::packed_trx</a></div><div class="ttdeci">const packed_transaction &amp; packed_trx</div><div class="ttdef"><b>Definition</b> <a href="transaction__context_8hpp_source.html#l00123">transaction_context.hpp:123</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1transaction__context_html_a26ad1d103e9f47c69dce0a8a85f76039"><div class="ttname"><a href="classsysio_1_1chain_1_1transaction__context.html#a26ad1d103e9f47c69dce0a8a85f76039">sysio::chain::transaction_context::pause_billing_timer</a></div><div class="ttdeci">void pause_billing_timer()</div><div class="ttdef"><b>Definition</b> <a href="#l00455">transaction_context.cpp:455</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1transaction__context_html_a2f8dc57cb2e3562de132326b0d06e15d"><div class="ttname"><a href="classsysio_1_1chain_1_1transaction__context.html#a2f8dc57cb2e3562de132326b0d06e15d">sysio::chain::transaction_context::update_billed_cpu_time</a></div><div class="ttdeci">uint32_t update_billed_cpu_time(fc::time_point now)</div><div class="ttdef"><b>Definition</b> <a href="#l00565">transaction_context.cpp:565</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1transaction__context_html_a300b3d2c25e7de11562c579c41f43dda"><div class="ttname"><a href="classsysio_1_1chain_1_1transaction__context.html#a300b3d2c25e7de11562c579c41f43dda">sysio::chain::transaction_context::finalize</a></div><div class="ttdeci">void finalize()</div><div class="ttdef"><b>Definition</b> <a href="#l00340">transaction_context.cpp:340</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1transaction__context_html_a346ee8df9ed43ccebf9ec1455facfc8d"><div class="ttname"><a href="classsysio_1_1chain_1_1transaction__context.html#a346ee8df9ed43ccebf9ec1455facfc8d">sysio::chain::transaction_context::transaction_timer</a></div><div class="ttdeci">transaction_checktime_timer transaction_timer</div><div class="ttdef"><b>Definition</b> <a href="transaction__context_8hpp_source.html#l00149">transaction_context.hpp:149</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1transaction__context_html_a558e8aff8e48deb61fae7407e10e8788"><div class="ttname"><a href="classsysio_1_1chain_1_1transaction__context.html#a558e8aff8e48deb61fae7407e10e8788">sysio::chain::transaction_context::squash</a></div><div class="ttdeci">void squash()</div><div class="ttdef"><b>Definition</b> <a href="#l00396">transaction_context.cpp:396</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1transaction__context_html_a5631f6c990c61c078e0de6f0e53171be"><div class="ttname"><a href="classsysio_1_1chain_1_1transaction__context.html#a5631f6c990c61c078e0de6f0e53171be">sysio::chain::transaction_context::undo</a></div><div class="ttdeci">void undo()</div><div class="ttdef"><b>Definition</b> <a href="#l00400">transaction_context.cpp:400</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1transaction__context_html_a5bcfb17b8688258f7287ad7c99567fad"><div class="ttname"><a href="classsysio_1_1chain_1_1transaction__context.html#a5bcfb17b8688258f7287ad7c99567fad">sysio::chain::transaction_context::validate_ram_usage</a></div><div class="ttdeci">flat_set&lt; account_name &gt; validate_ram_usage</div><div class="ttdef"><b>Definition</b> <a href="transaction__context_8hpp_source.html#l00133">transaction_context.hpp:133</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1transaction__context_html_a5ca7a519fb084bc4ad8c692a81f69277"><div class="ttname"><a href="classsysio_1_1chain_1_1transaction__context.html#a5ca7a519fb084bc4ad8c692a81f69277">sysio::chain::transaction_context::resume_billing_timer</a></div><div class="ttdeci">void resume_billing_timer()</div><div class="ttdef"><b>Definition</b> <a href="#l00464">transaction_context.cpp:464</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1transaction__context_html_a5d3d1260b6f77fdc4b6a8cef3417e94c"><div class="ttname"><a href="classsysio_1_1chain_1_1transaction__context.html#a5d3d1260b6f77fdc4b6a8cef3417e94c">sysio::chain::transaction_context::init_for_implicit_trx</a></div><div class="ttdeci">void init_for_implicit_trx(uint64_t initial_net_usage=0)</div><div class="ttdef"><b>Definition</b> <a href="#l00244">transaction_context.cpp:244</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1transaction__context_html_a62b3defb107a356551a01d2c78e80b4b"><div class="ttname"><a href="classsysio_1_1chain_1_1transaction__context.html#a62b3defb107a356551a01d2c78e80b4b">sysio::chain::transaction_context::add_net_usage</a></div><div class="ttdeci">void add_net_usage(uint64_t u)</div><div class="ttdef"><b>Definition</b> <a href="transaction__context_8hpp_source.html#l00057">transaction_context.hpp:57</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1transaction__context_html_a642c586e04091f30df003a71847f35f3"><div class="ttname"><a href="classsysio_1_1chain_1_1transaction__context.html#a642c586e04091f30df003a71847f35f3">sysio::chain::transaction_context::transaction_context</a></div><div class="ttdeci">transaction_context(controller &amp;c, const packed_transaction &amp;t, transaction_checktime_timer &amp;&amp;timer, fc::time_point start=fc::time_point::now(), bool read_only=false)</div><div class="ttdef"><b>Definition</b> <a href="#l00047">transaction_context.cpp:47</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1transaction__context_html_a708229aea669816e99b0039d716c3ed5"><div class="ttname"><a href="classsysio_1_1chain_1_1transaction__context.html#a708229aea669816e99b0039d716c3ed5">sysio::chain::transaction_context::block_deadline</a></div><div class="ttdeci">fc::time_point block_deadline</div><div class="ttdef"><b>Definition</b> <a href="transaction__context_8hpp_source.html#l00143">transaction_context.hpp:143</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1transaction__context_html_a7211fab425e4375e247c2a3d1924e63f"><div class="ttname"><a href="classsysio_1_1chain_1_1transaction__context.html#a7211fab425e4375e247c2a3d1924e63f">sysio::chain::transaction_context::trace</a></div><div class="ttdeci">transaction_trace_ptr trace</div><div class="ttdef"><b>Definition</b> <a href="transaction__context_8hpp_source.html#l00125">transaction_context.hpp:125</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1transaction__context_html_a73f4035fab7271fec7fcac5aa01bd461"><div class="ttname"><a href="classsysio_1_1chain_1_1transaction__context.html#a73f4035fab7271fec7fcac5aa01bd461">sysio::chain::transaction_context::delay</a></div><div class="ttdeci">fc::microseconds delay</div><div class="ttdef"><b>Definition</b> <a href="transaction__context_8hpp_source.html#l00138">transaction_context.hpp:138</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1transaction__context_html_a799e9208ec6d2ea3d1dfccfd4eb97cec"><div class="ttname"><a href="classsysio_1_1chain_1_1transaction__context.html#a799e9208ec6d2ea3d1dfccfd4eb97cec">sysio::chain::transaction_context::enforce_whiteblacklist</a></div><div class="ttdeci">bool enforce_whiteblacklist</div><div class="ttdef"><b>Definition</b> <a href="transaction__context_8hpp_source.html#l00141">transaction_context.hpp:141</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1transaction__context_html_a7b669aea7e7e49e2cd5f5eff2e8ca927"><div class="ttname"><a href="classsysio_1_1chain_1_1transaction__context.html#a7b669aea7e7e49e2cd5f5eff2e8ca927">sysio::chain::transaction_context::apply_context</a></div><div class="ttdeci">friend class apply_context</div><div class="ttdef"><b>Definition</b> <a href="transaction__context_8hpp_source.html#l00089">transaction_context.hpp:89</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1transaction__context_html_a7ecbfbb3d05a6a0b128feeb0a469878c"><div class="ttname"><a href="classsysio_1_1chain_1_1transaction__context.html#a7ecbfbb3d05a6a0b128feeb0a469878c">sysio::chain::transaction_context::validate_referenced_accounts</a></div><div class="ttdeci">void validate_referenced_accounts(const transaction &amp;trx, bool enforce_actor_whitelist_blacklist) const</div><div class="ttdoc">record_transaction</div><div class="ttdef"><b>Definition</b> <a href="#l00739">transaction_context.cpp:739</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1transaction__context_html_a8cb5a958083512d7ff0bff751db87dd9"><div class="ttname"><a href="classsysio_1_1chain_1_1transaction__context.html#a8cb5a958083512d7ff0bff751db87dd9">sysio::chain::transaction_context::apply_context_free</a></div><div class="ttdeci">bool apply_context_free</div><div class="ttdef"><b>Definition</b> <a href="transaction__context_8hpp_source.html#l00140">transaction_context.hpp:140</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1transaction__context_html_a90144b543cf9fd4e5ed08fc2a4cd75ff"><div class="ttname"><a href="classsysio_1_1chain_1_1transaction__context.html#a90144b543cf9fd4e5ed08fc2a4cd75ff">sysio::chain::transaction_context::undo_session</a></div><div class="ttdeci">std::optional&lt; chainbase::database::session &gt; undo_session</div><div class="ttdef"><b>Definition</b> <a href="transaction__context_8hpp_source.html#l00124">transaction_context.hpp:124</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1transaction__context_html_a9c12181bd0bd8a5aea0200c80e7b00e7"><div class="ttname"><a href="classsysio_1_1chain_1_1transaction__context.html#a9c12181bd0bd8a5aea0200c80e7b00e7">sysio::chain::transaction_context::start</a></div><div class="ttdeci">fc::time_point start</div><div class="ttdef"><b>Definition</b> <a href="transaction__context_8hpp_source.html#l00126">transaction_context.hpp:126</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1transaction__context_html_ab8e1aaec319ed2ae90b6a6f499919c89"><div class="ttname"><a href="classsysio_1_1chain_1_1transaction__context.html#ab8e1aaec319ed2ae90b6a6f499919c89">sysio::chain::transaction_context::published</a></div><div class="ttdeci">fc::time_point published</div><div class="ttdef"><b>Definition</b> <a href="transaction__context_8hpp_source.html#l00128">transaction_context.hpp:128</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1transaction__context_html_ac178b3a7e2ef905025ae4e2f262422ff"><div class="ttname"><a href="classsysio_1_1chain_1_1transaction__context.html#ac178b3a7e2ef905025ae4e2f262422ff">sysio::chain::transaction_context::bill_to_accounts</a></div><div class="ttdeci">flat_set&lt; account_name &gt; bill_to_accounts</div><div class="ttdef"><b>Definition</b> <a href="transaction__context_8hpp_source.html#l00132">transaction_context.hpp:132</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1transaction__context_html_ac2563020d92f69f6fe9a0b878f5a86f3"><div class="ttname"><a href="classsysio_1_1chain_1_1transaction__context.html#ac2563020d92f69f6fe9a0b878f5a86f3">sysio::chain::transaction_context::check_net_usage</a></div><div class="ttdeci">void check_net_usage() const</div><div class="ttdef"><b>Definition</b> <a href="#l00404">transaction_context.cpp:404</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1transaction__context_html_ac47cac1e2ac5625a8589686503dd1261"><div class="ttname"><a href="classsysio_1_1chain_1_1transaction__context.html#ac47cac1e2ac5625a8589686503dd1261">sysio::chain::transaction_context::checktime</a></div><div class="ttdeci">void checktime() const</div><div class="ttdef"><b>Definition</b> <a href="#l00424">transaction_context.cpp:424</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1transaction__context_html_acd4137f1354209bb1237e5a1f26fdbcd"><div class="ttname"><a href="classsysio_1_1chain_1_1transaction__context.html#acd4137f1354209bb1237e5a1f26fdbcd">sysio::chain::transaction_context::is_read_only</a></div><div class="ttdeci">const bool is_read_only</div><div class="ttdef"><b>Definition</b> <a href="transaction__context_8hpp_source.html#l00151">transaction_context.hpp:151</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1transaction__context_html_ad22e57171587ed29b371184a7be4529a"><div class="ttname"><a href="classsysio_1_1chain_1_1transaction__context.html#ad22e57171587ed29b371184a7be4529a">sysio::chain::transaction_context::is_input</a></div><div class="ttdeci">bool is_input</div><div class="ttdef"><b>Definition</b> <a href="transaction__context_8hpp_source.html#l00139">transaction_context.hpp:139</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1transaction__context_html_ad525fafe1ffad93dc767bf2b5b9ea0cc"><div class="ttname"><a href="classsysio_1_1chain_1_1transaction__context.html#ad525fafe1ffad93dc767bf2b5b9ea0cc">sysio::chain::transaction_context::max_bandwidth_billed_accounts_can_pay</a></div><div class="ttdeci">std::tuple&lt; int64_t, int64_t, bool, bool &gt; max_bandwidth_billed_accounts_can_pay(bool force_elastic_limits=false) const</div><div class="ttdef"><b>Definition</b> <a href="#l00574">transaction_context.cpp:574</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1transaction__context_html_adbf0d6f8a8a8d3b4544fafe24cd0a135"><div class="ttname"><a href="classsysio_1_1chain_1_1transaction__context.html#adbf0d6f8a8a8d3b4544fafe24cd0a135">sysio::chain::transaction_context::init_for_input_trx</a></div><div class="ttdeci">void init_for_input_trx(uint64_t packed_trx_unprunable_size, uint64_t packed_trx_prunable_size)</div><div class="ttdef"><b>Definition</b> <a href="#l00255">transaction_context.cpp:255</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1transaction__context_html_ae449b02626b4cd23a0aeb8b091f582ab"><div class="ttname"><a href="classsysio_1_1chain_1_1transaction__context.html#ae449b02626b4cd23a0aeb8b091f582ab">sysio::chain::transaction_context::~transaction_context</a></div><div class="ttdeci">~transaction_context()</div><div class="ttdef"><b>Definition</b> <a href="#l00076">transaction_context.cpp:76</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1transaction__context_html_af52efad2c5859002ad3bedad5834cb7f"><div class="ttname"><a href="classsysio_1_1chain_1_1transaction__context.html#af52efad2c5859002ad3bedad5834cb7f">sysio::chain::transaction_context::control</a></div><div class="ttdeci">controller &amp; control</div><div class="ttdoc">Fields:</div><div class="ttdef"><b>Definition</b> <a href="transaction__context_8hpp_source.html#l00122">transaction_context.hpp:122</a></div></div>
<div class="ttc" id="acode__cache_8cpp_html_aa0efefe21f4700d78692edc823e763be"><div class="ttname"><a href="code__cache_8cpp.html#aa0efefe21f4700d78692edc823e763be">id</a></div><div class="ttdeci">uint64_t id</div><div class="ttdef"><b>Definition</b> <a href="code__cache_8cpp_source.html#l00000">code_cache.cpp:0</a></div></div>
<div class="ttc" id="adeep__mind_8hpp_html"><div class="ttname"><a href="deep__mind_8hpp.html">deep_mind.hpp</a></div></div>
<div class="ttc" id="adeep__mind_8hpp_html_aaaa2f1dbd522de03ccbaa73f01db5f50"><div class="ttname"><a href="deep__mind_8hpp.html#aaaa2f1dbd522de03ccbaa73f01db5f50">RAM_EVENT_ID</a></div><div class="ttdeci">#define RAM_EVENT_ID(FORMAT,...)</div><div class="ttdef"><b>Definition</b> <a href="deep__mind_8hpp_source.html#l00027">deep_mind.hpp:27</a></div></div>
<div class="ttc" id="agenerated__transaction__object_8hpp_html"><div class="ttname"><a href="generated__transaction__object_8hpp.html">generated_transaction_object.hpp</a></div></div>
<div class="ttc" id="aglobal__property__object_8hpp_html"><div class="ttname"><a href="global__property__object_8hpp.html">global_property_object.hpp</a></div></div>
<div class="ttc" id="agmock__stress__test_8cc_html_afd9db40e3361ae09188795e8cbe19752"><div class="ttname"><a href="gmock__stress__test_8cc.html#afd9db40e3361ae09188795e8cbe19752">count</a></div><div class="ttdeci">int * count</div><div class="ttdef"><b>Definition</b> <a href="gmock__stress__test_8cc_source.html#l00177">gmock_stress_test.cc:177</a></div></div>
<div class="ttc" id="alib_8h_html_a02fd73d861ef2e4aabb38c0c9ff82947"><div class="ttname"><a href="lib_8h.html#a02fd73d861ef2e4aabb38c0c9ff82947">init</a></div><div class="ttdeci">void init()</div><div class="ttdef"><b>Definition</b> <a href="lib__test_8cpp_source.html#l00003">lib_test.cpp:3</a></div></div>
<div class="ttc" id="anamespacefc_html_a3d8a2be677709cc41f09aa7925f2d55fad6bcd1364809e1b881bb22334d14cd56"><div class="ttname"><a href="namespacefc.html#a3d8a2be677709cc41f09aa7925f2d55fad6bcd1364809e1b881bb22334d14cd56">fc::read_only</a></div><div class="ttdeci">@ read_only</div><div class="ttdef"><b>Definition</b> <a href="file__mapping_8hpp_source.html#l00013">file_mapping.hpp:13</a></div></div>
<div class="ttc" id="anamespacefc_html_a6e85a2de1275728bcc4a3d01f14d9172"><div class="ttname"><a href="namespacefc.html#a6e85a2de1275728bcc4a3d01f14d9172">fc::hours</a></div><div class="ttdeci">constexpr microseconds hours(int64_t h)</div><div class="ttdef"><b>Definition</b> <a href="include_2fc_2time_8hpp_source.html#l00035">time.hpp:35</a></div></div>
<div class="ttc" id="anamespacefc_html_a76ae235ec7e9b8862e70740058d7eb1b"><div class="ttname"><a href="namespacefc.html#a76ae235ec7e9b8862e70740058d7eb1b">fc::milliseconds</a></div><div class="ttdeci">constexpr microseconds milliseconds(int64_t s)</div><div class="ttdef"><b>Definition</b> <a href="include_2fc_2time_8hpp_source.html#l00033">time.hpp:33</a></div></div>
<div class="ttc" id="anamespacefc_html_a9623b8cae3f48bbed6aa1fc2afe9b174"><div class="ttname"><a href="namespacefc.html#a9623b8cae3f48bbed6aa1fc2afe9b174">fc::seconds</a></div><div class="ttdeci">constexpr microseconds seconds(int64_t s)</div><div class="ttdef"><b>Definition</b> <a href="include_2fc_2time_8hpp_source.html#l00032">time.hpp:32</a></div></div>
<div class="ttc" id="anamespacestd_html"><div class="ttname"><a href="namespacestd.html">std</a></div><div class="ttdef"><b>Definition</b> <a href="name_8hpp_source.html#l00106">name.hpp:106</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_1_1config_html_a2772c77657b1f6fda680bbe8f7282d13"><div class="ttname"><a href="namespacesysio_1_1chain_1_1config.html#a2772c77657b1f6fda680bbe8f7282d13">sysio::chain::config::billable_size_v</a></div><div class="ttdeci">constexpr uint64_t billable_size_v</div><div class="ttdef"><b>Definition</b> <a href="chain_2include_2sysio_2chain_2config_8hpp_source.html#l00147">config.hpp:147</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_a5dfe17906469eaf079c180c1afb4ad94"><div class="ttname"><a href="namespacesysio_1_1chain.html#a5dfe17906469eaf079c180c1afb4ad94">sysio::chain::transaction_exception</a></div><div class="ttdeci">key Invalid authority Invalid transaction Invalid block ID Invalid packed transaction Invalid chain ID Invalid symbol Signature type is not a currently activated type Block can not be found Unlinkable block Block does not guarantee concurrent execution without conflicts Block exhausted allowed resources Block is from the future Block is not signed by expected producer Block includes an ill formed protocol feature activation extension Block includes an ill formed additional block signature extension transaction_exception</div><div class="ttdef"><b>Definition</b> <a href="chain_2include_2sysio_2chain_2exceptions_8hpp_source.html#l00243">exceptions.hpp:243</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_aa85a3b49b3b219d1e3840567579e7e63"><div class="ttname"><a href="namespacesysio_1_1chain.html#aa85a3b49b3b219d1e3840567579e7e63">sysio::chain::transaction_id_type</a></div><div class="ttdeci">checksum_type transaction_id_type</div><div class="ttdef"><b>Definition</b> <a href="chain_2include_2sysio_2chain_2types_8hpp_source.html#l00236">types.hpp:236</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_aae2c9fe44a33a7568fb2b6a709112b9f"><div class="ttname"><a href="namespacesysio_1_1chain.html#aae2c9fe44a33a7568fb2b6a709112b9f">sysio::chain::transaction_id_to_sender_id</a></div><div class="ttdeci">uint128_t transaction_id_to_sender_id(const transaction_id_type &amp;tid)</div><div class="ttdef"><b>Definition</b> <a href="sysio__contract_8cpp_source.html#l00028">sysio_contract.cpp:28</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_ac32ce8e75243f2b3f76aff0c1984f11b"><div class="ttname"><a href="namespacesysio_1_1chain.html#ac32ce8e75243f2b3f76aff0c1984f11b">sysio::chain::account_name</a></div><div class="ttdeci">name account_name</div><div class="ttdef"><b>Definition</b> <a href="chain_2include_2sysio_2chain_2types_8hpp_source.html#l00120">types.hpp:120</a></div></div>
<div class="ttc" id="anamespacesysio_html"><div class="ttname"><a href="namespacesysio.html">sysio</a></div><div class="ttdef"><b>Definition</b> <a href="abi__serializer_8cpp_source.html#l00008">abi_serializer.cpp:8</a></div></div>
<div class="ttc" id="apointer_8h_html_aeeddce917cf130d62c370b8f216026dd"><div class="ttname"><a href="pointer_8h.html#aeeddce917cf130d62c370b8f216026dd">a</a></div><div class="ttdeci">const GenericPointer&lt; typename T::ValueType &gt; T2 T::AllocatorType &amp; a</div><div class="ttdef"><b>Definition</b> <a href="pointer_8h_source.html#l01181">pointer.h:1181</a></div></div>
<div class="ttc" id="aresource__limits_8hpp_html"><div class="ttname"><a href="resource__limits_8hpp.html">resource_limits.hpp</a></div></div>
<div class="ttc" id="astdint_8h_html_a414156feea104f8f75b4ed9e3121b2f6"><div class="ttname"><a href="stdint_8h.html#a414156feea104f8f75b4ed9e3121b2f6">int64_t</a></div><div class="ttdeci">signed __int64 int64_t</div><div class="ttdef"><b>Definition</b> <a href="stdint_8h_source.html#l00135">stdint.h:135</a></div></div>
<div class="ttc" id="astdint_8h_html_a435d1572bf3f880d55459d9805097f62"><div class="ttname"><a href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a></div><div class="ttdeci">unsigned int uint32_t</div><div class="ttdef"><b>Definition</b> <a href="stdint_8h_source.html#l00126">stdint.h:126</a></div></div>
<div class="ttc" id="astdint_8h_html_aec6fcb673ff035718c238c8c9d544c47"><div class="ttname"><a href="stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a></div><div class="ttdeci">unsigned __int64 uint64_t</div><div class="ttdef"><b>Definition</b> <a href="stdint_8h_source.html#l00136">stdint.h:136</a></div></div>
<div class="ttc" id="astructaction_html"><div class="ttname"><a href="structaction.html">action</a></div><div class="ttdef"><b>Definition</b> <a href="broadcast__server_8cpp_source.html#l00037">broadcast_server.cpp:37</a></div></div>
<div class="ttc" id="astructfc_1_1unsigned__int_html_ac54ac972d3e38a5852616aaee955ff3f"><div class="ttname"><a href="structfc_1_1unsigned__int.html#ac54ac972d3e38a5852616aaee955ff3f">fc::unsigned_int::value</a></div><div class="ttdeci">uint32_t value</div><div class="ttdef"><b>Definition</b> <a href="varint_8hpp_source.html#l00017">varint.hpp:17</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1action__trace_html"><div class="ttname"><a href="structsysio_1_1chain_1_1action__trace.html">sysio::chain::action_trace</a></div><div class="ttdef"><b>Definition</b> <a href="libraries_2chain_2include_2sysio_2chain_2trace_8hpp_source.html#l00022">trace.hpp:22</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1action__trace_html_a2aa19858e0762797685b9ec46e820656"><div class="ttname"><a href="structsysio_1_1chain_1_1action__trace.html#a2aa19858e0762797685b9ec46e820656">sysio::chain::action_trace::act</a></div><div class="ttdeci">action act</div><div class="ttdef"><b>Definition</b> <a href="libraries_2chain_2include_2sysio_2chain_2trace_8hpp_source.html#l00036">trace.hpp:36</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1chain__config__v0_html_a6ab303c6326dc33d1280e0b8d13eed68"><div class="ttname"><a href="structsysio_1_1chain_1_1chain__config__v0.html#a6ab303c6326dc33d1280e0b8d13eed68">sysio::chain::chain_config_v0::deferred_trx_expiration_window</a></div><div class="ttdeci">uint32_t deferred_trx_expiration_window</div><div class="ttdoc">the number of seconds after the time a deferred transaction can first execute until it expires</div><div class="ttdef"><b>Definition</b> <a href="chain__config_8hpp_source.html#l00054">chain_config.hpp:54</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1packed__transaction_html"><div class="ttname"><a href="structsysio_1_1chain_1_1packed__transaction.html">sysio::chain::packed_transaction</a></div><div class="ttdef"><b>Definition</b> <a href="transaction_8hpp_source.html#l00136">transaction.hpp:136</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1packed__transaction_html_acc706e72aa422ee3e3c02f73871609cb"><div class="ttname"><a href="structsysio_1_1chain_1_1packed__transaction.html#acc706e72aa422ee3e3c02f73871609cb">sysio::chain::packed_transaction::id</a></div><div class="ttdeci">const transaction_id_type &amp; id() const</div><div class="ttdef"><b>Definition</b> <a href="transaction_8hpp_source.html#l00179">transaction.hpp:179</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1packed__transaction_html_ad193d26eb97cfd5b3f7d8b957eaa35a2"><div class="ttname"><a href="structsysio_1_1chain_1_1packed__transaction.html#ad193d26eb97cfd5b3f7d8b957eaa35a2">sysio::chain::packed_transaction::get_transaction</a></div><div class="ttdeci">const transaction &amp; get_transaction() const</div><div class="ttdef"><b>Definition</b> <a href="transaction_8hpp_source.html#l00184">transaction.hpp:184</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1platform__timer_html"><div class="ttname"><a href="structsysio_1_1chain_1_1platform__timer.html">sysio::chain::platform_timer</a></div><div class="ttdef"><b>Definition</b> <a href="platform__timer_8hpp_source.html#l00014">platform_timer.hpp:14</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1platform__timer_html_a5cb70a095755d00bf02d37d31b6e46af"><div class="ttname"><a href="structsysio_1_1chain_1_1platform__timer.html#a5cb70a095755d00bf02d37d31b6e46af">sysio::chain::platform_timer::stop</a></div><div class="ttdeci">void stop()</div><div class="ttdef"><b>Definition</b> <a href="platform__timer__asio__fallback_8cpp_source.html#l00084">platform_timer_asio_fallback.cpp:84</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1platform__timer_html_a5fd5d9852eeb86bed7975076db770b10"><div class="ttname"><a href="structsysio_1_1chain_1_1platform__timer.html#a5fd5d9852eeb86bed7975076db770b10">sysio::chain::platform_timer::set_expiration_callback</a></div><div class="ttdeci">void set_expiration_callback(void(*func)(void *), void *user)</div><div class="ttdef"><b>Definition</b> <a href="platform__timer_8hpp_source.html#l00024">platform_timer.hpp:24</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1platform__timer_html_a8396e86c6a626dd2632cb075bd254ad4"><div class="ttname"><a href="structsysio_1_1chain_1_1platform__timer.html#a8396e86c6a626dd2632cb075bd254ad4">sysio::chain::platform_timer::start</a></div><div class="ttdeci">void start(fc::time_point tp)</div><div class="ttdef"><b>Definition</b> <a href="platform__timer__asio__fallback_8cpp_source.html#l00056">platform_timer_asio_fallback.cpp:56</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1transaction__checktime__timer_html"><div class="ttname"><a href="structsysio_1_1chain_1_1transaction__checktime__timer.html">sysio::chain::transaction_checktime_timer</a></div><div class="ttdef"><b>Definition</b> <a href="transaction__context_8hpp_source.html#l00009">transaction_context.hpp:9</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1transaction__checktime__timer_html_a05ca36147adfd661c6a20101244bc16f"><div class="ttname"><a href="structsysio_1_1chain_1_1transaction__checktime__timer.html#a05ca36147adfd661c6a20101244bc16f">sysio::chain::transaction_checktime_timer::~transaction_checktime_timer</a></div><div class="ttdeci">~transaction_checktime_timer()</div><div class="ttdef"><b>Definition</b> <a href="#l00042">transaction_context.cpp:42</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1transaction__checktime__timer_html_a8d521e32027600dda6369c50f01a10c9"><div class="ttname"><a href="structsysio_1_1chain_1_1transaction__checktime__timer.html#a8d521e32027600dda6369c50f01a10c9">sysio::chain::transaction_checktime_timer::set_expiration_callback</a></div><div class="ttdeci">void set_expiration_callback(void(*func)(void *), void *user)</div><div class="ttdef"><b>Definition</b> <a href="#l00038">transaction_context.cpp:38</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1transaction__checktime__timer_html_a957951b0f382670abeac7531d35924c1"><div class="ttname"><a href="structsysio_1_1chain_1_1transaction__checktime__timer.html#a957951b0f382670abeac7531d35924c1">sysio::chain::transaction_checktime_timer::expired</a></div><div class="ttdeci">std::atomic_bool &amp; expired</div><div class="ttdef"><b>Definition</b> <a href="transaction__context_8hpp_source.html#l00025">transaction_context.hpp:25</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1transaction__checktime__timer_html_ad84002d0816f8b4b6aa3c2dd3772d1fe"><div class="ttname"><a href="structsysio_1_1chain_1_1transaction__checktime__timer.html#ad84002d0816f8b4b6aa3c2dd3772d1fe">sysio::chain::transaction_checktime_timer::stop</a></div><div class="ttdeci">void stop()</div><div class="ttdef"><b>Definition</b> <a href="#l00034">transaction_context.cpp:34</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1transaction__checktime__timer_html_ae2b6276397aaf3de6730a0e1db06f4c2"><div class="ttname"><a href="structsysio_1_1chain_1_1transaction__checktime__timer.html#ae2b6276397aaf3de6730a0e1db06f4c2">sysio::chain::transaction_checktime_timer::transaction_checktime_timer</a></div><div class="ttdeci">transaction_checktime_timer()=delete</div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1transaction__checktime__timer_html_aef90525b3674b77efd2bb44da3405fc6"><div class="ttname"><a href="structsysio_1_1chain_1_1transaction__checktime__timer.html#aef90525b3674b77efd2bb44da3405fc6">sysio::chain::transaction_checktime_timer::start</a></div><div class="ttdeci">void start(fc::time_point tp)</div><div class="ttdef"><b>Definition</b> <a href="#l00030">transaction_context.cpp:30</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1transaction__header_html_a349b11695387e3dbe91f918ee759d4b4"><div class="ttname"><a href="structsysio_1_1chain_1_1transaction__header.html#a349b11695387e3dbe91f918ee759d4b4">sysio::chain::transaction_header::delay_sec</a></div><div class="ttdeci">fc::unsigned_int delay_sec</div><div class="ttdoc">upper limit on the total CPU time billed for this transaction</div><div class="ttdef"><b>Definition</b> <a href="transaction_8hpp_source.html#l00065">transaction.hpp:65</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1transaction__header_html_ad1ed2586e8ace769fdb9a54d09a752ce"><div class="ttname"><a href="structsysio_1_1chain_1_1transaction__header.html#ad1ed2586e8ace769fdb9a54d09a752ce">sysio::chain::transaction_header::expiration</a></div><div class="ttdeci">time_point_sec expiration</div><div class="ttdoc">the time at which a transaction expires</div><div class="ttdef"><b>Definition</b> <a href="transaction_8hpp_source.html#l00060">transaction.hpp:60</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1transaction__trace_html"><div class="ttname"><a href="structsysio_1_1chain_1_1transaction__trace.html">sysio::chain::transaction_trace</a></div><div class="ttdef"><b>Definition</b> <a href="libraries_2chain_2include_2sysio_2chain_2trace_8hpp_source.html#l00050">trace.hpp:50</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1transaction_html"><div class="ttname"><a href="structsysio_1_1chain_1_1transaction.html">sysio::chain::transaction</a></div><div class="ttdef"><b>Definition</b> <a href="transaction_8hpp_source.html#l00083">transaction.hpp:83</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1transaction_html_a407fcf1868b81bb30b85f80d388bbac2"><div class="ttname"><a href="structsysio_1_1chain_1_1transaction.html#a407fcf1868b81bb30b85f80d388bbac2">sysio::chain::transaction::actions</a></div><div class="ttdeci">vector&lt; action &gt; actions</div><div class="ttdef"><b>Definition</b> <a href="transaction_8hpp_source.html#l00085">transaction.hpp:85</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1transaction_html_a926f2528e0af9f17521fcf92282c5806"><div class="ttname"><a href="structsysio_1_1chain_1_1transaction.html#a926f2528e0af9f17521fcf92282c5806">sysio::chain::transaction::context_free_actions</a></div><div class="ttdeci">vector&lt; action &gt; context_free_actions</div><div class="ttdef"><b>Definition</b> <a href="transaction_8hpp_source.html#l00084">transaction.hpp:84</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1transaction_html_a9514bad03e7dd6a8fee1204611bcce6b"><div class="ttname"><a href="structsysio_1_1chain_1_1transaction.html#a9514bad03e7dd6a8fee1204611bcce6b">sysio::chain::transaction::transaction_extensions</a></div><div class="ttdeci">extensions_type transaction_extensions</div><div class="ttdef"><b>Definition</b> <a href="transaction_8hpp_source.html#l00086">transaction.hpp:86</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1transaction_html_a98cfda9267a92091fb3e7b73163406c2"><div class="ttname"><a href="structsysio_1_1chain_1_1transaction.html#a98cfda9267a92091fb3e7b73163406c2">sysio::chain::transaction::first_authorizer</a></div><div class="ttdeci">account_name first_authorizer() const</div><div class="ttdef"><b>Definition</b> <a href="transaction_8hpp_source.html#l00099">transaction.hpp:99</a></div></div>
<div class="ttc" id="asys-vm_8cpp_html_a32ff5901c3a451a048ff45b692591ba3"><div class="ttname"><a href="sys-vm_8cpp.html#a32ff5901c3a451a048ff45b692591ba3">_timer</a></div><div class="ttdeci">transaction_checktime_timer &amp; _timer</div><div class="ttdef"><b>Definition</b> <a href="sys-vm_8cpp_source.html#l00042">sys-vm.cpp:42</a></div></div>
<div class="ttc" id="atransaction__context_8hpp_html"><div class="ttname"><a href="transaction__context_8hpp.html">transaction_context.hpp</a></div></div>
<div class="ttc" id="atransaction__object_8hpp_html"><div class="ttname"><a href="transaction__object_8hpp.html">transaction_object.hpp</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a506da415c9307c897ca9be93acfe1d0f"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a></div><div class="ttdeci">char * s</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l00524">yubihsm_pkcs11.c:524</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_428556e0652617aa37d2f7d8bcaf7fdf.html">libraries</a></li><li class="navelem"><a class="el" href="dir_0d4aba5c25a4be0a24c819a636048cb8.html">chain</a></li><li class="navelem"><a class="el" href="transaction__context_8cpp.html">transaction_context.cpp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0 </li>
  </ul>
</div>
</body>
</html>
