<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Wire Sysio: libraries/yubihsm/lib/yubihsm.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Wire Sysio<span id="projectnumber">&#160;Wire Sysion 1.0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('yubihsm_8c.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">yubihsm.c File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;<a class="el" href="yubihsm_8h_source.html">yubihsm.h</a>&gt;</code><br />
<code>#include &quot;<a class="el" href="lib_2internal_8h_source.html">internal.h</a>&quot;</code><br />
<code>#include &lt;arpa/inet.h&gt;</code><br />
<code>#include &lt;dlfcn.h&gt;</code><br />
<code>#include &lt;errno.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;strings.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;limits.h&gt;</code><br />
<code>#include &quot;<a class="el" href="rand_8h_source.html">../common/rand.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="pkcs5_8h_source.html">../common/pkcs5.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="yubihsm_2common_2hash_8h_source.html">../common/hash.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="aes__cmac_8h_source.html">../aes_cmac/aes_cmac.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="debug__lib_8h_source.html">debug_lib.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="insecure__memzero_8h_source.html">../common/insecure_memzero.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for yubihsm.c:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c__incl.png" border="0" usemap="#alibraries_2yubihsm_2lib_2yubihsm_8c" alt=""/></div>
<map name="alibraries_2yubihsm_2lib_2yubihsm_8c" id="alibraries_2yubihsm_2lib_2yubihsm_8c">
<area shape="rect" title=" " alt="" coords="758,5,894,46"/>
<area shape="rect" href="yubihsm_8h.html" title=" " alt="" coords="643,183,724,208"/>
<area shape="poly" title=" " alt="" coords="758,41,710,61,689,76,672,95,665,113,665,131,674,168,669,169,659,132,660,111,668,93,685,72,707,56,756,36"/>
<area shape="rect" title=" " alt="" coords="174,330,238,356"/>
<area shape="poly" title=" " alt="" coords="758,32,587,40,375,53,186,72,119,84,82,96,57,115,37,135,22,157,13,180,8,204,10,229,18,255,33,280,59,305,91,322,126,332,159,337,158,342,125,337,89,327,56,310,29,284,14,257,5,230,3,204,7,179,18,154,33,132,54,111,79,92,118,78,185,67,375,48,586,35,757,27"/>
<area shape="rect" title=" " alt="" coords="872,256,932,282"/>
<area shape="poly" title=" " alt="" coords="841,45,864,93,888,172,901,240,895,241,882,174,860,95,836,47"/>
<area shape="rect" href="lib_2internal_8h.html" title=" " alt="" coords="471,102,546,127"/>
<area shape="poly" title=" " alt="" coords="758,47,572,97,562,100,560,94,571,91,756,42"/>
<area shape="rect" title=" " alt="" coords="556,183,619,208"/>
<area shape="poly" title=" " alt="" coords="758,47,707,67,658,96,625,132,602,170,597,168,621,129,655,92,704,62,756,42"/>
<area shape="rect" title=" " alt="" coords="1037,102,1119,127"/>
<area shape="poly" title=" " alt="" coords="886,44,1026,91,1031,93,1029,98,1024,97,884,49"/>
<area shape="rect" title=" " alt="" coords="1144,102,1204,127"/>
<area shape="poly" title=" " alt="" coords="895,35,1007,58,1132,91,1136,93,1134,98,1131,97,1006,63,894,41"/>
<area shape="rect" title=" " alt="" coords="1229,102,1290,127"/>
<area shape="poly" title=" " alt="" coords="895,31,1044,52,1132,69,1217,91,1221,93,1220,98,1216,97,1130,74,1043,57,894,36"/>
<area shape="rect" title=" " alt="" coords="1314,102,1378,127"/>
<area shape="poly" title=" " alt="" coords="895,28,1081,47,1192,66,1303,91,1308,93,1307,98,1301,97,1191,71,1080,53,894,34"/>
<area shape="rect" title=" " alt="" coords="1402,102,1474,127"/>
<area shape="poly" title=" " alt="" coords="895,27,993,33,1117,44,1254,63,1391,91,1397,93,1396,98,1389,97,1253,69,1117,50,993,38,895,32"/>
<area shape="rect" href="rand_8h.html" title=" " alt="" coords="230,183,353,208"/>
<area shape="poly" title=" " alt="" coords="758,35,618,54,538,72,460,96,421,114,383,135,321,175,318,171,380,130,418,109,458,92,537,67,617,49,757,30"/>
<area shape="rect" href="pkcs5_8h.html" title=" " alt="" coords="126,102,259,127"/>
<area shape="poly" title=" " alt="" coords="758,39,275,104,275,99,757,34"/>
<area shape="rect" href="yubihsm_2common_2hash_8h.html" title=" " alt="" coords="44,183,104,208"/>
<area shape="poly" title=" " alt="" coords="757,32,593,40,392,53,213,71,150,83,115,96,101,111,91,129,80,168,74,166,86,127,97,108,113,92,149,78,212,66,391,47,593,34,757,27"/>
<area shape="rect" href="aes__cmac_8h.html" title=" " alt="" coords="682,102,850,127"/>
<area shape="poly" title=" " alt="" coords="815,48,785,90,781,87,810,45"/>
<area shape="rect" href="debug__lib_8h.html" title=" " alt="" coords="925,102,1012,127"/>
<area shape="poly" title=" " alt="" coords="860,44,937,91,935,96,857,49"/>
<area shape="rect" href="insecure__memzero_8h.html" title=" " alt="" coords="1498,94,1634,135"/>
<area shape="poly" title=" " alt="" coords="895,28,1150,49,1314,67,1483,91,1482,96,1313,72,1150,54,895,34"/>
<area shape="rect" href="stdint_8h.html" title=" " alt="" coords="435,256,499,282"/>
<area shape="poly" title=" " alt="" coords="648,211,515,255,513,250,646,206"/>
<area shape="rect" title=" " alt="" coords="325,256,399,282"/>
<area shape="poly" title=" " alt="" coords="643,208,632,211,415,259,414,254,631,206,642,203"/>
<area shape="rect" title=" " alt="" coords="208,256,276,282"/>
<area shape="poly" title=" " alt="" coords="643,209,632,211,473,236,313,259,292,262,291,257,312,254,472,231,631,206,642,204"/>
<area shape="poly" title=" " alt="" coords="721,206,858,251,856,256,720,211"/>
<area shape="poly" title=" " alt="" coords="435,282,253,331,252,326,434,277"/>
<area shape="rect" title=" " alt="" coords="434,330,500,356"/>
<area shape="poly" title=" " alt="" coords="470,282,470,314,465,314,465,282"/>
<area shape="poly" title=" " alt="" coords="499,129,386,247,382,243,495,126"/>
<area shape="rect" href="scp_8h.html" title=" " alt="" coords="478,183,531,208"/>
<area shape="poly" title=" " alt="" coords="511,128,509,167,503,167,505,127"/>
<area shape="poly" title=" " alt="" coords="522,126,567,170,563,173,519,129"/>
<area shape="poly" title=" " alt="" coords="501,210,483,244,478,241,496,207"/>
<area shape="poly" title=" " alt="" coords="482,211,401,251,399,247,479,206"/>
<area shape="poly" title=" " alt="" coords="322,206,424,248,422,253,320,211"/>
<area shape="poly" title=" " alt="" coords="305,207,341,243,337,247,301,210"/>
<area shape="poly" title=" " alt="" coords="285,210,261,245,257,242,281,207"/>
<area shape="poly" title=" " alt="" coords="235,125,298,148,366,180,410,212,447,243,443,247,407,216,363,185,296,153,233,130"/>
<area shape="poly" title=" " alt="" coords="195,127,201,166,208,187,220,207,240,224,263,238,311,256,309,261,260,243,236,228,216,210,203,190,195,167,190,128"/>
<area shape="poly" title=" " alt="" coords="188,129,174,165,172,187,176,207,191,228,210,245,206,249,187,232,172,209,167,187,169,164,183,127"/>
<area shape="poly" title=" " alt="" coords="176,130,106,176,103,171,173,125"/>
<area shape="poly" title=" " alt="" coords="105,199,412,254,421,255,420,261,411,259,104,205"/>
<area shape="poly" title=" " alt="" coords="105,202,311,252,309,258,104,207"/>
<area shape="poly" title=" " alt="" coords="104,206,200,247,198,252,101,211"/>
<area shape="rect" title=" " alt="" coords="43,256,145,282"/>
<area shape="poly" title=" " alt="" coords="80,208,89,241,84,242,75,209"/>
<area shape="rect" href="aes_8h.html" title=" " alt="" coords="799,183,853,208"/>
<area shape="poly" title=" " alt="" coords="777,126,810,169,806,172,773,129"/>
<area shape="poly" title=" " alt="" coords="799,207,781,211,515,262,514,257,780,206,798,201"/>
<area shape="rect" title=" " alt="" coords="745,256,848,282"/>
<area shape="poly" title=" " alt="" coords="824,210,810,243,805,241,819,208"/>
<area shape="poly" title=" " alt="" coords="925,130,740,181,738,176,924,125"/>
<area shape="poly" title=" " alt="" coords="933,130,788,185,763,198,738,211,679,229,619,244,516,264,515,258,618,239,677,224,736,206,761,194,786,180,931,125"/>
<area shape="poly" title=" " alt="" coords="966,129,916,243,911,241,961,127"/>
<area shape="rect" title=" " alt="" coords="1106,256,1188,282"/>
<area shape="poly" title=" " alt="" coords="1005,125,1025,132,1070,141,1109,143,1144,152,1160,163,1176,181,1182,197,1182,214,1168,244,1163,242,1176,212,1177,198,1172,184,1157,167,1142,157,1108,148,1070,146,1024,137,1003,130"/>
<area shape="rect" title=" " alt="" coords="968,256,1025,282"/>
<area shape="poly" title=" " alt="" coords="973,127,994,241,989,242,968,128"/>
<area shape="rect" href="debug_8h.html" title=" " alt="" coords="1029,183,1162,208"/>
<area shape="poly" title=" " alt="" coords="989,125,1064,172,1062,176,986,130"/>
<area shape="poly" title=" " alt="" coords="1106,207,1132,242,1127,245,1102,210"/>
<area shape="poly" title=" " alt="" coords="1080,211,1027,249,1024,245,1077,207"/>
<area shape="rect" title=" " alt="" coords="1507,183,1625,208"/>
<area shape="poly" title=" " alt="" coords="1569,135,1569,167,1563,167,1563,135"/>
</map>
</div>
</div>
<p><a href="yubihsm_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ac5513a56708e275ba0a95f9aeb325c1a" id="r_ac5513a56708e275ba0a95f9aeb325c1a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac5513a56708e275ba0a95f9aeb325c1a">STATIC_USB_BACKEND</a>&#160;&#160;&#160;&quot;usb&quot;</td></tr>
<tr class="separator:ac5513a56708e275ba0a95f9aeb325c1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac07ffd02c4e4c6eefceb0e90c4005367" id="r_ac07ffd02c4e4c6eefceb0e90c4005367"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac07ffd02c4e4c6eefceb0e90c4005367">STATIC_HTTP_BACKEND</a>&#160;&#160;&#160;&quot;http&quot;</td></tr>
<tr class="separator:ac07ffd02c4e4c6eefceb0e90c4005367"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab62526d2d58f00a4d33d306db1a39507" id="r_ab62526d2d58f00a4d33d306db1a39507"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab62526d2d58f00a4d33d306db1a39507">LIST_SEPARATORS</a>&#160;&#160;&#160;&quot;:,;|&quot;</td></tr>
<tr class="separator:ab62526d2d58f00a4d33d306db1a39507"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b9ea5683398966b2db794d1a5a78005" id="r_a0b9ea5683398966b2db794d1a5a78005"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0b9ea5683398966b2db794d1a5a78005">LIST_ID</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:a0b9ea5683398966b2db794d1a5a78005"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa606355c30aa4b5f0ad83d25ed069b25" id="r_aa606355c30aa4b5f0ad83d25ed069b25"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa606355c30aa4b5f0ad83d25ed069b25">LIST_TYPE</a>&#160;&#160;&#160;2</td></tr>
<tr class="separator:aa606355c30aa4b5f0ad83d25ed069b25"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2eea78213279842d562d311a118c4e64" id="r_a2eea78213279842d562d311a118c4e64"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2eea78213279842d562d311a118c4e64">LIST_DOMAINS</a>&#160;&#160;&#160;3</td></tr>
<tr class="separator:a2eea78213279842d562d311a118c4e64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2887e3e4dd005035b369ba8a9ec94b7" id="r_ad2887e3e4dd005035b369ba8a9ec94b7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad2887e3e4dd005035b369ba8a9ec94b7">LIST_CAPABILITIES</a>&#160;&#160;&#160;4</td></tr>
<tr class="separator:ad2887e3e4dd005035b369ba8a9ec94b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4144e686fa1e1d546a89875fb152ed4b" id="r_a4144e686fa1e1d546a89875fb152ed4b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4144e686fa1e1d546a89875fb152ed4b">LIST_ALGORITHM</a>&#160;&#160;&#160;5</td></tr>
<tr class="separator:a4144e686fa1e1d546a89875fb152ed4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b34189280c5fe21d735f5bd67ce2c1e" id="r_a0b34189280c5fe21d735f5bd67ce2c1e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0b34189280c5fe21d735f5bd67ce2c1e">LIST_LABEL</a>&#160;&#160;&#160;6</td></tr>
<tr class="separator:a0b34189280c5fe21d735f5bd67ce2c1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a055ab06cb17913ccd704c735dbf3c332" id="r_a055ab06cb17913ccd704c735dbf3c332"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a055ab06cb17913ccd704c735dbf3c332">STATUS_ENDPOINT</a>&#160;&#160;&#160;&quot;/connector/status&quot;</td></tr>
<tr class="separator:a055ab06cb17913ccd704c735dbf3c332"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7518f88b39b8ffaf830fefd5943291bb" id="r_a7518f88b39b8ffaf830fefd5943291bb"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7518f88b39b8ffaf830fefd5943291bb">API_ENDPOINT</a>&#160;&#160;&#160;&quot;/connector/api&quot;</td></tr>
<tr class="separator:a7518f88b39b8ffaf830fefd5943291bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02343c4c03f60828514b2a220ea3e9c1" id="r_a02343c4c03f60828514b2a220ea3e9c1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a02343c4c03f60828514b2a220ea3e9c1">USB_LIB</a>&#160;&#160;&#160;&quot;libyubihsm_usb.so.&quot; SOVERSION</td></tr>
<tr class="separator:a02343c4c03f60828514b2a220ea3e9c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8bfb55db13a8e48927730381cc57822" id="r_ac8bfb55db13a8e48927730381cc57822"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac8bfb55db13a8e48927730381cc57822">HTTP_LIB</a>&#160;&#160;&#160;&quot;libyubihsm_http.so.&quot; SOVERSION</td></tr>
<tr class="separator:ac8bfb55db13a8e48927730381cc57822"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f4bf0773c45ad9a9753a1b784a13fbb" id="r_a9f4bf0773c45ad9a9753a1b784a13fbb"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9f4bf0773c45ad9a9753a1b784a13fbb">htonll</a>(x)</td></tr>
<tr class="separator:a9f4bf0773c45ad9a9753a1b784a13fbb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a799e299be8d4c13dfa2112a60d05480d" id="r_a799e299be8d4c13dfa2112a60d05480d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a799e299be8d4c13dfa2112a60d05480d">yh_send_plain_msg</a> (<a class="el" href="structyh__connector.html">yh_connector</a> *connector, <a class="el" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7e">yh_cmd</a> cmd, const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *data, size_t data_len, <a class="el" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7e">yh_cmd</a> *response_cmd, <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *response, size_t *response_len)</td></tr>
<tr class="separator:a799e299be8d4c13dfa2112a60d05480d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c26f003b72e800e9c934bca922a404a" id="r_a4c26f003b72e800e9c934bca922a404a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4c26f003b72e800e9c934bca922a404a">yh_send_secure_msg</a> (<a class="el" href="structyh__session.html">yh_session</a> *<a class="el" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, <a class="el" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7e">yh_cmd</a> cmd, const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *data, size_t data_len, <a class="el" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7e">yh_cmd</a> *response_cmd, <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *response, size_t *response_len)</td></tr>
<tr class="separator:a4c26f003b72e800e9c934bca922a404a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3be331dcf8907ff3569e4dc230e1c615" id="r_a3be331dcf8907ff3569e4dc230e1c615"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3be331dcf8907ff3569e4dc230e1c615">yh_create_session_derived</a> (<a class="el" href="structyh__connector.html">yh_connector</a> *connector, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> authkey_id, const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *password, size_t password_len, bool recreate, <a class="el" href="structyh__session.html">yh_session</a> **<a class="el" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>)</td></tr>
<tr class="separator:a3be331dcf8907ff3569e4dc230e1c615"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e96ea59c5f32def80843fec5a3c2142" id="r_a0e96ea59c5f32def80843fec5a3c2142"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0e96ea59c5f32def80843fec5a3c2142">yh_create_session</a> (<a class="el" href="structyh__connector.html">yh_connector</a> *connector, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> authkey_id, const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *key_enc, size_t key_enc_len, const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *key_mac, size_t key_mac_len, bool recreate, <a class="el" href="structyh__session.html">yh_session</a> **<a class="el" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>)</td></tr>
<tr class="separator:a0e96ea59c5f32def80843fec5a3c2142"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a296b43eadb1151017ba8e9578b351c5e" id="r_a296b43eadb1151017ba8e9578b351c5e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a296b43eadb1151017ba8e9578b351c5e">yh_begin_create_session_ext</a> (<a class="el" href="structyh__connector.html">yh_connector</a> *connector, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> authkey_id, <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> **<a class="el" href="structcontext.html">context</a>, <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *card_cryptogram, size_t card_cryptogram_len, <a class="el" href="structyh__session.html">yh_session</a> **<a class="el" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>)</td></tr>
<tr class="separator:a296b43eadb1151017ba8e9578b351c5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afbcb5c761339fbcf444be8f338b4614f" id="r_afbcb5c761339fbcf444be8f338b4614f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afbcb5c761339fbcf444be8f338b4614f">yh_finish_create_session_ext</a> (<a class="el" href="structyh__connector.html">yh_connector</a> *connector, <a class="el" href="structyh__session.html">yh_session</a> *<a class="el" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *key_senc, size_t key_senc_len, const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *key_smac, size_t key_smac_len, const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *key_srmac, size_t key_srmac_len, <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *card_cryptogram, size_t card_cryptogram_len)</td></tr>
<tr class="separator:afbcb5c761339fbcf444be8f338b4614f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a35f8ae5a739848408633a514e41b2d" id="r_a1a35f8ae5a739848408633a514e41b2d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1a35f8ae5a739848408633a514e41b2d">yh_destroy_session</a> (<a class="el" href="structyh__session.html">yh_session</a> **<a class="el" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>)</td></tr>
<tr class="separator:a1a35f8ae5a739848408633a514e41b2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a163506939cedbc1e849bdcfb8b5fe1de" id="r_a163506939cedbc1e849bdcfb8b5fe1de"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a163506939cedbc1e849bdcfb8b5fe1de">yh_connector_has_device</a> (<a class="el" href="structyh__connector.html">yh_connector</a> *connector)</td></tr>
<tr class="separator:a163506939cedbc1e849bdcfb8b5fe1de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b9f4070a103724b241e0a2b6a56d1ba" id="r_a2b9f4070a103724b241e0a2b6a56d1ba"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2b9f4070a103724b241e0a2b6a56d1ba">yh_get_connector_version</a> (<a class="el" href="structyh__connector.html">yh_connector</a> *connector, <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *<a class="el" href="yubihsm__pkcs11_8c.html#a5bd4e4c943762926c8f653b6224cced2">major</a>, <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *<a class="el" href="yubihsm__pkcs11_8c.html#ae2f416b0a34b7beb4ed3873d791ac393">minor</a>, <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *<a class="el" href="yubihsm__pkcs11_8c.html#a00c54fad5fef8d31eb75c1163468005b">patch</a>)</td></tr>
<tr class="separator:a2b9f4070a103724b241e0a2b6a56d1ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb5d5e9a2718b9427269f7d267ca25b9" id="r_acb5d5e9a2718b9427269f7d267ca25b9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acb5d5e9a2718b9427269f7d267ca25b9">yh_get_connector_address</a> (<a class="el" href="structyh__connector.html">yh_connector</a> *connector, char **const address)</td></tr>
<tr class="separator:acb5d5e9a2718b9427269f7d267ca25b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ab558e1426359cc78e7a362f8b3acd9" id="r_a6ab558e1426359cc78e7a362f8b3acd9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6ab558e1426359cc78e7a362f8b3acd9">yh_util_get_device_info</a> (<a class="el" href="structyh__connector.html">yh_connector</a> *connector, <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *<a class="el" href="yubihsm__pkcs11_8c.html#a5bd4e4c943762926c8f653b6224cced2">major</a>, <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *<a class="el" href="yubihsm__pkcs11_8c.html#ae2f416b0a34b7beb4ed3873d791ac393">minor</a>, <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *<a class="el" href="yubihsm__pkcs11_8c.html#a00c54fad5fef8d31eb75c1163468005b">patch</a>, <a class="el" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> *<a class="el" href="yubihsm__pkcs11_8c.html#a1149ca4bd0659030412db8e77bebdf88">serial</a>, <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *log_total, <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *log_used, <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55ca">yh_algorithm</a> *algorithms, size_t *n_algorithms)</td></tr>
<tr class="separator:a6ab558e1426359cc78e7a362f8b3acd9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7cbea7103efff8473ccfaaa35bfc6346" id="r_a7cbea7103efff8473ccfaaa35bfc6346"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7cbea7103efff8473ccfaaa35bfc6346">yh_util_list_objects</a> (<a class="el" href="structyh__session.html">yh_session</a> *<a class="el" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="el" href="code__cache_8cpp.html#aa0efefe21f4700d78692edc823e763be">id</a>, <a class="el" href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583">yh_object_type</a> type, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="el" href="yubihsm__pkcs11_8c.html#a5420fd4d2f76428942c2716b1cb7e863">domains</a>, const <a class="el" href="structyh__capabilities.html">yh_capabilities</a> *<a class="el" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>, <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55ca">yh_algorithm</a> <a class="el" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>, const char *<a class="el" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>, <a class="el" href="structyh__object__descriptor.html">yh_object_descriptor</a> *objects, size_t *<a class="el" href="yubihsm__pkcs11_8c.html#a351300ca15aa70c149f1301f89bcbe9b">n_objects</a>)</td></tr>
<tr class="separator:a7cbea7103efff8473ccfaaa35bfc6346"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b5f1f0c1cbca11fbe21e7e4e6b29a1b" id="r_a7b5f1f0c1cbca11fbe21e7e4e6b29a1b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7b5f1f0c1cbca11fbe21e7e4e6b29a1b">yh_util_get_object_info</a> (<a class="el" href="structyh__session.html">yh_session</a> *<a class="el" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="el" href="code__cache_8cpp.html#aa0efefe21f4700d78692edc823e763be">id</a>, <a class="el" href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583">yh_object_type</a> type, <a class="el" href="structyh__object__descriptor.html">yh_object_descriptor</a> *<a class="el" href="yubihsm__pkcs11_8c.html#a85d991d90970121ba1480cd98d93aab9">object</a>)</td></tr>
<tr class="separator:a7b5f1f0c1cbca11fbe21e7e4e6b29a1b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7b8b42156c4bdaf41d8b9758a2fd73f" id="r_aa7b8b42156c4bdaf41d8b9758a2fd73f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa7b8b42156c4bdaf41d8b9758a2fd73f">yh_util_get_public_key</a> (<a class="el" href="structyh__session.html">yh_session</a> *<a class="el" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="el" href="code__cache_8cpp.html#aa0efefe21f4700d78692edc823e763be">id</a>, <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *data, size_t *data_len, <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55ca">yh_algorithm</a> *<a class="el" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>)</td></tr>
<tr class="separator:aa7b8b42156c4bdaf41d8b9758a2fd73f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61ab8dbab67b1cceb49cd306f8c3f4b1" id="r_a61ab8dbab67b1cceb49cd306f8c3f4b1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a61ab8dbab67b1cceb49cd306f8c3f4b1">yh_util_close_session</a> (<a class="el" href="structyh__session.html">yh_session</a> *<a class="el" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>)</td></tr>
<tr class="separator:a61ab8dbab67b1cceb49cd306f8c3f4b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0a7644b7b368d6aaf8b4aff5e3d19b8" id="r_aa0a7644b7b368d6aaf8b4aff5e3d19b8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa0a7644b7b368d6aaf8b4aff5e3d19b8">yh_util_sign_pkcs1v1_5</a> (<a class="el" href="structyh__session.html">yh_session</a> *<a class="el" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="el" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>, bool hashed, const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *in, size_t <a class="el" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a>, <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *out, size_t *<a class="el" href="yubihsm__pkcs11_8c.html#a565e4b6f63fecad4c290b50ee6684ee3">out_len</a>)</td></tr>
<tr class="separator:aa0a7644b7b368d6aaf8b4aff5e3d19b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a944e6f31487857709f032598fd43fef5" id="r_a944e6f31487857709f032598fd43fef5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a944e6f31487857709f032598fd43fef5">yh_util_sign_pss</a> (<a class="el" href="structyh__session.html">yh_session</a> *<a class="el" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="el" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>, const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *in, size_t <a class="el" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a>, <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *out, size_t *<a class="el" href="yubihsm__pkcs11_8c.html#a565e4b6f63fecad4c290b50ee6684ee3">out_len</a>, size_t salt_len, <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55ca">yh_algorithm</a> mgf1Algo)</td></tr>
<tr class="separator:a944e6f31487857709f032598fd43fef5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5121c90d3bd745afd8264fef2ef39ace" id="r_a5121c90d3bd745afd8264fef2ef39ace"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5121c90d3bd745afd8264fef2ef39ace">yh_util_sign_ecdsa</a> (<a class="el" href="structyh__session.html">yh_session</a> *<a class="el" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="el" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>, const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *in, size_t <a class="el" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a>, <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *out, size_t *<a class="el" href="yubihsm__pkcs11_8c.html#a565e4b6f63fecad4c290b50ee6684ee3">out_len</a>)</td></tr>
<tr class="separator:a5121c90d3bd745afd8264fef2ef39ace"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a690a5585de21ce82495e139ec1dfdf9d" id="r_a690a5585de21ce82495e139ec1dfdf9d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a690a5585de21ce82495e139ec1dfdf9d">yh_util_sign_eddsa</a> (<a class="el" href="structyh__session.html">yh_session</a> *<a class="el" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="el" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>, const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *in, size_t <a class="el" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a>, <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *out, size_t *<a class="el" href="yubihsm__pkcs11_8c.html#a565e4b6f63fecad4c290b50ee6684ee3">out_len</a>)</td></tr>
<tr class="separator:a690a5585de21ce82495e139ec1dfdf9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9000d43fe8cf7313b319f316521eb0c4" id="r_a9000d43fe8cf7313b319f316521eb0c4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9000d43fe8cf7313b319f316521eb0c4">yh_util_sign_hmac</a> (<a class="el" href="structyh__session.html">yh_session</a> *<a class="el" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="el" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>, const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *in, size_t <a class="el" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a>, <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *out, size_t *<a class="el" href="yubihsm__pkcs11_8c.html#a565e4b6f63fecad4c290b50ee6684ee3">out_len</a>)</td></tr>
<tr class="separator:a9000d43fe8cf7313b319f316521eb0c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1bc8ed34687d83701eb3cc673ad4b96" id="r_af1bc8ed34687d83701eb3cc673ad4b96"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af1bc8ed34687d83701eb3cc673ad4b96">yh_util_get_pseudo_random</a> (<a class="el" href="structyh__session.html">yh_session</a> *<a class="el" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, size_t <a class="el" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>, <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *out, size_t *<a class="el" href="yubihsm__pkcs11_8c.html#a565e4b6f63fecad4c290b50ee6684ee3">out_len</a>)</td></tr>
<tr class="separator:af1bc8ed34687d83701eb3cc673ad4b96"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0ca24007ce6942d2185859560c43e8a" id="r_ab0ca24007ce6942d2185859560c43e8a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab0ca24007ce6942d2185859560c43e8a">yh_util_import_rsa_key</a> (<a class="el" href="structyh__session.html">yh_session</a> *<a class="el" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *<a class="el" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>, const char *<a class="el" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="el" href="yubihsm__pkcs11_8c.html#a5420fd4d2f76428942c2716b1cb7e863">domains</a>, const <a class="el" href="structyh__capabilities.html">yh_capabilities</a> *<a class="el" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>, <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55ca">yh_algorithm</a> <a class="el" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>, const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *<a class="el" href="bn_8cpp.html#a8b0eadcc506862e9d751ab45185053aa">p</a>, const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *q)</td></tr>
<tr class="separator:ab0ca24007ce6942d2185859560c43e8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc142d8f397eee024b3c145fa8abad85" id="r_adc142d8f397eee024b3c145fa8abad85"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adc142d8f397eee024b3c145fa8abad85">yh_util_import_ec_key</a> (<a class="el" href="structyh__session.html">yh_session</a> *<a class="el" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *<a class="el" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>, const char *<a class="el" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="el" href="yubihsm__pkcs11_8c.html#a5420fd4d2f76428942c2716b1cb7e863">domains</a>, const <a class="el" href="structyh__capabilities.html">yh_capabilities</a> *<a class="el" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>, <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55ca">yh_algorithm</a> <a class="el" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>, const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *<a class="el" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a>)</td></tr>
<tr class="separator:adc142d8f397eee024b3c145fa8abad85"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a886e052bc1571f24c6b7f0c57e2d8c" id="r_a7a886e052bc1571f24c6b7f0c57e2d8c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7a886e052bc1571f24c6b7f0c57e2d8c">yh_util_import_ed_key</a> (<a class="el" href="structyh__session.html">yh_session</a> *<a class="el" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *<a class="el" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>, const char *<a class="el" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="el" href="yubihsm__pkcs11_8c.html#a5420fd4d2f76428942c2716b1cb7e863">domains</a>, const <a class="el" href="structyh__capabilities.html">yh_capabilities</a> *<a class="el" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>, <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55ca">yh_algorithm</a> <a class="el" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>, const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *k)</td></tr>
<tr class="separator:a7a886e052bc1571f24c6b7f0c57e2d8c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19c79faaf10c405864f0179821d551a5" id="r_a19c79faaf10c405864f0179821d551a5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a19c79faaf10c405864f0179821d551a5">yh_util_import_hmac_key</a> (<a class="el" href="structyh__session.html">yh_session</a> *<a class="el" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *<a class="el" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>, const char *<a class="el" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="el" href="yubihsm__pkcs11_8c.html#a5420fd4d2f76428942c2716b1cb7e863">domains</a>, const <a class="el" href="structyh__capabilities.html">yh_capabilities</a> *<a class="el" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>, <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55ca">yh_algorithm</a> <a class="el" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>, const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *key, size_t <a class="el" href="yubihsm__pkcs11_8c.html#a8b142e2a51f6b9b8760f9132119673b6">key_len</a>)</td></tr>
<tr class="separator:a19c79faaf10c405864f0179821d551a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1c62ef2643184a8ad44c569c87712d1" id="r_ab1c62ef2643184a8ad44c569c87712d1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab1c62ef2643184a8ad44c569c87712d1">yh_util_generate_rsa_key</a> (<a class="el" href="structyh__session.html">yh_session</a> *<a class="el" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *<a class="el" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>, const char *<a class="el" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="el" href="yubihsm__pkcs11_8c.html#a5420fd4d2f76428942c2716b1cb7e863">domains</a>, const <a class="el" href="structyh__capabilities.html">yh_capabilities</a> *<a class="el" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>, <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55ca">yh_algorithm</a> <a class="el" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>)</td></tr>
<tr class="separator:ab1c62ef2643184a8ad44c569c87712d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2db9bbd57a908c5c454fc6254f57dcff" id="r_a2db9bbd57a908c5c454fc6254f57dcff"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2db9bbd57a908c5c454fc6254f57dcff">yh_util_generate_ec_key</a> (<a class="el" href="structyh__session.html">yh_session</a> *<a class="el" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *<a class="el" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>, const char *<a class="el" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="el" href="yubihsm__pkcs11_8c.html#a5420fd4d2f76428942c2716b1cb7e863">domains</a>, const <a class="el" href="structyh__capabilities.html">yh_capabilities</a> *<a class="el" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>, <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55ca">yh_algorithm</a> <a class="el" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>)</td></tr>
<tr class="separator:a2db9bbd57a908c5c454fc6254f57dcff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41f4326fe736e99302442d6a6109edbc" id="r_a41f4326fe736e99302442d6a6109edbc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a41f4326fe736e99302442d6a6109edbc">yh_util_generate_ed_key</a> (<a class="el" href="structyh__session.html">yh_session</a> *<a class="el" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *<a class="el" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>, const char *<a class="el" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="el" href="yubihsm__pkcs11_8c.html#a5420fd4d2f76428942c2716b1cb7e863">domains</a>, const <a class="el" href="structyh__capabilities.html">yh_capabilities</a> *<a class="el" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>, <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55ca">yh_algorithm</a> <a class="el" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>)</td></tr>
<tr class="separator:a41f4326fe736e99302442d6a6109edbc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab37ae2f7fc6857b420e173284130686d" id="r_ab37ae2f7fc6857b420e173284130686d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab37ae2f7fc6857b420e173284130686d">yh_util_verify_hmac</a> (<a class="el" href="structyh__session.html">yh_session</a> *<a class="el" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="el" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>, const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *signature, size_t signature_len, const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *data, size_t data_len, bool *verified)</td></tr>
<tr class="separator:ab37ae2f7fc6857b420e173284130686d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1eac22853548b7ceab92550c22233b18" id="r_a1eac22853548b7ceab92550c22233b18"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1eac22853548b7ceab92550c22233b18">yh_util_generate_hmac_key</a> (<a class="el" href="structyh__session.html">yh_session</a> *<a class="el" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *<a class="el" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>, const char *<a class="el" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="el" href="yubihsm__pkcs11_8c.html#a5420fd4d2f76428942c2716b1cb7e863">domains</a>, const <a class="el" href="structyh__capabilities.html">yh_capabilities</a> *<a class="el" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>, <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55ca">yh_algorithm</a> <a class="el" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>)</td></tr>
<tr class="separator:a1eac22853548b7ceab92550c22233b18"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ebf6932cd2e68b9a23787c27fde3e26" id="r_a5ebf6932cd2e68b9a23787c27fde3e26"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5ebf6932cd2e68b9a23787c27fde3e26">yh_util_decrypt_pkcs1v1_5</a> (<a class="el" href="structyh__session.html">yh_session</a> *<a class="el" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="el" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>, const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *in, size_t <a class="el" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a>, <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *out, size_t *<a class="el" href="yubihsm__pkcs11_8c.html#a565e4b6f63fecad4c290b50ee6684ee3">out_len</a>)</td></tr>
<tr class="separator:a5ebf6932cd2e68b9a23787c27fde3e26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa939f8764ed0cca27884d9c8f640ac14" id="r_aa939f8764ed0cca27884d9c8f640ac14"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa939f8764ed0cca27884d9c8f640ac14">yh_util_decrypt_oaep</a> (<a class="el" href="structyh__session.html">yh_session</a> *<a class="el" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="el" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>, const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *in, size_t <a class="el" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a>, <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *out, size_t *<a class="el" href="yubihsm__pkcs11_8c.html#a565e4b6f63fecad4c290b50ee6684ee3">out_len</a>, const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *<a class="el" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>, size_t <a class="el" href="yubihsm__pkcs11_8c.html#ae76ac4adc41ec92427b4a14cd3385c1b">label_len</a>, <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55ca">yh_algorithm</a> mgf1Algo)</td></tr>
<tr class="separator:aa939f8764ed0cca27884d9c8f640ac14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2900aee87732f9ec017bd1662bcef7e9" id="r_a2900aee87732f9ec017bd1662bcef7e9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2900aee87732f9ec017bd1662bcef7e9">yh_util_derive_ecdh</a> (<a class="el" href="structyh__session.html">yh_session</a> *<a class="el" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="el" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>, const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *in, size_t <a class="el" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a>, <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *out, size_t *<a class="el" href="yubihsm__pkcs11_8c.html#a565e4b6f63fecad4c290b50ee6684ee3">out_len</a>)</td></tr>
<tr class="separator:a2900aee87732f9ec017bd1662bcef7e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae736702f9463878db4adfd45b6a597f9" id="r_ae736702f9463878db4adfd45b6a597f9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae736702f9463878db4adfd45b6a597f9">yh_util_delete_object</a> (<a class="el" href="structyh__session.html">yh_session</a> *<a class="el" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="el" href="code__cache_8cpp.html#aa0efefe21f4700d78692edc823e763be">id</a>, <a class="el" href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583">yh_object_type</a> type)</td></tr>
<tr class="separator:ae736702f9463878db4adfd45b6a597f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3f473e6dbb9188ad0269b40921c4f5f" id="r_aa3f473e6dbb9188ad0269b40921c4f5f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa3f473e6dbb9188ad0269b40921c4f5f">yh_util_export_wrapped</a> (<a class="el" href="structyh__session.html">yh_session</a> *<a class="el" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> wrapping_key_id, <a class="el" href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583">yh_object_type</a> <a class="el" href="yubihsm__pkcs11_8c.html#a16deaf35253f2106ecf4fd8003b1284f">target_type</a>, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="el" href="yubihsm__pkcs11_8c.html#ad82e96deab6d88b5e26f9f11da9d3fa3">target_id</a>, <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *out, size_t *<a class="el" href="yubihsm__pkcs11_8c.html#a565e4b6f63fecad4c290b50ee6684ee3">out_len</a>)</td></tr>
<tr class="separator:aa3f473e6dbb9188ad0269b40921c4f5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5bf13f9558bb0340468b722accf94d3" id="r_ae5bf13f9558bb0340468b722accf94d3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae5bf13f9558bb0340468b722accf94d3">yh_util_import_wrapped</a> (<a class="el" href="structyh__session.html">yh_session</a> *<a class="el" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> wrapping_key_id, const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *in, size_t <a class="el" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a>, <a class="el" href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583">yh_object_type</a> *<a class="el" href="yubihsm__pkcs11_8c.html#a16deaf35253f2106ecf4fd8003b1284f">target_type</a>, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *<a class="el" href="yubihsm__pkcs11_8c.html#ad82e96deab6d88b5e26f9f11da9d3fa3">target_id</a>)</td></tr>
<tr class="separator:ae5bf13f9558bb0340468b722accf94d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a9729ea5b2e299a735b43f2b23e50a7" id="r_a3a9729ea5b2e299a735b43f2b23e50a7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3a9729ea5b2e299a735b43f2b23e50a7">yh_util_import_wrap_key</a> (<a class="el" href="structyh__session.html">yh_session</a> *<a class="el" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *<a class="el" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>, const char *<a class="el" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="el" href="yubihsm__pkcs11_8c.html#a5420fd4d2f76428942c2716b1cb7e863">domains</a>, const <a class="el" href="structyh__capabilities.html">yh_capabilities</a> *<a class="el" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>, <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55ca">yh_algorithm</a> <a class="el" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>, const <a class="el" href="structyh__capabilities.html">yh_capabilities</a> *<a class="el" href="yubihsm__pkcs11_8c.html#afa62e10709d52e5162a732e81369a7ec">delegated_capabilities</a>, const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *in, size_t <a class="el" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a>)</td></tr>
<tr class="separator:a3a9729ea5b2e299a735b43f2b23e50a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f749a696792e7911844629e056d9c15" id="r_a1f749a696792e7911844629e056d9c15"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1f749a696792e7911844629e056d9c15">yh_util_generate_wrap_key</a> (<a class="el" href="structyh__session.html">yh_session</a> *<a class="el" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *<a class="el" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>, const char *<a class="el" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="el" href="yubihsm__pkcs11_8c.html#a5420fd4d2f76428942c2716b1cb7e863">domains</a>, const <a class="el" href="structyh__capabilities.html">yh_capabilities</a> *<a class="el" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>, <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55ca">yh_algorithm</a> <a class="el" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>, const <a class="el" href="structyh__capabilities.html">yh_capabilities</a> *<a class="el" href="yubihsm__pkcs11_8c.html#afa62e10709d52e5162a732e81369a7ec">delegated_capabilities</a>)</td></tr>
<tr class="separator:a1f749a696792e7911844629e056d9c15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ae52ad56b7e83baeb33b46104263aa6" id="r_a5ae52ad56b7e83baeb33b46104263aa6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5ae52ad56b7e83baeb33b46104263aa6">yh_util_get_log_entries</a> (<a class="el" href="structyh__session.html">yh_session</a> *<a class="el" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *unlogged_boot, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *unlogged_auth, <a class="el" href="structyh__log__entry.html">yh_log_entry</a> *out, size_t *n_items)</td></tr>
<tr class="separator:a5ae52ad56b7e83baeb33b46104263aa6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d844855c9066bbea0e4344978dd7fdc" id="r_a9d844855c9066bbea0e4344978dd7fdc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9d844855c9066bbea0e4344978dd7fdc">yh_util_set_log_index</a> (<a class="el" href="structyh__session.html">yh_session</a> *<a class="el" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> index)</td></tr>
<tr class="separator:a9d844855c9066bbea0e4344978dd7fdc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56e060e71fb8baa0531b3a20848abf37" id="r_a56e060e71fb8baa0531b3a20848abf37"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a56e060e71fb8baa0531b3a20848abf37">yh_util_get_opaque</a> (<a class="el" href="structyh__session.html">yh_session</a> *<a class="el" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> object_id, <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *out, size_t *<a class="el" href="yubihsm__pkcs11_8c.html#a565e4b6f63fecad4c290b50ee6684ee3">out_len</a>)</td></tr>
<tr class="separator:a56e060e71fb8baa0531b3a20848abf37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1249c920eec24f634d04eaafb90a1ca2" id="r_a1249c920eec24f634d04eaafb90a1ca2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1249c920eec24f634d04eaafb90a1ca2">yh_util_import_opaque</a> (<a class="el" href="structyh__session.html">yh_session</a> *<a class="el" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *object_id, const char *<a class="el" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="el" href="yubihsm__pkcs11_8c.html#a5420fd4d2f76428942c2716b1cb7e863">domains</a>, const <a class="el" href="structyh__capabilities.html">yh_capabilities</a> *<a class="el" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>, <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55ca">yh_algorithm</a> <a class="el" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>, const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *in, size_t <a class="el" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a>)</td></tr>
<tr class="separator:a1249c920eec24f634d04eaafb90a1ca2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45c32b993856be818a70c0ffad589cbd" id="r_a45c32b993856be818a70c0ffad589cbd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a45c32b993856be818a70c0ffad589cbd">yh_util_sign_ssh_certificate</a> (<a class="el" href="structyh__session.html">yh_session</a> *<a class="el" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="el" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> template_id, <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55ca">yh_algorithm</a> sig_algo, const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *in, size_t <a class="el" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a>, <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *out, size_t *<a class="el" href="yubihsm__pkcs11_8c.html#a565e4b6f63fecad4c290b50ee6684ee3">out_len</a>)</td></tr>
<tr class="separator:a45c32b993856be818a70c0ffad589cbd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47768ae0e72beba49f02db1baddf4823" id="r_a47768ae0e72beba49f02db1baddf4823"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a47768ae0e72beba49f02db1baddf4823">yh_util_get_template</a> (<a class="el" href="structyh__session.html">yh_session</a> *<a class="el" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> object_id, <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *out, size_t *<a class="el" href="yubihsm__pkcs11_8c.html#a565e4b6f63fecad4c290b50ee6684ee3">out_len</a>)</td></tr>
<tr class="separator:a47768ae0e72beba49f02db1baddf4823"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0fc8d6520950868365011d1a9f450f1" id="r_ae0fc8d6520950868365011d1a9f450f1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae0fc8d6520950868365011d1a9f450f1">yh_util_import_template</a> (<a class="el" href="structyh__session.html">yh_session</a> *<a class="el" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *object_id, const char *<a class="el" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="el" href="yubihsm__pkcs11_8c.html#a5420fd4d2f76428942c2716b1cb7e863">domains</a>, const <a class="el" href="structyh__capabilities.html">yh_capabilities</a> *<a class="el" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>, <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55ca">yh_algorithm</a> <a class="el" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>, const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *in, size_t <a class="el" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a>)</td></tr>
<tr class="separator:ae0fc8d6520950868365011d1a9f450f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeabf472faf1ba8d963b39866e04df6b0" id="r_aeabf472faf1ba8d963b39866e04df6b0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aeabf472faf1ba8d963b39866e04df6b0">yh_get_session_id</a> (<a class="el" href="structyh__session.html">yh_session</a> *<a class="el" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *sid)</td></tr>
<tr class="separator:aeabf472faf1ba8d963b39866e04df6b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77870209747d5ccd90f9da3aae2bdfa8" id="r_a77870209747d5ccd90f9da3aae2bdfa8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a77870209747d5ccd90f9da3aae2bdfa8">yh_authenticate_session</a> (<a class="el" href="structyh__session.html">yh_session</a> *<a class="el" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>)</td></tr>
<tr class="separator:a77870209747d5ccd90f9da3aae2bdfa8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac154da7ac6dc0a7b4b3a6cdff9433da8" id="r_ac154da7ac6dc0a7b4b3a6cdff9433da8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac154da7ac6dc0a7b4b3a6cdff9433da8">yh_util_import_authentication_key</a> (<a class="el" href="structyh__session.html">yh_session</a> *<a class="el" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *<a class="el" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>, const char *<a class="el" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="el" href="yubihsm__pkcs11_8c.html#a5420fd4d2f76428942c2716b1cb7e863">domains</a>, const <a class="el" href="structyh__capabilities.html">yh_capabilities</a> *<a class="el" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>, const <a class="el" href="structyh__capabilities.html">yh_capabilities</a> *<a class="el" href="yubihsm__pkcs11_8c.html#afa62e10709d52e5162a732e81369a7ec">delegated_capabilities</a>, const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *key_enc, size_t key_enc_len, const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *key_mac, size_t key_mac_len)</td></tr>
<tr class="separator:ac154da7ac6dc0a7b4b3a6cdff9433da8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80b4c4caeb9c768737c2dbf46d9352e4" id="r_a80b4c4caeb9c768737c2dbf46d9352e4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a80b4c4caeb9c768737c2dbf46d9352e4">yh_util_import_authentication_key_derived</a> (<a class="el" href="structyh__session.html">yh_session</a> *<a class="el" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *<a class="el" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>, const char *<a class="el" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="el" href="yubihsm__pkcs11_8c.html#a5420fd4d2f76428942c2716b1cb7e863">domains</a>, const <a class="el" href="structyh__capabilities.html">yh_capabilities</a> *<a class="el" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>, const <a class="el" href="structyh__capabilities.html">yh_capabilities</a> *<a class="el" href="yubihsm__pkcs11_8c.html#afa62e10709d52e5162a732e81369a7ec">delegated_capabilities</a>, const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *password, size_t password_len)</td></tr>
<tr class="separator:a80b4c4caeb9c768737c2dbf46d9352e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f229874e387887d7c5b4c7e6e07db8e" id="r_a8f229874e387887d7c5b4c7e6e07db8e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8f229874e387887d7c5b4c7e6e07db8e">yh_util_change_authentication_key</a> (<a class="el" href="structyh__session.html">yh_session</a> *<a class="el" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *<a class="el" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>, const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *key_enc, size_t key_enc_len, const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *key_mac, size_t key_mac_len)</td></tr>
<tr class="separator:a8f229874e387887d7c5b4c7e6e07db8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8761bd8bcffcee4af737bda255ce5e53" id="r_a8761bd8bcffcee4af737bda255ce5e53"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8761bd8bcffcee4af737bda255ce5e53">yh_util_change_authentication_key_derived</a> (<a class="el" href="structyh__session.html">yh_session</a> *<a class="el" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *<a class="el" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>, const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *password, size_t password_len)</td></tr>
<tr class="separator:a8761bd8bcffcee4af737bda255ce5e53"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82d295a02d9eb628f6dea4b4c01fdec4" id="r_a82d295a02d9eb628f6dea4b4c01fdec4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a82d295a02d9eb628f6dea4b4c01fdec4">yh_util_create_otp_aead</a> (<a class="el" href="structyh__session.html">yh_session</a> *<a class="el" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="el" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>, const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *key, const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *private_id, <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *out, size_t *<a class="el" href="yubihsm__pkcs11_8c.html#a565e4b6f63fecad4c290b50ee6684ee3">out_len</a>)</td></tr>
<tr class="separator:a82d295a02d9eb628f6dea4b4c01fdec4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4bb1d420f681bc91bd36dc08695dbad6" id="r_a4bb1d420f681bc91bd36dc08695dbad6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4bb1d420f681bc91bd36dc08695dbad6">yh_util_randomize_otp_aead</a> (<a class="el" href="structyh__session.html">yh_session</a> *<a class="el" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="el" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>, <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *out, size_t *<a class="el" href="yubihsm__pkcs11_8c.html#a565e4b6f63fecad4c290b50ee6684ee3">out_len</a>)</td></tr>
<tr class="separator:a4bb1d420f681bc91bd36dc08695dbad6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3677afe2209a1cae31f70a304e260e28" id="r_a3677afe2209a1cae31f70a304e260e28"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3677afe2209a1cae31f70a304e260e28">yh_util_decrypt_otp</a> (<a class="el" href="structyh__session.html">yh_session</a> *<a class="el" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="el" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>, const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *aead, size_t aead_len, const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *<a class="el" href="yubico__otp_8c.html#ab1e1d61db8c48d537faca71988a7c123">otp</a>, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *useCtr, <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *sessionCtr, <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *tstph, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *tstpl)</td></tr>
<tr class="separator:a3677afe2209a1cae31f70a304e260e28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:addc22271306d847f53321984f41d818b" id="r_addc22271306d847f53321984f41d818b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#addc22271306d847f53321984f41d818b">yh_util_import_otp_aead_key</a> (<a class="el" href="structyh__session.html">yh_session</a> *<a class="el" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *<a class="el" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>, const char *<a class="el" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="el" href="yubihsm__pkcs11_8c.html#a5420fd4d2f76428942c2716b1cb7e863">domains</a>, const <a class="el" href="structyh__capabilities.html">yh_capabilities</a> *<a class="el" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>, <a class="el" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> nonce_id, const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *in, size_t <a class="el" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a>)</td></tr>
<tr class="separator:addc22271306d847f53321984f41d818b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e130d225a8dc003d7a7c0ce4b8ea5e4" id="r_a9e130d225a8dc003d7a7c0ce4b8ea5e4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9e130d225a8dc003d7a7c0ce4b8ea5e4">yh_util_generate_otp_aead_key</a> (<a class="el" href="structyh__session.html">yh_session</a> *<a class="el" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *<a class="el" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>, const char *<a class="el" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="el" href="yubihsm__pkcs11_8c.html#a5420fd4d2f76428942c2716b1cb7e863">domains</a>, const <a class="el" href="structyh__capabilities.html">yh_capabilities</a> *<a class="el" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>, <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55ca">yh_algorithm</a> <a class="el" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>, <a class="el" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> nonce_id)</td></tr>
<tr class="separator:a9e130d225a8dc003d7a7c0ce4b8ea5e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5988faffd97366b188728ff1a7fb6e89" id="r_a5988faffd97366b188728ff1a7fb6e89"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5988faffd97366b188728ff1a7fb6e89">yh_util_sign_attestation_certificate</a> (<a class="el" href="structyh__session.html">yh_session</a> *<a class="el" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="el" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> attest_id, <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *out, size_t *<a class="el" href="yubihsm__pkcs11_8c.html#a565e4b6f63fecad4c290b50ee6684ee3">out_len</a>)</td></tr>
<tr class="separator:a5988faffd97366b188728ff1a7fb6e89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85ac840aec77cb1ca3c3ce1f2ab26282" id="r_a85ac840aec77cb1ca3c3ce1f2ab26282"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a85ac840aec77cb1ca3c3ce1f2ab26282">yh_util_set_option</a> (<a class="el" href="structyh__session.html">yh_session</a> *<a class="el" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, <a class="el" href="yubihsm_8h.html#acc8090ce0ec5029b376803e44b1cb4aa">yh_option</a> <a class="el" href="yubihsm_8h.html#a023826538a428f5f8c53aaef5e9aec02">option</a>, size_t <a class="el" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>, <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *val)</td></tr>
<tr class="separator:a85ac840aec77cb1ca3c3ce1f2ab26282"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11871e03c808e2d25737f893e58ed094" id="r_a11871e03c808e2d25737f893e58ed094"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a11871e03c808e2d25737f893e58ed094">yh_util_get_option</a> (<a class="el" href="structyh__session.html">yh_session</a> *<a class="el" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, <a class="el" href="yubihsm_8h.html#acc8090ce0ec5029b376803e44b1cb4aa">yh_option</a> <a class="el" href="yubihsm_8h.html#a023826538a428f5f8c53aaef5e9aec02">option</a>, <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *out, size_t *<a class="el" href="yubihsm__pkcs11_8c.html#a565e4b6f63fecad4c290b50ee6684ee3">out_len</a>)</td></tr>
<tr class="separator:a11871e03c808e2d25737f893e58ed094"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae87d5578703775b9d4151a14435f4a73" id="r_ae87d5578703775b9d4151a14435f4a73"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae87d5578703775b9d4151a14435f4a73">yh_util_get_storage_info</a> (<a class="el" href="structyh__session.html">yh_session</a> *<a class="el" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *total_records, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *free_records, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *total_pages, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *free_pages, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *page_size)</td></tr>
<tr class="separator:ae87d5578703775b9d4151a14435f4a73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c2e101be04ad1546d99d5600e732eca" id="r_a7c2e101be04ad1546d99d5600e732eca"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7c2e101be04ad1546d99d5600e732eca">yh_util_wrap_data</a> (<a class="el" href="structyh__session.html">yh_session</a> *<a class="el" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="el" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>, const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *in, size_t <a class="el" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a>, <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *out, size_t *<a class="el" href="yubihsm__pkcs11_8c.html#a565e4b6f63fecad4c290b50ee6684ee3">out_len</a>)</td></tr>
<tr class="separator:a7c2e101be04ad1546d99d5600e732eca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a550567a0f56d8536b9b5f34e905da7ec" id="r_a550567a0f56d8536b9b5f34e905da7ec"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a550567a0f56d8536b9b5f34e905da7ec">yh_util_unwrap_data</a> (<a class="el" href="structyh__session.html">yh_session</a> *<a class="el" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="el" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>, const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *in, size_t <a class="el" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a>, <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *out, size_t *<a class="el" href="yubihsm__pkcs11_8c.html#a565e4b6f63fecad4c290b50ee6684ee3">out_len</a>)</td></tr>
<tr class="separator:a550567a0f56d8536b9b5f34e905da7ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad112fe09ee88d595333fa87e8059717b" id="r_ad112fe09ee88d595333fa87e8059717b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad112fe09ee88d595333fa87e8059717b">yh_util_blink_device</a> (<a class="el" href="structyh__session.html">yh_session</a> *<a class="el" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> seconds)</td></tr>
<tr class="separator:ad112fe09ee88d595333fa87e8059717b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c153fe27877bcc7927d391fb55550af" id="r_a5c153fe27877bcc7927d391fb55550af"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5c153fe27877bcc7927d391fb55550af">yh_util_reset_device</a> (<a class="el" href="structyh__session.html">yh_session</a> *<a class="el" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>)</td></tr>
<tr class="separator:a5c153fe27877bcc7927d391fb55550af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a24c3146e51242256af505961e763f417" id="r_a24c3146e51242256af505961e763f417"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a24c3146e51242256af505961e763f417">yh_set_verbosity</a> (<a class="el" href="structyh__connector.html">yh_connector</a> *connector, <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> verbosity)</td></tr>
<tr class="separator:a24c3146e51242256af505961e763f417"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17d49ccb12b100e98d8b99585a705444" id="r_a17d49ccb12b100e98d8b99585a705444"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a17d49ccb12b100e98d8b99585a705444">yh_get_verbosity</a> (<a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *verbosity)</td></tr>
<tr class="separator:a17d49ccb12b100e98d8b99585a705444"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d223fd4ee6ae3f578307d72aba37a19" id="r_a7d223fd4ee6ae3f578307d72aba37a19"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7d223fd4ee6ae3f578307d72aba37a19">yh_set_debug_output</a> (<a class="el" href="structyh__connector.html">yh_connector</a> *connector, FILE *output)</td></tr>
<tr class="separator:a7d223fd4ee6ae3f578307d72aba37a19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5392844a98c6220c69fe08d3dcf8f1bc" id="r_a5392844a98c6220c69fe08d3dcf8f1bc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5392844a98c6220c69fe08d3dcf8f1bc">yh_init</a> (void)</td></tr>
<tr class="separator:a5392844a98c6220c69fe08d3dcf8f1bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36e3d9a07c6689e14a9339ca1ebb7259" id="r_a36e3d9a07c6689e14a9339ca1ebb7259"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a36e3d9a07c6689e14a9339ca1ebb7259">yh_exit</a> (void)</td></tr>
<tr class="separator:a36e3d9a07c6689e14a9339ca1ebb7259"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c700747902a722d6c1d2073277de294" id="r_a9c700747902a722d6c1d2073277de294"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9c700747902a722d6c1d2073277de294">yh_init_connector</a> (const char *<a class="el" href="programs_2clio_2main_8cpp.html#aa03c1ef4c41f36b048cf58d5aade7653">url</a>, <a class="el" href="structyh__connector.html">yh_connector</a> **connector)</td></tr>
<tr class="separator:a9c700747902a722d6c1d2073277de294"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9addbfae4cdb70b819986e7769cdd102" id="r_a9addbfae4cdb70b819986e7769cdd102"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9addbfae4cdb70b819986e7769cdd102">yh_set_connector_option</a> (<a class="el" href="structyh__connector.html">yh_connector</a> *connector, <a class="el" href="yubihsm_8h.html#a59400bce0478b88e048d5e62b2b0b015">yh_connector_option</a> opt, const void *val)</td></tr>
<tr class="separator:a9addbfae4cdb70b819986e7769cdd102"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa19be6ac70a2a5d1cef8d7e6902fe05f" id="r_aa19be6ac70a2a5d1cef8d7e6902fe05f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa19be6ac70a2a5d1cef8d7e6902fe05f">yh_connect</a> (<a class="el" href="structyh__connector.html">yh_connector</a> *connector, int timeout)</td></tr>
<tr class="separator:aa19be6ac70a2a5d1cef8d7e6902fe05f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab12d5a42d2219741bd3630b99ed1c7d2" id="r_ab12d5a42d2219741bd3630b99ed1c7d2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab12d5a42d2219741bd3630b99ed1c7d2">yh_disconnect</a> (<a class="el" href="structyh__connector.html">yh_connector</a> *connector)</td></tr>
<tr class="separator:ab12d5a42d2219741bd3630b99ed1c7d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab440e1cb671d9ba7a2e7d1243960e42" id="r_aab440e1cb671d9ba7a2e7d1243960e42"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aab440e1cb671d9ba7a2e7d1243960e42">yh_string_to_capabilities</a> (const char *capability, <a class="el" href="structyh__capabilities.html">yh_capabilities</a> *result)</td></tr>
<tr class="separator:aab440e1cb671d9ba7a2e7d1243960e42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac46bac75dfd0a4358a4e6b432a50e48a" id="r_ac46bac75dfd0a4358a4e6b432a50e48a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac46bac75dfd0a4358a4e6b432a50e48a">yh_capabilities_to_strings</a> (const <a class="el" href="structyh__capabilities.html">yh_capabilities</a> *num, const char *result[], size_t *n_result)</td></tr>
<tr class="separator:ac46bac75dfd0a4358a4e6b432a50e48a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba384949362ccaf19cbeae3bb046489c" id="r_aba384949362ccaf19cbeae3bb046489c"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aba384949362ccaf19cbeae3bb046489c">yh_check_capability</a> (const <a class="el" href="structyh__capabilities.html">yh_capabilities</a> *<a class="el" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>, const char *capability)</td></tr>
<tr class="separator:aba384949362ccaf19cbeae3bb046489c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afcca1608845e7a783d41d8ffd6aac8ed" id="r_afcca1608845e7a783d41d8ffd6aac8ed"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afcca1608845e7a783d41d8ffd6aac8ed">yh_merge_capabilities</a> (const <a class="el" href="structyh__capabilities.html">yh_capabilities</a> *<a class="el" href="pointer_8h.html#aeeddce917cf130d62c370b8f216026dd">a</a>, const <a class="el" href="structyh__capabilities.html">yh_capabilities</a> *b, <a class="el" href="structyh__capabilities.html">yh_capabilities</a> *result)</td></tr>
<tr class="separator:afcca1608845e7a783d41d8ffd6aac8ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a900031f15115ee22e885d2de7ec80a4a" id="r_a900031f15115ee22e885d2de7ec80a4a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a900031f15115ee22e885d2de7ec80a4a">yh_filter_capabilities</a> (const <a class="el" href="structyh__capabilities.html">yh_capabilities</a> *<a class="el" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>, const <a class="el" href="structyh__capabilities.html">yh_capabilities</a> *filter, <a class="el" href="structyh__capabilities.html">yh_capabilities</a> *result)</td></tr>
<tr class="separator:a900031f15115ee22e885d2de7ec80a4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a67155f2a7970ecb52e4f6aac6bbe84" id="r_a0a67155f2a7970ecb52e4f6aac6bbe84"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0a67155f2a7970ecb52e4f6aac6bbe84">yh_is_rsa</a> (<a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55ca">yh_algorithm</a> <a class="el" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>)</td></tr>
<tr class="separator:a0a67155f2a7970ecb52e4f6aac6bbe84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3032a8f45bfad36ed6157b0158dd7921" id="r_a3032a8f45bfad36ed6157b0158dd7921"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3032a8f45bfad36ed6157b0158dd7921">yh_is_ec</a> (<a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55ca">yh_algorithm</a> <a class="el" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>)</td></tr>
<tr class="separator:a3032a8f45bfad36ed6157b0158dd7921"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16fbf4426acbf42695c4ec4738b6ae8a" id="r_a16fbf4426acbf42695c4ec4738b6ae8a"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a16fbf4426acbf42695c4ec4738b6ae8a">yh_is_ed</a> (<a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55ca">yh_algorithm</a> <a class="el" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>)</td></tr>
<tr class="separator:a16fbf4426acbf42695c4ec4738b6ae8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb19de78e7d1aed72abbed5c74c676bc" id="r_acb19de78e7d1aed72abbed5c74c676bc"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acb19de78e7d1aed72abbed5c74c676bc">yh_is_hmac</a> (<a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55ca">yh_algorithm</a> <a class="el" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>)</td></tr>
<tr class="separator:acb19de78e7d1aed72abbed5c74c676bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a375000f12ac554eb8cbaa0e6b75c3a08" id="r_a375000f12ac554eb8cbaa0e6b75c3a08"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a375000f12ac554eb8cbaa0e6b75c3a08">yh_get_key_bitlength</a> (<a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55ca">yh_algorithm</a> <a class="el" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>, size_t *result)</td></tr>
<tr class="separator:a375000f12ac554eb8cbaa0e6b75c3a08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a0d369611aa795c62645467062a9acb" id="r_a2a0d369611aa795c62645467062a9acb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2a0d369611aa795c62645467062a9acb">yh_algo_to_string</a> (<a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55ca">yh_algorithm</a> algo, char const **result)</td></tr>
<tr class="separator:a2a0d369611aa795c62645467062a9acb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad9943d12261cc0f0cada93cbd6d0704" id="r_aad9943d12261cc0f0cada93cbd6d0704"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aad9943d12261cc0f0cada93cbd6d0704">yh_string_to_algo</a> (const char *string, <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55ca">yh_algorithm</a> *algo)</td></tr>
<tr class="separator:aad9943d12261cc0f0cada93cbd6d0704"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe3d701f7470c1d7b05480e4b6728bf7" id="r_afe3d701f7470c1d7b05480e4b6728bf7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afe3d701f7470c1d7b05480e4b6728bf7">yh_type_to_string</a> (<a class="el" href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583">yh_object_type</a> type, char const **result)</td></tr>
<tr class="separator:afe3d701f7470c1d7b05480e4b6728bf7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57cdfa4b6224bd2c4a8bab24513475d8" id="r_a57cdfa4b6224bd2c4a8bab24513475d8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a57cdfa4b6224bd2c4a8bab24513475d8">yh_string_to_type</a> (const char *string, <a class="el" href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583">yh_object_type</a> *type)</td></tr>
<tr class="separator:a57cdfa4b6224bd2c4a8bab24513475d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5464c7a6ad858c1e4e42e588b406c2d3" id="r_a5464c7a6ad858c1e4e42e588b406c2d3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5464c7a6ad858c1e4e42e588b406c2d3">yh_string_to_option</a> (const char *string, <a class="el" href="yubihsm_8h.html#acc8090ce0ec5029b376803e44b1cb4aa">yh_option</a> *<a class="el" href="yubihsm_8h.html#a023826538a428f5f8c53aaef5e9aec02">option</a>)</td></tr>
<tr class="separator:a5464c7a6ad858c1e4e42e588b406c2d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00b81c3c9ca2964a672b7b0b725925e4" id="r_a00b81c3c9ca2964a672b7b0b725925e4"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a00b81c3c9ca2964a672b7b0b725925e4">yh_verify_logs</a> (<a class="el" href="structyh__log__entry.html">yh_log_entry</a> *logs, size_t n_items, <a class="el" href="structyh__log__entry.html">yh_log_entry</a> *last_previous_log)</td></tr>
<tr class="separator:a00b81c3c9ca2964a672b7b0b725925e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96a4c751a281515d5610adb8fd779438" id="r_a96a4c751a281515d5610adb8fd779438"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a96a4c751a281515d5610adb8fd779438">yh_string_to_domains</a> (const char *<a class="el" href="yubihsm__pkcs11_8c.html#a5420fd4d2f76428942c2716b1cb7e863">domains</a>, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *result)</td></tr>
<tr class="separator:a96a4c751a281515d5610adb8fd779438"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0100df295f7ecf0d0cc90052aac20586" id="r_a0100df295f7ecf0d0cc90052aac20586"><td class="memItemLeft" align="right" valign="top"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0100df295f7ecf0d0cc90052aac20586">yh_domains_to_string</a> (<a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="el" href="yubihsm__pkcs11_8c.html#a5420fd4d2f76428942c2716b1cb7e863">domains</a>, char *string, size_t max_len)</td></tr>
<tr class="separator:a0100df295f7ecf0d0cc90052aac20586"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a53dbe31d2d75719fb2b97437fcb42f2a" id="r_a53dbe31d2d75719fb2b97437fcb42f2a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="el" href="debug__lib_8h.html#a4ba5f59460a312e3f5f14926f4b2299e">_yh_verbosity</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a53dbe31d2d75719fb2b97437fcb42f2a">YH_INTERNAL</a> = 0</td></tr>
<tr class="separator:a53dbe31d2d75719fb2b97437fcb42f2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a7518f88b39b8ffaf830fefd5943291bb" name="a7518f88b39b8ffaf830fefd5943291bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7518f88b39b8ffaf830fefd5943291bb">&#9670;&#160;</a></span>API_ENDPOINT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define API_ENDPOINT&#160;&#160;&#160;&quot;/connector/api&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l03913">3913</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>

</div>
</div>
<a id="a9f4bf0773c45ad9a9753a1b784a13fbb" name="a9f4bf0773c45ad9a9753a1b784a13fbb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f4bf0773c45ad9a9753a1b784a13fbb">&#9670;&#160;</a></span>htonll</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define htonll</td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>x</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">  ((1 == htonl(1))                                                             \</div>
<div class="line">     ? (x)                                                                     \</div>
<div class="line">     : ((<a class="code hl_typedef" href="stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a>) htonl((x) &amp;0xFFFFFFFF) &lt;&lt; 32) | htonl((x) &gt;&gt; 32))</div>
<div class="ttc" id="astdint_8h_html_aec6fcb673ff035718c238c8c9d544c47"><div class="ttname"><a href="stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a></div><div class="ttdeci">unsigned __int64 uint64_t</div><div class="ttdef"><b>Definition</b> <a href="stdint_8h_source.html#l00136">stdint.h:136</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l04110">4110</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4110</span><span class="preprocessor">#define htonll(x)                                                              \</span></div>
<div class="line"><span class="lineno"> 4111</span><span class="preprocessor">  ((1 == htonl(1))                                                             \</span></div>
<div class="line"><span class="lineno"> 4112</span><span class="preprocessor">     ? (x)                                                                     \</span></div>
<div class="line"><span class="lineno"> 4113</span><span class="preprocessor">     : ((uint64_t) htonl((x) &amp;0xFFFFFFFF) &lt;&lt; 32) | htonl((x) &gt;&gt; 32))</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac8bfb55db13a8e48927730381cc57822" name="ac8bfb55db13a8e48927730381cc57822"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8bfb55db13a8e48927730381cc57822">&#9670;&#160;</a></span>HTTP_LIB</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HTTP_LIB&#160;&#160;&#160;&quot;libyubihsm_http.so.&quot; SOVERSION</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a4144e686fa1e1d546a89875fb152ed4b" name="a4144e686fa1e1d546a89875fb152ed4b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4144e686fa1e1d546a89875fb152ed4b">&#9670;&#160;</a></span>LIST_ALGORITHM</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LIST_ALGORITHM&#160;&#160;&#160;5</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l01027">1027</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>

</div>
</div>
<a id="ad2887e3e4dd005035b369ba8a9ec94b7" name="ad2887e3e4dd005035b369ba8a9ec94b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad2887e3e4dd005035b369ba8a9ec94b7">&#9670;&#160;</a></span>LIST_CAPABILITIES</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LIST_CAPABILITIES&#160;&#160;&#160;4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l01026">1026</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>

</div>
</div>
<a id="a2eea78213279842d562d311a118c4e64" name="a2eea78213279842d562d311a118c4e64"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2eea78213279842d562d311a118c4e64">&#9670;&#160;</a></span>LIST_DOMAINS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LIST_DOMAINS&#160;&#160;&#160;3</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l01025">1025</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>

</div>
</div>
<a id="a0b9ea5683398966b2db794d1a5a78005" name="a0b9ea5683398966b2db794d1a5a78005"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b9ea5683398966b2db794d1a5a78005">&#9670;&#160;</a></span>LIST_ID</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LIST_ID&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l01023">1023</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>

</div>
</div>
<a id="a0b34189280c5fe21d735f5bd67ce2c1e" name="a0b34189280c5fe21d735f5bd67ce2c1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b34189280c5fe21d735f5bd67ce2c1e">&#9670;&#160;</a></span>LIST_LABEL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LIST_LABEL&#160;&#160;&#160;6</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l01028">1028</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>

</div>
</div>
<a id="ab62526d2d58f00a4d33d306db1a39507" name="ab62526d2d58f00a4d33d306db1a39507"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab62526d2d58f00a4d33d306db1a39507">&#9670;&#160;</a></span>LIST_SEPARATORS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LIST_SEPARATORS&#160;&#160;&#160;&quot;:,;|&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l00055">55</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>

</div>
</div>
<a id="aa606355c30aa4b5f0ad83d25ed069b25" name="aa606355c30aa4b5f0ad83d25ed069b25"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa606355c30aa4b5f0ad83d25ed069b25">&#9670;&#160;</a></span>LIST_TYPE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LIST_TYPE&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l01024">1024</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>

</div>
</div>
<a id="ac07ffd02c4e4c6eefceb0e90c4005367" name="ac07ffd02c4e4c6eefceb0e90c4005367"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac07ffd02c4e4c6eefceb0e90c4005367">&#9670;&#160;</a></span>STATIC_HTTP_BACKEND</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STATIC_HTTP_BACKEND&#160;&#160;&#160;&quot;http&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l00044">44</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>

</div>
</div>
<a id="ac5513a56708e275ba0a95f9aeb325c1a" name="ac5513a56708e275ba0a95f9aeb325c1a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac5513a56708e275ba0a95f9aeb325c1a">&#9670;&#160;</a></span>STATIC_USB_BACKEND</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STATIC_USB_BACKEND&#160;&#160;&#160;&quot;usb&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l00043">43</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>

</div>
</div>
<a id="a055ab06cb17913ccd704c735dbf3c332" name="a055ab06cb17913ccd704c735dbf3c332"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a055ab06cb17913ccd704c735dbf3c332">&#9670;&#160;</a></span>STATUS_ENDPOINT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STATUS_ENDPOINT&#160;&#160;&#160;&quot;/connector/status&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l03912">3912</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>

</div>
</div>
<a id="a02343c4c03f60828514b2a220ea3e9c1" name="a02343c4c03f60828514b2a220ea3e9c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02343c4c03f60828514b2a220ea3e9c1">&#9670;&#160;</a></span>USB_LIB</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define USB_LIB&#160;&#160;&#160;&quot;libyubihsm_usb.so.&quot; SOVERSION</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a2a0d369611aa795c62645467062a9acb" name="a2a0d369611aa795c62645467062a9acb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a0d369611aa795c62645467062a9acb">&#9670;&#160;</a></span>yh_algo_to_string()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_algo_to_string </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55ca">yh_algorithm</a></td>          <td class="paramname"><span class="paramname"><em>algo</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char const **</td>          <td class="paramname"><span class="paramname"><em>result</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Convert an algorithm to its string representation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">algo</td><td>Algorithm to convert. See <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55ca">yh_algorithm</a> </td></tr>
    <tr><td class="paramname">result</td><td>The algorithm as a String. "Unknown" if the algorithm is not supported by YubiHSM 2.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> if <code>result</code> is NULL.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a href="https://developers.yubico.com/YubiHSM2/Concepts/Algorithms.html">Algorithms</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l04384">4384</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4384</span>                                                                {</div>
<div class="line"><span class="lineno"> 4385</span> </div>
<div class="line"><span class="lineno"> 4386</span>  <span class="keywordflow">if</span> (result == NULL) {</div>
<div class="line"><span class="lineno"> 4387</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>));</div>
<div class="line"><span class="lineno"> 4388</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 4389</span>  }</div>
<div class="line"><span class="lineno"> 4390</span> </div>
<div class="line"><span class="lineno"> 4391</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <span class="keyword">sizeof</span>(yh_algorithms) / <span class="keyword">sizeof</span>(yh_algorithms[0]);</div>
<div class="line"><span class="lineno"> 4392</span>       i++) {</div>
<div class="line"><span class="lineno"> 4393</span>    <span class="keywordflow">if</span> (algo == yh_algorithms[i].<a class="code hl_variable" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>) {</div>
<div class="line"><span class="lineno"> 4394</span>      *result = yh_algorithms[i].name;</div>
<div class="line"><span class="lineno"> 4395</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 4396</span>    }</div>
<div class="line"><span class="lineno"> 4397</span>  }</div>
<div class="line"><span class="lineno"> 4398</span> </div>
<div class="line"><span class="lineno"> 4399</span>  *result = <span class="stringliteral">&quot;Unknown&quot;</span>;</div>
<div class="line"><span class="lineno"> 4400</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 4401</span>}</div>
<div class="ttc" id="adebug__lib_8h_html_a2e3ed21e5ffba18d940d164aaec64a2a"><div class="ttname"><a href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a></div><div class="ttdeci">#define DBG_ERR(...)</div><div class="ttdef"><b>Definition</b> <a href="debug__lib_8h_source.html#l00076">debug_lib.h:76</a></div></div>
<div class="ttc" id="alib_2error_8c_html_a238eedb1e27dbff2a0ab9a3932eb3f8b"><div class="ttname"><a href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a></div><div class="ttdeci">const char * yh_strerror(yh_rc err)</div><div class="ttdef"><b>Definition</b> <a href="lib_2error_8c_source.html#l00065">error.c:65</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a67bb26eddc39413f8e94c98aedbbd391"><div class="ttname"><a href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a></div><div class="ttdeci">yh_algorithm algorithm</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00619">yubihsm.h:619</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815"><div class="ttname"><a href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a></div><div class="ttdeci">@ YHR_SUCCESS</div><div class="ttdoc">Returned value when function was successful.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00172">yubihsm.h:172</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5"><div class="ttname"><a href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a></div><div class="ttdeci">@ YHR_INVALID_PARAMETERS</div><div class="ttdoc">Returned value when an argument to a function is invalid.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00182">yubihsm.h:182</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a2a0d369611aa795c62645467062a9acb_cgraph.png" border="0" usemap="#ayubihsm_8c_a2a0d369611aa795c62645467062a9acb_cgraph" alt=""/></div>
<map name="ayubihsm_8c_a2a0d369611aa795c62645467062a9acb_cgraph" id="ayubihsm_8c_a2a0d369611aa795c62645467062a9acb_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,129,31"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="177,5,260,31"/>
<area shape="poly" title=" " alt="" coords="129,16,161,16,161,21,129,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a2a0d369611aa795c62645467062a9acb_icgraph.png" border="0" usemap="#ayubihsm_8c_a2a0d369611aa795c62645467062a9acb_icgraph" alt=""/></div>
<map name="ayubihsm_8c_a2a0d369611aa795c62645467062a9acb_icgraph" id="ayubihsm_8c_a2a0d369611aa795c62645467062a9acb_icgraph">
<area shape="rect" title=" " alt="" coords="509,80,633,106"/>
<area shape="rect" href="info_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="354,5,403,31"/>
<area shape="poly" title=" " alt="" coords="530,75,460,45,403,27,405,22,462,40,532,70"/>
<area shape="rect" href="commands_8c.html#ae2e50929acc6085cd395d0bd4ddb02db" title=" " alt="" coords="310,104,448,130"/>
<area shape="poly" title=" " alt="" coords="495,105,449,111,448,106,494,100"/>
<area shape="rect" href="commands_8c.html#aca833cbc2ca7673b00a4f6cb320c97b6" title=" " alt="" coords="296,55,461,80"/>
<area shape="poly" title=" " alt="" coords="494,85,461,81,462,76,494,80"/>
<area shape="rect" href="commands_8c.html#afa7330c81148ba6f4d5c53f7c370ed41" title=" " alt="" coords="298,153,460,179"/>
<area shape="poly" title=" " alt="" coords="530,115,462,145,431,155,429,150,460,140,528,110"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,104,248,130"/>
<area shape="poly" title=" " alt="" coords="294,120,249,120,249,114,294,114"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,104,55,130"/>
<area shape="poly" title=" " alt="" coords="87,120,55,120,55,114,87,114"/>
<area shape="poly" title=" " alt="" coords="308,87,232,106,231,101,307,82"/>
<area shape="poly" title=" " alt="" coords="280,73,194,80,103,94,56,109,55,104,102,89,193,74,280,67"/>
<area shape="poly" title=" " alt="" coords="307,152,231,133,232,128,308,146"/>
<area shape="poly" title=" " alt="" coords="282,166,194,159,102,145,55,130,56,125,103,140,195,154,282,161"/>
</map>
</div>

</div>
</div>
<a id="a77870209747d5ccd90f9da3aae2bdfa8" name="a77870209747d5ccd90f9da3aae2bdfa8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a77870209747d5ccd90f9da3aae2bdfa8">&#9670;&#160;</a></span>yh_authenticate_session()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_authenticate_session </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__session.html">yh_session</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Authenticate session</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>Session to authenticate</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> if the session is NULL. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366af8d55718c98750591e891a37409c9266" title="Returned value when failing to authenticate the session.">YHR_SESSION_AUTHENTICATION_FAILED</a> if the session fails to authenticate. See <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> for other possible errors</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a href="https://developers.yubico.com/YubiHSM2/Concepts/Session.html">Session</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l02927">2927</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2927</span>                                                   {</div>
<div class="line"><span class="lineno"> 2928</span> </div>
<div class="line"><span class="lineno"> 2929</span>  <a class="code hl_union" href="union___msg.html">Msg</a> msg;</div>
<div class="line"><span class="lineno"> 2930</span>  <a class="code hl_union" href="union___msg.html">Msg</a> response_msg;</div>
<div class="line"><span class="lineno"> 2931</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 2932</span> </div>
<div class="line"><span class="lineno"> 2933</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> mac_buf[64];</div>
<div class="line"><span class="lineno"> 2934</span>  <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> mac_buf_len;</div>
<div class="line"><span class="lineno"> 2935</span> </div>
<div class="line"><span class="lineno"> 2936</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a> == NULL) {</div>
<div class="line"><span class="lineno"> 2937</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>));</div>
<div class="line"><span class="lineno"> 2938</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 2939</span>  }</div>
<div class="line"><span class="lineno"> 2940</span> </div>
<div class="line"><span class="lineno"> 2941</span>  <span class="comment">// Send AUTHENTICATE SESSION command</span></div>
<div class="line"><span class="lineno"> 2942</span>  msg.<a class="code hl_variable" href="union___msg.html#a6b67958147999d1199c922c26763d7f0">st</a>.cmd = YHC_AUTHENTICATE_SESSION;</div>
<div class="line"><span class="lineno"> 2943</span>  msg.<a class="code hl_variable" href="union___msg.html#a6b67958147999d1199c922c26763d7f0">st</a>.len = 1 + <a class="code hl_define" href="scp_8h.html#ab69c4b9b326bc5bd847773167ca5c969">SCP_HOST_CRYPTO_LEN</a> + <a class="code hl_define" href="scp_8h.html#a4b017661aafe8f0a0bde0ff377684303">SCP_MAC_LEN</a>;</div>
<div class="line"><span class="lineno"> 2944</span> </div>
<div class="line"><span class="lineno"> 2945</span>  msg.<a class="code hl_variable" href="union___msg.html#a6b67958147999d1199c922c26763d7f0">st</a>.data[0] = <a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>-&gt;s.sid;</div>
<div class="line"><span class="lineno"> 2946</span> </div>
<div class="line"><span class="lineno"> 2947</span>  <span class="comment">// Compute host cryptogram</span></div>
<div class="line"><span class="lineno"> 2948</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = compute_host_cryptogram(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, msg.<a class="code hl_variable" href="union___msg.html#a6b67958147999d1199c922c26763d7f0">st</a>.data + 1);</div>
<div class="line"><span class="lineno"> 2949</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 2950</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 2951</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 2952</span>  }</div>
<div class="line"><span class="lineno"> 2953</span> </div>
<div class="line"><span class="lineno"> 2954</span>  <a class="code hl_define" href="debug__lib_8h.html#a81b33f0d4ec623bff78e988d14388d60">DBG_INT</a>(msg.<a class="code hl_variable" href="union___msg.html#a6b67958147999d1199c922c26763d7f0">st</a>.data + 1, <a class="code hl_define" href="scp_8h.html#ab69c4b9b326bc5bd847773167ca5c969">SCP_HOST_CRYPTO_LEN</a>, <span class="stringliteral">&quot;Host cryptogram: &quot;</span>);</div>
<div class="line"><span class="lineno"> 2955</span> </div>
<div class="line"><span class="lineno"> 2956</span>  mac_buf_len = <a class="code hl_define" href="scp_8h.html#a8f01665a0470dd4125b6518bd77e3328">SCP_PRF_LEN</a> + msg.<a class="code hl_variable" href="union___msg.html#a6b67958147999d1199c922c26763d7f0">st</a>.len + 3 - <a class="code hl_define" href="scp_8h.html#a4b017661aafe8f0a0bde0ff377684303">SCP_MAC_LEN</a>;</div>
<div class="line"><span class="lineno"> 2957</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105">memset</a>(mac_buf, 0, <a class="code hl_define" href="scp_8h.html#a8f01665a0470dd4125b6518bd77e3328">SCP_PRF_LEN</a>); <span class="comment">// Initial mac chaining value</span></div>
<div class="line"><span class="lineno"> 2958</span>  msg.<a class="code hl_variable" href="union___msg.html#a6b67958147999d1199c922c26763d7f0">st</a>.len = htons(msg.<a class="code hl_variable" href="union___msg.html#a6b67958147999d1199c922c26763d7f0">st</a>.len);</div>
<div class="line"><span class="lineno"> 2959</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(mac_buf + <a class="code hl_define" href="scp_8h.html#a8f01665a0470dd4125b6518bd77e3328">SCP_PRF_LEN</a>, msg.<a class="code hl_variable" href="union___msg.html#aeba349af15322ba6c42fe23750437b0d">raw</a>, mac_buf_len);</div>
<div class="line"><span class="lineno"> 2960</span>  msg.<a class="code hl_variable" href="union___msg.html#a6b67958147999d1199c922c26763d7f0">st</a>.len = ntohs(msg.<a class="code hl_variable" href="union___msg.html#a6b67958147999d1199c922c26763d7f0">st</a>.len);</div>
<div class="line"><span class="lineno"> 2961</span> </div>
<div class="line"><span class="lineno"> 2962</span>  compute_full_mac(mac_buf, mac_buf_len, <a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>-&gt;s.s_mac, <a class="code hl_define" href="scp_8h.html#a25905234f13446437b28c85d0504216d">SCP_KEY_LEN</a>,</div>
<div class="line"><span class="lineno"> 2963</span>                   <a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>-&gt;s.mac_chaining_value);</div>
<div class="line"><span class="lineno"> 2964</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(msg.<a class="code hl_variable" href="union___msg.html#a6b67958147999d1199c922c26763d7f0">st</a>.data + 1 + <a class="code hl_define" href="scp_8h.html#ab69c4b9b326bc5bd847773167ca5c969">SCP_HOST_CRYPTO_LEN</a>, <a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>-&gt;s.mac_chaining_value,</div>
<div class="line"><span class="lineno"> 2965</span>         <a class="code hl_define" href="scp_8h.html#a4b017661aafe8f0a0bde0ff377684303">SCP_MAC_LEN</a>);</div>
<div class="line"><span class="lineno"> 2966</span> </div>
<div class="line"><span class="lineno"> 2967</span>  <span class="comment">// Reset counter to 1</span></div>
<div class="line"><span class="lineno"> 2968</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105">memset</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>-&gt;s.ctr, 0, <a class="code hl_define" href="scp_8h.html#a8f01665a0470dd4125b6518bd77e3328">SCP_PRF_LEN</a>);</div>
<div class="line"><span class="lineno"> 2969</span>  <a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>-&gt;s.ctr[<a class="code hl_define" href="scp_8h.html#a8f01665a0470dd4125b6518bd77e3328">SCP_PRF_LEN</a> - 1]++;</div>
<div class="line"><span class="lineno"> 2970</span> </div>
<div class="line"><span class="lineno"> 2971</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = send_msg(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>-&gt;parent, &amp;msg, &amp;response_msg);</div>
<div class="line"><span class="lineno"> 2972</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 2973</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 2974</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 2975</span>  }</div>
<div class="line"><span class="lineno"> 2976</span> </div>
<div class="line"><span class="lineno"> 2977</span>  <span class="keywordflow">if</span> (response_msg.<a class="code hl_variable" href="union___msg.html#a6b67958147999d1199c922c26763d7f0">st</a>.cmd != YHC_AUTHENTICATE_SESSION_R) {</div>
<div class="line"><span class="lineno"> 2978</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 2979</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366af8d55718c98750591e891a37409c9266">YHR_SESSION_AUTHENTICATION_FAILED</a>;</div>
<div class="line"><span class="lineno"> 2980</span>  }</div>
<div class="line"><span class="lineno"> 2981</span> </div>
<div class="line"><span class="lineno"> 2982</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 2983</span>}</div>
<div class="ttc" id="adebug__lib_8h_html_a81b33f0d4ec623bff78e988d14388d60"><div class="ttname"><a href="debug__lib_8h.html#a81b33f0d4ec623bff78e988d14388d60">DBG_INT</a></div><div class="ttdeci">#define DBG_INT(var, len,...)</div><div class="ttdef"><b>Definition</b> <a href="debug__lib_8h_source.html#l00040">debug_lib.h:40</a></div></div>
<div class="ttc" id="aecdh__derive__test_8c_html_a0a2c7706d971796d7dc84fee36d6c84f"><div class="ttname"><a href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a></div><div class="ttdeci">CK_SESSION_HANDLE session</div><div class="ttdef"><b>Definition</b> <a href="ecdh__derive__test_8c_source.html#l00045">ecdh_derive_test.c:45</a></div></div>
<div class="ttc" id="ascp_8h_html_a25905234f13446437b28c85d0504216d"><div class="ttname"><a href="scp_8h.html#a25905234f13446437b28c85d0504216d">SCP_KEY_LEN</a></div><div class="ttdeci">#define SCP_KEY_LEN</div><div class="ttdef"><b>Definition</b> <a href="scp_8h_source.html#l00037">scp.h:37</a></div></div>
<div class="ttc" id="ascp_8h_html_a4b017661aafe8f0a0bde0ff377684303"><div class="ttname"><a href="scp_8h.html#a4b017661aafe8f0a0bde0ff377684303">SCP_MAC_LEN</a></div><div class="ttdeci">#define SCP_MAC_LEN</div><div class="ttdef"><b>Definition</b> <a href="scp_8h_source.html#l00046">scp.h:46</a></div></div>
<div class="ttc" id="ascp_8h_html_a8f01665a0470dd4125b6518bd77e3328"><div class="ttname"><a href="scp_8h.html#a8f01665a0470dd4125b6518bd77e3328">SCP_PRF_LEN</a></div><div class="ttdeci">#define SCP_PRF_LEN</div><div class="ttdef"><b>Definition</b> <a href="scp_8h_source.html#l00038">scp.h:38</a></div></div>
<div class="ttc" id="ascp_8h_html_ab69c4b9b326bc5bd847773167ca5c969"><div class="ttname"><a href="scp_8h.html#ab69c4b9b326bc5bd847773167ca5c969">SCP_HOST_CRYPTO_LEN</a></div><div class="ttdeci">#define SCP_HOST_CRYPTO_LEN</div><div class="ttdef"><b>Definition</b> <a href="scp_8h_source.html#l00044">scp.h:44</a></div></div>
<div class="ttc" id="astdint_8h_html_a273cf69d639a59973b6019625df33e30"><div class="ttname"><a href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a></div><div class="ttdeci">unsigned short uint16_t</div><div class="ttdef"><b>Definition</b> <a href="stdint_8h_source.html#l00125">stdint.h:125</a></div></div>
<div class="ttc" id="astdint_8h_html_aba7bc1797add20fe3efdf37ced1182c5"><div class="ttname"><a href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a></div><div class="ttdeci">unsigned char uint8_t</div><div class="ttdef"><b>Definition</b> <a href="stdint_8h_source.html#l00124">stdint.h:124</a></div></div>
<div class="ttc" id="aunion___msg_html"><div class="ttname"><a href="union___msg.html">_Msg</a></div><div class="ttdef"><b>Definition</b> <a href="scp_8h_source.html#l00056">scp.h:56</a></div></div>
<div class="ttc" id="aunion___msg_html_a6b67958147999d1199c922c26763d7f0"><div class="ttname"><a href="union___msg.html#a6b67958147999d1199c922c26763d7f0">_Msg::st</a></div><div class="ttdeci">struct _Msg::@103 st</div></div>
<div class="ttc" id="aunion___msg_html_aeba349af15322ba6c42fe23750437b0d"><div class="ttname"><a href="union___msg.html#aeba349af15322ba6c42fe23750437b0d">_Msg::raw</a></div><div class="ttdeci">uint8_t raw[3+SCP_MSG_BUF_SIZE]</div><div class="ttdef"><b>Definition</b> <a href="scp_8h_source.html#l00062">scp.h:62</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_ae4f602d2343d01b1727dfd633169d366"><div class="ttname"><a href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a></div><div class="ttdeci">yh_rc</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00170">yubihsm.h:170</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_ae4f602d2343d01b1727dfd633169d366af8d55718c98750591e891a37409c9266"><div class="ttname"><a href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366af8d55718c98750591e891a37409c9266">YHR_SESSION_AUTHENTICATION_FAILED</a></div><div class="ttdeci">@ YHR_SESSION_AUTHENTICATION_FAILED</div><div class="ttdoc">Returned value when failing to authenticate the session.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00191">yubihsm.h:191</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a9c8d6a4a7a87f74f070e816dca1a547b"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a></div><div class="ttdeci">yh_rc yrc</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l00606">yubihsm_pkcs11.c:606</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_adc4bd59a60361844aa0e852efa210105"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105">memset</a></div><div class="ttdeci">memset(pInfo-&gt;slotDescription, ' ', 64)</div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_ae785d5badbf1f08b491af31f32a135a1"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a></div><div class="ttdeci">memcpy((char *) pInfo-&gt;slotDescription, s, l)</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a77870209747d5ccd90f9da3aae2bdfa8_cgraph.png" border="0" usemap="#ayubihsm_8c_a77870209747d5ccd90f9da3aae2bdfa8_cgraph" alt=""/></div>
<map name="ayubihsm_8c_a77870209747d5ccd90f9da3aae2bdfa8_cgraph" id="ayubihsm_8c_a77870209747d5ccd90f9da3aae2bdfa8_cgraph">
<area shape="rect" title=" " alt="" coords="5,55,171,80"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="225,5,296,31"/>
<area shape="poly" title=" " alt="" coords="135,51,209,30,211,35,136,57"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="226,55,294,80"/>
<area shape="poly" title=" " alt="" coords="171,65,210,65,210,70,171,70"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="219,104,302,130"/>
<area shape="poly" title=" " alt="" coords="136,78,205,98,203,103,135,84"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a77870209747d5ccd90f9da3aae2bdfa8_icgraph.png" border="0" usemap="#ayubihsm_8c_a77870209747d5ccd90f9da3aae2bdfa8_icgraph" alt=""/></div>
<map name="ayubihsm_8c_a77870209747d5ccd90f9da3aae2bdfa8_icgraph" id="ayubihsm_8c_a77870209747d5ccd90f9da3aae2bdfa8_icgraph">
<area shape="rect" title=" " alt="" coords="967,145,1132,170"/>
<area shape="rect" href="yubihsm__shell__tests_8c.html#ae66f6b31b5ad750f1fe042a706a4e3d4" title=" " alt="" coords="586,170,635,196"/>
<area shape="poly" title=" " alt="" coords="952,166,636,184,635,179,952,161"/>
<area shape="rect" href="attest_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="348,2003,398,2029"/>
<area shape="poly" title=" " alt="" coords="1049,186,1016,607,985,940,947,1306,901,1667,875,1834,848,1987,819,2119,789,2228,758,2308,741,2335,724,2354,696,2375,668,2390,640,2398,612,2400,585,2397,556,2388,497,2354,459,2320,429,2278,408,2231,392,2182,376,2092,372,2030,377,2030,381,2091,397,2181,413,2229,434,2275,463,2316,500,2350,558,2383,586,2392,613,2395,639,2393,666,2385,693,2371,721,2350,737,2332,753,2305,784,2226,814,2118,843,1986,870,1833,895,1666,941,1305,980,940,1011,607,1044,185"/>
<area shape="rect" href="structsysio_1_1wallet_1_1detail_1_1yubihsm__wallet__impl.html#a00ee0ac7ac4a819d0b8755bf4f442263" title=" " alt="" coords="298,310,448,365"/>
<area shape="poly" title=" " alt="" coords="1003,141,963,127,918,116,824,102,702,89,640,87,583,90,535,99,500,116,481,135,473,156,470,177,472,200,473,248,467,274,452,299,440,311,437,307,448,296,462,272,468,248,466,200,465,177,467,154,477,132,497,111,533,94,582,85,640,82,702,84,825,96,920,111,964,122,1005,136"/>
<area shape="rect" href="commands_8c.html#ae2e50929acc6085cd395d0bd4ddb02db" title=" " alt="" coords="304,1402,442,1428"/>
<area shape="poly" title=" " alt="" coords="951,145,830,131,696,123,633,125,577,130,531,142,500,159,492,178,482,219,463,353,443,537,424,747,394,1158,378,1402,373,1402,388,1158,419,747,438,536,457,352,477,218,487,177,496,156,529,137,576,125,633,119,696,118,831,126,952,140"/>
<area shape="rect" href="commands_8c.html#a22f22a25151b12c7573f80563a341368" title=" " alt="" coords="296,259,450,285"/>
<area shape="poly" title=" " alt="" coords="1024,136,978,97,949,79,918,65,800,28,750,16,703,9,656,10,608,18,557,36,500,65,473,84,450,108,431,136,415,164,392,219,380,260,375,258,387,218,410,162,426,133,446,105,470,80,497,61,555,32,607,13,656,4,703,4,751,10,802,23,920,60,951,74,981,93,1027,132"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="771,1229,919,1254"/>
<area shape="poly" title=" " alt="" coords="1046,186,851,1229,846,1228,1040,185"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,1402,248,1428"/>
<area shape="poly" title=" " alt="" coords="288,1418,249,1418,249,1412,288,1412"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,1402,55,1428"/>
<area shape="poly" title=" " alt="" coords="87,1418,55,1418,55,1412,87,1412"/>
<area shape="poly" title=" " alt="" coords="300,297,298,299,286,319,276,343,262,403,255,475,252,552,253,707,251,826,210,1177,181,1402,176,1401,205,1176,245,825,248,707,247,552,249,474,257,402,271,341,281,316,294,296,296,294"/>
<area shape="poly" title=" " alt="" coords="301,296,298,299,269,339,242,392,216,456,192,529,148,695,111,873,82,1049,59,1206,35,1402,30,1401,54,1205,76,1048,106,872,143,693,186,527,211,454,237,390,265,336,294,296,297,293"/>
<area shape="poly" title=" " alt="" coords="839,1213,827,1000,803,680,786,518,767,376,745,268,733,232,721,210,702,196,680,188,635,184,636,178,681,183,705,191,725,207,738,229,750,266,772,375,791,518,808,680,832,1000,845,1213"/>
<area shape="rect" href="echo_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="586,1031,635,1057"/>
<area shape="poly" title=" " alt="" coords="830,1216,813,1182,789,1142,759,1103,721,1070,700,1060,678,1053,635,1047,636,1042,679,1048,702,1055,724,1066,763,1099,794,1139,818,1179,835,1213"/>
<area shape="rect" href="structsysio_1_1wallet_1_1detail_1_1yubihsm__wallet__impl.html#a6412f92a0ad381f2370582372a5b6082" title=" " alt="" coords="531,244,690,300"/>
<area shape="poly" title=" " alt="" coords="841,1213,838,1034,833,905,824,764,809,624,788,494,774,437,759,387,741,346,721,314,706,301,689,291,692,286,710,296,725,311,745,343,764,386,779,436,793,493,814,623,829,764,839,904,844,1033,846,1213"/>
<area shape="rect" href="commands_8c.html#af764906e585805991dd84ec5dc2c060a" title=" " alt="" coords="322,1546,424,1572"/>
<area shape="poly" title=" " alt="" coords="845,1270,837,1395,817,1570,801,1658,781,1737,756,1802,741,1826,724,1844,696,1864,668,1878,640,1886,613,1888,585,1885,557,1876,497,1844,478,1825,458,1794,423,1715,394,1632,376,1573,381,1571,399,1631,428,1713,463,1792,482,1821,500,1839,559,1871,586,1880,613,1883,639,1881,666,1873,693,1860,721,1840,737,1823,751,1799,776,1736,796,1657,812,1569,832,1395,840,1270"/>
<area shape="rect" href="yubihsm_8c.html#ad112fe09ee88d595333fa87e8059717b" title=" " alt="" coords="541,2053,680,2078"/>
<area shape="poly" title=" " alt="" coords="846,1270,842,1429,826,1662,811,1782,789,1891,761,1982,744,2017,725,2043,704,2058,681,2066,679,2061,702,2053,721,2040,739,2014,756,1980,784,1890,805,1781,820,1661,836,1429,841,1270"/>
<area shape="rect" href="yubihsm_8c.html#a8f229874e387887d7c5b4c7e6e07db8e" title=" " alt="" coords="498,2102,723,2128"/>
<area shape="poly" title=" " alt="" coords="846,1270,843,1437,838,1556,829,1685,814,1813,792,1930,779,1982,763,2027,745,2064,725,2093,711,2104,708,2100,721,2089,741,2062,758,2025,774,1980,787,1929,809,1812,823,1684,833,1556,838,1437,841,1270"/>
<area shape="rect" href="yubihsm_8c.html#a61ab8dbab67b1cceb49cd306f8c3f4b1" title=" " alt="" coords="536,1905,685,1930"/>
<area shape="poly" title=" " alt="" coords="845,1270,835,1401,814,1585,798,1680,779,1767,754,1838,740,1866,725,1887,707,1902,687,1911,685,1906,704,1897,721,1884,736,1863,749,1836,773,1765,793,1679,809,1585,830,1400,839,1270"/>
<area shape="rect" href="yubihsm_8c.html#a82d295a02d9eb628f6dea4b4c01fdec4" title=" " alt="" coords="529,1278,692,1304"/>
<area shape="poly" title=" " alt="" coords="766,1261,676,1280,675,1275,765,1256"/>
<area shape="rect" href="yubihsm_8c.html#aa939f8764ed0cca27884d9c8f640ac14" title=" " alt="" coords="538,2151,683,2177"/>
<area shape="poly" title=" " alt="" coords="847,1270,845,1446,841,1571,832,1708,817,1844,795,1969,781,2024,765,2072,746,2112,725,2142,706,2156,684,2164,682,2159,703,2152,721,2138,742,2109,760,2070,776,2022,790,1968,812,1843,826,1707,835,1571,840,1445,841,1270"/>
<area shape="rect" href="yubihsm_8c.html#a3677afe2209a1cae31f70a304e260e28" title=" " alt="" coords="543,1327,678,1353"/>
<area shape="poly" title=" " alt="" coords="816,1266,773,1294,724,1319,679,1332,677,1327,722,1314,771,1289,813,1261"/>
<area shape="rect" href="yubihsm_8c.html#a5ebf6932cd2e68b9a23787c27fde3e26" title=" " alt="" coords="521,2201,700,2226"/>
<area shape="poly" title=" " alt="" coords="847,1270,847,1454,843,1587,835,1731,820,1876,798,2008,784,2066,767,2117,747,2159,725,2191,702,2208,699,2203,721,2188,743,2157,762,2115,779,2065,793,2007,815,1875,829,1731,838,1587,841,1454,841,1270"/>
<area shape="rect" href="yubihsm_8c.html#ae736702f9463878db4adfd45b6a597f9" title=" " alt="" coords="539,1377,682,1402"/>
<area shape="poly" title=" " alt="" coords="828,1269,785,1320,756,1346,724,1368,684,1383,682,1378,721,1363,753,1342,781,1316,824,1265"/>
<area shape="rect" href="yubihsm_8c.html#a2900aee87732f9ec017bd1662bcef7e9" title=" " alt="" coords="542,1426,679,1452"/>
<area shape="poly" title=" " alt="" coords="835,1270,818,1304,794,1344,763,1384,724,1417,703,1428,680,1435,678,1430,701,1423,721,1413,759,1380,789,1341,813,1301,830,1267"/>
<area shape="rect" href="yubihsm_8c.html#aa3f473e6dbb9188ad0269b40921c4f5f" title=" " alt="" coords="531,1475,690,1501"/>
<area shape="poly" title=" " alt="" coords="839,1270,825,1314,802,1367,769,1421,748,1445,724,1466,691,1483,689,1478,721,1462,744,1442,764,1418,797,1365,820,1312,834,1268"/>
<area shape="rect" href="yubihsm_8c.html#a1eac22853548b7ceab92550c22233b18" title=" " alt="" coords="519,1525,702,1550"/>
<area shape="poly" title=" " alt="" coords="842,1270,831,1323,809,1390,794,1424,775,1458,752,1489,724,1516,704,1528,701,1523,721,1511,748,1485,770,1455,789,1422,804,1388,826,1322,837,1269"/>
<area shape="rect" href="yubihsm_8c.html#a9e130d225a8dc003d7a7c0ce4b8ea5e4" title=" " alt="" coords="540,1575,681,1615"/>
<area shape="poly" title=" " alt="" coords="844,1270,835,1331,815,1410,799,1452,779,1493,755,1531,724,1565,705,1579,682,1588,680,1583,702,1574,721,1561,750,1528,775,1491,794,1450,810,1409,830,1330,839,1270"/>
<area shape="rect" href="yubihsm_8c.html#a1f749a696792e7911844629e056d9c15" title=" " alt="" coords="521,1639,700,1665"/>
<area shape="poly" title=" " alt="" coords="846,1270,842,1343,825,1439,809,1491,788,1541,760,1588,724,1629,702,1644,699,1639,721,1625,756,1585,783,1539,804,1489,820,1438,836,1342,841,1270"/>
<area shape="rect" href="yubihsm_8c.html#a5ae52ad56b7e83baeb33b46104263aa6" title=" " alt="" coords="533,2250,688,2276"/>
<area shape="poly" title=" " alt="" coords="845,1270,832,1477,807,1785,790,1941,771,2079,749,2183,737,2219,725,2241,708,2254,689,2262,687,2257,706,2249,721,2237,733,2217,744,2182,766,2078,785,1941,802,1785,827,1477,839,1270"/>
<area shape="rect" href="yubihsm_8c.html#a7b5f1f0c1cbca11fbe21e7e4e6b29a1b" title=" " alt="" coords="533,325,688,350"/>
<area shape="poly" title=" " alt="" coords="841,1213,839,1041,834,918,825,784,811,652,789,530,775,477,759,430,741,392,721,363,705,352,687,344,689,339,708,347,725,360,746,389,764,428,780,475,794,529,816,651,831,784,840,917,845,1040,846,1213"/>
<area shape="rect" href="yubihsm_8c.html#a56e060e71fb8baa0531b3a20848abf37" title=" " alt="" coords="544,1954,677,1980"/>
<area shape="poly" title=" " alt="" coords="845,1270,838,1412,819,1614,804,1718,783,1813,757,1891,742,1922,725,1945,703,1960,678,1968,677,1963,701,1955,721,1941,737,1919,752,1889,778,1812,799,1717,814,1614,833,1411,840,1270"/>
<area shape="rect" href="yubihsm_8c.html#a11871e03c808e2d25737f893e58ed094" title=" " alt="" coords="547,374,674,400"/>
<area shape="poly" title=" " alt="" coords="841,1213,838,1049,832,933,822,808,807,683,786,569,757,475,740,440,721,413,699,398,673,390,675,385,702,393,725,409,745,437,762,473,791,568,813,682,828,807,837,933,843,1049,846,1213"/>
<area shape="rect" href="yubihsm_8c.html#af1bc8ed34687d83701eb3cc673ad4b96" title=" " alt="" coords="544,1689,677,1730"/>
<area shape="poly" title=" " alt="" coords="847,1270,845,1350,839,1402,830,1460,814,1519,793,1577,763,1631,725,1680,703,1695,678,1705,677,1700,700,1690,721,1676,759,1628,788,1575,809,1517,824,1458,834,1402,839,1349,842,1270"/>
<area shape="rect" href="yubihsm_8c.html#aa7b8b42156c4bdaf41d8b9758a2fd73f" title=" " alt="" coords="534,1754,687,1780"/>
<area shape="poly" title=" " alt="" coords="843,1270,830,1374,806,1516,790,1588,771,1653,749,1707,725,1743,708,1756,688,1764,686,1759,705,1751,721,1740,745,1704,766,1652,785,1587,801,1515,825,1373,838,1269"/>
<area shape="rect" href="yubihsm_8c.html#ae87d5578703775b9d4151a14435f4a73" title=" " alt="" coords="529,423,692,449"/>
<area shape="poly" title=" " alt="" coords="841,1213,836,1058,819,831,804,715,783,608,756,521,739,487,721,462,707,451,691,444,693,439,710,447,725,458,744,484,761,519,788,607,809,714,824,831,841,1058,846,1213"/>
<area shape="rect" href="yubihsm_8c.html#a47768ae0e72beba49f02db1baddf4823" title=" " alt="" coords="540,473,681,498"/>
<area shape="poly" title=" " alt="" coords="840,1213,834,1066,816,855,801,746,780,647,754,566,738,535,721,511,703,498,681,490,682,485,705,493,725,508,743,532,759,564,785,646,806,745,821,854,839,1066,846,1213"/>
<area shape="rect" href="yubihsm_8c.html#ac154da7ac6dc0a7b4b3a6cdff9433da8" title=" " alt="" coords="501,522,720,548"/>
<area shape="poly" title=" " alt="" coords="840,1213,832,1075,813,879,797,778,777,686,752,611,737,582,721,561,708,550,711,546,725,557,741,579,757,609,782,685,803,777,818,878,838,1075,845,1213"/>
<area shape="rect" href="yubihsm_8c.html#a19c79faaf10c405864f0179821d551a5" title=" " alt="" coords="526,621,695,646"/>
<area shape="poly" title=" " alt="" coords="839,1214,828,1094,806,927,790,843,771,766,748,703,735,679,721,661,694,644,697,639,724,657,739,676,753,701,776,764,796,842,812,927,834,1093,844,1213"/>
<area shape="rect" href="yubihsm_8c.html#a1249c920eec24f634d04eaafb90a1ca2" title=" " alt="" coords="535,2003,686,2029"/>
<area shape="poly" title=" " alt="" coords="846,1270,840,1420,823,1638,807,1750,786,1852,759,1937,743,1969,725,1994,707,2007,688,2015,686,2010,705,2002,721,1990,738,1966,754,1935,781,1851,802,1749,817,1637,835,1420,840,1270"/>
<area shape="rect" href="yubihsm_8c.html#addc22271306d847f53321984f41d818b" title=" " alt="" coords="547,671,674,711"/>
<area shape="poly" title=" " alt="" coords="838,1214,825,1106,801,959,785,885,766,817,745,762,721,725,699,709,673,700,675,695,702,704,725,721,749,760,771,816,790,884,806,958,830,1106,843,1213"/>
<area shape="rect" href="yubihsm_8c.html#ae0fc8d6520950868365011d1a9f450f1" title=" " alt="" coords="531,735,690,761"/>
<area shape="poly" title=" " alt="" coords="837,1214,823,1115,799,982,783,916,764,855,744,807,721,774,706,764,690,756,692,752,709,759,725,770,748,804,769,854,788,914,804,981,829,1114,843,1213"/>
<area shape="rect" href="yubihsm_8c.html#a3a9729ea5b2e299a735b43f2b23e50a7" title=" " alt="" coords="528,785,693,810"/>
<area shape="poly" title=" " alt="" coords="842,1213,839,1135,834,1084,824,1030,809,973,788,918,759,868,721,824,692,807,695,802,724,820,763,865,793,916,814,972,830,1028,839,1084,845,1135,847,1213"/>
<area shape="rect" href="yubihsm_8c.html#ae5bf13f9558bb0340468b722accf94d3" title=" " alt="" coords="531,883,690,909"/>
<area shape="poly" title=" " alt="" coords="839,1213,831,1152,811,1073,796,1032,776,991,751,954,721,922,706,912,689,905,691,900,708,908,724,918,755,951,781,989,801,1029,816,1071,836,1151,844,1213"/>
<area shape="rect" href="yubihsm_8c.html#a7cbea7103efff8473ccfaaa35bfc6346" title=" " alt="" coords="544,571,677,597"/>
<area shape="poly" title=" " alt="" coords="839,1213,830,1084,810,902,794,810,774,725,750,656,736,630,721,610,701,596,677,588,678,583,703,591,725,606,740,627,755,654,779,724,799,808,815,902,836,1084,845,1213"/>
<area shape="rect" href="yubihsm_8c.html#a4bb1d420f681bc91bd36dc08695dbad6" title=" " alt="" coords="517,933,704,958"/>
<area shape="poly" title=" " alt="" coords="837,1214,826,1161,804,1095,789,1061,770,1028,748,998,721,972,703,960,705,956,724,967,752,994,775,1025,794,1059,809,1093,831,1160,842,1213"/>
<area shape="rect" href="yubihsm_8c.html#a5c153fe27877bcc7927d391fb55550af" title=" " alt="" coords="540,982,681,1008"/>
<area shape="poly" title=" " alt="" coords="834,1215,820,1171,797,1118,764,1065,744,1042,721,1021,702,1010,680,1003,682,998,704,1005,724,1017,748,1038,769,1062,802,1116,825,1169,839,1213"/>
<area shape="rect" href="yubihsm_8c.html#a9d844855c9066bbea0e4344978dd7fdc" title=" " alt="" coords="537,1179,684,1205"/>
<area shape="poly" title=" " alt="" coords="765,1228,675,1208,676,1203,766,1222"/>
<area shape="rect" href="yubihsm_8c.html#a85ac840aec77cb1ca3c3ce1f2ab26282" title=" " alt="" coords="547,1803,674,1829"/>
<area shape="poly" title=" " alt="" coords="844,1270,832,1385,810,1542,794,1622,774,1694,751,1754,725,1794,701,1810,675,1818,673,1813,699,1805,721,1790,747,1751,769,1693,788,1620,804,1541,827,1384,839,1270"/>
<area shape="rect" href="yubihsm_8c.html#a5988faffd97366b188728ff1a7fb6e89" title=" " alt="" coords="531,2300,690,2341"/>
<area shape="poly" title=" " alt="" coords="845,1270,832,1485,807,1809,791,1973,771,2118,750,2229,738,2266,725,2290,709,2303,691,2313,689,2308,706,2299,721,2287,733,2264,744,2227,766,2117,785,1973,802,1809,827,1485,839,1270"/>
<area shape="rect" href="yubihsm_8c.html#a5121c90d3bd745afd8264fef2ef39ace" title=" " alt="" coords="544,834,677,860"/>
<area shape="poly" title=" " alt="" coords="841,1213,835,1144,818,1051,803,1002,782,955,755,911,721,873,700,860,676,852,678,847,702,855,724,869,759,908,787,952,808,1001,823,1050,840,1143,846,1213"/>
<area shape="rect" href="yubihsm_8c.html#a690a5585de21ce82495e139ec1dfdf9d" title=" " alt="" coords="544,1081,677,1106"/>
<area shape="poly" title=" " alt="" coords="824,1218,781,1167,753,1141,721,1120,676,1104,678,1099,724,1115,756,1137,785,1163,828,1214"/>
<area shape="rect" href="yubihsm_8c.html#a9000d43fe8cf7313b319f316521eb0c4" title=" " alt="" coords="546,1130,675,1156"/>
<area shape="poly" title=" " alt="" coords="813,1222,771,1194,722,1169,675,1155,676,1150,724,1164,773,1190,816,1217"/>
<area shape="rect" href="yubihsm_8c.html#aa0a7644b7b368d6aaf8b4aff5e3d19b8" title=" " alt="" coords="530,1229,691,1254"/>
<area shape="poly" title=" " alt="" coords="755,1244,691,1244,691,1239,755,1239"/>
<area shape="poly" title=" " alt="" coords="517,301,449,320,448,314,515,296"/>
<area shape="poly" title=" " alt="" coords="648,232,634,226,610,223,590,225,576,230,570,236,570,244,565,244,565,234,574,225,589,220,611,218,635,220,650,227"/>
<area shape="poly" title=" " alt="" coords="340,1539,193,1430,196,1426,343,1535"/>
<area shape="poly" title=" " alt="" coords="522,1937,499,1944,440,1974,394,2005,391,2001,438,1970,497,1939,520,1931"/>
<area shape="poly" title=" " alt="" coords="562,1900,526,1876,496,1843,475,1801,464,1763,461,1727,462,1692,465,1620,461,1580,448,1535,434,1504,416,1475,383,1430,388,1427,421,1472,438,1501,453,1533,466,1579,471,1620,468,1692,466,1727,469,1762,480,1799,501,1840,530,1872,565,1895"/>
<area shape="poly" title=" " alt="" coords="520,1904,497,1893,414,1839,335,1775,263,1706,198,1637,95,1510,38,1430,42,1427,99,1507,202,1633,266,1703,339,1771,417,1835,500,1889,522,1899"/>
<area shape="poly" title=" " alt="" coords="516,1311,500,1317,466,1337,435,1360,389,1404,385,1400,431,1356,463,1333,497,1313,514,1306"/>
<area shape="poly" title=" " alt="" coords="529,1359,499,1367,404,1404,402,1399,497,1362,528,1353"/>
<area shape="poly" title=" " alt="" coords="524,1401,443,1410,443,1405,524,1396"/>
<area shape="poly" title=" " alt="" coords="527,1433,443,1425,443,1419,527,1428"/>
<area shape="poly" title=" " alt="" coords="523,1474,498,1467,403,1431,405,1426,499,1462,525,1469"/>
<area shape="poly" title=" " alt="" coords="511,1522,497,1516,463,1496,431,1473,385,1430,389,1426,435,1469,466,1492,500,1511,513,1517"/>
<area shape="poly" title=" " alt="" coords="524,1579,497,1565,457,1533,423,1494,380,1430,384,1427,428,1491,461,1529,500,1561,527,1574"/>
<area shape="poly" title=" " alt="" coords="505,1635,497,1629,476,1607,467,1586,460,1562,448,1535,381,1430,386,1427,453,1532,465,1560,472,1584,481,1604,500,1625,508,1631"/>
<area shape="poly" title=" " alt="" coords="518,340,449,340,449,335,518,335"/>
<area shape="poly" title=" " alt="" coords="531,1986,399,2014,398,2009,530,1981"/>
<area shape="poly" title=" " alt="" coords="527,1699,497,1680,481,1662,472,1645,464,1611,461,1576,448,1535,414,1475,382,1430,387,1427,418,1472,453,1533,466,1575,470,1610,477,1643,486,1659,500,1676,530,1694"/>
<area shape="poly" title=" " alt="" coords="518,1758,497,1744,476,1718,465,1694,461,1670,460,1645,461,1594,458,1565,448,1535,415,1475,383,1430,387,1427,420,1472,453,1533,463,1564,467,1593,466,1645,466,1669,470,1692,481,1716,500,1740,521,1754"/>
<area shape="poly" title=" " alt="" coords="519,2019,398,2019,398,2014,519,2014"/>
<area shape="poly" title=" " alt="" coords="528,578,497,562,473,542,452,517,418,464,394,411,379,367,384,365,399,409,423,461,456,514,477,538,500,558,530,573"/>
<area shape="poly" title=" " alt="" coords="516,2303,497,2290,467,2260,442,2225,422,2187,406,2149,384,2079,374,2030,379,2029,389,2077,411,2147,427,2185,447,2222,471,2256,500,2286,519,2299"/>
<area shape="poly" title=" " alt="" coords="530,855,514,862,500,873,486,890,473,914,449,977,429,1054,412,1138,389,1298,378,1402,373,1401,384,1297,407,1137,424,1053,444,975,468,912,482,887,496,869,511,858,528,850"/>
<area shape="poly" title=" " alt="" coords="531,1103,500,1120,469,1152,443,1190,422,1230,407,1272,387,1349,378,1402,373,1401,381,1348,401,1270,418,1228,438,1187,464,1148,497,1115,528,1099"/>
<area shape="poly" title=" " alt="" coords="532,1153,500,1169,472,1195,449,1226,429,1259,413,1293,391,1357,380,1402,374,1401,386,1355,408,1291,424,1257,444,1223,468,1192,497,1165,530,1148"/>
<area shape="poly" title=" " alt="" coords="517,1259,500,1268,460,1299,426,1337,384,1403,379,1400,422,1334,456,1296,497,1263,514,1255"/>
</map>
</div>

</div>
</div>
<a id="a296b43eadb1151017ba8e9578b351c5e" name="a296b43eadb1151017ba8e9578b351c5e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a296b43eadb1151017ba8e9578b351c5e">&#9670;&#160;</a></span>yh_begin_create_session_ext()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_begin_create_session_ext </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__connector.html">yh_connector</a> *</td>          <td class="paramname"><span class="paramname"><em>connector</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a></td>          <td class="paramname"><span class="paramname"><em>authkey_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> **</td>          <td class="paramname"><span class="paramname"><em>context</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>card_cryptogram</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>card_cryptogram_len</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structyh__session.html">yh_session</a> **</td>          <td class="paramname"><span class="paramname"><em>session</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Begin creating an external session. The session's encryption key and MAC key are not stored in the device.</p>
<p>This function must be followed by <a class="el" href="yubihsm_8h.html#afbcb5c761339fbcf444be8f338b4614f">yh_finish_create_session_ext()</a> to set the session keys.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">connector</td><td>Connector to the device </td></tr>
    <tr><td class="paramname">authkey_id</td><td>Object ID of the Authentication Key used to authenticate the session </td></tr>
    <tr><td class="paramname">context</td><td>pointer to where context data is saved </td></tr>
    <tr><td class="paramname">card_cryptogram</td><td>Card cryptogram </td></tr>
    <tr><td class="paramname">card_cryptogram_len</td><td>Length of card cryptogram </td></tr>
    <tr><td class="paramname">session</td><td>created session</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> if input parameters are NULL. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a75ea079345046cdbf5612bf9065d8711" title="Returned value when unable to allocate memory.">YHR_MEMORY_ERROR</a> if failed to allocate memory for the session. See <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> for other possible errors</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a href="https://developers.yubico.com/YubiHSM2/Concepts/Session.html">Session</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l00751">751</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  754</span>                                                        {</div>
<div class="line"><span class="lineno">  755</span> </div>
<div class="line"><span class="lineno">  756</span>  <a class="code hl_union" href="union___msg.html">Msg</a> msg;</div>
<div class="line"><span class="lineno">  757</span>  <a class="code hl_union" href="union___msg.html">Msg</a> response_msg;</div>
<div class="line"><span class="lineno">  758</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno">  759</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *ptr;</div>
<div class="line"><span class="lineno">  760</span>  <a class="code hl_struct" href="structyh__session.html">yh_session</a> *new_session;</div>
<div class="line"><span class="lineno">  761</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> host_challenge[<a class="code hl_define" href="yubihsm_8h.html#a397824bc3574858c6c4502b81f7fae31">YH_HOST_CHAL_LEN</a>];</div>
<div class="line"><span class="lineno">  762</span> </div>
<div class="line"><span class="lineno">  763</span>  <span class="keywordflow">if</span> (connector == NULL || <a class="code hl_struct" href="structcontext.html">context</a> == NULL || card_cryptogram == NULL ||</div>
<div class="line"><span class="lineno">  764</span>      card_cryptogram_len != <a class="code hl_define" href="scp_8h.html#afa9d0a3bb1ce2a7951ca1b5f9f06dbe7">SCP_CARD_CRYPTO_LEN</a> || <a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a> == NULL) {</div>
<div class="line"><span class="lineno">  765</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>));</div>
<div class="line"><span class="lineno">  766</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno">  767</span>  }</div>
<div class="line"><span class="lineno">  768</span> </div>
<div class="line"><span class="lineno">  769</span>  <span class="keywordflow">if</span> (!<a class="code hl_function" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75">rand_generate</a>(host_challenge, <span class="keyword">sizeof</span>(host_challenge))) {</div>
<div class="line"><span class="lineno">  770</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a39fbc5bce29b178582419ae9d31ad252">YHR_GENERIC_ERROR</a>;</div>
<div class="line"><span class="lineno">  771</span>  } <span class="comment">// TODO(adma): take this as an input so that it can be generated from the</span></div>
<div class="line"><span class="lineno">  772</span>  <span class="comment">// YubiKey</span></div>
<div class="line"><span class="lineno">  773</span> </div>
<div class="line"><span class="lineno">  774</span><span class="comment">  /**********/</span></div>
<div class="line"><span class="lineno">  775</span>  <span class="comment">// TODO(adma): replace with func</span></div>
<div class="line"><span class="lineno">  776</span>  new_session = calloc(1, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structyh__session.html">yh_session</a>));</div>
<div class="line"><span class="lineno">  777</span>  <span class="keywordflow">if</span> (new_session == NULL) {</div>
<div class="line"><span class="lineno">  778</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a75ea079345046cdbf5612bf9065d8711">YHR_MEMORY_ERROR</a>));</div>
<div class="line"><span class="lineno">  779</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a75ea079345046cdbf5612bf9065d8711">YHR_MEMORY_ERROR</a>;</div>
<div class="line"><span class="lineno">  780</span>  }</div>
<div class="line"><span class="lineno">  781</span> </div>
<div class="line"><span class="lineno">  782</span>  <span class="comment">// Send CREATE SESSION command</span></div>
<div class="line"><span class="lineno">  783</span>  msg.<a class="code hl_variable" href="union___msg.html#a6b67958147999d1199c922c26763d7f0">st</a>.cmd = YHC_CREATE_SESSION;</div>
<div class="line"><span class="lineno">  784</span>  msg.<a class="code hl_variable" href="union___msg.html#a6b67958147999d1199c922c26763d7f0">st</a>.len = <a class="code hl_define" href="scp_8h.html#aaa32e6b7edd5513108f1410315fa594e">SCP_AUTHKEY_ID_LEN</a> + <a class="code hl_define" href="scp_8h.html#ac8a88e113e5d7d245aeb27e841214563">SCP_HOST_CHAL_LEN</a>;</div>
<div class="line"><span class="lineno">  785</span> </div>
<div class="line"><span class="lineno">  786</span>  <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> authkey_id_n = htons(authkey_id);</div>
<div class="line"><span class="lineno">  787</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(msg.<a class="code hl_variable" href="union___msg.html#a6b67958147999d1199c922c26763d7f0">st</a>.data, &amp;authkey_id_n, <a class="code hl_define" href="scp_8h.html#aaa32e6b7edd5513108f1410315fa594e">SCP_AUTHKEY_ID_LEN</a>);</div>
<div class="line"><span class="lineno">  788</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(msg.<a class="code hl_variable" href="union___msg.html#a6b67958147999d1199c922c26763d7f0">st</a>.data + <a class="code hl_define" href="scp_8h.html#aaa32e6b7edd5513108f1410315fa594e">SCP_AUTHKEY_ID_LEN</a>, host_challenge, <a class="code hl_define" href="scp_8h.html#ac8a88e113e5d7d245aeb27e841214563">SCP_HOST_CHAL_LEN</a>);</div>
<div class="line"><span class="lineno">  789</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(new_session-&gt;<a class="code hl_variable" href="structyh__session.html#a92d2141eb31c70c19d90519c6446c12d">context</a>, host_challenge, <a class="code hl_define" href="scp_8h.html#ac8a88e113e5d7d245aeb27e841214563">SCP_HOST_CHAL_LEN</a>);</div>
<div class="line"><span class="lineno">  790</span> </div>
<div class="line"><span class="lineno">  791</span>  <a class="code hl_define" href="debug__lib_8h.html#a81b33f0d4ec623bff78e988d14388d60">DBG_INT</a>(host_challenge, <a class="code hl_define" href="scp_8h.html#ac8a88e113e5d7d245aeb27e841214563">SCP_HOST_CHAL_LEN</a>, <span class="stringliteral">&quot;Host challenge: &quot;</span>);</div>
<div class="line"><span class="lineno">  792</span> </div>
<div class="line"><span class="lineno">  793</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = send_msg(connector, &amp;msg, &amp;response_msg);</div>
<div class="line"><span class="lineno">  794</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno">  795</span>    <span class="keywordflow">goto</span> bcse_failure;</div>
<div class="line"><span class="lineno">  796</span>  }</div>
<div class="line"><span class="lineno">  797</span> </div>
<div class="line"><span class="lineno">  798</span>  <span class="comment">// Parse response</span></div>
<div class="line"><span class="lineno">  799</span>  <span class="keywordflow">if</span> (response_msg.<a class="code hl_variable" href="union___msg.html#a6b67958147999d1199c922c26763d7f0">st</a>.cmd != YHC_CREATE_SESSION_R) {</div>
<div class="line"><span class="lineno">  800</span>    <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> translated = translate_device_error(response_msg.<a class="code hl_variable" href="union___msg.html#a6b67958147999d1199c922c26763d7f0">st</a>.data[0]);</div>
<div class="line"><span class="lineno">  801</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Device error %s (%d)&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(translated),</div>
<div class="line"><span class="lineno">  802</span>            response_msg.<a class="code hl_variable" href="union___msg.html#a6b67958147999d1199c922c26763d7f0">st</a>.data[0]);</div>
<div class="line"><span class="lineno">  803</span>    <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = translated;</div>
<div class="line"><span class="lineno">  804</span>    <span class="keywordflow">goto</span> bcse_failure;</div>
<div class="line"><span class="lineno">  805</span>  }</div>
<div class="line"><span class="lineno">  806</span> </div>
<div class="line"><span class="lineno">  807</span>  <span class="keywordflow">if</span> (response_msg.<a class="code hl_variable" href="union___msg.html#a6b67958147999d1199c922c26763d7f0">st</a>.len != 1 + <a class="code hl_define" href="scp_8h.html#aa341425f7d11b792662ebc93abf38cde">SCP_CARD_CHAL_LEN</a> + <a class="code hl_define" href="scp_8h.html#afa9d0a3bb1ce2a7951ca1b5f9f06dbe7">SCP_CARD_CRYPTO_LEN</a>) {</div>
<div class="line"><span class="lineno">  808</span>    <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366ae0b26dcb22aa228ab08c9e59a8975952">YHR_WRONG_LENGTH</a>;</div>
<div class="line"><span class="lineno">  809</span>    <span class="keywordflow">goto</span> bcse_failure;</div>
<div class="line"><span class="lineno">  810</span>  }</div>
<div class="line"><span class="lineno">  811</span> </div>
<div class="line"><span class="lineno">  812</span>  ptr = response_msg.<a class="code hl_variable" href="union___msg.html#a6b67958147999d1199c922c26763d7f0">st</a>.data;</div>
<div class="line"><span class="lineno">  813</span> </div>
<div class="line"><span class="lineno">  814</span>  <span class="comment">// Save sid</span></div>
<div class="line"><span class="lineno">  815</span>  new_session-&gt;<a class="code hl_variable" href="structyh__session.html#a5582d82fd5b88d1e26738437268fb285">s</a>.<a class="code hl_variable" href="struct_scp__ctx.html#af58bb8b1e7185c27de7c8a2df94de1f5">sid</a> = (*ptr++);</div>
<div class="line"><span class="lineno">  816</span> </div>
<div class="line"><span class="lineno">  817</span>  <span class="comment">// Save card challenge</span></div>
<div class="line"><span class="lineno">  818</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(new_session-&gt;<a class="code hl_variable" href="structyh__session.html#a92d2141eb31c70c19d90519c6446c12d">context</a> + <a class="code hl_define" href="scp_8h.html#ac8a88e113e5d7d245aeb27e841214563">SCP_HOST_CHAL_LEN</a>, ptr, <a class="code hl_define" href="scp_8h.html#aa341425f7d11b792662ebc93abf38cde">SCP_CARD_CHAL_LEN</a>);</div>
<div class="line"><span class="lineno">  819</span>  ptr += <a class="code hl_define" href="scp_8h.html#aa341425f7d11b792662ebc93abf38cde">SCP_CARD_CHAL_LEN</a>;</div>
<div class="line"><span class="lineno">  820</span> </div>
<div class="line"><span class="lineno">  821</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(card_cryptogram, ptr, <a class="code hl_define" href="scp_8h.html#afa9d0a3bb1ce2a7951ca1b5f9f06dbe7">SCP_CARD_CRYPTO_LEN</a>);</div>
<div class="line"><span class="lineno">  822</span>  ptr += <a class="code hl_define" href="scp_8h.html#afa9d0a3bb1ce2a7951ca1b5f9f06dbe7">SCP_CARD_CRYPTO_LEN</a>;</div>
<div class="line"><span class="lineno">  823</span> </div>
<div class="line"><span class="lineno">  824</span>  <a class="code hl_define" href="debug__lib_8h.html#a8c4742440a149ad8bcb5d58ae76c5ed3">DBG_INFO</a>(<span class="stringliteral">&quot;Received Session ID: %d&quot;</span>, new_session-&gt;<a class="code hl_variable" href="structyh__session.html#a5582d82fd5b88d1e26738437268fb285">s</a>.<a class="code hl_variable" href="struct_scp__ctx.html#af58bb8b1e7185c27de7c8a2df94de1f5">sid</a>);</div>
<div class="line"><span class="lineno">  825</span> </div>
<div class="line"><span class="lineno">  826</span>  <a class="code hl_define" href="debug__lib_8h.html#a81b33f0d4ec623bff78e988d14388d60">DBG_INT</a>(new_session-&gt;<a class="code hl_variable" href="structyh__session.html#a92d2141eb31c70c19d90519c6446c12d">context</a> + <a class="code hl_define" href="scp_8h.html#ac8a88e113e5d7d245aeb27e841214563">SCP_HOST_CHAL_LEN</a>, <a class="code hl_define" href="scp_8h.html#aa341425f7d11b792662ebc93abf38cde">SCP_CARD_CHAL_LEN</a>,</div>
<div class="line"><span class="lineno">  827</span>          <span class="stringliteral">&quot;Card challenge: &quot;</span>);</div>
<div class="line"><span class="lineno">  828</span>  <a class="code hl_define" href="debug__lib_8h.html#a81b33f0d4ec623bff78e988d14388d60">DBG_INT</a>(card_cryptogram, <a class="code hl_define" href="scp_8h.html#afa9d0a3bb1ce2a7951ca1b5f9f06dbe7">SCP_CARD_CRYPTO_LEN</a>, <span class="stringliteral">&quot;Card cryptogram: &quot;</span>);</div>
<div class="line"><span class="lineno">  829</span> </div>
<div class="line"><span class="lineno">  830</span>  <span class="comment">// Save link back to connector</span></div>
<div class="line"><span class="lineno">  831</span>  new_session-&gt;<a class="code hl_variable" href="structyh__session.html#a481fb0215d72e52bb619d6c934078167">parent</a> = connector;</div>
<div class="line"><span class="lineno">  832</span> </div>
<div class="line"><span class="lineno">  833</span>  *<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a> = new_session;</div>
<div class="line"><span class="lineno">  834</span>  *<a class="code hl_struct" href="structcontext.html">context</a> = new_session-&gt;<a class="code hl_variable" href="structyh__session.html#a92d2141eb31c70c19d90519c6446c12d">context</a>;</div>
<div class="line"><span class="lineno">  835</span> </div>
<div class="line"><span class="lineno">  836</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno">  837</span> </div>
<div class="line"><span class="lineno">  838</span>bcse_failure:</div>
<div class="line"><span class="lineno">  839</span>  free(new_session);</div>
<div class="line"><span class="lineno">  840</span>  (new_session) = NULL;</div>
<div class="line"><span class="lineno">  841</span> </div>
<div class="line"><span class="lineno">  842</span>  <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno">  843</span> </div>
<div class="line"><span class="lineno">  844</span>  <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno">  845</span>}</div>
<div class="ttc" id="adebug__lib_8h_html_a8c4742440a149ad8bcb5d58ae76c5ed3"><div class="ttname"><a href="debug__lib_8h.html#a8c4742440a149ad8bcb5d58ae76c5ed3">DBG_INFO</a></div><div class="ttdeci">#define DBG_INFO(...)</div><div class="ttdef"><b>Definition</b> <a href="debug__lib_8h_source.html#l00063">debug_lib.h:63</a></div></div>
<div class="ttc" id="arand_8c_html_a2d3d1e86f4093fbe0a1b2a7eede4cd75"><div class="ttname"><a href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75">rand_generate</a></div><div class="ttdeci">bool rand_generate(uint8_t *buf, size_t cb_buf)</div><div class="ttdef"><b>Definition</b> <a href="rand_8c_source.html#l00027">rand.c:27</a></div></div>
<div class="ttc" id="ascp_8h_html_aa341425f7d11b792662ebc93abf38cde"><div class="ttname"><a href="scp_8h.html#aa341425f7d11b792662ebc93abf38cde">SCP_CARD_CHAL_LEN</a></div><div class="ttdeci">#define SCP_CARD_CHAL_LEN</div><div class="ttdef"><b>Definition</b> <a href="scp_8h_source.html#l00040">scp.h:40</a></div></div>
<div class="ttc" id="ascp_8h_html_aaa32e6b7edd5513108f1410315fa594e"><div class="ttname"><a href="scp_8h.html#aaa32e6b7edd5513108f1410315fa594e">SCP_AUTHKEY_ID_LEN</a></div><div class="ttdeci">#define SCP_AUTHKEY_ID_LEN</div><div class="ttdef"><b>Definition</b> <a href="scp_8h_source.html#l00050">scp.h:50</a></div></div>
<div class="ttc" id="ascp_8h_html_ac8a88e113e5d7d245aeb27e841214563"><div class="ttname"><a href="scp_8h.html#ac8a88e113e5d7d245aeb27e841214563">SCP_HOST_CHAL_LEN</a></div><div class="ttdeci">#define SCP_HOST_CHAL_LEN</div><div class="ttdef"><b>Definition</b> <a href="scp_8h_source.html#l00041">scp.h:41</a></div></div>
<div class="ttc" id="ascp_8h_html_afa9d0a3bb1ce2a7951ca1b5f9f06dbe7"><div class="ttname"><a href="scp_8h.html#afa9d0a3bb1ce2a7951ca1b5f9f06dbe7">SCP_CARD_CRYPTO_LEN</a></div><div class="ttdeci">#define SCP_CARD_CRYPTO_LEN</div><div class="ttdef"><b>Definition</b> <a href="scp_8h_source.html#l00043">scp.h:43</a></div></div>
<div class="ttc" id="astruct_scp__ctx_html_af58bb8b1e7185c27de7c8a2df94de1f5"><div class="ttname"><a href="struct_scp__ctx.html#af58bb8b1e7185c27de7c8a2df94de1f5">Scp_ctx::sid</a></div><div class="ttdeci">uint8_t sid</div><div class="ttdef"><b>Definition</b> <a href="scp_8h_source.html#l00069">scp.h:69</a></div></div>
<div class="ttc" id="astructcontext_html"><div class="ttname"><a href="structcontext.html">context</a></div><div class="ttdef"><b>Definition</b> <a href="yubihsm__winhttp_8c_source.html#l00052">yubihsm_winhttp.c:52</a></div></div>
<div class="ttc" id="astructyh__session_html"><div class="ttname"><a href="structyh__session.html">yh_session</a></div><div class="ttdef"><b>Definition</b> <a href="lib_2internal_8h_source.html#l00025">internal.h:25</a></div></div>
<div class="ttc" id="astructyh__session_html_a481fb0215d72e52bb619d6c934078167"><div class="ttname"><a href="structyh__session.html#a481fb0215d72e52bb619d6c934078167">yh_session::parent</a></div><div class="ttdeci">struct yh_connector * parent</div><div class="ttdef"><b>Definition</b> <a href="lib_2internal_8h_source.html#l00026">internal.h:26</a></div></div>
<div class="ttc" id="astructyh__session_html_a5582d82fd5b88d1e26738437268fb285"><div class="ttname"><a href="structyh__session.html#a5582d82fd5b88d1e26738437268fb285">yh_session::s</a></div><div class="ttdeci">Scp_ctx s</div><div class="ttdef"><b>Definition</b> <a href="lib_2internal_8h_source.html#l00031">internal.h:31</a></div></div>
<div class="ttc" id="astructyh__session_html_a92d2141eb31c70c19d90519c6446c12d"><div class="ttname"><a href="structyh__session.html#a92d2141eb31c70c19d90519c6446c12d">yh_session::context</a></div><div class="ttdeci">uint8_t context[SCP_CONTEXT_LEN]</div><div class="ttdef"><b>Definition</b> <a href="lib_2internal_8h_source.html#l00032">internal.h:32</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a397824bc3574858c6c4502b81f7fae31"><div class="ttname"><a href="yubihsm_8h.html#a397824bc3574858c6c4502b81f7fae31">YH_HOST_CHAL_LEN</a></div><div class="ttdeci">#define YH_HOST_CHAL_LEN</div><div class="ttdoc">Length of host challenge for authentication.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00091">yubihsm.h:91</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_ae4f602d2343d01b1727dfd633169d366a39fbc5bce29b178582419ae9d31ad252"><div class="ttname"><a href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a39fbc5bce29b178582419ae9d31ad252">YHR_GENERIC_ERROR</a></div><div class="ttdeci">@ YHR_GENERIC_ERROR</div><div class="ttdoc">Return value when encountering an unknown error.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00228">yubihsm.h:228</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_ae4f602d2343d01b1727dfd633169d366a75ea079345046cdbf5612bf9065d8711"><div class="ttname"><a href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a75ea079345046cdbf5612bf9065d8711">YHR_MEMORY_ERROR</a></div><div class="ttdeci">@ YHR_MEMORY_ERROR</div><div class="ttdoc">Returned value when unable to allocate memory.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00174">yubihsm.h:174</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_ae4f602d2343d01b1727dfd633169d366ae0b26dcb22aa228ab08c9e59a8975952"><div class="ttname"><a href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366ae0b26dcb22aa228ab08c9e59a8975952">YHR_WRONG_LENGTH</a></div><div class="ttdeci">@ YHR_WRONG_LENGTH</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00185">yubihsm.h:185</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a296b43eadb1151017ba8e9578b351c5e_cgraph.png" border="0" usemap="#ayubihsm_8c_a296b43eadb1151017ba8e9578b351c5e_cgraph" alt=""/></div>
<map name="ayubihsm_8c_a296b43eadb1151017ba8e9578b351c5e_cgraph" id="ayubihsm_8c_a296b43eadb1151017ba8e9578b351c5e_cgraph">
<area shape="rect" title=" " alt="" coords="5,55,199,80"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="263,5,334,31"/>
<area shape="poly" title=" " alt="" coords="156,51,247,28,248,33,157,57"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="247,55,350,80"/>
<area shape="poly" title=" " alt="" coords="199,65,231,65,231,70,199,70"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="257,104,340,130"/>
<area shape="poly" title=" " alt="" coords="157,78,242,100,241,105,156,84"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a296b43eadb1151017ba8e9578b351c5e_icgraph.png" border="0" usemap="#ayubihsm_8c_a296b43eadb1151017ba8e9578b351c5e_icgraph" alt=""/></div>
<map name="ayubihsm_8c_a296b43eadb1151017ba8e9578b351c5e_icgraph" id="ayubihsm_8c_a296b43eadb1151017ba8e9578b351c5e_icgraph">
<area shape="rect" title=" " alt="" coords="498,31,692,56"/>
<area shape="rect" href="commands_8c.html#a22f22a25151b12c7573f80563a341368" title=" " alt="" coords="296,31,450,56"/>
<area shape="poly" title=" " alt="" coords="483,46,451,46,451,41,483,41"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="280,34,248,30,249,25,281,29"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,31,55,56"/>
<area shape="poly" title=" " alt="" coords="280,46,55,46,55,41,280,41"/>
<area shape="poly" title=" " alt="" coords="88,36,55,42,54,37,87,31"/>
</map>
</div>

</div>
</div>
<a id="ac46bac75dfd0a4358a4e6b432a50e48a" name="ac46bac75dfd0a4358a4e6b432a50e48a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac46bac75dfd0a4358a4e6b432a50e48a">&#9670;&#160;</a></span>yh_capabilities_to_strings()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_capabilities_to_strings </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structyh__capabilities.html">yh_capabilities</a> *</td>          <td class="paramname"><span class="paramname"><em>num</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>result</em></span>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *</td>          <td class="paramname"><span class="paramname"><em>n_result</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Convert an array of <a class="el" href="structyh__capabilities.html" title="Capabilities representation.">yh_capabilities</a> into strings separated by ','</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">num</td><td>Array of <a class="el" href="structyh__capabilities.html" title="Capabilities representation.">yh_capabilities</a> </td></tr>
    <tr><td class="paramname">result</td><td>Array of the capabilies as strings </td></tr>
    <tr><td class="paramname">n_result</td><td>Number of elements in result</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> if input parameters are NULL. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366ad8971a0b9647564b76b3f4e4b662c965" title="Returned value when there is not enough space to store data.">YHR_BUFFER_TOO_SMALL</a> if <code>n_result</code> is too small</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a href="https://developers.yubico.com/YubiHSM2/Concepts/Capability.html">Capability</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l04168">4168</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4169</span>                                                                         {</div>
<div class="line"><span class="lineno"> 4170</span> </div>
<div class="line"><span class="lineno"> 4171</span>  <span class="keywordflow">if</span> (num == 0 || result == NULL || n_result == NULL) {</div>
<div class="line"><span class="lineno"> 4172</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>));</div>
<div class="line"><span class="lineno"> 4173</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 4174</span>  }</div>
<div class="line"><span class="lineno"> 4175</span> </div>
<div class="line"><span class="lineno"> 4176</span>  <span class="keywordtype">size_t</span> matching = 0;</div>
<div class="line"><span class="lineno"> 4177</span> </div>
<div class="line"><span class="lineno"> 4178</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <span class="keyword">sizeof</span>(yh_capability) / <span class="keyword">sizeof</span>(yh_capability[0]);</div>
<div class="line"><span class="lineno"> 4179</span>       i++) {</div>
<div class="line"><span class="lineno"> 4180</span>    <span class="keywordflow">if</span> (((1ULL &lt;&lt; (yh_capability[i].<a class="code hl_variable" href="yubihsm_8h.html#a276ec4ea44aa77416c732159c90a37b9">bit</a> % 8)) &amp;</div>
<div class="line"><span class="lineno"> 4181</span>         <a class="code hl_enumvalue" href="namespace_i_r.html#aa1afcba889279fa935b76ba278be7fd6a0fc3cfbc27e91ea60a787de13dae3e3c">num</a>-&gt;capabilities[<a class="code hl_define" href="yubihsm_8h.html#ad3c904849d17cae0a6f426e8007731d7">YH_CAPABILITIES_LEN</a> - 1 -</div>
<div class="line"><span class="lineno"> 4182</span>                           (yh_capability[i].bit / 8)]) != 0) {</div>
<div class="line"><span class="lineno"> 4183</span>      <span class="keywordflow">if</span> (++matching &gt; *n_result) {</div>
<div class="line"><span class="lineno"> 4184</span>        <a class="code hl_function" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105">memset</a>(result, 0, *n_result);</div>
<div class="line"><span class="lineno"> 4185</span> </div>
<div class="line"><span class="lineno"> 4186</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366ad8971a0b9647564b76b3f4e4b662c965">YHR_BUFFER_TOO_SMALL</a>;</div>
<div class="line"><span class="lineno"> 4187</span>      }</div>
<div class="line"><span class="lineno"> 4188</span> </div>
<div class="line"><span class="lineno"> 4189</span>      result[matching - 1] = yh_capability[i].name;</div>
<div class="line"><span class="lineno"> 4190</span>    }</div>
<div class="line"><span class="lineno"> 4191</span>  }</div>
<div class="line"><span class="lineno"> 4192</span> </div>
<div class="line"><span class="lineno"> 4193</span>  *n_result = matching;</div>
<div class="line"><span class="lineno"> 4194</span> </div>
<div class="line"><span class="lineno"> 4195</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 4196</span>}</div>
<div class="ttc" id="anamespace_i_r_html_aa1afcba889279fa935b76ba278be7fd6a0fc3cfbc27e91ea60a787de13dae3e3c"><div class="ttname"><a href="namespace_i_r.html#aa1afcba889279fa935b76ba278be7fd6a0fc3cfbc27e91ea60a787de13dae3e3c">IR::ValueType::num</a></div><div class="ttdeci">@ num</div></div>
<div class="ttc" id="ayubihsm_8h_html_a276ec4ea44aa77416c732159c90a37b9"><div class="ttname"><a href="yubihsm_8h.html#a276ec4ea44aa77416c732159c90a37b9">bit</a></div><div class="ttdeci">int bit</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00566">yubihsm.h:566</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_ad3c904849d17cae0a6f426e8007731d7"><div class="ttname"><a href="yubihsm_8h.html#ad3c904849d17cae0a6f426e8007731d7">YH_CAPABILITIES_LEN</a></div><div class="ttdeci">#define YH_CAPABILITIES_LEN</div><div class="ttdoc">Length of capabilities array.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00119">yubihsm.h:119</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_ae4f602d2343d01b1727dfd633169d366ad8971a0b9647564b76b3f4e4b662c965"><div class="ttname"><a href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366ad8971a0b9647564b76b3f4e4b662c965">YHR_BUFFER_TOO_SMALL</a></div><div class="ttdeci">@ YHR_BUFFER_TOO_SMALL</div><div class="ttdoc">Returned value when there is not enough space to store data.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00187">yubihsm.h:187</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_ac46bac75dfd0a4358a4e6b432a50e48a_cgraph.png" border="0" usemap="#ayubihsm_8c_ac46bac75dfd0a4358a4e6b432a50e48a_cgraph" alt=""/></div>
<map name="ayubihsm_8c_ac46bac75dfd0a4358a4e6b432a50e48a_cgraph" id="ayubihsm_8c_ac46bac75dfd0a4358a4e6b432a50e48a_cgraph">
<area shape="rect" title=" " alt="" coords="5,23,131,64"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="186,5,254,31"/>
<area shape="poly" title=" " alt="" coords="131,30,170,24,171,29,132,36"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="179,55,262,80"/>
<area shape="poly" title=" " alt="" coords="131,51,164,56,163,61,131,56"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_ac46bac75dfd0a4358a4e6b432a50e48a_icgraph.png" border="0" usemap="#ayubihsm_8c_ac46bac75dfd0a4358a4e6b432a50e48a_icgraph" alt=""/></div>
<map name="ayubihsm_8c_ac46bac75dfd0a4358a4e6b432a50e48a_icgraph" id="ayubihsm_8c_ac46bac75dfd0a4358a4e6b432a50e48a_icgraph">
<area shape="rect" title=" " alt="" coords="506,23,632,64"/>
<area shape="rect" href="commands_8c.html#afa7330c81148ba6f4d5c53f7c370ed41" title=" " alt="" coords="296,31,458,56"/>
<area shape="poly" title=" " alt="" coords="491,46,459,46,459,41,491,41"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="280,34,248,30,249,25,281,29"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,31,55,56"/>
<area shape="poly" title=" " alt="" coords="280,46,55,46,55,41,280,41"/>
<area shape="poly" title=" " alt="" coords="88,36,55,42,54,37,87,31"/>
</map>
</div>

</div>
</div>
<a id="aba384949362ccaf19cbeae3bb046489c" name="aba384949362ccaf19cbeae3bb046489c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba384949362ccaf19cbeae3bb046489c">&#9670;&#160;</a></span>yh_check_capability()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool yh_check_capability </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structyh__capabilities.html">yh_capabilities</a> *</td>          <td class="paramname"><span class="paramname"><em>capabilities</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>capability</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Check if a capability is set</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">capabilities</td><td>Array of <a class="el" href="structyh__capabilities.html" title="Capabilities representation.">yh_capabilities</a> </td></tr>
    <tr><td class="paramname">capability</td><td>Capability to check as a string.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True if the <code>capability</code> is in <code>capabilities</code>. False otherwise</dd></dl>
<dl class="section user"><dt>Code sample</dt><dd><pre class="fragment">char *capabilities_str = "sign-pkcs,decrypt-pkcs,set-option";
yh_capabilities capabilities = {{0}};
yh_string_to_capabilities(capabilities_str, &amp;capabilities);
//yh_check_capability(&amp;capabilities, "something") =&gt; false
//yh_check_capability(&amp;capabilities, "sign-pss") =&gt; false
//yh_check_capability(&amp;capabilities, "decrypt-pkcs") =&gt; true
</pre></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a href="https://developers.yubico.com/YubiHSM2/Concepts/Capability.html">Capability</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l04198">4198</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4199</span>                                                 {</div>
<div class="line"><span class="lineno"> 4200</span> </div>
<div class="line"><span class="lineno"> 4201</span>  <a class="code hl_struct" href="structyh__capabilities.html">yh_capabilities</a> check_capabilities = {{0}};</div>
<div class="line"><span class="lineno"> 4202</span> </div>
<div class="line"><span class="lineno"> 4203</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="#aab440e1cb671d9ba7a2e7d1243960e42">yh_string_to_capabilities</a>(capability, &amp;check_capabilities) !=</div>
<div class="line"><span class="lineno"> 4204</span>      <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 4205</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 4206</span>  }</div>
<div class="line"><span class="lineno"> 4207</span> </div>
<div class="line"><span class="lineno"> 4208</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_define" href="yubihsm_8h.html#ad3c904849d17cae0a6f426e8007731d7">YH_CAPABILITIES_LEN</a>; i++) {</div>
<div class="line"><span class="lineno"> 4209</span>    <span class="keywordflow">if</span> (check_capabilities.<a class="code hl_variable" href="structyh__capabilities.html#a5398bad7e61385aa127265ba0a053079">capabilities</a>[i] != 0 &amp;&amp;</div>
<div class="line"><span class="lineno"> 4210</span>        (check_capabilities.<a class="code hl_variable" href="structyh__capabilities.html#a5398bad7e61385aa127265ba0a053079">capabilities</a>[i] &amp; <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>-&gt;<a class="code hl_variable" href="structyh__capabilities.html#a5398bad7e61385aa127265ba0a053079">capabilities</a>[i]) !=</div>
<div class="line"><span class="lineno"> 4211</span>          0) {</div>
<div class="line"><span class="lineno"> 4212</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 4213</span>    }</div>
<div class="line"><span class="lineno"> 4214</span>  }</div>
<div class="line"><span class="lineno"> 4215</span> </div>
<div class="line"><span class="lineno"> 4216</span>  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 4217</span>}</div>
<div class="ttc" id="astructyh__capabilities_html"><div class="ttname"><a href="structyh__capabilities.html">yh_capabilities</a></div><div class="ttdoc">Capabilities representation.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00162">yubihsm.h:162</a></div></div>
<div class="ttc" id="astructyh__capabilities_html_a5398bad7e61385aa127265ba0a053079"><div class="ttname"><a href="structyh__capabilities.html#a5398bad7e61385aa127265ba0a053079">yh_capabilities::capabilities</a></div><div class="ttdeci">uint8_t capabilities[YH_CAPABILITIES_LEN]</div><div class="ttdoc">Capabilities is represented as an 8 byte uint8_t array.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00164">yubihsm.h:164</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_aab440e1cb671d9ba7a2e7d1243960e42"><div class="ttname"><a href="#aab440e1cb671d9ba7a2e7d1243960e42">yh_string_to_capabilities</a></div><div class="ttdeci">yh_rc yh_string_to_capabilities(const char *capability, yh_capabilities *result)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l04115">yubihsm.c:4115</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a08393519edfd7c59fb01fb8db97514b5"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a></div><div class="ttdeci">yh_capabilities capabilities</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l01305">yubihsm_pkcs11.c:1305</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_aba384949362ccaf19cbeae3bb046489c_cgraph.png" border="0" usemap="#ayubihsm_8c_aba384949362ccaf19cbeae3bb046489c_cgraph" alt=""/></div>
<map name="ayubihsm_8c_aba384949362ccaf19cbeae3bb046489c_cgraph" id="ayubihsm_8c_aba384949362ccaf19cbeae3bb046489c_cgraph">
<area shape="rect" title=" " alt="" coords="5,55,145,80"/>
<area shape="rect" href="yubihsm_8c.html#aab440e1cb671d9ba7a2e7d1243960e42" title=" " alt="" coords="193,55,357,80"/>
<area shape="poly" title=" " alt="" coords="145,65,177,65,177,70,145,70"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="411,5,482,31"/>
<area shape="poly" title=" " alt="" coords="322,51,395,30,397,35,323,57"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="412,55,481,80"/>
<area shape="poly" title=" " alt="" coords="357,65,397,65,397,70,357,70"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="405,104,488,130"/>
<area shape="poly" title=" " alt="" coords="323,78,391,98,389,103,322,84"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_aba384949362ccaf19cbeae3bb046489c_icgraph.png" border="0" usemap="#ayubihsm_8c_aba384949362ccaf19cbeae3bb046489c_icgraph" alt=""/></div>
<map name="ayubihsm_8c_aba384949362ccaf19cbeae3bb046489c_icgraph" id="ayubihsm_8c_aba384949362ccaf19cbeae3bb046489c_icgraph">
<area shape="rect" title=" " alt="" coords="204,60,343,86"/>
<area shape="rect" href="structsysio_1_1wallet_1_1detail_1_1yubihsm__wallet__impl.html#a6266bcd9001ddbb02101bea6088f299b" title=" " alt="" coords="5,5,156,61"/>
<area shape="poly" title=" " alt="" coords="193,59,155,51,156,46,194,54"/>
<area shape="rect" href="structsysio_1_1wallet_1_1detail_1_1yubihsm__wallet__impl.html#a00ee0ac7ac4a819d0b8755bf4f442263" title=" " alt="" coords="5,85,156,141"/>
<area shape="poly" title=" " alt="" coords="194,92,156,100,155,95,193,87"/>
</map>
</div>

</div>
</div>
<a id="aa19be6ac70a2a5d1cef8d7e6902fe05f" name="aa19be6ac70a2a5d1cef8d7e6902fe05f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa19be6ac70a2a5d1cef8d7e6902fe05f">&#9670;&#160;</a></span>yh_connect()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_connect </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__connector.html">yh_connector</a> *</td>          <td class="paramname"><span class="paramname"><em>connector</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>timeout</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Connect to the device through the specified connector</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">connector</td><td>Connector to the device </td></tr>
    <tr><td class="paramname">timeout</td><td>Connection timeout in seconds</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> if the connector does not exist. See <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> for other possible errors </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l04079">4079</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4079</span>                                                       {</div>
<div class="line"><span class="lineno"> 4080</span> </div>
<div class="line"><span class="lineno"> 4081</span>  <span class="keywordflow">if</span> (connector == NULL || connector-&gt;<a class="code hl_variable" href="structyh__connector.html#a88057cfd7ee5af648c3aa315bbff7f8e">bf</a> == NULL) {</div>
<div class="line"><span class="lineno"> 4082</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Invalid parameters: undefined pointer&quot;</span>);</div>
<div class="line"><span class="lineno"> 4083</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 4084</span>  }</div>
<div class="line"><span class="lineno"> 4085</span> </div>
<div class="line"><span class="lineno"> 4086</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a97917e1d5a9fa5e8b7a4495dc9234ac7">rc</a>;</div>
<div class="line"><span class="lineno"> 4087</span> </div>
<div class="line"><span class="lineno"> 4088</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a97917e1d5a9fa5e8b7a4495dc9234ac7">rc</a> = connector-&gt;<a class="code hl_variable" href="structyh__connector.html#a88057cfd7ee5af648c3aa315bbff7f8e">bf</a>-&gt;backend_connect(connector, timeout);</div>
<div class="line"><span class="lineno"> 4089</span> </div>
<div class="line"><span class="lineno"> 4090</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a97917e1d5a9fa5e8b7a4495dc9234ac7">rc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 4091</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Failed when connecting: %s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a97917e1d5a9fa5e8b7a4495dc9234ac7">rc</a>));</div>
<div class="line"><span class="lineno"> 4092</span>  }</div>
<div class="line"><span class="lineno"> 4093</span> </div>
<div class="line"><span class="lineno"> 4094</span>  <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a97917e1d5a9fa5e8b7a4495dc9234ac7">rc</a>;</div>
<div class="line"><span class="lineno"> 4095</span>}</div>
<div class="ttc" id="astructyh__connector_html_a88057cfd7ee5af648c3aa315bbff7f8e"><div class="ttname"><a href="structyh__connector.html#a88057cfd7ee5af648c3aa315bbff7f8e">yh_connector::bf</a></div><div class="ttdeci">struct backend_functions * bf</div><div class="ttdef"><b>Definition</b> <a href="lib_2internal_8h_source.html#l00039">internal.h:39</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a97917e1d5a9fa5e8b7a4495dc9234ac7"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a97917e1d5a9fa5e8b7a4495dc9234ac7">rc</a></div><div class="ttdeci">yh_rc rc</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l01308">yubihsm_pkcs11.c:1308</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_aa19be6ac70a2a5d1cef8d7e6902fe05f_cgraph.png" border="0" usemap="#ayubihsm_8c_aa19be6ac70a2a5d1cef8d7e6902fe05f_cgraph" alt=""/></div>
<map name="ayubihsm_8c_aa19be6ac70a2a5d1cef8d7e6902fe05f_cgraph" id="ayubihsm_8c_aa19be6ac70a2a5d1cef8d7e6902fe05f_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,94,31"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="142,5,225,31"/>
<area shape="poly" title=" " alt="" coords="94,16,126,16,126,21,94,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_aa19be6ac70a2a5d1cef8d7e6902fe05f_icgraph.png" border="0" usemap="#ayubihsm_8c_aa19be6ac70a2a5d1cef8d7e6902fe05f_icgraph" alt=""/></div>
<map name="ayubihsm_8c_aa19be6ac70a2a5d1cef8d7e6902fe05f_icgraph" id="ayubihsm_8c_aa19be6ac70a2a5d1cef8d7e6902fe05f_icgraph">
<area shape="rect" title=" " alt="" coords="518,88,607,114"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#a553b528011491713b85dc590221ea616" title=" " alt="" coords="296,5,470,31"/>
<area shape="poly" title=" " alt="" coords="531,81,502,62,469,45,441,34,443,29,471,40,504,57,533,77"/>
<area shape="rect" href="attest_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="358,55,408,80"/>
<area shape="poly" title=" " alt="" coords="503,93,408,75,409,69,504,87"/>
<area shape="rect" href="structsysio_1_1wallet_1_1detail_1_1yubihsm__wallet__impl.html#a00ee0ac7ac4a819d0b8755bf4f442263" title=" " alt="" coords="308,105,458,161"/>
<area shape="poly" title=" " alt="" coords="504,114,459,122,458,117,503,109"/>
<area shape="rect" href="commands_8c.html#a9155cc4306ad97e58a03ead18637f33b" title=" " alt="" coords="323,185,443,211"/>
<area shape="poly" title=" " alt="" coords="539,126,508,152,472,175,443,187,441,182,469,170,505,147,536,122"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,160,248,186"/>
<area shape="poly" title=" " alt="" coords="307,192,248,184,249,179,308,186"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,185,55,211"/>
<area shape="poly" title=" " alt="" coords="307,201,55,201,55,196,307,196"/>
<area shape="poly" title=" " alt="" coords="88,191,55,197,54,191,87,186"/>
</map>
</div>

</div>
</div>
<a id="a163506939cedbc1e849bdcfb8b5fe1de" name="a163506939cedbc1e849bdcfb8b5fe1de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a163506939cedbc1e849bdcfb8b5fe1de">&#9670;&#160;</a></span>yh_connector_has_device()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool yh_connector_has_device </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__connector.html">yh_connector</a> *</td>          <td class="paramname"><span class="paramname"><em>connector</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Check if the connector has a device connected</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">connector</td><td>Connector currently in use</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True if the connector is not NULL and there is a device connected to it. False otherwise </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l00906">906</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  906</span>                                                      {</div>
<div class="line"><span class="lineno">  907</span> </div>
<div class="line"><span class="lineno">  908</span>  <span class="keywordflow">return</span> connector &amp;&amp; connector-&gt;<a class="code hl_variable" href="structyh__connector.html#a5528332cb62657dbe6fc7e795738872a">has_device</a>;</div>
<div class="line"><span class="lineno">  909</span>}</div>
<div class="ttc" id="astructyh__connector_html_a5528332cb62657dbe6fc7e795738872a"><div class="ttname"><a href="structyh__connector.html#a5528332cb62657dbe6fc7e795738872a">yh_connector::has_device</a></div><div class="ttdeci">bool has_device</div><div class="ttdef"><b>Definition</b> <a href="lib_2internal_8h_source.html#l00043">internal.h:43</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a163506939cedbc1e849bdcfb8b5fe1de_icgraph.png" border="0" usemap="#ayubihsm_8c_a163506939cedbc1e849bdcfb8b5fe1de_icgraph" alt=""/></div>
<map name="ayubihsm_8c_a163506939cedbc1e849bdcfb8b5fe1de_icgraph" id="ayubihsm_8c_a163506939cedbc1e849bdcfb8b5fe1de_icgraph">
<area shape="rect" title=" " alt="" coords="103,55,275,80"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#aece1dc2df605f6ad9024a124e044d995" title=" " alt="" coords="11,5,49,31"/>
<area shape="poly" title=" " alt="" coords="130,52,49,26,50,21,131,47"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#aa40f2eaed65fd9bf8fbd0a898df6e48f" title=" " alt="" coords="11,55,49,80"/>
<area shape="poly" title=" " alt="" coords="87,70,49,70,49,65,87,65"/>
<area shape="rect" href="info_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="5,104,55,130"/>
<area shape="poly" title=" " alt="" coords="131,88,56,112,54,107,130,83"/>
</map>
</div>

</div>
</div>
<a id="a0e96ea59c5f32def80843fec5a3c2142" name="a0e96ea59c5f32def80843fec5a3c2142"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e96ea59c5f32def80843fec5a3c2142">&#9670;&#160;</a></span>yh_create_session()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_create_session </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__connector.html">yh_connector</a> *</td>          <td class="paramname"><span class="paramname"><em>connector</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a></td>          <td class="paramname"><span class="paramname"><em>authkey_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>key_enc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>key_enc_len</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>key_mac</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>key_mac_len</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>recreate_session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structyh__session.html">yh_session</a> **</td>          <td class="paramname"><span class="paramname"><em>session</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create a session that uses the specified encryption key and MAC key to derive session-specific keys</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">connector</td><td>Connector to the device </td></tr>
    <tr><td class="paramname">authkey_id</td><td>Object ID of the Authentication Key used to authenticate the session </td></tr>
    <tr><td class="paramname">key_enc</td><td>Encryption key used to derive the session encryption key </td></tr>
    <tr><td class="paramname">key_enc_len</td><td>Length of the encryption key. </td></tr>
    <tr><td class="paramname">key_mac</td><td>MAC key used to derive the session MAC key </td></tr>
    <tr><td class="paramname">key_mac_len</td><td>Length of the MAC key. </td></tr>
    <tr><td class="paramname">recreate_session</td><td>If true, the session will be recreated if expired. This caches the password in memory </td></tr>
    <tr><td class="paramname">session</td><td>created session</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> if input parameters are NULL or incorrect. See <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> for other possible errors</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a href="https://developers.yubico.com/YubiHSM2/Concepts/Session.html">Session</a>, <a href="https://developers.yubico.com/YubiHSM2/Concepts/Object.html">Authentication Key</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l00616">616</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  619</span>                                                             {</div>
<div class="line"><span class="lineno">  620</span> </div>
<div class="line"><span class="lineno">  621</span>  <a class="code hl_union" href="union___msg.html">Msg</a> msg;</div>
<div class="line"><span class="lineno">  622</span>  <a class="code hl_union" href="union___msg.html">Msg</a> response_msg;</div>
<div class="line"><span class="lineno">  623</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno">  624</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *ptr;</div>
<div class="line"><span class="lineno">  625</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> card_cryptogram[<a class="code hl_define" href="scp_8h.html#afa9d0a3bb1ce2a7951ca1b5f9f06dbe7">SCP_CARD_CRYPTO_LEN</a>];</div>
<div class="line"><span class="lineno">  626</span>  <a class="code hl_struct" href="structyh__session.html">yh_session</a> *new_session;</div>
<div class="line"><span class="lineno">  627</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> host_challenge[<a class="code hl_define" href="yubihsm_8h.html#a397824bc3574858c6c4502b81f7fae31">YH_HOST_CHAL_LEN</a>];</div>
<div class="line"><span class="lineno">  628</span> </div>
<div class="line"><span class="lineno">  629</span>  <span class="keywordflow">if</span> (connector == NULL || key_enc == NULL || key_enc_len != <a class="code hl_define" href="scp_8h.html#a25905234f13446437b28c85d0504216d">SCP_KEY_LEN</a> ||</div>
<div class="line"><span class="lineno">  630</span>      key_mac == NULL || key_mac_len != <a class="code hl_define" href="scp_8h.html#a25905234f13446437b28c85d0504216d">SCP_KEY_LEN</a> || <a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a> == NULL) {</div>
<div class="line"><span class="lineno">  631</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>));</div>
<div class="line"><span class="lineno">  632</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno">  633</span>  }</div>
<div class="line"><span class="lineno">  634</span> </div>
<div class="line"><span class="lineno">  635</span>  <span class="keywordflow">if</span> (!<a class="code hl_function" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75">rand_generate</a>(host_challenge, <span class="keyword">sizeof</span>(host_challenge))) {</div>
<div class="line"><span class="lineno">  636</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a39fbc5bce29b178582419ae9d31ad252">YHR_GENERIC_ERROR</a>;</div>
<div class="line"><span class="lineno">  637</span>  }</div>
<div class="line"><span class="lineno">  638</span> </div>
<div class="line"><span class="lineno">  639</span>  <span class="keywordflow">if</span> (!*<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>) {</div>
<div class="line"><span class="lineno">  640</span>    new_session = calloc(1, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structyh__session.html">yh_session</a>));</div>
<div class="line"><span class="lineno">  641</span>    <span class="keywordflow">if</span> (new_session == NULL) {</div>
<div class="line"><span class="lineno">  642</span>      <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a75ea079345046cdbf5612bf9065d8711">YHR_MEMORY_ERROR</a>));</div>
<div class="line"><span class="lineno">  643</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a75ea079345046cdbf5612bf9065d8711">YHR_MEMORY_ERROR</a>;</div>
<div class="line"><span class="lineno">  644</span>    }</div>
<div class="line"><span class="lineno">  645</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  646</span>    new_session = *<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>;</div>
<div class="line"><span class="lineno">  647</span>  }</div>
<div class="line"><span class="lineno">  648</span> </div>
<div class="line"><span class="lineno">  649</span>  new_session-&gt;<a class="code hl_variable" href="structyh__session.html#a6c208ce524e1f71bde33103fd883db5a">authkey_id</a> = authkey_id;</div>
<div class="line"><span class="lineno">  650</span> </div>
<div class="line"><span class="lineno">  651</span>  <span class="keywordflow">if</span> (recreate) {</div>
<div class="line"><span class="lineno">  652</span>    new_session-&gt;<a class="code hl_variable" href="structyh__session.html#a2bcf5cb8c6bfb10b2300ed5f3a4f6e7b">recreate</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  653</span>    <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(new_session-&gt;<a class="code hl_variable" href="structyh__session.html#a2cce834e130b57e28a660ede08039e02">key_enc</a>, key_enc, <a class="code hl_define" href="scp_8h.html#a25905234f13446437b28c85d0504216d">SCP_KEY_LEN</a>);</div>
<div class="line"><span class="lineno">  654</span>    <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(new_session-&gt;<a class="code hl_variable" href="structyh__session.html#a88795cd7a6018303e3cea5cc3bdf02cf">key_mac</a>, key_mac, <a class="code hl_define" href="scp_8h.html#a25905234f13446437b28c85d0504216d">SCP_KEY_LEN</a>);</div>
<div class="line"><span class="lineno">  655</span>  }</div>
<div class="line"><span class="lineno">  656</span> </div>
<div class="line"><span class="lineno">  657</span>  <span class="comment">// Send CREATE SESSION command</span></div>
<div class="line"><span class="lineno">  658</span>  msg.<a class="code hl_variable" href="union___msg.html#a6b67958147999d1199c922c26763d7f0">st</a>.cmd = YHC_CREATE_SESSION;</div>
<div class="line"><span class="lineno">  659</span>  msg.<a class="code hl_variable" href="union___msg.html#a6b67958147999d1199c922c26763d7f0">st</a>.len = <a class="code hl_define" href="scp_8h.html#aaa32e6b7edd5513108f1410315fa594e">SCP_AUTHKEY_ID_LEN</a> + <a class="code hl_define" href="scp_8h.html#ac8a88e113e5d7d245aeb27e841214563">SCP_HOST_CHAL_LEN</a>;</div>
<div class="line"><span class="lineno">  660</span> </div>
<div class="line"><span class="lineno">  661</span>  <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> authkey_id_n = htons(authkey_id);</div>
<div class="line"><span class="lineno">  662</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(msg.<a class="code hl_variable" href="union___msg.html#a6b67958147999d1199c922c26763d7f0">st</a>.data, &amp;authkey_id_n, <a class="code hl_define" href="scp_8h.html#aaa32e6b7edd5513108f1410315fa594e">SCP_AUTHKEY_ID_LEN</a>);</div>
<div class="line"><span class="lineno">  663</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(msg.<a class="code hl_variable" href="union___msg.html#a6b67958147999d1199c922c26763d7f0">st</a>.data + <a class="code hl_define" href="scp_8h.html#aaa32e6b7edd5513108f1410315fa594e">SCP_AUTHKEY_ID_LEN</a>, host_challenge, <a class="code hl_define" href="scp_8h.html#ac8a88e113e5d7d245aeb27e841214563">SCP_HOST_CHAL_LEN</a>);</div>
<div class="line"><span class="lineno">  664</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(new_session-&gt;<a class="code hl_variable" href="structyh__session.html#a92d2141eb31c70c19d90519c6446c12d">context</a>, host_challenge, <a class="code hl_define" href="scp_8h.html#ac8a88e113e5d7d245aeb27e841214563">SCP_HOST_CHAL_LEN</a>);</div>
<div class="line"><span class="lineno">  665</span> </div>
<div class="line"><span class="lineno">  666</span>  <a class="code hl_define" href="debug__lib_8h.html#a81b33f0d4ec623bff78e988d14388d60">DBG_INT</a>(host_challenge, <a class="code hl_define" href="scp_8h.html#ac8a88e113e5d7d245aeb27e841214563">SCP_HOST_CHAL_LEN</a>, <span class="stringliteral">&quot;Host challenge: &quot;</span>);</div>
<div class="line"><span class="lineno">  667</span> </div>
<div class="line"><span class="lineno">  668</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = send_msg(connector, &amp;msg, &amp;response_msg);</div>
<div class="line"><span class="lineno">  669</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno">  670</span>    <span class="keywordflow">goto</span> cs_failure;</div>
<div class="line"><span class="lineno">  671</span>  }</div>
<div class="line"><span class="lineno">  672</span> </div>
<div class="line"><span class="lineno">  673</span>  <span class="comment">// Parse response</span></div>
<div class="line"><span class="lineno">  674</span>  <span class="keywordflow">if</span> (response_msg.<a class="code hl_variable" href="union___msg.html#a6b67958147999d1199c922c26763d7f0">st</a>.cmd != YHC_CREATE_SESSION_R) {</div>
<div class="line"><span class="lineno">  675</span>    <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> translated = translate_device_error(response_msg.<a class="code hl_variable" href="union___msg.html#a6b67958147999d1199c922c26763d7f0">st</a>.data[0]);</div>
<div class="line"><span class="lineno">  676</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Device error %s (%d)&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(translated),</div>
<div class="line"><span class="lineno">  677</span>            response_msg.<a class="code hl_variable" href="union___msg.html#a6b67958147999d1199c922c26763d7f0">st</a>.data[0]);</div>
<div class="line"><span class="lineno">  678</span>    <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = translated;</div>
<div class="line"><span class="lineno">  679</span>    <span class="keywordflow">goto</span> cs_failure;</div>
<div class="line"><span class="lineno">  680</span>  }</div>
<div class="line"><span class="lineno">  681</span> </div>
<div class="line"><span class="lineno">  682</span>  <span class="keywordflow">if</span> (response_msg.<a class="code hl_variable" href="union___msg.html#a6b67958147999d1199c922c26763d7f0">st</a>.len != 1 + <a class="code hl_define" href="scp_8h.html#aa341425f7d11b792662ebc93abf38cde">SCP_CARD_CHAL_LEN</a> + <a class="code hl_define" href="scp_8h.html#afa9d0a3bb1ce2a7951ca1b5f9f06dbe7">SCP_CARD_CRYPTO_LEN</a>) {</div>
<div class="line"><span class="lineno">  683</span>    <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366ae0b26dcb22aa228ab08c9e59a8975952">YHR_WRONG_LENGTH</a>;</div>
<div class="line"><span class="lineno">  684</span>    <span class="keywordflow">goto</span> cs_failure;</div>
<div class="line"><span class="lineno">  685</span>  }</div>
<div class="line"><span class="lineno">  686</span> </div>
<div class="line"><span class="lineno">  687</span>  ptr = response_msg.<a class="code hl_variable" href="union___msg.html#a6b67958147999d1199c922c26763d7f0">st</a>.data;</div>
<div class="line"><span class="lineno">  688</span> </div>
<div class="line"><span class="lineno">  689</span>  <span class="comment">// Save sid</span></div>
<div class="line"><span class="lineno">  690</span>  new_session-&gt;<a class="code hl_variable" href="structyh__session.html#a5582d82fd5b88d1e26738437268fb285">s</a>.<a class="code hl_variable" href="struct_scp__ctx.html#af58bb8b1e7185c27de7c8a2df94de1f5">sid</a> = (*ptr++);</div>
<div class="line"><span class="lineno">  691</span> </div>
<div class="line"><span class="lineno">  692</span>  <span class="comment">// Save card challenge</span></div>
<div class="line"><span class="lineno">  693</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(new_session-&gt;<a class="code hl_variable" href="structyh__session.html#a92d2141eb31c70c19d90519c6446c12d">context</a> + <a class="code hl_define" href="scp_8h.html#ac8a88e113e5d7d245aeb27e841214563">SCP_HOST_CHAL_LEN</a>, ptr, <a class="code hl_define" href="scp_8h.html#aa341425f7d11b792662ebc93abf38cde">SCP_CARD_CHAL_LEN</a>);</div>
<div class="line"><span class="lineno">  694</span>  ptr += <a class="code hl_define" href="scp_8h.html#aa341425f7d11b792662ebc93abf38cde">SCP_CARD_CHAL_LEN</a>;</div>
<div class="line"><span class="lineno">  695</span> </div>
<div class="line"><span class="lineno">  696</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(card_cryptogram, ptr, <a class="code hl_define" href="scp_8h.html#afa9d0a3bb1ce2a7951ca1b5f9f06dbe7">SCP_CARD_CRYPTO_LEN</a>);</div>
<div class="line"><span class="lineno">  697</span>  ptr += <a class="code hl_define" href="scp_8h.html#afa9d0a3bb1ce2a7951ca1b5f9f06dbe7">SCP_CARD_CRYPTO_LEN</a>;</div>
<div class="line"><span class="lineno">  698</span> </div>
<div class="line"><span class="lineno">  699</span>  <a class="code hl_define" href="debug__lib_8h.html#a8c4742440a149ad8bcb5d58ae76c5ed3">DBG_INFO</a>(<span class="stringliteral">&quot;Received Session ID: %d&quot;</span>, new_session-&gt;<a class="code hl_variable" href="structyh__session.html#a5582d82fd5b88d1e26738437268fb285">s</a>.<a class="code hl_variable" href="struct_scp__ctx.html#af58bb8b1e7185c27de7c8a2df94de1f5">sid</a>);</div>
<div class="line"><span class="lineno">  700</span> </div>
<div class="line"><span class="lineno">  701</span>  <a class="code hl_define" href="debug__lib_8h.html#a81b33f0d4ec623bff78e988d14388d60">DBG_INT</a>(new_session-&gt;<a class="code hl_variable" href="structyh__session.html#a92d2141eb31c70c19d90519c6446c12d">context</a> + <a class="code hl_define" href="scp_8h.html#ac8a88e113e5d7d245aeb27e841214563">SCP_HOST_CHAL_LEN</a>, <a class="code hl_define" href="scp_8h.html#aa341425f7d11b792662ebc93abf38cde">SCP_CARD_CHAL_LEN</a>,</div>
<div class="line"><span class="lineno">  702</span>          <span class="stringliteral">&quot;Card challenge: &quot;</span>);</div>
<div class="line"><span class="lineno">  703</span>  <a class="code hl_define" href="debug__lib_8h.html#a81b33f0d4ec623bff78e988d14388d60">DBG_INT</a>(card_cryptogram, <a class="code hl_define" href="scp_8h.html#afa9d0a3bb1ce2a7951ca1b5f9f06dbe7">SCP_CARD_CRYPTO_LEN</a>, <span class="stringliteral">&quot;Card cryptogram: &quot;</span>);</div>
<div class="line"><span class="lineno">  704</span> </div>
<div class="line"><span class="lineno">  705</span>  <span class="comment">// Derive session keys</span></div>
<div class="line"><span class="lineno">  706</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> =</div>
<div class="line"><span class="lineno">  707</span>    derive_s_enc(&amp;new_session-&gt;<a class="code hl_variable" href="structyh__session.html#a5582d82fd5b88d1e26738437268fb285">s</a>, key_enc, key_enc_len, new_session-&gt;<a class="code hl_variable" href="structyh__session.html#a92d2141eb31c70c19d90519c6446c12d">context</a>);</div>
<div class="line"><span class="lineno">  708</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>)</div>
<div class="line"><span class="lineno">  709</span>    <span class="keywordflow">goto</span> cs_failure;</div>
<div class="line"><span class="lineno">  710</span> </div>
<div class="line"><span class="lineno">  711</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> =</div>
<div class="line"><span class="lineno">  712</span>    derive_s_mac(&amp;new_session-&gt;<a class="code hl_variable" href="structyh__session.html#a5582d82fd5b88d1e26738437268fb285">s</a>, key_mac, key_mac_len, new_session-&gt;<a class="code hl_variable" href="structyh__session.html#a92d2141eb31c70c19d90519c6446c12d">context</a>);</div>
<div class="line"><span class="lineno">  713</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>)</div>
<div class="line"><span class="lineno">  714</span>    <span class="keywordflow">goto</span> cs_failure;</div>
<div class="line"><span class="lineno">  715</span> </div>
<div class="line"><span class="lineno">  716</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> =</div>
<div class="line"><span class="lineno">  717</span>    derive_s_rmac(&amp;new_session-&gt;<a class="code hl_variable" href="structyh__session.html#a5582d82fd5b88d1e26738437268fb285">s</a>, key_mac, key_enc_len, new_session-&gt;<a class="code hl_variable" href="structyh__session.html#a92d2141eb31c70c19d90519c6446c12d">context</a>);</div>
<div class="line"><span class="lineno">  718</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>)</div>
<div class="line"><span class="lineno">  719</span>    <span class="keywordflow">goto</span> cs_failure;</div>
<div class="line"><span class="lineno">  720</span> </div>
<div class="line"><span class="lineno">  721</span>  <a class="code hl_define" href="debug__lib_8h.html#a81b33f0d4ec623bff78e988d14388d60">DBG_INT</a>(new_session-&gt;<a class="code hl_variable" href="structyh__session.html#a5582d82fd5b88d1e26738437268fb285">s</a>.<a class="code hl_variable" href="struct_scp__ctx.html#af74beebd17620c5ff6fc1bd48fd017bf">s_enc</a>, <a class="code hl_define" href="scp_8h.html#a25905234f13446437b28c85d0504216d">SCP_KEY_LEN</a>, <span class="stringliteral">&quot;S-ENC: &quot;</span>);</div>
<div class="line"><span class="lineno">  722</span>  <a class="code hl_define" href="debug__lib_8h.html#a81b33f0d4ec623bff78e988d14388d60">DBG_INT</a>(new_session-&gt;<a class="code hl_variable" href="structyh__session.html#a5582d82fd5b88d1e26738437268fb285">s</a>.<a class="code hl_variable" href="struct_scp__ctx.html#a5c1e57aa4641ea9404201193367bfd37">s_mac</a>, <a class="code hl_define" href="scp_8h.html#a25905234f13446437b28c85d0504216d">SCP_KEY_LEN</a>, <span class="stringliteral">&quot;S-MAC: &quot;</span>);</div>
<div class="line"><span class="lineno">  723</span>  <a class="code hl_define" href="debug__lib_8h.html#a81b33f0d4ec623bff78e988d14388d60">DBG_INT</a>(new_session-&gt;<a class="code hl_variable" href="structyh__session.html#a5582d82fd5b88d1e26738437268fb285">s</a>.<a class="code hl_variable" href="struct_scp__ctx.html#a6d4e08d26c9ab0e28d75a3976d16967c">s_rmac</a>, <a class="code hl_define" href="scp_8h.html#a25905234f13446437b28c85d0504216d">SCP_KEY_LEN</a>, <span class="stringliteral">&quot;S-RMAC: &quot;</span>);</div>
<div class="line"><span class="lineno">  724</span>  <span class="comment">// Verify card cryptogram</span></div>
<div class="line"><span class="lineno">  725</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = verify_card_cryptogram(&amp;new_session-&gt;<a class="code hl_variable" href="structyh__session.html#a5582d82fd5b88d1e26738437268fb285">s</a>, new_session-&gt;<a class="code hl_variable" href="structyh__session.html#a92d2141eb31c70c19d90519c6446c12d">context</a>,</div>
<div class="line"><span class="lineno">  726</span>                               card_cryptogram);</div>
<div class="line"><span class="lineno">  727</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno">  728</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno">  729</span>    <span class="keywordflow">goto</span> cs_failure;</div>
<div class="line"><span class="lineno">  730</span>  }</div>
<div class="line"><span class="lineno">  731</span> </div>
<div class="line"><span class="lineno">  732</span>  <a class="code hl_define" href="debug__lib_8h.html#a8c4742440a149ad8bcb5d58ae76c5ed3">DBG_INFO</a>(<span class="stringliteral">&quot;Card cryptogram successfully verified&quot;</span>);</div>
<div class="line"><span class="lineno">  733</span> </div>
<div class="line"><span class="lineno">  734</span>  <span class="comment">// Save link back to connector</span></div>
<div class="line"><span class="lineno">  735</span>  new_session-&gt;<a class="code hl_variable" href="structyh__session.html#a481fb0215d72e52bb619d6c934078167">parent</a> = connector;</div>
<div class="line"><span class="lineno">  736</span> </div>
<div class="line"><span class="lineno">  737</span>  *<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a> = new_session;</div>
<div class="line"><span class="lineno">  738</span> </div>
<div class="line"><span class="lineno">  739</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno">  740</span> </div>
<div class="line"><span class="lineno">  741</span>cs_failure:</div>
<div class="line"><span class="lineno">  742</span>  <a class="code hl_define" href="insecure__memzero_8h.html#a0794f9275fd1036ecba6ff0a901a320b">insecure_memzero</a>(new_session, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structyh__session.html">yh_session</a>));</div>
<div class="line"><span class="lineno">  743</span>  free(new_session);</div>
<div class="line"><span class="lineno">  744</span>  (new_session) = NULL;</div>
<div class="line"><span class="lineno">  745</span> </div>
<div class="line"><span class="lineno">  746</span>  <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno">  747</span> </div>
<div class="line"><span class="lineno">  748</span>  <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno">  749</span>}</div>
<div class="ttc" id="ainsecure__memzero_8h_html_a0794f9275fd1036ecba6ff0a901a320b"><div class="ttname"><a href="insecure__memzero_8h.html#a0794f9275fd1036ecba6ff0a901a320b">insecure_memzero</a></div><div class="ttdeci">#define insecure_memzero(buf, len)</div><div class="ttdef"><b>Definition</b> <a href="insecure__memzero_8h_source.html#l00031">insecure_memzero.h:31</a></div></div>
<div class="ttc" id="astruct_scp__ctx_html_a5c1e57aa4641ea9404201193367bfd37"><div class="ttname"><a href="struct_scp__ctx.html#a5c1e57aa4641ea9404201193367bfd37">Scp_ctx::s_mac</a></div><div class="ttdeci">uint8_t s_mac[SCP_KEY_LEN]</div><div class="ttdef"><b>Definition</b> <a href="scp_8h_source.html#l00071">scp.h:71</a></div></div>
<div class="ttc" id="astruct_scp__ctx_html_a6d4e08d26c9ab0e28d75a3976d16967c"><div class="ttname"><a href="struct_scp__ctx.html#a6d4e08d26c9ab0e28d75a3976d16967c">Scp_ctx::s_rmac</a></div><div class="ttdeci">uint8_t s_rmac[SCP_KEY_LEN]</div><div class="ttdef"><b>Definition</b> <a href="scp_8h_source.html#l00072">scp.h:72</a></div></div>
<div class="ttc" id="astruct_scp__ctx_html_af74beebd17620c5ff6fc1bd48fd017bf"><div class="ttname"><a href="struct_scp__ctx.html#af74beebd17620c5ff6fc1bd48fd017bf">Scp_ctx::s_enc</a></div><div class="ttdeci">uint8_t s_enc[SCP_KEY_LEN]</div><div class="ttdef"><b>Definition</b> <a href="scp_8h_source.html#l00070">scp.h:70</a></div></div>
<div class="ttc" id="astructyh__session_html_a2bcf5cb8c6bfb10b2300ed5f3a4f6e7b"><div class="ttname"><a href="structyh__session.html#a2bcf5cb8c6bfb10b2300ed5f3a4f6e7b">yh_session::recreate</a></div><div class="ttdeci">bool recreate</div><div class="ttdef"><b>Definition</b> <a href="lib_2internal_8h_source.html#l00028">internal.h:28</a></div></div>
<div class="ttc" id="astructyh__session_html_a2cce834e130b57e28a660ede08039e02"><div class="ttname"><a href="structyh__session.html#a2cce834e130b57e28a660ede08039e02">yh_session::key_enc</a></div><div class="ttdeci">uint8_t key_enc[SCP_KEY_LEN]</div><div class="ttdef"><b>Definition</b> <a href="lib_2internal_8h_source.html#l00029">internal.h:29</a></div></div>
<div class="ttc" id="astructyh__session_html_a6c208ce524e1f71bde33103fd883db5a"><div class="ttname"><a href="structyh__session.html#a6c208ce524e1f71bde33103fd883db5a">yh_session::authkey_id</a></div><div class="ttdeci">uint16_t authkey_id</div><div class="ttdef"><b>Definition</b> <a href="lib_2internal_8h_source.html#l00027">internal.h:27</a></div></div>
<div class="ttc" id="astructyh__session_html_a88795cd7a6018303e3cea5cc3bdf02cf"><div class="ttname"><a href="structyh__session.html#a88795cd7a6018303e3cea5cc3bdf02cf">yh_session::key_mac</a></div><div class="ttdeci">uint8_t key_mac[SCP_KEY_LEN]</div><div class="ttdef"><b>Definition</b> <a href="lib_2internal_8h_source.html#l00030">internal.h:30</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a0e96ea59c5f32def80843fec5a3c2142_cgraph.png" border="0" usemap="#ayubihsm_8c_a0e96ea59c5f32def80843fec5a3c2142_cgraph" alt=""/></div>
<map name="ayubihsm_8c_a0e96ea59c5f32def80843fec5a3c2142_cgraph" id="ayubihsm_8c_a0e96ea59c5f32def80843fec5a3c2142_cgraph">
<area shape="rect" title=" " alt="" coords="5,55,136,80"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="200,5,271,31"/>
<area shape="poly" title=" " alt="" coords="115,51,184,31,186,36,117,57"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="184,55,287,80"/>
<area shape="poly" title=" " alt="" coords="136,65,168,65,168,70,136,70"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="194,104,277,130"/>
<area shape="poly" title=" " alt="" coords="117,78,180,97,178,103,115,84"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a0e96ea59c5f32def80843fec5a3c2142_icgraph.png" border="0" usemap="#ayubihsm_8c_a0e96ea59c5f32def80843fec5a3c2142_icgraph" alt=""/></div>
<map name="ayubihsm_8c_a0e96ea59c5f32def80843fec5a3c2142_icgraph" id="ayubihsm_8c_a0e96ea59c5f32def80843fec5a3c2142_icgraph">
<area shape="rect" title=" " alt="" coords="676,56,807,82"/>
<area shape="rect" href="yubihsm__shell__tests_8c.html#ae66f6b31b5ad750f1fe042a706a4e3d4" title=" " alt="" coords="295,55,344,80"/>
<area shape="poly" title=" " alt="" coords="661,71,345,70,345,65,661,66"/>
<area shape="rect" href="yubihsm_8c.html#a3be331dcf8907ff3569e4dc230e1c615" title=" " alt="" coords="230,5,410,31"/>
<area shape="poly" title=" " alt="" coords="661,58,628,53,410,29,410,23,629,48,661,52"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="480,1165,628,1191"/>
<area shape="poly" title=" " alt="" coords="738,97,560,1165,555,1164,733,97"/>
<area shape="rect" href="attest_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="58,703,107,728"/>
<area shape="poly" title=" " alt="" coords="218,37,210,44,199,75,183,144,145,348,88,703,83,702,140,347,178,143,193,73,205,41,215,32"/>
<area shape="rect" href="structsysio_1_1wallet_1_1detail_1_1yubihsm__wallet__impl.html#a00ee0ac7ac4a819d0b8755bf4f442263" title=" " alt="" coords="7,162,158,218"/>
<area shape="poly" title=" " alt="" coords="218,40,209,44,175,71,145,102,102,163,97,160,141,99,171,67,206,40,215,35"/>
<area shape="rect" href="commands_8c.html#ae2e50929acc6085cd395d0bd4ddb02db" title=" " alt="" coords="13,1195,152,1220"/>
<area shape="poly" title=" " alt="" coords="219,36,210,44,201,60,194,86,183,166,175,269,171,385,166,607,162,741,144,880,122,1015,89,1195,84,1194,117,1014,138,880,157,741,161,607,165,385,170,269,177,165,189,85,196,58,206,41,215,32"/>
<area shape="rect" href="commands_8c.html#a22f22a25151b12c7573f80563a341368" title=" " alt="" coords="5,5,160,31"/>
<area shape="poly" title=" " alt="" coords="215,21,160,21,160,16,215,16"/>
<area shape="poly" title=" " alt="" coords="549,1150,537,927,514,591,497,420,478,270,455,156,443,117,430,95,412,81,389,72,345,68,345,63,391,67,414,76,434,91,448,115,460,154,483,269,502,420,519,590,543,927,554,1149"/>
<area shape="rect" href="echo_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="295,555,344,580"/>
<area shape="poly" title=" " alt="" coords="548,1150,538,1029,516,862,500,776,481,699,457,635,444,611,430,593,411,580,389,572,345,568,345,563,390,567,414,575,434,590,449,608,462,633,486,697,505,775,521,861,543,1029,554,1150"/>
<area shape="rect" href="structsysio_1_1wallet_1_1detail_1_1yubihsm__wallet__impl.html#a6412f92a0ad381f2370582372a5b6082" title=" " alt="" coords="240,129,400,185"/>
<area shape="poly" title=" " alt="" coords="551,1150,549,961,545,825,536,676,522,527,500,390,486,330,470,277,451,232,430,199,416,185,398,175,401,170,419,181,434,195,456,230,475,275,491,328,505,389,527,527,541,676,550,824,555,961,556,1150"/>
<area shape="rect" href="commands_8c.html#af764906e585805991dd84ec5dc2c060a" title=" " alt="" coords="269,1639,371,1664"/>
<area shape="poly" title=" " alt="" coords="552,1206,537,1301,512,1428,496,1492,477,1550,457,1597,434,1629,404,1647,372,1654,371,1649,403,1642,430,1626,452,1595,472,1548,491,1491,507,1427,532,1300,547,1206"/>
<area shape="rect" href="yubihsm_8c.html#ad112fe09ee88d595333fa87e8059717b" title=" " alt="" coords="251,1688,389,1714"/>
<area shape="poly" title=" " alt="" coords="553,1207,539,1311,515,1453,499,1524,480,1589,459,1643,434,1679,413,1693,390,1701,388,1696,411,1688,430,1675,454,1640,475,1588,494,1523,510,1452,534,1310,547,1206"/>
<area shape="rect" href="yubihsm_8c.html#a8f229874e387887d7c5b4c7e6e07db8e" title=" " alt="" coords="208,1737,432,1763"/>
<area shape="poly" title=" " alt="" coords="553,1207,542,1321,519,1477,503,1556,483,1629,461,1688,434,1728,420,1739,416,1735,430,1724,456,1685,478,1627,498,1555,513,1476,536,1320,548,1206"/>
<area shape="rect" href="yubihsm_8c.html#a61ab8dbab67b1cceb49cd306f8c3f4b1" title=" " alt="" coords="245,817,394,843"/>
<area shape="poly" title=" " alt="" coords="548,1150,540,1088,521,1009,506,967,486,926,461,889,430,856,413,845,394,838,396,833,416,840,434,852,465,885,490,923,511,965,526,1007,546,1088,554,1150"/>
<area shape="rect" href="yubihsm_8c.html#a82d295a02d9eb628f6dea4b4c01fdec4" title=" " alt="" coords="239,1491,401,1516"/>
<area shape="poly" title=" " alt="" coords="553,1207,543,1265,523,1339,507,1378,488,1416,463,1451,434,1482,403,1498,400,1494,430,1477,459,1448,483,1414,503,1376,518,1338,538,1264,548,1206"/>
<area shape="rect" href="yubihsm_8c.html#aa939f8764ed0cca27884d9c8f640ac14" title=" " alt="" coords="248,1787,392,1812"/>
<area shape="poly" title=" " alt="" coords="554,1207,544,1329,522,1501,506,1588,487,1668,463,1733,449,1758,434,1777,415,1791,393,1799,391,1794,412,1786,430,1774,444,1755,458,1731,481,1666,501,1587,517,1500,538,1329,548,1206"/>
<area shape="rect" href="yubihsm_8c.html#a3677afe2209a1cae31f70a304e260e28" title=" " alt="" coords="253,1540,387,1566"/>
<area shape="poly" title=" " alt="" coords="555,1207,548,1273,530,1361,514,1407,494,1453,467,1495,434,1531,412,1544,388,1552,386,1547,410,1540,430,1527,463,1491,489,1450,509,1405,525,1360,543,1273,549,1206"/>
<area shape="rect" href="yubihsm_8c.html#a5ebf6932cd2e68b9a23787c27fde3e26" title=" " alt="" coords="230,1836,410,1862"/>
<area shape="poly" title=" " alt="" coords="554,1207,546,1339,525,1525,510,1620,489,1707,465,1778,450,1806,434,1827,411,1842,408,1838,430,1823,445,1803,460,1776,484,1705,504,1619,520,1524,540,1338,549,1207"/>
<area shape="rect" href="yubihsm_8c.html#ae736702f9463878db4adfd45b6a597f9" title=" " alt="" coords="248,1589,392,1615"/>
<area shape="poly" title=" " alt="" coords="556,1207,552,1281,536,1382,521,1436,500,1489,471,1538,434,1580,414,1593,393,1601,391,1596,412,1588,430,1576,467,1535,495,1486,516,1434,531,1381,547,1281,551,1206"/>
<area shape="rect" href="yubihsm_8c.html#a2900aee87732f9ec017bd1662bcef7e9" title=" " alt="" coords="252,867,388,892"/>
<area shape="poly" title=" " alt="" coords="546,1150,535,1097,514,1030,499,996,480,963,457,932,430,906,410,894,388,886,389,881,413,889,434,901,461,928,484,960,503,994,519,1029,540,1096,552,1149"/>
<area shape="rect" href="yubihsm_8c.html#aa3f473e6dbb9188ad0269b40921c4f5f" title=" " alt="" coords="241,916,399,942"/>
<area shape="poly" title=" " alt="" coords="544,1151,530,1107,507,1053,474,1000,454,976,431,955,398,939,401,934,433,951,457,972,478,997,512,1051,535,1105,549,1149"/>
<area shape="rect" href="yubihsm_8c.html#a1eac22853548b7ceab92550c22233b18" title=" " alt="" coords="228,965,412,991"/>
<area shape="poly" title=" " alt="" coords="539,1152,523,1118,499,1078,468,1039,431,1006,407,994,410,989,433,1001,472,1035,503,1075,527,1115,544,1150"/>
<area shape="rect" href="yubihsm_8c.html#a9e130d225a8dc003d7a7c0ce4b8ea5e4" title=" " alt="" coords="249,1015,390,1056"/>
<area shape="poly" title=" " alt="" coords="530,1155,487,1111,460,1089,431,1070,390,1053,392,1048,433,1065,463,1085,491,1107,534,1151"/>
<area shape="rect" href="yubihsm_8c.html#a1f749a696792e7911844629e056d9c15" title=" " alt="" coords="230,1080,410,1106"/>
<area shape="poly" title=" " alt="" coords="516,1160,476,1139,431,1121,391,1109,392,1104,433,1116,478,1135,518,1155"/>
<area shape="rect" href="yubihsm_8c.html#a5ae52ad56b7e83baeb33b46104263aa6" title=" " alt="" coords="243,1885,397,1911"/>
<area shape="poly" title=" " alt="" coords="555,1207,547,1347,528,1548,513,1652,492,1746,466,1823,451,1853,434,1876,417,1889,398,1897,396,1892,415,1884,430,1872,447,1850,462,1821,487,1744,508,1651,523,1548,542,1347,549,1207"/>
<area shape="rect" href="yubihsm_8c.html#a7b5f1f0c1cbca11fbe21e7e4e6b29a1b" title=" " alt="" coords="243,209,397,235"/>
<area shape="poly" title=" " alt="" coords="551,1150,550,969,546,839,538,697,523,556,502,426,487,369,471,319,452,279,430,248,415,236,396,228,399,223,418,231,434,244,456,276,476,317,492,367,507,425,529,555,543,697,552,838,556,969,556,1150"/>
<area shape="rect" href="yubihsm_8c.html#a56e060e71fb8baa0531b3a20848abf37" title=" " alt="" coords="253,653,386,679"/>
<area shape="poly" title=" " alt="" coords="547,1150,534,1048,509,910,493,840,475,777,454,726,430,692,410,679,386,671,388,666,412,674,434,688,458,724,480,775,499,839,515,909,539,1047,552,1149"/>
<area shape="rect" href="yubihsm_8c.html#a11871e03c808e2d25737f893e58ed094" title=" " alt="" coords="257,1935,383,1960"/>
<area shape="poly" title=" " alt="" coords="555,1207,549,1356,532,1572,516,1683,495,1785,468,1868,452,1901,434,1925,411,1941,384,1949,383,1944,409,1937,430,1922,448,1898,464,1866,490,1783,511,1682,526,1571,544,1355,550,1206"/>
<area shape="rect" href="yubihsm_8c.html#af1bc8ed34687d83701eb3cc673ad4b96" title=" " alt="" coords="253,1130,386,1170"/>
<area shape="poly" title=" " alt="" coords="464,1170,387,1161,387,1155,465,1165"/>
<area shape="rect" href="yubihsm_8c.html#aa7b8b42156c4bdaf41d8b9758a2fd73f" title=" " alt="" coords="243,1195,396,1220"/>
<area shape="poly" title=" " alt="" coords="465,1192,397,1201,396,1195,464,1187"/>
<area shape="rect" href="yubihsm_8c.html#ae87d5578703775b9d4151a14435f4a73" title=" " alt="" coords="239,1984,401,2010"/>
<area shape="poly" title=" " alt="" coords="555,1207,551,1365,535,1595,520,1715,498,1824,470,1913,453,1948,434,1975,419,1986,402,1994,400,1989,416,1982,430,1971,449,1945,465,1911,493,1822,514,1714,529,1595,546,1364,550,1207"/>
<area shape="rect" href="yubihsm_8c.html#a47768ae0e72beba49f02db1baddf4823" title=" " alt="" coords="249,2033,390,2059"/>
<area shape="poly" title=" " alt="" coords="556,1206,553,1373,547,1491,538,1618,523,1746,501,1862,488,1914,472,1959,454,1996,434,2024,415,2038,392,2047,390,2042,412,2034,430,2020,450,1993,467,1956,483,1912,496,1861,518,1745,532,1618,542,1490,547,1372,550,1206"/>
<area shape="rect" href="yubihsm_8c.html#ac154da7ac6dc0a7b4b3a6cdff9433da8" title=" " alt="" coords="211,2083,429,2108"/>
<area shape="poly" title=" " alt="" coords="556,1206,554,1381,550,1506,541,1642,526,1777,504,1901,490,1956,474,2004,455,2043,434,2073,421,2084,417,2080,430,2070,451,2041,469,2002,485,1954,499,1900,521,1776,535,1641,544,1506,549,1381,551,1206"/>
<area shape="rect" href="yubihsm_8c.html#a19c79faaf10c405864f0179821d551a5" title=" " alt="" coords="235,2132,404,2158"/>
<area shape="poly" title=" " alt="" coords="556,1206,556,1390,552,1522,544,1665,529,1809,507,1940,493,1998,476,2049,457,2091,434,2123,421,2134,406,2141,404,2136,418,2129,430,2119,452,2088,471,2047,488,1997,502,1939,524,1808,538,1665,547,1522,551,1390,551,1206"/>
<area shape="rect" href="yubihsm_8c.html#a1249c920eec24f634d04eaafb90a1ca2" title=" " alt="" coords="244,703,396,728"/>
<area shape="poly" title=" " alt="" coords="546,1150,531,1058,506,935,490,873,472,818,452,773,430,743,414,731,395,724,397,719,416,727,434,739,456,770,476,816,495,872,511,934,536,1057,551,1150"/>
<area shape="rect" href="yubihsm_8c.html#addc22271306d847f53321984f41d818b" title=" " alt="" coords="256,2182,384,2222"/>
<area shape="poly" title=" " alt="" coords="554,1207,541,1412,515,1718,498,1873,479,2010,458,2114,446,2150,434,2172,412,2190,385,2200,383,2195,409,2185,430,2168,441,2148,453,2113,474,2009,493,1872,510,1718,535,1411,549,1206"/>
<area shape="rect" href="yubihsm_8c.html#ae0fc8d6520950868365011d1a9f450f1" title=" " alt="" coords="240,2247,400,2272"/>
<area shape="poly" title=" " alt="" coords="554,1207,542,1424,518,1751,502,1917,482,2063,460,2175,447,2212,434,2236,419,2248,401,2257,399,2252,416,2244,430,2232,442,2210,455,2173,477,2062,496,1916,513,1750,537,1423,549,1206"/>
<area shape="rect" href="yubihsm_8c.html#a3a9729ea5b2e299a735b43f2b23e50a7" title=" " alt="" coords="237,259,402,284"/>
<area shape="poly" title=" " alt="" coords="550,1150,549,977,544,854,535,720,520,587,499,465,485,411,469,364,451,326,430,297,417,287,402,280,404,275,420,282,434,294,455,323,474,362,490,410,504,463,525,586,540,720,549,854,554,977,556,1150"/>
<area shape="rect" href="yubihsm_8c.html#ae5bf13f9558bb0340468b722accf94d3" title=" " alt="" coords="241,308,399,334"/>
<area shape="poly" title=" " alt="" coords="550,1150,547,985,541,869,532,743,517,618,496,503,467,409,450,374,430,347,416,335,399,328,401,323,418,331,434,343,454,371,472,408,501,502,522,617,537,742,547,868,552,985,556,1150"/>
<area shape="rect" href="yubihsm_8c.html#a7cbea7103efff8473ccfaaa35bfc6346" title=" " alt="" coords="254,357,386,383"/>
<area shape="poly" title=" " alt="" coords="550,1150,545,994,529,767,514,649,493,542,465,455,448,421,430,396,410,382,386,374,387,369,412,377,434,392,453,418,470,453,498,541,519,649,534,766,551,994,555,1150"/>
<area shape="rect" href="yubihsm_8c.html#a4bb1d420f681bc91bd36dc08695dbad6" title=" " alt="" coords="227,407,413,432"/>
<area shape="poly" title=" " alt="" coords="550,1150,543,1002,526,790,510,681,490,581,463,500,447,469,430,445,412,432,415,428,434,442,452,466,468,498,495,580,515,680,531,789,549,1002,555,1149"/>
<area shape="rect" href="yubihsm_8c.html#a5c153fe27877bcc7927d391fb55550af" title=" " alt="" coords="250,456,390,482"/>
<area shape="poly" title=" " alt="" coords="549,1150,542,1012,523,814,507,713,487,621,461,545,446,516,430,495,412,481,389,474,391,469,414,477,434,491,451,513,466,543,492,619,512,712,528,814,547,1011,555,1150"/>
<area shape="rect" href="yubihsm_8c.html#a9d844855c9066bbea0e4344978dd7fdc" title=" " alt="" coords="247,505,393,531"/>
<area shape="poly" title=" " alt="" coords="549,1150,540,1021,519,838,504,745,484,660,459,590,445,564,430,544,413,532,393,524,395,519,416,527,434,540,450,561,464,588,489,658,509,744,525,837,545,1020,554,1150"/>
<area shape="rect" href="yubihsm_8c.html#a85ac840aec77cb1ca3c3ce1f2ab26282" title=" " alt="" coords="257,604,383,630"/>
<area shape="poly" title=" " alt="" coords="548,1151,536,1039,513,886,497,808,478,738,456,681,430,643,408,628,383,621,384,616,411,623,434,639,460,678,483,736,502,807,518,885,541,1039,553,1150"/>
<area shape="rect" href="yubihsm_8c.html#a5988faffd97366b188728ff1a7fb6e89" title=" " alt="" coords="241,752,399,793"/>
<area shape="poly" title=" " alt="" coords="550,1150,544,1081,526,988,511,939,490,891,463,846,430,807,415,795,398,787,400,782,418,791,434,803,468,843,495,889,516,937,531,987,549,1080,555,1150"/>
<area shape="rect" href="yubihsm_8c.html#a5121c90d3bd745afd8264fef2ef39ace" title=" " alt="" coords="254,1244,386,1270"/>
<area shape="poly" title=" " alt="" coords="515,1201,433,1235,387,1248,386,1243,431,1230,513,1196"/>
<area shape="rect" href="yubihsm_8c.html#a690a5585de21ce82495e139ec1dfdf9d" title=" " alt="" coords="254,1293,386,1319"/>
<area shape="poly" title=" " alt="" coords="533,1205,490,1246,463,1267,433,1285,387,1300,385,1295,431,1280,460,1263,486,1242,530,1201"/>
<area shape="rect" href="yubihsm_8c.html#a9000d43fe8cf7313b319f316521eb0c4" title=" " alt="" coords="255,1343,384,1368"/>
<area shape="poly" title=" " alt="" coords="542,1206,500,1271,469,1305,433,1334,410,1345,386,1352,384,1347,408,1340,431,1329,466,1301,496,1268,537,1203"/>
<area shape="rect" href="yubihsm_8c.html#aa0a7644b7b368d6aaf8b4aff5e3d19b8" title=" " alt="" coords="240,1392,400,1418"/>
<area shape="poly" title=" " alt="" coords="547,1207,532,1247,508,1295,476,1343,456,1364,433,1383,401,1399,399,1394,431,1379,452,1360,471,1339,503,1292,527,1245,542,1205"/>
<area shape="rect" href="yubihsm_8c.html#a944e6f31487857709f032598fd43fef5" title=" " alt="" coords="261,1441,379,1467"/>
<area shape="poly" title=" " alt="" coords="550,1207,538,1256,516,1317,482,1380,460,1408,434,1432,408,1446,380,1454,379,1449,406,1442,430,1428,456,1404,477,1377,511,1315,533,1254,545,1205"/>
<area shape="poly" title=" " alt="" coords="225,173,158,182,158,177,224,168"/>
<area shape="poly" title=" " alt="" coords="357,117,343,110,320,108,299,110,286,114,279,121,279,129,274,128,275,118,283,110,298,104,320,102,344,105,360,112"/>
<area shape="poly" title=" " alt="" coords="230,816,207,807,174,790,143,769,97,731,100,727,146,765,177,785,209,802,232,811"/>
<area shape="poly" title=" " alt="" coords="232,842,209,856,174,895,146,941,124,990,109,1041,92,1133,87,1194,81,1194,87,1132,104,1039,119,989,141,939,170,892,206,852,229,838"/>
<area shape="poly" title=" " alt="" coords="223,1492,206,1482,176,1452,151,1417,130,1380,114,1341,93,1271,83,1221,88,1220,98,1269,119,1340,135,1377,155,1414,180,1448,209,1477,225,1488"/>
<area shape="poly" title=" " alt="" coords="236,1548,206,1531,172,1495,145,1453,124,1408,108,1362,89,1278,82,1221,87,1220,94,1277,113,1361,129,1406,149,1450,176,1492,209,1527,239,1543"/>
<area shape="poly" title=" " alt="" coords="232,1596,206,1580,168,1538,139,1489,117,1436,102,1383,85,1286,81,1221,87,1221,91,1285,107,1382,122,1434,144,1486,172,1535,209,1576,235,1591"/>
<area shape="poly" title=" " alt="" coords="238,890,209,906,177,939,152,977,131,1019,115,1061,96,1140,88,1194,82,1194,90,1139,110,1060,126,1017,147,974,173,935,206,901,235,885"/>
<area shape="poly" title=" " alt="" coords="228,944,209,955,181,982,157,1014,137,1048,121,1083,99,1149,89,1195,83,1194,94,1147,116,1081,133,1045,153,1011,177,978,206,951,225,939"/>
<area shape="poly" title=" " alt="" coords="218,1000,209,1006,185,1027,163,1051,128,1106,104,1157,90,1195,85,1194,99,1155,123,1103,159,1048,181,1023,206,1001,215,996"/>
<area shape="poly" title=" " alt="" coords="236,1057,209,1070,171,1100,138,1135,94,1196,90,1192,134,1131,167,1096,206,1065,233,1052"/>
<area shape="poly" title=" " alt="" coords="228,1113,209,1121,177,1138,146,1158,100,1196,97,1192,143,1154,174,1133,207,1116,226,1108"/>
<area shape="poly" title=" " alt="" coords="227,212,158,203,158,198,228,207"/>
<area shape="poly" title=" " alt="" coords="240,685,108,713,107,708,239,680"/>
<area shape="poly" title=" " alt="" coords="239,1172,140,1197,138,1191,237,1167"/>
<area shape="poly" title=" " alt="" coords="228,1210,152,1210,152,1205,228,1205"/>
<area shape="poly" title=" " alt="" coords="228,718,108,718,108,713,228,713"/>
<area shape="poly" title=" " alt="" coords="238,362,206,348,170,320,139,285,96,220,100,217,143,282,174,316,209,344,240,358"/>
<area shape="poly" title=" " alt="" coords="225,753,107,724,108,719,227,748"/>
<area shape="poly" title=" " alt="" coords="239,1243,147,1224,148,1218,240,1238"/>
<area shape="poly" title=" " alt="" coords="238,1295,207,1285,147,1254,100,1223,103,1219,150,1250,209,1280,239,1290"/>
<area shape="poly" title=" " alt="" coords="239,1347,206,1334,169,1308,136,1277,91,1223,95,1219,140,1273,172,1304,209,1329,241,1342"/>
<area shape="poly" title=" " alt="" coords="224,1392,206,1383,163,1345,128,1299,103,1255,87,1222,92,1220,107,1253,132,1296,167,1341,209,1379,226,1388"/>
<area shape="poly" title=" " alt="" coords="245,1450,225,1443,206,1432,179,1409,156,1381,121,1320,97,1263,84,1221,90,1220,102,1261,125,1318,161,1378,183,1405,209,1428,227,1438,247,1445"/>
</map>
</div>

</div>
</div>
<a id="a3be331dcf8907ff3569e4dc230e1c615" name="a3be331dcf8907ff3569e4dc230e1c615"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3be331dcf8907ff3569e4dc230e1c615">&#9670;&#160;</a></span>yh_create_session_derived()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_create_session_derived </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__connector.html">yh_connector</a> *</td>          <td class="paramname"><span class="paramname"><em>connector</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a></td>          <td class="paramname"><span class="paramname"><em>authkey_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>password</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>password_len</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>recreate_session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structyh__session.html">yh_session</a> **</td>          <td class="paramname"><span class="paramname"><em>session</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create a session that uses an encryption key and a MAC key derived from a password</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">connector</td><td>Connector to the device </td></tr>
    <tr><td class="paramname">authkey_id</td><td>Object ID of the Authentication Key used to authenticate the session </td></tr>
    <tr><td class="paramname">password</td><td>Password used to derive the session encryption key and MAC key </td></tr>
    <tr><td class="paramname">password_len</td><td>Length of the password in bytes </td></tr>
    <tr><td class="paramname">recreate_session</td><td>If true, the session will be recreated if expired. This caches the password in memory </td></tr>
    <tr><td class="paramname">session</td><td>The created session</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> if the connector, the password or the session are NULL. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a39fbc5bce29b178582419ae9d31ad252" title="Return value when encountering an unknown error.">YHR_GENERIC_ERROR</a> if failed to derive the session encryption key and/or the MAC key or if PRNG related errors occur. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a75ea079345046cdbf5612bf9065d8711" title="Returned value when unable to allocate memory.">YHR_MEMORY_ERROR</a> if failed to allocate memory for the session. See <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> for other possible errors</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a href="https://developers.yubico.com/YubiHSM2/Concepts/Session.html">Session</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l00593">593</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  595</span>                                                                     {</div>
<div class="line"><span class="lineno">  596</span> </div>
<div class="line"><span class="lineno">  597</span>  <span class="keywordflow">if</span> (connector == NULL || password == NULL || <a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a> == NULL) {</div>
<div class="line"><span class="lineno">  598</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>));</div>
<div class="line"><span class="lineno">  599</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno">  600</span>  }</div>
<div class="line"><span class="lineno">  601</span> </div>
<div class="line"><span class="lineno">  602</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> key_enc[<a class="code hl_define" href="scp_8h.html#a25905234f13446437b28c85d0504216d">SCP_KEY_LEN</a>];</div>
<div class="line"><span class="lineno">  603</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> key_mac[<a class="code hl_define" href="scp_8h.html#a25905234f13446437b28c85d0504216d">SCP_KEY_LEN</a>];</div>
<div class="line"><span class="lineno">  604</span> </div>
<div class="line"><span class="lineno">  605</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = derive_keys(password, password_len, key_enc, key_mac);</div>
<div class="line"><span class="lineno">  606</span> </div>
<div class="line"><span class="lineno">  607</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> == <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno">  608</span>    <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="#a0e96ea59c5f32def80843fec5a3c2142">yh_create_session</a>(connector, authkey_id, key_enc, <a class="code hl_define" href="scp_8h.html#a25905234f13446437b28c85d0504216d">SCP_KEY_LEN</a>,</div>
<div class="line"><span class="lineno">  609</span>                            key_mac, <a class="code hl_define" href="scp_8h.html#a25905234f13446437b28c85d0504216d">SCP_KEY_LEN</a>, recreate, <a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>);</div>
<div class="line"><span class="lineno">  610</span>    <a class="code hl_define" href="insecure__memzero_8h.html#a0794f9275fd1036ecba6ff0a901a320b">insecure_memzero</a>(key_enc, <span class="keyword">sizeof</span>(key_enc));</div>
<div class="line"><span class="lineno">  611</span>    <a class="code hl_define" href="insecure__memzero_8h.html#a0794f9275fd1036ecba6ff0a901a320b">insecure_memzero</a>(key_mac, <span class="keyword">sizeof</span>(key_mac));</div>
<div class="line"><span class="lineno">  612</span>  }</div>
<div class="line"><span class="lineno">  613</span>  <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno">  614</span>}</div>
<div class="ttc" id="ayubihsm_8c_html_a0e96ea59c5f32def80843fec5a3c2142"><div class="ttname"><a href="#a0e96ea59c5f32def80843fec5a3c2142">yh_create_session</a></div><div class="ttdeci">yh_rc yh_create_session(yh_connector *connector, uint16_t authkey_id, const uint8_t *key_enc, size_t key_enc_len, const uint8_t *key_mac, size_t key_mac_len, bool recreate, yh_session **session)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l00616">yubihsm.c:616</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a3be331dcf8907ff3569e4dc230e1c615_cgraph.png" border="0" usemap="#ayubihsm_8c_a3be331dcf8907ff3569e4dc230e1c615_cgraph" alt=""/></div>
<map name="ayubihsm_8c_a3be331dcf8907ff3569e4dc230e1c615_cgraph" id="ayubihsm_8c_a3be331dcf8907ff3569e4dc230e1c615_cgraph">
<area shape="rect" title=" " alt="" coords="5,79,185,104"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="233,53,363,79"/>
<area shape="poly" title=" " alt="" coords="185,78,217,74,218,79,186,83"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="421,104,504,130"/>
<area shape="poly" title=" " alt="" coords="185,95,405,110,405,116,185,100"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="427,5,498,31"/>
<area shape="poly" title=" " alt="" coords="344,50,411,30,413,35,346,55"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="411,55,514,80"/>
<area shape="poly" title=" " alt="" coords="363,64,395,64,395,70,363,69"/>
<area shape="poly" title=" " alt="" coords="343,77,407,97,405,102,341,82"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a3be331dcf8907ff3569e4dc230e1c615_icgraph.png" border="0" usemap="#ayubihsm_8c_a3be331dcf8907ff3569e4dc230e1c615_icgraph" alt=""/></div>
<map name="ayubihsm_8c_a3be331dcf8907ff3569e4dc230e1c615_icgraph" id="ayubihsm_8c_a3be331dcf8907ff3569e4dc230e1c615_icgraph">
<area shape="rect" title=" " alt="" coords="498,104,678,130"/>
<area shape="rect" href="attest_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="348,5,398,31"/>
<area shape="poly" title=" " alt="" coords="550,98,449,46,398,28,399,23,451,41,553,93"/>
<area shape="rect" href="structsysio_1_1wallet_1_1detail_1_1yubihsm__wallet__impl.html#a00ee0ac7ac4a819d0b8755bf4f442263" title=" " alt="" coords="298,56,448,111"/>
<area shape="poly" title=" " alt="" coords="485,104,448,98,449,93,486,98"/>
<area shape="rect" href="commands_8c.html#ae2e50929acc6085cd395d0bd4ddb02db" title=" " alt="" coords="304,136,442,162"/>
<area shape="poly" title=" " alt="" coords="484,135,443,141,442,136,483,130"/>
<area shape="rect" href="commands_8c.html#a22f22a25151b12c7573f80563a341368" title=" " alt="" coords="296,185,450,211"/>
<area shape="poly" title=" " alt="" coords="544,139,451,177,420,187,418,182,449,172,542,134"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,136,248,162"/>
<area shape="poly" title=" " alt="" coords="288,152,249,152,249,146,288,146"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,161,55,187"/>
<area shape="poly" title=" " alt="" coords="88,167,55,173,54,167,87,162"/>
<area shape="poly" title=" " alt="" coords="303,184,229,165,231,160,304,178"/>
<area shape="poly" title=" " alt="" coords="280,194,55,178,55,173,281,189"/>
</map>
</div>

</div>
</div>
<a id="a1a35f8ae5a739848408633a514e41b2d" name="a1a35f8ae5a739848408633a514e41b2d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a35f8ae5a739848408633a514e41b2d">&#9670;&#160;</a></span>yh_destroy_session()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_destroy_session </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__session.html">yh_session</a> **</td>          <td class="paramname"><span class="paramname"><em>session</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Free data associated with the session</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>Pointer to the session to destroy</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> if the session is NULL.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a href="https://developers.yubico.com/YubiHSM2/Concepts/Session.html">Session</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l00890">890</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  890</span>                                               {</div>
<div class="line"><span class="lineno">  891</span> </div>
<div class="line"><span class="lineno">  892</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a> == NULL) {</div>
<div class="line"><span class="lineno">  893</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>));</div>
<div class="line"><span class="lineno">  894</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno">  895</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a> == NULL) {</div>
<div class="line"><span class="lineno">  896</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno">  897</span>  }</div>
<div class="line"><span class="lineno">  898</span> </div>
<div class="line"><span class="lineno">  899</span>  <a class="code hl_define" href="insecure__memzero_8h.html#a0794f9275fd1036ecba6ff0a901a320b">insecure_memzero</a>(*<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structyh__session.html">yh_session</a>));</div>
<div class="line"><span class="lineno">  900</span>  free(*<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>);</div>
<div class="line"><span class="lineno">  901</span>  *<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a> = NULL;</div>
<div class="line"><span class="lineno">  902</span> </div>
<div class="line"><span class="lineno">  903</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno">  904</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a1a35f8ae5a739848408633a514e41b2d_cgraph.png" border="0" usemap="#ayubihsm_8c_a1a35f8ae5a739848408633a514e41b2d_cgraph" alt=""/></div>
<map name="ayubihsm_8c_a1a35f8ae5a739848408633a514e41b2d_cgraph" id="ayubihsm_8c_a1a35f8ae5a739848408633a514e41b2d_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,143,31"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="191,5,274,31"/>
<area shape="poly" title=" " alt="" coords="143,16,175,16,175,21,143,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a1a35f8ae5a739848408633a514e41b2d_icgraph.png" border="0" usemap="#ayubihsm_8c_a1a35f8ae5a739848408633a514e41b2d_icgraph" alt=""/></div>
<map name="ayubihsm_8c_a1a35f8ae5a739848408633a514e41b2d_icgraph" id="ayubihsm_8c_a1a35f8ae5a739848408633a514e41b2d_icgraph">
<area shape="rect" title=" " alt="" coords="641,274,779,299"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#a48d97eeb2196fb96be0f0ba4c82d5063" title=" " alt="" coords="415,88,589,114"/>
<area shape="poly" title=" " alt="" coords="694,261,655,193,626,158,592,127,572,117,575,112,595,123,630,154,659,190,699,258"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae42be1463b17c635f1d1db61afc0db16" title=" " alt="" coords="415,138,589,163"/>
<area shape="poly" title=" " alt="" coords="687,263,646,219,620,196,592,177,568,166,570,161,595,172,624,192,650,215,691,259"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#a011b512f4b9e6e43e3ab56b5534f3fde" title=" " alt="" coords="415,187,589,213"/>
<area shape="poly" title=" " alt="" coords="673,268,592,228,557,216,559,211,594,223,675,263"/>
<area shape="rect" href="structsysio_1_1wallet_1_1detail_1_1yubihsm__wallet__impl.html#a5920ace754a2d851bdb11322372b849c" title=" " alt="" coords="411,237,593,278"/>
<area shape="poly" title=" " alt="" coords="625,277,593,273,594,267,626,272"/>
<area shape="rect" href="attest_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="478,302,527,327"/>
<area shape="poly" title=" " alt="" coords="626,300,528,314,527,309,626,295"/>
<area shape="rect" href="commands_8c.html#aabb06b0c16a19b4b22478cb753d8f599" title=" " alt="" coords="424,351,581,377"/>
<area shape="poly" title=" " alt="" coords="671,309,594,342,560,353,559,348,592,337,669,304"/>
<area shape="rect" href="commands_8c.html#ac388fd67865728ed4f4267a8a13b248e" title=" " alt="" coords="434,400,571,426"/>
<area shape="poly" title=" " alt="" coords="690,313,648,353,622,374,595,392,569,402,567,397,592,387,619,369,645,349,686,309"/>
<area shape="rect" href="commands_8c.html#a22f22a25151b12c7573f80563a341368" title=" " alt="" coords="425,450,579,475"/>
<area shape="poly" title=" " alt="" coords="698,315,658,378,629,412,595,441,574,451,572,447,592,436,625,408,653,375,693,312"/>
<area shape="rect" href="structsysio_1_1wallet_1_1detail_1_1yubihsm__wallet__impl.html#a6266bcd9001ddbb02101bea6088f299b" title=" " alt="" coords="208,5,358,61"/>
<area shape="poly" title=" " alt="" coords="411,229,409,227,394,208,387,188,383,151,380,113,374,94,361,75,349,63,352,59,365,71,379,92,386,112,388,150,392,187,399,205,413,223,415,225"/>
<area shape="rect" href="structsysio_1_1wallet_1_1detail_1_1yubihsm__wallet__impl.html#a6412f92a0ad381f2370582372a5b6082" title=" " alt="" coords="204,109,363,165"/>
<area shape="poly" title=" " alt="" coords="418,232,410,227,385,207,361,186,334,168,337,163,365,182,388,203,412,223,421,227"/>
<area shape="rect" href="structsysio_1_1wallet_1_1detail_1_1yubihsm__wallet__impl.html#a00ee0ac7ac4a819d0b8755bf4f442263" title=" " alt="" coords="5,143,156,198"/>
<area shape="poly" title=" " alt="" coords="395,237,362,230,155,188,156,183,364,225,396,232"/>
<area shape="rect" href="structsysio_1_1wallet_1_1detail_1_1yubihsm__wallet__impl.html#a8987016445813c0391f04894e9bdb002" title=" " alt="" coords="208,240,358,296"/>
<area shape="poly" title=" " alt="" coords="396,265,359,267,359,262,395,260"/>
<area shape="rect" href="structsysio_1_1wallet_1_1detail_1_1yubihsm__wallet__impl.html#af535b22a76cac37f33ef43715865648c" title=" " alt="" coords="204,320,362,376"/>
<area shape="poly" title=" " alt="" coords="427,286,412,292,344,322,342,317,410,287,425,281"/>
<area shape="poly" title=" " alt="" coords="315,97,303,90,283,88,266,90,254,95,249,101,249,109,243,109,244,99,251,90,264,85,283,83,305,85,318,92"/>
<area shape="poly" title=" " alt="" coords="189,155,157,161,156,155,188,150"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="211,400,356,426"/>
<area shape="poly" title=" " alt="" coords="428,383,344,402,343,397,426,378"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="56,426,105,451"/>
<area shape="poly" title=" " alt="" coords="196,427,106,438,105,433,195,421"/>
<area shape="poly" title=" " alt="" coords="418,416,356,416,356,410,418,410"/>
<area shape="poly" title=" " alt="" coords="426,448,343,429,344,424,428,443"/>
<area shape="poly" title=" " alt="" coords="409,460,106,443,106,437,409,455"/>
</map>
</div>

</div>
</div>
<a id="ab12d5a42d2219741bd3630b99ed1c7d2" name="ab12d5a42d2219741bd3630b99ed1c7d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab12d5a42d2219741bd3630b99ed1c7d2">&#9670;&#160;</a></span>yh_disconnect()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_disconnect </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__connector.html">yh_connector</a> *</td>          <td class="paramname"><span class="paramname"><em>connector</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Disconnect from a connector</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">connector</td><td>Connector from which to disconnect</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> if the connector is NULL </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l04097">4097</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4097</span>                                             {</div>
<div class="line"><span class="lineno"> 4098</span> </div>
<div class="line"><span class="lineno"> 4099</span>  <span class="keywordflow">if</span> (connector == NULL) {</div>
<div class="line"><span class="lineno"> 4100</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>));</div>
<div class="line"><span class="lineno"> 4101</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 4102</span>  }</div>
<div class="line"><span class="lineno"> 4103</span> </div>
<div class="line"><span class="lineno"> 4104</span>  destroy_connector(connector);</div>
<div class="line"><span class="lineno"> 4105</span> </div>
<div class="line"><span class="lineno"> 4106</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 4107</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_ab12d5a42d2219741bd3630b99ed1c7d2_cgraph.png" border="0" usemap="#ayubihsm_8c_ab12d5a42d2219741bd3630b99ed1c7d2_cgraph" alt=""/></div>
<map name="ayubihsm_8c_ab12d5a42d2219741bd3630b99ed1c7d2_cgraph" id="ayubihsm_8c_ab12d5a42d2219741bd3630b99ed1c7d2_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,111,31"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="159,5,242,31"/>
<area shape="poly" title=" " alt="" coords="111,16,143,16,143,21,111,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_ab12d5a42d2219741bd3630b99ed1c7d2_icgraph.png" border="0" usemap="#ayubihsm_8c_ab12d5a42d2219741bd3630b99ed1c7d2_icgraph" alt=""/></div>
<map name="ayubihsm_8c_ab12d5a42d2219741bd3630b99ed1c7d2_icgraph" id="ayubihsm_8c_ab12d5a42d2219741bd3630b99ed1c7d2_icgraph">
<area shape="rect" title=" " alt="" coords="641,307,747,333"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#a553b528011491713b85dc590221ea616" title=" " alt="" coords="415,192,589,218"/>
<area shape="poly" title=" " alt="" coords="670,297,635,264,592,233,564,221,566,216,595,228,639,260,673,294"/>
<area shape="rect" href="structsysio_1_1wallet_1_1detail_1_1yubihsm__wallet__impl.html#a5920ace754a2d851bdb11322372b849c" title=" " alt="" coords="411,242,593,283"/>
<area shape="poly" title=" " alt="" coords="633,305,572,286,574,281,635,300"/>
<area shape="rect" href="attest_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="478,307,527,333"/>
<area shape="poly" title=" " alt="" coords="626,322,527,322,527,317,626,317"/>
<area shape="rect" href="commands_8c.html#a9155cc4306ad97e58a03ead18637f33b" title=" " alt="" coords="442,406,562,431"/>
<area shape="poly" title=" " alt="" coords="669,345,635,372,595,397,564,409,562,404,592,392,632,368,666,341"/>
<area shape="rect" href="commands_8c.html#ac388fd67865728ed4f4267a8a13b248e" title=" " alt="" coords="434,356,571,382"/>
<area shape="poly" title=" " alt="" coords="627,340,556,358,554,353,626,334"/>
<area shape="rect" href="structsysio_1_1wallet_1_1detail_1_1yubihsm__wallet__impl.html#a6266bcd9001ddbb02101bea6088f299b" title=" " alt="" coords="208,5,358,61"/>
<area shape="poly" title=" " alt="" coords="411,234,409,232,394,212,386,192,383,153,381,114,374,95,361,75,349,63,352,59,365,71,379,93,386,113,388,153,391,191,399,210,413,229,414,230"/>
<area shape="rect" href="structsysio_1_1wallet_1_1detail_1_1yubihsm__wallet__impl.html#a6412f92a0ad381f2370582372a5b6082" title=" " alt="" coords="204,109,363,165"/>
<area shape="poly" title=" " alt="" coords="417,237,410,233,394,221,384,210,361,186,335,168,338,163,365,182,388,206,398,217,412,228,420,233"/>
<area shape="rect" href="structsysio_1_1wallet_1_1detail_1_1yubihsm__wallet__impl.html#a00ee0ac7ac4a819d0b8755bf4f442263" title=" " alt="" coords="5,143,156,198"/>
<area shape="poly" title=" " alt="" coords="405,241,362,230,155,187,157,182,364,225,406,235"/>
<area shape="rect" href="structsysio_1_1wallet_1_1detail_1_1yubihsm__wallet__impl.html#a8987016445813c0391f04894e9bdb002" title=" " alt="" coords="208,240,358,296"/>
<area shape="poly" title=" " alt="" coords="396,268,359,269,359,263,395,262"/>
<area shape="rect" href="structsysio_1_1wallet_1_1detail_1_1yubihsm__wallet__impl.html#af535b22a76cac37f33ef43715865648c" title=" " alt="" coords="204,320,362,376"/>
<area shape="poly" title=" " alt="" coords="428,291,412,297,351,322,349,317,410,292,426,286"/>
<area shape="poly" title=" " alt="" coords="315,97,303,90,283,88,266,90,254,95,249,101,249,109,243,109,244,99,251,90,264,85,283,83,305,85,318,92"/>
<area shape="poly" title=" " alt="" coords="189,155,157,161,156,155,188,150"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="211,400,356,426"/>
<area shape="poly" title=" " alt="" coords="426,419,356,418,356,412,427,414"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="56,426,105,451"/>
<area shape="poly" title=" " alt="" coords="427,434,363,441,217,445,106,442,106,437,217,440,363,436,426,429"/>
<area shape="poly" title=" " alt="" coords="196,427,106,438,105,433,195,421"/>
<area shape="poly" title=" " alt="" coords="421,388,351,402,350,397,420,383"/>
</map>
</div>

</div>
</div>
<a id="a0100df295f7ecf0d0cc90052aac20586" name="a0100df295f7ecf0d0cc90052aac20586"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0100df295f7ecf0d0cc90052aac20586">&#9670;&#160;</a></span>yh_domains_to_string()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_domains_to_string </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a></td>          <td class="paramname"><span class="paramname"><em>domains</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *</td>          <td class="paramname"><span class="paramname"><em>string</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>max_len</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Convert domains parameter to its String representation</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">domains</td><td>Encoded domains </td></tr>
    <tr><td class="paramname">string</td><td>Domains as a string </td></tr>
    <tr><td class="paramname">max_len</td><td>Maximum length of the string</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366ad8971a0b9647564b76b3f4e4b662c965" title="Returned value when there is not enough space to store data.">YHR_BUFFER_TOO_SMALL</a> if <code>max_len</code> is too small</dd></dl>
<dl class="section user"><dt>Examples</dt><dd></dd></dl>
<ul>
<li>1 =&gt; "1"</li>
<li>0x8001 =&gt; "1:16"</li>
<li>0, ""</li>
<li>0xffff =&gt; "1:2:3:4:5:6:7:8:9:10:11:12:13:14:15:16"</li>
</ul>
<dl class="section see"><dt>See also</dt><dd><a href="https://developers.yubico.com/YubiHSM2/Concepts/Domain.html">Domains</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l04587">4587</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4587</span>                                                                           {</div>
<div class="line"><span class="lineno"> 4588</span>  <span class="keywordtype">char</span> *ptr = string;</div>
<div class="line"><span class="lineno"> 4589</span>  *ptr = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno"> 4590</span>  <span class="keywordflow">for</span> (<a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> i = 0; i &lt; <a class="code hl_define" href="yubihsm_8h.html#aedf3b950c50f82299eddf54d0338dd60">YH_MAX_DOMAINS</a>; i++) {</div>
<div class="line"><span class="lineno"> 4591</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a5420fd4d2f76428942c2716b1cb7e863">domains</a> &amp; (1 &lt;&lt; i)) {</div>
<div class="line"><span class="lineno"> 4592</span>      <span class="keywordtype">size_t</span> wrote = snprintf(ptr, max_len, <span class="stringliteral">&quot;%d:&quot;</span>, i + 1);</div>
<div class="line"><span class="lineno"> 4593</span>      <span class="keywordflow">if</span> (wrote &gt;= max_len) {</div>
<div class="line"><span class="lineno"> 4594</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366ad8971a0b9647564b76b3f4e4b662c965">YHR_BUFFER_TOO_SMALL</a>;</div>
<div class="line"><span class="lineno"> 4595</span>      }</div>
<div class="line"><span class="lineno"> 4596</span>      ptr += wrote;</div>
<div class="line"><span class="lineno"> 4597</span>      max_len -= wrote;</div>
<div class="line"><span class="lineno"> 4598</span>    }</div>
<div class="line"><span class="lineno"> 4599</span>  }</div>
<div class="line"><span class="lineno"> 4600</span>  <span class="keywordflow">if</span> (ptr != <span class="keywordtype">string</span>) {</div>
<div class="line"><span class="lineno"> 4601</span>    *(ptr - 1) = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno"> 4602</span>  }</div>
<div class="line"><span class="lineno"> 4603</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 4604</span>}</div>
<div class="ttc" id="ayubihsm_8h_html_aedf3b950c50f82299eddf54d0338dd60"><div class="ttname"><a href="yubihsm_8h.html#aedf3b950c50f82299eddf54d0338dd60">YH_MAX_DOMAINS</a></div><div class="ttdeci">#define YH_MAX_DOMAINS</div><div class="ttdoc">Max number of domains.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00125">yubihsm.h:125</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a5420fd4d2f76428942c2716b1cb7e863"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a5420fd4d2f76428942c2716b1cb7e863">domains</a></div><div class="ttdeci">uint16_t domains</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l01926">yubihsm_pkcs11.c:1926</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a0100df295f7ecf0d0cc90052aac20586_icgraph.png" border="0" usemap="#ayubihsm_8c_a0100df295f7ecf0d0cc90052aac20586_icgraph" alt=""/></div>
<map name="ayubihsm_8c_a0100df295f7ecf0d0cc90052aac20586_icgraph" id="ayubihsm_8c_a0100df295f7ecf0d0cc90052aac20586_icgraph">
<area shape="rect" title=" " alt="" coords="506,31,655,56"/>
<area shape="rect" href="commands_8c.html#afa7330c81148ba6f4d5c53f7c370ed41" title=" " alt="" coords="296,31,458,56"/>
<area shape="poly" title=" " alt="" coords="491,46,459,46,459,41,491,41"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="280,34,248,30,249,25,281,29"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,31,55,56"/>
<area shape="poly" title=" " alt="" coords="280,46,55,46,55,41,280,41"/>
<area shape="poly" title=" " alt="" coords="88,36,55,42,54,37,87,31"/>
</map>
</div>

</div>
</div>
<a id="a36e3d9a07c6689e14a9339ca1ebb7259" name="a36e3d9a07c6689e14a9339ca1ebb7259"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a36e3d9a07c6689e14a9339ca1ebb7259">&#9670;&#160;</a></span>yh_exit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_exit </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Global library clean up</p>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l03910">3910</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3910</span>{ <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>; }</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a36e3d9a07c6689e14a9339ca1ebb7259_icgraph.png" border="0" usemap="#ayubihsm_8c_a36e3d9a07c6689e14a9339ca1ebb7259_icgraph" alt=""/></div>
<map name="ayubihsm_8c_a36e3d9a07c6689e14a9339ca1ebb7259_icgraph" id="ayubihsm_8c_a36e3d9a07c6689e14a9339ca1ebb7259_icgraph">
<area shape="rect" title=" " alt="" coords="228,104,291,130"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#af7ca295a6817bd3aab2a5405bd716103" title=" " alt="" coords="5,5,180,31"/>
<area shape="poly" title=" " alt="" coords="236,94,210,68,178,44,155,34,157,29,181,40,214,64,240,90"/>
<area shape="rect" href="yubihsm__shell__tests_8c.html#ae66f6b31b5ad750f1fe042a706a4e3d4" title=" " alt="" coords="68,55,117,80"/>
<area shape="poly" title=" " alt="" coords="212,104,179,94,117,76,118,71,180,89,214,99"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="68,104,117,130"/>
<area shape="poly" title=" " alt="" coords="212,120,118,120,118,114,212,114"/>
<area shape="rect" href="attest_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="68,153,117,179"/>
<area shape="poly" title=" " alt="" coords="214,134,180,145,118,162,117,157,179,140,212,129"/>
<area shape="rect" href="structsysio_1_1wallet_1_1detail_1_1yubihsm__wallet__impl.html#af535b22a76cac37f33ef43715865648c" title=" " alt="" coords="13,204,172,259"/>
<area shape="poly" title=" " alt="" coords="239,143,212,169,181,194,162,205,159,201,178,189,209,165,235,139"/>
</map>
</div>

</div>
</div>
<a id="a900031f15115ee22e885d2de7ec80a4a" name="a900031f15115ee22e885d2de7ec80a4a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a900031f15115ee22e885d2de7ec80a4a">&#9670;&#160;</a></span>yh_filter_capabilities()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_filter_capabilities </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structyh__capabilities.html">yh_capabilities</a> *</td>          <td class="paramname"><span class="paramname"><em>capabilities</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structyh__capabilities.html">yh_capabilities</a> *</td>          <td class="paramname"><span class="paramname"><em>filter</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structyh__capabilities.html">yh_capabilities</a> *</td>          <td class="paramname"><span class="paramname"><em>result</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Filter one set of capabilities with another. The resulting set of capabilities contains only the capabilities that exist in both sets of input capabilities</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">capabilities</td><td>Array of <a class="el" href="structyh__capabilities.html" title="Capabilities representation.">yh_capabilities</a> </td></tr>
    <tr><td class="paramname">filter</td><td>Array of <a class="el" href="structyh__capabilities.html" title="Capabilities representation.">yh_capabilities</a> </td></tr>
    <tr><td class="paramname">result</td><td>Resulting array of <a class="el" href="structyh__capabilities.html" title="Capabilities representation.">yh_capabilities</a></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> if input parameters are NULL.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a href="https://developers.yubico.com/YubiHSM2/Concepts/Capability.html">Capability</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l04231">4231</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4233</span>                                                      {</div>
<div class="line"><span class="lineno"> 4234</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a> == NULL || filter == NULL || result == NULL) {</div>
<div class="line"><span class="lineno"> 4235</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 4236</span>  }</div>
<div class="line"><span class="lineno"> 4237</span> </div>
<div class="line"><span class="lineno"> 4238</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_define" href="yubihsm_8h.html#ad3c904849d17cae0a6f426e8007731d7">YH_CAPABILITIES_LEN</a>; i++) {</div>
<div class="line"><span class="lineno"> 4239</span>    result-&gt;capabilities[i] =</div>
<div class="line"><span class="lineno"> 4240</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>-&gt;<a class="code hl_variable" href="structyh__capabilities.html#a5398bad7e61385aa127265ba0a053079">capabilities</a>[i] &amp; filter-&gt;capabilities[i];</div>
<div class="line"><span class="lineno"> 4241</span>  }</div>
<div class="line"><span class="lineno"> 4242</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 4243</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="afbcb5c761339fbcf444be8f338b4614f" name="afbcb5c761339fbcf444be8f338b4614f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afbcb5c761339fbcf444be8f338b4614f">&#9670;&#160;</a></span>yh_finish_create_session_ext()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_finish_create_session_ext </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__connector.html">yh_connector</a> *</td>          <td class="paramname"><span class="paramname"><em>connector</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structyh__session.html">yh_session</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>key_senc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>key_senc_len</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>key_smac</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>key_smac_len</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>key_srmac</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>key_srmac_len</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>card_cryptogram</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>card_cryptogram_len</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Finish creating external session. The session's encryption key and MAC key are not stored in the device.</p>
<p>This function must be called after <a class="el" href="yubihsm_8h.html#a296b43eadb1151017ba8e9578b351c5e">yh_begin_create_session_ext()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">connector</td><td>Connector to the device </td></tr>
    <tr><td class="paramname">session</td><td>The session created with <a class="el" href="yubihsm_8h.html#a296b43eadb1151017ba8e9578b351c5e">yh_begin_create_session_ext()</a> </td></tr>
    <tr><td class="paramname">key_senc</td><td>Session encryption key used to encrypt the messages exchanged with the device </td></tr>
    <tr><td class="paramname">key_senc_len</td><td>Lenght of the encryption key. Must be <a class="el" href="yubihsm_8h.html#ac2737b2a34c26d0258d25e34993df391" title="Length of authentication keys.">YH_KEY_LEN</a> </td></tr>
    <tr><td class="paramname">key_smac</td><td>Session MAC key used for creating the authentication tag for each message </td></tr>
    <tr><td class="paramname">key_smac_len</td><td>Length of the MAC key. Must be <a class="el" href="yubihsm_8h.html#ac2737b2a34c26d0258d25e34993df391" title="Length of authentication keys.">YH_KEY_LEN</a> </td></tr>
    <tr><td class="paramname">key_srmac</td><td>Session return MAC key used for creating the authentication tag for each response message </td></tr>
    <tr><td class="paramname">key_srmac_len</td><td>Length of the return MAC key. Must be <a class="el" href="yubihsm_8h.html#ac2737b2a34c26d0258d25e34993df391" title="Length of authentication keys.">YH_KEY_LEN</a> </td></tr>
    <tr><td class="paramname">card_cryptogram</td><td>Card cryptogram </td></tr>
    <tr><td class="paramname">card_cryptogram_len</td><td>Length of card cryptogram</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> if input parameters are NULL or any of the key lengths are not <a class="el" href="yubihsm_8h.html#ac2737b2a34c26d0258d25e34993df391" title="Length of authentication keys.">YH_KEY_LEN</a>. See <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> for other possible errors</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a href="https://developers.yubico.com/YubiHSM2/Concepts/Session.html">Session</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l00847">847</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  851</span>                              { <span class="comment">// TODO(adma): remove all these</span></div>
<div class="line"><span class="lineno">  852</span> </div>
<div class="line"><span class="lineno">  853</span>  <span class="keywordflow">if</span> (connector == NULL || <a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a> == NULL || key_senc == NULL ||</div>
<div class="line"><span class="lineno">  854</span>      key_senc_len != <a class="code hl_define" href="yubihsm_8h.html#ac2737b2a34c26d0258d25e34993df391">YH_KEY_LEN</a> || key_smac == NULL ||</div>
<div class="line"><span class="lineno">  855</span>      key_smac_len != <a class="code hl_define" href="yubihsm_8h.html#ac2737b2a34c26d0258d25e34993df391">YH_KEY_LEN</a> || key_srmac == NULL ||</div>
<div class="line"><span class="lineno">  856</span>      key_srmac_len != <a class="code hl_define" href="yubihsm_8h.html#ac2737b2a34c26d0258d25e34993df391">YH_KEY_LEN</a> || card_cryptogram == NULL ||</div>
<div class="line"><span class="lineno">  857</span>      card_cryptogram_len != <a class="code hl_define" href="scp_8h.html#afa9d0a3bb1ce2a7951ca1b5f9f06dbe7">SCP_CARD_CRYPTO_LEN</a>) {</div>
<div class="line"><span class="lineno">  858</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>));</div>
<div class="line"><span class="lineno">  859</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno">  860</span>  }</div>
<div class="line"><span class="lineno">  861</span> </div>
<div class="line"><span class="lineno">  862</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno">  863</span> </div>
<div class="line"><span class="lineno">  864</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>-&gt;s.s_enc, key_senc, key_senc_len);</div>
<div class="line"><span class="lineno">  865</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>-&gt;s.s_mac, key_smac, key_smac_len);</div>
<div class="line"><span class="lineno">  866</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>-&gt;s.s_rmac, key_srmac, key_srmac_len);</div>
<div class="line"><span class="lineno">  867</span> </div>
<div class="line"><span class="lineno">  868</span>  <a class="code hl_define" href="debug__lib_8h.html#a81b33f0d4ec623bff78e988d14388d60">DBG_INT</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>-&gt;s.s_enc, <a class="code hl_define" href="scp_8h.html#a25905234f13446437b28c85d0504216d">SCP_KEY_LEN</a>, <span class="stringliteral">&quot;S-ENC: &quot;</span>);</div>
<div class="line"><span class="lineno">  869</span>  <a class="code hl_define" href="debug__lib_8h.html#a81b33f0d4ec623bff78e988d14388d60">DBG_INT</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>-&gt;s.s_mac, <a class="code hl_define" href="scp_8h.html#a25905234f13446437b28c85d0504216d">SCP_KEY_LEN</a>, <span class="stringliteral">&quot;S-MAC: &quot;</span>);</div>
<div class="line"><span class="lineno">  870</span>  <a class="code hl_define" href="debug__lib_8h.html#a81b33f0d4ec623bff78e988d14388d60">DBG_INT</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>-&gt;s.s_rmac, <a class="code hl_define" href="scp_8h.html#a25905234f13446437b28c85d0504216d">SCP_KEY_LEN</a>, <span class="stringliteral">&quot;S-RMAC: &quot;</span>);</div>
<div class="line"><span class="lineno">  871</span> </div>
<div class="line"><span class="lineno">  872</span>  <span class="comment">// Verify card cryptogram</span></div>
<div class="line"><span class="lineno">  873</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = verify_card_cryptogram(&amp;<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>-&gt;s, <a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>-&gt;context, card_cryptogram);</div>
<div class="line"><span class="lineno">  874</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno">  875</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno">  876</span> </div>
<div class="line"><span class="lineno">  877</span>    free(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>);</div>
<div class="line"><span class="lineno">  878</span>    <a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a> = NULL;</div>
<div class="line"><span class="lineno">  879</span> </div>
<div class="line"><span class="lineno">  880</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno">  881</span> </div>
<div class="line"><span class="lineno">  882</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno">  883</span>  }</div>
<div class="line"><span class="lineno">  884</span> </div>
<div class="line"><span class="lineno">  885</span>  <a class="code hl_define" href="debug__lib_8h.html#a8c4742440a149ad8bcb5d58ae76c5ed3">DBG_INFO</a>(<span class="stringliteral">&quot;Card cryptogram successfully verified&quot;</span>);</div>
<div class="line"><span class="lineno">  886</span> </div>
<div class="line"><span class="lineno">  887</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno">  888</span>}</div>
<div class="ttc" id="ayubihsm_8h_html_ac2737b2a34c26d0258d25e34993df391"><div class="ttname"><a href="yubihsm_8h.html#ac2737b2a34c26d0258d25e34993df391">YH_KEY_LEN</a></div><div class="ttdeci">#define YH_KEY_LEN</div><div class="ttdoc">Length of authentication keys.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00095">yubihsm.h:95</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_afbcb5c761339fbcf444be8f338b4614f_cgraph.png" border="0" usemap="#ayubihsm_8c_afbcb5c761339fbcf444be8f338b4614f_cgraph" alt=""/></div>
<map name="ayubihsm_8c_afbcb5c761339fbcf444be8f338b4614f_cgraph" id="ayubihsm_8c_afbcb5c761339fbcf444be8f338b4614f_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,199,56"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="253,5,324,31"/>
<area shape="poly" title=" " alt="" coords="199,28,237,22,238,28,199,33"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="247,55,330,80"/>
<area shape="poly" title=" " alt="" coords="199,53,232,58,231,63,199,59"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_afbcb5c761339fbcf444be8f338b4614f_icgraph.png" border="0" usemap="#ayubihsm_8c_afbcb5c761339fbcf444be8f338b4614f_icgraph" alt=""/></div>
<map name="ayubihsm_8c_afbcb5c761339fbcf444be8f338b4614f_icgraph" id="ayubihsm_8c_afbcb5c761339fbcf444be8f338b4614f_icgraph">
<area shape="rect" title=" " alt="" coords="498,31,692,56"/>
<area shape="rect" href="commands_8c.html#a22f22a25151b12c7573f80563a341368" title=" " alt="" coords="296,31,450,56"/>
<area shape="poly" title=" " alt="" coords="483,46,451,46,451,41,483,41"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="280,34,248,30,249,25,281,29"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,31,55,56"/>
<area shape="poly" title=" " alt="" coords="280,46,55,46,55,41,280,41"/>
<area shape="poly" title=" " alt="" coords="88,36,55,42,54,37,87,31"/>
</map>
</div>

</div>
</div>
<a id="acb5d5e9a2718b9427269f7d267ca25b9" name="acb5d5e9a2718b9427269f7d267ca25b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb5d5e9a2718b9427269f7d267ca25b9">&#9670;&#160;</a></span>yh_get_connector_address()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_get_connector_address </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__connector.html">yh_connector</a> *</td>          <td class="paramname"><span class="paramname"><em>connector</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **const</td>          <td class="paramname"><span class="paramname"><em>address</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get connector address</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">connector</td><td>Connector currently in use </td></tr>
    <tr><td class="paramname">address</td><td>Pointer to the connector address as string</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> if input parameters are NULL. </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l00926">926</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  926</span>                                                                              {</div>
<div class="line"><span class="lineno">  927</span> </div>
<div class="line"><span class="lineno">  928</span>  <span class="keywordflow">if</span> (connector == NULL || address == NULL) {</div>
<div class="line"><span class="lineno">  929</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>));</div>
<div class="line"><span class="lineno">  930</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno">  931</span>  }</div>
<div class="line"><span class="lineno">  932</span> </div>
<div class="line"><span class="lineno">  933</span>  *address = (<span class="keywordtype">char</span> *) connector-&gt;<a class="code hl_variable" href="structyh__connector.html#a72b90da1f0e2f5b24ba1d2ce503754ff">address</a>;</div>
<div class="line"><span class="lineno">  934</span> </div>
<div class="line"><span class="lineno">  935</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno">  936</span>}</div>
<div class="ttc" id="astructyh__connector_html_a72b90da1f0e2f5b24ba1d2ce503754ff"><div class="ttname"><a href="structyh__connector.html#a72b90da1f0e2f5b24ba1d2ce503754ff">yh_connector::address</a></div><div class="ttdeci">uint8_t address[32]</div><div class="ttdef"><b>Definition</b> <a href="lib_2internal_8h_source.html#l00047">internal.h:47</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_acb5d5e9a2718b9427269f7d267ca25b9_cgraph.png" border="0" usemap="#ayubihsm_8c_acb5d5e9a2718b9427269f7d267ca25b9_cgraph" alt=""/></div>
<map name="ayubihsm_8c_acb5d5e9a2718b9427269f7d267ca25b9_cgraph" id="ayubihsm_8c_acb5d5e9a2718b9427269f7d267ca25b9_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,183,31"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="231,5,314,31"/>
<area shape="poly" title=" " alt="" coords="183,16,215,16,215,21,183,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_acb5d5e9a2718b9427269f7d267ca25b9_icgraph.png" border="0" usemap="#ayubihsm_8c_acb5d5e9a2718b9427269f7d267ca25b9_icgraph" alt=""/></div>
<map name="ayubihsm_8c_acb5d5e9a2718b9427269f7d267ca25b9_icgraph" id="ayubihsm_8c_acb5d5e9a2718b9427269f7d267ca25b9_icgraph">
<area shape="rect" title=" " alt="" coords="103,5,280,31"/>
<area shape="rect" href="echo_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="5,5,55,31"/>
<area shape="poly" title=" " alt="" coords="87,21,55,21,55,16,87,16"/>
</map>
</div>

</div>
</div>
<a id="a2b9f4070a103724b241e0a2b6a56d1ba" name="a2b9f4070a103724b241e0a2b6a56d1ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b9f4070a103724b241e0a2b6a56d1ba">&#9670;&#160;</a></span>yh_get_connector_version()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_get_connector_version </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__connector.html">yh_connector</a> *</td>          <td class="paramname"><span class="paramname"><em>connector</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>major</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>minor</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>patch</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get the connector version</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">connector</td><td>Connector currently in use </td></tr>
    <tr><td class="paramname">major</td><td>Connector major version </td></tr>
    <tr><td class="paramname">minor</td><td>Connector minor version </td></tr>
    <tr><td class="paramname">patch</td><td>Connector patch version</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> if input parameters are NULL. </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l00911">911</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  912</span>                                                               {</div>
<div class="line"><span class="lineno">  913</span> </div>
<div class="line"><span class="lineno">  914</span>  <span class="keywordflow">if</span> (connector == NULL || <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a5bd4e4c943762926c8f653b6224cced2">major</a> == NULL || <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ae2f416b0a34b7beb4ed3873d791ac393">minor</a> == NULL || <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a00c54fad5fef8d31eb75c1163468005b">patch</a> == NULL) {</div>
<div class="line"><span class="lineno">  915</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>));</div>
<div class="line"><span class="lineno">  916</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno">  917</span>  }</div>
<div class="line"><span class="lineno">  918</span> </div>
<div class="line"><span class="lineno">  919</span>  *<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a5bd4e4c943762926c8f653b6224cced2">major</a> = connector-&gt;<a class="code hl_variable" href="structyh__connector.html#af9b0901bc659e7e0c22d76e350bc7269">version_major</a>;</div>
<div class="line"><span class="lineno">  920</span>  *<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ae2f416b0a34b7beb4ed3873d791ac393">minor</a> = connector-&gt;<a class="code hl_variable" href="structyh__connector.html#ab53147f120dfdfa7f19882b8631401ce">version_minor</a>;</div>
<div class="line"><span class="lineno">  921</span>  *<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a00c54fad5fef8d31eb75c1163468005b">patch</a> = connector-&gt;<a class="code hl_variable" href="structyh__connector.html#a888c95a32a81c6c6e62f336214e965fa">version_patch</a>;</div>
<div class="line"><span class="lineno">  922</span> </div>
<div class="line"><span class="lineno">  923</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno">  924</span>}</div>
<div class="ttc" id="astructyh__connector_html_a888c95a32a81c6c6e62f336214e965fa"><div class="ttname"><a href="structyh__connector.html#a888c95a32a81c6c6e62f336214e965fa">yh_connector::version_patch</a></div><div class="ttdeci">uint8_t version_patch</div><div class="ttdef"><b>Definition</b> <a href="lib_2internal_8h_source.html#l00046">internal.h:46</a></div></div>
<div class="ttc" id="astructyh__connector_html_ab53147f120dfdfa7f19882b8631401ce"><div class="ttname"><a href="structyh__connector.html#ab53147f120dfdfa7f19882b8631401ce">yh_connector::version_minor</a></div><div class="ttdeci">uint8_t version_minor</div><div class="ttdef"><b>Definition</b> <a href="lib_2internal_8h_source.html#l00045">internal.h:45</a></div></div>
<div class="ttc" id="astructyh__connector_html_af9b0901bc659e7e0c22d76e350bc7269"><div class="ttname"><a href="structyh__connector.html#af9b0901bc659e7e0c22d76e350bc7269">yh_connector::version_major</a></div><div class="ttdeci">uint8_t version_major</div><div class="ttdef"><b>Definition</b> <a href="lib_2internal_8h_source.html#l00044">internal.h:44</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a00c54fad5fef8d31eb75c1163468005b"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a00c54fad5fef8d31eb75c1163468005b">patch</a></div><div class="ttdeci">uint8_t patch</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l00548">yubihsm_pkcs11.c:548</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a5bd4e4c943762926c8f653b6224cced2"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a5bd4e4c943762926c8f653b6224cced2">major</a></div><div class="ttdeci">uint8_t major</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l00546">yubihsm_pkcs11.c:546</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_ae2f416b0a34b7beb4ed3873d791ac393"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#ae2f416b0a34b7beb4ed3873d791ac393">minor</a></div><div class="ttdeci">uint8_t minor</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l00547">yubihsm_pkcs11.c:547</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a2b9f4070a103724b241e0a2b6a56d1ba_cgraph.png" border="0" usemap="#ayubihsm_8c_a2b9f4070a103724b241e0a2b6a56d1ba_cgraph" alt=""/></div>
<map name="ayubihsm_8c_a2b9f4070a103724b241e0a2b6a56d1ba_cgraph" id="ayubihsm_8c_a2b9f4070a103724b241e0a2b6a56d1ba_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,179,31"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="227,5,310,31"/>
<area shape="poly" title=" " alt="" coords="179,16,211,16,211,21,179,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a2b9f4070a103724b241e0a2b6a56d1ba_icgraph.png" border="0" usemap="#ayubihsm_8c_a2b9f4070a103724b241e0a2b6a56d1ba_icgraph" alt=""/></div>
<map name="ayubihsm_8c_a2b9f4070a103724b241e0a2b6a56d1ba_icgraph" id="ayubihsm_8c_a2b9f4070a103724b241e0a2b6a56d1ba_icgraph">
<area shape="rect" title=" " alt="" coords="103,5,276,31"/>
<area shape="rect" href="info_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="5,5,55,31"/>
<area shape="poly" title=" " alt="" coords="87,21,55,21,55,16,87,16"/>
</map>
</div>

</div>
</div>
<a id="a375000f12ac554eb8cbaa0e6b75c3a08" name="a375000f12ac554eb8cbaa0e6b75c3a08"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a375000f12ac554eb8cbaa0e6b75c3a08">&#9670;&#160;</a></span>yh_get_key_bitlength()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_get_key_bitlength </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55ca">yh_algorithm</a></td>          <td class="paramname"><span class="paramname"><em>algorithm</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *</td>          <td class="paramname"><span class="paramname"><em>result</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get the expected key length of a key generated by the given algorithm</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">algorithm</td><td>Algorithm to check. See <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55ca">yh_algorithm</a> </td></tr>
    <tr><td class="paramname">result</td><td>Expected bitlength of a key generated by the algorithm</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> if <code>result</code> is NULL or if the algorithm is no supported by YubiHSM 2. For a list of supported algorithms, see <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55ca">yh_algorithm</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l04309">4309</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4309</span>                                                                   {</div>
<div class="line"><span class="lineno"> 4310</span> </div>
<div class="line"><span class="lineno"> 4311</span>  <span class="keywordflow">if</span> (result == NULL) {</div>
<div class="line"><span class="lineno"> 4312</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 4313</span>  }</div>
<div class="line"><span class="lineno"> 4314</span> </div>
<div class="line"><span class="lineno"> 4315</span>  <span class="keywordflow">switch</span> (<a class="code hl_variable" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>) {</div>
<div class="line"><span class="lineno"> 4316</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caaafe94e6a770edb51c6db84f77d98d2c6">YH_ALGO_RSA_2048</a>:</div>
<div class="line"><span class="lineno"> 4317</span>      *result = 2048;</div>
<div class="line"><span class="lineno"> 4318</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4319</span> </div>
<div class="line"><span class="lineno"> 4320</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caafd3fbd9ed86caf267ccc77cb24d44426">YH_ALGO_RSA_3072</a>:</div>
<div class="line"><span class="lineno"> 4321</span>      *result = 3072;</div>
<div class="line"><span class="lineno"> 4322</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4323</span> </div>
<div class="line"><span class="lineno"> 4324</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caae5963322a0a0f43a1b74faa78e3a7329">YH_ALGO_RSA_4096</a>:</div>
<div class="line"><span class="lineno"> 4325</span>      *result = 4096;</div>
<div class="line"><span class="lineno"> 4326</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4327</span> </div>
<div class="line"><span class="lineno"> 4328</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caae4b191baf5c65f9234120080264d129b">YH_ALGO_EC_P256</a>:</div>
<div class="line"><span class="lineno"> 4329</span>      *result = 256;</div>
<div class="line"><span class="lineno"> 4330</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4331</span> </div>
<div class="line"><span class="lineno"> 4332</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa31094c17c66e4c365ca3dad353bc8bda">YH_ALGO_EC_P384</a>:</div>
<div class="line"><span class="lineno"> 4333</span>      *result = 384;</div>
<div class="line"><span class="lineno"> 4334</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4335</span> </div>
<div class="line"><span class="lineno"> 4336</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa05aec903fd67851f968aaa606fe2138a">YH_ALGO_EC_P521</a>:</div>
<div class="line"><span class="lineno"> 4337</span>      *result = 521;</div>
<div class="line"><span class="lineno"> 4338</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4339</span> </div>
<div class="line"><span class="lineno"> 4340</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caaedcbc07d82b18ca5c21eb3379a6cc010">YH_ALGO_EC_P224</a>:</div>
<div class="line"><span class="lineno"> 4341</span>      *result = 224;</div>
<div class="line"><span class="lineno"> 4342</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4343</span> </div>
<div class="line"><span class="lineno"> 4344</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caad423056b13955068935dc8b3ac0e65d1">YH_ALGO_EC_K256</a>:</div>
<div class="line"><span class="lineno"> 4345</span>      *result = 256;</div>
<div class="line"><span class="lineno"> 4346</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4347</span> </div>
<div class="line"><span class="lineno"> 4348</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caabd995726d45b6dd2388775db4767c80d">YH_ALGO_EC_BP256</a>:</div>
<div class="line"><span class="lineno"> 4349</span>      *result = 256;</div>
<div class="line"><span class="lineno"> 4350</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4351</span> </div>
<div class="line"><span class="lineno"> 4352</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa228fd3332b55c60438dfea6a1b09af36">YH_ALGO_EC_BP384</a>:</div>
<div class="line"><span class="lineno"> 4353</span>      *result = 394;</div>
<div class="line"><span class="lineno"> 4354</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4355</span> </div>
<div class="line"><span class="lineno"> 4356</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caab9c1be17b7b3f755346ff8c3cca3ed25">YH_ALGO_EC_BP512</a>:</div>
<div class="line"><span class="lineno"> 4357</span>      *result = 512;</div>
<div class="line"><span class="lineno"> 4358</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4359</span> </div>
<div class="line"><span class="lineno"> 4360</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa942e65c8cd0034eebe9a20c2297c7b06">YH_ALGO_HMAC_SHA1</a>:</div>
<div class="line"><span class="lineno"> 4361</span>      *result = 160;</div>
<div class="line"><span class="lineno"> 4362</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4363</span> </div>
<div class="line"><span class="lineno"> 4364</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caab0a0e1eb424b61057f159f1e53311f5c">YH_ALGO_HMAC_SHA256</a>:</div>
<div class="line"><span class="lineno"> 4365</span>      *result = 256;</div>
<div class="line"><span class="lineno"> 4366</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4367</span> </div>
<div class="line"><span class="lineno"> 4368</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa781e7ca62563917d2129bde8ec53401b">YH_ALGO_HMAC_SHA384</a>:</div>
<div class="line"><span class="lineno"> 4369</span>      *result = 384;</div>
<div class="line"><span class="lineno"> 4370</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4371</span> </div>
<div class="line"><span class="lineno"> 4372</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa72d6c7ea77f10e39bbadc8b58d55b9ec">YH_ALGO_HMAC_SHA512</a>:</div>
<div class="line"><span class="lineno"> 4373</span>      *result = 512;</div>
<div class="line"><span class="lineno"> 4374</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4375</span> </div>
<div class="line"><span class="lineno"> 4376</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 4377</span>      *result = 0;</div>
<div class="line"><span class="lineno"> 4378</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 4379</span>  }</div>
<div class="line"><span class="lineno"> 4380</span> </div>
<div class="line"><span class="lineno"> 4381</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 4382</span>}</div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caa05aec903fd67851f968aaa606fe2138a"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa05aec903fd67851f968aaa606fe2138a">YH_ALGO_EC_P521</a></div><div class="ttdeci">@ YH_ALGO_EC_P521</div><div class="ttdoc">ecp521</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00418">yubihsm.h:418</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caa228fd3332b55c60438dfea6a1b09af36"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa228fd3332b55c60438dfea6a1b09af36">YH_ALGO_EC_BP384</a></div><div class="ttdeci">@ YH_ALGO_EC_BP384</div><div class="ttdoc">ecbp384</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00424">yubihsm.h:424</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caa31094c17c66e4c365ca3dad353bc8bda"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa31094c17c66e4c365ca3dad353bc8bda">YH_ALGO_EC_P384</a></div><div class="ttdeci">@ YH_ALGO_EC_P384</div><div class="ttdoc">ecp384</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00416">yubihsm.h:416</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caa72d6c7ea77f10e39bbadc8b58d55b9ec"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa72d6c7ea77f10e39bbadc8b58d55b9ec">YH_ALGO_HMAC_SHA512</a></div><div class="ttdeci">@ YH_ALGO_HMAC_SHA512</div><div class="ttdoc">hmac-sha512</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00434">yubihsm.h:434</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caa781e7ca62563917d2129bde8ec53401b"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa781e7ca62563917d2129bde8ec53401b">YH_ALGO_HMAC_SHA384</a></div><div class="ttdeci">@ YH_ALGO_HMAC_SHA384</div><div class="ttdoc">hmac-sha384</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00432">yubihsm.h:432</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caa942e65c8cd0034eebe9a20c2297c7b06"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa942e65c8cd0034eebe9a20c2297c7b06">YH_ALGO_HMAC_SHA1</a></div><div class="ttdeci">@ YH_ALGO_HMAC_SHA1</div><div class="ttdoc">hmac-sha1</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00428">yubihsm.h:428</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caaafe94e6a770edb51c6db84f77d98d2c6"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caaafe94e6a770edb51c6db84f77d98d2c6">YH_ALGO_RSA_2048</a></div><div class="ttdeci">@ YH_ALGO_RSA_2048</div><div class="ttdoc">rsa2048</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00408">yubihsm.h:408</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caab0a0e1eb424b61057f159f1e53311f5c"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caab0a0e1eb424b61057f159f1e53311f5c">YH_ALGO_HMAC_SHA256</a></div><div class="ttdeci">@ YH_ALGO_HMAC_SHA256</div><div class="ttdoc">hmac-sha256</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00430">yubihsm.h:430</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caab9c1be17b7b3f755346ff8c3cca3ed25"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caab9c1be17b7b3f755346ff8c3cca3ed25">YH_ALGO_EC_BP512</a></div><div class="ttdeci">@ YH_ALGO_EC_BP512</div><div class="ttdoc">ecbp512</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00426">yubihsm.h:426</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caabd995726d45b6dd2388775db4767c80d"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caabd995726d45b6dd2388775db4767c80d">YH_ALGO_EC_BP256</a></div><div class="ttdeci">@ YH_ALGO_EC_BP256</div><div class="ttdoc">ecbp256</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00422">yubihsm.h:422</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caad423056b13955068935dc8b3ac0e65d1"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caad423056b13955068935dc8b3ac0e65d1">YH_ALGO_EC_K256</a></div><div class="ttdeci">@ YH_ALGO_EC_K256</div><div class="ttdoc">eck256</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00420">yubihsm.h:420</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caae4b191baf5c65f9234120080264d129b"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caae4b191baf5c65f9234120080264d129b">YH_ALGO_EC_P256</a></div><div class="ttdeci">@ YH_ALGO_EC_P256</div><div class="ttdoc">ecp256</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00414">yubihsm.h:414</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caae5963322a0a0f43a1b74faa78e3a7329"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caae5963322a0a0f43a1b74faa78e3a7329">YH_ALGO_RSA_4096</a></div><div class="ttdeci">@ YH_ALGO_RSA_4096</div><div class="ttdoc">rsa4096</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00412">yubihsm.h:412</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caaedcbc07d82b18ca5c21eb3379a6cc010"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caaedcbc07d82b18ca5c21eb3379a6cc010">YH_ALGO_EC_P224</a></div><div class="ttdeci">@ YH_ALGO_EC_P224</div><div class="ttdoc">ecp224</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00484">yubihsm.h:484</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caafd3fbd9ed86caf267ccc77cb24d44426"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caafd3fbd9ed86caf267ccc77cb24d44426">YH_ALGO_RSA_3072</a></div><div class="ttdeci">@ YH_ALGO_RSA_3072</div><div class="ttdoc">rsa3072</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00410">yubihsm.h:410</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a375000f12ac554eb8cbaa0e6b75c3a08_icgraph.png" border="0" usemap="#ayubihsm_8c_a375000f12ac554eb8cbaa0e6b75c3a08_icgraph" alt=""/></div>
<map name="ayubihsm_8c_a375000f12ac554eb8cbaa0e6b75c3a08_icgraph" id="ayubihsm_8c_a375000f12ac554eb8cbaa0e6b75c3a08_icgraph">
<area shape="rect" title=" " alt="" coords="92,5,236,31"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#aac0e444e09db485cd53d305981f1e39f" title=" " alt="" coords="5,5,44,31"/>
<area shape="poly" title=" " alt="" coords="76,21,44,21,44,16,76,16"/>
</map>
</div>

</div>
</div>
<a id="aeabf472faf1ba8d963b39866e04df6b0" name="aeabf472faf1ba8d963b39866e04df6b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeabf472faf1ba8d963b39866e04df6b0">&#9670;&#160;</a></span>yh_get_session_id()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_get_session_id </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__session.html">yh_session</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>sid</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get the session ID</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>Authenticated session to use </td></tr>
    <tr><td class="paramname">sid</td><td>Session ID</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> if input parameters are NULL. </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l02915">2915</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2915</span>                                                           {</div>
<div class="line"><span class="lineno"> 2916</span> </div>
<div class="line"><span class="lineno"> 2917</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a> == NULL || sid == NULL) {</div>
<div class="line"><span class="lineno"> 2918</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>));</div>
<div class="line"><span class="lineno"> 2919</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 2920</span>  }</div>
<div class="line"><span class="lineno"> 2921</span> </div>
<div class="line"><span class="lineno"> 2922</span>  *sid = <a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>-&gt;s.sid;</div>
<div class="line"><span class="lineno"> 2923</span> </div>
<div class="line"><span class="lineno"> 2924</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 2925</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_aeabf472faf1ba8d963b39866e04df6b0_cgraph.png" border="0" usemap="#ayubihsm_8c_aeabf472faf1ba8d963b39866e04df6b0_cgraph" alt=""/></div>
<map name="ayubihsm_8c_aeabf472faf1ba8d963b39866e04df6b0_cgraph" id="ayubihsm_8c_aeabf472faf1ba8d963b39866e04df6b0_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,135,31"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="183,5,266,31"/>
<area shape="poly" title=" " alt="" coords="135,16,167,16,167,21,135,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_aeabf472faf1ba8d963b39866e04df6b0_icgraph.png" border="0" usemap="#ayubihsm_8c_aeabf472faf1ba8d963b39866e04df6b0_icgraph" alt=""/></div>
<map name="ayubihsm_8c_aeabf472faf1ba8d963b39866e04df6b0_icgraph" id="ayubihsm_8c_aeabf472faf1ba8d963b39866e04df6b0_icgraph">
<area shape="rect" title=" " alt="" coords="501,55,631,80"/>
<area shape="rect" href="attest_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="350,5,399,31"/>
<area shape="poly" title=" " alt="" coords="498,53,399,27,401,22,499,48"/>
<area shape="rect" href="commands_8c.html#aabb06b0c16a19b4b22478cb753d8f599" title=" " alt="" coords="296,55,453,80"/>
<area shape="poly" title=" " alt="" coords="486,70,454,70,454,65,486,65"/>
<area shape="rect" href="commands_8c.html#a22f22a25151b12c7573f80563a341368" title=" " alt="" coords="298,104,452,130"/>
<area shape="poly" title=" " alt="" coords="499,87,428,106,427,101,498,82"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,55,248,80"/>
<area shape="poly" title=" " alt="" coords="280,70,248,70,248,65,280,65"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,80,55,106"/>
<area shape="poly" title=" " alt="" coords="88,85,55,91,54,86,87,80"/>
<area shape="poly" title=" " alt="" coords="304,102,230,84,231,78,305,97"/>
<area shape="poly" title=" " alt="" coords="282,113,55,97,55,92,282,108"/>
</map>
</div>

</div>
</div>
<a id="a17d49ccb12b100e98d8b99585a705444" name="a17d49ccb12b100e98d8b99585a705444"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a17d49ccb12b100e98d8b99585a705444">&#9670;&#160;</a></span>yh_get_verbosity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_get_verbosity </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>verbosity</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get verbosity level when executing commands</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">verbosity</td><td>The verbosity level</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if seccessful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> if verbosity is NULL</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="yubihsm_8h.html#aa11030bbf6092d8934236958e9478084" title="Debug level quiet. No messages printed out.">YH_VERB_QUIET</a>, <a class="el" href="yubihsm_8h.html#af507fefd9d19bfd531277a6c6cb56452" title="Debug level intermediate. Intermediate results printed out.">YH_VERB_INTERMEDIATE</a>, <a class="el" href="yubihsm_8h.html#a8881b983de3922f9abb5d1fcc99216e2" title="Debug level crypto. Crypto results printed out.">YH_VERB_CRYPTO</a>, <a class="el" href="yubihsm_8h.html#a4ead07ea7b1232808085d4bdbc7eb5b9" title="Debug level raw. Raw messages printed out.">YH_VERB_RAW</a>, <a class="el" href="yubihsm_8h.html#a2ac0b183de01f2dc9f64372e6c66bba4" title="Debug level info. General information messages printed out.">YH_VERB_INFO</a>, <a class="el" href="yubihsm_8h.html#a978bb82a3974b6778aadb56fa450e8ca" title="Debug level error. Error messages printed out.">YH_VERB_ERR</a>, <a class="el" href="yubihsm_8h.html#a15dbe0ac973691939ca6e9148b181ccd" title="Debug level all. All previous options enabled.">YH_VERB_ALL</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l03837">3837</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3837</span>                                           {</div>
<div class="line"><span class="lineno"> 3838</span> </div>
<div class="line"><span class="lineno"> 3839</span>  <span class="keywordflow">if</span> (verbosity == NULL) {</div>
<div class="line"><span class="lineno"> 3840</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 3841</span>  }</div>
<div class="line"><span class="lineno"> 3842</span> </div>
<div class="line"><span class="lineno"> 3843</span>  *verbosity = <a class="code hl_variable" href="debug__lib_8h.html#a4ba5f59460a312e3f5f14926f4b2299e">_yh_verbosity</a>;</div>
<div class="line"><span class="lineno"> 3844</span> </div>
<div class="line"><span class="lineno"> 3845</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 3846</span>}</div>
<div class="ttc" id="adebug__lib_8h_html_a4ba5f59460a312e3f5f14926f4b2299e"><div class="ttname"><a href="debug__lib_8h.html#a4ba5f59460a312e3f5f14926f4b2299e">_yh_verbosity</a></div><div class="ttdeci">uint8_t _yh_verbosity</div><div class="ttdef"><b>Definition</b> <a href="test__usb__url_8c_source.html#l00027">test_usb_url.c:27</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a17d49ccb12b100e98d8b99585a705444_icgraph.png" border="0" usemap="#ayubihsm_8c_a17d49ccb12b100e98d8b99585a705444_icgraph" alt=""/></div>
<map name="ayubihsm_8c_a17d49ccb12b100e98d8b99585a705444_icgraph" id="ayubihsm_8c_a17d49ccb12b100e98d8b99585a705444_icgraph">
<area shape="rect" title=" " alt="" coords="531,104,652,130"/>
<area shape="rect" href="commands_8c.html#af5cc531118346eb9389b42149112acdc" title=" " alt="" coords="314,5,466,31"/>
<area shape="poly" title=" " alt="" coords="562,96,525,69,482,45,454,34,456,29,484,40,528,65,565,92"/>
<area shape="rect" href="commands_8c.html#af045c2e8a570dc8fed3d339e75d26feb" title=" " alt="" coords="318,55,461,80"/>
<area shape="poly" title=" " alt="" coords="520,102,445,84,446,78,522,97"/>
<area shape="rect" href="commands_8c.html#a774b8dbc4c8d855527e518270206bb52" title=" " alt="" coords="321,104,458,130"/>
<area shape="poly" title=" " alt="" coords="516,120,459,120,459,114,516,114"/>
<area shape="rect" href="commands_8c.html#ad621ced8cc22f103e049f17717d0b3d8" title=" " alt="" coords="296,153,483,179"/>
<area shape="poly" title=" " alt="" coords="522,137,446,155,445,150,520,131"/>
<area shape="rect" href="commands_8c.html#ac67abff009407dcfe773a32d8273969a" title=" " alt="" coords="321,203,458,228"/>
<area shape="poly" title=" " alt="" coords="565,142,528,169,484,194,456,205,454,200,482,189,525,164,562,137"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,104,248,130"/>
<area shape="poly" title=" " alt="" coords="313,39,297,45,240,75,196,106,193,101,238,71,295,40,311,34"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,104,55,130"/>
<area shape="poly" title=" " alt="" coords="87,120,55,120,55,114,87,114"/>
<area shape="poly" title=" " alt="" coords="316,87,235,106,234,101,315,82"/>
<area shape="poly" title=" " alt="" coords="306,120,248,120,248,114,306,114"/>
<area shape="poly" title=" " alt="" coords="315,152,234,133,235,128,316,147"/>
<area shape="poly" title=" " alt="" coords="311,200,295,194,238,163,193,133,196,128,240,159,297,189,313,195"/>
</map>
</div>

</div>
</div>
<a id="a5392844a98c6220c69fe08d3dcf8f1bc" name="a5392844a98c6220c69fe08d3dcf8f1bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5392844a98c6220c69fe08d3dcf8f1bc">&#9670;&#160;</a></span>yh_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_init </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Global library initialization</p>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l03857">3857</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3857</span>                    {</div>
<div class="line"><span class="lineno"> 3858</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="debug__lib_8h.html#a76ba6bc136c2b38b71a9e3c56282cd3a">_yh_output</a> == NULL) {</div>
<div class="line"><span class="lineno"> 3859</span>    <a class="code hl_variable" href="debug__lib_8h.html#a76ba6bc136c2b38b71a9e3c56282cd3a">_yh_output</a> = stderr;</div>
<div class="line"><span class="lineno"> 3860</span>  }</div>
<div class="line"><span class="lineno"> 3861</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 3862</span>}</div>
<div class="ttc" id="adebug__lib_8h_html_a76ba6bc136c2b38b71a9e3c56282cd3a"><div class="ttname"><a href="debug__lib_8h.html#a76ba6bc136c2b38b71a9e3c56282cd3a">_yh_output</a></div><div class="ttdeci">FILE * _yh_output</div><div class="ttdef"><b>Definition</b> <a href="test__usb__url_8c_source.html#l00028">test_usb_url.c:28</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a5392844a98c6220c69fe08d3dcf8f1bc_icgraph.png" border="0" usemap="#ayubihsm_8c_a5392844a98c6220c69fe08d3dcf8f1bc_icgraph" alt=""/></div>
<map name="ayubihsm_8c_a5392844a98c6220c69fe08d3dcf8f1bc_icgraph" id="ayubihsm_8c_a5392844a98c6220c69fe08d3dcf8f1bc_icgraph">
<area shape="rect" title=" " alt="" coords="228,104,287,130"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#a553b528011491713b85dc590221ea616" title=" " alt="" coords="5,5,180,31"/>
<area shape="poly" title=" " alt="" coords="235,94,209,68,178,44,155,34,157,29,181,40,213,64,239,90"/>
<area shape="rect" href="yubihsm__shell__tests_8c.html#ae66f6b31b5ad750f1fe042a706a4e3d4" title=" " alt="" coords="68,55,117,80"/>
<area shape="poly" title=" " alt="" coords="212,105,179,94,117,76,118,71,180,89,213,99"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="68,104,117,130"/>
<area shape="poly" title=" " alt="" coords="212,120,118,120,118,114,212,114"/>
<area shape="rect" href="attest_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="68,153,117,179"/>
<area shape="poly" title=" " alt="" coords="213,134,180,145,118,162,117,157,179,140,212,129"/>
<area shape="rect" href="structsysio_1_1wallet_1_1detail_1_1yubihsm__wallet__impl.html#aab88a7a970733811d37fed3fb5041350" title=" " alt="" coords="17,204,168,259"/>
<area shape="poly" title=" " alt="" coords="237,143,212,169,181,194,162,205,159,201,178,189,208,165,234,139"/>
</map>
</div>

</div>
</div>
<a id="a9c700747902a722d6c1d2073277de294" name="a9c700747902a722d6c1d2073277de294"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c700747902a722d6c1d2073277de294">&#9670;&#160;</a></span>yh_init_connector()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_init_connector </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>url</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structyh__connector.html">yh_connector</a> **</td>          <td class="paramname"><span class="paramname"><em>connector</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Instantiate a new connector</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">url</td><td>URL associated with this connector </td></tr>
    <tr><td class="paramname">connector</td><td>Connector to the device</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> if either the URL or the connector are NULL. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a39fbc5bce29b178582419ae9d31ad252" title="Return value when encountering an unknown error.">YHR_GENERIC_ERROR</a> if failed to load the backend. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a75ea079345046cdbf5612bf9065d8711" title="Returned value when unable to allocate memory.">YHR_MEMORY_ERROR</a> if failed to allocate memory for the connector. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366ae4f6537a9d33914ea06c53b015d92ca8" title="Returned value when a connection error was encountered.">YHR_CONNECTION_ERROR</a> if failed to create the connector </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l04024">4024</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4024</span>                                                                   {</div>
<div class="line"><span class="lineno"> 4025</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="programs_2clio_2main_8cpp.html#aa03c1ef4c41f36b048cf58d5aade7653">url</a> == NULL || connector == NULL) {</div>
<div class="line"><span class="lineno"> 4026</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Invalid parameters: undefined pointer&quot;</span>);</div>
<div class="line"><span class="lineno"> 4027</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 4028</span>  }</div>
<div class="line"><span class="lineno"> 4029</span> </div>
<div class="line"><span class="lineno"> 4030</span><span class="preprocessor">#ifdef STATIC</span></div>
<div class="line"><span class="lineno"> 4031</span><span class="preprocessor">#define USB_LIB STATIC_USB_BACKEND</span></div>
<div class="line"><span class="lineno"> 4032</span><span class="preprocessor">#define HTTP_LIB STATIC_HTTP_BACKEND</span></div>
<div class="line"><span class="lineno"> 4033</span><span class="preprocessor">#elif defined WIN32</span></div>
<div class="line"><span class="lineno"> 4034</span><span class="preprocessor">#define USB_LIB &quot;libyubihsm_usb.dll&quot;</span></div>
<div class="line"><span class="lineno"> 4035</span><span class="preprocessor">#define HTTP_LIB &quot;libyubihsm_http.dll&quot;</span></div>
<div class="line"><span class="lineno"> 4036</span><span class="preprocessor">#elif defined __APPLE__</span></div>
<div class="line"><span class="lineno"> 4037</span><span class="preprocessor">#define USB_LIB &quot;libyubihsm_usb.&quot; SOVERSION &quot;.dylib&quot;</span></div>
<div class="line"><span class="lineno"> 4038</span><span class="preprocessor">#define HTTP_LIB &quot;libyubihsm_http.&quot; SOVERSION &quot;.dylib&quot;</span></div>
<div class="line"><span class="lineno"> 4039</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno"> 4040</span><span class="preprocessor">#define USB_LIB &quot;libyubihsm_usb.so.&quot; SOVERSION</span></div>
<div class="line"><span class="lineno"> 4041</span><span class="preprocessor">#define HTTP_LIB &quot;libyubihsm_http.so.&quot; SOVERSION</span></div>
<div class="line"><span class="lineno"> 4042</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 4043</span> </div>
<div class="line"><span class="lineno"> 4044</span>  <span class="keywordtype">void</span> *backend = NULL;</div>
<div class="line"><span class="lineno"> 4045</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structbackend__functions.html">backend_functions</a> *bf = NULL;</div>
<div class="line"><span class="lineno"> 4046</span> </div>
<div class="line"><span class="lineno"> 4047</span>  <span class="keywordflow">if</span> (strncmp(<a class="code hl_variable" href="programs_2clio_2main_8cpp.html#aa03c1ef4c41f36b048cf58d5aade7653">url</a>, <a class="code hl_define" href="yubihsm_8h.html#a4c5f4e9bfa0e29ea9b0d951c9c928c90">YH_USB_URL_SCHEME</a>, strlen(<a class="code hl_define" href="yubihsm_8h.html#a4c5f4e9bfa0e29ea9b0d951c9c928c90">YH_USB_URL_SCHEME</a>)) == 0) {</div>
<div class="line"><span class="lineno"> 4048</span>    <a class="code hl_define" href="debug__lib_8h.html#a8c4742440a149ad8bcb5d58ae76c5ed3">DBG_INFO</a>(<span class="stringliteral">&quot;Loading usb backend&quot;</span>);</div>
<div class="line"><span class="lineno"> 4049</span>    load_backend(<a class="code hl_define" href="#a02343c4c03f60828514b2a220ea3e9c1">USB_LIB</a>, &amp;backend, &amp;bf);</div>
<div class="line"><span class="lineno"> 4050</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strncmp(<a class="code hl_variable" href="programs_2clio_2main_8cpp.html#aa03c1ef4c41f36b048cf58d5aade7653">url</a>, <span class="stringliteral">&quot;http://&quot;</span>, strlen(<span class="stringliteral">&quot;http://&quot;</span>)) == 0 ||</div>
<div class="line"><span class="lineno"> 4051</span>             strncmp(<a class="code hl_variable" href="programs_2clio_2main_8cpp.html#aa03c1ef4c41f36b048cf58d5aade7653">url</a>, <span class="stringliteral">&quot;https://&quot;</span>, strlen(<span class="stringliteral">&quot;https://&quot;</span>)) == 0) {</div>
<div class="line"><span class="lineno"> 4052</span>    <a class="code hl_define" href="debug__lib_8h.html#a8c4742440a149ad8bcb5d58ae76c5ed3">DBG_INFO</a>(<span class="stringliteral">&quot;Loading http backend&quot;</span>);</div>
<div class="line"><span class="lineno"> 4053</span>    load_backend(<a class="code hl_define" href="#ac8bfb55db13a8e48927730381cc57822">HTTP_LIB</a>, &amp;backend, &amp;bf);</div>
<div class="line"><span class="lineno"> 4054</span>  }</div>
<div class="line"><span class="lineno"> 4055</span>  <span class="keywordflow">if</span> (bf == NULL) {</div>
<div class="line"><span class="lineno"> 4056</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Failed loading the backend&quot;</span>);</div>
<div class="line"><span class="lineno"> 4057</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a39fbc5bce29b178582419ae9d31ad252">YHR_GENERIC_ERROR</a>;</div>
<div class="line"><span class="lineno"> 4058</span>  }</div>
<div class="line"><span class="lineno"> 4059</span> </div>
<div class="line"><span class="lineno"> 4060</span>  <span class="keywordflow">return</span> create_connector(connector, <a class="code hl_variable" href="programs_2clio_2main_8cpp.html#aa03c1ef4c41f36b048cf58d5aade7653">url</a>, backend, bf);</div>
<div class="line"><span class="lineno"> 4061</span>}</div>
<div class="ttc" id="aprograms_2clio_2main_8cpp_html_aa03c1ef4c41f36b048cf58d5aade7653"><div class="ttname"><a href="programs_2clio_2main_8cpp.html#aa03c1ef4c41f36b048cf58d5aade7653">url</a></div><div class="ttdeci">string url</div><div class="ttdef"><b>Definition</b> <a href="programs_2clio_2main_8cpp_source.html#l00166">main.cpp:166</a></div></div>
<div class="ttc" id="astructbackend__functions_html"><div class="ttname"><a href="structbackend__functions.html">backend_functions</a></div><div class="ttdef"><b>Definition</b> <a href="lib_2internal_8h_source.html#l00065">internal.h:65</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_a02343c4c03f60828514b2a220ea3e9c1"><div class="ttname"><a href="#a02343c4c03f60828514b2a220ea3e9c1">USB_LIB</a></div><div class="ttdeci">#define USB_LIB</div></div>
<div class="ttc" id="ayubihsm_8c_html_ac8bfb55db13a8e48927730381cc57822"><div class="ttname"><a href="#ac8bfb55db13a8e48927730381cc57822">HTTP_LIB</a></div><div class="ttdeci">#define HTTP_LIB</div></div>
<div class="ttc" id="ayubihsm_8h_html_a4c5f4e9bfa0e29ea9b0d951c9c928c90"><div class="ttname"><a href="yubihsm_8h.html#a4c5f4e9bfa0e29ea9b0d951c9c928c90">YH_USB_URL_SCHEME</a></div><div class="ttdeci">#define YH_USB_URL_SCHEME</div><div class="ttdoc">URL scheme used for direct USB access.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00129">yubihsm.h:129</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a9c700747902a722d6c1d2073277de294_icgraph.png" border="0" usemap="#ayubihsm_8c_a9c700747902a722d6c1d2073277de294_icgraph" alt=""/></div>
<map name="ayubihsm_8c_a9c700747902a722d6c1d2073277de294_icgraph" id="ayubihsm_8c_a9c700747902a722d6c1d2073277de294_icgraph">
<area shape="rect" title=" " alt="" coords="518,88,642,114"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#a553b528011491713b85dc590221ea616" title=" " alt="" coords="296,5,470,31"/>
<area shape="poly" title=" " alt="" coords="544,82,469,45,439,34,440,29,471,40,546,78"/>
<area shape="rect" href="attest_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="358,55,408,80"/>
<area shape="poly" title=" " alt="" coords="503,90,408,74,409,69,503,85"/>
<area shape="rect" href="structsysio_1_1wallet_1_1detail_1_1yubihsm__wallet__impl.html#a00ee0ac7ac4a819d0b8755bf4f442263" title=" " alt="" coords="308,105,458,161"/>
<area shape="poly" title=" " alt="" coords="503,116,459,123,458,118,503,111"/>
<area shape="rect" href="commands_8c.html#a9155cc4306ad97e58a03ead18637f33b" title=" " alt="" coords="323,185,443,211"/>
<area shape="poly" title=" " alt="" coords="552,125,515,151,471,175,440,187,438,182,469,170,512,147,549,121"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,160,248,186"/>
<area shape="poly" title=" " alt="" coords="307,192,248,184,249,179,308,186"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,185,55,211"/>
<area shape="poly" title=" " alt="" coords="307,201,55,201,55,196,307,196"/>
<area shape="poly" title=" " alt="" coords="88,191,55,197,54,191,87,186"/>
</map>
</div>

</div>
</div>
<a id="a3032a8f45bfad36ed6157b0158dd7921" name="a3032a8f45bfad36ed6157b0158dd7921"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3032a8f45bfad36ed6157b0158dd7921">&#9670;&#160;</a></span>yh_is_ec()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool yh_is_ec </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55ca">yh_algorithm</a></td>          <td class="paramname"><span class="paramname"><em>algorithm</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Check if an algorithm is a supported Elliptic Curve algorithm.</p>
<p>Supported EC algorithms: <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caaedcbc07d82b18ca5c21eb3379a6cc010" title="ecp224">YH_ALGO_EC_P224</a>, <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caae4b191baf5c65f9234120080264d129b" title="ecp256">YH_ALGO_EC_P256</a>, <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa31094c17c66e4c365ca3dad353bc8bda" title="ecp384">YH_ALGO_EC_P384</a>, <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa05aec903fd67851f968aaa606fe2138a" title="ecp521">YH_ALGO_EC_P521</a>, <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caad423056b13955068935dc8b3ac0e65d1" title="eck256">YH_ALGO_EC_K256</a>, <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caabd995726d45b6dd2388775db4767c80d" title="ecbp256">YH_ALGO_EC_BP256</a>, <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa228fd3332b55c60438dfea6a1b09af36" title="ecbp384">YH_ALGO_EC_BP384</a> and <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caab9c1be17b7b3f755346ff8c3cca3ed25" title="ecbp512">YH_ALGO_EC_BP512</a></p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">algorithm</td><td>Algorithm to check. See <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55ca">yh_algorithm</a></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True if the algorithm is one of the supported EC algorithms. False otherwise </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l04260">4260</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4260</span>                                      {</div>
<div class="line"><span class="lineno"> 4261</span> </div>
<div class="line"><span class="lineno"> 4262</span>  <span class="keywordflow">switch</span> (<a class="code hl_variable" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>) {</div>
<div class="line"><span class="lineno"> 4263</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caaedcbc07d82b18ca5c21eb3379a6cc010">YH_ALGO_EC_P224</a>:</div>
<div class="line"><span class="lineno"> 4264</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caae4b191baf5c65f9234120080264d129b">YH_ALGO_EC_P256</a>:</div>
<div class="line"><span class="lineno"> 4265</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa31094c17c66e4c365ca3dad353bc8bda">YH_ALGO_EC_P384</a>:</div>
<div class="line"><span class="lineno"> 4266</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa05aec903fd67851f968aaa606fe2138a">YH_ALGO_EC_P521</a>:</div>
<div class="line"><span class="lineno"> 4267</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caad423056b13955068935dc8b3ac0e65d1">YH_ALGO_EC_K256</a>:</div>
<div class="line"><span class="lineno"> 4268</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caabd995726d45b6dd2388775db4767c80d">YH_ALGO_EC_BP256</a>:</div>
<div class="line"><span class="lineno"> 4269</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa228fd3332b55c60438dfea6a1b09af36">YH_ALGO_EC_BP384</a>:</div>
<div class="line"><span class="lineno"> 4270</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caab9c1be17b7b3f755346ff8c3cca3ed25">YH_ALGO_EC_BP512</a>:</div>
<div class="line"><span class="lineno"> 4271</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 4272</span> </div>
<div class="line"><span class="lineno"> 4273</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 4274</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4275</span>  }</div>
<div class="line"><span class="lineno"> 4276</span> </div>
<div class="line"><span class="lineno"> 4277</span>  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 4278</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a3032a8f45bfad36ed6157b0158dd7921_icgraph.png" border="0" usemap="#ayubihsm_8c_a3032a8f45bfad36ed6157b0158dd7921_icgraph" alt=""/></div>
<map name="ayubihsm_8c_a3032a8f45bfad36ed6157b0158dd7921_icgraph" id="ayubihsm_8c_a3032a8f45bfad36ed6157b0158dd7921_icgraph">
<area shape="rect" title=" " alt="" coords="757,80,830,106"/>
<area shape="rect" href="commands_8c.html#ae2e50929acc6085cd395d0bd4ddb02db" title=" " alt="" coords="326,55,465,80"/>
<area shape="poly" title=" " alt="" coords="741,92,465,75,466,69,742,87"/>
<area shape="rect" href="commands_8c.html#aa1c71ebc2b3f298b6522ab090393c73e" title=" " alt="" coords="296,5,495,31"/>
<area shape="poly" title=" " alt="" coords="744,77,708,66,599,44,495,30,496,25,600,39,709,61,745,72"/>
<area shape="rect" href="commands_8c.html#aa1c9a933f4601dae48cd64f911d297aa" title=" " alt="" coords="325,235,466,260"/>
<area shape="poly" title=" " alt="" coords="761,117,710,146,605,191,496,225,454,237,453,231,495,220,603,186,707,141,759,112"/>
<area shape="rect" href="yubihsm_8c.html#a2db9bbd57a908c5c454fc6254f57dcff" title=" " alt="" coords="543,105,709,131"/>
<area shape="poly" title=" " alt="" coords="742,103,710,108,709,103,741,98"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,56,248,82"/>
<area shape="poly" title=" " alt="" coords="311,71,248,71,248,66,311,65"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,56,55,82"/>
<area shape="poly" title=" " alt="" coords="87,72,55,72,55,66,87,66"/>
<area shape="poly" title=" " alt="" coords="322,38,235,58,234,53,321,32"/>
<area shape="poly" title=" " alt="" coords="281,24,193,32,103,46,56,61,55,56,102,41,193,26,280,19"/>
<area shape="poly" title=" " alt="" coords="309,233,294,224,247,165,184,84,189,80,251,162,298,220,312,228"/>
<area shape="poly" title=" " alt="" coords="316,232,295,225,221,190,151,151,49,85,52,80,154,146,224,185,297,220,318,227"/>
<area shape="poly" title=" " alt="" coords="549,104,457,84,458,78,550,99"/>
<area shape="poly" title=" " alt="" coords="592,99,547,71,494,45,463,34,464,29,496,40,549,66,595,94"/>
<area shape="rect" href="structsysio_1_1wallet_1_1detail_1_1yubihsm__wallet__impl.html#a6266bcd9001ddbb02101bea6088f299b" title=" " alt="" coords="320,154,471,210"/>
<area shape="poly" title=" " alt="" coords="563,138,472,164,470,159,562,133"/>
<area shape="rect" href="attest_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="371,104,420,130"/>
<area shape="poly" title=" " alt="" coords="528,120,421,120,421,114,528,115"/>
</map>
</div>

</div>
</div>
<a id="a16fbf4426acbf42695c4ec4738b6ae8a" name="a16fbf4426acbf42695c4ec4738b6ae8a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16fbf4426acbf42695c4ec4738b6ae8a">&#9670;&#160;</a></span>yh_is_ed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool yh_is_ed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55ca">yh_algorithm</a></td>          <td class="paramname"><span class="paramname"><em>algorithm</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Check if an algorithm is a supported ED algorithm.</p>
<p>Supported ED algorithms: <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa68c2c97f16c36f727e41a899d8a7e8bd" title="ed25519">YH_ALGO_EC_ED25519</a></p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">algorithm</td><td>algorithm. See <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55ca">yh_algorithm</a></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True if the algorithm is <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa68c2c97f16c36f727e41a899d8a7e8bd" title="ed25519">YH_ALGO_EC_ED25519</a>. False otherwise </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l04280">4280</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4280</span>                                      {</div>
<div class="line"><span class="lineno"> 4281</span> </div>
<div class="line"><span class="lineno"> 4282</span>  <span class="keywordflow">switch</span> (<a class="code hl_variable" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>) {</div>
<div class="line"><span class="lineno"> 4283</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa68c2c97f16c36f727e41a899d8a7e8bd">YH_ALGO_EC_ED25519</a>:</div>
<div class="line"><span class="lineno"> 4284</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 4285</span> </div>
<div class="line"><span class="lineno"> 4286</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 4287</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4288</span>  }</div>
<div class="line"><span class="lineno"> 4289</span> </div>
<div class="line"><span class="lineno"> 4290</span>  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 4291</span>}</div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caa68c2c97f16c36f727e41a899d8a7e8bd"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa68c2c97f16c36f727e41a899d8a7e8bd">YH_ALGO_EC_ED25519</a></div><div class="ttdeci">@ YH_ALGO_EC_ED25519</div><div class="ttdoc">ed25519</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00482">yubihsm.h:482</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a16fbf4426acbf42695c4ec4738b6ae8a_icgraph.png" border="0" usemap="#ayubihsm_8c_a16fbf4426acbf42695c4ec4738b6ae8a_icgraph" alt=""/></div>
<map name="ayubihsm_8c_a16fbf4426acbf42695c4ec4738b6ae8a_icgraph" id="ayubihsm_8c_a16fbf4426acbf42695c4ec4738b6ae8a_icgraph">
<area shape="rect" title=" " alt="" coords="757,29,830,55"/>
<area shape="rect" href="commands_8c.html#aa1c71ebc2b3f298b6522ab090393c73e" title=" " alt="" coords="296,5,495,31"/>
<area shape="poly" title=" " alt="" coords="741,42,495,27,496,21,741,36"/>
<area shape="rect" href="yubihsm_8c.html#a41f4326fe736e99302442d6a6109edbc" title=" " alt="" coords="543,55,709,80"/>
<area shape="poly" title=" " alt="" coords="742,53,710,58,709,52,741,47"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,55,248,80"/>
<area shape="poly" title=" " alt="" coords="321,38,237,57,235,51,319,32"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,29,55,55"/>
<area shape="poly" title=" " alt="" coords="281,28,55,43,55,38,280,23"/>
<area shape="poly" title=" " alt="" coords="87,55,54,49,55,44,88,50"/>
<area shape="poly" title=" " alt="" coords="547,53,459,34,460,29,548,48"/>
<area shape="rect" href="commands_8c.html#ae2e50929acc6085cd395d0bd4ddb02db" title=" " alt="" coords="326,55,465,80"/>
<area shape="poly" title=" " alt="" coords="528,70,465,70,465,65,528,65"/>
<area shape="poly" title=" " alt="" coords="311,70,248,70,248,65,311,65"/>
</map>
</div>

</div>
</div>
<a id="acb19de78e7d1aed72abbed5c74c676bc" name="acb19de78e7d1aed72abbed5c74c676bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb19de78e7d1aed72abbed5c74c676bc">&#9670;&#160;</a></span>yh_is_hmac()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool yh_is_hmac </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55ca">yh_algorithm</a></td>          <td class="paramname"><span class="paramname"><em>algorithm</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Check if algorithm is a supported HMAC algorithm.</p>
<p>Supported HMAC algorithms: <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa942e65c8cd0034eebe9a20c2297c7b06" title="hmac-sha1">YH_ALGO_HMAC_SHA1</a>, <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caab0a0e1eb424b61057f159f1e53311f5c" title="hmac-sha256">YH_ALGO_HMAC_SHA256</a>, <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa781e7ca62563917d2129bde8ec53401b" title="hmac-sha384">YH_ALGO_HMAC_SHA384</a> and <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa72d6c7ea77f10e39bbadc8b58d55b9ec" title="hmac-sha512">YH_ALGO_HMAC_SHA512</a></p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">algorithm</td><td>Algorithm to check. See <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55ca">yh_algorithm</a></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True if the algorithm is one of the supported HMAC algorithms. False otherwise </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l04293">4293</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4293</span>                                        {</div>
<div class="line"><span class="lineno"> 4294</span> </div>
<div class="line"><span class="lineno"> 4295</span>  <span class="keywordflow">switch</span> (<a class="code hl_variable" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>) {</div>
<div class="line"><span class="lineno"> 4296</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa942e65c8cd0034eebe9a20c2297c7b06">YH_ALGO_HMAC_SHA1</a>:</div>
<div class="line"><span class="lineno"> 4297</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caab0a0e1eb424b61057f159f1e53311f5c">YH_ALGO_HMAC_SHA256</a>:</div>
<div class="line"><span class="lineno"> 4298</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa781e7ca62563917d2129bde8ec53401b">YH_ALGO_HMAC_SHA384</a>:</div>
<div class="line"><span class="lineno"> 4299</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa72d6c7ea77f10e39bbadc8b58d55b9ec">YH_ALGO_HMAC_SHA512</a>:</div>
<div class="line"><span class="lineno"> 4300</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 4301</span> </div>
<div class="line"><span class="lineno"> 4302</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 4303</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4304</span>  }</div>
<div class="line"><span class="lineno"> 4305</span> </div>
<div class="line"><span class="lineno"> 4306</span>  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 4307</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_acb19de78e7d1aed72abbed5c74c676bc_icgraph.png" border="0" usemap="#ayubihsm_8c_acb19de78e7d1aed72abbed5c74c676bc_icgraph" alt=""/></div>
<map name="ayubihsm_8c_acb19de78e7d1aed72abbed5c74c676bc_icgraph" id="ayubihsm_8c_acb19de78e7d1aed72abbed5c74c676bc_icgraph">
<area shape="rect" title=" " alt="" coords="507,31,599,56"/>
<area shape="rect" href="commands_8c.html#ae2e50929acc6085cd395d0bd4ddb02db" title=" " alt="" coords="308,5,447,31"/>
<area shape="poly" title=" " alt="" coords="491,37,447,31,448,26,492,32"/>
<area shape="rect" href="commands_8c.html#a2be1be0e0a454965f5a378e4ecb483f0" title=" " alt="" coords="296,55,459,80"/>
<area shape="poly" title=" " alt="" coords="492,54,460,59,459,54,491,49"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="293,21,249,21,249,16,293,16"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,31,55,56"/>
<area shape="poly" title=" " alt="" coords="88,36,55,42,54,37,87,31"/>
<area shape="poly" title=" " alt="" coords="306,53,231,34,232,29,308,48"/>
<area shape="poly" title=" " alt="" coords="280,63,55,48,55,42,281,58"/>
</map>
</div>

</div>
</div>
<a id="a0a67155f2a7970ecb52e4f6aac6bbe84" name="a0a67155f2a7970ecb52e4f6aac6bbe84"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a67155f2a7970ecb52e4f6aac6bbe84">&#9670;&#160;</a></span>yh_is_rsa()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool yh_is_rsa </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55ca">yh_algorithm</a></td>          <td class="paramname"><span class="paramname"><em>algorithm</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Check if an algorithm is a supported RSA algorithm.</p>
<p>Supported RSA algorithms: <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caaafe94e6a770edb51c6db84f77d98d2c6" title="rsa2048">YH_ALGO_RSA_2048</a>, <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caafd3fbd9ed86caf267ccc77cb24d44426" title="rsa3072">YH_ALGO_RSA_3072</a> and <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caae5963322a0a0f43a1b74faa78e3a7329" title="rsa4096">YH_ALGO_RSA_4096</a></p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">algorithm</td><td>Algorithm to check. See <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55ca">yh_algorithm</a></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True if the algorithm is one of the supported RSA algorithms . False otherwise </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l04245">4245</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4245</span>                                       {</div>
<div class="line"><span class="lineno"> 4246</span> </div>
<div class="line"><span class="lineno"> 4247</span>  <span class="keywordflow">switch</span> (<a class="code hl_variable" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>) {</div>
<div class="line"><span class="lineno"> 4248</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caaafe94e6a770edb51c6db84f77d98d2c6">YH_ALGO_RSA_2048</a>:</div>
<div class="line"><span class="lineno"> 4249</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caafd3fbd9ed86caf267ccc77cb24d44426">YH_ALGO_RSA_3072</a>:</div>
<div class="line"><span class="lineno"> 4250</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caae5963322a0a0f43a1b74faa78e3a7329">YH_ALGO_RSA_4096</a>:</div>
<div class="line"><span class="lineno"> 4251</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 4252</span> </div>
<div class="line"><span class="lineno"> 4253</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 4254</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4255</span>  }</div>
<div class="line"><span class="lineno"> 4256</span> </div>
<div class="line"><span class="lineno"> 4257</span>  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 4258</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a0a67155f2a7970ecb52e4f6aac6bbe84_icgraph.png" border="0" usemap="#ayubihsm_8c_a0a67155f2a7970ecb52e4f6aac6bbe84_icgraph" alt=""/></div>
<map name="ayubihsm_8c_a0a67155f2a7970ecb52e4f6aac6bbe84_icgraph" id="ayubihsm_8c_a0a67155f2a7970ecb52e4f6aac6bbe84_icgraph">
<area shape="rect" title=" " alt="" coords="761,80,838,106"/>
<area shape="rect" href="commands_8c.html#ae2e50929acc6085cd395d0bd4ddb02db" title=" " alt="" coords="326,55,465,80"/>
<area shape="poly" title=" " alt="" coords="745,92,465,74,465,69,745,87"/>
<area shape="rect" href="commands_8c.html#aa1c71ebc2b3f298b6522ab090393c73e" title=" " alt="" coords="296,5,495,31"/>
<area shape="poly" title=" " alt="" coords="748,77,712,66,600,44,495,30,496,25,601,39,713,61,750,72"/>
<area shape="rect" href="commands_8c.html#aa1c9a933f4601dae48cd64f911d297aa" title=" " alt="" coords="325,203,466,228"/>
<area shape="poly" title=" " alt="" coords="768,117,714,146,650,168,584,186,467,209,466,203,583,180,648,163,712,141,765,112"/>
<area shape="rect" href="yubihsm_8c.html#ab1c62ef2643184a8ad44c569c87712d1" title=" " alt="" coords="543,105,713,131"/>
<area shape="poly" title=" " alt="" coords="746,103,714,108,713,103,745,98"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,56,248,82"/>
<area shape="poly" title=" " alt="" coords="311,71,248,71,248,66,311,65"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,56,55,82"/>
<area shape="poly" title=" " alt="" coords="87,72,55,72,55,66,87,66"/>
<area shape="poly" title=" " alt="" coords="322,38,235,58,234,53,321,32"/>
<area shape="poly" title=" " alt="" coords="281,24,193,32,103,46,56,61,55,56,102,41,193,26,280,19"/>
<area shape="poly" title=" " alt="" coords="309,201,295,194,270,174,240,144,186,84,190,80,243,140,274,170,297,189,312,196"/>
<area shape="poly" title=" " alt="" coords="316,201,295,194,225,167,157,136,54,84,56,79,159,131,227,162,297,189,318,196"/>
<area shape="poly" title=" " alt="" coords="550,104,457,84,458,78,551,99"/>
<area shape="poly" title=" " alt="" coords="593,99,548,71,494,45,463,34,464,29,496,40,550,66,596,94"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#a0d58173720fcc1219a584ff8041fdb4c" title=" " alt="" coords="376,153,415,179"/>
<area shape="poly" title=" " alt="" coords="548,137,416,165,415,160,547,132"/>
<area shape="rect" href="generate__rsa_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="371,104,420,130"/>
<area shape="poly" title=" " alt="" coords="528,120,421,120,421,114,528,115"/>
</map>
</div>

</div>
</div>
<a id="afcca1608845e7a783d41d8ffd6aac8ed" name="afcca1608845e7a783d41d8ffd6aac8ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afcca1608845e7a783d41d8ffd6aac8ed">&#9670;&#160;</a></span>yh_merge_capabilities()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_merge_capabilities </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structyh__capabilities.html">yh_capabilities</a> *</td>          <td class="paramname"><span class="paramname"><em>a</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structyh__capabilities.html">yh_capabilities</a> *</td>          <td class="paramname"><span class="paramname"><em>b</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structyh__capabilities.html">yh_capabilities</a> *</td>          <td class="paramname"><span class="paramname"><em>result</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Merge two sets of capabilities. The resulting set of capabilities contain all capabilities from both arrays</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">a</td><td>Array of <a class="el" href="structyh__capabilities.html" title="Capabilities representation.">yh_capabilities</a> </td></tr>
    <tr><td class="paramname">b</td><td>Array of <a class="el" href="structyh__capabilities.html" title="Capabilities representation.">yh_capabilities</a> </td></tr>
    <tr><td class="paramname">result</td><td>Resulting array of <a class="el" href="structyh__capabilities.html" title="Capabilities representation.">yh_capabilities</a></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> if input parameters are NULL.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a href="https://developers.yubico.com/YubiHSM2/Concepts/Capability.html">Capability</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l04219">4219</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4220</span>                                                     {</div>
<div class="line"><span class="lineno"> 4221</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="pointer_8h.html#aeeddce917cf130d62c370b8f216026dd">a</a> == NULL || b == NULL || result == NULL) {</div>
<div class="line"><span class="lineno"> 4222</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 4223</span>  }</div>
<div class="line"><span class="lineno"> 4224</span> </div>
<div class="line"><span class="lineno"> 4225</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_define" href="yubihsm_8h.html#ad3c904849d17cae0a6f426e8007731d7">YH_CAPABILITIES_LEN</a>; i++) {</div>
<div class="line"><span class="lineno"> 4226</span>    result-&gt;capabilities[i] = <a class="code hl_variable" href="pointer_8h.html#aeeddce917cf130d62c370b8f216026dd">a</a>-&gt;capabilities[i] | b-&gt;<a class="code hl_variable" href="structyh__capabilities.html#a5398bad7e61385aa127265ba0a053079">capabilities</a>[i];</div>
<div class="line"><span class="lineno"> 4227</span>  }</div>
<div class="line"><span class="lineno"> 4228</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 4229</span>}</div>
<div class="ttc" id="apointer_8h_html_aeeddce917cf130d62c370b8f216026dd"><div class="ttname"><a href="pointer_8h.html#aeeddce917cf130d62c370b8f216026dd">a</a></div><div class="ttdeci">const GenericPointer&lt; typename T::ValueType &gt; T2 T::AllocatorType &amp; a</div><div class="ttdef"><b>Definition</b> <a href="pointer_8h_source.html#l01181">pointer.h:1181</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a799e299be8d4c13dfa2112a60d05480d" name="a799e299be8d4c13dfa2112a60d05480d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a799e299be8d4c13dfa2112a60d05480d">&#9670;&#160;</a></span>yh_send_plain_msg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_send_plain_msg </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__connector.html">yh_connector</a> *</td>          <td class="paramname"><span class="paramname"><em>connector</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7e">yh_cmd</a></td>          <td class="paramname"><span class="paramname"><em>cmd</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>data</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>data_len</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7e">yh_cmd</a> *</td>          <td class="paramname"><span class="paramname"><em>response_cmd</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>response</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *</td>          <td class="paramname"><span class="paramname"><em>response_len</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Send a plain (unencrypted) message to the device through a connector</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">connector</td><td>Connector to the device </td></tr>
    <tr><td class="paramname">cmd</td><td><a class="el" href="struct_command.html">Command</a> to send. See <a class="el" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7e">yh_cmd</a> </td></tr>
    <tr><td class="paramname">data</td><td><a class="el" href="struct_data.html">Data</a> to send </td></tr>
    <tr><td class="paramname">data_len</td><td>length of data to send </td></tr>
    <tr><td class="paramname">response_cmd</td><td>Response command </td></tr>
    <tr><td class="paramname">response</td><td>Response data </td></tr>
    <tr><td class="paramname">response_len</td><td>Length of response data</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> if input parameters are NULL. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366ad8971a0b9647564b76b3f4e4b662c965" title="Returned value when there is not enough space to store data.">YHR_BUFFER_TOO_SMALL</a> if the actual response was longer than response_len. See <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> for other possible errors </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l00126">126</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  129</span>                                              {</div>
<div class="line"><span class="lineno">  130</span> </div>
<div class="line"><span class="lineno">  131</span>  <a class="code hl_union" href="union___msg.html">Msg</a> msg;</div>
<div class="line"><span class="lineno">  132</span>  <a class="code hl_union" href="union___msg.html">Msg</a> response_msg;</div>
<div class="line"><span class="lineno">  133</span> </div>
<div class="line"><span class="lineno">  134</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno">  135</span> </div>
<div class="line"><span class="lineno">  136</span>  <span class="keywordflow">if</span> (connector == NULL || (data_len != 0 &amp;&amp; data == NULL) ||</div>
<div class="line"><span class="lineno">  137</span>      response_cmd == NULL || response == NULL || response_len == NULL) {</div>
<div class="line"><span class="lineno">  138</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>));</div>
<div class="line"><span class="lineno">  139</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno">  140</span>  }</div>
<div class="line"><span class="lineno">  141</span> </div>
<div class="line"><span class="lineno">  142</span>  <span class="keywordflow">if</span> (data_len &gt; <span class="keyword">sizeof</span>(msg.<a class="code hl_variable" href="union___msg.html#a6b67958147999d1199c922c26763d7f0">st</a>.data)) {</div>
<div class="line"><span class="lineno">  143</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Tried to transfer oversized data (%zu &gt; %zu)&quot;</span>, data_len,</div>
<div class="line"><span class="lineno">  144</span>            <span class="keyword">sizeof</span>(msg.<a class="code hl_variable" href="union___msg.html#a6b67958147999d1199c922c26763d7f0">st</a>.data));</div>
<div class="line"><span class="lineno">  145</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno">  146</span>  }</div>
<div class="line"><span class="lineno">  147</span> </div>
<div class="line"><span class="lineno">  148</span>  msg.<a class="code hl_variable" href="union___msg.html#a6b67958147999d1199c922c26763d7f0">st</a>.cmd = cmd;</div>
<div class="line"><span class="lineno">  149</span>  msg.<a class="code hl_variable" href="union___msg.html#a6b67958147999d1199c922c26763d7f0">st</a>.len = data_len;</div>
<div class="line"><span class="lineno">  150</span>  <span class="keywordflow">if</span> (data_len &gt; 0) {</div>
<div class="line"><span class="lineno">  151</span>    <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(msg.<a class="code hl_variable" href="union___msg.html#a6b67958147999d1199c922c26763d7f0">st</a>.data, data, data_len);</div>
<div class="line"><span class="lineno">  152</span>  }</div>
<div class="line"><span class="lineno">  153</span> </div>
<div class="line"><span class="lineno">  154</span>  <a class="code hl_define" href="debug__lib_8h.html#ac9fd02aaaf96a535c1d73aefb379e4d6">DBG_DUMPINFO</a>(msg.<a class="code hl_variable" href="union___msg.html#aeba349af15322ba6c42fe23750437b0d">raw</a>, data_len + 3, <span class="stringliteral">&quot;Sending cmd %02x (%3zu Bytes): &quot;</span>, cmd,</div>
<div class="line"><span class="lineno">  155</span>               data_len + 3);</div>
<div class="line"><span class="lineno">  156</span> </div>
<div class="line"><span class="lineno">  157</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = send_msg(connector, &amp;msg, &amp;response_msg);</div>
<div class="line"><span class="lineno">  158</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno">  159</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno">  160</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno">  161</span>  }</div>
<div class="line"><span class="lineno">  162</span> </div>
<div class="line"><span class="lineno">  163</span>  <span class="keywordflow">if</span> (*response_len &lt; response_msg.<a class="code hl_variable" href="union___msg.html#a6b67958147999d1199c922c26763d7f0">st</a>.len) {</div>
<div class="line"><span class="lineno">  164</span>    <a class="code hl_define" href="debug__lib_8h.html#a741bf237335f48769194bd9e625c1d53">DBG_DUMPERR</a>(response_msg.<a class="code hl_variable" href="union___msg.html#aeba349af15322ba6c42fe23750437b0d">raw</a>, response_msg.<a class="code hl_variable" href="union___msg.html#a6b67958147999d1199c922c26763d7f0">st</a>.len + 3,</div>
<div class="line"><span class="lineno">  165</span>                <span class="stringliteral">&quot;%s (received %3d Bytes, can fit %3zu Bytes) &quot;</span>,</div>
<div class="line"><span class="lineno">  166</span>                <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366ad8971a0b9647564b76b3f4e4b662c965">YHR_BUFFER_TOO_SMALL</a>), response_msg.<a class="code hl_variable" href="union___msg.html#a6b67958147999d1199c922c26763d7f0">st</a>.len,</div>
<div class="line"><span class="lineno">  167</span>                *response_len);</div>
<div class="line"><span class="lineno">  168</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366ad8971a0b9647564b76b3f4e4b662c965">YHR_BUFFER_TOO_SMALL</a>;</div>
<div class="line"><span class="lineno">  169</span>  }</div>
<div class="line"><span class="lineno">  170</span> </div>
<div class="line"><span class="lineno">  171</span>  *response_cmd = response_msg.<a class="code hl_variable" href="union___msg.html#a6b67958147999d1199c922c26763d7f0">st</a>.cmd;</div>
<div class="line"><span class="lineno">  172</span> </div>
<div class="line"><span class="lineno">  173</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(response, response_msg.<a class="code hl_variable" href="union___msg.html#a6b67958147999d1199c922c26763d7f0">st</a>.data, response_msg.<a class="code hl_variable" href="union___msg.html#a6b67958147999d1199c922c26763d7f0">st</a>.len);</div>
<div class="line"><span class="lineno">  174</span>  *response_len = response_msg.<a class="code hl_variable" href="union___msg.html#a6b67958147999d1199c922c26763d7f0">st</a>.len;</div>
<div class="line"><span class="lineno">  175</span> </div>
<div class="line"><span class="lineno">  176</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno">  177</span>}</div>
<div class="ttc" id="adebug__lib_8h_html_a741bf237335f48769194bd9e625c1d53"><div class="ttname"><a href="debug__lib_8h.html#a741bf237335f48769194bd9e625c1d53">DBG_DUMPERR</a></div><div class="ttdeci">#define DBG_DUMPERR(var, len,...)</div><div class="ttdef"><b>Definition</b> <a href="debug__lib_8h_source.html#l00083">debug_lib.h:83</a></div></div>
<div class="ttc" id="adebug__lib_8h_html_ac9fd02aaaf96a535c1d73aefb379e4d6"><div class="ttname"><a href="debug__lib_8h.html#ac9fd02aaaf96a535c1d73aefb379e4d6">DBG_DUMPINFO</a></div><div class="ttdeci">#define DBG_DUMPINFO(var, len,...)</div><div class="ttdef"><b>Definition</b> <a href="debug__lib_8h_source.html#l00069">debug_lib.h:69</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a799e299be8d4c13dfa2112a60d05480d_cgraph.png" border="0" usemap="#ayubihsm_8c_a799e299be8d4c13dfa2112a60d05480d_cgraph" alt=""/></div>
<map name="ayubihsm_8c_a799e299be8d4c13dfa2112a60d05480d_cgraph" id="ayubihsm_8c_a799e299be8d4c13dfa2112a60d05480d_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,142,56"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="196,5,267,31"/>
<area shape="poly" title=" " alt="" coords="142,30,180,24,181,29,142,35"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="190,55,273,80"/>
<area shape="poly" title=" " alt="" coords="142,51,175,56,174,62,142,57"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a799e299be8d4c13dfa2112a60d05480d_icgraph.png" border="0" usemap="#ayubihsm_8c_a799e299be8d4c13dfa2112a60d05480d_icgraph" alt=""/></div>
<map name="ayubihsm_8c_a799e299be8d4c13dfa2112a60d05480d_icgraph" id="ayubihsm_8c_a799e299be8d4c13dfa2112a60d05480d_icgraph">
<area shape="rect" title=" " alt="" coords="870,80,1006,106"/>
<area shape="rect" href="yubihsm__shell__tests_8c.html#ae66f6b31b5ad750f1fe042a706a4e3d4" title=" " alt="" coords="718,5,768,31"/>
<area shape="poly" title=" " alt="" coords="894,76,821,45,767,27,769,22,823,40,896,71"/>
<area shape="rect" href="echo_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="718,55,768,80"/>
<area shape="poly" title=" " alt="" coords="854,85,768,73,769,68,855,79"/>
<area shape="rect" href="commands_8c.html#a95d970cdea5162be25cac2a7f5c420ed" title=" " alt="" coords="688,104,798,130"/>
<area shape="poly" title=" " alt="" coords="855,106,798,113,798,107,854,100"/>
<area shape="rect" href="yubihsm_8c.html#a6ab558e1426359cc78e7a362f8b3acd9" title=" " alt="" coords="664,179,822,204"/>
<area shape="poly" title=" " alt="" coords="898,115,772,180,769,176,896,111"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="240,79,386,104"/>
<area shape="poly" title=" " alt="" coords="673,115,386,98,386,93,673,110"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="65,104,115,130"/>
<area shape="poly" title=" " alt="" coords="225,104,115,117,115,111,225,99"/>
<area shape="rect" href="util__pkcs11_8c.html#a95f1c61424aa67f782a360e59c6cee84" title=" " alt="" coords="463,179,604,204"/>
<area shape="poly" title=" " alt="" coords="649,194,605,194,605,189,649,189"/>
<area shape="rect" href="util__pkcs11_8c.html#a064731f36eb972f687b4059dc5f340db" title=" " alt="" coords="465,229,602,255"/>
<area shape="poly" title=" " alt="" coords="673,211,590,231,589,226,671,206"/>
<area shape="rect" href="info_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="509,279,558,304"/>
<area shape="poly" title=" " alt="" coords="712,216,668,243,617,270,560,289,558,284,615,265,666,239,709,211"/>
<area shape="rect" href="commands_8c.html#aca833cbc2ca7673b00a4f6cb320c97b6" title=" " alt="" coords="451,129,616,155"/>
<area shape="poly" title=" " alt="" coords="670,177,591,158,592,153,671,172"/>
<area shape="rect" href="util__pkcs11_8c.html#a5ce40fa3ee245e65d99ee4cec7a1dd0c" title=" " alt="" coords="223,229,403,255"/>
<area shape="poly" title=" " alt="" coords="449,245,404,245,404,240,449,240"/>
<area shape="rect" href="util__pkcs11_8c.html#a1a99061c5c316d6427b27f8d506338bf" title=" " alt="" coords="223,279,403,304"/>
<area shape="poly" title=" " alt="" coords="458,262,374,281,373,275,457,256"/>
<area shape="rect" href="util__pkcs11_8c.html#ae8ed437178cb69b0fed6916747368344" title=" " alt="" coords="232,328,394,354"/>
<area shape="poly" title=" " alt="" coords="461,264,453,268,438,280,429,293,420,306,404,319,381,330,379,325,402,315,416,303,425,290,434,277,449,264,458,259"/>
<area shape="rect" href="util__pkcs11_8c.html#a83e06a2ae90589d9fad186cad9ed5ede" title=" " alt="" coords="230,180,396,206"/>
<area shape="poly" title=" " alt="" coords="457,228,373,209,374,204,458,223"/>
<area shape="rect" href="util__pkcs11_8c.html#a87b96fbdfd225d8124f0a6f6d6538292" title=" " alt="" coords="5,328,175,354"/>
<area shape="poly" title=" " alt="" coords="217,344,175,344,175,338,217,338"/>
<area shape="poly" title=" " alt="" coords="459,128,371,108,373,102,460,123"/>
<area shape="poly" title=" " alt="" coords="435,139,115,121,115,116,436,134"/>
</map>
</div>

</div>
</div>
<a id="a4c26f003b72e800e9c934bca922a404a" name="a4c26f003b72e800e9c934bca922a404a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c26f003b72e800e9c934bca922a404a">&#9670;&#160;</a></span>yh_send_secure_msg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_send_secure_msg </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__session.html">yh_session</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7e">yh_cmd</a></td>          <td class="paramname"><span class="paramname"><em>cmd</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>data</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>data_len</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7e">yh_cmd</a> *</td>          <td class="paramname"><span class="paramname"><em>response_cmd</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>response</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *</td>          <td class="paramname"><span class="paramname"><em>response_len</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Send an encrypted message to the device over a session. The session has to be authenticated</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>Session to send the message over </td></tr>
    <tr><td class="paramname">cmd</td><td><a class="el" href="struct_command.html">Command</a> to send </td></tr>
    <tr><td class="paramname">data</td><td><a class="el" href="struct_data.html">Data</a> to send </td></tr>
    <tr><td class="paramname">data_len</td><td>Length of data to send </td></tr>
    <tr><td class="paramname">response_cmd</td><td>Response command </td></tr>
    <tr><td class="paramname">response</td><td>Response data </td></tr>
    <tr><td class="paramname">response_len</td><td>Length of response data</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. See <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> for possible errors </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l00416">416</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  418</span>                                                                  {</div>
<div class="line"><span class="lineno">  419</span> </div>
<div class="line"><span class="lineno">  420</span>  <span class="keywordtype">size_t</span> saved_len = *response_len;</div>
<div class="line"><span class="lineno">  421</span> </div>
<div class="line"><span class="lineno">  422</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = _send_secure_msg(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, cmd, data, data_len, response_cmd,</div>
<div class="line"><span class="lineno">  423</span>                               response, response_len);</div>
<div class="line"><span class="lineno">  424</span>  <span class="keywordflow">if</span> ((<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> == <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a36bb9a78d1e8eda6adcf8fb3eff2bf9d">YHR_DEVICE_INVALID_SESSION</a> ||</div>
<div class="line"><span class="lineno">  425</span>       <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> == <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a9fdf081102d4876da3b7bc9986cdbef8">YHR_DEVICE_AUTHENTICATION_FAILED</a>) &amp;&amp;</div>
<div class="line"><span class="lineno">  426</span>      <a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>-&gt;recreate) {</div>
<div class="line"><span class="lineno">  427</span>    <a class="code hl_define" href="debug__lib_8h.html#a8c4742440a149ad8bcb5d58ae76c5ed3">DBG_INFO</a>(<span class="stringliteral">&quot;Recreating session&quot;</span>);</div>
<div class="line"><span class="lineno">  428</span>    <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="#a0e96ea59c5f32def80843fec5a3c2142">yh_create_session</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>-&gt;parent, <a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>-&gt;authkey_id,</div>
<div class="line"><span class="lineno">  429</span>                            <a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>-&gt;key_enc, <a class="code hl_define" href="scp_8h.html#a25905234f13446437b28c85d0504216d">SCP_KEY_LEN</a>, <a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>-&gt;key_mac,</div>
<div class="line"><span class="lineno">  430</span>                            <a class="code hl_define" href="scp_8h.html#a25905234f13446437b28c85d0504216d">SCP_KEY_LEN</a>, <span class="keyword">true</span>, &amp;<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>);</div>
<div class="line"><span class="lineno">  431</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno">  432</span>      <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno">  433</span>    }</div>
<div class="line"><span class="lineno">  434</span>    <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="#a77870209747d5ccd90f9da3aae2bdfa8">yh_authenticate_session</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>);</div>
<div class="line"><span class="lineno">  435</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno">  436</span>      <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno">  437</span>    }</div>
<div class="line"><span class="lineno">  438</span>    *response_len = saved_len;</div>
<div class="line"><span class="lineno">  439</span>    <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = _send_secure_msg(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, cmd, data, data_len, response_cmd, response,</div>
<div class="line"><span class="lineno">  440</span>                           response_len);</div>
<div class="line"><span class="lineno">  441</span>  }</div>
<div class="line"><span class="lineno">  442</span>  <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno">  443</span>}</div>
<div class="ttc" id="ayubihsm_8c_html_a77870209747d5ccd90f9da3aae2bdfa8"><div class="ttname"><a href="#a77870209747d5ccd90f9da3aae2bdfa8">yh_authenticate_session</a></div><div class="ttdeci">yh_rc yh_authenticate_session(yh_session *session)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l02927">yubihsm.c:2927</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_ae4f602d2343d01b1727dfd633169d366a36bb9a78d1e8eda6adcf8fb3eff2bf9d"><div class="ttname"><a href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a36bb9a78d1e8eda6adcf8fb3eff2bf9d">YHR_DEVICE_INVALID_SESSION</a></div><div class="ttdeci">@ YHR_DEVICE_INVALID_SESSION</div><div class="ttdoc">Returned value when the device session is invalid.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00201">yubihsm.h:201</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_ae4f602d2343d01b1727dfd633169d366a9fdf081102d4876da3b7bc9986cdbef8"><div class="ttname"><a href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a9fdf081102d4876da3b7bc9986cdbef8">YHR_DEVICE_AUTHENTICATION_FAILED</a></div><div class="ttdeci">@ YHR_DEVICE_AUTHENTICATION_FAILED</div><div class="ttdoc">Return value when the device fails to encrypt or verify the message.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00203">yubihsm.h:203</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a4c26f003b72e800e9c934bca922a404a_cgraph.png" border="0" usemap="#ayubihsm_8c_a4c26f003b72e800e9c934bca922a404a_cgraph" alt=""/></div>
<map name="ayubihsm_8c_a4c26f003b72e800e9c934bca922a404a_cgraph" id="ayubihsm_8c_a4c26f003b72e800e9c934bca922a404a_cgraph">
<area shape="rect" title=" " alt="" coords="5,80,154,106"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="202,104,367,130"/>
<area shape="poly" title=" " alt="" coords="154,99,186,103,186,108,154,104"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="219,55,350,80"/>
<area shape="poly" title=" " alt="" coords="153,81,204,75,204,80,154,86"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="431,55,502,80"/>
<area shape="poly" title=" " alt="" coords="334,101,415,78,417,84,335,106"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="432,153,501,179"/>
<area shape="poly" title=" " alt="" coords="335,128,418,150,417,156,334,133"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="425,104,508,130"/>
<area shape="poly" title=" " alt="" coords="368,114,410,114,410,120,368,120"/>
<area shape="poly" title=" " alt="" coords="350,65,416,65,416,70,350,70"/>
<area shape="poly" title=" " alt="" coords="335,78,411,99,409,104,334,84"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="415,5,518,31"/>
<area shape="poly" title=" " alt="" coords="334,51,401,33,402,38,335,57"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a4c26f003b72e800e9c934bca922a404a_icgraph.png" border="0" usemap="#ayubihsm_8c_a4c26f003b72e800e9c934bca922a404a_icgraph" alt=""/></div>
<map name="ayubihsm_8c_a4c26f003b72e800e9c934bca922a404a_icgraph" id="ayubihsm_8c_a4c26f003b72e800e9c934bca922a404a_icgraph">
<area shape="rect" title=" " alt="" coords="476,1228,624,1254"/>
<area shape="rect" href="yubihsm__shell__tests_8c.html#ae66f6b31b5ad750f1fe042a706a4e3d4" title=" " alt="" coords="291,5,340,31"/>
<area shape="poly" title=" " alt="" coords="545,1213,535,970,513,597,497,407,477,239,453,112,440,69,426,44,408,30,385,22,341,19,341,13,387,17,410,25,430,40,445,67,459,111,483,238,503,406,519,596,541,969,551,1212"/>
<area shape="rect" href="echo_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="291,55,340,80"/>
<area shape="poly" title=" " alt="" coords="545,1212,535,978,512,621,496,440,476,280,452,158,440,117,426,93,408,79,385,72,341,68,341,63,387,66,410,75,430,90,444,115,458,157,481,279,501,439,517,620,540,978,550,1212"/>
<area shape="rect" href="structsysio_1_1wallet_1_1detail_1_1yubihsm__wallet__impl.html#a6412f92a0ad381f2370582372a5b6082" title=" " alt="" coords="236,178,396,234"/>
<area shape="poly" title=" " alt="" coords="547,1212,546,1022,541,883,533,733,518,582,497,442,483,381,466,327,447,282,426,248,412,234,394,224,397,220,415,230,430,244,452,280,471,325,488,380,502,441,524,581,538,732,547,883,551,1021,552,1212"/>
<area shape="rect" href="commands_8c.html#af764906e585805991dd84ec5dc2c060a" title=" " alt="" coords="265,104,367,130"/>
<area shape="poly" title=" " alt="" coords="545,1213,534,988,510,647,494,474,474,322,451,206,439,167,426,144,414,133,399,126,367,119,368,113,401,121,417,129,430,140,444,165,457,204,479,321,499,473,515,646,539,987,550,1212"/>
<area shape="rect" href="yubihsm_8c.html#ad112fe09ee88d595333fa87e8059717b" title=" " alt="" coords="247,259,385,284"/>
<area shape="poly" title=" " alt="" coords="547,1213,547,1029,543,896,535,753,520,609,498,478,484,420,467,370,448,328,426,297,407,283,385,276,386,271,410,279,430,294,453,326,472,368,489,419,503,477,525,609,540,752,548,896,552,1029,552,1213"/>
<area shape="rect" href="yubihsm_8c.html#a8f229874e387887d7c5b4c7e6e07db8e" title=" " alt="" coords="204,308,428,334"/>
<area shape="poly" title=" " alt="" coords="547,1213,545,1038,540,912,532,776,517,641,495,517,481,462,465,415,447,376,426,347,413,336,417,332,430,343,452,373,470,413,487,461,501,516,522,640,537,776,546,912,550,1037,552,1213"/>
<area shape="rect" href="yubihsm_8c.html#a61ab8dbab67b1cceb49cd306f8c3f4b1" title=" " alt="" coords="241,357,390,383"/>
<area shape="poly" title=" " alt="" coords="546,1213,543,1046,538,928,529,800,514,672,492,556,479,505,463,460,446,423,426,396,410,384,390,376,392,371,412,379,430,392,450,421,468,458,484,503,498,554,519,672,534,799,543,927,549,1046,552,1213"/>
<area shape="rect" href="yubihsm_8c.html#a82d295a02d9eb628f6dea4b4c01fdec4" title=" " alt="" coords="235,407,397,432"/>
<area shape="poly" title=" " alt="" coords="546,1212,542,1054,525,823,510,703,489,594,462,505,445,471,426,445,412,434,396,427,398,422,415,430,430,442,449,468,466,503,495,593,516,703,531,822,547,1054,551,1212"/>
<area shape="rect" href="yubihsm_8c.html#aa939f8764ed0cca27884d9c8f640ac14" title=" " alt="" coords="244,456,388,482"/>
<area shape="poly" title=" " alt="" coords="546,1213,540,1063,522,847,507,735,486,634,460,550,444,519,426,495,409,482,388,474,390,469,411,477,430,491,448,516,465,548,492,632,512,734,528,846,545,1063,551,1212"/>
<area shape="rect" href="yubihsm_8c.html#a3677afe2209a1cae31f70a304e260e28" title=" " alt="" coords="249,505,383,531"/>
<area shape="poly" title=" " alt="" coords="545,1212,538,1071,519,870,504,767,483,672,458,595,443,566,426,544,406,530,383,522,384,517,409,525,430,540,447,563,463,593,489,671,509,766,525,869,543,1071,551,1212"/>
<area shape="rect" href="yubihsm_8c.html#a5ebf6932cd2e68b9a23787c27fde3e26" title=" " alt="" coords="226,555,406,580"/>
<area shape="poly" title=" " alt="" coords="545,1213,536,1081,516,894,501,799,481,712,456,641,442,614,426,593,404,579,407,574,430,590,446,611,461,639,486,710,506,798,521,894,542,1081,550,1213"/>
<area shape="rect" href="yubihsm_8c.html#ae736702f9463878db4adfd45b6a597f9" title=" " alt="" coords="244,604,388,630"/>
<area shape="poly" title=" " alt="" coords="545,1213,535,1091,513,919,497,831,478,751,454,686,441,661,426,643,408,630,387,622,389,617,411,625,430,639,445,658,459,684,483,750,503,830,518,918,540,1090,550,1213"/>
<area shape="rect" href="yubihsm_8c.html#a2900aee87732f9ec017bd1662bcef7e9" title=" " alt="" coords="248,653,384,679"/>
<area shape="poly" title=" " alt="" coords="544,1212,532,1098,510,941,494,862,475,790,452,731,426,692,407,679,383,671,385,666,409,674,430,688,457,729,480,788,499,861,515,941,538,1098,549,1212"/>
<area shape="rect" href="yubihsm_8c.html#aa3f473e6dbb9188ad0269b40921c4f5f" title=" " alt="" coords="237,703,395,728"/>
<area shape="poly" title=" " alt="" coords="543,1213,530,1109,506,966,490,895,472,829,450,777,426,741,412,731,394,723,397,718,414,726,430,738,455,774,477,828,496,893,512,965,536,1108,549,1213"/>
<area shape="rect" href="yubihsm_8c.html#a1eac22853548b7ceab92550c22233b18" title=" " alt="" coords="224,752,408,778"/>
<area shape="poly" title=" " alt="" coords="543,1213,528,1118,503,991,487,928,468,870,448,823,426,792,407,779,410,774,430,788,453,821,473,868,492,926,508,990,533,1117,548,1213"/>
<area shape="rect" href="yubihsm_8c.html#a9e130d225a8dc003d7a7c0ce4b8ea5e4" title=" " alt="" coords="245,802,386,842"/>
<area shape="poly" title=" " alt="" coords="546,1213,541,1141,523,1045,508,994,488,944,460,897,426,856,407,843,386,833,388,829,410,838,430,852,465,894,492,941,513,992,529,1044,546,1140,551,1212"/>
<area shape="rect" href="yubihsm_8c.html#a1f749a696792e7911844629e056d9c15" title=" " alt="" coords="226,867,406,892"/>
<area shape="poly" title=" " alt="" coords="545,1213,537,1149,519,1065,503,1021,483,979,458,939,426,906,405,892,407,888,430,901,462,936,488,976,508,1019,524,1064,543,1148,550,1212"/>
<area shape="rect" href="yubihsm_8c.html#a5ae52ad56b7e83baeb33b46104263aa6" title=" " alt="" coords="239,916,393,942"/>
<area shape="poly" title=" " alt="" coords="543,1213,533,1158,512,1087,497,1051,478,1015,454,983,426,955,410,945,392,938,394,933,413,940,430,951,458,979,482,1013,501,1048,517,1085,538,1156,548,1212"/>
<area shape="rect" href="yubihsm_8c.html#a7b5f1f0c1cbca11fbe21e7e4e6b29a1b" title=" " alt="" coords="239,965,393,991"/>
<area shape="poly" title=" " alt="" coords="540,1213,527,1167,505,1110,472,1052,451,1026,426,1004,392,988,394,983,430,1000,454,1023,476,1049,510,1108,532,1165,545,1212"/>
<area shape="rect" href="yubihsm_8c.html#a56e060e71fb8baa0531b3a20848abf37" title=" " alt="" coords="249,1015,382,1040"/>
<area shape="poly" title=" " alt="" coords="537,1215,521,1178,497,1134,466,1090,426,1054,405,1043,382,1035,384,1030,407,1038,430,1049,470,1086,502,1131,526,1175,542,1213"/>
<area shape="rect" href="yubihsm_8c.html#a11871e03c808e2d25737f893e58ed094" title=" " alt="" coords="253,1064,379,1090"/>
<area shape="poly" title=" " alt="" coords="531,1216,489,1159,460,1129,427,1104,404,1094,379,1087,380,1081,405,1089,429,1100,463,1125,493,1155,536,1213"/>
<area shape="rect" href="yubihsm_8c.html#af1bc8ed34687d83701eb3cc673ad4b96" title=" " alt="" coords="249,1114,382,1154"/>
<area shape="poly" title=" " alt="" coords="517,1221,475,1194,427,1169,382,1152,384,1147,429,1164,478,1190,520,1217"/>
<area shape="rect" href="yubihsm_8c.html#aa7b8b42156c4bdaf41d8b9758a2fd73f" title=" " alt="" coords="239,1179,392,1204"/>
<area shape="poly" title=" " alt="" coords="470,1227,380,1208,381,1202,471,1222"/>
<area shape="rect" href="yubihsm_8c.html#ae87d5578703775b9d4151a14435f4a73" title=" " alt="" coords="235,1228,397,1254"/>
<area shape="poly" title=" " alt="" coords="461,1244,398,1244,398,1238,461,1238"/>
<area shape="rect" href="yubihsm_8c.html#a47768ae0e72beba49f02db1baddf4823" title=" " alt="" coords="245,1277,386,1303"/>
<area shape="poly" title=" " alt="" coords="471,1260,381,1279,380,1274,470,1255"/>
<area shape="rect" href="yubihsm_8c.html#ac154da7ac6dc0a7b4b3a6cdff9433da8" title=" " alt="" coords="207,1327,425,1352"/>
<area shape="poly" title=" " alt="" coords="521,1265,479,1293,429,1318,396,1329,394,1324,427,1313,476,1288,518,1261"/>
<area shape="rect" href="yubihsm_8c.html#a19c79faaf10c405864f0179821d551a5" title=" " alt="" coords="231,1376,400,1402"/>
<area shape="poly" title=" " alt="" coords="533,1268,490,1319,461,1345,429,1367,402,1379,400,1374,427,1362,458,1341,486,1315,529,1265"/>
<area shape="rect" href="yubihsm_8c.html#a1249c920eec24f634d04eaafb90a1ca2" title=" " alt="" coords="240,1425,392,1451"/>
<area shape="poly" title=" " alt="" coords="540,1269,523,1303,499,1343,468,1383,429,1416,393,1432,391,1428,427,1412,464,1379,495,1340,519,1301,535,1267"/>
<area shape="rect" href="yubihsm_8c.html#addc22271306d847f53321984f41d818b" title=" " alt="" coords="252,1475,380,1516"/>
<area shape="poly" title=" " alt="" coords="544,1270,529,1313,506,1366,473,1419,453,1444,430,1466,406,1480,381,1489,379,1484,404,1475,426,1461,449,1440,469,1416,501,1363,524,1311,539,1268"/>
<area shape="rect" href="yubihsm_8c.html#ae0fc8d6520950868365011d1a9f450f1" title=" " alt="" coords="236,1540,396,1566"/>
<area shape="poly" title=" " alt="" coords="548,1270,537,1325,516,1396,501,1432,482,1468,458,1501,430,1530,397,1547,395,1542,426,1525,454,1498,477,1465,496,1430,511,1394,532,1324,543,1269"/>
<area shape="rect" href="yubihsm_8c.html#a3a9729ea5b2e299a735b43f2b23e50a7" title=" " alt="" coords="233,1589,398,1615"/>
<area shape="poly" title=" " alt="" coords="550,1270,543,1334,524,1418,508,1462,488,1506,462,1546,430,1580,400,1597,397,1592,426,1576,458,1542,483,1503,503,1460,519,1417,537,1333,545,1269"/>
<area shape="rect" href="yubihsm_8c.html#ae5bf13f9558bb0340468b722accf94d3" title=" " alt="" coords="237,1639,395,1664"/>
<area shape="poly" title=" " alt="" coords="552,1270,547,1342,530,1440,515,1491,494,1542,466,1589,430,1629,414,1640,397,1648,395,1643,412,1636,426,1626,461,1586,489,1540,510,1490,525,1438,542,1342,546,1269"/>
<area shape="rect" href="yubihsm_8c.html#a7cbea7103efff8473ccfaaa35bfc6346" title=" " alt="" coords="250,1688,382,1714"/>
<area shape="poly" title=" " alt="" coords="547,1269,532,1362,507,1485,491,1546,473,1602,452,1648,430,1679,408,1693,383,1701,382,1696,406,1688,426,1675,448,1645,468,1600,486,1545,502,1483,527,1361,542,1269"/>
<area shape="rect" href="yubihsm_8c.html#a4bb1d420f681bc91bd36dc08695dbad6" title=" " alt="" coords="223,1737,409,1763"/>
<area shape="poly" title=" " alt="" coords="548,1269,535,1371,510,1509,494,1578,476,1641,454,1693,430,1728,411,1741,408,1737,426,1724,450,1690,471,1640,489,1577,505,1508,529,1370,543,1269"/>
<area shape="rect" href="yubihsm_8c.html#a5c153fe27877bcc7927d391fb55550af" title=" " alt="" coords="246,1787,386,1812"/>
<area shape="poly" title=" " alt="" coords="549,1269,537,1380,514,1532,498,1610,479,1680,456,1738,430,1777,410,1791,387,1799,386,1794,408,1787,426,1774,451,1736,474,1679,493,1609,509,1532,532,1379,544,1268"/>
<area shape="rect" href="yubihsm_8c.html#a9d844855c9066bbea0e4344978dd7fdc" title=" " alt="" coords="243,1836,389,1862"/>
<area shape="poly" title=" " alt="" coords="550,1269,539,1389,517,1557,501,1642,482,1720,458,1783,445,1808,430,1827,411,1840,390,1848,389,1843,409,1835,426,1823,440,1805,453,1781,477,1718,496,1641,512,1556,534,1389,544,1269"/>
<area shape="rect" href="yubihsm_8c.html#a85ac840aec77cb1ca3c3ce1f2ab26282" title=" " alt="" coords="253,1885,379,1911"/>
<area shape="poly" title=" " alt="" coords="550,1270,541,1399,520,1581,505,1674,485,1759,460,1828,446,1856,430,1876,407,1892,380,1900,378,1895,404,1887,426,1872,441,1853,455,1826,480,1757,499,1673,515,1580,536,1398,545,1269"/>
<area shape="rect" href="yubihsm_8c.html#a5988faffd97366b188728ff1a7fb6e89" title=" " alt="" coords="237,1935,395,1976"/>
<area shape="poly" title=" " alt="" coords="550,1269,542,1407,522,1603,506,1704,486,1796,461,1873,446,1902,430,1925,415,1938,397,1947,394,1942,412,1934,426,1922,442,1900,456,1871,481,1795,501,1703,517,1602,537,1406,545,1269"/>
<area shape="rect" href="yubihsm_8c.html#a5121c90d3bd745afd8264fef2ef39ace" title=" " alt="" coords="250,2000,382,2026"/>
<area shape="poly" title=" " alt="" coords="551,1269,545,1418,527,1635,512,1746,491,1848,464,1932,448,1965,430,1989,408,2005,383,2013,382,2008,406,2000,426,1986,444,1962,459,1930,486,1847,507,1745,522,1634,540,1418,546,1269"/>
<area shape="rect" href="yubihsm_8c.html#a690a5585de21ce82495e139ec1dfdf9d" title=" " alt="" coords="250,2049,382,2075"/>
<area shape="poly" title=" " alt="" coords="551,1269,547,1428,531,1659,516,1779,495,1889,466,1979,449,2013,430,2040,408,2055,383,2064,382,2059,406,2051,426,2036,445,2011,462,1977,489,1887,510,1778,525,1659,542,1428,546,1269"/>
<area shape="rect" href="yubihsm_8c.html#a9000d43fe8cf7313b319f316521eb0c4" title=" " alt="" coords="251,2099,380,2124"/>
<area shape="poly" title=" " alt="" coords="552,1269,549,1436,543,1554,534,1682,519,1810,498,1927,484,1979,468,2024,450,2061,430,2089,408,2105,382,2113,380,2108,405,2100,426,2086,446,2058,463,2022,479,1977,492,1926,514,1809,529,1682,538,1554,543,1436,546,1269"/>
<area shape="rect" href="yubihsm_8c.html#aa0a7644b7b368d6aaf8b4aff5e3d19b8" title=" " alt="" coords="236,2148,396,2174"/>
<area shape="poly" title=" " alt="" coords="552,1269,550,1444,546,1570,537,1706,522,1841,501,1966,487,2021,470,2069,452,2108,430,2139,415,2151,397,2159,395,2154,412,2146,426,2135,447,2106,465,2067,481,2019,495,1965,517,1841,532,1705,540,1569,545,1444,547,1269"/>
<area shape="rect" href="yubihsm_8c.html#a944e6f31487857709f032598fd43fef5" title=" " alt="" coords="257,2197,375,2223"/>
<area shape="poly" title=" " alt="" coords="552,1269,552,1453,548,1585,540,1729,525,1873,503,2005,489,2063,472,2114,453,2156,430,2188,405,2205,376,2213,375,2208,403,2200,426,2184,448,2153,467,2112,484,2062,498,2004,520,1872,535,1729,543,1585,547,1453,547,1269"/>
<area shape="rect" href="yubihsm_8c.html#a45c32b993856be818a70c0ffad589cbd" title=" " alt="" coords="225,2247,407,2272"/>
<area shape="poly" title=" " alt="" coords="550,1270,537,1476,512,1783,496,1939,476,2076,455,2180,443,2215,430,2237,409,2253,406,2248,426,2234,438,2213,449,2179,471,2075,490,1938,507,1783,532,1475,545,1269"/>
<area shape="rect" href="yubihsm_8c.html#a550567a0f56d8536b9b5f34e905da7ec" title=" " alt="" coords="246,2296,386,2322"/>
<area shape="poly" title=" " alt="" coords="550,1269,538,1485,514,1808,497,1972,478,2116,456,2226,443,2263,430,2287,410,2301,387,2310,385,2305,408,2297,426,2283,438,2261,450,2225,473,2115,492,1971,509,1808,533,1484,545,1269"/>
<area shape="rect" href="yubihsm_8c.html#ab37ae2f7fc6857b420e173284130686d" title=" " alt="" coords="247,2345,384,2371"/>
<area shape="poly" title=" " alt="" coords="550,1270,539,1494,515,1833,499,2005,479,2157,457,2272,444,2312,430,2336,410,2351,386,2359,384,2354,407,2346,426,2332,439,2310,451,2271,474,2156,494,2005,510,1833,534,1494,545,1269"/>
<area shape="rect" href="yubihsm_8c.html#a7c2e101be04ad1546d99d5600e732eca" title=" " alt="" coords="253,2395,379,2420"/>
<area shape="poly" title=" " alt="" coords="550,1269,540,1503,517,1858,501,2038,481,2197,458,2319,444,2360,430,2385,407,2402,380,2410,379,2405,405,2397,426,2382,440,2358,452,2317,476,2197,495,2037,512,1857,535,1502,545,1269"/>
<area shape="poly" title=" " alt="" coords="353,166,339,159,316,157,295,159,282,164,275,170,275,178,270,178,271,168,279,159,294,154,316,152,340,154,356,161"/>
<area shape="rect" href="structsysio_1_1wallet_1_1detail_1_1yubihsm__wallet__impl.html#a00ee0ac7ac4a819d0b8755bf4f442263" title=" " alt="" coords="5,950,156,1006"/>
<area shape="poly" title=" " alt="" coords="224,232,206,248,190,272,175,304,149,386,129,486,113,594,93,805,85,950,80,950,88,804,108,594,124,485,144,385,170,302,185,270,202,244,221,228"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="8,104,153,130"/>
<area shape="poly" title=" " alt="" coords="249,120,153,120,153,114,249,114"/>
<area shape="poly" title=" " alt="" coords="223,981,156,981,156,976,223,976"/>
<area shape="poly" title=" " alt="" coords="234,1698,217,1690,202,1679,184,1656,169,1626,143,1548,122,1453,107,1350,87,1148,80,1007,85,1007,93,1147,112,1349,128,1452,148,1546,174,1624,189,1653,206,1675,219,1686,236,1693"/>
</map>
</div>

</div>
</div>
<a id="a9addbfae4cdb70b819986e7769cdd102" name="a9addbfae4cdb70b819986e7769cdd102"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9addbfae4cdb70b819986e7769cdd102">&#9670;&#160;</a></span>yh_set_connector_option()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_set_connector_option </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__connector.html">yh_connector</a> *</td>          <td class="paramname"><span class="paramname"><em>connector</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm_8h.html#a59400bce0478b88e048d5e62b2b0b015">yh_connector_option</a></td>          <td class="paramname"><span class="paramname"><em>opt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *</td>          <td class="paramname"><span class="paramname"><em>val</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set connector options.</p>
<p>Note that backend options are not supported with winhttp or USB connectors</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">connector</td><td>Connector to set an option on </td></tr>
    <tr><td class="paramname">opt</td><td>Option to set. See <a class="el" href="yubihsm_8h.html#a59400bce0478b88e048d5e62b2b0b015">yh_connector_option</a> </td></tr>
    <tr><td class="paramname">val</td><td>Value of the option. Type of value is specific to the given option</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> if the connector or the value are NULL or if the option is unknown. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366ad9339b4f96ca48d9c987ce1e05596fe9" title="Return value when connector operation failed.">YHR_CONNECTOR_ERROR</a> if failed to set the option </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l04063">4063</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4064</span>                                               {</div>
<div class="line"><span class="lineno"> 4065</span> </div>
<div class="line"><span class="lineno"> 4066</span>  <span class="keywordflow">if</span> (connector == NULL || val == NULL) {</div>
<div class="line"><span class="lineno"> 4067</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Invalid parameters: undefined pointer&quot;</span>);</div>
<div class="line"><span class="lineno"> 4068</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 4069</span>  }</div>
<div class="line"><span class="lineno"> 4070</span> </div>
<div class="line"><span class="lineno"> 4071</span>  <span class="keywordflow">if</span> (connector-&gt;<a class="code hl_variable" href="structyh__connector.html#a88057cfd7ee5af648c3aa315bbff7f8e">bf</a> == NULL) {</div>
<div class="line"><span class="lineno"> 4072</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;No backend loaded&quot;</span>);</div>
<div class="line"><span class="lineno"> 4073</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 4074</span>  }</div>
<div class="line"><span class="lineno"> 4075</span> </div>
<div class="line"><span class="lineno"> 4076</span>  <span class="keywordflow">return</span> connector-&gt;<a class="code hl_variable" href="structyh__connector.html#a88057cfd7ee5af648c3aa315bbff7f8e">bf</a>-&gt;backend_option(connector-&gt;<a class="code hl_variable" href="structyh__connector.html#aafc44285171a0cb9b662fed6230a0648">connection</a>, opt, val);</div>
<div class="line"><span class="lineno"> 4077</span>}</div>
<div class="ttc" id="astructyh__connector_html_aafc44285171a0cb9b662fed6230a0648"><div class="ttname"><a href="structyh__connector.html#aafc44285171a0cb9b662fed6230a0648">yh_connector::connection</a></div><div class="ttdeci">yh_backend * connection</div><div class="ttdef"><b>Definition</b> <a href="lib_2internal_8h_source.html#l00040">internal.h:40</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a9addbfae4cdb70b819986e7769cdd102_icgraph.png" border="0" usemap="#ayubihsm_8c_a9addbfae4cdb70b819986e7769cdd102_icgraph" alt=""/></div>
<map name="ayubihsm_8c_a9addbfae4cdb70b819986e7769cdd102_icgraph" id="ayubihsm_8c_a9addbfae4cdb70b819986e7769cdd102_icgraph">
<area shape="rect" title=" " alt="" coords="518,31,685,56"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#a553b528011491713b85dc590221ea616" title=" " alt="" coords="296,5,470,31"/>
<area shape="poly" title=" " alt="" coords="503,35,470,31,471,26,503,29"/>
<area shape="rect" href="commands_8c.html#a9155cc4306ad97e58a03ead18637f33b" title=" " alt="" coords="323,55,443,80"/>
<area shape="poly" title=" " alt="" coords="504,57,444,64,443,58,503,52"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,29,248,55"/>
<area shape="poly" title=" " alt="" coords="307,61,248,54,249,48,308,56"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,55,55,80"/>
<area shape="poly" title=" " alt="" coords="307,70,55,70,55,65,307,65"/>
<area shape="poly" title=" " alt="" coords="88,60,55,66,54,61,87,55"/>
</map>
</div>

</div>
</div>
<a id="a7d223fd4ee6ae3f578307d72aba37a19" name="a7d223fd4ee6ae3f578307d72aba37a19"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d223fd4ee6ae3f578307d72aba37a19">&#9670;&#160;</a></span>yh_set_debug_output()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void yh_set_debug_output </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__connector.html">yh_connector</a> *</td>          <td class="paramname"><span class="paramname"><em>connector</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FILE *</td>          <td class="paramname"><span class="paramname"><em>output</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set file for debug output</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">connector</td><td>If not NULL, the debug messages will be written to the specified output file </td></tr>
    <tr><td class="paramname">output</td><td>The destination of the debug messages</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l03848">3848</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3848</span>                                                                {</div>
<div class="line"><span class="lineno"> 3849</span>  <a class="code hl_variable" href="debug__lib_8h.html#a76ba6bc136c2b38b71a9e3c56282cd3a">_yh_output</a> = output;</div>
<div class="line"><span class="lineno"> 3850</span> </div>
<div class="line"><span class="lineno"> 3851</span>  <span class="keywordflow">if</span> (connector != NULL &amp;&amp; connector-&gt;<a class="code hl_variable" href="structyh__connector.html#a88057cfd7ee5af648c3aa315bbff7f8e">bf</a> != NULL) {</div>
<div class="line"><span class="lineno"> 3852</span>    <span class="comment">// TODO(adma): should we error out if NULL?</span></div>
<div class="line"><span class="lineno"> 3853</span>    connector-&gt;<a class="code hl_variable" href="structyh__connector.html#a88057cfd7ee5af648c3aa315bbff7f8e">bf</a>-&gt;backend_set_verbosity(<a class="code hl_variable" href="debug__lib_8h.html#a4ba5f59460a312e3f5f14926f4b2299e">_yh_verbosity</a>, <a class="code hl_variable" href="debug__lib_8h.html#a76ba6bc136c2b38b71a9e3c56282cd3a">_yh_output</a>);</div>
<div class="line"><span class="lineno"> 3854</span>  }</div>
<div class="line"><span class="lineno"> 3855</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a7d223fd4ee6ae3f578307d72aba37a19_icgraph.png" border="0" usemap="#ayubihsm_8c_a7d223fd4ee6ae3f578307d72aba37a19_icgraph" alt=""/></div>
<map name="ayubihsm_8c_a7d223fd4ee6ae3f578307d72aba37a19_icgraph" id="ayubihsm_8c_a7d223fd4ee6ae3f578307d72aba37a19_icgraph">
<area shape="rect" title=" " alt="" coords="363,5,508,31"/>
<area shape="rect" href="debug__p11_8c.html#a561f643ac8a24b9d62f61117cd0a1bb4" title=" " alt="" coords="228,5,315,31"/>
<area shape="poly" title=" " alt="" coords="347,21,316,21,316,16,347,16"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#a553b528011491713b85dc590221ea616" title=" " alt="" coords="5,5,180,31"/>
<area shape="poly" title=" " alt="" coords="212,21,180,21,180,16,212,16"/>
</map>
</div>

</div>
</div>
<a id="a24c3146e51242256af505961e763f417" name="a24c3146e51242256af505961e763f417"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a24c3146e51242256af505961e763f417">&#9670;&#160;</a></span>yh_set_verbosity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_set_verbosity </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__connector.html">yh_connector</a> *</td>          <td class="paramname"><span class="paramname"><em>connector</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a></td>          <td class="paramname"><span class="paramname"><em>verbosity</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set verbosity level when executing commands. Default verbosity is <a class="el" href="yubihsm_8h.html#aa11030bbf6092d8934236958e9478084" title="Debug level quiet. No messages printed out.">YH_VERB_QUIET</a></p>
<p>This function may be called prior to global library initialization to set the debug level</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">connector</td><td>If not NULL, the verbosity of the specific connector will be set </td></tr>
    <tr><td class="paramname">verbosity</td><td>The desired level of debug output</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="yubihsm_8h.html#aa11030bbf6092d8934236958e9478084" title="Debug level quiet. No messages printed out.">YH_VERB_QUIET</a>, <a class="el" href="yubihsm_8h.html#af507fefd9d19bfd531277a6c6cb56452" title="Debug level intermediate. Intermediate results printed out.">YH_VERB_INTERMEDIATE</a>, <a class="el" href="yubihsm_8h.html#a8881b983de3922f9abb5d1fcc99216e2" title="Debug level crypto. Crypto results printed out.">YH_VERB_CRYPTO</a>, <a class="el" href="yubihsm_8h.html#a4ead07ea7b1232808085d4bdbc7eb5b9" title="Debug level raw. Raw messages printed out.">YH_VERB_RAW</a>, <a class="el" href="yubihsm_8h.html#a2ac0b183de01f2dc9f64372e6c66bba4" title="Debug level info. General information messages printed out.">YH_VERB_INFO</a>, <a class="el" href="yubihsm_8h.html#a978bb82a3974b6778aadb56fa450e8ca" title="Debug level error. Error messages printed out.">YH_VERB_ERR</a>, <a class="el" href="yubihsm_8h.html#a15dbe0ac973691939ca6e9148b181ccd" title="Debug level all. All previous options enabled.">YH_VERB_ALL</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l03825">3825</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3825</span>                                                                   {</div>
<div class="line"><span class="lineno"> 3826</span> </div>
<div class="line"><span class="lineno"> 3827</span>  <a class="code hl_variable" href="debug__lib_8h.html#a4ba5f59460a312e3f5f14926f4b2299e">_yh_verbosity</a> = verbosity;</div>
<div class="line"><span class="lineno"> 3828</span> </div>
<div class="line"><span class="lineno"> 3829</span>  <span class="keywordflow">if</span> (connector != NULL &amp;&amp; connector-&gt;<a class="code hl_variable" href="structyh__connector.html#a88057cfd7ee5af648c3aa315bbff7f8e">bf</a> != NULL) {</div>
<div class="line"><span class="lineno"> 3830</span>    <span class="comment">// TODO(adma): should we error out if NULL?</span></div>
<div class="line"><span class="lineno"> 3831</span>    connector-&gt;<a class="code hl_variable" href="structyh__connector.html#a88057cfd7ee5af648c3aa315bbff7f8e">bf</a>-&gt;backend_set_verbosity(<a class="code hl_variable" href="debug__lib_8h.html#a4ba5f59460a312e3f5f14926f4b2299e">_yh_verbosity</a>, <a class="code hl_variable" href="debug__lib_8h.html#a76ba6bc136c2b38b71a9e3c56282cd3a">_yh_output</a>);</div>
<div class="line"><span class="lineno"> 3832</span>  }</div>
<div class="line"><span class="lineno"> 3833</span> </div>
<div class="line"><span class="lineno"> 3834</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 3835</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a24c3146e51242256af505961e763f417_icgraph.png" border="0" usemap="#ayubihsm_8c_a24c3146e51242256af505961e763f417_icgraph" alt=""/></div>
<map name="ayubihsm_8c_a24c3146e51242256af505961e763f417_icgraph" id="ayubihsm_8c_a24c3146e51242256af505961e763f417_icgraph">
<area shape="rect" title=" " alt="" coords="560,255,681,280"/>
<area shape="rect" href="yubihsm__shell__tests_8c.html#ae66f6b31b5ad750f1fe042a706a4e3d4" title=" " alt="" coords="394,5,443,31"/>
<area shape="poly" title=" " alt="" coords="610,240,598,199,578,148,549,97,511,52,477,33,443,24,444,19,479,28,514,48,553,94,582,146,603,197,615,239"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,156,55,182"/>
<area shape="poly" title=" " alt="" coords="609,241,596,205,576,165,548,126,530,110,511,96,481,82,450,73,385,64,318,67,253,80,191,98,136,119,56,158,54,153,134,114,189,93,251,75,318,62,385,59,451,67,483,78,514,92,534,106,552,123,580,162,601,203,614,239"/>
<area shape="rect" href="echo_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="394,107,443,132"/>
<area shape="poly" title=" " alt="" coords="602,243,564,193,539,167,511,146,477,131,443,124,444,119,478,126,514,141,543,163,568,189,606,240"/>
<area shape="rect" href="commands_8c.html#ad8a6eb16c04ad3e525f8be152062ff24" title=" " alt="" coords="354,156,483,182"/>
<area shape="poly" title=" " alt="" coords="591,247,554,220,511,195,483,185,485,180,513,190,557,215,594,243"/>
<area shape="rect" href="commands_8c.html#af5cc531118346eb9389b42149112acdc" title=" " alt="" coords="342,205,495,231"/>
<area shape="poly" title=" " alt="" coords="549,253,474,234,475,229,551,248"/>
<area shape="rect" href="commands_8c.html#af045c2e8a570dc8fed3d339e75d26feb" title=" " alt="" coords="348,255,490,280"/>
<area shape="poly" title=" " alt="" coords="545,270,490,270,490,265,545,265"/>
<area shape="rect" href="commands_8c.html#a774b8dbc4c8d855527e518270206bb52" title=" " alt="" coords="350,304,487,330"/>
<area shape="poly" title=" " alt="" coords="551,287,475,306,474,301,549,282"/>
<area shape="rect" href="commands_8c.html#ad621ced8cc22f103e049f17717d0b3d8" title=" " alt="" coords="325,353,512,379"/>
<area shape="poly" title=" " alt="" coords="594,292,557,320,513,345,485,355,483,350,511,340,554,315,591,288"/>
<area shape="rect" href="commands_8c.html#ac8470d4c5dc4fa0d300bcf171a16140b" title=" " alt="" coords="346,403,491,428"/>
<area shape="poly" title=" " alt="" coords="606,295,568,346,543,372,514,394,492,404,489,400,511,389,539,368,564,342,602,292"/>
<area shape="rect" href="commands_8c.html#ac67abff009407dcfe773a32d8273969a" title=" " alt="" coords="350,452,487,478"/>
<area shape="poly" title=" " alt="" coords="612,296,598,330,577,369,549,409,514,443,489,456,487,451,511,439,545,406,572,367,593,327,607,294"/>
<area shape="rect" href="debug__p11_8c.html#a561f643ac8a24b9d62f61117cd0a1bb4" title=" " alt="" coords="375,501,462,527"/>
<area shape="poly" title=" " alt="" coords="616,296,605,340,585,393,555,446,536,471,514,492,490,506,463,513,462,508,488,501,511,488,532,467,551,443,580,390,600,338,611,295"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="117,280,262,306"/>
<area shape="poly" title=" " alt="" coords="340,189,326,195,291,215,257,239,207,281,203,277,254,235,288,211,324,190,338,184"/>
<area shape="poly" title=" " alt="" coords="158,272,46,184,50,180,161,268"/>
<area shape="poly" title=" " alt="" coords="348,238,326,245,225,282,223,277,324,240,347,233"/>
<area shape="poly" title=" " alt="" coords="333,280,263,287,263,282,332,274"/>
<area shape="poly" title=" " alt="" coords="334,311,263,303,263,298,335,305"/>
<area shape="poly" title=" " alt="" coords="347,351,324,345,224,309,225,304,326,340,348,346"/>
<area shape="poly" title=" " alt="" coords="337,400,324,394,288,374,254,350,204,308,207,304,257,346,291,369,326,389,340,395"/>
<area shape="poly" title=" " alt="" coords="334,449,324,443,281,411,245,373,197,308,201,305,249,369,285,407,326,439,337,444"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#a553b528011491713b85dc590221ea616" title=" " alt="" coords="103,501,277,527"/>
<area shape="poly" title=" " alt="" coords="360,517,278,517,278,512,360,512"/>
</map>
</div>

</div>
</div>
<a id="aad9943d12261cc0f0cada93cbd6d0704" name="aad9943d12261cc0f0cada93cbd6d0704"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad9943d12261cc0f0cada93cbd6d0704">&#9670;&#160;</a></span>yh_string_to_algo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_string_to_algo </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>string</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55ca">yh_algorithm</a> *</td>          <td class="paramname"><span class="paramname"><em>algo</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Convert a string to an algorithm's numeric value</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">string</td><td>Algorithm as string. See <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55ca">yh_algorithm</a> </td></tr>
    <tr><td class="paramname">algo</td><td>Algorithm numeric value</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> if input parameters are NULL or if the algorithm is not supported by YubiHSM 2.</dd></dl>
<dl class="section user"><dt>Code sample</dt><dd><pre class="fragment">yh_algorithm algorithm;
//yh_string_to_algo(NULL, &amp;algorithm) =&gt; YHR_INVALID_PARAMETERS
//yh_string_to_algo("something", NULL) =&gt; YHR_INVALID_PARAMETERS
//yh_string_to_algo("something", &amp;algorithm) =&gt; YHR_INVALID_PARAMETERS
//yh_string_to_algo("rsa-pkcs1-sha1", &amp;algorithm) =&gt;
</pre> YH_ALGO_RSA_PKCS1_SHA1 //yh_string_to_algo("rsa2048", &amp;algorithm) =&gt; YH_ALGO_RSA_2048</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a href="https://developers.yubico.com/YubiHSM2/Concepts/Algorithms.html">Algorithms</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l04403">4403</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4403</span>                                                                {</div>
<div class="line"><span class="lineno"> 4404</span> </div>
<div class="line"><span class="lineno"> 4405</span>  <span class="keywordflow">if</span> (<span class="keywordtype">string</span> == NULL || algo == NULL) {</div>
<div class="line"><span class="lineno"> 4406</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>));</div>
<div class="line"><span class="lineno"> 4407</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 4408</span>  }</div>
<div class="line"><span class="lineno"> 4409</span>  <span class="keywordflow">if</span> (strcasecmp(<span class="keywordtype">string</span>, <span class="stringliteral">&quot;any&quot;</span>) == 0) {</div>
<div class="line"><span class="lineno"> 4410</span>    *algo = 0;</div>
<div class="line"><span class="lineno"> 4411</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 4412</span>  }</div>
<div class="line"><span class="lineno"> 4413</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <span class="keyword">sizeof</span>(yh_algorithms) / <span class="keyword">sizeof</span>(yh_algorithms[0]);</div>
<div class="line"><span class="lineno"> 4414</span>       i++) {</div>
<div class="line"><span class="lineno"> 4415</span>    <span class="keywordflow">if</span> (strcasecmp(<span class="keywordtype">string</span>, yh_algorithms[i].<a class="code hl_variable" href="catch__reporter__console_8cpp.html#a9b45b3e13bd9167aab02e17e08916231">name</a>) == 0) {</div>
<div class="line"><span class="lineno"> 4416</span>      *algo = yh_algorithms[i].algorithm;</div>
<div class="line"><span class="lineno"> 4417</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 4418</span>    }</div>
<div class="line"><span class="lineno"> 4419</span>  }</div>
<div class="line"><span class="lineno"> 4420</span> </div>
<div class="line"><span class="lineno"> 4421</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 4422</span>}</div>
<div class="ttc" id="acatch__reporter__console_8cpp_html_a9b45b3e13bd9167aab02e17e08916231"><div class="ttname"><a href="catch__reporter__console_8cpp.html#a9b45b3e13bd9167aab02e17e08916231">name</a></div><div class="ttdeci">std::string name</div><div class="ttdef"><b>Definition</b> <a href="catch__reporter__console_8cpp_source.html#l00186">catch_reporter_console.cpp:186</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_aad9943d12261cc0f0cada93cbd6d0704_cgraph.png" border="0" usemap="#ayubihsm_8c_aad9943d12261cc0f0cada93cbd6d0704_cgraph" alt=""/></div>
<map name="ayubihsm_8c_aad9943d12261cc0f0cada93cbd6d0704_cgraph" id="ayubihsm_8c_aad9943d12261cc0f0cada93cbd6d0704_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,129,31"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="177,5,260,31"/>
<area shape="poly" title=" " alt="" coords="129,16,161,16,161,21,129,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_aad9943d12261cc0f0cada93cbd6d0704_icgraph.png" border="0" usemap="#ayubihsm_8c_aad9943d12261cc0f0cada93cbd6d0704_icgraph" alt=""/></div>
<map name="ayubihsm_8c_aad9943d12261cc0f0cada93cbd6d0704_icgraph" id="ayubihsm_8c_aad9943d12261cc0f0cada93cbd6d0704_icgraph">
<area shape="rect" title=" " alt="" coords="411,5,535,31"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,55,31"/>
<area shape="poly" title=" " alt="" coords="396,21,55,21,55,16,396,16"/>
<area shape="rect" href="src_2main_8c.html#a4f0deecffa91ccb37fdf866d83789e8c" title=" " alt="" coords="272,31,363,56"/>
<area shape="poly" title=" " alt="" coords="396,33,364,39,363,33,395,28"/>
<area shape="rect" href="src_2main_8c.html#a29146144eaaaf11f5b49e85d4fe2bd4c" title=" " alt="" coords="103,31,224,56"/>
<area shape="poly" title=" " alt="" coords="257,46,224,46,224,41,257,41"/>
<area shape="poly" title=" " alt="" coords="87,32,55,25,56,20,88,26"/>
</map>
</div>

</div>
</div>
<a id="aab440e1cb671d9ba7a2e7d1243960e42" name="aab440e1cb671d9ba7a2e7d1243960e42"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab440e1cb671d9ba7a2e7d1243960e42">&#9670;&#160;</a></span>yh_string_to_capabilities()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_string_to_capabilities </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>capability</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structyh__capabilities.html">yh_capabilities</a> *</td>          <td class="paramname"><span class="paramname"><em>result</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Convert capability string to byte array</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">capability</td><td>String of capabilities separated by ',', ':' or '|' </td></tr>
    <tr><td class="paramname">result</td><td>Array of <a class="el" href="structyh__capabilities.html" title="Capabilities representation.">yh_capabilities</a></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> if input parameters are NULL. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366ad8971a0b9647564b76b3f4e4b662c965" title="Returned value when there is not enough space to store data.">YHR_BUFFER_TOO_SMALL</a> if <code>capability</code> is too big</dd></dl>
<dl class="section user"><dt>Examples:</dt><dd></dd></dl>
<ul>
<li>"get-opaque" =&gt; {"\x00\x00\x00\x00\x00\x00\x00\x01"}</li>
<li>"sign-hmac:verify-hmac|exportable-under-wrap," =&gt; {"\x00\x00\x00\x00\x00\xc1\x00\x00"}</li>
<li>",,unwrap-data|:wrap-data,,," =&gt; {"\x00\x00\x00\x60\x00\x00\x00\x00"}</li>
<li>"0x7fffffffffffffff" =&gt; {"\x7f\xff\xff\xff\xff\xff\xff\xff"}</li>
<li>"0xffffffffffffffff" =&gt; {"\xff\xff\xff\xff\xff\xff\xff\xff"}</li>
</ul>
<dl class="section see"><dt>See also</dt><dd><a href="https://developers.yubico.com/YubiHSM2/Concepts/Capability.html">Capability</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l04115">4115</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4116</span>                                                         {</div>
<div class="line"><span class="lineno"> 4117</span> </div>
<div class="line"><span class="lineno"> 4118</span>  <span class="keywordtype">char</span> *endptr;</div>
<div class="line"><span class="lineno"> 4119</span>  <span class="keywordtype">char</span> *saveptr = NULL;</div>
<div class="line"><span class="lineno"> 4120</span>  <span class="keywordtype">char</span> *<a class="code hl_variable" href="namespace_c_l_i_1_1detail.html#ab4542375c903302c3876ce0403d55596">str</a> = NULL;</div>
<div class="line"><span class="lineno"> 4121</span>  <span class="keywordtype">char</span> tmp[2048] = {0};</div>
<div class="line"><span class="lineno"> 4122</span>  <a class="code hl_typedef" href="stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a> <a class="code hl_define" href="pkcs11_8h.html#a32aff7c6c4cd253fdf6563677afab5ce">value</a>;</div>
<div class="line"><span class="lineno"> 4123</span> </div>
<div class="line"><span class="lineno"> 4124</span>  <span class="keywordflow">if</span> (capability == NULL || result == NULL) {</div>
<div class="line"><span class="lineno"> 4125</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>));</div>
<div class="line"><span class="lineno"> 4126</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 4127</span>  }</div>
<div class="line"><span class="lineno"> 4128</span> </div>
<div class="line"><span class="lineno"> 4129</span>  errno = 0;</div>
<div class="line"><span class="lineno"> 4130</span>  <a class="code hl_define" href="pkcs11_8h.html#a32aff7c6c4cd253fdf6563677afab5ce">value</a> = strtoull(capability, &amp;endptr, 0);</div>
<div class="line"><span class="lineno"> 4131</span> </div>
<div class="line"><span class="lineno"> 4132</span>  <span class="keywordflow">if</span> (capability != endptr &amp;&amp; errno != ERANGE) {</div>
<div class="line"><span class="lineno"> 4133</span>    <a class="code hl_typedef" href="stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a> actual = <a class="code hl_define" href="#a9f4bf0773c45ad9a9753a1b784a13fbb">htonll</a>(<a class="code hl_define" href="pkcs11_8h.html#a32aff7c6c4cd253fdf6563677afab5ce">value</a>);</div>
<div class="line"><span class="lineno"> 4134</span>    <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(result, &amp;actual, 8);</div>
<div class="line"><span class="lineno"> 4135</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 4136</span>  }</div>
<div class="line"><span class="lineno"> 4137</span> </div>
<div class="line"><span class="lineno"> 4138</span>  <span class="keywordflow">if</span> (strcasecmp(capability, <span class="stringliteral">&quot;all&quot;</span>) == 0) {</div>
<div class="line"><span class="lineno"> 4139</span>    <a class="code hl_function" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105">memset</a>(result-&gt;capabilities, 0xff, <a class="code hl_define" href="yubihsm_8h.html#ad3c904849d17cae0a6f426e8007731d7">YH_CAPABILITIES_LEN</a>);</div>
<div class="line"><span class="lineno"> 4140</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 4141</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcasecmp(capability, <span class="stringliteral">&quot;none&quot;</span>) == 0) {</div>
<div class="line"><span class="lineno"> 4142</span>    <a class="code hl_function" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105">memset</a>(result-&gt;capabilities, 0x00, <a class="code hl_define" href="yubihsm_8h.html#ad3c904849d17cae0a6f426e8007731d7">YH_CAPABILITIES_LEN</a>);</div>
<div class="line"><span class="lineno"> 4143</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 4144</span>  }</div>
<div class="line"><span class="lineno"> 4145</span> </div>
<div class="line"><span class="lineno"> 4146</span>  <span class="keywordflow">if</span> (strlen(capability) &gt; <span class="keyword">sizeof</span>(tmp)) {</div>
<div class="line"><span class="lineno"> 4147</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366ad8971a0b9647564b76b3f4e4b662c965">YHR_BUFFER_TOO_SMALL</a>;</div>
<div class="line"><span class="lineno"> 4148</span>  }</div>
<div class="line"><span class="lineno"> 4149</span>  strncpy(tmp, capability, <span class="keyword">sizeof</span>(tmp) - 1);</div>
<div class="line"><span class="lineno"> 4150</span> </div>
<div class="line"><span class="lineno"> 4151</span>  <span class="keywordflow">while</span> ((str = strtok_r(str ? NULL : tmp, <a class="code hl_define" href="#ab62526d2d58f00a4d33d306db1a39507">LIST_SEPARATORS</a>, &amp;saveptr))) {</div>
<div class="line"><span class="lineno"> 4152</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <span class="keyword">sizeof</span>(yh_capability) / <span class="keyword">sizeof</span>(yh_capability[0]);</div>
<div class="line"><span class="lineno"> 4153</span>         i++) {</div>
<div class="line"><span class="lineno"> 4154</span>      <span class="keywordflow">if</span> (strcasecmp(str, yh_capability[i].<a class="code hl_variable" href="catch__reporter__console_8cpp.html#a9b45b3e13bd9167aab02e17e08916231">name</a>) == 0) {</div>
<div class="line"><span class="lineno"> 4155</span>        result</div>
<div class="line"><span class="lineno"> 4156</span>          -&gt;capabilities[<a class="code hl_define" href="yubihsm_8h.html#ad3c904849d17cae0a6f426e8007731d7">YH_CAPABILITIES_LEN</a> - 1 - yh_capability[i].bit / 8] |=</div>
<div class="line"><span class="lineno"> 4157</span>          1ULL &lt;&lt; (yh_capability[i].bit % 8);</div>
<div class="line"><span class="lineno"> 4158</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4159</span>      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i + 1 == <span class="keyword">sizeof</span>(yh_capability) / <span class="keyword">sizeof</span>(yh_capability[0])) {</div>
<div class="line"><span class="lineno"> 4160</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 4161</span>      }</div>
<div class="line"><span class="lineno"> 4162</span>    }</div>
<div class="line"><span class="lineno"> 4163</span>  }</div>
<div class="line"><span class="lineno"> 4164</span> </div>
<div class="line"><span class="lineno"> 4165</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 4166</span>}</div>
<div class="ttc" id="anamespace_c_l_i_1_1detail_html_ab4542375c903302c3876ce0403d55596"><div class="ttname"><a href="namespace_c_l_i_1_1detail.html#ab4542375c903302c3876ce0403d55596">CLI::detail::str</a></div><div class="ttdeci">return str</div><div class="ttdef"><b>Definition</b> <a href="_c_l_i11_8hpp_source.html#l01359">CLI11.hpp:1359</a></div></div>
<div class="ttc" id="apkcs11_8h_html_a32aff7c6c4cd253fdf6563677afab5ce"><div class="ttname"><a href="pkcs11_8h.html#a32aff7c6c4cd253fdf6563677afab5ce">value</a></div><div class="ttdeci">#define value</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00157">pkcs11.h:157</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_a9f4bf0773c45ad9a9753a1b784a13fbb"><div class="ttname"><a href="#a9f4bf0773c45ad9a9753a1b784a13fbb">htonll</a></div><div class="ttdeci">#define htonll(x)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l04110">yubihsm.c:4110</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_ab62526d2d58f00a4d33d306db1a39507"><div class="ttname"><a href="#ab62526d2d58f00a4d33d306db1a39507">LIST_SEPARATORS</a></div><div class="ttdeci">#define LIST_SEPARATORS</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l00055">yubihsm.c:55</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_aab440e1cb671d9ba7a2e7d1243960e42_cgraph.png" border="0" usemap="#ayubihsm_8c_aab440e1cb671d9ba7a2e7d1243960e42_cgraph" alt=""/></div>
<map name="ayubihsm_8c_aab440e1cb671d9ba7a2e7d1243960e42_cgraph" id="ayubihsm_8c_aab440e1cb671d9ba7a2e7d1243960e42_cgraph">
<area shape="rect" title=" " alt="" coords="5,55,170,80"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="224,5,295,31"/>
<area shape="poly" title=" " alt="" coords="134,51,208,30,209,35,136,57"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="225,55,294,80"/>
<area shape="poly" title=" " alt="" coords="170,65,210,65,210,70,170,70"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="218,104,301,130"/>
<area shape="poly" title=" " alt="" coords="136,78,203,98,202,103,134,84"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_aab440e1cb671d9ba7a2e7d1243960e42_icgraph.png" border="0" usemap="#ayubihsm_8c_aab440e1cb671d9ba7a2e7d1243960e42_icgraph" alt=""/></div>
<map name="ayubihsm_8c_aab440e1cb671d9ba7a2e7d1243960e42_icgraph" id="ayubihsm_8c_aab440e1cb671d9ba7a2e7d1243960e42_icgraph">
<area shape="rect" title=" " alt="" coords="488,205,653,231"/>
<area shape="rect" href="structsysio_1_1wallet_1_1detail_1_1yubihsm__wallet__impl.html#a6266bcd9001ddbb02101bea6088f299b" title=" " alt="" coords="103,160,253,215"/>
<area shape="poly" title=" " alt="" coords="497,204,440,195,343,189,253,188,253,183,343,184,441,190,498,199"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#a9f9c05a4456fb73c13f92b20bbb77898" title=" " alt="" coords="351,55,390,80"/>
<area shape="poly" title=" " alt="" coords="548,195,501,144,471,117,439,94,414,82,390,74,391,69,416,77,442,89,475,113,505,140,552,191"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#a0d58173720fcc1219a584ff8041fdb4c" title=" " alt="" coords="351,104,390,130"/>
<area shape="poly" title=" " alt="" coords="531,200,439,151,389,127,391,123,442,146,533,195"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,356,55,382"/>
<area shape="poly" title=" " alt="" coords="561,247,544,283,518,325,484,365,464,383,442,397,394,417,352,429,314,433,276,432,198,417,102,397,54,382,56,377,103,392,200,412,277,427,314,428,351,424,393,412,439,392,461,378,481,362,514,322,539,280,556,244"/>
<area shape="rect" href="attest_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="346,205,395,231"/>
<area shape="poly" title=" " alt="" coords="473,221,396,221,396,216,473,216"/>
<area shape="rect" href="structsysio_1_1wallet_1_1detail_1_1yubihsm__wallet__impl.html#a00ee0ac7ac4a819d0b8755bf4f442263" title=" " alt="" coords="103,258,253,314"/>
<area shape="poly" title=" " alt="" coords="542,243,497,272,441,295,393,304,344,307,253,302,253,296,344,302,392,299,440,290,494,267,539,238"/>
<area shape="rect" href="src_2main_8c.html#a4f0deecffa91ccb37fdf866d83789e8c" title=" " alt="" coords="325,5,416,31"/>
<area shape="poly" title=" " alt="" coords="554,193,509,119,477,79,439,44,416,32,418,27,442,40,481,75,514,116,559,190"/>
<area shape="rect" href="yubihsm_8c.html#aba384949362ccaf19cbeae3bb046489c" title=" " alt="" coords="301,255,440,280"/>
<area shape="poly" title=" " alt="" coords="501,238,426,257,425,251,500,233"/>
<area shape="rect" href="commands_8c.html#ae2e50929acc6085cd395d0bd4ddb02db" title=" " alt="" coords="302,356,440,382"/>
<area shape="poly" title=" " alt="" coords="549,244,502,291,442,339,407,358,405,353,439,335,498,287,545,240"/>
<area shape="rect" href="src_2main_8c.html#a29146144eaaaf11f5b49e85d4fe2bd4c" title=" " alt="" coords="117,57,238,83"/>
<area shape="poly" title=" " alt="" coords="311,37,229,59,228,54,310,32"/>
<area shape="poly" title=" " alt="" coords="151,95,127,120,105,149,77,206,57,266,36,356,31,355,52,264,72,204,100,146,123,116,147,91"/>
<area shape="poly" title=" " alt="" coords="314,251,300,246,237,218,239,214,302,241,316,246"/>
<area shape="poly" title=" " alt="" coords="286,278,254,282,253,276,285,273"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="105,356,250,382"/>
<area shape="poly" title=" " alt="" coords="286,372,251,372,251,366,286,366"/>
<area shape="poly" title=" " alt="" coords="90,372,55,372,55,366,90,366"/>
</map>
</div>

</div>
</div>
<a id="a96a4c751a281515d5610adb8fd779438" name="a96a4c751a281515d5610adb8fd779438"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96a4c751a281515d5610adb8fd779438">&#9670;&#160;</a></span>yh_string_to_domains()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_string_to_domains </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>domains</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *</td>          <td class="paramname"><span class="paramname"><em>result</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Convert a string to a domain's numeric value.</p>
<p>The domains string can contain one or several domains separated by ',', ':' or '|'. Each domain can be written in decimal or hex format</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">domains</td><td>String of domains </td></tr>
    <tr><td class="paramname">result</td><td>Resulting parsed domains as an unsigned int</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> if input parameters are NULL, if the domains string is does not contains the expected values</dd></dl>
<dl class="section user"><dt>Examples</dt><dd></dd></dl>
<ul>
<li>"1" =&gt; 1</li>
<li>"1,2:3,4|5,6;7,8,9,10,11,12,13,14,15,16" =&gt; 0xffff</li>
<li>"1,16" =&gt; 0x8001</li>
<li>"16" =&gt; 0x8000</li>
<li>"16,15" =&gt; 0xc000</li>
<li>"1,0xf" =&gt; 0x4001</li>
<li>"0x1,0x2" =&gt; 3</li>
<li>"0x8888" =&gt; 0x8888</li>
<li>"0" =&gt; 0</li>
<li>"all" =&gt; 0xffff</li>
<li>"2" =&gt; 2</li>
<li>"2:4" =&gt; 10</li>
</ul>
<dl class="section see"><dt>See also</dt><dd><a href="https://developers.yubico.com/YubiHSM2/Concepts/Domain.html">Domains</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l04535">4535</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4535</span>                                                                  {</div>
<div class="line"><span class="lineno"> 4536</span>  <span class="keywordtype">char</span> *endptr;</div>
<div class="line"><span class="lineno"> 4537</span>  <span class="keywordtype">char</span> *saveptr = NULL;</div>
<div class="line"><span class="lineno"> 4538</span>  <span class="keywordtype">char</span> *<a class="code hl_variable" href="namespace_c_l_i_1_1detail.html#ab4542375c903302c3876ce0403d55596">str</a> = NULL;</div>
<div class="line"><span class="lineno"> 4539</span>  <span class="keywordtype">char</span> tmp[64] = {0};</div>
<div class="line"><span class="lineno"> 4540</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code hl_define" href="pkcs11_8h.html#a32aff7c6c4cd253fdf6563677afab5ce">value</a>;</div>
<div class="line"><span class="lineno"> 4541</span> </div>
<div class="line"><span class="lineno"> 4542</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a5420fd4d2f76428942c2716b1cb7e863">domains</a> == NULL || result == NULL) {</div>
<div class="line"><span class="lineno"> 4543</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>));</div>
<div class="line"><span class="lineno"> 4544</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 4545</span>  }</div>
<div class="line"><span class="lineno"> 4546</span>  *result = 0;</div>
<div class="line"><span class="lineno"> 4547</span> </div>
<div class="line"><span class="lineno"> 4548</span>  <span class="keywordflow">if</span> (strcasecmp(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a5420fd4d2f76428942c2716b1cb7e863">domains</a>, <span class="stringliteral">&quot;all&quot;</span>) == 0) {</div>
<div class="line"><span class="lineno"> 4549</span>    *result = 0xffff;</div>
<div class="line"><span class="lineno"> 4550</span>    <span class="keywordflow">goto</span> out;</div>
<div class="line"><span class="lineno"> 4551</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a5420fd4d2f76428942c2716b1cb7e863">domains</a>, <span class="stringliteral">&quot;0&quot;</span>) == 0) {</div>
<div class="line"><span class="lineno"> 4552</span>    <span class="keywordflow">goto</span> out;</div>
<div class="line"><span class="lineno"> 4553</span>  }</div>
<div class="line"><span class="lineno"> 4554</span> </div>
<div class="line"><span class="lineno"> 4555</span>  errno = 0;</div>
<div class="line"><span class="lineno"> 4556</span>  <a class="code hl_define" href="pkcs11_8h.html#a32aff7c6c4cd253fdf6563677afab5ce">value</a> = strtoul(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a5420fd4d2f76428942c2716b1cb7e863">domains</a>, &amp;endptr, 0);</div>
<div class="line"><span class="lineno"> 4557</span> </div>
<div class="line"><span class="lineno"> 4558</span>  <span class="keywordflow">if</span> (strncmp(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a5420fd4d2f76428942c2716b1cb7e863">domains</a>, <span class="stringliteral">&quot;0x&quot;</span>, 2) == 0 &amp;&amp; *endptr == <span class="charliteral">&#39;\0&#39;</span> &amp;&amp; errno != ERANGE &amp;&amp;</div>
<div class="line"><span class="lineno"> 4559</span>      <a class="code hl_define" href="pkcs11_8h.html#a32aff7c6c4cd253fdf6563677afab5ce">value</a> != ULONG_MAX) {</div>
<div class="line"><span class="lineno"> 4560</span>    <span class="keywordflow">if</span> (<a class="code hl_define" href="pkcs11_8h.html#a32aff7c6c4cd253fdf6563677afab5ce">value</a> &gt; USHRT_MAX) {</div>
<div class="line"><span class="lineno"> 4561</span>      <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Tried to parse to long number for domains&quot;</span>);</div>
<div class="line"><span class="lineno"> 4562</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 4563</span>    }</div>
<div class="line"><span class="lineno"> 4564</span>    *result = <a class="code hl_define" href="pkcs11_8h.html#a32aff7c6c4cd253fdf6563677afab5ce">value</a>;</div>
<div class="line"><span class="lineno"> 4565</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 4566</span>    <span class="keywordflow">if</span> (strlen(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a5420fd4d2f76428942c2716b1cb7e863">domains</a>) &gt; <span class="keyword">sizeof</span>(tmp)) {</div>
<div class="line"><span class="lineno"> 4567</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366ad8971a0b9647564b76b3f4e4b662c965">YHR_BUFFER_TOO_SMALL</a>;</div>
<div class="line"><span class="lineno"> 4568</span>    }</div>
<div class="line"><span class="lineno"> 4569</span>    strncpy(tmp, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a5420fd4d2f76428942c2716b1cb7e863">domains</a>, <span class="keyword">sizeof</span>(tmp) - 1);</div>
<div class="line"><span class="lineno"> 4570</span> </div>
<div class="line"><span class="lineno"> 4571</span>    <span class="keywordflow">while</span> ((str = strtok_r(str ? NULL : tmp, <a class="code hl_define" href="#ab62526d2d58f00a4d33d306db1a39507">LIST_SEPARATORS</a>, &amp;saveptr))) {</div>
<div class="line"><span class="lineno"> 4572</span>      endptr = NULL;</div>
<div class="line"><span class="lineno"> 4573</span>      <a class="code hl_define" href="pkcs11_8h.html#a32aff7c6c4cd253fdf6563677afab5ce">value</a> = strtoul(str, &amp;endptr, 0);</div>
<div class="line"><span class="lineno"> 4574</span>      <span class="keywordflow">if</span> (errno == ERANGE || <a class="code hl_define" href="pkcs11_8h.html#a32aff7c6c4cd253fdf6563677afab5ce">value</a> &gt; <a class="code hl_define" href="yubihsm_8h.html#aedf3b950c50f82299eddf54d0338dd60">YH_MAX_DOMAINS</a> || <a class="code hl_define" href="pkcs11_8h.html#a32aff7c6c4cd253fdf6563677afab5ce">value</a> == 0) {</div>
<div class="line"><span class="lineno"> 4575</span>        <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Domains are numbered from 1 to %d&quot;</span>, <a class="code hl_define" href="yubihsm_8h.html#aedf3b950c50f82299eddf54d0338dd60">YH_MAX_DOMAINS</a>);</div>
<div class="line"><span class="lineno"> 4576</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 4577</span>      }</div>
<div class="line"><span class="lineno"> 4578</span>      *result |= 1 &lt;&lt; (<a class="code hl_define" href="pkcs11_8h.html#a32aff7c6c4cd253fdf6563677afab5ce">value</a> - 1);</div>
<div class="line"><span class="lineno"> 4579</span>    }</div>
<div class="line"><span class="lineno"> 4580</span>  }</div>
<div class="line"><span class="lineno"> 4581</span> </div>
<div class="line"><span class="lineno"> 4582</span>out:</div>
<div class="line"><span class="lineno"> 4583</span>  <a class="code hl_define" href="debug__lib_8h.html#a8c4742440a149ad8bcb5d58ae76c5ed3">DBG_INFO</a>(<span class="stringliteral">&quot;Domains parsed as %x&quot;</span>, *result);</div>
<div class="line"><span class="lineno"> 4584</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 4585</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a96a4c751a281515d5610adb8fd779438_cgraph.png" border="0" usemap="#ayubihsm_8c_a96a4c751a281515d5610adb8fd779438_cgraph" alt=""/></div>
<map name="ayubihsm_8c_a96a4c751a281515d5610adb8fd779438_cgraph" id="ayubihsm_8c_a96a4c751a281515d5610adb8fd779438_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,154,31"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="202,5,285,31"/>
<area shape="poly" title=" " alt="" coords="154,16,186,16,186,21,154,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a96a4c751a281515d5610adb8fd779438_icgraph.png" border="0" usemap="#ayubihsm_8c_a96a4c751a281515d5610adb8fd779438_icgraph" alt=""/></div>
<map name="ayubihsm_8c_a96a4c751a281515d5610adb8fd779438_icgraph" id="ayubihsm_8c_a96a4c751a281515d5610adb8fd779438_icgraph">
<area shape="rect" title=" " alt="" coords="411,22,560,47"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,20,55,46"/>
<area shape="poly" title=" " alt="" coords="416,20,363,12,274,8,187,13,55,31,55,26,186,8,274,3,364,7,417,15"/>
<area shape="rect" href="attest_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="293,22,342,47"/>
<area shape="poly" title=" " alt="" coords="396,37,343,37,343,32,396,32"/>
<area shape="rect" href="src_2main_8c.html#a4f0deecffa91ccb37fdf866d83789e8c" title=" " alt="" coords="272,71,363,97"/>
<area shape="poly" title=" " alt="" coords="426,55,364,73,363,68,424,50"/>
<area shape="rect" href="src_2main_8c.html#a29146144eaaaf11f5b49e85d4fe2bd4c" title=" " alt="" coords="103,46,224,71"/>
<area shape="poly" title=" " alt="" coords="256,77,224,71,225,66,257,71"/>
<area shape="poly" title=" " alt="" coords="87,47,55,40,56,35,88,41"/>
</map>
</div>

</div>
</div>
<a id="a5464c7a6ad858c1e4e42e588b406c2d3" name="a5464c7a6ad858c1e4e42e588b406c2d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5464c7a6ad858c1e4e42e588b406c2d3">&#9670;&#160;</a></span>yh_string_to_option()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_string_to_option </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>string</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm_8h.html#acc8090ce0ec5029b376803e44b1cb4aa">yh_option</a> *</td>          <td class="paramname"><span class="paramname"><em>option</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Convert a string to an option's numeric value</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">string</td><td>Option as string. See <a class="el" href="yubihsm_8h.html#acc8090ce0ec5029b376803e44b1cb4aa">yh_option</a> </td></tr>
    <tr><td class="paramname">option</td><td>Option numeric value</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> if input parameters are NULL or if the option was not recognized.</dd></dl>
<dl class="section user"><dt>Code sample</dt><dd><pre class="fragment">yh_option option;
//yh_string_to_option(NULL, &amp;option) =&gt; YHR_INVALID_PARAMETERS
//yh_string_to_option("something", NULL) =&gt; YHR_INVALID_PARAMETERS
//yh_string_to_option("something", &amp;option) =&gt; YHR_INVALID_PARAMETERS
//yh_string_to_option("force-audit", &amp;option) =&gt;
</pre> option=YH_OPTION_FORCE_AUDIT</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a href="https://developers.yubico.com/YubiHSM2/Concepts/Options.html">Options</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l04463">4463</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4463</span>                                                                 {</div>
<div class="line"><span class="lineno"> 4464</span> </div>
<div class="line"><span class="lineno"> 4465</span>  <span class="keywordflow">if</span> (<span class="keywordtype">string</span> == NULL || <a class="code hl_variable" href="yubihsm_8h.html#a023826538a428f5f8c53aaef5e9aec02">option</a> == NULL) {</div>
<div class="line"><span class="lineno"> 4466</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>));</div>
<div class="line"><span class="lineno"> 4467</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 4468</span>  }</div>
<div class="line"><span class="lineno"> 4469</span> </div>
<div class="line"><span class="lineno"> 4470</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <span class="keyword">sizeof</span>(yh_options) / <span class="keyword">sizeof</span>(yh_options[0]); i++) {</div>
<div class="line"><span class="lineno"> 4471</span>    <span class="keywordflow">if</span> (strcasecmp(<span class="keywordtype">string</span>, yh_options[i].<a class="code hl_variable" href="catch__reporter__console_8cpp.html#a9b45b3e13bd9167aab02e17e08916231">name</a>) == 0) {</div>
<div class="line"><span class="lineno"> 4472</span>      *<a class="code hl_variable" href="yubihsm_8h.html#a023826538a428f5f8c53aaef5e9aec02">option</a> = yh_options[i].option;</div>
<div class="line"><span class="lineno"> 4473</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 4474</span>    }</div>
<div class="line"><span class="lineno"> 4475</span>  }</div>
<div class="line"><span class="lineno"> 4476</span> </div>
<div class="line"><span class="lineno"> 4477</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 4478</span>}</div>
<div class="ttc" id="ayubihsm_8h_html_a023826538a428f5f8c53aaef5e9aec02"><div class="ttname"><a href="yubihsm_8h.html#a023826538a428f5f8c53aaef5e9aec02">option</a></div><div class="ttdeci">yh_option option</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00685">yubihsm.h:685</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a5464c7a6ad858c1e4e42e588b406c2d3_cgraph.png" border="0" usemap="#ayubihsm_8c_a5464c7a6ad858c1e4e42e588b406c2d3_cgraph" alt=""/></div>
<map name="ayubihsm_8c_a5464c7a6ad858c1e4e42e588b406c2d3_cgraph" id="ayubihsm_8c_a5464c7a6ad858c1e4e42e588b406c2d3_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,140,31"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="188,5,271,31"/>
<area shape="poly" title=" " alt="" coords="140,16,172,16,172,21,140,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a5464c7a6ad858c1e4e42e588b406c2d3_icgraph.png" border="0" usemap="#ayubihsm_8c_a5464c7a6ad858c1e4e42e588b406c2d3_icgraph" alt=""/></div>
<map name="ayubihsm_8c_a5464c7a6ad858c1e4e42e588b406c2d3_icgraph" id="ayubihsm_8c_a5464c7a6ad858c1e4e42e588b406c2d3_icgraph">
<area shape="rect" title=" " alt="" coords="411,5,546,31"/>
<area shape="rect" href="src_2main_8c.html#a4f0deecffa91ccb37fdf866d83789e8c" title=" " alt="" coords="272,5,363,31"/>
<area shape="poly" title=" " alt="" coords="396,21,364,21,364,16,396,16"/>
<area shape="rect" href="src_2main_8c.html#a29146144eaaaf11f5b49e85d4fe2bd4c" title=" " alt="" coords="103,5,224,31"/>
<area shape="poly" title=" " alt="" coords="257,21,224,21,224,16,257,16"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,55,31"/>
<area shape="poly" title=" " alt="" coords="87,21,55,21,55,16,87,16"/>
</map>
</div>

</div>
</div>
<a id="a57cdfa4b6224bd2c4a8bab24513475d8" name="a57cdfa4b6224bd2c4a8bab24513475d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a57cdfa4b6224bd2c4a8bab24513475d8">&#9670;&#160;</a></span>yh_string_to_type()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_string_to_type </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>string</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583">yh_object_type</a> *</td>          <td class="paramname"><span class="paramname"><em>type</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Convert a string to a type's numeric value</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">string</td><td>Type as a String. See <a class="el" href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583">yh_object_type</a> </td></tr>
    <tr><td class="paramname">type</td><td>Type numeric value</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> if input parameters are NULL or if the type was not recognized.</dd></dl>
<dl class="section user"><dt>Code sample</dt><dd><pre class="fragment">yh_object_type type;
//yh_string_to_type(NULL, &amp;type) =&gt; YHR_INVALID_PARAMETERS
//yh_string_to_type("something", NULL) =&gt; YHR_INVALID_PARAMETERS
//yh_string_to_type("something", &amp;type) =&gt; YHR_INVALID_PARAMETERS
//yh_string_to_type("opaque", &amp;type) =&gt; type=YH_OPAQUE
//yh_string_to_type("authentication-key", &amp;type) =&gt;
</pre> type=YH_AUTHENTICATION_KEY</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a href="https://developers.yubico.com/YubiHSM2/Concepts/Object.html">Object</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l04442">4442</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4442</span>                                                                  {</div>
<div class="line"><span class="lineno"> 4443</span> </div>
<div class="line"><span class="lineno"> 4444</span>  <span class="keywordflow">if</span> (<span class="keywordtype">string</span> == NULL || type == NULL) {</div>
<div class="line"><span class="lineno"> 4445</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>));</div>
<div class="line"><span class="lineno"> 4446</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 4447</span>  }</div>
<div class="line"><span class="lineno"> 4448</span> </div>
<div class="line"><span class="lineno"> 4449</span>  <span class="keywordflow">if</span> (strcasecmp(<span class="keywordtype">string</span>, <span class="stringliteral">&quot;any&quot;</span>) == 0) {</div>
<div class="line"><span class="lineno"> 4450</span>    *type = 0;</div>
<div class="line"><span class="lineno"> 4451</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 4452</span>  }</div>
<div class="line"><span class="lineno"> 4453</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <span class="keyword">sizeof</span>(yh_types) / <span class="keyword">sizeof</span>(yh_types[0]); i++) {</div>
<div class="line"><span class="lineno"> 4454</span>    <span class="keywordflow">if</span> (strcasecmp(<span class="keywordtype">string</span>, yh_types[i].<a class="code hl_variable" href="catch__reporter__console_8cpp.html#a9b45b3e13bd9167aab02e17e08916231">name</a>) == 0) {</div>
<div class="line"><span class="lineno"> 4455</span>      *type = yh_types[i].type;</div>
<div class="line"><span class="lineno"> 4456</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 4457</span>    }</div>
<div class="line"><span class="lineno"> 4458</span>  }</div>
<div class="line"><span class="lineno"> 4459</span> </div>
<div class="line"><span class="lineno"> 4460</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 4461</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a57cdfa4b6224bd2c4a8bab24513475d8_cgraph.png" border="0" usemap="#ayubihsm_8c_a57cdfa4b6224bd2c4a8bab24513475d8_cgraph" alt=""/></div>
<map name="ayubihsm_8c_a57cdfa4b6224bd2c4a8bab24513475d8_cgraph" id="ayubihsm_8c_a57cdfa4b6224bd2c4a8bab24513475d8_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,130,31"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="178,5,261,31"/>
<area shape="poly" title=" " alt="" coords="130,16,162,16,162,21,130,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a57cdfa4b6224bd2c4a8bab24513475d8_icgraph.png" border="0" usemap="#ayubihsm_8c_a57cdfa4b6224bd2c4a8bab24513475d8_icgraph" alt=""/></div>
<map name="ayubihsm_8c_a57cdfa4b6224bd2c4a8bab24513475d8_icgraph" id="ayubihsm_8c_a57cdfa4b6224bd2c4a8bab24513475d8_icgraph">
<area shape="rect" title=" " alt="" coords="411,5,536,31"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,55,31"/>
<area shape="poly" title=" " alt="" coords="396,21,55,21,55,16,396,16"/>
<area shape="rect" href="src_2main_8c.html#a4f0deecffa91ccb37fdf866d83789e8c" title=" " alt="" coords="272,31,363,56"/>
<area shape="poly" title=" " alt="" coords="396,33,364,39,363,33,395,28"/>
<area shape="rect" href="src_2main_8c.html#a29146144eaaaf11f5b49e85d4fe2bd4c" title=" " alt="" coords="103,31,224,56"/>
<area shape="poly" title=" " alt="" coords="257,46,224,46,224,41,257,41"/>
<area shape="poly" title=" " alt="" coords="87,32,55,25,56,20,88,26"/>
</map>
</div>

</div>
</div>
<a id="afe3d701f7470c1d7b05480e4b6728bf7" name="afe3d701f7470c1d7b05480e4b6728bf7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe3d701f7470c1d7b05480e4b6728bf7">&#9670;&#160;</a></span>yh_type_to_string()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_type_to_string </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583">yh_object_type</a></td>          <td class="paramname"><span class="paramname"><em>type</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char const **</td>          <td class="paramname"><span class="paramname"><em>result</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Convert a <a class="el" href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583">yh_object_type</a> to its string representation</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">type</td><td>Type to convert. See <a class="el" href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583">yh_object_type</a> </td></tr>
    <tr><td class="paramname">result</td><td>The type as a String. "Unknown" if the type was not recognized</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> if <code>result</code> is NULL.</dd></dl>
<dl class="section user"><dt>Code sample</dt><dd><pre class="fragment">const char *string;
//yh_type_to_string(0, NULL) =&gt; YHR_INVALID_PARAMETERS
//yh_type_to_string(99, &amp;string) =&gt; string="Unknown"
//yh_type_to_string(YH_OPAQUE, &amp;string) =&gt; string="opaque"
//yh_type_to_string(YH_AUTHENTICATION_KEY, &amp;string) =&gt;
</pre> string="authentication-key"</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a href="https://developers.yubico.com/YubiHSM2/Concepts/Object.html">Object</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l04424">4424</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4424</span>                                                                  {</div>
<div class="line"><span class="lineno"> 4425</span> </div>
<div class="line"><span class="lineno"> 4426</span>  <span class="keywordflow">if</span> (result == NULL) {</div>
<div class="line"><span class="lineno"> 4427</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>));</div>
<div class="line"><span class="lineno"> 4428</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 4429</span>  }</div>
<div class="line"><span class="lineno"> 4430</span> </div>
<div class="line"><span class="lineno"> 4431</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <span class="keyword">sizeof</span>(yh_types) / <span class="keyword">sizeof</span>(yh_types[0]); i++) {</div>
<div class="line"><span class="lineno"> 4432</span>    <span class="keywordflow">if</span> (type == yh_types[i].type) {</div>
<div class="line"><span class="lineno"> 4433</span>      *result = yh_types[i].name;</div>
<div class="line"><span class="lineno"> 4434</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 4435</span>    }</div>
<div class="line"><span class="lineno"> 4436</span>  }</div>
<div class="line"><span class="lineno"> 4437</span> </div>
<div class="line"><span class="lineno"> 4438</span>  *result = <span class="stringliteral">&quot;Unknown&quot;</span>;</div>
<div class="line"><span class="lineno"> 4439</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 4440</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_afe3d701f7470c1d7b05480e4b6728bf7_cgraph.png" border="0" usemap="#ayubihsm_8c_afe3d701f7470c1d7b05480e4b6728bf7_cgraph" alt=""/></div>
<map name="ayubihsm_8c_afe3d701f7470c1d7b05480e4b6728bf7_cgraph" id="ayubihsm_8c_afe3d701f7470c1d7b05480e4b6728bf7_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,130,31"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="178,5,261,31"/>
<area shape="poly" title=" " alt="" coords="130,16,162,16,162,21,130,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_afe3d701f7470c1d7b05480e4b6728bf7_icgraph.png" border="0" usemap="#ayubihsm_8c_afe3d701f7470c1d7b05480e4b6728bf7_icgraph" alt=""/></div>
<map name="ayubihsm_8c_afe3d701f7470c1d7b05480e4b6728bf7_icgraph" id="ayubihsm_8c_afe3d701f7470c1d7b05480e4b6728bf7_icgraph">
<area shape="rect" title=" " alt="" coords="506,60,631,86"/>
<area shape="rect" href="commands_8c.html#afa7330c81148ba6f4d5c53f7c370ed41" title=" " alt="" coords="296,11,458,36"/>
<area shape="poly" title=" " alt="" coords="500,58,429,40,431,35,501,53"/>
<area shape="rect" href="commands_8c.html#a2b752129687a9ca758661e0b6625b59c" title=" " alt="" coords="307,60,447,86"/>
<area shape="poly" title=" " alt="" coords="491,76,448,76,448,70,491,70"/>
<area shape="rect" href="commands_8c.html#a6b74f2d2d47796c2432a15cd63183dd1" title=" " alt="" coords="303,109,451,135"/>
<area shape="poly" title=" " alt="" coords="501,93,431,111,429,106,500,88"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,35,248,60"/>
<area shape="poly" title=" " alt="" coords="281,38,249,42,248,36,280,32"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,60,55,86"/>
<area shape="poly" title=" " alt="" coords="280,12,193,10,147,14,104,25,72,41,46,62,43,57,69,37,102,20,147,9,193,4,281,6"/>
<area shape="poly" title=" " alt="" coords="88,66,55,71,54,66,87,60"/>
<area shape="poly" title=" " alt="" coords="292,65,248,59,249,54,292,60"/>
<area shape="poly" title=" " alt="" coords="291,76,55,76,55,70,291,70"/>
<area shape="poly" title=" " alt="" coords="312,107,295,101,205,63,207,59,297,96,314,102"/>
<area shape="poly" title=" " alt="" coords="287,112,55,79,55,74,288,107"/>
</map>
</div>

</div>
</div>
<a id="ad112fe09ee88d595333fa87e8059717b" name="ad112fe09ee88d595333fa87e8059717b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad112fe09ee88d595333fa87e8059717b">&#9670;&#160;</a></span>yh_util_blink_device()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_util_blink_device </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__session.html">yh_session</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a></td>          <td class="paramname"><span class="paramname"><em>seconds</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Blink the LED of the device to identify it</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>Authenticated session to use </td></tr>
    <tr><td class="paramname">seconds</td><td>Number of seconds to blink</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> if the session is NULL. See <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> for other possible errors </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l03766">3766</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3766</span>                                                                 {</div>
<div class="line"><span class="lineno"> 3767</span> </div>
<div class="line"><span class="lineno"> 3768</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a> == NULL) {</div>
<div class="line"><span class="lineno"> 3769</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>));</div>
<div class="line"><span class="lineno"> 3770</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 3771</span>  }</div>
<div class="line"><span class="lineno"> 3772</span> </div>
<div class="line"><span class="lineno"> 3773</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 3774</span> </div>
<div class="line"><span class="lineno"> 3775</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> response[5];</div>
<div class="line"><span class="lineno"> 3776</span>  <span class="keywordtype">size_t</span> response_len = <span class="keyword">sizeof</span>(response);</div>
<div class="line"><span class="lineno"> 3777</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7e">yh_cmd</a> response_cmd;</div>
<div class="line"><span class="lineno"> 3778</span> </div>
<div class="line"><span class="lineno"> 3779</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="#a4c26f003b72e800e9c934bca922a404a">yh_send_secure_msg</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, YHC_BLINK_DEVICE, &amp;seconds, <span class="keyword">sizeof</span>(seconds),</div>
<div class="line"><span class="lineno"> 3780</span>                           &amp;response_cmd, response, &amp;response_len);</div>
<div class="line"><span class="lineno"> 3781</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 3782</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Failed to send BLINK DEVICE command: %s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 3783</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 3784</span>  }</div>
<div class="line"><span class="lineno"> 3785</span> </div>
<div class="line"><span class="lineno"> 3786</span>  <span class="keywordflow">if</span> (response_cmd == <a class="code hl_enumvalue" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7ea51cdf2ccd6995498e589e8ea6ce2a1f2">YHC_ERROR</a>) {</div>
<div class="line"><span class="lineno"> 3787</span>    <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> translated = translate_device_error(response[0]);</div>
<div class="line"><span class="lineno"> 3788</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Unable to blink the device: %s (%x)&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(translated),</div>
<div class="line"><span class="lineno"> 3789</span>            response[0]);</div>
<div class="line"><span class="lineno"> 3790</span>    <span class="keywordflow">return</span> translated;</div>
<div class="line"><span class="lineno"> 3791</span>  }</div>
<div class="line"><span class="lineno"> 3792</span> </div>
<div class="line"><span class="lineno"> 3793</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 3794</span>}</div>
<div class="ttc" id="ayubihsm_8c_html_a4c26f003b72e800e9c934bca922a404a"><div class="ttname"><a href="#a4c26f003b72e800e9c934bca922a404a">yh_send_secure_msg</a></div><div class="ttdeci">yh_rc yh_send_secure_msg(yh_session *session, yh_cmd cmd, const uint8_t *data, size_t data_len, yh_cmd *response_cmd, uint8_t *response, size_t *response_len)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l00416">yubihsm.c:416</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_aa5415bafa9c48dfef0e183d8df504b7e"><div class="ttname"><a href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7e">yh_cmd</a></div><div class="ttdeci">yh_cmd</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00243">yubihsm.h:243</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_aa5415bafa9c48dfef0e183d8df504b7ea51cdf2ccd6995498e589e8ea6ce2a1f2"><div class="ttname"><a href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7ea51cdf2ccd6995498e589e8ea6ce2a1f2">YHC_ERROR</a></div><div class="ttdeci">@ YHC_ERROR</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00348">yubihsm.h:348</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_ad112fe09ee88d595333fa87e8059717b_cgraph.png" border="0" usemap="#ayubihsm_8c_ad112fe09ee88d595333fa87e8059717b_cgraph" alt=""/></div>
<map name="ayubihsm_8c_ad112fe09ee88d595333fa87e8059717b_cgraph" id="ayubihsm_8c_ad112fe09ee88d595333fa87e8059717b_cgraph">
<area shape="rect" title=" " alt="" coords="5,129,144,155"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="192,104,340,130"/>
<area shape="poly" title=" " alt="" coords="144,130,176,126,177,131,144,136"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="611,153,695,179"/>
<area shape="poly" title=" " alt="" coords="144,142,596,161,596,167,144,148"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="388,55,553,80"/>
<area shape="poly" title=" " alt="" coords="322,101,399,82,400,87,323,106"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="406,104,536,130"/>
<area shape="poly" title=" " alt="" coords="340,114,390,114,390,120,340,120"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="617,55,689,80"/>
<area shape="poly" title=" " alt="" coords="554,65,602,65,602,70,554,70"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="619,5,687,31"/>
<area shape="poly" title=" " alt="" coords="520,51,603,29,605,34,522,57"/>
<area shape="poly" title=" " alt="" coords="532,79,555,89,570,102,580,114,589,127,603,140,608,143,605,148,600,144,585,131,576,118,567,106,552,94,530,83"/>
<area shape="poly" title=" " alt="" coords="520,101,602,78,603,84,522,106"/>
<area shape="poly" title=" " alt="" coords="522,128,597,148,596,154,520,133"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="601,104,705,130"/>
<area shape="poly" title=" " alt="" coords="536,114,586,114,586,120,536,120"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_ad112fe09ee88d595333fa87e8059717b_icgraph.png" border="0" usemap="#ayubihsm_8c_ad112fe09ee88d595333fa87e8059717b_icgraph" alt=""/></div>
<map name="ayubihsm_8c_ad112fe09ee88d595333fa87e8059717b_icgraph" id="ayubihsm_8c_ad112fe09ee88d595333fa87e8059717b_icgraph">
<area shape="rect" title=" " alt="" coords="445,31,584,56"/>
<area shape="rect" href="commands_8c.html#a1d821476693df49671598a98e7d6dbca" title=" " alt="" coords="296,31,397,56"/>
<area shape="poly" title=" " alt="" coords="430,46,398,46,398,41,430,41"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="280,36,248,32,249,26,281,31"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,31,55,56"/>
<area shape="poly" title=" " alt="" coords="280,46,55,46,55,41,280,41"/>
<area shape="poly" title=" " alt="" coords="88,36,55,42,54,37,87,31"/>
</map>
</div>

</div>
</div>
<a id="a8f229874e387887d7c5b4c7e6e07db8e" name="a8f229874e387887d7c5b4c7e6e07db8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f229874e387887d7c5b4c7e6e07db8e">&#9670;&#160;</a></span>yh_util_change_authentication_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_util_change_authentication_key </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__session.html">yh_session</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *</td>          <td class="paramname"><span class="paramname"><em>key_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>key_enc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>key_enc_len</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>key_mac</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>key_mac_len</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Replace the long lived encryption key and MAC key associated with an <a class="el" href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583acee44b775b3c5b6157f0732699935074" title="Authentication Key is used to establish Sessions with a device.">YH_AUTHENTICATION_KEY</a> in the device</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>Authenticated session to use </td></tr>
    <tr><td class="paramname">key_id</td><td>Object ID of the key to replace </td></tr>
    <tr><td class="paramname">key_enc</td><td>New long lived encryption key </td></tr>
    <tr><td class="paramname">key_enc_len</td><td>Length of the new encryption key. Must be <a class="el" href="yubihsm_8h.html#ac2737b2a34c26d0258d25e34993df391" title="Length of authentication keys.">YH_KEY_LEN</a> </td></tr>
    <tr><td class="paramname">key_mac</td><td>New long lived MAC key </td></tr>
    <tr><td class="paramname">key_mac_len</td><td>Length of the new MAC key. Must be <a class="el" href="yubihsm_8h.html#ac2737b2a34c26d0258d25e34993df391" title="Length of authentication keys.">YH_KEY_LEN</a></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> if input parameters are NULL or if <code>key_enc_len</code> or <code>key_mac_len</code> are not the expected values. See <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> for other possible errors</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a href="https://developers.yubico.com/YubiHSM2/Concepts/Object.html">Authentication Key</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l03094">3094</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3098</span>                                                            {</div>
<div class="line"><span class="lineno"> 3099</span> </div>
<div class="line"><span class="lineno"> 3100</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a> == NULL || <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a> == NULL || key_enc == NULL ||</div>
<div class="line"><span class="lineno"> 3101</span>      key_enc_len != <a class="code hl_define" href="yubihsm_8h.html#ac2737b2a34c26d0258d25e34993df391">YH_KEY_LEN</a> || key_mac == NULL ||</div>
<div class="line"><span class="lineno"> 3102</span>      key_mac_len != <a class="code hl_define" href="yubihsm_8h.html#ac2737b2a34c26d0258d25e34993df391">YH_KEY_LEN</a>) {</div>
<div class="line"><span class="lineno"> 3103</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>));</div>
<div class="line"><span class="lineno"> 3104</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 3105</span>  }</div>
<div class="line"><span class="lineno"> 3106</span> </div>
<div class="line"><span class="lineno"> 3107</span><span class="preprocessor">#pragma pack(push, 1)</span></div>
<div class="line"><span class="lineno"> 3108</span>  <span class="keyword">union </span>{</div>
<div class="line"><span class="lineno"> 3109</span>    <span class="keyword">struct </span>{</div>
<div class="line"><span class="lineno"> 3110</span>      <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>;</div>
<div class="line"><span class="lineno"> 3111</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>;</div>
<div class="line"><span class="lineno"> 3112</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> key_enc[<a class="code hl_define" href="yubihsm_8h.html#ac2737b2a34c26d0258d25e34993df391">YH_KEY_LEN</a>];</div>
<div class="line"><span class="lineno"> 3113</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> key_mac[<a class="code hl_define" href="yubihsm_8h.html#ac2737b2a34c26d0258d25e34993df391">YH_KEY_LEN</a>];</div>
<div class="line"><span class="lineno"> 3114</span>    };</div>
<div class="line"><span class="lineno"> 3115</span>    <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a855e99b645b13e7905d074d02fe0bff5">buf</a>[1];</div>
<div class="line"><span class="lineno"> 3116</span>  } data;</div>
<div class="line"><span class="lineno"> 3117</span>  <span class="keyword">union </span>{</div>
<div class="line"><span class="lineno"> 3118</span>    <span class="keyword">struct </span>{</div>
<div class="line"><span class="lineno"> 3119</span>      <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>;</div>
<div class="line"><span class="lineno"> 3120</span>    };</div>
<div class="line"><span class="lineno"> 3121</span>    <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a855e99b645b13e7905d074d02fe0bff5">buf</a>[1];</div>
<div class="line"><span class="lineno"> 3122</span>  } response;</div>
<div class="line"><span class="lineno"> 3123</span><span class="preprocessor">#pragma pack(pop)</span></div>
<div class="line"><span class="lineno"> 3124</span>  <span class="keywordtype">size_t</span> response_len = <span class="keyword">sizeof</span>(response);</div>
<div class="line"><span class="lineno"> 3125</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7e">yh_cmd</a> response_cmd;</div>
<div class="line"><span class="lineno"> 3126</span> </div>
<div class="line"><span class="lineno"> 3127</span>  data.key_id = htons(*<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>);</div>
<div class="line"><span class="lineno"> 3128</span>  data.algorithm = <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa461952ba18e7fcd792e480f71c853513">YH_ALGO_AES128_YUBICO_AUTHENTICATION</a>;</div>
<div class="line"><span class="lineno"> 3129</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(data.key_enc, key_enc, key_enc_len);</div>
<div class="line"><span class="lineno"> 3130</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(data.key_mac, key_mac, key_mac_len);</div>
<div class="line"><span class="lineno"> 3131</span> </div>
<div class="line"><span class="lineno"> 3132</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="#a4c26f003b72e800e9c934bca922a404a">yh_send_secure_msg</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, YHC_CHANGE_AUTHENTICATION_KEY,</div>
<div class="line"><span class="lineno"> 3133</span>                                 data.buf, <span class="keyword">sizeof</span>(data), &amp;response_cmd,</div>
<div class="line"><span class="lineno"> 3134</span>                                 response.buf, &amp;response_len);</div>
<div class="line"><span class="lineno"> 3135</span>  <a class="code hl_define" href="insecure__memzero_8h.html#a0794f9275fd1036ecba6ff0a901a320b">insecure_memzero</a>(data.buf, <span class="keyword">sizeof</span>(data));</div>
<div class="line"><span class="lineno"> 3136</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 3137</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Failed to send CHANGE AUTHENTICATION KEY command: %s\n&quot;</span>,</div>
<div class="line"><span class="lineno"> 3138</span>            <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 3139</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 3140</span>  }</div>
<div class="line"><span class="lineno"> 3141</span> </div>
<div class="line"><span class="lineno"> 3142</span>  <span class="keywordflow">if</span> (response_cmd == <a class="code hl_enumvalue" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7ea51cdf2ccd6995498e589e8ea6ce2a1f2">YHC_ERROR</a>) {</div>
<div class="line"><span class="lineno"> 3143</span>    <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> translated = translate_device_error(response.buf[0]);</div>
<div class="line"><span class="lineno"> 3144</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Unable to change authentication key: %s (%x)\n&quot;</span>,</div>
<div class="line"><span class="lineno"> 3145</span>            <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(translated), response.buf[0]);</div>
<div class="line"><span class="lineno"> 3146</span>    <span class="keywordflow">return</span> translated;</div>
<div class="line"><span class="lineno"> 3147</span>  }</div>
<div class="line"><span class="lineno"> 3148</span> </div>
<div class="line"><span class="lineno"> 3149</span>  *<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a> = ntohs(response.key_id);</div>
<div class="line"><span class="lineno"> 3150</span>  <a class="code hl_define" href="debug__lib_8h.html#a8c4742440a149ad8bcb5d58ae76c5ed3">DBG_INFO</a>(<span class="stringliteral">&quot;Changed Authentication key 0x%04x&quot;</span>, *<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>);</div>
<div class="line"><span class="lineno"> 3151</span> </div>
<div class="line"><span class="lineno"> 3152</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 3153</span>}</div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caa461952ba18e7fcd792e480f71c853513"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa461952ba18e7fcd792e480f71c853513">YH_ALGO_AES128_YUBICO_AUTHENTICATION</a></div><div class="ttdeci">@ YH_ALGO_AES128_YUBICO_AUTHENTICATION</div><div class="ttdoc">aes128-yubico-authentication</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00466">yubihsm.h:466</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a855e99b645b13e7905d074d02fe0bff5"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a855e99b645b13e7905d074d02fe0bff5">buf</a></div><div class="ttdeci">uint8_t buf[2048]</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l04770">yubihsm_pkcs11.c:4770</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_ada12860f8f9f5f3cac5b179ef352434c"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a></div><div class="ttdeci">uint16_t key_id</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l01104">yubihsm_pkcs11.c:1104</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a8f229874e387887d7c5b4c7e6e07db8e_cgraph.png" border="0" usemap="#ayubihsm_8c_a8f229874e387887d7c5b4c7e6e07db8e_cgraph" alt=""/></div>
<map name="ayubihsm_8c_a8f229874e387887d7c5b4c7e6e07db8e_cgraph" id="ayubihsm_8c_a8f229874e387887d7c5b4c7e6e07db8e_cgraph">
<area shape="rect" title=" " alt="" coords="5,80,230,106"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="703,5,775,31"/>
<area shape="poly" title=" " alt="" coords="200,77,277,65,474,40,688,19,688,25,474,45,278,70,201,82"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="278,80,426,106"/>
<area shape="poly" title=" " alt="" coords="230,90,262,90,262,96,230,96"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="697,104,781,130"/>
<area shape="poly" title=" " alt="" coords="176,104,265,121,380,137,509,146,575,145,639,140,682,131,683,136,640,145,575,150,509,151,380,143,264,126,175,109"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="474,55,639,80"/>
<area shape="poly" title=" " alt="" coords="426,81,458,77,459,82,426,86"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="492,104,622,130"/>
<area shape="poly" title=" " alt="" coords="426,99,477,105,476,110,426,104"/>
<area shape="poly" title=" " alt="" coords="606,51,688,29,689,34,608,57"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="705,55,773,80"/>
<area shape="poly" title=" " alt="" coords="640,65,689,65,689,70,640,70"/>
<area shape="poly" title=" " alt="" coords="608,78,683,99,682,104,606,84"/>
<area shape="poly" title=" " alt="" coords="616,101,638,91,653,79,662,67,671,54,686,40,691,37,694,41,689,44,675,57,666,70,656,83,641,95,618,106"/>
<area shape="poly" title=" " alt="" coords="622,114,682,114,682,120,622,120"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="687,153,791,179"/>
<area shape="poly" title=" " alt="" coords="608,128,675,146,673,151,606,133"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a8f229874e387887d7c5b4c7e6e07db8e_icgraph.png" border="0" usemap="#ayubihsm_8c_a8f229874e387887d7c5b4c7e6e07db8e_icgraph" alt=""/></div>
<map name="ayubihsm_8c_a8f229874e387887d7c5b4c7e6e07db8e_icgraph" id="ayubihsm_8c_a8f229874e387887d7c5b4c7e6e07db8e_icgraph">
<area shape="rect" title=" " alt="" coords="821,31,1045,56"/>
<area shape="rect" href="yubihsm_8c.html#a8761bd8bcffcee4af737bda255ce5e53" title=" " alt="" coords="576,23,773,64"/>
<area shape="poly" title=" " alt="" coords="805,46,773,46,773,41,805,41"/>
<area shape="rect" href="change__authkey_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="388,5,437,31"/>
<area shape="poly" title=" " alt="" coords="561,35,437,23,438,18,561,30"/>
<area shape="rect" href="commands_8c.html#a0691ab03bd0e40402b2ad5f9a378a541" title=" " alt="" coords="296,55,528,80"/>
<area shape="poly" title=" " alt="" coords="561,57,529,59,529,54,560,51"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,55,248,80"/>
<area shape="poly" title=" " alt="" coords="280,70,248,70,248,65,280,65"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,55,55,80"/>
<area shape="poly" title=" " alt="" coords="87,70,55,70,55,65,87,65"/>
</map>
</div>

</div>
</div>
<a id="a8761bd8bcffcee4af737bda255ce5e53" name="a8761bd8bcffcee4af737bda255ce5e53"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8761bd8bcffcee4af737bda255ce5e53">&#9670;&#160;</a></span>yh_util_change_authentication_key_derived()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_util_change_authentication_key_derived </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__session.html">yh_session</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *</td>          <td class="paramname"><span class="paramname"><em>key_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>password</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>password_len</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Replace the long lived encryption key and MAC key associated with an <a class="el" href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583acee44b775b3c5b6157f0732699935074" title="Authentication Key is used to establish Sessions with a device.">YH_AUTHENTICATION_KEY</a> in the device with keys derived from a password</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>Authenticated session to use </td></tr>
    <tr><td class="paramname">key_id</td><td>Object ID of the key to replace </td></tr>
    <tr><td class="paramname">password</td><td>Password to derive the new encryption key and MAC key </td></tr>
    <tr><td class="paramname">password_len</td><td>Length of password</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> if input parameters are NULL. See <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> for other possible errors</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a href="https://developers.yubico.com/YubiHSM2/Concepts/Object.html">Authentication Key</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l03155">3155</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3158</span>                                                                     {</div>
<div class="line"><span class="lineno"> 3159</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a> == NULL || <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a> == NULL || password == NULL) {</div>
<div class="line"><span class="lineno"> 3160</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>));</div>
<div class="line"><span class="lineno"> 3161</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 3162</span>  }</div>
<div class="line"><span class="lineno"> 3163</span> </div>
<div class="line"><span class="lineno"> 3164</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> key_enc[<a class="code hl_define" href="scp_8h.html#a25905234f13446437b28c85d0504216d">SCP_KEY_LEN</a>];</div>
<div class="line"><span class="lineno"> 3165</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> key_mac[<a class="code hl_define" href="scp_8h.html#a25905234f13446437b28c85d0504216d">SCP_KEY_LEN</a>];</div>
<div class="line"><span class="lineno"> 3166</span> </div>
<div class="line"><span class="lineno"> 3167</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = derive_keys(password, password_len, key_enc, key_mac);</div>
<div class="line"><span class="lineno"> 3168</span> </div>
<div class="line"><span class="lineno"> 3169</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> == <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 3170</span>    <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="#a8f229874e387887d7c5b4c7e6e07db8e">yh_util_change_authentication_key</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>, key_enc,</div>
<div class="line"><span class="lineno"> 3171</span>                                            <span class="keyword">sizeof</span>(key_enc), key_mac,</div>
<div class="line"><span class="lineno"> 3172</span>                                            <span class="keyword">sizeof</span>(key_mac));</div>
<div class="line"><span class="lineno"> 3173</span>    <a class="code hl_define" href="insecure__memzero_8h.html#a0794f9275fd1036ecba6ff0a901a320b">insecure_memzero</a>(key_enc, <span class="keyword">sizeof</span>(key_enc));</div>
<div class="line"><span class="lineno"> 3174</span>    <a class="code hl_define" href="insecure__memzero_8h.html#a0794f9275fd1036ecba6ff0a901a320b">insecure_memzero</a>(key_mac, <span class="keyword">sizeof</span>(key_mac));</div>
<div class="line"><span class="lineno"> 3175</span>  }</div>
<div class="line"><span class="lineno"> 3176</span>  <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 3177</span>}</div>
<div class="ttc" id="ayubihsm_8c_html_a8f229874e387887d7c5b4c7e6e07db8e"><div class="ttname"><a href="#a8f229874e387887d7c5b4c7e6e07db8e">yh_util_change_authentication_key</a></div><div class="ttdeci">yh_rc yh_util_change_authentication_key(yh_session *session, uint16_t *key_id, const uint8_t *key_enc, size_t key_enc_len, const uint8_t *key_mac, size_t key_mac_len)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l03094">yubihsm.c:3094</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a8761bd8bcffcee4af737bda255ce5e53_cgraph.png" border="0" usemap="#ayubihsm_8c_a8761bd8bcffcee4af737bda255ce5e53_cgraph" alt=""/></div>
<map name="ayubihsm_8c_a8761bd8bcffcee4af737bda255ce5e53_cgraph" id="ayubihsm_8c_a8761bd8bcffcee4af737bda255ce5e53_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,202,46"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="942,14,1025,40"/>
<area shape="poly" title=" " alt="" coords="202,21,718,12,801,10,884,12,927,16,926,22,884,18,801,16,718,18,202,26"/>
<area shape="rect" href="yubihsm_8c.html#a8f229874e387887d7c5b4c7e6e07db8e" title=" " alt="" coords="250,38,474,64"/>
<area shape="poly" title=" " alt="" coords="202,33,234,36,234,41,202,38"/>
<area shape="poly" title=" " alt="" coords="474,44,926,27,926,32,475,49"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="948,113,1019,138"/>
<area shape="poly" title=" " alt="" coords="404,62,523,99,622,128,701,148,781,155,883,148,933,138,934,143,884,154,781,161,701,153,621,134,521,104,402,67"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="522,64,670,89"/>
<area shape="poly" title=" " alt="" coords="475,61,507,64,506,69,474,66"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="718,64,884,89"/>
<area shape="poly" title=" " alt="" coords="670,74,703,74,703,79,670,79"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="736,113,866,138"/>
<area shape="poly" title=" " alt="" coords="653,87,730,106,729,111,652,92"/>
<area shape="poly" title=" " alt="" coords="851,60,926,40,927,45,852,65"/>
<area shape="poly" title=" " alt="" coords="852,87,933,110,932,115,851,92"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="949,64,1018,89"/>
<area shape="poly" title=" " alt="" coords="884,74,934,74,934,79,884,79"/>
<area shape="poly" title=" " alt="" coords="861,110,882,99,897,88,906,76,915,63,930,49,935,46,938,50,933,53,919,66,910,79,901,91,885,104,863,115"/>
<area shape="poly" title=" " alt="" coords="867,123,933,123,933,128,867,128"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="932,162,1035,188"/>
<area shape="poly" title=" " alt="" coords="852,137,919,155,917,160,851,142"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a8761bd8bcffcee4af737bda255ce5e53_icgraph.png" border="0" usemap="#ayubihsm_8c_a8761bd8bcffcee4af737bda255ce5e53_icgraph" alt=""/></div>
<map name="ayubihsm_8c_a8761bd8bcffcee4af737bda255ce5e53_icgraph" id="ayubihsm_8c_a8761bd8bcffcee4af737bda255ce5e53_icgraph">
<area shape="rect" title=" " alt="" coords="576,23,773,64"/>
<area shape="rect" href="change__authkey_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="388,5,437,31"/>
<area shape="poly" title=" " alt="" coords="561,35,437,23,438,18,561,30"/>
<area shape="rect" href="commands_8c.html#a0691ab03bd0e40402b2ad5f9a378a541" title=" " alt="" coords="296,55,528,80"/>
<area shape="poly" title=" " alt="" coords="561,57,529,59,529,54,560,51"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,55,248,80"/>
<area shape="poly" title=" " alt="" coords="280,70,248,70,248,65,280,65"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,55,55,80"/>
<area shape="poly" title=" " alt="" coords="87,70,55,70,55,65,87,65"/>
</map>
</div>

</div>
</div>
<a id="a61ab8dbab67b1cceb49cd306f8c3f4b1" name="a61ab8dbab67b1cceb49cd306f8c3f4b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a61ab8dbab67b1cceb49cd306f8c3f4b1">&#9670;&#160;</a></span>yh_util_close_session()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_util_close_session </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__session.html">yh_session</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Close a session</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>Session to close</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> if the session is NULL. See <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> for other possible errors </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l01257">1257</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1257</span>                                                 {</div>
<div class="line"><span class="lineno"> 1258</span> </div>
<div class="line"><span class="lineno"> 1259</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a> == NULL) {</div>
<div class="line"><span class="lineno"> 1260</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>));</div>
<div class="line"><span class="lineno"> 1261</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 1262</span>  }</div>
<div class="line"><span class="lineno"> 1263</span> </div>
<div class="line"><span class="lineno"> 1264</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 1265</span> </div>
<div class="line"><span class="lineno"> 1266</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> response[5];</div>
<div class="line"><span class="lineno"> 1267</span>  <span class="keywordtype">size_t</span> response_len = <span class="keyword">sizeof</span>(response);</div>
<div class="line"><span class="lineno"> 1268</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7e">yh_cmd</a> response_cmd;</div>
<div class="line"><span class="lineno"> 1269</span> </div>
<div class="line"><span class="lineno"> 1270</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="#a4c26f003b72e800e9c934bca922a404a">yh_send_secure_msg</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, YHC_CLOSE_SESSION, NULL, 0, &amp;response_cmd,</div>
<div class="line"><span class="lineno"> 1271</span>                           response, &amp;response_len);</div>
<div class="line"><span class="lineno"> 1272</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 1273</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Failed to send CLOSE SESSION command: %s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 1274</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 1275</span>  }</div>
<div class="line"><span class="lineno"> 1276</span> </div>
<div class="line"><span class="lineno"> 1277</span>  <span class="keywordflow">if</span> (response_cmd == <a class="code hl_enumvalue" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7ea51cdf2ccd6995498e589e8ea6ce2a1f2">YHC_ERROR</a>) {</div>
<div class="line"><span class="lineno"> 1278</span>    <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> translated = translate_device_error(response[0]);</div>
<div class="line"><span class="lineno"> 1279</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Unable to close session: %s (%x)&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(translated),</div>
<div class="line"><span class="lineno"> 1280</span>            response[0]);</div>
<div class="line"><span class="lineno"> 1281</span>    <span class="keywordflow">return</span> translated;</div>
<div class="line"><span class="lineno"> 1282</span>  }</div>
<div class="line"><span class="lineno"> 1283</span> </div>
<div class="line"><span class="lineno"> 1284</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 1285</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a61ab8dbab67b1cceb49cd306f8c3f4b1_cgraph.png" border="0" usemap="#ayubihsm_8c_a61ab8dbab67b1cceb49cd306f8c3f4b1_cgraph" alt=""/></div>
<map name="ayubihsm_8c_a61ab8dbab67b1cceb49cd306f8c3f4b1_cgraph" id="ayubihsm_8c_a61ab8dbab67b1cceb49cd306f8c3f4b1_cgraph">
<area shape="rect" title=" " alt="" coords="5,129,155,155"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="203,104,351,130"/>
<area shape="poly" title=" " alt="" coords="155,130,187,126,188,131,156,135"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="622,153,706,179"/>
<area shape="poly" title=" " alt="" coords="155,143,607,161,607,167,155,148"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="399,55,564,80"/>
<area shape="poly" title=" " alt="" coords="333,101,410,82,411,87,334,106"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="416,104,547,130"/>
<area shape="poly" title=" " alt="" coords="351,114,401,114,401,120,351,120"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="628,55,700,80"/>
<area shape="poly" title=" " alt="" coords="565,65,613,65,613,70,565,70"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="630,5,698,31"/>
<area shape="poly" title=" " alt="" coords="531,51,614,29,616,34,533,57"/>
<area shape="poly" title=" " alt="" coords="543,79,566,89,581,102,591,114,600,127,614,140,619,143,616,148,611,144,596,131,587,118,578,106,563,94,541,83"/>
<area shape="poly" title=" " alt="" coords="531,101,613,78,614,84,533,106"/>
<area shape="poly" title=" " alt="" coords="533,128,608,148,607,154,531,133"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="612,104,716,130"/>
<area shape="poly" title=" " alt="" coords="547,114,597,114,597,120,547,120"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a61ab8dbab67b1cceb49cd306f8c3f4b1_icgraph.png" border="0" usemap="#ayubihsm_8c_a61ab8dbab67b1cceb49cd306f8c3f4b1_icgraph" alt=""/></div>
<map name="ayubihsm_8c_a61ab8dbab67b1cceb49cd306f8c3f4b1_icgraph" id="ayubihsm_8c_a61ab8dbab67b1cceb49cd306f8c3f4b1_icgraph">
<area shape="rect" title=" " alt="" coords="641,343,791,369"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#a48d97eeb2196fb96be0f0ba4c82d5063" title=" " alt="" coords="415,158,589,183"/>
<area shape="poly" title=" " alt="" coords="699,330,658,263,627,227,592,197,572,186,574,182,595,192,631,223,662,260,704,328"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae42be1463b17c635f1d1db61afc0db16" title=" " alt="" coords="415,207,589,233"/>
<area shape="poly" title=" " alt="" coords="692,333,649,288,622,265,592,246,568,236,570,231,595,241,625,261,653,284,696,329"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#a011b512f4b9e6e43e3ab56b5534f3fde" title=" " alt="" coords="415,256,589,282"/>
<area shape="poly" title=" " alt="" coords="677,338,592,297,557,285,559,280,594,292,679,333"/>
<area shape="rect" href="structsysio_1_1wallet_1_1detail_1_1yubihsm__wallet__impl.html#a5920ace754a2d851bdb11322372b849c" title=" " alt="" coords="411,306,593,347"/>
<area shape="poly" title=" " alt="" coords="626,346,593,342,594,336,626,341"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="56,426,105,451"/>
<area shape="poly" title=" " alt="" coords="626,370,106,438,105,433,625,365"/>
<area shape="rect" href="attest_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="478,422,527,447"/>
<area shape="poly" title=" " alt="" coords="668,377,594,405,528,429,526,424,592,400,666,372"/>
<area shape="rect" href="commands_8c.html#ae2e50929acc6085cd395d0bd4ddb02db" title=" " alt="" coords="433,471,571,497"/>
<area shape="poly" title=" " alt="" coords="694,382,651,423,595,462,569,473,567,468,592,457,647,419,691,378"/>
<area shape="rect" href="commands_8c.html#aabb06b0c16a19b4b22478cb753d8f599" title=" " alt="" coords="424,520,581,546"/>
<area shape="poly" title=" " alt="" coords="703,384,661,448,630,482,595,511,573,522,571,517,592,507,627,479,656,445,699,381"/>
<area shape="rect" href="structsysio_1_1wallet_1_1detail_1_1yubihsm__wallet__impl.html#a6266bcd9001ddbb02101bea6088f299b" title=" " alt="" coords="208,5,358,61"/>
<area shape="poly" title=" " alt="" coords="410,297,409,296,390,268,381,240,380,212,382,185,385,158,384,131,377,103,361,75,350,64,354,60,365,72,382,101,390,130,390,158,388,186,385,212,387,239,395,265,413,293,414,294"/>
<area shape="rect" href="structsysio_1_1wallet_1_1detail_1_1yubihsm__wallet__impl.html#a6412f92a0ad381f2370582372a5b6082" title=" " alt="" coords="204,109,363,165"/>
<area shape="poly" title=" " alt="" coords="412,299,409,296,397,282,389,268,383,241,377,214,361,186,341,168,344,164,365,182,382,212,388,240,394,266,401,279,413,293,416,295"/>
<area shape="rect" href="structsysio_1_1wallet_1_1detail_1_1yubihsm__wallet__impl.html#a00ee0ac7ac4a819d0b8755bf4f442263" title=" " alt="" coords="5,143,156,198"/>
<area shape="poly" title=" " alt="" coords="414,300,409,297,393,279,385,262,377,245,362,230,326,215,273,202,156,182,156,177,274,197,327,210,364,226,381,242,390,259,398,276,413,292,417,296"/>
<area shape="rect" href="structsysio_1_1wallet_1_1detail_1_1yubihsm__wallet__impl.html#a8987016445813c0391f04894e9bdb002" title=" " alt="" coords="208,240,358,296"/>
<area shape="poly" title=" " alt="" coords="409,304,358,291,360,285,410,299"/>
<area shape="rect" href="structsysio_1_1wallet_1_1detail_1_1yubihsm__wallet__impl.html#af535b22a76cac37f33ef43715865648c" title=" " alt="" coords="204,320,362,376"/>
<area shape="poly" title=" " alt="" coords="395,340,363,343,363,337,395,334"/>
<area shape="poly" title=" " alt="" coords="315,97,303,90,283,88,266,90,254,95,249,101,249,109,243,109,244,99,251,90,264,85,283,83,305,85,318,92"/>
<area shape="poly" title=" " alt="" coords="189,155,157,161,156,155,188,150"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="211,471,356,497"/>
<area shape="poly" title=" " alt="" coords="417,486,356,486,356,481,417,481"/>
<area shape="poly" title=" " alt="" coords="207,470,105,446,106,441,208,464"/>
<area shape="poly" title=" " alt="" coords="426,519,343,500,344,495,428,514"/>
</map>
</div>

</div>
</div>
<a id="a82d295a02d9eb628f6dea4b4c01fdec4" name="a82d295a02d9eb628f6dea4b4c01fdec4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a82d295a02d9eb628f6dea4b4c01fdec4">&#9670;&#160;</a></span>yh_util_create_otp_aead()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_util_create_otp_aead </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__session.html">yh_session</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a></td>          <td class="paramname"><span class="paramname"><em>key_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>key</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>private_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>out</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *</td>          <td class="paramname"><span class="paramname"><em>out_len</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create a Yubico OTP AEAD using the provided data</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>Authenticated session to use </td></tr>
    <tr><td class="paramname">key_id</td><td>Object ID of the Otp-aead Key to use </td></tr>
    <tr><td class="paramname">key</td><td>OTP key </td></tr>
    <tr><td class="paramname">private_id</td><td>OTP private id </td></tr>
    <tr><td class="paramname">out</td><td>The created AEAD </td></tr>
    <tr><td class="paramname">out_len</td><td>Length of the created AEAD</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> if input parameters are NULL. See <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> for other possible errors </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l03179">3179</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3181</span>                                                             {</div>
<div class="line"><span class="lineno"> 3182</span> </div>
<div class="line"><span class="lineno"> 3183</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a> == NULL || key == NULL || private_id == NULL || out == NULL ||</div>
<div class="line"><span class="lineno"> 3184</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a565e4b6f63fecad4c290b50ee6684ee3">out_len</a> == NULL) {</div>
<div class="line"><span class="lineno"> 3185</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>));</div>
<div class="line"><span class="lineno"> 3186</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 3187</span>  }</div>
<div class="line"><span class="lineno"> 3188</span><span class="preprocessor">#pragma pack(push, 1)</span></div>
<div class="line"><span class="lineno"> 3189</span>  <span class="keyword">union </span>{</div>
<div class="line"><span class="lineno"> 3190</span>    <span class="keyword">struct </span>{</div>
<div class="line"><span class="lineno"> 3191</span>      <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>;</div>
<div class="line"><span class="lineno"> 3192</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> key[16];</div>
<div class="line"><span class="lineno"> 3193</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> private_id[6];</div>
<div class="line"><span class="lineno"> 3194</span>    };</div>
<div class="line"><span class="lineno"> 3195</span>    <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a855e99b645b13e7905d074d02fe0bff5">buf</a>[1];</div>
<div class="line"><span class="lineno"> 3196</span>  } data;</div>
<div class="line"><span class="lineno"> 3197</span><span class="preprocessor">#pragma pack(pop)</span></div>
<div class="line"><span class="lineno"> 3198</span> </div>
<div class="line"><span class="lineno"> 3199</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7e">yh_cmd</a> response_cmd;</div>
<div class="line"><span class="lineno"> 3200</span> </div>
<div class="line"><span class="lineno"> 3201</span>  data.key_id = htons(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>);</div>
<div class="line"><span class="lineno"> 3202</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(data.key, key, <span class="keyword">sizeof</span>(data.key));</div>
<div class="line"><span class="lineno"> 3203</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(data.private_id, private_id, <span class="keyword">sizeof</span>(data.private_id));</div>
<div class="line"><span class="lineno"> 3204</span> </div>
<div class="line"><span class="lineno"> 3205</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="#a4c26f003b72e800e9c934bca922a404a">yh_send_secure_msg</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, YHC_CREATE_OTP_AEAD, data.buf,</div>
<div class="line"><span class="lineno"> 3206</span>                                 <span class="keyword">sizeof</span>(data), &amp;response_cmd, out, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a565e4b6f63fecad4c290b50ee6684ee3">out_len</a>);</div>
<div class="line"><span class="lineno"> 3207</span>  <a class="code hl_define" href="insecure__memzero_8h.html#a0794f9275fd1036ecba6ff0a901a320b">insecure_memzero</a>(data.buf, <span class="keyword">sizeof</span>(data));</div>
<div class="line"><span class="lineno"> 3208</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 3209</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Failed to send CREATE OTP AEAD command: %s\n&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 3210</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 3211</span>  }</div>
<div class="line"><span class="lineno"> 3212</span> </div>
<div class="line"><span class="lineno"> 3213</span>  <span class="keywordflow">if</span> (response_cmd == <a class="code hl_enumvalue" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7ea51cdf2ccd6995498e589e8ea6ce2a1f2">YHC_ERROR</a>) {</div>
<div class="line"><span class="lineno"> 3214</span>    <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> translated = translate_device_error(out[0]);</div>
<div class="line"><span class="lineno"> 3215</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Unable to get OTP AEAD: %s (%x)\n&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(translated),</div>
<div class="line"><span class="lineno"> 3216</span>            out[0]);</div>
<div class="line"><span class="lineno"> 3217</span>    <span class="keywordflow">return</span> translated;</div>
<div class="line"><span class="lineno"> 3218</span>  }</div>
<div class="line"><span class="lineno"> 3219</span> </div>
<div class="line"><span class="lineno"> 3220</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 3221</span>}</div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a565e4b6f63fecad4c290b50ee6684ee3"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a565e4b6f63fecad4c290b50ee6684ee3">out_len</a></div><div class="ttdeci">size_t out_len</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l05000">yubihsm_pkcs11.c:5000</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a82d295a02d9eb628f6dea4b4c01fdec4_cgraph.png" border="0" usemap="#ayubihsm_8c_a82d295a02d9eb628f6dea4b4c01fdec4_cgraph" alt=""/></div>
<map name="ayubihsm_8c_a82d295a02d9eb628f6dea4b4c01fdec4_cgraph" id="ayubihsm_8c_a82d295a02d9eb628f6dea4b4c01fdec4_cgraph">
<area shape="rect" title=" " alt="" coords="5,80,168,106"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="641,5,713,31"/>
<area shape="poly" title=" " alt="" coords="151,77,215,65,444,35,625,19,626,24,445,41,216,70,152,82"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="216,80,364,106"/>
<area shape="poly" title=" " alt="" coords="168,90,200,90,200,96,168,96"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="635,104,719,130"/>
<area shape="poly" title=" " alt="" coords="151,104,216,116,317,133,396,145,476,148,577,140,620,131,621,136,578,145,476,153,396,150,316,138,215,121,150,109"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="412,55,577,80"/>
<area shape="poly" title=" " alt="" coords="364,81,396,77,397,82,364,86"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="430,104,560,130"/>
<area shape="poly" title=" " alt="" coords="364,99,415,105,414,110,364,104"/>
<area shape="poly" title=" " alt="" coords="544,51,626,29,627,34,546,57"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="643,55,711,80"/>
<area shape="poly" title=" " alt="" coords="578,65,627,65,627,70,578,70"/>
<area shape="poly" title=" " alt="" coords="546,78,621,99,620,104,544,84"/>
<area shape="poly" title=" " alt="" coords="554,101,576,91,591,79,600,67,609,54,624,40,629,37,632,41,627,44,613,57,604,70,594,83,579,95,556,106"/>
<area shape="poly" title=" " alt="" coords="560,114,620,114,620,120,560,120"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="625,153,729,179"/>
<area shape="poly" title=" " alt="" coords="546,128,613,146,611,151,544,133"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a82d295a02d9eb628f6dea4b4c01fdec4_icgraph.png" border="0" usemap="#ayubihsm_8c_a82d295a02d9eb628f6dea4b4c01fdec4_icgraph" alt=""/></div>
<map name="ayubihsm_8c_a82d295a02d9eb628f6dea4b4c01fdec4_icgraph" id="ayubihsm_8c_a82d295a02d9eb628f6dea4b4c01fdec4_icgraph">
<area shape="rect" title=" " alt="" coords="514,55,677,80"/>
<area shape="rect" href="yubico__otp_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="356,5,406,31"/>
<area shape="poly" title=" " alt="" coords="521,53,405,26,407,21,522,48"/>
<area shape="rect" href="commands_8c.html#ae2e50929acc6085cd395d0bd4ddb02db" title=" " alt="" coords="312,55,450,80"/>
<area shape="poly" title=" " alt="" coords="499,70,451,70,451,65,499,65"/>
<area shape="rect" href="commands_8c.html#ae716e54fae7ba83cb44fe966fbcad9cb" title=" " alt="" coords="296,104,466,130"/>
<area shape="poly" title=" " alt="" coords="522,87,441,106,440,101,521,82"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,80,248,106"/>
<area shape="poly" title=" " alt="" coords="297,81,249,87,248,81,296,75"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,80,55,106"/>
<area shape="poly" title=" " alt="" coords="87,96,55,96,55,90,87,90"/>
<area shape="poly" title=" " alt="" coords="280,108,248,104,249,99,281,102"/>
</map>
</div>

</div>
</div>
<a id="aa939f8764ed0cca27884d9c8f640ac14" name="aa939f8764ed0cca27884d9c8f640ac14"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa939f8764ed0cca27884d9c8f640ac14">&#9670;&#160;</a></span>yh_util_decrypt_oaep()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_util_decrypt_oaep </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__session.html">yh_session</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a></td>          <td class="paramname"><span class="paramname"><em>key_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>in</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>in_len</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>out</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *</td>          <td class="paramname"><span class="paramname"><em>out_len</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>label</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>label_len</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55ca">yh_algorithm</a></td>          <td class="paramname"><span class="paramname"><em>mgf1Algo</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Decrypt data using RSA-OAEP</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>Authenticated session to use </td></tr>
    <tr><td class="paramname">key_id</td><td>Object ID of the RSA key to use for decryption </td></tr>
    <tr><td class="paramname">in</td><td>Encrypted data </td></tr>
    <tr><td class="paramname">in_len</td><td>Length of encrypted data. Must be 256, 384 or 512 </td></tr>
    <tr><td class="paramname">out</td><td>Decrypted data </td></tr>
    <tr><td class="paramname">out_len</td><td>Length of decrypted data </td></tr>
    <tr><td class="paramname">label</td><td>OAEP label </td></tr>
    <tr><td class="paramname">label_len</td><td>Length of OAEP label. Must be 20, 32, 48 or 64 </td></tr>
    <tr><td class="paramname">mgf1Algo</td><td>MGF1 algorithm</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> input parameters are NULL. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366ae0b26dcb22aa228ab08c9e59a8975952">YHR_WRONG_LENGTH</a> if <code>in_len</code> or <code>label_len</code> are not what expected. See <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> for other possible errors </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l02107">2107</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2110</span>                                                                    {</div>
<div class="line"><span class="lineno"> 2111</span> </div>
<div class="line"><span class="lineno"> 2112</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a> == NULL || in == NULL || out == NULL || <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a565e4b6f63fecad4c290b50ee6684ee3">out_len</a> == NULL ||</div>
<div class="line"><span class="lineno"> 2113</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> == NULL) {</div>
<div class="line"><span class="lineno"> 2114</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>));</div>
<div class="line"><span class="lineno"> 2115</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 2116</span>  }</div>
<div class="line"><span class="lineno"> 2117</span> </div>
<div class="line"><span class="lineno"> 2118</span><span class="preprocessor">#pragma pack(push, 1)</span></div>
<div class="line"><span class="lineno"> 2119</span>  <span class="keyword">union </span>{</div>
<div class="line"><span class="lineno"> 2120</span>    <span class="keyword">struct </span>{</div>
<div class="line"><span class="lineno"> 2121</span>      <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>;</div>
<div class="line"><span class="lineno"> 2122</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> mgf1Algo;</div>
<div class="line"><span class="lineno"> 2123</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#ac6f5a1f1e061f000983f5d5f3ac25dfa">bytes</a>[<a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a>];</div>
<div class="line"><span class="lineno"> 2124</span>    };</div>
<div class="line"><span class="lineno"> 2125</span>    <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a855e99b645b13e7905d074d02fe0bff5">buf</a>[1];</div>
<div class="line"><span class="lineno"> 2126</span>  } data;</div>
<div class="line"><span class="lineno"> 2127</span><span class="preprocessor">#pragma pack(pop)</span></div>
<div class="line"><span class="lineno"> 2128</span> </div>
<div class="line"><span class="lineno"> 2129</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7e">yh_cmd</a> response_cmd;</div>
<div class="line"><span class="lineno"> 2130</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 2131</span>  <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> = 0;</div>
<div class="line"><span class="lineno"> 2132</span> </div>
<div class="line"><span class="lineno"> 2133</span>  data.key_id = htons(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>);</div>
<div class="line"><span class="lineno"> 2134</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> += <span class="keyword">sizeof</span>(data.key_id);</div>
<div class="line"><span class="lineno"> 2135</span> </div>
<div class="line"><span class="lineno"> 2136</span>  data.mgf1Algo = mgf1Algo;</div>
<div class="line"><span class="lineno"> 2137</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> += <span class="keyword">sizeof</span>(data.mgf1Algo);</div>
<div class="line"><span class="lineno"> 2138</span> </div>
<div class="line"><span class="lineno"> 2139</span>  <span class="comment">// in_len has to match the rsa key size</span></div>
<div class="line"><span class="lineno"> 2140</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a> != 256 &amp;&amp; <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a> != 384 &amp;&amp; <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a> != 512) {</div>
<div class="line"><span class="lineno"> 2141</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Wrong input length&quot;</span>);</div>
<div class="line"><span class="lineno"> 2142</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366ae0b26dcb22aa228ab08c9e59a8975952">YHR_WRONG_LENGTH</a>;</div>
<div class="line"><span class="lineno"> 2143</span>  }</div>
<div class="line"><span class="lineno"> 2144</span> </div>
<div class="line"><span class="lineno"> 2145</span>  <span class="comment">// label_len is hashed and specified the mgf hash</span></div>
<div class="line"><span class="lineno"> 2146</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ae76ac4adc41ec92427b4a14cd3385c1b">label_len</a> != 20 &amp;&amp; <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ae76ac4adc41ec92427b4a14cd3385c1b">label_len</a> != 32 &amp;&amp; <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ae76ac4adc41ec92427b4a14cd3385c1b">label_len</a> != 48 &amp;&amp;</div>
<div class="line"><span class="lineno"> 2147</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ae76ac4adc41ec92427b4a14cd3385c1b">label_len</a> != 64) {</div>
<div class="line"><span class="lineno"> 2148</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Wrong label length&quot;</span>);</div>
<div class="line"><span class="lineno"> 2149</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366ae0b26dcb22aa228ab08c9e59a8975952">YHR_WRONG_LENGTH</a>;</div>
<div class="line"><span class="lineno"> 2150</span>  }</div>
<div class="line"><span class="lineno"> 2151</span> </div>
<div class="line"><span class="lineno"> 2152</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(data.bytes, in, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a>);</div>
<div class="line"><span class="lineno"> 2153</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> += <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a>;</div>
<div class="line"><span class="lineno"> 2154</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(data.bytes + <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a>, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ae76ac4adc41ec92427b4a14cd3385c1b">label_len</a>);</div>
<div class="line"><span class="lineno"> 2155</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> += <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ae76ac4adc41ec92427b4a14cd3385c1b">label_len</a>;</div>
<div class="line"><span class="lineno"> 2156</span> </div>
<div class="line"><span class="lineno"> 2157</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="#a4c26f003b72e800e9c934bca922a404a">yh_send_secure_msg</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, YHC_DECRYPT_OAEP, data.buf, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>,</div>
<div class="line"><span class="lineno"> 2158</span>                           &amp;response_cmd, out, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a565e4b6f63fecad4c290b50ee6684ee3">out_len</a>);</div>
<div class="line"><span class="lineno"> 2159</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 2160</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Failed to send DECRYPT OAEP command: %s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 2161</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 2162</span>  }</div>
<div class="line"><span class="lineno"> 2163</span> </div>
<div class="line"><span class="lineno"> 2164</span>  <span class="keywordflow">if</span> (response_cmd == <a class="code hl_enumvalue" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7ea51cdf2ccd6995498e589e8ea6ce2a1f2">YHC_ERROR</a>) {</div>
<div class="line"><span class="lineno"> 2165</span>    <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> translated = translate_device_error(out[0]);</div>
<div class="line"><span class="lineno"> 2166</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Unable to get decrypted data: %s (%x)&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(translated),</div>
<div class="line"><span class="lineno"> 2167</span>            out[0]);</div>
<div class="line"><span class="lineno"> 2168</span>    <span class="keywordflow">return</span> translated;</div>
<div class="line"><span class="lineno"> 2169</span>  }</div>
<div class="line"><span class="lineno"> 2170</span> </div>
<div class="line"><span class="lineno"> 2171</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 2172</span>}</div>
<div class="ttc" id="anamespacesysio_1_1chain_html_ac6f5a1f1e061f000983f5d5f3ac25dfa"><div class="ttname"><a href="namespacesysio_1_1chain.html#ac6f5a1f1e061f000983f5d5f3ac25dfa">sysio::chain::bytes</a></div><div class="ttdeci">vector&lt; char &gt; bytes</div><div class="ttdef"><b>Definition</b> <a href="chain_2include_2sysio_2chain_2types_8hpp_source.html#l00243">types.hpp:243</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a706bd8e7adf0de85e6cfb0efc8981d3f"><div class="ttname"><a href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a></div><div class="ttdeci">#define YH_MSG_BUF_SIZE</div><div class="ttdoc">Maximum length of message buffer.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00093">yubihsm.h:93</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a22f45a3cb4f074e609f58ebaeef0ecf9"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a></div><div class="ttdeci">char * label</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l01883">yubihsm_pkcs11.c:1883</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a7360b55975153b822efc5217b7734e6a"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a></div><div class="ttdeci">size_t len</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l04771">yubihsm_pkcs11.c:4771</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_ae76ac4adc41ec92427b4a14cd3385c1b"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#ae76ac4adc41ec92427b4a14cd3385c1b">label_len</a></div><div class="ttdeci">size_t label_len</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l04938">yubihsm_pkcs11.c:4938</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_af352138fec1245efdaee143f770c01ef"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a></div><div class="ttdeci">size_t in_len</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l04978">yubihsm_pkcs11.c:4978</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_aa939f8764ed0cca27884d9c8f640ac14_cgraph.png" border="0" usemap="#ayubihsm_8c_aa939f8764ed0cca27884d9c8f640ac14_cgraph" alt=""/></div>
<map name="ayubihsm_8c_aa939f8764ed0cca27884d9c8f640ac14_cgraph" id="ayubihsm_8c_aa939f8764ed0cca27884d9c8f640ac14_cgraph">
<area shape="rect" title=" " alt="" coords="5,80,150,106"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="623,5,695,31"/>
<area shape="poly" title=" " alt="" coords="137,77,197,65,312,48,426,35,607,19,608,24,427,40,313,53,198,70,138,82"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="198,80,346,106"/>
<area shape="poly" title=" " alt="" coords="150,90,182,90,182,96,150,96"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="617,104,701,130"/>
<area shape="poly" title=" " alt="" coords="137,104,198,116,299,133,378,145,458,148,559,140,602,131,603,136,560,145,458,153,378,150,298,139,197,121,136,109"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="394,55,559,80"/>
<area shape="poly" title=" " alt="" coords="346,81,378,77,379,82,346,86"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="412,104,542,130"/>
<area shape="poly" title=" " alt="" coords="346,99,397,105,396,110,346,104"/>
<area shape="poly" title=" " alt="" coords="526,51,608,29,609,34,528,57"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="625,55,693,80"/>
<area shape="poly" title=" " alt="" coords="560,65,609,65,609,70,560,70"/>
<area shape="poly" title=" " alt="" coords="528,78,603,99,602,104,526,84"/>
<area shape="poly" title=" " alt="" coords="536,101,558,91,573,79,582,67,591,54,606,40,611,37,614,41,609,44,595,57,586,70,576,83,561,95,538,106"/>
<area shape="poly" title=" " alt="" coords="542,114,602,114,602,120,542,120"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="607,153,711,179"/>
<area shape="poly" title=" " alt="" coords="528,128,595,146,593,151,526,133"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_aa939f8764ed0cca27884d9c8f640ac14_icgraph.png" border="0" usemap="#ayubihsm_8c_aa939f8764ed0cca27884d9c8f640ac14_icgraph" alt=""/></div>
<map name="ayubihsm_8c_aa939f8764ed0cca27884d9c8f640ac14_icgraph" id="ayubihsm_8c_aa939f8764ed0cca27884d9c8f640ac14_icgraph">
<area shape="rect" title=" " alt="" coords="496,55,641,80"/>
<area shape="rect" href="decrypt__rsa_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="348,5,397,31"/>
<area shape="poly" title=" " alt="" coords="499,53,396,27,398,22,500,48"/>
<area shape="rect" href="util__pkcs11_8c.html#a89815aa1db935281716a2b4d5520da8f" title=" " alt="" coords="314,55,430,80"/>
<area shape="poly" title=" " alt="" coords="481,70,430,70,430,65,481,65"/>
<area shape="rect" href="commands_8c.html#a38efe7b63355b641f9489d4f95106589" title=" " alt="" coords="296,104,448,130"/>
<area shape="poly" title=" " alt="" coords="500,87,427,106,426,101,499,82"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,104,248,130"/>
<area shape="poly" title=" " alt="" coords="281,120,248,120,248,114,281,114"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,104,55,130"/>
<area shape="poly" title=" " alt="" coords="87,120,55,120,55,114,87,114"/>
</map>
</div>

</div>
</div>
<a id="a3677afe2209a1cae31f70a304e260e28" name="a3677afe2209a1cae31f70a304e260e28"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3677afe2209a1cae31f70a304e260e28">&#9670;&#160;</a></span>yh_util_decrypt_otp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_util_decrypt_otp </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__session.html">yh_session</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a></td>          <td class="paramname"><span class="paramname"><em>key_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>aead</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>aead_len</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>otp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *</td>          <td class="paramname"><span class="paramname"><em>useCtr</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>sessionCtr</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>tstph</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *</td>          <td class="paramname"><span class="paramname"><em>tstpl</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Decrypt a Yubico OTP and return counters and time information.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>Authenticated session to use </td></tr>
    <tr><td class="paramname">key_id</td><td>Object ID of the key used for decryption </td></tr>
    <tr><td class="paramname">aead</td><td>AEAD as created by <a class="el" href="yubihsm_8h.html#a82d295a02d9eb628f6dea4b4c01fdec4">yh_util_create_otp_aead()</a> or <a class="el" href="yubihsm_8h.html#a4bb1d420f681bc91bd36dc08695dbad6">yh_util_randomize_otp_aead()</a> </td></tr>
    <tr><td class="paramname">aead_len</td><td>Length of AEAD </td></tr>
    <tr><td class="paramname">otp</td><td>OTP </td></tr>
    <tr><td class="paramname">useCtr</td><td>OTP use counter </td></tr>
    <tr><td class="paramname">sessionCtr</td><td>OTP session counter </td></tr>
    <tr><td class="paramname">tstph</td><td>OTP timestamp high </td></tr>
    <tr><td class="paramname">tstpl</td><td>OTP timestamp low</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> if input parameters are NULL. See <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> for other possible errors </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l03261">3261</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3265</span>                                           {</div>
<div class="line"><span class="lineno"> 3266</span> </div>
<div class="line"><span class="lineno"> 3267</span><span class="preprocessor">#pragma pack(push, 1)</span></div>
<div class="line"><span class="lineno"> 3268</span>  <span class="keyword">union </span>{</div>
<div class="line"><span class="lineno"> 3269</span>    <span class="keyword">struct </span>{</div>
<div class="line"><span class="lineno"> 3270</span>      <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>;</div>
<div class="line"><span class="lineno"> 3271</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> aead[6 + 16 + 6 + 8]; <span class="comment">// FIXME: ya.. magic numbers!</span></div>
<div class="line"><span class="lineno"> 3272</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubico__otp_8c.html#ab1e1d61db8c48d537faca71988a7c123">otp</a>[16];</div>
<div class="line"><span class="lineno"> 3273</span>    };</div>
<div class="line"><span class="lineno"> 3274</span>    <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a855e99b645b13e7905d074d02fe0bff5">buf</a>[1];</div>
<div class="line"><span class="lineno"> 3275</span>  } data;</div>
<div class="line"><span class="lineno"> 3276</span>  <span class="keyword">union </span>{</div>
<div class="line"><span class="lineno"> 3277</span>    <span class="keyword">struct </span>{</div>
<div class="line"><span class="lineno"> 3278</span>      <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> useCtr;</div>
<div class="line"><span class="lineno"> 3279</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> sessionCtr;</div>
<div class="line"><span class="lineno"> 3280</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> tstph;</div>
<div class="line"><span class="lineno"> 3281</span>      <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> tstpl;</div>
<div class="line"><span class="lineno"> 3282</span>    };</div>
<div class="line"><span class="lineno"> 3283</span>    <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a855e99b645b13e7905d074d02fe0bff5">buf</a>[1];</div>
<div class="line"><span class="lineno"> 3284</span>  } response;</div>
<div class="line"><span class="lineno"> 3285</span><span class="preprocessor">#pragma pack(pop)</span></div>
<div class="line"><span class="lineno"> 3286</span> </div>
<div class="line"><span class="lineno"> 3287</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a> == NULL || aead == NULL || <a class="code hl_variable" href="yubico__otp_8c.html#ab1e1d61db8c48d537faca71988a7c123">otp</a> == NULL ||</div>
<div class="line"><span class="lineno"> 3288</span>      aead_len != <span class="keyword">sizeof</span>(data.aead)) {</div>
<div class="line"><span class="lineno"> 3289</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>));</div>
<div class="line"><span class="lineno"> 3290</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 3291</span>  }</div>
<div class="line"><span class="lineno"> 3292</span> </div>
<div class="line"><span class="lineno"> 3293</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7e">yh_cmd</a> response_cmd;</div>
<div class="line"><span class="lineno"> 3294</span>  <span class="keywordtype">size_t</span> response_len = <span class="keyword">sizeof</span>(response);</div>
<div class="line"><span class="lineno"> 3295</span> </div>
<div class="line"><span class="lineno"> 3296</span>  data.key_id = htons(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>);</div>
<div class="line"><span class="lineno"> 3297</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(data.aead, aead, <span class="keyword">sizeof</span>(data.aead));</div>
<div class="line"><span class="lineno"> 3298</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(data.otp, <a class="code hl_variable" href="yubico__otp_8c.html#ab1e1d61db8c48d537faca71988a7c123">otp</a>, <span class="keyword">sizeof</span>(data.otp));</div>
<div class="line"><span class="lineno"> 3299</span> </div>
<div class="line"><span class="lineno"> 3300</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> =</div>
<div class="line"><span class="lineno"> 3301</span>    <a class="code hl_function" href="#a4c26f003b72e800e9c934bca922a404a">yh_send_secure_msg</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, YHC_DECRYPT_OTP, data.buf, <span class="keyword">sizeof</span>(data),</div>
<div class="line"><span class="lineno"> 3302</span>                       &amp;response_cmd, response.buf, &amp;response_len);</div>
<div class="line"><span class="lineno"> 3303</span>  <a class="code hl_define" href="insecure__memzero_8h.html#a0794f9275fd1036ecba6ff0a901a320b">insecure_memzero</a>(data.buf, <span class="keyword">sizeof</span>(data));</div>
<div class="line"><span class="lineno"> 3304</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 3305</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Failed to send DECRYPT OTP command: %s\n&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 3306</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 3307</span>  }</div>
<div class="line"><span class="lineno"> 3308</span> </div>
<div class="line"><span class="lineno"> 3309</span>  <span class="keywordflow">if</span> (response_cmd == <a class="code hl_enumvalue" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7ea51cdf2ccd6995498e589e8ea6ce2a1f2">YHC_ERROR</a>) {</div>
<div class="line"><span class="lineno"> 3310</span>    <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> translated = translate_device_error(response.buf[0]);</div>
<div class="line"><span class="lineno"> 3311</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Unable to decrypt OTP: %s (%x)\n&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(translated),</div>
<div class="line"><span class="lineno"> 3312</span>            response.buf[0]);</div>
<div class="line"><span class="lineno"> 3313</span>    <span class="keywordflow">return</span> translated;</div>
<div class="line"><span class="lineno"> 3314</span>  }</div>
<div class="line"><span class="lineno"> 3315</span> </div>
<div class="line"><span class="lineno"> 3316</span>  <span class="keywordflow">if</span> (response_len != <span class="keyword">sizeof</span>(response)) {</div>
<div class="line"><span class="lineno"> 3317</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Wrong size returned&quot;</span>);</div>
<div class="line"><span class="lineno"> 3318</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366ae0b26dcb22aa228ab08c9e59a8975952">YHR_WRONG_LENGTH</a>;</div>
<div class="line"><span class="lineno"> 3319</span>  }</div>
<div class="line"><span class="lineno"> 3320</span> </div>
<div class="line"><span class="lineno"> 3321</span>  <span class="keywordflow">if</span> (useCtr) {</div>
<div class="line"><span class="lineno"> 3322</span>    *useCtr = response.useCtr;</div>
<div class="line"><span class="lineno"> 3323</span>  }</div>
<div class="line"><span class="lineno"> 3324</span>  <span class="keywordflow">if</span> (sessionCtr) {</div>
<div class="line"><span class="lineno"> 3325</span>    *sessionCtr = response.sessionCtr;</div>
<div class="line"><span class="lineno"> 3326</span>  }</div>
<div class="line"><span class="lineno"> 3327</span>  <span class="keywordflow">if</span> (tstph) {</div>
<div class="line"><span class="lineno"> 3328</span>    *tstph = response.tstph;</div>
<div class="line"><span class="lineno"> 3329</span>  }</div>
<div class="line"><span class="lineno"> 3330</span>  <span class="keywordflow">if</span> (tstpl) {</div>
<div class="line"><span class="lineno"> 3331</span>    *tstpl = response.tstpl;</div>
<div class="line"><span class="lineno"> 3332</span>  }</div>
<div class="line"><span class="lineno"> 3333</span> </div>
<div class="line"><span class="lineno"> 3334</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 3335</span>}</div>
<div class="ttc" id="ayubico__otp_8c_html_ab1e1d61db8c48d537faca71988a7c123"><div class="ttname"><a href="yubico__otp_8c.html#ab1e1d61db8c48d537faca71988a7c123">otp</a></div><div class="ttdeci">uint8_t otp[32]</div><div class="ttdef"><b>Definition</b> <a href="yubico__otp_8c_source.html#l00049">yubico_otp.c:49</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a3677afe2209a1cae31f70a304e260e28_cgraph.png" border="0" usemap="#ayubihsm_8c_a3677afe2209a1cae31f70a304e260e28_cgraph" alt=""/></div>
<map name="ayubihsm_8c_a3677afe2209a1cae31f70a304e260e28_cgraph" id="ayubihsm_8c_a3677afe2209a1cae31f70a304e260e28_cgraph">
<area shape="rect" title=" " alt="" coords="5,80,140,106"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="613,5,685,31"/>
<area shape="poly" title=" " alt="" coords="129,77,187,65,302,48,416,34,597,19,598,24,417,40,303,53,188,70,130,82"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="188,80,336,106"/>
<area shape="poly" title=" " alt="" coords="140,90,172,90,172,96,140,96"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="607,104,691,130"/>
<area shape="poly" title=" " alt="" coords="128,104,209,121,314,137,431,145,491,144,549,140,592,131,593,136,550,145,491,150,431,150,314,142,208,126,127,109"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="384,55,549,80"/>
<area shape="poly" title=" " alt="" coords="336,81,368,77,369,82,336,86"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="402,104,532,130"/>
<area shape="poly" title=" " alt="" coords="336,99,387,105,386,110,336,104"/>
<area shape="poly" title=" " alt="" coords="516,51,598,29,599,34,518,57"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="615,55,683,80"/>
<area shape="poly" title=" " alt="" coords="550,65,599,65,599,70,550,70"/>
<area shape="poly" title=" " alt="" coords="518,78,593,99,592,104,516,84"/>
<area shape="poly" title=" " alt="" coords="526,101,548,91,563,79,572,67,581,54,596,40,601,37,604,41,599,44,585,57,576,70,566,83,551,95,528,106"/>
<area shape="poly" title=" " alt="" coords="532,114,592,114,592,120,532,120"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="597,153,701,179"/>
<area shape="poly" title=" " alt="" coords="518,128,585,146,583,151,516,133"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a3677afe2209a1cae31f70a304e260e28_icgraph.png" border="0" usemap="#ayubihsm_8c_a3677afe2209a1cae31f70a304e260e28_icgraph" alt=""/></div>
<map name="ayubihsm_8c_a3677afe2209a1cae31f70a304e260e28_icgraph" id="ayubihsm_8c_a3677afe2209a1cae31f70a304e260e28_icgraph">
<area shape="rect" title=" " alt="" coords="486,55,621,80"/>
<area shape="rect" href="yubico__otp_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="342,5,392,31"/>
<area shape="poly" title=" " alt="" coords="487,53,392,27,393,22,488,47"/>
<area shape="rect" href="commands_8c.html#ae2e50929acc6085cd395d0bd4ddb02db" title=" " alt="" coords="298,55,436,80"/>
<area shape="poly" title=" " alt="" coords="471,70,437,70,437,65,471,65"/>
<area shape="rect" href="commands_8c.html#ad676312a3ed43f6a3ece63851780aeff" title=" " alt="" coords="296,104,438,130"/>
<area shape="poly" title=" " alt="" coords="488,87,419,106,418,101,487,82"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,80,248,106"/>
<area shape="poly" title=" " alt="" coords="283,81,248,86,248,81,282,76"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,80,55,106"/>
<area shape="poly" title=" " alt="" coords="87,96,55,96,55,90,87,90"/>
<area shape="poly" title=" " alt="" coords="280,109,248,105,249,99,281,103"/>
</map>
</div>

</div>
</div>
<a id="a5ebf6932cd2e68b9a23787c27fde3e26" name="a5ebf6932cd2e68b9a23787c27fde3e26"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ebf6932cd2e68b9a23787c27fde3e26">&#9670;&#160;</a></span>yh_util_decrypt_pkcs1v1_5()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_util_decrypt_pkcs1v1_5 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__session.html">yh_session</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a></td>          <td class="paramname"><span class="paramname"><em>key_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>in</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>in_len</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>out</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *</td>          <td class="paramname"><span class="paramname"><em>out_len</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Decrypt data that was encrypted using RSA-PKCS#1v1.5</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>Authenticated session to use </td></tr>
    <tr><td class="paramname">key_id</td><td>Object ID of the RSA key to use for decryption </td></tr>
    <tr><td class="paramname">in</td><td>Encrypted data </td></tr>
    <tr><td class="paramname">in_len</td><td>Length of encrypted data </td></tr>
    <tr><td class="paramname">out</td><td>Decrypted data </td></tr>
    <tr><td class="paramname">out_len</td><td>Length of decrypted data</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> input parameters are NULL or if <code>in_len</code> is bigger than <a class="el" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f" title="Maximum length of message buffer.">YH_MSG_BUF_SIZE</a>-2. See <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> for other possible errors </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l02059">2059</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2061</span>                                                 {</div>
<div class="line"><span class="lineno"> 2062</span> </div>
<div class="line"><span class="lineno"> 2063</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a> == NULL || in == NULL || out == NULL || <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a565e4b6f63fecad4c290b50ee6684ee3">out_len</a> == NULL) {</div>
<div class="line"><span class="lineno"> 2064</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>));</div>
<div class="line"><span class="lineno"> 2065</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 2066</span>  }</div>
<div class="line"><span class="lineno"> 2067</span> </div>
<div class="line"><span class="lineno"> 2068</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a> &gt; <a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a> - 2) {</div>
<div class="line"><span class="lineno"> 2069</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Too much data, must be &lt; %d&quot;</span>, <a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a> - 2);</div>
<div class="line"><span class="lineno"> 2070</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 2071</span>  }</div>
<div class="line"><span class="lineno"> 2072</span> </div>
<div class="line"><span class="lineno"> 2073</span><span class="preprocessor">#pragma pack(push, 1)</span></div>
<div class="line"><span class="lineno"> 2074</span>  <span class="keyword">union </span>{</div>
<div class="line"><span class="lineno"> 2075</span>    <span class="keyword">struct </span>{</div>
<div class="line"><span class="lineno"> 2076</span>      <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>;</div>
<div class="line"><span class="lineno"> 2077</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#ac6f5a1f1e061f000983f5d5f3ac25dfa">bytes</a>[<a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a>];</div>
<div class="line"><span class="lineno"> 2078</span>    };</div>
<div class="line"><span class="lineno"> 2079</span>    <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a855e99b645b13e7905d074d02fe0bff5">buf</a>[1];</div>
<div class="line"><span class="lineno"> 2080</span>  } data;</div>
<div class="line"><span class="lineno"> 2081</span><span class="preprocessor">#pragma pack(pop)</span></div>
<div class="line"><span class="lineno"> 2082</span> </div>
<div class="line"><span class="lineno"> 2083</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7e">yh_cmd</a> response_cmd;</div>
<div class="line"><span class="lineno"> 2084</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 2085</span> </div>
<div class="line"><span class="lineno"> 2086</span>  data.key_id = htons(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>);</div>
<div class="line"><span class="lineno"> 2087</span> </div>
<div class="line"><span class="lineno"> 2088</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(data.bytes, in, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a>);</div>
<div class="line"><span class="lineno"> 2089</span> </div>
<div class="line"><span class="lineno"> 2090</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="#a4c26f003b72e800e9c934bca922a404a">yh_send_secure_msg</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, YHC_DECRYPT_PKCS1, data.buf, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a> + 2,</div>
<div class="line"><span class="lineno"> 2091</span>                           &amp;response_cmd, out, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a565e4b6f63fecad4c290b50ee6684ee3">out_len</a>);</div>
<div class="line"><span class="lineno"> 2092</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 2093</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Failed to send DECRYPT PKCS1 command: %s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 2094</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 2095</span>  }</div>
<div class="line"><span class="lineno"> 2096</span> </div>
<div class="line"><span class="lineno"> 2097</span>  <span class="keywordflow">if</span> (response_cmd == <a class="code hl_enumvalue" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7ea51cdf2ccd6995498e589e8ea6ce2a1f2">YHC_ERROR</a>) {</div>
<div class="line"><span class="lineno"> 2098</span>    <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> translated = translate_device_error(out[0]);</div>
<div class="line"><span class="lineno"> 2099</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Unable to get decrypted data: %s (%x)&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(translated),</div>
<div class="line"><span class="lineno"> 2100</span>            out[0]);</div>
<div class="line"><span class="lineno"> 2101</span>    <span class="keywordflow">return</span> translated;</div>
<div class="line"><span class="lineno"> 2102</span>  }</div>
<div class="line"><span class="lineno"> 2103</span> </div>
<div class="line"><span class="lineno"> 2104</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 2105</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a5ebf6932cd2e68b9a23787c27fde3e26_cgraph.png" border="0" usemap="#ayubihsm_8c_a5ebf6932cd2e68b9a23787c27fde3e26_cgraph" alt=""/></div>
<map name="ayubihsm_8c_a5ebf6932cd2e68b9a23787c27fde3e26_cgraph" id="ayubihsm_8c_a5ebf6932cd2e68b9a23787c27fde3e26_cgraph">
<area shape="rect" title=" " alt="" coords="5,80,185,106"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="658,5,730,31"/>
<area shape="poly" title=" " alt="" coords="164,77,232,65,461,36,642,19,643,25,462,41,233,70,165,82"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="233,80,381,106"/>
<area shape="poly" title=" " alt="" coords="185,90,217,90,217,96,185,96"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="652,104,736,130"/>
<area shape="poly" title=" " alt="" coords="165,104,233,116,414,144,493,148,594,140,637,131,638,136,595,145,493,153,413,150,232,121,164,109"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="429,55,594,80"/>
<area shape="poly" title=" " alt="" coords="381,81,413,77,414,82,381,86"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="446,104,577,130"/>
<area shape="poly" title=" " alt="" coords="381,99,432,105,431,110,381,104"/>
<area shape="poly" title=" " alt="" coords="561,51,643,29,644,34,563,57"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="660,55,728,80"/>
<area shape="poly" title=" " alt="" coords="595,65,644,65,644,70,595,70"/>
<area shape="poly" title=" " alt="" coords="563,78,638,99,637,104,561,84"/>
<area shape="poly" title=" " alt="" coords="571,101,593,91,608,79,617,67,626,54,641,40,646,37,649,41,644,44,630,57,621,70,611,83,596,95,573,106"/>
<area shape="poly" title=" " alt="" coords="577,114,637,114,637,120,577,120"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="642,153,746,179"/>
<area shape="poly" title=" " alt="" coords="563,128,630,146,628,151,561,133"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a5ebf6932cd2e68b9a23787c27fde3e26_icgraph.png" border="0" usemap="#ayubihsm_8c_a5ebf6932cd2e68b9a23787c27fde3e26_icgraph" alt=""/></div>
<map name="ayubihsm_8c_a5ebf6932cd2e68b9a23787c27fde3e26_icgraph" id="ayubihsm_8c_a5ebf6932cd2e68b9a23787c27fde3e26_icgraph">
<area shape="rect" title=" " alt="" coords="531,55,711,80"/>
<area shape="rect" href="decrypt__rsa_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="365,5,414,31"/>
<area shape="poly" title=" " alt="" coords="542,53,414,26,415,21,543,48"/>
<area shape="rect" href="util__pkcs11_8c.html#a89815aa1db935281716a2b4d5520da8f" title=" " alt="" coords="332,55,447,80"/>
<area shape="poly" title=" " alt="" coords="516,70,448,70,448,65,516,65"/>
<area shape="rect" href="commands_8c.html#aea9c5cab32280dc06d4681c02f1b5ccb" title=" " alt="" coords="296,104,483,130"/>
<area shape="poly" title=" " alt="" coords="543,87,454,106,453,101,542,82"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,79,248,104"/>
<area shape="poly" title=" " alt="" coords="280,107,248,103,249,97,281,101"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,104,55,130"/>
<area shape="poly" title=" " alt="" coords="280,120,55,120,55,114,280,114"/>
<area shape="poly" title=" " alt="" coords="88,109,55,115,54,110,87,104"/>
</map>
</div>

</div>
</div>
<a id="ae736702f9463878db4adfd45b6a597f9" name="ae736702f9463878db4adfd45b6a597f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae736702f9463878db4adfd45b6a597f9">&#9670;&#160;</a></span>yh_util_delete_object()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_util_delete_object </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__session.html">yh_session</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a></td>          <td class="paramname"><span class="paramname"><em>id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583">yh_object_type</a></td>          <td class="paramname"><span class="paramname"><em>type</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Delete an object in the device</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>Authenticated session to use </td></tr>
    <tr><td class="paramname">id</td><td>Object ID of the object to delete </td></tr>
    <tr><td class="paramname">type</td><td>Type of object to delete. See <a class="el" href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583">yh_object_type</a></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> if session is NULL. See <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> for other possible errors </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l02222">2222</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2223</span>                                                 {</div>
<div class="line"><span class="lineno"> 2224</span> </div>
<div class="line"><span class="lineno"> 2225</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a> == NULL) {</div>
<div class="line"><span class="lineno"> 2226</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>));</div>
<div class="line"><span class="lineno"> 2227</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 2228</span>  }</div>
<div class="line"><span class="lineno"> 2229</span> </div>
<div class="line"><span class="lineno"> 2230</span><span class="preprocessor">#pragma pack(push, 1)</span></div>
<div class="line"><span class="lineno"> 2231</span>  <span class="keyword">union </span>{</div>
<div class="line"><span class="lineno"> 2232</span>    <span class="keyword">struct </span>{</div>
<div class="line"><span class="lineno"> 2233</span>      <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="code hl_variable" href="code__cache_8cpp.html#aa0efefe21f4700d78692edc823e763be">id</a>;</div>
<div class="line"><span class="lineno"> 2234</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a>;</div>
<div class="line"><span class="lineno"> 2235</span>    };</div>
<div class="line"><span class="lineno"> 2236</span>    <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a855e99b645b13e7905d074d02fe0bff5">buf</a>[1];</div>
<div class="line"><span class="lineno"> 2237</span>  } data;</div>
<div class="line"><span class="lineno"> 2238</span><span class="preprocessor">#pragma pack(pop)</span></div>
<div class="line"><span class="lineno"> 2239</span> </div>
<div class="line"><span class="lineno"> 2240</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 2241</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7e">yh_cmd</a> response_cmd;</div>
<div class="line"><span class="lineno"> 2242</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> response[<a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a>];</div>
<div class="line"><span class="lineno"> 2243</span>  <span class="keywordtype">size_t</span> response_len = <span class="keyword">sizeof</span>(response);</div>
<div class="line"><span class="lineno"> 2244</span> </div>
<div class="line"><span class="lineno"> 2245</span>  data.type = <a class="code hl_variable" href="yubihsm_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a>;</div>
<div class="line"><span class="lineno"> 2246</span>  data.id = htons(<span class="keywordtype">id</span>);</div>
<div class="line"><span class="lineno"> 2247</span> </div>
<div class="line"><span class="lineno"> 2248</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="#a4c26f003b72e800e9c934bca922a404a">yh_send_secure_msg</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, YHC_DELETE_OBJECT, data.buf, <span class="keyword">sizeof</span>(data),</div>
<div class="line"><span class="lineno"> 2249</span>                           &amp;response_cmd, response, &amp;response_len);</div>
<div class="line"><span class="lineno"> 2250</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 2251</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Failed to send DELETE command: %s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 2252</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 2253</span>  }</div>
<div class="line"><span class="lineno"> 2254</span> </div>
<div class="line"><span class="lineno"> 2255</span>  <span class="keywordflow">if</span> (response_cmd == <a class="code hl_enumvalue" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7ea51cdf2ccd6995498e589e8ea6ce2a1f2">YHC_ERROR</a>) {</div>
<div class="line"><span class="lineno"> 2256</span>    <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> translated = translate_device_error(response[0]);</div>
<div class="line"><span class="lineno"> 2257</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Unable to delete object: %s (%x)&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(translated),</div>
<div class="line"><span class="lineno"> 2258</span>            response[0]);</div>
<div class="line"><span class="lineno"> 2259</span>    <span class="keywordflow">return</span> translated;</div>
<div class="line"><span class="lineno"> 2260</span>  }</div>
<div class="line"><span class="lineno"> 2261</span> </div>
<div class="line"><span class="lineno"> 2262</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 2263</span>}</div>
<div class="ttc" id="acode__cache_8cpp_html_aa0efefe21f4700d78692edc823e763be"><div class="ttname"><a href="code__cache_8cpp.html#aa0efefe21f4700d78692edc823e763be">id</a></div><div class="ttdeci">uint64_t id</div><div class="ttdef"><b>Definition</b> <a href="code__cache_8cpp_source.html#l00000">code_cache.cpp:0</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a1d127017fb298b889f4ba24752d08b8e"><div class="ttname"><a href="yubihsm_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a></div><div class="ttdeci">yh_object_type type</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00672">yubihsm.h:672</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_ae736702f9463878db4adfd45b6a597f9_cgraph.png" border="0" usemap="#ayubihsm_8c_ae736702f9463878db4adfd45b6a597f9_cgraph" alt=""/></div>
<map name="ayubihsm_8c_ae736702f9463878db4adfd45b6a597f9_cgraph" id="ayubihsm_8c_ae736702f9463878db4adfd45b6a597f9_cgraph">
<area shape="rect" title=" " alt="" coords="5,129,149,155"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="197,104,345,130"/>
<area shape="poly" title=" " alt="" coords="149,130,181,126,182,131,149,135"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="616,153,700,179"/>
<area shape="poly" title=" " alt="" coords="149,142,601,161,600,167,149,148"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="393,55,558,80"/>
<area shape="poly" title=" " alt="" coords="327,101,404,82,405,87,328,106"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="410,104,541,130"/>
<area shape="poly" title=" " alt="" coords="345,114,395,114,395,120,345,120"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="622,55,694,80"/>
<area shape="poly" title=" " alt="" coords="559,65,607,65,607,70,559,70"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="624,5,692,31"/>
<area shape="poly" title=" " alt="" coords="525,51,608,29,610,34,527,57"/>
<area shape="poly" title=" " alt="" coords="537,79,560,89,575,102,585,114,594,127,608,140,613,143,610,148,605,144,590,131,581,118,572,106,557,94,535,83"/>
<area shape="poly" title=" " alt="" coords="525,101,607,78,608,84,527,106"/>
<area shape="poly" title=" " alt="" coords="527,128,602,148,601,154,525,133"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="606,104,710,130"/>
<area shape="poly" title=" " alt="" coords="541,114,591,114,591,120,541,120"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_ae736702f9463878db4adfd45b6a597f9_icgraph.png" border="0" usemap="#ayubihsm_8c_ae736702f9463878db4adfd45b6a597f9_icgraph" alt=""/></div>
<map name="ayubihsm_8c_ae736702f9463878db4adfd45b6a597f9_icgraph" id="ayubihsm_8c_ae736702f9463878db4adfd45b6a597f9_icgraph">
<area shape="rect" title=" " alt="" coords="482,55,626,80"/>
<area shape="rect" href="ssh_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="340,5,390,31"/>
<area shape="poly" title=" " alt="" coords="487,53,389,27,391,22,488,48"/>
<area shape="rect" href="commands_8c.html#ae2e50929acc6085cd395d0bd4ddb02db" title=" " alt="" coords="296,55,434,80"/>
<area shape="poly" title=" " alt="" coords="467,70,435,70,435,65,467,65"/>
<area shape="rect" href="commands_8c.html#ad490f0e89d33c1300a44bd095eb5562c" title=" " alt="" coords="310,104,420,130"/>
<area shape="poly" title=" " alt="" coords="488,87,418,106,417,101,486,82"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,55,248,80"/>
<area shape="poly" title=" " alt="" coords="281,70,248,70,248,65,281,65"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,80,55,106"/>
<area shape="poly" title=" " alt="" coords="88,85,55,91,54,86,87,80"/>
<area shape="poly" title=" " alt="" coords="297,102,227,84,228,78,299,97"/>
<area shape="poly" title=" " alt="" coords="295,115,55,97,55,92,295,109"/>
</map>
</div>

</div>
</div>
<a id="a2900aee87732f9ec017bd1662bcef7e9" name="a2900aee87732f9ec017bd1662bcef7e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2900aee87732f9ec017bd1662bcef7e9">&#9670;&#160;</a></span>yh_util_derive_ecdh()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_util_derive_ecdh </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__session.html">yh_session</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a></td>          <td class="paramname"><span class="paramname"><em>key_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>in</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>in_len</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>out</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *</td>          <td class="paramname"><span class="paramname"><em>out_len</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Derive an ECDH key from a private EC key on the device and a provided public EC key</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>Authenticated session to use </td></tr>
    <tr><td class="paramname">key_id</td><td>Object ID of the EC private key to use for ECDH derivation </td></tr>
    <tr><td class="paramname">in</td><td>Public key of another EC key-pair </td></tr>
    <tr><td class="paramname">in_len</td><td>Length of public key </td></tr>
    <tr><td class="paramname">out</td><td>Shared secret ECDH key </td></tr>
    <tr><td class="paramname">out_len</td><td>Length of the shared ECDH key</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> input parameters are NULL or if <code>in_len</code> is bigger than <a class="el" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f" title="Maximum length of message buffer.">YH_MSG_BUF_SIZE</a>-2. See <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> for other possible errors </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l02174">2174</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2176</span>                                           {</div>
<div class="line"><span class="lineno"> 2177</span> </div>
<div class="line"><span class="lineno"> 2178</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a> == NULL || in == NULL || out == NULL || <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a565e4b6f63fecad4c290b50ee6684ee3">out_len</a> == NULL) {</div>
<div class="line"><span class="lineno"> 2179</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>));</div>
<div class="line"><span class="lineno"> 2180</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 2181</span>  }</div>
<div class="line"><span class="lineno"> 2182</span> </div>
<div class="line"><span class="lineno"> 2183</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a> &gt; <a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a> - 2) {</div>
<div class="line"><span class="lineno"> 2184</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Too much data, must be &lt; %d&quot;</span>, <a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a> - 2);</div>
<div class="line"><span class="lineno"> 2185</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 2186</span>  }</div>
<div class="line"><span class="lineno"> 2187</span> </div>
<div class="line"><span class="lineno"> 2188</span><span class="preprocessor">#pragma pack(push, 1)</span></div>
<div class="line"><span class="lineno"> 2189</span>  <span class="keyword">union </span>{</div>
<div class="line"><span class="lineno"> 2190</span>    <span class="keyword">struct </span>{</div>
<div class="line"><span class="lineno"> 2191</span>      <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>;</div>
<div class="line"><span class="lineno"> 2192</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#ac6f5a1f1e061f000983f5d5f3ac25dfa">bytes</a>[<a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a>];</div>
<div class="line"><span class="lineno"> 2193</span>    };</div>
<div class="line"><span class="lineno"> 2194</span>    <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a855e99b645b13e7905d074d02fe0bff5">buf</a>[1];</div>
<div class="line"><span class="lineno"> 2195</span>  } data;</div>
<div class="line"><span class="lineno"> 2196</span><span class="preprocessor">#pragma pack(pop)</span></div>
<div class="line"><span class="lineno"> 2197</span> </div>
<div class="line"><span class="lineno"> 2198</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7e">yh_cmd</a> response_cmd;</div>
<div class="line"><span class="lineno"> 2199</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 2200</span> </div>
<div class="line"><span class="lineno"> 2201</span>  data.key_id = htons(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>);</div>
<div class="line"><span class="lineno"> 2202</span> </div>
<div class="line"><span class="lineno"> 2203</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(data.bytes, in, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a>);</div>
<div class="line"><span class="lineno"> 2204</span> </div>
<div class="line"><span class="lineno"> 2205</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="#a4c26f003b72e800e9c934bca922a404a">yh_send_secure_msg</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, YHC_DERIVE_ECDH, data.buf, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a> + 2,</div>
<div class="line"><span class="lineno"> 2206</span>                           &amp;response_cmd, out, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a565e4b6f63fecad4c290b50ee6684ee3">out_len</a>);</div>
<div class="line"><span class="lineno"> 2207</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 2208</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Failed to send DERIVE ECDH command: %s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 2209</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 2210</span>  }</div>
<div class="line"><span class="lineno"> 2211</span> </div>
<div class="line"><span class="lineno"> 2212</span>  <span class="keywordflow">if</span> (response_cmd == <a class="code hl_enumvalue" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7ea51cdf2ccd6995498e589e8ea6ce2a1f2">YHC_ERROR</a>) {</div>
<div class="line"><span class="lineno"> 2213</span>    <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> translated = translate_device_error(out[0]);</div>
<div class="line"><span class="lineno"> 2214</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Unable to get decrypted data: %s (%x)&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(translated),</div>
<div class="line"><span class="lineno"> 2215</span>            out[0]);</div>
<div class="line"><span class="lineno"> 2216</span>    <span class="keywordflow">return</span> translated;</div>
<div class="line"><span class="lineno"> 2217</span>  }</div>
<div class="line"><span class="lineno"> 2218</span> </div>
<div class="line"><span class="lineno"> 2219</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 2220</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a2900aee87732f9ec017bd1662bcef7e9_cgraph.png" border="0" usemap="#ayubihsm_8c_a2900aee87732f9ec017bd1662bcef7e9_cgraph" alt=""/></div>
<map name="ayubihsm_8c_a2900aee87732f9ec017bd1662bcef7e9_cgraph" id="ayubihsm_8c_a2900aee87732f9ec017bd1662bcef7e9_cgraph">
<area shape="rect" title=" " alt="" coords="5,80,142,106"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="615,5,687,31"/>
<area shape="poly" title=" " alt="" coords="130,77,189,65,304,48,418,34,599,19,600,24,419,40,305,53,190,70,131,82"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="190,80,338,106"/>
<area shape="poly" title=" " alt="" coords="142,90,174,90,174,96,142,96"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="609,104,693,130"/>
<area shape="poly" title=" " alt="" coords="129,104,210,121,316,137,433,145,493,144,551,140,594,131,595,136,552,145,493,150,433,150,315,142,209,126,128,109"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="386,55,551,80"/>
<area shape="poly" title=" " alt="" coords="338,81,370,77,371,82,338,86"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="404,104,534,130"/>
<area shape="poly" title=" " alt="" coords="338,99,389,105,388,110,338,104"/>
<area shape="poly" title=" " alt="" coords="518,51,600,29,601,34,520,57"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="617,55,685,80"/>
<area shape="poly" title=" " alt="" coords="552,65,601,65,601,70,552,70"/>
<area shape="poly" title=" " alt="" coords="520,78,595,99,594,104,518,84"/>
<area shape="poly" title=" " alt="" coords="528,101,550,91,565,79,574,67,583,54,598,40,603,37,606,41,601,44,587,57,578,70,568,83,553,95,530,106"/>
<area shape="poly" title=" " alt="" coords="534,114,594,114,594,120,534,120"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="599,153,703,179"/>
<area shape="poly" title=" " alt="" coords="520,128,587,146,585,151,518,133"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a2900aee87732f9ec017bd1662bcef7e9_icgraph.png" border="0" usemap="#ayubihsm_8c_a2900aee87732f9ec017bd1662bcef7e9_icgraph" alt=""/></div>
<map name="ayubihsm_8c_a2900aee87732f9ec017bd1662bcef7e9_icgraph" id="ayubihsm_8c_a2900aee87732f9ec017bd1662bcef7e9_icgraph">
<area shape="rect" title=" " alt="" coords="488,55,625,80"/>
<area shape="rect" href="decrypt__ec_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="344,5,393,31"/>
<area shape="poly" title=" " alt="" coords="489,53,392,27,394,22,491,48"/>
<area shape="rect" href="commands_8c.html#ae2e50929acc6085cd395d0bd4ddb02db" title=" " alt="" coords="299,55,437,80"/>
<area shape="poly" title=" " alt="" coords="473,70,438,70,438,65,473,65"/>
<area shape="rect" href="commands_8c.html#a0f6792710fe36e1bf00cb839f286d473" title=" " alt="" coords="296,104,440,130"/>
<area shape="poly" title=" " alt="" coords="491,87,421,106,419,101,489,82"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,55,248,80"/>
<area shape="poly" title=" " alt="" coords="283,70,248,70,248,65,283,65"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,80,55,106"/>
<area shape="poly" title=" " alt="" coords="88,85,55,91,54,86,87,80"/>
<area shape="poly" title=" " alt="" coords="300,102,228,84,229,78,301,97"/>
<area shape="poly" title=" " alt="" coords="280,113,55,97,55,92,281,108"/>
</map>
</div>

</div>
</div>
<a id="aa3f473e6dbb9188ad0269b40921c4f5f" name="aa3f473e6dbb9188ad0269b40921c4f5f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3f473e6dbb9188ad0269b40921c4f5f">&#9670;&#160;</a></span>yh_util_export_wrapped()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_util_export_wrapped </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__session.html">yh_session</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a></td>          <td class="paramname"><span class="paramname"><em>wrapping_key_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583">yh_object_type</a></td>          <td class="paramname"><span class="paramname"><em>target_type</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a></td>          <td class="paramname"><span class="paramname"><em>target_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>out</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *</td>          <td class="paramname"><span class="paramname"><em>out_len</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Export an object under wrap from the device</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>Authenticated session to use </td></tr>
    <tr><td class="paramname">wrapping_key_id</td><td>Object ID of the Wrap Key to use to wrap the object </td></tr>
    <tr><td class="paramname">target_type</td><td>Type of the object to be exported. See <a class="el" href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583">yh_object_type</a> </td></tr>
    <tr><td class="paramname">target_id</td><td>Object ID of the object to be exported </td></tr>
    <tr><td class="paramname">out</td><td>Wrapped data </td></tr>
    <tr><td class="paramname">out_len</td><td>Length of wrapped data</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> if input parameters are NULL. See <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> for other possible errors </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l02265">2265</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2267</span>                                                            {</div>
<div class="line"><span class="lineno"> 2268</span> </div>
<div class="line"><span class="lineno"> 2269</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a> == NULL || out == NULL || <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a565e4b6f63fecad4c290b50ee6684ee3">out_len</a> == NULL) {</div>
<div class="line"><span class="lineno"> 2270</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>));</div>
<div class="line"><span class="lineno"> 2271</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 2272</span>  }</div>
<div class="line"><span class="lineno"> 2273</span> </div>
<div class="line"><span class="lineno"> 2274</span><span class="preprocessor">#pragma pack(push, 1)</span></div>
<div class="line"><span class="lineno"> 2275</span>  <span class="keyword">union </span>{</div>
<div class="line"><span class="lineno"> 2276</span>    <span class="keyword">struct </span>{</div>
<div class="line"><span class="lineno"> 2277</span>      <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>;</div>
<div class="line"><span class="lineno"> 2278</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a>;</div>
<div class="line"><span class="lineno"> 2279</span>      <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> tgt_id;</div>
<div class="line"><span class="lineno"> 2280</span>    };</div>
<div class="line"><span class="lineno"> 2281</span>    <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a855e99b645b13e7905d074d02fe0bff5">buf</a>[1];</div>
<div class="line"><span class="lineno"> 2282</span>  } data;</div>
<div class="line"><span class="lineno"> 2283</span><span class="preprocessor">#pragma pack(pop)</span></div>
<div class="line"><span class="lineno"> 2284</span> </div>
<div class="line"><span class="lineno"> 2285</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7e">yh_cmd</a> response_cmd;</div>
<div class="line"><span class="lineno"> 2286</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 2287</span> </div>
<div class="line"><span class="lineno"> 2288</span>  data.key_id = htons(wrapping_key_id);</div>
<div class="line"><span class="lineno"> 2289</span>  data.type = (<a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>) <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a16deaf35253f2106ecf4fd8003b1284f">target_type</a>;</div>
<div class="line"><span class="lineno"> 2290</span>  data.tgt_id = htons(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ad82e96deab6d88b5e26f9f11da9d3fa3">target_id</a>);</div>
<div class="line"><span class="lineno"> 2291</span> </div>
<div class="line"><span class="lineno"> 2292</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="#a4c26f003b72e800e9c934bca922a404a">yh_send_secure_msg</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, YHC_EXPORT_WRAPPED, data.buf, <span class="keyword">sizeof</span>(data),</div>
<div class="line"><span class="lineno"> 2293</span>                           &amp;response_cmd, out, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a565e4b6f63fecad4c290b50ee6684ee3">out_len</a>);</div>
<div class="line"><span class="lineno"> 2294</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 2295</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Failed to send EXPORT WRAPPED command: %s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 2296</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 2297</span>  }</div>
<div class="line"><span class="lineno"> 2298</span> </div>
<div class="line"><span class="lineno"> 2299</span>  <span class="keywordflow">if</span> (response_cmd == <a class="code hl_enumvalue" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7ea51cdf2ccd6995498e589e8ea6ce2a1f2">YHC_ERROR</a>) {</div>
<div class="line"><span class="lineno"> 2300</span>    <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> translated = translate_device_error(out[0]);</div>
<div class="line"><span class="lineno"> 2301</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Unable to get wrapped object: %s (%x)&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(translated),</div>
<div class="line"><span class="lineno"> 2302</span>            out[0]);</div>
<div class="line"><span class="lineno"> 2303</span>    <span class="keywordflow">return</span> translated;</div>
<div class="line"><span class="lineno"> 2304</span>  }</div>
<div class="line"><span class="lineno"> 2305</span> </div>
<div class="line"><span class="lineno"> 2306</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 2307</span>}</div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a16deaf35253f2106ecf4fd8003b1284f"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a16deaf35253f2106ecf4fd8003b1284f">target_type</a></div><div class="ttdeci">yh_object_type target_type</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l04868">yubihsm_pkcs11.c:4868</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_ad82e96deab6d88b5e26f9f11da9d3fa3"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#ad82e96deab6d88b5e26f9f11da9d3fa3">target_id</a></div><div class="ttdeci">uint16_t target_id</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l04867">yubihsm_pkcs11.c:4867</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_aa3f473e6dbb9188ad0269b40921c4f5f_cgraph.png" border="0" usemap="#ayubihsm_8c_aa3f473e6dbb9188ad0269b40921c4f5f_cgraph" alt=""/></div>
<map name="ayubihsm_8c_aa3f473e6dbb9188ad0269b40921c4f5f_cgraph" id="ayubihsm_8c_aa3f473e6dbb9188ad0269b40921c4f5f_cgraph">
<area shape="rect" title=" " alt="" coords="5,129,164,155"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="212,104,360,130"/>
<area shape="poly" title=" " alt="" coords="163,130,196,125,197,131,164,135"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="631,153,715,179"/>
<area shape="poly" title=" " alt="" coords="164,143,616,161,616,167,164,148"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="408,55,573,80"/>
<area shape="poly" title=" " alt="" coords="342,101,419,82,420,87,343,106"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="426,104,556,130"/>
<area shape="poly" title=" " alt="" coords="360,114,410,114,410,120,360,120"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="637,55,709,80"/>
<area shape="poly" title=" " alt="" coords="574,65,622,65,622,70,574,70"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="639,5,707,31"/>
<area shape="poly" title=" " alt="" coords="540,51,623,29,625,34,542,57"/>
<area shape="poly" title=" " alt="" coords="552,79,575,89,590,102,600,114,609,127,623,140,628,143,625,148,620,144,605,131,596,118,587,106,572,94,550,83"/>
<area shape="poly" title=" " alt="" coords="540,101,622,78,623,84,542,106"/>
<area shape="poly" title=" " alt="" coords="542,128,617,148,616,154,540,133"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="621,104,725,130"/>
<area shape="poly" title=" " alt="" coords="556,114,606,114,606,120,556,120"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_aa3f473e6dbb9188ad0269b40921c4f5f_icgraph.png" border="0" usemap="#ayubihsm_8c_aa3f473e6dbb9188ad0269b40921c4f5f_icgraph" alt=""/></div>
<map name="ayubihsm_8c_aa3f473e6dbb9188ad0269b40921c4f5f_icgraph" id="ayubihsm_8c_aa3f473e6dbb9188ad0269b40921c4f5f_icgraph">
<area shape="rect" title=" " alt="" coords="492,55,651,80"/>
<area shape="rect" href="wrap_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="346,5,395,31"/>
<area shape="poly" title=" " alt="" coords="500,53,395,27,396,21,502,48"/>
<area shape="rect" href="commands_8c.html#ae2e50929acc6085cd395d0bd4ddb02db" title=" " alt="" coords="301,55,439,80"/>
<area shape="poly" title=" " alt="" coords="477,70,440,70,440,65,477,65"/>
<area shape="rect" href="commands_8c.html#ac221d587381b78c747d8290320ee4c0a" title=" " alt="" coords="296,104,444,130"/>
<area shape="poly" title=" " alt="" coords="502,87,426,106,425,101,501,82"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,55,248,80"/>
<area shape="poly" title=" " alt="" coords="285,70,249,70,249,65,285,65"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,80,55,106"/>
<area shape="poly" title=" " alt="" coords="88,85,55,91,54,86,87,80"/>
<area shape="poly" title=" " alt="" coords="301,102,228,84,230,78,302,97"/>
<area shape="poly" title=" " alt="" coords="280,113,55,97,55,92,281,108"/>
</map>
</div>

</div>
</div>
<a id="a2db9bbd57a908c5c454fc6254f57dcff" name="a2db9bbd57a908c5c454fc6254f57dcff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2db9bbd57a908c5c454fc6254f57dcff">&#9670;&#160;</a></span>yh_util_generate_ec_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_util_generate_ec_key </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__session.html">yh_session</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *</td>          <td class="paramname"><span class="paramname"><em>key_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>label</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a></td>          <td class="paramname"><span class="paramname"><em>domains</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structyh__capabilities.html">yh_capabilities</a> *</td>          <td class="paramname"><span class="paramname"><em>capabilities</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55ca">yh_algorithm</a></td>          <td class="paramname"><span class="paramname"><em>algorithm</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Generate an Elliptic Curve key in the device</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>Authenticated session to use </td></tr>
    <tr><td class="paramname">key_id</td><td>Object ID of the key. 0 if the Object ID should be generated by the device </td></tr>
    <tr><td class="paramname">label</td><td>Label of the key. Maximum length is <a class="el" href="yubihsm_8h.html#a431f8b753552a8b2f5f980e871b6d019" title="Max length of object labels.">YH_OBJ_LABEL_LEN</a> </td></tr>
    <tr><td class="paramname">domains</td><td>Domains to which the key belongs. See <a class="el" href="yubihsm_8h.html#a96a4c751a281515d5610adb8fd779438">yh_string_to_domains()</a> </td></tr>
    <tr><td class="paramname">capabilities</td><td>Capabilities of the key. See <a class="el" href="yubihsm_8h.html#aab440e1cb671d9ba7a2e7d1243960e42">yh_string_to_capabilities()</a> </td></tr>
    <tr><td class="paramname">algorithm</td><td>Algorithm to use to generate the EC key. Supported algorithm: <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caaedcbc07d82b18ca5c21eb3379a6cc010" title="ecp224">YH_ALGO_EC_P224</a>, <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caae4b191baf5c65f9234120080264d129b" title="ecp256">YH_ALGO_EC_P256</a>, <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caad423056b13955068935dc8b3ac0e65d1" title="eck256">YH_ALGO_EC_K256</a>, <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caabd995726d45b6dd2388775db4767c80d" title="ecbp256">YH_ALGO_EC_BP256</a>, <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa31094c17c66e4c365ca3dad353bc8bda" title="ecp384">YH_ALGO_EC_P384</a>, <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa228fd3332b55c60438dfea6a1b09af36" title="ecbp384">YH_ALGO_EC_BP384</a>, <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caab9c1be17b7b3f755346ff8c3cca3ed25" title="ecbp512">YH_ALGO_EC_BP512</a> and <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa05aec903fd67851f968aaa606fe2138a" title="ecp521">YH_ALGO_EC_P521</a>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> input parameters are NULL or the algorithm is not one of <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caaedcbc07d82b18ca5c21eb3379a6cc010" title="ecp224">YH_ALGO_EC_P224</a>, <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caae4b191baf5c65f9234120080264d129b" title="ecp256">YH_ALGO_EC_P256</a>, <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caad423056b13955068935dc8b3ac0e65d1" title="eck256">YH_ALGO_EC_K256</a>, <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caabd995726d45b6dd2388775db4767c80d" title="ecbp256">YH_ALGO_EC_BP256</a>, <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa31094c17c66e4c365ca3dad353bc8bda" title="ecp384">YH_ALGO_EC_P384</a>, <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa228fd3332b55c60438dfea6a1b09af36" title="ecbp384">YH_ALGO_EC_BP384</a>, <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caab9c1be17b7b3f755346ff8c3cca3ed25" title="ecbp512">YH_ALGO_EC_BP512</a> or <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa05aec903fd67851f968aaa606fe2138a" title="ecp521">YH_ALGO_EC_P521</a>. See <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> for other possible errors </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l01913">1913</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1916</span>                                                      {</div>
<div class="line"><span class="lineno"> 1917</span> </div>
<div class="line"><span class="lineno"> 1918</span>  <span class="keywordflow">if</span> (!<a class="code hl_function" href="#a3032a8f45bfad36ed6157b0158dd7921">yh_is_ec</a>(<a class="code hl_variable" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>)) {</div>
<div class="line"><span class="lineno"> 1919</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Invalid algorithm %d&quot;</span>, <a class="code hl_variable" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>);</div>
<div class="line"><span class="lineno"> 1920</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 1921</span>  }</div>
<div class="line"><span class="lineno"> 1922</span> </div>
<div class="line"><span class="lineno"> 1923</span>  <span class="keywordflow">return</span> generate_key(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a5420fd4d2f76428942c2716b1cb7e863">domains</a>, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>, <a class="code hl_variable" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>);</div>
<div class="line"><span class="lineno"> 1924</span>}</div>
<div class="ttc" id="ayubihsm_8c_html_a3032a8f45bfad36ed6157b0158dd7921"><div class="ttname"><a href="#a3032a8f45bfad36ed6157b0158dd7921">yh_is_ec</a></div><div class="ttdeci">bool yh_is_ec(yh_algorithm algorithm)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l04260">yubihsm.c:4260</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a2db9bbd57a908c5c454fc6254f57dcff_cgraph.png" border="0" usemap="#ayubihsm_8c_a2db9bbd57a908c5c454fc6254f57dcff_cgraph" alt=""/></div>
<map name="ayubihsm_8c_a2db9bbd57a908c5c454fc6254f57dcff_cgraph" id="ayubihsm_8c_a2db9bbd57a908c5c454fc6254f57dcff_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,171,31"/>
<area shape="rect" href="yubihsm_8c.html#a3032a8f45bfad36ed6157b0158dd7921" title=" " alt="" coords="219,5,292,31"/>
<area shape="poly" title=" " alt="" coords="171,16,203,16,203,21,171,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a2db9bbd57a908c5c454fc6254f57dcff_icgraph.png" border="0" usemap="#ayubihsm_8c_a2db9bbd57a908c5c454fc6254f57dcff_icgraph" alt=""/></div>
<map name="ayubihsm_8c_a2db9bbd57a908c5c454fc6254f57dcff_icgraph" id="ayubihsm_8c_a2db9bbd57a908c5c454fc6254f57dcff_icgraph">
<area shape="rect" title=" " alt="" coords="543,111,709,137"/>
<area shape="rect" href="structsysio_1_1wallet_1_1detail_1_1yubihsm__wallet__impl.html#a6266bcd9001ddbb02101bea6088f299b" title=" " alt="" coords="320,5,471,61"/>
<area shape="poly" title=" " alt="" coords="576,107,467,64,469,59,578,102"/>
<area shape="rect" href="attest_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="371,86,420,111"/>
<area shape="poly" title=" " alt="" coords="528,116,420,104,421,98,528,110"/>
<area shape="rect" href="commands_8c.html#ae2e50929acc6085cd395d0bd4ddb02db" title=" " alt="" coords="326,135,465,161"/>
<area shape="poly" title=" " alt="" coords="528,137,466,143,465,138,528,131"/>
<area shape="rect" href="commands_8c.html#aa1c71ebc2b3f298b6522ab090393c73e" title=" " alt="" coords="296,184,495,210"/>
<area shape="poly" title=" " alt="" coords="580,145,496,176,458,186,456,181,495,171,578,140"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,135,248,161"/>
<area shape="poly" title=" " alt="" coords="311,150,248,150,248,145,311,145"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,160,55,186"/>
<area shape="poly" title=" " alt="" coords="88,166,55,172,54,166,87,161"/>
<area shape="poly" title=" " alt="" coords="319,183,235,164,237,159,321,178"/>
<area shape="poly" title=" " alt="" coords="280,192,55,177,55,172,281,187"/>
</map>
</div>

</div>
</div>
<a id="a41f4326fe736e99302442d6a6109edbc" name="a41f4326fe736e99302442d6a6109edbc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a41f4326fe736e99302442d6a6109edbc">&#9670;&#160;</a></span>yh_util_generate_ed_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_util_generate_ed_key </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__session.html">yh_session</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *</td>          <td class="paramname"><span class="paramname"><em>key_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>label</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a></td>          <td class="paramname"><span class="paramname"><em>domains</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structyh__capabilities.html">yh_capabilities</a> *</td>          <td class="paramname"><span class="paramname"><em>capabilities</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55ca">yh_algorithm</a></td>          <td class="paramname"><span class="paramname"><em>algorithm</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Generate an ED key in the device</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>Authenticated session to use </td></tr>
    <tr><td class="paramname">key_id</td><td>Object ID of the key. 0 if the Object ID should be generated by the device </td></tr>
    <tr><td class="paramname">label</td><td>Label for the key. Maximum length <a class="el" href="yubihsm_8h.html#a431f8b753552a8b2f5f980e871b6d019" title="Max length of object labels.">YH_OBJ_LABEL_LEN</a> </td></tr>
    <tr><td class="paramname">domains</td><td>Domains to which the key belongs. See <a class="el" href="yubihsm_8h.html#a96a4c751a281515d5610adb8fd779438">yh_string_to_domains()</a> </td></tr>
    <tr><td class="paramname">capabilities</td><td>Capabilities of the ED key. See <a class="el" href="yubihsm_8h.html#aab440e1cb671d9ba7a2e7d1243960e42">yh_string_to_capabilities()</a> </td></tr>
    <tr><td class="paramname">algorithm</td><td>Algorithm to use to generate the ED key. Supported algorithm: <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa68c2c97f16c36f727e41a899d8a7e8bd" title="ed25519">YH_ALGO_EC_ED25519</a></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> input parameters are NULL or the algorithm is not <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa68c2c97f16c36f727e41a899d8a7e8bd" title="ed25519">YH_ALGO_EC_ED25519</a>. See <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> for other possible errors </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l01926">1926</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1929</span>                                                      {</div>
<div class="line"><span class="lineno"> 1930</span> </div>
<div class="line"><span class="lineno"> 1931</span>  <span class="keywordflow">if</span> (!<a class="code hl_function" href="#a16fbf4426acbf42695c4ec4738b6ae8a">yh_is_ed</a>(<a class="code hl_variable" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>)) {</div>
<div class="line"><span class="lineno"> 1932</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Invalid algorithm %d&quot;</span>, <a class="code hl_variable" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>);</div>
<div class="line"><span class="lineno"> 1933</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 1934</span>  }</div>
<div class="line"><span class="lineno"> 1935</span> </div>
<div class="line"><span class="lineno"> 1936</span>  <span class="keywordflow">return</span> generate_key(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a5420fd4d2f76428942c2716b1cb7e863">domains</a>, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>, <a class="code hl_variable" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>);</div>
<div class="line"><span class="lineno"> 1937</span>}</div>
<div class="ttc" id="ayubihsm_8c_html_a16fbf4426acbf42695c4ec4738b6ae8a"><div class="ttname"><a href="#a16fbf4426acbf42695c4ec4738b6ae8a">yh_is_ed</a></div><div class="ttdeci">bool yh_is_ed(yh_algorithm algorithm)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l04280">yubihsm.c:4280</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a41f4326fe736e99302442d6a6109edbc_cgraph.png" border="0" usemap="#ayubihsm_8c_a41f4326fe736e99302442d6a6109edbc_cgraph" alt=""/></div>
<map name="ayubihsm_8c_a41f4326fe736e99302442d6a6109edbc_cgraph" id="ayubihsm_8c_a41f4326fe736e99302442d6a6109edbc_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,171,31"/>
<area shape="rect" href="yubihsm_8c.html#a16fbf4426acbf42695c4ec4738b6ae8a" title=" " alt="" coords="219,5,292,31"/>
<area shape="poly" title=" " alt="" coords="171,16,203,16,203,21,171,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a41f4326fe736e99302442d6a6109edbc_icgraph.png" border="0" usemap="#ayubihsm_8c_a41f4326fe736e99302442d6a6109edbc_icgraph" alt=""/></div>
<map name="ayubihsm_8c_a41f4326fe736e99302442d6a6109edbc_icgraph" id="ayubihsm_8c_a41f4326fe736e99302442d6a6109edbc_icgraph">
<area shape="rect" title=" " alt="" coords="543,31,709,56"/>
<area shape="rect" href="commands_8c.html#ae2e50929acc6085cd395d0bd4ddb02db" title=" " alt="" coords="326,5,465,31"/>
<area shape="poly" title=" " alt="" coords="528,35,465,28,466,23,528,30"/>
<area shape="rect" href="commands_8c.html#aa1c71ebc2b3f298b6522ab090393c73e" title=" " alt="" coords="296,55,495,80"/>
<area shape="poly" title=" " alt="" coords="528,56,496,60,496,54,528,51"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="311,21,248,21,248,16,311,16"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,31,55,56"/>
<area shape="poly" title=" " alt="" coords="88,36,55,42,54,37,87,31"/>
<area shape="poly" title=" " alt="" coords="319,53,235,34,237,29,321,48"/>
<area shape="poly" title=" " alt="" coords="280,63,55,48,55,42,281,57"/>
</map>
</div>

</div>
</div>
<a id="a1eac22853548b7ceab92550c22233b18" name="a1eac22853548b7ceab92550c22233b18"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1eac22853548b7ceab92550c22233b18">&#9670;&#160;</a></span>yh_util_generate_hmac_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_util_generate_hmac_key </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__session.html">yh_session</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *</td>          <td class="paramname"><span class="paramname"><em>key_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>label</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a></td>          <td class="paramname"><span class="paramname"><em>domains</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structyh__capabilities.html">yh_capabilities</a> *</td>          <td class="paramname"><span class="paramname"><em>capabilities</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55ca">yh_algorithm</a></td>          <td class="paramname"><span class="paramname"><em>algorithm</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Generate an HMAC key in the device</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>Authenticated session to use </td></tr>
    <tr><td class="paramname">key_id</td><td>Object ID of the key. 0 if the Object ID should be generated by the device </td></tr>
    <tr><td class="paramname">label</td><td>Label of the key. Maximum length <a class="el" href="yubihsm_8h.html#a431f8b753552a8b2f5f980e871b6d019" title="Max length of object labels.">YH_OBJ_LABEL_LEN</a> </td></tr>
    <tr><td class="paramname">domains</td><td>Domains to which the key belongs. See <a class="el" href="yubihsm_8h.html#a96a4c751a281515d5610adb8fd779438">yh_string_to_domains()</a> </td></tr>
    <tr><td class="paramname">capabilities</td><td>Capabilities of the key. See <a class="el" href="yubihsm_8h.html#aab440e1cb671d9ba7a2e7d1243960e42">yh_string_to_capabilities()</a> </td></tr>
    <tr><td class="paramname">algorithm</td><td>Algorithm to use to generate the HMAC key. Supported algorithims: <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa942e65c8cd0034eebe9a20c2297c7b06" title="hmac-sha1">YH_ALGO_HMAC_SHA1</a>, <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caab0a0e1eb424b61057f159f1e53311f5c" title="hmac-sha256">YH_ALGO_HMAC_SHA256</a>, <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa781e7ca62563917d2129bde8ec53401b" title="hmac-sha384">YH_ALGO_HMAC_SHA384</a> and <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa72d6c7ea77f10e39bbadc8b58d55b9ec" title="hmac-sha512">YH_ALGO_HMAC_SHA512</a></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> input parameters are NULL. See <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> for other possible errors </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l01992">1992</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1995</span>                                                        {</div>
<div class="line"><span class="lineno"> 1996</span> </div>
<div class="line"><span class="lineno"> 1997</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a> == NULL || <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> == NULL || strlen(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>) &gt; <a class="code hl_define" href="yubihsm_8h.html#a431f8b753552a8b2f5f980e871b6d019">YH_OBJ_LABEL_LEN</a> ||</div>
<div class="line"><span class="lineno"> 1998</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a> == NULL) {</div>
<div class="line"><span class="lineno"> 1999</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>));</div>
<div class="line"><span class="lineno"> 2000</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 2001</span>  }</div>
<div class="line"><span class="lineno"> 2002</span> </div>
<div class="line"><span class="lineno"> 2003</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 2004</span> </div>
<div class="line"><span class="lineno"> 2005</span><span class="preprocessor">#pragma pack(push, 1)</span></div>
<div class="line"><span class="lineno"> 2006</span>  <span class="keyword">union </span>{</div>
<div class="line"><span class="lineno"> 2007</span>    <span class="keyword">struct </span>{</div>
<div class="line"><span class="lineno"> 2008</span>      <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>;</div>
<div class="line"><span class="lineno"> 2009</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>[<a class="code hl_define" href="yubihsm_8h.html#a431f8b753552a8b2f5f980e871b6d019">YH_OBJ_LABEL_LEN</a>];</div>
<div class="line"><span class="lineno"> 2010</span>      <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a5420fd4d2f76428942c2716b1cb7e863">domains</a>;</div>
<div class="line"><span class="lineno"> 2011</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>[<a class="code hl_define" href="yubihsm_8h.html#ad3c904849d17cae0a6f426e8007731d7">YH_CAPABILITIES_LEN</a>];</div>
<div class="line"><span class="lineno"> 2012</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>;</div>
<div class="line"><span class="lineno"> 2013</span>    };</div>
<div class="line"><span class="lineno"> 2014</span>    <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a855e99b645b13e7905d074d02fe0bff5">buf</a>[1];</div>
<div class="line"><span class="lineno"> 2015</span>  } data;</div>
<div class="line"><span class="lineno"> 2016</span>  <span class="keyword">union </span>{</div>
<div class="line"><span class="lineno"> 2017</span>    <span class="keyword">struct </span>{</div>
<div class="line"><span class="lineno"> 2018</span>      <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>;</div>
<div class="line"><span class="lineno"> 2019</span>    };</div>
<div class="line"><span class="lineno"> 2020</span>    <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a855e99b645b13e7905d074d02fe0bff5">buf</a>[1];</div>
<div class="line"><span class="lineno"> 2021</span>  } response;</div>
<div class="line"><span class="lineno"> 2022</span><span class="preprocessor">#pragma pack(pop)</span></div>
<div class="line"><span class="lineno"> 2023</span> </div>
<div class="line"><span class="lineno"> 2024</span>  <span class="keywordtype">size_t</span> response_len = <span class="keyword">sizeof</span>(response);</div>
<div class="line"><span class="lineno"> 2025</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7e">yh_cmd</a> response_cmd;</div>
<div class="line"><span class="lineno"> 2026</span> </div>
<div class="line"><span class="lineno"> 2027</span>  data.key_id = htons(*<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>);</div>
<div class="line"><span class="lineno"> 2028</span> </div>
<div class="line"><span class="lineno"> 2029</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(data.label, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>, strlen(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>));</div>
<div class="line"><span class="lineno"> 2030</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105">memset</a>(data.label + strlen(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>), 0, <a class="code hl_define" href="yubihsm_8h.html#a431f8b753552a8b2f5f980e871b6d019">YH_OBJ_LABEL_LEN</a> - strlen(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>));</div>
<div class="line"><span class="lineno"> 2031</span> </div>
<div class="line"><span class="lineno"> 2032</span>  data.domains = htons(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a5420fd4d2f76428942c2716b1cb7e863">domains</a>);</div>
<div class="line"><span class="lineno"> 2033</span> </div>
<div class="line"><span class="lineno"> 2034</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(data.capabilities, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>, <a class="code hl_define" href="yubihsm_8h.html#ad3c904849d17cae0a6f426e8007731d7">YH_CAPABILITIES_LEN</a>);</div>
<div class="line"><span class="lineno"> 2035</span> </div>
<div class="line"><span class="lineno"> 2036</span>  data.algorithm = <a class="code hl_variable" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>;</div>
<div class="line"><span class="lineno"> 2037</span> </div>
<div class="line"><span class="lineno"> 2038</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> =</div>
<div class="line"><span class="lineno"> 2039</span>    <a class="code hl_function" href="#a4c26f003b72e800e9c934bca922a404a">yh_send_secure_msg</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, YHC_GENERATE_HMAC_KEY, data.buf, <span class="keyword">sizeof</span>(data),</div>
<div class="line"><span class="lineno"> 2040</span>                       &amp;response_cmd, response.buf, &amp;response_len);</div>
<div class="line"><span class="lineno"> 2041</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 2042</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Failed to send GENERATE HMAC command: %s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 2043</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 2044</span>  }</div>
<div class="line"><span class="lineno"> 2045</span> </div>
<div class="line"><span class="lineno"> 2046</span>  <span class="keywordflow">if</span> (response_cmd == <a class="code hl_enumvalue" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7ea51cdf2ccd6995498e589e8ea6ce2a1f2">YHC_ERROR</a>) {</div>
<div class="line"><span class="lineno"> 2047</span>    <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> translated = translate_device_error(response.buf[0]);</div>
<div class="line"><span class="lineno"> 2048</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Unable to generate key: %s (%x)&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(translated),</div>
<div class="line"><span class="lineno"> 2049</span>            response.buf[0]);</div>
<div class="line"><span class="lineno"> 2050</span>    <span class="keywordflow">return</span> translated;</div>
<div class="line"><span class="lineno"> 2051</span>  }</div>
<div class="line"><span class="lineno"> 2052</span> </div>
<div class="line"><span class="lineno"> 2053</span>  *<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a> = ntohs(response.key_id);</div>
<div class="line"><span class="lineno"> 2054</span>  <a class="code hl_define" href="debug__lib_8h.html#a8c4742440a149ad8bcb5d58ae76c5ed3">DBG_INFO</a>(<span class="stringliteral">&quot;Generated HMAC key 0x%04x&quot;</span>, *<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>);</div>
<div class="line"><span class="lineno"> 2055</span> </div>
<div class="line"><span class="lineno"> 2056</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 2057</span>}</div>
<div class="ttc" id="ayubihsm_8h_html_a431f8b753552a8b2f5f980e871b6d019"><div class="ttname"><a href="yubihsm_8h.html#a431f8b753552a8b2f5f980e871b6d019">YH_OBJ_LABEL_LEN</a></div><div class="ttdeci">#define YH_OBJ_LABEL_LEN</div><div class="ttdoc">Max length of object labels.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00123">yubihsm.h:123</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a1eac22853548b7ceab92550c22233b18_cgraph.png" border="0" usemap="#ayubihsm_8c_a1eac22853548b7ceab92550c22233b18_cgraph" alt=""/></div>
<map name="ayubihsm_8c_a1eac22853548b7ceab92550c22233b18_cgraph" id="ayubihsm_8c_a1eac22853548b7ceab92550c22233b18_cgraph">
<area shape="rect" title=" " alt="" coords="5,129,189,155"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="662,5,734,31"/>
<area shape="poly" title=" " alt="" coords="131,126,236,89,333,60,433,40,547,25,647,18,647,23,548,30,433,45,334,65,237,94,133,131"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="664,179,732,204"/>
<area shape="poly" title=" " alt="" coords="189,152,237,157,468,175,649,186,649,192,467,181,236,162,189,157"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="237,104,385,130"/>
<area shape="poly" title=" " alt="" coords="189,129,221,125,222,130,189,134"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="656,104,740,130"/>
<area shape="poly" title=" " alt="" coords="189,146,378,152,488,149,598,140,641,131,642,136,599,145,489,154,378,157,189,152"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="433,104,598,130"/>
<area shape="poly" title=" " alt="" coords="385,114,417,114,417,120,385,120"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="450,55,581,80"/>
<area shape="poly" title=" " alt="" coords="367,101,444,82,445,87,368,106"/>
<area shape="poly" title=" " alt="" coords="575,101,597,91,612,79,621,67,630,54,645,40,650,37,653,41,648,44,634,57,625,70,615,83,600,95,577,106"/>
<area shape="poly" title=" " alt="" coords="550,128,651,170,649,175,548,133"/>
<area shape="poly" title=" " alt="" coords="599,114,641,114,641,120,599,120"/>
<area shape="poly" title=" " alt="" coords="565,51,647,29,648,34,567,57"/>
<area shape="poly" title=" " alt="" coords="567,78,642,99,641,104,565,84"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="646,55,750,80"/>
<area shape="poly" title=" " alt="" coords="581,65,631,65,631,70,581,70"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a1eac22853548b7ceab92550c22233b18_icgraph.png" border="0" usemap="#ayubihsm_8c_a1eac22853548b7ceab92550c22233b18_icgraph" alt=""/></div>
<map name="ayubihsm_8c_a1eac22853548b7ceab92550c22233b18_icgraph" id="ayubihsm_8c_a1eac22853548b7ceab92550c22233b18_icgraph">
<area shape="rect" title=" " alt="" coords="507,55,691,80"/>
<area shape="rect" href="generate__hmac_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="353,5,402,31"/>
<area shape="poly" title=" " alt="" coords="523,53,402,26,403,21,524,48"/>
<area shape="rect" href="commands_8c.html#ae2e50929acc6085cd395d0bd4ddb02db" title=" " alt="" coords="308,55,447,80"/>
<area shape="poly" title=" " alt="" coords="492,70,447,70,447,65,492,65"/>
<area shape="rect" href="commands_8c.html#a2be1be0e0a454965f5a378e4ecb483f0" title=" " alt="" coords="296,104,459,130"/>
<area shape="poly" title=" " alt="" coords="524,87,439,106,438,101,522,82"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,55,248,80"/>
<area shape="poly" title=" " alt="" coords="293,70,249,70,249,65,293,65"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,80,55,106"/>
<area shape="poly" title=" " alt="" coords="88,85,55,91,54,86,87,80"/>
<area shape="poly" title=" " alt="" coords="306,102,231,84,232,78,308,97"/>
<area shape="poly" title=" " alt="" coords="280,113,55,97,55,92,281,108"/>
</map>
</div>

</div>
</div>
<a id="a9e130d225a8dc003d7a7c0ce4b8ea5e4" name="a9e130d225a8dc003d7a7c0ce4b8ea5e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e130d225a8dc003d7a7c0ce4b8ea5e4">&#9670;&#160;</a></span>yh_util_generate_otp_aead_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_util_generate_otp_aead_key </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__session.html">yh_session</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *</td>          <td class="paramname"><span class="paramname"><em>key_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>label</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a></td>          <td class="paramname"><span class="paramname"><em>domains</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structyh__capabilities.html">yh_capabilities</a> *</td>          <td class="paramname"><span class="paramname"><em>capabilities</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55ca">yh_algorithm</a></td>          <td class="paramname"><span class="paramname"><em>algorithm</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a></td>          <td class="paramname"><span class="paramname"><em>nonce_id</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Generate an <a class="el" href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583a02c5f683fde147de6a9e1043f971f5f0" title="OTP AEAD Key is a secret key used to decrypt Yubico OTP values.">YH_OTP_AEAD_KEY</a> for Yubico OTP decryption in the device.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>Authenticated session to use </td></tr>
    <tr><td class="paramname">key_id</td><td>Object ID of the AEAD Key. 0 if the Object ID should be generated by the device </td></tr>
    <tr><td class="paramname">label</td><td>Label of the AEAD Key. Maximum length is <a class="el" href="yubihsm_8h.html#a431f8b753552a8b2f5f980e871b6d019" title="Max length of object labels.">YH_OBJ_LABEL_LEN</a> </td></tr>
    <tr><td class="paramname">domains</td><td>Domains the AEAD Key will be operating within. See <a class="el" href="yubihsm_8h.html#a96a4c751a281515d5610adb8fd779438">yh_string_to_domains()</a> </td></tr>
    <tr><td class="paramname">capabilities</td><td>Capabilities of the AEAD Key. See <a class="el" href="yubihsm_8h.html#aab440e1cb671d9ba7a2e7d1243960e42">yh_string_to_capabilities()</a> </td></tr>
    <tr><td class="paramname">algorithm</td><td>Algorithm used to generate the AEAD Key. Supported algorithms: <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa62e7ba4126ae16faeafb28972a4e0959" title="aes128-yubico-otp">YH_ALGO_AES128_YUBICO_OTP</a>, <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa62dd31db747b4b7f81d9e30877a0b720" title="aes192-yubico-otp">YH_ALGO_AES192_YUBICO_OTP</a> and <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caad1558532867577d1d77c84f1ae632acd" title="aes256-yubico-otp">YH_ALGO_AES256_YUBICO_OTP</a> </td></tr>
    <tr><td class="paramname">nonce_id</td><td>Nonce ID</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> if input parameters are NULL. See <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> for other possible errors </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l03422">3422</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3425</span>                                                                               {</div>
<div class="line"><span class="lineno"> 3426</span> </div>
<div class="line"><span class="lineno"> 3427</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a> == NULL || <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a> == NULL || <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> == NULL ||</div>
<div class="line"><span class="lineno"> 3428</span>      strlen(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>) &gt; <a class="code hl_define" href="yubihsm_8h.html#a431f8b753552a8b2f5f980e871b6d019">YH_OBJ_LABEL_LEN</a> || <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a> == NULL) {</div>
<div class="line"><span class="lineno"> 3429</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>));</div>
<div class="line"><span class="lineno"> 3430</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 3431</span>  }</div>
<div class="line"><span class="lineno"> 3432</span> </div>
<div class="line"><span class="lineno"> 3433</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 3434</span> </div>
<div class="line"><span class="lineno"> 3435</span><span class="preprocessor">#pragma pack(push, 1)</span></div>
<div class="line"><span class="lineno"> 3436</span>  <span class="keyword">union </span>{</div>
<div class="line"><span class="lineno"> 3437</span>    <span class="keyword">struct </span>{</div>
<div class="line"><span class="lineno"> 3438</span>      <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>;</div>
<div class="line"><span class="lineno"> 3439</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>[<a class="code hl_define" href="yubihsm_8h.html#a431f8b753552a8b2f5f980e871b6d019">YH_OBJ_LABEL_LEN</a>];</div>
<div class="line"><span class="lineno"> 3440</span>      <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a5420fd4d2f76428942c2716b1cb7e863">domains</a>;</div>
<div class="line"><span class="lineno"> 3441</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>[<a class="code hl_define" href="yubihsm_8h.html#ad3c904849d17cae0a6f426e8007731d7">YH_CAPABILITIES_LEN</a>];</div>
<div class="line"><span class="lineno"> 3442</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>;</div>
<div class="line"><span class="lineno"> 3443</span>      <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> nonce_id;</div>
<div class="line"><span class="lineno"> 3444</span>    };</div>
<div class="line"><span class="lineno"> 3445</span>    <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a855e99b645b13e7905d074d02fe0bff5">buf</a>[1];</div>
<div class="line"><span class="lineno"> 3446</span>  } data;</div>
<div class="line"><span class="lineno"> 3447</span>  <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> data_len = <span class="keyword">sizeof</span>(data);</div>
<div class="line"><span class="lineno"> 3448</span>  <span class="keyword">union </span>{</div>
<div class="line"><span class="lineno"> 3449</span>    <span class="keyword">struct </span>{</div>
<div class="line"><span class="lineno"> 3450</span>      <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>;</div>
<div class="line"><span class="lineno"> 3451</span>    };</div>
<div class="line"><span class="lineno"> 3452</span>    <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a855e99b645b13e7905d074d02fe0bff5">buf</a>[1];</div>
<div class="line"><span class="lineno"> 3453</span>  } response;</div>
<div class="line"><span class="lineno"> 3454</span><span class="preprocessor">#pragma pack(pop)</span></div>
<div class="line"><span class="lineno"> 3455</span> </div>
<div class="line"><span class="lineno"> 3456</span>  <span class="keywordtype">size_t</span> response_len = <span class="keyword">sizeof</span>(response);</div>
<div class="line"><span class="lineno"> 3457</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7e">yh_cmd</a> response_cmd;</div>
<div class="line"><span class="lineno"> 3458</span> </div>
<div class="line"><span class="lineno"> 3459</span>  data.key_id = htons(*<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>);</div>
<div class="line"><span class="lineno"> 3460</span> </div>
<div class="line"><span class="lineno"> 3461</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(data.label, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>, strlen(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>));</div>
<div class="line"><span class="lineno"> 3462</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105">memset</a>(data.label + strlen(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>), 0, <a class="code hl_define" href="yubihsm_8h.html#a431f8b753552a8b2f5f980e871b6d019">YH_OBJ_LABEL_LEN</a> - strlen(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>));</div>
<div class="line"><span class="lineno"> 3463</span> </div>
<div class="line"><span class="lineno"> 3464</span>  data.domains = htons(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a5420fd4d2f76428942c2716b1cb7e863">domains</a>);</div>
<div class="line"><span class="lineno"> 3465</span> </div>
<div class="line"><span class="lineno"> 3466</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(data.capabilities, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>, <a class="code hl_define" href="yubihsm_8h.html#ad3c904849d17cae0a6f426e8007731d7">YH_CAPABILITIES_LEN</a>);</div>
<div class="line"><span class="lineno"> 3467</span> </div>
<div class="line"><span class="lineno"> 3468</span>  data.algorithm = <a class="code hl_variable" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>;</div>
<div class="line"><span class="lineno"> 3469</span> </div>
<div class="line"><span class="lineno"> 3470</span>  data.nonce_id = nonce_id;</div>
<div class="line"><span class="lineno"> 3471</span> </div>
<div class="line"><span class="lineno"> 3472</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> =</div>
<div class="line"><span class="lineno"> 3473</span>    <a class="code hl_function" href="#a4c26f003b72e800e9c934bca922a404a">yh_send_secure_msg</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, YHC_GENERATE_OTP_AEAD_KEY, data.buf, data_len,</div>
<div class="line"><span class="lineno"> 3474</span>                       &amp;response_cmd, response.buf, &amp;response_len);</div>
<div class="line"><span class="lineno"> 3475</span>  <a class="code hl_define" href="insecure__memzero_8h.html#a0794f9275fd1036ecba6ff0a901a320b">insecure_memzero</a>(data.buf, data_len);</div>
<div class="line"><span class="lineno"> 3476</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 3477</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Failed to send GENERATE OTP AEAD KEY command: %s&quot;</span>,</div>
<div class="line"><span class="lineno"> 3478</span>            <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 3479</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 3480</span>  }</div>
<div class="line"><span class="lineno"> 3481</span> </div>
<div class="line"><span class="lineno"> 3482</span>  <span class="keywordflow">if</span> (response_cmd == <a class="code hl_enumvalue" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7ea51cdf2ccd6995498e589e8ea6ce2a1f2">YHC_ERROR</a>) {</div>
<div class="line"><span class="lineno"> 3483</span>    <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> translated = translate_device_error(response.buf[0]);</div>
<div class="line"><span class="lineno"> 3484</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Unable to generate key: %s (%x)&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(translated),</div>
<div class="line"><span class="lineno"> 3485</span>            response.buf[0]);</div>
<div class="line"><span class="lineno"> 3486</span>    <span class="keywordflow">return</span> translated;</div>
<div class="line"><span class="lineno"> 3487</span>  }</div>
<div class="line"><span class="lineno"> 3488</span> </div>
<div class="line"><span class="lineno"> 3489</span>  *<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a> = ntohs(response.key_id);</div>
<div class="line"><span class="lineno"> 3490</span>  <a class="code hl_define" href="debug__lib_8h.html#a8c4742440a149ad8bcb5d58ae76c5ed3">DBG_INFO</a>(<span class="stringliteral">&quot;Generated OTP AEAD key 0x%04x\n&quot;</span>, *<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>);</div>
<div class="line"><span class="lineno"> 3491</span> </div>
<div class="line"><span class="lineno"> 3492</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 3493</span>}</div>
<div class="ttc" id="astdint_8h_html_a435d1572bf3f880d55459d9805097f62"><div class="ttname"><a href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a></div><div class="ttdeci">unsigned int uint32_t</div><div class="ttdef"><b>Definition</b> <a href="stdint_8h_source.html#l00126">stdint.h:126</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a9e130d225a8dc003d7a7c0ce4b8ea5e4_cgraph.png" border="0" usemap="#ayubihsm_8c_a9e130d225a8dc003d7a7c0ce4b8ea5e4_cgraph" alt=""/></div>
<map name="ayubihsm_8c_a9e130d225a8dc003d7a7c0ce4b8ea5e4_cgraph" id="ayubihsm_8c_a9e130d225a8dc003d7a7c0ce4b8ea5e4_cgraph">
<area shape="rect" title=" " alt="" coords="5,122,147,162"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="620,5,692,31"/>
<area shape="poly" title=" " alt="" coords="120,119,194,89,291,59,391,40,505,25,605,18,605,23,506,30,391,45,292,64,196,94,122,124"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="622,179,690,204"/>
<area shape="poly" title=" " alt="" coords="148,151,195,157,426,176,607,187,607,192,425,182,194,162,147,156"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="195,104,343,130"/>
<area shape="poly" title=" " alt="" coords="147,130,179,126,180,131,147,136"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="614,104,698,130"/>
<area shape="poly" title=" " alt="" coords="147,145,333,151,444,149,556,140,599,131,600,136,557,145,445,154,333,157,147,150"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="391,104,556,130"/>
<area shape="poly" title=" " alt="" coords="343,114,375,114,375,120,343,120"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="408,55,539,80"/>
<area shape="poly" title=" " alt="" coords="325,101,402,82,403,87,326,106"/>
<area shape="poly" title=" " alt="" coords="533,101,555,91,570,79,579,67,588,54,603,40,608,37,611,41,606,44,592,57,583,70,573,83,558,95,535,106"/>
<area shape="poly" title=" " alt="" coords="508,128,609,170,607,175,506,133"/>
<area shape="poly" title=" " alt="" coords="557,114,599,114,599,120,557,120"/>
<area shape="poly" title=" " alt="" coords="523,51,605,29,606,34,525,57"/>
<area shape="poly" title=" " alt="" coords="525,78,600,99,599,104,523,84"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="604,55,708,80"/>
<area shape="poly" title=" " alt="" coords="539,65,589,65,589,70,539,70"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a9e130d225a8dc003d7a7c0ce4b8ea5e4_icgraph.png" border="0" usemap="#ayubihsm_8c_a9e130d225a8dc003d7a7c0ce4b8ea5e4_icgraph" alt=""/></div>
<map name="ayubihsm_8c_a9e130d225a8dc003d7a7c0ce4b8ea5e4_icgraph" id="ayubihsm_8c_a9e130d225a8dc003d7a7c0ce4b8ea5e4_icgraph">
<area shape="rect" title=" " alt="" coords="493,47,635,88"/>
<area shape="rect" href="yubico__otp_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="346,5,395,31"/>
<area shape="poly" title=" " alt="" coords="478,48,395,27,397,22,479,43"/>
<area shape="rect" href="commands_8c.html#ae2e50929acc6085cd395d0bd4ddb02db" title=" " alt="" coords="302,55,440,80"/>
<area shape="poly" title=" " alt="" coords="478,70,440,70,440,65,478,65"/>
<area shape="rect" href="commands_8c.html#a13416d261c1a92415525cbfa63a2dc0c" title=" " alt="" coords="296,104,445,145"/>
<area shape="poly" title=" " alt="" coords="480,95,442,106,441,101,478,90"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,61,248,87"/>
<area shape="poly" title=" " alt="" coords="286,73,248,74,248,69,286,68"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,87,55,112"/>
<area shape="poly" title=" " alt="" coords="88,92,55,98,54,93,87,87"/>
<area shape="poly" title=" " alt="" coords="280,104,227,90,228,85,282,99"/>
<area shape="poly" title=" " alt="" coords="280,121,55,104,55,99,281,116"/>
</map>
</div>

</div>
</div>
<a id="ab1c62ef2643184a8ad44c569c87712d1" name="ab1c62ef2643184a8ad44c569c87712d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab1c62ef2643184a8ad44c569c87712d1">&#9670;&#160;</a></span>yh_util_generate_rsa_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_util_generate_rsa_key </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__session.html">yh_session</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *</td>          <td class="paramname"><span class="paramname"><em>key_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>label</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a></td>          <td class="paramname"><span class="paramname"><em>domains</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structyh__capabilities.html">yh_capabilities</a> *</td>          <td class="paramname"><span class="paramname"><em>capabilities</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55ca">yh_algorithm</a></td>          <td class="paramname"><span class="paramname"><em>algorithm</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Generate an RSA key in the device</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>Authenticated session to use </td></tr>
    <tr><td class="paramname">key_id</td><td>Object ID of the key. 0 if the Object ID should be generated by the device </td></tr>
    <tr><td class="paramname">label</td><td>Label of the key. Maximum length is <a class="el" href="yubihsm_8h.html#a431f8b753552a8b2f5f980e871b6d019" title="Max length of object labels.">YH_OBJ_LABEL_LEN</a> </td></tr>
    <tr><td class="paramname">domains</td><td>Domains to which the key belongs. See <a class="el" href="yubihsm_8h.html#a96a4c751a281515d5610adb8fd779438">yh_string_to_domains()</a> </td></tr>
    <tr><td class="paramname">capabilities</td><td>Capabilities of the key. See <a class="el" href="yubihsm_8h.html#aab440e1cb671d9ba7a2e7d1243960e42">yh_string_to_capabilities()</a> </td></tr>
    <tr><td class="paramname">algorithm</td><td>Algorithm to use to generate the RSA key. Supported algorithms: <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caaafe94e6a770edb51c6db84f77d98d2c6" title="rsa2048">YH_ALGO_RSA_2048</a>, <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caafd3fbd9ed86caf267ccc77cb24d44426" title="rsa3072">YH_ALGO_RSA_3072</a> and <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caae5963322a0a0f43a1b74faa78e3a7329" title="rsa4096">YH_ALGO_RSA_4096</a></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> input parameters are NULL or the algorithm is not one of <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caaafe94e6a770edb51c6db84f77d98d2c6" title="rsa2048">YH_ALGO_RSA_2048</a>, <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caafd3fbd9ed86caf267ccc77cb24d44426" title="rsa3072">YH_ALGO_RSA_3072</a> or <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caae5963322a0a0f43a1b74faa78e3a7329" title="rsa4096">YH_ALGO_RSA_4096</a>. See <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> for other possible errors </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l01900">1900</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1903</span>                                                       {</div>
<div class="line"><span class="lineno"> 1904</span> </div>
<div class="line"><span class="lineno"> 1905</span>  <span class="keywordflow">if</span> (!<a class="code hl_function" href="#a0a67155f2a7970ecb52e4f6aac6bbe84">yh_is_rsa</a>(<a class="code hl_variable" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>)) {</div>
<div class="line"><span class="lineno"> 1906</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Invalid algorithm %d&quot;</span>, <a class="code hl_variable" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>);</div>
<div class="line"><span class="lineno"> 1907</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 1908</span>  }</div>
<div class="line"><span class="lineno"> 1909</span> </div>
<div class="line"><span class="lineno"> 1910</span>  <span class="keywordflow">return</span> generate_key(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a5420fd4d2f76428942c2716b1cb7e863">domains</a>, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>, <a class="code hl_variable" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>);</div>
<div class="line"><span class="lineno"> 1911</span>}</div>
<div class="ttc" id="ayubihsm_8c_html_a0a67155f2a7970ecb52e4f6aac6bbe84"><div class="ttname"><a href="#a0a67155f2a7970ecb52e4f6aac6bbe84">yh_is_rsa</a></div><div class="ttdeci">bool yh_is_rsa(yh_algorithm algorithm)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l04245">yubihsm.c:4245</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_ab1c62ef2643184a8ad44c569c87712d1_cgraph.png" border="0" usemap="#ayubihsm_8c_ab1c62ef2643184a8ad44c569c87712d1_cgraph" alt=""/></div>
<map name="ayubihsm_8c_ab1c62ef2643184a8ad44c569c87712d1_cgraph" id="ayubihsm_8c_ab1c62ef2643184a8ad44c569c87712d1_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,175,31"/>
<area shape="rect" href="yubihsm_8c.html#a0a67155f2a7970ecb52e4f6aac6bbe84" title=" " alt="" coords="223,5,300,31"/>
<area shape="poly" title=" " alt="" coords="175,16,207,16,207,21,175,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_ab1c62ef2643184a8ad44c569c87712d1_icgraph.png" border="0" usemap="#ayubihsm_8c_ab1c62ef2643184a8ad44c569c87712d1_icgraph" alt=""/></div>
<map name="ayubihsm_8c_ab1c62ef2643184a8ad44c569c87712d1_icgraph" id="ayubihsm_8c_ab1c62ef2643184a8ad44c569c87712d1_icgraph">
<area shape="rect" title=" " alt="" coords="543,80,713,106"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#a0d58173720fcc1219a584ff8041fdb4c" title=" " alt="" coords="376,5,415,31"/>
<area shape="poly" title=" " alt="" coords="580,76,495,45,415,24,416,19,496,40,582,71"/>
<area shape="rect" href="generate__rsa_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="371,55,420,80"/>
<area shape="poly" title=" " alt="" coords="528,85,420,73,421,67,528,79"/>
<area shape="rect" href="commands_8c.html#ae2e50929acc6085cd395d0bd4ddb02db" title=" " alt="" coords="326,104,465,130"/>
<area shape="poly" title=" " alt="" coords="528,106,466,112,465,107,528,100"/>
<area shape="rect" href="commands_8c.html#aa1c71ebc2b3f298b6522ab090393c73e" title=" " alt="" coords="296,153,495,179"/>
<area shape="poly" title=" " alt="" coords="581,114,496,145,458,155,456,150,495,140,579,109"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,104,248,130"/>
<area shape="poly" title=" " alt="" coords="311,120,248,120,248,114,311,114"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,129,55,155"/>
<area shape="poly" title=" " alt="" coords="88,135,55,141,54,135,87,130"/>
<area shape="poly" title=" " alt="" coords="319,152,235,133,237,128,321,147"/>
<area shape="poly" title=" " alt="" coords="280,161,55,146,55,141,281,156"/>
</map>
</div>

</div>
</div>
<a id="a1f749a696792e7911844629e056d9c15" name="a1f749a696792e7911844629e056d9c15"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f749a696792e7911844629e056d9c15">&#9670;&#160;</a></span>yh_util_generate_wrap_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_util_generate_wrap_key </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__session.html">yh_session</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *</td>          <td class="paramname"><span class="paramname"><em>key_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>label</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a></td>          <td class="paramname"><span class="paramname"><em>domains</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structyh__capabilities.html">yh_capabilities</a> *</td>          <td class="paramname"><span class="paramname"><em>capabilities</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55ca">yh_algorithm</a></td>          <td class="paramname"><span class="paramname"><em>algorithm</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structyh__capabilities.html">yh_capabilities</a> *</td>          <td class="paramname"><span class="paramname"><em>delegated_capabilities</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Generate a Wrap Key that can be used for export, import, wrap data and unwrap data in the device.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>Authenticated session to use </td></tr>
    <tr><td class="paramname">key_id</td><td>Object ID of the Wrap Key. 0 if the Object ID should be generated by the device </td></tr>
    <tr><td class="paramname">label</td><td>Label of the Wrap Key. Maximum length <a class="el" href="yubihsm_8h.html#a431f8b753552a8b2f5f980e871b6d019" title="Max length of object labels.">YH_OBJ_LABEL_LEN</a> </td></tr>
    <tr><td class="paramname">domains</td><td>Domains where the Wrap Key will be operating within. See <a class="el" href="yubihsm_8h.html#a96a4c751a281515d5610adb8fd779438">yh_string_to_domains()</a> </td></tr>
    <tr><td class="paramname">capabilities</td><td>Capabilities of the Wrap Key. See <a class="el" href="yubihsm_8h.html#aab440e1cb671d9ba7a2e7d1243960e42">yh_string_to_capabilities()</a> </td></tr>
    <tr><td class="paramname">algorithm</td><td>Algorithm used to generate the Wrap Key </td></tr>
    <tr><td class="paramname">delegated_capabilities</td><td>Delegated capabilitites of the Wrap Key. See <a class="el" href="yubihsm_8h.html#aab440e1cb671d9ba7a2e7d1243960e42">yh_string_to_capabilities()</a></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> if input parameters are NULL. See <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> for other possible errors</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583">yh_object_type</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l02458">2458</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2462</span>                                                                               {</div>
<div class="line"><span class="lineno"> 2463</span> </div>
<div class="line"><span class="lineno"> 2464</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a> == NULL || <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a> == NULL || <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> == NULL ||</div>
<div class="line"><span class="lineno"> 2465</span>      strlen(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>) &gt; <a class="code hl_define" href="yubihsm_8h.html#a431f8b753552a8b2f5f980e871b6d019">YH_OBJ_LABEL_LEN</a> || <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a> == NULL ||</div>
<div class="line"><span class="lineno"> 2466</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#afa62e10709d52e5162a732e81369a7ec">delegated_capabilities</a> == NULL) {</div>
<div class="line"><span class="lineno"> 2467</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>));</div>
<div class="line"><span class="lineno"> 2468</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 2469</span>  }</div>
<div class="line"><span class="lineno"> 2470</span> </div>
<div class="line"><span class="lineno"> 2471</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 2472</span> </div>
<div class="line"><span class="lineno"> 2473</span><span class="preprocessor">#pragma pack(push, 1)</span></div>
<div class="line"><span class="lineno"> 2474</span>  <span class="keyword">union </span>{</div>
<div class="line"><span class="lineno"> 2475</span>    <span class="keyword">struct </span>{</div>
<div class="line"><span class="lineno"> 2476</span>      <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>;</div>
<div class="line"><span class="lineno"> 2477</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>[<a class="code hl_define" href="yubihsm_8h.html#a431f8b753552a8b2f5f980e871b6d019">YH_OBJ_LABEL_LEN</a>];</div>
<div class="line"><span class="lineno"> 2478</span>      <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a5420fd4d2f76428942c2716b1cb7e863">domains</a>;</div>
<div class="line"><span class="lineno"> 2479</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>[<a class="code hl_define" href="yubihsm_8h.html#ad3c904849d17cae0a6f426e8007731d7">YH_CAPABILITIES_LEN</a>];</div>
<div class="line"><span class="lineno"> 2480</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>;</div>
<div class="line"><span class="lineno"> 2481</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#afa62e10709d52e5162a732e81369a7ec">delegated_capabilities</a>[<a class="code hl_define" href="yubihsm_8h.html#ad3c904849d17cae0a6f426e8007731d7">YH_CAPABILITIES_LEN</a>];</div>
<div class="line"><span class="lineno"> 2482</span>    };</div>
<div class="line"><span class="lineno"> 2483</span>    <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a855e99b645b13e7905d074d02fe0bff5">buf</a>[1];</div>
<div class="line"><span class="lineno"> 2484</span>  } data;</div>
<div class="line"><span class="lineno"> 2485</span>  <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> data_len = <span class="keyword">sizeof</span>(data);</div>
<div class="line"><span class="lineno"> 2486</span>  <span class="keyword">union </span>{</div>
<div class="line"><span class="lineno"> 2487</span>    <span class="keyword">struct </span>{</div>
<div class="line"><span class="lineno"> 2488</span>      <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>;</div>
<div class="line"><span class="lineno"> 2489</span>    };</div>
<div class="line"><span class="lineno"> 2490</span>    <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a855e99b645b13e7905d074d02fe0bff5">buf</a>[1];</div>
<div class="line"><span class="lineno"> 2491</span>  } response;</div>
<div class="line"><span class="lineno"> 2492</span><span class="preprocessor">#pragma pack(pop)</span></div>
<div class="line"><span class="lineno"> 2493</span> </div>
<div class="line"><span class="lineno"> 2494</span>  <span class="keywordtype">size_t</span> response_len = <span class="keyword">sizeof</span>(response);</div>
<div class="line"><span class="lineno"> 2495</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7e">yh_cmd</a> response_cmd;</div>
<div class="line"><span class="lineno"> 2496</span> </div>
<div class="line"><span class="lineno"> 2497</span>  data.key_id = htons(*<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>);</div>
<div class="line"><span class="lineno"> 2498</span> </div>
<div class="line"><span class="lineno"> 2499</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(data.label, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>, strlen(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>));</div>
<div class="line"><span class="lineno"> 2500</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105">memset</a>(data.label + strlen(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>), 0, <a class="code hl_define" href="yubihsm_8h.html#a431f8b753552a8b2f5f980e871b6d019">YH_OBJ_LABEL_LEN</a> - strlen(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>));</div>
<div class="line"><span class="lineno"> 2501</span> </div>
<div class="line"><span class="lineno"> 2502</span>  data.domains = htons(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a5420fd4d2f76428942c2716b1cb7e863">domains</a>);</div>
<div class="line"><span class="lineno"> 2503</span> </div>
<div class="line"><span class="lineno"> 2504</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(data.capabilities, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>, <a class="code hl_define" href="yubihsm_8h.html#ad3c904849d17cae0a6f426e8007731d7">YH_CAPABILITIES_LEN</a>);</div>
<div class="line"><span class="lineno"> 2505</span> </div>
<div class="line"><span class="lineno"> 2506</span>  data.algorithm = <a class="code hl_variable" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>;</div>
<div class="line"><span class="lineno"> 2507</span> </div>
<div class="line"><span class="lineno"> 2508</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(data.delegated_capabilities, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#afa62e10709d52e5162a732e81369a7ec">delegated_capabilities</a>,</div>
<div class="line"><span class="lineno"> 2509</span>         <a class="code hl_define" href="yubihsm_8h.html#ad3c904849d17cae0a6f426e8007731d7">YH_CAPABILITIES_LEN</a>);</div>
<div class="line"><span class="lineno"> 2510</span> </div>
<div class="line"><span class="lineno"> 2511</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="#a4c26f003b72e800e9c934bca922a404a">yh_send_secure_msg</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, YHC_GENERATE_WRAP_KEY, data.buf, data_len,</div>
<div class="line"><span class="lineno"> 2512</span>                           &amp;response_cmd, response.buf, &amp;response_len);</div>
<div class="line"><span class="lineno"> 2513</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 2514</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Failed to send GENERATE WRAP KEY command: %s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 2515</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 2516</span>  }</div>
<div class="line"><span class="lineno"> 2517</span> </div>
<div class="line"><span class="lineno"> 2518</span>  <span class="keywordflow">if</span> (response_cmd == <a class="code hl_enumvalue" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7ea51cdf2ccd6995498e589e8ea6ce2a1f2">YHC_ERROR</a>) {</div>
<div class="line"><span class="lineno"> 2519</span>    <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> translated = translate_device_error(response.buf[0]);</div>
<div class="line"><span class="lineno"> 2520</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Unable to generate key: %s (%x)&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(translated),</div>
<div class="line"><span class="lineno"> 2521</span>            response.buf[0]);</div>
<div class="line"><span class="lineno"> 2522</span>    <span class="keywordflow">return</span> translated;</div>
<div class="line"><span class="lineno"> 2523</span>  }</div>
<div class="line"><span class="lineno"> 2524</span> </div>
<div class="line"><span class="lineno"> 2525</span>  *<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a> = ntohs(response.key_id);</div>
<div class="line"><span class="lineno"> 2526</span>  <a class="code hl_define" href="debug__lib_8h.html#a8c4742440a149ad8bcb5d58ae76c5ed3">DBG_INFO</a>(<span class="stringliteral">&quot;Generated Wrap key 0x%04x\n&quot;</span>, *<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>);</div>
<div class="line"><span class="lineno"> 2527</span> </div>
<div class="line"><span class="lineno"> 2528</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 2529</span>}</div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_afa62e10709d52e5162a732e81369a7ec"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#afa62e10709d52e5162a732e81369a7ec">delegated_capabilities</a></div><div class="ttdeci">yh_capabilities delegated_capabilities</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l01306">yubihsm_pkcs11.c:1306</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a1f749a696792e7911844629e056d9c15_cgraph.png" border="0" usemap="#ayubihsm_8c_a1f749a696792e7911844629e056d9c15_cgraph" alt=""/></div>
<map name="ayubihsm_8c_a1f749a696792e7911844629e056d9c15_cgraph" id="ayubihsm_8c_a1f749a696792e7911844629e056d9c15_cgraph">
<area shape="rect" title=" " alt="" coords="5,129,185,155"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="658,5,730,31"/>
<area shape="poly" title=" " alt="" coords="128,126,232,89,329,60,429,40,543,25,643,18,643,23,544,30,429,45,330,65,234,94,130,131"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="660,179,728,204"/>
<area shape="poly" title=" " alt="" coords="185,152,233,157,464,175,645,186,645,192,463,181,232,162,185,157"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="233,104,381,130"/>
<area shape="poly" title=" " alt="" coords="185,129,217,125,218,130,185,134"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="652,104,736,130"/>
<area shape="poly" title=" " alt="" coords="185,146,374,152,484,149,594,140,637,131,638,136,595,145,484,154,374,157,185,152"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="429,104,594,130"/>
<area shape="poly" title=" " alt="" coords="381,114,413,114,413,120,381,120"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="446,55,577,80"/>
<area shape="poly" title=" " alt="" coords="363,101,440,82,441,87,364,106"/>
<area shape="poly" title=" " alt="" coords="571,101,593,91,608,79,617,67,626,54,641,40,646,37,649,41,644,44,630,57,621,70,611,83,596,95,573,106"/>
<area shape="poly" title=" " alt="" coords="546,128,647,170,645,175,544,133"/>
<area shape="poly" title=" " alt="" coords="595,114,637,114,637,120,595,120"/>
<area shape="poly" title=" " alt="" coords="561,51,643,29,644,34,563,57"/>
<area shape="poly" title=" " alt="" coords="563,78,638,99,637,104,561,84"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="642,55,746,80"/>
<area shape="poly" title=" " alt="" coords="577,65,627,65,627,70,577,70"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a1f749a696792e7911844629e056d9c15_icgraph.png" border="0" usemap="#ayubihsm_8c_a1f749a696792e7911844629e056d9c15_icgraph" alt=""/></div>
<map name="ayubihsm_8c_a1f749a696792e7911844629e056d9c15_icgraph" id="ayubihsm_8c_a1f749a696792e7911844629e056d9c15_icgraph">
<area shape="rect" title=" " alt="" coords="503,55,683,80"/>
<area shape="rect" href="wrap_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="351,5,400,31"/>
<area shape="poly" title=" " alt="" coords="518,53,400,26,402,21,519,48"/>
<area shape="rect" href="commands_8c.html#ae2e50929acc6085cd395d0bd4ddb02db" title=" " alt="" coords="306,55,445,80"/>
<area shape="poly" title=" " alt="" coords="488,70,445,70,445,65,488,65"/>
<area shape="rect" href="commands_8c.html#a43d7d9dd1659838d79f875e61e59ce52" title=" " alt="" coords="296,104,455,130"/>
<area shape="poly" title=" " alt="" coords="519,87,436,106,435,101,518,82"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,55,248,80"/>
<area shape="poly" title=" " alt="" coords="291,70,249,70,249,65,291,65"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,80,55,106"/>
<area shape="poly" title=" " alt="" coords="88,85,55,91,54,86,87,80"/>
<area shape="poly" title=" " alt="" coords="305,102,230,84,231,78,306,97"/>
<area shape="poly" title=" " alt="" coords="281,113,55,97,55,92,281,108"/>
</map>
</div>

</div>
</div>
<a id="a6ab558e1426359cc78e7a362f8b3acd9" name="a6ab558e1426359cc78e7a362f8b3acd9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ab558e1426359cc78e7a362f8b3acd9">&#9670;&#160;</a></span>yh_util_get_device_info()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_util_get_device_info </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__connector.html">yh_connector</a> *</td>          <td class="paramname"><span class="paramname"><em>connector</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>major</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>minor</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>patch</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> *</td>          <td class="paramname"><span class="paramname"><em>serial</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>log_total</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>log_used</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55ca">yh_algorithm</a> *</td>          <td class="paramname"><span class="paramname"><em>algorithms</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *</td>          <td class="paramname"><span class="paramname"><em>n_algorithms</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get device version, device serial number, supported algorithms and available log entries.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">connector</td><td>Connector to the device </td></tr>
    <tr><td class="paramname">major</td><td>Device major version number </td></tr>
    <tr><td class="paramname">minor</td><td>Device minor version number </td></tr>
    <tr><td class="paramname">patch</td><td>Device build version number </td></tr>
    <tr><td class="paramname">serial</td><td>Device serial number </td></tr>
    <tr><td class="paramname">log_total</td><td>Total number of log entries </td></tr>
    <tr><td class="paramname">log_used</td><td>Number of written log entries </td></tr>
    <tr><td class="paramname">algorithms</td><td><a class="el" href="struct_list.html">List</a> of supported algorithms </td></tr>
    <tr><td class="paramname">n_algorithms</td><td>Number of supported algorithms</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> if the connector is NULL. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366ad8971a0b9647564b76b3f4e4b662c965" title="Returned value when there is not enough space to store data.">YHR_BUFFER_TOO_SMALL</a> if n_algorithms is smaller than the number of actually supported algorithms. See <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> for other possible errors.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a href="https://developers.yubico.com/YubiHSM2/Concepts/Algorithms.html">Algorithms</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l00938">938</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  941</span>                                                                              {</div>
<div class="line"><span class="lineno">  942</span> </div>
<div class="line"><span class="lineno">  943</span>  <span class="keywordflow">if</span> (connector == NULL) {</div>
<div class="line"><span class="lineno">  944</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>));</div>
<div class="line"><span class="lineno">  945</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno">  946</span>  }</div>
<div class="line"><span class="lineno">  947</span> </div>
<div class="line"><span class="lineno">  948</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno">  949</span> </div>
<div class="line"><span class="lineno">  950</span><span class="preprocessor">#pragma pack(push, 1)</span></div>
<div class="line"><span class="lineno">  951</span>  <span class="keyword">union </span>{</div>
<div class="line"><span class="lineno">  952</span>    <span class="keyword">struct </span>{</div>
<div class="line"><span class="lineno">  953</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a5bd4e4c943762926c8f653b6224cced2">major</a>;</div>
<div class="line"><span class="lineno">  954</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ae2f416b0a34b7beb4ed3873d791ac393">minor</a>;</div>
<div class="line"><span class="lineno">  955</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a00c54fad5fef8d31eb75c1163468005b">patch</a>;</div>
<div class="line"><span class="lineno">  956</span>      <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a1149ca4bd0659030412db8e77bebdf88">serial</a>;</div>
<div class="line"><span class="lineno">  957</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> log_total;</div>
<div class="line"><span class="lineno">  958</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> log_used;</div>
<div class="line"><span class="lineno">  959</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> algorithms[<a class="code hl_define" href="yubihsm_8h.html#a6f472329e64b5720ed637fa886aea8c8">YH_MAX_ALGORITHM_COUNT</a>];</div>
<div class="line"><span class="lineno">  960</span>    };</div>
<div class="line"><span class="lineno">  961</span>    <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a855e99b645b13e7905d074d02fe0bff5">buf</a>[1];</div>
<div class="line"><span class="lineno">  962</span>  } response;</div>
<div class="line"><span class="lineno">  963</span><span class="preprocessor">#pragma pack(pop)</span></div>
<div class="line"><span class="lineno">  964</span>  <span class="keywordtype">size_t</span> response_len = <span class="keyword">sizeof</span>(response);</div>
<div class="line"><span class="lineno">  965</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7e">yh_cmd</a> response_cmd;</div>
<div class="line"><span class="lineno">  966</span> </div>
<div class="line"><span class="lineno">  967</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="#a799e299be8d4c13dfa2112a60d05480d">yh_send_plain_msg</a>(connector, YHC_GET_DEVICE_INFO, NULL, 0,</div>
<div class="line"><span class="lineno">  968</span>                          &amp;response_cmd, response.buf, &amp;response_len);</div>
<div class="line"><span class="lineno">  969</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno">  970</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Failed to send GET DEVICE INFO command: %s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno">  971</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno">  972</span>  }</div>
<div class="line"><span class="lineno">  973</span> </div>
<div class="line"><span class="lineno">  974</span>  <span class="keywordflow">if</span> (response_cmd == <a class="code hl_enumvalue" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7ea51cdf2ccd6995498e589e8ea6ce2a1f2">YHC_ERROR</a>) {</div>
<div class="line"><span class="lineno">  975</span>    <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> translated = translate_device_error(response.buf[0]);</div>
<div class="line"><span class="lineno">  976</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Unable to get data: %s (%x)&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(translated),</div>
<div class="line"><span class="lineno">  977</span>            response.buf[0]);</div>
<div class="line"><span class="lineno">  978</span>    <span class="keywordflow">return</span> translated;</div>
<div class="line"><span class="lineno">  979</span>  }</div>
<div class="line"><span class="lineno">  980</span> </div>
<div class="line"><span class="lineno">  981</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a5bd4e4c943762926c8f653b6224cced2">major</a> != NULL) {</div>
<div class="line"><span class="lineno">  982</span>    *<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a5bd4e4c943762926c8f653b6224cced2">major</a> = response.major;</div>
<div class="line"><span class="lineno">  983</span>  }</div>
<div class="line"><span class="lineno">  984</span> </div>
<div class="line"><span class="lineno">  985</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ae2f416b0a34b7beb4ed3873d791ac393">minor</a> != NULL) {</div>
<div class="line"><span class="lineno">  986</span>    *<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ae2f416b0a34b7beb4ed3873d791ac393">minor</a> = response.minor;</div>
<div class="line"><span class="lineno">  987</span>  }</div>
<div class="line"><span class="lineno">  988</span> </div>
<div class="line"><span class="lineno">  989</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a00c54fad5fef8d31eb75c1163468005b">patch</a> != NULL) {</div>
<div class="line"><span class="lineno">  990</span>    *<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a00c54fad5fef8d31eb75c1163468005b">patch</a> = response.patch;</div>
<div class="line"><span class="lineno">  991</span>  }</div>
<div class="line"><span class="lineno">  992</span> </div>
<div class="line"><span class="lineno">  993</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a1149ca4bd0659030412db8e77bebdf88">serial</a> != NULL) {</div>
<div class="line"><span class="lineno">  994</span>    *<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a1149ca4bd0659030412db8e77bebdf88">serial</a> = ntohl(response.serial);</div>
<div class="line"><span class="lineno">  995</span>  }</div>
<div class="line"><span class="lineno">  996</span> </div>
<div class="line"><span class="lineno">  997</span>  <span class="keywordflow">if</span> (log_total != NULL) {</div>
<div class="line"><span class="lineno">  998</span>    *log_total = response.log_total;</div>
<div class="line"><span class="lineno">  999</span>  }</div>
<div class="line"><span class="lineno"> 1000</span> </div>
<div class="line"><span class="lineno"> 1001</span>  <span class="keywordflow">if</span> (log_used != NULL) {</div>
<div class="line"><span class="lineno"> 1002</span>    *log_used = response.log_used;</div>
<div class="line"><span class="lineno"> 1003</span>  }</div>
<div class="line"><span class="lineno"> 1004</span> </div>
<div class="line"><span class="lineno"> 1005</span>  <span class="keywordflow">if</span> (algorithms != NULL &amp;&amp; n_algorithms) {</div>
<div class="line"><span class="lineno"> 1006</span>    <span class="keywordtype">size_t</span> items = response_len - <span class="keyword">sizeof</span>(response.major) -</div>
<div class="line"><span class="lineno"> 1007</span>                   <span class="keyword">sizeof</span>(response.minor) - <span class="keyword">sizeof</span>(response.patch) -</div>
<div class="line"><span class="lineno"> 1008</span>                   <span class="keyword">sizeof</span>(response.serial) - <span class="keyword">sizeof</span>(response.log_total) -</div>
<div class="line"><span class="lineno"> 1009</span>                   <span class="keyword">sizeof</span>(response.log_used);</div>
<div class="line"><span class="lineno"> 1010</span>    <span class="keywordflow">if</span> (*n_algorithms &lt; items) {</div>
<div class="line"><span class="lineno"> 1011</span>      <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Algorithms buffer too small&quot;</span>);</div>
<div class="line"><span class="lineno"> 1012</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366ad8971a0b9647564b76b3f4e4b662c965">YHR_BUFFER_TOO_SMALL</a>;</div>
<div class="line"><span class="lineno"> 1013</span>    }</div>
<div class="line"><span class="lineno"> 1014</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; items; i++) {</div>
<div class="line"><span class="lineno"> 1015</span>      algorithms[i] = response.algorithms[i];</div>
<div class="line"><span class="lineno"> 1016</span>    }</div>
<div class="line"><span class="lineno"> 1017</span>    *n_algorithms = items;</div>
<div class="line"><span class="lineno"> 1018</span>  }</div>
<div class="line"><span class="lineno"> 1019</span> </div>
<div class="line"><span class="lineno"> 1020</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 1021</span>}</div>
<div class="ttc" id="ayubihsm_8c_html_a799e299be8d4c13dfa2112a60d05480d"><div class="ttname"><a href="#a799e299be8d4c13dfa2112a60d05480d">yh_send_plain_msg</a></div><div class="ttdeci">yh_rc yh_send_plain_msg(yh_connector *connector, yh_cmd cmd, const uint8_t *data, size_t data_len, yh_cmd *response_cmd, uint8_t *response, size_t *response_len)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l00126">yubihsm.c:126</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a6f472329e64b5720ed637fa886aea8c8"><div class="ttname"><a href="yubihsm_8h.html#a6f472329e64b5720ed637fa886aea8c8">YH_MAX_ALGORITHM_COUNT</a></div><div class="ttdeci">#define YH_MAX_ALGORITHM_COUNT</div><div class="ttdoc">Max number of algorithms defined here.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00383">yubihsm.h:383</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a1149ca4bd0659030412db8e77bebdf88"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a1149ca4bd0659030412db8e77bebdf88">serial</a></div><div class="ttdeci">uint32_t serial</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l00611">yubihsm_pkcs11.c:611</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a6ab558e1426359cc78e7a362f8b3acd9_cgraph.png" border="0" usemap="#ayubihsm_8c_a6ab558e1426359cc78e7a362f8b3acd9_cgraph" alt=""/></div>
<map name="ayubihsm_8c_a6ab558e1426359cc78e7a362f8b3acd9_cgraph" id="ayubihsm_8c_a6ab558e1426359cc78e7a362f8b3acd9_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,163,56"/>
<area shape="rect" href="yubihsm_8c.html#a799e299be8d4c13dfa2112a60d05480d" title=" " alt="" coords="211,5,347,31"/>
<area shape="poly" title=" " alt="" coords="163,31,195,26,196,32,163,36"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="395,55,478,80"/>
<area shape="poly" title=" " alt="" coords="163,46,379,61,379,66,163,51"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="401,5,472,31"/>
<area shape="poly" title=" " alt="" coords="347,16,385,16,385,21,347,21"/>
<area shape="poly" title=" " alt="" coords="323,29,381,48,380,53,322,34"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a6ab558e1426359cc78e7a362f8b3acd9_icgraph.png" border="0" usemap="#ayubihsm_8c_a6ab558e1426359cc78e7a362f8b3acd9_icgraph" alt=""/></div>
<map name="ayubihsm_8c_a6ab558e1426359cc78e7a362f8b3acd9_icgraph" id="ayubihsm_8c_a6ab558e1426359cc78e7a362f8b3acd9_icgraph">
<area shape="rect" title=" " alt="" coords="664,129,822,155"/>
<area shape="rect" href="util__pkcs11_8c.html#a95f1c61424aa67f782a360e59c6cee84" title=" " alt="" coords="463,55,604,80"/>
<area shape="poly" title=" " alt="" coords="696,125,615,94,583,83,584,78,617,89,698,120"/>
<area shape="rect" href="util__pkcs11_8c.html#a064731f36eb972f687b4059dc5f340db" title=" " alt="" coords="465,104,602,130"/>
<area shape="poly" title=" " alt="" coords="649,133,602,128,603,122,650,128"/>
<area shape="rect" href="info_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="509,153,558,179"/>
<area shape="poly" title=" " alt="" coords="649,156,559,166,559,161,649,150"/>
<area shape="rect" href="commands_8c.html#aca833cbc2ca7673b00a4f6cb320c97b6" title=" " alt="" coords="451,203,616,228"/>
<area shape="poly" title=" " alt="" coords="697,164,617,194,584,205,582,200,615,189,695,159"/>
<area shape="rect" href="util__pkcs11_8c.html#a5ce40fa3ee245e65d99ee4cec7a1dd0c" title=" " alt="" coords="223,5,403,31"/>
<area shape="poly" title=" " alt="" coords="458,100,449,95,434,82,425,69,416,56,402,44,379,34,381,29,404,40,420,53,429,66,438,79,453,91,461,95"/>
<area shape="rect" href="util__pkcs11_8c.html#a1a99061c5c316d6427b27f8d506338bf" title=" " alt="" coords="223,55,403,80"/>
<area shape="poly" title=" " alt="" coords="457,103,373,84,374,78,458,97"/>
<area shape="rect" href="util__pkcs11_8c.html#ae8ed437178cb69b0fed6916747368344" title=" " alt="" coords="232,104,394,130"/>
<area shape="poly" title=" " alt="" coords="449,120,394,120,394,114,449,114"/>
<area shape="rect" href="util__pkcs11_8c.html#a83e06a2ae90589d9fad186cad9ed5ede" title=" " alt="" coords="230,153,396,179"/>
<area shape="poly" title=" " alt="" coords="458,136,374,155,373,150,457,131"/>
<area shape="rect" href="util__pkcs11_8c.html#a87b96fbdfd225d8124f0a6f6d6538292" title=" " alt="" coords="5,104,175,130"/>
<area shape="poly" title=" " alt="" coords="217,120,175,120,175,114,217,114"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="240,203,386,228"/>
<area shape="poly" title=" " alt="" coords="435,218,386,218,386,213,435,213"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="65,228,115,254"/>
<area shape="poly" title=" " alt="" coords="462,235,403,243,320,249,239,249,115,245,115,240,239,244,320,243,403,238,461,229"/>
<area shape="poly" title=" " alt="" coords="225,228,115,241,115,235,225,223"/>
</map>
</div>

</div>
</div>
<a id="a5ae52ad56b7e83baeb33b46104263aa6" name="a5ae52ad56b7e83baeb33b46104263aa6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ae52ad56b7e83baeb33b46104263aa6">&#9670;&#160;</a></span>yh_util_get_log_entries()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_util_get_log_entries </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__session.html">yh_session</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *</td>          <td class="paramname"><span class="paramname"><em>unlogged_boot</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *</td>          <td class="paramname"><span class="paramname"><em>unlogged_auth</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structyh__log__entry.html">yh_log_entry</a> *</td>          <td class="paramname"><span class="paramname"><em>out</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *</td>          <td class="paramname"><span class="paramname"><em>n_items</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get audit logs from the device.</p>
<p>When audit enforce is set, if the log buffer is full, no new operations (other than authentication operations) can be performed unless the log entries are read by this command and then the log index is set by calling <a class="el" href="yubihsm_8h.html#a9d844855c9066bbea0e4344978dd7fdc">yh_util_set_log_index()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>Authenticated session to use </td></tr>
    <tr><td class="paramname">unlogged_boot</td><td>Number of unlogged boot events. Used if the log buffer is full and audit enforce is set </td></tr>
    <tr><td class="paramname">unlogged_auth</td><td>Number of unlogged authentication events. Used if the log buffer is full and audit enforce is set </td></tr>
    <tr><td class="paramname">out</td><td><a class="el" href="namespace_log.html">Log</a> entries on the device </td></tr>
    <tr><td class="paramname">n_items</td><td>Number of log entries</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> if input parameters are NULL. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366ad8971a0b9647564b76b3f4e4b662c965" title="Returned value when there is not enough space to store data.">YHR_BUFFER_TOO_SMALL</a> if <code>n_items</code> is smaller than the actual number of retrieved log entries. See <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> for other possible errors </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l02531">2531</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2533</span>                                               {</div>
<div class="line"><span class="lineno"> 2534</span> </div>
<div class="line"><span class="lineno"> 2535</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a> == NULL || out == NULL || n_items == NULL) {</div>
<div class="line"><span class="lineno"> 2536</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>));</div>
<div class="line"><span class="lineno"> 2537</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 2538</span>  }</div>
<div class="line"><span class="lineno"> 2539</span> </div>
<div class="line"><span class="lineno"> 2540</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 2541</span> </div>
<div class="line"><span class="lineno"> 2542</span>  <span class="keyword">union </span>{</div>
<div class="line"><span class="lineno"> 2543</span>    <span class="keyword">struct </span>{</div>
<div class="line"><span class="lineno"> 2544</span>      <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> log_overflow_boot;</div>
<div class="line"><span class="lineno"> 2545</span>      <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> log_overflow_auth;</div>
<div class="line"><span class="lineno"> 2546</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> items;</div>
<div class="line"><span class="lineno"> 2547</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> data[1];</div>
<div class="line"><span class="lineno"> 2548</span>    };</div>
<div class="line"><span class="lineno"> 2549</span>    <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a855e99b645b13e7905d074d02fe0bff5">buf</a>[<a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a>];</div>
<div class="line"><span class="lineno"> 2550</span>  } response;</div>
<div class="line"><span class="lineno"> 2551</span>  <span class="keywordtype">size_t</span> response_len = <span class="keyword">sizeof</span>(response);</div>
<div class="line"><span class="lineno"> 2552</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7e">yh_cmd</a> response_cmd;</div>
<div class="line"><span class="lineno"> 2553</span> </div>
<div class="line"><span class="lineno"> 2554</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="#a4c26f003b72e800e9c934bca922a404a">yh_send_secure_msg</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, YHC_GET_LOG_ENTRIES, NULL, 0, &amp;response_cmd,</div>
<div class="line"><span class="lineno"> 2555</span>                           response.buf, &amp;response_len);</div>
<div class="line"><span class="lineno"> 2556</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 2557</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Failed to send GET LOGS command: %s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 2558</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 2559</span>  }</div>
<div class="line"><span class="lineno"> 2560</span> </div>
<div class="line"><span class="lineno"> 2561</span>  <span class="keywordflow">if</span> (response_cmd == <a class="code hl_enumvalue" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7ea51cdf2ccd6995498e589e8ea6ce2a1f2">YHC_ERROR</a>) {</div>
<div class="line"><span class="lineno"> 2562</span>    <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> translated = translate_device_error(response.buf[0]);</div>
<div class="line"><span class="lineno"> 2563</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Unable to get logs: %s (%x)&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(translated),</div>
<div class="line"><span class="lineno"> 2564</span>            response.buf[0]);</div>
<div class="line"><span class="lineno"> 2565</span>    <span class="keywordflow">return</span> translated;</div>
<div class="line"><span class="lineno"> 2566</span>  }</div>
<div class="line"><span class="lineno"> 2567</span> </div>
<div class="line"><span class="lineno"> 2568</span>  <span class="keywordflow">if</span> (unlogged_boot) {</div>
<div class="line"><span class="lineno"> 2569</span>    *unlogged_boot = ntohs(response.log_overflow_boot);</div>
<div class="line"><span class="lineno"> 2570</span>  }</div>
<div class="line"><span class="lineno"> 2571</span> </div>
<div class="line"><span class="lineno"> 2572</span>  <span class="keywordflow">if</span> (unlogged_auth) {</div>
<div class="line"><span class="lineno"> 2573</span>    *unlogged_auth = ntohs(response.log_overflow_auth);</div>
<div class="line"><span class="lineno"> 2574</span>  }</div>
<div class="line"><span class="lineno"> 2575</span> </div>
<div class="line"><span class="lineno"> 2576</span>  <span class="keywordflow">if</span> (response.items &gt; <a class="code hl_define" href="yubihsm_8h.html#ae10a65a4b5dfaac7c3d64c1ec7b99e82">YH_MAX_LOG_ENTRIES</a>) {</div>
<div class="line"><span class="lineno"> 2577</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(</div>
<div class="line"><span class="lineno"> 2578</span>      <span class="stringliteral">&quot;Response contain more items than the maximum number of log entries&quot;</span>);</div>
<div class="line"><span class="lineno"> 2579</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366ab7388c97719517ba2f7e43d3d16850e1">YHR_DEVICE_INVALID_DATA</a>;</div>
<div class="line"><span class="lineno"> 2580</span>  }</div>
<div class="line"><span class="lineno"> 2581</span> </div>
<div class="line"><span class="lineno"> 2582</span>  <span class="keywordflow">if</span> (response.items &gt; *n_items) {</div>
<div class="line"><span class="lineno"> 2583</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Log buffer too small, needed at lest %d, got %zu&quot;</span>, response.items,</div>
<div class="line"><span class="lineno"> 2584</span>            *n_items);</div>
<div class="line"><span class="lineno"> 2585</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366ad8971a0b9647564b76b3f4e4b662c965">YHR_BUFFER_TOO_SMALL</a>;</div>
<div class="line"><span class="lineno"> 2586</span>  }</div>
<div class="line"><span class="lineno"> 2587</span> </div>
<div class="line"><span class="lineno"> 2588</span>  *n_items = response.items;</div>
<div class="line"><span class="lineno"> 2589</span> </div>
<div class="line"><span class="lineno"> 2590</span>  <a class="code hl_struct" href="structyh__log__entry.html">yh_log_entry</a> *ptr = (<a class="code hl_struct" href="structyh__log__entry.html">yh_log_entry</a> *) response.data;</div>
<div class="line"><span class="lineno"> 2591</span>  <span class="keywordflow">for</span> (<a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> i = 0; i &lt; *n_items; i++) {</div>
<div class="line"><span class="lineno"> 2592</span>    out[i].number = ntohs(ptr[i].number);</div>
<div class="line"><span class="lineno"> 2593</span>    out[i].command = ptr[i].command;</div>
<div class="line"><span class="lineno"> 2594</span>    out[i].length = ntohs(ptr[i].length);</div>
<div class="line"><span class="lineno"> 2595</span>    out[i].session_key = ntohs(ptr[i].session_key);</div>
<div class="line"><span class="lineno"> 2596</span>    out[i].target_key = ntohs(ptr[i].target_key);</div>
<div class="line"><span class="lineno"> 2597</span>    out[i].second_key = ntohs(ptr[i].second_key);</div>
<div class="line"><span class="lineno"> 2598</span>    out[i].result = ptr[i].result;</div>
<div class="line"><span class="lineno"> 2599</span>    out[i].systick = ntohl(ptr[i].systick);</div>
<div class="line"><span class="lineno"> 2600</span>    <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(out[i].digest, ptr[i].digest, <a class="code hl_define" href="yubihsm_8h.html#a289ca46f5ef481980f0fad98d727e87a">YH_LOG_DIGEST_SIZE</a>);</div>
<div class="line"><span class="lineno"> 2601</span>  }</div>
<div class="line"><span class="lineno"> 2602</span> </div>
<div class="line"><span class="lineno"> 2603</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 2604</span>}</div>
<div class="ttc" id="astructyh__log__entry_html"><div class="ttname"><a href="structyh__log__entry.html">yh_log_entry</a></div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00516">yubihsm.h:516</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a289ca46f5ef481980f0fad98d727e87a"><div class="ttname"><a href="yubihsm_8h.html#a289ca46f5ef481980f0fad98d727e87a">YH_LOG_DIGEST_SIZE</a></div><div class="ttdeci">#define YH_LOG_DIGEST_SIZE</div><div class="ttdoc">Size that the log digest is truncated to.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00127">yubihsm.h:127</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_ae10a65a4b5dfaac7c3d64c1ec7b99e82"><div class="ttname"><a href="yubihsm_8h.html#ae10a65a4b5dfaac7c3d64c1ec7b99e82">YH_MAX_LOG_ENTRIES</a></div><div class="ttdeci">#define YH_MAX_LOG_ENTRIES</div><div class="ttdoc">Max log entries the device may hold.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00121">yubihsm.h:121</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_ae4f602d2343d01b1727dfd633169d366ab7388c97719517ba2f7e43d3d16850e1"><div class="ttname"><a href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366ab7388c97719517ba2f7e43d3d16850e1">YHR_DEVICE_INVALID_DATA</a></div><div class="ttdeci">@ YHR_DEVICE_INVALID_DATA</div><div class="ttdoc">Returned value when the device receives a malformed command invalid data.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00199">yubihsm.h:199</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a5ae52ad56b7e83baeb33b46104263aa6_cgraph.png" border="0" usemap="#ayubihsm_8c_a5ae52ad56b7e83baeb33b46104263aa6_cgraph" alt=""/></div>
<map name="ayubihsm_8c_a5ae52ad56b7e83baeb33b46104263aa6_cgraph" id="ayubihsm_8c_a5ae52ad56b7e83baeb33b46104263aa6_cgraph">
<area shape="rect" title=" " alt="" coords="5,80,160,106"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="633,5,705,31"/>
<area shape="poly" title=" " alt="" coords="144,77,207,65,436,35,617,19,618,24,437,40,208,70,145,82"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="208,80,356,106"/>
<area shape="poly" title=" " alt="" coords="160,90,192,90,192,96,160,96"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="627,104,711,130"/>
<area shape="poly" title=" " alt="" coords="145,104,208,116,309,133,388,145,468,148,569,140,612,131,613,136,570,145,468,153,388,150,308,138,207,121,144,109"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="404,55,569,80"/>
<area shape="poly" title=" " alt="" coords="356,81,388,77,389,82,356,86"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="422,104,552,130"/>
<area shape="poly" title=" " alt="" coords="356,99,407,105,406,110,356,104"/>
<area shape="poly" title=" " alt="" coords="536,51,618,29,619,34,538,57"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="635,55,703,80"/>
<area shape="poly" title=" " alt="" coords="570,65,619,65,619,70,570,70"/>
<area shape="poly" title=" " alt="" coords="538,78,613,99,612,104,536,84"/>
<area shape="poly" title=" " alt="" coords="546,101,568,91,583,79,592,67,601,54,616,40,621,37,624,41,619,44,605,57,596,70,586,83,571,95,548,106"/>
<area shape="poly" title=" " alt="" coords="552,114,612,114,612,120,552,120"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="617,153,721,179"/>
<area shape="poly" title=" " alt="" coords="538,128,605,146,603,151,536,133"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a5ae52ad56b7e83baeb33b46104263aa6_icgraph.png" border="0" usemap="#ayubihsm_8c_a5ae52ad56b7e83baeb33b46104263aa6_icgraph" alt=""/></div>
<map name="ayubihsm_8c_a5ae52ad56b7e83baeb33b46104263aa6_icgraph" id="ayubihsm_8c_a5ae52ad56b7e83baeb33b46104263aa6_icgraph">
<area shape="rect" title=" " alt="" coords="446,31,601,56"/>
<area shape="rect" href="logs_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="322,5,372,31"/>
<area shape="poly" title=" " alt="" coords="431,33,372,24,373,19,431,28"/>
<area shape="rect" href="commands_8c.html#a3c600843ccdac7af506983bc67cb0bc3" title=" " alt="" coords="296,55,398,80"/>
<area shape="poly" title=" " alt="" coords="431,59,399,63,398,58,431,53"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,29,248,55"/>
<area shape="poly" title=" " alt="" coords="280,60,248,56,249,50,281,55"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,55,55,80"/>
<area shape="poly" title=" " alt="" coords="280,70,55,70,55,65,280,65"/>
<area shape="poly" title=" " alt="" coords="88,60,55,66,54,61,87,55"/>
</map>
</div>

</div>
</div>
<a id="a7b5f1f0c1cbca11fbe21e7e4e6b29a1b" name="a7b5f1f0c1cbca11fbe21e7e4e6b29a1b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b5f1f0c1cbca11fbe21e7e4e6b29a1b">&#9670;&#160;</a></span>yh_util_get_object_info()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_util_get_object_info </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__session.html">yh_session</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a></td>          <td class="paramname"><span class="paramname"><em>id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583">yh_object_type</a></td>          <td class="paramname"><span class="paramname"><em>type</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structyh__object__descriptor.html">yh_object_descriptor</a> *</td>          <td class="paramname"><span class="paramname"><em>object</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get metadata of the object with the specified Object ID and Type</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>Authenticated session to use </td></tr>
    <tr><td class="paramname">id</td><td>Object ID of the object to get </td></tr>
    <tr><td class="paramname">type</td><td>Object type. See <a class="el" href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583">yh_object_type</a> </td></tr>
    <tr><td class="paramname">object</td><td>Object information</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> if the session is NULL. See <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> for other possible errors.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a href="https://developers.yubico.com/YubiHSM2/Concepts/Object.html">Objects</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l01128">1128</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1130</span>                                                            {</div>
<div class="line"><span class="lineno"> 1131</span> </div>
<div class="line"><span class="lineno"> 1132</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a> == NULL) {</div>
<div class="line"><span class="lineno"> 1133</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>));</div>
<div class="line"><span class="lineno"> 1134</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 1135</span>  }</div>
<div class="line"><span class="lineno"> 1136</span> </div>
<div class="line"><span class="lineno"> 1137</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> data[3];</div>
<div class="line"><span class="lineno"> 1138</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *dataptr = data;</div>
<div class="line"><span class="lineno"> 1139</span> </div>
<div class="line"><span class="lineno"> 1140</span><span class="preprocessor">#pragma pack(push, 1)</span></div>
<div class="line"><span class="lineno"> 1141</span>  <span class="keyword">union </span>{</div>
<div class="line"><span class="lineno"> 1142</span>    <span class="keyword">struct </span>{</div>
<div class="line"><span class="lineno"> 1143</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>[<a class="code hl_define" href="yubihsm_8h.html#ad3c904849d17cae0a6f426e8007731d7">YH_CAPABILITIES_LEN</a>];</div>
<div class="line"><span class="lineno"> 1144</span>      <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="code hl_variable" href="code__cache_8cpp.html#aa0efefe21f4700d78692edc823e763be">id</a>;</div>
<div class="line"><span class="lineno"> 1145</span>      <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>;</div>
<div class="line"><span class="lineno"> 1146</span>      <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a5420fd4d2f76428942c2716b1cb7e863">domains</a>;</div>
<div class="line"><span class="lineno"> 1147</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a>;</div>
<div class="line"><span class="lineno"> 1148</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>;</div>
<div class="line"><span class="lineno"> 1149</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> sequence;</div>
<div class="line"><span class="lineno"> 1150</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> origin;</div>
<div class="line"><span class="lineno"> 1151</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>[<a class="code hl_define" href="yubihsm_8h.html#a431f8b753552a8b2f5f980e871b6d019">YH_OBJ_LABEL_LEN</a>];</div>
<div class="line"><span class="lineno"> 1152</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#afa62e10709d52e5162a732e81369a7ec">delegated_capabilities</a>[<a class="code hl_define" href="yubihsm_8h.html#ad3c904849d17cae0a6f426e8007731d7">YH_CAPABILITIES_LEN</a>];</div>
<div class="line"><span class="lineno"> 1153</span>    };</div>
<div class="line"><span class="lineno"> 1154</span>    <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a855e99b645b13e7905d074d02fe0bff5">buf</a>[1];</div>
<div class="line"><span class="lineno"> 1155</span>  } response;</div>
<div class="line"><span class="lineno"> 1156</span>  <span class="keywordtype">size_t</span> response_len = <span class="keyword">sizeof</span>(response);</div>
<div class="line"><span class="lineno"> 1157</span><span class="preprocessor">#pragma pack(pop)</span></div>
<div class="line"><span class="lineno"> 1158</span> </div>
<div class="line"><span class="lineno"> 1159</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 1160</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7e">yh_cmd</a> response_cmd;</div>
<div class="line"><span class="lineno"> 1161</span> </div>
<div class="line"><span class="lineno"> 1162</span>  *dataptr++ = <span class="keywordtype">id</span> &gt;&gt; 8 &amp; 0xff;</div>
<div class="line"><span class="lineno"> 1163</span>  *dataptr++ = <span class="keywordtype">id</span> &amp; 0xff;</div>
<div class="line"><span class="lineno"> 1164</span> </div>
<div class="line"><span class="lineno"> 1165</span>  *dataptr++ = (<a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a>) type;</div>
<div class="line"><span class="lineno"> 1166</span> </div>
<div class="line"><span class="lineno"> 1167</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="#a4c26f003b72e800e9c934bca922a404a">yh_send_secure_msg</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, YHC_GET_OBJECT_INFO, data, <span class="keyword">sizeof</span>(data),</div>
<div class="line"><span class="lineno"> 1168</span>                           &amp;response_cmd, response.buf, &amp;response_len);</div>
<div class="line"><span class="lineno"> 1169</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 1170</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Failed to send GET OBJECT INFO command: %s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 1171</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 1172</span>  }</div>
<div class="line"><span class="lineno"> 1173</span> </div>
<div class="line"><span class="lineno"> 1174</span>  <span class="keywordflow">if</span> (response_cmd == <a class="code hl_enumvalue" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7ea51cdf2ccd6995498e589e8ea6ce2a1f2">YHC_ERROR</a>) {</div>
<div class="line"><span class="lineno"> 1175</span>    <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> translated = translate_device_error(response.buf[0]);</div>
<div class="line"><span class="lineno"> 1176</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Unable to get object info: %s (%x)&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(translated),</div>
<div class="line"><span class="lineno"> 1177</span>            response.buf[0]);</div>
<div class="line"><span class="lineno"> 1178</span>    <span class="keywordflow">return</span> translated;</div>
<div class="line"><span class="lineno"> 1179</span>  }</div>
<div class="line"><span class="lineno"> 1180</span> </div>
<div class="line"><span class="lineno"> 1181</span>  <span class="keywordflow">if</span> (response_len == <span class="keyword">sizeof</span>(response)) {</div>
<div class="line"><span class="lineno"> 1182</span>    <span class="keywordflow">if</span> (<span class="keywordtype">object</span>) {</div>
<div class="line"><span class="lineno"> 1183</span>      <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a85d991d90970121ba1480cd98d93aab9">object</a>-&gt;<a class="code hl_variable" href="structyh__object__descriptor.html#a94fcb9bbe5ffacadafc207c166f6239f">capabilities</a>.<a class="code hl_variable" href="structyh__capabilities.html#a5398bad7e61385aa127265ba0a053079">capabilities</a>, response.capabilities,</div>
<div class="line"><span class="lineno"> 1184</span>             <a class="code hl_define" href="yubihsm_8h.html#ad3c904849d17cae0a6f426e8007731d7">YH_CAPABILITIES_LEN</a>);</div>
<div class="line"><span class="lineno"> 1185</span> </div>
<div class="line"><span class="lineno"> 1186</span>      <span class="keywordtype">object</span>-&gt;id = htons(response.id);</div>
<div class="line"><span class="lineno"> 1187</span> </div>
<div class="line"><span class="lineno"> 1188</span>      <span class="keywordtype">object</span>-&gt;len = htons(response.len);</div>
<div class="line"><span class="lineno"> 1189</span> </div>
<div class="line"><span class="lineno"> 1190</span>      <span class="keywordtype">object</span>-&gt;domains = htons(response.domains);</div>
<div class="line"><span class="lineno"> 1191</span> </div>
<div class="line"><span class="lineno"> 1192</span>      <span class="keywordtype">object</span>-&gt;type = response.type;</div>
<div class="line"><span class="lineno"> 1193</span> </div>
<div class="line"><span class="lineno"> 1194</span>      <span class="keywordtype">object</span>-&gt;algorithm = response.algorithm;</div>
<div class="line"><span class="lineno"> 1195</span> </div>
<div class="line"><span class="lineno"> 1196</span>      <span class="keywordtype">object</span>-&gt;sequence = response.sequence;</div>
<div class="line"><span class="lineno"> 1197</span> </div>
<div class="line"><span class="lineno"> 1198</span>      <span class="keywordtype">object</span>-&gt;origin = response.origin;</div>
<div class="line"><span class="lineno"> 1199</span> </div>
<div class="line"><span class="lineno"> 1200</span>      <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a85d991d90970121ba1480cd98d93aab9">object</a>-&gt;<a class="code hl_variable" href="structyh__object__descriptor.html#ab63cc80a958a1debc4ac0ee255810fa5">label</a>, response.label, <a class="code hl_define" href="yubihsm_8h.html#a431f8b753552a8b2f5f980e871b6d019">YH_OBJ_LABEL_LEN</a>);</div>
<div class="line"><span class="lineno"> 1201</span>      <span class="keywordtype">object</span>-&gt;label[<a class="code hl_define" href="yubihsm_8h.html#a431f8b753552a8b2f5f980e871b6d019">YH_OBJ_LABEL_LEN</a>] = 0;</div>
<div class="line"><span class="lineno"> 1202</span> </div>
<div class="line"><span class="lineno"> 1203</span>      <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a85d991d90970121ba1480cd98d93aab9">object</a>-&gt;<a class="code hl_variable" href="structyh__object__descriptor.html#a98e1c698e0d1344c4fe4a215d2d633ec">delegated_capabilities</a>.<a class="code hl_variable" href="structyh__capabilities.html#a5398bad7e61385aa127265ba0a053079">capabilities</a>,</div>
<div class="line"><span class="lineno"> 1204</span>             response.delegated_capabilities, <a class="code hl_define" href="yubihsm_8h.html#ad3c904849d17cae0a6f426e8007731d7">YH_CAPABILITIES_LEN</a>);</div>
<div class="line"><span class="lineno"> 1205</span>    }</div>
<div class="line"><span class="lineno"> 1206</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1207</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Wrong response length, expecting %lu or 0, received %lu&quot;</span>,</div>
<div class="line"><span class="lineno"> 1208</span>            (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>) <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structyh__object__descriptor.html">yh_object_descriptor</a>),</div>
<div class="line"><span class="lineno"> 1209</span>            (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>) response_len);</div>
<div class="line"><span class="lineno"> 1210</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366ae0b26dcb22aa228ab08c9e59a8975952">YHR_WRONG_LENGTH</a>;</div>
<div class="line"><span class="lineno"> 1211</span>  }</div>
<div class="line"><span class="lineno"> 1212</span> </div>
<div class="line"><span class="lineno"> 1213</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 1214</span>}</div>
<div class="ttc" id="astructyh__object__descriptor_html"><div class="ttname"><a href="structyh__object__descriptor.html">yh_object_descriptor</a></div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00540">yubihsm.h:540</a></div></div>
<div class="ttc" id="astructyh__object__descriptor_html_a94fcb9bbe5ffacadafc207c166f6239f"><div class="ttname"><a href="structyh__object__descriptor.html#a94fcb9bbe5ffacadafc207c166f6239f">yh_object_descriptor::capabilities</a></div><div class="ttdeci">yh_capabilities capabilities</div><div class="ttdoc">Object capabilities.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00542">yubihsm.h:542</a></div></div>
<div class="ttc" id="astructyh__object__descriptor_html_a98e1c698e0d1344c4fe4a215d2d633ec"><div class="ttname"><a href="structyh__object__descriptor.html#a98e1c698e0d1344c4fe4a215d2d633ec">yh_object_descriptor::delegated_capabilities</a></div><div class="ttdeci">yh_capabilities delegated_capabilities</div><div class="ttdoc">Object delegated capabilities.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00560">yubihsm.h:560</a></div></div>
<div class="ttc" id="astructyh__object__descriptor_html_ab63cc80a958a1debc4ac0ee255810fa5"><div class="ttname"><a href="structyh__object__descriptor.html#ab63cc80a958a1debc4ac0ee255810fa5">yh_object_descriptor::label</a></div><div class="ttdeci">char label[YH_OBJ_LABEL_LEN+1]</div><div class="ttdoc">Object label.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00558">yubihsm.h:558</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a85d991d90970121ba1480cd98d93aab9"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a85d991d90970121ba1480cd98d93aab9">object</a></div><div class="ttdeci">yh_object_descriptor object</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l01544">yubihsm_pkcs11.c:1544</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a7b5f1f0c1cbca11fbe21e7e4e6b29a1b_cgraph.png" border="0" usemap="#ayubihsm_8c_a7b5f1f0c1cbca11fbe21e7e4e6b29a1b_cgraph" alt=""/></div>
<map name="ayubihsm_8c_a7b5f1f0c1cbca11fbe21e7e4e6b29a1b_cgraph" id="ayubihsm_8c_a7b5f1f0c1cbca11fbe21e7e4e6b29a1b_cgraph">
<area shape="rect" title=" " alt="" coords="5,80,160,106"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="633,5,705,31"/>
<area shape="poly" title=" " alt="" coords="144,77,207,65,436,35,617,19,618,24,437,40,208,70,145,82"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="208,80,356,106"/>
<area shape="poly" title=" " alt="" coords="160,90,192,90,192,96,160,96"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="627,104,711,130"/>
<area shape="poly" title=" " alt="" coords="145,104,208,116,309,133,388,145,468,148,569,140,612,131,613,136,570,145,468,153,388,150,308,138,207,121,144,109"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="404,55,569,80"/>
<area shape="poly" title=" " alt="" coords="356,81,388,77,389,82,356,86"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="422,104,552,130"/>
<area shape="poly" title=" " alt="" coords="356,99,407,105,406,110,356,104"/>
<area shape="poly" title=" " alt="" coords="536,51,618,29,619,34,538,57"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="635,55,703,80"/>
<area shape="poly" title=" " alt="" coords="570,65,619,65,619,70,570,70"/>
<area shape="poly" title=" " alt="" coords="538,78,613,99,612,104,536,84"/>
<area shape="poly" title=" " alt="" coords="546,101,568,91,583,79,592,67,601,54,616,40,621,37,624,41,619,44,605,57,596,70,586,83,571,95,548,106"/>
<area shape="poly" title=" " alt="" coords="552,114,612,114,612,120,552,120"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="617,153,721,179"/>
<area shape="poly" title=" " alt="" coords="538,128,605,146,603,151,536,133"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a7b5f1f0c1cbca11fbe21e7e4e6b29a1b_icgraph.png" border="0" usemap="#ayubihsm_8c_a7b5f1f0c1cbca11fbe21e7e4e6b29a1b_icgraph" alt=""/></div>
<map name="ayubihsm_8c_a7b5f1f0c1cbca11fbe21e7e4e6b29a1b_icgraph" id="ayubihsm_8c_a7b5f1f0c1cbca11fbe21e7e4e6b29a1b_icgraph">
<area shape="rect" title=" " alt="" coords="506,88,661,114"/>
<area shape="rect" href="util__pkcs11_8c.html#a85589628d7732ef01a3f80a25d217c8c" title=" " alt="" coords="319,5,435,31"/>
<area shape="poly" title=" " alt="" coords="542,83,457,45,427,34,428,29,459,40,545,78"/>
<area shape="rect" href="logs_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="352,55,402,80"/>
<area shape="poly" title=" " alt="" coords="490,89,402,74,403,69,491,83"/>
<area shape="rect" href="structsysio_1_1wallet_1_1detail_1_1yubihsm__wallet__impl.html#a00ee0ac7ac4a819d0b8755bf4f442263" title=" " alt="" coords="302,105,452,161"/>
<area shape="poly" title=" " alt="" coords="491,118,453,124,453,118,491,113"/>
<area shape="rect" href="commands_8c.html#afa7330c81148ba6f4d5c53f7c370ed41" title=" " alt="" coords="296,185,458,211"/>
<area shape="poly" title=" " alt="" coords="551,125,508,150,459,175,428,187,426,182,457,170,506,146,548,120"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,160,248,186"/>
<area shape="poly" title=" " alt="" coords="280,189,248,185,249,179,281,183"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,185,55,211"/>
<area shape="poly" title=" " alt="" coords="280,201,55,201,55,196,280,196"/>
<area shape="poly" title=" " alt="" coords="88,191,55,197,54,191,87,186"/>
</map>
</div>

</div>
</div>
<a id="a56e060e71fb8baa0531b3a20848abf37" name="a56e060e71fb8baa0531b3a20848abf37"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56e060e71fb8baa0531b3a20848abf37">&#9670;&#160;</a></span>yh_util_get_opaque()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_util_get_opaque </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__session.html">yh_session</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a></td>          <td class="paramname"><span class="paramname"><em>object_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>out</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *</td>          <td class="paramname"><span class="paramname"><em>out_len</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get an <a class="el" href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583a5d37b7418d50b420621e6a6eb2700de4">YH_OPAQUE</a> object (like an X.509 certificate) from the device</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>Authenticated session to use </td></tr>
    <tr><td class="paramname">object_id</td><td>Object ID of the <a class="el" href="struct_opaque.html">Opaque</a> object </td></tr>
    <tr><td class="paramname">out</td><td>the retrieved <a class="el" href="struct_opaque.html">Opaque</a> object </td></tr>
    <tr><td class="paramname">out_len</td><td>Length of the retrieved <a class="el" href="struct_opaque.html">Opaque</a> object</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> if input parameters are NULL. See <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> for other possible errors </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l02636">2636</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2637</span>                                          {</div>
<div class="line"><span class="lineno"> 2638</span> </div>
<div class="line"><span class="lineno"> 2639</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a> == NULL || out == NULL || <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a565e4b6f63fecad4c290b50ee6684ee3">out_len</a> == NULL) {</div>
<div class="line"><span class="lineno"> 2640</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>));</div>
<div class="line"><span class="lineno"> 2641</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 2642</span>  }</div>
<div class="line"><span class="lineno"> 2643</span> </div>
<div class="line"><span class="lineno"> 2644</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> data[2];</div>
<div class="line"><span class="lineno"> 2645</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7e">yh_cmd</a> response_cmd;</div>
<div class="line"><span class="lineno"> 2646</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 2647</span> </div>
<div class="line"><span class="lineno"> 2648</span>  <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> object_id_h = htons(object_id);</div>
<div class="line"><span class="lineno"> 2649</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(data, &amp;object_id_h, <span class="keyword">sizeof</span>(object_id_h));</div>
<div class="line"><span class="lineno"> 2650</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="#a4c26f003b72e800e9c934bca922a404a">yh_send_secure_msg</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, YHC_GET_OPAQUE, data, <span class="keyword">sizeof</span>(data),</div>
<div class="line"><span class="lineno"> 2651</span>                           &amp;response_cmd, out, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a565e4b6f63fecad4c290b50ee6684ee3">out_len</a>);</div>
<div class="line"><span class="lineno"> 2652</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 2653</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Failed to send GET OPAQUE command: %s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 2654</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 2655</span>  }</div>
<div class="line"><span class="lineno"> 2656</span> </div>
<div class="line"><span class="lineno"> 2657</span>  <span class="keywordflow">if</span> (response_cmd == <a class="code hl_enumvalue" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7ea51cdf2ccd6995498e589e8ea6ce2a1f2">YHC_ERROR</a>) {</div>
<div class="line"><span class="lineno"> 2658</span>    <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> translated = translate_device_error(out[0]);</div>
<div class="line"><span class="lineno"> 2659</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Unable to get object: %s (%x)&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(translated), out[0]);</div>
<div class="line"><span class="lineno"> 2660</span>    <span class="keywordflow">return</span> translated;</div>
<div class="line"><span class="lineno"> 2661</span>  }</div>
<div class="line"><span class="lineno"> 2662</span> </div>
<div class="line"><span class="lineno"> 2663</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 2664</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a56e060e71fb8baa0531b3a20848abf37_cgraph.png" border="0" usemap="#ayubihsm_8c_a56e060e71fb8baa0531b3a20848abf37_cgraph" alt=""/></div>
<map name="ayubihsm_8c_a56e060e71fb8baa0531b3a20848abf37_cgraph" id="ayubihsm_8c_a56e060e71fb8baa0531b3a20848abf37_cgraph">
<area shape="rect" title=" " alt="" coords="5,80,139,106"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="612,5,684,31"/>
<area shape="poly" title=" " alt="" coords="128,77,186,65,301,47,415,34,596,19,597,24,416,39,302,53,187,70,129,82"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="187,80,335,106"/>
<area shape="poly" title=" " alt="" coords="139,90,171,90,171,96,139,96"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="606,104,690,130"/>
<area shape="poly" title=" " alt="" coords="127,104,208,121,313,137,430,145,490,144,548,140,591,131,592,136,549,145,490,150,430,150,313,142,208,126,126,109"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="383,55,548,80"/>
<area shape="poly" title=" " alt="" coords="335,81,367,77,368,82,335,86"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="400,104,531,130"/>
<area shape="poly" title=" " alt="" coords="335,99,386,105,385,110,335,104"/>
<area shape="poly" title=" " alt="" coords="515,51,597,29,598,34,517,57"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="614,55,682,80"/>
<area shape="poly" title=" " alt="" coords="549,65,598,65,598,70,549,70"/>
<area shape="poly" title=" " alt="" coords="517,78,592,99,591,104,515,84"/>
<area shape="poly" title=" " alt="" coords="525,101,547,91,562,79,571,67,580,54,595,40,600,37,603,41,598,44,584,57,575,70,565,83,550,95,527,106"/>
<area shape="poly" title=" " alt="" coords="531,114,591,114,591,120,531,120"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="596,153,700,179"/>
<area shape="poly" title=" " alt="" coords="517,128,584,146,582,151,515,133"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a56e060e71fb8baa0531b3a20848abf37_icgraph.png" border="0" usemap="#ayubihsm_8c_a56e060e71fb8baa0531b3a20848abf37_icgraph" alt=""/></div>
<map name="ayubihsm_8c_a56e060e71fb8baa0531b3a20848abf37_icgraph" id="ayubihsm_8c_a56e060e71fb8baa0531b3a20848abf37_icgraph">
<area shape="rect" title=" " alt="" coords="485,31,619,56"/>
<area shape="rect" href="attest_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="342,5,391,31"/>
<area shape="poly" title=" " alt="" coords="469,35,391,24,392,19,470,30"/>
<area shape="rect" href="commands_8c.html#ad8a4781a26be12a87848234cc184a3bb" title=" " alt="" coords="296,55,437,80"/>
<area shape="poly" title=" " alt="" coords="470,57,438,61,437,56,469,51"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,29,248,55"/>
<area shape="poly" title=" " alt="" coords="280,59,248,54,249,49,281,53"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,55,55,80"/>
<area shape="poly" title=" " alt="" coords="281,70,55,70,55,65,281,65"/>
<area shape="poly" title=" " alt="" coords="88,60,55,66,54,61,87,55"/>
</map>
</div>

</div>
</div>
<a id="a11871e03c808e2d25737f893e58ed094" name="a11871e03c808e2d25737f893e58ed094"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a11871e03c808e2d25737f893e58ed094">&#9670;&#160;</a></span>yh_util_get_option()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_util_get_option </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__session.html">yh_session</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm_8h.html#acc8090ce0ec5029b376803e44b1cb4aa">yh_option</a></td>          <td class="paramname"><span class="paramname"><em>option</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>out</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *</td>          <td class="paramname"><span class="paramname"><em>out_len</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get a device-global option</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>Authenticated session to use </td></tr>
    <tr><td class="paramname">option</td><td>Option to get. See <a class="el" href="yubihsm_8h.html#acc8090ce0ec5029b376803e44b1cb4aa">yh_option</a> </td></tr>
    <tr><td class="paramname">out</td><td>Option value </td></tr>
    <tr><td class="paramname">out_len</td><td>Length of option value</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> if input parameters are NULL. See <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> for other possible errors </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l03584">3584</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3585</span>                                          {</div>
<div class="line"><span class="lineno"> 3586</span> </div>
<div class="line"><span class="lineno"> 3587</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a> == NULL || out == NULL || <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a565e4b6f63fecad4c290b50ee6684ee3">out_len</a> == NULL) {</div>
<div class="line"><span class="lineno"> 3588</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>));</div>
<div class="line"><span class="lineno"> 3589</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 3590</span>  }</div>
<div class="line"><span class="lineno"> 3591</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a855e99b645b13e7905d074d02fe0bff5">buf</a>[1] = {<a class="code hl_variable" href="yubihsm_8h.html#a023826538a428f5f8c53aaef5e9aec02">option</a>};</div>
<div class="line"><span class="lineno"> 3592</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7e">yh_cmd</a> response_cmd;</div>
<div class="line"><span class="lineno"> 3593</span> </div>
<div class="line"><span class="lineno"> 3594</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="#a4c26f003b72e800e9c934bca922a404a">yh_send_secure_msg</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, YHC_GET_OPTION, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a855e99b645b13e7905d074d02fe0bff5">buf</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a855e99b645b13e7905d074d02fe0bff5">buf</a>),</div>
<div class="line"><span class="lineno"> 3595</span>                                 &amp;response_cmd, out, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a565e4b6f63fecad4c290b50ee6684ee3">out_len</a>);</div>
<div class="line"><span class="lineno"> 3596</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 3597</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Failed to send GET OPTION command: %s\n&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 3598</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 3599</span>  }</div>
<div class="line"><span class="lineno"> 3600</span> </div>
<div class="line"><span class="lineno"> 3601</span>  <span class="keywordflow">if</span> (response_cmd == <a class="code hl_enumvalue" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7ea51cdf2ccd6995498e589e8ea6ce2a1f2">YHC_ERROR</a>) {</div>
<div class="line"><span class="lineno"> 3602</span>    <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> translated = translate_device_error(out[0]);</div>
<div class="line"><span class="lineno"> 3603</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Unable to get option: %s (%x)\n&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(translated), out[0]);</div>
<div class="line"><span class="lineno"> 3604</span>    <span class="keywordflow">return</span> translated;</div>
<div class="line"><span class="lineno"> 3605</span>  }</div>
<div class="line"><span class="lineno"> 3606</span> </div>
<div class="line"><span class="lineno"> 3607</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 3608</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a11871e03c808e2d25737f893e58ed094_cgraph.png" border="0" usemap="#ayubihsm_8c_a11871e03c808e2d25737f893e58ed094_cgraph" alt=""/></div>
<map name="ayubihsm_8c_a11871e03c808e2d25737f893e58ed094_cgraph" id="ayubihsm_8c_a11871e03c808e2d25737f893e58ed094_cgraph">
<area shape="rect" title=" " alt="" coords="5,129,132,155"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="180,104,328,130"/>
<area shape="poly" title=" " alt="" coords="132,131,164,126,164,132,133,136"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="599,153,683,179"/>
<area shape="poly" title=" " alt="" coords="132,142,584,161,584,166,132,147"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="376,55,541,80"/>
<area shape="poly" title=" " alt="" coords="310,101,387,82,388,87,311,106"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="394,104,524,130"/>
<area shape="poly" title=" " alt="" coords="328,114,378,114,378,120,328,120"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="605,55,677,80"/>
<area shape="poly" title=" " alt="" coords="542,65,590,65,590,70,542,70"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="607,5,675,31"/>
<area shape="poly" title=" " alt="" coords="508,51,591,29,593,34,510,57"/>
<area shape="poly" title=" " alt="" coords="520,79,543,89,558,102,568,114,577,127,591,140,596,143,593,148,588,144,573,131,564,118,555,106,540,94,518,83"/>
<area shape="poly" title=" " alt="" coords="508,101,590,78,591,84,510,106"/>
<area shape="poly" title=" " alt="" coords="510,128,585,148,584,154,508,133"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="589,104,693,130"/>
<area shape="poly" title=" " alt="" coords="524,114,574,114,574,120,524,120"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a11871e03c808e2d25737f893e58ed094_icgraph.png" border="0" usemap="#ayubihsm_8c_a11871e03c808e2d25737f893e58ed094_icgraph" alt=""/></div>
<map name="ayubihsm_8c_a11871e03c808e2d25737f893e58ed094_icgraph" id="ayubihsm_8c_a11871e03c808e2d25737f893e58ed094_icgraph">
<area shape="rect" title=" " alt="" coords="478,31,605,56"/>
<area shape="rect" href="logs_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="338,5,388,31"/>
<area shape="poly" title=" " alt="" coords="462,35,388,24,389,19,463,30"/>
<area shape="rect" href="commands_8c.html#aaafb1f743869a0068a7d7b6ed1bafb01" title=" " alt="" coords="296,55,430,80"/>
<area shape="poly" title=" " alt="" coords="463,57,431,61,431,56,463,51"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,55,248,80"/>
<area shape="poly" title=" " alt="" coords="280,70,248,70,248,65,280,65"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,55,55,80"/>
<area shape="poly" title=" " alt="" coords="87,70,55,70,55,65,87,65"/>
</map>
</div>

</div>
</div>
<a id="af1bc8ed34687d83701eb3cc673ad4b96" name="af1bc8ed34687d83701eb3cc673ad4b96"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af1bc8ed34687d83701eb3cc673ad4b96">&#9670;&#160;</a></span>yh_util_get_pseudo_random()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_util_get_pseudo_random </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__session.html">yh_session</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>len</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>out</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *</td>          <td class="paramname"><span class="paramname"><em>out_len</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get a fixed number of pseudo-random bytes from the device</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>Authenticated session to use </td></tr>
    <tr><td class="paramname">len</td><td>Length of pseudo-random data to get </td></tr>
    <tr><td class="paramname">out</td><td>Pseudo-random data out </td></tr>
    <tr><td class="paramname">out_len</td><td>Length of pseudo-random data</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> input parameters are NULL. See <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> for other possible errors </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l01560">1560</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1561</span>                                                 {</div>
<div class="line"><span class="lineno"> 1562</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 1563</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7e">yh_cmd</a> response_cmd;</div>
<div class="line"><span class="lineno"> 1564</span> </div>
<div class="line"><span class="lineno"> 1565</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a> == NULL || out == NULL || <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a565e4b6f63fecad4c290b50ee6684ee3">out_len</a> == NULL) {</div>
<div class="line"><span class="lineno"> 1566</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>));</div>
<div class="line"><span class="lineno"> 1567</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 1568</span>  }</div>
<div class="line"><span class="lineno"> 1569</span> </div>
<div class="line"><span class="lineno"> 1570</span>  <span class="keyword">union </span>{</div>
<div class="line"><span class="lineno"> 1571</span>    <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>;</div>
<div class="line"><span class="lineno"> 1572</span>    <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a855e99b645b13e7905d074d02fe0bff5">buf</a>[2];</div>
<div class="line"><span class="lineno"> 1573</span>  } data;</div>
<div class="line"><span class="lineno"> 1574</span>  data.len = htons(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>);</div>
<div class="line"><span class="lineno"> 1575</span> </div>
<div class="line"><span class="lineno"> 1576</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="#a4c26f003b72e800e9c934bca922a404a">yh_send_secure_msg</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, YHC_GET_PSEUDO_RANDOM, data.buf,</div>
<div class="line"><span class="lineno"> 1577</span>                           <span class="keyword">sizeof</span>(data), &amp;response_cmd, out, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a565e4b6f63fecad4c290b50ee6684ee3">out_len</a>);</div>
<div class="line"><span class="lineno"> 1578</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 1579</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Failed to send GET PSEUDO RANDOM command: %s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 1580</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 1581</span>  }</div>
<div class="line"><span class="lineno"> 1582</span> </div>
<div class="line"><span class="lineno"> 1583</span>  <span class="keywordflow">if</span> (response_cmd == <a class="code hl_enumvalue" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7ea51cdf2ccd6995498e589e8ea6ce2a1f2">YHC_ERROR</a>) {</div>
<div class="line"><span class="lineno"> 1584</span>    <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> translated = translate_device_error(out[0]);</div>
<div class="line"><span class="lineno"> 1585</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Unable to get data: %s (%x)&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(translated), out[0]);</div>
<div class="line"><span class="lineno"> 1586</span>    <span class="keywordflow">return</span> translated;</div>
<div class="line"><span class="lineno"> 1587</span>  }</div>
<div class="line"><span class="lineno"> 1588</span> </div>
<div class="line"><span class="lineno"> 1589</span>  <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 1590</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_af1bc8ed34687d83701eb3cc673ad4b96_cgraph.png" border="0" usemap="#ayubihsm_8c_af1bc8ed34687d83701eb3cc673ad4b96_cgraph" alt=""/></div>
<map name="ayubihsm_8c_af1bc8ed34687d83701eb3cc673ad4b96_cgraph" id="ayubihsm_8c_af1bc8ed34687d83701eb3cc673ad4b96_cgraph">
<area shape="rect" title=" " alt="" coords="5,122,139,162"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="187,104,335,130"/>
<area shape="poly" title=" " alt="" coords="139,131,171,126,171,132,139,136"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="606,153,690,179"/>
<area shape="poly" title=" " alt="" coords="139,142,591,161,591,167,139,148"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="383,55,548,80"/>
<area shape="poly" title=" " alt="" coords="317,101,394,82,395,87,318,106"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="400,104,531,130"/>
<area shape="poly" title=" " alt="" coords="335,114,385,114,385,120,335,120"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="612,55,684,80"/>
<area shape="poly" title=" " alt="" coords="549,65,597,65,597,70,549,70"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="614,5,682,31"/>
<area shape="poly" title=" " alt="" coords="515,51,598,29,600,34,517,57"/>
<area shape="poly" title=" " alt="" coords="527,79,550,89,565,102,575,114,584,127,598,140,603,143,600,148,595,144,580,131,571,118,562,106,547,94,525,83"/>
<area shape="poly" title=" " alt="" coords="515,101,597,78,598,84,517,106"/>
<area shape="poly" title=" " alt="" coords="517,128,592,148,591,154,515,133"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="596,104,700,130"/>
<area shape="poly" title=" " alt="" coords="531,114,581,114,581,120,531,120"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_af1bc8ed34687d83701eb3cc673ad4b96_icgraph.png" border="0" usemap="#ayubihsm_8c_af1bc8ed34687d83701eb3cc673ad4b96_icgraph" alt=""/></div>
<map name="ayubihsm_8c_af1bc8ed34687d83701eb3cc673ad4b96_icgraph" id="ayubihsm_8c_af1bc8ed34687d83701eb3cc673ad4b96_icgraph">
<area shape="rect" title=" " alt="" coords="486,47,620,88"/>
<area shape="rect" href="import__authkey_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="342,5,392,31"/>
<area shape="poly" title=" " alt="" coords="471,48,392,27,393,22,472,43"/>
<area shape="rect" href="commands_8c.html#ae2e50929acc6085cd395d0bd4ddb02db" title=" " alt="" coords="298,55,436,80"/>
<area shape="poly" title=" " alt="" coords="471,70,437,70,437,65,471,65"/>
<area shape="rect" href="commands_8c.html#af32a8f10f2d022ca8b7816e6f4809a24" title=" " alt="" coords="296,104,438,130"/>
<area shape="poly" title=" " alt="" coords="472,92,419,106,417,101,471,86"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,55,248,80"/>
<area shape="poly" title=" " alt="" coords="282,70,248,70,248,65,282,65"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,80,55,106"/>
<area shape="poly" title=" " alt="" coords="88,85,55,91,54,86,87,80"/>
<area shape="poly" title=" " alt="" coords="299,102,228,84,229,78,301,97"/>
<area shape="poly" title=" " alt="" coords="280,113,55,97,55,92,281,108"/>
</map>
</div>

</div>
</div>
<a id="aa7b8b42156c4bdaf41d8b9758a2fd73f" name="aa7b8b42156c4bdaf41d8b9758a2fd73f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa7b8b42156c4bdaf41d8b9758a2fd73f">&#9670;&#160;</a></span>yh_util_get_public_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_util_get_public_key </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__session.html">yh_session</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a></td>          <td class="paramname"><span class="paramname"><em>id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>data</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *</td>          <td class="paramname"><span class="paramname"><em>data_len</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55ca">yh_algorithm</a> *</td>          <td class="paramname"><span class="paramname"><em>algorithm</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get the value of the public key with the specified Object ID</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>Authenticated session to use </td></tr>
    <tr><td class="paramname">id</td><td>Object ID of the public key </td></tr>
    <tr><td class="paramname">data</td><td>Value of the public key </td></tr>
    <tr><td class="paramname">data_len</td><td>Length of the public key in bytes </td></tr>
    <tr><td class="paramname">algorithm</td><td>Algorithm of the key</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> if input parameters are NULL. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366ad8971a0b9647564b76b3f4e4b662c965" title="Returned value when there is not enough space to store data.">YHR_BUFFER_TOO_SMALL</a> if the actual key length was bigger than data_len. See <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> for other possible errors </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l01216">1216</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1217</span>                                                                        {</div>
<div class="line"><span class="lineno"> 1218</span> </div>
<div class="line"><span class="lineno"> 1219</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a> == NULL || data == NULL || data_len == NULL) {</div>
<div class="line"><span class="lineno"> 1220</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>));</div>
<div class="line"><span class="lineno"> 1221</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 1222</span>  }</div>
<div class="line"><span class="lineno"> 1223</span> </div>
<div class="line"><span class="lineno"> 1224</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> cmd[2] = {<span class="keywordtype">id</span> &gt;&gt; 8, <span class="keywordtype">id</span> &amp; 0xff};</div>
<div class="line"><span class="lineno"> 1225</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7e">yh_cmd</a> response_cmd;</div>
<div class="line"><span class="lineno"> 1226</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> response[<a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a>];</div>
<div class="line"><span class="lineno"> 1227</span>  <span class="keywordtype">size_t</span> response_len = <span class="keyword">sizeof</span>(response);</div>
<div class="line"><span class="lineno"> 1228</span> </div>
<div class="line"><span class="lineno"> 1229</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="#a4c26f003b72e800e9c934bca922a404a">yh_send_secure_msg</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, YHC_GET_PUBLIC_KEY, cmd, <span class="keyword">sizeof</span>(cmd),</div>
<div class="line"><span class="lineno"> 1230</span>                                 &amp;response_cmd, response, &amp;response_len);</div>
<div class="line"><span class="lineno"> 1231</span> </div>
<div class="line"><span class="lineno"> 1232</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 1233</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Failed to send GET PUBLIC KEY command: %s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 1234</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 1235</span>  }</div>
<div class="line"><span class="lineno"> 1236</span> </div>
<div class="line"><span class="lineno"> 1237</span>  <span class="keywordflow">if</span> (response_cmd == <a class="code hl_enumvalue" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7ea51cdf2ccd6995498e589e8ea6ce2a1f2">YHC_ERROR</a>) {</div>
<div class="line"><span class="lineno"> 1238</span>    <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> translated = translate_device_error(response[0]);</div>
<div class="line"><span class="lineno"> 1239</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Unable to get public key: %s (%x)&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(translated),</div>
<div class="line"><span class="lineno"> 1240</span>            response[0]);</div>
<div class="line"><span class="lineno"> 1241</span>    <span class="keywordflow">return</span> translated;</div>
<div class="line"><span class="lineno"> 1242</span>  }</div>
<div class="line"><span class="lineno"> 1243</span> </div>
<div class="line"><span class="lineno"> 1244</span>  <span class="keywordflow">if</span> (response_len &gt; *data_len) {</div>
<div class="line"><span class="lineno"> 1245</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366ad8971a0b9647564b76b3f4e4b662c965">YHR_BUFFER_TOO_SMALL</a>;</div>
<div class="line"><span class="lineno"> 1246</span>  }</div>
<div class="line"><span class="lineno"> 1247</span> </div>
<div class="line"><span class="lineno"> 1248</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>) {</div>
<div class="line"><span class="lineno"> 1249</span>    *<a class="code hl_variable" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a> = *response;</div>
<div class="line"><span class="lineno"> 1250</span>  }</div>
<div class="line"><span class="lineno"> 1251</span>  *data_len = response_len - 1;</div>
<div class="line"><span class="lineno"> 1252</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(data, response + 1, *data_len);</div>
<div class="line"><span class="lineno"> 1253</span> </div>
<div class="line"><span class="lineno"> 1254</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 1255</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_aa7b8b42156c4bdaf41d8b9758a2fd73f_cgraph.png" border="0" usemap="#ayubihsm_8c_aa7b8b42156c4bdaf41d8b9758a2fd73f_cgraph" alt=""/></div>
<map name="ayubihsm_8c_aa7b8b42156c4bdaf41d8b9758a2fd73f_cgraph" id="ayubihsm_8c_aa7b8b42156c4bdaf41d8b9758a2fd73f_cgraph">
<area shape="rect" title=" " alt="" coords="5,80,159,106"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="632,5,704,31"/>
<area shape="poly" title=" " alt="" coords="144,77,206,65,321,48,435,35,616,19,617,24,436,40,322,53,207,70,145,82"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="207,80,355,106"/>
<area shape="poly" title=" " alt="" coords="159,90,191,90,191,96,159,96"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="626,104,710,130"/>
<area shape="poly" title=" " alt="" coords="144,104,207,116,308,133,387,145,467,148,568,140,611,131,612,136,569,145,467,153,387,150,307,138,206,121,144,109"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="403,55,568,80"/>
<area shape="poly" title=" " alt="" coords="355,81,387,77,388,82,355,86"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="420,104,551,130"/>
<area shape="poly" title=" " alt="" coords="355,99,406,105,405,110,355,104"/>
<area shape="poly" title=" " alt="" coords="535,51,617,29,618,34,537,57"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="634,55,702,80"/>
<area shape="poly" title=" " alt="" coords="569,65,618,65,618,70,569,70"/>
<area shape="poly" title=" " alt="" coords="537,78,612,99,611,104,535,84"/>
<area shape="poly" title=" " alt="" coords="545,101,567,91,582,79,591,67,600,54,615,40,620,37,623,41,618,44,604,57,595,70,585,83,570,95,547,106"/>
<area shape="poly" title=" " alt="" coords="551,114,611,114,611,120,551,120"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="616,153,720,179"/>
<area shape="poly" title=" " alt="" coords="537,128,604,146,602,151,535,133"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_aa7b8b42156c4bdaf41d8b9758a2fd73f_icgraph.png" border="0" usemap="#ayubihsm_8c_aa7b8b42156c4bdaf41d8b9758a2fd73f_icgraph" alt=""/></div>
<map name="ayubihsm_8c_aa7b8b42156c4bdaf41d8b9758a2fd73f_icgraph" id="ayubihsm_8c_aa7b8b42156c4bdaf41d8b9758a2fd73f_icgraph">
<area shape="rect" title=" " alt="" coords="556,134,710,159"/>
<area shape="rect" href="decrypt__ec_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="380,35,429,61"/>
<area shape="poly" title=" " alt="" coords="599,127,557,100,507,76,467,62,429,54,430,49,468,57,509,71,559,96,602,122"/>
<area shape="rect" href="structsysio_1_1wallet_1_1detail_1_1yubihsm__wallet__impl.html#adbeac5d7c3d1ad9d3cb6c37cc996d8c5" title=" " alt="" coords="301,85,508,141"/>
<area shape="poly" title=" " alt="" coords="540,136,508,131,509,126,541,130"/>
<area shape="rect" href="commands_8c.html#ae2e50929acc6085cd395d0bd4ddb02db" title=" " alt="" coords="336,166,474,191"/>
<area shape="poly" title=" " alt="" coords="541,162,475,171,474,166,540,157"/>
<area shape="rect" href="commands_8c.html#aa1c9a933f4601dae48cd64f911d297aa" title=" " alt="" coords="334,215,475,241"/>
<area shape="poly" title=" " alt="" coords="594,169,509,206,473,217,471,212,507,201,592,164"/>
<area shape="rect" href="structsysio_1_1wallet_1_1detail_1_1yubihsm__wallet__impl.html#a6266bcd9001ddbb02101bea6088f299b" title=" " alt="" coords="103,5,253,61"/>
<area shape="poly" title=" " alt="" coords="309,82,252,62,254,57,310,77"/>
<area shape="rect" href="structsysio_1_1wallet_1_1detail_1_1yubihsm__wallet__impl.html#a00ee0ac7ac4a819d0b8755bf4f442263" title=" " alt="" coords="103,85,253,141"/>
<area shape="poly" title=" " alt="" coords="285,116,253,116,253,110,285,110"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="105,166,250,191"/>
<area shape="poly" title=" " alt="" coords="320,181,251,181,251,176,320,176"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,191,55,217"/>
<area shape="poly" title=" " alt="" coords="90,196,55,202,55,197,89,191"/>
<area shape="poly" title=" " alt="" coords="327,214,240,195,241,189,328,208"/>
<area shape="poly" title=" " alt="" coords="318,225,55,208,55,203,319,220"/>
</map>
</div>

</div>
</div>
<a id="ae87d5578703775b9d4151a14435f4a73" name="ae87d5578703775b9d4151a14435f4a73"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae87d5578703775b9d4151a14435f4a73">&#9670;&#160;</a></span>yh_util_get_storage_info()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_util_get_storage_info </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__session.html">yh_session</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *</td>          <td class="paramname"><span class="paramname"><em>total_records</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *</td>          <td class="paramname"><span class="paramname"><em>free_records</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *</td>          <td class="paramname"><span class="paramname"><em>total_pages</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *</td>          <td class="paramname"><span class="paramname"><em>free_pages</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *</td>          <td class="paramname"><span class="paramname"><em>page_size</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Report currently free storage. This is reported as free records, free pages and page size.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>Authenticated session to use </td></tr>
    <tr><td class="paramname">total_records</td><td>Total number of records </td></tr>
    <tr><td class="paramname">free_records</td><td>Number of free records </td></tr>
    <tr><td class="paramname">total_pages</td><td>Total number of pages </td></tr>
    <tr><td class="paramname">free_pages</td><td>Number of free pages </td></tr>
    <tr><td class="paramname">page_size</td><td>Page size in bytes</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> if the session is NULL. See <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> for other possible errors </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l03610">3610</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3612</span>                                                                          {</div>
<div class="line"><span class="lineno"> 3613</span> </div>
<div class="line"><span class="lineno"> 3614</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a> == NULL) {</div>
<div class="line"><span class="lineno"> 3615</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>));</div>
<div class="line"><span class="lineno"> 3616</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 3617</span>  }</div>
<div class="line"><span class="lineno"> 3618</span> </div>
<div class="line"><span class="lineno"> 3619</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7e">yh_cmd</a> response_cmd;</div>
<div class="line"><span class="lineno"> 3620</span><span class="preprocessor">#pragma pack(push, 1)</span></div>
<div class="line"><span class="lineno"> 3621</span>  <span class="keyword">union </span>{</div>
<div class="line"><span class="lineno"> 3622</span>    <span class="keyword">struct </span>{</div>
<div class="line"><span class="lineno"> 3623</span>      <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> total_records;</div>
<div class="line"><span class="lineno"> 3624</span>      <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> free_records;</div>
<div class="line"><span class="lineno"> 3625</span>      <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> total_pages;</div>
<div class="line"><span class="lineno"> 3626</span>      <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> free_pages;</div>
<div class="line"><span class="lineno"> 3627</span>      <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="code hl_enumvalue" href="namespacesysio_1_1vm.html#a0ae6751a77293216df4656dee5081eb2a10108b6260714ad13914454c1dd1ec8f">page_size</a>;</div>
<div class="line"><span class="lineno"> 3628</span>    };</div>
<div class="line"><span class="lineno"> 3629</span>    <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a855e99b645b13e7905d074d02fe0bff5">buf</a>[1];</div>
<div class="line"><span class="lineno"> 3630</span>  } response;</div>
<div class="line"><span class="lineno"> 3631</span><span class="preprocessor">#pragma pack(pop)</span></div>
<div class="line"><span class="lineno"> 3632</span>  <span class="keywordtype">size_t</span> response_len = <span class="keyword">sizeof</span>(response);</div>
<div class="line"><span class="lineno"> 3633</span> </div>
<div class="line"><span class="lineno"> 3634</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="#a4c26f003b72e800e9c934bca922a404a">yh_send_secure_msg</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, YHC_GET_STORAGE_INFO, NULL, 0,</div>
<div class="line"><span class="lineno"> 3635</span>                                 &amp;response_cmd, response.buf, &amp;response_len);</div>
<div class="line"><span class="lineno"> 3636</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 3637</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Failed to send GET STORAGE INFO command: %s\n&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 3638</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 3639</span>  }</div>
<div class="line"><span class="lineno"> 3640</span> </div>
<div class="line"><span class="lineno"> 3641</span>  <span class="keywordflow">if</span> (response_cmd == <a class="code hl_enumvalue" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7ea51cdf2ccd6995498e589e8ea6ce2a1f2">YHC_ERROR</a>) {</div>
<div class="line"><span class="lineno"> 3642</span>    <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> translated = translate_device_error(response.buf[0]);</div>
<div class="line"><span class="lineno"> 3643</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Unable to get storage stats: %s (%x)\n&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(translated),</div>
<div class="line"><span class="lineno"> 3644</span>            response.buf[0]);</div>
<div class="line"><span class="lineno"> 3645</span>    <span class="keywordflow">return</span> translated;</div>
<div class="line"><span class="lineno"> 3646</span>  }</div>
<div class="line"><span class="lineno"> 3647</span> </div>
<div class="line"><span class="lineno"> 3648</span>  <span class="keywordflow">if</span> (total_records) {</div>
<div class="line"><span class="lineno"> 3649</span>    *total_records = ntohs(response.total_records);</div>
<div class="line"><span class="lineno"> 3650</span>  }</div>
<div class="line"><span class="lineno"> 3651</span>  <span class="keywordflow">if</span> (free_records) {</div>
<div class="line"><span class="lineno"> 3652</span>    *free_records = ntohs(response.free_records);</div>
<div class="line"><span class="lineno"> 3653</span>  }</div>
<div class="line"><span class="lineno"> 3654</span>  <span class="keywordflow">if</span> (total_pages) {</div>
<div class="line"><span class="lineno"> 3655</span>    *total_pages = ntohs(response.total_pages);</div>
<div class="line"><span class="lineno"> 3656</span>  }</div>
<div class="line"><span class="lineno"> 3657</span>  <span class="keywordflow">if</span> (free_pages) {</div>
<div class="line"><span class="lineno"> 3658</span>    *free_pages = ntohs(response.free_pages);</div>
<div class="line"><span class="lineno"> 3659</span>  }</div>
<div class="line"><span class="lineno"> 3660</span>  <span class="keywordflow">if</span> (page_size) {</div>
<div class="line"><span class="lineno"> 3661</span>    *<a class="code hl_enumvalue" href="namespacesysio_1_1vm.html#a0ae6751a77293216df4656dee5081eb2a10108b6260714ad13914454c1dd1ec8f">page_size</a> = ntohs(response.page_size);</div>
<div class="line"><span class="lineno"> 3662</span>  }</div>
<div class="line"><span class="lineno"> 3663</span> </div>
<div class="line"><span class="lineno"> 3664</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 3665</span>}</div>
<div class="ttc" id="anamespacesysio_1_1vm_html_a0ae6751a77293216df4656dee5081eb2a10108b6260714ad13914454c1dd1ec8f"><div class="ttname"><a href="namespacesysio_1_1vm.html#a0ae6751a77293216df4656dee5081eb2a10108b6260714ad13914454c1dd1ec8f">sysio::vm::page_size</a></div><div class="ttdeci">@ page_size</div><div class="ttdef"><b>Definition</b> <a href="sys-vm_2include_2sysio_2sysio_2vm_2constants_8hpp_source.html#l00017">constants.hpp:17</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_ae87d5578703775b9d4151a14435f4a73_cgraph.png" border="0" usemap="#ayubihsm_8c_ae87d5578703775b9d4151a14435f4a73_cgraph" alt=""/></div>
<map name="ayubihsm_8c_ae87d5578703775b9d4151a14435f4a73_cgraph" id="ayubihsm_8c_ae87d5578703775b9d4151a14435f4a73_cgraph">
<area shape="rect" title=" " alt="" coords="5,129,168,155"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="216,104,364,130"/>
<area shape="poly" title=" " alt="" coords="168,129,200,125,201,131,169,135"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="635,153,719,179"/>
<area shape="poly" title=" " alt="" coords="168,143,620,161,619,167,168,148"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="412,55,577,80"/>
<area shape="poly" title=" " alt="" coords="346,101,423,82,424,87,347,106"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="430,104,560,130"/>
<area shape="poly" title=" " alt="" coords="364,114,414,114,414,120,364,120"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="641,55,713,80"/>
<area shape="poly" title=" " alt="" coords="578,65,626,65,626,70,578,70"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="643,5,711,31"/>
<area shape="poly" title=" " alt="" coords="544,51,627,29,629,34,546,57"/>
<area shape="poly" title=" " alt="" coords="556,79,579,89,594,102,604,114,613,127,627,140,632,143,629,148,624,144,609,131,600,118,591,106,576,94,554,83"/>
<area shape="poly" title=" " alt="" coords="544,101,626,78,627,84,546,106"/>
<area shape="poly" title=" " alt="" coords="546,128,621,148,620,154,544,133"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="625,104,729,130"/>
<area shape="poly" title=" " alt="" coords="560,114,610,114,610,120,560,120"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_ae87d5578703775b9d4151a14435f4a73_icgraph.png" border="0" usemap="#ayubihsm_8c_ae87d5578703775b9d4151a14435f4a73_icgraph" alt=""/></div>
<map name="ayubihsm_8c_ae87d5578703775b9d4151a14435f4a73_icgraph" id="ayubihsm_8c_ae87d5578703775b9d4151a14435f4a73_icgraph">
<area shape="rect" title=" " alt="" coords="486,31,649,56"/>
<area shape="rect" href="commands_8c.html#a408c9e43b8ccb159acb178f2b20f3f77" title=" " alt="" coords="296,31,438,56"/>
<area shape="poly" title=" " alt="" coords="471,46,439,46,439,41,471,41"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="280,35,248,30,249,25,281,29"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,31,55,56"/>
<area shape="poly" title=" " alt="" coords="281,46,55,46,55,41,281,41"/>
<area shape="poly" title=" " alt="" coords="88,36,55,42,54,37,87,31"/>
</map>
</div>

</div>
</div>
<a id="a47768ae0e72beba49f02db1baddf4823" name="a47768ae0e72beba49f02db1baddf4823"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a47768ae0e72beba49f02db1baddf4823">&#9670;&#160;</a></span>yh_util_get_template()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_util_get_template </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__session.html">yh_session</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a></td>          <td class="paramname"><span class="paramname"><em>object_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>out</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *</td>          <td class="paramname"><span class="paramname"><em>out_len</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get a <a class="el" href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583a96244762de5ce4175e60157239e7a097">YH_TEMPLATE</a> object from the device</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>Authenticated session to use </td></tr>
    <tr><td class="paramname">object_id</td><td>Object ID of the Template to get </td></tr>
    <tr><td class="paramname">out</td><td>The retrieved Template </td></tr>
    <tr><td class="paramname">out_len</td><td>Length of the retrieved Template</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> if input parameters are NULL. See <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> for other possible errors </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l02805">2805</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2806</span>                                                          {</div>
<div class="line"><span class="lineno"> 2807</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a> == NULL || out == NULL) {</div>
<div class="line"><span class="lineno"> 2808</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>));</div>
<div class="line"><span class="lineno"> 2809</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 2810</span>  }</div>
<div class="line"><span class="lineno"> 2811</span> </div>
<div class="line"><span class="lineno"> 2812</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> data[2];</div>
<div class="line"><span class="lineno"> 2813</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7e">yh_cmd</a> response_cmd;</div>
<div class="line"><span class="lineno"> 2814</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 2815</span> </div>
<div class="line"><span class="lineno"> 2816</span>  <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> object_id_h = htons(object_id);</div>
<div class="line"><span class="lineno"> 2817</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(data, &amp;object_id_h, <span class="keyword">sizeof</span>(object_id_h));</div>
<div class="line"><span class="lineno"> 2818</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="#a4c26f003b72e800e9c934bca922a404a">yh_send_secure_msg</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, YHC_GET_TEMPLATE, data, <span class="keyword">sizeof</span>(data),</div>
<div class="line"><span class="lineno"> 2819</span>                           &amp;response_cmd, out, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a565e4b6f63fecad4c290b50ee6684ee3">out_len</a>);</div>
<div class="line"><span class="lineno"> 2820</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 2821</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Failed to send GET TEMPLATE command: %s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 2822</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 2823</span>  }</div>
<div class="line"><span class="lineno"> 2824</span> </div>
<div class="line"><span class="lineno"> 2825</span>  <span class="keywordflow">if</span> (response_cmd == <a class="code hl_enumvalue" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7ea51cdf2ccd6995498e589e8ea6ce2a1f2">YHC_ERROR</a>) {</div>
<div class="line"><span class="lineno"> 2826</span>    <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> translated = translate_device_error(out[0]);</div>
<div class="line"><span class="lineno"> 2827</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Unable to get template object: %s (%x)&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(translated),</div>
<div class="line"><span class="lineno"> 2828</span>            out[0]);</div>
<div class="line"><span class="lineno"> 2829</span>    <span class="keywordflow">return</span> translated;</div>
<div class="line"><span class="lineno"> 2830</span>  }</div>
<div class="line"><span class="lineno"> 2831</span> </div>
<div class="line"><span class="lineno"> 2832</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 2833</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a47768ae0e72beba49f02db1baddf4823_cgraph.png" border="0" usemap="#ayubihsm_8c_a47768ae0e72beba49f02db1baddf4823_cgraph" alt=""/></div>
<map name="ayubihsm_8c_a47768ae0e72beba49f02db1baddf4823_cgraph" id="ayubihsm_8c_a47768ae0e72beba49f02db1baddf4823_cgraph">
<area shape="rect" title=" " alt="" coords="5,80,147,106"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="620,5,692,31"/>
<area shape="poly" title=" " alt="" coords="135,77,194,65,309,48,423,35,604,19,605,24,424,40,310,53,195,70,136,82"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="195,80,343,106"/>
<area shape="poly" title=" " alt="" coords="147,90,179,90,179,96,147,96"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="614,104,698,130"/>
<area shape="poly" title=" " alt="" coords="135,104,195,116,296,133,375,145,455,148,556,140,599,131,600,136,557,145,455,153,375,150,295,139,194,121,134,109"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="391,55,556,80"/>
<area shape="poly" title=" " alt="" coords="343,81,375,77,376,82,343,86"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="408,104,539,130"/>
<area shape="poly" title=" " alt="" coords="343,99,394,105,393,110,343,104"/>
<area shape="poly" title=" " alt="" coords="523,51,605,29,606,34,525,57"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="622,55,690,80"/>
<area shape="poly" title=" " alt="" coords="557,65,606,65,606,70,557,70"/>
<area shape="poly" title=" " alt="" coords="525,78,600,99,599,104,523,84"/>
<area shape="poly" title=" " alt="" coords="533,101,555,91,570,79,579,67,588,54,603,40,608,37,611,41,606,44,592,57,583,70,573,83,558,95,535,106"/>
<area shape="poly" title=" " alt="" coords="539,114,599,114,599,120,539,120"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="604,153,708,179"/>
<area shape="poly" title=" " alt="" coords="525,128,592,146,590,151,523,133"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a47768ae0e72beba49f02db1baddf4823_icgraph.png" border="0" usemap="#ayubihsm_8c_a47768ae0e72beba49f02db1baddf4823_icgraph" alt=""/></div>
<map name="ayubihsm_8c_a47768ae0e72beba49f02db1baddf4823_icgraph" id="ayubihsm_8c_a47768ae0e72beba49f02db1baddf4823_icgraph">
<area shape="rect" title=" " alt="" coords="493,31,635,56"/>
<area shape="rect" href="ssh_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="346,5,395,31"/>
<area shape="poly" title=" " alt="" coords="477,35,396,24,396,19,478,30"/>
<area shape="rect" href="commands_8c.html#ac8e5bb8ba179bc997ddc73e03423782d" title=" " alt="" coords="296,55,445,80"/>
<area shape="poly" title=" " alt="" coords="478,57,446,61,445,56,477,52"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,29,248,55"/>
<area shape="poly" title=" " alt="" coords="280,58,248,54,249,49,281,53"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,55,55,80"/>
<area shape="poly" title=" " alt="" coords="280,70,55,70,55,65,280,65"/>
<area shape="poly" title=" " alt="" coords="88,60,55,66,54,61,87,55"/>
</map>
</div>

</div>
</div>
<a id="ac154da7ac6dc0a7b4b3a6cdff9433da8" name="ac154da7ac6dc0a7b4b3a6cdff9433da8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac154da7ac6dc0a7b4b3a6cdff9433da8">&#9670;&#160;</a></span>yh_util_import_authentication_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_util_import_authentication_key </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__session.html">yh_session</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *</td>          <td class="paramname"><span class="paramname"><em>key_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>label</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a></td>          <td class="paramname"><span class="paramname"><em>domains</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structyh__capabilities.html">yh_capabilities</a> *</td>          <td class="paramname"><span class="paramname"><em>capabilities</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structyh__capabilities.html">yh_capabilities</a> *</td>          <td class="paramname"><span class="paramname"><em>delegated_capabilities</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>key_enc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>key_enc_len</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>key_mac</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>key_mac_len</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Import an <a class="el" href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583acee44b775b3c5b6157f0732699935074" title="Authentication Key is used to establish Sessions with a device.">YH_AUTHENTICATION_KEY</a> into the device</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>Authenticated session to use </td></tr>
    <tr><td class="paramname">key_id</td><td>Object ID of the imported key. 0 if the Object ID should be generated by the device </td></tr>
    <tr><td class="paramname">label</td><td>Label of the key. Maximum length is <a class="el" href="yubihsm_8h.html#a431f8b753552a8b2f5f980e871b6d019" title="Max length of object labels.">YH_OBJ_LABEL_LEN</a> </td></tr>
    <tr><td class="paramname">domains</td><td>Domains to which the key belongs. See <a class="el" href="yubihsm_8h.html#a96a4c751a281515d5610adb8fd779438">yh_string_to_domains()</a> </td></tr>
    <tr><td class="paramname">capabilities</td><td>Capabilities of the key. See <a class="el" href="yubihsm_8h.html#aab440e1cb671d9ba7a2e7d1243960e42">yh_string_to_capabilities()</a> </td></tr>
    <tr><td class="paramname">delegated_capabilities</td><td>Delegated capabilities of the key. See <a class="el" href="yubihsm_8h.html#aab440e1cb671d9ba7a2e7d1243960e42">yh_string_to_capabilities()</a> </td></tr>
    <tr><td class="paramname">key_enc</td><td>Long lived encryption key of the Authentication Key to import </td></tr>
    <tr><td class="paramname">key_enc_len</td><td>Length of the encryption key. Must be <a class="el" href="yubihsm_8h.html#ac2737b2a34c26d0258d25e34993df391" title="Length of authentication keys.">YH_KEY_LEN</a> </td></tr>
    <tr><td class="paramname">key_mac</td><td>Long lived MAC key of the Authentication Key to import </td></tr>
    <tr><td class="paramname">key_mac_len</td><td>Length of the MAC key. Must be <a class="el" href="yubihsm_8h.html#ac2737b2a34c26d0258d25e34993df391" title="Length of authentication keys.">YH_KEY_LEN</a></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> if input parameters are NULL or if <code>key_enc_len</code> or <code>key_mac_len</code> are not the expected values. See <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> for other possible errors</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a href="https://developers.yubico.com/YubiHSM2/Concepts/Object.html">Authentication Key</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l02985">2985</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2989</span>                                                                  {</div>
<div class="line"><span class="lineno"> 2990</span> </div>
<div class="line"><span class="lineno"> 2991</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a> == NULL || <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a> == NULL || <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> == NULL ||</div>
<div class="line"><span class="lineno"> 2992</span>      strlen(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>) &gt; <a class="code hl_define" href="yubihsm_8h.html#a431f8b753552a8b2f5f980e871b6d019">YH_OBJ_LABEL_LEN</a> || <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a> == NULL ||</div>
<div class="line"><span class="lineno"> 2993</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#afa62e10709d52e5162a732e81369a7ec">delegated_capabilities</a> == NULL || key_enc == NULL ||</div>
<div class="line"><span class="lineno"> 2994</span>      key_enc_len != <a class="code hl_define" href="yubihsm_8h.html#ac2737b2a34c26d0258d25e34993df391">YH_KEY_LEN</a> || key_mac == NULL ||</div>
<div class="line"><span class="lineno"> 2995</span>      key_mac_len != <a class="code hl_define" href="yubihsm_8h.html#ac2737b2a34c26d0258d25e34993df391">YH_KEY_LEN</a>) {</div>
<div class="line"><span class="lineno"> 2996</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>));</div>
<div class="line"><span class="lineno"> 2997</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 2998</span>  }</div>
<div class="line"><span class="lineno"> 2999</span> </div>
<div class="line"><span class="lineno"> 3000</span><span class="preprocessor">#pragma pack(push, 1)</span></div>
<div class="line"><span class="lineno"> 3001</span>  <span class="keyword">union </span>{</div>
<div class="line"><span class="lineno"> 3002</span>    <span class="keyword">struct </span>{</div>
<div class="line"><span class="lineno"> 3003</span>      <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>;</div>
<div class="line"><span class="lineno"> 3004</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>[<a class="code hl_define" href="yubihsm_8h.html#a431f8b753552a8b2f5f980e871b6d019">YH_OBJ_LABEL_LEN</a>];</div>
<div class="line"><span class="lineno"> 3005</span>      <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a5420fd4d2f76428942c2716b1cb7e863">domains</a>;</div>
<div class="line"><span class="lineno"> 3006</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>[<a class="code hl_define" href="yubihsm_8h.html#ad3c904849d17cae0a6f426e8007731d7">YH_CAPABILITIES_LEN</a>];</div>
<div class="line"><span class="lineno"> 3007</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>;</div>
<div class="line"><span class="lineno"> 3008</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#afa62e10709d52e5162a732e81369a7ec">delegated_capabilities</a>[<a class="code hl_define" href="yubihsm_8h.html#ad3c904849d17cae0a6f426e8007731d7">YH_CAPABILITIES_LEN</a>];</div>
<div class="line"><span class="lineno"> 3009</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> key_enc[<a class="code hl_define" href="yubihsm_8h.html#ac2737b2a34c26d0258d25e34993df391">YH_KEY_LEN</a>];</div>
<div class="line"><span class="lineno"> 3010</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> key_mac[<a class="code hl_define" href="yubihsm_8h.html#ac2737b2a34c26d0258d25e34993df391">YH_KEY_LEN</a>];</div>
<div class="line"><span class="lineno"> 3011</span>    };</div>
<div class="line"><span class="lineno"> 3012</span>    <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a855e99b645b13e7905d074d02fe0bff5">buf</a>[1];</div>
<div class="line"><span class="lineno"> 3013</span>  } data;</div>
<div class="line"><span class="lineno"> 3014</span>  <span class="keyword">union </span>{</div>
<div class="line"><span class="lineno"> 3015</span>    <span class="keyword">struct </span>{</div>
<div class="line"><span class="lineno"> 3016</span>      <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>;</div>
<div class="line"><span class="lineno"> 3017</span>    };</div>
<div class="line"><span class="lineno"> 3018</span>    <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a855e99b645b13e7905d074d02fe0bff5">buf</a>[1];</div>
<div class="line"><span class="lineno"> 3019</span>  } response;</div>
<div class="line"><span class="lineno"> 3020</span><span class="preprocessor">#pragma pack(pop)</span></div>
<div class="line"><span class="lineno"> 3021</span>  <span class="keywordtype">size_t</span> response_len = <span class="keyword">sizeof</span>(response);</div>
<div class="line"><span class="lineno"> 3022</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7e">yh_cmd</a> response_cmd;</div>
<div class="line"><span class="lineno"> 3023</span> </div>
<div class="line"><span class="lineno"> 3024</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(data.key_enc, key_enc, <a class="code hl_define" href="yubihsm_8h.html#ac2737b2a34c26d0258d25e34993df391">YH_KEY_LEN</a>);</div>
<div class="line"><span class="lineno"> 3025</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(data.key_mac, key_mac, <a class="code hl_define" href="yubihsm_8h.html#ac2737b2a34c26d0258d25e34993df391">YH_KEY_LEN</a>);</div>
<div class="line"><span class="lineno"> 3026</span> </div>
<div class="line"><span class="lineno"> 3027</span>  data.key_id = htons(*<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>);</div>
<div class="line"><span class="lineno"> 3028</span> </div>
<div class="line"><span class="lineno"> 3029</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(data.label, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>, strlen(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>));</div>
<div class="line"><span class="lineno"> 3030</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105">memset</a>(data.label + strlen(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>), 0, <a class="code hl_define" href="yubihsm_8h.html#a431f8b753552a8b2f5f980e871b6d019">YH_OBJ_LABEL_LEN</a> - strlen(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>));</div>
<div class="line"><span class="lineno"> 3031</span> </div>
<div class="line"><span class="lineno"> 3032</span>  data.domains = htons(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a5420fd4d2f76428942c2716b1cb7e863">domains</a>);</div>
<div class="line"><span class="lineno"> 3033</span> </div>
<div class="line"><span class="lineno"> 3034</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(data.capabilities, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>, <a class="code hl_define" href="yubihsm_8h.html#ad3c904849d17cae0a6f426e8007731d7">YH_CAPABILITIES_LEN</a>);</div>
<div class="line"><span class="lineno"> 3035</span> </div>
<div class="line"><span class="lineno"> 3036</span>  data.algorithm = <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa461952ba18e7fcd792e480f71c853513">YH_ALGO_AES128_YUBICO_AUTHENTICATION</a>;</div>
<div class="line"><span class="lineno"> 3037</span> </div>
<div class="line"><span class="lineno"> 3038</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(data.delegated_capabilities, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#afa62e10709d52e5162a732e81369a7ec">delegated_capabilities</a>,</div>
<div class="line"><span class="lineno"> 3039</span>         <a class="code hl_define" href="yubihsm_8h.html#ad3c904849d17cae0a6f426e8007731d7">YH_CAPABILITIES_LEN</a>);</div>
<div class="line"><span class="lineno"> 3040</span> </div>
<div class="line"><span class="lineno"> 3041</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="#a4c26f003b72e800e9c934bca922a404a">yh_send_secure_msg</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, YHC_PUT_AUTHENTICATION_KEY, data.buf,</div>
<div class="line"><span class="lineno"> 3042</span>                                 <span class="keyword">sizeof</span>(data), &amp;response_cmd, response.buf,</div>
<div class="line"><span class="lineno"> 3043</span>                                 &amp;response_len);</div>
<div class="line"><span class="lineno"> 3044</span>  <a class="code hl_define" href="insecure__memzero_8h.html#a0794f9275fd1036ecba6ff0a901a320b">insecure_memzero</a>(data.buf, <span class="keyword">sizeof</span>(data));</div>
<div class="line"><span class="lineno"> 3045</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 3046</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Failed to send PUT AUTHENTICATION KEY command: %s\n&quot;</span>,</div>
<div class="line"><span class="lineno"> 3047</span>            <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 3048</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 3049</span>  }</div>
<div class="line"><span class="lineno"> 3050</span> </div>
<div class="line"><span class="lineno"> 3051</span>  <span class="keywordflow">if</span> (response_cmd == <a class="code hl_enumvalue" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7ea51cdf2ccd6995498e589e8ea6ce2a1f2">YHC_ERROR</a>) {</div>
<div class="line"><span class="lineno"> 3052</span>    <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> translated = translate_device_error(response.buf[0]);</div>
<div class="line"><span class="lineno"> 3053</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Unable to store authentication key: %s (%x)\n&quot;</span>,</div>
<div class="line"><span class="lineno"> 3054</span>            <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(translated), response.buf[0]);</div>
<div class="line"><span class="lineno"> 3055</span>    <span class="keywordflow">return</span> translated;</div>
<div class="line"><span class="lineno"> 3056</span>  }</div>
<div class="line"><span class="lineno"> 3057</span> </div>
<div class="line"><span class="lineno"> 3058</span>  *<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a> = ntohs(response.key_id);</div>
<div class="line"><span class="lineno"> 3059</span>  <a class="code hl_define" href="debug__lib_8h.html#a8c4742440a149ad8bcb5d58ae76c5ed3">DBG_INFO</a>(<span class="stringliteral">&quot;Stored Authentication key 0x%04x&quot;</span>, *<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>);</div>
<div class="line"><span class="lineno"> 3060</span> </div>
<div class="line"><span class="lineno"> 3061</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 3062</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_ac154da7ac6dc0a7b4b3a6cdff9433da8_cgraph.png" border="0" usemap="#ayubihsm_8c_ac154da7ac6dc0a7b4b3a6cdff9433da8_cgraph" alt=""/></div>
<map name="ayubihsm_8c_ac154da7ac6dc0a7b4b3a6cdff9433da8_cgraph" id="ayubihsm_8c_ac154da7ac6dc0a7b4b3a6cdff9433da8_cgraph">
<area shape="rect" title=" " alt="" coords="5,129,224,155"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="697,5,769,31"/>
<area shape="poly" title=" " alt="" coords="154,126,271,89,368,61,468,40,582,25,682,18,682,23,583,30,468,45,370,66,272,94,155,131"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="699,179,767,204"/>
<area shape="poly" title=" " alt="" coords="222,153,272,158,503,176,684,186,684,192,502,181,271,163,222,158"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="272,104,420,130"/>
<area shape="poly" title=" " alt="" coords="224,128,256,124,256,129,224,133"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="691,104,775,130"/>
<area shape="poly" title=" " alt="" coords="224,147,415,152,525,149,633,140,676,131,677,136,634,145,525,154,415,158,224,153"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="468,104,633,130"/>
<area shape="poly" title=" " alt="" coords="420,114,452,114,452,120,420,120"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="486,55,616,80"/>
<area shape="poly" title=" " alt="" coords="402,101,479,82,480,87,403,106"/>
<area shape="poly" title=" " alt="" coords="610,101,632,91,647,79,656,67,665,54,680,40,685,37,688,41,683,44,669,57,660,70,650,83,635,95,612,106"/>
<area shape="poly" title=" " alt="" coords="585,128,686,170,684,175,583,133"/>
<area shape="poly" title=" " alt="" coords="634,114,676,114,676,120,634,120"/>
<area shape="poly" title=" " alt="" coords="600,51,682,29,683,34,602,57"/>
<area shape="poly" title=" " alt="" coords="602,78,677,99,676,104,600,84"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="681,55,785,80"/>
<area shape="poly" title=" " alt="" coords="616,65,666,65,666,70,616,70"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_ac154da7ac6dc0a7b4b3a6cdff9433da8_icgraph.png" border="0" usemap="#ayubihsm_8c_ac154da7ac6dc0a7b4b3a6cdff9433da8_icgraph" alt=""/></div>
<map name="ayubihsm_8c_ac154da7ac6dc0a7b4b3a6cdff9433da8_icgraph" id="ayubihsm_8c_ac154da7ac6dc0a7b4b3a6cdff9433da8_icgraph">
<area shape="rect" title=" " alt="" coords="763,55,981,80"/>
<area shape="rect" href="yubihsm_8c.html#a80b4c4caeb9c768737c2dbf46d9352e4" title=" " alt="" coords="524,47,715,88"/>
<area shape="poly" title=" " alt="" coords="747,70,715,70,715,65,747,65"/>
<area shape="rect" href="change__authkey_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="362,5,411,31"/>
<area shape="poly" title=" " alt="" coords="509,47,411,26,412,21,510,42"/>
<area shape="rect" href="commands_8c.html#ae2e50929acc6085cd395d0bd4ddb02db" title=" " alt="" coords="317,55,455,80"/>
<area shape="poly" title=" " alt="" coords="509,70,456,70,456,65,509,65"/>
<area shape="rect" href="commands_8c.html#a3bd17c302789958013e50a2ad9738aea" title=" " alt="" coords="296,104,476,130"/>
<area shape="poly" title=" " alt="" coords="510,93,451,106,450,101,509,88"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,55,248,80"/>
<area shape="poly" title=" " alt="" coords="302,70,249,70,249,65,302,65"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,80,55,106"/>
<area shape="poly" title=" " alt="" coords="88,85,55,91,54,86,87,80"/>
<area shape="poly" title=" " alt="" coords="312,102,233,84,234,78,314,97"/>
<area shape="poly" title=" " alt="" coords="281,112,55,97,55,92,281,107"/>
</map>
</div>

</div>
</div>
<a id="a80b4c4caeb9c768737c2dbf46d9352e4" name="a80b4c4caeb9c768737c2dbf46d9352e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a80b4c4caeb9c768737c2dbf46d9352e4">&#9670;&#160;</a></span>yh_util_import_authentication_key_derived()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_util_import_authentication_key_derived </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__session.html">yh_session</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *</td>          <td class="paramname"><span class="paramname"><em>key_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>label</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a></td>          <td class="paramname"><span class="paramname"><em>domains</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structyh__capabilities.html">yh_capabilities</a> *</td>          <td class="paramname"><span class="paramname"><em>capabilities</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structyh__capabilities.html">yh_capabilities</a> *</td>          <td class="paramname"><span class="paramname"><em>delegated_capabilities</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>password</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>password_len</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Import an <a class="el" href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583acee44b775b3c5b6157f0732699935074" title="Authentication Key is used to establish Sessions with a device.">YH_AUTHENTICATION_KEY</a> with long lived keys derived from a password</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>Authenticated session to use </td></tr>
    <tr><td class="paramname">key_id</td><td>Object ID of the key. 0 if the Object ID should be generated by the device </td></tr>
    <tr><td class="paramname">label</td><td>Label of the key. Maximum length is <a class="el" href="yubihsm_8h.html#a431f8b753552a8b2f5f980e871b6d019" title="Max length of object labels.">YH_OBJ_LABEL_LEN</a> </td></tr>
    <tr><td class="paramname">domains</td><td>Domains to which the key belongs. See <a class="el" href="yubihsm_8h.html#a96a4c751a281515d5610adb8fd779438">yh_string_to_domains()</a> </td></tr>
    <tr><td class="paramname">capabilities</td><td>Capabilities of the key. See <a class="el" href="yubihsm_8h.html#aab440e1cb671d9ba7a2e7d1243960e42">yh_string_to_capabilities()</a> </td></tr>
    <tr><td class="paramname">delegated_capabilities</td><td>Delegated capabilities of the key. See <a class="el" href="yubihsm_8h.html#aab440e1cb671d9ba7a2e7d1243960e42">yh_string_to_capabilities()</a> </td></tr>
    <tr><td class="paramname">password</td><td>Password used to derive the long lived encryption key and MAC key of the Athentication Key </td></tr>
    <tr><td class="paramname">password_len</td><td>Length of password</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> if input parameters are NULL. See <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> for other possible errors </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a href="https://developers.yubico.com/YubiHSM2/Concepts/Object.html">Authentication Key</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l03064">3064</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3068</span>                       {</div>
<div class="line"><span class="lineno"> 3069</span> </div>
<div class="line"><span class="lineno"> 3070</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a> == NULL || <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a> == NULL || <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> == NULL ||</div>
<div class="line"><span class="lineno"> 3071</span>      strlen(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>) &gt; <a class="code hl_define" href="yubihsm_8h.html#a431f8b753552a8b2f5f980e871b6d019">YH_OBJ_LABEL_LEN</a> || <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a> == NULL ||</div>
<div class="line"><span class="lineno"> 3072</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#afa62e10709d52e5162a732e81369a7ec">delegated_capabilities</a> == NULL || password == NULL) {</div>
<div class="line"><span class="lineno"> 3073</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>));</div>
<div class="line"><span class="lineno"> 3074</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 3075</span>  }</div>
<div class="line"><span class="lineno"> 3076</span> </div>
<div class="line"><span class="lineno"> 3077</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> key_enc[<a class="code hl_define" href="scp_8h.html#a25905234f13446437b28c85d0504216d">SCP_KEY_LEN</a>];</div>
<div class="line"><span class="lineno"> 3078</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> key_mac[<a class="code hl_define" href="scp_8h.html#a25905234f13446437b28c85d0504216d">SCP_KEY_LEN</a>];</div>
<div class="line"><span class="lineno"> 3079</span> </div>
<div class="line"><span class="lineno"> 3080</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = derive_keys(password, password_len, key_enc, key_mac);</div>
<div class="line"><span class="lineno"> 3081</span> </div>
<div class="line"><span class="lineno"> 3082</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> == <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 3083</span>    <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> =</div>
<div class="line"><span class="lineno"> 3084</span>      <a class="code hl_function" href="#ac154da7ac6dc0a7b4b3a6cdff9433da8">yh_util_import_authentication_key</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a5420fd4d2f76428942c2716b1cb7e863">domains</a>,</div>
<div class="line"><span class="lineno"> 3085</span>                                        <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#afa62e10709d52e5162a732e81369a7ec">delegated_capabilities</a>,</div>
<div class="line"><span class="lineno"> 3086</span>                                        key_enc, <span class="keyword">sizeof</span>(key_enc), key_mac,</div>
<div class="line"><span class="lineno"> 3087</span>                                        <span class="keyword">sizeof</span>(key_mac));</div>
<div class="line"><span class="lineno"> 3088</span>    <a class="code hl_define" href="insecure__memzero_8h.html#a0794f9275fd1036ecba6ff0a901a320b">insecure_memzero</a>(key_enc, <span class="keyword">sizeof</span>(key_enc));</div>
<div class="line"><span class="lineno"> 3089</span>    <a class="code hl_define" href="insecure__memzero_8h.html#a0794f9275fd1036ecba6ff0a901a320b">insecure_memzero</a>(key_mac, <span class="keyword">sizeof</span>(key_mac));</div>
<div class="line"><span class="lineno"> 3090</span>  }</div>
<div class="line"><span class="lineno"> 3091</span>  <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 3092</span>}</div>
<div class="ttc" id="ayubihsm_8c_html_ac154da7ac6dc0a7b4b3a6cdff9433da8"><div class="ttname"><a href="#ac154da7ac6dc0a7b4b3a6cdff9433da8">yh_util_import_authentication_key</a></div><div class="ttdeci">yh_rc yh_util_import_authentication_key(yh_session *session, uint16_t *key_id, const char *label, uint16_t domains, const yh_capabilities *capabilities, const yh_capabilities *delegated_capabilities, const uint8_t *key_enc, size_t key_enc_len, const uint8_t *key_mac, size_t key_mac_len)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l02985">yubihsm.c:2985</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a80b4c4caeb9c768737c2dbf46d9352e4_cgraph.png" border="0" usemap="#ayubihsm_8c_a80b4c4caeb9c768737c2dbf46d9352e4_cgraph" alt=""/></div>
<map name="ayubihsm_8c_a80b4c4caeb9c768737c2dbf46d9352e4_cgraph" id="ayubihsm_8c_a80b4c4caeb9c768737c2dbf46d9352e4_cgraph">
<area shape="rect" title=" " alt="" coords="5,172,196,213"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="930,179,1013,204"/>
<area shape="poly" title=" " alt="" coords="196,190,914,189,914,194,196,195"/>
<area shape="rect" href="yubihsm_8c.html#ac154da7ac6dc0a7b4b3a6cdff9433da8" title=" " alt="" coords="244,105,462,131"/>
<area shape="poly" title=" " alt="" coords="171,169,292,133,293,138,173,174"/>
<area shape="poly" title=" " alt="" coords="434,129,510,141,707,165,914,184,914,190,706,170,510,146,433,134"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="936,80,1007,106"/>
<area shape="poly" title=" " alt="" coords="433,102,510,90,690,61,770,57,872,65,922,75,921,80,871,70,770,62,691,67,510,95,434,107"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="937,5,1006,31"/>
<area shape="poly" title=" " alt="" coords="384,102,441,80,509,60,624,39,739,26,921,16,922,22,740,32,625,44,511,65,443,85,386,107"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="510,105,658,131"/>
<area shape="poly" title=" " alt="" coords="462,116,494,116,494,121,462,121"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="706,80,872,106"/>
<area shape="poly" title=" " alt="" coords="658,106,690,102,691,108,659,112"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="724,129,854,155"/>
<area shape="poly" title=" " alt="" coords="659,124,709,130,708,135,658,129"/>
<area shape="poly" title=" " alt="" coords="851,104,873,115,889,127,898,140,907,152,921,165,926,169,923,173,918,170,903,156,894,143,885,131,870,119,849,109"/>
<area shape="poly" title=" " alt="" coords="872,90,920,90,920,96,872,96"/>
<area shape="poly" title=" " alt="" coords="821,77,923,35,925,40,823,82"/>
<area shape="poly" title=" " alt="" coords="840,153,915,174,914,179,839,158"/>
<area shape="poly" title=" " alt="" coords="839,126,920,104,921,109,840,131"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="920,129,1023,155"/>
<area shape="poly" title=" " alt="" coords="855,140,904,140,904,145,855,145"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a80b4c4caeb9c768737c2dbf46d9352e4_icgraph.png" border="0" usemap="#ayubihsm_8c_a80b4c4caeb9c768737c2dbf46d9352e4_icgraph" alt=""/></div>
<map name="ayubihsm_8c_a80b4c4caeb9c768737c2dbf46d9352e4_icgraph" id="ayubihsm_8c_a80b4c4caeb9c768737c2dbf46d9352e4_icgraph">
<area shape="rect" title=" " alt="" coords="524,47,715,88"/>
<area shape="rect" href="change__authkey_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="362,5,411,31"/>
<area shape="poly" title=" " alt="" coords="509,47,411,26,412,21,510,42"/>
<area shape="rect" href="commands_8c.html#ae2e50929acc6085cd395d0bd4ddb02db" title=" " alt="" coords="317,55,455,80"/>
<area shape="poly" title=" " alt="" coords="509,70,456,70,456,65,509,65"/>
<area shape="rect" href="commands_8c.html#a3bd17c302789958013e50a2ad9738aea" title=" " alt="" coords="296,104,476,130"/>
<area shape="poly" title=" " alt="" coords="510,93,451,106,450,101,509,88"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,55,248,80"/>
<area shape="poly" title=" " alt="" coords="302,70,249,70,249,65,302,65"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,80,55,106"/>
<area shape="poly" title=" " alt="" coords="88,85,55,91,54,86,87,80"/>
<area shape="poly" title=" " alt="" coords="312,102,233,84,234,78,314,97"/>
<area shape="poly" title=" " alt="" coords="281,112,55,97,55,92,281,107"/>
</map>
</div>

</div>
</div>
<a id="adc142d8f397eee024b3c145fa8abad85" name="adc142d8f397eee024b3c145fa8abad85"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc142d8f397eee024b3c145fa8abad85">&#9670;&#160;</a></span>yh_util_import_ec_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_util_import_ec_key </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__session.html">yh_session</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *</td>          <td class="paramname"><span class="paramname"><em>key_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>label</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a></td>          <td class="paramname"><span class="paramname"><em>domains</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structyh__capabilities.html">yh_capabilities</a> *</td>          <td class="paramname"><span class="paramname"><em>capabilities</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55ca">yh_algorithm</a></td>          <td class="paramname"><span class="paramname"><em>algorithm</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>s</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Import an Elliptic Curve key into the device</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>Authenticated session to use </td></tr>
    <tr><td class="paramname">key_id</td><td>Object ID of the key. 0 if the Object ID should be generated by the device </td></tr>
    <tr><td class="paramname">label</td><td>Label of the key. Maximum length is <a class="el" href="yubihsm_8h.html#a431f8b753552a8b2f5f980e871b6d019" title="Max length of object labels.">YH_OBJ_LABEL_LEN</a> </td></tr>
    <tr><td class="paramname">domains</td><td>Domains to which the key belongs specified as an unsigned int. See <a class="el" href="yubihsm_8h.html#a96a4c751a281515d5610adb8fd779438">yh_string_to_domains()</a> </td></tr>
    <tr><td class="paramname">capabilities</td><td>Capabilities of the key. See <a class="el" href="yubihsm_8h.html#aab440e1cb671d9ba7a2e7d1243960e42">yh_string_to_capabilities()</a> </td></tr>
    <tr><td class="paramname">algorithm</td><td>Algorithm of the key to import. Must be one of: <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caaedcbc07d82b18ca5c21eb3379a6cc010" title="ecp224">YH_ALGO_EC_P224</a>, <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caae4b191baf5c65f9234120080264d129b" title="ecp256">YH_ALGO_EC_P256</a>, <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caad423056b13955068935dc8b3ac0e65d1" title="eck256">YH_ALGO_EC_K256</a>, <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caabd995726d45b6dd2388775db4767c80d" title="ecbp256">YH_ALGO_EC_BP256</a>, <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa31094c17c66e4c365ca3dad353bc8bda" title="ecp384">YH_ALGO_EC_P384</a>, <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa228fd3332b55c60438dfea6a1b09af36" title="ecbp384">YH_ALGO_EC_BP384</a>, <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caab9c1be17b7b3f755346ff8c3cca3ed25" title="ecbp512">YH_ALGO_EC_BP512</a> or <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa05aec903fd67851f968aaa606fe2138a" title="ecp521">YH_ALGO_EC_P521</a> </td></tr>
    <tr><td class="paramname">s</td><td>the EC key to import</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> input parameters are NULL or the algorithm is not one of <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caaedcbc07d82b18ca5c21eb3379a6cc010" title="ecp224">YH_ALGO_EC_P224</a>, <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caae4b191baf5c65f9234120080264d129b" title="ecp256">YH_ALGO_EC_P256</a>, <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caad423056b13955068935dc8b3ac0e65d1" title="eck256">YH_ALGO_EC_K256</a>, <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caabd995726d45b6dd2388775db4767c80d" title="ecbp256">YH_ALGO_EC_BP256</a>, <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa31094c17c66e4c365ca3dad353bc8bda" title="ecp384">YH_ALGO_EC_P384</a>, <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa228fd3332b55c60438dfea6a1b09af36" title="ecbp384">YH_ALGO_EC_BP384</a>, <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caab9c1be17b7b3f755346ff8c3cca3ed25" title="ecbp512">YH_ALGO_EC_BP512</a> or <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa05aec903fd67851f968aaa606fe2138a" title="ecp521">YH_ALGO_EC_P521</a>. See <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> for other possible errors </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l01689">1689</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1692</span>                                                                      {</div>
<div class="line"><span class="lineno"> 1693</span> </div>
<div class="line"><span class="lineno"> 1694</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a> == NULL || <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a> == NULL || <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> == NULL ||</div>
<div class="line"><span class="lineno"> 1695</span>      strlen(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>) &gt; <a class="code hl_define" href="yubihsm_8h.html#a431f8b753552a8b2f5f980e871b6d019">YH_OBJ_LABEL_LEN</a> || <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a> == NULL) {</div>
<div class="line"><span class="lineno"> 1696</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>));</div>
<div class="line"><span class="lineno"> 1697</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 1698</span>  }</div>
<div class="line"><span class="lineno"> 1699</span> </div>
<div class="line"><span class="lineno"> 1700</span>  <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> component_len;</div>
<div class="line"><span class="lineno"> 1701</span>  <span class="keywordflow">switch</span> (<a class="code hl_variable" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>) {</div>
<div class="line"><span class="lineno"> 1702</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caaedcbc07d82b18ca5c21eb3379a6cc010">YH_ALGO_EC_P224</a>:</div>
<div class="line"><span class="lineno"> 1703</span>      component_len = 28;</div>
<div class="line"><span class="lineno"> 1704</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1705</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caae4b191baf5c65f9234120080264d129b">YH_ALGO_EC_P256</a>:</div>
<div class="line"><span class="lineno"> 1706</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caad423056b13955068935dc8b3ac0e65d1">YH_ALGO_EC_K256</a>:</div>
<div class="line"><span class="lineno"> 1707</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caabd995726d45b6dd2388775db4767c80d">YH_ALGO_EC_BP256</a>:</div>
<div class="line"><span class="lineno"> 1708</span>      component_len = 32;</div>
<div class="line"><span class="lineno"> 1709</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1710</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa31094c17c66e4c365ca3dad353bc8bda">YH_ALGO_EC_P384</a>:</div>
<div class="line"><span class="lineno"> 1711</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa228fd3332b55c60438dfea6a1b09af36">YH_ALGO_EC_BP384</a>:</div>
<div class="line"><span class="lineno"> 1712</span>      component_len = 48;</div>
<div class="line"><span class="lineno"> 1713</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1714</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caab9c1be17b7b3f755346ff8c3cca3ed25">YH_ALGO_EC_BP512</a>:</div>
<div class="line"><span class="lineno"> 1715</span>      component_len = 64;</div>
<div class="line"><span class="lineno"> 1716</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1717</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa05aec903fd67851f968aaa606fe2138a">YH_ALGO_EC_P521</a>:</div>
<div class="line"><span class="lineno"> 1718</span>      component_len = 66;</div>
<div class="line"><span class="lineno"> 1719</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1720</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 1721</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 1722</span>  }</div>
<div class="line"><span class="lineno"> 1723</span>  <span class="keywordflow">return</span> import_asymmetric(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a5420fd4d2f76428942c2716b1cb7e863">domains</a>, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>,</div>
<div class="line"><span class="lineno"> 1724</span>                           <a class="code hl_variable" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a>, component_len);</div>
<div class="line"><span class="lineno"> 1725</span>}</div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a506da415c9307c897ca9be93acfe1d0f"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a></div><div class="ttdeci">char * s</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l00524">yubihsm_pkcs11.c:524</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_adc142d8f397eee024b3c145fa8abad85_cgraph.png" border="0" usemap="#ayubihsm_8c_adc142d8f397eee024b3c145fa8abad85_cgraph" alt=""/></div>
<map name="ayubihsm_8c_adc142d8f397eee024b3c145fa8abad85_cgraph" id="ayubihsm_8c_adc142d8f397eee024b3c145fa8abad85_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,157,31"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="205,5,288,31"/>
<area shape="poly" title=" " alt="" coords="157,16,189,16,189,21,157,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_adc142d8f397eee024b3c145fa8abad85_icgraph.png" border="0" usemap="#ayubihsm_8c_adc142d8f397eee024b3c145fa8abad85_icgraph" alt=""/></div>
<map name="ayubihsm_8c_adc142d8f397eee024b3c145fa8abad85_icgraph" id="ayubihsm_8c_adc142d8f397eee024b3c145fa8abad85_icgraph">
<area shape="rect" title=" " alt="" coords="511,31,663,56"/>
<area shape="rect" href="import__ec_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="355,5,404,31"/>
<area shape="poly" title=" " alt="" coords="496,35,405,24,405,18,496,30"/>
<area shape="rect" href="commands_8c.html#a0abe95eb37069022ed341835938de103" title=" " alt="" coords="296,55,463,80"/>
<area shape="poly" title=" " alt="" coords="496,57,464,60,463,55,496,51"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,29,248,55"/>
<area shape="poly" title=" " alt="" coords="280,58,248,54,249,49,281,53"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,55,55,80"/>
<area shape="poly" title=" " alt="" coords="281,70,55,70,55,65,281,65"/>
<area shape="poly" title=" " alt="" coords="88,60,55,66,54,61,87,55"/>
</map>
</div>

</div>
</div>
<a id="a7a886e052bc1571f24c6b7f0c57e2d8c" name="a7a886e052bc1571f24c6b7f0c57e2d8c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a886e052bc1571f24c6b7f0c57e2d8c">&#9670;&#160;</a></span>yh_util_import_ed_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_util_import_ed_key </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__session.html">yh_session</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *</td>          <td class="paramname"><span class="paramname"><em>key_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>label</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a></td>          <td class="paramname"><span class="paramname"><em>domains</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structyh__capabilities.html">yh_capabilities</a> *</td>          <td class="paramname"><span class="paramname"><em>capabilities</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55ca">yh_algorithm</a></td>          <td class="paramname"><span class="paramname"><em>algorithm</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>k</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Import an ED key into the device</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>Authenticated session to use </td></tr>
    <tr><td class="paramname">key_id</td><td>Object ID of the key will have. 0 if the Object ID should be generated by the device </td></tr>
    <tr><td class="paramname">label</td><td>Label of the key. Maximum length is <a class="el" href="yubihsm_8h.html#a431f8b753552a8b2f5f980e871b6d019" title="Max length of object labels.">YH_OBJ_LABEL_LEN</a> </td></tr>
    <tr><td class="paramname">domains</td><td>Domains to which the key belongs. See <a class="el" href="yubihsm_8h.html#a96a4c751a281515d5610adb8fd779438">yh_string_to_domains()</a> </td></tr>
    <tr><td class="paramname">capabilities</td><td>Capabilities of the key. See <a class="el" href="yubihsm_8h.html#aab440e1cb671d9ba7a2e7d1243960e42">yh_string_to_capabilities()</a> </td></tr>
    <tr><td class="paramname">algorithm</td><td>Algorithm of the key to import. Must be <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa68c2c97f16c36f727e41a899d8a7e8bd" title="ed25519">YH_ALGO_EC_ED25519</a> </td></tr>
    <tr><td class="paramname">k</td><td>the ED key to import</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> input parameters are NULL or the algorithm is not <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa68c2c97f16c36f727e41a899d8a7e8bd" title="ed25519">YH_ALGO_EC_ED25519</a>. See <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> for other possible errors </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l01727">1727</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1730</span>                                                                      {</div>
<div class="line"><span class="lineno"> 1731</span> </div>
<div class="line"><span class="lineno"> 1732</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a> == NULL || <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a> == NULL || <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> == NULL ||</div>
<div class="line"><span class="lineno"> 1733</span>      strlen(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>) &gt; <a class="code hl_define" href="yubihsm_8h.html#a431f8b753552a8b2f5f980e871b6d019">YH_OBJ_LABEL_LEN</a> || k == NULL) {</div>
<div class="line"><span class="lineno"> 1734</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>));</div>
<div class="line"><span class="lineno"> 1735</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 1736</span>  }</div>
<div class="line"><span class="lineno"> 1737</span> </div>
<div class="line"><span class="lineno"> 1738</span>  <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> component_len;</div>
<div class="line"><span class="lineno"> 1739</span>  <span class="keywordflow">switch</span> (<a class="code hl_variable" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>) {</div>
<div class="line"><span class="lineno"> 1740</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa68c2c97f16c36f727e41a899d8a7e8bd">YH_ALGO_EC_ED25519</a>:</div>
<div class="line"><span class="lineno"> 1741</span>      component_len = 32;</div>
<div class="line"><span class="lineno"> 1742</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1743</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 1744</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 1745</span>  }</div>
<div class="line"><span class="lineno"> 1746</span>  <span class="keywordflow">return</span> import_asymmetric(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a5420fd4d2f76428942c2716b1cb7e863">domains</a>, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>,</div>
<div class="line"><span class="lineno"> 1747</span>                           <a class="code hl_variable" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>, k, component_len);</div>
<div class="line"><span class="lineno"> 1748</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a7a886e052bc1571f24c6b7f0c57e2d8c_cgraph.png" border="0" usemap="#ayubihsm_8c_a7a886e052bc1571f24c6b7f0c57e2d8c_cgraph" alt=""/></div>
<map name="ayubihsm_8c_a7a886e052bc1571f24c6b7f0c57e2d8c_cgraph" id="ayubihsm_8c_a7a886e052bc1571f24c6b7f0c57e2d8c_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,157,31"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="205,5,288,31"/>
<area shape="poly" title=" " alt="" coords="157,16,189,16,189,21,157,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a7a886e052bc1571f24c6b7f0c57e2d8c_icgraph.png" border="0" usemap="#ayubihsm_8c_a7a886e052bc1571f24c6b7f0c57e2d8c_icgraph" alt=""/></div>
<map name="ayubihsm_8c_a7a886e052bc1571f24c6b7f0c57e2d8c_icgraph" id="ayubihsm_8c_a7a886e052bc1571f24c6b7f0c57e2d8c_icgraph">
<area shape="rect" title=" " alt="" coords="511,31,663,56"/>
<area shape="rect" href="import__ed_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="355,5,404,31"/>
<area shape="poly" title=" " alt="" coords="496,35,405,24,405,18,496,30"/>
<area shape="rect" href="commands_8c.html#a0abe95eb37069022ed341835938de103" title=" " alt="" coords="296,55,463,80"/>
<area shape="poly" title=" " alt="" coords="496,57,464,60,463,55,496,51"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,29,248,55"/>
<area shape="poly" title=" " alt="" coords="280,58,248,54,249,49,281,53"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,55,55,80"/>
<area shape="poly" title=" " alt="" coords="281,70,55,70,55,65,281,65"/>
<area shape="poly" title=" " alt="" coords="88,60,55,66,54,61,87,55"/>
</map>
</div>

</div>
</div>
<a id="a19c79faaf10c405864f0179821d551a5" name="a19c79faaf10c405864f0179821d551a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a19c79faaf10c405864f0179821d551a5">&#9670;&#160;</a></span>yh_util_import_hmac_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_util_import_hmac_key </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__session.html">yh_session</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *</td>          <td class="paramname"><span class="paramname"><em>key_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>label</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a></td>          <td class="paramname"><span class="paramname"><em>domains</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structyh__capabilities.html">yh_capabilities</a> *</td>          <td class="paramname"><span class="paramname"><em>capabilities</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55ca">yh_algorithm</a></td>          <td class="paramname"><span class="paramname"><em>algorithm</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>key</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>key_len</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Import an HMAC key into the device</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>Authenticated session to use </td></tr>
    <tr><td class="paramname">key_id</td><td>Object ID of the key. 0 if the Object ID should be generated by the device </td></tr>
    <tr><td class="paramname">label</td><td>Label of the key. Maxium length is <a class="el" href="yubihsm_8h.html#a431f8b753552a8b2f5f980e871b6d019" title="Max length of object labels.">YH_OBJ_LABEL_LEN</a> </td></tr>
    <tr><td class="paramname">domains</td><td>Domains to which the key belongs. See <a class="el" href="yubihsm_8h.html#a96a4c751a281515d5610adb8fd779438">yh_string_to_domains()</a> </td></tr>
    <tr><td class="paramname">capabilities</td><td>Capabilities of the key. See <a class="el" href="yubihsm_8h.html#aab440e1cb671d9ba7a2e7d1243960e42">yh_string_to_capabilities()</a> </td></tr>
    <tr><td class="paramname">algorithm</td><td>Algorithm of the key to import. Must be one of: <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa942e65c8cd0034eebe9a20c2297c7b06" title="hmac-sha1">YH_ALGO_HMAC_SHA1</a>, <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caab0a0e1eb424b61057f159f1e53311f5c" title="hmac-sha256">YH_ALGO_HMAC_SHA256</a>, <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa781e7ca62563917d2129bde8ec53401b" title="hmac-sha384">YH_ALGO_HMAC_SHA384</a> or <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa72d6c7ea77f10e39bbadc8b58d55b9ec" title="hmac-sha512">YH_ALGO_HMAC_SHA512</a> </td></tr>
    <tr><td class="paramname">key</td><td>The HMAC key to import </td></tr>
    <tr><td class="paramname">key_len</td><td>Length of the HMAC key to import</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> input parameters are NULL. See <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> for other possible errors </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l01750">1750</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1754</span>                                              {</div>
<div class="line"><span class="lineno"> 1755</span> </div>
<div class="line"><span class="lineno"> 1756</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a> == NULL || <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a> == NULL || <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> == NULL ||</div>
<div class="line"><span class="lineno"> 1757</span>      strlen(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>) &gt; <a class="code hl_define" href="yubihsm_8h.html#a431f8b753552a8b2f5f980e871b6d019">YH_OBJ_LABEL_LEN</a> || key == NULL) {</div>
<div class="line"><span class="lineno"> 1758</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>));</div>
<div class="line"><span class="lineno"> 1759</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 1760</span>  }</div>
<div class="line"><span class="lineno"> 1761</span> </div>
<div class="line"><span class="lineno"> 1762</span><span class="preprocessor">#pragma pack(push, 1)</span></div>
<div class="line"><span class="lineno"> 1763</span>  <span class="keyword">union </span>{</div>
<div class="line"><span class="lineno"> 1764</span>    <span class="keyword">struct </span>{</div>
<div class="line"><span class="lineno"> 1765</span>      <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>;</div>
<div class="line"><span class="lineno"> 1766</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>[<a class="code hl_define" href="yubihsm_8h.html#a431f8b753552a8b2f5f980e871b6d019">YH_OBJ_LABEL_LEN</a>];</div>
<div class="line"><span class="lineno"> 1767</span>      <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a5420fd4d2f76428942c2716b1cb7e863">domains</a>;</div>
<div class="line"><span class="lineno"> 1768</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>[<a class="code hl_define" href="yubihsm_8h.html#ad3c904849d17cae0a6f426e8007731d7">YH_CAPABILITIES_LEN</a>];</div>
<div class="line"><span class="lineno"> 1769</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>;</div>
<div class="line"><span class="lineno"> 1770</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> key[128];</div>
<div class="line"><span class="lineno"> 1771</span>    };</div>
<div class="line"><span class="lineno"> 1772</span>    <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a855e99b645b13e7905d074d02fe0bff5">buf</a>[1];</div>
<div class="line"><span class="lineno"> 1773</span>  } k;</div>
<div class="line"><span class="lineno"> 1774</span>  <span class="keyword">union </span>{</div>
<div class="line"><span class="lineno"> 1775</span>    <span class="keyword">struct </span>{</div>
<div class="line"><span class="lineno"> 1776</span>      <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>;</div>
<div class="line"><span class="lineno"> 1777</span>    };</div>
<div class="line"><span class="lineno"> 1778</span>    <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a855e99b645b13e7905d074d02fe0bff5">buf</a>[1];</div>
<div class="line"><span class="lineno"> 1779</span>  } response;</div>
<div class="line"><span class="lineno"> 1780</span><span class="preprocessor">#pragma pack(pop)</span></div>
<div class="line"><span class="lineno"> 1781</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 1782</span>  <span class="keywordtype">size_t</span> response_len = <span class="keyword">sizeof</span>(response);</div>
<div class="line"><span class="lineno"> 1783</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7e">yh_cmd</a> response_cmd;</div>
<div class="line"><span class="lineno"> 1784</span>  <span class="keywordtype">size_t</span> max_len = 64;</div>
<div class="line"><span class="lineno"> 1785</span>  <span class="keywordtype">int</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> = <span class="keyword">sizeof</span>(k) - <span class="keyword">sizeof</span>(k.key);</div>
<div class="line"><span class="lineno"> 1786</span> </div>
<div class="line"><span class="lineno"> 1787</span>  k.key_id = htons(*<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>);</div>
<div class="line"><span class="lineno"> 1788</span> </div>
<div class="line"><span class="lineno"> 1789</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(k.label, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>, strlen(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>));</div>
<div class="line"><span class="lineno"> 1790</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105">memset</a>(k.label + strlen(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>), 0, <a class="code hl_define" href="yubihsm_8h.html#a431f8b753552a8b2f5f980e871b6d019">YH_OBJ_LABEL_LEN</a> - strlen(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>));</div>
<div class="line"><span class="lineno"> 1791</span> </div>
<div class="line"><span class="lineno"> 1792</span>  k.domains = htons(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a5420fd4d2f76428942c2716b1cb7e863">domains</a>);</div>
<div class="line"><span class="lineno"> 1793</span> </div>
<div class="line"><span class="lineno"> 1794</span>  k.algorithm = <a class="code hl_variable" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>;</div>
<div class="line"><span class="lineno"> 1795</span> </div>
<div class="line"><span class="lineno"> 1796</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(k.capabilities, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>, <a class="code hl_define" href="yubihsm_8h.html#ad3c904849d17cae0a6f426e8007731d7">YH_CAPABILITIES_LEN</a>);</div>
<div class="line"><span class="lineno"> 1797</span> </div>
<div class="line"><span class="lineno"> 1798</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a> == <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa781e7ca62563917d2129bde8ec53401b">YH_ALGO_HMAC_SHA384</a> || <a class="code hl_variable" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a> == <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa72d6c7ea77f10e39bbadc8b58d55b9ec">YH_ALGO_HMAC_SHA512</a>) {</div>
<div class="line"><span class="lineno"> 1799</span>    max_len = 128;</div>
<div class="line"><span class="lineno"> 1800</span>  }</div>
<div class="line"><span class="lineno"> 1801</span> </div>
<div class="line"><span class="lineno"> 1802</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a8b142e2a51f6b9b8760f9132119673b6">key_len</a> &gt; max_len) {</div>
<div class="line"><span class="lineno"> 1803</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Too long key supplied, max %lu bytes allowed&quot;</span>,</div>
<div class="line"><span class="lineno"> 1804</span>            (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>) max_len);</div>
<div class="line"><span class="lineno"> 1805</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366ae0b26dcb22aa228ab08c9e59a8975952">YHR_WRONG_LENGTH</a>;</div>
<div class="line"><span class="lineno"> 1806</span>  }</div>
<div class="line"><span class="lineno"> 1807</span> </div>
<div class="line"><span class="lineno"> 1808</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(k.key, key, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a8b142e2a51f6b9b8760f9132119673b6">key_len</a>);</div>
<div class="line"><span class="lineno"> 1809</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> += <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a8b142e2a51f6b9b8760f9132119673b6">key_len</a>;</div>
<div class="line"><span class="lineno"> 1810</span> </div>
<div class="line"><span class="lineno"> 1811</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="#a4c26f003b72e800e9c934bca922a404a">yh_send_secure_msg</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, YHC_PUT_HMAC_KEY, k.buf, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>, &amp;response_cmd,</div>
<div class="line"><span class="lineno"> 1812</span>                           response.buf, &amp;response_len);</div>
<div class="line"><span class="lineno"> 1813</span>  <a class="code hl_define" href="insecure__memzero_8h.html#a0794f9275fd1036ecba6ff0a901a320b">insecure_memzero</a>(k.buf, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>);</div>
<div class="line"><span class="lineno"> 1814</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 1815</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Failed to send PUT HMAC KEY command: %s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 1816</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 1817</span>  }</div>
<div class="line"><span class="lineno"> 1818</span> </div>
<div class="line"><span class="lineno"> 1819</span>  <span class="keywordflow">if</span> (response_cmd == <a class="code hl_enumvalue" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7ea51cdf2ccd6995498e589e8ea6ce2a1f2">YHC_ERROR</a>) {</div>
<div class="line"><span class="lineno"> 1820</span>    <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> translated = translate_device_error(response.buf[0]);</div>
<div class="line"><span class="lineno"> 1821</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Unable to put key: %s (%x)&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(translated),</div>
<div class="line"><span class="lineno"> 1822</span>            response.buf[0]);</div>
<div class="line"><span class="lineno"> 1823</span>    <span class="keywordflow">return</span> translated;</div>
<div class="line"><span class="lineno"> 1824</span>  }</div>
<div class="line"><span class="lineno"> 1825</span> </div>
<div class="line"><span class="lineno"> 1826</span>  *<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a> = ntohs(response.key_id);</div>
<div class="line"><span class="lineno"> 1827</span>  <a class="code hl_define" href="debug__lib_8h.html#a8c4742440a149ad8bcb5d58ae76c5ed3">DBG_INFO</a>(<span class="stringliteral">&quot;Stored HMAC key 0x%04x&quot;</span>, *<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>);</div>
<div class="line"><span class="lineno"> 1828</span> </div>
<div class="line"><span class="lineno"> 1829</span>  <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 1830</span>}</div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a8b142e2a51f6b9b8760f9132119673b6"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a8b142e2a51f6b9b8760f9132119673b6">key_len</a></div><div class="ttdeci">session operation op sign key_len</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l03475">yubihsm_pkcs11.c:3475</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a19c79faaf10c405864f0179821d551a5_cgraph.png" border="0" usemap="#ayubihsm_8c_a19c79faaf10c405864f0179821d551a5_cgraph" alt=""/></div>
<map name="ayubihsm_8c_a19c79faaf10c405864f0179821d551a5_cgraph" id="ayubihsm_8c_a19c79faaf10c405864f0179821d551a5_cgraph">
<area shape="rect" title=" " alt="" coords="5,129,175,155"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="648,5,720,31"/>
<area shape="poly" title=" " alt="" coords="122,126,222,89,319,60,419,40,533,25,633,18,633,23,534,30,419,45,320,65,224,94,124,131"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="650,179,718,204"/>
<area shape="poly" title=" " alt="" coords="176,151,223,157,454,176,635,186,635,192,453,181,222,162,175,157"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="223,104,371,130"/>
<area shape="poly" title=" " alt="" coords="175,129,207,125,208,130,175,134"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="642,104,726,130"/>
<area shape="poly" title=" " alt="" coords="175,146,363,152,474,149,584,140,627,131,628,136,585,145,474,154,363,157,175,151"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="419,104,584,130"/>
<area shape="poly" title=" " alt="" coords="371,114,403,114,403,120,371,120"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="436,55,567,80"/>
<area shape="poly" title=" " alt="" coords="353,101,430,82,431,87,354,106"/>
<area shape="poly" title=" " alt="" coords="561,101,583,91,598,79,607,67,616,54,631,40,636,37,639,41,634,44,620,57,611,70,601,83,586,95,563,106"/>
<area shape="poly" title=" " alt="" coords="536,128,637,170,635,175,534,133"/>
<area shape="poly" title=" " alt="" coords="585,114,627,114,627,120,585,120"/>
<area shape="poly" title=" " alt="" coords="551,51,633,29,634,34,553,57"/>
<area shape="poly" title=" " alt="" coords="553,78,628,99,627,104,551,84"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="632,55,736,80"/>
<area shape="poly" title=" " alt="" coords="567,65,617,65,617,70,567,70"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a19c79faaf10c405864f0179821d551a5_icgraph.png" border="0" usemap="#ayubihsm_8c_a19c79faaf10c405864f0179821d551a5_icgraph" alt=""/></div>
<map name="ayubihsm_8c_a19c79faaf10c405864f0179821d551a5_icgraph" id="ayubihsm_8c_a19c79faaf10c405864f0179821d551a5_icgraph">
<area shape="rect" title=" " alt="" coords="475,5,645,31"/>
<area shape="rect" href="commands_8c.html#aed17eea0c4eb877cd1097fbcd8e8e5d0" title=" " alt="" coords="296,5,427,31"/>
<area shape="poly" title=" " alt="" coords="460,21,428,21,428,16,460,16"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="280,21,248,21,248,16,280,16"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,55,31"/>
<area shape="poly" title=" " alt="" coords="87,21,55,21,55,16,87,16"/>
</map>
</div>

</div>
</div>
<a id="a1249c920eec24f634d04eaafb90a1ca2" name="a1249c920eec24f634d04eaafb90a1ca2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1249c920eec24f634d04eaafb90a1ca2">&#9670;&#160;</a></span>yh_util_import_opaque()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_util_import_opaque </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__session.html">yh_session</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *</td>          <td class="paramname"><span class="paramname"><em>object_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>label</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a></td>          <td class="paramname"><span class="paramname"><em>domains</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structyh__capabilities.html">yh_capabilities</a> *</td>          <td class="paramname"><span class="paramname"><em>capabilities</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55ca">yh_algorithm</a></td>          <td class="paramname"><span class="paramname"><em>algorithm</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>in</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>in_len</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Import an <a class="el" href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583a5d37b7418d50b420621e6a6eb2700de4">YH_OPAQUE</a> object into the device</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>Authenticated session to use </td></tr>
    <tr><td class="paramname">object_id</td><td>Object ID of the <a class="el" href="struct_opaque.html">Opaque</a> object. 0 if the Object ID should be generated by the device </td></tr>
    <tr><td class="paramname">label</td><td>Label of the <a class="el" href="struct_opaque.html">Opaque</a> object. Maximum length is <a class="el" href="yubihsm_8h.html#a431f8b753552a8b2f5f980e871b6d019" title="Max length of object labels.">YH_OBJ_LABEL_LEN</a> </td></tr>
    <tr><td class="paramname">domains</td><td>Domains the <a class="el" href="struct_opaque.html">Opaque</a> object will be operating within. See <a class="el" href="yubihsm_8h.html#a96a4c751a281515d5610adb8fd779438">yh_string_to_domains()</a> </td></tr>
    <tr><td class="paramname">capabilities</td><td>Capabilities of the <a class="el" href="struct_opaque.html">Opaque</a> object. See <a class="el" href="yubihsm_8h.html#aab440e1cb671d9ba7a2e7d1243960e42">yh_string_to_capabilities()</a> </td></tr>
    <tr><td class="paramname">algorithm</td><td>Algorithm of the <a class="el" href="struct_opaque.html">Opaque</a> object </td></tr>
    <tr><td class="paramname">in</td><td>the <a class="el" href="struct_opaque.html">Opaque</a> object to import </td></tr>
    <tr><td class="paramname">in_len</td><td>Length of the <a class="el" href="struct_opaque.html">Opaque</a> object to import</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> if input parameters are NULL or <code>in_len</code> is too big. See <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> for other possible errors </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l02666">2666</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2670</span>                                           {</div>
<div class="line"><span class="lineno"> 2671</span> </div>
<div class="line"><span class="lineno"> 2672</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a> == NULL || object_id == NULL || <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> == NULL ||</div>
<div class="line"><span class="lineno"> 2673</span>      strlen(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>) &gt; <a class="code hl_define" href="yubihsm_8h.html#a431f8b753552a8b2f5f980e871b6d019">YH_OBJ_LABEL_LEN</a> || in == NULL) {</div>
<div class="line"><span class="lineno"> 2674</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>));</div>
<div class="line"><span class="lineno"> 2675</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 2676</span>  }</div>
<div class="line"><span class="lineno"> 2677</span> </div>
<div class="line"><span class="lineno"> 2678</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 2679</span> </div>
<div class="line"><span class="lineno"> 2680</span><span class="preprocessor">#pragma pack(push, 1)</span></div>
<div class="line"><span class="lineno"> 2681</span>  <span class="keyword">union </span>{</div>
<div class="line"><span class="lineno"> 2682</span>    <span class="keyword">struct </span>{</div>
<div class="line"><span class="lineno"> 2683</span>      <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> object_id;</div>
<div class="line"><span class="lineno"> 2684</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>[<a class="code hl_define" href="yubihsm_8h.html#a431f8b753552a8b2f5f980e871b6d019">YH_OBJ_LABEL_LEN</a>];</div>
<div class="line"><span class="lineno"> 2685</span>      <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a5420fd4d2f76428942c2716b1cb7e863">domains</a>;</div>
<div class="line"><span class="lineno"> 2686</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>[<a class="code hl_define" href="yubihsm_8h.html#ad3c904849d17cae0a6f426e8007731d7">YH_CAPABILITIES_LEN</a>];</div>
<div class="line"><span class="lineno"> 2687</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>;</div>
<div class="line"><span class="lineno"> 2688</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#ac6f5a1f1e061f000983f5d5f3ac25dfa">bytes</a>[<a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a> - <span class="keyword">sizeof</span>(object_id) - <span class="keyword">sizeof</span>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a5420fd4d2f76428942c2716b1cb7e863">domains</a>) -</div>
<div class="line"><span class="lineno"> 2689</span>                    <a class="code hl_define" href="yubihsm_8h.html#ad3c904849d17cae0a6f426e8007731d7">YH_CAPABILITIES_LEN</a> - 2];</div>
<div class="line"><span class="lineno"> 2690</span>    };</div>
<div class="line"><span class="lineno"> 2691</span>    <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a855e99b645b13e7905d074d02fe0bff5">buf</a>[1];</div>
<div class="line"><span class="lineno"> 2692</span>  } data;</div>
<div class="line"><span class="lineno"> 2693</span>  <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> data_len;</div>
<div class="line"><span class="lineno"> 2694</span>  <span class="keyword">union </span>{</div>
<div class="line"><span class="lineno"> 2695</span>    <span class="keyword">struct </span>{</div>
<div class="line"><span class="lineno"> 2696</span>      <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> object_id;</div>
<div class="line"><span class="lineno"> 2697</span>    };</div>
<div class="line"><span class="lineno"> 2698</span>    <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a855e99b645b13e7905d074d02fe0bff5">buf</a>[1];</div>
<div class="line"><span class="lineno"> 2699</span>  } response;</div>
<div class="line"><span class="lineno"> 2700</span><span class="preprocessor">#pragma pack(pop)</span></div>
<div class="line"><span class="lineno"> 2701</span>  <span class="keywordtype">size_t</span> response_len = <span class="keyword">sizeof</span>(response);</div>
<div class="line"><span class="lineno"> 2702</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7e">yh_cmd</a> response_cmd;</div>
<div class="line"><span class="lineno"> 2703</span> </div>
<div class="line"><span class="lineno"> 2704</span>  data.object_id = htons(*object_id);</div>
<div class="line"><span class="lineno"> 2705</span> </div>
<div class="line"><span class="lineno"> 2706</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(data.label, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>, strlen(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>));</div>
<div class="line"><span class="lineno"> 2707</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105">memset</a>(data.label + strlen(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>), 0, <a class="code hl_define" href="yubihsm_8h.html#a431f8b753552a8b2f5f980e871b6d019">YH_OBJ_LABEL_LEN</a> - strlen(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>));</div>
<div class="line"><span class="lineno"> 2708</span> </div>
<div class="line"><span class="lineno"> 2709</span>  data.domains = htons(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a5420fd4d2f76428942c2716b1cb7e863">domains</a>);</div>
<div class="line"><span class="lineno"> 2710</span> </div>
<div class="line"><span class="lineno"> 2711</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(data.capabilities, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>, <a class="code hl_define" href="yubihsm_8h.html#ad3c904849d17cae0a6f426e8007731d7">YH_CAPABILITIES_LEN</a>);</div>
<div class="line"><span class="lineno"> 2712</span> </div>
<div class="line"><span class="lineno"> 2713</span>  data.algorithm = <a class="code hl_variable" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>;</div>
<div class="line"><span class="lineno"> 2714</span> </div>
<div class="line"><span class="lineno"> 2715</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a> &gt; <span class="keyword">sizeof</span>(data.bytes)) {</div>
<div class="line"><span class="lineno"> 2716</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Data length must be in [0, %lu]\n&quot;</span>,</div>
<div class="line"><span class="lineno"> 2717</span>            (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>) <span class="keyword">sizeof</span>(data.bytes));</div>
<div class="line"><span class="lineno"> 2718</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 2719</span>  }</div>
<div class="line"><span class="lineno"> 2720</span> </div>
<div class="line"><span class="lineno"> 2721</span>  data_len = <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a> + <span class="keyword">sizeof</span>(data) - <span class="keyword">sizeof</span>(data.bytes);</div>
<div class="line"><span class="lineno"> 2722</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(data.bytes, in, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a>);</div>
<div class="line"><span class="lineno"> 2723</span> </div>
<div class="line"><span class="lineno"> 2724</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="#a4c26f003b72e800e9c934bca922a404a">yh_send_secure_msg</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, YHC_PUT_OPAQUE, data.buf, data_len,</div>
<div class="line"><span class="lineno"> 2725</span>                           &amp;response_cmd, response.buf, &amp;response_len);</div>
<div class="line"><span class="lineno"> 2726</span>  <a class="code hl_define" href="insecure__memzero_8h.html#a0794f9275fd1036ecba6ff0a901a320b">insecure_memzero</a>(data.buf, data_len);</div>
<div class="line"><span class="lineno"> 2727</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 2728</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Failed to send PUT OPAQUE command: %s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 2729</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 2730</span>  }</div>
<div class="line"><span class="lineno"> 2731</span> </div>
<div class="line"><span class="lineno"> 2732</span>  <span class="keywordflow">if</span> (response_cmd == <a class="code hl_enumvalue" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7ea51cdf2ccd6995498e589e8ea6ce2a1f2">YHC_ERROR</a>) {</div>
<div class="line"><span class="lineno"> 2733</span>    <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> translated = translate_device_error(response.buf[0]);</div>
<div class="line"><span class="lineno"> 2734</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Unable to store opaque object: %s (%x)&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(translated),</div>
<div class="line"><span class="lineno"> 2735</span>            response.buf[0]);</div>
<div class="line"><span class="lineno"> 2736</span>    <span class="keywordflow">return</span> translated;</div>
<div class="line"><span class="lineno"> 2737</span>  }</div>
<div class="line"><span class="lineno"> 2738</span> </div>
<div class="line"><span class="lineno"> 2739</span>  *object_id = ntohs(response.object_id);</div>
<div class="line"><span class="lineno"> 2740</span>  <a class="code hl_define" href="debug__lib_8h.html#a8c4742440a149ad8bcb5d58ae76c5ed3">DBG_INFO</a>(<span class="stringliteral">&quot;Stored Opaque Object 0x%04x&quot;</span>, *object_id);</div>
<div class="line"><span class="lineno"> 2741</span> </div>
<div class="line"><span class="lineno"> 2742</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 2743</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a1249c920eec24f634d04eaafb90a1ca2_cgraph.png" border="0" usemap="#ayubihsm_8c_a1249c920eec24f634d04eaafb90a1ca2_cgraph" alt=""/></div>
<map name="ayubihsm_8c_a1249c920eec24f634d04eaafb90a1ca2_cgraph" id="ayubihsm_8c_a1249c920eec24f634d04eaafb90a1ca2_cgraph">
<area shape="rect" title=" " alt="" coords="5,129,157,155"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="630,5,702,31"/>
<area shape="poly" title=" " alt="" coords="110,126,204,89,301,59,401,40,515,25,615,18,615,23,516,30,401,45,302,64,206,94,112,131"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="632,179,700,204"/>
<area shape="poly" title=" " alt="" coords="158,151,205,157,436,176,617,187,617,192,435,181,204,162,157,156"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="205,104,353,130"/>
<area shape="poly" title=" " alt="" coords="157,130,189,126,190,131,158,135"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="624,104,708,130"/>
<area shape="poly" title=" " alt="" coords="157,145,344,152,455,149,566,140,609,131,610,136,567,145,455,154,344,157,157,151"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="401,104,566,130"/>
<area shape="poly" title=" " alt="" coords="353,114,385,114,385,120,353,120"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="418,55,549,80"/>
<area shape="poly" title=" " alt="" coords="335,101,412,82,413,87,336,106"/>
<area shape="poly" title=" " alt="" coords="543,101,565,91,580,79,589,67,598,54,613,40,618,37,621,41,616,44,602,57,593,70,583,83,568,95,545,106"/>
<area shape="poly" title=" " alt="" coords="518,128,619,170,617,175,516,133"/>
<area shape="poly" title=" " alt="" coords="567,114,609,114,609,120,567,120"/>
<area shape="poly" title=" " alt="" coords="533,51,615,29,616,34,535,57"/>
<area shape="poly" title=" " alt="" coords="535,78,610,99,609,104,533,84"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="614,55,718,80"/>
<area shape="poly" title=" " alt="" coords="549,65,599,65,599,70,549,70"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a1249c920eec24f634d04eaafb90a1ca2_icgraph.png" border="0" usemap="#ayubihsm_8c_a1249c920eec24f634d04eaafb90a1ca2_icgraph" alt=""/></div>
<map name="ayubihsm_8c_a1249c920eec24f634d04eaafb90a1ca2_icgraph" id="ayubihsm_8c_a1249c920eec24f634d04eaafb90a1ca2_icgraph">
<area shape="rect" title=" " alt="" coords="485,31,637,56"/>
<area shape="rect" href="attest_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="342,5,391,31"/>
<area shape="poly" title=" " alt="" coords="470,34,391,24,392,19,470,29"/>
<area shape="rect" href="commands_8c.html#a2be40cf6e90d80392d7aa5e291660f65" title=" " alt="" coords="296,55,437,80"/>
<area shape="poly" title=" " alt="" coords="470,57,438,61,437,56,470,52"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,29,248,55"/>
<area shape="poly" title=" " alt="" coords="280,59,248,54,249,49,281,53"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,55,55,80"/>
<area shape="poly" title=" " alt="" coords="281,70,55,70,55,65,281,65"/>
<area shape="poly" title=" " alt="" coords="88,60,55,66,54,61,87,55"/>
</map>
</div>

</div>
</div>
<a id="addc22271306d847f53321984f41d818b" name="addc22271306d847f53321984f41d818b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#addc22271306d847f53321984f41d818b">&#9670;&#160;</a></span>yh_util_import_otp_aead_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_util_import_otp_aead_key </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__session.html">yh_session</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *</td>          <td class="paramname"><span class="paramname"><em>key_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>label</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a></td>          <td class="paramname"><span class="paramname"><em>domains</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structyh__capabilities.html">yh_capabilities</a> *</td>          <td class="paramname"><span class="paramname"><em>capabilities</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a></td>          <td class="paramname"><span class="paramname"><em>nonce_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>in</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>in_len</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Import an <a class="el" href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583a02c5f683fde147de6a9e1043f971f5f0" title="OTP AEAD Key is a secret key used to decrypt Yubico OTP values.">YH_OTP_AEAD_KEY</a> used for Yubico OTP Decryption</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>Authenticated session to use </td></tr>
    <tr><td class="paramname">key_id</td><td>Object ID of the AEAD Key. 0 if the Object ID should be generated by the device </td></tr>
    <tr><td class="paramname">label</td><td>Label of the AEAD Key. Maximum length is <a class="el" href="yubihsm_8h.html#a431f8b753552a8b2f5f980e871b6d019" title="Max length of object labels.">YH_OBJ_LABEL_LEN</a> </td></tr>
    <tr><td class="paramname">domains</td><td>Domains the AEAD Key will be operating within. See <a class="el" href="yubihsm_8h.html#a96a4c751a281515d5610adb8fd779438">yh_string_to_domains()</a> </td></tr>
    <tr><td class="paramname">capabilities</td><td>Capabilities of the AEAD Key. See <a class="el" href="yubihsm_8h.html#aab440e1cb671d9ba7a2e7d1243960e42">yh_string_to_capabilities()</a> </td></tr>
    <tr><td class="paramname">nonce_id</td><td>Nonce ID </td></tr>
    <tr><td class="paramname">in</td><td>AEAD Key to import </td></tr>
    <tr><td class="paramname">in_len</td><td>Length of AEAD Key to import. Must be 16, 24 or 32</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> if input parameters are NULL or if <code>in_len</code> is not one of 16, 24 or 32. See <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> for other possible errors </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l03337">3337</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3341</span>                                                 {</div>
<div class="line"><span class="lineno"> 3342</span> </div>
<div class="line"><span class="lineno"> 3343</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a> == NULL || <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a> == NULL || <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> == NULL ||</div>
<div class="line"><span class="lineno"> 3344</span>      strlen(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>) &gt; <a class="code hl_define" href="yubihsm_8h.html#a431f8b753552a8b2f5f980e871b6d019">YH_OBJ_LABEL_LEN</a> || <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a> == NULL || in == NULL) {</div>
<div class="line"><span class="lineno"> 3345</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>));</div>
<div class="line"><span class="lineno"> 3346</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 3347</span>  }</div>
<div class="line"><span class="lineno"> 3348</span><span class="preprocessor">#pragma pack(push, 1)</span></div>
<div class="line"><span class="lineno"> 3349</span>  <span class="keyword">union </span>{</div>
<div class="line"><span class="lineno"> 3350</span>    <span class="keyword">struct </span>{</div>
<div class="line"><span class="lineno"> 3351</span>      <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>;</div>
<div class="line"><span class="lineno"> 3352</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>[<a class="code hl_define" href="yubihsm_8h.html#a431f8b753552a8b2f5f980e871b6d019">YH_OBJ_LABEL_LEN</a>];</div>
<div class="line"><span class="lineno"> 3353</span>      <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a5420fd4d2f76428942c2716b1cb7e863">domains</a>;</div>
<div class="line"><span class="lineno"> 3354</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>[<a class="code hl_define" href="yubihsm_8h.html#ad3c904849d17cae0a6f426e8007731d7">YH_CAPABILITIES_LEN</a>];</div>
<div class="line"><span class="lineno"> 3355</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>;</div>
<div class="line"><span class="lineno"> 3356</span>      <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> nonce_id;</div>
<div class="line"><span class="lineno"> 3357</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> key[32];</div>
<div class="line"><span class="lineno"> 3358</span>    };</div>
<div class="line"><span class="lineno"> 3359</span>    <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a855e99b645b13e7905d074d02fe0bff5">buf</a>[1];</div>
<div class="line"><span class="lineno"> 3360</span>  } data;</div>
<div class="line"><span class="lineno"> 3361</span>  <span class="keyword">union </span>{</div>
<div class="line"><span class="lineno"> 3362</span>    <span class="keyword">struct </span>{</div>
<div class="line"><span class="lineno"> 3363</span>      <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>;</div>
<div class="line"><span class="lineno"> 3364</span>    };</div>
<div class="line"><span class="lineno"> 3365</span>    <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a855e99b645b13e7905d074d02fe0bff5">buf</a>[1];</div>
<div class="line"><span class="lineno"> 3366</span>  } response;</div>
<div class="line"><span class="lineno"> 3367</span><span class="preprocessor">#pragma pack(pop)</span></div>
<div class="line"><span class="lineno"> 3368</span> </div>
<div class="line"><span class="lineno"> 3369</span>  <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> data_len = <span class="keyword">sizeof</span>(data);</div>
<div class="line"><span class="lineno"> 3370</span>  <span class="keywordtype">size_t</span> response_len = <span class="keyword">sizeof</span>(response);</div>
<div class="line"><span class="lineno"> 3371</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7e">yh_cmd</a> response_cmd;</div>
<div class="line"><span class="lineno"> 3372</span> </div>
<div class="line"><span class="lineno"> 3373</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 3374</span> </div>
<div class="line"><span class="lineno"> 3375</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a> == 16) {</div>
<div class="line"><span class="lineno"> 3376</span>    data.algorithm = <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa62e7ba4126ae16faeafb28972a4e0959">YH_ALGO_AES128_YUBICO_OTP</a>;</div>
<div class="line"><span class="lineno"> 3377</span>    data_len -= 16;</div>
<div class="line"><span class="lineno"> 3378</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a> == 24) {</div>
<div class="line"><span class="lineno"> 3379</span>    data.algorithm = <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa62dd31db747b4b7f81d9e30877a0b720">YH_ALGO_AES192_YUBICO_OTP</a>;</div>
<div class="line"><span class="lineno"> 3380</span>    data_len -= 8;</div>
<div class="line"><span class="lineno"> 3381</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a> == 32) {</div>
<div class="line"><span class="lineno"> 3382</span>    data.algorithm = <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caad1558532867577d1d77c84f1ae632acd">YH_ALGO_AES256_YUBICO_OTP</a>;</div>
<div class="line"><span class="lineno"> 3383</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3384</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Key length has to be 16, 24 or 32 bytes.&quot;</span>);</div>
<div class="line"><span class="lineno"> 3385</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 3386</span>  }</div>
<div class="line"><span class="lineno"> 3387</span> </div>
<div class="line"><span class="lineno"> 3388</span>  data.key_id = htons(*<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>);</div>
<div class="line"><span class="lineno"> 3389</span> </div>
<div class="line"><span class="lineno"> 3390</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(data.label, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>, strlen(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>));</div>
<div class="line"><span class="lineno"> 3391</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105">memset</a>(data.label + strlen(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>), 0, <a class="code hl_define" href="yubihsm_8h.html#a431f8b753552a8b2f5f980e871b6d019">YH_OBJ_LABEL_LEN</a> - strlen(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>));</div>
<div class="line"><span class="lineno"> 3392</span> </div>
<div class="line"><span class="lineno"> 3393</span>  data.domains = htons(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a5420fd4d2f76428942c2716b1cb7e863">domains</a>);</div>
<div class="line"><span class="lineno"> 3394</span> </div>
<div class="line"><span class="lineno"> 3395</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(data.capabilities, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>, <a class="code hl_define" href="yubihsm_8h.html#ad3c904849d17cae0a6f426e8007731d7">YH_CAPABILITIES_LEN</a>);</div>
<div class="line"><span class="lineno"> 3396</span> </div>
<div class="line"><span class="lineno"> 3397</span>  data.nonce_id = nonce_id;</div>
<div class="line"><span class="lineno"> 3398</span> </div>
<div class="line"><span class="lineno"> 3399</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(data.key, in, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a>);</div>
<div class="line"><span class="lineno"> 3400</span> </div>
<div class="line"><span class="lineno"> 3401</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="#a4c26f003b72e800e9c934bca922a404a">yh_send_secure_msg</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, YHC_PUT_OTP_AEAD_KEY, data.buf, data_len,</div>
<div class="line"><span class="lineno"> 3402</span>                           &amp;response_cmd, response.buf, &amp;response_len);</div>
<div class="line"><span class="lineno"> 3403</span>  <a class="code hl_define" href="insecure__memzero_8h.html#a0794f9275fd1036ecba6ff0a901a320b">insecure_memzero</a>(data.buf, data_len);</div>
<div class="line"><span class="lineno"> 3404</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 3405</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Failed to send PUT OTP AEAD KEY command: %s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 3406</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 3407</span>  }</div>
<div class="line"><span class="lineno"> 3408</span> </div>
<div class="line"><span class="lineno"> 3409</span>  <span class="keywordflow">if</span> (response_cmd == <a class="code hl_enumvalue" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7ea51cdf2ccd6995498e589e8ea6ce2a1f2">YHC_ERROR</a>) {</div>
<div class="line"><span class="lineno"> 3410</span>    <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> translated = translate_device_error(response.buf[0]);</div>
<div class="line"><span class="lineno"> 3411</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Unable to store OTP AEAD key: %s (%x)&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(translated),</div>
<div class="line"><span class="lineno"> 3412</span>            response.buf[0]);</div>
<div class="line"><span class="lineno"> 3413</span>    <span class="keywordflow">return</span> translated;</div>
<div class="line"><span class="lineno"> 3414</span>  }</div>
<div class="line"><span class="lineno"> 3415</span> </div>
<div class="line"><span class="lineno"> 3416</span>  *<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a> = ntohs(response.key_id);</div>
<div class="line"><span class="lineno"> 3417</span>  <a class="code hl_define" href="debug__lib_8h.html#a8c4742440a149ad8bcb5d58ae76c5ed3">DBG_INFO</a>(<span class="stringliteral">&quot;Imported OTP AEAD key 0x%04x&quot;</span>, *<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>);</div>
<div class="line"><span class="lineno"> 3418</span> </div>
<div class="line"><span class="lineno"> 3419</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 3420</span>}</div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caa62dd31db747b4b7f81d9e30877a0b720"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa62dd31db747b4b7f81d9e30877a0b720">YH_ALGO_AES192_YUBICO_OTP</a></div><div class="ttdeci">@ YH_ALGO_AES192_YUBICO_OTP</div><div class="ttdoc">aes192-yubico-otp</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00468">yubihsm.h:468</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caa62e7ba4126ae16faeafb28972a4e0959"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa62e7ba4126ae16faeafb28972a4e0959">YH_ALGO_AES128_YUBICO_OTP</a></div><div class="ttdeci">@ YH_ALGO_AES128_YUBICO_OTP</div><div class="ttdoc">aes128-yubico-otp</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00464">yubihsm.h:464</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caad1558532867577d1d77c84f1ae632acd"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caad1558532867577d1d77c84f1ae632acd">YH_ALGO_AES256_YUBICO_OTP</a></div><div class="ttdeci">@ YH_ALGO_AES256_YUBICO_OTP</div><div class="ttdoc">aes256-yubico-otp</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00470">yubihsm.h:470</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_addc22271306d847f53321984f41d818b_cgraph.png" border="0" usemap="#ayubihsm_8c_addc22271306d847f53321984f41d818b_cgraph" alt=""/></div>
<map name="ayubihsm_8c_addc22271306d847f53321984f41d818b_cgraph" id="ayubihsm_8c_addc22271306d847f53321984f41d818b_cgraph">
<area shape="rect" title=" " alt="" coords="5,122,133,162"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="606,5,678,31"/>
<area shape="poly" title=" " alt="" coords="110,119,180,89,277,59,377,40,491,25,591,18,591,23,492,30,377,45,278,64,182,94,112,124"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="608,179,676,204"/>
<area shape="poly" title=" " alt="" coords="134,150,181,157,412,177,593,187,593,192,411,182,180,162,133,156"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="181,104,329,130"/>
<area shape="poly" title=" " alt="" coords="132,131,165,126,166,132,133,136"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="600,104,684,130"/>
<area shape="poly" title=" " alt="" coords="133,145,317,151,430,149,542,140,585,131,586,136,543,145,430,154,317,157,133,150"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="377,104,542,130"/>
<area shape="poly" title=" " alt="" coords="329,114,361,114,361,120,329,120"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="394,55,525,80"/>
<area shape="poly" title=" " alt="" coords="311,101,388,82,389,87,312,106"/>
<area shape="poly" title=" " alt="" coords="519,101,541,91,556,79,565,67,574,54,589,40,594,37,597,41,592,44,578,57,569,70,559,83,544,95,521,106"/>
<area shape="poly" title=" " alt="" coords="494,128,595,170,593,175,492,133"/>
<area shape="poly" title=" " alt="" coords="543,114,585,114,585,120,543,120"/>
<area shape="poly" title=" " alt="" coords="509,51,591,29,592,34,511,57"/>
<area shape="poly" title=" " alt="" coords="511,78,586,99,585,104,509,84"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="590,55,694,80"/>
<area shape="poly" title=" " alt="" coords="525,65,575,65,575,70,525,70"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_addc22271306d847f53321984f41d818b_icgraph.png" border="0" usemap="#ayubihsm_8c_addc22271306d847f53321984f41d818b_icgraph" alt=""/></div>
<map name="ayubihsm_8c_addc22271306d847f53321984f41d818b_icgraph" id="ayubihsm_8c_addc22271306d847f53321984f41d818b_icgraph">
<area shape="rect" title=" " alt="" coords="524,23,652,64"/>
<area shape="rect" href="yubico__otp_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="362,5,411,31"/>
<area shape="poly" title=" " alt="" coords="509,36,411,24,412,19,509,31"/>
<area shape="rect" href="commands_8c.html#a7ef84380bc19536e4ba9bf62fd44ba93" title=" " alt="" coords="296,55,476,80"/>
<area shape="poly" title=" " alt="" coords="509,56,477,59,476,54,509,50"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,55,248,80"/>
<area shape="poly" title=" " alt="" coords="280,70,249,70,249,65,280,65"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,55,55,80"/>
<area shape="poly" title=" " alt="" coords="87,70,55,70,55,65,87,65"/>
</map>
</div>

</div>
</div>
<a id="ab0ca24007ce6942d2185859560c43e8a" name="ab0ca24007ce6942d2185859560c43e8a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab0ca24007ce6942d2185859560c43e8a">&#9670;&#160;</a></span>yh_util_import_rsa_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_util_import_rsa_key </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__session.html">yh_session</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *</td>          <td class="paramname"><span class="paramname"><em>key_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>label</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a></td>          <td class="paramname"><span class="paramname"><em>domains</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structyh__capabilities.html">yh_capabilities</a> *</td>          <td class="paramname"><span class="paramname"><em>capabilities</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55ca">yh_algorithm</a></td>          <td class="paramname"><span class="paramname"><em>algorithm</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>p</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>q</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Import an RSA key into the device</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>Authenticated session to use </td></tr>
    <tr><td class="paramname">key_id</td><td>Object ID the key. 0 if Object ID should be generated by the device </td></tr>
    <tr><td class="paramname">label</td><td>Label of the key. Maximum length is <a class="el" href="yubihsm_8h.html#a431f8b753552a8b2f5f980e871b6d019" title="Max length of object labels.">YH_OBJ_LABEL_LEN</a> </td></tr>
    <tr><td class="paramname">domains</td><td>Domains to which the key belongs specified as an unsigned int. See <a class="el" href="yubihsm_8h.html#a96a4c751a281515d5610adb8fd779438">yh_string_to_domains()</a> </td></tr>
    <tr><td class="paramname">capabilities</td><td>Capabilities of the key. See <a class="el" href="yubihsm_8h.html#aab440e1cb671d9ba7a2e7d1243960e42">yh_string_to_capabilities()</a> </td></tr>
    <tr><td class="paramname">algorithm</td><td>Algorithm of the key to import. Must be one of: <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caaafe94e6a770edb51c6db84f77d98d2c6" title="rsa2048">YH_ALGO_RSA_2048</a>, <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caafd3fbd9ed86caf267ccc77cb24d44426" title="rsa3072">YH_ALGO_RSA_3072</a> or <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caae5963322a0a0f43a1b74faa78e3a7329" title="rsa4096">YH_ALGO_RSA_4096</a> </td></tr>
    <tr><td class="paramname">p</td><td>P component of the RSA key to import </td></tr>
    <tr><td class="paramname">q</td><td>Q component of the RSA key to import</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> input parameters are NULL or the algorithm is not one of <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caaafe94e6a770edb51c6db84f77d98d2c6" title="rsa2048">YH_ALGO_RSA_2048</a>, <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caafd3fbd9ed86caf267ccc77cb24d44426" title="rsa3072">YH_ALGO_RSA_3072</a> or <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caae5963322a0a0f43a1b74faa78e3a7329" title="rsa4096">YH_ALGO_RSA_4096</a>. See <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> for other possible errors </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l01655">1655</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1659</span>                                               {</div>
<div class="line"><span class="lineno"> 1660</span> </div>
<div class="line"><span class="lineno"> 1661</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a> == NULL || <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a> == NULL || <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> == NULL ||</div>
<div class="line"><span class="lineno"> 1662</span>      strlen(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>) &gt; <a class="code hl_define" href="yubihsm_8h.html#a431f8b753552a8b2f5f980e871b6d019">YH_OBJ_LABEL_LEN</a> || <a class="code hl_variable" href="bn_8cpp.html#a8b0eadcc506862e9d751ab45185053aa">p</a> == NULL || q == NULL) {</div>
<div class="line"><span class="lineno"> 1663</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>));</div>
<div class="line"><span class="lineno"> 1664</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 1665</span>  }</div>
<div class="line"><span class="lineno"> 1666</span> </div>
<div class="line"><span class="lineno"> 1667</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> keybuf[256 * 2];</div>
<div class="line"><span class="lineno"> 1668</span>  <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> component_len;</div>
<div class="line"><span class="lineno"> 1669</span> </div>
<div class="line"><span class="lineno"> 1670</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a> == <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caaafe94e6a770edb51c6db84f77d98d2c6">YH_ALGO_RSA_2048</a>) {</div>
<div class="line"><span class="lineno"> 1671</span>    component_len = 128;</div>
<div class="line"><span class="lineno"> 1672</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a> == <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caafd3fbd9ed86caf267ccc77cb24d44426">YH_ALGO_RSA_3072</a>) {</div>
<div class="line"><span class="lineno"> 1673</span>    component_len = 192;</div>
<div class="line"><span class="lineno"> 1674</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a> == <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caae5963322a0a0f43a1b74faa78e3a7329">YH_ALGO_RSA_4096</a>) {</div>
<div class="line"><span class="lineno"> 1675</span>    component_len = 256;</div>
<div class="line"><span class="lineno"> 1676</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1677</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 1678</span>  }</div>
<div class="line"><span class="lineno"> 1679</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(keybuf, <a class="code hl_variable" href="bn_8cpp.html#a8b0eadcc506862e9d751ab45185053aa">p</a>, component_len);</div>
<div class="line"><span class="lineno"> 1680</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(keybuf + component_len, q, component_len);</div>
<div class="line"><span class="lineno"> 1681</span> </div>
<div class="line"><span class="lineno"> 1682</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = import_asymmetric(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a5420fd4d2f76428942c2716b1cb7e863">domains</a>, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>,</div>
<div class="line"><span class="lineno"> 1683</span>                                <a class="code hl_variable" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>, keybuf, component_len * 2);</div>
<div class="line"><span class="lineno"> 1684</span>  <a class="code hl_define" href="insecure__memzero_8h.html#a0794f9275fd1036ecba6ff0a901a320b">insecure_memzero</a>(keybuf, <span class="keyword">sizeof</span>(keybuf));</div>
<div class="line"><span class="lineno"> 1685</span> </div>
<div class="line"><span class="lineno"> 1686</span>  <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 1687</span>}</div>
<div class="ttc" id="abn_8cpp_html_a8b0eadcc506862e9d751ab45185053aa"><div class="ttname"><a href="bn_8cpp.html#a8b0eadcc506862e9d751ab45185053aa">p</a></div><div class="ttdeci">const mie::Vuint &amp; p</div><div class="ttdef"><b>Definition</b> <a href="bn_8cpp_source.html#l00027">bn.cpp:27</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_ab0ca24007ce6942d2185859560c43e8a_cgraph.png" border="0" usemap="#ayubihsm_8c_ab0ca24007ce6942d2185859560c43e8a_cgraph" alt=""/></div>
<map name="ayubihsm_8c_ab0ca24007ce6942d2185859560c43e8a_cgraph" id="ayubihsm_8c_ab0ca24007ce6942d2185859560c43e8a_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,161,56"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="215,5,286,31"/>
<area shape="poly" title=" " alt="" coords="160,29,199,23,199,28,161,34"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="209,55,292,80"/>
<area shape="poly" title=" " alt="" coords="161,52,193,57,193,62,160,57"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_ab0ca24007ce6942d2185859560c43e8a_icgraph.png" border="0" usemap="#ayubihsm_8c_ab0ca24007ce6942d2185859560c43e8a_icgraph" alt=""/></div>
<map name="ayubihsm_8c_ab0ca24007ce6942d2185859560c43e8a_icgraph" id="ayubihsm_8c_ab0ca24007ce6942d2185859560c43e8a_icgraph">
<area shape="rect" title=" " alt="" coords="511,31,667,56"/>
<area shape="rect" href="decrypt__rsa_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="355,5,404,31"/>
<area shape="poly" title=" " alt="" coords="495,35,404,24,405,18,496,30"/>
<area shape="rect" href="commands_8c.html#a0abe95eb37069022ed341835938de103" title=" " alt="" coords="296,55,463,80"/>
<area shape="poly" title=" " alt="" coords="496,57,464,61,464,55,495,52"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,29,248,55"/>
<area shape="poly" title=" " alt="" coords="280,58,248,54,249,49,281,53"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,55,55,80"/>
<area shape="poly" title=" " alt="" coords="281,70,55,70,55,65,281,65"/>
<area shape="poly" title=" " alt="" coords="88,60,55,66,54,61,87,55"/>
</map>
</div>

</div>
</div>
<a id="ae0fc8d6520950868365011d1a9f450f1" name="ae0fc8d6520950868365011d1a9f450f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0fc8d6520950868365011d1a9f450f1">&#9670;&#160;</a></span>yh_util_import_template()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_util_import_template </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__session.html">yh_session</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *</td>          <td class="paramname"><span class="paramname"><em>object_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>label</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a></td>          <td class="paramname"><span class="paramname"><em>domains</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structyh__capabilities.html">yh_capabilities</a> *</td>          <td class="paramname"><span class="paramname"><em>capabilities</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55ca">yh_algorithm</a></td>          <td class="paramname"><span class="paramname"><em>algorithm</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>in</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>in_len</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Import a <a class="el" href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583a96244762de5ce4175e60157239e7a097">YH_TEMPLATE</a> object into the device</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>Authenticated session to use </td></tr>
    <tr><td class="paramname">object_id</td><td>Object ID of the Template. 0 if the Object ID should be generated by the device </td></tr>
    <tr><td class="paramname">label</td><td>Label of the Template. Maximum length is <a class="el" href="yubihsm_8h.html#a431f8b753552a8b2f5f980e871b6d019" title="Max length of object labels.">YH_OBJ_LABEL_LEN</a> </td></tr>
    <tr><td class="paramname">domains</td><td>Domains the Template will be operating within. See <a class="el" href="yubihsm_8h.html#a96a4c751a281515d5610adb8fd779438">yh_string_to_domains()</a> </td></tr>
    <tr><td class="paramname">capabilities</td><td>Capabilities of the Template. See <a class="el" href="yubihsm_8h.html#aab440e1cb671d9ba7a2e7d1243960e42">yh_string_to_capabilities</a> </td></tr>
    <tr><td class="paramname">algorithm</td><td>Algorithm of the Template </td></tr>
    <tr><td class="paramname">in</td><td>Template to import </td></tr>
    <tr><td class="paramname">in_len</td><td>Length of the Template to import</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> if input parameters are NULL or if <code>in_len</code> is too big. See <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> for other possible errors </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l02835">2835</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2839</span>                                             {</div>
<div class="line"><span class="lineno"> 2840</span> </div>
<div class="line"><span class="lineno"> 2841</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a> == NULL || object_id == NULL || <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> == NULL ||</div>
<div class="line"><span class="lineno"> 2842</span>      strlen(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>) &gt; <a class="code hl_define" href="yubihsm_8h.html#a431f8b753552a8b2f5f980e871b6d019">YH_OBJ_LABEL_LEN</a> || in == NULL || <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a> == 0) {</div>
<div class="line"><span class="lineno"> 2843</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>));</div>
<div class="line"><span class="lineno"> 2844</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 2845</span>  }</div>
<div class="line"><span class="lineno"> 2846</span> </div>
<div class="line"><span class="lineno"> 2847</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 2848</span> </div>
<div class="line"><span class="lineno"> 2849</span><span class="preprocessor">#pragma pack(push, 1)</span></div>
<div class="line"><span class="lineno"> 2850</span>  <span class="keyword">union </span>{</div>
<div class="line"><span class="lineno"> 2851</span>    <span class="keyword">struct </span>{</div>
<div class="line"><span class="lineno"> 2852</span>      <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> object_id;</div>
<div class="line"><span class="lineno"> 2853</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>[<a class="code hl_define" href="yubihsm_8h.html#a431f8b753552a8b2f5f980e871b6d019">YH_OBJ_LABEL_LEN</a>];</div>
<div class="line"><span class="lineno"> 2854</span>      <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a5420fd4d2f76428942c2716b1cb7e863">domains</a>;</div>
<div class="line"><span class="lineno"> 2855</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>[<a class="code hl_define" href="yubihsm_8h.html#ad3c904849d17cae0a6f426e8007731d7">YH_CAPABILITIES_LEN</a>];</div>
<div class="line"><span class="lineno"> 2856</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>;</div>
<div class="line"><span class="lineno"> 2857</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#ac6f5a1f1e061f000983f5d5f3ac25dfa">bytes</a>[<a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a> - <span class="keyword">sizeof</span>(object_id) - <span class="keyword">sizeof</span>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a5420fd4d2f76428942c2716b1cb7e863">domains</a>) -</div>
<div class="line"><span class="lineno"> 2858</span>                    <a class="code hl_define" href="yubihsm_8h.html#a431f8b753552a8b2f5f980e871b6d019">YH_OBJ_LABEL_LEN</a> - <a class="code hl_define" href="yubihsm_8h.html#ad3c904849d17cae0a6f426e8007731d7">YH_CAPABILITIES_LEN</a> - 2];</div>
<div class="line"><span class="lineno"> 2859</span>    };</div>
<div class="line"><span class="lineno"> 2860</span>    <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a855e99b645b13e7905d074d02fe0bff5">buf</a>[1];</div>
<div class="line"><span class="lineno"> 2861</span>  } data;</div>
<div class="line"><span class="lineno"> 2862</span>  <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> data_len;</div>
<div class="line"><span class="lineno"> 2863</span>  <span class="keyword">union </span>{</div>
<div class="line"><span class="lineno"> 2864</span>    <span class="keyword">struct </span>{</div>
<div class="line"><span class="lineno"> 2865</span>      <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> object_id;</div>
<div class="line"><span class="lineno"> 2866</span>    };</div>
<div class="line"><span class="lineno"> 2867</span>    <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a855e99b645b13e7905d074d02fe0bff5">buf</a>[1];</div>
<div class="line"><span class="lineno"> 2868</span>  } response;</div>
<div class="line"><span class="lineno"> 2869</span><span class="preprocessor">#pragma pack(pop)</span></div>
<div class="line"><span class="lineno"> 2870</span> </div>
<div class="line"><span class="lineno"> 2871</span>  <span class="keywordtype">size_t</span> response_len = <span class="keyword">sizeof</span>(response);</div>
<div class="line"><span class="lineno"> 2872</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7e">yh_cmd</a> response_cmd;</div>
<div class="line"><span class="lineno"> 2873</span> </div>
<div class="line"><span class="lineno"> 2874</span>  data.object_id = htons(*object_id);</div>
<div class="line"><span class="lineno"> 2875</span> </div>
<div class="line"><span class="lineno"> 2876</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(data.label, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>, strlen(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>));</div>
<div class="line"><span class="lineno"> 2877</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105">memset</a>(data.label + strlen(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>), 0, <a class="code hl_define" href="yubihsm_8h.html#a431f8b753552a8b2f5f980e871b6d019">YH_OBJ_LABEL_LEN</a> - strlen(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>));</div>
<div class="line"><span class="lineno"> 2878</span> </div>
<div class="line"><span class="lineno"> 2879</span>  data.domains = htons(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a5420fd4d2f76428942c2716b1cb7e863">domains</a>);</div>
<div class="line"><span class="lineno"> 2880</span> </div>
<div class="line"><span class="lineno"> 2881</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(data.capabilities, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>, <a class="code hl_define" href="yubihsm_8h.html#ad3c904849d17cae0a6f426e8007731d7">YH_CAPABILITIES_LEN</a>);</div>
<div class="line"><span class="lineno"> 2882</span> </div>
<div class="line"><span class="lineno"> 2883</span>  data.algorithm = <a class="code hl_variable" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>;</div>
<div class="line"><span class="lineno"> 2884</span> </div>
<div class="line"><span class="lineno"> 2885</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a> &gt; <span class="keyword">sizeof</span>(data.bytes)) {</div>
<div class="line"><span class="lineno"> 2886</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Data length must be in [0, %lu]\n&quot;</span>,</div>
<div class="line"><span class="lineno"> 2887</span>            (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>) <span class="keyword">sizeof</span>(data.bytes));</div>
<div class="line"><span class="lineno"> 2888</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 2889</span>  }</div>
<div class="line"><span class="lineno"> 2890</span> </div>
<div class="line"><span class="lineno"> 2891</span>  data_len = <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a> + <span class="keyword">sizeof</span>(data.object_id) + <span class="keyword">sizeof</span>(data.domains) +</div>
<div class="line"><span class="lineno"> 2892</span>             <a class="code hl_define" href="yubihsm_8h.html#ad3c904849d17cae0a6f426e8007731d7">YH_CAPABILITIES_LEN</a> + <a class="code hl_define" href="yubihsm_8h.html#a431f8b753552a8b2f5f980e871b6d019">YH_OBJ_LABEL_LEN</a> + <span class="keyword">sizeof</span>(data.algorithm);</div>
<div class="line"><span class="lineno"> 2893</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(data.bytes, in, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a>);</div>
<div class="line"><span class="lineno"> 2894</span> </div>
<div class="line"><span class="lineno"> 2895</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="#a4c26f003b72e800e9c934bca922a404a">yh_send_secure_msg</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, YHC_PUT_TEMPLATE, data.buf, data_len,</div>
<div class="line"><span class="lineno"> 2896</span>                           &amp;response_cmd, response.buf, &amp;response_len);</div>
<div class="line"><span class="lineno"> 2897</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 2898</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Failed to send PUT TEMPLATE command: %s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 2899</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 2900</span>  }</div>
<div class="line"><span class="lineno"> 2901</span> </div>
<div class="line"><span class="lineno"> 2902</span>  <span class="keywordflow">if</span> (response_cmd == <a class="code hl_enumvalue" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7ea51cdf2ccd6995498e589e8ea6ce2a1f2">YHC_ERROR</a>) {</div>
<div class="line"><span class="lineno"> 2903</span>    <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> translated = translate_device_error(response.buf[0]);</div>
<div class="line"><span class="lineno"> 2904</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Unable to store template object: %s (%x)&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(translated),</div>
<div class="line"><span class="lineno"> 2905</span>            response.buf[0]);</div>
<div class="line"><span class="lineno"> 2906</span>    <span class="keywordflow">return</span> translated;</div>
<div class="line"><span class="lineno"> 2907</span>  }</div>
<div class="line"><span class="lineno"> 2908</span> </div>
<div class="line"><span class="lineno"> 2909</span>  *object_id = ntohs(response.object_id);</div>
<div class="line"><span class="lineno"> 2910</span>  <a class="code hl_define" href="debug__lib_8h.html#a8c4742440a149ad8bcb5d58ae76c5ed3">DBG_INFO</a>(<span class="stringliteral">&quot;Stored Opaque Object 0x%04x&quot;</span>, *object_id);</div>
<div class="line"><span class="lineno"> 2911</span> </div>
<div class="line"><span class="lineno"> 2912</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 2913</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_ae0fc8d6520950868365011d1a9f450f1_cgraph.png" border="0" usemap="#ayubihsm_8c_ae0fc8d6520950868365011d1a9f450f1_cgraph" alt=""/></div>
<map name="ayubihsm_8c_ae0fc8d6520950868365011d1a9f450f1_cgraph" id="ayubihsm_8c_ae0fc8d6520950868365011d1a9f450f1_cgraph">
<area shape="rect" title=" " alt="" coords="5,129,165,155"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="638,5,710,31"/>
<area shape="poly" title=" " alt="" coords="116,126,212,89,309,59,409,40,523,25,623,18,623,23,524,30,409,45,310,65,214,94,118,131"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="640,179,708,204"/>
<area shape="poly" title=" " alt="" coords="165,151,213,157,444,176,625,187,625,192,443,181,212,162,165,156"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="213,104,361,130"/>
<area shape="poly" title=" " alt="" coords="165,130,197,125,198,131,165,135"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="632,104,716,130"/>
<area shape="poly" title=" " alt="" coords="165,146,352,152,463,149,574,140,617,131,618,136,575,145,464,154,352,157,165,151"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="409,104,574,130"/>
<area shape="poly" title=" " alt="" coords="361,114,393,114,393,120,361,120"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="426,55,557,80"/>
<area shape="poly" title=" " alt="" coords="343,101,420,82,421,87,344,106"/>
<area shape="poly" title=" " alt="" coords="551,101,573,91,588,79,597,67,606,54,621,40,626,37,629,41,624,44,610,57,601,70,591,83,576,95,553,106"/>
<area shape="poly" title=" " alt="" coords="526,128,627,170,625,175,524,133"/>
<area shape="poly" title=" " alt="" coords="575,114,617,114,617,120,575,120"/>
<area shape="poly" title=" " alt="" coords="541,51,623,29,624,34,543,57"/>
<area shape="poly" title=" " alt="" coords="543,78,618,99,617,104,541,84"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="622,55,726,80"/>
<area shape="poly" title=" " alt="" coords="557,65,607,65,607,70,557,70"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_ae0fc8d6520950868365011d1a9f450f1_icgraph.png" border="0" usemap="#ayubihsm_8c_ae0fc8d6520950868365011d1a9f450f1_icgraph" alt=""/></div>
<map name="ayubihsm_8c_ae0fc8d6520950868365011d1a9f450f1_icgraph" id="ayubihsm_8c_ae0fc8d6520950868365011d1a9f450f1_icgraph">
<area shape="rect" title=" " alt="" coords="493,31,653,56"/>
<area shape="rect" href="ssh_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="346,5,395,31"/>
<area shape="poly" title=" " alt="" coords="477,34,396,24,396,19,478,29"/>
<area shape="rect" href="commands_8c.html#ad1629b955c1d718c65f137c9df3b3332" title=" " alt="" coords="296,55,445,80"/>
<area shape="poly" title=" " alt="" coords="478,57,446,61,445,56,477,52"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,29,248,55"/>
<area shape="poly" title=" " alt="" coords="280,58,248,54,249,49,281,53"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,55,55,80"/>
<area shape="poly" title=" " alt="" coords="280,70,55,70,55,65,280,65"/>
<area shape="poly" title=" " alt="" coords="88,60,55,66,54,61,87,55"/>
</map>
</div>

</div>
</div>
<a id="a3a9729ea5b2e299a735b43f2b23e50a7" name="a3a9729ea5b2e299a735b43f2b23e50a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a9729ea5b2e299a735b43f2b23e50a7">&#9670;&#160;</a></span>yh_util_import_wrap_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_util_import_wrap_key </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__session.html">yh_session</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *</td>          <td class="paramname"><span class="paramname"><em>key_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>label</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a></td>          <td class="paramname"><span class="paramname"><em>domains</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structyh__capabilities.html">yh_capabilities</a> *</td>          <td class="paramname"><span class="paramname"><em>capabilities</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55ca">yh_algorithm</a></td>          <td class="paramname"><span class="paramname"><em>algorithm</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structyh__capabilities.html">yh_capabilities</a> *</td>          <td class="paramname"><span class="paramname"><em>delegated_capabilities</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>in</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>in_len</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Import a Wrap Key into the device</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>Authenticated session to use </td></tr>
    <tr><td class="paramname">key_id</td><td>Object ID the Wrap Key. 0 if the Object ID should be generated by the device </td></tr>
    <tr><td class="paramname">label</td><td>Label of the Wrap Key. Maximum length is <a class="el" href="yubihsm_8h.html#a431f8b753552a8b2f5f980e871b6d019" title="Max length of object labels.">YH_OBJ_LABEL_LEN</a> </td></tr>
    <tr><td class="paramname">domains</td><td>Domains where the Wrap Key will be operating within. See <a class="el" href="yubihsm_8h.html#a96a4c751a281515d5610adb8fd779438">yh_string_to_domains()</a> </td></tr>
    <tr><td class="paramname">capabilities</td><td>Capabilities of the Wrap Key. See <a class="el" href="yubihsm_8h.html#aab440e1cb671d9ba7a2e7d1243960e42">yh_string_to_capabilities()</a> </td></tr>
    <tr><td class="paramname">algorithm</td><td>Algorithm of the Wrap Key. Supported algorithms: <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caae22b228e457c9bdccb5a93d81730b1b1" title="aes128-ccm-wrap">YH_ALGO_AES128_CCM_WRAP</a>, <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caab739a1d142dacaf37ba13a73e2d83fab" title="aes192-ccm-wrap">YH_ALGO_AES192_CCM_WRAP</a> and <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa927e2246e5657f946b4da4b71092b022" title="aes256-ccm-wrap">YH_ALGO_AES256_CCM_WRAP</a> </td></tr>
    <tr><td class="paramname">delegated_capabilities</td><td>Delegated capabilities of the Wrap Key. See <a class="el" href="yubihsm_8h.html#aab440e1cb671d9ba7a2e7d1243960e42">yh_string_to_capabilities()</a> </td></tr>
    <tr><td class="paramname">in</td><td>the Wrap Key to import </td></tr>
    <tr><td class="paramname">in_len</td><td>Length of the Wrap Key to import</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> if input parameters are NULL, <code>in_len</code> is not what expected based on the algorithm and if the algorithms is not one of <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caae22b228e457c9bdccb5a93d81730b1b1" title="aes128-ccm-wrap">YH_ALGO_AES128_CCM_WRAP</a>, <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caab739a1d142dacaf37ba13a73e2d83fab" title="aes192-ccm-wrap">YH_ALGO_AES192_CCM_WRAP</a> or <a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa927e2246e5657f946b4da4b71092b022" title="aes256-ccm-wrap">YH_ALGO_AES256_CCM_WRAP</a>. See <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> for other possible errors </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l02363">2363</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2368</span>                                                                {</div>
<div class="line"><span class="lineno"> 2369</span> </div>
<div class="line"><span class="lineno"> 2370</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a> == NULL || <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a> == NULL || <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> == NULL ||</div>
<div class="line"><span class="lineno"> 2371</span>      strlen(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>) &gt; <a class="code hl_define" href="yubihsm_8h.html#a431f8b753552a8b2f5f980e871b6d019">YH_OBJ_LABEL_LEN</a> || <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a> == NULL ||</div>
<div class="line"><span class="lineno"> 2372</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#afa62e10709d52e5162a732e81369a7ec">delegated_capabilities</a> == NULL || in == NULL) {</div>
<div class="line"><span class="lineno"> 2373</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>));</div>
<div class="line"><span class="lineno"> 2374</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 2375</span>  }</div>
<div class="line"><span class="lineno"> 2376</span> </div>
<div class="line"><span class="lineno"> 2377</span><span class="preprocessor">#pragma pack(push, 1)</span></div>
<div class="line"><span class="lineno"> 2378</span>  <span class="keyword">union </span>{</div>
<div class="line"><span class="lineno"> 2379</span>    <span class="keyword">struct </span>{</div>
<div class="line"><span class="lineno"> 2380</span>      <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>;</div>
<div class="line"><span class="lineno"> 2381</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>[<a class="code hl_define" href="yubihsm_8h.html#a431f8b753552a8b2f5f980e871b6d019">YH_OBJ_LABEL_LEN</a>];</div>
<div class="line"><span class="lineno"> 2382</span>      <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a5420fd4d2f76428942c2716b1cb7e863">domains</a>;</div>
<div class="line"><span class="lineno"> 2383</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>[<a class="code hl_define" href="yubihsm_8h.html#ad3c904849d17cae0a6f426e8007731d7">YH_CAPABILITIES_LEN</a>];</div>
<div class="line"><span class="lineno"> 2384</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>;</div>
<div class="line"><span class="lineno"> 2385</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#afa62e10709d52e5162a732e81369a7ec">delegated_capabilities</a>[<a class="code hl_define" href="yubihsm_8h.html#ad3c904849d17cae0a6f426e8007731d7">YH_CAPABILITIES_LEN</a>];</div>
<div class="line"><span class="lineno"> 2386</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> key[32];</div>
<div class="line"><span class="lineno"> 2387</span>    };</div>
<div class="line"><span class="lineno"> 2388</span>    <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a855e99b645b13e7905d074d02fe0bff5">buf</a>[1];</div>
<div class="line"><span class="lineno"> 2389</span>  } data;</div>
<div class="line"><span class="lineno"> 2390</span>  <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> data_len = <span class="keyword">sizeof</span>(data);</div>
<div class="line"><span class="lineno"> 2391</span>  <span class="keyword">union </span>{</div>
<div class="line"><span class="lineno"> 2392</span>    <span class="keyword">struct </span>{</div>
<div class="line"><span class="lineno"> 2393</span>      <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>;</div>
<div class="line"><span class="lineno"> 2394</span>    };</div>
<div class="line"><span class="lineno"> 2395</span>    <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a855e99b645b13e7905d074d02fe0bff5">buf</a>[1];</div>
<div class="line"><span class="lineno"> 2396</span>  } response;</div>
<div class="line"><span class="lineno"> 2397</span><span class="preprocessor">#pragma pack(pop)</span></div>
<div class="line"><span class="lineno"> 2398</span> </div>
<div class="line"><span class="lineno"> 2399</span>  <span class="keywordtype">size_t</span> response_len = <span class="keyword">sizeof</span>(response);</div>
<div class="line"><span class="lineno"> 2400</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7e">yh_cmd</a> response_cmd;</div>
<div class="line"><span class="lineno"> 2401</span>  <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a8b142e2a51f6b9b8760f9132119673b6">key_len</a>;</div>
<div class="line"><span class="lineno"> 2402</span> </div>
<div class="line"><span class="lineno"> 2403</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 2404</span> </div>
<div class="line"><span class="lineno"> 2405</span>  <span class="keywordflow">switch</span> (<a class="code hl_variable" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>) {</div>
<div class="line"><span class="lineno"> 2406</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caae22b228e457c9bdccb5a93d81730b1b1">YH_ALGO_AES128_CCM_WRAP</a>:</div>
<div class="line"><span class="lineno"> 2407</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a8b142e2a51f6b9b8760f9132119673b6">key_len</a> = 16;</div>
<div class="line"><span class="lineno"> 2408</span>      data_len -= 16;</div>
<div class="line"><span class="lineno"> 2409</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2410</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caab739a1d142dacaf37ba13a73e2d83fab">YH_ALGO_AES192_CCM_WRAP</a>:</div>
<div class="line"><span class="lineno"> 2411</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a8b142e2a51f6b9b8760f9132119673b6">key_len</a> = 24;</div>
<div class="line"><span class="lineno"> 2412</span>      data_len -= 8;</div>
<div class="line"><span class="lineno"> 2413</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2414</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa927e2246e5657f946b4da4b71092b022">YH_ALGO_AES256_CCM_WRAP</a>:</div>
<div class="line"><span class="lineno"> 2415</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a8b142e2a51f6b9b8760f9132119673b6">key_len</a> = 32;</div>
<div class="line"><span class="lineno"> 2416</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2417</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 2418</span>      <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Bad algorithm specified: %x&quot;</span>, <a class="code hl_variable" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>);</div>
<div class="line"><span class="lineno"> 2419</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 2420</span>  }</div>
<div class="line"><span class="lineno"> 2421</span> </div>
<div class="line"><span class="lineno"> 2422</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a> != <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a8b142e2a51f6b9b8760f9132119673b6">key_len</a>) {</div>
<div class="line"><span class="lineno"> 2423</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Key length not matching, should be %d&quot;</span>, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a8b142e2a51f6b9b8760f9132119673b6">key_len</a>);</div>
<div class="line"><span class="lineno"> 2424</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 2425</span>  }</div>
<div class="line"><span class="lineno"> 2426</span> </div>
<div class="line"><span class="lineno"> 2427</span>  data.key_id = htons(*<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>);</div>
<div class="line"><span class="lineno"> 2428</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(data.label, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>, strlen(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>));</div>
<div class="line"><span class="lineno"> 2429</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105">memset</a>(data.label + strlen(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>), 0, <a class="code hl_define" href="yubihsm_8h.html#a431f8b753552a8b2f5f980e871b6d019">YH_OBJ_LABEL_LEN</a> - strlen(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>));</div>
<div class="line"><span class="lineno"> 2430</span>  data.domains = htons(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a5420fd4d2f76428942c2716b1cb7e863">domains</a>);</div>
<div class="line"><span class="lineno"> 2431</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(data.capabilities, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>, <a class="code hl_define" href="yubihsm_8h.html#ad3c904849d17cae0a6f426e8007731d7">YH_CAPABILITIES_LEN</a>);</div>
<div class="line"><span class="lineno"> 2432</span>  data.algorithm = <a class="code hl_variable" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>;</div>
<div class="line"><span class="lineno"> 2433</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(data.delegated_capabilities, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#afa62e10709d52e5162a732e81369a7ec">delegated_capabilities</a>,</div>
<div class="line"><span class="lineno"> 2434</span>         <a class="code hl_define" href="yubihsm_8h.html#ad3c904849d17cae0a6f426e8007731d7">YH_CAPABILITIES_LEN</a>);</div>
<div class="line"><span class="lineno"> 2435</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(data.key, in, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a8b142e2a51f6b9b8760f9132119673b6">key_len</a>);</div>
<div class="line"><span class="lineno"> 2436</span> </div>
<div class="line"><span class="lineno"> 2437</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="#a4c26f003b72e800e9c934bca922a404a">yh_send_secure_msg</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, YHC_PUT_WRAP_KEY, data.buf, data_len,</div>
<div class="line"><span class="lineno"> 2438</span>                           &amp;response_cmd, response.buf, &amp;response_len);</div>
<div class="line"><span class="lineno"> 2439</span>  <a class="code hl_define" href="insecure__memzero_8h.html#a0794f9275fd1036ecba6ff0a901a320b">insecure_memzero</a>(data.buf, data_len);</div>
<div class="line"><span class="lineno"> 2440</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 2441</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Failed to send PUT WRAP KEY command: %s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 2442</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 2443</span>  }</div>
<div class="line"><span class="lineno"> 2444</span> </div>
<div class="line"><span class="lineno"> 2445</span>  <span class="keywordflow">if</span> (response_cmd == <a class="code hl_enumvalue" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7ea51cdf2ccd6995498e589e8ea6ce2a1f2">YHC_ERROR</a>) {</div>
<div class="line"><span class="lineno"> 2446</span>    <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> translated = translate_device_error(response.buf[0]);</div>
<div class="line"><span class="lineno"> 2447</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Unable to store wrapping key: %s (%x)&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(translated),</div>
<div class="line"><span class="lineno"> 2448</span>            response.buf[0]);</div>
<div class="line"><span class="lineno"> 2449</span>    <span class="keywordflow">return</span> translated;</div>
<div class="line"><span class="lineno"> 2450</span>  }</div>
<div class="line"><span class="lineno"> 2451</span> </div>
<div class="line"><span class="lineno"> 2452</span>  *<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a> = ntohs(response.key_id);</div>
<div class="line"><span class="lineno"> 2453</span>  <a class="code hl_define" href="debug__lib_8h.html#a8c4742440a149ad8bcb5d58ae76c5ed3">DBG_INFO</a>(<span class="stringliteral">&quot;Imported Wrap key 0x%04x&quot;</span>, *<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>);</div>
<div class="line"><span class="lineno"> 2454</span> </div>
<div class="line"><span class="lineno"> 2455</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 2456</span>}</div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caa927e2246e5657f946b4da4b71092b022"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa927e2246e5657f946b4da4b71092b022">YH_ALGO_AES256_CCM_WRAP</a></div><div class="ttdeci">@ YH_ALGO_AES256_CCM_WRAP</div><div class="ttdoc">aes256-ccm-wrap</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00474">yubihsm.h:474</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caab739a1d142dacaf37ba13a73e2d83fab"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caab739a1d142dacaf37ba13a73e2d83fab">YH_ALGO_AES192_CCM_WRAP</a></div><div class="ttdeci">@ YH_ALGO_AES192_CCM_WRAP</div><div class="ttdoc">aes192-ccm-wrap</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00472">yubihsm.h:472</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caae22b228e457c9bdccb5a93d81730b1b1"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caae22b228e457c9bdccb5a93d81730b1b1">YH_ALGO_AES128_CCM_WRAP</a></div><div class="ttdeci">@ YH_ALGO_AES128_CCM_WRAP</div><div class="ttdoc">aes128-ccm-wrap</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00448">yubihsm.h:448</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a3a9729ea5b2e299a735b43f2b23e50a7_cgraph.png" border="0" usemap="#ayubihsm_8c_a3a9729ea5b2e299a735b43f2b23e50a7_cgraph" alt=""/></div>
<map name="ayubihsm_8c_a3a9729ea5b2e299a735b43f2b23e50a7_cgraph" id="ayubihsm_8c_a3a9729ea5b2e299a735b43f2b23e50a7_cgraph">
<area shape="rect" title=" " alt="" coords="5,129,171,155"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="644,5,716,31"/>
<area shape="poly" title=" " alt="" coords="119,126,218,89,315,60,415,40,529,25,629,18,629,23,530,30,415,45,316,65,220,94,121,131"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="646,179,714,204"/>
<area shape="poly" title=" " alt="" coords="171,151,219,157,450,176,631,187,631,192,449,181,218,162,171,157"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="219,104,367,130"/>
<area shape="poly" title=" " alt="" coords="171,129,203,125,203,131,171,135"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="638,104,722,130"/>
<area shape="poly" title=" " alt="" coords="171,146,359,152,470,149,580,140,623,131,624,136,581,145,470,154,359,157,171,151"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="415,104,580,130"/>
<area shape="poly" title=" " alt="" coords="367,114,399,114,399,120,367,120"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="432,55,563,80"/>
<area shape="poly" title=" " alt="" coords="349,101,426,82,427,87,350,106"/>
<area shape="poly" title=" " alt="" coords="557,101,579,91,594,79,603,67,612,54,627,40,632,37,635,41,630,44,616,57,607,70,597,83,582,95,559,106"/>
<area shape="poly" title=" " alt="" coords="532,128,633,170,631,175,530,133"/>
<area shape="poly" title=" " alt="" coords="581,114,623,114,623,120,581,120"/>
<area shape="poly" title=" " alt="" coords="547,51,629,29,630,34,549,57"/>
<area shape="poly" title=" " alt="" coords="549,78,624,99,623,104,547,84"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="628,55,732,80"/>
<area shape="poly" title=" " alt="" coords="563,65,613,65,613,70,563,70"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a3a9729ea5b2e299a735b43f2b23e50a7_icgraph.png" border="0" usemap="#ayubihsm_8c_a3a9729ea5b2e299a735b43f2b23e50a7_icgraph" alt=""/></div>
<map name="ayubihsm_8c_a3a9729ea5b2e299a735b43f2b23e50a7_icgraph" id="ayubihsm_8c_a3a9729ea5b2e299a735b43f2b23e50a7_icgraph">
<area shape="rect" title=" " alt="" coords="492,31,658,56"/>
<area shape="rect" href="commands_8c.html#ab2eb73abfe6f6d5a7f17752b3cab227a" title=" " alt="" coords="296,31,444,56"/>
<area shape="poly" title=" " alt="" coords="477,46,445,46,445,41,477,41"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="280,35,248,30,249,25,281,29"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,31,55,56"/>
<area shape="poly" title=" " alt="" coords="280,46,55,46,55,41,280,41"/>
<area shape="poly" title=" " alt="" coords="88,36,55,42,54,37,87,31"/>
</map>
</div>

</div>
</div>
<a id="ae5bf13f9558bb0340468b722accf94d3" name="ae5bf13f9558bb0340468b722accf94d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5bf13f9558bb0340468b722accf94d3">&#9670;&#160;</a></span>yh_util_import_wrapped()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_util_import_wrapped </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__session.html">yh_session</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a></td>          <td class="paramname"><span class="paramname"><em>wrapping_key_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>in</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>in_len</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583">yh_object_type</a> *</td>          <td class="paramname"><span class="paramname"><em>target_type</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *</td>          <td class="paramname"><span class="paramname"><em>target_id</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Import a wrapped object into the device. The object should have been previously exported by <a class="el" href="yubihsm_8h.html#aa3f473e6dbb9188ad0269b40921c4f5f">yh_util_export_wrapped()</a></p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>Authenticated session to use </td></tr>
    <tr><td class="paramname">wrapping_key_id</td><td>Object ID of the Wrap Key to use to unwrap the object </td></tr>
    <tr><td class="paramname">in</td><td>Wrapped data </td></tr>
    <tr><td class="paramname">in_len</td><td>Length of wrapped data </td></tr>
    <tr><td class="paramname">target_type</td><td>Type of the imported object </td></tr>
    <tr><td class="paramname">target_id</td><td>Object ID of the imported object</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> if input parameters are NULL. See <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> for other possible errors </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l02309">2309</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2311</span>                                                                               {</div>
<div class="line"><span class="lineno"> 2312</span> </div>
<div class="line"><span class="lineno"> 2313</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a> == NULL || in == NULL || <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a16deaf35253f2106ecf4fd8003b1284f">target_type</a> == NULL ||</div>
<div class="line"><span class="lineno"> 2314</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ad82e96deab6d88b5e26f9f11da9d3fa3">target_id</a> == NULL) {</div>
<div class="line"><span class="lineno"> 2315</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>));</div>
<div class="line"><span class="lineno"> 2316</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 2317</span>  }</div>
<div class="line"><span class="lineno"> 2318</span> </div>
<div class="line"><span class="lineno"> 2319</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a> &gt; <a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a> - 2) {</div>
<div class="line"><span class="lineno"> 2320</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Too much data, must be &lt; %d&quot;</span>, <a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a> - 2);</div>
<div class="line"><span class="lineno"> 2321</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 2322</span>  }</div>
<div class="line"><span class="lineno"> 2323</span> </div>
<div class="line"><span class="lineno"> 2324</span><span class="preprocessor">#pragma pack(push, 1)</span></div>
<div class="line"><span class="lineno"> 2325</span>  <span class="keyword">union </span>{</div>
<div class="line"><span class="lineno"> 2326</span>    <span class="keyword">struct </span>{</div>
<div class="line"><span class="lineno"> 2327</span>      <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>;</div>
<div class="line"><span class="lineno"> 2328</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#ac6f5a1f1e061f000983f5d5f3ac25dfa">bytes</a>[<a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a> - 2];</div>
<div class="line"><span class="lineno"> 2329</span>    };</div>
<div class="line"><span class="lineno"> 2330</span>    <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a855e99b645b13e7905d074d02fe0bff5">buf</a>[1];</div>
<div class="line"><span class="lineno"> 2331</span>  } data;</div>
<div class="line"><span class="lineno"> 2332</span><span class="preprocessor">#pragma pack(pop)</span></div>
<div class="line"><span class="lineno"> 2333</span>  <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> data_len = 2 + <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a>;</div>
<div class="line"><span class="lineno"> 2334</span> </div>
<div class="line"><span class="lineno"> 2335</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> response[<a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a>];</div>
<div class="line"><span class="lineno"> 2336</span>  <span class="keywordtype">size_t</span> response_len = <span class="keyword">sizeof</span>(response);</div>
<div class="line"><span class="lineno"> 2337</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7e">yh_cmd</a> response_cmd;</div>
<div class="line"><span class="lineno"> 2338</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 2339</span> </div>
<div class="line"><span class="lineno"> 2340</span>  data.key_id = htons(wrapping_key_id);</div>
<div class="line"><span class="lineno"> 2341</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(data.bytes, in, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a>);</div>
<div class="line"><span class="lineno"> 2342</span> </div>
<div class="line"><span class="lineno"> 2343</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="#a4c26f003b72e800e9c934bca922a404a">yh_send_secure_msg</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, YHC_IMPORT_WRAPPED, data.buf, data_len,</div>
<div class="line"><span class="lineno"> 2344</span>                           &amp;response_cmd, response, &amp;response_len);</div>
<div class="line"><span class="lineno"> 2345</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 2346</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Failed to send IMPORT WRAPPED command: %s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 2347</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 2348</span>  }</div>
<div class="line"><span class="lineno"> 2349</span> </div>
<div class="line"><span class="lineno"> 2350</span>  <span class="keywordflow">if</span> (response_cmd == <a class="code hl_enumvalue" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7ea51cdf2ccd6995498e589e8ea6ce2a1f2">YHC_ERROR</a>) {</div>
<div class="line"><span class="lineno"> 2351</span>    <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> translated = translate_device_error(response[0]);</div>
<div class="line"><span class="lineno"> 2352</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Unable to get data: %s (%x)&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(translated),</div>
<div class="line"><span class="lineno"> 2353</span>            response[0]);</div>
<div class="line"><span class="lineno"> 2354</span>    <span class="keywordflow">return</span> translated;</div>
<div class="line"><span class="lineno"> 2355</span>  }</div>
<div class="line"><span class="lineno"> 2356</span> </div>
<div class="line"><span class="lineno"> 2357</span>  *<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a16deaf35253f2106ecf4fd8003b1284f">target_type</a> = response[0];</div>
<div class="line"><span class="lineno"> 2358</span>  *<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ad82e96deab6d88b5e26f9f11da9d3fa3">target_id</a> = ntohs(*((<a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *) (response + 1)));</div>
<div class="line"><span class="lineno"> 2359</span> </div>
<div class="line"><span class="lineno"> 2360</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 2361</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_ae5bf13f9558bb0340468b722accf94d3_cgraph.png" border="0" usemap="#ayubihsm_8c_ae5bf13f9558bb0340468b722accf94d3_cgraph" alt=""/></div>
<map name="ayubihsm_8c_ae5bf13f9558bb0340468b722accf94d3_cgraph" id="ayubihsm_8c_ae5bf13f9558bb0340468b722accf94d3_cgraph">
<area shape="rect" title=" " alt="" coords="5,80,164,106"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="637,5,709,31"/>
<area shape="poly" title=" " alt="" coords="148,77,211,65,440,35,621,19,622,24,441,40,212,70,149,82"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="212,80,360,106"/>
<area shape="poly" title=" " alt="" coords="164,90,196,90,196,96,164,96"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="631,104,715,130"/>
<area shape="poly" title=" " alt="" coords="148,104,212,116,313,133,392,145,472,148,573,140,616,131,617,136,574,145,472,153,392,150,312,138,211,121,147,109"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="408,55,573,80"/>
<area shape="poly" title=" " alt="" coords="360,81,392,77,393,82,360,86"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="426,104,556,130"/>
<area shape="poly" title=" " alt="" coords="360,99,411,105,410,110,360,104"/>
<area shape="poly" title=" " alt="" coords="540,51,622,29,623,34,542,57"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="639,55,707,80"/>
<area shape="poly" title=" " alt="" coords="574,65,623,65,623,70,574,70"/>
<area shape="poly" title=" " alt="" coords="542,78,617,99,616,104,540,84"/>
<area shape="poly" title=" " alt="" coords="550,101,572,91,587,79,596,67,605,54,620,40,625,37,628,41,623,44,609,57,600,70,590,83,575,95,552,106"/>
<area shape="poly" title=" " alt="" coords="556,114,616,114,616,120,556,120"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="621,153,725,179"/>
<area shape="poly" title=" " alt="" coords="542,128,609,146,607,151,540,133"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_ae5bf13f9558bb0340468b722accf94d3_icgraph.png" border="0" usemap="#ayubihsm_8c_ae5bf13f9558bb0340468b722accf94d3_icgraph" alt=""/></div>
<map name="ayubihsm_8c_ae5bf13f9558bb0340468b722accf94d3_icgraph" id="ayubihsm_8c_ae5bf13f9558bb0340468b722accf94d3_icgraph">
<area shape="rect" title=" " alt="" coords="492,31,651,56"/>
<area shape="rect" href="wrap_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="346,5,395,31"/>
<area shape="poly" title=" " alt="" coords="477,34,395,24,396,19,477,29"/>
<area shape="rect" href="commands_8c.html#a6b74f2d2d47796c2432a15cd63183dd1" title=" " alt="" coords="296,55,444,80"/>
<area shape="poly" title=" " alt="" coords="477,57,445,61,444,56,477,52"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,29,248,55"/>
<area shape="poly" title=" " alt="" coords="280,59,248,54,249,49,281,53"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,55,55,80"/>
<area shape="poly" title=" " alt="" coords="280,70,55,70,55,65,280,65"/>
<area shape="poly" title=" " alt="" coords="88,60,55,66,54,61,87,55"/>
</map>
</div>

</div>
</div>
<a id="a7cbea7103efff8473ccfaaa35bfc6346" name="a7cbea7103efff8473ccfaaa35bfc6346"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7cbea7103efff8473ccfaaa35bfc6346">&#9670;&#160;</a></span>yh_util_list_objects()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_util_list_objects </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__session.html">yh_session</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a></td>          <td class="paramname"><span class="paramname"><em>id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583">yh_object_type</a></td>          <td class="paramname"><span class="paramname"><em>type</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a></td>          <td class="paramname"><span class="paramname"><em>domains</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structyh__capabilities.html">yh_capabilities</a> *</td>          <td class="paramname"><span class="paramname"><em>capabilities</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55ca">yh_algorithm</a></td>          <td class="paramname"><span class="paramname"><em>algorithm</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>label</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structyh__object__descriptor.html">yh_object_descriptor</a> *</td>          <td class="paramname"><span class="paramname"><em>objects</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *</td>          <td class="paramname"><span class="paramname"><em>n_objects</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p><a class="el" href="struct_list.html">List</a> objects accessible from the session</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>Authenticated session to use </td></tr>
    <tr><td class="paramname">id</td><td>Object ID to filter by (0 to not filter by ID) </td></tr>
    <tr><td class="paramname">type</td><td>Object type to filter by (0 to not filter by type). See <a class="el" href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583">yh_object_type</a> </td></tr>
    <tr><td class="paramname">domains</td><td>Domains to filter by (0 to not filter by domain) </td></tr>
    <tr><td class="paramname">capabilities</td><td>Capabilities to filter by (0 to not filter by capabilities). See <a class="el" href="structyh__capabilities.html" title="Capabilities representation.">yh_capabilities</a> </td></tr>
    <tr><td class="paramname">algorithm</td><td>Algorithm to filter by (0 to not filter by algorithm) </td></tr>
    <tr><td class="paramname">label</td><td>Label to filter by </td></tr>
    <tr><td class="paramname">objects</td><td>Array of objects returned </td></tr>
    <tr><td class="paramname">n_objects</td><td>Max number of objects (will be set to number found on return)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> if input parameters are NULL. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366ad8971a0b9647564b76b3f4e4b662c965" title="Returned value when there is not enough space to store data.">YHR_BUFFER_TOO_SMALL</a> if n_objects is smaller than the number of objects found. See <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> for other possible errors.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a href="https://developers.yubico.com/YubiHSM2/Concepts/Object.html">Objects</a>, <a href="https://developers.yubico.com/YubiHSM2/Concepts/Domain.html">Domains</a>, <a href="https://developers.yubico.com/YubiHSM2/Concepts/Capability.html">Capabilities</a>, <a href="https://developers.yubico.com/YubiHSM2/Concepts/Algorithms.html">Algorithms</a>, <a href="https://developers.yubico.com/YubiHSM2/Concepts/Label.html">Labels</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l01030">1030</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1034</span>                                                                             {</div>
<div class="line"><span class="lineno"> 1035</span> </div>
<div class="line"><span class="lineno"> 1036</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a> == NULL || objects == NULL || <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a351300ca15aa70c149f1301f89bcbe9b">n_objects</a> == NULL ||</div>
<div class="line"><span class="lineno"> 1037</span>      (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> != NULL &amp;&amp; strlen(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>) &gt; <a class="code hl_define" href="yubihsm_8h.html#a431f8b753552a8b2f5f980e871b6d019">YH_OBJ_LABEL_LEN</a>)) {</div>
<div class="line"><span class="lineno"> 1038</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>));</div>
<div class="line"><span class="lineno"> 1039</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 1040</span>  }</div>
<div class="line"><span class="lineno"> 1041</span> </div>
<div class="line"><span class="lineno"> 1042</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> data[<a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a>];</div>
<div class="line"><span class="lineno"> 1043</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *dataptr = data;</div>
<div class="line"><span class="lineno"> 1044</span> </div>
<div class="line"><span class="lineno"> 1045</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> response[<a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a>];</div>
<div class="line"><span class="lineno"> 1046</span>  <span class="keywordtype">size_t</span> response_len = <span class="keyword">sizeof</span>(response);</div>
<div class="line"><span class="lineno"> 1047</span> </div>
<div class="line"><span class="lineno"> 1048</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 1049</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7e">yh_cmd</a> response_cmd;</div>
<div class="line"><span class="lineno"> 1050</span> </div>
<div class="line"><span class="lineno"> 1051</span>  <span class="keywordflow">if</span> (<span class="keywordtype">id</span>) {</div>
<div class="line"><span class="lineno"> 1052</span>    *dataptr++ = <a class="code hl_define" href="#a0b9ea5683398966b2db794d1a5a78005">LIST_ID</a>;</div>
<div class="line"><span class="lineno"> 1053</span>    *dataptr++ = <span class="keywordtype">id</span> &gt;&gt; 8 &amp; 0xff;</div>
<div class="line"><span class="lineno"> 1054</span>    *dataptr++ = <span class="keywordtype">id</span> &amp; 0xff;</div>
<div class="line"><span class="lineno"> 1055</span>  }</div>
<div class="line"><span class="lineno"> 1056</span> </div>
<div class="line"><span class="lineno"> 1057</span>  <span class="keywordflow">if</span> (type) {</div>
<div class="line"><span class="lineno"> 1058</span>    *dataptr++ = <a class="code hl_define" href="#aa606355c30aa4b5f0ad83d25ed069b25">LIST_TYPE</a>;</div>
<div class="line"><span class="lineno"> 1059</span>    *dataptr++ = <a class="code hl_variable" href="yubihsm_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a>;</div>
<div class="line"><span class="lineno"> 1060</span>  }</div>
<div class="line"><span class="lineno"> 1061</span> </div>
<div class="line"><span class="lineno"> 1062</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a5420fd4d2f76428942c2716b1cb7e863">domains</a>) {</div>
<div class="line"><span class="lineno"> 1063</span>    *dataptr++ = <a class="code hl_define" href="#a2eea78213279842d562d311a118c4e64">LIST_DOMAINS</a>;</div>
<div class="line"><span class="lineno"> 1064</span>    *dataptr++ = <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a5420fd4d2f76428942c2716b1cb7e863">domains</a> &gt;&gt; 8 &amp; 0xff;</div>
<div class="line"><span class="lineno"> 1065</span>    *dataptr++ = <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a5420fd4d2f76428942c2716b1cb7e863">domains</a> &amp; 0xff;</div>
<div class="line"><span class="lineno"> 1066</span>  }</div>
<div class="line"><span class="lineno"> 1067</span> </div>
<div class="line"><span class="lineno"> 1068</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>) {</div>
<div class="line"><span class="lineno"> 1069</span>    *dataptr++ = <a class="code hl_define" href="#a4144e686fa1e1d546a89875fb152ed4b">LIST_ALGORITHM</a>;</div>
<div class="line"><span class="lineno"> 1070</span>    *dataptr++ = <a class="code hl_variable" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>;</div>
<div class="line"><span class="lineno"> 1071</span>  }</div>
<div class="line"><span class="lineno"> 1072</span> </div>
<div class="line"><span class="lineno"> 1073</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> &amp;&amp; strlen(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>)) {</div>
<div class="line"><span class="lineno"> 1074</span>    *dataptr++ = <a class="code hl_define" href="#a0b34189280c5fe21d735f5bd67ce2c1e">LIST_LABEL</a>;</div>
<div class="line"><span class="lineno"> 1075</span>    <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(dataptr, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>, strlen(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>));</div>
<div class="line"><span class="lineno"> 1076</span>    <a class="code hl_function" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105">memset</a>(dataptr + strlen(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>), 0, <a class="code hl_define" href="yubihsm_8h.html#a431f8b753552a8b2f5f980e871b6d019">YH_OBJ_LABEL_LEN</a> - strlen(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>));</div>
<div class="line"><span class="lineno"> 1077</span>    dataptr += <a class="code hl_define" href="yubihsm_8h.html#a431f8b753552a8b2f5f980e871b6d019">YH_OBJ_LABEL_LEN</a>;</div>
<div class="line"><span class="lineno"> 1078</span>  }</div>
<div class="line"><span class="lineno"> 1079</span> </div>
<div class="line"><span class="lineno"> 1080</span>  <span class="keywordtype">bool</span> send_capabilities = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1081</span>  <span class="keywordflow">for</span> (<a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> i = 0; i &lt; <a class="code hl_define" href="yubihsm_8h.html#ad3c904849d17cae0a6f426e8007731d7">YH_CAPABILITIES_LEN</a>; i++) {</div>
<div class="line"><span class="lineno"> 1082</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>-&gt;<a class="code hl_variable" href="structyh__capabilities.html#a5398bad7e61385aa127265ba0a053079">capabilities</a>[i]) {</div>
<div class="line"><span class="lineno"> 1083</span>      send_capabilities = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1084</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1085</span>    }</div>
<div class="line"><span class="lineno"> 1086</span>  }</div>
<div class="line"><span class="lineno"> 1087</span> </div>
<div class="line"><span class="lineno"> 1088</span>  <span class="keywordflow">if</span> (send_capabilities == <span class="keyword">true</span>) {</div>
<div class="line"><span class="lineno"> 1089</span>    *dataptr++ = <a class="code hl_define" href="#ad2887e3e4dd005035b369ba8a9ec94b7">LIST_CAPABILITIES</a>;</div>
<div class="line"><span class="lineno"> 1090</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> i = 0; i &lt; <a class="code hl_define" href="yubihsm_8h.html#ad3c904849d17cae0a6f426e8007731d7">YH_CAPABILITIES_LEN</a>; i++) {</div>
<div class="line"><span class="lineno"> 1091</span>      *dataptr++ = <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>-&gt;<a class="code hl_variable" href="structyh__capabilities.html#a5398bad7e61385aa127265ba0a053079">capabilities</a>[i];</div>
<div class="line"><span class="lineno"> 1092</span>    }</div>
<div class="line"><span class="lineno"> 1093</span>  }</div>
<div class="line"><span class="lineno"> 1094</span> </div>
<div class="line"><span class="lineno"> 1095</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="#a4c26f003b72e800e9c934bca922a404a">yh_send_secure_msg</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, YHC_LIST_OBJECTS, data, dataptr - data,</div>
<div class="line"><span class="lineno"> 1096</span>                           &amp;response_cmd, response, &amp;response_len);</div>
<div class="line"><span class="lineno"> 1097</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 1098</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Failed to send LIST OBJECTS command: %s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 1099</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 1100</span>  }</div>
<div class="line"><span class="lineno"> 1101</span> </div>
<div class="line"><span class="lineno"> 1102</span>  <span class="keywordflow">if</span> (response_cmd == <a class="code hl_enumvalue" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7ea51cdf2ccd6995498e589e8ea6ce2a1f2">YHC_ERROR</a>) {</div>
<div class="line"><span class="lineno"> 1103</span>    <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> translated = translate_device_error(response[0]);</div>
<div class="line"><span class="lineno"> 1104</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Unable to list objects: %s (%x)&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(translated),</div>
<div class="line"><span class="lineno"> 1105</span>            response[0]);</div>
<div class="line"><span class="lineno"> 1106</span>    <span class="keywordflow">return</span> translated;</div>
<div class="line"><span class="lineno"> 1107</span>  }</div>
<div class="line"><span class="lineno"> 1108</span> </div>
<div class="line"><span class="lineno"> 1109</span>  <span class="keywordflow">if</span> ((response_len / 4) &gt; *<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a351300ca15aa70c149f1301f89bcbe9b">n_objects</a>) {</div>
<div class="line"><span class="lineno"> 1110</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Objects buffer too small&quot;</span>);</div>
<div class="line"><span class="lineno"> 1111</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366ad8971a0b9647564b76b3f4e4b662c965">YHR_BUFFER_TOO_SMALL</a>;</div>
<div class="line"><span class="lineno"> 1112</span>  }</div>
<div class="line"><span class="lineno"> 1113</span> </div>
<div class="line"><span class="lineno"> 1114</span>  *<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a351300ca15aa70c149f1301f89bcbe9b">n_objects</a> = response_len / 4;</div>
<div class="line"><span class="lineno"> 1115</span>  <span class="keywordflow">for</span> (<a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> i = 0; i &lt; response_len; i += 4) {</div>
<div class="line"><span class="lineno"> 1116</span>    <span class="comment">// NOTE: clear the fields that we didn&#39;t set</span></div>
<div class="line"><span class="lineno"> 1117</span>    <a class="code hl_function" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105">memset</a>(&amp;objects[i / 4], 0, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structyh__object__descriptor.html">yh_object_descriptor</a>));</div>
<div class="line"><span class="lineno"> 1118</span>    objects[i / 4].<a class="code hl_variable" href="structyh__object__descriptor.html#a8683d3f22f1e8ba56e3caea8ed8504ec">id</a> = ntohs(*((<a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *) (response + i)));</div>
<div class="line"><span class="lineno"> 1119</span>    objects[i / 4].<a class="code hl_variable" href="structyh__object__descriptor.html#ab8c1b3cc5b859e3c89eb228fa0763165">type</a> = response[i + 2];</div>
<div class="line"><span class="lineno"> 1120</span>    objects[i / 4].<a class="code hl_variable" href="structyh__object__descriptor.html#a84e5c94f9a0a39eb7ed39444c48ab4b5">sequence</a> = response[i + 3];</div>
<div class="line"><span class="lineno"> 1121</span>  }</div>
<div class="line"><span class="lineno"> 1122</span> </div>
<div class="line"><span class="lineno"> 1123</span>  <a class="code hl_define" href="debug__lib_8h.html#a8c4742440a149ad8bcb5d58ae76c5ed3">DBG_INFO</a>(<span class="stringliteral">&quot;Found %zu objects&quot;</span>, *<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a351300ca15aa70c149f1301f89bcbe9b">n_objects</a>);</div>
<div class="line"><span class="lineno"> 1124</span> </div>
<div class="line"><span class="lineno"> 1125</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 1126</span>}</div>
<div class="ttc" id="astructyh__object__descriptor_html_a84e5c94f9a0a39eb7ed39444c48ab4b5"><div class="ttname"><a href="structyh__object__descriptor.html#a84e5c94f9a0a39eb7ed39444c48ab4b5">yh_object_descriptor::sequence</a></div><div class="ttdeci">uint8_t sequence</div><div class="ttdoc">Object sequence.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00554">yubihsm.h:554</a></div></div>
<div class="ttc" id="astructyh__object__descriptor_html_a8683d3f22f1e8ba56e3caea8ed8504ec"><div class="ttname"><a href="structyh__object__descriptor.html#a8683d3f22f1e8ba56e3caea8ed8504ec">yh_object_descriptor::id</a></div><div class="ttdeci">uint16_t id</div><div class="ttdoc">Object ID.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00544">yubihsm.h:544</a></div></div>
<div class="ttc" id="astructyh__object__descriptor_html_ab8c1b3cc5b859e3c89eb228fa0763165"><div class="ttname"><a href="structyh__object__descriptor.html#ab8c1b3cc5b859e3c89eb228fa0763165">yh_object_descriptor::type</a></div><div class="ttdeci">yh_object_type type</div><div class="ttdoc">Object type.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00550">yubihsm.h:550</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_a0b34189280c5fe21d735f5bd67ce2c1e"><div class="ttname"><a href="#a0b34189280c5fe21d735f5bd67ce2c1e">LIST_LABEL</a></div><div class="ttdeci">#define LIST_LABEL</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l01028">yubihsm.c:1028</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_a0b9ea5683398966b2db794d1a5a78005"><div class="ttname"><a href="#a0b9ea5683398966b2db794d1a5a78005">LIST_ID</a></div><div class="ttdeci">#define LIST_ID</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l01023">yubihsm.c:1023</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_a2eea78213279842d562d311a118c4e64"><div class="ttname"><a href="#a2eea78213279842d562d311a118c4e64">LIST_DOMAINS</a></div><div class="ttdeci">#define LIST_DOMAINS</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l01025">yubihsm.c:1025</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_a4144e686fa1e1d546a89875fb152ed4b"><div class="ttname"><a href="#a4144e686fa1e1d546a89875fb152ed4b">LIST_ALGORITHM</a></div><div class="ttdeci">#define LIST_ALGORITHM</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l01027">yubihsm.c:1027</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_aa606355c30aa4b5f0ad83d25ed069b25"><div class="ttname"><a href="#aa606355c30aa4b5f0ad83d25ed069b25">LIST_TYPE</a></div><div class="ttdeci">#define LIST_TYPE</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l01024">yubihsm.c:1024</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_ad2887e3e4dd005035b369ba8a9ec94b7"><div class="ttname"><a href="#ad2887e3e4dd005035b369ba8a9ec94b7">LIST_CAPABILITIES</a></div><div class="ttdeci">#define LIST_CAPABILITIES</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l01026">yubihsm.c:1026</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a351300ca15aa70c149f1301f89bcbe9b"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a351300ca15aa70c149f1301f89bcbe9b">n_objects</a></div><div class="ttdeci">session operation op find n_objects</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l01909">yubihsm_pkcs11.c:1909</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a7cbea7103efff8473ccfaaa35bfc6346_cgraph.png" border="0" usemap="#ayubihsm_8c_a7cbea7103efff8473ccfaaa35bfc6346_cgraph" alt=""/></div>
<map name="ayubihsm_8c_a7cbea7103efff8473ccfaaa35bfc6346_cgraph" id="ayubihsm_8c_a7cbea7103efff8473ccfaaa35bfc6346_cgraph">
<area shape="rect" title=" " alt="" coords="5,129,138,155"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="611,5,683,31"/>
<area shape="poly" title=" " alt="" coords="98,126,185,89,282,59,382,40,496,25,596,18,596,23,497,30,382,45,283,64,187,94,100,131"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="613,179,681,204"/>
<area shape="poly" title=" " alt="" coords="138,150,186,157,417,177,598,187,598,192,416,182,185,162,137,156"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="186,104,334,130"/>
<area shape="poly" title=" " alt="" coords="138,131,170,126,171,132,139,136"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="605,104,689,130"/>
<area shape="poly" title=" " alt="" coords="138,145,323,151,435,149,547,140,590,131,591,136,548,145,435,154,323,157,138,150"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="382,104,547,130"/>
<area shape="poly" title=" " alt="" coords="334,114,366,114,366,120,334,120"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="400,55,530,80"/>
<area shape="poly" title=" " alt="" coords="316,101,393,82,394,87,317,106"/>
<area shape="poly" title=" " alt="" coords="524,101,546,91,561,79,570,67,579,54,594,40,599,37,602,41,597,44,583,57,574,70,564,83,549,95,526,106"/>
<area shape="poly" title=" " alt="" coords="499,128,600,170,598,175,497,133"/>
<area shape="poly" title=" " alt="" coords="548,114,590,114,590,120,548,120"/>
<area shape="poly" title=" " alt="" coords="514,51,596,29,597,34,516,57"/>
<area shape="poly" title=" " alt="" coords="516,78,591,99,590,104,514,84"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="595,55,699,80"/>
<area shape="poly" title=" " alt="" coords="530,65,580,65,580,70,530,70"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a7cbea7103efff8473ccfaaa35bfc6346_icgraph.png" border="0" usemap="#ayubihsm_8c_a7cbea7103efff8473ccfaaa35bfc6346_icgraph" alt=""/></div>
<map name="ayubihsm_8c_a7cbea7103efff8473ccfaaa35bfc6346_icgraph" id="ayubihsm_8c_a7cbea7103efff8473ccfaaa35bfc6346_icgraph">
<area shape="rect" title=" " alt="" coords="494,71,627,96"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#acc47a5da9d35def289bc163ab2e4bf30" title=" " alt="" coords="352,5,390,31"/>
<area shape="poly" title=" " alt="" coords="507,68,445,46,390,27,392,22,447,41,508,63"/>
<area shape="rect" href="structsysio_1_1wallet_1_1detail_1_1yubihsm__wallet__impl.html#a00ee0ac7ac4a819d0b8755bf4f442263" title=" " alt="" coords="296,56,446,111"/>
<area shape="poly" title=" " alt="" coords="479,86,446,86,446,81,479,81"/>
<area shape="rect" href="commands_8c.html#a2b752129687a9ca758661e0b6625b59c" title=" " alt="" coords="301,136,441,162"/>
<area shape="poly" title=" " alt="" coords="508,104,447,126,413,138,411,133,445,121,507,99"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,111,248,136"/>
<area shape="poly" title=" " alt="" coords="285,140,248,136,249,130,286,135"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,136,55,162"/>
<area shape="poly" title=" " alt="" coords="285,152,55,152,55,146,285,146"/>
<area shape="poly" title=" " alt="" coords="88,141,55,147,54,142,87,136"/>
</map>
</div>

</div>
</div>
<a id="a4bb1d420f681bc91bd36dc08695dbad6" name="a4bb1d420f681bc91bd36dc08695dbad6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4bb1d420f681bc91bd36dc08695dbad6">&#9670;&#160;</a></span>yh_util_randomize_otp_aead()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_util_randomize_otp_aead </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__session.html">yh_session</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a></td>          <td class="paramname"><span class="paramname"><em>key_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>out</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *</td>          <td class="paramname"><span class="paramname"><em>out_len</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create OTP AEAD from random data</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>Authenticated session to use </td></tr>
    <tr><td class="paramname">key_id</td><td>Object ID of the Otp-aead Key to use </td></tr>
    <tr><td class="paramname">out</td><td>The created AEAD </td></tr>
    <tr><td class="paramname">out_len</td><td>Length of the created AEAD</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> if input parameters are NULL. See <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> for other possible errors </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l03223">3223</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3224</span>                                                                {</div>
<div class="line"><span class="lineno"> 3225</span> </div>
<div class="line"><span class="lineno"> 3226</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a> == NULL || out == NULL || <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a565e4b6f63fecad4c290b50ee6684ee3">out_len</a> == NULL) {</div>
<div class="line"><span class="lineno"> 3227</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>));</div>
<div class="line"><span class="lineno"> 3228</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 3229</span>  }</div>
<div class="line"><span class="lineno"> 3230</span><span class="preprocessor">#pragma pack(push, 1)</span></div>
<div class="line"><span class="lineno"> 3231</span>  <span class="keyword">union </span>{</div>
<div class="line"><span class="lineno"> 3232</span>    <span class="keyword">struct </span>{</div>
<div class="line"><span class="lineno"> 3233</span>      <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>;</div>
<div class="line"><span class="lineno"> 3234</span>    };</div>
<div class="line"><span class="lineno"> 3235</span>    <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a855e99b645b13e7905d074d02fe0bff5">buf</a>[1];</div>
<div class="line"><span class="lineno"> 3236</span>  } data;</div>
<div class="line"><span class="lineno"> 3237</span><span class="preprocessor">#pragma pack(pop)</span></div>
<div class="line"><span class="lineno"> 3238</span> </div>
<div class="line"><span class="lineno"> 3239</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7e">yh_cmd</a> response_cmd;</div>
<div class="line"><span class="lineno"> 3240</span> </div>
<div class="line"><span class="lineno"> 3241</span>  data.key_id = htons(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>);</div>
<div class="line"><span class="lineno"> 3242</span> </div>
<div class="line"><span class="lineno"> 3243</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="#a4c26f003b72e800e9c934bca922a404a">yh_send_secure_msg</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, YHC_RANDOMIZE_OTP_AEAD, data.buf,</div>
<div class="line"><span class="lineno"> 3244</span>                                 <span class="keyword">sizeof</span>(data), &amp;response_cmd, out, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a565e4b6f63fecad4c290b50ee6684ee3">out_len</a>);</div>
<div class="line"><span class="lineno"> 3245</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 3246</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Failed to send RANDOMIZE OTP AEAD command: %s\n&quot;</span>,</div>
<div class="line"><span class="lineno"> 3247</span>            <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 3248</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 3249</span>  }</div>
<div class="line"><span class="lineno"> 3250</span> </div>
<div class="line"><span class="lineno"> 3251</span>  <span class="keywordflow">if</span> (response_cmd == <a class="code hl_enumvalue" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7ea51cdf2ccd6995498e589e8ea6ce2a1f2">YHC_ERROR</a>) {</div>
<div class="line"><span class="lineno"> 3252</span>    <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> translated = translate_device_error(out[0]);</div>
<div class="line"><span class="lineno"> 3253</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Unable to get OTP AEAD: %s (%x)\n&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(translated),</div>
<div class="line"><span class="lineno"> 3254</span>            out[0]);</div>
<div class="line"><span class="lineno"> 3255</span>    <span class="keywordflow">return</span> translated;</div>
<div class="line"><span class="lineno"> 3256</span>  }</div>
<div class="line"><span class="lineno"> 3257</span> </div>
<div class="line"><span class="lineno"> 3258</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 3259</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a4bb1d420f681bc91bd36dc08695dbad6_cgraph.png" border="0" usemap="#ayubihsm_8c_a4bb1d420f681bc91bd36dc08695dbad6_cgraph" alt=""/></div>
<map name="ayubihsm_8c_a4bb1d420f681bc91bd36dc08695dbad6_cgraph" id="ayubihsm_8c_a4bb1d420f681bc91bd36dc08695dbad6_cgraph">
<area shape="rect" title=" " alt="" coords="5,129,192,155"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="240,104,388,130"/>
<area shape="poly" title=" " alt="" coords="192,129,224,125,225,130,192,134"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="659,153,743,179"/>
<area shape="poly" title=" " alt="" coords="192,143,644,161,644,167,192,149"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="436,55,601,80"/>
<area shape="poly" title=" " alt="" coords="370,101,447,82,448,87,371,106"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="454,104,584,130"/>
<area shape="poly" title=" " alt="" coords="388,114,438,114,438,120,388,120"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="665,55,737,80"/>
<area shape="poly" title=" " alt="" coords="602,65,650,65,650,70,602,70"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="667,5,735,31"/>
<area shape="poly" title=" " alt="" coords="568,51,651,29,653,34,570,57"/>
<area shape="poly" title=" " alt="" coords="580,79,603,89,618,102,628,114,637,127,651,140,656,143,653,148,648,144,633,131,624,118,615,106,600,94,578,83"/>
<area shape="poly" title=" " alt="" coords="568,101,650,78,651,84,570,106"/>
<area shape="poly" title=" " alt="" coords="570,128,645,148,644,154,568,133"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="649,104,753,130"/>
<area shape="poly" title=" " alt="" coords="584,114,634,114,634,120,584,120"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a4bb1d420f681bc91bd36dc08695dbad6_icgraph.png" border="0" usemap="#ayubihsm_8c_a4bb1d420f681bc91bd36dc08695dbad6_icgraph" alt=""/></div>
<map name="ayubihsm_8c_a4bb1d420f681bc91bd36dc08695dbad6_icgraph" id="ayubihsm_8c_a4bb1d420f681bc91bd36dc08695dbad6_icgraph">
<area shape="rect" title=" " alt="" coords="521,31,708,56"/>
<area shape="rect" href="yubico__otp_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="360,5,409,31"/>
<area shape="poly" title=" " alt="" coords="506,34,409,23,410,18,506,29"/>
<area shape="rect" href="commands_8c.html#a533707756dfe3a35c9aadf4d288b73d4" title=" " alt="" coords="296,55,473,80"/>
<area shape="poly" title=" " alt="" coords="506,57,474,61,474,56,505,52"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,29,248,55"/>
<area shape="poly" title=" " alt="" coords="280,58,248,54,249,48,281,52"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,55,55,80"/>
<area shape="poly" title=" " alt="" coords="280,70,55,70,55,65,280,65"/>
<area shape="poly" title=" " alt="" coords="88,60,55,66,54,61,87,55"/>
</map>
</div>

</div>
</div>
<a id="a5c153fe27877bcc7927d391fb55550af" name="a5c153fe27877bcc7927d391fb55550af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c153fe27877bcc7927d391fb55550af">&#9670;&#160;</a></span>yh_util_reset_device()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_util_reset_device </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__session.html">yh_session</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Factory reset the device. Resets and reboots the device, deletes all Objects and restores the default <a class="el" href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583acee44b775b3c5b6157f0732699935074" title="Authentication Key is used to establish Sessions with a device.">YH_AUTHENTICATION_KEY</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>Authenticated session to use</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> if the session is NULL. See <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> for other possible errors </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l03796">3796</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3796</span>                                                {</div>
<div class="line"><span class="lineno"> 3797</span> </div>
<div class="line"><span class="lineno"> 3798</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a> == NULL) {</div>
<div class="line"><span class="lineno"> 3799</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>));</div>
<div class="line"><span class="lineno"> 3800</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 3801</span>  }</div>
<div class="line"><span class="lineno"> 3802</span> </div>
<div class="line"><span class="lineno"> 3803</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 3804</span> </div>
<div class="line"><span class="lineno"> 3805</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7e">yh_cmd</a> response_cmd;</div>
<div class="line"><span class="lineno"> 3806</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> response[1];</div>
<div class="line"><span class="lineno"> 3807</span>  <span class="keywordtype">size_t</span> response_len = <span class="keyword">sizeof</span>(response);</div>
<div class="line"><span class="lineno"> 3808</span> </div>
<div class="line"><span class="lineno"> 3809</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="#a4c26f003b72e800e9c934bca922a404a">yh_send_secure_msg</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, YHC_RESET_DEVICE, NULL, 0, &amp;response_cmd,</div>
<div class="line"><span class="lineno"> 3810</span>                           response, &amp;response_len);</div>
<div class="line"><span class="lineno"> 3811</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 3812</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Failed to send RESET DEVICE command: %s\n&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 3813</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 3814</span>  }</div>
<div class="line"><span class="lineno"> 3815</span> </div>
<div class="line"><span class="lineno"> 3816</span>  <span class="keywordflow">if</span> (response_cmd == <a class="code hl_enumvalue" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7ea51cdf2ccd6995498e589e8ea6ce2a1f2">YHC_ERROR</a>) {</div>
<div class="line"><span class="lineno"> 3817</span>    <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> translated = translate_device_error(response[0]);</div>
<div class="line"><span class="lineno"> 3818</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Unable to reset: %s (%x)\n&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(translated), response[0]);</div>
<div class="line"><span class="lineno"> 3819</span>    <span class="keywordflow">return</span> translated;</div>
<div class="line"><span class="lineno"> 3820</span>  }</div>
<div class="line"><span class="lineno"> 3821</span> </div>
<div class="line"><span class="lineno"> 3822</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 3823</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a5c153fe27877bcc7927d391fb55550af_cgraph.png" border="0" usemap="#ayubihsm_8c_a5c153fe27877bcc7927d391fb55550af_cgraph" alt=""/></div>
<map name="ayubihsm_8c_a5c153fe27877bcc7927d391fb55550af_cgraph" id="ayubihsm_8c_a5c153fe27877bcc7927d391fb55550af_cgraph">
<area shape="rect" title=" " alt="" coords="5,129,146,155"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="194,104,342,130"/>
<area shape="poly" title=" " alt="" coords="145,130,178,126,179,131,146,136"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="613,153,697,179"/>
<area shape="poly" title=" " alt="" coords="146,142,598,161,598,167,146,148"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="390,55,555,80"/>
<area shape="poly" title=" " alt="" coords="324,101,401,82,402,87,325,106"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="408,104,538,130"/>
<area shape="poly" title=" " alt="" coords="342,114,392,114,392,120,342,120"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="619,55,691,80"/>
<area shape="poly" title=" " alt="" coords="556,65,604,65,604,70,556,70"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="621,5,689,31"/>
<area shape="poly" title=" " alt="" coords="522,51,605,29,607,34,524,57"/>
<area shape="poly" title=" " alt="" coords="534,79,557,89,572,102,582,114,591,127,605,140,610,143,607,148,602,144,587,131,578,118,569,106,554,94,532,83"/>
<area shape="poly" title=" " alt="" coords="522,101,604,78,605,84,524,106"/>
<area shape="poly" title=" " alt="" coords="524,128,599,148,598,154,522,133"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="603,104,707,130"/>
<area shape="poly" title=" " alt="" coords="538,114,588,114,588,120,538,120"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a5c153fe27877bcc7927d391fb55550af_icgraph.png" border="0" usemap="#ayubihsm_8c_a5c153fe27877bcc7927d391fb55550af_icgraph" alt=""/></div>
<map name="ayubihsm_8c_a5c153fe27877bcc7927d391fb55550af_icgraph" id="ayubihsm_8c_a5c153fe27877bcc7927d391fb55550af_icgraph">
<area shape="rect" title=" " alt="" coords="447,31,588,56"/>
<area shape="rect" href="commands_8c.html#a5947d870ac856de3880f8b80981e6355" title=" " alt="" coords="296,31,399,56"/>
<area shape="poly" title=" " alt="" coords="431,46,400,46,400,41,431,41"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="280,36,248,31,249,26,281,31"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,31,55,56"/>
<area shape="poly" title=" " alt="" coords="280,46,55,46,55,41,280,41"/>
<area shape="poly" title=" " alt="" coords="88,36,55,42,54,37,87,31"/>
</map>
</div>

</div>
</div>
<a id="a9d844855c9066bbea0e4344978dd7fdc" name="a9d844855c9066bbea0e4344978dd7fdc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d844855c9066bbea0e4344978dd7fdc">&#9670;&#160;</a></span>yh_util_set_log_index()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_util_set_log_index </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__session.html">yh_session</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a></td>          <td class="paramname"><span class="paramname"><em>index</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set the index of the last extracted log entry.</p>
<p>This function should be called after <a class="el" href="yubihsm_8h.html#a5ae52ad56b7e83baeb33b46104263aa6">yh_util_get_log_entries()</a> to inform the device what the last extracted log entry is so new logs can be written. This is used when forced auditing is enabled.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>Authenticated session to use </td></tr>
    <tr><td class="paramname">index</td><td>index to set. Should be the same index as the last entry extracted using <a class="el" href="yubihsm_8h.html#a5ae52ad56b7e83baeb33b46104263aa6">yh_util_get_log_entries()</a></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> if the session is NULL. See <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> for other possible errors </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l02606">2606</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2606</span>                                                                 {</div>
<div class="line"><span class="lineno"> 2607</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a> == NULL) {</div>
<div class="line"><span class="lineno"> 2608</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>));</div>
<div class="line"><span class="lineno"> 2609</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 2610</span>  }</div>
<div class="line"><span class="lineno"> 2611</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> data[2];</div>
<div class="line"><span class="lineno"> 2612</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7e">yh_cmd</a> response_cmd;</div>
<div class="line"><span class="lineno"> 2613</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 2614</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> response[<a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a>];</div>
<div class="line"><span class="lineno"> 2615</span>  <span class="keywordtype">size_t</span> response_len = <span class="keyword">sizeof</span>(response);</div>
<div class="line"><span class="lineno"> 2616</span> </div>
<div class="line"><span class="lineno"> 2617</span>  <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> index_h = htons(index);</div>
<div class="line"><span class="lineno"> 2618</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(data, &amp;index_h, <span class="keyword">sizeof</span>(index_h));</div>
<div class="line"><span class="lineno"> 2619</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="#a4c26f003b72e800e9c934bca922a404a">yh_send_secure_msg</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, YHC_SET_LOG_INDEX, data, <span class="keyword">sizeof</span>(data),</div>
<div class="line"><span class="lineno"> 2620</span>                           &amp;response_cmd, response, &amp;response_len);</div>
<div class="line"><span class="lineno"> 2621</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 2622</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Failed to send SET LOG INDEX command: %s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 2623</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 2624</span>  }</div>
<div class="line"><span class="lineno"> 2625</span> </div>
<div class="line"><span class="lineno"> 2626</span>  <span class="keywordflow">if</span> (response_cmd == <a class="code hl_enumvalue" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7ea51cdf2ccd6995498e589e8ea6ce2a1f2">YHC_ERROR</a>) {</div>
<div class="line"><span class="lineno"> 2627</span>    <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> translated = translate_device_error(response[0]);</div>
<div class="line"><span class="lineno"> 2628</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Unable to set log index: %s (%x)&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(translated),</div>
<div class="line"><span class="lineno"> 2629</span>            response[0]);</div>
<div class="line"><span class="lineno"> 2630</span>    <span class="keywordflow">return</span> translated;</div>
<div class="line"><span class="lineno"> 2631</span>  }</div>
<div class="line"><span class="lineno"> 2632</span> </div>
<div class="line"><span class="lineno"> 2633</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 2634</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a9d844855c9066bbea0e4344978dd7fdc_cgraph.png" border="0" usemap="#ayubihsm_8c_a9d844855c9066bbea0e4344978dd7fdc_cgraph" alt=""/></div>
<map name="ayubihsm_8c_a9d844855c9066bbea0e4344978dd7fdc_cgraph" id="ayubihsm_8c_a9d844855c9066bbea0e4344978dd7fdc_cgraph">
<area shape="rect" title=" " alt="" coords="5,80,152,106"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="625,5,697,31"/>
<area shape="poly" title=" " alt="" coords="138,77,199,65,314,48,428,35,609,19,610,24,429,40,315,53,200,70,139,82"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="200,80,348,106"/>
<area shape="poly" title=" " alt="" coords="152,90,184,90,184,96,152,96"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="619,104,703,130"/>
<area shape="poly" title=" " alt="" coords="139,104,200,116,301,133,380,145,460,148,561,140,604,131,605,136,562,145,460,153,380,150,300,139,199,121,138,109"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="396,55,561,80"/>
<area shape="poly" title=" " alt="" coords="348,81,380,77,381,82,348,86"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="414,104,544,130"/>
<area shape="poly" title=" " alt="" coords="348,99,399,105,398,110,348,104"/>
<area shape="poly" title=" " alt="" coords="528,51,610,29,611,34,530,57"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="627,55,695,80"/>
<area shape="poly" title=" " alt="" coords="562,65,611,65,611,70,562,70"/>
<area shape="poly" title=" " alt="" coords="530,78,605,99,604,104,528,84"/>
<area shape="poly" title=" " alt="" coords="538,101,560,91,575,79,584,67,593,54,608,40,613,37,616,41,611,44,597,57,588,70,578,83,563,95,540,106"/>
<area shape="poly" title=" " alt="" coords="544,114,604,114,604,120,544,120"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="609,153,713,179"/>
<area shape="poly" title=" " alt="" coords="530,128,597,146,595,151,528,133"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a9d844855c9066bbea0e4344978dd7fdc_icgraph.png" border="0" usemap="#ayubihsm_8c_a9d844855c9066bbea0e4344978dd7fdc_icgraph" alt=""/></div>
<map name="ayubihsm_8c_a9d844855c9066bbea0e4344978dd7fdc_icgraph" id="ayubihsm_8c_a9d844855c9066bbea0e4344978dd7fdc_icgraph">
<area shape="rect" title=" " alt="" coords="498,31,645,56"/>
<area shape="rect" href="logs_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="348,5,398,31"/>
<area shape="poly" title=" " alt="" coords="483,35,398,24,399,19,483,30"/>
<area shape="rect" href="commands_8c.html#aeb72c881aa2699aea40f45fa65cf069b" title=" " alt="" coords="296,55,450,80"/>
<area shape="poly" title=" " alt="" coords="483,57,451,61,450,56,482,52"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,29,248,55"/>
<area shape="poly" title=" " alt="" coords="280,58,248,54,249,49,281,53"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,55,55,80"/>
<area shape="poly" title=" " alt="" coords="280,70,55,70,55,65,280,65"/>
<area shape="poly" title=" " alt="" coords="88,60,55,66,54,61,87,55"/>
</map>
</div>

</div>
</div>
<a id="a85ac840aec77cb1ca3c3ce1f2ab26282" name="a85ac840aec77cb1ca3c3ce1f2ab26282"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85ac840aec77cb1ca3c3ce1f2ab26282">&#9670;&#160;</a></span>yh_util_set_option()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_util_set_option </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__session.html">yh_session</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm_8h.html#acc8090ce0ec5029b376803e44b1cb4aa">yh_option</a></td>          <td class="paramname"><span class="paramname"><em>option</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>len</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>val</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set a device-global option</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>Authenticated session to use </td></tr>
    <tr><td class="paramname">option</td><td>Option to set. See <a class="el" href="yubihsm_8h.html#acc8090ce0ec5029b376803e44b1cb4aa">yh_option</a> </td></tr>
    <tr><td class="paramname">len</td><td>Length of option value </td></tr>
    <tr><td class="paramname">val</td><td>Option value</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> if <code>session</code> or <code>val</code> are NULL or if <code>len</code> is too long. See <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> for other possible errors </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l03537">3537</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3538</span>                                       {</div>
<div class="line"><span class="lineno"> 3539</span> </div>
<div class="line"><span class="lineno"> 3540</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a> == NULL || val == NULL) {</div>
<div class="line"><span class="lineno"> 3541</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>));</div>
<div class="line"><span class="lineno"> 3542</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 3543</span>  }</div>
<div class="line"><span class="lineno"> 3544</span> </div>
<div class="line"><span class="lineno"> 3545</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> &gt; <a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a> - 3) {</div>
<div class="line"><span class="lineno"> 3546</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Too much data, must be &lt; %d&quot;</span>, <a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a> - 3);</div>
<div class="line"><span class="lineno"> 3547</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 3548</span>  }</div>
<div class="line"><span class="lineno"> 3549</span> </div>
<div class="line"><span class="lineno"> 3550</span><span class="preprocessor">#pragma pack(push, 1)</span></div>
<div class="line"><span class="lineno"> 3551</span>  <span class="keyword">union </span>{</div>
<div class="line"><span class="lineno"> 3552</span>    <span class="keyword">struct </span>{</div>
<div class="line"><span class="lineno"> 3553</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm_8h.html#a023826538a428f5f8c53aaef5e9aec02">option</a>;</div>
<div class="line"><span class="lineno"> 3554</span>      <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>;</div>
<div class="line"><span class="lineno"> 3555</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#ac6f5a1f1e061f000983f5d5f3ac25dfa">bytes</a>[1];</div>
<div class="line"><span class="lineno"> 3556</span>    };</div>
<div class="line"><span class="lineno"> 3557</span>    <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a855e99b645b13e7905d074d02fe0bff5">buf</a>[<a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a>];</div>
<div class="line"><span class="lineno"> 3558</span>  } data;</div>
<div class="line"><span class="lineno"> 3559</span><span class="preprocessor">#pragma pack(pop)</span></div>
<div class="line"><span class="lineno"> 3560</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> out[<a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a>];</div>
<div class="line"><span class="lineno"> 3561</span>  <span class="keywordtype">size_t</span> outlen = <span class="keyword">sizeof</span>(out);</div>
<div class="line"><span class="lineno"> 3562</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7e">yh_cmd</a> response_cmd;</div>
<div class="line"><span class="lineno"> 3563</span> </div>
<div class="line"><span class="lineno"> 3564</span>  data.option = <a class="code hl_variable" href="yubihsm_8h.html#a023826538a428f5f8c53aaef5e9aec02">option</a>;</div>
<div class="line"><span class="lineno"> 3565</span>  data.len = htons(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>);</div>
<div class="line"><span class="lineno"> 3566</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(data.bytes, val, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>);</div>
<div class="line"><span class="lineno"> 3567</span> </div>
<div class="line"><span class="lineno"> 3568</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="#a4c26f003b72e800e9c934bca922a404a">yh_send_secure_msg</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, YHC_SET_OPTION, data.buf, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> + 3,</div>
<div class="line"><span class="lineno"> 3569</span>                                 &amp;response_cmd, out, &amp;outlen);</div>
<div class="line"><span class="lineno"> 3570</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 3571</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Failed to send SET OPTION command: %s\n&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 3572</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 3573</span>  }</div>
<div class="line"><span class="lineno"> 3574</span> </div>
<div class="line"><span class="lineno"> 3575</span>  <span class="keywordflow">if</span> (response_cmd == <a class="code hl_enumvalue" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7ea51cdf2ccd6995498e589e8ea6ce2a1f2">YHC_ERROR</a>) {</div>
<div class="line"><span class="lineno"> 3576</span>    <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> translated = translate_device_error(out[0]);</div>
<div class="line"><span class="lineno"> 3577</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Unable to put option: %s (%x)\n&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(translated), out[0]);</div>
<div class="line"><span class="lineno"> 3578</span>    <span class="keywordflow">return</span> translated;</div>
<div class="line"><span class="lineno"> 3579</span>  }</div>
<div class="line"><span class="lineno"> 3580</span> </div>
<div class="line"><span class="lineno"> 3581</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 3582</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a85ac840aec77cb1ca3c3ce1f2ab26282_cgraph.png" border="0" usemap="#ayubihsm_8c_a85ac840aec77cb1ca3c3ce1f2ab26282_cgraph" alt=""/></div>
<map name="ayubihsm_8c_a85ac840aec77cb1ca3c3ce1f2ab26282_cgraph" id="ayubihsm_8c_a85ac840aec77cb1ca3c3ce1f2ab26282_cgraph">
<area shape="rect" title=" " alt="" coords="5,80,132,106"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="605,5,677,31"/>
<area shape="poly" title=" " alt="" coords="123,77,179,65,294,47,408,34,589,19,590,24,408,39,294,53,180,70,124,82"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="180,80,328,106"/>
<area shape="poly" title=" " alt="" coords="132,90,164,90,164,96,132,96"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="599,104,683,130"/>
<area shape="poly" title=" " alt="" coords="123,104,204,121,308,136,424,145,483,144,541,140,584,131,585,136,542,145,483,150,424,150,308,142,203,126,122,109"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="376,55,541,80"/>
<area shape="poly" title=" " alt="" coords="328,81,360,77,361,82,328,86"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="394,104,524,130"/>
<area shape="poly" title=" " alt="" coords="328,99,379,105,378,110,328,104"/>
<area shape="poly" title=" " alt="" coords="508,51,590,29,591,34,510,57"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="607,55,675,80"/>
<area shape="poly" title=" " alt="" coords="542,65,591,65,591,70,542,70"/>
<area shape="poly" title=" " alt="" coords="510,78,585,99,584,104,508,84"/>
<area shape="poly" title=" " alt="" coords="518,101,540,91,555,79,564,67,573,54,588,40,593,37,596,41,591,44,577,57,568,70,558,83,543,95,520,106"/>
<area shape="poly" title=" " alt="" coords="524,114,584,114,584,120,524,120"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="589,153,693,179"/>
<area shape="poly" title=" " alt="" coords="510,128,577,146,575,151,508,133"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a85ac840aec77cb1ca3c3ce1f2ab26282_icgraph.png" border="0" usemap="#ayubihsm_8c_a85ac840aec77cb1ca3c3ce1f2ab26282_icgraph" alt=""/></div>
<map name="ayubihsm_8c_a85ac840aec77cb1ca3c3ce1f2ab26282_icgraph" id="ayubihsm_8c_a85ac840aec77cb1ca3c3ce1f2ab26282_icgraph">
<area shape="rect" title=" " alt="" coords="478,31,605,56"/>
<area shape="rect" href="logs_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="338,5,388,31"/>
<area shape="poly" title=" " alt="" coords="462,35,388,24,389,19,463,30"/>
<area shape="rect" href="commands_8c.html#ae400ec3fdd83a82b3c08dd7106c516b9" title=" " alt="" coords="296,55,430,80"/>
<area shape="poly" title=" " alt="" coords="463,57,431,61,431,56,463,51"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,55,248,80"/>
<area shape="poly" title=" " alt="" coords="280,70,248,70,248,65,280,65"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,55,55,80"/>
<area shape="poly" title=" " alt="" coords="87,70,55,70,55,65,87,65"/>
</map>
</div>

</div>
</div>
<a id="a5988faffd97366b188728ff1a7fb6e89" name="a5988faffd97366b188728ff1a7fb6e89"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5988faffd97366b188728ff1a7fb6e89">&#9670;&#160;</a></span>yh_util_sign_attestation_certificate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_util_sign_attestation_certificate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__session.html">yh_session</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a></td>          <td class="paramname"><span class="paramname"><em>key_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a></td>          <td class="paramname"><span class="paramname"><em>attest_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>out</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *</td>          <td class="paramname"><span class="paramname"><em>out_len</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get attestation of an Asymmetric Key in the form of an X.509 certificate</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>Authenticated session to use </td></tr>
    <tr><td class="paramname">key_id</td><td>Object ID of the Asymmetric Key to attest </td></tr>
    <tr><td class="paramname">attest_id</td><td>Object ID for the key used to sign the attestation certificate </td></tr>
    <tr><td class="paramname">out</td><td>The attestation certificate </td></tr>
    <tr><td class="paramname">out_len</td><td>Length of the attestation certificate</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> if input parameters are NULL. See <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> for other possible errors </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l03495">3495</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3497</span>                                                            {</div>
<div class="line"><span class="lineno"> 3498</span> </div>
<div class="line"><span class="lineno"> 3499</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a> == NULL || out == NULL || <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a565e4b6f63fecad4c290b50ee6684ee3">out_len</a> == NULL) {</div>
<div class="line"><span class="lineno"> 3500</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>));</div>
<div class="line"><span class="lineno"> 3501</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 3502</span>  }</div>
<div class="line"><span class="lineno"> 3503</span><span class="preprocessor">#pragma pack(push, 1)</span></div>
<div class="line"><span class="lineno"> 3504</span>  <span class="keyword">union </span>{</div>
<div class="line"><span class="lineno"> 3505</span>    <span class="keyword">struct </span>{</div>
<div class="line"><span class="lineno"> 3506</span>      <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>;</div>
<div class="line"><span class="lineno"> 3507</span>      <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> attest_id;</div>
<div class="line"><span class="lineno"> 3508</span>    };</div>
<div class="line"><span class="lineno"> 3509</span>    <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a855e99b645b13e7905d074d02fe0bff5">buf</a>[1];</div>
<div class="line"><span class="lineno"> 3510</span>  } data;</div>
<div class="line"><span class="lineno"> 3511</span><span class="preprocessor">#pragma pack(pop)</span></div>
<div class="line"><span class="lineno"> 3512</span> </div>
<div class="line"><span class="lineno"> 3513</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7e">yh_cmd</a> response_cmd;</div>
<div class="line"><span class="lineno"> 3514</span> </div>
<div class="line"><span class="lineno"> 3515</span>  data.key_id = htons(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>);</div>
<div class="line"><span class="lineno"> 3516</span>  data.attest_id = htons(attest_id);</div>
<div class="line"><span class="lineno"> 3517</span> </div>
<div class="line"><span class="lineno"> 3518</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> =</div>
<div class="line"><span class="lineno"> 3519</span>    <a class="code hl_function" href="#a4c26f003b72e800e9c934bca922a404a">yh_send_secure_msg</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, YHC_SIGN_ATTESTATION_CERTIFICATE, data.buf,</div>
<div class="line"><span class="lineno"> 3520</span>                       <span class="keyword">sizeof</span>(data), &amp;response_cmd, out, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a565e4b6f63fecad4c290b50ee6684ee3">out_len</a>);</div>
<div class="line"><span class="lineno"> 3521</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 3522</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Failed to send SIGN ATTESTATION CERTIFICATE command: %s\n&quot;</span>,</div>
<div class="line"><span class="lineno"> 3523</span>            <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 3524</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 3525</span>  }</div>
<div class="line"><span class="lineno"> 3526</span> </div>
<div class="line"><span class="lineno"> 3527</span>  <span class="keywordflow">if</span> (response_cmd == <a class="code hl_enumvalue" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7ea51cdf2ccd6995498e589e8ea6ce2a1f2">YHC_ERROR</a>) {</div>
<div class="line"><span class="lineno"> 3528</span>    <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> translated = translate_device_error(out[0]);</div>
<div class="line"><span class="lineno"> 3529</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Unable to get attestation: %s (%x)\n&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(translated),</div>
<div class="line"><span class="lineno"> 3530</span>            out[0]);</div>
<div class="line"><span class="lineno"> 3531</span>    <span class="keywordflow">return</span> translated;</div>
<div class="line"><span class="lineno"> 3532</span>  }</div>
<div class="line"><span class="lineno"> 3533</span> </div>
<div class="line"><span class="lineno"> 3534</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 3535</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a5988faffd97366b188728ff1a7fb6e89_cgraph.png" border="0" usemap="#ayubihsm_8c_a5988faffd97366b188728ff1a7fb6e89_cgraph" alt=""/></div>
<map name="ayubihsm_8c_a5988faffd97366b188728ff1a7fb6e89_cgraph" id="ayubihsm_8c_a5988faffd97366b188728ff1a7fb6e89_cgraph">
<area shape="rect" title=" " alt="" coords="5,122,164,162"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="212,104,360,130"/>
<area shape="poly" title=" " alt="" coords="163,130,196,125,197,131,164,135"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="631,153,715,179"/>
<area shape="poly" title=" " alt="" coords="164,143,616,161,616,167,164,148"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="408,55,573,80"/>
<area shape="poly" title=" " alt="" coords="342,101,419,82,420,87,343,106"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="426,104,556,130"/>
<area shape="poly" title=" " alt="" coords="360,114,410,114,410,120,360,120"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="637,55,709,80"/>
<area shape="poly" title=" " alt="" coords="574,65,622,65,622,70,574,70"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="639,5,707,31"/>
<area shape="poly" title=" " alt="" coords="540,51,623,29,625,34,542,57"/>
<area shape="poly" title=" " alt="" coords="552,79,575,89,590,102,600,114,609,127,623,140,628,143,625,148,620,144,605,131,596,118,587,106,572,94,550,83"/>
<area shape="poly" title=" " alt="" coords="540,101,622,78,623,84,542,106"/>
<area shape="poly" title=" " alt="" coords="542,128,617,148,616,154,540,133"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="621,104,725,130"/>
<area shape="poly" title=" " alt="" coords="556,114,606,114,606,120,556,120"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a5988faffd97366b188728ff1a7fb6e89_icgraph.png" border="0" usemap="#ayubihsm_8c_a5988faffd97366b188728ff1a7fb6e89_icgraph" alt=""/></div>
<map name="ayubihsm_8c_a5988faffd97366b188728ff1a7fb6e89_icgraph" id="ayubihsm_8c_a5988faffd97366b188728ff1a7fb6e89_icgraph">
<area shape="rect" title=" " alt="" coords="510,27,669,68"/>
<area shape="rect" href="attest_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="354,5,404,31"/>
<area shape="poly" title=" " alt="" coords="495,37,404,24,404,19,496,32"/>
<area shape="rect" href="commands_8c.html#af224308de5cdf8e20cbbdcaa6cf7598c" title=" " alt="" coords="296,55,462,96"/>
<area shape="poly" title=" " alt="" coords="495,63,463,67,462,62,495,57"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,37,248,63"/>
<area shape="poly" title=" " alt="" coords="280,66,248,62,249,57,281,61"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,63,55,88"/>
<area shape="poly" title=" " alt="" coords="281,78,55,78,55,73,281,73"/>
<area shape="poly" title=" " alt="" coords="88,68,55,74,54,69,87,63"/>
</map>
</div>

</div>
</div>
<a id="a5121c90d3bd745afd8264fef2ef39ace" name="a5121c90d3bd745afd8264fef2ef39ace"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5121c90d3bd745afd8264fef2ef39ace">&#9670;&#160;</a></span>yh_util_sign_ecdsa()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_util_sign_ecdsa </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__session.html">yh_session</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a></td>          <td class="paramname"><span class="paramname"><em>key_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>in</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>in_len</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>out</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *</td>          <td class="paramname"><span class="paramname"><em>out_len</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Sign data using ECDSA</p>
<p><code>in</code> is a raw hashed message, a truncated hash to the curve length or a padded hash to the curve length</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>Authenticated session to use </td></tr>
    <tr><td class="paramname">key_id</td><td>Object ID of the signing key </td></tr>
    <tr><td class="paramname">in</td><td><a class="el" href="struct_data.html">Data</a> to sign </td></tr>
    <tr><td class="paramname">in_len</td><td>Length of data to sign </td></tr>
    <tr><td class="paramname">out</td><td>Signed data </td></tr>
    <tr><td class="paramname">out_len</td><td>Length of signed data</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> input parameters are NULL or if <code>in_len</code> is not 20, 28, 34, 48, 64 or 66. See <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> for other possible errors </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l01411">1411</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1413</span>                                          {</div>
<div class="line"><span class="lineno"> 1414</span> </div>
<div class="line"><span class="lineno"> 1415</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a> == NULL || in == NULL || out == NULL || <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a565e4b6f63fecad4c290b50ee6684ee3">out_len</a> == NULL) {</div>
<div class="line"><span class="lineno"> 1416</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>));</div>
<div class="line"><span class="lineno"> 1417</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 1418</span>  }</div>
<div class="line"><span class="lineno"> 1419</span> </div>
<div class="line"><span class="lineno"> 1420</span>  <span class="keywordflow">switch</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a>) {</div>
<div class="line"><span class="lineno"> 1421</span>    <span class="keywordflow">case</span> 20:</div>
<div class="line"><span class="lineno"> 1422</span>    <span class="keywordflow">case</span> 28: <span class="comment">// p224..</span></div>
<div class="line"><span class="lineno"> 1423</span>    <span class="keywordflow">case</span> 32:</div>
<div class="line"><span class="lineno"> 1424</span>    <span class="keywordflow">case</span> 48:</div>
<div class="line"><span class="lineno"> 1425</span>    <span class="keywordflow">case</span> 64:</div>
<div class="line"><span class="lineno"> 1426</span>    <span class="keywordflow">case</span> 66: <span class="comment">// p521 needs 66 bytes input</span></div>
<div class="line"><span class="lineno"> 1427</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1428</span> </div>
<div class="line"><span class="lineno"> 1429</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 1430</span>      <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Data length must be 20, 28, 32, 48, 64 or 66&quot;</span>);</div>
<div class="line"><span class="lineno"> 1431</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 1432</span>  }</div>
<div class="line"><span class="lineno"> 1433</span> </div>
<div class="line"><span class="lineno"> 1434</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 1435</span> </div>
<div class="line"><span class="lineno"> 1436</span><span class="preprocessor">#pragma pack(push, 1)</span></div>
<div class="line"><span class="lineno"> 1437</span>  <span class="keyword">union </span>{</div>
<div class="line"><span class="lineno"> 1438</span>    <span class="keyword">struct </span>{</div>
<div class="line"><span class="lineno"> 1439</span>      <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>;</div>
<div class="line"><span class="lineno"> 1440</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#ac6f5a1f1e061f000983f5d5f3ac25dfa">bytes</a>[<a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a>];</div>
<div class="line"><span class="lineno"> 1441</span>    };</div>
<div class="line"><span class="lineno"> 1442</span>    <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a855e99b645b13e7905d074d02fe0bff5">buf</a>[1];</div>
<div class="line"><span class="lineno"> 1443</span>  } data;</div>
<div class="line"><span class="lineno"> 1444</span><span class="preprocessor">#pragma pack(pop)</span></div>
<div class="line"><span class="lineno"> 1445</span>  <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> data_len = <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a>;</div>
<div class="line"><span class="lineno"> 1446</span> </div>
<div class="line"><span class="lineno"> 1447</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7e">yh_cmd</a> response_cmd;</div>
<div class="line"><span class="lineno"> 1448</span> </div>
<div class="line"><span class="lineno"> 1449</span>  data.key_id = htons(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>);</div>
<div class="line"><span class="lineno"> 1450</span> </div>
<div class="line"><span class="lineno"> 1451</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(data.bytes, in, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a>);</div>
<div class="line"><span class="lineno"> 1452</span> </div>
<div class="line"><span class="lineno"> 1453</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="#a4c26f003b72e800e9c934bca922a404a">yh_send_secure_msg</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, YHC_SIGN_ECDSA, data.buf, data_len + 2,</div>
<div class="line"><span class="lineno"> 1454</span>                           &amp;response_cmd, out, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a565e4b6f63fecad4c290b50ee6684ee3">out_len</a>);</div>
<div class="line"><span class="lineno"> 1455</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 1456</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Failed to send SIGN ECDSA command: %s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 1457</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 1458</span>  }</div>
<div class="line"><span class="lineno"> 1459</span> </div>
<div class="line"><span class="lineno"> 1460</span>  <span class="keywordflow">if</span> (response_cmd == <a class="code hl_enumvalue" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7ea51cdf2ccd6995498e589e8ea6ce2a1f2">YHC_ERROR</a>) {</div>
<div class="line"><span class="lineno"> 1461</span>    <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> translated = translate_device_error(out[0]);</div>
<div class="line"><span class="lineno"> 1462</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Unable to get signature: %s (%x)&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(translated),</div>
<div class="line"><span class="lineno"> 1463</span>            out[0]);</div>
<div class="line"><span class="lineno"> 1464</span>    <span class="keywordflow">return</span> translated;</div>
<div class="line"><span class="lineno"> 1465</span>  }</div>
<div class="line"><span class="lineno"> 1466</span> </div>
<div class="line"><span class="lineno"> 1467</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 1468</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a5121c90d3bd745afd8264fef2ef39ace_cgraph.png" border="0" usemap="#ayubihsm_8c_a5121c90d3bd745afd8264fef2ef39ace_cgraph" alt=""/></div>
<map name="ayubihsm_8c_a5121c90d3bd745afd8264fef2ef39ace_cgraph" id="ayubihsm_8c_a5121c90d3bd745afd8264fef2ef39ace_cgraph">
<area shape="rect" title=" " alt="" coords="5,80,138,106"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="611,5,683,31"/>
<area shape="poly" title=" " alt="" coords="127,77,185,65,300,47,414,34,595,19,596,24,415,39,301,53,186,70,128,82"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="186,80,334,106"/>
<area shape="poly" title=" " alt="" coords="138,90,170,90,170,96,138,96"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="605,104,689,130"/>
<area shape="poly" title=" " alt="" coords="126,104,208,121,313,137,430,145,489,144,547,140,590,131,591,136,548,145,489,150,429,150,312,142,207,126,125,109"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="382,55,547,80"/>
<area shape="poly" title=" " alt="" coords="334,81,366,77,367,82,334,86"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="400,104,530,130"/>
<area shape="poly" title=" " alt="" coords="334,99,385,105,384,110,334,104"/>
<area shape="poly" title=" " alt="" coords="514,51,596,29,597,34,516,57"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="613,55,681,80"/>
<area shape="poly" title=" " alt="" coords="548,65,597,65,597,70,548,70"/>
<area shape="poly" title=" " alt="" coords="516,78,591,99,590,104,514,84"/>
<area shape="poly" title=" " alt="" coords="524,101,546,91,561,79,570,67,579,54,594,40,599,37,602,41,597,44,583,57,574,70,564,83,549,95,526,106"/>
<area shape="poly" title=" " alt="" coords="530,114,590,114,590,120,530,120"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="595,153,699,179"/>
<area shape="poly" title=" " alt="" coords="516,128,583,146,581,151,514,133"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a5121c90d3bd745afd8264fef2ef39ace_icgraph.png" border="0" usemap="#ayubihsm_8c_a5121c90d3bd745afd8264fef2ef39ace_icgraph" alt=""/></div>
<map name="ayubihsm_8c_a5121c90d3bd745afd8264fef2ef39ace_icgraph" id="ayubihsm_8c_a5121c90d3bd745afd8264fef2ef39ace_icgraph">
<area shape="rect" title=" " alt="" coords="494,120,627,146"/>
<area shape="rect" href="generate__ec_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="346,5,396,31"/>
<area shape="poly" title=" " alt="" coords="534,112,494,77,445,45,395,26,397,21,448,40,497,73,537,108"/>
<area shape="rect" href="util__pkcs11_8c.html#a547f9032e3bcd7d6a5a810e94822e337" title=" " alt="" coords="308,55,434,80"/>
<area shape="poly" title=" " alt="" coords="507,117,445,95,411,83,413,78,447,90,508,112"/>
<area shape="rect" href="structsysio_1_1wallet_1_1detail_1_1yubihsm__wallet__impl.html#a8987016445813c0391f04894e9bdb002" title=" " alt="" coords="296,105,446,161"/>
<area shape="poly" title=" " alt="" coords="479,136,446,136,446,130,479,130"/>
<area shape="rect" href="commands_8c.html#ae2e50929acc6085cd395d0bd4ddb02db" title=" " alt="" coords="302,185,440,211"/>
<area shape="poly" title=" " alt="" coords="508,154,447,175,413,187,411,182,445,170,507,149"/>
<area shape="rect" href="commands_8c.html#a982058963f9ff020c357030be09e79fc" title=" " alt="" coords="301,235,441,260"/>
<area shape="poly" title=" " alt="" coords="537,158,497,193,448,226,423,236,421,232,445,221,494,188,534,154"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,185,248,211"/>
<area shape="poly" title=" " alt="" coords="286,201,248,201,248,196,286,196"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,211,55,236"/>
<area shape="poly" title=" " alt="" coords="88,216,55,222,54,217,87,211"/>
<area shape="poly" title=" " alt="" coords="302,233,229,214,230,209,303,228"/>
<area shape="poly" title=" " alt="" coords="285,244,55,228,55,223,285,239"/>
</map>
</div>

</div>
</div>
<a id="a690a5585de21ce82495e139ec1dfdf9d" name="a690a5585de21ce82495e139ec1dfdf9d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a690a5585de21ce82495e139ec1dfdf9d">&#9670;&#160;</a></span>yh_util_sign_eddsa()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_util_sign_eddsa </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__session.html">yh_session</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a></td>          <td class="paramname"><span class="paramname"><em>key_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>in</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>in_len</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>out</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *</td>          <td class="paramname"><span class="paramname"><em>out_len</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Sign data using EdDSA</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>Authenticated session to use </td></tr>
    <tr><td class="paramname">key_id</td><td>Object ID of the signing key </td></tr>
    <tr><td class="paramname">in</td><td><a class="el" href="struct_data.html">Data</a> to sign </td></tr>
    <tr><td class="paramname">in_len</td><td>Length of data to sign </td></tr>
    <tr><td class="paramname">out</td><td>Signed data </td></tr>
    <tr><td class="paramname">out_len</td><td>Length of signed data</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> input parameters are NULL or if <code>in_len</code> is bigger than YH_MSG_BUF_SIZE-2. See <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> for other possible errors </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l01470">1470</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1472</span>                                          {</div>
<div class="line"><span class="lineno"> 1473</span> </div>
<div class="line"><span class="lineno"> 1474</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a> == NULL || in == NULL || out == NULL || <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a565e4b6f63fecad4c290b50ee6684ee3">out_len</a> == NULL) {</div>
<div class="line"><span class="lineno"> 1475</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>));</div>
<div class="line"><span class="lineno"> 1476</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 1477</span>  }</div>
<div class="line"><span class="lineno"> 1478</span> </div>
<div class="line"><span class="lineno"> 1479</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a> &gt; <a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a> - 2) {</div>
<div class="line"><span class="lineno"> 1480</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Too much data, must be &lt; %d&quot;</span>, <a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a> - 2);</div>
<div class="line"><span class="lineno"> 1481</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 1482</span>  }</div>
<div class="line"><span class="lineno"> 1483</span> </div>
<div class="line"><span class="lineno"> 1484</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 1485</span> </div>
<div class="line"><span class="lineno"> 1486</span><span class="preprocessor">#pragma pack(push, 1)</span></div>
<div class="line"><span class="lineno"> 1487</span>  <span class="keyword">union </span>{</div>
<div class="line"><span class="lineno"> 1488</span>    <span class="keyword">struct </span>{</div>
<div class="line"><span class="lineno"> 1489</span>      <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>;</div>
<div class="line"><span class="lineno"> 1490</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#ac6f5a1f1e061f000983f5d5f3ac25dfa">bytes</a>[<a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a>];</div>
<div class="line"><span class="lineno"> 1491</span>    };</div>
<div class="line"><span class="lineno"> 1492</span>    <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a855e99b645b13e7905d074d02fe0bff5">buf</a>[1];</div>
<div class="line"><span class="lineno"> 1493</span>  } data;</div>
<div class="line"><span class="lineno"> 1494</span><span class="preprocessor">#pragma pack(pop)</span></div>
<div class="line"><span class="lineno"> 1495</span>  <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> data_len = <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a>;</div>
<div class="line"><span class="lineno"> 1496</span> </div>
<div class="line"><span class="lineno"> 1497</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7e">yh_cmd</a> response_cmd;</div>
<div class="line"><span class="lineno"> 1498</span> </div>
<div class="line"><span class="lineno"> 1499</span>  data.key_id = htons(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>);</div>
<div class="line"><span class="lineno"> 1500</span> </div>
<div class="line"><span class="lineno"> 1501</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(data.bytes, in, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a>);</div>
<div class="line"><span class="lineno"> 1502</span> </div>
<div class="line"><span class="lineno"> 1503</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="#a4c26f003b72e800e9c934bca922a404a">yh_send_secure_msg</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, YHC_SIGN_EDDSA, data.buf, data_len + 2,</div>
<div class="line"><span class="lineno"> 1504</span>                           &amp;response_cmd, out, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a565e4b6f63fecad4c290b50ee6684ee3">out_len</a>);</div>
<div class="line"><span class="lineno"> 1505</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 1506</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Failed to send SIGN EDDSA command: %s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 1507</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 1508</span>  }</div>
<div class="line"><span class="lineno"> 1509</span> </div>
<div class="line"><span class="lineno"> 1510</span>  <span class="keywordflow">if</span> (response_cmd == <a class="code hl_enumvalue" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7ea51cdf2ccd6995498e589e8ea6ce2a1f2">YHC_ERROR</a>) {</div>
<div class="line"><span class="lineno"> 1511</span>    <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> translated = translate_device_error(out[0]);</div>
<div class="line"><span class="lineno"> 1512</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Unable to get signature: %s (%x)&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(translated),</div>
<div class="line"><span class="lineno"> 1513</span>            out[0]);</div>
<div class="line"><span class="lineno"> 1514</span>    <span class="keywordflow">return</span> translated;</div>
<div class="line"><span class="lineno"> 1515</span>  }</div>
<div class="line"><span class="lineno"> 1516</span> </div>
<div class="line"><span class="lineno"> 1517</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 1518</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a690a5585de21ce82495e139ec1dfdf9d_cgraph.png" border="0" usemap="#ayubihsm_8c_a690a5585de21ce82495e139ec1dfdf9d_cgraph" alt=""/></div>
<map name="ayubihsm_8c_a690a5585de21ce82495e139ec1dfdf9d_cgraph" id="ayubihsm_8c_a690a5585de21ce82495e139ec1dfdf9d_cgraph">
<area shape="rect" title=" " alt="" coords="5,80,138,106"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="611,5,683,31"/>
<area shape="poly" title=" " alt="" coords="127,77,185,65,300,47,414,34,595,19,596,24,415,39,301,53,186,70,128,82"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="186,80,334,106"/>
<area shape="poly" title=" " alt="" coords="138,90,170,90,170,96,138,96"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="605,104,689,130"/>
<area shape="poly" title=" " alt="" coords="126,104,208,121,313,137,430,145,489,144,547,140,590,131,591,136,548,145,489,150,429,150,312,142,207,126,125,109"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="382,55,547,80"/>
<area shape="poly" title=" " alt="" coords="334,81,366,77,367,82,334,86"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="400,104,530,130"/>
<area shape="poly" title=" " alt="" coords="334,99,385,105,384,110,334,104"/>
<area shape="poly" title=" " alt="" coords="514,51,596,29,597,34,516,57"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="613,55,681,80"/>
<area shape="poly" title=" " alt="" coords="548,65,597,65,597,70,548,70"/>
<area shape="poly" title=" " alt="" coords="516,78,591,99,590,104,514,84"/>
<area shape="poly" title=" " alt="" coords="524,101,546,91,561,79,570,67,579,54,594,40,599,37,602,41,597,44,583,57,574,70,564,83,549,95,526,106"/>
<area shape="poly" title=" " alt="" coords="530,114,590,114,590,120,530,120"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="595,153,699,179"/>
<area shape="poly" title=" " alt="" coords="516,128,583,146,581,151,514,133"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a690a5585de21ce82495e139ec1dfdf9d_icgraph.png" border="0" usemap="#ayubihsm_8c_a690a5585de21ce82495e139ec1dfdf9d_icgraph" alt=""/></div>
<map name="ayubihsm_8c_a690a5585de21ce82495e139ec1dfdf9d_icgraph" id="ayubihsm_8c_a690a5585de21ce82495e139ec1dfdf9d_icgraph">
<area shape="rect" title=" " alt="" coords="484,55,617,80"/>
<area shape="rect" href="import__ed_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="342,5,391,31"/>
<area shape="poly" title=" " alt="" coords="484,53,390,27,392,22,486,47"/>
<area shape="rect" href="commands_8c.html#ae2e50929acc6085cd395d0bd4ddb02db" title=" " alt="" coords="297,55,435,80"/>
<area shape="poly" title=" " alt="" coords="469,70,436,70,436,65,469,65"/>
<area shape="rect" href="commands_8c.html#ac867ca0fc75e87da1a8d924fc587f5b9" title=" " alt="" coords="296,104,436,130"/>
<area shape="poly" title=" " alt="" coords="486,87,418,106,416,101,485,82"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,55,248,80"/>
<area shape="poly" title=" " alt="" coords="281,70,249,70,249,65,281,65"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,80,55,106"/>
<area shape="poly" title=" " alt="" coords="88,85,55,91,54,86,87,80"/>
<area shape="poly" title=" " alt="" coords="298,102,227,84,229,78,299,97"/>
<area shape="poly" title=" " alt="" coords="281,113,55,97,55,92,281,108"/>
</map>
</div>

</div>
</div>
<a id="a9000d43fe8cf7313b319f316521eb0c4" name="a9000d43fe8cf7313b319f316521eb0c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9000d43fe8cf7313b319f316521eb0c4">&#9670;&#160;</a></span>yh_util_sign_hmac()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_util_sign_hmac </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__session.html">yh_session</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a></td>          <td class="paramname"><span class="paramname"><em>key_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>in</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>in_len</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>out</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *</td>          <td class="paramname"><span class="paramname"><em>out_len</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Sign data using HMAC</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>Authenticated session to use </td></tr>
    <tr><td class="paramname">key_id</td><td>Object ID of the signing key </td></tr>
    <tr><td class="paramname">in</td><td><a class="el" href="struct_data.html">Data</a> to HMAC </td></tr>
    <tr><td class="paramname">in_len</td><td>Length of data to hmac </td></tr>
    <tr><td class="paramname">out</td><td>HMAC </td></tr>
    <tr><td class="paramname">out_len</td><td>Length of HMAC</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> input parameters are NULL or if <code>in_len</code> is bigger than YH_MSG_BUF_SIZE-2. See <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> for other possible errors </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l01520">1520</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1521</span>                                                                      {</div>
<div class="line"><span class="lineno"> 1522</span> </div>
<div class="line"><span class="lineno"> 1523</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a> == NULL || in == NULL || out == NULL || <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a565e4b6f63fecad4c290b50ee6684ee3">out_len</a> == NULL) {</div>
<div class="line"><span class="lineno"> 1524</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>));</div>
<div class="line"><span class="lineno"> 1525</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 1526</span>  }</div>
<div class="line"><span class="lineno"> 1527</span> </div>
<div class="line"><span class="lineno"> 1528</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a> &gt; <a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a> - 2) {</div>
<div class="line"><span class="lineno"> 1529</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Too much data, must be &lt; %d&quot;</span>, <a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a> - 2);</div>
<div class="line"><span class="lineno"> 1530</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 1531</span>  }</div>
<div class="line"><span class="lineno"> 1532</span> </div>
<div class="line"><span class="lineno"> 1533</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> data[<a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a>];</div>
<div class="line"><span class="lineno"> 1534</span>  <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> data_len = 2;</div>
<div class="line"><span class="lineno"> 1535</span> </div>
<div class="line"><span class="lineno"> 1536</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7e">yh_cmd</a> response_cmd;</div>
<div class="line"><span class="lineno"> 1537</span> </div>
<div class="line"><span class="lineno"> 1538</span>  data[0] = htons(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>) &amp; 0xff;</div>
<div class="line"><span class="lineno"> 1539</span>  data[1] = htons(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>) &gt;&gt; 8;</div>
<div class="line"><span class="lineno"> 1540</span> </div>
<div class="line"><span class="lineno"> 1541</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(data + 2, in, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a>);</div>
<div class="line"><span class="lineno"> 1542</span>  data_len += <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a>;</div>
<div class="line"><span class="lineno"> 1543</span> </div>
<div class="line"><span class="lineno"> 1544</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="#a4c26f003b72e800e9c934bca922a404a">yh_send_secure_msg</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, YHC_SIGN_HMAC, data, data_len,</div>
<div class="line"><span class="lineno"> 1545</span>                                 &amp;response_cmd, out, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a565e4b6f63fecad4c290b50ee6684ee3">out_len</a>);</div>
<div class="line"><span class="lineno"> 1546</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 1547</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Failed to send SIGN HMAC command: %s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 1548</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 1549</span>  }</div>
<div class="line"><span class="lineno"> 1550</span> </div>
<div class="line"><span class="lineno"> 1551</span>  <span class="keywordflow">if</span> (response_cmd == <a class="code hl_enumvalue" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7ea51cdf2ccd6995498e589e8ea6ce2a1f2">YHC_ERROR</a>) {</div>
<div class="line"><span class="lineno"> 1552</span>    <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> translated = translate_device_error(out[0]);</div>
<div class="line"><span class="lineno"> 1553</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Unable to get data: %s (%x)&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(translated), out[0]);</div>
<div class="line"><span class="lineno"> 1554</span>    <span class="keywordflow">return</span> translated;</div>
<div class="line"><span class="lineno"> 1555</span>  }</div>
<div class="line"><span class="lineno"> 1556</span> </div>
<div class="line"><span class="lineno"> 1557</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 1558</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a9000d43fe8cf7313b319f316521eb0c4_cgraph.png" border="0" usemap="#ayubihsm_8c_a9000d43fe8cf7313b319f316521eb0c4_cgraph" alt=""/></div>
<map name="ayubihsm_8c_a9000d43fe8cf7313b319f316521eb0c4_cgraph" id="ayubihsm_8c_a9000d43fe8cf7313b319f316521eb0c4_cgraph">
<area shape="rect" title=" " alt="" coords="5,80,135,106"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="608,5,680,31"/>
<area shape="poly" title=" " alt="" coords="125,77,182,65,297,47,411,34,592,19,593,24,412,39,298,53,183,70,126,82"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="183,80,331,106"/>
<area shape="poly" title=" " alt="" coords="135,90,167,90,167,96,135,96"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="602,104,686,130"/>
<area shape="poly" title=" " alt="" coords="125,104,206,121,310,136,427,145,486,144,544,140,587,131,588,136,545,145,486,150,427,150,310,142,205,126,124,109"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="379,55,544,80"/>
<area shape="poly" title=" " alt="" coords="331,81,363,77,364,82,331,86"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="396,104,527,130"/>
<area shape="poly" title=" " alt="" coords="331,99,382,105,381,110,331,104"/>
<area shape="poly" title=" " alt="" coords="511,51,593,29,594,34,513,57"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="610,55,678,80"/>
<area shape="poly" title=" " alt="" coords="545,65,594,65,594,70,545,70"/>
<area shape="poly" title=" " alt="" coords="513,78,588,99,587,104,511,84"/>
<area shape="poly" title=" " alt="" coords="521,101,543,91,558,79,567,67,576,54,591,40,596,37,599,41,594,44,580,57,571,70,561,83,546,95,523,106"/>
<area shape="poly" title=" " alt="" coords="527,114,587,114,587,120,527,120"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="592,153,696,179"/>
<area shape="poly" title=" " alt="" coords="513,128,580,146,578,151,511,133"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a9000d43fe8cf7313b319f316521eb0c4_icgraph.png" border="0" usemap="#ayubihsm_8c_a9000d43fe8cf7313b319f316521eb0c4_icgraph" alt=""/></div>
<map name="ayubihsm_8c_a9000d43fe8cf7313b319f316521eb0c4_icgraph" id="ayubihsm_8c_a9000d43fe8cf7313b319f316521eb0c4_icgraph">
<area shape="rect" title=" " alt="" coords="482,80,612,106"/>
<area shape="rect" href="generate__hmac_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="340,5,390,31"/>
<area shape="poly" title=" " alt="" coords="503,76,433,45,389,28,391,23,435,40,506,71"/>
<area shape="rect" href="util__pkcs11_8c.html#a547f9032e3bcd7d6a5a810e94822e337" title=" " alt="" coords="302,55,428,80"/>
<area shape="poly" title=" " alt="" coords="467,84,428,79,429,74,467,79"/>
<area shape="rect" href="commands_8c.html#ae2e50929acc6085cd395d0bd4ddb02db" title=" " alt="" coords="296,104,434,130"/>
<area shape="poly" title=" " alt="" coords="467,106,435,110,434,105,467,101"/>
<area shape="rect" href="commands_8c.html#a8de2999193b4caa2d0d1fd2e8451dba1" title=" " alt="" coords="312,153,418,179"/>
<area shape="poly" title=" " alt="" coords="505,115,435,145,407,155,405,150,433,140,503,110"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,129,248,155"/>
<area shape="poly" title=" " alt="" coords="281,131,249,135,248,130,280,125"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,129,55,155"/>
<area shape="poly" title=" " alt="" coords="87,145,55,145,55,140,87,140"/>
<area shape="poly" title=" " alt="" coords="296,160,248,154,249,149,297,155"/>
</map>
</div>

</div>
</div>
<a id="aa0a7644b7b368d6aaf8b4aff5e3d19b8" name="aa0a7644b7b368d6aaf8b4aff5e3d19b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0a7644b7b368d6aaf8b4aff5e3d19b8">&#9670;&#160;</a></span>yh_util_sign_pkcs1v1_5()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_util_sign_pkcs1v1_5 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__session.html">yh_session</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a></td>          <td class="paramname"><span class="paramname"><em>key_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>hashed</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>in</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>in_len</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>out</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *</td>          <td class="paramname"><span class="paramname"><em>out_len</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Sign data using RSA-PKCS#1v1.5</p>
<p><code>in</code> is either a raw hashed message (sha1, sha256, sha384 or sha512) or that with correct digestinfo pre-pended</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>Authenticated session to use </td></tr>
    <tr><td class="paramname">key_id</td><td>Object ID of the signing key </td></tr>
    <tr><td class="paramname">hashed</td><td>true if data is only hashed </td></tr>
    <tr><td class="paramname">in</td><td>data to sign </td></tr>
    <tr><td class="paramname">in_len</td><td>length of data to sign </td></tr>
    <tr><td class="paramname">out</td><td>signed data </td></tr>
    <tr><td class="paramname">out_len</td><td>length of signed data</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> input parameters are NULL or if <code>in_len</code> is not 20, 34, 48 or 64. See <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> for other possible errors </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l01287">1287</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1289</span>                                              {</div>
<div class="line"><span class="lineno"> 1290</span> </div>
<div class="line"><span class="lineno"> 1291</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a> == NULL || in == NULL || out == NULL || <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a565e4b6f63fecad4c290b50ee6684ee3">out_len</a> == NULL) {</div>
<div class="line"><span class="lineno"> 1292</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>));</div>
<div class="line"><span class="lineno"> 1293</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 1294</span>  }</div>
<div class="line"><span class="lineno"> 1295</span> </div>
<div class="line"><span class="lineno"> 1296</span>  <span class="keywordflow">if</span> (hashed)</div>
<div class="line"><span class="lineno"> 1297</span>    <span class="keywordflow">switch</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a>) {</div>
<div class="line"><span class="lineno"> 1298</span>      <span class="keywordflow">case</span> 20:</div>
<div class="line"><span class="lineno"> 1299</span>      <span class="keywordflow">case</span> 32:</div>
<div class="line"><span class="lineno"> 1300</span>      <span class="keywordflow">case</span> 48:</div>
<div class="line"><span class="lineno"> 1301</span>      <span class="keywordflow">case</span> 64:</div>
<div class="line"><span class="lineno"> 1302</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1303</span> </div>
<div class="line"><span class="lineno"> 1304</span>      <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 1305</span>        <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Data length must be 20, 32, 48 or 64&quot;</span>);</div>
<div class="line"><span class="lineno"> 1306</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 1307</span>    }</div>
<div class="line"><span class="lineno"> 1308</span> </div>
<div class="line"><span class="lineno"> 1309</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 1310</span> </div>
<div class="line"><span class="lineno"> 1311</span><span class="preprocessor">#pragma pack(push, 1)</span></div>
<div class="line"><span class="lineno"> 1312</span>  <span class="keyword">union </span>{</div>
<div class="line"><span class="lineno"> 1313</span>    <span class="keyword">struct </span>{</div>
<div class="line"><span class="lineno"> 1314</span>      <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>;</div>
<div class="line"><span class="lineno"> 1315</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#ac6f5a1f1e061f000983f5d5f3ac25dfa">bytes</a>[<a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a>];</div>
<div class="line"><span class="lineno"> 1316</span>    };</div>
<div class="line"><span class="lineno"> 1317</span>    <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a855e99b645b13e7905d074d02fe0bff5">buf</a>[1];</div>
<div class="line"><span class="lineno"> 1318</span>  } data;</div>
<div class="line"><span class="lineno"> 1319</span><span class="preprocessor">#pragma pack(pop)</span></div>
<div class="line"><span class="lineno"> 1320</span>  <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> data_len;</div>
<div class="line"><span class="lineno"> 1321</span> </div>
<div class="line"><span class="lineno"> 1322</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7e">yh_cmd</a> response_cmd;</div>
<div class="line"><span class="lineno"> 1323</span> </div>
<div class="line"><span class="lineno"> 1324</span>  data.key_id = htons(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>);</div>
<div class="line"><span class="lineno"> 1325</span> </div>
<div class="line"><span class="lineno"> 1326</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(data.bytes, in, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a>);</div>
<div class="line"><span class="lineno"> 1327</span>  data_len = <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a>;</div>
<div class="line"><span class="lineno"> 1328</span> </div>
<div class="line"><span class="lineno"> 1329</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="#a4c26f003b72e800e9c934bca922a404a">yh_send_secure_msg</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, YHC_SIGN_PKCS1, data.buf, data_len + 2,</div>
<div class="line"><span class="lineno"> 1330</span>                           &amp;response_cmd, out, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a565e4b6f63fecad4c290b50ee6684ee3">out_len</a>);</div>
<div class="line"><span class="lineno"> 1331</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 1332</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Failed to send SIGN PKCS1 command: %s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 1333</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 1334</span>  }</div>
<div class="line"><span class="lineno"> 1335</span> </div>
<div class="line"><span class="lineno"> 1336</span>  <span class="keywordflow">if</span> (response_cmd == <a class="code hl_enumvalue" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7ea51cdf2ccd6995498e589e8ea6ce2a1f2">YHC_ERROR</a>) {</div>
<div class="line"><span class="lineno"> 1337</span>    <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> translated = translate_device_error(out[0]);</div>
<div class="line"><span class="lineno"> 1338</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Unable to get signature: %s (%x)&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(translated),</div>
<div class="line"><span class="lineno"> 1339</span>            out[0]);</div>
<div class="line"><span class="lineno"> 1340</span>    <span class="keywordflow">return</span> translated;</div>
<div class="line"><span class="lineno"> 1341</span>  }</div>
<div class="line"><span class="lineno"> 1342</span> </div>
<div class="line"><span class="lineno"> 1343</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 1344</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_aa0a7644b7b368d6aaf8b4aff5e3d19b8_cgraph.png" border="0" usemap="#ayubihsm_8c_aa0a7644b7b368d6aaf8b4aff5e3d19b8_cgraph" alt=""/></div>
<map name="ayubihsm_8c_aa0a7644b7b368d6aaf8b4aff5e3d19b8_cgraph" id="ayubihsm_8c_aa0a7644b7b368d6aaf8b4aff5e3d19b8_cgraph">
<area shape="rect" title=" " alt="" coords="5,80,166,106"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="639,5,711,31"/>
<area shape="poly" title=" " alt="" coords="149,77,213,65,442,35,623,19,624,24,443,41,214,70,150,82"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="214,80,362,106"/>
<area shape="poly" title=" " alt="" coords="166,90,198,90,198,96,166,96"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="633,104,717,130"/>
<area shape="poly" title=" " alt="" coords="150,104,214,116,315,133,394,145,474,148,575,140,618,131,619,136,576,145,474,153,394,150,314,138,213,121,149,109"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="410,55,575,80"/>
<area shape="poly" title=" " alt="" coords="362,81,394,77,395,82,362,86"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="428,104,558,130"/>
<area shape="poly" title=" " alt="" coords="362,99,413,105,412,110,362,104"/>
<area shape="poly" title=" " alt="" coords="542,51,624,29,625,34,544,57"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="641,55,709,80"/>
<area shape="poly" title=" " alt="" coords="576,65,625,65,625,70,576,70"/>
<area shape="poly" title=" " alt="" coords="544,78,619,99,618,104,542,84"/>
<area shape="poly" title=" " alt="" coords="552,101,574,91,589,79,598,67,607,54,622,40,627,37,630,41,625,44,611,57,602,70,592,83,577,95,554,106"/>
<area shape="poly" title=" " alt="" coords="558,114,618,114,618,120,558,120"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="623,153,727,179"/>
<area shape="poly" title=" " alt="" coords="544,128,611,146,609,151,542,133"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_aa0a7644b7b368d6aaf8b4aff5e3d19b8_icgraph.png" border="0" usemap="#ayubihsm_8c_aa0a7644b7b368d6aaf8b4aff5e3d19b8_icgraph" alt=""/></div>
<map name="ayubihsm_8c_aa0a7644b7b368d6aaf8b4aff5e3d19b8_icgraph" id="ayubihsm_8c_aa0a7644b7b368d6aaf8b4aff5e3d19b8_icgraph">
<area shape="rect" title=" " alt="" coords="512,80,673,106"/>
<area shape="rect" href="generate__rsa_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="356,5,405,31"/>
<area shape="poly" title=" " alt="" coords="545,76,463,45,404,27,406,22,465,40,547,71"/>
<area shape="rect" href="util__pkcs11_8c.html#a547f9032e3bcd7d6a5a810e94822e337" title=" " alt="" coords="318,55,443,80"/>
<area shape="poly" title=" " alt="" coords="496,84,443,78,444,72,497,79"/>
<area shape="rect" href="commands_8c.html#ae2e50929acc6085cd395d0bd4ddb02db" title=" " alt="" coords="311,104,449,130"/>
<area shape="poly" title=" " alt="" coords="497,106,450,112,450,106,497,101"/>
<area shape="rect" href="commands_8c.html#a98cf5e35ce2e4fd5881d8b6e7a890357" title=" " alt="" coords="296,153,464,179"/>
<area shape="poly" title=" " alt="" coords="546,114,465,145,432,155,430,150,463,140,544,109"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,104,248,130"/>
<area shape="poly" title=" " alt="" coords="295,120,248,120,248,114,295,114"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,129,55,155"/>
<area shape="poly" title=" " alt="" coords="88,135,55,141,54,135,87,130"/>
<area shape="poly" title=" " alt="" coords="308,152,231,133,232,128,309,146"/>
<area shape="poly" title=" " alt="" coords="280,162,55,146,55,141,281,157"/>
</map>
</div>

</div>
</div>
<a id="a944e6f31487857709f032598fd43fef5" name="a944e6f31487857709f032598fd43fef5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a944e6f31487857709f032598fd43fef5">&#9670;&#160;</a></span>yh_util_sign_pss()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_util_sign_pss </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__session.html">yh_session</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a></td>          <td class="paramname"><span class="paramname"><em>key_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>in</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>in_len</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>out</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *</td>          <td class="paramname"><span class="paramname"><em>out_len</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>salt_len</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55ca">yh_algorithm</a></td>          <td class="paramname"><span class="paramname"><em>mgf1Algo</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Sign data using RSA-PSS</p>
<p><code>in</code> is a raw hashed message (sha1, sha256, sha384 or sha512)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>Authenticated session to use </td></tr>
    <tr><td class="paramname">key_id</td><td>Object ID of the signing key </td></tr>
    <tr><td class="paramname">in</td><td><a class="el" href="struct_data.html">Data</a> to sign </td></tr>
    <tr><td class="paramname">in_len</td><td>Length of data to sign </td></tr>
    <tr><td class="paramname">out</td><td>Signed data </td></tr>
    <tr><td class="paramname">out_len</td><td>Length of signed data </td></tr>
    <tr><td class="paramname">salt_len</td><td>Length of salt </td></tr>
    <tr><td class="paramname">mgf1Algo</td><td>Algorithm for mgf1 (mask generation function for PSS)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> input parameters are NULL or if <code>in_len</code> is not 20, 34, 48 or 64. See <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> for other possible errors</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a href="https://tools.ietf.org/html/rfc8017#section-9.1">PSS specifications</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l01346">1346</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1348</span>                                                               {</div>
<div class="line"><span class="lineno"> 1349</span> </div>
<div class="line"><span class="lineno"> 1350</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a> == NULL || in == NULL || out == NULL || <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a565e4b6f63fecad4c290b50ee6684ee3">out_len</a> == NULL) {</div>
<div class="line"><span class="lineno"> 1351</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>));</div>
<div class="line"><span class="lineno"> 1352</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 1353</span>  }</div>
<div class="line"><span class="lineno"> 1354</span> </div>
<div class="line"><span class="lineno"> 1355</span>  <span class="keywordflow">switch</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a>) {</div>
<div class="line"><span class="lineno"> 1356</span>    <span class="keywordflow">case</span> 20:</div>
<div class="line"><span class="lineno"> 1357</span>    <span class="keywordflow">case</span> 32:</div>
<div class="line"><span class="lineno"> 1358</span>    <span class="keywordflow">case</span> 48:</div>
<div class="line"><span class="lineno"> 1359</span>    <span class="keywordflow">case</span> 64:</div>
<div class="line"><span class="lineno"> 1360</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1361</span> </div>
<div class="line"><span class="lineno"> 1362</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 1363</span>      <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Data length must be 20, 32, 48 or 64&quot;</span>);</div>
<div class="line"><span class="lineno"> 1364</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 1365</span>  }</div>
<div class="line"><span class="lineno"> 1366</span> </div>
<div class="line"><span class="lineno"> 1367</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 1368</span> </div>
<div class="line"><span class="lineno"> 1369</span><span class="preprocessor">#pragma pack(push, 1)</span></div>
<div class="line"><span class="lineno"> 1370</span>  <span class="keyword">union </span>{</div>
<div class="line"><span class="lineno"> 1371</span>    <span class="keyword">struct </span>{</div>
<div class="line"><span class="lineno"> 1372</span>      <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>;</div>
<div class="line"><span class="lineno"> 1373</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> mgf1Algo;</div>
<div class="line"><span class="lineno"> 1374</span>      <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> salt_len;</div>
<div class="line"><span class="lineno"> 1375</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#ac6f5a1f1e061f000983f5d5f3ac25dfa">bytes</a>[<a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a>];</div>
<div class="line"><span class="lineno"> 1376</span>    };</div>
<div class="line"><span class="lineno"> 1377</span>    <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a855e99b645b13e7905d074d02fe0bff5">buf</a>[1];</div>
<div class="line"><span class="lineno"> 1378</span>  } data;</div>
<div class="line"><span class="lineno"> 1379</span><span class="preprocessor">#pragma pack(pop)</span></div>
<div class="line"><span class="lineno"> 1380</span>  <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> data_len = <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a>;</div>
<div class="line"><span class="lineno"> 1381</span> </div>
<div class="line"><span class="lineno"> 1382</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7e">yh_cmd</a> response_cmd;</div>
<div class="line"><span class="lineno"> 1383</span> </div>
<div class="line"><span class="lineno"> 1384</span>  data.key_id = htons(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>);</div>
<div class="line"><span class="lineno"> 1385</span> </div>
<div class="line"><span class="lineno"> 1386</span>  data.mgf1Algo = mgf1Algo;</div>
<div class="line"><span class="lineno"> 1387</span> </div>
<div class="line"><span class="lineno"> 1388</span>  <span class="comment">// NOTE(adma): &#39;in&#39; is already a hash of the data, which type is inferred from</span></div>
<div class="line"><span class="lineno"> 1389</span>  <span class="comment">// the length</span></div>
<div class="line"><span class="lineno"> 1390</span>  data.salt_len = htons(salt_len);</div>
<div class="line"><span class="lineno"> 1391</span> </div>
<div class="line"><span class="lineno"> 1392</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(data.bytes, in, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a>);</div>
<div class="line"><span class="lineno"> 1393</span> </div>
<div class="line"><span class="lineno"> 1394</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="#a4c26f003b72e800e9c934bca922a404a">yh_send_secure_msg</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, YHC_SIGN_PSS, data.buf, data_len + 5,</div>
<div class="line"><span class="lineno"> 1395</span>                           &amp;response_cmd, out, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a565e4b6f63fecad4c290b50ee6684ee3">out_len</a>);</div>
<div class="line"><span class="lineno"> 1396</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 1397</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Failed to send SIGN PSS command: %s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 1398</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 1399</span>  }</div>
<div class="line"><span class="lineno"> 1400</span> </div>
<div class="line"><span class="lineno"> 1401</span>  <span class="keywordflow">if</span> (response_cmd == <a class="code hl_enumvalue" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7ea51cdf2ccd6995498e589e8ea6ce2a1f2">YHC_ERROR</a>) {</div>
<div class="line"><span class="lineno"> 1402</span>    <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> translated = translate_device_error(out[0]);</div>
<div class="line"><span class="lineno"> 1403</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Unable to get signature: %s (%x)&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(translated),</div>
<div class="line"><span class="lineno"> 1404</span>            out[0]);</div>
<div class="line"><span class="lineno"> 1405</span>    <span class="keywordflow">return</span> translated;</div>
<div class="line"><span class="lineno"> 1406</span>  }</div>
<div class="line"><span class="lineno"> 1407</span> </div>
<div class="line"><span class="lineno"> 1408</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 1409</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a944e6f31487857709f032598fd43fef5_cgraph.png" border="0" usemap="#ayubihsm_8c_a944e6f31487857709f032598fd43fef5_cgraph" alt=""/></div>
<map name="ayubihsm_8c_a944e6f31487857709f032598fd43fef5_cgraph" id="ayubihsm_8c_a944e6f31487857709f032598fd43fef5_cgraph">
<area shape="rect" title=" " alt="" coords="5,80,124,106"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="597,5,669,31"/>
<area shape="poly" title=" " alt="" coords="117,77,171,65,286,47,400,34,581,18,582,24,400,39,286,52,172,70,118,82"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="172,80,320,106"/>
<area shape="poly" title=" " alt="" coords="124,90,156,90,156,96,124,96"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="591,104,675,130"/>
<area shape="poly" title=" " alt="" coords="117,104,172,116,273,134,352,146,432,148,533,140,576,131,577,136,534,145,432,154,352,151,272,139,171,121,116,109"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="368,55,533,80"/>
<area shape="poly" title=" " alt="" coords="320,81,352,77,353,82,320,86"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="386,104,516,130"/>
<area shape="poly" title=" " alt="" coords="320,99,371,105,370,110,320,104"/>
<area shape="poly" title=" " alt="" coords="500,51,582,29,583,34,502,57"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="599,55,667,80"/>
<area shape="poly" title=" " alt="" coords="534,65,583,65,583,70,534,70"/>
<area shape="poly" title=" " alt="" coords="502,78,577,99,576,104,500,84"/>
<area shape="poly" title=" " alt="" coords="510,101,532,91,547,79,556,67,565,54,580,40,585,37,588,41,583,44,569,57,560,70,550,83,535,95,512,106"/>
<area shape="poly" title=" " alt="" coords="516,114,576,114,576,120,516,120"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="581,153,685,179"/>
<area shape="poly" title=" " alt="" coords="502,128,569,146,567,151,500,133"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a944e6f31487857709f032598fd43fef5_icgraph.png" border="0" usemap="#ayubihsm_8c_a944e6f31487857709f032598fd43fef5_icgraph" alt=""/></div>
<map name="ayubihsm_8c_a944e6f31487857709f032598fd43fef5_icgraph" id="ayubihsm_8c_a944e6f31487857709f032598fd43fef5_icgraph">
<area shape="rect" title=" " alt="" coords="482,80,601,106"/>
<area shape="rect" href="import__rsa_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="340,5,390,31"/>
<area shape="poly" title=" " alt="" coords="499,75,433,45,389,28,391,23,435,40,502,70"/>
<area shape="rect" href="util__pkcs11_8c.html#a547f9032e3bcd7d6a5a810e94822e337" title=" " alt="" coords="302,55,428,80"/>
<area shape="poly" title=" " alt="" coords="467,85,428,79,428,74,467,80"/>
<area shape="rect" href="commands_8c.html#ae2e50929acc6085cd395d0bd4ddb02db" title=" " alt="" coords="296,104,434,130"/>
<area shape="poly" title=" " alt="" coords="467,106,435,110,434,105,467,100"/>
<area shape="rect" href="commands_8c.html#a1dcbe3dfaa3722ae6e9246527b889627" title=" " alt="" coords="302,153,428,179"/>
<area shape="poly" title=" " alt="" coords="501,115,435,145,408,155,406,150,433,140,499,110"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,104,248,130"/>
<area shape="poly" title=" " alt="" coords="281,120,248,120,248,114,281,114"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,129,55,155"/>
<area shape="poly" title=" " alt="" coords="88,135,55,141,54,135,87,130"/>
<area shape="poly" title=" " alt="" coords="297,151,227,133,228,128,299,146"/>
<area shape="poly" title=" " alt="" coords="287,163,55,147,55,141,287,158"/>
</map>
</div>

</div>
</div>
<a id="a45c32b993856be818a70c0ffad589cbd" name="a45c32b993856be818a70c0ffad589cbd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a45c32b993856be818a70c0ffad589cbd">&#9670;&#160;</a></span>yh_util_sign_ssh_certificate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_util_sign_ssh_certificate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__session.html">yh_session</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a></td>          <td class="paramname"><span class="paramname"><em>key_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a></td>          <td class="paramname"><span class="paramname"><em>template_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55ca">yh_algorithm</a></td>          <td class="paramname"><span class="paramname"><em>sig_algo</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>in</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>in_len</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>out</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *</td>          <td class="paramname"><span class="paramname"><em>out_len</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Sign an SSH Certificate request. The function produces a signature that can then be used to produce the SSH Certificate</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>Authenticated session to use </td></tr>
    <tr><td class="paramname">key_id</td><td>Object ID of the key used to sign the request </td></tr>
    <tr><td class="paramname">template_id</td><td>Object ID of the template to use as a certificate template </td></tr>
    <tr><td class="paramname">sig_algo</td><td>Signature algorithm to use to sign the certificate request </td></tr>
    <tr><td class="paramname">in</td><td>Certificate request </td></tr>
    <tr><td class="paramname">in_len</td><td>Length of the certificate request </td></tr>
    <tr><td class="paramname">out</td><td>Signature </td></tr>
    <tr><td class="paramname">out_len</td><td>Length of the signature</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> if input parameters are NULL or <code>in_len</code> is too big. See <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> for other possible errors </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l02745">2745</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2748</span>                                                                  {</div>
<div class="line"><span class="lineno"> 2749</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a> == NULL || in == NULL || out == NULL || <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a565e4b6f63fecad4c290b50ee6684ee3">out_len</a> == NULL ||</div>
<div class="line"><span class="lineno"> 2750</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a> == 0) {</div>
<div class="line"><span class="lineno"> 2751</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>));</div>
<div class="line"><span class="lineno"> 2752</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 2753</span>  }</div>
<div class="line"><span class="lineno"> 2754</span> </div>
<div class="line"><span class="lineno"> 2755</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 2756</span> </div>
<div class="line"><span class="lineno"> 2757</span><span class="preprocessor">#pragma pack(push, 1)</span></div>
<div class="line"><span class="lineno"> 2758</span>  <span class="keyword">union </span>{</div>
<div class="line"><span class="lineno"> 2759</span>    <span class="keyword">struct </span>{</div>
<div class="line"><span class="lineno"> 2760</span>      <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>;</div>
<div class="line"><span class="lineno"> 2761</span>      <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> template_id;</div>
<div class="line"><span class="lineno"> 2762</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> algo;</div>
<div class="line"><span class="lineno"> 2763</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#ac6f5a1f1e061f000983f5d5f3ac25dfa">bytes</a>[<a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a> - <span class="keyword">sizeof</span>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>) - <span class="keyword">sizeof</span>(template_id) - 2];</div>
<div class="line"><span class="lineno"> 2764</span>    };</div>
<div class="line"><span class="lineno"> 2765</span>    <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a855e99b645b13e7905d074d02fe0bff5">buf</a>[1];</div>
<div class="line"><span class="lineno"> 2766</span>  } data;</div>
<div class="line"><span class="lineno"> 2767</span>  <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> data_len;</div>
<div class="line"><span class="lineno"> 2768</span><span class="preprocessor">#pragma pack(pop)</span></div>
<div class="line"><span class="lineno"> 2769</span> </div>
<div class="line"><span class="lineno"> 2770</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7e">yh_cmd</a> response_cmd;</div>
<div class="line"><span class="lineno"> 2771</span> </div>
<div class="line"><span class="lineno"> 2772</span>  data.key_id = htons(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>);</div>
<div class="line"><span class="lineno"> 2773</span> </div>
<div class="line"><span class="lineno"> 2774</span>  data.template_id = htons(template_id);</div>
<div class="line"><span class="lineno"> 2775</span> </div>
<div class="line"><span class="lineno"> 2776</span>  data.algo = sig_algo;</div>
<div class="line"><span class="lineno"> 2777</span> </div>
<div class="line"><span class="lineno"> 2778</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a> &gt; <span class="keyword">sizeof</span>(data.bytes)) {</div>
<div class="line"><span class="lineno"> 2779</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Data length must be in [0, %lu]\n&quot;</span>,</div>
<div class="line"><span class="lineno"> 2780</span>            (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>) <span class="keyword">sizeof</span>(data.bytes));</div>
<div class="line"><span class="lineno"> 2781</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 2782</span>  }</div>
<div class="line"><span class="lineno"> 2783</span> </div>
<div class="line"><span class="lineno"> 2784</span>  data_len = <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a> + 5;</div>
<div class="line"><span class="lineno"> 2785</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(data.bytes, in, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a>);</div>
<div class="line"><span class="lineno"> 2786</span> </div>
<div class="line"><span class="lineno"> 2787</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="#a4c26f003b72e800e9c934bca922a404a">yh_send_secure_msg</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, YHC_SIGN_SSH_CERTIFICATE, data.buf,</div>
<div class="line"><span class="lineno"> 2788</span>                           data_len, &amp;response_cmd, out, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a565e4b6f63fecad4c290b50ee6684ee3">out_len</a>);</div>
<div class="line"><span class="lineno"> 2789</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 2790</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Failed to send SIGN SSH CERTIFICATE command: %s&quot;</span>,</div>
<div class="line"><span class="lineno"> 2791</span>            <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 2792</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 2793</span>  }</div>
<div class="line"><span class="lineno"> 2794</span> </div>
<div class="line"><span class="lineno"> 2795</span>  <span class="keywordflow">if</span> (response_cmd == <a class="code hl_enumvalue" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7ea51cdf2ccd6995498e589e8ea6ce2a1f2">YHC_ERROR</a>) {</div>
<div class="line"><span class="lineno"> 2796</span>    <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> translated = translate_device_error(out[0]);</div>
<div class="line"><span class="lineno"> 2797</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Unable to get certificate: %s (%x)&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(translated),</div>
<div class="line"><span class="lineno"> 2798</span>            out[0]);</div>
<div class="line"><span class="lineno"> 2799</span>    <span class="keywordflow">return</span> translated;</div>
<div class="line"><span class="lineno"> 2800</span>  }</div>
<div class="line"><span class="lineno"> 2801</span> </div>
<div class="line"><span class="lineno"> 2802</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 2803</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a45c32b993856be818a70c0ffad589cbd_cgraph.png" border="0" usemap="#ayubihsm_8c_a45c32b993856be818a70c0ffad589cbd_cgraph" alt=""/></div>
<map name="ayubihsm_8c_a45c32b993856be818a70c0ffad589cbd_cgraph" id="ayubihsm_8c_a45c32b993856be818a70c0ffad589cbd_cgraph">
<area shape="rect" title=" " alt="" coords="5,80,188,106"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="661,5,733,31"/>
<area shape="poly" title=" " alt="" coords="167,77,235,65,464,36,645,19,646,25,465,41,236,70,168,82"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="236,80,384,106"/>
<area shape="poly" title=" " alt="" coords="188,90,220,90,220,96,188,96"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="655,104,739,130"/>
<area shape="poly" title=" " alt="" coords="167,104,236,116,417,144,496,148,597,140,640,131,641,136,598,145,496,153,416,150,235,121,166,109"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="432,55,597,80"/>
<area shape="poly" title=" " alt="" coords="384,81,416,77,417,82,384,86"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="450,104,580,130"/>
<area shape="poly" title=" " alt="" coords="384,99,435,105,434,110,384,104"/>
<area shape="poly" title=" " alt="" coords="564,51,646,29,647,34,566,57"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="663,55,731,80"/>
<area shape="poly" title=" " alt="" coords="598,65,647,65,647,70,598,70"/>
<area shape="poly" title=" " alt="" coords="566,78,641,99,640,104,564,84"/>
<area shape="poly" title=" " alt="" coords="574,101,596,91,611,79,620,67,629,54,644,40,649,37,652,41,647,44,633,57,624,70,614,83,599,95,576,106"/>
<area shape="poly" title=" " alt="" coords="580,114,640,114,640,120,580,120"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="645,153,749,179"/>
<area shape="poly" title=" " alt="" coords="566,128,633,146,631,151,564,133"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a45c32b993856be818a70c0ffad589cbd_icgraph.png" border="0" usemap="#ayubihsm_8c_a45c32b993856be818a70c0ffad589cbd_icgraph" alt=""/></div>
<map name="ayubihsm_8c_a45c32b993856be818a70c0ffad589cbd_icgraph" id="ayubihsm_8c_a45c32b993856be818a70c0ffad589cbd_icgraph">
<area shape="rect" title=" " alt="" coords="534,31,717,56"/>
<area shape="rect" href="ssh_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="366,5,416,31"/>
<area shape="poly" title=" " alt="" coords="518,35,416,23,416,18,519,29"/>
<area shape="rect" href="commands_8c.html#a03581158b5703a0ffe866d50d8a3982d" title=" " alt="" coords="296,55,486,80"/>
<area shape="poly" title=" " alt="" coords="519,57,487,60,486,55,519,52"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,29,248,55"/>
<area shape="poly" title=" " alt="" coords="280,57,248,53,249,48,281,52"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,55,55,80"/>
<area shape="poly" title=" " alt="" coords="281,70,55,70,55,65,281,65"/>
<area shape="poly" title=" " alt="" coords="88,60,55,66,54,61,87,55"/>
</map>
</div>

</div>
</div>
<a id="a550567a0f56d8536b9b5f34e905da7ec" name="a550567a0f56d8536b9b5f34e905da7ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a550567a0f56d8536b9b5f34e905da7ec">&#9670;&#160;</a></span>yh_util_unwrap_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_util_unwrap_data </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__session.html">yh_session</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a></td>          <td class="paramname"><span class="paramname"><em>key_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>in</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>in_len</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>out</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *</td>          <td class="paramname"><span class="paramname"><em>out_len</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Decrypt (unwrap) data using a <a class="el" href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583a16f0118db1dac3d0732e7d66630e1dba">YH_WRAP_KEY</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>Authenticated session to use </td></tr>
    <tr><td class="paramname">key_id</td><td>Object ID of the Wrap Key to use </td></tr>
    <tr><td class="paramname">in</td><td>Wrapped data </td></tr>
    <tr><td class="paramname">in_len</td><td>Length of wrapped data </td></tr>
    <tr><td class="paramname">out</td><td>Unwrapped data </td></tr>
    <tr><td class="paramname">out_len</td><td>Length of unwrapped data</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> if input parameters are NULL or if <code>in_len</code> is too big. See <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> for other possible errors </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l03716">3716</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3718</span>                                           {</div>
<div class="line"><span class="lineno"> 3719</span> </div>
<div class="line"><span class="lineno"> 3720</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a> == NULL || in == NULL || out == NULL || <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a565e4b6f63fecad4c290b50ee6684ee3">out_len</a> == NULL) {</div>
<div class="line"><span class="lineno"> 3721</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>));</div>
<div class="line"><span class="lineno"> 3722</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 3723</span>  }</div>
<div class="line"><span class="lineno"> 3724</span> </div>
<div class="line"><span class="lineno"> 3725</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a> &gt; <a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a> - 2) {</div>
<div class="line"><span class="lineno"> 3726</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Too much data, must be &lt; %d&quot;</span>, <a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a> - 2);</div>
<div class="line"><span class="lineno"> 3727</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 3728</span>  }</div>
<div class="line"><span class="lineno"> 3729</span> </div>
<div class="line"><span class="lineno"> 3730</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 3731</span> </div>
<div class="line"><span class="lineno"> 3732</span><span class="preprocessor">#pragma pack(push, 1)</span></div>
<div class="line"><span class="lineno"> 3733</span>  <span class="keyword">union </span>{</div>
<div class="line"><span class="lineno"> 3734</span>    <span class="keyword">struct </span>{</div>
<div class="line"><span class="lineno"> 3735</span>      <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>;</div>
<div class="line"><span class="lineno"> 3736</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#ac6f5a1f1e061f000983f5d5f3ac25dfa">bytes</a>[<a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a>];</div>
<div class="line"><span class="lineno"> 3737</span>    };</div>
<div class="line"><span class="lineno"> 3738</span>    <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a855e99b645b13e7905d074d02fe0bff5">buf</a>[1];</div>
<div class="line"><span class="lineno"> 3739</span>  } data;</div>
<div class="line"><span class="lineno"> 3740</span><span class="preprocessor">#pragma pack(pop)</span></div>
<div class="line"><span class="lineno"> 3741</span>  <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> data_len = <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a> + 2;</div>
<div class="line"><span class="lineno"> 3742</span> </div>
<div class="line"><span class="lineno"> 3743</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7e">yh_cmd</a> response_cmd;</div>
<div class="line"><span class="lineno"> 3744</span> </div>
<div class="line"><span class="lineno"> 3745</span>  data.key_id = htons(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>);</div>
<div class="line"><span class="lineno"> 3746</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(data.bytes, in, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a>);</div>
<div class="line"><span class="lineno"> 3747</span> </div>
<div class="line"><span class="lineno"> 3748</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="#a4c26f003b72e800e9c934bca922a404a">yh_send_secure_msg</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, YHC_UNWRAP_DATA, data.buf, data_len,</div>
<div class="line"><span class="lineno"> 3749</span>                           &amp;response_cmd, out, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a565e4b6f63fecad4c290b50ee6684ee3">out_len</a>);</div>
<div class="line"><span class="lineno"> 3750</span>  <a class="code hl_define" href="insecure__memzero_8h.html#a0794f9275fd1036ecba6ff0a901a320b">insecure_memzero</a>(data.buf, data_len);</div>
<div class="line"><span class="lineno"> 3751</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 3752</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Failed to send UNWRAP DATA command: %s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 3753</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 3754</span>  }</div>
<div class="line"><span class="lineno"> 3755</span> </div>
<div class="line"><span class="lineno"> 3756</span>  <span class="keywordflow">if</span> (response_cmd == <a class="code hl_enumvalue" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7ea51cdf2ccd6995498e589e8ea6ce2a1f2">YHC_ERROR</a>) {</div>
<div class="line"><span class="lineno"> 3757</span>    <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> translated = translate_device_error(out[0]);</div>
<div class="line"><span class="lineno"> 3758</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Unable to get unwrapped data: %s (%x)&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(translated),</div>
<div class="line"><span class="lineno"> 3759</span>            out[0]);</div>
<div class="line"><span class="lineno"> 3760</span>    <span class="keywordflow">return</span> translated;</div>
<div class="line"><span class="lineno"> 3761</span>  }</div>
<div class="line"><span class="lineno"> 3762</span> </div>
<div class="line"><span class="lineno"> 3763</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 3764</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a550567a0f56d8536b9b5f34e905da7ec_cgraph.png" border="0" usemap="#ayubihsm_8c_a550567a0f56d8536b9b5f34e905da7ec_cgraph" alt=""/></div>
<map name="ayubihsm_8c_a550567a0f56d8536b9b5f34e905da7ec_cgraph" id="ayubihsm_8c_a550567a0f56d8536b9b5f34e905da7ec_cgraph">
<area shape="rect" title=" " alt="" coords="5,80,146,106"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="619,5,691,31"/>
<area shape="poly" title=" " alt="" coords="134,77,193,65,308,48,422,34,603,19,604,24,423,40,309,53,194,70,135,82"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="194,80,342,106"/>
<area shape="poly" title=" " alt="" coords="146,90,178,90,178,96,146,96"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="613,104,697,130"/>
<area shape="poly" title=" " alt="" coords="134,104,194,116,295,133,374,145,454,148,555,140,598,131,599,136,556,145,454,153,374,150,294,139,193,121,133,109"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="390,55,555,80"/>
<area shape="poly" title=" " alt="" coords="342,81,374,77,375,82,342,86"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="408,104,538,130"/>
<area shape="poly" title=" " alt="" coords="342,99,393,105,392,110,342,104"/>
<area shape="poly" title=" " alt="" coords="522,51,604,29,605,34,524,57"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="621,55,689,80"/>
<area shape="poly" title=" " alt="" coords="556,65,605,65,605,70,556,70"/>
<area shape="poly" title=" " alt="" coords="524,78,599,99,598,104,522,84"/>
<area shape="poly" title=" " alt="" coords="532,101,554,91,569,79,578,67,587,54,602,40,607,37,610,41,605,44,591,57,582,70,572,83,557,95,534,106"/>
<area shape="poly" title=" " alt="" coords="538,114,598,114,598,120,538,120"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="603,153,707,179"/>
<area shape="poly" title=" " alt="" coords="524,128,591,146,589,151,522,133"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a550567a0f56d8536b9b5f34e905da7ec_icgraph.png" border="0" usemap="#ayubihsm_8c_a550567a0f56d8536b9b5f34e905da7ec_icgraph" alt=""/></div>
<map name="ayubihsm_8c_a550567a0f56d8536b9b5f34e905da7ec_icgraph" id="ayubihsm_8c_a550567a0f56d8536b9b5f34e905da7ec_icgraph">
<area shape="rect" title=" " alt="" coords="514,55,655,80"/>
<area shape="rect" href="wrap__data_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="356,5,406,31"/>
<area shape="poly" title=" " alt="" coords="513,53,406,27,407,21,514,48"/>
<area shape="rect" href="util__pkcs11_8c.html#a89815aa1db935281716a2b4d5520da8f" title=" " alt="" coords="324,55,439,80"/>
<area shape="poly" title=" " alt="" coords="499,70,439,70,439,65,499,65"/>
<area shape="rect" href="commands_8c.html#a4a18ed75272b213eea9b2ebec190b8c1" title=" " alt="" coords="296,104,466,130"/>
<area shape="poly" title=" " alt="" coords="514,87,438,106,437,101,513,82"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,104,248,130"/>
<area shape="poly" title=" " alt="" coords="280,120,248,120,248,114,280,114"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,104,55,130"/>
<area shape="poly" title=" " alt="" coords="87,120,55,120,55,114,87,114"/>
</map>
</div>

</div>
</div>
<a id="ab37ae2f7fc6857b420e173284130686d" name="ab37ae2f7fc6857b420e173284130686d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab37ae2f7fc6857b420e173284130686d">&#9670;&#160;</a></span>yh_util_verify_hmac()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_util_verify_hmac </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__session.html">yh_session</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a></td>          <td class="paramname"><span class="paramname"><em>key_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>signature</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>signature_len</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>data</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>data_len</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool *</td>          <td class="paramname"><span class="paramname"><em>verified</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Verify a generated HMAC</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>Authenticated session to use </td></tr>
    <tr><td class="paramname">key_id</td><td>Object ID of the HMAC key </td></tr>
    <tr><td class="paramname">signature</td><td>HMAC signature (20, 32, 48 or 64 bytes) </td></tr>
    <tr><td class="paramname">signature_len</td><td>length of HMAC signature </td></tr>
    <tr><td class="paramname">data</td><td>data to verify </td></tr>
    <tr><td class="paramname">data_len</td><td>length of data to verify </td></tr>
    <tr><td class="paramname">verified</td><td>true if verification succeeded</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> input parameters are NULL or if <code>signature_len</code> + <code>data_len</code> is too long. See <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> for other possible errors </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l01939">1939</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1942</span>                                          {</div>
<div class="line"><span class="lineno"> 1943</span> </div>
<div class="line"><span class="lineno"> 1944</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a> == NULL || signature == NULL || data == NULL ||</div>
<div class="line"><span class="lineno"> 1945</span>      verified == NULL) {</div>
<div class="line"><span class="lineno"> 1946</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>));</div>
<div class="line"><span class="lineno"> 1947</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 1948</span>  }</div>
<div class="line"><span class="lineno"> 1949</span> </div>
<div class="line"><span class="lineno"> 1950</span>  <span class="keywordflow">if</span> (data_len + signature_len &gt; <a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a> - 2) {</div>
<div class="line"><span class="lineno"> 1951</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Too much data, must be &lt; %d&quot;</span>, <a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a> - 2);</div>
<div class="line"><span class="lineno"> 1952</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 1953</span>  }</div>
<div class="line"><span class="lineno"> 1954</span> </div>
<div class="line"><span class="lineno"> 1955</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 1956</span> </div>
<div class="line"><span class="lineno"> 1957</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> cmd_data[<a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a>];</div>
<div class="line"><span class="lineno"> 1958</span>  <span class="keywordtype">int</span> cmd_data_len;</div>
<div class="line"><span class="lineno"> 1959</span> </div>
<div class="line"><span class="lineno"> 1960</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> response[3];</div>
<div class="line"><span class="lineno"> 1961</span>  <span class="keywordtype">size_t</span> response_len = <span class="keyword">sizeof</span>(response);</div>
<div class="line"><span class="lineno"> 1962</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7e">yh_cmd</a> response_cmd;</div>
<div class="line"><span class="lineno"> 1963</span> </div>
<div class="line"><span class="lineno"> 1964</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a> = htons(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>);</div>
<div class="line"><span class="lineno"> 1965</span> </div>
<div class="line"><span class="lineno"> 1966</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(cmd_data, (<a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *) &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>, 2);</div>
<div class="line"><span class="lineno"> 1967</span>  cmd_data_len = 2;</div>
<div class="line"><span class="lineno"> 1968</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(cmd_data + cmd_data_len, signature, signature_len);</div>
<div class="line"><span class="lineno"> 1969</span>  cmd_data_len += signature_len;</div>
<div class="line"><span class="lineno"> 1970</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(cmd_data + cmd_data_len, data, data_len);</div>
<div class="line"><span class="lineno"> 1971</span>  cmd_data_len += data_len;</div>
<div class="line"><span class="lineno"> 1972</span> </div>
<div class="line"><span class="lineno"> 1973</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="#a4c26f003b72e800e9c934bca922a404a">yh_send_secure_msg</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, YHC_VERIFY_HMAC, cmd_data, cmd_data_len,</div>
<div class="line"><span class="lineno"> 1974</span>                           &amp;response_cmd, response, &amp;response_len);</div>
<div class="line"><span class="lineno"> 1975</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 1976</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Failed to send HMAC VERIFY command: %s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 1977</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 1978</span>  }</div>
<div class="line"><span class="lineno"> 1979</span> </div>
<div class="line"><span class="lineno"> 1980</span>  <span class="keywordflow">if</span> (response_cmd == <a class="code hl_enumvalue" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7ea51cdf2ccd6995498e589e8ea6ce2a1f2">YHC_ERROR</a>) {</div>
<div class="line"><span class="lineno"> 1981</span>    <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> translated = translate_device_error(response[0]);</div>
<div class="line"><span class="lineno"> 1982</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Unable to verify data: %s (%x)&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(translated),</div>
<div class="line"><span class="lineno"> 1983</span>            response[0]);</div>
<div class="line"><span class="lineno"> 1984</span>    <span class="keywordflow">return</span> translated;</div>
<div class="line"><span class="lineno"> 1985</span>  }</div>
<div class="line"><span class="lineno"> 1986</span> </div>
<div class="line"><span class="lineno"> 1987</span>  *verified = response[0];</div>
<div class="line"><span class="lineno"> 1988</span> </div>
<div class="line"><span class="lineno"> 1989</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 1990</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_ab37ae2f7fc6857b420e173284130686d_cgraph.png" border="0" usemap="#ayubihsm_8c_ab37ae2f7fc6857b420e173284130686d_cgraph" alt=""/></div>
<map name="ayubihsm_8c_ab37ae2f7fc6857b420e173284130686d_cgraph" id="ayubihsm_8c_ab37ae2f7fc6857b420e173284130686d_cgraph">
<area shape="rect" title=" " alt="" coords="5,80,143,106"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="616,5,688,31"/>
<area shape="poly" title=" " alt="" coords="132,77,190,65,305,48,419,34,600,19,601,24,420,40,306,53,191,70,133,82"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="191,80,339,106"/>
<area shape="poly" title=" " alt="" coords="143,90,175,90,175,96,143,96"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="610,104,694,130"/>
<area shape="poly" title=" " alt="" coords="129,104,211,121,316,137,434,145,494,144,552,140,595,131,596,136,553,145,494,150,434,150,316,142,210,126,128,109"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="387,55,552,80"/>
<area shape="poly" title=" " alt="" coords="339,81,371,77,372,82,339,86"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="404,104,535,130"/>
<area shape="poly" title=" " alt="" coords="339,99,390,105,389,110,339,104"/>
<area shape="poly" title=" " alt="" coords="519,51,601,29,602,34,521,57"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="618,55,686,80"/>
<area shape="poly" title=" " alt="" coords="553,65,602,65,602,70,553,70"/>
<area shape="poly" title=" " alt="" coords="521,78,596,99,595,104,519,84"/>
<area shape="poly" title=" " alt="" coords="529,101,551,91,566,79,575,67,584,54,599,40,604,37,607,41,602,44,588,57,579,70,569,83,554,95,531,106"/>
<area shape="poly" title=" " alt="" coords="535,114,595,114,595,120,535,120"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="600,153,704,179"/>
<area shape="poly" title=" " alt="" coords="521,128,588,146,586,151,519,133"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_ab37ae2f7fc6857b420e173284130686d_icgraph.png" border="0" usemap="#ayubihsm_8c_ab37ae2f7fc6857b420e173284130686d_icgraph" alt=""/></div>
<map name="ayubihsm_8c_ab37ae2f7fc6857b420e173284130686d_icgraph" id="ayubihsm_8c_ab37ae2f7fc6857b420e173284130686d_icgraph">
<area shape="rect" title=" " alt="" coords="158,31,295,56"/>
<area shape="rect" href="generate__hmac_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="33,5,82,31"/>
<area shape="poly" title=" " alt="" coords="142,34,82,24,83,19,143,28"/>
<area shape="rect" href="util__pkcs11_8c.html#ab17f6ba85432d715def5185e7832c9e8" title=" " alt="" coords="5,55,110,80"/>
<area shape="poly" title=" " alt="" coords="143,58,110,63,110,57,142,53"/>
</map>
</div>

</div>
</div>
<a id="a7c2e101be04ad1546d99d5600e732eca" name="a7c2e101be04ad1546d99d5600e732eca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c2e101be04ad1546d99d5600e732eca">&#9670;&#160;</a></span>yh_util_wrap_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> yh_util_wrap_data </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__session.html">yh_session</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a></td>          <td class="paramname"><span class="paramname"><em>key_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>in</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>in_len</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>out</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *</td>          <td class="paramname"><span class="paramname"><em>out_len</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Encrypt (wrap) data using a <a class="el" href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583a16f0118db1dac3d0732e7d66630e1dba">YH_WRAP_KEY</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>Authenticated session to use </td></tr>
    <tr><td class="paramname">key_id</td><td>Object ID of the Wrap Key to use </td></tr>
    <tr><td class="paramname">in</td><td><a class="el" href="struct_data.html">Data</a> to wrap </td></tr>
    <tr><td class="paramname">in_len</td><td>Length of data to wrap </td></tr>
    <tr><td class="paramname">out</td><td>Wrapped data </td></tr>
    <tr><td class="paramname">out_len</td><td>Length of the wrapped data</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815" title="Returned value when function was successful.">YHR_SUCCESS</a> if successful. <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5" title="Returned value when an argument to a function is invalid.">YHR_INVALID_PARAMETERS</a> if input parameters are NULL or if <code>in_len</code> is too big. See <a class="el" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> for other possible errors </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l03667">3667</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3668</span>                                                                      {</div>
<div class="line"><span class="lineno"> 3669</span> </div>
<div class="line"><span class="lineno"> 3670</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a> == NULL || in == NULL || out == NULL || <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a565e4b6f63fecad4c290b50ee6684ee3">out_len</a> == NULL) {</div>
<div class="line"><span class="lineno"> 3671</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>));</div>
<div class="line"><span class="lineno"> 3672</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 3673</span>  }</div>
<div class="line"><span class="lineno"> 3674</span> </div>
<div class="line"><span class="lineno"> 3675</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a> &gt; <a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a> - 2) {</div>
<div class="line"><span class="lineno"> 3676</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Too much data, must be &lt; %d&quot;</span>, <a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a> - 2);</div>
<div class="line"><span class="lineno"> 3677</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a731b3992b45fde61b6760d92de4dbbf5">YHR_INVALID_PARAMETERS</a>;</div>
<div class="line"><span class="lineno"> 3678</span>  }</div>
<div class="line"><span class="lineno"> 3679</span> </div>
<div class="line"><span class="lineno"> 3680</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 3681</span> </div>
<div class="line"><span class="lineno"> 3682</span><span class="preprocessor">#pragma pack(push, 1)</span></div>
<div class="line"><span class="lineno"> 3683</span>  <span class="keyword">union </span>{</div>
<div class="line"><span class="lineno"> 3684</span>    <span class="keyword">struct </span>{</div>
<div class="line"><span class="lineno"> 3685</span>      <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>;</div>
<div class="line"><span class="lineno"> 3686</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#ac6f5a1f1e061f000983f5d5f3ac25dfa">bytes</a>[<a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a>];</div>
<div class="line"><span class="lineno"> 3687</span>    };</div>
<div class="line"><span class="lineno"> 3688</span>    <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a855e99b645b13e7905d074d02fe0bff5">buf</a>[1];</div>
<div class="line"><span class="lineno"> 3689</span>  } data;</div>
<div class="line"><span class="lineno"> 3690</span><span class="preprocessor">#pragma pack(pop)</span></div>
<div class="line"><span class="lineno"> 3691</span>  <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> data_len = <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a> + 2;</div>
<div class="line"><span class="lineno"> 3692</span> </div>
<div class="line"><span class="lineno"> 3693</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7e">yh_cmd</a> response_cmd;</div>
<div class="line"><span class="lineno"> 3694</span> </div>
<div class="line"><span class="lineno"> 3695</span>  data.key_id = htons(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ada12860f8f9f5f3cac5b179ef352434c">key_id</a>);</div>
<div class="line"><span class="lineno"> 3696</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(data.bytes, in, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a>);</div>
<div class="line"><span class="lineno"> 3697</span> </div>
<div class="line"><span class="lineno"> 3698</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="#a4c26f003b72e800e9c934bca922a404a">yh_send_secure_msg</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, YHC_WRAP_DATA, data.buf, data_len,</div>
<div class="line"><span class="lineno"> 3699</span>                           &amp;response_cmd, out, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a565e4b6f63fecad4c290b50ee6684ee3">out_len</a>);</div>
<div class="line"><span class="lineno"> 3700</span>  <a class="code hl_define" href="insecure__memzero_8h.html#a0794f9275fd1036ecba6ff0a901a320b">insecure_memzero</a>(data.buf, data_len);</div>
<div class="line"><span class="lineno"> 3701</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 3702</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Failed to send WRAP DATA command: %s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 3703</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 3704</span>  }</div>
<div class="line"><span class="lineno"> 3705</span> </div>
<div class="line"><span class="lineno"> 3706</span>  <span class="keywordflow">if</span> (response_cmd == <a class="code hl_enumvalue" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7ea51cdf2ccd6995498e589e8ea6ce2a1f2">YHC_ERROR</a>) {</div>
<div class="line"><span class="lineno"> 3707</span>    <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> translated = translate_device_error(out[0]);</div>
<div class="line"><span class="lineno"> 3708</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Unable to get wrapped data: %s (%x)&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(translated),</div>
<div class="line"><span class="lineno"> 3709</span>            out[0]);</div>
<div class="line"><span class="lineno"> 3710</span>    <span class="keywordflow">return</span> translated;</div>
<div class="line"><span class="lineno"> 3711</span>  }</div>
<div class="line"><span class="lineno"> 3712</span> </div>
<div class="line"><span class="lineno"> 3713</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 3714</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a7c2e101be04ad1546d99d5600e732eca_cgraph.png" border="0" usemap="#ayubihsm_8c_a7c2e101be04ad1546d99d5600e732eca_cgraph" alt=""/></div>
<map name="ayubihsm_8c_a7c2e101be04ad1546d99d5600e732eca_cgraph" id="ayubihsm_8c_a7c2e101be04ad1546d99d5600e732eca_cgraph">
<area shape="rect" title=" " alt="" coords="5,80,132,106"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="605,5,677,31"/>
<area shape="poly" title=" " alt="" coords="123,77,179,65,294,47,408,34,589,19,590,24,408,39,294,53,180,70,124,82"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="180,80,328,106"/>
<area shape="poly" title=" " alt="" coords="132,90,164,90,164,96,132,96"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="599,104,683,130"/>
<area shape="poly" title=" " alt="" coords="123,104,204,121,308,136,424,145,483,144,541,140,584,131,585,136,542,145,483,150,424,150,308,142,203,126,122,109"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="376,55,541,80"/>
<area shape="poly" title=" " alt="" coords="328,81,360,77,361,82,328,86"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="394,104,524,130"/>
<area shape="poly" title=" " alt="" coords="328,99,379,105,378,110,328,104"/>
<area shape="poly" title=" " alt="" coords="508,51,590,29,591,34,510,57"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="607,55,675,80"/>
<area shape="poly" title=" " alt="" coords="542,65,591,65,591,70,542,70"/>
<area shape="poly" title=" " alt="" coords="510,78,585,99,584,104,508,84"/>
<area shape="poly" title=" " alt="" coords="518,101,540,91,555,79,564,67,573,54,588,40,593,37,596,41,591,44,577,57,568,70,558,83,543,95,520,106"/>
<area shape="poly" title=" " alt="" coords="524,114,584,114,584,120,524,120"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="589,153,693,179"/>
<area shape="poly" title=" " alt="" coords="510,128,577,146,575,151,508,133"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a7c2e101be04ad1546d99d5600e732eca_icgraph.png" border="0" usemap="#ayubihsm_8c_a7c2e101be04ad1546d99d5600e732eca_icgraph" alt=""/></div>
<map name="ayubihsm_8c_a7c2e101be04ad1546d99d5600e732eca_icgraph" id="ayubihsm_8c_a7c2e101be04ad1546d99d5600e732eca_icgraph">
<area shape="rect" title=" " alt="" coords="514,55,641,80"/>
<area shape="rect" href="wrap__data_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="356,5,406,31"/>
<area shape="poly" title=" " alt="" coords="508,53,405,27,407,22,509,48"/>
<area shape="rect" href="util__pkcs11_8c.html#aeb9c5d4717c977e42f88669d5ff26286" title=" " alt="" coords="324,55,439,80"/>
<area shape="poly" title=" " alt="" coords="499,70,439,70,439,65,499,65"/>
<area shape="rect" href="commands_8c.html#a115ebd6b436229c152141f64a2405e70" title=" " alt="" coords="296,104,466,130"/>
<area shape="poly" title=" " alt="" coords="509,87,436,106,435,101,508,82"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,104,248,130"/>
<area shape="poly" title=" " alt="" coords="280,120,248,120,248,114,280,114"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,104,55,130"/>
<area shape="poly" title=" " alt="" coords="87,120,55,120,55,114,87,114"/>
</map>
</div>

</div>
</div>
<a id="a00b81c3c9ca2964a672b7b0b725925e4" name="a00b81c3c9ca2964a672b7b0b725925e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a00b81c3c9ca2964a672b7b0b725925e4">&#9670;&#160;</a></span>yh_verify_logs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool yh_verify_logs </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__log__entry.html">yh_log_entry</a> *</td>          <td class="paramname"><span class="paramname"><em>logs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>n_items</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structyh__log__entry.html">yh_log_entry</a> *</td>          <td class="paramname"><span class="paramname"><em>last_previous_log</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Verify an array of log entries</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">logs</td><td>Array of log entries </td></tr>
    <tr><td class="paramname">n_items</td><td>number of log entries </td></tr>
    <tr><td class="paramname">last_previous_log</td><td>Optional pointer to the entry before the first entry in logs</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True if verification succeeds. False otherwise</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a href="https://developers.yubico.com/YubiHSM2/Concepts/Logs.html">Logs</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l04480">4480</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4481</span>                                                     {</div>
<div class="line"><span class="lineno"> 4482</span>  <span class="keywordflow">if</span> (logs == NULL || n_items == 0) {</div>
<div class="line"><span class="lineno"> 4483</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 4484</span>  }</div>
<div class="line"><span class="lineno"> 4485</span> </div>
<div class="line"><span class="lineno"> 4486</span>  <a class="code hl_struct" href="struct__hash__ctx.html">hash_ctx</a> hashctx = NULL;</div>
<div class="line"><span class="lineno"> 4487</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> previous_hash[32];</div>
<div class="line"><span class="lineno"> 4488</span>  <span class="keywordtype">size_t</span> previous_hash_len = 32;</div>
<div class="line"><span class="lineno"> 4489</span>  <span class="keywordtype">int</span> <a class="code hl_enumvalue" href="namespace_w_a_s_m.html#a9690a14428419003297ae35f505b5103aea2b2676c28c0db26d39331a336c6b92">start</a>;</div>
<div class="line"><span class="lineno"> 4490</span>  <span class="keywordtype">bool</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a3d854b6efad16a16e4d7b4539d4fc71f">ret</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 4491</span> </div>
<div class="line"><span class="lineno"> 4492</span>  <span class="keywordflow">if</span> (!<a class="code hl_function" href="hash_8c.html#a3cc1419f3a2f6401e22e8b339b73c609">hash_create</a>(&amp;hashctx, <a class="code hl_enumvalue" href="yubihsm_2common_2hash_8h.html#a488906826f8aaf7e850c35889d560089af0ab1a9d65ceafa4ba1f6f177e379258">_SHA256</a>)) {</div>
<div class="line"><span class="lineno"> 4493</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 4494</span>  }</div>
<div class="line"><span class="lineno"> 4495</span> </div>
<div class="line"><span class="lineno"> 4496</span>  <span class="keywordflow">if</span> (last_previous_log != NULL) {</div>
<div class="line"><span class="lineno"> 4497</span>    <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(previous_hash, last_previous_log-&gt;<a class="code hl_variable" href="structyh__log__entry.html#a0e8ca2892b29342aa721e5a9917fabed">digest</a>, <a class="code hl_define" href="yubihsm_8h.html#a289ca46f5ef481980f0fad98d727e87a">YH_LOG_DIGEST_SIZE</a>);</div>
<div class="line"><span class="lineno"> 4498</span>    <a class="code hl_enumvalue" href="namespace_w_a_s_m.html#a9690a14428419003297ae35f505b5103aea2b2676c28c0db26d39331a336c6b92">start</a> = 0;</div>
<div class="line"><span class="lineno"> 4499</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 4500</span>    <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(previous_hash, logs[0].digest, <a class="code hl_define" href="yubihsm_8h.html#a289ca46f5ef481980f0fad98d727e87a">YH_LOG_DIGEST_SIZE</a>);</div>
<div class="line"><span class="lineno"> 4501</span>    <a class="code hl_enumvalue" href="namespace_w_a_s_m.html#a9690a14428419003297ae35f505b5103aea2b2676c28c0db26d39331a336c6b92">start</a> = 1;</div>
<div class="line"><span class="lineno"> 4502</span>  }</div>
<div class="line"><span class="lineno"> 4503</span> </div>
<div class="line"><span class="lineno"> 4504</span>  <span class="keywordflow">for</span> (<a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> i = start; i &lt; n_items; i++) {</div>
<div class="line"><span class="lineno"> 4505</span>    <a class="code hl_struct" href="structyh__log__entry.html">yh_log_entry</a> inverted;</div>
<div class="line"><span class="lineno"> 4506</span>    inverted.<a class="code hl_variable" href="structyh__log__entry.html#adbdbdd10828646a96f67438062c909c8">number</a> = htons(logs[i].number);</div>
<div class="line"><span class="lineno"> 4507</span>    inverted.<a class="code hl_variable" href="structyh__log__entry.html#ad1932210758f5649c94e0a7758040b48">command</a> = logs[i].<a class="code hl_variable" href="structyh__log__entry.html#ad1932210758f5649c94e0a7758040b48">command</a>;</div>
<div class="line"><span class="lineno"> 4508</span>    inverted.<a class="code hl_variable" href="structyh__log__entry.html#abd847b85c49faf8f3bb88876fe56cf2f">length</a> = htons(logs[i].length);</div>
<div class="line"><span class="lineno"> 4509</span>    inverted.<a class="code hl_variable" href="structyh__log__entry.html#a925f85bbcea7077e632e1699d32dfbe2">session_key</a> = htons(logs[i].session_key);</div>
<div class="line"><span class="lineno"> 4510</span>    inverted.<a class="code hl_variable" href="structyh__log__entry.html#ab866b36403547d518733745c090f69cc">target_key</a> = htons(logs[i].target_key);</div>
<div class="line"><span class="lineno"> 4511</span>    inverted.<a class="code hl_variable" href="structyh__log__entry.html#a248294c48b017749865e97c22fee57ce">second_key</a> = htons(logs[i].second_key);</div>
<div class="line"><span class="lineno"> 4512</span>    inverted.<a class="code hl_variable" href="structyh__log__entry.html#a31bb67d7241b0cdd25d36cee65d4b6da">result</a> = logs[i].<a class="code hl_variable" href="structyh__log__entry.html#a31bb67d7241b0cdd25d36cee65d4b6da">result</a>;</div>
<div class="line"><span class="lineno"> 4513</span>    inverted.<a class="code hl_variable" href="structyh__log__entry.html#a32bf3bd463165110201f585222616ee4">systick</a> = htonl(logs[i].systick);</div>
<div class="line"><span class="lineno"> 4514</span> </div>
<div class="line"><span class="lineno"> 4515</span>    <a class="code hl_function" href="hash_8c.html#a6146398e6f54347faf3e9c4e6c7cde7b">hash_init</a>(hashctx);</div>
<div class="line"><span class="lineno"> 4516</span>    <a class="code hl_function" href="hash_8c.html#a00c3b2f60d87f408d16804b22c4fd2c2">hash_update</a>(hashctx, (<span class="keyword">const</span> <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *) &amp;inverted,</div>
<div class="line"><span class="lineno"> 4517</span>                <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structyh__log__entry.html">yh_log_entry</a>) - <a class="code hl_define" href="yubihsm_8h.html#a289ca46f5ef481980f0fad98d727e87a">YH_LOG_DIGEST_SIZE</a>);</div>
<div class="line"><span class="lineno"> 4518</span>    <a class="code hl_function" href="hash_8c.html#a00c3b2f60d87f408d16804b22c4fd2c2">hash_update</a>(hashctx, previous_hash, <a class="code hl_define" href="yubihsm_8h.html#a289ca46f5ef481980f0fad98d727e87a">YH_LOG_DIGEST_SIZE</a>);</div>
<div class="line"><span class="lineno"> 4519</span>    <a class="code hl_function" href="hash_8c.html#aa23c36aa0b4bb19de4bbeaa64720e494">hash_final</a>(hashctx, previous_hash, &amp;previous_hash_len);</div>
<div class="line"><span class="lineno"> 4520</span> </div>
<div class="line"><span class="lineno"> 4521</span>    <span class="keywordflow">if</span> (memcmp(logs[i].digest, previous_hash, <a class="code hl_define" href="yubihsm_8h.html#a289ca46f5ef481980f0fad98d727e87a">YH_LOG_DIGEST_SIZE</a>) != 0) {</div>
<div class="line"><span class="lineno"> 4522</span>      <span class="keywordflow">goto</span> out;</div>
<div class="line"><span class="lineno"> 4523</span>    }</div>
<div class="line"><span class="lineno"> 4524</span>  }</div>
<div class="line"><span class="lineno"> 4525</span> </div>
<div class="line"><span class="lineno"> 4526</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a3d854b6efad16a16e4d7b4539d4fc71f">ret</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 4527</span> </div>
<div class="line"><span class="lineno"> 4528</span>out:</div>
<div class="line"><span class="lineno"> 4529</span>  <a class="code hl_function" href="hash_8c.html#a9d8dba1d151d3db0137137a845bccc8b">hash_destroy</a>(hashctx);</div>
<div class="line"><span class="lineno"> 4530</span>  hashctx = NULL;</div>
<div class="line"><span class="lineno"> 4531</span> </div>
<div class="line"><span class="lineno"> 4532</span>  <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a3d854b6efad16a16e4d7b4539d4fc71f">ret</a>;</div>
<div class="line"><span class="lineno"> 4533</span>}</div>
<div class="ttc" id="ahash_8c_html_a00c3b2f60d87f408d16804b22c4fd2c2"><div class="ttname"><a href="hash_8c.html#a00c3b2f60d87f408d16804b22c4fd2c2">hash_update</a></div><div class="ttdeci">bool hash_update(_hash_ctx *ctx, const uint8_t *in, size_t cb_in)</div><div class="ttdef"><b>Definition</b> <a href="hash_8c_source.html#l00319">hash.c:319</a></div></div>
<div class="ttc" id="ahash_8c_html_a3cc1419f3a2f6401e22e8b339b73c609"><div class="ttname"><a href="hash_8c.html#a3cc1419f3a2f6401e22e8b339b73c609">hash_create</a></div><div class="ttdeci">bool hash_create(_hash_ctx **ctx, hash_t hash)</div><div class="ttdef"><b>Definition</b> <a href="hash_8c_source.html#l00189">hash.c:189</a></div></div>
<div class="ttc" id="ahash_8c_html_a6146398e6f54347faf3e9c4e6c7cde7b"><div class="ttname"><a href="hash_8c.html#a6146398e6f54347faf3e9c4e6c7cde7b">hash_init</a></div><div class="ttdeci">bool hash_init(_hash_ctx *ctx)</div><div class="ttdef"><b>Definition</b> <a href="hash_8c_source.html#l00294">hash.c:294</a></div></div>
<div class="ttc" id="ahash_8c_html_a9d8dba1d151d3db0137137a845bccc8b"><div class="ttname"><a href="hash_8c.html#a9d8dba1d151d3db0137137a845bccc8b">hash_destroy</a></div><div class="ttdeci">bool hash_destroy(_hash_ctx *ctx)</div><div class="ttdef"><b>Definition</b> <a href="hash_8c_source.html#l00387">hash.c:387</a></div></div>
<div class="ttc" id="ahash_8c_html_aa23c36aa0b4bb19de4bbeaa64720e494"><div class="ttname"><a href="hash_8c.html#aa23c36aa0b4bb19de4bbeaa64720e494">hash_final</a></div><div class="ttdeci">bool hash_final(_hash_ctx *ctx, uint8_t *out, size_t *pcb_out)</div><div class="ttdef"><b>Definition</b> <a href="hash_8c_source.html#l00351">hash.c:351</a></div></div>
<div class="ttc" id="anamespace_w_a_s_m_html_a9690a14428419003297ae35f505b5103aea2b2676c28c0db26d39331a336c6b92"><div class="ttname"><a href="namespace_w_a_s_m.html#a9690a14428419003297ae35f505b5103aea2b2676c28c0db26d39331a336c6b92">WASM::SectionType::start</a></div><div class="ttdeci">@ start</div></div>
<div class="ttc" id="astruct__hash__ctx_html"><div class="ttname"><a href="struct__hash__ctx.html">_hash_ctx</a></div><div class="ttdef"><b>Definition</b> <a href="hash_8c_source.html#l00027">hash.c:27</a></div></div>
<div class="ttc" id="astructyh__log__entry_html_a0e8ca2892b29342aa721e5a9917fabed"><div class="ttname"><a href="structyh__log__entry.html#a0e8ca2892b29342aa721e5a9917fabed">yh_log_entry::digest</a></div><div class="ttdeci">uint8_t digest[YH_LOG_DIGEST_SIZE]</div><div class="ttdoc">Truncated sha256 digest of this last digest + this entry.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00534">yubihsm.h:534</a></div></div>
<div class="ttc" id="astructyh__log__entry_html_a248294c48b017749865e97c22fee57ce"><div class="ttname"><a href="structyh__log__entry.html#a248294c48b017749865e97c22fee57ce">yh_log_entry::second_key</a></div><div class="ttdeci">uint16_t second_key</div><div class="ttdoc">ID of second Object used.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00528">yubihsm.h:528</a></div></div>
<div class="ttc" id="astructyh__log__entry_html_a31bb67d7241b0cdd25d36cee65d4b6da"><div class="ttname"><a href="structyh__log__entry.html#a31bb67d7241b0cdd25d36cee65d4b6da">yh_log_entry::result</a></div><div class="ttdeci">uint8_t result</div><div class="ttdoc">Command result.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00530">yubihsm.h:530</a></div></div>
<div class="ttc" id="astructyh__log__entry_html_a32bf3bd463165110201f585222616ee4"><div class="ttname"><a href="structyh__log__entry.html#a32bf3bd463165110201f585222616ee4">yh_log_entry::systick</a></div><div class="ttdeci">uint32_t systick</div><div class="ttdoc">Systick at time of execution.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00532">yubihsm.h:532</a></div></div>
<div class="ttc" id="astructyh__log__entry_html_a925f85bbcea7077e632e1699d32dfbe2"><div class="ttname"><a href="structyh__log__entry.html#a925f85bbcea7077e632e1699d32dfbe2">yh_log_entry::session_key</a></div><div class="ttdeci">uint16_t session_key</div><div class="ttdoc">ID of Authentication Key used.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00524">yubihsm.h:524</a></div></div>
<div class="ttc" id="astructyh__log__entry_html_ab866b36403547d518733745c090f69cc"><div class="ttname"><a href="structyh__log__entry.html#ab866b36403547d518733745c090f69cc">yh_log_entry::target_key</a></div><div class="ttdeci">uint16_t target_key</div><div class="ttdoc">ID of first Object used.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00526">yubihsm.h:526</a></div></div>
<div class="ttc" id="astructyh__log__entry_html_abd847b85c49faf8f3bb88876fe56cf2f"><div class="ttname"><a href="structyh__log__entry.html#abd847b85c49faf8f3bb88876fe56cf2f">yh_log_entry::length</a></div><div class="ttdeci">uint16_t length</div><div class="ttdoc">Length of in-data.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00522">yubihsm.h:522</a></div></div>
<div class="ttc" id="astructyh__log__entry_html_ad1932210758f5649c94e0a7758040b48"><div class="ttname"><a href="structyh__log__entry.html#ad1932210758f5649c94e0a7758040b48">yh_log_entry::command</a></div><div class="ttdeci">uint8_t command</div><div class="ttdoc">What command was executed.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00520">yubihsm.h:520</a></div></div>
<div class="ttc" id="astructyh__log__entry_html_adbdbdd10828646a96f67438062c909c8"><div class="ttname"><a href="structyh__log__entry.html#adbdbdd10828646a96f67438062c909c8">yh_log_entry::number</a></div><div class="ttdeci">uint16_t number</div><div class="ttdoc">Monotonically increasing index.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00518">yubihsm.h:518</a></div></div>
<div class="ttc" id="ayubihsm_2common_2hash_8h_html_a488906826f8aaf7e850c35889d560089af0ab1a9d65ceafa4ba1f6f177e379258"><div class="ttname"><a href="yubihsm_2common_2hash_8h.html#a488906826f8aaf7e850c35889d560089af0ab1a9d65ceafa4ba1f6f177e379258">_SHA256</a></div><div class="ttdeci">@ _SHA256</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_2common_2hash_8h_source.html#l00036">hash.h:36</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a3d854b6efad16a16e4d7b4539d4fc71f"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a3d854b6efad16a16e4d7b4539d4fc71f">ret</a></div><div class="ttdeci">CK_RV ret</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l00973">yubihsm_pkcs11.c:973</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a00b81c3c9ca2964a672b7b0b725925e4_cgraph.png" border="0" usemap="#ayubihsm_8c_a00b81c3c9ca2964a672b7b0b725925e4_cgraph" alt=""/></div>
<map name="ayubihsm_8c_a00b81c3c9ca2964a672b7b0b725925e4_cgraph" id="ayubihsm_8c_a00b81c3c9ca2964a672b7b0b725925e4_cgraph">
<area shape="rect" title=" " alt="" coords="5,131,111,156"/>
<area shape="rect" href="hash_8c.html#a3cc1419f3a2f6401e22e8b339b73c609" title=" " alt="" coords="162,5,254,31"/>
<area shape="poly" title=" " alt="" coords="68,129,105,87,157,40,161,37,164,42,160,44,109,90,72,132"/>
<area shape="rect" href="hash_8c.html#a9d8dba1d151d3db0137137a845bccc8b" title=" " alt="" coords="159,55,258,80"/>
<area shape="poly" title=" " alt="" coords="84,128,166,85,169,90,87,132"/>
<area shape="rect" href="hash_8c.html#aa23c36aa0b4bb19de4bbeaa64720e494" title=" " alt="" coords="306,131,386,156"/>
<area shape="poly" title=" " alt="" coords="111,141,290,141,290,146,111,146"/>
<area shape="rect" href="hash_8c.html#a6146398e6f54347faf3e9c4e6c7cde7b" title=" " alt="" coords="172,156,245,182"/>
<area shape="poly" title=" " alt="" coords="111,150,157,158,156,163,111,155"/>
<area shape="rect" href="hash_8c.html#a00c3b2f60d87f408d16804b22c4fd2c2" title=" " alt="" coords="161,205,256,231"/>
<area shape="poly" title=" " alt="" coords="87,155,160,192,167,196,165,200,157,197,84,159"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="173,255,244,280"/>
<area shape="poly" title=" " alt="" coords="72,155,109,196,160,241,165,245,162,249,157,246,105,200,68,159"/>
<area shape="rect" href="hash_8c.html#a2de35447908a9afccca42825a87854fb" title=" " alt="" coords="309,5,383,31"/>
<area shape="poly" title=" " alt="" coords="255,16,294,16,294,21,255,21"/>
<area shape="poly" title=" " alt="" coords="245,159,290,151,291,156,246,165"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="yubihsm_8c_a00b81c3c9ca2964a672b7b0b725925e4_icgraph.png" border="0" usemap="#ayubihsm_8c_a00b81c3c9ca2964a672b7b0b725925e4_icgraph" alt=""/></div>
<map name="ayubihsm_8c_a00b81c3c9ca2964a672b7b0b725925e4_icgraph" id="ayubihsm_8c_a00b81c3c9ca2964a672b7b0b725925e4_icgraph">
<area shape="rect" title=" " alt="" coords="103,5,208,31"/>
<area shape="rect" href="logs_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="5,5,55,31"/>
<area shape="poly" title=" " alt="" coords="87,21,55,21,55,16,87,16"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a53dbe31d2d75719fb2b97437fcb42f2a" name="a53dbe31d2d75719fb2b97437fcb42f2a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53dbe31d2d75719fb2b97437fcb42f2a">&#9670;&#160;</a></span>YH_INTERNAL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">FILE* <a class="el" href="debug__lib_8h.html#a76ba6bc136c2b38b71a9e3c56282cd3a">_yh_output</a> YH_INTERNAL = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="yubihsm_8c_source.html#l00057">57</a> of file <a class="el" href="yubihsm_8c_source.html">yubihsm.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_428556e0652617aa37d2f7d8bcaf7fdf.html">libraries</a></li><li class="navelem"><a class="el" href="dir_63c6fe01b05f3098165849fc89c17214.html">yubihsm</a></li><li class="navelem"><a class="el" href="dir_972445ff1c6fd6b40da37ec96cd4b819.html">lib</a></li><li class="navelem"><a class="el" href="yubihsm_8c.html">yubihsm.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0 </li>
  </ul>
</div>
</body>
</html>
