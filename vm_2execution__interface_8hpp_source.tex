\doxysection{execution\+\_\+interface.\+hpp}
\hypertarget{vm_2execution__interface_8hpp_source}{}\label{vm_2execution__interface_8hpp_source}\index{libraries/sys-\/vm/include/sysio/vm/execution\_interface.hpp@{libraries/sys-\/vm/include/sysio/vm/execution\_interface.hpp}}
\mbox{\hyperlink{vm_2execution__interface_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{vm_2execution__interface_8hpp_source_l00001}00001\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{\Hypertarget{vm_2execution__interface_8hpp_source_l00002}00002\ }
\DoxyCodeLine{\Hypertarget{vm_2execution__interface_8hpp_source_l00003}00003\ \textcolor{preprocessor}{\#include\ <sysio/vm/wasm\_stack.hpp>}}
\DoxyCodeLine{\Hypertarget{vm_2execution__interface_8hpp_source_l00004}00004\ \textcolor{preprocessor}{\#include\ <sysio/vm/utils.hpp>}}
\DoxyCodeLine{\Hypertarget{vm_2execution__interface_8hpp_source_l00005}00005\ \textcolor{preprocessor}{\#include\ <sysio/vm/exceptions.hpp>}}
\DoxyCodeLine{\Hypertarget{vm_2execution__interface_8hpp_source_l00006}00006\ \textcolor{preprocessor}{\#include\ <cstring>}}
\DoxyCodeLine{\Hypertarget{vm_2execution__interface_8hpp_source_l00007}00007\ \textcolor{preprocessor}{\#include\ <limits>}}
\DoxyCodeLine{\Hypertarget{vm_2execution__interface_8hpp_source_l00008}00008\ }
\DoxyCodeLine{\Hypertarget{vm_2execution__interface_8hpp_source_l00009}00009\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacesysio}{sysio}}\ \{\ \textcolor{keyword}{namespace\ }vm\ \{}
\DoxyCodeLine{\Hypertarget{vm_2execution__interface_8hpp_source_l00010}00010\ }
\DoxyCodeLine{\Hypertarget{vm_2execution__interface_8hpp_source_l00011}00011\ \ \ \ \textcolor{comment}{//\ interface\ used\ for\ the\ host\ function\ system\ to\ use}}
\DoxyCodeLine{\Hypertarget{vm_2execution__interface_8hpp_source_l00012}00012\ \ \ \ \textcolor{comment}{//\ clients\ can\ create\ their\ own\ interface\ to\ overlay\ their\ own\ implementations}}
\DoxyCodeLine{\Hypertarget{vm_2execution__interface_8hpp_source_l00013}\mbox{\hyperlink{structsysio_1_1vm_1_1execution__interface}{00013}}\ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structsysio_1_1vm_1_1execution__interface}{execution\_interface}}\ \{}
\DoxyCodeLine{\Hypertarget{vm_2execution__interface_8hpp_source_l00014}\mbox{\hyperlink{structsysio_1_1vm_1_1execution__interface_a6f30f7ec6697931179c396b8152d9b31}{00014}}\ \ \ \ \ \ \ \textcolor{keyword}{inline}\ \mbox{\hyperlink{structsysio_1_1vm_1_1execution__interface_a6f30f7ec6697931179c396b8152d9b31}{execution\_interface}}(\ \textcolor{keywordtype}{char}*\ \mbox{\hyperlink{structsysio_1_1vm_1_1execution__interface_aee156e49ed42e090ea0950672b22906e}{memory}},\ \mbox{\hyperlink{classsysio_1_1vm_1_1stack}{operand\_stack}}*\ \mbox{\hyperlink{structsysio_1_1vm_1_1execution__interface_ab9a372ed9206cf89b9b1dc2383a72157}{os}}\ )\ :\ \mbox{\hyperlink{structsysio_1_1vm_1_1execution__interface_aee156e49ed42e090ea0950672b22906e}{memory}}(\mbox{\hyperlink{structsysio_1_1vm_1_1execution__interface_aee156e49ed42e090ea0950672b22906e}{memory}}),\ \mbox{\hyperlink{structsysio_1_1vm_1_1execution__interface_ab9a372ed9206cf89b9b1dc2383a72157}{os}}(\mbox{\hyperlink{structsysio_1_1vm_1_1execution__interface_ab9a372ed9206cf89b9b1dc2383a72157}{os}})\ \{\}}
\DoxyCodeLine{\Hypertarget{vm_2execution__interface_8hpp_source_l00015}\mbox{\hyperlink{structsysio_1_1vm_1_1execution__interface_a15cc2cd83df3c0e6572c58f325d4c482}{00015}}\ \ \ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}*\ \mbox{\hyperlink{structsysio_1_1vm_1_1execution__interface_a15cc2cd83df3c0e6572c58f325d4c482}{get\_memory}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structsysio_1_1vm_1_1execution__interface_aee156e49ed42e090ea0950672b22906e}{memory}};\ \}}
\DoxyCodeLine{\Hypertarget{vm_2execution__interface_8hpp_source_l00016}\mbox{\hyperlink{structsysio_1_1vm_1_1execution__interface_a209bec8b3138d230fe2aae2385bc567c}{00016}}\ \ \ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structsysio_1_1vm_1_1execution__interface_a209bec8b3138d230fe2aae2385bc567c}{trim\_operands}}(std::size\_t\ amt)\ \{\ \mbox{\hyperlink{structsysio_1_1vm_1_1execution__interface_ab9a372ed9206cf89b9b1dc2383a72157}{os}}-\/>\mbox{\hyperlink{classsysio_1_1vm_1_1stack_adc4a93eafdcbf2f3526d11bdbe0cc126}{trim}}(amt);\ \}}
\DoxyCodeLine{\Hypertarget{vm_2execution__interface_8hpp_source_l00017}00017\ }
\DoxyCodeLine{\Hypertarget{vm_2execution__interface_8hpp_source_l00018}00018\ \ \ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{\Hypertarget{vm_2execution__interface_8hpp_source_l00019}\mbox{\hyperlink{structsysio_1_1vm_1_1execution__interface_a2b8ae377145c591c5d199c4d91e71c64}{00019}}\ \ \ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structsysio_1_1vm_1_1execution__interface_a2b8ae377145c591c5d199c4d91e71c64}{push\_operand}}(\mbox{\hyperlink{prettywritertest_8cpp_a6283df8c4e365cc8a01727e2d7ad44bf}{T}}\&\&\ \mbox{\hyperlink{unionop}{op}})\ \{\ \mbox{\hyperlink{structsysio_1_1vm_1_1execution__interface_ab9a372ed9206cf89b9b1dc2383a72157}{os}}-\/>\mbox{\hyperlink{classsysio_1_1vm_1_1stack_a6622e50cf34d892c701d2085faa53f8e}{push}}(std::forward<T>(\mbox{\hyperlink{unionop}{op}}));\ \}}
\DoxyCodeLine{\Hypertarget{vm_2execution__interface_8hpp_source_l00020}\mbox{\hyperlink{structsysio_1_1vm_1_1execution__interface_a25821ae413bb8e693deac653c82ddd95}{00020}}\ \ \ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keyword}{auto}\ \mbox{\hyperlink{structsysio_1_1vm_1_1execution__interface_a25821ae413bb8e693deac653c82ddd95}{pop\_operand}}()\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structsysio_1_1vm_1_1execution__interface_ab9a372ed9206cf89b9b1dc2383a72157}{os}}-\/>\mbox{\hyperlink{classsysio_1_1vm_1_1stack_ae9a715af8918e2e59bf5256632c6b7b1}{pop}}();\ \}}
\DoxyCodeLine{\Hypertarget{vm_2execution__interface_8hpp_source_l00021}\mbox{\hyperlink{structsysio_1_1vm_1_1execution__interface_ac5ab9433c402a92f88dbcb9e1bf02108}{00021}}\ \ \ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ \mbox{\hyperlink{structsysio_1_1vm_1_1execution__interface_ac5ab9433c402a92f88dbcb9e1bf02108}{operand\_from\_back}}(std::size\_t\ index)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structsysio_1_1vm_1_1execution__interface_ab9a372ed9206cf89b9b1dc2383a72157}{os}}-\/>\mbox{\hyperlink{classsysio_1_1vm_1_1stack_a062d42c4ce4359ef87c6a53267796d4d}{get\_back}}(index);\ \}}
\DoxyCodeLine{\Hypertarget{vm_2execution__interface_8hpp_source_l00022}00022\ }
\DoxyCodeLine{\Hypertarget{vm_2execution__interface_8hpp_source_l00023}00023\ \ \ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{\Hypertarget{vm_2execution__interface_8hpp_source_l00024}\mbox{\hyperlink{structsysio_1_1vm_1_1execution__interface_aa226d8c9bc28da78dca896d499136780}{00024}}\ \ \ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}*\ \mbox{\hyperlink{structsysio_1_1vm_1_1execution__interface_aa226d8c9bc28da78dca896d499136780}{validate\_pointer}}(\mbox{\hyperlink{namespacesysio_1_1vm_a82e706727e849ccc38e1c8e7888c1609}{wasm\_ptr\_t}}\ ptr,\ \mbox{\hyperlink{namespacesysio_1_1vm_ab7d81f47e123ef4970d3e643196660ea}{wasm\_size\_t}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a7360b55975153b822efc5217b7734e6a}{len}})\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{\Hypertarget{vm_2execution__interface_8hpp_source_l00025}00025\ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ result\ =\ \mbox{\hyperlink{structsysio_1_1vm_1_1execution__interface_aee156e49ed42e090ea0950672b22906e}{memory}}\ +\ ptr;}
\DoxyCodeLine{\Hypertarget{vm_2execution__interface_8hpp_source_l00026}00026\ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structsysio_1_1vm_1_1execution__interface_aa226d8c9bc28da78dca896d499136780}{validate\_pointer<T>}}(result,\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a7360b55975153b822efc5217b7734e6a}{len}});}
\DoxyCodeLine{\Hypertarget{vm_2execution__interface_8hpp_source_l00027}00027\ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{\Hypertarget{vm_2execution__interface_8hpp_source_l00028}00028\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{vm_2execution__interface_8hpp_source_l00029}00029\ }
\DoxyCodeLine{\Hypertarget{vm_2execution__interface_8hpp_source_l00030}00030\ \ \ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{\Hypertarget{vm_2execution__interface_8hpp_source_l00031}\mbox{\hyperlink{structsysio_1_1vm_1_1execution__interface_ab27e50adf88011911f5aab31cdaa90c4}{00031}}\ \ \ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structsysio_1_1vm_1_1execution__interface_ab27e50adf88011911f5aab31cdaa90c4}{validate\_pointer}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{void}*\ ptr,\ \mbox{\hyperlink{namespacesysio_1_1vm_ab7d81f47e123ef4970d3e643196660ea}{wasm\_size\_t}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a7360b55975153b822efc5217b7734e6a}{len}})\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{\Hypertarget{vm_2execution__interface_8hpp_source_l00032}00032\ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{sys-vm_2include_2sysio_2sysio_2vm_2exceptions_8hpp_a2b63f5625ff6dcb6dedeb3ae08c4584a}{SYS\_VM\_ASSERT}}(\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a7360b55975153b822efc5217b7734e6a}{len}}\ <=\ std::numeric\_limits<wasm\_size\_t>::max()\ /\ (\mbox{\hyperlink{namespacesysio_1_1vm_ab7d81f47e123ef4970d3e643196660ea}{wasm\_size\_t}})\textcolor{keyword}{sizeof}(\mbox{\hyperlink{prettywritertest_8cpp_a6283df8c4e365cc8a01727e2d7ad44bf}{T}}),\ wasm\_interpreter\_exception,\ \textcolor{stringliteral}{"{}length\ will\ overflow"{}}\ );}
\DoxyCodeLine{\Hypertarget{vm_2execution__interface_8hpp_source_l00033}00033\ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{volatile}\ \textcolor{keyword}{auto}\ check\_addr\ =\ *(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }\textcolor{keywordtype}{char}*\textcolor{keyword}{>}(ptr)\ +\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a7360b55975153b822efc5217b7734e6a}{len}}\ *\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{prettywritertest_8cpp_a6283df8c4e365cc8a01727e2d7ad44bf}{T}}))\ -\/\ 1);}
\DoxyCodeLine{\Hypertarget{vm_2execution__interface_8hpp_source_l00034}00034\ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesysio_1_1vm_a54ec5a188f3bccc28c33687d74736bdf}{ignore\_unused\_variable\_warning}}(check\_addr);}
\DoxyCodeLine{\Hypertarget{vm_2execution__interface_8hpp_source_l00035}00035\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{vm_2execution__interface_8hpp_source_l00036}00036\ }
\DoxyCodeLine{\Hypertarget{vm_2execution__interface_8hpp_source_l00037}\mbox{\hyperlink{structsysio_1_1vm_1_1execution__interface_a5cbc04a72bafb4d0cfb32453991258af}{00037}}\ \ \ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}*\ \mbox{\hyperlink{structsysio_1_1vm_1_1execution__interface_a5cbc04a72bafb4d0cfb32453991258af}{validate\_null\_terminated\_pointer}}(\mbox{\hyperlink{namespacesysio_1_1vm_a82e706727e849ccc38e1c8e7888c1609}{wasm\_ptr\_t}}\ ptr)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{\Hypertarget{vm_2execution__interface_8hpp_source_l00038}00038\ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ result\ =\ \mbox{\hyperlink{structsysio_1_1vm_1_1execution__interface_aee156e49ed42e090ea0950672b22906e}{memory}}\ +\ ptr;}
\DoxyCodeLine{\Hypertarget{vm_2execution__interface_8hpp_source_l00039}00039\ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structsysio_1_1vm_1_1execution__interface_a5cbc04a72bafb4d0cfb32453991258af}{validate\_null\_terminated\_pointer}}(result);}
\DoxyCodeLine{\Hypertarget{vm_2execution__interface_8hpp_source_l00040}00040\ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{\Hypertarget{vm_2execution__interface_8hpp_source_l00041}00041\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{vm_2execution__interface_8hpp_source_l00042}00042\ }
\DoxyCodeLine{\Hypertarget{vm_2execution__interface_8hpp_source_l00043}\mbox{\hyperlink{structsysio_1_1vm_1_1execution__interface_ae232261f5e82de248bfd4b92523c1948}{00043}}\ \ \ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structsysio_1_1vm_1_1execution__interface_ae232261f5e82de248bfd4b92523c1948}{validate\_null\_terminated\_pointer}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{void}*\ ptr)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{\Hypertarget{vm_2execution__interface_8hpp_source_l00044}00044\ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{volatile}\ \textcolor{keyword}{auto}\ check\_addr\ =\ std::strlen(\textcolor{keyword}{static\_cast<}\textcolor{keyword}{const\ }\textcolor{keywordtype}{char}*\textcolor{keyword}{>}(ptr));}
\DoxyCodeLine{\Hypertarget{vm_2execution__interface_8hpp_source_l00045}00045\ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesysio_1_1vm_a54ec5a188f3bccc28c33687d74736bdf}{ignore\_unused\_variable\_warning}}(check\_addr);}
\DoxyCodeLine{\Hypertarget{vm_2execution__interface_8hpp_source_l00046}00046\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{vm_2execution__interface_8hpp_source_l00047}00047\ \ \ \ \ \ \ \textcolor{keywordtype}{char}*\ \mbox{\hyperlink{structsysio_1_1vm_1_1execution__interface_aee156e49ed42e090ea0950672b22906e}{memory}};}
\DoxyCodeLine{\Hypertarget{vm_2execution__interface_8hpp_source_l00048}00048\ \ \ \ \ \ \ \mbox{\hyperlink{classsysio_1_1vm_1_1stack}{operand\_stack}}*\ \mbox{\hyperlink{structsysio_1_1vm_1_1execution__interface_ab9a372ed9206cf89b9b1dc2383a72157}{os}};}
\DoxyCodeLine{\Hypertarget{vm_2execution__interface_8hpp_source_l00049}00049\ \ \ \ \};}
\DoxyCodeLine{\Hypertarget{vm_2execution__interface_8hpp_source_l00050}00050\ \}\}\ \textcolor{comment}{//\ ns\ sysio::vm}}

\end{DoxyCode}
