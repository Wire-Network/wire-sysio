\doxysection{libraries/fc/test/crypto/test\+\_\+webauthn.cpp File Reference}
\hypertarget{test__webauthn_8cpp}{}\label{test__webauthn_8cpp}\index{libraries/fc/test/crypto/test\_webauthn.cpp@{libraries/fc/test/crypto/test\_webauthn.cpp}}
{\ttfamily \#include $<$boost/test/included/unit\+\_\+test.\+hpp$>$}\newline
{\ttfamily \#include $<$boost/algorithm/string.\+hpp$>$}\newline
{\ttfamily \#include $<$fc/crypto/public\+\_\+key.\+hpp$>$}\newline
{\ttfamily \#include $<$fc/crypto/private\+\_\+key.\+hpp$>$}\newline
{\ttfamily \#include $<$fc/crypto/signature.\+hpp$>$}\newline
{\ttfamily \#include $<$fc/utility.\+hpp$>$}\newline
Include dependency graph for test\+\_\+webauthn.\+cpp\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{test__webauthn_8cpp__incl}
\end{center}
\end{figure}
\doxysubsubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{test__webauthn_8cpp_a6b2a3852db8bb19ab6909bac01859985}{BOOST\+\_\+\+TEST\+\_\+\+MODULE}}~webauthn\+\_\+test\+\_\+mod
\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{test__webauthn_8cpp_a75805940106aba536c48e0c047fc814e}{BOOST\+\_\+\+AUTO\+\_\+\+TEST\+\_\+\+CASE}} (good)
\item 
\mbox{\hyperlink{test__webauthn_8cpp_ae70bfa24f5a3bc0917382b3c17fc033c}{FC\+\_\+\+LOG\+\_\+\+AND\+\_\+\+RETHROW}} ()
\item 
\mbox{\hyperlink{test__webauthn_8cpp_a8f1802f977a71adb7942a40d8e9f6c47}{BOOST\+\_\+\+AUTO\+\_\+\+TEST\+\_\+\+CASE}} (mismatch\+\_\+presence)
\item 
\mbox{\hyperlink{test__webauthn_8cpp_a2a1d2f05f67659071e22f320ef91c0ef}{BOOST\+\_\+\+AUTO\+\_\+\+TEST\+\_\+\+CASE}} (mismatch\+\_\+origin)
\item 
\mbox{\hyperlink{test__webauthn_8cpp_a4b9953c77aafa04553785736c43e07a5}{BOOST\+\_\+\+AUTO\+\_\+\+TEST\+\_\+\+CASE}} (non\+\_\+https)
\item 
\mbox{\hyperlink{test__webauthn_8cpp_a1a4dc27ff697dc8d69cbd8bfd3e41853}{BOOST\+\_\+\+AUTO\+\_\+\+TEST\+\_\+\+CASE}} (lacking\+\_\+scheme)
\item 
\mbox{\hyperlink{test__webauthn_8cpp_a010d0b81ec2257a446d8f9e1a43a4d4f}{BOOST\+\_\+\+AUTO\+\_\+\+TEST\+\_\+\+CASE}} (empty\+\_\+origin)
\item 
\mbox{\hyperlink{test__webauthn_8cpp_aae90fa97d890394d420629752fef64df}{BOOST\+\_\+\+AUTO\+\_\+\+TEST\+\_\+\+CASE}} (good\+\_\+port)
\item 
\mbox{\hyperlink{test__webauthn_8cpp_a4f19eaa04d61bbaa9324ee8d5ada9a90}{BOOST\+\_\+\+AUTO\+\_\+\+TEST\+\_\+\+CASE}} (empty\+\_\+port)
\item 
\mbox{\hyperlink{test__webauthn_8cpp_a0ed9c663c1c7990474cb70a258ec9377}{BOOST\+\_\+\+AUTO\+\_\+\+TEST\+\_\+\+CASE}} (challenge\+\_\+junk)
\item 
\mbox{\hyperlink{test__webauthn_8cpp_af58f9647f13c05324de3b3fa2d6aa328}{BOOST\+\_\+\+AUTO\+\_\+\+TEST\+\_\+\+CASE}} (challenge\+\_\+non\+\_\+base64)
\item 
\mbox{\hyperlink{test__webauthn_8cpp_abd36e135c2332d8f04b795dddc13a2f3}{BOOST\+\_\+\+AUTO\+\_\+\+TEST\+\_\+\+CASE}} (challenge\+\_\+wrong)
\item 
\mbox{\hyperlink{test__webauthn_8cpp_a6d810d26f3a9ea62940516bbcbcf6b90}{BOOST\+\_\+\+AUTO\+\_\+\+TEST\+\_\+\+CASE}} (wrong\+\_\+type)
\item 
\mbox{\hyperlink{test__webauthn_8cpp_ad6a3dcec639ba94708fa05a8d82c891c}{BOOST\+\_\+\+AUTO\+\_\+\+TEST\+\_\+\+CASE}} (auth\+\_\+data\+\_\+rpid\+\_\+hash\+\_\+bad)
\item 
\mbox{\hyperlink{test__webauthn_8cpp_a04cd22b50edfdbf19e9c068f6a7228e3}{BOOST\+\_\+\+AUTO\+\_\+\+TEST\+\_\+\+CASE}} (auth\+\_\+data\+\_\+too\+\_\+short)
\item 
\mbox{\hyperlink{test__webauthn_8cpp_af95c77a48776d8dc9544884aaeaf5946}{BOOST\+\_\+\+AUTO\+\_\+\+TEST\+\_\+\+CASE}} (missing\+\_\+origin)
\item 
\mbox{\hyperlink{test__webauthn_8cpp_a91ac61998bf2fbd672164518842c3dbc}{BOOST\+\_\+\+AUTO\+\_\+\+TEST\+\_\+\+CASE}} (missing\+\_\+type)
\item 
\mbox{\hyperlink{test__webauthn_8cpp_a0c364fa12210f90fb306e3948cd3e5b0}{BOOST\+\_\+\+AUTO\+\_\+\+TEST\+\_\+\+CASE}} (missing\+\_\+challenge)
\item 
\mbox{\hyperlink{test__webauthn_8cpp_a4fa4b484f47ac1bf70c7b2c99a91c9fb}{BOOST\+\_\+\+AUTO\+\_\+\+TEST\+\_\+\+CASE}} (good\+\_\+extrajunk)
\item 
\mbox{\hyperlink{test__webauthn_8cpp_a72e0ee1c4a2abdcc362828f8ca7f119d}{BOOST\+\_\+\+AUTO\+\_\+\+TEST\+\_\+\+CASE}} (not\+\_\+json\+\_\+object)
\item 
\mbox{\hyperlink{test__webauthn_8cpp_ad28a941550711577d070b4c59039fb47}{BOOST\+\_\+\+AUTO\+\_\+\+TEST\+\_\+\+CASE}} (damage\+\_\+sig)
\item 
\mbox{\hyperlink{test__webauthn_8cpp_a3f379acf17a88ae382a683f053192846}{BOOST\+\_\+\+AUTO\+\_\+\+TEST\+\_\+\+CASE}} (damage\+\_\+sig\+\_\+idx)
\item 
\mbox{\hyperlink{test__webauthn_8cpp_a297871fcd73110d766a978fe337ef1e5}{BOOST\+\_\+\+AUTO\+\_\+\+TEST\+\_\+\+CASE}} (different\+\_\+priv\+\_\+key)
\item 
\mbox{\hyperlink{test__webauthn_8cpp_ac9a2e889a79cc815fd3d36b6f8f77724}{BOOST\+\_\+\+AUTO\+\_\+\+TEST\+\_\+\+CASE}} (empty\+\_\+json)
\item 
\mbox{\hyperlink{test__webauthn_8cpp_adc615b5851afd2b6e5668f9311758a45}{BOOST\+\_\+\+AUTO\+\_\+\+TEST\+\_\+\+CASE}} (empty\+\_\+rpid)
\item 
\mbox{\hyperlink{test__webauthn_8cpp_a15cf1d57bbd4118800b640e96c012cd2}{BOOST\+\_\+\+AUTO\+\_\+\+TEST\+\_\+\+CASE}} (good\+\_\+no\+\_\+trailing\+\_\+equal)
\item 
\mbox{\hyperlink{test__webauthn_8cpp_a4567990f83744a1b06c7894321f28f7b}{BOOST\+\_\+\+AUTO\+\_\+\+TEST\+\_\+\+CASE}} (base64\+\_\+wonky)
\end{DoxyCompactItemize}


\doxysubsection{Macro Definition Documentation}
\Hypertarget{test__webauthn_8cpp_a6b2a3852db8bb19ab6909bac01859985}\index{test\_webauthn.cpp@{test\_webauthn.cpp}!BOOST\_TEST\_MODULE@{BOOST\_TEST\_MODULE}}
\index{BOOST\_TEST\_MODULE@{BOOST\_TEST\_MODULE}!test\_webauthn.cpp@{test\_webauthn.cpp}}
\doxysubsubsection{\texorpdfstring{BOOST\_TEST\_MODULE}{BOOST\_TEST\_MODULE}}
{\footnotesize\ttfamily \label{test__webauthn_8cpp_a6b2a3852db8bb19ab6909bac01859985} 
\#define BOOST\+\_\+\+TEST\+\_\+\+MODULE~webauthn\+\_\+test\+\_\+mod}



Definition at line \mbox{\hyperlink{test__webauthn_8cpp_source_l00001}{1}} of file \mbox{\hyperlink{test__webauthn_8cpp_source}{test\+\_\+webauthn.\+cpp}}.



\doxysubsection{Function Documentation}
\Hypertarget{test__webauthn_8cpp_ad6a3dcec639ba94708fa05a8d82c891c}\index{test\_webauthn.cpp@{test\_webauthn.cpp}!BOOST\_AUTO\_TEST\_CASE@{BOOST\_AUTO\_TEST\_CASE}}
\index{BOOST\_AUTO\_TEST\_CASE@{BOOST\_AUTO\_TEST\_CASE}!test\_webauthn.cpp@{test\_webauthn.cpp}}
\doxysubsubsection{\texorpdfstring{BOOST\_AUTO\_TEST\_CASE()}{BOOST\_AUTO\_TEST\_CASE()}\hspace{0.1cm}{\footnotesize\ttfamily [1/26]}}
{\footnotesize\ttfamily \label{test__webauthn_8cpp_ad6a3dcec639ba94708fa05a8d82c891c} 
BOOST\+\_\+\+AUTO\+\_\+\+TEST\+\_\+\+CASE (\begin{DoxyParamCaption}\item[{auth\+\_\+data\+\_\+rpid\+\_\+hash\+\_\+bad}]{}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{test__webauthn_8cpp_source_l00199}{199}} of file \mbox{\hyperlink{test__webauthn_8cpp_source}{test\+\_\+webauthn.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00199\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00200\ \ \ \ \mbox{\hyperlink{classfc_1_1crypto_1_1webauthn_1_1public__key}{webauthn::public\_key}}\ wa\_pub(pub.serialize(),\ webauthn::public\_key::user\_presence\_t::USER\_PRESENCE\_NONE,\ \textcolor{stringliteral}{"{}fctesting.invalid"{}});}
\DoxyCodeLine{00201\ \ \ \ std::string\ \mbox{\hyperlink{classfc_1_1json}{json}}\ =\ \textcolor{stringliteral}{"{}\{\(\backslash\)"{}origin\(\backslash\)"{}:\(\backslash\)"{}https://fctesting.invalid\(\backslash\)"{},\(\backslash\)"{}type\(\backslash\)"{}:\(\backslash\)"{}webauthn.get\(\backslash\)"{},\(\backslash\)"{}challenge\(\backslash\)"{}:\(\backslash\)"{}"{}}\ +\ \mbox{\hyperlink{namespacefc_a4d30681e99b9cacc0c9b3b8985a5daa4}{fc::base64url\_encode}}(d.\mbox{\hyperlink{classfc_1_1sha256_ab897537f6c524085b28049be51ed370d}{data}}(),\ d.\mbox{\hyperlink{classfc_1_1sha256_ac7722b7428b1db345f1b7fab7f4d5774}{data\_size}}())\ +\ \textcolor{stringliteral}{"{}\(\backslash\)"{}\}"{}};}
\DoxyCodeLine{00202\ }
\DoxyCodeLine{00203\ \ \ \ std::vector<uint8\_t>\ auth\_data(37);}
\DoxyCodeLine{00204\ \ \ \ \mbox{\hyperlink{classfc_1_1sha256}{fc::sha256}}\ origin\_hash\_corrupt\ =\ \mbox{\hyperlink{classfc_1_1sha256_a474784de7d6213b855abd7e952df5e36}{fc::sha256::hash}}(\textcolor{stringliteral}{"{}fctesting.invalid"{}}\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}});}
\DoxyCodeLine{00205\ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(auth\_data.data(),\ origin\_hash\_corrupt.\mbox{\hyperlink{classfc_1_1sha256_ab897537f6c524085b28049be51ed370d}{data}}(),\ \textcolor{keyword}{sizeof}(origin\_hash\_corrupt));}
\DoxyCodeLine{00206\ \ \ \ auth\_data[4]++;}
\DoxyCodeLine{00207\ }
\DoxyCodeLine{00208\ \ \ \ BOOST\_CHECK\_EXCEPTION(make\_webauthn\_sig(priv,\ auth\_data,\ \mbox{\hyperlink{classfc_1_1json}{json}}).recover(d,\ \textcolor{keyword}{true}),\ fc::assert\_exception,\ [](\textcolor{keyword}{const}\ fc::assert\_exception\&\ e)\ \{}
\DoxyCodeLine{00209\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ e.to\_detail\_string().find(\textcolor{stringliteral}{"{}webauthn\ rpid\ hash\ doesn't\ match\ origin"{}})\ !=\ std::string::npos;}
\DoxyCodeLine{00210\ \ \ \ \});}
\DoxyCodeLine{00211\ \}\ \mbox{\hyperlink{test__webauthn_8cpp_ae70bfa24f5a3bc0917382b3c17fc033c}{FC\_LOG\_AND\_RETHROW}}();}

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{test__webauthn_8cpp_ad6a3dcec639ba94708fa05a8d82c891c_cgraph}
\end{center}
\end{figure}
\Hypertarget{test__webauthn_8cpp_a04cd22b50edfdbf19e9c068f6a7228e3}\index{test\_webauthn.cpp@{test\_webauthn.cpp}!BOOST\_AUTO\_TEST\_CASE@{BOOST\_AUTO\_TEST\_CASE}}
\index{BOOST\_AUTO\_TEST\_CASE@{BOOST\_AUTO\_TEST\_CASE}!test\_webauthn.cpp@{test\_webauthn.cpp}}
\doxysubsubsection{\texorpdfstring{BOOST\_AUTO\_TEST\_CASE()}{BOOST\_AUTO\_TEST\_CASE()}\hspace{0.1cm}{\footnotesize\ttfamily [2/26]}}
{\footnotesize\ttfamily \label{test__webauthn_8cpp_a04cd22b50edfdbf19e9c068f6a7228e3} 
BOOST\+\_\+\+AUTO\+\_\+\+TEST\+\_\+\+CASE (\begin{DoxyParamCaption}\item[{auth\+\_\+data\+\_\+too\+\_\+short}]{}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{test__webauthn_8cpp_source_l00214}{214}} of file \mbox{\hyperlink{test__webauthn_8cpp_source}{test\+\_\+webauthn.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00214\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00215\ \ \ \ \mbox{\hyperlink{classfc_1_1crypto_1_1webauthn_1_1public__key}{webauthn::public\_key}}\ wa\_pub(pub.serialize(),\ webauthn::public\_key::user\_presence\_t::USER\_PRESENCE\_NONE,\ \textcolor{stringliteral}{"{}fctesting.invalid"{}});}
\DoxyCodeLine{00216\ \ \ \ std::string\ \mbox{\hyperlink{classfc_1_1json}{json}}\ =\ \textcolor{stringliteral}{"{}\{\(\backslash\)"{}origin\(\backslash\)"{}:\(\backslash\)"{}https://fctesting.invalid\(\backslash\)"{},\(\backslash\)"{}type\(\backslash\)"{}:\(\backslash\)"{}webauthn.get\(\backslash\)"{},\(\backslash\)"{}challenge\(\backslash\)"{}:\(\backslash\)"{}"{}}\ +\ \mbox{\hyperlink{namespacefc_a4d30681e99b9cacc0c9b3b8985a5daa4}{fc::base64url\_encode}}(d.\mbox{\hyperlink{classfc_1_1sha256_ab897537f6c524085b28049be51ed370d}{data}}(),\ d.\mbox{\hyperlink{classfc_1_1sha256_ac7722b7428b1db345f1b7fab7f4d5774}{data\_size}}())\ +\ \textcolor{stringliteral}{"{}\(\backslash\)"{}\}"{}};}
\DoxyCodeLine{00217\ }
\DoxyCodeLine{00218\ \ \ \ std::vector<uint8\_t>\ auth\_data(1);}
\DoxyCodeLine{00219\ }
\DoxyCodeLine{00220\ \ \ \ BOOST\_CHECK\_EXCEPTION(make\_webauthn\_sig(priv,\ auth\_data,\ \mbox{\hyperlink{classfc_1_1json}{json}}).recover(d,\ \textcolor{keyword}{true}),\ fc::assert\_exception,\ [](\textcolor{keyword}{const}\ fc::assert\_exception\&\ e)\ \{}
\DoxyCodeLine{00221\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ e.to\_detail\_string().find(\textcolor{stringliteral}{"{}auth\_data\ not\ as\ large\ as\ required"{}})\ !=\ std::string::npos;}
\DoxyCodeLine{00222\ \ \ \ \});}
\DoxyCodeLine{00223\ \}\ \mbox{\hyperlink{test__webauthn_8cpp_ae70bfa24f5a3bc0917382b3c17fc033c}{FC\_LOG\_AND\_RETHROW}}();}

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{test__webauthn_8cpp_a04cd22b50edfdbf19e9c068f6a7228e3_cgraph}
\end{center}
\end{figure}
\Hypertarget{test__webauthn_8cpp_a4567990f83744a1b06c7894321f28f7b}\index{test\_webauthn.cpp@{test\_webauthn.cpp}!BOOST\_AUTO\_TEST\_CASE@{BOOST\_AUTO\_TEST\_CASE}}
\index{BOOST\_AUTO\_TEST\_CASE@{BOOST\_AUTO\_TEST\_CASE}!test\_webauthn.cpp@{test\_webauthn.cpp}}
\doxysubsubsection{\texorpdfstring{BOOST\_AUTO\_TEST\_CASE()}{BOOST\_AUTO\_TEST\_CASE()}\hspace{0.1cm}{\footnotesize\ttfamily [3/26]}}
{\footnotesize\ttfamily \label{test__webauthn_8cpp_a4567990f83744a1b06c7894321f28f7b} 
BOOST\+\_\+\+AUTO\+\_\+\+TEST\+\_\+\+CASE (\begin{DoxyParamCaption}\item[{base64\+\_\+wonky}]{}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{test__webauthn_8cpp_source_l00406}{406}} of file \mbox{\hyperlink{test__webauthn_8cpp_source}{test\+\_\+webauthn.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00406\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00407\ \ \ \ \mbox{\hyperlink{classfc_1_1crypto_1_1webauthn_1_1public__key}{webauthn::public\_key}}\ wa\_pub(pub.serialize(),\ webauthn::public\_key::user\_presence\_t::USER\_PRESENCE\_NONE,\ \textcolor{stringliteral}{"{}fctesting.invalid"{}});}
\DoxyCodeLine{00408\ }
\DoxyCodeLine{00409\ \ \ \ std::string\ \mbox{\hyperlink{classfc_1_1json}{json}}\ =\ \textcolor{stringliteral}{"{}\{\(\backslash\)"{}origin\(\backslash\)"{}:\(\backslash\)"{}https://fctesting.invalid\(\backslash\)"{},\(\backslash\)"{}type\(\backslash\)"{}:\(\backslash\)"{}webauthn.get\(\backslash\)"{},\(\backslash\)"{}challenge\(\backslash\)"{}:\(\backslash\)"{}"{}}\ +\ \mbox{\hyperlink{namespacefc_a4d30681e99b9cacc0c9b3b8985a5daa4}{fc::base64url\_encode}}(d.\mbox{\hyperlink{classfc_1_1sha256_ab897537f6c524085b28049be51ed370d}{data}}(),\ d.\mbox{\hyperlink{classfc_1_1sha256_ac7722b7428b1db345f1b7fab7f4d5774}{data\_size}}())\ +\ \textcolor{stringliteral}{"{}!@\#\$\(\backslash\)"{}\}"{}};}
\DoxyCodeLine{00410\ \ \ \ boost::erase\_all(\mbox{\hyperlink{classfc_1_1json}{json}},\ \textcolor{stringliteral}{"{}="{}});}
\DoxyCodeLine{00411\ }
\DoxyCodeLine{00412\ \ \ \ std::vector<uint8\_t>\ auth\_data(37);}
\DoxyCodeLine{00413\ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(auth\_data.data(),\ origin\_hash.\mbox{\hyperlink{classfc_1_1sha256_ab897537f6c524085b28049be51ed370d}{data}}(),\ \textcolor{keyword}{sizeof}(origin\_hash));}
\DoxyCodeLine{00414\ }
\DoxyCodeLine{00415\ \ \ \ BOOST\_CHECK\_EXCEPTION(make\_webauthn\_sig(priv,\ auth\_data,\ \mbox{\hyperlink{classfc_1_1json}{json}}).recover(d,\ \textcolor{keyword}{true}),\ \mbox{\hyperlink{classfc_1_1exception}{fc::exception}},\ [](\textcolor{keyword}{const}\ \mbox{\hyperlink{classfc_1_1exception}{fc::exception}}\&\ e)\ \{}
\DoxyCodeLine{00416\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ e.\mbox{\hyperlink{classfc_1_1exception_a7611ea8fbe25dde56649b685c2298a37}{to\_detail\_string}}().find(\textcolor{stringliteral}{"{}encountered\ non-\/base64\ character"{}})\ !=\ std::string::npos;}
\DoxyCodeLine{00417\ \ \ \ \});}
\DoxyCodeLine{00418\ \}\ \mbox{\hyperlink{test__webauthn_8cpp_ae70bfa24f5a3bc0917382b3c17fc033c}{FC\_LOG\_AND\_RETHROW}}();}

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{test__webauthn_8cpp_a4567990f83744a1b06c7894321f28f7b_cgraph}
\end{center}
\end{figure}
\Hypertarget{test__webauthn_8cpp_a0ed9c663c1c7990474cb70a258ec9377}\index{test\_webauthn.cpp@{test\_webauthn.cpp}!BOOST\_AUTO\_TEST\_CASE@{BOOST\_AUTO\_TEST\_CASE}}
\index{BOOST\_AUTO\_TEST\_CASE@{BOOST\_AUTO\_TEST\_CASE}!test\_webauthn.cpp@{test\_webauthn.cpp}}
\doxysubsubsection{\texorpdfstring{BOOST\_AUTO\_TEST\_CASE()}{BOOST\_AUTO\_TEST\_CASE()}\hspace{0.1cm}{\footnotesize\ttfamily [4/26]}}
{\footnotesize\ttfamily \label{test__webauthn_8cpp_a0ed9c663c1c7990474cb70a258ec9377} 
BOOST\+\_\+\+AUTO\+\_\+\+TEST\+\_\+\+CASE (\begin{DoxyParamCaption}\item[{challenge\+\_\+junk}]{}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{test__webauthn_8cpp_source_l00145}{145}} of file \mbox{\hyperlink{test__webauthn_8cpp_source}{test\+\_\+webauthn.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00145\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00146\ \ \ \ \mbox{\hyperlink{classfc_1_1crypto_1_1webauthn_1_1public__key}{webauthn::public\_key}}\ wa\_pub(pub.serialize(),\ webauthn::public\_key::user\_presence\_t::USER\_PRESENCE\_NONE,\ \textcolor{stringliteral}{"{}fctesting.invalid"{}});}
\DoxyCodeLine{00147\ \ \ \ std::string\ \mbox{\hyperlink{classfc_1_1json}{json}}\ =\ \textcolor{stringliteral}{"{}\{\(\backslash\)"{}origin\(\backslash\)"{}:\(\backslash\)"{}https://fctesting.invalid\(\backslash\)"{},\(\backslash\)"{}type\(\backslash\)"{}:\(\backslash\)"{}webauthn.get\(\backslash\)"{},\(\backslash\)"{}challenge\(\backslash\)"{}:\(\backslash\)"{}"{}}\ +\ \textcolor{stringliteral}{"{}blahBLAH"{}}\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}}\ +\ \textcolor{stringliteral}{"{}\(\backslash\)"{}\}"{}};}
\DoxyCodeLine{00148\ }
\DoxyCodeLine{00149\ \ \ \ std::vector<uint8\_t>\ auth\_data(37);}
\DoxyCodeLine{00150\ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(auth\_data.data(),\ origin\_hash.\mbox{\hyperlink{classfc_1_1sha256_ab897537f6c524085b28049be51ed370d}{data}}(),\ \textcolor{keyword}{sizeof}(origin\_hash));}
\DoxyCodeLine{00151\ }
\DoxyCodeLine{00152\ \ \ \ BOOST\_CHECK\_EXCEPTION(make\_webauthn\_sig(priv,\ auth\_data,\ \mbox{\hyperlink{classfc_1_1json}{json}}).recover(d,\ \textcolor{keyword}{true}),\ \mbox{\hyperlink{classfc_1_1exception}{fc::exception}},\ [](\textcolor{keyword}{const}\ \mbox{\hyperlink{classfc_1_1exception}{fc::exception}}\&\ e)\ \{}
\DoxyCodeLine{00153\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ e.\mbox{\hyperlink{classfc_1_1exception_a7611ea8fbe25dde56649b685c2298a37}{to\_detail\_string}}().find(\textcolor{stringliteral}{"{}sha256:\ size\ mismatch"{}})\ !=\ std::string::npos;}
\DoxyCodeLine{00154\ \ \ \ \});}
\DoxyCodeLine{00155\ \}\ \mbox{\hyperlink{test__webauthn_8cpp_ae70bfa24f5a3bc0917382b3c17fc033c}{FC\_LOG\_AND\_RETHROW}}();}

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{test__webauthn_8cpp_a0ed9c663c1c7990474cb70a258ec9377_cgraph}
\end{center}
\end{figure}
\Hypertarget{test__webauthn_8cpp_af58f9647f13c05324de3b3fa2d6aa328}\index{test\_webauthn.cpp@{test\_webauthn.cpp}!BOOST\_AUTO\_TEST\_CASE@{BOOST\_AUTO\_TEST\_CASE}}
\index{BOOST\_AUTO\_TEST\_CASE@{BOOST\_AUTO\_TEST\_CASE}!test\_webauthn.cpp@{test\_webauthn.cpp}}
\doxysubsubsection{\texorpdfstring{BOOST\_AUTO\_TEST\_CASE()}{BOOST\_AUTO\_TEST\_CASE()}\hspace{0.1cm}{\footnotesize\ttfamily [5/26]}}
{\footnotesize\ttfamily \label{test__webauthn_8cpp_af58f9647f13c05324de3b3fa2d6aa328} 
BOOST\+\_\+\+AUTO\+\_\+\+TEST\+\_\+\+CASE (\begin{DoxyParamCaption}\item[{challenge\+\_\+non\+\_\+base64}]{}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{test__webauthn_8cpp_source_l00158}{158}} of file \mbox{\hyperlink{test__webauthn_8cpp_source}{test\+\_\+webauthn.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00158\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00159\ \ \ \ \mbox{\hyperlink{classfc_1_1crypto_1_1webauthn_1_1public__key}{webauthn::public\_key}}\ wa\_pub(pub.serialize(),\ webauthn::public\_key::user\_presence\_t::USER\_PRESENCE\_NONE,\ \textcolor{stringliteral}{"{}fctesting.invalid"{}});}
\DoxyCodeLine{00160\ \ \ \ std::string\ \mbox{\hyperlink{classfc_1_1json}{json}}\ =\ \textcolor{stringliteral}{"{}\{\(\backslash\)"{}origin\(\backslash\)"{}:\(\backslash\)"{}https://fctesting.invalid\(\backslash\)"{},\(\backslash\)"{}type\(\backslash\)"{}:\(\backslash\)"{}webauthn.get\(\backslash\)"{},\(\backslash\)"{}challenge\(\backslash\)"{}:\(\backslash\)"{}"{}}\ +\ \textcolor{stringliteral}{"{}hello@world\$"{}}\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}}\ +\ \textcolor{stringliteral}{"{}\(\backslash\)"{}\}"{}};}
\DoxyCodeLine{00161\ }
\DoxyCodeLine{00162\ \ \ \ std::vector<uint8\_t>\ auth\_data(37);}
\DoxyCodeLine{00163\ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(auth\_data.data(),\ origin\_hash.\mbox{\hyperlink{classfc_1_1sha256_ab897537f6c524085b28049be51ed370d}{data}}(),\ \textcolor{keyword}{sizeof}(origin\_hash));}
\DoxyCodeLine{00164\ }
\DoxyCodeLine{00165\ \ \ \ BOOST\_CHECK\_EXCEPTION(make\_webauthn\_sig(priv,\ auth\_data,\ \mbox{\hyperlink{classfc_1_1json}{json}}).recover(d,\ \textcolor{keyword}{true}),\ \mbox{\hyperlink{classfc_1_1exception}{fc::exception}},\ [](\textcolor{keyword}{const}\ \mbox{\hyperlink{classfc_1_1exception}{fc::exception}}\&\ e)\ \{}
\DoxyCodeLine{00166\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ e.\mbox{\hyperlink{classfc_1_1exception_a7611ea8fbe25dde56649b685c2298a37}{to\_detail\_string}}().find(\textcolor{stringliteral}{"{}encountered\ non-\/base64\ character"{}})\ !=\ std::string::npos;}
\DoxyCodeLine{00167\ \ \ \ \});}
\DoxyCodeLine{00168\ \}\ \mbox{\hyperlink{test__webauthn_8cpp_ae70bfa24f5a3bc0917382b3c17fc033c}{FC\_LOG\_AND\_RETHROW}}();}

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{test__webauthn_8cpp_af58f9647f13c05324de3b3fa2d6aa328_cgraph}
\end{center}
\end{figure}
\Hypertarget{test__webauthn_8cpp_abd36e135c2332d8f04b795dddc13a2f3}\index{test\_webauthn.cpp@{test\_webauthn.cpp}!BOOST\_AUTO\_TEST\_CASE@{BOOST\_AUTO\_TEST\_CASE}}
\index{BOOST\_AUTO\_TEST\_CASE@{BOOST\_AUTO\_TEST\_CASE}!test\_webauthn.cpp@{test\_webauthn.cpp}}
\doxysubsubsection{\texorpdfstring{BOOST\_AUTO\_TEST\_CASE()}{BOOST\_AUTO\_TEST\_CASE()}\hspace{0.1cm}{\footnotesize\ttfamily [6/26]}}
{\footnotesize\ttfamily \label{test__webauthn_8cpp_abd36e135c2332d8f04b795dddc13a2f3} 
BOOST\+\_\+\+AUTO\+\_\+\+TEST\+\_\+\+CASE (\begin{DoxyParamCaption}\item[{challenge\+\_\+wrong}]{}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{test__webauthn_8cpp_source_l00171}{171}} of file \mbox{\hyperlink{test__webauthn_8cpp_source}{test\+\_\+webauthn.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00171\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00172\ \ \ \ \mbox{\hyperlink{classfc_1_1crypto_1_1webauthn_1_1public__key}{webauthn::public\_key}}\ wa\_pub(pub.serialize(),\ webauthn::public\_key::user\_presence\_t::USER\_PRESENCE\_NONE,\ \textcolor{stringliteral}{"{}fctesting.invalid"{}});}
\DoxyCodeLine{00173\ \ \ \ \mbox{\hyperlink{classfc_1_1sha256}{fc::sha256}}\ other\_digest\ =\ \mbox{\hyperlink{classfc_1_1sha256_a474784de7d6213b855abd7e952df5e36}{fc::sha256::hash}}(\textcolor{stringliteral}{"{}yo"{}}\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}});}
\DoxyCodeLine{00174\ \ \ \ std::string\ \mbox{\hyperlink{classfc_1_1json}{json}}\ =\ \textcolor{stringliteral}{"{}\{\(\backslash\)"{}origin\(\backslash\)"{}:\(\backslash\)"{}https://fctesting.invalid\(\backslash\)"{},\(\backslash\)"{}type\(\backslash\)"{}:\(\backslash\)"{}webauthn.get\(\backslash\)"{},\(\backslash\)"{}challenge\(\backslash\)"{}:\(\backslash\)"{}"{}}\ +\ \mbox{\hyperlink{namespacefc_a4d30681e99b9cacc0c9b3b8985a5daa4}{fc::base64url\_encode}}(other\_digest.\mbox{\hyperlink{classfc_1_1sha256_ab897537f6c524085b28049be51ed370d}{data}}(),\ other\_digest.\mbox{\hyperlink{classfc_1_1sha256_ac7722b7428b1db345f1b7fab7f4d5774}{data\_size}}())\ +\ \textcolor{stringliteral}{"{}\(\backslash\)"{}\}"{}};}
\DoxyCodeLine{00175\ }
\DoxyCodeLine{00176\ \ \ \ std::vector<uint8\_t>\ auth\_data(37);}
\DoxyCodeLine{00177\ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(auth\_data.data(),\ origin\_hash.\mbox{\hyperlink{classfc_1_1sha256_ab897537f6c524085b28049be51ed370d}{data}}(),\ \textcolor{keyword}{sizeof}(origin\_hash));}
\DoxyCodeLine{00178\ }
\DoxyCodeLine{00179\ \ \ \ BOOST\_CHECK\_EXCEPTION(make\_webauthn\_sig(priv,\ auth\_data,\ \mbox{\hyperlink{classfc_1_1json}{json}}).recover(d,\ \textcolor{keyword}{true}),\ fc::assert\_exception,\ [](\textcolor{keyword}{const}\ fc::assert\_exception\&\ e)\ \{}
\DoxyCodeLine{00180\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ e.to\_detail\_string().find(\textcolor{stringliteral}{"{}Wrong\ webauthn\ challenge"{}})\ !=\ std::string::npos;}
\DoxyCodeLine{00181\ \ \ \ \});}
\DoxyCodeLine{00182\ \}\ \mbox{\hyperlink{test__webauthn_8cpp_ae70bfa24f5a3bc0917382b3c17fc033c}{FC\_LOG\_AND\_RETHROW}}();}

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{test__webauthn_8cpp_abd36e135c2332d8f04b795dddc13a2f3_cgraph}
\end{center}
\end{figure}
\Hypertarget{test__webauthn_8cpp_ad28a941550711577d070b4c59039fb47}\index{test\_webauthn.cpp@{test\_webauthn.cpp}!BOOST\_AUTO\_TEST\_CASE@{BOOST\_AUTO\_TEST\_CASE}}
\index{BOOST\_AUTO\_TEST\_CASE@{BOOST\_AUTO\_TEST\_CASE}!test\_webauthn.cpp@{test\_webauthn.cpp}}
\doxysubsubsection{\texorpdfstring{BOOST\_AUTO\_TEST\_CASE()}{BOOST\_AUTO\_TEST\_CASE()}\hspace{0.1cm}{\footnotesize\ttfamily [7/26]}}
{\footnotesize\ttfamily \label{test__webauthn_8cpp_ad28a941550711577d070b4c59039fb47} 
BOOST\+\_\+\+AUTO\+\_\+\+TEST\+\_\+\+CASE (\begin{DoxyParamCaption}\item[{damage\+\_\+sig}]{}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{test__webauthn_8cpp_source_l00290}{290}} of file \mbox{\hyperlink{test__webauthn_8cpp_source}{test\+\_\+webauthn.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00290\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00291\ \ \ \ \mbox{\hyperlink{classfc_1_1crypto_1_1webauthn_1_1public__key}{webauthn::public\_key}}\ wa\_pub(pub.serialize(),\ webauthn::public\_key::user\_presence\_t::USER\_PRESENCE\_NONE,\ \textcolor{stringliteral}{"{}fctesting.invalid"{}});}
\DoxyCodeLine{00292\ \ \ \ std::string\ \mbox{\hyperlink{classfc_1_1json}{json}}\ =\ \textcolor{stringliteral}{"{}\{\(\backslash\)"{}origin\(\backslash\)"{}:\(\backslash\)"{}https://fctesting.invalid\(\backslash\)"{},\(\backslash\)"{}type\(\backslash\)"{}:\(\backslash\)"{}webauthn.get\(\backslash\)"{},\(\backslash\)"{}challenge\(\backslash\)"{}:\(\backslash\)"{}"{}}\ +\ \mbox{\hyperlink{namespacefc_a4d30681e99b9cacc0c9b3b8985a5daa4}{fc::base64url\_encode}}(d.\mbox{\hyperlink{classfc_1_1sha256_ab897537f6c524085b28049be51ed370d}{data}}(),\ d.\mbox{\hyperlink{classfc_1_1sha256_ac7722b7428b1db345f1b7fab7f4d5774}{data\_size}}())\ +\ \textcolor{stringliteral}{"{}\(\backslash\)"{}\}"{}};}
\DoxyCodeLine{00293\ }
\DoxyCodeLine{00294\ \ \ \ std::vector<uint8\_t>\ auth\_data(37);}
\DoxyCodeLine{00295\ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(auth\_data.data(),\ origin\_hash.\mbox{\hyperlink{classfc_1_1sha256_ab897537f6c524085b28049be51ed370d}{data}}(),\ \textcolor{keyword}{sizeof}(origin\_hash));}
\DoxyCodeLine{00296\ }
\DoxyCodeLine{00297\ \ \ \ \mbox{\hyperlink{classfc_1_1crypto_1_1webauthn_1_1signature}{webauthn::signature}}\ sig\ =\ make\_webauthn\_sig(priv,\ auth\_data,\ \mbox{\hyperlink{classfc_1_1json}{json}});}
\DoxyCodeLine{00298\ \ \ \ \textcolor{keywordtype}{char}\ buff[8192];}
\DoxyCodeLine{00299\ \ \ \ \mbox{\hyperlink{classfc_1_1datastream}{datastream<char*>}}\ \mbox{\hyperlink{namespace_xbyak_1_1util_a4b2aef26182d21706896022467868f7c}{ds}}(buff,\ \textcolor{keyword}{sizeof}(buff));}
\DoxyCodeLine{00300\ \ \ \ \mbox{\hyperlink{namespacefc_1_1raw_a3a18d8161aa5b4f4f02b6fcfdff5e5d1}{fc::raw::pack}}(ds,\ sig);}
\DoxyCodeLine{00301\ \ \ \ buff[4]++;}
\DoxyCodeLine{00302\ \ \ \ \mbox{\hyperlink{namespace_xbyak_1_1util_a4b2aef26182d21706896022467868f7c}{ds}}.seekp(0);}
\DoxyCodeLine{00303\ \ \ \ \mbox{\hyperlink{namespacefc_1_1raw_a0b442d98ceb22dd5a6ae84745e43ffab}{fc::raw::unpack}}(ds,\ sig);}
\DoxyCodeLine{00304\ }
\DoxyCodeLine{00305\ \ \ \ \textcolor{keywordtype}{bool}\ failed\_recovery\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00306\ \ \ \ \textcolor{keywordtype}{bool}\ failed\_compare\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00307\ \ \ \ \mbox{\hyperlink{classfc_1_1crypto_1_1webauthn_1_1public__key}{webauthn::public\_key}}\ recovered\_pub;}
\DoxyCodeLine{00308\ }
\DoxyCodeLine{00309\ \ \ \ \textcolor{keywordflow}{try}\ \{}
\DoxyCodeLine{00310\ \ \ \ \ \ \ recovered\_pub\ =\ sig.\mbox{\hyperlink{classfc_1_1crypto_1_1webauthn_1_1signature_a28633b0f40d89bedb305e2343d9ac4ca}{recover}}(d,\ \textcolor{keyword}{true});}
\DoxyCodeLine{00311\ \ \ \ \ \ \ failed\_compare\ =\ !(wa\_pub\ ==\ recovered\_pub);}
\DoxyCodeLine{00312\ \ \ \ \}}
\DoxyCodeLine{00313\ \ \ \ \textcolor{keywordflow}{catch}(\mbox{\hyperlink{classfc_1_1exception}{fc::exception}}\&\ e)\ \{}
\DoxyCodeLine{00314\ \ \ \ \ \ \ failed\_recovery\ =\ e.\mbox{\hyperlink{classfc_1_1exception_a7611ea8fbe25dde56649b685c2298a37}{to\_detail\_string}}().find(\textcolor{stringliteral}{"{}unable\ to\ reconstruct\ public\ key\ from\ signature"{}})\ !=\ std::string::npos;}
\DoxyCodeLine{00315\ \ \ \ \}}
\DoxyCodeLine{00316\ }
\DoxyCodeLine{00317\ \ \ \ \textcolor{comment}{//We\ can\ fail\ either\ by\ failing\ to\ recover\ any\ key,\ or\ recovering\ the\ wrong\ key.\ Check\ that\ at\ least\ one\ of\ these\ failed}}
\DoxyCodeLine{00318\ \ \ \ BOOST\_CHECK\_EQUAL(failed\_recovery\ ||\ failed\_compare,\ \textcolor{keyword}{true});}
\DoxyCodeLine{00319\ \}\ \mbox{\hyperlink{test__webauthn_8cpp_ae70bfa24f5a3bc0917382b3c17fc033c}{FC\_LOG\_AND\_RETHROW}}();}

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{test__webauthn_8cpp_ad28a941550711577d070b4c59039fb47_cgraph}
\end{center}
\end{figure}
\Hypertarget{test__webauthn_8cpp_a3f379acf17a88ae382a683f053192846}\index{test\_webauthn.cpp@{test\_webauthn.cpp}!BOOST\_AUTO\_TEST\_CASE@{BOOST\_AUTO\_TEST\_CASE}}
\index{BOOST\_AUTO\_TEST\_CASE@{BOOST\_AUTO\_TEST\_CASE}!test\_webauthn.cpp@{test\_webauthn.cpp}}
\doxysubsubsection{\texorpdfstring{BOOST\_AUTO\_TEST\_CASE()}{BOOST\_AUTO\_TEST\_CASE()}\hspace{0.1cm}{\footnotesize\ttfamily [8/26]}}
{\footnotesize\ttfamily \label{test__webauthn_8cpp_a3f379acf17a88ae382a683f053192846} 
BOOST\+\_\+\+AUTO\+\_\+\+TEST\+\_\+\+CASE (\begin{DoxyParamCaption}\item[{damage\+\_\+sig\+\_\+idx}]{}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{test__webauthn_8cpp_source_l00322}{322}} of file \mbox{\hyperlink{test__webauthn_8cpp_source}{test\+\_\+webauthn.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00322\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00323\ \ \ \ \mbox{\hyperlink{classfc_1_1crypto_1_1webauthn_1_1public__key}{webauthn::public\_key}}\ wa\_pub(pub.serialize(),\ webauthn::public\_key::user\_presence\_t::USER\_PRESENCE\_NONE,\ \textcolor{stringliteral}{"{}fctesting.invalid"{}});}
\DoxyCodeLine{00324\ \ \ \ std::string\ \mbox{\hyperlink{classfc_1_1json}{json}}\ =\ \textcolor{stringliteral}{"{}\{\(\backslash\)"{}origin\(\backslash\)"{}:\(\backslash\)"{}https://fctesting.invalid\(\backslash\)"{},\(\backslash\)"{}type\(\backslash\)"{}:\(\backslash\)"{}webauthn.get\(\backslash\)"{},\(\backslash\)"{}challenge\(\backslash\)"{}:\(\backslash\)"{}"{}}\ +\ \mbox{\hyperlink{namespacefc_a4d30681e99b9cacc0c9b3b8985a5daa4}{fc::base64url\_encode}}(d.\mbox{\hyperlink{classfc_1_1sha256_ab897537f6c524085b28049be51ed370d}{data}}(),\ d.\mbox{\hyperlink{classfc_1_1sha256_ac7722b7428b1db345f1b7fab7f4d5774}{data\_size}}())\ +\ \textcolor{stringliteral}{"{}\(\backslash\)"{}\}"{}};}
\DoxyCodeLine{00325\ }
\DoxyCodeLine{00326\ \ \ \ std::vector<uint8\_t>\ auth\_data(37);}
\DoxyCodeLine{00327\ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(auth\_data.data(),\ origin\_hash.\mbox{\hyperlink{classfc_1_1sha256_ab897537f6c524085b28049be51ed370d}{data}}(),\ \textcolor{keyword}{sizeof}(origin\_hash));}
\DoxyCodeLine{00328\ }
\DoxyCodeLine{00329\ \ \ \ \mbox{\hyperlink{classfc_1_1crypto_1_1webauthn_1_1signature}{webauthn::signature}}\ sig\ =\ make\_webauthn\_sig(priv,\ auth\_data,\ \mbox{\hyperlink{classfc_1_1json}{json}});}
\DoxyCodeLine{00330\ \ \ \ \textcolor{keywordtype}{char}\ buff[8192];}
\DoxyCodeLine{00331\ \ \ \ \mbox{\hyperlink{classfc_1_1datastream}{datastream<char*>}}\ \mbox{\hyperlink{namespace_xbyak_1_1util_a4b2aef26182d21706896022467868f7c}{ds}}(buff,\ \textcolor{keyword}{sizeof}(buff));}
\DoxyCodeLine{00332\ \ \ \ \mbox{\hyperlink{namespacefc_1_1raw_a3a18d8161aa5b4f4f02b6fcfdff5e5d1}{fc::raw::pack}}(ds,\ sig);}
\DoxyCodeLine{00333\ \ \ \ buff[0]++;}
\DoxyCodeLine{00334\ \ \ \ \mbox{\hyperlink{namespace_xbyak_1_1util_a4b2aef26182d21706896022467868f7c}{ds}}.seekp(0);}
\DoxyCodeLine{00335\ \ \ \ \mbox{\hyperlink{namespacefc_1_1raw_a0b442d98ceb22dd5a6ae84745e43ffab}{fc::raw::unpack}}(ds,\ sig);}
\DoxyCodeLine{00336\ }
\DoxyCodeLine{00337\ \ \ \ \textcolor{keywordtype}{bool}\ failed\_recovery\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00338\ \ \ \ \textcolor{keywordtype}{bool}\ failed\_compare\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00339\ \ \ \ \mbox{\hyperlink{classfc_1_1crypto_1_1webauthn_1_1public__key}{webauthn::public\_key}}\ recovered\_pub;}
\DoxyCodeLine{00340\ }
\DoxyCodeLine{00341\ \ \ \ \textcolor{keywordflow}{try}\ \{}
\DoxyCodeLine{00342\ \ \ \ \ \ \ recovered\_pub\ =\ sig.\mbox{\hyperlink{classfc_1_1crypto_1_1webauthn_1_1signature_a28633b0f40d89bedb305e2343d9ac4ca}{recover}}(d,\ \textcolor{keyword}{true});}
\DoxyCodeLine{00343\ \ \ \ \ \ \ failed\_compare\ =\ !(wa\_pub\ ==\ recovered\_pub);}
\DoxyCodeLine{00344\ \ \ \ \}}
\DoxyCodeLine{00345\ \ \ \ \textcolor{keywordflow}{catch}(\mbox{\hyperlink{classfc_1_1exception}{fc::exception}}\&\ e)\ \{}
\DoxyCodeLine{00346\ \ \ \ \ \ \ failed\_recovery\ =\ e.\mbox{\hyperlink{classfc_1_1exception_a7611ea8fbe25dde56649b685c2298a37}{to\_detail\_string}}().find(\textcolor{stringliteral}{"{}unable\ to\ reconstruct\ public\ key\ from\ signature"{}})\ !=\ std::string::npos;}
\DoxyCodeLine{00347\ \ \ \ \}}
\DoxyCodeLine{00348\ }
\DoxyCodeLine{00349\ \ \ \ \textcolor{comment}{//We\ can\ fail\ either\ by\ failing\ to\ recover\ any\ key,\ or\ recovering\ the\ wrong\ key.\ Check\ that\ at\ least\ one\ of\ these\ failed}}
\DoxyCodeLine{00350\ \ \ \ BOOST\_CHECK\_EQUAL(failed\_recovery\ ||\ failed\_compare,\ \textcolor{keyword}{true});}
\DoxyCodeLine{00351\ \}\ \mbox{\hyperlink{test__webauthn_8cpp_ae70bfa24f5a3bc0917382b3c17fc033c}{FC\_LOG\_AND\_RETHROW}}();}

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{test__webauthn_8cpp_a3f379acf17a88ae382a683f053192846_cgraph}
\end{center}
\end{figure}
\Hypertarget{test__webauthn_8cpp_a297871fcd73110d766a978fe337ef1e5}\index{test\_webauthn.cpp@{test\_webauthn.cpp}!BOOST\_AUTO\_TEST\_CASE@{BOOST\_AUTO\_TEST\_CASE}}
\index{BOOST\_AUTO\_TEST\_CASE@{BOOST\_AUTO\_TEST\_CASE}!test\_webauthn.cpp@{test\_webauthn.cpp}}
\doxysubsubsection{\texorpdfstring{BOOST\_AUTO\_TEST\_CASE()}{BOOST\_AUTO\_TEST\_CASE()}\hspace{0.1cm}{\footnotesize\ttfamily [9/26]}}
{\footnotesize\ttfamily \label{test__webauthn_8cpp_a297871fcd73110d766a978fe337ef1e5} 
BOOST\+\_\+\+AUTO\+\_\+\+TEST\+\_\+\+CASE (\begin{DoxyParamCaption}\item[{different\+\_\+priv\+\_\+key}]{}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{test__webauthn_8cpp_source_l00354}{354}} of file \mbox{\hyperlink{test__webauthn_8cpp_source}{test\+\_\+webauthn.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00354\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00355\ \ \ \ r1::private\_key\ other\_priv\ =\ \mbox{\hyperlink{classfc_1_1crypto_1_1r1_1_1private__key_ad71aa7d73e57ef9fd7648fb7461177fb}{fc::crypto::r1::private\_key::generate}}();}
\DoxyCodeLine{00356\ }
\DoxyCodeLine{00357\ \ \ \ \mbox{\hyperlink{classfc_1_1crypto_1_1webauthn_1_1public__key}{webauthn::public\_key}}\ wa\_pub(pub.serialize(),\ webauthn::public\_key::user\_presence\_t::USER\_PRESENCE\_NONE,\ \textcolor{stringliteral}{"{}fctesting.invalid"{}});}
\DoxyCodeLine{00358\ \ \ \ std::string\ \mbox{\hyperlink{classfc_1_1json}{json}}\ =\ \textcolor{stringliteral}{"{}\{\(\backslash\)"{}origin\(\backslash\)"{}:\(\backslash\)"{}https://fctesting.invalid\(\backslash\)"{},\(\backslash\)"{}type\(\backslash\)"{}:\(\backslash\)"{}webauthn.get\(\backslash\)"{},\(\backslash\)"{}challenge\(\backslash\)"{}:\(\backslash\)"{}"{}}\ +\ \mbox{\hyperlink{namespacefc_a4d30681e99b9cacc0c9b3b8985a5daa4}{fc::base64url\_encode}}(d.\mbox{\hyperlink{classfc_1_1sha256_ab897537f6c524085b28049be51ed370d}{data}}(),\ d.\mbox{\hyperlink{classfc_1_1sha256_ac7722b7428b1db345f1b7fab7f4d5774}{data\_size}}())\ +\ \textcolor{stringliteral}{"{}\(\backslash\)"{}\}"{}};}
\DoxyCodeLine{00359\ }
\DoxyCodeLine{00360\ \ \ \ std::vector<uint8\_t>\ auth\_data(37);}
\DoxyCodeLine{00361\ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(auth\_data.data(),\ origin\_hash.\mbox{\hyperlink{classfc_1_1sha256_ab897537f6c524085b28049be51ed370d}{data}}(),\ \textcolor{keyword}{sizeof}(origin\_hash));}
\DoxyCodeLine{00362\ }
\DoxyCodeLine{00363\ \ \ \ BOOST\_CHECK\_NE(wa\_pub,\ make\_webauthn\_sig(other\_priv,\ auth\_data,\ \mbox{\hyperlink{classfc_1_1json}{json}}).recover(d,\ \textcolor{keyword}{true}));}
\DoxyCodeLine{00364\ \}\ \mbox{\hyperlink{test__webauthn_8cpp_ae70bfa24f5a3bc0917382b3c17fc033c}{FC\_LOG\_AND\_RETHROW}}();}

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{test__webauthn_8cpp_a297871fcd73110d766a978fe337ef1e5_cgraph}
\end{center}
\end{figure}
\Hypertarget{test__webauthn_8cpp_ac9a2e889a79cc815fd3d36b6f8f77724}\index{test\_webauthn.cpp@{test\_webauthn.cpp}!BOOST\_AUTO\_TEST\_CASE@{BOOST\_AUTO\_TEST\_CASE}}
\index{BOOST\_AUTO\_TEST\_CASE@{BOOST\_AUTO\_TEST\_CASE}!test\_webauthn.cpp@{test\_webauthn.cpp}}
\doxysubsubsection{\texorpdfstring{BOOST\_AUTO\_TEST\_CASE()}{BOOST\_AUTO\_TEST\_CASE()}\hspace{0.1cm}{\footnotesize\ttfamily [10/26]}}
{\footnotesize\ttfamily \label{test__webauthn_8cpp_ac9a2e889a79cc815fd3d36b6f8f77724} 
BOOST\+\_\+\+AUTO\+\_\+\+TEST\+\_\+\+CASE (\begin{DoxyParamCaption}\item[{empty\+\_\+json}]{}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{test__webauthn_8cpp_source_l00367}{367}} of file \mbox{\hyperlink{test__webauthn_8cpp_source}{test\+\_\+webauthn.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00367\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00368\ \ \ \ \mbox{\hyperlink{classfc_1_1crypto_1_1webauthn_1_1public__key}{webauthn::public\_key}}\ wa\_pub(pub.serialize(),\ webauthn::public\_key::user\_presence\_t::USER\_PRESENCE\_NONE,\ \textcolor{stringliteral}{"{}fctesting.invalid"{}});}
\DoxyCodeLine{00369\ \ \ \ std::string\ \mbox{\hyperlink{classfc_1_1json}{json}};}
\DoxyCodeLine{00370\ }
\DoxyCodeLine{00371\ \ \ \ std::vector<uint8\_t>\ auth\_data(37);}
\DoxyCodeLine{00372\ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(auth\_data.data(),\ origin\_hash.\mbox{\hyperlink{classfc_1_1sha256_ab897537f6c524085b28049be51ed370d}{data}}(),\ \textcolor{keyword}{sizeof}(origin\_hash));}
\DoxyCodeLine{00373\ }
\DoxyCodeLine{00374\ \ \ \ BOOST\_CHECK\_EXCEPTION(make\_webauthn\_sig(priv,\ auth\_data,\ \mbox{\hyperlink{classfc_1_1json}{json}}).recover(d,\ \textcolor{keyword}{true}),\ fc::assert\_exception,\ [](\textcolor{keyword}{const}\ fc::assert\_exception\&\ e)\ \{}
\DoxyCodeLine{00375\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ e.to\_detail\_string().find(\textcolor{stringliteral}{"{}Failed\ to\ parse\ client\ data\ JSON"{}})\ !=\ std::string::npos;}
\DoxyCodeLine{00376\ \ \ \ \});}
\DoxyCodeLine{00377\ \}\ \mbox{\hyperlink{test__webauthn_8cpp_ae70bfa24f5a3bc0917382b3c17fc033c}{FC\_LOG\_AND\_RETHROW}}();}

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{test__webauthn_8cpp_ac9a2e889a79cc815fd3d36b6f8f77724_cgraph}
\end{center}
\end{figure}
\Hypertarget{test__webauthn_8cpp_a010d0b81ec2257a446d8f9e1a43a4d4f}\index{test\_webauthn.cpp@{test\_webauthn.cpp}!BOOST\_AUTO\_TEST\_CASE@{BOOST\_AUTO\_TEST\_CASE}}
\index{BOOST\_AUTO\_TEST\_CASE@{BOOST\_AUTO\_TEST\_CASE}!test\_webauthn.cpp@{test\_webauthn.cpp}}
\doxysubsubsection{\texorpdfstring{BOOST\_AUTO\_TEST\_CASE()}{BOOST\_AUTO\_TEST\_CASE()}\hspace{0.1cm}{\footnotesize\ttfamily [11/26]}}
{\footnotesize\ttfamily \label{test__webauthn_8cpp_a010d0b81ec2257a446d8f9e1a43a4d4f} 
BOOST\+\_\+\+AUTO\+\_\+\+TEST\+\_\+\+CASE (\begin{DoxyParamCaption}\item[{empty\+\_\+origin}]{}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{test__webauthn_8cpp_source_l00110}{110}} of file \mbox{\hyperlink{test__webauthn_8cpp_source}{test\+\_\+webauthn.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00110\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00111\ \ \ \ \mbox{\hyperlink{classfc_1_1crypto_1_1webauthn_1_1public__key}{webauthn::public\_key}}\ wa\_pub(pub.serialize(),\ webauthn::public\_key::user\_presence\_t::USER\_PRESENCE\_NONE,\ \textcolor{stringliteral}{"{}fctesting.invalid"{}});}
\DoxyCodeLine{00112\ \ \ \ std::string\ \mbox{\hyperlink{classfc_1_1json}{json}}\ =\ \textcolor{stringliteral}{"{}\{\(\backslash\)"{}origin\(\backslash\)"{}:\(\backslash\)"{}\(\backslash\)"{},\(\backslash\)"{}type\(\backslash\)"{}:\(\backslash\)"{}webauthn.get\(\backslash\)"{},\(\backslash\)"{}challenge\(\backslash\)"{}:\(\backslash\)"{}"{}}\ +\ \mbox{\hyperlink{namespacefc_a4d30681e99b9cacc0c9b3b8985a5daa4}{fc::base64url\_encode}}(d.\mbox{\hyperlink{classfc_1_1sha256_ab897537f6c524085b28049be51ed370d}{data}}(),\ d.\mbox{\hyperlink{classfc_1_1sha256_ac7722b7428b1db345f1b7fab7f4d5774}{data\_size}}())\ +\ \textcolor{stringliteral}{"{}\(\backslash\)"{}\}"{}};}
\DoxyCodeLine{00113\ }
\DoxyCodeLine{00114\ \ \ \ std::vector<uint8\_t>\ auth\_data(37);}
\DoxyCodeLine{00115\ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(auth\_data.data(),\ origin\_hash.\mbox{\hyperlink{classfc_1_1sha256_ab897537f6c524085b28049be51ed370d}{data}}(),\ \textcolor{keyword}{sizeof}(origin\_hash));}
\DoxyCodeLine{00116\ }
\DoxyCodeLine{00117\ \ \ \ BOOST\_CHECK\_EXCEPTION(make\_webauthn\_sig(priv,\ auth\_data,\ \mbox{\hyperlink{classfc_1_1json}{json}}).recover(d,\ \textcolor{keyword}{true}),\ fc::assert\_exception,\ [](\textcolor{keyword}{const}\ fc::assert\_exception\&\ e)\ \{}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ e.to\_detail\_string().find(\textcolor{stringliteral}{"{}webauthn\ origin\ must\ begin\ with\ https://"{}})\ !=\ std::string::npos;}
\DoxyCodeLine{00119\ \ \ \ \});}
\DoxyCodeLine{00120\ \}\ \mbox{\hyperlink{test__webauthn_8cpp_ae70bfa24f5a3bc0917382b3c17fc033c}{FC\_LOG\_AND\_RETHROW}}();}

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{test__webauthn_8cpp_a010d0b81ec2257a446d8f9e1a43a4d4f_cgraph}
\end{center}
\end{figure}
\Hypertarget{test__webauthn_8cpp_a4f19eaa04d61bbaa9324ee8d5ada9a90}\index{test\_webauthn.cpp@{test\_webauthn.cpp}!BOOST\_AUTO\_TEST\_CASE@{BOOST\_AUTO\_TEST\_CASE}}
\index{BOOST\_AUTO\_TEST\_CASE@{BOOST\_AUTO\_TEST\_CASE}!test\_webauthn.cpp@{test\_webauthn.cpp}}
\doxysubsubsection{\texorpdfstring{BOOST\_AUTO\_TEST\_CASE()}{BOOST\_AUTO\_TEST\_CASE()}\hspace{0.1cm}{\footnotesize\ttfamily [12/26]}}
{\footnotesize\ttfamily \label{test__webauthn_8cpp_a4f19eaa04d61bbaa9324ee8d5ada9a90} 
BOOST\+\_\+\+AUTO\+\_\+\+TEST\+\_\+\+CASE (\begin{DoxyParamCaption}\item[{empty\+\_\+port}]{}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{test__webauthn_8cpp_source_l00134}{134}} of file \mbox{\hyperlink{test__webauthn_8cpp_source}{test\+\_\+webauthn.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00134\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00135\ \ \ \ \mbox{\hyperlink{classfc_1_1crypto_1_1webauthn_1_1public__key}{webauthn::public\_key}}\ wa\_pub(pub.serialize(),\ webauthn::public\_key::user\_presence\_t::USER\_PRESENCE\_NONE,\ \textcolor{stringliteral}{"{}fctesting.invalid"{}});}
\DoxyCodeLine{00136\ \ \ \ std::string\ \mbox{\hyperlink{classfc_1_1json}{json}}\ =\ \textcolor{stringliteral}{"{}\{\(\backslash\)"{}origin\(\backslash\)"{}:\(\backslash\)"{}https://fctesting.invalid:\(\backslash\)"{},\(\backslash\)"{}type\(\backslash\)"{}:\(\backslash\)"{}webauthn.get\(\backslash\)"{},\(\backslash\)"{}challenge\(\backslash\)"{}:\(\backslash\)"{}"{}}\ +\ \mbox{\hyperlink{namespacefc_a4d30681e99b9cacc0c9b3b8985a5daa4}{fc::base64url\_encode}}(d.\mbox{\hyperlink{classfc_1_1sha256_ab897537f6c524085b28049be51ed370d}{data}}(),\ d.\mbox{\hyperlink{classfc_1_1sha256_ac7722b7428b1db345f1b7fab7f4d5774}{data\_size}}())\ +\ \textcolor{stringliteral}{"{}\(\backslash\)"{}\}"{}};}
\DoxyCodeLine{00137\ }
\DoxyCodeLine{00138\ \ \ \ std::vector<uint8\_t>\ auth\_data(37);}
\DoxyCodeLine{00139\ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(auth\_data.data(),\ origin\_hash.\mbox{\hyperlink{classfc_1_1sha256_ab897537f6c524085b28049be51ed370d}{data}}(),\ \textcolor{keyword}{sizeof}(origin\_hash));}
\DoxyCodeLine{00140\ }
\DoxyCodeLine{00141\ \ \ \ BOOST\_CHECK\_EQUAL(wa\_pub,\ make\_webauthn\_sig(priv,\ auth\_data,\ \mbox{\hyperlink{classfc_1_1json}{json}}).recover(d,\ \textcolor{keyword}{true}));}
\DoxyCodeLine{00142\ \}\ \mbox{\hyperlink{test__webauthn_8cpp_ae70bfa24f5a3bc0917382b3c17fc033c}{FC\_LOG\_AND\_RETHROW}}();}

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{test__webauthn_8cpp_a4f19eaa04d61bbaa9324ee8d5ada9a90_cgraph}
\end{center}
\end{figure}
\Hypertarget{test__webauthn_8cpp_adc615b5851afd2b6e5668f9311758a45}\index{test\_webauthn.cpp@{test\_webauthn.cpp}!BOOST\_AUTO\_TEST\_CASE@{BOOST\_AUTO\_TEST\_CASE}}
\index{BOOST\_AUTO\_TEST\_CASE@{BOOST\_AUTO\_TEST\_CASE}!test\_webauthn.cpp@{test\_webauthn.cpp}}
\doxysubsubsection{\texorpdfstring{BOOST\_AUTO\_TEST\_CASE()}{BOOST\_AUTO\_TEST\_CASE()}\hspace{0.1cm}{\footnotesize\ttfamily [13/26]}}
{\footnotesize\ttfamily \label{test__webauthn_8cpp_adc615b5851afd2b6e5668f9311758a45} 
BOOST\+\_\+\+AUTO\+\_\+\+TEST\+\_\+\+CASE (\begin{DoxyParamCaption}\item[{empty\+\_\+rpid}]{}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{test__webauthn_8cpp_source_l00380}{380}} of file \mbox{\hyperlink{test__webauthn_8cpp_source}{test\+\_\+webauthn.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00380\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00381\ \ \ \ \textcolor{keywordtype}{char}\ data[67]\ =\ \{\};}
\DoxyCodeLine{00382\ \ \ \ \mbox{\hyperlink{classfc_1_1datastream}{datastream<char*>}}\ \mbox{\hyperlink{namespace_xbyak_1_1util_a4b2aef26182d21706896022467868f7c}{ds}}(data,\ \textcolor{keyword}{sizeof}(data));}
\DoxyCodeLine{00383\ \ \ \ \mbox{\hyperlink{classfc_1_1crypto_1_1webauthn_1_1public__key}{webauthn::public\_key}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a931987c85fd408a620505ee9a1aa6f58}{pubkey}};}
\DoxyCodeLine{00384\ }
\DoxyCodeLine{00385\ \ \ \ BOOST\_CHECK\_EXCEPTION(\mbox{\hyperlink{namespacefc_1_1raw_a0b442d98ceb22dd5a6ae84745e43ffab}{fc::raw::unpack}}(ds,\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a931987c85fd408a620505ee9a1aa6f58}{pubkey}}),\ fc::assert\_exception,\ [](\textcolor{keyword}{const}\ fc::assert\_exception\&\ e)\ \{}
\DoxyCodeLine{00386\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ e.to\_detail\_string().find(\textcolor{stringliteral}{"{}webauthn\ pubkey\ must\ have\ non\ empty\ rpid"{}})\ !=\ std::string::npos;}
\DoxyCodeLine{00387\ \ \ \ \});}
\DoxyCodeLine{00388\ \}\ \mbox{\hyperlink{test__webauthn_8cpp_ae70bfa24f5a3bc0917382b3c17fc033c}{FC\_LOG\_AND\_RETHROW}}();}

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=347pt]{test__webauthn_8cpp_adc615b5851afd2b6e5668f9311758a45_cgraph}
\end{center}
\end{figure}
\Hypertarget{test__webauthn_8cpp_a75805940106aba536c48e0c047fc814e}\index{test\_webauthn.cpp@{test\_webauthn.cpp}!BOOST\_AUTO\_TEST\_CASE@{BOOST\_AUTO\_TEST\_CASE}}
\index{BOOST\_AUTO\_TEST\_CASE@{BOOST\_AUTO\_TEST\_CASE}!test\_webauthn.cpp@{test\_webauthn.cpp}}
\doxysubsubsection{\texorpdfstring{BOOST\_AUTO\_TEST\_CASE()}{BOOST\_AUTO\_TEST\_CASE()}\hspace{0.1cm}{\footnotesize\ttfamily [14/26]}}
{\footnotesize\ttfamily \label{test__webauthn_8cpp_a75805940106aba536c48e0c047fc814e} 
BOOST\+\_\+\+AUTO\+\_\+\+TEST\+\_\+\+CASE (\begin{DoxyParamCaption}\item[{good}]{}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{test__webauthn_8cpp_source_l00048}{48}} of file \mbox{\hyperlink{test__webauthn_8cpp_source}{test\+\_\+webauthn.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00048\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00049\ \ \ \ \mbox{\hyperlink{classfc_1_1crypto_1_1webauthn_1_1public__key}{webauthn::public\_key}}\ wa\_pub(pub.serialize(),\ webauthn::public\_key::user\_presence\_t::USER\_PRESENCE\_NONE,\ \textcolor{stringliteral}{"{}fctesting.invalid"{}});}
\DoxyCodeLine{00050\ \ \ \ std::string\ \mbox{\hyperlink{classfc_1_1json}{json}}\ =\ \textcolor{stringliteral}{"{}\{\(\backslash\)"{}origin\(\backslash\)"{}:\(\backslash\)"{}https://fctesting.invalid\(\backslash\)"{},\(\backslash\)"{}type\(\backslash\)"{}:\(\backslash\)"{}webauthn.get\(\backslash\)"{},\(\backslash\)"{}challenge\(\backslash\)"{}:\(\backslash\)"{}"{}}\ +\ \mbox{\hyperlink{namespacefc_a4d30681e99b9cacc0c9b3b8985a5daa4}{fc::base64url\_encode}}(d.\mbox{\hyperlink{classfc_1_1sha256_ab897537f6c524085b28049be51ed370d}{data}}(),\ d.\mbox{\hyperlink{classfc_1_1sha256_ac7722b7428b1db345f1b7fab7f4d5774}{data\_size}}())\ +\ \textcolor{stringliteral}{"{}\(\backslash\)"{}\}"{}};}
\DoxyCodeLine{00051\ }
\DoxyCodeLine{00052\ \ \ \ std::vector<uint8\_t>\ auth\_data(37);}
\DoxyCodeLine{00053\ }
\DoxyCodeLine{00054\ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(auth\_data.data(),\ origin\_hash.\mbox{\hyperlink{classfc_1_1sha256_ab897537f6c524085b28049be51ed370d}{data}}(),\ \textcolor{keyword}{sizeof}(origin\_hash));}
\DoxyCodeLine{00055\ }
\DoxyCodeLine{00056\ \ \ \ BOOST\_CHECK\_EQUAL(wa\_pub,\ make\_webauthn\_sig(priv,\ auth\_data,\ \mbox{\hyperlink{classfc_1_1json}{json}}).recover(d,\ \textcolor{keyword}{true}));}
\DoxyCodeLine{00057\ \}\ \mbox{\hyperlink{test__webauthn_8cpp_ae70bfa24f5a3bc0917382b3c17fc033c}{FC\_LOG\_AND\_RETHROW}}();}

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{test__webauthn_8cpp_a75805940106aba536c48e0c047fc814e_cgraph}
\end{center}
\end{figure}
\Hypertarget{test__webauthn_8cpp_a4fa4b484f47ac1bf70c7b2c99a91c9fb}\index{test\_webauthn.cpp@{test\_webauthn.cpp}!BOOST\_AUTO\_TEST\_CASE@{BOOST\_AUTO\_TEST\_CASE}}
\index{BOOST\_AUTO\_TEST\_CASE@{BOOST\_AUTO\_TEST\_CASE}!test\_webauthn.cpp@{test\_webauthn.cpp}}
\doxysubsubsection{\texorpdfstring{BOOST\_AUTO\_TEST\_CASE()}{BOOST\_AUTO\_TEST\_CASE()}\hspace{0.1cm}{\footnotesize\ttfamily [15/26]}}
{\footnotesize\ttfamily \label{test__webauthn_8cpp_a4fa4b484f47ac1bf70c7b2c99a91c9fb} 
BOOST\+\_\+\+AUTO\+\_\+\+TEST\+\_\+\+CASE (\begin{DoxyParamCaption}\item[{good\+\_\+extrajunk}]{}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{test__webauthn_8cpp_source_l00265}{265}} of file \mbox{\hyperlink{test__webauthn_8cpp_source}{test\+\_\+webauthn.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00265\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00266\ \ \ \ \mbox{\hyperlink{classfc_1_1crypto_1_1webauthn_1_1public__key}{webauthn::public\_key}}\ wa\_pub(pub.serialize(),\ webauthn::public\_key::user\_presence\_t::USER\_PRESENCE\_NONE,\ \textcolor{stringliteral}{"{}fctesting.invalid"{}});}
\DoxyCodeLine{00267\ \ \ \ std::string\ \mbox{\hyperlink{classfc_1_1json}{json}}\ =\ \textcolor{stringliteral}{"{}\{\(\backslash\)"{}origin\(\backslash\)"{}:\(\backslash\)"{}https://fctesting.invalid\(\backslash\)"{},\(\backslash\)"{}cool\(\backslash\)"{}:\(\backslash\)"{}beans\(\backslash\)"{},\(\backslash\)"{}obj\(\backslash\)"{}:\{\(\backslash\)"{}array\(\backslash\)"{}:[4,\ 5,\ 6]\},"{}}}
\DoxyCodeLine{00268\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\(\backslash\)"{}type\(\backslash\)"{}:\(\backslash\)"{}webauthn.get\(\backslash\)"{},\(\backslash\)"{}answer\(\backslash\)"{}:\ 42\ ,\(\backslash\)"{}challenge\(\backslash\)"{}:\(\backslash\)"{}"{}}\ +\ \mbox{\hyperlink{namespacefc_a4d30681e99b9cacc0c9b3b8985a5daa4}{fc::base64url\_encode}}(d.\mbox{\hyperlink{classfc_1_1sha256_ab897537f6c524085b28049be51ed370d}{data}}(),\ d.\mbox{\hyperlink{classfc_1_1sha256_ac7722b7428b1db345f1b7fab7f4d5774}{data\_size}}())\ +\ \textcolor{stringliteral}{"{}\(\backslash\)"{}\}"{}};}
\DoxyCodeLine{00269\ }
\DoxyCodeLine{00270\ \ \ \ std::vector<uint8\_t>\ auth\_data(37);}
\DoxyCodeLine{00271\ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(auth\_data.data(),\ origin\_hash.\mbox{\hyperlink{classfc_1_1sha256_ab897537f6c524085b28049be51ed370d}{data}}(),\ \textcolor{keyword}{sizeof}(origin\_hash));}
\DoxyCodeLine{00272\ }
\DoxyCodeLine{00273\ \ \ \ BOOST\_CHECK\_EQUAL(wa\_pub,\ make\_webauthn\_sig(priv,\ auth\_data,\ \mbox{\hyperlink{classfc_1_1json}{json}}).recover(d,\ \textcolor{keyword}{true}));}
\DoxyCodeLine{00274\ \}\ \mbox{\hyperlink{test__webauthn_8cpp_ae70bfa24f5a3bc0917382b3c17fc033c}{FC\_LOG\_AND\_RETHROW}}();}

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{test__webauthn_8cpp_a4fa4b484f47ac1bf70c7b2c99a91c9fb_cgraph}
\end{center}
\end{figure}
\Hypertarget{test__webauthn_8cpp_a15cf1d57bbd4118800b640e96c012cd2}\index{test\_webauthn.cpp@{test\_webauthn.cpp}!BOOST\_AUTO\_TEST\_CASE@{BOOST\_AUTO\_TEST\_CASE}}
\index{BOOST\_AUTO\_TEST\_CASE@{BOOST\_AUTO\_TEST\_CASE}!test\_webauthn.cpp@{test\_webauthn.cpp}}
\doxysubsubsection{\texorpdfstring{BOOST\_AUTO\_TEST\_CASE()}{BOOST\_AUTO\_TEST\_CASE()}\hspace{0.1cm}{\footnotesize\ttfamily [16/26]}}
{\footnotesize\ttfamily \label{test__webauthn_8cpp_a15cf1d57bbd4118800b640e96c012cd2} 
BOOST\+\_\+\+AUTO\+\_\+\+TEST\+\_\+\+CASE (\begin{DoxyParamCaption}\item[{good\+\_\+no\+\_\+trailing\+\_\+equal}]{}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{test__webauthn_8cpp_source_l00391}{391}} of file \mbox{\hyperlink{test__webauthn_8cpp_source}{test\+\_\+webauthn.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00391\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00392\ \ \ \ \mbox{\hyperlink{classfc_1_1crypto_1_1webauthn_1_1public__key}{webauthn::public\_key}}\ wa\_pub(pub.serialize(),\ webauthn::public\_key::user\_presence\_t::USER\_PRESENCE\_NONE,\ \textcolor{stringliteral}{"{}fctesting.invalid"{}});}
\DoxyCodeLine{00393\ }
\DoxyCodeLine{00394\ \ \ \ std::string\ \mbox{\hyperlink{classfc_1_1json}{json}}\ =\ \textcolor{stringliteral}{"{}\{\(\backslash\)"{}origin\(\backslash\)"{}:\(\backslash\)"{}https://fctesting.invalid\(\backslash\)"{},\(\backslash\)"{}type\(\backslash\)"{}:\(\backslash\)"{}webauthn.get\(\backslash\)"{},\(\backslash\)"{}challenge\(\backslash\)"{}:\(\backslash\)"{}"{}}\ +\ \mbox{\hyperlink{namespacefc_a4d30681e99b9cacc0c9b3b8985a5daa4}{fc::base64url\_encode}}(d.\mbox{\hyperlink{classfc_1_1sha256_ab897537f6c524085b28049be51ed370d}{data}}(),\ d.\mbox{\hyperlink{classfc_1_1sha256_ac7722b7428b1db345f1b7fab7f4d5774}{data\_size}}())\ +\ \textcolor{stringliteral}{"{}\(\backslash\)"{}\}"{}};}
\DoxyCodeLine{00395\ \ \ \ boost::erase\_all(\mbox{\hyperlink{classfc_1_1json}{json}},\ \textcolor{stringliteral}{"{}="{}});}
\DoxyCodeLine{00396\ }
\DoxyCodeLine{00397\ \ \ \ std::vector<uint8\_t>\ auth\_data(37);}
\DoxyCodeLine{00398\ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(auth\_data.data(),\ origin\_hash.\mbox{\hyperlink{classfc_1_1sha256_ab897537f6c524085b28049be51ed370d}{data}}(),\ \textcolor{keyword}{sizeof}(origin\_hash));}
\DoxyCodeLine{00399\ }
\DoxyCodeLine{00400\ \ \ \ BOOST\_CHECK\_EQUAL(wa\_pub,\ make\_webauthn\_sig(priv,\ auth\_data,\ \mbox{\hyperlink{classfc_1_1json}{json}}).recover(d,\ \textcolor{keyword}{true}));}
\DoxyCodeLine{00401\ \}\ \mbox{\hyperlink{test__webauthn_8cpp_ae70bfa24f5a3bc0917382b3c17fc033c}{FC\_LOG\_AND\_RETHROW}}();}

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{test__webauthn_8cpp_a15cf1d57bbd4118800b640e96c012cd2_cgraph}
\end{center}
\end{figure}
\Hypertarget{test__webauthn_8cpp_aae90fa97d890394d420629752fef64df}\index{test\_webauthn.cpp@{test\_webauthn.cpp}!BOOST\_AUTO\_TEST\_CASE@{BOOST\_AUTO\_TEST\_CASE}}
\index{BOOST\_AUTO\_TEST\_CASE@{BOOST\_AUTO\_TEST\_CASE}!test\_webauthn.cpp@{test\_webauthn.cpp}}
\doxysubsubsection{\texorpdfstring{BOOST\_AUTO\_TEST\_CASE()}{BOOST\_AUTO\_TEST\_CASE()}\hspace{0.1cm}{\footnotesize\ttfamily [17/26]}}
{\footnotesize\ttfamily \label{test__webauthn_8cpp_aae90fa97d890394d420629752fef64df} 
BOOST\+\_\+\+AUTO\+\_\+\+TEST\+\_\+\+CASE (\begin{DoxyParamCaption}\item[{good\+\_\+port}]{}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{test__webauthn_8cpp_source_l00123}{123}} of file \mbox{\hyperlink{test__webauthn_8cpp_source}{test\+\_\+webauthn.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00123\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00124\ \ \ \ \mbox{\hyperlink{classfc_1_1crypto_1_1webauthn_1_1public__key}{webauthn::public\_key}}\ wa\_pub(pub.serialize(),\ webauthn::public\_key::user\_presence\_t::USER\_PRESENCE\_NONE,\ \textcolor{stringliteral}{"{}fctesting.invalid"{}});}
\DoxyCodeLine{00125\ \ \ \ std::string\ \mbox{\hyperlink{classfc_1_1json}{json}}\ =\ \textcolor{stringliteral}{"{}\{\(\backslash\)"{}origin\(\backslash\)"{}:\(\backslash\)"{}https://fctesting.invalid:123456\(\backslash\)"{},\(\backslash\)"{}type\(\backslash\)"{}:\(\backslash\)"{}webauthn.get\(\backslash\)"{},\(\backslash\)"{}challenge\(\backslash\)"{}:\(\backslash\)"{}"{}}\ +\ \mbox{\hyperlink{namespacefc_a4d30681e99b9cacc0c9b3b8985a5daa4}{fc::base64url\_encode}}(d.\mbox{\hyperlink{classfc_1_1sha256_ab897537f6c524085b28049be51ed370d}{data}}(),\ d.\mbox{\hyperlink{classfc_1_1sha256_ac7722b7428b1db345f1b7fab7f4d5774}{data\_size}}())\ +\ \textcolor{stringliteral}{"{}\(\backslash\)"{}\}"{}};}
\DoxyCodeLine{00126\ }
\DoxyCodeLine{00127\ \ \ \ std::vector<uint8\_t>\ auth\_data(37);}
\DoxyCodeLine{00128\ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(auth\_data.data(),\ origin\_hash.\mbox{\hyperlink{classfc_1_1sha256_ab897537f6c524085b28049be51ed370d}{data}}(),\ \textcolor{keyword}{sizeof}(origin\_hash));}
\DoxyCodeLine{00129\ }
\DoxyCodeLine{00130\ \ \ \ BOOST\_CHECK\_EQUAL(wa\_pub,\ make\_webauthn\_sig(priv,\ auth\_data,\ \mbox{\hyperlink{classfc_1_1json}{json}}).recover(d,\ \textcolor{keyword}{true}));}
\DoxyCodeLine{00131\ \}\ \mbox{\hyperlink{test__webauthn_8cpp_ae70bfa24f5a3bc0917382b3c17fc033c}{FC\_LOG\_AND\_RETHROW}}();}

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{test__webauthn_8cpp_aae90fa97d890394d420629752fef64df_cgraph}
\end{center}
\end{figure}
\Hypertarget{test__webauthn_8cpp_a1a4dc27ff697dc8d69cbd8bfd3e41853}\index{test\_webauthn.cpp@{test\_webauthn.cpp}!BOOST\_AUTO\_TEST\_CASE@{BOOST\_AUTO\_TEST\_CASE}}
\index{BOOST\_AUTO\_TEST\_CASE@{BOOST\_AUTO\_TEST\_CASE}!test\_webauthn.cpp@{test\_webauthn.cpp}}
\doxysubsubsection{\texorpdfstring{BOOST\_AUTO\_TEST\_CASE()}{BOOST\_AUTO\_TEST\_CASE()}\hspace{0.1cm}{\footnotesize\ttfamily [18/26]}}
{\footnotesize\ttfamily \label{test__webauthn_8cpp_a1a4dc27ff697dc8d69cbd8bfd3e41853} 
BOOST\+\_\+\+AUTO\+\_\+\+TEST\+\_\+\+CASE (\begin{DoxyParamCaption}\item[{lacking\+\_\+scheme}]{}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{test__webauthn_8cpp_source_l00097}{97}} of file \mbox{\hyperlink{test__webauthn_8cpp_source}{test\+\_\+webauthn.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00097\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00098\ \ \ \ \mbox{\hyperlink{classfc_1_1crypto_1_1webauthn_1_1public__key}{webauthn::public\_key}}\ wa\_pub(pub.serialize(),\ webauthn::public\_key::user\_presence\_t::USER\_PRESENCE\_NONE,\ \textcolor{stringliteral}{"{}fctesting.invalid"{}});}
\DoxyCodeLine{00099\ \ \ \ std::string\ \mbox{\hyperlink{classfc_1_1json}{json}}\ =\ \textcolor{stringliteral}{"{}\{\(\backslash\)"{}origin\(\backslash\)"{}:\(\backslash\)"{}fctesting.invalid\(\backslash\)"{},\(\backslash\)"{}type\(\backslash\)"{}:\(\backslash\)"{}webauthn.get\(\backslash\)"{},\(\backslash\)"{}challenge\(\backslash\)"{}:\(\backslash\)"{}"{}}\ +\ \mbox{\hyperlink{namespacefc_a4d30681e99b9cacc0c9b3b8985a5daa4}{fc::base64url\_encode}}(d.\mbox{\hyperlink{classfc_1_1sha256_ab897537f6c524085b28049be51ed370d}{data}}(),\ d.\mbox{\hyperlink{classfc_1_1sha256_ac7722b7428b1db345f1b7fab7f4d5774}{data\_size}}())\ +\ \textcolor{stringliteral}{"{}\(\backslash\)"{}\}"{}};}
\DoxyCodeLine{00100\ }
\DoxyCodeLine{00101\ \ \ \ std::vector<uint8\_t>\ auth\_data(37);}
\DoxyCodeLine{00102\ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(auth\_data.data(),\ origin\_hash.\mbox{\hyperlink{classfc_1_1sha256_ab897537f6c524085b28049be51ed370d}{data}}(),\ \textcolor{keyword}{sizeof}(origin\_hash));}
\DoxyCodeLine{00103\ }
\DoxyCodeLine{00104\ \ \ \ BOOST\_CHECK\_EXCEPTION(make\_webauthn\_sig(priv,\ auth\_data,\ \mbox{\hyperlink{classfc_1_1json}{json}}).recover(d,\ \textcolor{keyword}{true}),\ fc::assert\_exception,\ [](\textcolor{keyword}{const}\ fc::assert\_exception\&\ e)\ \{}
\DoxyCodeLine{00105\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ e.to\_detail\_string().find(\textcolor{stringliteral}{"{}webauthn\ origin\ must\ begin\ with\ https://"{}})\ !=\ std::string::npos;}
\DoxyCodeLine{00106\ \ \ \ \});}
\DoxyCodeLine{00107\ \}\ \mbox{\hyperlink{test__webauthn_8cpp_ae70bfa24f5a3bc0917382b3c17fc033c}{FC\_LOG\_AND\_RETHROW}}();}

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{test__webauthn_8cpp_a1a4dc27ff697dc8d69cbd8bfd3e41853_cgraph}
\end{center}
\end{figure}
\Hypertarget{test__webauthn_8cpp_a2a1d2f05f67659071e22f320ef91c0ef}\index{test\_webauthn.cpp@{test\_webauthn.cpp}!BOOST\_AUTO\_TEST\_CASE@{BOOST\_AUTO\_TEST\_CASE}}
\index{BOOST\_AUTO\_TEST\_CASE@{BOOST\_AUTO\_TEST\_CASE}!test\_webauthn.cpp@{test\_webauthn.cpp}}
\doxysubsubsection{\texorpdfstring{BOOST\_AUTO\_TEST\_CASE()}{BOOST\_AUTO\_TEST\_CASE()}\hspace{0.1cm}{\footnotesize\ttfamily [19/26]}}
{\footnotesize\ttfamily \label{test__webauthn_8cpp_a2a1d2f05f67659071e22f320ef91c0ef} 
BOOST\+\_\+\+AUTO\+\_\+\+TEST\+\_\+\+CASE (\begin{DoxyParamCaption}\item[{mismatch\+\_\+origin}]{}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{test__webauthn_8cpp_source_l00072}{72}} of file \mbox{\hyperlink{test__webauthn_8cpp_source}{test\+\_\+webauthn.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00072\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00073\ \ \ \ \mbox{\hyperlink{classfc_1_1crypto_1_1webauthn_1_1public__key}{webauthn::public\_key}}\ wa\_pub(pub.serialize(),\ webauthn::public\_key::user\_presence\_t::USER\_PRESENCE\_PRESENT,\ \textcolor{stringliteral}{"{}fctesting.invalid"{}});}
\DoxyCodeLine{00074\ \ \ \ std::string\ \mbox{\hyperlink{classfc_1_1json}{json}}\ =\ \textcolor{stringliteral}{"{}\{\(\backslash\)"{}origin\(\backslash\)"{}:\(\backslash\)"{}https://mallory.invalid\(\backslash\)"{},\(\backslash\)"{}type\(\backslash\)"{}:\(\backslash\)"{}webauthn.get\(\backslash\)"{},\(\backslash\)"{}challenge\(\backslash\)"{}:\(\backslash\)"{}"{}}\ +\ \mbox{\hyperlink{namespacefc_a4d30681e99b9cacc0c9b3b8985a5daa4}{fc::base64url\_encode}}(d.\mbox{\hyperlink{classfc_1_1sha256_ab897537f6c524085b28049be51ed370d}{data}}(),\ d.\mbox{\hyperlink{classfc_1_1sha256_ac7722b7428b1db345f1b7fab7f4d5774}{data\_size}}())\ +\ \textcolor{stringliteral}{"{}\(\backslash\)"{}\}"{}};}
\DoxyCodeLine{00075\ }
\DoxyCodeLine{00076\ \ \ \ std::vector<uint8\_t>\ auth\_data(37);}
\DoxyCodeLine{00077\ \ \ \ \mbox{\hyperlink{classfc_1_1sha256}{fc::sha256}}\ mallory\_origin\_hash\ =\ \mbox{\hyperlink{classfc_1_1sha256_a474784de7d6213b855abd7e952df5e36}{fc::sha256::hash}}(\textcolor{stringliteral}{"{}mallory.invalid"{}}\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}});}
\DoxyCodeLine{00078\ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(auth\_data.data(),\ mallory\_origin\_hash.\mbox{\hyperlink{classfc_1_1sha256_ab897537f6c524085b28049be51ed370d}{data}}(),\ \textcolor{keyword}{sizeof}(mallory\_origin\_hash));}
\DoxyCodeLine{00079\ }
\DoxyCodeLine{00080\ \ \ \ BOOST\_CHECK\_NE(wa\_pub,\ make\_webauthn\_sig(priv,\ auth\_data,\ \mbox{\hyperlink{classfc_1_1json}{json}}).recover(d,\ \textcolor{keyword}{true}));}
\DoxyCodeLine{00081\ \}\ \mbox{\hyperlink{test__webauthn_8cpp_ae70bfa24f5a3bc0917382b3c17fc033c}{FC\_LOG\_AND\_RETHROW}}();}

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{test__webauthn_8cpp_a2a1d2f05f67659071e22f320ef91c0ef_cgraph}
\end{center}
\end{figure}
\Hypertarget{test__webauthn_8cpp_a8f1802f977a71adb7942a40d8e9f6c47}\index{test\_webauthn.cpp@{test\_webauthn.cpp}!BOOST\_AUTO\_TEST\_CASE@{BOOST\_AUTO\_TEST\_CASE}}
\index{BOOST\_AUTO\_TEST\_CASE@{BOOST\_AUTO\_TEST\_CASE}!test\_webauthn.cpp@{test\_webauthn.cpp}}
\doxysubsubsection{\texorpdfstring{BOOST\_AUTO\_TEST\_CASE()}{BOOST\_AUTO\_TEST\_CASE()}\hspace{0.1cm}{\footnotesize\ttfamily [20/26]}}
{\footnotesize\ttfamily \label{test__webauthn_8cpp_a8f1802f977a71adb7942a40d8e9f6c47} 
BOOST\+\_\+\+AUTO\+\_\+\+TEST\+\_\+\+CASE (\begin{DoxyParamCaption}\item[{mismatch\+\_\+presence}]{}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{test__webauthn_8cpp_source_l00060}{60}} of file \mbox{\hyperlink{test__webauthn_8cpp_source}{test\+\_\+webauthn.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00060\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00061\ \ \ \ \mbox{\hyperlink{classfc_1_1crypto_1_1webauthn_1_1public__key}{webauthn::public\_key}}\ wa\_pub(pub.serialize(),\ webauthn::public\_key::user\_presence\_t::USER\_PRESENCE\_PRESENT,\ \textcolor{stringliteral}{"{}fctesting.invalid"{}});}
\DoxyCodeLine{00062\ \ \ \ std::string\ \mbox{\hyperlink{classfc_1_1json}{json}}\ =\ \textcolor{stringliteral}{"{}\{\(\backslash\)"{}origin\(\backslash\)"{}:\(\backslash\)"{}https://fctesting.invalid\(\backslash\)"{},\(\backslash\)"{}type\(\backslash\)"{}:\(\backslash\)"{}webauthn.get\(\backslash\)"{},\(\backslash\)"{}challenge\(\backslash\)"{}:\(\backslash\)"{}"{}}\ +\ \mbox{\hyperlink{namespacefc_a4d30681e99b9cacc0c9b3b8985a5daa4}{fc::base64url\_encode}}(d.\mbox{\hyperlink{classfc_1_1sha256_ab897537f6c524085b28049be51ed370d}{data}}(),\ d.\mbox{\hyperlink{classfc_1_1sha256_ac7722b7428b1db345f1b7fab7f4d5774}{data\_size}}())\ +\ \textcolor{stringliteral}{"{}\(\backslash\)"{}\}"{}};}
\DoxyCodeLine{00063\ }
\DoxyCodeLine{00064\ \ \ \ std::vector<uint8\_t>\ auth\_data(37);}
\DoxyCodeLine{00065\ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(auth\_data.data(),\ origin\_hash.\mbox{\hyperlink{classfc_1_1sha256_ab897537f6c524085b28049be51ed370d}{data}}(),\ \textcolor{keyword}{sizeof}(origin\_hash));}
\DoxyCodeLine{00066\ \ \ \ auth\_data[32]\ |=\ 0x04;\ \textcolor{comment}{//User\ presence\ verified}}
\DoxyCodeLine{00067\ }
\DoxyCodeLine{00068\ \ \ \ BOOST\_CHECK\_NE(wa\_pub,\ make\_webauthn\_sig(priv,\ auth\_data,\ \mbox{\hyperlink{classfc_1_1json}{json}}).recover(d,\ \textcolor{keyword}{true}));}
\DoxyCodeLine{00069\ \}\ \mbox{\hyperlink{test__webauthn_8cpp_ae70bfa24f5a3bc0917382b3c17fc033c}{FC\_LOG\_AND\_RETHROW}}();}

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{test__webauthn_8cpp_a8f1802f977a71adb7942a40d8e9f6c47_cgraph}
\end{center}
\end{figure}
\Hypertarget{test__webauthn_8cpp_a0c364fa12210f90fb306e3948cd3e5b0}\index{test\_webauthn.cpp@{test\_webauthn.cpp}!BOOST\_AUTO\_TEST\_CASE@{BOOST\_AUTO\_TEST\_CASE}}
\index{BOOST\_AUTO\_TEST\_CASE@{BOOST\_AUTO\_TEST\_CASE}!test\_webauthn.cpp@{test\_webauthn.cpp}}
\doxysubsubsection{\texorpdfstring{BOOST\_AUTO\_TEST\_CASE()}{BOOST\_AUTO\_TEST\_CASE()}\hspace{0.1cm}{\footnotesize\ttfamily [21/26]}}
{\footnotesize\ttfamily \label{test__webauthn_8cpp_a0c364fa12210f90fb306e3948cd3e5b0} 
BOOST\+\_\+\+AUTO\+\_\+\+TEST\+\_\+\+CASE (\begin{DoxyParamCaption}\item[{missing\+\_\+challenge}]{}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{test__webauthn_8cpp_source_l00252}{252}} of file \mbox{\hyperlink{test__webauthn_8cpp_source}{test\+\_\+webauthn.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00252\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00253\ \ \ \ \mbox{\hyperlink{classfc_1_1crypto_1_1webauthn_1_1public__key}{webauthn::public\_key}}\ wa\_pub(pub.serialize(),\ webauthn::public\_key::user\_presence\_t::USER\_PRESENCE\_NONE,\ \textcolor{stringliteral}{"{}fctesting.invalid"{}});}
\DoxyCodeLine{00254\ \ \ \ std::string\ \mbox{\hyperlink{classfc_1_1json}{json}}\ =\ \textcolor{stringliteral}{"{}\{\(\backslash\)"{}origin\(\backslash\)"{}:\(\backslash\)"{}https://fctesting.invalid\(\backslash\)"{},\(\backslash\)"{}type\(\backslash\)"{}:\(\backslash\)"{}webauthn.get\(\backslash\)"{}\}"{}};}
\DoxyCodeLine{00255\ }
\DoxyCodeLine{00256\ \ \ \ std::vector<uint8\_t>\ auth\_data(37);}
\DoxyCodeLine{00257\ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(auth\_data.data(),\ origin\_hash.\mbox{\hyperlink{classfc_1_1sha256_ab897537f6c524085b28049be51ed370d}{data}}(),\ \textcolor{keyword}{sizeof}(origin\_hash));}
\DoxyCodeLine{00258\ }
\DoxyCodeLine{00259\ \ \ \ BOOST\_CHECK\_EXCEPTION(make\_webauthn\_sig(priv,\ auth\_data,\ \mbox{\hyperlink{classfc_1_1json}{json}}).recover(d,\ \textcolor{keyword}{true}),\ \mbox{\hyperlink{classfc_1_1exception}{fc::exception}},\ [](\textcolor{keyword}{const}\ \mbox{\hyperlink{classfc_1_1exception}{fc::exception}}\&\ e)\ \{}
\DoxyCodeLine{00260\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ e.\mbox{\hyperlink{classfc_1_1exception_a7611ea8fbe25dde56649b685c2298a37}{to\_detail\_string}}().find(\textcolor{stringliteral}{"{}sha256:\ size\ mismatch"{}})\ !=\ std::string::npos;}
\DoxyCodeLine{00261\ \ \ \ \});}
\DoxyCodeLine{00262\ \}\ \mbox{\hyperlink{test__webauthn_8cpp_ae70bfa24f5a3bc0917382b3c17fc033c}{FC\_LOG\_AND\_RETHROW}}();}

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{test__webauthn_8cpp_a0c364fa12210f90fb306e3948cd3e5b0_cgraph}
\end{center}
\end{figure}
\Hypertarget{test__webauthn_8cpp_af95c77a48776d8dc9544884aaeaf5946}\index{test\_webauthn.cpp@{test\_webauthn.cpp}!BOOST\_AUTO\_TEST\_CASE@{BOOST\_AUTO\_TEST\_CASE}}
\index{BOOST\_AUTO\_TEST\_CASE@{BOOST\_AUTO\_TEST\_CASE}!test\_webauthn.cpp@{test\_webauthn.cpp}}
\doxysubsubsection{\texorpdfstring{BOOST\_AUTO\_TEST\_CASE()}{BOOST\_AUTO\_TEST\_CASE()}\hspace{0.1cm}{\footnotesize\ttfamily [22/26]}}
{\footnotesize\ttfamily \label{test__webauthn_8cpp_af95c77a48776d8dc9544884aaeaf5946} 
BOOST\+\_\+\+AUTO\+\_\+\+TEST\+\_\+\+CASE (\begin{DoxyParamCaption}\item[{missing\+\_\+origin}]{}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{test__webauthn_8cpp_source_l00226}{226}} of file \mbox{\hyperlink{test__webauthn_8cpp_source}{test\+\_\+webauthn.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00226\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00227\ \ \ \ \mbox{\hyperlink{classfc_1_1crypto_1_1webauthn_1_1public__key}{webauthn::public\_key}}\ wa\_pub(pub.serialize(),\ webauthn::public\_key::user\_presence\_t::USER\_PRESENCE\_NONE,\ \textcolor{stringliteral}{"{}fctesting.invalid"{}});}
\DoxyCodeLine{00228\ \ \ \ std::string\ \mbox{\hyperlink{classfc_1_1json}{json}}\ =\ \textcolor{stringliteral}{"{}\{\(\backslash\)"{}type\(\backslash\)"{}:\(\backslash\)"{}webauthn.get\(\backslash\)"{},\(\backslash\)"{}challenge\(\backslash\)"{}:\(\backslash\)"{}"{}}\ +\ \mbox{\hyperlink{namespacefc_a4d30681e99b9cacc0c9b3b8985a5daa4}{fc::base64url\_encode}}(d.\mbox{\hyperlink{classfc_1_1sha256_ab897537f6c524085b28049be51ed370d}{data}}(),\ d.\mbox{\hyperlink{classfc_1_1sha256_ac7722b7428b1db345f1b7fab7f4d5774}{data\_size}}())\ +\ \textcolor{stringliteral}{"{}\(\backslash\)"{}\}"{}};}
\DoxyCodeLine{00229\ }
\DoxyCodeLine{00230\ \ \ \ std::vector<uint8\_t>\ auth\_data(37);}
\DoxyCodeLine{00231\ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(auth\_data.data(),\ origin\_hash.\mbox{\hyperlink{classfc_1_1sha256_ab897537f6c524085b28049be51ed370d}{data}}(),\ \textcolor{keyword}{sizeof}(origin\_hash));}
\DoxyCodeLine{00232\ }
\DoxyCodeLine{00233\ \ \ \ BOOST\_CHECK\_EXCEPTION(make\_webauthn\_sig(priv,\ auth\_data,\ \mbox{\hyperlink{classfc_1_1json}{json}}).recover(d,\ \textcolor{keyword}{true}),\ fc::assert\_exception,\ [](\textcolor{keyword}{const}\ fc::assert\_exception\&\ e)\ \{}
\DoxyCodeLine{00234\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ e.to\_detail\_string().find(\textcolor{stringliteral}{"{}webauthn\ origin\ must\ begin\ with\ https://"{}})\ !=\ std::string::npos;}
\DoxyCodeLine{00235\ \ \ \ \});}
\DoxyCodeLine{00236\ \}\ \mbox{\hyperlink{test__webauthn_8cpp_ae70bfa24f5a3bc0917382b3c17fc033c}{FC\_LOG\_AND\_RETHROW}}();}

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{test__webauthn_8cpp_af95c77a48776d8dc9544884aaeaf5946_cgraph}
\end{center}
\end{figure}
\Hypertarget{test__webauthn_8cpp_a91ac61998bf2fbd672164518842c3dbc}\index{test\_webauthn.cpp@{test\_webauthn.cpp}!BOOST\_AUTO\_TEST\_CASE@{BOOST\_AUTO\_TEST\_CASE}}
\index{BOOST\_AUTO\_TEST\_CASE@{BOOST\_AUTO\_TEST\_CASE}!test\_webauthn.cpp@{test\_webauthn.cpp}}
\doxysubsubsection{\texorpdfstring{BOOST\_AUTO\_TEST\_CASE()}{BOOST\_AUTO\_TEST\_CASE()}\hspace{0.1cm}{\footnotesize\ttfamily [23/26]}}
{\footnotesize\ttfamily \label{test__webauthn_8cpp_a91ac61998bf2fbd672164518842c3dbc} 
BOOST\+\_\+\+AUTO\+\_\+\+TEST\+\_\+\+CASE (\begin{DoxyParamCaption}\item[{missing\+\_\+type}]{}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{test__webauthn_8cpp_source_l00239}{239}} of file \mbox{\hyperlink{test__webauthn_8cpp_source}{test\+\_\+webauthn.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00239\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00240\ \ \ \ \mbox{\hyperlink{classfc_1_1crypto_1_1webauthn_1_1public__key}{webauthn::public\_key}}\ wa\_pub(pub.serialize(),\ webauthn::public\_key::user\_presence\_t::USER\_PRESENCE\_NONE,\ \textcolor{stringliteral}{"{}fctesting.invalid"{}});}
\DoxyCodeLine{00241\ \ \ \ std::string\ \mbox{\hyperlink{classfc_1_1json}{json}}\ =\ \textcolor{stringliteral}{"{}\{\(\backslash\)"{}origin\(\backslash\)"{}:\(\backslash\)"{}https://fctesting.invalid\(\backslash\)"{},\(\backslash\)"{}challenge\(\backslash\)"{}:\(\backslash\)"{}"{}}\ +\ \mbox{\hyperlink{namespacefc_a4d30681e99b9cacc0c9b3b8985a5daa4}{fc::base64url\_encode}}(d.\mbox{\hyperlink{classfc_1_1sha256_ab897537f6c524085b28049be51ed370d}{data}}(),\ d.\mbox{\hyperlink{classfc_1_1sha256_ac7722b7428b1db345f1b7fab7f4d5774}{data\_size}}())\ +\ \textcolor{stringliteral}{"{}\(\backslash\)"{}\}"{}};}
\DoxyCodeLine{00242\ }
\DoxyCodeLine{00243\ \ \ \ std::vector<uint8\_t>\ auth\_data(37);}
\DoxyCodeLine{00244\ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(auth\_data.data(),\ origin\_hash.\mbox{\hyperlink{classfc_1_1sha256_ab897537f6c524085b28049be51ed370d}{data}}(),\ \textcolor{keyword}{sizeof}(origin\_hash));}
\DoxyCodeLine{00245\ }
\DoxyCodeLine{00246\ \ \ \ BOOST\_CHECK\_EXCEPTION(make\_webauthn\_sig(priv,\ auth\_data,\ \mbox{\hyperlink{classfc_1_1json}{json}}).recover(d,\ \textcolor{keyword}{true}),\ fc::assert\_exception,\ [](\textcolor{keyword}{const}\ fc::assert\_exception\&\ e)\ \{}
\DoxyCodeLine{00247\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ e.to\_detail\_string().find(\textcolor{stringliteral}{"{}webauthn\ signature\ type\ not\ an\ assertion"{}})\ !=\ std::string::npos;}
\DoxyCodeLine{00248\ \ \ \ \});}
\DoxyCodeLine{00249\ \}\ \mbox{\hyperlink{test__webauthn_8cpp_ae70bfa24f5a3bc0917382b3c17fc033c}{FC\_LOG\_AND\_RETHROW}}();}

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{test__webauthn_8cpp_a91ac61998bf2fbd672164518842c3dbc_cgraph}
\end{center}
\end{figure}
\Hypertarget{test__webauthn_8cpp_a4b9953c77aafa04553785736c43e07a5}\index{test\_webauthn.cpp@{test\_webauthn.cpp}!BOOST\_AUTO\_TEST\_CASE@{BOOST\_AUTO\_TEST\_CASE}}
\index{BOOST\_AUTO\_TEST\_CASE@{BOOST\_AUTO\_TEST\_CASE}!test\_webauthn.cpp@{test\_webauthn.cpp}}
\doxysubsubsection{\texorpdfstring{BOOST\_AUTO\_TEST\_CASE()}{BOOST\_AUTO\_TEST\_CASE()}\hspace{0.1cm}{\footnotesize\ttfamily [24/26]}}
{\footnotesize\ttfamily \label{test__webauthn_8cpp_a4b9953c77aafa04553785736c43e07a5} 
BOOST\+\_\+\+AUTO\+\_\+\+TEST\+\_\+\+CASE (\begin{DoxyParamCaption}\item[{non\+\_\+https}]{}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{test__webauthn_8cpp_source_l00084}{84}} of file \mbox{\hyperlink{test__webauthn_8cpp_source}{test\+\_\+webauthn.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00084\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00085\ \ \ \ \mbox{\hyperlink{classfc_1_1crypto_1_1webauthn_1_1public__key}{webauthn::public\_key}}\ wa\_pub(pub.serialize(),\ webauthn::public\_key::user\_presence\_t::USER\_PRESENCE\_NONE,\ \textcolor{stringliteral}{"{}fctesting.invalid"{}});}
\DoxyCodeLine{00086\ \ \ \ std::string\ \mbox{\hyperlink{classfc_1_1json}{json}}\ =\ \textcolor{stringliteral}{"{}\{\(\backslash\)"{}origin\(\backslash\)"{}:\(\backslash\)"{}http://fctesting.invalid\(\backslash\)"{},\(\backslash\)"{}type\(\backslash\)"{}:\(\backslash\)"{}webauthn.get\(\backslash\)"{},\(\backslash\)"{}challenge\(\backslash\)"{}:\(\backslash\)"{}"{}}\ +\ \mbox{\hyperlink{namespacefc_a4d30681e99b9cacc0c9b3b8985a5daa4}{fc::base64url\_encode}}(d.\mbox{\hyperlink{classfc_1_1sha256_ab897537f6c524085b28049be51ed370d}{data}}(),\ d.\mbox{\hyperlink{classfc_1_1sha256_ac7722b7428b1db345f1b7fab7f4d5774}{data\_size}}())\ +\ \textcolor{stringliteral}{"{}\(\backslash\)"{}\}"{}};}
\DoxyCodeLine{00087\ }
\DoxyCodeLine{00088\ \ \ \ std::vector<uint8\_t>\ auth\_data(37);}
\DoxyCodeLine{00089\ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(auth\_data.data(),\ origin\_hash.\mbox{\hyperlink{classfc_1_1sha256_ab897537f6c524085b28049be51ed370d}{data}}(),\ \textcolor{keyword}{sizeof}(origin\_hash));}
\DoxyCodeLine{00090\ }
\DoxyCodeLine{00091\ \ \ \ BOOST\_CHECK\_EXCEPTION(make\_webauthn\_sig(priv,\ auth\_data,\ \mbox{\hyperlink{classfc_1_1json}{json}}).recover(d,\ \textcolor{keyword}{true}),\ fc::assert\_exception,\ [](\textcolor{keyword}{const}\ fc::assert\_exception\&\ e)\ \{}
\DoxyCodeLine{00092\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ e.to\_detail\_string().find(\textcolor{stringliteral}{"{}webauthn\ origin\ must\ begin\ with\ https://"{}})\ !=\ std::string::npos;}
\DoxyCodeLine{00093\ \ \ \ \});}
\DoxyCodeLine{00094\ \}\ \mbox{\hyperlink{test__webauthn_8cpp_ae70bfa24f5a3bc0917382b3c17fc033c}{FC\_LOG\_AND\_RETHROW}}();}

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{test__webauthn_8cpp_a4b9953c77aafa04553785736c43e07a5_cgraph}
\end{center}
\end{figure}
\Hypertarget{test__webauthn_8cpp_a72e0ee1c4a2abdcc362828f8ca7f119d}\index{test\_webauthn.cpp@{test\_webauthn.cpp}!BOOST\_AUTO\_TEST\_CASE@{BOOST\_AUTO\_TEST\_CASE}}
\index{BOOST\_AUTO\_TEST\_CASE@{BOOST\_AUTO\_TEST\_CASE}!test\_webauthn.cpp@{test\_webauthn.cpp}}
\doxysubsubsection{\texorpdfstring{BOOST\_AUTO\_TEST\_CASE()}{BOOST\_AUTO\_TEST\_CASE()}\hspace{0.1cm}{\footnotesize\ttfamily [25/26]}}
{\footnotesize\ttfamily \label{test__webauthn_8cpp_a72e0ee1c4a2abdcc362828f8ca7f119d} 
BOOST\+\_\+\+AUTO\+\_\+\+TEST\+\_\+\+CASE (\begin{DoxyParamCaption}\item[{not\+\_\+json\+\_\+object}]{}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{test__webauthn_8cpp_source_l00277}{277}} of file \mbox{\hyperlink{test__webauthn_8cpp_source}{test\+\_\+webauthn.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00277\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00278\ \ \ \ \mbox{\hyperlink{classfc_1_1crypto_1_1webauthn_1_1public__key}{webauthn::public\_key}}\ wa\_pub(pub.serialize(),\ webauthn::public\_key::user\_presence\_t::USER\_PRESENCE\_NONE,\ \textcolor{stringliteral}{"{}fctesting.invalid"{}});}
\DoxyCodeLine{00279\ \ \ \ std::string\ \mbox{\hyperlink{classfc_1_1json}{json}}\ =\ \textcolor{stringliteral}{"{}hey\ man"{}}\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}};}
\DoxyCodeLine{00280\ }
\DoxyCodeLine{00281\ \ \ \ std::vector<uint8\_t>\ auth\_data(37);}
\DoxyCodeLine{00282\ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(auth\_data.data(),\ origin\_hash.\mbox{\hyperlink{classfc_1_1sha256_ab897537f6c524085b28049be51ed370d}{data}}(),\ \textcolor{keyword}{sizeof}(origin\_hash));}
\DoxyCodeLine{00283\ }
\DoxyCodeLine{00284\ \ \ \ BOOST\_CHECK\_EXCEPTION(make\_webauthn\_sig(priv,\ auth\_data,\ \mbox{\hyperlink{classfc_1_1json}{json}}).recover(d,\ \textcolor{keyword}{true}),\ fc::assert\_exception,\ [](\textcolor{keyword}{const}\ fc::assert\_exception\&\ e)\ \{}
\DoxyCodeLine{00285\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ e.to\_detail\_string().find(\textcolor{stringliteral}{"{}Failed\ to\ parse\ client\ data\ JSON"{}})\ !=\ std::string::npos;}
\DoxyCodeLine{00286\ \ \ \ \});}
\DoxyCodeLine{00287\ \}\ \mbox{\hyperlink{test__webauthn_8cpp_ae70bfa24f5a3bc0917382b3c17fc033c}{FC\_LOG\_AND\_RETHROW}}();}

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{test__webauthn_8cpp_a72e0ee1c4a2abdcc362828f8ca7f119d_cgraph}
\end{center}
\end{figure}
\Hypertarget{test__webauthn_8cpp_a6d810d26f3a9ea62940516bbcbcf6b90}\index{test\_webauthn.cpp@{test\_webauthn.cpp}!BOOST\_AUTO\_TEST\_CASE@{BOOST\_AUTO\_TEST\_CASE}}
\index{BOOST\_AUTO\_TEST\_CASE@{BOOST\_AUTO\_TEST\_CASE}!test\_webauthn.cpp@{test\_webauthn.cpp}}
\doxysubsubsection{\texorpdfstring{BOOST\_AUTO\_TEST\_CASE()}{BOOST\_AUTO\_TEST\_CASE()}\hspace{0.1cm}{\footnotesize\ttfamily [26/26]}}
{\footnotesize\ttfamily \label{test__webauthn_8cpp_a6d810d26f3a9ea62940516bbcbcf6b90} 
BOOST\+\_\+\+AUTO\+\_\+\+TEST\+\_\+\+CASE (\begin{DoxyParamCaption}\item[{wrong\+\_\+type}]{}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{test__webauthn_8cpp_source_l00185}{185}} of file \mbox{\hyperlink{test__webauthn_8cpp_source}{test\+\_\+webauthn.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00185\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00186\ }
\DoxyCodeLine{00187\ \ \ \ \mbox{\hyperlink{classfc_1_1crypto_1_1webauthn_1_1public__key}{webauthn::public\_key}}\ wa\_pub(pub.serialize(),\ webauthn::public\_key::user\_presence\_t::USER\_PRESENCE\_NONE,\ \textcolor{stringliteral}{"{}fctesting.invalid"{}});}
\DoxyCodeLine{00188\ \ \ \ std::string\ \mbox{\hyperlink{classfc_1_1json}{json}}\ =\ \textcolor{stringliteral}{"{}\{\(\backslash\)"{}origin\(\backslash\)"{}:\(\backslash\)"{}https://fctesting.invalid\(\backslash\)"{},\(\backslash\)"{}type\(\backslash\)"{}:\(\backslash\)"{}webauthn.meh\(\backslash\)"{},\(\backslash\)"{}challenge\(\backslash\)"{}:\(\backslash\)"{}"{}}\ +\ \mbox{\hyperlink{namespacefc_a4d30681e99b9cacc0c9b3b8985a5daa4}{fc::base64url\_encode}}(d.\mbox{\hyperlink{classfc_1_1sha256_ab897537f6c524085b28049be51ed370d}{data}}(),\ d.\mbox{\hyperlink{classfc_1_1sha256_ac7722b7428b1db345f1b7fab7f4d5774}{data\_size}}())\ +\ \textcolor{stringliteral}{"{}\(\backslash\)"{}\}"{}};}
\DoxyCodeLine{00189\ }
\DoxyCodeLine{00190\ \ \ \ std::vector<uint8\_t>\ auth\_data(37);}
\DoxyCodeLine{00191\ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(auth\_data.data(),\ origin\_hash.\mbox{\hyperlink{classfc_1_1sha256_ab897537f6c524085b28049be51ed370d}{data}}(),\ \textcolor{keyword}{sizeof}(origin\_hash));}
\DoxyCodeLine{00192\ }
\DoxyCodeLine{00193\ \ \ \ BOOST\_CHECK\_EXCEPTION(make\_webauthn\_sig(priv,\ auth\_data,\ \mbox{\hyperlink{classfc_1_1json}{json}}).recover(d,\ \textcolor{keyword}{true}),\ fc::assert\_exception,\ [](\textcolor{keyword}{const}\ fc::assert\_exception\&\ e)\ \{}
\DoxyCodeLine{00194\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ e.to\_detail\_string().find(\textcolor{stringliteral}{"{}webauthn\ signature\ type\ not\ an\ assertion"{}})\ !=\ std::string::npos;}
\DoxyCodeLine{00195\ \ \ \ \});}
\DoxyCodeLine{00196\ \}\ \mbox{\hyperlink{test__webauthn_8cpp_ae70bfa24f5a3bc0917382b3c17fc033c}{FC\_LOG\_AND\_RETHROW}}();}

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{test__webauthn_8cpp_a6d810d26f3a9ea62940516bbcbcf6b90_cgraph}
\end{center}
\end{figure}
\Hypertarget{test__webauthn_8cpp_ae70bfa24f5a3bc0917382b3c17fc033c}\index{test\_webauthn.cpp@{test\_webauthn.cpp}!FC\_LOG\_AND\_RETHROW@{FC\_LOG\_AND\_RETHROW}}
\index{FC\_LOG\_AND\_RETHROW@{FC\_LOG\_AND\_RETHROW}!test\_webauthn.cpp@{test\_webauthn.cpp}}
\doxysubsubsection{\texorpdfstring{FC\_LOG\_AND\_RETHROW()}{FC\_LOG\_AND\_RETHROW()}}
{\footnotesize\ttfamily \label{test__webauthn_8cpp_ae70bfa24f5a3bc0917382b3c17fc033c} 
FC\+\_\+\+LOG\+\_\+\+AND\+\_\+\+RETHROW (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})}

