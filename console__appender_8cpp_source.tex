\doxysection{console\+\_\+appender.\+cpp}
\hypertarget{console__appender_8cpp_source}{}\label{console__appender_8cpp_source}\index{libraries/fc/src/log/console\_appender.cpp@{libraries/fc/src/log/console\_appender.cpp}}
\mbox{\hyperlink{console__appender_8cpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00001}00001\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{console__appender_8hpp}{fc/log/console\_appender.hpp}}>}}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00002}00002\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{log__message_8hpp}{fc/log/log\_message.hpp}}>}}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00003}00003\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{string_8hpp}{fc/string.hpp}}>}}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00004}00004\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{fc_2include_2fc_2variant_8hpp}{fc/variant.hpp}}>}}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00005}00005\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{fc_2include_2fc_2reflect_2variant_8hpp}{fc/reflect/variant.hpp}}>}}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00006}00006\ \textcolor{preprocessor}{\#ifndef\ WIN32}}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00007}00007\ \textcolor{preprocessor}{\#include\ <unistd.h>}}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00008}00008\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00009}\mbox{\hyperlink{console__appender_8cpp_a478c5f24881cbe1fc6441efff770463c}{00009}}\ \textcolor{preprocessor}{\#define\ COLOR\_CONSOLE\ 1}}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00010}00010\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{console__defines_8h}{console\_defines.h}}"{}}}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00011}00011\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{exception_8hpp}{fc/exception/exception.hpp}}>}}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00012}00012\ \textcolor{preprocessor}{\#include\ <iomanip>}}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00013}00013\ \textcolor{preprocessor}{\#include\ <mutex>}}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00014}00014\ \textcolor{preprocessor}{\#include\ <sstream>}}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00015}00015\ }
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00016}00016\ }
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00017}00017\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacefc}{fc}}\ \{}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00018}00018\ }
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00019}\mbox{\hyperlink{classfc_1_1console__appender_1_1impl}{00019}}\ \ \ \ \textcolor{keyword}{class\ }\mbox{\hyperlink{classfc_1_1console__appender_1_1impl}{console\_appender::impl}}\ \{}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00020}00020\ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00021}\mbox{\hyperlink{classfc_1_1console__appender_1_1impl_a2fc97c332cff29837eb16c2218704723}{00021}}\ \ \ \ \ \ \mbox{\hyperlink{structfc_1_1console__appender_1_1config}{config}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classfc_1_1console__appender_1_1impl_a2fc97c332cff29837eb16c2218704723}{cfg}};}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00022}\mbox{\hyperlink{classfc_1_1console__appender_1_1impl_af44d61eb9751176bee7d6a506a923ca6}{00022}}\ \ \ \ \ \ \mbox{\hyperlink{structfc_1_1console__appender_1_1color_ae3f964a317f52c91550bd98bb4e4402d}{color::type}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classfc_1_1console__appender_1_1impl_af44d61eb9751176bee7d6a506a923ca6}{lc}}[\mbox{\hyperlink{classfc_1_1log__level_a5a5e31c4c1f38d9115ecbe44927fb2e4a93f96542fabbe1792786b3ab17ad1dda}{log\_level::off}}+1];}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00023}\mbox{\hyperlink{classfc_1_1console__appender_1_1impl_abf6e22a55e56bbe93ac6fb55bbd7f93c}{00023}}\ \ \ \ \ \ \textcolor{keywordtype}{bool}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classfc_1_1console__appender_1_1impl_abf6e22a55e56bbe93ac6fb55bbd7f93c}{use\_syslog\_header}}\{getenv(\textcolor{stringliteral}{"{}JOURNAL\_STREAM"{}})\ !=\ \textcolor{keyword}{nullptr}\};}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00024}00024\ \textcolor{preprocessor}{\#ifdef\ WIN32}}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00025}00025\ \ \ \ \ \ HANDLE\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ console\_handle;}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00026}00026\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00027}00027\ \ \ \ \};}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00028}00028\ }
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00029}\mbox{\hyperlink{classfc_1_1console__appender_a0a006a1985fca8fa9168d983d2be0030}{00029}}\ \ \ \ \mbox{\hyperlink{classfc_1_1console__appender_a2ce8c326496cfd455d390e50ceee6eef}{console\_appender::console\_appender}}(\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classfc_1_1variant}{variant}}\&\ args\ )}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00030}00030\ \ \ \ :my(new\ \mbox{\hyperlink{classfc_1_1console__appender_1_1impl}{impl}})}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00031}00031\ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00032}00032\ \ \ \ \ \ \ \mbox{\hyperlink{classfc_1_1console__appender_ab859b37eea5c803c674ce786f0fa64c5}{configure}}(\ args.as<\mbox{\hyperlink{structfc_1_1console__appender_1_1config}{config}}>()\ );}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00033}00033\ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00034}00034\ }
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00035}\mbox{\hyperlink{classfc_1_1console__appender_a8f9dddd4a61b22543229631f43ace3d2}{00035}}\ \ \ \ \mbox{\hyperlink{classfc_1_1console__appender_a2ce8c326496cfd455d390e50ceee6eef}{console\_appender::console\_appender}}(\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structfc_1_1console__appender_1_1config}{config}}\&\ cfg\ )}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00036}00036\ \ \ \ :my(new\ \mbox{\hyperlink{classfc_1_1console__appender_1_1impl}{impl}})}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00037}00037\ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00038}00038\ \ \ \ \ \ \ \mbox{\hyperlink{classfc_1_1console__appender_ab859b37eea5c803c674ce786f0fa64c5}{configure}}(\ cfg\ );}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00039}00039\ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00040}\mbox{\hyperlink{classfc_1_1console__appender_a2ce8c326496cfd455d390e50ceee6eef}{00040}}\ \ \ \ \mbox{\hyperlink{classfc_1_1console__appender_a2ce8c326496cfd455d390e50ceee6eef}{console\_appender::console\_appender}}()}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00041}00041\ \ \ \ :my(new\ \mbox{\hyperlink{classfc_1_1console__appender_1_1impl}{impl}})\{\}}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00042}00042\ }
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00043}00043\ }
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00044}\mbox{\hyperlink{classfc_1_1console__appender_ab859b37eea5c803c674ce786f0fa64c5}{00044}}\ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classfc_1_1console__appender_ab859b37eea5c803c674ce786f0fa64c5}{console\_appender::configure}}(\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structfc_1_1console__appender_1_1config}{config}}\&\ console\_appender\_config\ )}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00045}00045\ \ \ \ \{\ \textcolor{keywordflow}{try}\ \{}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00046}00046\ \textcolor{preprocessor}{\#ifdef\ WIN32}}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00047}00047\ \ \ \ \ \ \ my-\/>console\_handle\ =\ INVALID\_HANDLE\_VALUE;}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00048}00048\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00049}00049\ \ \ \ \ \ \ my-\/>cfg\ =\ console\_appender\_config;}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00050}00050\ \textcolor{preprocessor}{\#ifdef\ WIN32}}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00051}00051\ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (my-\/>cfg.stream\ ==\ \mbox{\hyperlink{structfc_1_1console__appender_1_1stream_aaf2f066b1d3019c7858383edc440cbf8a5f2c746830a2d1349805a92dc7cb656d}{stream::std\_error}})}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00052}00052\ \ \ \ \ \ \ \ \ \ \ \ \ my-\/>console\_handle\ =\ GetStdHandle(STD\_ERROR\_HANDLE);}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00053}00053\ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (my-\/>cfg.stream\ ==\ \mbox{\hyperlink{structfc_1_1console__appender_1_1stream_aaf2f066b1d3019c7858383edc440cbf8a56183016743ae254a1a804d72656a57e}{stream::std\_out}})}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00054}00054\ \ \ \ \ \ \ \ \ \ \ \ \ my-\/>console\_handle\ =\ GetStdHandle(STD\_OUTPUT\_HANDLE);}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00055}00055\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00056}00056\ }
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00057}00057\ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classfc_1_1log__level_a5a5e31c4c1f38d9115ecbe44927fb2e4a93f96542fabbe1792786b3ab17ad1dda}{log\_level::off}}+1;\ ++i\ )}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00058}00058\ \ \ \ \ \ \ \ \ \ \ \ \ my-\/>lc[i]\ =\ \mbox{\hyperlink{structfc_1_1console__appender_1_1color_ae3f964a317f52c91550bd98bb4e4402da83d2b7a506e9f71773b9b8bc5f922843}{color::console\_default}};}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00059}00059\ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\ \textcolor{keyword}{auto}\ itr\ =\ my-\/>cfg.level\_colors.begin();\ itr\ !=\ my-\/>cfg.level\_colors.end();\ ++itr\ )}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00060}00060\ \ \ \ \ \ \ \ \ \ \ \ \ my-\/>lc[itr-\/>level]\ =\ itr-\/>color;}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00061}00061\ \ \ \ \}\ \mbox{\hyperlink{exception_8hpp_a094902280cad82ad6529ebbd12a697eb}{FC\_CAPTURE\_AND\_RETHROW}}(\ (console\_appender\_config)\ )\ \}}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00062}00062\ }
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00063}\mbox{\hyperlink{classfc_1_1console__appender_a65a8ebf6b619e0cc8e7d39c2c0152c2d}{00063}}\ \ \ \ \mbox{\hyperlink{classfc_1_1console__appender_a65a8ebf6b619e0cc8e7d39c2c0152c2d}{console\_appender::\string~console\_appender}}()\ \{\}}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00064}00064\ }
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00065}00065\ \textcolor{preprocessor}{\ \ \ \#ifdef\ WIN32}}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00066}00066\ \ \ \ \textcolor{keyword}{static}\ WORD}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00067}00067\ \textcolor{preprocessor}{\ \ \ \#else}}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00068}00068\ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00069}00069\ \textcolor{preprocessor}{\ \ \ \#endif}}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00070}00070\ \ \ \ get\_console\_color(\mbox{\hyperlink{structfc_1_1console__appender_1_1color_ae3f964a317f52c91550bd98bb4e4402d}{console\_appender::color::type}}\ t\ )\ \{}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00071}00071\ \ \ \ \ \ \ \textcolor{keywordflow}{switch}(\ t\ )\ \{}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00072}00072\ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{structfc_1_1console__appender_1_1color_ae3f964a317f52c91550bd98bb4e4402da47dcfc9a3c21cc4f7f036d1a131fb409}{console\_appender::color::red}}:\ \textcolor{keywordflow}{return}\ CONSOLE\_RED;}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00073}00073\ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{structfc_1_1console__appender_1_1color_ae3f964a317f52c91550bd98bb4e4402da79816745933fd1a9177d156c7e27e143}{console\_appender::color::green}}:\ \textcolor{keywordflow}{return}\ CONSOLE\_GREEN;}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00074}00074\ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{structfc_1_1console__appender_1_1color_ae3f964a317f52c91550bd98bb4e4402da87a1bab8807775aeddb7402f648532ba}{console\_appender::color::brown}}:\ \textcolor{keywordflow}{return}\ CONSOLE\_BROWN;}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00075}00075\ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{structfc_1_1console__appender_1_1color_ae3f964a317f52c91550bd98bb4e4402dafce63670b6f724afdc0f1c569180076a}{console\_appender::color::blue}}:\ \textcolor{keywordflow}{return}\ CONSOLE\_BLUE;}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00076}00076\ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{structfc_1_1console__appender_1_1color_ae3f964a317f52c91550bd98bb4e4402dac5f059f23b03cf39a362692813eaecb4}{console\_appender::color::magenta}}:\ \textcolor{keywordflow}{return}\ CONSOLE\_MAGENTA;}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00077}00077\ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{structfc_1_1console__appender_1_1color_ae3f964a317f52c91550bd98bb4e4402da029caa5f39c6e55e48633c61efc1d56a}{console\_appender::color::cyan}}:\ \textcolor{keywordflow}{return}\ CONSOLE\_CYAN;}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00078}00078\ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{structfc_1_1console__appender_1_1color_ae3f964a317f52c91550bd98bb4e4402da6067bf373b7d56574d42378d1a796b38}{console\_appender::color::white}}:\ \textcolor{keywordflow}{return}\ CONSOLE\_WHITE;}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00079}00079\ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{structfc_1_1console__appender_1_1color_ae3f964a317f52c91550bd98bb4e4402da83d2b7a506e9f71773b9b8bc5f922843}{console\_appender::color::console\_default}}:}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00080}00080\ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00081}00081\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ CONSOLE\_DEFAULT;}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00082}00082\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00083}00083\ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00084}00084\ }
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00085}\mbox{\hyperlink{namespacefc_acc781e4860d923d50e0acd2b7dae30a4}{00085}}\ \ \ \ \textcolor{keywordtype}{string}\ \mbox{\hyperlink{namespacefc_acc781e4860d923d50e0acd2b7dae30a4}{fixed\_size}}(\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}},\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\&\ str\ )\ \{}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00086}00086\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ str.size()\ ==\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}}\ )\ \textcolor{keywordflow}{return}\ str;}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00087}00087\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ str.size()\ >\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}}\ )\ \textcolor{keywordflow}{return}\ str.substr(\ 0,\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}}\ );}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00088}00088\ \ \ \ \ \ \ \textcolor{keywordtype}{string}\ tmp\ =\ str;}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00089}00089\ \ \ \ \ \ \ tmp.append(\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}}\ -\/\ str.size(),\ \textcolor{charliteral}{'\ '}\ );}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00090}00090\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ tmp;}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00091}00091\ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00092}00092\ }
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00093}\mbox{\hyperlink{classfc_1_1console__appender_a0c8bd1b4b2058a5760e926065ac37437}{00093}}\ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classfc_1_1console__appender_a0c8bd1b4b2058a5760e926065ac37437}{console\_appender::log}}(\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classfc_1_1log__message}{log\_message}}\&\ m\ )\ \{}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00094}00094\ \ \ \ \ \ \ \textcolor{comment}{//fc::string\ message\ =\ fc::format\_string(\ m.get\_format(),\ m.get\_data()\ );}}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00095}00095\ \ \ \ \ \ \ \textcolor{comment}{//fc::variant\ lmsg(m);}}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00096}00096\ }
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00097}00097\ \ \ \ \ \ \ FILE*\ out\ =\ my-\/>cfg.stream\ ==\ \mbox{\hyperlink{structfc_1_1console__appender_1_1stream_aaf2f066b1d3019c7858383edc440cbf8a5f2c746830a2d1349805a92dc7cb656d}{stream::std\_error}}\ ?\ stderr\ :\ stdout;}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00098}00098\ }
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00099}00099\ \ \ \ \ \ \ \textcolor{comment}{//fc::string\ fmt\_str\ =\ fc::format\_string(\ cfg.format,\ mutable\_variant\_object(m.get\_context())(\ "{}message"{},\ message)\ \ );}}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00100}00100\ }
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00101}00101\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classfc_1_1log__context}{log\_context}}\ \mbox{\hyperlink{structcontext}{context}}\ =\ m.\mbox{\hyperlink{classfc_1_1log__message_a6566f216627b8eb68472c8924dc6434f}{get\_context}}();}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00102}00102\ \ \ \ \ \ \ std::string\ file\_line\ =\ \mbox{\hyperlink{structcontext}{context}}.get\_file().substr(\ 0,\ 22\ );}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00103}00103\ \ \ \ \ \ \ file\_line\ +=\ \textcolor{charliteral}{':'};}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00104}00104\ \ \ \ \ \ \ file\_line\ +=\ \mbox{\hyperlink{namespacefc_acc781e4860d923d50e0acd2b7dae30a4}{fixed\_size}}(\ \ 6,\ \mbox{\hyperlink{namespacefc_a4e07b3870aa72f8c38bdd5f78044dad1}{fc::to\_string}}(\ \mbox{\hyperlink{structcontext}{context}}.get\_line\_number()\ )\ );}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00105}00105\ }
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00106}00106\ \ \ \ \ \ \ std::string\ line;}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00107}00107\ \ \ \ \ \ \ line.reserve(\ 256\ );}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00108}00108\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(my-\/>use\_syslog\_header)\ \{}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00109}00109\ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{switch}(m.\mbox{\hyperlink{classfc_1_1log__message_a6566f216627b8eb68472c8924dc6434f}{get\_context}}().\mbox{\hyperlink{classfc_1_1log__context_a1033bff5ffa2ebdfa70ae0f9d63a7666}{get\_log\_level}}())\ \{}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00110}00110\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{classfc_1_1log__level_a5a5e31c4c1f38d9115ecbe44927fb2e4a836fc8bbd6f9c9445879679eb512df49}{log\_level::error}}:}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00111}00111\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ line\ +=\ \textcolor{stringliteral}{"{}<3>"{}};}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00112}00112\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00113}00113\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{classfc_1_1log__level_a5a5e31c4c1f38d9115ecbe44927fb2e4a890c8f6993efee47d617cf72e6b19583}{log\_level::warn}}:}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00114}00114\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ line\ +=\ \textcolor{stringliteral}{"{}<4>"{}};}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00115}00115\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00116}00116\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{classfc_1_1log__level_a5a5e31c4c1f38d9115ecbe44927fb2e4afe6da1f3a75c3911b0b59bffaea070e1}{log\_level::info}}:}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00117}00117\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ line\ +=\ \textcolor{stringliteral}{"{}<6>"{}};}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00118}00118\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00119}00119\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{classfc_1_1log__level_a5a5e31c4c1f38d9115ecbe44927fb2e4a30d2de77e71beb8d09d530cac04efa25}{log\_level::debug}}:}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00120}00120\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ line\ +=\ \textcolor{stringliteral}{"{}<7>"{}};}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00121}00121\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00122}00122\ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00123}00123\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00124}00124\ \ \ \ \ \ \ line\ +=\ \mbox{\hyperlink{namespacefc_acc781e4860d923d50e0acd2b7dae30a4}{fixed\_size}}(\ \ 5,\ \mbox{\hyperlink{structcontext}{context}}.get\_log\_level().to\_string()\ );\ line\ +=\ \textcolor{charliteral}{'\ '};}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00125}00125\ \ \ \ \ \ \ \textcolor{comment}{//\ use\ now()\ instead\ of\ context.get\_timestamp()\ because\ log\_message\ construction\ can\ include\ user\ provided\ long\ running\ calls}}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00126}00126\ \ \ \ \ \ \ line\ +=\ \mbox{\hyperlink{namespacefc_a0f3d84fe9e7adcd2d1e0bb7b60b49aa0}{string}}(\ \mbox{\hyperlink{classfc_1_1time__point_aa164ff1268a16d4b32afcff181f6100e}{time\_point::now}}()\ );\ line\ +=\ \textcolor{charliteral}{'\ '};}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00127}00127\ \ \ \ \ \ \ line\ +=\ \mbox{\hyperlink{namespacefc_acc781e4860d923d50e0acd2b7dae30a4}{fixed\_size}}(\ \ 9,\ \mbox{\hyperlink{structcontext}{context}}.get\_thread\_name()\ );\ line\ +=\ \textcolor{charliteral}{'\ '};}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00128}00128\ \ \ \ \ \ \ line\ +=\ \mbox{\hyperlink{namespacefc_acc781e4860d923d50e0acd2b7dae30a4}{fixed\_size}}(\ 29,\ file\_line\ );\ line\ +=\ \textcolor{charliteral}{'\ '};}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00129}00129\ }
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00130}00130\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ me\ =\ \mbox{\hyperlink{structcontext}{context}}.get\_method();}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00131}00131\ \ \ \ \ \ \ \textcolor{comment}{//\ strip\ all\ leading\ scopes...}}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00132}00132\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ me.size()\ )\ \{}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00133}00133\ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t}}\ \mbox{\hyperlink{bn_8cpp_a8b0eadcc506862e9d751ab45185053aa}{p}}\ =\ 0;}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00134}00134\ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\ \mbox{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t}}\ i\ =\ 0;i\ <\ me.size();\ ++i\ )\ \{}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00135}00135\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ me[i]\ ==\ \textcolor{charliteral}{':'}\ )\ \mbox{\hyperlink{bn_8cpp_a8b0eadcc506862e9d751ab45185053aa}{p}}\ =\ i;}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00136}00136\ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00137}00137\ }
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00138}00138\ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ me[\mbox{\hyperlink{bn_8cpp_a8b0eadcc506862e9d751ab45185053aa}{p}}]\ ==\ \textcolor{charliteral}{':'}\ )\ ++\mbox{\hyperlink{bn_8cpp_a8b0eadcc506862e9d751ab45185053aa}{p}};}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00139}00139\ \ \ \ \ \ \ \ \ \ line\ +=\ \mbox{\hyperlink{namespacefc_acc781e4860d923d50e0acd2b7dae30a4}{fixed\_size}}(\ 20,\ \mbox{\hyperlink{structcontext}{context}}.get\_method().substr(\ \mbox{\hyperlink{bn_8cpp_a8b0eadcc506862e9d751ab45185053aa}{p}},\ 20\ )\ );\ line\ +=\ \textcolor{charliteral}{'\ '};}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00140}00140\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00141}00141\ \ \ \ \ \ \ line\ +=\ \textcolor{stringliteral}{"{}]\ "{}};}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00142}00142\ \ \ \ \ \ \ line\ +=\ \mbox{\hyperlink{namespacefc_acd5129981ae93fce3154d3fed6f6acbc}{fc::format\_string}}(\ m.\mbox{\hyperlink{classfc_1_1log__message_ad966a7abc653c4e9a253d8352acf8c40}{get\_format}}(),\ m.\mbox{\hyperlink{classfc_1_1log__message_af68127555870f9aa5d06f7c2db9f1d32}{get\_data}}()\ );}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00143}00143\ }
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00144}00144\ \ \ \ \ \ \ \mbox{\hyperlink{classfc_1_1console__appender_a819864eb29982c6c82397e91a8a4ada4}{print}}(\ line,\ my-\/>lc[\mbox{\hyperlink{structcontext}{context}}.get\_log\_level()]\ );}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00145}00145\ }
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00146}00146\ \ \ \ \ \ \ fprintf(\ out,\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}}\ );}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00147}00147\ }
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00148}00148\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ my-\/>cfg.flush\ )\ fflush(\ out\ );}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00149}00149\ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00150}00150\ }
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00151}\mbox{\hyperlink{classfc_1_1console__appender_a819864eb29982c6c82397e91a8a4ada4}{00151}}\ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classfc_1_1console__appender_a819864eb29982c6c82397e91a8a4ada4}{console\_appender::print}}(\ \textcolor{keyword}{const}\ std::string\&\ text,\ \mbox{\hyperlink{structfc_1_1console__appender_1_1color_ae3f964a317f52c91550bd98bb4e4402d}{color::type}}\ text\_color\ )}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00152}00152\ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00153}00153\ \ \ \ \ \ \ FILE*\ out\ =\ my-\/>cfg.stream\ ==\ \mbox{\hyperlink{structfc_1_1console__appender_1_1stream_aaf2f066b1d3019c7858383edc440cbf8a5f2c746830a2d1349805a92dc7cb656d}{stream::std\_error}}\ ?\ stderr\ :\ stdout;}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00154}00154\ }
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00155}00155\ \textcolor{preprocessor}{\ \ \ \ \ \ \#ifdef\ WIN32}}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00156}00156\ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (my-\/>console\_handle\ !=\ INVALID\_HANDLE\_VALUE)}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00157}00157\ \ \ \ \ \ \ \ \ \ \ \ SetConsoleTextAttribute(my-\/>console\_handle,\ get\_console\_color(text\_color));}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00158}00158\ \textcolor{preprocessor}{\ \ \ \ \ \ \#else}}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00159}00159\ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(isatty(fileno(out)))\ fprintf(\ out,\ \textcolor{stringliteral}{"{}\%s"{}},\ get\_console\_color(\ text\_color\ )\ );}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00160}00160\ \textcolor{preprocessor}{\ \ \ \ \ \ \#endif}}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00161}00161\ }
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00162}00162\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ text.size()\ )}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00163}00163\ \ \ \ \ \ \ \ \ \ fprintf(\ out,\ \textcolor{stringliteral}{"{}\%s"{}},\ text.c\_str()\ );\ \textcolor{comment}{//fmt\_str.c\_str()\ );}}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00164}00164\ }
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00165}00165\ \textcolor{preprocessor}{\ \ \ \ \ \ \#ifdef\ WIN32}}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00166}00166\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (my-\/>console\_handle\ !=\ INVALID\_HANDLE\_VALUE)}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00167}00167\ \ \ \ \ \ \ \ \ SetConsoleTextAttribute(my-\/>console\_handle,\ CONSOLE\_DEFAULT);}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00168}00168\ \textcolor{preprocessor}{\ \ \ \ \ \ \#else}}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00169}00169\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(isatty(fileno(out)))\ fprintf(\ out,\ \textcolor{stringliteral}{"{}\%s"{}},\ CONSOLE\_DEFAULT\ );}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00170}00170\ \textcolor{preprocessor}{\ \ \ \ \ \ \#endif}}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00171}00171\ }
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00172}00172\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ my-\/>cfg.flush\ )\ fflush(\ out\ );}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00173}00173\ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00174}00174\ }
\DoxyCodeLine{\Hypertarget{console__appender_8cpp_source_l00175}00175\ \}}

\end{DoxyCode}
