\doxysection{lax\+\_\+der\+\_\+privatekey\+\_\+parsing.\+c}
\hypertarget{lax__der__privatekey__parsing_8c_source}{}\label{lax__der__privatekey__parsing_8c_source}\index{libraries/fc/secp256k1/secp256k1/contrib/lax\_der\_privatekey\_parsing.c@{libraries/fc/secp256k1/secp256k1/contrib/lax\_der\_privatekey\_parsing.c}}
\mbox{\hyperlink{lax__der__privatekey__parsing_8c}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00001}00001\ \textcolor{comment}{/***********************************************************************}}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00002}00002\ \textcolor{comment}{\ *\ Copyright\ (c)\ 2014,\ 2015\ Pieter\ Wuille\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *}}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00003}00003\ \textcolor{comment}{\ *\ Distributed\ under\ the\ MIT\ software\ license,\ see\ the\ accompanying\ \ \ \ *}}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00004}00004\ \textcolor{comment}{\ *\ file\ COPYING\ or\ https://www.opensource.org/licenses/mit-\/license.php.*}}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00005}00005\ \textcolor{comment}{\ ***********************************************************************/}}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00006}00006\ }
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00007}00007\ \textcolor{preprocessor}{\#include\ <string.h>}}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00008}00008\ }
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00009}00009\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{lax__der__privatekey__parsing_8h}{lax\_der\_privatekey\_parsing.h}}"{}}}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00010}00010\ }
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00011}\mbox{\hyperlink{lax__der__privatekey__parsing_8c_ab807c294559193bc65b53f14ca677db6}{00011}}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{lax__der__privatekey__parsing_8c_ab807c294559193bc65b53f14ca677db6}{ec\_privkey\_import\_der}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structsecp256k1__context__struct}{secp256k1\_context}}*\ ctx,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *out32,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *privkey,\ \textcolor{keywordtype}{size\_t}\ privkeylen)\ \{}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00012}00012\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *end\ =\ privkey\ +\ privkeylen;}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00013}00013\ \ \ \ \ \textcolor{keywordtype}{int}\ lenb\ =\ 0;}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00014}00014\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a7360b55975153b822efc5217b7734e6a}{len}}\ =\ 0;}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00015}00015\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_adc4bd59a60361844aa0e852efa210105}{memset}}(out32,\ 0,\ 32);}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00016}00016\ \ \ \ \ \textcolor{comment}{/*\ sequence\ header\ */}}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00017}00017\ \ \ \ \ \textcolor{keywordflow}{if}\ (end\ <\ privkey+1\ ||\ *privkey\ !=\ 0x30)\ \{}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00018}00018\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00019}00019\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00020}00020\ \ \ \ \ privkey++;}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00021}00021\ \ \ \ \ \textcolor{comment}{/*\ sequence\ length\ constructor\ */}}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00022}00022\ \ \ \ \ \textcolor{keywordflow}{if}\ (end\ <\ privkey+1\ ||\ !(*privkey\ \&\ 0x80))\ \{}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00023}00023\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00024}00024\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00025}00025\ \ \ \ \ lenb\ =\ *privkey\ \&\ \string~0x80;\ privkey++;}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00026}00026\ \ \ \ \ \textcolor{keywordflow}{if}\ (lenb\ <\ 1\ ||\ lenb\ >\ 2)\ \{}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00027}00027\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00028}00028\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00029}00029\ \ \ \ \ \textcolor{keywordflow}{if}\ (end\ <\ privkey+lenb)\ \{}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00030}00030\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00031}00031\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00032}00032\ \ \ \ \ \textcolor{comment}{/*\ sequence\ length\ */}}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00033}00033\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a7360b55975153b822efc5217b7734e6a}{len}}\ =\ privkey[lenb-\/1]\ |\ (lenb\ >\ 1\ ?\ privkey[lenb-\/2]\ <<\ 8\ :\ 0);}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00034}00034\ \ \ \ \ privkey\ +=\ lenb;}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00035}00035\ \ \ \ \ \textcolor{keywordflow}{if}\ (end\ <\ privkey+\mbox{\hyperlink{yubihsm__pkcs11_8c_a7360b55975153b822efc5217b7734e6a}{len}})\ \{}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00036}00036\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00037}00037\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00038}00038\ \ \ \ \ \textcolor{comment}{/*\ sequence\ element\ 0:\ version\ number\ (=1)\ */}}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00039}00039\ \ \ \ \ \textcolor{keywordflow}{if}\ (end\ <\ privkey+3\ ||\ privkey[0]\ !=\ 0x02\ ||\ privkey[1]\ !=\ 0x01\ ||\ privkey[2]\ !=\ 0x01)\ \{}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00040}00040\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00041}00041\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00042}00042\ \ \ \ \ privkey\ +=\ 3;}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00043}00043\ \ \ \ \ \textcolor{comment}{/*\ sequence\ element\ 1:\ octet\ string,\ up\ to\ 32\ bytes\ */}}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00044}00044\ \ \ \ \ \textcolor{keywordflow}{if}\ (end\ <\ privkey+2\ ||\ privkey[0]\ !=\ 0x04\ ||\ privkey[1]\ >\ 0x20\ ||\ end\ <\ privkey+2+privkey[1])\ \{}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00045}00045\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00046}00046\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00047}00047\ \ \ \ \ \textcolor{keywordflow}{if}\ (privkey[1])\ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(out32\ +\ 32\ -\/\ privkey[1],\ privkey\ +\ 2,\ privkey[1]);}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00048}00048\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{secp256k1_8h_a366f922fc0c787351e82ff8e3a95f652}{secp256k1\_ec\_seckey\_verify}}(ctx,\ out32))\ \{}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00049}00049\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_adc4bd59a60361844aa0e852efa210105}{memset}}(out32,\ 0,\ 32);}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00050}00050\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00051}00051\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00052}00052\ \ \ \ \ \textcolor{keywordflow}{return}\ 1;}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00053}00053\ \}}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00054}00054\ }
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00055}\mbox{\hyperlink{lax__der__privatekey__parsing_8c_a9ff2773bdc052e3af4def4afb183c95c}{00055}}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{lax__der__privatekey__parsing_8c_a9ff2773bdc052e3af4def4afb183c95c}{ec\_privkey\_export\_der}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structsecp256k1__context__struct}{secp256k1\_context}}\ *ctx,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *privkey,\ \textcolor{keywordtype}{size\_t}\ *privkeylen,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *key32,\ \textcolor{keywordtype}{int}\ compressed)\ \{}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00056}00056\ \ \ \ \ \mbox{\hyperlink{structsecp256k1__pubkey}{secp256k1\_pubkey}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a931987c85fd408a620505ee9a1aa6f58}{pubkey}};}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00057}00057\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ pubkeylen\ =\ 0;}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00058}00058\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{secp256k1_8h_a7438071aa8a6dc4697abe4f4659f2161}{secp256k1\_ec\_pubkey\_create}}(ctx,\ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a931987c85fd408a620505ee9a1aa6f58}{pubkey}},\ key32))\ \{}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00059}00059\ \ \ \ \ \ \ \ \ *privkeylen\ =\ 0;}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00060}00060\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00061}00061\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00062}00062\ \ \ \ \ \textcolor{keywordflow}{if}\ (compressed)\ \{}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00063}00063\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ begin[]\ =\ \{}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00064}00064\ \ \ \ \ \ \ \ \ \ \ \ \ 0x30,0x81,0xD3,0x02,0x01,0x01,0x04,0x20}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00065}00065\ \ \ \ \ \ \ \ \ \};}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00066}00066\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ middle[]\ =\ \{}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00067}00067\ \ \ \ \ \ \ \ \ \ \ \ \ 0xA0,0x81,0x85,0x30,0x81,0x82,0x02,0x01,0x01,0x30,0x2C,0x06,0x07,0x2A,0x86,0x48,}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00068}00068\ \ \ \ \ \ \ \ \ \ \ \ \ 0xCE,0x3D,0x01,0x01,0x02,0x21,0x00,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00069}00069\ \ \ \ \ \ \ \ \ \ \ \ \ 0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00070}00070\ \ \ \ \ \ \ \ \ \ \ \ \ 0xFF,0xFF,0xFE,0xFF,0xFF,0xFC,0x2F,0x30,0x06,0x04,0x01,0x00,0x04,0x01,0x07,0x04,}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00071}00071\ \ \ \ \ \ \ \ \ \ \ \ \ 0x21,0x02,0x79,0xBE,0x66,0x7E,0xF9,0xDC,0xBB,0xAC,0x55,0xA0,0x62,0x95,0xCE,0x87,}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00072}00072\ \ \ \ \ \ \ \ \ \ \ \ \ 0x0B,0x07,0x02,0x9B,0xFC,0xDB,0x2D,0xCE,0x28,0xD9,0x59,0xF2,0x81,0x5B,0x16,0xF8,}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00073}00073\ \ \ \ \ \ \ \ \ \ \ \ \ 0x17,0x98,0x02,0x21,0x00,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00074}00074\ \ \ \ \ \ \ \ \ \ \ \ \ 0xFF,0xFF,0xFF,0xFF,0xFE,0xBA,0xAE,0xDC,0xE6,0xAF,0x48,0xA0,0x3B,0xBF,0xD2,0x5E,}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00075}00075\ \ \ \ \ \ \ \ \ \ \ \ \ 0x8C,0xD0,0x36,0x41,0x41,0x02,0x01,0x01,0xA1,0x24,0x03,0x22,0x00}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00076}00076\ \ \ \ \ \ \ \ \ \};}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00077}00077\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *ptr\ =\ privkey;}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00078}00078\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(ptr,\ begin,\ \textcolor{keyword}{sizeof}(begin));\ ptr\ +=\ \textcolor{keyword}{sizeof}(begin);}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00079}00079\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(ptr,\ key32,\ 32);\ ptr\ +=\ 32;}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00080}00080\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(ptr,\ middle,\ \textcolor{keyword}{sizeof}(middle));\ ptr\ +=\ \textcolor{keyword}{sizeof}(middle);}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00081}00081\ \ \ \ \ \ \ \ \ pubkeylen\ =\ 33;}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00082}00082\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{secp256k1_8h_a34977bf00322e510e881160c421836d7}{secp256k1\_ec\_pubkey\_serialize}}(ctx,\ ptr,\ \&pubkeylen,\ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a931987c85fd408a620505ee9a1aa6f58}{pubkey}},\ \mbox{\hyperlink{secp256k1_8h_a7b8f642c65e8b5c81fa4421b7c42ab57}{SECP256K1\_EC\_COMPRESSED}});}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00083}00083\ \ \ \ \ \ \ \ \ ptr\ +=\ pubkeylen;}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00084}00084\ \ \ \ \ \ \ \ \ *privkeylen\ =\ ptr\ -\/\ privkey;}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00085}00085\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00086}00086\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ begin[]\ =\ \{}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00087}00087\ \ \ \ \ \ \ \ \ \ \ \ \ 0x30,0x82,0x01,0x13,0x02,0x01,0x01,0x04,0x20}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00088}00088\ \ \ \ \ \ \ \ \ \};}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00089}00089\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ middle[]\ =\ \{}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00090}00090\ \ \ \ \ \ \ \ \ \ \ \ \ 0xA0,0x81,0xA5,0x30,0x81,0xA2,0x02,0x01,0x01,0x30,0x2C,0x06,0x07,0x2A,0x86,0x48,}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00091}00091\ \ \ \ \ \ \ \ \ \ \ \ \ 0xCE,0x3D,0x01,0x01,0x02,0x21,0x00,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00092}00092\ \ \ \ \ \ \ \ \ \ \ \ \ 0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00093}00093\ \ \ \ \ \ \ \ \ \ \ \ \ 0xFF,0xFF,0xFE,0xFF,0xFF,0xFC,0x2F,0x30,0x06,0x04,0x01,0x00,0x04,0x01,0x07,0x04,}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00094}00094\ \ \ \ \ \ \ \ \ \ \ \ \ 0x41,0x04,0x79,0xBE,0x66,0x7E,0xF9,0xDC,0xBB,0xAC,0x55,0xA0,0x62,0x95,0xCE,0x87,}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00095}00095\ \ \ \ \ \ \ \ \ \ \ \ \ 0x0B,0x07,0x02,0x9B,0xFC,0xDB,0x2D,0xCE,0x28,0xD9,0x59,0xF2,0x81,0x5B,0x16,0xF8,}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00096}00096\ \ \ \ \ \ \ \ \ \ \ \ \ 0x17,0x98,0x48,0x3A,0xDA,0x77,0x26,0xA3,0xC4,0x65,0x5D,0xA4,0xFB,0xFC,0x0E,0x11,}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00097}00097\ \ \ \ \ \ \ \ \ \ \ \ \ 0x08,0xA8,0xFD,0x17,0xB4,0x48,0xA6,0x85,0x54,0x19,0x9C,0x47,0xD0,0x8F,0xFB,0x10,}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00098}00098\ \ \ \ \ \ \ \ \ \ \ \ \ 0xD4,0xB8,0x02,0x21,0x00,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00099}00099\ \ \ \ \ \ \ \ \ \ \ \ \ 0xFF,0xFF,0xFF,0xFF,0xFE,0xBA,0xAE,0xDC,0xE6,0xAF,0x48,0xA0,0x3B,0xBF,0xD2,0x5E,}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00100}00100\ \ \ \ \ \ \ \ \ \ \ \ \ 0x8C,0xD0,0x36,0x41,0x41,0x02,0x01,0x01,0xA1,0x44,0x03,0x42,0x00}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00101}00101\ \ \ \ \ \ \ \ \ \};}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00102}00102\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *ptr\ =\ privkey;}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00103}00103\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(ptr,\ begin,\ \textcolor{keyword}{sizeof}(begin));\ ptr\ +=\ \textcolor{keyword}{sizeof}(begin);}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00104}00104\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(ptr,\ key32,\ 32);\ ptr\ +=\ 32;}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00105}00105\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(ptr,\ middle,\ \textcolor{keyword}{sizeof}(middle));\ ptr\ +=\ \textcolor{keyword}{sizeof}(middle);}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00106}00106\ \ \ \ \ \ \ \ \ pubkeylen\ =\ 65;}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00107}00107\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{secp256k1_8h_a34977bf00322e510e881160c421836d7}{secp256k1\_ec\_pubkey\_serialize}}(ctx,\ ptr,\ \&pubkeylen,\ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a931987c85fd408a620505ee9a1aa6f58}{pubkey}},\ \mbox{\hyperlink{secp256k1_8h_ab8e25dc58843e83926f95795f9e8a6e2}{SECP256K1\_EC\_UNCOMPRESSED}});}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00108}00108\ \ \ \ \ \ \ \ \ ptr\ +=\ pubkeylen;}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00109}00109\ \ \ \ \ \ \ \ \ *privkeylen\ =\ ptr\ -\/\ privkey;}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00110}00110\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00111}00111\ \ \ \ \ \textcolor{keywordflow}{return}\ 1;}
\DoxyCodeLine{\Hypertarget{lax__der__privatekey__parsing_8c_source_l00112}00112\ \}}

\end{DoxyCode}
