\chapter{Xbyak 5.63 ; JIT assembler for x86(IA32), x64(AMD64, x86-\/64) by C++}
\hypertarget{md_libraries_2fc_2libraries_2ff_2depends_2xbyak_2readme}{}\label{md_libraries_2fc_2libraries_2ff_2depends_2xbyak_2readme}\index{Xbyak 5.63 ; JIT assembler for x86(IA32), x64(AMD64, x86-\/64) by C++@{Xbyak 5.63 ; JIT assembler for x86(IA32), x64(AMD64, x86-\/64) by C++}}
\doxysection*{Abstract }

This is a header file which enables dynamically to assemble x86(\+IA32), x64(AMD64, x86-\/64) mnemonic.

\doxysection*{Feature }

header file only you can use \doxylink{namespace_xbyak}{Xbyak}\textquotesingle{}s functions at once if \doxylink{xbyak_8h}{xbyak.\+h} is included.

\doxysubsection*{Supported Instructions Sets}

MMX/\+MMX2/\+SSE/\+SSE2/\+SSE3/\+SSSE3/\+SSE4/\+FPU({\itshape partial})/\+AVX/\+AVX2/\+FMA/\+VEX-\/encoded GPR/\+AVX-\/512

\doxysubsection*{Supported OS}


\begin{DoxyItemize}
\item Windows Xp, Vista, Windows 7(32bit, 64bit)
\item Linux(32bit, 64bit)
\item Intel Mac OSX
\end{DoxyItemize}

\doxysubsection*{Supported Compilers}


\begin{DoxyItemize}
\item Visual Studio C++ VC2012 or later
\item gcc 4.\+7 or later
\item clang 3.\+3
\item cygwin gcc 4.\+5.\+3
\item icc 7.\+2
\end{DoxyItemize}

\texorpdfstring{$>$}{>}Note\+: \doxylink{namespace_xbyak}{Xbyak} uses \doxylink{xbyak__mnemonic_8h_a8bfc9d22e0846b48228832bc081c5ccb}{and()}, \doxylink{xbyak__mnemonic_8h_ac1c6311186b3918c9070ad8d6602ad2e}{or()}, \doxylink{xbyak__mnemonic_8h_a0f498ee9a8673680cf2b6673847436b8}{xor()}, \doxylink{xbyak__mnemonic_8h_acaa92038ead3557cfbf3e0f8e5a26077}{not()} functions, so "{}-\/fno-\/operator-\/names"{} option is required on gcc. Or define XBYAK\+\_\+\+NO\+\_\+\+OP\+\_\+\+NAMES and use \doxylink{xbyak__mnemonic_8h_a852f5fbe31e6343e0b72a0c3ae0e02a2}{and\+\_\+()}, \doxylink{xbyak__mnemonic_8h_ae2671a6e11c7fbb9d0046ea8c91495f5}{or\+\_\+()}, \doxylink{xbyak__mnemonic_8h_a0efb05fdbef7e40003a0dd643d23c322}{xor\+\_\+()}, \doxylink{xbyak__mnemonic_8h_a53023f0714e3986f0cc22815a1b1e7d9}{not\+\_\+()} instead of them. \doxylink{xbyak__mnemonic_8h_a852f5fbe31e6343e0b72a0c3ae0e02a2}{and\+\_\+()}, \doxylink{xbyak__mnemonic_8h_ae2671a6e11c7fbb9d0046ea8c91495f5}{or\+\_\+()}, \doxylink{xbyak__mnemonic_8h_a0efb05fdbef7e40003a0dd643d23c322}{xor\+\_\+()}, \doxylink{xbyak__mnemonic_8h_a53023f0714e3986f0cc22815a1b1e7d9}{not\+\_\+()} are always available.

\doxysection*{Install }

The following files are necessary. Please add the path to your compile directories.


\begin{DoxyItemize}
\item \doxylink{xbyak_8h}{xbyak.\+h}
\item \doxylink{xbyak__mnemonic_8h}{xbyak\+\_\+mnemonic.\+h}
\end{DoxyItemize}

Linux\+: \begin{DoxyVerb}make install
\end{DoxyVerb}


These files are copied into /usr/local/include/xbyak

\doxysection*{New Feature }

Add support for AVX-\/512 instruction set.

\doxysection*{Syntax }

Make \doxylink{class_xbyak_1_1_code_generator}{Xbyak\+::\+Code\+Generator} and make the class method and get the function pointer by calling cget\+Code() and casting the return value. \begin{DoxyVerb}NASM              Xbyak
mov eax, ebx  --> mov(eax, ebx);
inc ecx           inc(ecx);
ret           --> ret();
\end{DoxyVerb}


\doxysubsection*{Addressing}

\begin{DoxyVerb}(ptr|dword|word|byte) [base + index * (1|2|4|8) + displacement]
                      [rip + 32bit disp] ; x64 only

NASM                   Xbyak
mov eax, [ebx+ecx] --> mov (eax, ptr[ebx+ecx]);
test byte [esp], 4 --> test (byte [esp], 4);
\end{DoxyVerb}


How to use Selector(\+Segment Register)

\texorpdfstring{$>$}{>}Note\+: Segment class is not derived from Operand.


\begin{DoxyCode}{0}
\DoxyCodeLine{mov\ eax,\ [fs:eax]\ -\/-\/>\ putSeg(fs);\ mov(eax,\ ptr\ [eax]);}
\DoxyCodeLine{mov\ ax,\ cs\ \ \ \ \ \ \ \ -\/-\/>\ mov(ax,\ cs);}

\end{DoxyCode}


\texorpdfstring{$>$}{>}you can use ptr for almost memory access unless you specify the size of memory.

\texorpdfstring{$>$}{>}dword, word and byte are member variables, then don\textquotesingle{}t use dword as unsigned int, for example.

\doxysubsection*{AVX}

\begin{DoxyVerb}vaddps(xmm1, xmm2, xmm3); // xmm1 <- xmm2 + xmm3
vaddps(xmm2, xmm3, ptr [rax]); // use ptr to access memory
vgatherdpd(xmm1, ptr [ebp+123+xmm2*4], xmm3);
\end{DoxyVerb}


{\itshape Remark} The omitted destination syntax as the following ss disabled. 
\begin{DoxyCode}{0}
\DoxyCodeLine{vaddps(xmm2,\ xmm3);\ //\ xmm2\ <-\/\ xmm2\ +\ xmm3}

\end{DoxyCode}
 define {\ttfamily XBYAK\+\_\+\+ENABLE\+\_\+\+OMITTED\+\_\+\+OPERAND} if you use it for backward compatibility. But the newer version will not support it.

\doxysubsection*{AVX-\/512}


\begin{DoxyCode}{0}
\DoxyCodeLine{vaddpd\ zmm2,\ zmm5,\ zmm30\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ -\/-\/>\ vaddpd(zmm2,\ zmm5,\ zmm30);}
\DoxyCodeLine{vaddpd\ xmm30,\ xmm20,\ [rax]\ \ \ \ \ \ \ \ \ \ \ \ \ \ -\/-\/>\ vaddpd(xmm30,\ xmm20,\ ptr\ [rax]);}
\DoxyCodeLine{vaddps\ xmm30,\ xmm20,\ [rax]\ \ \ \ \ \ \ \ \ \ \ \ \ \ -\/-\/>\ vaddps(xmm30,\ xmm20,\ ptr\ [rax]);}
\DoxyCodeLine{vaddpd\ zmm2\{k5\},\ zmm4,\ zmm2\ \ \ \ \ \ \ \ \ \ \ \ \ -\/-\/>\ vaddpd(zmm2\ |\ k5,\ zmm4,\ zmm2);}
\DoxyCodeLine{vaddpd\ zmm2\{k5\}\{z\},\ zmm4,\ zmm2\ \ \ \ \ \ \ \ \ \ -\/-\/>\ vaddpd(zmm2\ |\ k5\ |\ T\_z,\ zmm4,\ zmm2);}
\DoxyCodeLine{vaddpd\ zmm2\{k5\}\{z\},\ zmm4,\ zmm2,\{rd-\/sae\}\ -\/-\/>\ vaddpd(zmm2\ |\ k5\ |\ T\_z,\ zmm4,\ zmm2\ |\ T\_rd\_sae);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ vaddpd(zmm2\ |\ k5\ |\ T\_z\ |\ T\_rd\_sae,\ zmm4,\ zmm2);\ //\ the\ position\ of\ \`{}|`\ is\ arbitrary.}
\DoxyCodeLine{vcmppd\ k4\{k3\},\ zmm1,\ zmm2,\ \{sae\},\ 5\ \ \ \ \ -\/-\/>\ vcmppd(k4\ |\ k3,\ zmm1,\ zmm2\ |\ T\_sae,\ 5);}
\DoxyCodeLine{}
\DoxyCodeLine{vaddpd\ xmm1,\ xmm2,\ [rax+256]\ \ \ \ \ \ \ \ \ \ \ \ -\/-\/>\ vaddpd(xmm1,\ xmm2,\ ptr\ [rax+256]);}
\DoxyCodeLine{vaddpd\ xmm1,\ xmm2,\ [rax+256]\{1to2\}\ \ \ \ \ \ -\/-\/>\ vaddpd(xmm1,\ xmm2,\ ptr\_b\ [rax+256]);}
\DoxyCodeLine{vaddpd\ ymm1,\ ymm2,\ [rax+256]\{1to4\}\ \ \ \ \ \ -\/-\/>\ vaddpd(ymm1,\ ymm2,\ ptr\_b\ [rax+256]);}
\DoxyCodeLine{vaddpd\ zmm1,\ zmm2,\ [rax+256]\{1to8\}\ \ \ \ \ \ -\/-\/>\ vaddpd(zmm1,\ zmm2,\ ptr\_b\ [rax+256]);}
\DoxyCodeLine{vaddps\ zmm1,\ zmm2,\ [rax+rcx*8+8]\{1to16\}\ -\/-\/>\ vaddps(zmm1,\ zmm2,\ ptr\_b\ [rax+rcx*8+8]);}
\DoxyCodeLine{vmovsd\ [rax]\{k1\},\ xmm4\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ -\/-\/>\ vmovsd(ptr\ [rax]\ |\ k1,\ xmm4);}
\DoxyCodeLine{}
\DoxyCodeLine{vcvtpd2dq\ xmm16,\ oword\ [eax+33]\ \ \ \ \ \ \ \ \ -\/-\/>\ vcvtpd2dq(xmm16,\ xword\ [eax+33]);\ //\ use\ xword\ for\ m128\ instead\ of\ oword}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ vcvtpd2dq(xmm16,\ ptr\ [eax+33]);\ //\ default\ xword}
\DoxyCodeLine{vcvtpd2dq\ xmm21,\ [eax+32]\{1to2\}\ \ \ \ \ \ \ \ \ -\/-\/>\ vcvtpd2dq(xmm21,\ ptr\_b\ [eax+32]);}
\DoxyCodeLine{vcvtpd2dq\ xmm0,\ yword\ [eax+33]\ \ \ \ \ \ \ \ \ \ -\/-\/>\ vcvtpd2dq(xmm0,\ yword\ [eax+33]);\ //\ use\ yword\ for\ m256}
\DoxyCodeLine{vcvtpd2dq\ xmm19,\ [eax+32]\{1to4\}\ \ \ \ \ \ \ \ \ -\/-\/>\ vcvtpd2dq(xmm19,\ yword\_b\ [eax+32]);\ //\ use\ yword\_b\ to\ broadcast}
\DoxyCodeLine{}
\DoxyCodeLine{vfpclassps\ k5\{k3\},\ zword\ [rax+64],\ 5\ \ \ \ -\/-\/>\ vfpclassps(k5|k3,\ zword\ [rax+64],\ 5);\ //\ specify\ m512}
\DoxyCodeLine{vfpclasspd\ k5\{k3\},\ [rax+64]\{1to2\},\ 5\ \ \ \ -\/-\/>\ vfpclasspd(k5|k3,\ xword\_b\ [rax+64],\ 5);\ //\ broadcast\ 64-\/bit\ to\ 128-\/bit}
\DoxyCodeLine{vfpclassps\ k5\{k3\},\ [rax+64]\{1to4\},\ 5\ \ \ \ -\/-\/>\ vfpclassps(k5|k3,\ yword\_b\ [rax+64],\ 5);\ //\ broadcast\ 64-\/bit\ to\ 256-\/bit}

\end{DoxyCode}
 Remark
\begin{DoxyItemize}
\item k1, ..., k7 are new opmask registers.
\item use {\ttfamily \texorpdfstring{$\vert$}{|} T\+\_\+z}, {\ttfamily \texorpdfstring{$\vert$}{|} T\+\_\+sae}, {\ttfamily \texorpdfstring{$\vert$}{|} T\+\_\+rn\+\_\+sae}, {\ttfamily \texorpdfstring{$\vert$}{|} T\+\_\+rd\+\_\+sae}, {\ttfamily \texorpdfstring{$\vert$}{|} T\+\_\+ru\+\_\+sae}, {\ttfamily \texorpdfstring{$\vert$}{|} T\+\_\+rz\+\_\+sae} instead of {\ttfamily ,\{z\}}, {\ttfamily ,\{sae\}}, {\ttfamily ,\{rn-\/sae\}}, {\ttfamily ,\{rd-\/sae\}}, {\ttfamily ,\{ru-\/sae\}}, {\ttfamily ,\{rz-\/sae\}} respectively.
\item {\ttfamily k4 \texorpdfstring{$\vert$}{|} k3} is different from {\ttfamily k3 \texorpdfstring{$\vert$}{|} k4}.
\item use {\ttfamily ptr\+\_\+b} for broadcast {\ttfamily \{1toX\}}. X is automatically determined.
\item specify xword/yword/zword(\+\_\+b) for m128/m256/m512 if necessary.
\end{DoxyItemize}

\doxysubsection*{Label}

\begin{DoxyVerb}L("L1");
  jmp ("L1");

  jmp ("L2");
  ...
  a few mnemonics(8-bit displacement jmp)
  ...
L("L2");

  jmp ("L3", T_NEAR);
  ...
  a lot of mnemonics(32-bit displacement jmp)
  ...
L("L3");
\end{DoxyVerb}


\texorpdfstring{$>$}{>}\doxylink{struct_call}{Call} has\+Undefined\+Label() to verify your code has no undefined label. \begin{quote}
you can use a label for immediate value of mov like as mov (eax, "{}\+L2"{}); \end{quote}
\doxysubsubsection*{1. support @, @f, {\bfseries{like}} MASM}

\begin{DoxyVerb}L("@@"); // <A>
  jmp("@b"); // jmp to <A>
  jmp("@f"); // jmp to <B>
L("@@"); // <B>
  jmp("@b"); // jmp to <B>
  mov(eax, "@b");
  jmp(eax); // jmp to <B>
\end{DoxyVerb}


\doxysubsubsection*{2. localization of label by calling in\+Local\+Label(), out\+Locallabel().}

labels begining of period between in\+Local\+Label() and out\+Local\+Label() are dealed with local label. in\+Local\+Label() and out\+Local\+Label() can be nested. \begin{DoxyVerb}void func1()
{
    inLocalLabel();
  L(".lp"); // <A> ; local label
    ...
    jmp(".lp"); // jmpt to <A>
  L("aaa"); // global label
    outLocalLabel();
}

void func2()
{
    inLocalLabel();
  L(".lp"); // <B> ; local label
    func1();
    jmp(".lp"); // jmp to <B>
    inLocalLabel();
}
\end{DoxyVerb}


\doxysubsection*{Label class}

L() and jxx() functions support a new Label class. \begin{DoxyVerb}  Label label1, label2;
L(label1);
  ...
  jmp(label1);
  ...
  jmp(label2);
  ...
L(label2);
\end{DoxyVerb}


Moreover, assign\+L(dst\+Label, src\+Label) method binds dst\+Label with src\+Label. \begin{DoxyVerb}  Label label1, label2;
L(label1);
  ...
  jmp(label2);
  ...
  assignL(label2, label1); // label2 <= label1
\end{DoxyVerb}


The above jmp opecode jumps label1.


\begin{DoxyItemize}
\item Restriction\+:
\item src\+Label must be used in L().
\item dst\+Label must not be used in L().
\end{DoxyItemize}

Label\+::get\+Address() returns the address specified by the label instance and 0 if not specified. 
\begin{DoxyCode}{0}
\DoxyCodeLine{//\ not\ AutoGrow\ mode}
\DoxyCodeLine{Label\ \ label;}
\DoxyCodeLine{assert(label.getAddress()\ ==\ 0);}
\DoxyCodeLine{L(label);}
\DoxyCodeLine{assert(label.getAddress()\ ==\ getCurr());}

\end{DoxyCode}


\doxysubsection*{Rip}


\begin{DoxyCode}{0}
\DoxyCodeLine{Label\ label;}
\DoxyCodeLine{mov(eax,\ ptr\ [rip\ +\ label]);\ //\ eax\ =\ 4}
\DoxyCodeLine{...}
\DoxyCodeLine{}
\DoxyCodeLine{L(label);}
\DoxyCodeLine{dd(4);}

\end{DoxyCode}
 
\begin{DoxyCode}{0}
\DoxyCodeLine{int\ x;}
\DoxyCodeLine{...}
\DoxyCodeLine{\ \ mov(eax,\ ptr[rip\ +\ \&x]);\ //\ throw\ exception\ if\ the\ difference\ between\ \&x\ and\ current\ position\ is\ larger\ than\ 2GiB}

\end{DoxyCode}
 \doxysubsection*{\doxylink{struct_code}{Code} size}

The default max code size is 4096 bytes. Please set it in constructor of Code\+Generator() if you want to use large size. \begin{DoxyVerb}class Quantize : public Xbyak::CodeGenerator {
public:
  Quantize()
    : CodeGenerator(8192)
  {
  }
  ...
};
\end{DoxyVerb}


\doxysubsection*{use user allocated memory}

You can make jit code on prepaired memory. \begin{DoxyVerb}class Sample : public Xbyak::CodeGenerator {
public:
    Sample(void *userPtr, size_t size)
        : Xbyak::CodeGenerator(size, userPtr)
    {
        ...
    }
};

const size_t codeSize = 1024;
uint8 buf[codeSize + 16];

// get 16-byte aligned address
uint8 *p = Xbyak::CodeArray::getAlignedAddress(buf);

// append executable attribute to the memory
Xbyak::CodeArray::protect(p, codeSize, true);

// construct your jit code on the memory
Sample s(p, codeSize);
\end{DoxyVerb}


\texorpdfstring{$>$}{>}See {\itshape \doxylink{test0_8cpp}{sample/test0.\+cpp}}

\doxysection*{Auto\+Grow }

Under {\ttfamily Auto\+Grow} mode, \doxylink{namespace_xbyak}{Xbyak} extends memory automatically if necessary. \doxylink{struct_call}{Call} ready() before calling get\+Code() to calc address of jmp. 
\begin{DoxyCode}{0}
\DoxyCodeLine{struct\ Code\ :\ Xbyak::CodeGenerator\ \{}
\DoxyCodeLine{\ \ Code()}
\DoxyCodeLine{\ \ \ \ :\ Xbyak::CodeGenerator(<default\ memory\ size>,\ Xbyak::AutoGrow)}
\DoxyCodeLine{\ \ \{}
\DoxyCodeLine{\ \ \ \ \ ...}
\DoxyCodeLine{\ \ \}}
\DoxyCodeLine{\};}
\DoxyCodeLine{Code\ c;}
\DoxyCodeLine{c.ready();\ //\ Don't\ forget\ to\ call\ this\ function}

\end{DoxyCode}
 \texorpdfstring{$>$}{>}Don\textquotesingle{}t use the address returned by get\+Curr() before calling ready(). \texorpdfstring{$>$}{>}It may be invalid address. \texorpdfstring{$>$}{>}RESTRICTION \+: rip addressing is not supported in Auto\+Grow

\doxysection*{Macro }


\begin{DoxyItemize}
\item {\bfseries{XBYAK32}} is defined on 32bit.
\item {\bfseries{XBYAK64}} is defined on 64bit.
\item {\bfseries{XBYAK64\+\_\+\+WIN}} is defined on 64bit Windows(\+VC)
\item {\bfseries{XBYAK64\+\_\+\+GCC}} is defined on 64bit gcc, cygwin
\item define {\bfseries{XBYAK\+\_\+\+NO\+\_\+\+OP\+\_\+\+NAMES}} on gcc without {\ttfamily -\/fno-\/operator-\/names}
\item define {\bfseries{XBYAK\+\_\+\+ENABLE\+\_\+\+OMITTED\+\_\+\+OPERAND}} if you use omitted destination such as {\ttfamily vaddps(xmm2, xmm3);}(duplicated in the future)
\item define {\bfseries{XBYAK\+\_\+\+UNDEF\+\_\+\+JNL}} if Bessel function jnl is defined as macro
\end{DoxyItemize}

\doxysection*{\doxylink{class_sample}{Sample} }


\begin{DoxyItemize}
\item \doxylink{test0_8cpp}{test0.\+cpp} ; tiny sample of Xbyak(x86, x64)
\item \doxylink{quantize_8cpp}{quantize.\+cpp} ; JIT optimized quantization by fast division(x86 only)
\item \doxylink{calc_8cpp}{calc.\+cpp} ; assemble and estimate a given polynomial(x86, x64)
\item \doxylink{bf_8cpp}{bf.\+cpp} ; JIT brainfuck(x86, x64)
\end{DoxyItemize}

\doxysection*{License }

modified new BSD License \href{http://opensource.org/licenses/BSD-3-Clause}{\texttt{ http\+://opensource.\+org/licenses/\+BSD-\/3-\/\+Clause}}

The files under test/cybozu/ are copied from cybozulib(\href{https://github.com/herumi/cybozulib/}{\texttt{ https\+://github.\+com/herumi/cybozulib/}}), which is licensed by BSD-\/3-\/\+Clause and are used for only tests. The header files under xbyak/ are independent of cybozulib.

\doxysection*{History }


\begin{DoxyItemize}
\item 2018/\+Feb/14 ver 5.\+63 fix Cpu\+::set\+Cache\+Hierarchy() and fix Evex\+Modifier\+Zero for clang\texorpdfstring{$<$}{<}3.\+9(thanks to mgouicem)
\item 2018/\+Feb/13 ver 5.\+62 Cpu\+::set\+Cache\+Hierarchy() by mgouicem and rsdubtso
\item 2018/\+Feb/07 ver 5.\+61 vmov\texorpdfstring{$\ast$}{*} supports mem\{k\}\{z\}(I forgot it)
\item 2018/\+Jan/24 ver 5.\+601 add xword, yword, etc. into \doxylink{namespace_xbyak_1_1util}{Xbyak\+::util} namespace
\item 2018/\+Jan/05 ver 5.\+60 support AVX-\/512 for Ice lake(319433-\/030.\+pdf)
\item 2017/\+Aug/22 ver 5.\+53 fix mpx encoding, add \doxylink{xbyak__mnemonic_8h_ae3b0ed2e09f69d08312ea6ec8821a402}{bnd()} prefix
\item 2017/\+Aug/18 ver 5.\+52 fix align (thanks to Merry\+Mage)
\item 2017/\+Aug/17 ver 5.\+51 add multi-\/byte nop and align() uses it(thanks to inolen)
\item 2017/\+Aug/08 ver 5.\+50 add mpx(thanks to magurosan)
\item 2017/\+Aug/08 ver 5.\+45 add sha(thanks to magurosan)
\item 2017/\+Aug/08 ver 5.\+44 add prefetchw(thanks to rsdubtso)
\item 2017/\+Jul/12 ver 5.\+432 reduce warnings of PVS studio
\item 2017/\+Jul/09 ver 5.\+431 fix has\+Rex() (no affect) (thanks to drillsar)
\item 2017/\+May/14 ver 5.\+43 fix Code\+Generator\+::reset\+Size() (thanks to gibbed)
\item 2017/\+May/13 ver 5.\+42 add movs\{b,w,d,q\}
\item 2017/\+Jan/26 ver 5.\+41 add prefetchwt1 and support for scale == 0(thanks to rsdubtso)
\item 2016/\+Dec/14 ver 5.\+40 add Label\+::get\+Address() method to get the pointer specified by the label
\item 2016/\+Dec/09 ver 5.\+34 fix handling of negative offsets when encoding disp8\+N(thanks to rsdubtso)
\item 2016/\+Dec/08 ver 5.\+33 fix encoding of vpbroadcast\{b,w,d,q\}, vpinsr\{b,w\}, vpextr\{b,w\} for disp8N
\item 2016/\+Dec/01 ver 5.\+32 rename \+\_\+\+\_\+xgetbv() to {\itshape \doxylink{xbyak__mnemonic_8h_a484f67fadd30f1deb2a7c4fe0a7c6c9d}{xgetbv()} to support clang for Visual Studio(thanks to freiro)}
\item {\itshape 2016/\+Nov/27 ver 5.\+31 rename AVX512\+\_\+4\+VNNI to AVX512\+\_\+4\+VNNIW}
\item {\itshape 2016/\+Nov/27 ver 5.\+30 add AVX512\+\_\+4\+VNNI, AVX512\+\_\+4\+FMAPS instructions(thanks to rsdubtso)}
\item {\itshape 2016/\+Nov/26 ver 5.\+20 add detection of AVX512\+\_\+4\+VNNI and AVX512\+\_\+4\+FMAPS(thanks to rsdubtso)}
\item {\itshape 2016/\+Nov/20 ver 5.\+11 lost vptest for ymm(thanks to gregory38)}
\item {\itshape 2016/\+Nov/20 ver 5.\+10 add addressing \mbox{[}rip+\&var\mbox{]}}
\item {\itshape 2016/\+Sep/29 ver 5.\+03 fix detection ERR\+\_\+\+INVALID\+\_\+\+OPMASK\+\_\+\+WITH\+\_\+\+MEMORY(thanks to PVS-\/\+Studio)}
\item {\itshape 2016/\+Aug/15 ver 5.\+02 xbyak does not include \doxylink{xbyak__bin2hex_8h}{xbyak\+\_\+bin2hex.\+h}}
\item {\itshape 2016/\+Aug/15 ver 5.\+011 fix detection of version of gcc 5.\+4}
\item {\itshape 2016/\+Aug/03 ver 5.\+01 disable omitted operand}
\item {\itshape 2016/\+Jun/24 ver 5.\+00 support avx-\/512 instruction set}
\item {\itshape 2016/\+Jun/13 avx-\/512 add mask instructions}
\item {\itshape 2016/\+May/05 ver 4.\+91 add detection of AVX-\/512 to \doxylink{class_xbyak_1_1util_1_1_cpu}{Xbyak\+::util\+::\+Cpu}}
\item {\itshape 2016/\+Mar/14 ver 4.\+901 comment to ready() function(thanks to skmp)}
\item {\itshape 2016/\+Feb/04 ver 4.\+90 add jcc(const void \texorpdfstring{$\ast$}{*}addr);}
\item {\itshape 2016/\+Jan/30 ver 4.\+89 vpblendvb supports ymm reg(thanks to John Funnell)}
\item {\itshape 2016/\+Jan/24 ver 4.\+88 lea, cmov supports 16-\/bit register(thanks to whyisthisfieldhere)}
\item {\itshape 2015/\+Oct/05 ver 4.\+87 support segment selectors}
\item {\itshape 2015/\+Aug/18 ver 4.\+86 fix \mbox{[}rip + label\mbox{]} addressing with immediate \doxylink{pkcs11_8h_a32aff7c6c4cd253fdf6563677afab5ce}{value(thanks to whyisthisfieldhere)}}
\item {\itshape 2015/\+Aug/10 ver 4.\+85 Address\+::operator==() is not correct(thanks to inolen)}
\item {\itshape 2015/\+Jun/22 ver 4.\+84 \doxylink{programs_2clio_2main_8cpp_af931af8e9f099860a2670931f8d3ad2c}{call()} support variadic template if available(thanks to randomstuff)}
\item {\itshape 2015/\+Jun/16 ver 4.\+83 support movbe(thanks to benvanik)}
\item {\itshape 2015/\+May/24 ver 4.\+82 support detection of F16C}
\item {\itshape 2015/\+Apr/25 ver 4.\+81 fix the condition to throw exception for set\+Size(thanks to whyisthisfieldhere)}
\item {\itshape 2015/\+Apr/22 ver 4.\+80 rip supports \doxylink{yubihsm__pkcs11_8c_a22f45a3cb4f074e609f58ebaeef0ecf9}{label(thanks to whyisthisfieldhere)}}
\item {\itshape 2015/\+Jar/28 ver 4.\+71 support adcx, adox, cmpxchg, rdseed, stac}
\item {\itshape 2014/\+Oct/14 ver 4.\+70 support Mmap\+Allocator}
\item {\itshape 2014/\+Jun/13 ver 4.\+62 disable warning of VC2014}
\item {\itshape 2014/\+May/30 ver 4.\+61 support bt, bts, btr, btc}
\item {\itshape 2014/\+May/28 ver 4.\+60 support vcvtph2ps, vcvtps2ph}
\item {\itshape 2014/\+Apr/11 ver 4.\+52 add detection of rdrand}
\item {\itshape 2014/\+Mar/25 ver 4.\+51 remove state information of unreferenced labels}
\item {\itshape 2014/\+Mar/16 ver 4.\+50 support new Label}
\item {\itshape 2014/\+Mar/05 ver 4.\+40 fix wrong detection of BMI/enhanced rep on Virtual\+Box}
\item {\itshape 2013/\+Dec/03 ver 4.\+30 support Reg\+::cvt8(), cvt16(), cvt32(), cvt64()}
\item {\itshape 2013/\+Oct/16 ver 4.\+21 label support std\+::string}
\item {\itshape 2013/\+Jul/30 ver 4.\+20 \mbox{[}break backward compatibility\mbox{]} split Reg32e class into Reg\+Exp(base+index\texorpdfstring{$\ast$}{*}scale+disp) and Reg32e(means Reg32 or Reg64)}
\item {\itshape 2013/\+Jul/04 ver 4.\+10 \mbox{[}break backward compatibility\mbox{]} change the type of \doxylink{class_xbyak_1_1_error}{Xbyak\+::\+Error} from enum to a class}
\item {\itshape 2013/\+Jun/21 ver 4.\+02 add put\+L(\+LABEL) function to put the address of the label}
\item {\itshape 2013/\+Jun/21 ver 4.\+01 vpsllw, vpslld, vpsllq, vpsraw, vpsrad, vpsrlw, vpsrld, vpsrlq support (ymm, ymm, xmm). support vpbroadcastb, vpbroadcastw, vpbroadcastd, vpbroadcastq(thanks to Gabest).}
\item {\itshape 2013/\+May/30 ver 4.\+00 support AVX2, VEX-\/encoded GPR-\/instructions}
\item {\itshape 2013/\+Mar/27 ver 3.\+80 support mov(reg, "{}label"{});}
\item {\itshape 2013/\+Mar/13 ver 3.\+76 add cqo(), \doxylink{xbyak__mnemonic_8h_a0db9ac97b9688d7b40cea60fcb97549a}{jcxz()}, \doxylink{xbyak__mnemonic_8h_a570f5d3366ddfce0d4b613aa343e34f0}{jecxz()}, jrcxz()}
\item {\itshape 2013/\+Jan/15 ver 3.\+75 add set\+Size() to modify generated code}
\item {\itshape 2013/\+Jan/12 ver 3.\+74 add Code\+Generator\+::reset() ; add Allocator\+::use\+Protect()}
\item {\itshape 2013/\+Jan/06 ver 3.\+73 use unordered\+\_\+map if possible}
\item {\itshape 2012/\+Dec/04 ver 3.\+72 eax, ebx, ... are member variables of Code\+Generator(revert), Xbyak\+::util\+::eax, ... are static const.}
\item {\itshape 2012/\+Nov/17 ver 3.\+71 and}(), \doxylink{xbyak__mnemonic_8h_ae2671a6e11c7fbb9d0046ea8c91495f5}{or\+\_\+()}, \doxylink{xbyak__mnemonic_8h_a0efb05fdbef7e40003a0dd643d23c322}{xor\+\_\+()}, \doxylink{xbyak__mnemonic_8h_a53023f0714e3986f0cc22815a1b1e7d9}{not\+\_\+()} are available if XBYAK\+\_\+\+NO\+\_\+\+OP\+\_\+\+NAMES is not defined.
\item 2012/\+Nov/17 change eax, ebx, ptr and so on in Code\+Generator as static member and alias of them are defined in \doxylink{namespace_xbyak_1_1util}{Xbyak\+::util}.
\item 2012/\+Nov/09 ver 3.\+70 XBYAK\+\_\+\+NO\+\_\+\+OP\+\_\+\+NAMES macro is added to use \doxylink{xbyak__mnemonic_8h_a852f5fbe31e6343e0b72a0c3ae0e02a2}{and\+\_\+()} instead of \doxylink{xbyak__mnemonic_8h_a8bfc9d22e0846b48228832bc081c5ccb}{and()} (thanks to Mattias)
\item 2012/\+Nov/01 ver 3.\+62 add fwait/fnwait/finit/fninit
\item 2012/\+Nov/01 ver 3.\+61 add fldcw/fstcw
\item 2012/\+May/03 ver 3.\+60 change interface of Allocator
\item 2012/\+Mar/23 ver 3.\+51 fix user\+Ptr mode
\item 2012/\+Mar/19 ver 3.\+50 support Auto\+Grow mode
\item 2011/\+Nov/09 ver 3.\+05 fix bit property of rip addresing / support movsxd
\item 2011/\+Aug/15 ver 3.\+04 fix dealing with imm8 such as add(dword \mbox{[}ebp-\/8\mbox{]}, 0xda); (thanks to lolcat)
\item 2011/\+Jun/16 ver 3.\+03 fix \+\_\+\+\_\+\+GNUC\+\_\+\+PREREQ macro for Mac gcc(thanks to t\+\_\+teruya)
\item 2011/\+Apr/28 ver 3.\+02 do not use xgetbv on Mac gcc
\item 2011/\+May/24 ver 3.\+01 fix typo of OSXSAVE
\item 2011/\+May/23 ver 3.\+00 add vcmpeqps and so on
\item 2011/\+Feb/16 ver 2.\+994 beta add vmovq for 32-\/bit mode(\+I forgot it)
\item 2011/\+Feb/16 ver 2.\+993 beta remove cvt\+Reg to avoid thread unsafe
\item 2011/\+Feb/10 ver 2.\+992 beta support one argument syntax for fadd like nasm
\item 2011/\+Feb/07 ver 2.\+991 beta fix pextrw reg, xmm, imm(\+Thanks to Gabest)
\item 2011/\+Feb/04 ver 2.\+99 beta support AVX
\item 2010/\+Dec/08 ver 2.\+31 fix ptr \mbox{[}rip + 32bit offset\mbox{]}, support rdtscp
\item 2010/\+Oct/19 ver 2.\+30 support pclmulqdq, aesdec, aesdeclast, aesenc, aesenclast, aesimc, aeskeygenassist
\item 2010/\+Jun/07 ver 2.\+29 fix call($<$label$>$)
\item 2010/\+Jun/17 ver 2.\+28 move some member functions to public
\item 2010/\+Jun/01 ver 2.\+27 support encoding of mov(reg64, imm) like yasm(not nasm)
\item 2010/\+May/24 ver 2.\+26 fix sub(rsp, 1000)
\item 2010/\+Apr/26 ver 2.\+25 add jc/jnc(I forgot to implement them...)
\item 2010/\+Apr/16 ver 2.\+24 change the prototype of rewrite() method
\item 2010/\+Apr/15 ver 2.\+23 fix align() and \doxylink{xbyak__util_8h}{xbyak\+\_\+util.\+h} for Mac
\item 2010/\+Feb/16 ver 2.\+22 fix in\+Local\+Label()/out\+Local\+Label()
\item 2009/\+Dec/09 ver 2.\+21 support cygwin(gcc 4.\+3.\+2)
\item 2009/\+Nov/28 support a part of FPU
\item 2009/\+Jun/25 fix mov(qword\mbox{[}rax\mbox{]}, imm); (thanks to Martin)
\item 2009/\+Mar/10 fix redundant REX.\+W prefix on jmp/call reg64
\item 2009/\+Feb/24 add movq reg64, mmx/xmm; movq mmx/xmm, reg64
\item 2009/\+Feb/13 movd(xmm7, dword\mbox{[}eax\mbox{]}) drops 0x66 prefix (thanks to Gabest)
\item 2008/\+Dec/30 fix call in short relative address(thanks to kato san)
\item 2008/\+Sep/18 support @, @f, {\bfseries{and}} localization of label(thanks to nobu-\/q san)
\item 2008/\+Sep/18 support (ptr\mbox{[}rip + 32bit offset\mbox{]}) (thanks to Dango-\/\+Chu san)
\item 2008/\+Jun/03 fix align(). mov(ptr\mbox{[}eax\mbox{]},1) throws ERR\+\_\+\+MEM\+\_\+\+SIZE\+\_\+\+IS\+\_\+\+NOT\+\_\+\+SPECIFIED.
\item 2008/\+Jun/02 support memory interface allocated by user
\item 2008/\+May/26 fix protect() to avoid invalid setting(thanks to shinichiro\+\_\+h san)
\item 2008/\+Apr/30 add cmpxchg16b, cdqe
\item 2008/\+Apr/29 support x64
\item 2008/\+Apr/14 code refactoring
\item 2008/\+Mar/12 add bsr/bsf
\item 2008/\+Feb/14 fix output of sub eax, 1234 (thanks to Robert)
\item 2007/\+Nov/5 support lock, xadd, xchg
\item 2007/\+Nov/2 support SSSE3/\+SSE4 (thanks to Dango-\/\+Chu san)
\item 2007/\+Feb/4 fix the bug that exception doesn\textquotesingle{}t occur under the condition which the offset of jmp mnemonic without T\+\_\+\+NEAR is over 127.
\item 2007/\+Jan/21 fix the bug to create address like \mbox{[}disp\mbox{]} select smaller representation for mov (eax\texorpdfstring{$\vert$}{|}ax\texorpdfstring{$\vert$}{|}al, \mbox{[}disp\mbox{]})
\item 2007/\+Jan/4 first version
\end{DoxyItemize}

\doxysection*{Author }

MITSUNARI Shigeo(\href{mailto:herumi@nifty.com}{\texttt{ herumi@nifty.\+com}}) 