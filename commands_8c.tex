\doxysection{libraries/yubihsm/src/commands.c File Reference}
\hypertarget{commands_8c}{}\label{commands_8c}\index{libraries/yubihsm/src/commands.c@{libraries/yubihsm/src/commands.c}}
{\ttfamily \#include $<$ctype.\+h$>$}\newline
{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include $<$string.\+h$>$}\newline
{\ttfamily \#include "{}commands.\+h"{}}\newline
{\ttfamily \#include "{}yubihsm-\/shell.\+h"{}}\newline
{\ttfamily \#include "{}../common/insecure\+\_\+memzero.\+h"{}}\newline
{\ttfamily \#include "{}hash.\+h"{}}\newline
{\ttfamily \#include "{}util.\+h"{}}\newline
{\ttfamily \#include "{}openssl-\/compat.\+h"{}}\newline
{\ttfamily \#include $<$arpa/inet.\+h$>$}\newline
{\ttfamily \#include $<$unistd.\+h$>$}\newline
{\ttfamily \#include $<$sys/ioctl.\+h$>$}\newline
{\ttfamily \#include $<$openssl/rand.\+h$>$}\newline
{\ttfamily \#include $<$openssl/pem.\+h$>$}\newline
{\ttfamily \#include $<$openssl/x509.\+h$>$}\newline
{\ttfamily \#include $<$sys/time.\+h$>$}\newline
Include dependency graph for commands.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c__incl}
\end{center}
\end{figure}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \mbox{\hyperlink{commands_8c_a3c600843ccdac7af506983bc67cb0bc3}{yh\+\_\+com\+\_\+audit}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{commands_8c_aeb72c881aa2699aea40f45fa65cf069b}{yh\+\_\+com\+\_\+set\+\_\+log\+\_\+index}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{commands_8c_a1d821476693df49671598a98e7d6dbca}{yh\+\_\+com\+\_\+blink}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{commands_8c_aabb06b0c16a19b4b22478cb753d8f599}{yh\+\_\+com\+\_\+close\+\_\+session}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{commands_8c_a9155cc4306ad97e58a03ead18637f33b}{yh\+\_\+com\+\_\+connect}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{commands_8c_ad8a6eb16c04ad3e525f8be152062ff24}{yh\+\_\+com\+\_\+debug\+\_\+all}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{commands_8c_af045c2e8a570dc8fed3d339e75d26feb}{yh\+\_\+com\+\_\+debug\+\_\+error}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{commands_8c_a774b8dbc4c8d855527e518270206bb52}{yh\+\_\+com\+\_\+debug\+\_\+info}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{commands_8c_ad621ced8cc22f103e049f17717d0b3d8}{yh\+\_\+com\+\_\+debug\+\_\+intermediate}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{commands_8c_ac8470d4c5dc4fa0d300bcf171a16140b}{yh\+\_\+com\+\_\+debug\+\_\+none}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{commands_8c_ac67abff009407dcfe773a32d8273969a}{yh\+\_\+com\+\_\+debug\+\_\+raw}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{commands_8c_af5cc531118346eb9389b42149112acdc}{yh\+\_\+com\+\_\+debug\+\_\+crypto}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{commands_8c_aea9c5cab32280dc06d4681c02f1b5ccb}{yh\+\_\+com\+\_\+decrypt\+\_\+pkcs1v1\+\_\+5}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{commands_8c_a0f6792710fe36e1bf00cb839f286d473}{yh\+\_\+com\+\_\+derive\+\_\+ecdh}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{commands_8c_a4a18ed75272b213eea9b2ebec190b8c1}{yh\+\_\+com\+\_\+decrypt\+\_\+aesccm}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{commands_8c_a115ebd6b436229c152141f64a2405e70}{yh\+\_\+com\+\_\+encrypt\+\_\+aesccm}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{commands_8c_ac388fd67865728ed4f4267a8a13b248e}{yh\+\_\+com\+\_\+disconnect}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{commands_8c_af764906e585805991dd84ec5dc2c060a}{yh\+\_\+com\+\_\+echo}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{commands_8c_aa1c71ebc2b3f298b6522ab090393c73e}{yh\+\_\+com\+\_\+generate\+\_\+asymmetric}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{commands_8c_a2be1be0e0a454965f5a378e4ecb483f0}{yh\+\_\+com\+\_\+generate\+\_\+hmac}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{commands_8c_a43d7d9dd1659838d79f875e61e59ce52}{yh\+\_\+com\+\_\+generate\+\_\+wrap}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{commands_8c_ad8a4781a26be12a87848234cc184a3bb}{yh\+\_\+com\+\_\+get\+\_\+opaque}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{commands_8c_aaafb1f743869a0068a7d7b6ed1bafb01}{yh\+\_\+com\+\_\+get\+\_\+option}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{commands_8c_af32a8f10f2d022ca8b7816e6f4809a24}{yh\+\_\+com\+\_\+get\+\_\+random}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{commands_8c_a408c9e43b8ccb159acb178f2b20f3f77}{yh\+\_\+com\+\_\+get\+\_\+storage}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{commands_8c_aa1c9a933f4601dae48cd64f911d297aa}{yh\+\_\+com\+\_\+get\+\_\+pubkey}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{commands_8c_afa7330c81148ba6f4d5c53f7c370ed41}{yh\+\_\+com\+\_\+get\+\_\+object\+\_\+info}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{commands_8c_ac221d587381b78c747d8290320ee4c0a}{yh\+\_\+com\+\_\+get\+\_\+wrapped}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{commands_8c_ac8e5bb8ba179bc997ddc73e03423782d}{yh\+\_\+com\+\_\+get\+\_\+template}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{commands_8c_a39d9fd4501c5547cb11e00a3ca37be7e}{yh\+\_\+com\+\_\+noop}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{commands_8c_ab7355f80935fb819c440a21d56f181e4}{yh\+\_\+com\+\_\+list\+\_\+capabilities}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{commands_8c_ac981267ad1d570af845289dfb0733b8b}{yh\+\_\+com\+\_\+list\+\_\+algorithms}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{commands_8c_a65ff18ca1fb6f1b4da386071e1c1a505}{yh\+\_\+com\+\_\+list\+\_\+types}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{commands_8c_ab98950b39a19499a22ec6b2e874525a5}{yh\+\_\+com\+\_\+list\+\_\+sessions}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{commands_8c_a2b752129687a9ca758661e0b6625b59c}{yh\+\_\+com\+\_\+list\+\_\+objects}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{commands_8c_a22f22a25151b12c7573f80563a341368}{yh\+\_\+com\+\_\+open\+\_\+session}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{commands_8c_a95d970cdea5162be25cac2a7f5c420ed}{yh\+\_\+com\+\_\+pecho}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{commands_8c_a0abe95eb37069022ed341835938de103}{yh\+\_\+com\+\_\+put\+\_\+asymmetric}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{commands_8c_a3bd17c302789958013e50a2ad9738aea}{yh\+\_\+com\+\_\+put\+\_\+authentication}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{commands_8c_a2be40cf6e90d80392d7aa5e291660f65}{yh\+\_\+com\+\_\+put\+\_\+opaque}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{commands_8c_ae400ec3fdd83a82b3c08dd7106c516b9}{yh\+\_\+com\+\_\+put\+\_\+option}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{commands_8c_aed17eea0c4eb877cd1097fbcd8e8e5d0}{yh\+\_\+com\+\_\+put\+\_\+hmac}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{commands_8c_ab2eb73abfe6f6d5a7f17752b3cab227a}{yh\+\_\+com\+\_\+put\+\_\+wrapkey}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{commands_8c_a6b74f2d2d47796c2432a15cd63183dd1}{yh\+\_\+com\+\_\+put\+\_\+wrapped}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{commands_8c_ad1629b955c1d718c65f137c9df3b3332}{yh\+\_\+com\+\_\+put\+\_\+template}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{commands_8c_a982058963f9ff020c357030be09e79fc}{yh\+\_\+com\+\_\+sign\+\_\+ecdsa}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{commands_8c_ac867ca0fc75e87da1a8d924fc587f5b9}{yh\+\_\+com\+\_\+sign\+\_\+eddsa}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{commands_8c_a98cf5e35ce2e4fd5881d8b6e7a890357}{yh\+\_\+com\+\_\+sign\+\_\+pkcs1v1\+\_\+5}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{commands_8c_a1dcbe3dfaa3722ae6e9246527b889627}{yh\+\_\+com\+\_\+sign\+\_\+pss}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{commands_8c_aca833cbc2ca7673b00a4f6cb320c97b6}{yh\+\_\+com\+\_\+get\+\_\+device\+\_\+info}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{commands_8c_a8de2999193b4caa2d0d1fd2e8451dba1}{yh\+\_\+com\+\_\+hmac}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{commands_8c_a5947d870ac856de3880f8b80981e6355}{yh\+\_\+com\+\_\+reset}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{commands_8c_ad490f0e89d33c1300a44bd095eb5562c}{yh\+\_\+com\+\_\+delete}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{commands_8c_a03581158b5703a0ffe866d50d8a3982d}{yh\+\_\+com\+\_\+sign\+\_\+ssh\+\_\+certificate}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{commands_8c_ae2e50929acc6085cd395d0bd4ddb02db}{yh\+\_\+com\+\_\+benchmark}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{commands_8c_ae716e54fae7ba83cb44fe966fbcad9cb}{yh\+\_\+com\+\_\+otp\+\_\+aead\+\_\+create}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{commands_8c_a533707756dfe3a35c9aadf4d288b73d4}{yh\+\_\+com\+\_\+otp\+\_\+aead\+\_\+random}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{commands_8c_ad676312a3ed43f6a3ece63851780aeff}{yh\+\_\+com\+\_\+otp\+\_\+decrypt}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{commands_8c_af224308de5cdf8e20cbbdcaa6cf7598c}{yh\+\_\+com\+\_\+sign\+\_\+attestation\+\_\+certificate}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{commands_8c_a7ef84380bc19536e4ba9bf62fd44ba93}{yh\+\_\+com\+\_\+put\+\_\+otp\+\_\+aead\+\_\+key}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{commands_8c_a13416d261c1a92415525cbfa63a2dc0c}{yh\+\_\+com\+\_\+generate\+\_\+otp\+\_\+aead\+\_\+key}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{commands_8c_a38efe7b63355b641f9489d4f95106589}{yh\+\_\+com\+\_\+decrypt\+\_\+oaep}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{commands_8c_ada05a561c71aebab8f0a53c0d552e027}{yh\+\_\+com\+\_\+set\+\_\+cacert}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{commands_8c_a264ec5c469bd0517814525ef59c8e69e}{yh\+\_\+com\+\_\+set\+\_\+proxy}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\item 
int \mbox{\hyperlink{commands_8c_a0691ab03bd0e40402b2ad5f9a378a541}{yh\+\_\+com\+\_\+change\+\_\+authentication\+\_\+key}} (\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}} fmt)
\end{DoxyCompactItemize}


\doxysubsection{Function Documentation}
\Hypertarget{commands_8c_a3c600843ccdac7af506983bc67cb0bc3}\index{commands.c@{commands.c}!yh\_com\_audit@{yh\_com\_audit}}
\index{yh\_com\_audit@{yh\_com\_audit}!commands.c@{commands.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_audit()}{yh\_com\_audit()}}
{\footnotesize\ttfamily \label{commands_8c_a3c600843ccdac7af506983bc67cb0bc3} 
int yh\+\_\+com\+\_\+audit (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{commands_8c_source_l00059}{59}} of file \mbox{\hyperlink{commands_8c_source}{commands.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00059\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00060\ }
\DoxyCodeLine{00061\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(ctx);}
\DoxyCodeLine{00062\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(fmt);}
\DoxyCodeLine{00063\ }
\DoxyCodeLine{00064\ \ \ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366}{yh\_rc}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}};}
\DoxyCodeLine{00065\ }
\DoxyCodeLine{00066\ \ \ \mbox{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t}}\ unlogged\_boot\ =\ 0;}
\DoxyCodeLine{00067\ \ \ \mbox{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t}}\ unlogged\_auth\ =\ 0;}
\DoxyCodeLine{00068\ \ \ \mbox{\hyperlink{structyh__log__entry}{yh\_log\_entry}}\ logs[\mbox{\hyperlink{yubihsm_8h_ae10a65a4b5dfaac7c3d64c1ec7b99e82}{YH\_MAX\_LOG\_ENTRIES}}];}
\DoxyCodeLine{00069\ \ \ \textcolor{keywordtype}{size\_t}\ n\_items\ =\ \textcolor{keyword}{sizeof}(logs);}
\DoxyCodeLine{00070\ }
\DoxyCodeLine{00071\ \ \ \textcolor{keywordflow}{switch}\ (fmt)\ \{}
\DoxyCodeLine{00072\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a701725c70fb214e14a2feee390939a09}{fmt\_binary}}:}
\DoxyCodeLine{00073\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708aa8908f2c651567ae288c587240e71d3e}{fmt\_PEM}}:}
\DoxyCodeLine{00074\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708add674d756d2c6341a834a330a874b550}{fmt\_base64}}:}
\DoxyCodeLine{00075\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708ad58942468b13601c21c14f2269dbca57}{fmt\_password}}:}
\DoxyCodeLine{00076\ \ \ \ \ \ \ fprintf(stderr,}
\DoxyCodeLine{00077\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}The\ selected\ output\ format\ is\ not\ supported\ for\ this\ operation.\ "{}}}
\DoxyCodeLine{00078\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Supported\ format\ are\ \(\backslash\)"{}ASCII\(\backslash\)"{},\ \(\backslash\)"{}hex\(\backslash\)"{}\ and\ \(\backslash\)"{}default\(\backslash\)"{}\(\backslash\)n"{}});}
\DoxyCodeLine{00079\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{00080\ }
\DoxyCodeLine{00081\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00082\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00083\ \ \ \}}
\DoxyCodeLine{00084\ }
\DoxyCodeLine{00085\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a5ae52ad56b7e83baeb33b46104263aa6}{yh\_util\_get\_log\_entries}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e,\ \&unlogged\_boot,\ \&unlogged\_auth,\ logs,}
\DoxyCodeLine{00086\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&n\_items);}
\DoxyCodeLine{00087\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{00088\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ get\ logs:\ \%s\(\backslash\)n"{}},\ \mbox{\hyperlink{lib_2error_8c_a238eedb1e27dbff2a0ab9a3932eb3f8b}{yh\_strerror}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}));}
\DoxyCodeLine{00089\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{00090\ \ \ \}}
\DoxyCodeLine{00091\ }
\DoxyCodeLine{00092\ \ \ \textcolor{keywordtype}{char}\ digest\_buf[(2\ *\ \mbox{\hyperlink{yubihsm_8h_a289ca46f5ef481980f0fad98d727e87a}{YH\_LOG\_DIGEST\_SIZE}})\ +\ 1];}
\DoxyCodeLine{00093\ }
\DoxyCodeLine{00094\ \ \ \textcolor{keywordflow}{switch}\ (ctx-\/>\mbox{\hyperlink{structyubihsm__context_addfaa9a6a08f58bdb5b5a93f2e89ccc2}{out\_fmt}})\ \{}
\DoxyCodeLine{00095\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708acce29e9764c448874d69cb6c90b02401}{fmt\_hex}}:}
\DoxyCodeLine{00096\ \ \ \ \ \ \ fprintf(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}},\ \textcolor{stringliteral}{"{}\%04x\%04x"{}},\ unlogged\_boot,\ unlogged\_auth);}
\DoxyCodeLine{00097\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t}}\ i\ =\ 0;\ i\ <\ n\_items;\ i++)\ \{}
\DoxyCodeLine{00098\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{util_8c_a99b40ed1e5df4e0e59f93585ea38b7c4}{format\_digest}}(logs[i].digest,\ digest\_buf,\ \mbox{\hyperlink{yubihsm_8h_a289ca46f5ef481980f0fad98d727e87a}{YH\_LOG\_DIGEST\_SIZE}});}
\DoxyCodeLine{00099\ \ \ \ \ \ \ \ \ fprintf(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}},\ \textcolor{stringliteral}{"{}\%04x\%02x\%04x\%04x\%04x\%04x\%02x\%08lx\%s"{}},\ logs[i].number,}
\DoxyCodeLine{00100\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ logs[i].command,\ logs[i].length,\ logs[i].session\_key,}
\DoxyCodeLine{00101\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ logs[i].target\_key,\ logs[i].second\_key,\ logs[i].result,}
\DoxyCodeLine{00102\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{long})\ logs[i].systick,\ digest\_buf);}
\DoxyCodeLine{00103\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00104\ \ \ \ \ \ \ fprintf(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}},\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{00105\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00106\ }
\DoxyCodeLine{00107\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a4fff5e64ffe63c6c03b00438c0b09282}{fmt\_ASCII}}:}
\DoxyCodeLine{00108\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00109\ \ \ \ \ \ \ fprintf(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}},\ \textcolor{stringliteral}{"{}\%d\ unlogged\ boots\ found\(\backslash\)n"{}},\ unlogged\_boot);}
\DoxyCodeLine{00110\ \ \ \ \ \ \ fprintf(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}},\ \textcolor{stringliteral}{"{}\%d\ unlogged\ authentications\ found\(\backslash\)n"{}},\ unlogged\_auth);}
\DoxyCodeLine{00111\ }
\DoxyCodeLine{00112\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (n\_items\ ==\ 0)\ \{}
\DoxyCodeLine{00113\ \ \ \ \ \ \ \ \ fprintf(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}},\ \textcolor{stringliteral}{"{}No\ logs\ to\ extract\(\backslash\)n"{}});}
\DoxyCodeLine{00114\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00115\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (n\_items\ ==\ 1)\ \{}
\DoxyCodeLine{00116\ \ \ \ \ \ \ \ \ fprintf(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}},\ \textcolor{stringliteral}{"{}Found\ 1\ item\(\backslash\)n"{}});}
\DoxyCodeLine{00117\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \ \ fprintf(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}},\ \textcolor{stringliteral}{"{}Found\ \%zu\ items\(\backslash\)n"{}},\ n\_items);}
\DoxyCodeLine{00119\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00120\ }
\DoxyCodeLine{00121\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t}}\ i\ =\ 0;\ i\ <\ n\_items;\ i++)\ \{}
\DoxyCodeLine{00122\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{util_8c_a99b40ed1e5df4e0e59f93585ea38b7c4}{format\_digest}}(logs[i].digest,\ digest\_buf,\ \mbox{\hyperlink{yubihsm_8h_a289ca46f5ef481980f0fad98d727e87a}{YH\_LOG\_DIGEST\_SIZE}});}
\DoxyCodeLine{00123\ \ \ \ \ \ \ \ \ fprintf(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}},}
\DoxyCodeLine{00124\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}item:\ \%5u\ -\/-\/\ cmd:\ 0x\%02x\ -\/-\/\ length:\ \%4u\ -\/-\/\ session\ key:\ "{}}}
\DoxyCodeLine{00125\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}0x\%04x\ -\/-\/\ target\ key:\ 0x\%04x\ -\/-\/\ second\ key:\ 0x\%04x\ -\/-\/\ "{}}}
\DoxyCodeLine{00126\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}result:\ 0x\%02x\ -\/-\/\ tick:\ \%lu\ -\/-\/\ hash:\ \%s\(\backslash\)n"{}},}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ logs[i].number,\ logs[i].command,\ logs[i].length,}
\DoxyCodeLine{00128\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ logs[i].session\_key,\ logs[i].target\_key,\ logs[i].second\_key,}
\DoxyCodeLine{00129\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ logs[i].result,\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{long})\ logs[i].systick,\ digest\_buf);}
\DoxyCodeLine{00130\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00131\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00132\ \ \ \}}
\DoxyCodeLine{00133\ }
\DoxyCodeLine{00134\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00135\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_a3c600843ccdac7af506983bc67cb0bc3_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_a3c600843ccdac7af506983bc67cb0bc3_icgraph}
\end{center}
\end{figure}
\Hypertarget{commands_8c_ae2e50929acc6085cd395d0bd4ddb02db}\index{commands.c@{commands.c}!yh\_com\_benchmark@{yh\_com\_benchmark}}
\index{yh\_com\_benchmark@{yh\_com\_benchmark}!commands.c@{commands.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_benchmark()}{yh\_com\_benchmark()}}
{\footnotesize\ttfamily \label{commands_8c_ae2e50929acc6085cd395d0bd4ddb02db} 
int yh\+\_\+com\+\_\+benchmark (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{commands_8c_source_l02111}{2111}} of file \mbox{\hyperlink{commands_8c_source}{commands.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02111\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02112\ }
\DoxyCodeLine{02113\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(ctx);}
\DoxyCodeLine{02114\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(fmt);}
\DoxyCodeLine{02115\ }
\DoxyCodeLine{02116\ \ \ \textcolor{keyword}{struct\ }\{}
\DoxyCodeLine{02117\ \ \ \ \ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55ca}{yh\_algorithm}}\ algo;}
\DoxyCodeLine{02118\ \ \ \ \ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55ca}{yh\_algorithm}}\ algo2;}
\DoxyCodeLine{02119\ \ \ \ \ \mbox{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t}}\ \mbox{\hyperlink{namespacesysio_1_1chain_ac6f5a1f1e061f000983f5d5f3ac25dfa}{bytes}};}
\DoxyCodeLine{02120\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *special;}
\DoxyCodeLine{02121\ \ \ \}\ benchmarks[]\ =\ \{}
\DoxyCodeLine{02122\ \ \ \ \ \{\mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caaafe94e6a770edb51c6db84f77d98d2c6}{YH\_ALGO\_RSA\_2048}},\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa18e17370fcf9a829572e57608aff743c}{YH\_ALGO\_RSA\_PKCS1\_SHA256}},\ 32,\ \textcolor{stringliteral}{"{}"{}}\},}
\DoxyCodeLine{02123\ \ \ \ \ \{\mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caafd3fbd9ed86caf267ccc77cb24d44426}{YH\_ALGO\_RSA\_3072}},\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caafc78c2f62fe0a185c38d2644755fde2c}{YH\_ALGO\_RSA\_PKCS1\_SHA384}},\ 48,\ \textcolor{stringliteral}{"{}"{}}\},}
\DoxyCodeLine{02124\ \ \ \ \ \{\mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caae5963322a0a0f43a1b74faa78e3a7329}{YH\_ALGO\_RSA\_4096}},\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa84e18ba6561d5a834dc8d794504708db}{YH\_ALGO\_RSA\_PKCS1\_SHA512}},\ 64,\ \textcolor{stringliteral}{"{}"{}}\},}
\DoxyCodeLine{02125\ \ \ \ \ \{\mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caaafe94e6a770edb51c6db84f77d98d2c6}{YH\_ALGO\_RSA\_2048}},\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caac42381f876f5e7190547cf81021451f5}{YH\_ALGO\_RSA\_PSS\_SHA256}},\ 32,\ \textcolor{stringliteral}{"{}"{}}\},}
\DoxyCodeLine{02126\ \ \ \ \ \{\mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caafd3fbd9ed86caf267ccc77cb24d44426}{YH\_ALGO\_RSA\_3072}},\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa144083d6414cb33e8543d51e7d361d05}{YH\_ALGO\_RSA\_PSS\_SHA384}},\ 48,\ \textcolor{stringliteral}{"{}"{}}\},}
\DoxyCodeLine{02127\ \ \ \ \ \{\mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caae5963322a0a0f43a1b74faa78e3a7329}{YH\_ALGO\_RSA\_4096}},\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa1d5a50a1a53000cd2b2989c17703e2d1}{YH\_ALGO\_RSA\_PSS\_SHA512}},\ 64,\ \textcolor{stringliteral}{"{}"{}}\},}
\DoxyCodeLine{02128\ \ \ \ \ \{\mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caaedcbc07d82b18ca5c21eb3379a6cc010}{YH\_ALGO\_EC\_P224}},\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caae9b7b5598c3839a53e4986dc901be244}{YH\_ALGO\_EC\_ECDSA\_SHA1}},\ 20,\ \textcolor{stringliteral}{"{}"{}}\},}
\DoxyCodeLine{02129\ \ \ \ \ \{\mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caae4b191baf5c65f9234120080264d129b}{YH\_ALGO\_EC\_P256}},\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa2e5dfe9c79cb0d391d7bf952227268ec}{YH\_ALGO\_EC\_ECDSA\_SHA256}},\ 32,\ \textcolor{stringliteral}{"{}"{}}\},}
\DoxyCodeLine{02130\ \ \ \ \ \{\mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa31094c17c66e4c365ca3dad353bc8bda}{YH\_ALGO\_EC\_P384}},\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa657d2b30d884aeeff3c024404132ad69}{YH\_ALGO\_EC\_ECDSA\_SHA384}},\ 48,\ \textcolor{stringliteral}{"{}"{}}\},}
\DoxyCodeLine{02131\ \ \ \ \ \{\mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa05aec903fd67851f968aaa606fe2138a}{YH\_ALGO\_EC\_P521}},\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa44153987efd3466070143dbab77f2d70}{YH\_ALGO\_EC\_ECDSA\_SHA512}},\ 66,\ \textcolor{stringliteral}{"{}"{}}\},}
\DoxyCodeLine{02132\ \ \ \ \ \{\mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caad423056b13955068935dc8b3ac0e65d1}{YH\_ALGO\_EC\_K256}},\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa2e5dfe9c79cb0d391d7bf952227268ec}{YH\_ALGO\_EC\_ECDSA\_SHA256}},\ 32,\ \textcolor{stringliteral}{"{}"{}}\},}
\DoxyCodeLine{02133\ \ \ \ \ \{\mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caabd995726d45b6dd2388775db4767c80d}{YH\_ALGO\_EC\_BP256}},\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa2e5dfe9c79cb0d391d7bf952227268ec}{YH\_ALGO\_EC\_ECDSA\_SHA256}},\ 32,\ \textcolor{stringliteral}{"{}"{}}\},}
\DoxyCodeLine{02134\ \ \ \ \ \{\mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa228fd3332b55c60438dfea6a1b09af36}{YH\_ALGO\_EC\_BP384}},\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa657d2b30d884aeeff3c024404132ad69}{YH\_ALGO\_EC\_ECDSA\_SHA384}},\ 48,\ \textcolor{stringliteral}{"{}"{}}\},}
\DoxyCodeLine{02135\ \ \ \ \ \{\mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caab9c1be17b7b3f755346ff8c3cca3ed25}{YH\_ALGO\_EC\_BP512}},\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa44153987efd3466070143dbab77f2d70}{YH\_ALGO\_EC\_ECDSA\_SHA512}},\ 64,\ \textcolor{stringliteral}{"{}"{}}\},}
\DoxyCodeLine{02136\ \ \ \ \ \{\mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caaedcbc07d82b18ca5c21eb3379a6cc010}{YH\_ALGO\_EC\_P224}},\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa14b36e4ff3b90d44ace0aa2b2c65ef48}{YH\_ALGO\_EC\_ECDH}},\ 56,\ \textcolor{stringliteral}{"{}"{}}\},}
\DoxyCodeLine{02137\ \ \ \ \ \{\mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caae4b191baf5c65f9234120080264d129b}{YH\_ALGO\_EC\_P256}},\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa14b36e4ff3b90d44ace0aa2b2c65ef48}{YH\_ALGO\_EC\_ECDH}},\ 64,\ \textcolor{stringliteral}{"{}"{}}\},}
\DoxyCodeLine{02138\ \ \ \ \ \{\mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa31094c17c66e4c365ca3dad353bc8bda}{YH\_ALGO\_EC\_P384}},\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa14b36e4ff3b90d44ace0aa2b2c65ef48}{YH\_ALGO\_EC\_ECDH}},\ 96,\ \textcolor{stringliteral}{"{}"{}}\},}
\DoxyCodeLine{02139\ \ \ \ \ \{\mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa05aec903fd67851f968aaa606fe2138a}{YH\_ALGO\_EC\_P521}},\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa14b36e4ff3b90d44ace0aa2b2c65ef48}{YH\_ALGO\_EC\_ECDH}},\ 132,\ \textcolor{stringliteral}{"{}"{}}\},}
\DoxyCodeLine{02140\ \ \ \ \ \{\mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caad423056b13955068935dc8b3ac0e65d1}{YH\_ALGO\_EC\_K256}},\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa14b36e4ff3b90d44ace0aa2b2c65ef48}{YH\_ALGO\_EC\_ECDH}},\ 64,\ \textcolor{stringliteral}{"{}"{}}\},}
\DoxyCodeLine{02141\ \ \ \ \ \{\mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caabd995726d45b6dd2388775db4767c80d}{YH\_ALGO\_EC\_BP256}},\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa14b36e4ff3b90d44ace0aa2b2c65ef48}{YH\_ALGO\_EC\_ECDH}},\ 64,\ \textcolor{stringliteral}{"{}"{}}\},}
\DoxyCodeLine{02142\ \ \ \ \ \{\mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa228fd3332b55c60438dfea6a1b09af36}{YH\_ALGO\_EC\_BP384}},\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa14b36e4ff3b90d44ace0aa2b2c65ef48}{YH\_ALGO\_EC\_ECDH}},\ 96,\ \textcolor{stringliteral}{"{}"{}}\},}
\DoxyCodeLine{02143\ \ \ \ \ \{\mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caab9c1be17b7b3f755346ff8c3cca3ed25}{YH\_ALGO\_EC\_BP512}},\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa14b36e4ff3b90d44ace0aa2b2c65ef48}{YH\_ALGO\_EC\_ECDH}},\ 128,\ \textcolor{stringliteral}{"{}"{}}\},}
\DoxyCodeLine{02144\ \ \ \ \ \{\mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa68c2c97f16c36f727e41a899d8a7e8bd}{YH\_ALGO\_EC\_ED25519}},\ 0,\ 32,\ \textcolor{stringliteral}{"{}32\ bytes\ data"{}}\},}
\DoxyCodeLine{02145\ \ \ \ \ \{\mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa68c2c97f16c36f727e41a899d8a7e8bd}{YH\_ALGO\_EC\_ED25519}},\ 0,\ 64,\ \textcolor{stringliteral}{"{}64\ bytes\ data"{}}\},}
\DoxyCodeLine{02146\ \ \ \ \ \{\mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa68c2c97f16c36f727e41a899d8a7e8bd}{YH\_ALGO\_EC\_ED25519}},\ 0,\ 128,\ \textcolor{stringliteral}{"{}128\ bytes\ data"{}}\},}
\DoxyCodeLine{02147\ \ \ \ \ \{\mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa68c2c97f16c36f727e41a899d8a7e8bd}{YH\_ALGO\_EC\_ED25519}},\ 0,\ 256,\ \textcolor{stringliteral}{"{}256\ bytes\ data"{}}\},}
\DoxyCodeLine{02148\ \ \ \ \ \{\mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa68c2c97f16c36f727e41a899d8a7e8bd}{YH\_ALGO\_EC\_ED25519}},\ 0,\ 512,\ \textcolor{stringliteral}{"{}512\ bytes\ data"{}}\},}
\DoxyCodeLine{02149\ \ \ \ \ \{\mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa68c2c97f16c36f727e41a899d8a7e8bd}{YH\_ALGO\_EC\_ED25519}},\ 0,\ 1024,\ \textcolor{stringliteral}{"{}1024\ bytes\ data"{}}\},}
\DoxyCodeLine{02150\ \ \ \ \ \{\mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa942e65c8cd0034eebe9a20c2297c7b06}{YH\_ALGO\_HMAC\_SHA1}},\ 0,\ 64,\ \textcolor{stringliteral}{"{}"{}}\},}
\DoxyCodeLine{02151\ \ \ \ \ \{\mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caab0a0e1eb424b61057f159f1e53311f5c}{YH\_ALGO\_HMAC\_SHA256}},\ 0,\ 64,\ \textcolor{stringliteral}{"{}"{}}\},}
\DoxyCodeLine{02152\ \ \ \ \ \{\mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa781e7ca62563917d2129bde8ec53401b}{YH\_ALGO\_HMAC\_SHA384}},\ 0,\ 128,\ \textcolor{stringliteral}{"{}"{}}\},}
\DoxyCodeLine{02153\ \ \ \ \ \{\mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa72d6c7ea77f10e39bbadc8b58d55b9ec}{YH\_ALGO\_HMAC\_SHA512}},\ 0,\ 128,\ \textcolor{stringliteral}{"{}"{}}\},}
\DoxyCodeLine{02154\ \ \ \ \ \{\mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caae22b228e457c9bdccb5a93d81730b1b1}{YH\_ALGO\_AES128\_CCM\_WRAP}},\ 0,\ 0,\ \textcolor{stringliteral}{"{}"{}}\},}
\DoxyCodeLine{02155\ \ \ \ \ \{\mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caab739a1d142dacaf37ba13a73e2d83fab}{YH\_ALGO\_AES192\_CCM\_WRAP}},\ 0,\ 0,\ \textcolor{stringliteral}{"{}"{}}\},}
\DoxyCodeLine{02156\ \ \ \ \ \{\mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa927e2246e5657f946b4da4b71092b022}{YH\_ALGO\_AES256\_CCM\_WRAP}},\ 0,\ 0,\ \textcolor{stringliteral}{"{}"{}}\},}
\DoxyCodeLine{02157\ \ \ \ \ \{\mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa62e7ba4126ae16faeafb28972a4e0959}{YH\_ALGO\_AES128\_YUBICO\_OTP}},\ 0,\ 0,\ \textcolor{stringliteral}{"{}"{}}\},}
\DoxyCodeLine{02158\ \ \ \ \ \{\mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa62dd31db747b4b7f81d9e30877a0b720}{YH\_ALGO\_AES192\_YUBICO\_OTP}},\ 0,\ 0,\ \textcolor{stringliteral}{"{}"{}}\},}
\DoxyCodeLine{02159\ \ \ \ \ \{\mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caad1558532867577d1d77c84f1ae632acd}{YH\_ALGO\_AES256\_YUBICO\_OTP}},\ 0,\ 0,\ \textcolor{stringliteral}{"{}"{}}\},}
\DoxyCodeLine{02160\ \ \ \ \ \{0,\ 0,\ 8,\ \textcolor{stringliteral}{"{}Random\ 8\ bytes"{}}\},}
\DoxyCodeLine{02161\ \ \ \ \ \{0,\ 0,\ 16,\ \textcolor{stringliteral}{"{}Random\ 16\ bytes"{}}\},}
\DoxyCodeLine{02162\ \ \ \ \ \{0,\ 0,\ 32,\ \textcolor{stringliteral}{"{}Random\ 32\ bytes"{}}\},}
\DoxyCodeLine{02163\ \ \ \ \ \{0,\ 0,\ 64,\ \textcolor{stringliteral}{"{}Random\ 64\ bytes"{}}\},}
\DoxyCodeLine{02164\ \ \ \ \ \{0,\ 0,\ 128,\ \textcolor{stringliteral}{"{}Random\ 128\ bytes"{}}\},}
\DoxyCodeLine{02165\ \ \ \ \ \{0,\ 0,\ 256,\ \textcolor{stringliteral}{"{}Random\ 256\ bytes"{}}\},}
\DoxyCodeLine{02166\ \ \ \ \ \{0,\ 0,\ 512,\ \textcolor{stringliteral}{"{}Random\ 512\ bytes"{}}\},}
\DoxyCodeLine{02167\ \ \ \ \ \{0,\ 0,\ 1024,\ \textcolor{stringliteral}{"{}Random\ 1024\ bytes"{}}\},}
\DoxyCodeLine{02168\ \ \ \ \ \{\mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa461952ba18e7fcd792e480f71c853513}{YH\_ALGO\_AES128\_YUBICO\_AUTHENTICATION}},\ 0,\ 0,\ \textcolor{stringliteral}{"{}"{}}\},}
\DoxyCodeLine{02169\ \ \ \};}
\DoxyCodeLine{02170\ }
\DoxyCodeLine{02171\ \ \ \textcolor{comment}{//\ this\ is\ some\ data\ for\ the\ OTP\ benchmark}}
\DoxyCodeLine{02172\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ \mbox{\hyperlink{yubico__otp_8c_a485b73836b7b661b3333a70b309ffba6}{otp\_key}}[]\ =}
\DoxyCodeLine{02173\ \ \ \ \ \textcolor{stringliteral}{"{}\(\backslash\)x00\(\backslash\)x01\(\backslash\)x02\(\backslash\)x03\(\backslash\)x04\(\backslash\)x05\(\backslash\)x06\(\backslash\)x07\(\backslash\)x08\(\backslash\)x09\(\backslash\)x0a\(\backslash\)x0b\(\backslash\)x0c\(\backslash\)x0d\(\backslash\)x0e\(\backslash\)x0f"{}};}
\DoxyCodeLine{02174\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ otp\_id[]\ =\ \textcolor{stringliteral}{"{}\(\backslash\)x01\(\backslash\)x02\(\backslash\)x03\(\backslash\)x04\(\backslash\)x05\(\backslash\)x06"{}};}
\DoxyCodeLine{02175\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ \mbox{\hyperlink{yubico__otp_8c_ab1e1d61db8c48d537faca71988a7c123}{otp}}[]\ =}
\DoxyCodeLine{02176\ \ \ \ \ \textcolor{stringliteral}{"{}\(\backslash\)x2f\(\backslash\)x5d\(\backslash\)x71\(\backslash\)xa4\(\backslash\)x91\(\backslash\)x5d\(\backslash\)xec\(\backslash\)x30\(\backslash\)x4a\(\backslash\)xa1\(\backslash\)x3c\(\backslash\)xcf\(\backslash\)x97\(\backslash\)xbb\(\backslash\)x0d\(\backslash\)xbb"{}};}
\DoxyCodeLine{02177\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ password[]\ =\ \textcolor{stringliteral}{"{}benchmark"{}};}
\DoxyCodeLine{02178\ }
\DoxyCodeLine{02179\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].d\ ==\ 0)\ \{}
\DoxyCodeLine{02180\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Benchmark\ with\ 0\ rounds\ seems\ pointless\(\backslash\)n"{}});}
\DoxyCodeLine{02181\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{02182\ \ \ \}}
\DoxyCodeLine{02183\ }
\DoxyCodeLine{02184\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ \textcolor{keyword}{sizeof}(benchmarks)\ /\ \textcolor{keyword}{sizeof}(benchmarks[0]);\ i++)\ \{}
\DoxyCodeLine{02185\ \ \ \ \ \textcolor{keyword}{struct\ }timeval\ total\ =\ \{0,\ 0\};}
\DoxyCodeLine{02186\ \ \ \ \ \textcolor{keyword}{struct\ }timeval\ avg\ =\ \{0,\ 0\};}
\DoxyCodeLine{02187\ \ \ \ \ \textcolor{keyword}{struct\ }timeval\ max\ =\ \{0,\ 0\};}
\DoxyCodeLine{02188\ \ \ \ \ \textcolor{keyword}{struct\ }timeval\ \mbox{\hyperlink{namespacefc_aa3ea11c18de71ec23b19c3cc571fb8ff}{min}};}
\DoxyCodeLine{02189\ \ \ \ \ \mbox{\hyperlink{structyh__capabilities}{yh\_capabilities}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a08393519edfd7c59fb01fb8db97514b5}{capabilities}}\ =\ \{\{0\}\};}
\DoxyCodeLine{02190\ \ \ \ \ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366}{yh\_rc}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}};}
\DoxyCodeLine{02191\ \ \ \ \ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ algo\_data[1024];}
\DoxyCodeLine{02192\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ algo\_len\ =\ \textcolor{keyword}{sizeof}(algo\_data);}
\DoxyCodeLine{02193\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *str1\ =\ NULL,\ *str2\ =\ \textcolor{stringliteral}{"{}"{}},\ *str3\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{02194\ \ \ \ \ \mbox{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t}}\ \textcolor{keywordtype}{id}\ =\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[2].w;}
\DoxyCodeLine{02195\ \ \ \ \ \textcolor{keywordtype}{char}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a22f45a3cb4f074e609f58ebaeef0ecf9}{label}}[\mbox{\hyperlink{yubihsm_8h_a431f8b753552a8b2f5f980e871b6d019}{YH\_OBJ\_LABEL\_LEN}}\ +\ 1]\ =\ \{0\};}
\DoxyCodeLine{02196\ \ \ \ \ \mbox{\hyperlink{yubihsm_8h_a2fe39512cb4df34b270a67dbb8e13583}{yh\_object\_type}}\ type\ =\ 0;}
\DoxyCodeLine{02197\ \textcolor{preprocessor}{\#ifndef\ \_WIN32}}
\DoxyCodeLine{02198\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ chars\ =\ 0;}
\DoxyCodeLine{02199\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02200\ }
\DoxyCodeLine{02201\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[3].\mbox{\hyperlink{pointer_8h_aeeddce917cf130d62c370b8f216026dd}{a}}\ !=\ 0)\ \{}
\DoxyCodeLine{02202\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[3].\mbox{\hyperlink{pointer_8h_aeeddce917cf130d62c370b8f216026dd}{a}}\ !=\ benchmarks[i].algo\ \&\&\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[3].\mbox{\hyperlink{pointer_8h_aeeddce917cf130d62c370b8f216026dd}{a}}\ !=\ benchmarks[i].algo2)\ \{}
\DoxyCodeLine{02203\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{02204\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02205\ \ \ \ \ \}}
\DoxyCodeLine{02206\ \ \ \ \ \textcolor{keywordflow}{if}\ (benchmarks[i].algo)\ \{}
\DoxyCodeLine{02207\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm_8c_a2a0d369611aa795c62645467062a9acb}{yh\_algo\_to\_string}}(benchmarks[i].algo,\ \&str1);}
\DoxyCodeLine{02208\ \ \ \ \ \}}
\DoxyCodeLine{02209\ \ \ \ \ \textcolor{keywordflow}{if}\ (benchmarks[i].algo2)\ \{}
\DoxyCodeLine{02210\ \ \ \ \ \ \ str2\ =\ \textcolor{stringliteral}{"{}\ "{}};}
\DoxyCodeLine{02211\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm_8c_a2a0d369611aa795c62645467062a9acb}{yh\_algo\_to\_string}}(benchmarks[i].algo2,\ \&str3);}
\DoxyCodeLine{02212\ \ \ \ \ \}}
\DoxyCodeLine{02213\ \ \ \ \ \textcolor{keywordflow}{if}\ (str1)\ \{}
\DoxyCodeLine{02214\ \ \ \ \ \ \ snprintf(\mbox{\hyperlink{yubihsm__pkcs11_8c_a22f45a3cb4f074e609f58ebaeef0ecf9}{label}},\ \mbox{\hyperlink{yubihsm_8h_a431f8b753552a8b2f5f980e871b6d019}{YH\_OBJ\_LABEL\_LEN}},\ \textcolor{stringliteral}{"{}Benchmark:\ \%s\%s\%s"{}},\ str1,\ str2,\ str3);}
\DoxyCodeLine{02215\ \ \ \ \ \}}
\DoxyCodeLine{02216\ }
\DoxyCodeLine{02217\ \ \ \ \ \textcolor{keywordflow}{if}\ (str1)\ \{}
\DoxyCodeLine{02218\ \textcolor{preprocessor}{\#ifndef\ \_WIN32}}
\DoxyCodeLine{02219\ \ \ \ \ \ \ chars\ =}
\DoxyCodeLine{02220\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02221\ \ \ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Doing\ benchmark\ setup\ for\ \%s\%s\%s..."{}},\ str1,\ str2,}
\DoxyCodeLine{02222\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ str3);}
\DoxyCodeLine{02223\ \ \ \ \ \}}
\DoxyCodeLine{02224\ }
\DoxyCodeLine{02225\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm_8c_a0a67155f2a7970ecb52e4f6aac6bbe84}{yh\_is\_rsa}}(benchmarks[i].algo))\ \{}
\DoxyCodeLine{02226\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (benchmarks[i].algo2\ ==\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa18e17370fcf9a829572e57608aff743c}{YH\_ALGO\_RSA\_PKCS1\_SHA256}}\ ||}
\DoxyCodeLine{02227\ \ \ \ \ \ \ \ \ \ \ benchmarks[i].algo2\ ==\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caafc78c2f62fe0a185c38d2644755fde2c}{YH\_ALGO\_RSA\_PKCS1\_SHA384}}\ ||}
\DoxyCodeLine{02228\ \ \ \ \ \ \ \ \ \ \ benchmarks[i].algo2\ ==\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa84e18ba6561d5a834dc8d794504708db}{YH\_ALGO\_RSA\_PKCS1\_SHA512}})\ \{}
\DoxyCodeLine{02229\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm_8c_aab440e1cb671d9ba7a2e7d1243960e42}{yh\_string\_to\_capabilities}}(\textcolor{stringliteral}{"{}sign-\/pkcs"{}},\ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a08393519edfd7c59fb01fb8db97514b5}{capabilities}});}
\DoxyCodeLine{02230\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (benchmarks[i].algo2\ ==\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caac42381f876f5e7190547cf81021451f5}{YH\_ALGO\_RSA\_PSS\_SHA256}}\ ||}
\DoxyCodeLine{02231\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ benchmarks[i].algo2\ ==\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa144083d6414cb33e8543d51e7d361d05}{YH\_ALGO\_RSA\_PSS\_SHA384}}\ ||}
\DoxyCodeLine{02232\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ benchmarks[i].algo2\ ==\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa1d5a50a1a53000cd2b2989c17703e2d1}{YH\_ALGO\_RSA\_PSS\_SHA512}})\ \{}
\DoxyCodeLine{02233\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm_8c_aab440e1cb671d9ba7a2e7d1243960e42}{yh\_string\_to\_capabilities}}(\textcolor{stringliteral}{"{}sign-\/pss"{}},\ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a08393519edfd7c59fb01fb8db97514b5}{capabilities}});}
\DoxyCodeLine{02234\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02235\ \ \ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Unknown\ benchmark\ algorithms\(\backslash\)n"{}});}
\DoxyCodeLine{02236\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{02237\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02238\ \ \ \ \ \ \ type\ =\ \mbox{\hyperlink{yubihsm_8h_a2fe39512cb4df34b270a67dbb8e13583ab71424e16384319d6e6a12f9a3d8ceae}{YH\_ASYMMETRIC\_KEY}};}
\DoxyCodeLine{02239\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_ab1c62ef2643184a8ad44c569c87712d1}{yh\_util\_generate\_rsa\_key}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e,\ \&\textcolor{keywordtype}{id},\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a22f45a3cb4f074e609f58ebaeef0ecf9}{label}},\ 0xffff,}
\DoxyCodeLine{02240\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a08393519edfd7c59fb01fb8db97514b5}{capabilities}},\ benchmarks[i].algo);}
\DoxyCodeLine{02241\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm_8c_a3032a8f45bfad36ed6157b0158dd7921}{yh\_is\_ec}}(benchmarks[i].algo))\ \{}
\DoxyCodeLine{02242\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (benchmarks[i].algo2\ ==\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caae9b7b5598c3839a53e4986dc901be244}{YH\_ALGO\_EC\_ECDSA\_SHA1}}\ ||}
\DoxyCodeLine{02243\ \ \ \ \ \ \ \ \ \ \ benchmarks[i].algo2\ ==\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa2e5dfe9c79cb0d391d7bf952227268ec}{YH\_ALGO\_EC\_ECDSA\_SHA256}}\ ||}
\DoxyCodeLine{02244\ \ \ \ \ \ \ \ \ \ \ benchmarks[i].algo2\ ==\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa657d2b30d884aeeff3c024404132ad69}{YH\_ALGO\_EC\_ECDSA\_SHA384}}\ ||}
\DoxyCodeLine{02245\ \ \ \ \ \ \ \ \ \ \ benchmarks[i].algo2\ ==\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa44153987efd3466070143dbab77f2d70}{YH\_ALGO\_EC\_ECDSA\_SHA512}})\ \{}
\DoxyCodeLine{02246\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm_8c_aab440e1cb671d9ba7a2e7d1243960e42}{yh\_string\_to\_capabilities}}(\textcolor{stringliteral}{"{}sign-\/ecdsa"{}},\ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a08393519edfd7c59fb01fb8db97514b5}{capabilities}});}
\DoxyCodeLine{02247\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (benchmarks[i].algo2\ ==\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa14b36e4ff3b90d44ace0aa2b2c65ef48}{YH\_ALGO\_EC\_ECDH}})\ \{}
\DoxyCodeLine{02248\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm_8c_aab440e1cb671d9ba7a2e7d1243960e42}{yh\_string\_to\_capabilities}}(\textcolor{stringliteral}{"{}derive-\/ecdh"{}},\ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a08393519edfd7c59fb01fb8db97514b5}{capabilities}});}
\DoxyCodeLine{02249\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a2db9bbd57a908c5c454fc6254f57dcff}{yh\_util\_generate\_ec\_key}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e,\ \&\textcolor{keywordtype}{id},\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a22f45a3cb4f074e609f58ebaeef0ecf9}{label}},\ 0xffff,}
\DoxyCodeLine{02250\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a08393519edfd7c59fb01fb8db97514b5}{capabilities}},\ benchmarks[i].algo);}
\DoxyCodeLine{02251\ }
\DoxyCodeLine{02252\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{02253\ \ \ \ \ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ ECDH\ setup\(\backslash\)n"{}});}
\DoxyCodeLine{02254\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{02255\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02256\ \ \ \ \ \ \ \ \ algo\_len-\/-\/;}
\DoxyCodeLine{02257\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =}
\DoxyCodeLine{02258\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm_8c_aa7b8b42156c4bdaf41d8b9758a2fd73f}{yh\_util\_get\_public\_key}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e,\ \textcolor{keywordtype}{id},\ algo\_data\ +\ 1,\ \&algo\_len,\ NULL);}
\DoxyCodeLine{02259\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}}\ ||\ algo\_len\ !=\ benchmarks[i].bytes)\ \{}
\DoxyCodeLine{02260\ \ \ \ \ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ get\ ECDH\ pubkey\ (\%zu)\(\backslash\)n"{}},\ algo\_len);}
\DoxyCodeLine{02261\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{02262\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02263\ \ \ \ \ \ \ \ \ algo\_data[0]\ =\ 0x04;\ \textcolor{comment}{//\ this\ is\ a\ hack\ to\ make\ it\ look\ correct..}}
\DoxyCodeLine{02264\ \ \ \ \ \ \ \ \ algo\_len++;}
\DoxyCodeLine{02265\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_ae736702f9463878db4adfd45b6a597f9}{yh\_util\_delete\_object}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e,\ \textcolor{keywordtype}{id},\ \mbox{\hyperlink{yubihsm_8h_a2fe39512cb4df34b270a67dbb8e13583ab71424e16384319d6e6a12f9a3d8ceae}{YH\_ASYMMETRIC\_KEY}});}
\DoxyCodeLine{02266\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{02267\ \ \ \ \ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ deleting\ temporary\ ec\ key\(\backslash\)n"{}});}
\DoxyCodeLine{02268\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{02269\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02270\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02271\ \ \ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Unknown\ benchmark\ algorithms\(\backslash\)n"{}});}
\DoxyCodeLine{02272\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{02273\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02274\ \ \ \ \ \ \ type\ =\ \mbox{\hyperlink{yubihsm_8h_a2fe39512cb4df34b270a67dbb8e13583ab71424e16384319d6e6a12f9a3d8ceae}{YH\_ASYMMETRIC\_KEY}};}
\DoxyCodeLine{02275\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a2db9bbd57a908c5c454fc6254f57dcff}{yh\_util\_generate\_ec\_key}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e,\ \&\textcolor{keywordtype}{id},\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a22f45a3cb4f074e609f58ebaeef0ecf9}{label}},\ 0xffff,}
\DoxyCodeLine{02276\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a08393519edfd7c59fb01fb8db97514b5}{capabilities}},\ benchmarks[i].algo);}
\DoxyCodeLine{02277\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (benchmarks[i].algo\ ==\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa68c2c97f16c36f727e41a899d8a7e8bd}{YH\_ALGO\_EC\_ED25519}})\ \{}
\DoxyCodeLine{02278\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm_8c_aab440e1cb671d9ba7a2e7d1243960e42}{yh\_string\_to\_capabilities}}(\textcolor{stringliteral}{"{}sign-\/eddsa"{}},\ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a08393519edfd7c59fb01fb8db97514b5}{capabilities}});}
\DoxyCodeLine{02279\ \ \ \ \ \ \ type\ =\ \mbox{\hyperlink{yubihsm_8h_a2fe39512cb4df34b270a67dbb8e13583ab71424e16384319d6e6a12f9a3d8ceae}{YH\_ASYMMETRIC\_KEY}};}
\DoxyCodeLine{02280\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a41f4326fe736e99302442d6a6109edbc}{yh\_util\_generate\_ed\_key}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e,\ \&\textcolor{keywordtype}{id},\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a22f45a3cb4f074e609f58ebaeef0ecf9}{label}},\ 0xffff,}
\DoxyCodeLine{02281\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a08393519edfd7c59fb01fb8db97514b5}{capabilities}},\ benchmarks[i].algo);}
\DoxyCodeLine{02282\ \ \ \ \ \ \ str2\ =\ \textcolor{stringliteral}{"{}\ "{}};}
\DoxyCodeLine{02283\ \ \ \ \ \ \ str3\ =\ benchmarks[i].special;}
\DoxyCodeLine{02284\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm_8c_acb19de78e7d1aed72abbed5c74c676bc}{yh\_is\_hmac}}(benchmarks[i].algo))\ \{}
\DoxyCodeLine{02285\ \ \ \ \ \ \ type\ =\ \mbox{\hyperlink{yubihsm_8h_a2fe39512cb4df34b270a67dbb8e13583a708d85f80fc33743ac26a7c3e43464a9}{YH\_HMAC\_KEY}};}
\DoxyCodeLine{02286\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm_8c_aab440e1cb671d9ba7a2e7d1243960e42}{yh\_string\_to\_capabilities}}(\textcolor{stringliteral}{"{}sign-\/hmac"{}},\ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a08393519edfd7c59fb01fb8db97514b5}{capabilities}});}
\DoxyCodeLine{02287\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a1eac22853548b7ceab92550c22233b18}{yh\_util\_generate\_hmac\_key}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e,\ \&\textcolor{keywordtype}{id},\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a22f45a3cb4f074e609f58ebaeef0ecf9}{label}},\ 0xffff,}
\DoxyCodeLine{02288\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a08393519edfd7c59fb01fb8db97514b5}{capabilities}},\ benchmarks[i].algo);}
\DoxyCodeLine{02289\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (benchmarks[i].algo\ ==\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caae22b228e457c9bdccb5a93d81730b1b1}{YH\_ALGO\_AES128\_CCM\_WRAP}}\ ||}
\DoxyCodeLine{02290\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ benchmarks[i].algo\ ==\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caab739a1d142dacaf37ba13a73e2d83fab}{YH\_ALGO\_AES192\_CCM\_WRAP}}\ ||}
\DoxyCodeLine{02291\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ benchmarks[i].algo\ ==\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa927e2246e5657f946b4da4b71092b022}{YH\_ALGO\_AES256\_CCM\_WRAP}})\ \{}
\DoxyCodeLine{02292\ \ \ \ \ \ \ type\ =\ \mbox{\hyperlink{yubihsm_8h_a2fe39512cb4df34b270a67dbb8e13583a16f0118db1dac3d0732e7d66630e1dba}{YH\_WRAP\_KEY}};}
\DoxyCodeLine{02293\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm_8c_aab440e1cb671d9ba7a2e7d1243960e42}{yh\_string\_to\_capabilities}}(\textcolor{stringliteral}{"{}export-\/wrapped,exportable-\/under-\/wrap"{}},}
\DoxyCodeLine{02294\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a08393519edfd7c59fb01fb8db97514b5}{capabilities}});}
\DoxyCodeLine{02295\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =}
\DoxyCodeLine{02296\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm_8c_a1f749a696792e7911844629e056d9c15}{yh\_util\_generate\_wrap\_key}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e,\ \&\textcolor{keywordtype}{id},\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a22f45a3cb4f074e609f58ebaeef0ecf9}{label}},\ 0xffff,\ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a08393519edfd7c59fb01fb8db97514b5}{capabilities}},}
\DoxyCodeLine{02297\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ benchmarks[i].algo,\ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a08393519edfd7c59fb01fb8db97514b5}{capabilities}});}
\DoxyCodeLine{02298\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (benchmarks[i].algo\ ==\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa62e7ba4126ae16faeafb28972a4e0959}{YH\_ALGO\_AES128\_YUBICO\_OTP}}\ ||}
\DoxyCodeLine{02299\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ benchmarks[i].algo\ ==\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa62dd31db747b4b7f81d9e30877a0b720}{YH\_ALGO\_AES192\_YUBICO\_OTP}}\ ||}
\DoxyCodeLine{02300\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ benchmarks[i].algo\ ==\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caad1558532867577d1d77c84f1ae632acd}{YH\_ALGO\_AES256\_YUBICO\_OTP}})\ \{}
\DoxyCodeLine{02301\ \ \ \ \ \ \ type\ =\ \mbox{\hyperlink{yubihsm_8h_a2fe39512cb4df34b270a67dbb8e13583a02c5f683fde147de6a9e1043f971f5f0}{YH\_OTP\_AEAD\_KEY}};}
\DoxyCodeLine{02302\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm_8c_aab440e1cb671d9ba7a2e7d1243960e42}{yh\_string\_to\_capabilities}}(\textcolor{stringliteral}{"{}decrypt-\/otp,create-\/otp-\/aead"{}},\ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a08393519edfd7c59fb01fb8db97514b5}{capabilities}});}
\DoxyCodeLine{02303\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a9e130d225a8dc003d7a7c0ce4b8ea5e4}{yh\_util\_generate\_otp\_aead\_key}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e,\ \&\textcolor{keywordtype}{id},\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a22f45a3cb4f074e609f58ebaeef0ecf9}{label}},\ 0xffff,}
\DoxyCodeLine{02304\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a08393519edfd7c59fb01fb8db97514b5}{capabilities}},\ benchmarks[i].algo,}
\DoxyCodeLine{02305\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x12345678);}
\DoxyCodeLine{02306\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ ==\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{02307\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a82d295a02d9eb628f6dea4b4c01fdec4}{yh\_util\_create\_otp\_aead}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e,\ \textcolor{keywordtype}{id},\ \mbox{\hyperlink{yubico__otp_8c_a485b73836b7b661b3333a70b309ffba6}{otp\_key}},\ otp\_id,\ algo\_data,}
\DoxyCodeLine{02308\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&algo\_len);}
\DoxyCodeLine{02309\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02310\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (strncmp(benchmarks[i].special,\ \textcolor{stringliteral}{"{}Random\ "{}},\ 7)\ ==\ 0)\ \{}
\DoxyCodeLine{02311\ \ \ \ \ \ \ str1\ =\ benchmarks[i].special;}
\DoxyCodeLine{02312\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (benchmarks[i].algo\ ==\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa461952ba18e7fcd792e480f71c853513}{YH\_ALGO\_AES128\_YUBICO\_AUTHENTICATION}})\ \{}
\DoxyCodeLine{02313\ \ \ \ \ \ \ type\ =\ \mbox{\hyperlink{yubihsm_8h_a2fe39512cb4df34b270a67dbb8e13583acee44b775b3c5b6157f0732699935074}{YH\_AUTHENTICATION\_KEY}};}
\DoxyCodeLine{02314\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm_8c_aab440e1cb671d9ba7a2e7d1243960e42}{yh\_string\_to\_capabilities}}(\textcolor{stringliteral}{"{}"{}},\ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a08393519edfd7c59fb01fb8db97514b5}{capabilities}});}
\DoxyCodeLine{02315\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =}
\DoxyCodeLine{02316\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm_8c_a80b4c4caeb9c768737c2dbf46d9352e4}{yh\_util\_import\_authentication\_key\_derived}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e,\ \&\textcolor{keywordtype}{id},\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a22f45a3cb4f074e609f58ebaeef0ecf9}{label}},\ 0xffff,}
\DoxyCodeLine{02317\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a08393519edfd7c59fb01fb8db97514b5}{capabilities}},\ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a08393519edfd7c59fb01fb8db97514b5}{capabilities}},}
\DoxyCodeLine{02318\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ password,\ \textcolor{keyword}{sizeof}(password));}
\DoxyCodeLine{02319\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02320\ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Unknown\ benchmark\ algorithms\(\backslash\)n"{}});}
\DoxyCodeLine{02321\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{02322\ \ \ \ \ \}}
\DoxyCodeLine{02323\ }
\DoxyCodeLine{02324\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{02325\ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ benchmark\ setup\ for\ \%s\%s\%s\(\backslash\)n"{}},\ str1,\ str2,\ str3);}
\DoxyCodeLine{02326\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{02327\ \ \ \ \ \}}
\DoxyCodeLine{02328\ }
\DoxyCodeLine{02329\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_adc4bd59a60361844aa0e852efa210105}{memset}}(\&min,\ 0x7f,\ \textcolor{keyword}{sizeof}(min));}
\DoxyCodeLine{02330\ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a538d097420e725c4dad63c3caa9e55bd}{j}}\ =\ 0;\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a538d097420e725c4dad63c3caa9e55bd}{j}}\ <\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].d;\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a538d097420e725c4dad63c3caa9e55bd}{j}}++)\ \{}
\DoxyCodeLine{02331\ \ \ \ \ \ \ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ data[1024];}
\DoxyCodeLine{02332\ \ \ \ \ \ \ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ out[1024];}
\DoxyCodeLine{02333\ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a565e4b6f63fecad4c290b50ee6684ee3}{out\_len}}\ =\ \textcolor{keyword}{sizeof}(out);}
\DoxyCodeLine{02334\ \ \ \ \ \ \ \textcolor{keyword}{struct\ }timeval\ before,\ after,\ result;}
\DoxyCodeLine{02335\ }
\DoxyCodeLine{02336\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_adc4bd59a60361844aa0e852efa210105}{memset}}(data,\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a538d097420e725c4dad63c3caa9e55bd}{j}},\ \textcolor{keyword}{sizeof}(data));}
\DoxyCodeLine{02337\ \ \ \ \ \ \ gettimeofday(\&before,\ NULL);}
\DoxyCodeLine{02338\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm_8c_a0a67155f2a7970ecb52e4f6aac6bbe84}{yh\_is\_rsa}}(benchmarks[i].algo)\ \&\&}
\DoxyCodeLine{02339\ \ \ \ \ \ \ \ \ \ \ (benchmarks[i].algo2\ ==\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa18e17370fcf9a829572e57608aff743c}{YH\_ALGO\_RSA\_PKCS1\_SHA256}}\ ||}
\DoxyCodeLine{02340\ \ \ \ \ \ \ \ \ \ \ \ benchmarks[i].algo2\ ==\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caafc78c2f62fe0a185c38d2644755fde2c}{YH\_ALGO\_RSA\_PKCS1\_SHA384}}\ ||}
\DoxyCodeLine{02341\ \ \ \ \ \ \ \ \ \ \ \ benchmarks[i].algo2\ ==\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa84e18ba6561d5a834dc8d794504708db}{YH\_ALGO\_RSA\_PKCS1\_SHA512}}))\ \{}
\DoxyCodeLine{02342\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_aa0a7644b7b368d6aaf8b4aff5e3d19b8}{yh\_util\_sign\_pkcs1v1\_5}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e,\ \textcolor{keywordtype}{id},\ \textcolor{keyword}{true},\ data,}
\DoxyCodeLine{02343\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ benchmarks[i].bytes,\ out,\ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a565e4b6f63fecad4c290b50ee6684ee3}{out\_len}});}
\DoxyCodeLine{02344\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm_8c_a0a67155f2a7970ecb52e4f6aac6bbe84}{yh\_is\_rsa}}(benchmarks[i].algo)\ \&\&}
\DoxyCodeLine{02345\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (benchmarks[i].algo2\ ==\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caac42381f876f5e7190547cf81021451f5}{YH\_ALGO\_RSA\_PSS\_SHA256}}\ ||}
\DoxyCodeLine{02346\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ benchmarks[i].algo2\ ==\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa144083d6414cb33e8543d51e7d361d05}{YH\_ALGO\_RSA\_PSS\_SHA384}}\ ||}
\DoxyCodeLine{02347\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ benchmarks[i].algo2\ ==\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa1d5a50a1a53000cd2b2989c17703e2d1}{YH\_ALGO\_RSA\_PSS\_SHA512}}))\ \{}
\DoxyCodeLine{02348\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =}
\DoxyCodeLine{02349\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm_8c_a944e6f31487857709f032598fd43fef5}{yh\_util\_sign\_pss}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e,\ \textcolor{keywordtype}{id},\ data,\ benchmarks[i].bytes,\ out,}
\DoxyCodeLine{02350\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a565e4b6f63fecad4c290b50ee6684ee3}{out\_len}},\ benchmarks[i].bytes,\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caae1ab21f2df42a56bdc8ff046ed14797a}{YH\_ALGO\_MGF1\_SHA1}});}
\DoxyCodeLine{02351\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm_8c_a3032a8f45bfad36ed6157b0158dd7921}{yh\_is\_ec}}(benchmarks[i].algo)\ \&\&}
\DoxyCodeLine{02352\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (benchmarks[i].algo2\ ==\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caae9b7b5598c3839a53e4986dc901be244}{YH\_ALGO\_EC\_ECDSA\_SHA1}}\ ||}
\DoxyCodeLine{02353\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ benchmarks[i].algo2\ ==\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa2e5dfe9c79cb0d391d7bf952227268ec}{YH\_ALGO\_EC\_ECDSA\_SHA256}}\ ||}
\DoxyCodeLine{02354\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ benchmarks[i].algo2\ ==\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa657d2b30d884aeeff3c024404132ad69}{YH\_ALGO\_EC\_ECDSA\_SHA384}}\ ||}
\DoxyCodeLine{02355\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ benchmarks[i].algo2\ ==\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa44153987efd3466070143dbab77f2d70}{YH\_ALGO\_EC\_ECDSA\_SHA512}}))\ \{}
\DoxyCodeLine{02356\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a5121c90d3bd745afd8264fef2ef39ace}{yh\_util\_sign\_ecdsa}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e,\ \textcolor{keywordtype}{id},\ data,\ benchmarks[i].bytes,\ out,}
\DoxyCodeLine{02357\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a565e4b6f63fecad4c290b50ee6684ee3}{out\_len}});}
\DoxyCodeLine{02358\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm_8c_a3032a8f45bfad36ed6157b0158dd7921}{yh\_is\_ec}}(benchmarks[i].algo)\ \&\&}
\DoxyCodeLine{02359\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ benchmarks[i].algo2\ ==\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa14b36e4ff3b90d44ace0aa2b2c65ef48}{YH\_ALGO\_EC\_ECDH}})\ \{}
\DoxyCodeLine{02360\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a2900aee87732f9ec017bd1662bcef7e9}{yh\_util\_derive\_ecdh}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e,\ \textcolor{keywordtype}{id},\ algo\_data,\ algo\_len,\ out,}
\DoxyCodeLine{02361\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a565e4b6f63fecad4c290b50ee6684ee3}{out\_len}});}
\DoxyCodeLine{02362\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (benchmarks[i].algo\ ==\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa68c2c97f16c36f727e41a899d8a7e8bd}{YH\_ALGO\_EC\_ED25519}})\ \{}
\DoxyCodeLine{02363\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a690a5585de21ce82495e139ec1dfdf9d}{yh\_util\_sign\_eddsa}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e,\ \textcolor{keywordtype}{id},\ data,\ benchmarks[i].bytes,\ out,}
\DoxyCodeLine{02364\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a565e4b6f63fecad4c290b50ee6684ee3}{out\_len}});}
\DoxyCodeLine{02365\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm_8c_acb19de78e7d1aed72abbed5c74c676bc}{yh\_is\_hmac}}(benchmarks[i].algo))\ \{}
\DoxyCodeLine{02366\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a9000d43fe8cf7313b319f316521eb0c4}{yh\_util\_sign\_hmac}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e,\ \textcolor{keywordtype}{id},\ data,\ benchmarks[i].bytes,\ out,}
\DoxyCodeLine{02367\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a565e4b6f63fecad4c290b50ee6684ee3}{out\_len}});}
\DoxyCodeLine{02368\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (benchmarks[i].algo\ ==\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caae22b228e457c9bdccb5a93d81730b1b1}{YH\_ALGO\_AES128\_CCM\_WRAP}}\ ||}
\DoxyCodeLine{02369\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ benchmarks[i].algo\ ==\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caab739a1d142dacaf37ba13a73e2d83fab}{YH\_ALGO\_AES192\_CCM\_WRAP}}\ ||}
\DoxyCodeLine{02370\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ benchmarks[i].algo\ ==\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa927e2246e5657f946b4da4b71092b022}{YH\_ALGO\_AES256\_CCM\_WRAP}})\ \{}
\DoxyCodeLine{02371\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =}
\DoxyCodeLine{02372\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm_8c_aa3f473e6dbb9188ad0269b40921c4f5f}{yh\_util\_export\_wrapped}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e,\ \textcolor{keywordtype}{id},\ \mbox{\hyperlink{yubihsm_8h_a2fe39512cb4df34b270a67dbb8e13583a16f0118db1dac3d0732e7d66630e1dba}{YH\_WRAP\_KEY}},\ \textcolor{keywordtype}{id},\ out,\ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a565e4b6f63fecad4c290b50ee6684ee3}{out\_len}});}
\DoxyCodeLine{02373\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (benchmarks[i].algo\ ==\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa62e7ba4126ae16faeafb28972a4e0959}{YH\_ALGO\_AES128\_YUBICO\_OTP}}\ ||}
\DoxyCodeLine{02374\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ benchmarks[i].algo\ ==\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa62dd31db747b4b7f81d9e30877a0b720}{YH\_ALGO\_AES192\_YUBICO\_OTP}}\ ||}
\DoxyCodeLine{02375\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ benchmarks[i].algo\ ==\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caad1558532867577d1d77c84f1ae632acd}{YH\_ALGO\_AES256\_YUBICO\_OTP}})\ \{}
\DoxyCodeLine{02376\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a3677afe2209a1cae31f70a304e260e28}{yh\_util\_decrypt\_otp}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e,\ \textcolor{keywordtype}{id},\ algo\_data,\ algo\_len,\ \mbox{\hyperlink{yubico__otp_8c_ab1e1d61db8c48d537faca71988a7c123}{otp}},\ NULL,}
\DoxyCodeLine{02377\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ NULL,\ NULL,\ NULL);}
\DoxyCodeLine{02378\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (strncmp(benchmarks[i].special,\ \textcolor{stringliteral}{"{}Random\ "{}},\ 7)\ ==\ 0)\ \{}
\DoxyCodeLine{02379\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_af1bc8ed34687d83701eb3cc673ad4b96}{yh\_util\_get\_pseudo\_random}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e,\ benchmarks[i].bytes,\ out,}
\DoxyCodeLine{02380\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a565e4b6f63fecad4c290b50ee6684ee3}{out\_len}});}
\DoxyCodeLine{02381\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (benchmarks[i].algo\ ==\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa461952ba18e7fcd792e480f71c853513}{YH\_ALGO\_AES128\_YUBICO\_AUTHENTICATION}})\ \{}
\DoxyCodeLine{02382\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structyh__session}{yh\_session}}\ *\mbox{\hyperlink{yubihsm__shell__tests_8c_a06390486523e3578750748be3bea88d4}{ses}}\ =\ NULL;}
\DoxyCodeLine{02383\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a3be331dcf8907ff3569e4dc230e1c615}{yh\_create\_session\_derived}}(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a8c52c1a89cd4334a0225a1fbfba9a930}{connector}},\ \textcolor{keywordtype}{id},\ password,}
\DoxyCodeLine{02384\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{sizeof}(password),\ \textcolor{keyword}{false},\ \&\mbox{\hyperlink{yubihsm__shell__tests_8c_a06390486523e3578750748be3bea88d4}{ses}});}
\DoxyCodeLine{02385\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ ==\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{02386\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a77870209747d5ccd90f9da3aae2bdfa8}{yh\_authenticate\_session}}(\mbox{\hyperlink{yubihsm__shell__tests_8c_a06390486523e3578750748be3bea88d4}{ses}});}
\DoxyCodeLine{02387\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02388\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ ==\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{02389\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a61ab8dbab67b1cceb49cd306f8c3f4b1}{yh\_util\_close\_session}}(\mbox{\hyperlink{yubihsm__shell__tests_8c_a06390486523e3578750748be3bea88d4}{ses}});}
\DoxyCodeLine{02390\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02391\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02392\ \ \ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Unknown\ benchmark\ algorithm\(\backslash\)n"{}});}
\DoxyCodeLine{02393\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{02394\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02395\ }
\DoxyCodeLine{02396\ \ \ \ \ \ \ gettimeofday(\&after,\ NULL);}
\DoxyCodeLine{02397\ }
\DoxyCodeLine{02398\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{02399\ \ \ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ running\ benchmark\ \%u\ for\ \%s\%s\%s\(\backslash\)n"{}},\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a538d097420e725c4dad63c3caa9e55bd}{j}},\ str1,}
\DoxyCodeLine{02400\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ str2,\ str3);}
\DoxyCodeLine{02401\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{02402\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02403\ }
\DoxyCodeLine{02404\ \ \ \ \ \ \ time\_elapsed(\&after,\ \&before,\ \&result);}
\DoxyCodeLine{02405\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (time\_less(\&result,\ \&min))\ \{}
\DoxyCodeLine{02406\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacefc_aa3ea11c18de71ec23b19c3cc571fb8ff}{min}}\ =\ result;}
\DoxyCodeLine{02407\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02408\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (time\_less(\&max,\ \&result))\ \{}
\DoxyCodeLine{02409\ \ \ \ \ \ \ \ \ max\ =\ result;}
\DoxyCodeLine{02410\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02411\ \ \ \ \ \ \ time\_add(\&result,\ \&total,\ \&total);}
\DoxyCodeLine{02412\ \ \ \ \ \ \ time\_average(\&total,\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a538d097420e725c4dad63c3caa9e55bd}{j}}\ +\ 1,\ \&avg);}
\DoxyCodeLine{02413\ \textcolor{preprocessor}{\#ifndef\ \_WIN32}}
\DoxyCodeLine{02414\ \ \ \ \ \ \ \textcolor{keyword}{struct\ }winsize\ w;}
\DoxyCodeLine{02415\ \ \ \ \ \ \ ioctl(fileno(stderr),\ TIOCGWINSZ,\ \&w);}
\DoxyCodeLine{02416\ }
\DoxyCodeLine{02417\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (chars\ >\ w.ws\_col)\ \{}
\DoxyCodeLine{02418\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ move\ the\ cursor\ up\ and\ to\ column\ 1}}
\DoxyCodeLine{02419\ \ \ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}\(\backslash\)33[\%zuF"{}},\ chars\ /\ w.ws\_col);}
\DoxyCodeLine{02420\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02421\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ if\ we're\ still\ on\ same\ line,\ just\ move\ to\ column\ 1}}
\DoxyCodeLine{02422\ \ \ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}\(\backslash\)33[1G"{}});}
\DoxyCodeLine{02423\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02424\ \ \ \ \ \ \ \textcolor{comment}{//\ clear\ display\ from\ cursor}}
\DoxyCodeLine{02425\ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}\(\backslash\)33[J"{}});}
\DoxyCodeLine{02426\ \ \ \ \ \ \ chars\ =\ fprintf(stderr,}
\DoxyCodeLine{02427\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\%s\%s\%s\ (\%u/\%d\ times)\ total:\ \%ld.\%06ld\ avg:\ \%ld.\%06ld\ "{}}}
\DoxyCodeLine{02428\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}min:\ \%ld.\%06ld\ max:\ \%ld.\%06ld\ tps:\ \%.06f"{}},}
\DoxyCodeLine{02429\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ str1,\ str2,\ str3,\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a538d097420e725c4dad63c3caa9e55bd}{j}}\ +\ 1,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].w,\ total.tv\_sec,}
\DoxyCodeLine{02430\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{keywordtype}{long})\ total.tv\_usec,\ avg.tv\_sec,\ (\textcolor{keywordtype}{long})\ avg.tv\_usec,}
\DoxyCodeLine{02431\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacefc_aa3ea11c18de71ec23b19c3cc571fb8ff}{min}}.tv\_sec,\ (\textcolor{keywordtype}{long})\ \mbox{\hyperlink{namespacefc_aa3ea11c18de71ec23b19c3cc571fb8ff}{min}}.tv\_usec,\ max.tv\_sec,}
\DoxyCodeLine{02432\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{keywordtype}{long})\ max.tv\_usec,\ time\_tps(\&total,\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a538d097420e725c4dad63c3caa9e55bd}{j}}\ +\ 1));}
\DoxyCodeLine{02433\ \ \ \ \ \ \ fflush(stderr);}
\DoxyCodeLine{02434\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02435\ \ \ \ \ \}}
\DoxyCodeLine{02436\ \textcolor{preprocessor}{\#ifdef\ \_WIN32}}
\DoxyCodeLine{02437\ \ \ \ \ fprintf(stderr,}
\DoxyCodeLine{02438\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\%s\%s\%s\ (\%d\ times)\ total:\ \%ld.\%06ld\ avg:\ \%ld.\%06ld\ "{}}}
\DoxyCodeLine{02439\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}min:\ \%ld.\%06ld\ max:\ \%ld.\%06ld\ tps:\ \%.06f"{}},}
\DoxyCodeLine{02440\ \ \ \ \ \ \ \ \ \ \ \ \ str1,\ str2,\ str3,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].w,\ total.tv\_sec,\ (\textcolor{keywordtype}{long})\ total.tv\_usec,}
\DoxyCodeLine{02441\ \ \ \ \ \ \ \ \ \ \ \ \ avg.tv\_sec,\ (\textcolor{keywordtype}{long})\ avg.tv\_usec,\ \mbox{\hyperlink{namespacefc_aa3ea11c18de71ec23b19c3cc571fb8ff}{min}}.tv\_sec,\ (\textcolor{keywordtype}{long})\ \mbox{\hyperlink{namespacefc_aa3ea11c18de71ec23b19c3cc571fb8ff}{min}}.tv\_usec,}
\DoxyCodeLine{02442\ \ \ \ \ \ \ \ \ \ \ \ \ max.tv\_sec,\ (\textcolor{keywordtype}{long})\ max.tv\_usec,\ time\_tps(\&total,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].w));}
\DoxyCodeLine{02443\ }
\DoxyCodeLine{02444\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02445\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{02446\ \ \ \ \ \textcolor{keywordflow}{if}\ (type\ !=\ 0)\ \{}
\DoxyCodeLine{02447\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm_8c_ae736702f9463878db4adfd45b6a597f9}{yh\_util\_delete\_object}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e,\ \textcolor{keywordtype}{id},\ type);}
\DoxyCodeLine{02448\ \ \ \ \ \}}
\DoxyCodeLine{02449\ \ \ \}}
\DoxyCodeLine{02450\ }
\DoxyCodeLine{02451\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{02452\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=550pt]{commands_8c_ae2e50929acc6085cd395d0bd4ddb02db_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_ae2e50929acc6085cd395d0bd4ddb02db_icgraph}
\end{center}
\end{figure}
\Hypertarget{commands_8c_a1d821476693df49671598a98e7d6dbca}\index{commands.c@{commands.c}!yh\_com\_blink@{yh\_com\_blink}}
\index{yh\_com\_blink@{yh\_com\_blink}!commands.c@{commands.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_blink()}{yh\_com\_blink()}}
{\footnotesize\ttfamily \label{commands_8c_a1d821476693df49671598a98e7d6dbca} 
int yh\+\_\+com\+\_\+blink (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{commands_8c_source_l00159}{159}} of file \mbox{\hyperlink{commands_8c_source}{commands.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00159\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00160\ }
\DoxyCodeLine{00161\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(fmt);}
\DoxyCodeLine{00162\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(ctx);}
\DoxyCodeLine{00163\ }
\DoxyCodeLine{00164\ \ \ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366}{yh\_rc}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_ad112fe09ee88d595333fa87e8059717b}{yh\_util\_blink\_device}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].b);}
\DoxyCodeLine{00165\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{00166\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ blink\ the\ device:\ \%s\(\backslash\)n"{}},\ \mbox{\hyperlink{lib_2error_8c_a238eedb1e27dbff2a0ab9a3932eb3f8b}{yh\_strerror}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}));}
\DoxyCodeLine{00167\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{00168\ \ \ \}}
\DoxyCodeLine{00169\ }
\DoxyCodeLine{00170\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00171\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_a1d821476693df49671598a98e7d6dbca_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_a1d821476693df49671598a98e7d6dbca_icgraph}
\end{center}
\end{figure}
\Hypertarget{commands_8c_a0691ab03bd0e40402b2ad5f9a378a541}\index{commands.c@{commands.c}!yh\_com\_change\_authentication\_key@{yh\_com\_change\_authentication\_key}}
\index{yh\_com\_change\_authentication\_key@{yh\_com\_change\_authentication\_key}!commands.c@{commands.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_change\_authentication\_key()}{yh\_com\_change\_authentication\_key()}}
{\footnotesize\ttfamily \label{commands_8c_a0691ab03bd0e40402b2ad5f9a378a541} 
int yh\+\_\+com\+\_\+change\+\_\+authentication\+\_\+key (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{commands_8c_source_l02767}{2767}} of file \mbox{\hyperlink{commands_8c_source}{commands.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02768\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02769\ }
\DoxyCodeLine{02770\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(fmt);}
\DoxyCodeLine{02771\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(ctx);}
\DoxyCodeLine{02772\ }
\DoxyCodeLine{02773\ \ \ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366}{yh\_rc}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a8761bd8bcffcee4af737bda255ce5e53}{yh\_util\_change\_authentication\_key\_derived}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e,\ \&\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].w,}
\DoxyCodeLine{02774\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[2].x,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[2].\mbox{\hyperlink{yubihsm__pkcs11_8c_a7360b55975153b822efc5217b7734e6a}{len}});}
\DoxyCodeLine{02775\ \ \ \mbox{\hyperlink{insecure__memzero_8h_a0794f9275fd1036ecba6ff0a901a320b}{insecure\_memzero}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[2].x,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[2].\mbox{\hyperlink{yubihsm__pkcs11_8c_a7360b55975153b822efc5217b7734e6a}{len}});}
\DoxyCodeLine{02776\ }
\DoxyCodeLine{02777\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{02778\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ change\ authentication\ key:\ \%s\(\backslash\)n"{}},}
\DoxyCodeLine{02779\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{lib_2error_8c_a238eedb1e27dbff2a0ab9a3932eb3f8b}{yh\_strerror}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}));}
\DoxyCodeLine{02780\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{02781\ \ \ \}}
\DoxyCodeLine{02782\ }
\DoxyCodeLine{02783\ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Changed\ Authentication\ key\ 0x\%04x\(\backslash\)n"{}},\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].w);}
\DoxyCodeLine{02784\ }
\DoxyCodeLine{02785\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{02786\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_a0691ab03bd0e40402b2ad5f9a378a541_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_a0691ab03bd0e40402b2ad5f9a378a541_icgraph}
\end{center}
\end{figure}
\Hypertarget{commands_8c_aabb06b0c16a19b4b22478cb753d8f599}\index{commands.c@{commands.c}!yh\_com\_close\_session@{yh\_com\_close\_session}}
\index{yh\_com\_close\_session@{yh\_com\_close\_session}!commands.c@{commands.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_close\_session()}{yh\_com\_close\_session()}}
{\footnotesize\ttfamily \label{commands_8c_aabb06b0c16a19b4b22478cb753d8f599} 
int yh\+\_\+com\+\_\+close\+\_\+session (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{commands_8c_source_l00176}{176}} of file \mbox{\hyperlink{commands_8c_source}{commands.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00176\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00177\ }
\DoxyCodeLine{00178\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(fmt);}
\DoxyCodeLine{00179\ \ \ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ session\_id\ =\ 0;}
\DoxyCodeLine{00180\ }
\DoxyCodeLine{00181\ \ \ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366}{yh\_rc}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_aeabf472faf1ba8d963b39866e04df6b0}{yh\_get\_session\_id}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e,\ \&session\_id);}
\DoxyCodeLine{00182\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{00183\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ get\ session\ id:\ \%s\(\backslash\)n"{}},\ \mbox{\hyperlink{lib_2error_8c_a238eedb1e27dbff2a0ab9a3932eb3f8b}{yh\_strerror}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}));}
\DoxyCodeLine{00184\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{00185\ \ \ \}}
\DoxyCodeLine{00186\ }
\DoxyCodeLine{00187\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a61ab8dbab67b1cceb49cd306f8c3f4b1}{yh\_util\_close\_session}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e);}
\DoxyCodeLine{00188\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{00189\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ close\ session:\ \%s\(\backslash\)n"{}},\ \mbox{\hyperlink{lib_2error_8c_a238eedb1e27dbff2a0ab9a3932eb3f8b}{yh\_strerror}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}));}
\DoxyCodeLine{00190\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{00191\ \ \ \}}
\DoxyCodeLine{00192\ }
\DoxyCodeLine{00193\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a1a35f8ae5a739848408633a514e41b2d}{yh\_destroy\_session}}(\&\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e);}
\DoxyCodeLine{00194\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{00195\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ destroy\ session:\ \%s\(\backslash\)n"{}},\ \mbox{\hyperlink{lib_2error_8c_a238eedb1e27dbff2a0ab9a3932eb3f8b}{yh\_strerror}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}));}
\DoxyCodeLine{00196\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{00197\ \ \ \}}
\DoxyCodeLine{00198\ }
\DoxyCodeLine{00199\ \ \ ctx-\/>\mbox{\hyperlink{structyubihsm__context_a7a959752fa285fb4a7a75921bbfa00fe}{sessions}}[session\_id]\ =\ NULL;}
\DoxyCodeLine{00200\ }
\DoxyCodeLine{00201\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00202\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_aabb06b0c16a19b4b22478cb753d8f599_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_aabb06b0c16a19b4b22478cb753d8f599_icgraph}
\end{center}
\end{figure}
\Hypertarget{commands_8c_a9155cc4306ad97e58a03ead18637f33b}\index{commands.c@{commands.c}!yh\_com\_connect@{yh\_com\_connect}}
\index{yh\_com\_connect@{yh\_com\_connect}!commands.c@{commands.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_connect()}{yh\_com\_connect()}}
{\footnotesize\ttfamily \label{commands_8c_a9155cc4306ad97e58a03ead18637f33b} 
int yh\+\_\+com\+\_\+connect (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{commands_8c_source_l00206}{206}} of file \mbox{\hyperlink{commands_8c_source}{commands.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00206\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00207\ }
\DoxyCodeLine{00208\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}});}
\DoxyCodeLine{00209\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(fmt);}
\DoxyCodeLine{00210\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}}\ =\ -\/1;}
\DoxyCodeLine{00211\ }
\DoxyCodeLine{00212\ \ \ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366}{yh\_rc}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}};}
\DoxyCodeLine{00213\ \ \ \mbox{\hyperlink{structyh__connector}{yh\_connector}}\ **connectors\ =\ calloc(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a260f9000b86a557d5d758d498f8e0f51}{n\_connectors}},\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structyh__connector}{yh\_connector}}\ *));}
\DoxyCodeLine{00214\ \ \ \textcolor{keywordflow}{if}\ (connectors\ ==\ NULL)\ \{}
\DoxyCodeLine{00215\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ allocating\ memory\(\backslash\)n"{}});}
\DoxyCodeLine{00216\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{00217\ \ \ \}}
\DoxyCodeLine{00218\ }
\DoxyCodeLine{00219\ \ \ \textcolor{keywordtype}{int}\ idx\ =\ -\/1;}
\DoxyCodeLine{00220\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ ctx-\/>\mbox{\hyperlink{structyubihsm__context_a260f9000b86a557d5d758d498f8e0f51}{n\_connectors}};\ i++)\ \{}
\DoxyCodeLine{00221\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a9c700747902a722d6c1d2073277de294}{yh\_init\_connector}}(ctx-\/>\mbox{\hyperlink{structyubihsm__context_ae6f60d6cb3833712a87ecdb42088ccc1}{connector\_list}}[i],\ \&connectors[i]);}
\DoxyCodeLine{00222\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{00223\ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ initializing\ connector\(\backslash\)n"{}});}
\DoxyCodeLine{00224\ \ \ \ \ \ \ \textcolor{keywordflow}{goto}\ cleanup;}
\DoxyCodeLine{00225\ \ \ \ \ \}}
\DoxyCodeLine{00226\ \ \ \ \ \textcolor{keywordflow}{if}\ (ctx-\/>\mbox{\hyperlink{structyubihsm__context_a97d98362b0e43b749a9cb75da4793932}{cacert}})\ \{}
\DoxyCodeLine{00227\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm_8c_a9addbfae4cdb70b819986e7769cdd102}{yh\_set\_connector\_option}}(connectors[i],\ \mbox{\hyperlink{yubihsm_8h_a59400bce0478b88e048d5e62b2b0b015aef4e49a3018eee6219e6fdee93b32386}{YH\_CONNECTOR\_HTTPS\_CA}},}
\DoxyCodeLine{00228\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ctx-\/>\mbox{\hyperlink{structyubihsm__context_a97d98362b0e43b749a9cb75da4793932}{cacert}})\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{00229\ \ \ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ setting\ HTTPS\ CA\(\backslash\)n"{}});}
\DoxyCodeLine{00230\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{goto}\ cleanup;}
\DoxyCodeLine{00231\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00232\ \ \ \ \ \}}
\DoxyCodeLine{00233\ \ \ \ \ \textcolor{keywordflow}{if}\ (ctx-\/>\mbox{\hyperlink{structyubihsm__context_aa2578fc399603af54de958824179cae4}{proxy}})\ \{}
\DoxyCodeLine{00234\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm_8c_a9addbfae4cdb70b819986e7769cdd102}{yh\_set\_connector\_option}}(connectors[i],\ \mbox{\hyperlink{yubihsm_8h_a59400bce0478b88e048d5e62b2b0b015a90c65d2ccea0060d121c9c60b3a8b2df}{YH\_CONNECTOR\_PROXY\_SERVER}},}
\DoxyCodeLine{00235\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ctx-\/>\mbox{\hyperlink{structyubihsm__context_aa2578fc399603af54de958824179cae4}{proxy}})\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{00236\ \ \ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ setting\ proxy\ server\(\backslash\)n"{}});}
\DoxyCodeLine{00237\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{goto}\ cleanup;}
\DoxyCodeLine{00238\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00239\ \ \ \ \ \}}
\DoxyCodeLine{00240\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm_8c_aa19be6ac70a2a5d1cef8d7e6902fe05f}{yh\_connect}}(connectors[i],\ 0)\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{00241\ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ connecting\ '\%s'\(\backslash\)n"{}},\ ctx-\/>\mbox{\hyperlink{structyubihsm__context_ae6f60d6cb3833712a87ecdb42088ccc1}{connector\_list}}[i]);}
\DoxyCodeLine{00242\ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00243\ \ \ \ \ \}}
\DoxyCodeLine{00244\ \ \ \ \ idx\ =\ i;}
\DoxyCodeLine{00245\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00246\ \ \ \}}
\DoxyCodeLine{00247\ }
\DoxyCodeLine{00248\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ ctx-\/>\mbox{\hyperlink{structyubihsm__context_a260f9000b86a557d5d758d498f8e0f51}{n\_connectors}};\ i++)\ \{}
\DoxyCodeLine{00249\ \ \ \ \ \textcolor{keywordflow}{if}\ (i\ ==\ idx)\ \{}
\DoxyCodeLine{00250\ \ \ \ \ \ \ ctx-\/>\mbox{\hyperlink{structyubihsm__context_a8c52c1a89cd4334a0225a1fbfba9a930}{connector}}\ =\ connectors[i];}
\DoxyCodeLine{00251\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00252\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm_8c_ab12d5a42d2219741bd3630b99ed1c7d2}{yh\_disconnect}}(connectors[i]);}
\DoxyCodeLine{00253\ \ \ \ \ \}}
\DoxyCodeLine{00254\ \ \ \}}
\DoxyCodeLine{00255\ }
\DoxyCodeLine{00256\ \ \ \textcolor{keywordflow}{if}\ (idx\ >=\ 0)\ \{}
\DoxyCodeLine{00257\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}}\ =\ 0;}
\DoxyCodeLine{00258\ }
\DoxyCodeLine{00259\ \ \ \ \ (void)\ \mbox{\hyperlink{commands_8h_a5530032f495d88f8b95a38f8fcd50da8}{yh\_com\_keepalive\_on}}(NULL,\ NULL,\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740}{fmt\_nofmt}});}
\DoxyCodeLine{00260\ \ \ \}}
\DoxyCodeLine{00261\ }
\DoxyCodeLine{00262\ cleanup:}
\DoxyCodeLine{00263\ \ \ free(connectors);}
\DoxyCodeLine{00264\ }
\DoxyCodeLine{00265\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}};}
\DoxyCodeLine{00266\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_a9155cc4306ad97e58a03ead18637f33b_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_a9155cc4306ad97e58a03ead18637f33b_icgraph}
\end{center}
\end{figure}
\Hypertarget{commands_8c_ad8a6eb16c04ad3e525f8be152062ff24}\index{commands.c@{commands.c}!yh\_com\_debug\_all@{yh\_com\_debug\_all}}
\index{yh\_com\_debug\_all@{yh\_com\_debug\_all}!commands.c@{commands.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_debug\_all()}{yh\_com\_debug\_all()}}
{\footnotesize\ttfamily \label{commands_8c_ad8a6eb16c04ad3e525f8be152062ff24} 
int yh\+\_\+com\+\_\+debug\+\_\+all (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{commands_8c_source_l00270}{270}} of file \mbox{\hyperlink{commands_8c_source}{commands.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00270\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00271\ }
\DoxyCodeLine{00272\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(ctx);}
\DoxyCodeLine{00273\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}});}
\DoxyCodeLine{00274\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(fmt);}
\DoxyCodeLine{00275\ }
\DoxyCodeLine{00276\ \ \ \mbox{\hyperlink{yubihsm_8c_a24c3146e51242256af505961e763f417}{yh\_set\_verbosity}}(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a8c52c1a89cd4334a0225a1fbfba9a930}{connector}},\ \mbox{\hyperlink{yubihsm_8h_a15dbe0ac973691939ca6e9148b181ccd}{YH\_VERB\_ALL}});}
\DoxyCodeLine{00277\ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Debug\ messages\ enabled\(\backslash\)n"{}});}
\DoxyCodeLine{00278\ }
\DoxyCodeLine{00279\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00280\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=303pt]{commands_8c_ad8a6eb16c04ad3e525f8be152062ff24_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_ad8a6eb16c04ad3e525f8be152062ff24_icgraph}
\end{center}
\end{figure}
\Hypertarget{commands_8c_af5cc531118346eb9389b42149112acdc}\index{commands.c@{commands.c}!yh\_com\_debug\_crypto@{yh\_com\_debug\_crypto}}
\index{yh\_com\_debug\_crypto@{yh\_com\_debug\_crypto}!commands.c@{commands.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_debug\_crypto()}{yh\_com\_debug\_crypto()}}
{\footnotesize\ttfamily \label{commands_8c_af5cc531118346eb9389b42149112acdc} 
int yh\+\_\+com\+\_\+debug\+\_\+crypto (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{commands_8c_source_l00391}{391}} of file \mbox{\hyperlink{commands_8c_source}{commands.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00391\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00392\ }
\DoxyCodeLine{00393\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(ctx);}
\DoxyCodeLine{00394\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}});}
\DoxyCodeLine{00395\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(fmt);}
\DoxyCodeLine{00396\ }
\DoxyCodeLine{00397\ \ \ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ yh\_verbosity;}
\DoxyCodeLine{00398\ }
\DoxyCodeLine{00399\ \ \ \mbox{\hyperlink{yubihsm_8c_a17d49ccb12b100e98d8b99585a705444}{yh\_get\_verbosity}}(\&yh\_verbosity);}
\DoxyCodeLine{00400\ \ \ yh\_verbosity\ \string^=\ \mbox{\hyperlink{yubihsm_8h_a8881b983de3922f9abb5d1fcc99216e2}{YH\_VERB\_CRYPTO}};}
\DoxyCodeLine{00401\ }
\DoxyCodeLine{00402\ \ \ \textcolor{keywordflow}{if}\ (yh\_verbosity\ \&\ \mbox{\hyperlink{yubihsm_8h_a8881b983de3922f9abb5d1fcc99216e2}{YH\_VERB\_CRYPTO}})}
\DoxyCodeLine{00403\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Crypto\ messages\ on\(\backslash\)n"{}});}
\DoxyCodeLine{00404\ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00405\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Crypto\ messages\ off\(\backslash\)n"{}});}
\DoxyCodeLine{00406\ }
\DoxyCodeLine{00407\ \ \ \mbox{\hyperlink{yubihsm_8c_a24c3146e51242256af505961e763f417}{yh\_set\_verbosity}}(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a8c52c1a89cd4334a0225a1fbfba9a930}{connector}},\ yh\_verbosity);}
\DoxyCodeLine{00408\ }
\DoxyCodeLine{00409\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00410\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=321pt]{commands_8c_af5cc531118346eb9389b42149112acdc_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_af5cc531118346eb9389b42149112acdc_icgraph}
\end{center}
\end{figure}
\Hypertarget{commands_8c_af045c2e8a570dc8fed3d339e75d26feb}\index{commands.c@{commands.c}!yh\_com\_debug\_error@{yh\_com\_debug\_error}}
\index{yh\_com\_debug\_error@{yh\_com\_debug\_error}!commands.c@{commands.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_debug\_error()}{yh\_com\_debug\_error()}}
{\footnotesize\ttfamily \label{commands_8c_af045c2e8a570dc8fed3d339e75d26feb} 
int yh\+\_\+com\+\_\+debug\+\_\+error (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{commands_8c_source_l00284}{284}} of file \mbox{\hyperlink{commands_8c_source}{commands.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00284\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00285\ }
\DoxyCodeLine{00286\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(ctx);}
\DoxyCodeLine{00287\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}});}
\DoxyCodeLine{00288\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(fmt);}
\DoxyCodeLine{00289\ }
\DoxyCodeLine{00290\ \ \ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ yh\_verbosity;}
\DoxyCodeLine{00291\ }
\DoxyCodeLine{00292\ \ \ \mbox{\hyperlink{yubihsm_8c_a17d49ccb12b100e98d8b99585a705444}{yh\_get\_verbosity}}(\&yh\_verbosity);}
\DoxyCodeLine{00293\ \ \ yh\_verbosity\ \string^=\ \mbox{\hyperlink{yubihsm_8h_a978bb82a3974b6778aadb56fa450e8ca}{YH\_VERB\_ERR}};}
\DoxyCodeLine{00294\ }
\DoxyCodeLine{00295\ \ \ \textcolor{keywordflow}{if}\ (yh\_verbosity\ \&\ \mbox{\hyperlink{yubihsm_8h_a978bb82a3974b6778aadb56fa450e8ca}{YH\_VERB\_ERR}})}
\DoxyCodeLine{00296\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Error\ messages\ on\(\backslash\)n"{}});}
\DoxyCodeLine{00297\ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00298\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Error\ messages\ off\(\backslash\)n"{}});}
\DoxyCodeLine{00299\ }
\DoxyCodeLine{00300\ \ \ \mbox{\hyperlink{yubihsm_8c_a24c3146e51242256af505961e763f417}{yh\_set\_verbosity}}(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a8c52c1a89cd4334a0225a1fbfba9a930}{connector}},\ yh\_verbosity);}
\DoxyCodeLine{00301\ }
\DoxyCodeLine{00302\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00303\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=313pt]{commands_8c_af045c2e8a570dc8fed3d339e75d26feb_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_af045c2e8a570dc8fed3d339e75d26feb_icgraph}
\end{center}
\end{figure}
\Hypertarget{commands_8c_a774b8dbc4c8d855527e518270206bb52}\index{commands.c@{commands.c}!yh\_com\_debug\_info@{yh\_com\_debug\_info}}
\index{yh\_com\_debug\_info@{yh\_com\_debug\_info}!commands.c@{commands.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_debug\_info()}{yh\_com\_debug\_info()}}
{\footnotesize\ttfamily \label{commands_8c_a774b8dbc4c8d855527e518270206bb52} 
int yh\+\_\+com\+\_\+debug\+\_\+info (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{commands_8c_source_l00307}{307}} of file \mbox{\hyperlink{commands_8c_source}{commands.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00307\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00308\ }
\DoxyCodeLine{00309\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(ctx);}
\DoxyCodeLine{00310\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}});}
\DoxyCodeLine{00311\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(fmt);}
\DoxyCodeLine{00312\ }
\DoxyCodeLine{00313\ \ \ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ yh\_verbosity;}
\DoxyCodeLine{00314\ }
\DoxyCodeLine{00315\ \ \ \mbox{\hyperlink{yubihsm_8c_a17d49ccb12b100e98d8b99585a705444}{yh\_get\_verbosity}}(\&yh\_verbosity);}
\DoxyCodeLine{00316\ \ \ yh\_verbosity\ \string^=\ \mbox{\hyperlink{yubihsm_8h_a2ac0b183de01f2dc9f64372e6c66bba4}{YH\_VERB\_INFO}};}
\DoxyCodeLine{00317\ }
\DoxyCodeLine{00318\ \ \ \textcolor{keywordflow}{if}\ (yh\_verbosity\ \&\ \mbox{\hyperlink{yubihsm_8h_a2ac0b183de01f2dc9f64372e6c66bba4}{YH\_VERB\_INFO}})}
\DoxyCodeLine{00319\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Info\ messages\ on\(\backslash\)n"{}});}
\DoxyCodeLine{00320\ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00321\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Info\ messages\ off\(\backslash\)n"{}});}
\DoxyCodeLine{00322\ }
\DoxyCodeLine{00323\ \ \ \mbox{\hyperlink{yubihsm_8c_a24c3146e51242256af505961e763f417}{yh\_set\_verbosity}}(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a8c52c1a89cd4334a0225a1fbfba9a930}{connector}},\ yh\_verbosity);}
\DoxyCodeLine{00324\ }
\DoxyCodeLine{00325\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00326\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=309pt]{commands_8c_a774b8dbc4c8d855527e518270206bb52_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_a774b8dbc4c8d855527e518270206bb52_icgraph}
\end{center}
\end{figure}
\Hypertarget{commands_8c_ad621ced8cc22f103e049f17717d0b3d8}\index{commands.c@{commands.c}!yh\_com\_debug\_intermediate@{yh\_com\_debug\_intermediate}}
\index{yh\_com\_debug\_intermediate@{yh\_com\_debug\_intermediate}!commands.c@{commands.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_debug\_intermediate()}{yh\_com\_debug\_intermediate()}}
{\footnotesize\ttfamily \label{commands_8c_ad621ced8cc22f103e049f17717d0b3d8} 
int yh\+\_\+com\+\_\+debug\+\_\+intermediate (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{commands_8c_source_l00330}{330}} of file \mbox{\hyperlink{commands_8c_source}{commands.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00331\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00332\ }
\DoxyCodeLine{00333\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(ctx);}
\DoxyCodeLine{00334\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}});}
\DoxyCodeLine{00335\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(fmt);}
\DoxyCodeLine{00336\ }
\DoxyCodeLine{00337\ \ \ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ yh\_verbosity;}
\DoxyCodeLine{00338\ }
\DoxyCodeLine{00339\ \ \ \mbox{\hyperlink{yubihsm_8c_a17d49ccb12b100e98d8b99585a705444}{yh\_get\_verbosity}}(\&yh\_verbosity);}
\DoxyCodeLine{00340\ \ \ yh\_verbosity\ \string^=\ \mbox{\hyperlink{yubihsm_8h_af507fefd9d19bfd531277a6c6cb56452}{YH\_VERB\_INTERMEDIATE}};}
\DoxyCodeLine{00341\ }
\DoxyCodeLine{00342\ \ \ \textcolor{keywordflow}{if}\ (yh\_verbosity\ \&\ \mbox{\hyperlink{yubihsm_8h_af507fefd9d19bfd531277a6c6cb56452}{YH\_VERB\_INTERMEDIATE}})}
\DoxyCodeLine{00343\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Intermediate\ messages\ on\(\backslash\)n"{}});}
\DoxyCodeLine{00344\ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00345\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Intermediate\ messages\ off\(\backslash\)n"{}});}
\DoxyCodeLine{00346\ }
\DoxyCodeLine{00347\ \ \ \mbox{\hyperlink{yubihsm_8c_a24c3146e51242256af505961e763f417}{yh\_set\_verbosity}}(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a8c52c1a89cd4334a0225a1fbfba9a930}{connector}},\ yh\_verbosity);}
\DoxyCodeLine{00348\ }
\DoxyCodeLine{00349\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00350\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=347pt]{commands_8c_ad621ced8cc22f103e049f17717d0b3d8_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_ad621ced8cc22f103e049f17717d0b3d8_icgraph}
\end{center}
\end{figure}
\Hypertarget{commands_8c_ac8470d4c5dc4fa0d300bcf171a16140b}\index{commands.c@{commands.c}!yh\_com\_debug\_none@{yh\_com\_debug\_none}}
\index{yh\_com\_debug\_none@{yh\_com\_debug\_none}!commands.c@{commands.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_debug\_none()}{yh\_com\_debug\_none()}}
{\footnotesize\ttfamily \label{commands_8c_ac8470d4c5dc4fa0d300bcf171a16140b} 
int yh\+\_\+com\+\_\+debug\+\_\+none (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{commands_8c_source_l00354}{354}} of file \mbox{\hyperlink{commands_8c_source}{commands.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00354\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00355\ }
\DoxyCodeLine{00356\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(ctx);}
\DoxyCodeLine{00357\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}});}
\DoxyCodeLine{00358\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(fmt);}
\DoxyCodeLine{00359\ }
\DoxyCodeLine{00360\ \ \ \mbox{\hyperlink{yubihsm_8c_a24c3146e51242256af505961e763f417}{yh\_set\_verbosity}}(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a8c52c1a89cd4334a0225a1fbfba9a930}{connector}},\ \mbox{\hyperlink{yubihsm_8h_aa11030bbf6092d8934236958e9478084}{YH\_VERB\_QUIET}});}
\DoxyCodeLine{00361\ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Debug\ messages\ disabled\(\backslash\)n"{}});}
\DoxyCodeLine{00362\ }
\DoxyCodeLine{00363\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00364\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=315pt]{commands_8c_ac8470d4c5dc4fa0d300bcf171a16140b_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_ac8470d4c5dc4fa0d300bcf171a16140b_icgraph}
\end{center}
\end{figure}
\Hypertarget{commands_8c_ac67abff009407dcfe773a32d8273969a}\index{commands.c@{commands.c}!yh\_com\_debug\_raw@{yh\_com\_debug\_raw}}
\index{yh\_com\_debug\_raw@{yh\_com\_debug\_raw}!commands.c@{commands.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_debug\_raw()}{yh\_com\_debug\_raw()}}
{\footnotesize\ttfamily \label{commands_8c_ac67abff009407dcfe773a32d8273969a} 
int yh\+\_\+com\+\_\+debug\+\_\+raw (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{commands_8c_source_l00368}{368}} of file \mbox{\hyperlink{commands_8c_source}{commands.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00368\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00369\ }
\DoxyCodeLine{00370\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(ctx);}
\DoxyCodeLine{00371\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}});}
\DoxyCodeLine{00372\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(fmt);}
\DoxyCodeLine{00373\ }
\DoxyCodeLine{00374\ \ \ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ yh\_verbosity;}
\DoxyCodeLine{00375\ }
\DoxyCodeLine{00376\ \ \ \mbox{\hyperlink{yubihsm_8c_a17d49ccb12b100e98d8b99585a705444}{yh\_get\_verbosity}}(\&yh\_verbosity);}
\DoxyCodeLine{00377\ \ \ yh\_verbosity\ \string^=\ \mbox{\hyperlink{yubihsm_8h_a4ead07ea7b1232808085d4bdbc7eb5b9}{YH\_VERB\_RAW}};}
\DoxyCodeLine{00378\ }
\DoxyCodeLine{00379\ \ \ \textcolor{keywordflow}{if}\ (yh\_verbosity\ \&\ \mbox{\hyperlink{yubihsm_8h_a4ead07ea7b1232808085d4bdbc7eb5b9}{YH\_VERB\_RAW}})}
\DoxyCodeLine{00380\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Raw\ messages\ on\(\backslash\)n"{}});}
\DoxyCodeLine{00381\ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00382\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Raw\ messages\ off\(\backslash\)n"{}});}
\DoxyCodeLine{00383\ }
\DoxyCodeLine{00384\ \ \ \mbox{\hyperlink{yubihsm_8c_a24c3146e51242256af505961e763f417}{yh\_set\_verbosity}}(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a8c52c1a89cd4334a0225a1fbfba9a930}{connector}},\ yh\_verbosity);}
\DoxyCodeLine{00385\ }
\DoxyCodeLine{00386\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00387\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=309pt]{commands_8c_ac67abff009407dcfe773a32d8273969a_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_ac67abff009407dcfe773a32d8273969a_icgraph}
\end{center}
\end{figure}
\Hypertarget{commands_8c_a4a18ed75272b213eea9b2ebec190b8c1}\index{commands.c@{commands.c}!yh\_com\_decrypt\_aesccm@{yh\_com\_decrypt\_aesccm}}
\index{yh\_com\_decrypt\_aesccm@{yh\_com\_decrypt\_aesccm}!commands.c@{commands.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_decrypt\_aesccm()}{yh\_com\_decrypt\_aesccm()}}
{\footnotesize\ttfamily \label{commands_8c_a4a18ed75272b213eea9b2ebec190b8c1} 
int yh\+\_\+com\+\_\+decrypt\+\_\+aesccm (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{commands_8c_source_l00501}{501}} of file \mbox{\hyperlink{commands_8c_source}{commands.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00502\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00503\ \ \ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366}{yh\_rc}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}};}
\DoxyCodeLine{00504\ }
\DoxyCodeLine{00505\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(ctx);}
\DoxyCodeLine{00506\ }
\DoxyCodeLine{00507\ \ \ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ response[\mbox{\hyperlink{yubihsm_8h_a706bd8e7adf0de85e6cfb0efc8981d3f}{YH\_MSG\_BUF\_SIZE}}];}
\DoxyCodeLine{00508\ \ \ \textcolor{keywordtype}{size\_t}\ response\_len\ =\ \textcolor{keyword}{sizeof}(response);}
\DoxyCodeLine{00509\ }
\DoxyCodeLine{00510\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a550567a0f56d8536b9b5f34e905da7ec}{yh\_util\_unwrap\_data}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].w,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[2].x,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[2].\mbox{\hyperlink{yubihsm__pkcs11_8c_a7360b55975153b822efc5217b7734e6a}{len}},}
\DoxyCodeLine{00511\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ response,\ \&response\_len);}
\DoxyCodeLine{00512\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{00513\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ decrypt\ data:\ \%s\(\backslash\)n"{}},\ \mbox{\hyperlink{lib_2error_8c_a238eedb1e27dbff2a0ab9a3932eb3f8b}{yh\_strerror}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}));}
\DoxyCodeLine{00514\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{00515\ \ \ \}}
\DoxyCodeLine{00516\ }
\DoxyCodeLine{00517\ \ \ \mbox{\hyperlink{util_8c_ad969d220471d10a9f07080b50210f403}{write\_file}}(response,\ response\_len,\ ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}},\ fmt\_to\_fmt(fmt));}
\DoxyCodeLine{00518\ }
\DoxyCodeLine{00519\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00520\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_a4a18ed75272b213eea9b2ebec190b8c1_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_a4a18ed75272b213eea9b2ebec190b8c1_icgraph}
\end{center}
\end{figure}
\Hypertarget{commands_8c_a38efe7b63355b641f9489d4f95106589}\index{commands.c@{commands.c}!yh\_com\_decrypt\_oaep@{yh\_com\_decrypt\_oaep}}
\index{yh\_com\_decrypt\_oaep@{yh\_com\_decrypt\_oaep}!commands.c@{commands.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_decrypt\_oaep()}{yh\_com\_decrypt\_oaep()}}
{\footnotesize\ttfamily \label{commands_8c_a38efe7b63355b641f9489d4f95106589} 
int yh\+\_\+com\+\_\+decrypt\+\_\+oaep (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{commands_8c_source_l02676}{2676}} of file \mbox{\hyperlink{commands_8c_source}{commands.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02676\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02677\ }
\DoxyCodeLine{02678\ \ \ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366}{yh\_rc}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}};}
\DoxyCodeLine{02679\ }
\DoxyCodeLine{02680\ \ \ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ response[\mbox{\hyperlink{yubihsm_8h_a706bd8e7adf0de85e6cfb0efc8981d3f}{YH\_MSG\_BUF\_SIZE}}];}
\DoxyCodeLine{02681\ \ \ \textcolor{keywordtype}{size\_t}\ response\_len\ =\ \textcolor{keyword}{sizeof}(response);}
\DoxyCodeLine{02682\ }
\DoxyCodeLine{02683\ \ \ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a22f45a3cb4f074e609f58ebaeef0ecf9}{label}}[64];}
\DoxyCodeLine{02684\ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae76ac4adc41ec92427b4a14cd3385c1b}{label\_len}}\ =\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a22f45a3cb4f074e609f58ebaeef0ecf9}{label}});}
\DoxyCodeLine{02685\ }
\DoxyCodeLine{02686\ \ \ \textcolor{keywordtype}{int}\ hash;}
\DoxyCodeLine{02687\ \ \ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55ca}{yh\_algorithm}}\ mgf;}
\DoxyCodeLine{02688\ }
\DoxyCodeLine{02689\ \ \ \textcolor{keywordflow}{switch}\ (\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[2].\mbox{\hyperlink{pointer_8h_aeeddce917cf130d62c370b8f216026dd}{a}})\ \{}
\DoxyCodeLine{02690\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caae9e58613e12b0f9f445e620f1dd77e1d}{YH\_ALGO\_RSA\_OAEP\_SHA1}}:}
\DoxyCodeLine{02691\ \ \ \ \ \ \ hash\ =\ \mbox{\hyperlink{yubihsm_2common_2hash_8h_a488906826f8aaf7e850c35889d560089a970f17bf10faf2a31f535116e97f6b4a}{\_SHA1}};}
\DoxyCodeLine{02692\ \ \ \ \ \ \ mgf\ =\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caae1ab21f2df42a56bdc8ff046ed14797a}{YH\_ALGO\_MGF1\_SHA1}};}
\DoxyCodeLine{02693\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02694\ }
\DoxyCodeLine{02695\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa590665f5e23f996daeba0a2586b2ff33}{YH\_ALGO\_RSA\_OAEP\_SHA256}}:}
\DoxyCodeLine{02696\ \ \ \ \ \ \ hash\ =\ \mbox{\hyperlink{yubihsm_2common_2hash_8h_a488906826f8aaf7e850c35889d560089af0ab1a9d65ceafa4ba1f6f177e379258}{\_SHA256}};}
\DoxyCodeLine{02697\ \ \ \ \ \ \ mgf\ =\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caae3f68121c91d613fe450c12fad55eab2}{YH\_ALGO\_MGF1\_SHA256}};}
\DoxyCodeLine{02698\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02699\ }
\DoxyCodeLine{02700\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caab2580ffabb9b08affd0f7803fb1536cd}{YH\_ALGO\_RSA\_OAEP\_SHA384}}:}
\DoxyCodeLine{02701\ \ \ \ \ \ \ hash\ =\ \mbox{\hyperlink{yubihsm_2common_2hash_8h_a488906826f8aaf7e850c35889d560089a46254673795a1d78b2d84adbf88d8bb2}{\_SHA384}};}
\DoxyCodeLine{02702\ \ \ \ \ \ \ mgf\ =\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa788440387af34a9aa10a3e5561c8ee31}{YH\_ALGO\_MGF1\_SHA384}};}
\DoxyCodeLine{02703\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02704\ }
\DoxyCodeLine{02705\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caaa4c2625511af2c17ed83da552d3dc5f6}{YH\_ALGO\_RSA\_OAEP\_SHA512}}:}
\DoxyCodeLine{02706\ \ \ \ \ \ \ hash\ =\ \mbox{\hyperlink{yubihsm_2common_2hash_8h_a488906826f8aaf7e850c35889d560089a0dbf438178c608dea7392e75c9b7ae2d}{\_SHA512}};}
\DoxyCodeLine{02707\ \ \ \ \ \ \ mgf\ =\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa104308e8fac7553b1d875f149ff133b1}{YH\_ALGO\_MGF1\_SHA512}};}
\DoxyCodeLine{02708\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02709\ }
\DoxyCodeLine{02710\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{02711\ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Invalid\ hash\ algorithm\(\backslash\)n"{}});}
\DoxyCodeLine{02712\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{02713\ \ \ \}}
\DoxyCodeLine{02714\ }
\DoxyCodeLine{02715\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{hash_8c_a062ee0f36e0c16725c22a5d9d964a8cd}{hash\_bytes}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[4].x,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[4].\mbox{\hyperlink{yubihsm__pkcs11_8c_a7360b55975153b822efc5217b7734e6a}{len}},\ hash,\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a22f45a3cb4f074e609f58ebaeef0ecf9}{label}},\ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_ae76ac4adc41ec92427b4a14cd3385c1b}{label\_len}})\ ==\ \textcolor{keyword}{false})\ \{}
\DoxyCodeLine{02716\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Unable\ to\ hash\ data\(\backslash\)n"{}});}
\DoxyCodeLine{02717\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{02718\ \ \ \}}
\DoxyCodeLine{02719\ }
\DoxyCodeLine{02720\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_aa939f8764ed0cca27884d9c8f640ac14}{yh\_util\_decrypt\_oaep}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].w,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[3].x,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[3].\mbox{\hyperlink{yubihsm__pkcs11_8c_a7360b55975153b822efc5217b7734e6a}{len}},}
\DoxyCodeLine{02721\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ response,\ \&response\_len,\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a22f45a3cb4f074e609f58ebaeef0ecf9}{label}},\ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae76ac4adc41ec92427b4a14cd3385c1b}{label\_len}},\ mgf);}
\DoxyCodeLine{02722\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{02723\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ decrypt\ data\ with\ OAEP:\ \%s\(\backslash\)n"{}},\ \mbox{\hyperlink{lib_2error_8c_a238eedb1e27dbff2a0ab9a3932eb3f8b}{yh\_strerror}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}));}
\DoxyCodeLine{02724\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{02725\ \ \ \}}
\DoxyCodeLine{02726\ }
\DoxyCodeLine{02727\ \ \ \mbox{\hyperlink{util_8c_ad969d220471d10a9f07080b50210f403}{write\_file}}(response,\ response\_len,\ ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}},\ fmt\_to\_fmt(fmt));}
\DoxyCodeLine{02728\ }
\DoxyCodeLine{02729\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{02730\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_a38efe7b63355b641f9489d4f95106589_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_a38efe7b63355b641f9489d4f95106589_icgraph}
\end{center}
\end{figure}
\Hypertarget{commands_8c_aea9c5cab32280dc06d4681c02f1b5ccb}\index{commands.c@{commands.c}!yh\_com\_decrypt\_pkcs1v1\_5@{yh\_com\_decrypt\_pkcs1v1\_5}}
\index{yh\_com\_decrypt\_pkcs1v1\_5@{yh\_com\_decrypt\_pkcs1v1\_5}!commands.c@{commands.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_decrypt\_pkcs1v1\_5()}{yh\_com\_decrypt\_pkcs1v1\_5()}}
{\footnotesize\ttfamily \label{commands_8c_aea9c5cab32280dc06d4681c02f1b5ccb} 
int yh\+\_\+com\+\_\+decrypt\+\_\+pkcs1v1\+\_\+5 (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{commands_8c_source_l00417}{417}} of file \mbox{\hyperlink{commands_8c_source}{commands.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00418\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00419\ }
\DoxyCodeLine{00420\ \ \ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366}{yh\_rc}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}};}
\DoxyCodeLine{00421\ }
\DoxyCodeLine{00422\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(ctx);}
\DoxyCodeLine{00423\ }
\DoxyCodeLine{00424\ \ \ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ response[\mbox{\hyperlink{yubihsm_8h_a706bd8e7adf0de85e6cfb0efc8981d3f}{YH\_MSG\_BUF\_SIZE}}];}
\DoxyCodeLine{00425\ \ \ \textcolor{keywordtype}{size\_t}\ response\_len\ =\ \textcolor{keyword}{sizeof}(response);}
\DoxyCodeLine{00426\ }
\DoxyCodeLine{00427\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a5ebf6932cd2e68b9a23787c27fde3e26}{yh\_util\_decrypt\_pkcs1v1\_5}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].w,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[2].x,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[2].\mbox{\hyperlink{yubihsm__pkcs11_8c_a7360b55975153b822efc5217b7734e6a}{len}},}
\DoxyCodeLine{00428\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ response,\ \&response\_len);}
\DoxyCodeLine{00429\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{00430\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ decrypt\ data:\ \%s\(\backslash\)n"{}},\ \mbox{\hyperlink{lib_2error_8c_a238eedb1e27dbff2a0ab9a3932eb3f8b}{yh\_strerror}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}));}
\DoxyCodeLine{00431\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{00432\ \ \ \}}
\DoxyCodeLine{00433\ }
\DoxyCodeLine{00434\ \ \ \mbox{\hyperlink{util_8c_ad969d220471d10a9f07080b50210f403}{write\_file}}(response,\ response\_len,\ ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}},\ fmt\_to\_fmt(fmt));}
\DoxyCodeLine{00435\ }
\DoxyCodeLine{00436\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00437\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_aea9c5cab32280dc06d4681c02f1b5ccb_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_aea9c5cab32280dc06d4681c02f1b5ccb_icgraph}
\end{center}
\end{figure}
\Hypertarget{commands_8c_ad490f0e89d33c1300a44bd095eb5562c}\index{commands.c@{commands.c}!yh\_com\_delete@{yh\_com\_delete}}
\index{yh\_com\_delete@{yh\_com\_delete}!commands.c@{commands.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_delete()}{yh\_com\_delete()}}
{\footnotesize\ttfamily \label{commands_8c_ad490f0e89d33c1300a44bd095eb5562c} 
int yh\+\_\+com\+\_\+delete (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{commands_8c_source_l01975}{1975}} of file \mbox{\hyperlink{commands_8c_source}{commands.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01975\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01976\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(ctx);}
\DoxyCodeLine{01977\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(fmt);}
\DoxyCodeLine{01978\ }
\DoxyCodeLine{01979\ \ \ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366}{yh\_rc}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_ae736702f9463878db4adfd45b6a597f9}{yh\_util\_delete\_object}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].w,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[2].t);}
\DoxyCodeLine{01980\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{01981\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ delete\ object:\ \%s\(\backslash\)n"{}},\ \mbox{\hyperlink{lib_2error_8c_a238eedb1e27dbff2a0ab9a3932eb3f8b}{yh\_strerror}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}));}
\DoxyCodeLine{01982\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{01983\ \ \ \}\ \textcolor{comment}{//\ TODO(adma):\ the\ order\ of\ the\ arguments\ should\ be\ changed\ to\ id\ and\ type}}
\DoxyCodeLine{01984\ }
\DoxyCodeLine{01985\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{01986\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_ad490f0e89d33c1300a44bd095eb5562c_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_ad490f0e89d33c1300a44bd095eb5562c_icgraph}
\end{center}
\end{figure}
\Hypertarget{commands_8c_a0f6792710fe36e1bf00cb839f286d473}\index{commands.c@{commands.c}!yh\_com\_derive\_ecdh@{yh\_com\_derive\_ecdh}}
\index{yh\_com\_derive\_ecdh@{yh\_com\_derive\_ecdh}!commands.c@{commands.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_derive\_ecdh()}{yh\_com\_derive\_ecdh()}}
{\footnotesize\ttfamily \label{commands_8c_a0f6792710fe36e1bf00cb839f286d473} 
int yh\+\_\+com\+\_\+derive\+\_\+ecdh (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{commands_8c_source_l00444}{444}} of file \mbox{\hyperlink{commands_8c_source}{commands.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00444\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00445\ }
\DoxyCodeLine{00446\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(ctx);}
\DoxyCodeLine{00447\ }
\DoxyCodeLine{00448\ \ \ BIO\ *bio\ =\ BIO\_new(BIO\_s\_mem());}
\DoxyCodeLine{00449\ \ \ \textcolor{keywordflow}{if}\ (bio\ ==\ NULL)\ \{}
\DoxyCodeLine{00450\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00451\ \ \ \}}
\DoxyCodeLine{00452\ }
\DoxyCodeLine{00453\ \ \ (void)\ BIO\_write(bio,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[2].x,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[2].\mbox{\hyperlink{yubihsm__pkcs11_8c_a7360b55975153b822efc5217b7734e6a}{len}});}
\DoxyCodeLine{00454\ }
\DoxyCodeLine{00455\ \ \ EVP\_PKEY\ *\mbox{\hyperlink{yubihsm__pkcs11_8c_a931987c85fd408a620505ee9a1aa6f58}{pubkey}}\ =\ PEM\_read\_bio\_PUBKEY(bio,\ NULL,\ NULL,\ NULL);}
\DoxyCodeLine{00456\ \ \ BIO\_free\_all(bio);}
\DoxyCodeLine{00457\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a931987c85fd408a620505ee9a1aa6f58}{pubkey}}\ ==\ NULL)\ \{}
\DoxyCodeLine{00458\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ load\ public\ key\(\backslash\)n"{}});}
\DoxyCodeLine{00459\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{00460\ \ \ \}}
\DoxyCodeLine{00461\ \ \ \textcolor{keywordflow}{if}\ (EVP\_PKEY\_base\_id(\mbox{\hyperlink{yubihsm__pkcs11_8c_a931987c85fd408a620505ee9a1aa6f58}{pubkey}})\ !=\ EVP\_PKEY\_EC)\ \{}
\DoxyCodeLine{00462\ \ \ \ \ EVP\_PKEY\_free(\mbox{\hyperlink{yubihsm__pkcs11_8c_a931987c85fd408a620505ee9a1aa6f58}{pubkey}});}
\DoxyCodeLine{00463\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Key\ is\ not\ an\ EC\ key.\(\backslash\)n"{}});}
\DoxyCodeLine{00464\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{00465\ \ \ \}}
\DoxyCodeLine{00466\ }
\DoxyCodeLine{00467\ \ \ EC\_KEY\ *ec\ =\ EVP\_PKEY\_get1\_EC\_KEY(\mbox{\hyperlink{yubihsm__pkcs11_8c_a931987c85fd408a620505ee9a1aa6f58}{pubkey}});}
\DoxyCodeLine{00468\ \ \ EVP\_PKEY\_free(\mbox{\hyperlink{yubihsm__pkcs11_8c_a931987c85fd408a620505ee9a1aa6f58}{pubkey}});}
\DoxyCodeLine{00469\ \ \ \textcolor{keywordflow}{if}\ (ec\ ==\ NULL)\ \{}
\DoxyCodeLine{00470\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ retrive\ key.\(\backslash\)n"{}});}
\DoxyCodeLine{00471\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{00472\ \ \ \}}
\DoxyCodeLine{00473\ }
\DoxyCodeLine{00474\ \ \ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ data[\mbox{\hyperlink{yubihsm_8h_a706bd8e7adf0de85e6cfb0efc8981d3f}{YH\_MSG\_BUF\_SIZE}}];}
\DoxyCodeLine{00475\ \ \ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ *ptr\ =\ data;}
\DoxyCodeLine{00476\ \ \ \textcolor{keywordtype}{size\_t}\ data\_len\ =\ i2o\_ECPublicKey(ec,\ \&ptr);}
\DoxyCodeLine{00477\ }
\DoxyCodeLine{00478\ \ \ EC\_KEY\_free(ec);}
\DoxyCodeLine{00479\ }
\DoxyCodeLine{00480\ \ \ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366}{yh\_rc}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}};}
\DoxyCodeLine{00481\ \ \ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ response[\mbox{\hyperlink{yubihsm_8h_a706bd8e7adf0de85e6cfb0efc8981d3f}{YH\_MSG\_BUF\_SIZE}}];}
\DoxyCodeLine{00482\ \ \ \textcolor{keywordtype}{size\_t}\ response\_len\ =\ \textcolor{keyword}{sizeof}(response);}
\DoxyCodeLine{00483\ }
\DoxyCodeLine{00484\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a2900aee87732f9ec017bd1662bcef7e9}{yh\_util\_derive\_ecdh}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].w,\ data,\ data\_len,\ response,}
\DoxyCodeLine{00485\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&response\_len);}
\DoxyCodeLine{00486\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{00487\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ do\ key\ exchange:\ \%s\(\backslash\)n"{}},\ \mbox{\hyperlink{lib_2error_8c_a238eedb1e27dbff2a0ab9a3932eb3f8b}{yh\_strerror}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}));}
\DoxyCodeLine{00488\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{00489\ \ \ \}}
\DoxyCodeLine{00490\ }
\DoxyCodeLine{00491\ \ \ \mbox{\hyperlink{util_8c_ad969d220471d10a9f07080b50210f403}{write\_file}}(response,\ response\_len,\ ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}},\ fmt\_to\_fmt(fmt));}
\DoxyCodeLine{00492\ }
\DoxyCodeLine{00493\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00494\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_a0f6792710fe36e1bf00cb839f286d473_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_a0f6792710fe36e1bf00cb839f286d473_icgraph}
\end{center}
\end{figure}
\Hypertarget{commands_8c_ac388fd67865728ed4f4267a8a13b248e}\index{commands.c@{commands.c}!yh\_com\_disconnect@{yh\_com\_disconnect}}
\index{yh\_com\_disconnect@{yh\_com\_disconnect}!commands.c@{commands.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_disconnect()}{yh\_com\_disconnect()}}
{\footnotesize\ttfamily \label{commands_8c_ac388fd67865728ed4f4267a8a13b248e} 
int yh\+\_\+com\+\_\+disconnect (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{commands_8c_source_l00550}{550}} of file \mbox{\hyperlink{commands_8c_source}{commands.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00550\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00551\ }
\DoxyCodeLine{00552\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}});}
\DoxyCodeLine{00553\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(fmt);}
\DoxyCodeLine{00554\ }
\DoxyCodeLine{00555\ \ \ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366}{yh\_rc}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}};}
\DoxyCodeLine{00556\ }
\DoxyCodeLine{00557\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{yubihsm_8h_add4e5963a36bd6c9b06c717d705f4c2f}{YH\_MAX\_SESSIONS}};\ i++)\ \{}
\DoxyCodeLine{00558\ \ \ \ \ \textcolor{keywordflow}{if}\ (ctx-\/>\mbox{\hyperlink{structyubihsm__context_a7a959752fa285fb4a7a75921bbfa00fe}{sessions}}[i])\ \{}
\DoxyCodeLine{00559\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a1a35f8ae5a739848408633a514e41b2d}{yh\_destroy\_session}}(\&ctx-\/>\mbox{\hyperlink{structyubihsm__context_a7a959752fa285fb4a7a75921bbfa00fe}{sessions}}[i]);}
\DoxyCodeLine{00560\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{00561\ \ \ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ destroy\ session:\ \%s\(\backslash\)n"{}},\ \mbox{\hyperlink{lib_2error_8c_a238eedb1e27dbff2a0ab9a3932eb3f8b}{yh\_strerror}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}));}
\DoxyCodeLine{00562\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00563\ \ \ \ \ \ \ ctx-\/>\mbox{\hyperlink{structyubihsm__context_a7a959752fa285fb4a7a75921bbfa00fe}{sessions}}[i]\ =\ NULL;}
\DoxyCodeLine{00564\ \ \ \ \ \}}
\DoxyCodeLine{00565\ \ \ \}}
\DoxyCodeLine{00566\ }
\DoxyCodeLine{00567\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_ab12d5a42d2219741bd3630b99ed1c7d2}{yh\_disconnect}}(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a8c52c1a89cd4334a0225a1fbfba9a930}{connector}});}
\DoxyCodeLine{00568\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{00569\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Unable\ to\ disconnect:\ \%s\(\backslash\)n"{}},\ \mbox{\hyperlink{lib_2error_8c_a238eedb1e27dbff2a0ab9a3932eb3f8b}{yh\_strerror}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}));}
\DoxyCodeLine{00570\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{00571\ \ \ \}}
\DoxyCodeLine{00572\ \ \ ctx-\/>\mbox{\hyperlink{structyubihsm__context_a8c52c1a89cd4334a0225a1fbfba9a930}{connector}}\ =\ NULL;}
\DoxyCodeLine{00573\ }
\DoxyCodeLine{00574\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00575\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_ac388fd67865728ed4f4267a8a13b248e_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_ac388fd67865728ed4f4267a8a13b248e_icgraph}
\end{center}
\end{figure}
\Hypertarget{commands_8c_af764906e585805991dd84ec5dc2c060a}\index{commands.c@{commands.c}!yh\_com\_echo@{yh\_com\_echo}}
\index{yh\_com\_echo@{yh\_com\_echo}!commands.c@{commands.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_echo()}{yh\_com\_echo()}}
{\footnotesize\ttfamily \label{commands_8c_af764906e585805991dd84ec5dc2c060a} 
int yh\+\_\+com\+\_\+echo (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{commands_8c_source_l00582}{582}} of file \mbox{\hyperlink{commands_8c_source}{commands.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00582\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00583\ }
\DoxyCodeLine{00584\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(ctx);}
\DoxyCodeLine{00585\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(fmt);}
\DoxyCodeLine{00586\ }
\DoxyCodeLine{00587\ \ \ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366}{yh\_rc}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}};}
\DoxyCodeLine{00588\ }
\DoxyCodeLine{00589\ \ \ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ data[\mbox{\hyperlink{yubihsm_8h_a706bd8e7adf0de85e6cfb0efc8981d3f}{YH\_MSG\_BUF\_SIZE}}];}
\DoxyCodeLine{00590\ \ \ \mbox{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t}}\ data\_len;}
\DoxyCodeLine{00591\ }
\DoxyCodeLine{00592\ \ \ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ response[\mbox{\hyperlink{yubihsm_8h_a706bd8e7adf0de85e6cfb0efc8981d3f}{YH\_MSG\_BUF\_SIZE}}];}
\DoxyCodeLine{00593\ \ \ \textcolor{keywordtype}{size\_t}\ response\_len;}
\DoxyCodeLine{00594\ \ \ \mbox{\hyperlink{yubihsm_8h_aa5415bafa9c48dfef0e183d8df504b7e}{yh\_cmd}}\ response\_cmd;}
\DoxyCodeLine{00595\ }
\DoxyCodeLine{00596\ \ \ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ \textcolor{keywordtype}{byte}\ =\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].b;}
\DoxyCodeLine{00597\ }
\DoxyCodeLine{00598\ \ \ \mbox{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t}}\ \mbox{\hyperlink{gmock__stress__test_8cc_afd9db40e3361ae09188795e8cbe19752}{count}}\ =\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[2].w;}
\DoxyCodeLine{00599\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{gmock__stress__test_8cc_afd9db40e3361ae09188795e8cbe19752}{count}}\ >\ \mbox{\hyperlink{yubihsm_8h_a706bd8e7adf0de85e6cfb0efc8981d3f}{YH\_MSG\_BUF\_SIZE}})\ \{}
\DoxyCodeLine{00600\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Count\ must\ be\ in\ [0,\ \%d]\(\backslash\)n"{}},\ \mbox{\hyperlink{yubihsm_8h_a706bd8e7adf0de85e6cfb0efc8981d3f}{YH\_MSG\_BUF\_SIZE}});}
\DoxyCodeLine{00601\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{00602\ \ \ \}}
\DoxyCodeLine{00603\ }
\DoxyCodeLine{00604\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_adc4bd59a60361844aa0e852efa210105}{memset}}(data,\ \textcolor{keywordtype}{byte},\ \mbox{\hyperlink{gmock__stress__test_8cc_afd9db40e3361ae09188795e8cbe19752}{count}});}
\DoxyCodeLine{00605\ }
\DoxyCodeLine{00606\ \ \ data\_len\ =\ \mbox{\hyperlink{gmock__stress__test_8cc_afd9db40e3361ae09188795e8cbe19752}{count}};}
\DoxyCodeLine{00607\ \ \ response\_len\ =\ \textcolor{keyword}{sizeof}(response);}
\DoxyCodeLine{00608\ }
\DoxyCodeLine{00609\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a4c26f003b72e800e9c934bca922a404a}{yh\_send\_secure\_msg}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e,\ YHC\_ECHO,\ data,\ data\_len,\ \&response\_cmd,}
\DoxyCodeLine{00610\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ response,\ \&response\_len);}
\DoxyCodeLine{00611\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{00612\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ send\ ECHO\ command:\ \%s\(\backslash\)n"{}},\ \mbox{\hyperlink{lib_2error_8c_a238eedb1e27dbff2a0ab9a3932eb3f8b}{yh\_strerror}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}));}
\DoxyCodeLine{00613\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{00614\ \ \ \}}
\DoxyCodeLine{00615\ }
\DoxyCodeLine{00616\ \ \ \textcolor{keywordflow}{if}\ (response\_cmd\ ==\ \mbox{\hyperlink{yubihsm_8h_aa5415bafa9c48dfef0e183d8df504b7ea51cdf2ccd6995498e589e8ea6ce2a1f2}{YHC\_ERROR}})\ \{}
\DoxyCodeLine{00617\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Unable\ to\ get\ echo\ data:\ \%s\ (\%x)\(\backslash\)n"{}},}
\DoxyCodeLine{00618\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{lib_2error_8c_a238eedb1e27dbff2a0ab9a3932eb3f8b}{yh\_strerror}}(response[0]),\ response[0]);}
\DoxyCodeLine{00619\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{00620\ \ \ \}}
\DoxyCodeLine{00621\ }
\DoxyCodeLine{00622\ \ \ fprintf(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}},\ \textcolor{stringliteral}{"{}Response\ (\%zu\ bytes):\(\backslash\)n"{}},\ response\_len);}
\DoxyCodeLine{00623\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t}}\ i\ =\ 0;\ i\ <\ response\_len;\ i++)\ \{}
\DoxyCodeLine{00624\ \ \ \ \ \textcolor{keywordflow}{if}\ (i\ \&\&\ !(i\ \%\ 64))}
\DoxyCodeLine{00625\ \ \ \ \ \ \ fprintf(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}},\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{00626\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (i\ \&\&\ !(i\ \%\ 8))}
\DoxyCodeLine{00627\ \ \ \ \ \ \ fprintf(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}},\ \textcolor{stringliteral}{"{}\ "{}});}
\DoxyCodeLine{00628\ \ \ \ \ fprintf(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}},\ \textcolor{stringliteral}{"{}\%02x"{}},\ response[i]);}
\DoxyCodeLine{00629\ \ \ \}}
\DoxyCodeLine{00630\ }
\DoxyCodeLine{00631\ \ \ fprintf(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}},\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{00632\ }
\DoxyCodeLine{00633\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00634\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_af764906e585805991dd84ec5dc2c060a_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_af764906e585805991dd84ec5dc2c060a_icgraph}
\end{center}
\end{figure}
\Hypertarget{commands_8c_a115ebd6b436229c152141f64a2405e70}\index{commands.c@{commands.c}!yh\_com\_encrypt\_aesccm@{yh\_com\_encrypt\_aesccm}}
\index{yh\_com\_encrypt\_aesccm@{yh\_com\_encrypt\_aesccm}!commands.c@{commands.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_encrypt\_aesccm()}{yh\_com\_encrypt\_aesccm()}}
{\footnotesize\ttfamily \label{commands_8c_a115ebd6b436229c152141f64a2405e70} 
int yh\+\_\+com\+\_\+encrypt\+\_\+aesccm (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{commands_8c_source_l00527}{527}} of file \mbox{\hyperlink{commands_8c_source}{commands.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00528\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00529\ \ \ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366}{yh\_rc}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}};}
\DoxyCodeLine{00530\ }
\DoxyCodeLine{00531\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(ctx);}
\DoxyCodeLine{00532\ }
\DoxyCodeLine{00533\ \ \ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ response[\mbox{\hyperlink{yubihsm_8h_a706bd8e7adf0de85e6cfb0efc8981d3f}{YH\_MSG\_BUF\_SIZE}}];}
\DoxyCodeLine{00534\ \ \ \textcolor{keywordtype}{size\_t}\ response\_len\ =\ \textcolor{keyword}{sizeof}(response);}
\DoxyCodeLine{00535\ }
\DoxyCodeLine{00536\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a7c2e101be04ad1546d99d5600e732eca}{yh\_util\_wrap\_data}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].w,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[2].x,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[2].\mbox{\hyperlink{yubihsm__pkcs11_8c_a7360b55975153b822efc5217b7734e6a}{len}},}
\DoxyCodeLine{00537\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ response,\ \&response\_len);}
\DoxyCodeLine{00538\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{00539\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ encrypt\ data:\ \%s\(\backslash\)n"{}},\ \mbox{\hyperlink{lib_2error_8c_a238eedb1e27dbff2a0ab9a3932eb3f8b}{yh\_strerror}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}));}
\DoxyCodeLine{00540\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{00541\ \ \ \}}
\DoxyCodeLine{00542\ }
\DoxyCodeLine{00543\ \ \ \mbox{\hyperlink{util_8c_ad969d220471d10a9f07080b50210f403}{write\_file}}(response,\ response\_len,\ ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}},\ fmt\_to\_fmt(fmt));}
\DoxyCodeLine{00544\ }
\DoxyCodeLine{00545\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00546\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_a115ebd6b436229c152141f64a2405e70_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_a115ebd6b436229c152141f64a2405e70_icgraph}
\end{center}
\end{figure}
\Hypertarget{commands_8c_aa1c71ebc2b3f298b6522ab090393c73e}\index{commands.c@{commands.c}!yh\_com\_generate\_asymmetric@{yh\_com\_generate\_asymmetric}}
\index{yh\_com\_generate\_asymmetric@{yh\_com\_generate\_asymmetric}!commands.c@{commands.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_generate\_asymmetric()}{yh\_com\_generate\_asymmetric()}}
{\footnotesize\ttfamily \label{commands_8c_aa1c71ebc2b3f298b6522ab090393c73e} 
int yh\+\_\+com\+\_\+generate\+\_\+asymmetric (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{commands_8c_source_l00644}{644}} of file \mbox{\hyperlink{commands_8c_source}{commands.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00645\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00646\ }
\DoxyCodeLine{00647\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(ctx);}
\DoxyCodeLine{00648\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(fmt);}
\DoxyCodeLine{00649\ }
\DoxyCodeLine{00650\ \ \ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366}{yh\_rc}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}};}
\DoxyCodeLine{00651\ }
\DoxyCodeLine{00652\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm_8c_a0a67155f2a7970ecb52e4f6aac6bbe84}{yh\_is\_rsa}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[5].\mbox{\hyperlink{pointer_8h_aeeddce917cf130d62c370b8f216026dd}{a}}))\ \{}
\DoxyCodeLine{00653\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_ab1c62ef2643184a8ad44c569c87712d1}{yh\_util\_generate\_rsa\_key}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e,\ \&\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].w,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[2].\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}},\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[3].w,}
\DoxyCodeLine{00654\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[4].c,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[5].\mbox{\hyperlink{pointer_8h_aeeddce917cf130d62c370b8f216026dd}{a}});}
\DoxyCodeLine{00655\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm_8c_a3032a8f45bfad36ed6157b0158dd7921}{yh\_is\_ec}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[5].\mbox{\hyperlink{pointer_8h_aeeddce917cf130d62c370b8f216026dd}{a}}))\ \{}
\DoxyCodeLine{00656\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a2db9bbd57a908c5c454fc6254f57dcff}{yh\_util\_generate\_ec\_key}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e,\ \&\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].w,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[2].\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}},\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[3].w,}
\DoxyCodeLine{00657\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[4].c,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[5].\mbox{\hyperlink{pointer_8h_aeeddce917cf130d62c370b8f216026dd}{a}});}
\DoxyCodeLine{00658\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm_8c_a16fbf4426acbf42695c4ec4738b6ae8a}{yh\_is\_ed}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[5].\mbox{\hyperlink{pointer_8h_aeeddce917cf130d62c370b8f216026dd}{a}}))\ \{}
\DoxyCodeLine{00659\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a41f4326fe736e99302442d6a6109edbc}{yh\_util\_generate\_ed\_key}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e,\ \&\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].w,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[2].\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}},\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[3].w,}
\DoxyCodeLine{00660\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[4].c,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[5].\mbox{\hyperlink{pointer_8h_aeeddce917cf130d62c370b8f216026dd}{a}});}
\DoxyCodeLine{00661\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00662\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Invalid\ algorithm\ \%d\(\backslash\)n"{}},\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[5].\mbox{\hyperlink{pointer_8h_aeeddce917cf130d62c370b8f216026dd}{a}});}
\DoxyCodeLine{00663\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{00664\ \ \ \}}
\DoxyCodeLine{00665\ }
\DoxyCodeLine{00666\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{00667\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ generate\ asymmetric\ key:\ \%s\(\backslash\)n"{}},}
\DoxyCodeLine{00668\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{lib_2error_8c_a238eedb1e27dbff2a0ab9a3932eb3f8b}{yh\_strerror}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}));}
\DoxyCodeLine{00669\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{00670\ \ \ \}}
\DoxyCodeLine{00671\ }
\DoxyCodeLine{00672\ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Generated\ Asymmetric\ key\ 0x\%04x\(\backslash\)n"{}},\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].w);}
\DoxyCodeLine{00673\ }
\DoxyCodeLine{00674\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00675\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_aa1c71ebc2b3f298b6522ab090393c73e_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_aa1c71ebc2b3f298b6522ab090393c73e_icgraph}
\end{center}
\end{figure}
\Hypertarget{commands_8c_a2be1be0e0a454965f5a378e4ecb483f0}\index{commands.c@{commands.c}!yh\_com\_generate\_hmac@{yh\_com\_generate\_hmac}}
\index{yh\_com\_generate\_hmac@{yh\_com\_generate\_hmac}!commands.c@{commands.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_generate\_hmac()}{yh\_com\_generate\_hmac()}}
{\footnotesize\ttfamily \label{commands_8c_a2be1be0e0a454965f5a378e4ecb483f0} 
int yh\+\_\+com\+\_\+generate\+\_\+hmac (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{commands_8c_source_l00685}{685}} of file \mbox{\hyperlink{commands_8c_source}{commands.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00685\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00686\ }
\DoxyCodeLine{00687\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(ctx);}
\DoxyCodeLine{00688\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(fmt);}
\DoxyCodeLine{00689\ }
\DoxyCodeLine{00690\ \ \ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366}{yh\_rc}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}};}
\DoxyCodeLine{00691\ }
\DoxyCodeLine{00692\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{yubihsm_8c_acb19de78e7d1aed72abbed5c74c676bc}{yh\_is\_hmac}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[5].\mbox{\hyperlink{pointer_8h_aeeddce917cf130d62c370b8f216026dd}{a}}))\ \{}
\DoxyCodeLine{00693\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Invalid\ algorithm:\ \%d\(\backslash\)n"{}},\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[5].\mbox{\hyperlink{pointer_8h_aeeddce917cf130d62c370b8f216026dd}{a}});}
\DoxyCodeLine{00694\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{00695\ \ \ \}}
\DoxyCodeLine{00696\ }
\DoxyCodeLine{00697\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a1eac22853548b7ceab92550c22233b18}{yh\_util\_generate\_hmac\_key}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e,\ \&\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].w,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[2].\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}},\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[3].w,}
\DoxyCodeLine{00698\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[4].c,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[5].\mbox{\hyperlink{pointer_8h_aeeddce917cf130d62c370b8f216026dd}{a}});}
\DoxyCodeLine{00699\ }
\DoxyCodeLine{00700\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{00701\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ generate\ HMAC\ key:\ \%s\(\backslash\)n"{}},\ \mbox{\hyperlink{lib_2error_8c_a238eedb1e27dbff2a0ab9a3932eb3f8b}{yh\_strerror}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}));}
\DoxyCodeLine{00702\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{00703\ \ \ \}}
\DoxyCodeLine{00704\ }
\DoxyCodeLine{00705\ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Generated\ HMAC\ key\ 0x\%04x\(\backslash\)n"{}},\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].w);}
\DoxyCodeLine{00706\ }
\DoxyCodeLine{00707\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00708\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_a2be1be0e0a454965f5a378e4ecb483f0_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_a2be1be0e0a454965f5a378e4ecb483f0_icgraph}
\end{center}
\end{figure}
\Hypertarget{commands_8c_a13416d261c1a92415525cbfa63a2dc0c}\index{commands.c@{commands.c}!yh\_com\_generate\_otp\_aead\_key@{yh\_com\_generate\_otp\_aead\_key}}
\index{yh\_com\_generate\_otp\_aead\_key@{yh\_com\_generate\_otp\_aead\_key}!commands.c@{commands.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_generate\_otp\_aead\_key()}{yh\_com\_generate\_otp\_aead\_key()}}
{\footnotesize\ttfamily \label{commands_8c_a13416d261c1a92415525cbfa63a2dc0c} 
int yh\+\_\+com\+\_\+generate\+\_\+otp\+\_\+aead\+\_\+key (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{commands_8c_source_l02648}{2648}} of file \mbox{\hyperlink{commands_8c_source}{commands.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02649\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02650\ }
\DoxyCodeLine{02651\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(ctx);}
\DoxyCodeLine{02652\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(fmt);}
\DoxyCodeLine{02653\ }
\DoxyCodeLine{02654\ \ \ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366}{yh\_rc}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}};}
\DoxyCodeLine{02655\ }
\DoxyCodeLine{02656\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =}
\DoxyCodeLine{02657\ \ \ \ \ \mbox{\hyperlink{yubihsm_8c_a9e130d225a8dc003d7a7c0ce4b8ea5e4}{yh\_util\_generate\_otp\_aead\_key}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e,\ \&\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].w,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[2].\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}},\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[3].w,}
\DoxyCodeLine{02658\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[4].c,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[5].\mbox{\hyperlink{pointer_8h_aeeddce917cf130d62c370b8f216026dd}{a}},\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[6].d);}
\DoxyCodeLine{02659\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{02660\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ generate\ OTP\ AEAD\ key:\ \%s\(\backslash\)n"{}},\ \mbox{\hyperlink{lib_2error_8c_a238eedb1e27dbff2a0ab9a3932eb3f8b}{yh\_strerror}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}));}
\DoxyCodeLine{02661\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{02662\ \ \ \}}
\DoxyCodeLine{02663\ }
\DoxyCodeLine{02664\ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Generated\ OTP\ AEAD\ key\ 0x\%04x\(\backslash\)n"{}},\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].w);}
\DoxyCodeLine{02665\ }
\DoxyCodeLine{02666\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{02667\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_a13416d261c1a92415525cbfa63a2dc0c_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_a13416d261c1a92415525cbfa63a2dc0c_icgraph}
\end{center}
\end{figure}
\Hypertarget{commands_8c_a43d7d9dd1659838d79f875e61e59ce52}\index{commands.c@{commands.c}!yh\_com\_generate\_wrap@{yh\_com\_generate\_wrap}}
\index{yh\_com\_generate\_wrap@{yh\_com\_generate\_wrap}!commands.c@{commands.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_generate\_wrap()}{yh\_com\_generate\_wrap()}}
{\footnotesize\ttfamily \label{commands_8c_a43d7d9dd1659838d79f875e61e59ce52} 
int yh\+\_\+com\+\_\+generate\+\_\+wrap (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{commands_8c_source_l00719}{719}} of file \mbox{\hyperlink{commands_8c_source}{commands.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00719\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00720\ }
\DoxyCodeLine{00721\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(ctx);}
\DoxyCodeLine{00722\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(fmt);}
\DoxyCodeLine{00723\ }
\DoxyCodeLine{00724\ \ \ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366}{yh\_rc}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}};}
\DoxyCodeLine{00725\ }
\DoxyCodeLine{00726\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a1f749a696792e7911844629e056d9c15}{yh\_util\_generate\_wrap\_key}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e,\ \&\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].w,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[2].\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}},\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[3].w,}
\DoxyCodeLine{00727\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[4].c,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[6].\mbox{\hyperlink{pointer_8h_aeeddce917cf130d62c370b8f216026dd}{a}},\ \&\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[5].c);}
\DoxyCodeLine{00728\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{00729\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ generate\ wrapping\ key:\ \%s\(\backslash\)n"{}},\ \mbox{\hyperlink{lib_2error_8c_a238eedb1e27dbff2a0ab9a3932eb3f8b}{yh\_strerror}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}));}
\DoxyCodeLine{00730\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{00731\ \ \ \}}
\DoxyCodeLine{00732\ }
\DoxyCodeLine{00733\ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Generated\ Wrap\ key\ 0x\%04x\(\backslash\)n"{}},\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].w);}
\DoxyCodeLine{00734\ }
\DoxyCodeLine{00735\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00736\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_a43d7d9dd1659838d79f875e61e59ce52_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_a43d7d9dd1659838d79f875e61e59ce52_icgraph}
\end{center}
\end{figure}
\Hypertarget{commands_8c_aca833cbc2ca7673b00a4f6cb320c97b6}\index{commands.c@{commands.c}!yh\_com\_get\_device\_info@{yh\_com\_get\_device\_info}}
\index{yh\_com\_get\_device\_info@{yh\_com\_get\_device\_info}!commands.c@{commands.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_get\_device\_info()}{yh\_com\_get\_device\_info()}}
{\footnotesize\ttfamily \label{commands_8c_aca833cbc2ca7673b00a4f6cb320c97b6} 
int yh\+\_\+com\+\_\+get\+\_\+device\+\_\+info (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{commands_8c_source_l01876}{1876}} of file \mbox{\hyperlink{commands_8c_source}{commands.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01877\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01878\ }
\DoxyCodeLine{01879\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}});}
\DoxyCodeLine{01880\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(fmt);}
\DoxyCodeLine{01881\ }
\DoxyCodeLine{01882\ \ \ \textcolor{keywordflow}{if}\ (ctx-\/>\mbox{\hyperlink{structyubihsm__context_a8c52c1a89cd4334a0225a1fbfba9a930}{connector}}\ ==\ NULL)\ \{}
\DoxyCodeLine{01883\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Not\ connected\(\backslash\)n"{}});}
\DoxyCodeLine{01884\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{01885\ \ \ \}}
\DoxyCodeLine{01886\ }
\DoxyCodeLine{01887\ \ \ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366}{yh\_rc}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}};}
\DoxyCodeLine{01888\ }
\DoxyCodeLine{01889\ \ \ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a5bd4e4c943762926c8f653b6224cced2}{major}};}
\DoxyCodeLine{01890\ \ \ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae2f416b0a34b7beb4ed3873d791ac393}{minor}};}
\DoxyCodeLine{01891\ \ \ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a00c54fad5fef8d31eb75c1163468005b}{patch}};}
\DoxyCodeLine{01892\ \ \ \mbox{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a1149ca4bd0659030412db8e77bebdf88}{serial}};}
\DoxyCodeLine{01893\ \ \ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ log\_total;}
\DoxyCodeLine{01894\ \ \ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ log\_used;}
\DoxyCodeLine{01895\ \ \ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55ca}{yh\_algorithm}}\ algorithms[\mbox{\hyperlink{yubihsm_8h_a6f472329e64b5720ed637fa886aea8c8}{YH\_MAX\_ALGORITHM\_COUNT}}];}
\DoxyCodeLine{01896\ \ \ \textcolor{keywordtype}{size\_t}\ n\_algorithms\ =\ \textcolor{keyword}{sizeof}(algorithms);}
\DoxyCodeLine{01897\ }
\DoxyCodeLine{01898\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =}
\DoxyCodeLine{01899\ \ \ \ \ \mbox{\hyperlink{yubihsm_8c_a6ab558e1426359cc78e7a362f8b3acd9}{yh\_util\_get\_device\_info}}(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a8c52c1a89cd4334a0225a1fbfba9a930}{connector}},\ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a5bd4e4c943762926c8f653b6224cced2}{major}},\ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_ae2f416b0a34b7beb4ed3873d791ac393}{minor}},\ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a00c54fad5fef8d31eb75c1163468005b}{patch}},\ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a1149ca4bd0659030412db8e77bebdf88}{serial}},}
\DoxyCodeLine{01900\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&log\_total,\ \&log\_used,\ algorithms,\ \&n\_algorithms);}
\DoxyCodeLine{01901\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{01902\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ get\ device\ info:\ \%s\(\backslash\)n"{}},\ \mbox{\hyperlink{lib_2error_8c_a238eedb1e27dbff2a0ab9a3932eb3f8b}{yh\_strerror}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}));}
\DoxyCodeLine{01903\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{01904\ \ \ \}}
\DoxyCodeLine{01905\ }
\DoxyCodeLine{01906\ \ \ fprintf(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}},\ \textcolor{stringliteral}{"{}Version\ number:\(\backslash\)t\(\backslash\)t\%hhu.\%hhu.\%hhu\(\backslash\)n"{}},\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a5bd4e4c943762926c8f653b6224cced2}{major}},\ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae2f416b0a34b7beb4ed3873d791ac393}{minor}},\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a00c54fad5fef8d31eb75c1163468005b}{patch}});}
\DoxyCodeLine{01907\ \ \ fprintf(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}},\ \textcolor{stringliteral}{"{}Serial\ number:\(\backslash\)t\(\backslash\)t\%u\(\backslash\)n"{}},\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a1149ca4bd0659030412db8e77bebdf88}{serial}});}
\DoxyCodeLine{01908\ \ \ fprintf(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}},\ \textcolor{stringliteral}{"{}Log\ used:\(\backslash\)t\(\backslash\)t\%d/\%d\(\backslash\)n"{}},\ log\_used,\ log\_total);}
\DoxyCodeLine{01909\ }
\DoxyCodeLine{01910\ \ \ fprintf(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}},\ \textcolor{stringliteral}{"{}Supported\ algorithms:\(\backslash\)t"{}});}
\DoxyCodeLine{01911\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ n\_algorithms;\ i++)\ \{}
\DoxyCodeLine{01912\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *algo\_str;}
\DoxyCodeLine{01913\ \ \ \ \ \mbox{\hyperlink{yubihsm_8c_a2a0d369611aa795c62645467062a9acb}{yh\_algo\_to\_string}}(algorithms[i],\ \&algo\_str);}
\DoxyCodeLine{01914\ \ \ \ \ fprintf(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}},\ \textcolor{stringliteral}{"{}\%s,\ "{}},\ algo\_str);}
\DoxyCodeLine{01915\ \ \ \ \ \textcolor{keywordflow}{if}\ ((i\ +\ 1)\ \%\ 3\ ==\ 0\ \&\&\ i\ !=\ 0)\ \{}
\DoxyCodeLine{01916\ \ \ \ \ \ \ fprintf(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}},\ \textcolor{stringliteral}{"{}\(\backslash\)n\(\backslash\)t\(\backslash\)t\(\backslash\)t"{}});}
\DoxyCodeLine{01917\ \ \ \ \ \}}
\DoxyCodeLine{01918\ \ \ \}}
\DoxyCodeLine{01919\ \ \ fprintf(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}},\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{01920\ }
\DoxyCodeLine{01921\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{01922\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_aca833cbc2ca7673b00a4f6cb320c97b6_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_aca833cbc2ca7673b00a4f6cb320c97b6_icgraph}
\end{center}
\end{figure}
\Hypertarget{commands_8c_afa7330c81148ba6f4d5c53f7c370ed41}\index{commands.c@{commands.c}!yh\_com\_get\_object\_info@{yh\_com\_get\_object\_info}}
\index{yh\_com\_get\_object\_info@{yh\_com\_get\_object\_info}!commands.c@{commands.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_get\_object\_info()}{yh\_com\_get\_object\_info()}}
{\footnotesize\ttfamily \label{commands_8c_afa7330c81148ba6f4d5c53f7c370ed41} 
int yh\+\_\+com\+\_\+get\+\_\+object\+\_\+info (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{commands_8c_source_l00924}{924}} of file \mbox{\hyperlink{commands_8c_source}{commands.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00925\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00926\ \ \ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366}{yh\_rc}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}};}
\DoxyCodeLine{00927\ \ \ \mbox{\hyperlink{structyh__object__descriptor}{yh\_object\_descriptor}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a85d991d90970121ba1480cd98d93aab9}{object}};}
\DoxyCodeLine{00928\ }
\DoxyCodeLine{00929\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(ctx);}
\DoxyCodeLine{00930\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(fmt);}
\DoxyCodeLine{00931\ }
\DoxyCodeLine{00932\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a7b5f1f0c1cbca11fbe21e7e4e6b29a1b}{yh\_util\_get\_object\_info}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].w,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[2].b,\ \&\textcolor{keywordtype}{object});}
\DoxyCodeLine{00933\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{00934\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ get\ object\ info:\ \%s\(\backslash\)n"{}},\ \mbox{\hyperlink{lib_2error_8c_a238eedb1e27dbff2a0ab9a3932eb3f8b}{yh\_strerror}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}));}
\DoxyCodeLine{00935\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{00936\ \ \ \}}
\DoxyCodeLine{00937\ }
\DoxyCodeLine{00938\ \ \ \textcolor{keywordtype}{char}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a5420fd4d2f76428942c2716b1cb7e863}{domains}}[256]\ =\ \{0\};}
\DoxyCodeLine{00939\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *cap[\textcolor{keyword}{sizeof}(yh\_capability)\ /\ \textcolor{keyword}{sizeof}(yh\_capability[0])];}
\DoxyCodeLine{00940\ \ \ \textcolor{keywordtype}{size\_t}\ n\_cap\ =\ \textcolor{keyword}{sizeof}(yh\_capability)\ /\ \textcolor{keyword}{sizeof}(yh\_capability[0]);}
\DoxyCodeLine{00941\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *\mbox{\hyperlink{yubihsm_8h_a1d127017fb298b889f4ba24752d08b8e}{type}};}
\DoxyCodeLine{00942\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *\mbox{\hyperlink{yubihsm_8h_a67bb26eddc39413f8e94c98aedbbd391}{algorithm}}\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{00943\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *extra\_algo\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{00944\ \ \ \mbox{\hyperlink{yubihsm_8c_afe3d701f7470c1d7b05480e4b6728bf7}{yh\_type\_to\_string}}(\textcolor{keywordtype}{object}.type,\ \&type);}
\DoxyCodeLine{00945\ \ \ \textcolor{keywordflow}{if}\ (\textcolor{keywordtype}{object}.\mbox{\hyperlink{yubihsm_8h_a67bb26eddc39413f8e94c98aedbbd391}{algorithm}})\ \{}
\DoxyCodeLine{00946\ \ \ \ \ \mbox{\hyperlink{yubihsm_8c_a2a0d369611aa795c62645467062a9acb}{yh\_algo\_to\_string}}(\textcolor{keywordtype}{object}.\mbox{\hyperlink{yubihsm_8h_a67bb26eddc39413f8e94c98aedbbd391}{algorithm}},\ \&\mbox{\hyperlink{yubihsm_8h_a67bb26eddc39413f8e94c98aedbbd391}{algorithm}});}
\DoxyCodeLine{00947\ \ \ \ \ extra\_algo\ =\ \textcolor{stringliteral}{"{},\ algorithm:\ "{}};}
\DoxyCodeLine{00948\ \ \ \}}
\DoxyCodeLine{00949\ \ \ \mbox{\hyperlink{yubihsm_8c_a0100df295f7ecf0d0cc90052aac20586}{yh\_domains\_to\_string}}(\textcolor{keywordtype}{object}.\mbox{\hyperlink{yubihsm__pkcs11_8c_a5420fd4d2f76428942c2716b1cb7e863}{domains}},\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a5420fd4d2f76428942c2716b1cb7e863}{domains}},\ 255);}
\DoxyCodeLine{00950\ }
\DoxyCodeLine{00951\ \ \ fprintf(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}},}
\DoxyCodeLine{00952\ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}id:\ 0x\%04x,\ type:\ \%s\%s\%s,\ label:\ \(\backslash\)"{}\%s\(\backslash\)"{},\ length:\ \%d,\ "{}}}
\DoxyCodeLine{00953\ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}domains:\ \%s,\ sequence:\ \%hhu,\ origin:\ "{}},}
\DoxyCodeLine{00954\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{object}.id,\ type,\ extra\_algo,\ \mbox{\hyperlink{yubihsm_8h_a67bb26eddc39413f8e94c98aedbbd391}{algorithm}},\ \textcolor{keywordtype}{object}.label,\ \textcolor{keywordtype}{object}.len,}
\DoxyCodeLine{00955\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a5420fd4d2f76428942c2716b1cb7e863}{domains}},\ \textcolor{keywordtype}{object}.sequence);}
\DoxyCodeLine{00956\ }
\DoxyCodeLine{00957\ \ \ \textcolor{keywordflow}{if}\ (\textcolor{keywordtype}{object}.origin\ \&\ \mbox{\hyperlink{yubihsm_8h_a1b233ade526e2b1a6313e2e2d892bd88}{YH\_ORIGIN\_GENERATED}})\ \{}
\DoxyCodeLine{00958\ \ \ \ \ fprintf(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}},\ \textcolor{stringliteral}{"{}generated"{}});}
\DoxyCodeLine{00959\ \ \ \}}
\DoxyCodeLine{00960\ \ \ \textcolor{keywordflow}{if}\ (\textcolor{keywordtype}{object}.origin\ \&\ \mbox{\hyperlink{yubihsm_8h_a1b58deb7ffe0ac04a240e07923a8a613}{YH\_ORIGIN\_IMPORTED}})\ \{}
\DoxyCodeLine{00961\ \ \ \ \ fprintf(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}},\ \textcolor{stringliteral}{"{}imported"{}});}
\DoxyCodeLine{00962\ \ \ \}}
\DoxyCodeLine{00963\ \ \ \textcolor{keywordflow}{if}\ (\textcolor{keywordtype}{object}.origin\ \&\ \mbox{\hyperlink{yubihsm_8h_a03f1a4cf5b57bc3a4eababaee26aa801}{YH\_ORIGIN\_IMPORTED\_WRAPPED}})\ \{}
\DoxyCodeLine{00964\ \ \ \ \ fprintf(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}},\ \textcolor{stringliteral}{"{}:imported\_wrapped"{}});}
\DoxyCodeLine{00965\ \ \ \}}
\DoxyCodeLine{00966\ }
\DoxyCodeLine{00967\ \ \ fprintf(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}},\ \textcolor{stringliteral}{"{},\ capabilities:\ "{}});}
\DoxyCodeLine{00968\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm_8c_ac46bac75dfd0a4358a4e6b432a50e48a}{yh\_capabilities\_to\_strings}}(\&\textcolor{keywordtype}{object}.\mbox{\hyperlink{yubihsm__pkcs11_8c_a08393519edfd7c59fb01fb8db97514b5}{capabilities}},\ cap,\ \&n\_cap)\ !=}
\DoxyCodeLine{00969\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{00970\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{yubihsm_8h_ad3c904849d17cae0a6f426e8007731d7}{YH\_CAPABILITIES\_LEN}};\ i++)\ \{}
\DoxyCodeLine{00971\ \ \ \ \ \ \ fprintf(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}},\ \textcolor{stringliteral}{"{}0x\%02x\%s"{}},\ \textcolor{keywordtype}{object}.capabilities.capabilities[i],}
\DoxyCodeLine{00972\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ i\ <\ \mbox{\hyperlink{yubihsm_8h_ad3c904849d17cae0a6f426e8007731d7}{YH\_CAPABILITIES\_LEN}}\ -\/\ 1\ ?\ \textcolor{stringliteral}{"{}\ "{}}\ :\ \textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{00973\ \ \ \ \ \}}
\DoxyCodeLine{00974\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00975\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ n\_cap;\ i++)\ \{}
\DoxyCodeLine{00976\ \ \ \ \ \ \ fprintf(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}},\ \textcolor{stringliteral}{"{}\%s\%s"{}},\ cap[i],\ i\ <\ n\_cap\ -\/\ 1\ ?\ \textcolor{stringliteral}{"{}:"{}}\ :\ \textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{00977\ \ \ \ \ \}}
\DoxyCodeLine{00978\ \ \ \}}
\DoxyCodeLine{00979\ \ \ \textcolor{keywordflow}{if}\ (\textcolor{keywordtype}{object}.type\ ==\ \mbox{\hyperlink{yubihsm_8h_a2fe39512cb4df34b270a67dbb8e13583a16f0118db1dac3d0732e7d66630e1dba}{YH\_WRAP\_KEY}}\ ||\ \textcolor{keywordtype}{object}.type\ ==\ \mbox{\hyperlink{yubihsm_8h_a2fe39512cb4df34b270a67dbb8e13583acee44b775b3c5b6157f0732699935074}{YH\_AUTHENTICATION\_KEY}})\ \{}
\DoxyCodeLine{00980\ \ \ \ \ fprintf(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}},\ \textcolor{stringliteral}{"{},\ delegated\_capabilities:\ "{}});}
\DoxyCodeLine{00981\ \ \ \ \ n\_cap\ =\ \textcolor{keyword}{sizeof}(yh\_capability)\ /\ \textcolor{keyword}{sizeof}(yh\_capability[0]);}
\DoxyCodeLine{00982\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm_8c_ac46bac75dfd0a4358a4e6b432a50e48a}{yh\_capabilities\_to\_strings}}(\&\textcolor{keywordtype}{object}.\mbox{\hyperlink{yubihsm__pkcs11_8c_afa62e10709d52e5162a732e81369a7ec}{delegated\_capabilities}},\ cap,}
\DoxyCodeLine{00983\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&n\_cap)\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{00984\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{yubihsm_8h_ad3c904849d17cae0a6f426e8007731d7}{YH\_CAPABILITIES\_LEN}};\ i++)\ \{}
\DoxyCodeLine{00985\ \ \ \ \ \ \ \ \ fprintf(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}},\ \textcolor{stringliteral}{"{}0x\%02x\%s"{}},}
\DoxyCodeLine{00986\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{object}.delegated\_capabilities.capabilities[i],}
\DoxyCodeLine{00987\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ i\ <\ \mbox{\hyperlink{yubihsm_8h_ad3c904849d17cae0a6f426e8007731d7}{YH\_CAPABILITIES\_LEN}}\ -\/\ 1\ ?\ \textcolor{stringliteral}{"{}\ "{}}\ :\ \textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{00988\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00989\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00990\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ n\_cap;\ i++)\ \{}
\DoxyCodeLine{00991\ \ \ \ \ \ \ \ \ fprintf(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}},\ \textcolor{stringliteral}{"{}\%s\%s"{}},\ cap[i],\ i\ <\ n\_cap\ -\/\ 1\ ?\ \textcolor{stringliteral}{"{}:"{}}\ :\ \textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{00992\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00993\ \ \ \ \ \}}
\DoxyCodeLine{00994\ \ \ \}}
\DoxyCodeLine{00995\ \ \ fprintf(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}},\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{00996\ }
\DoxyCodeLine{00997\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00998\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_afa7330c81148ba6f4d5c53f7c370ed41_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_afa7330c81148ba6f4d5c53f7c370ed41_icgraph}
\end{center}
\end{figure}
\Hypertarget{commands_8c_ad8a4781a26be12a87848234cc184a3bb}\index{commands.c@{commands.c}!yh\_com\_get\_opaque@{yh\_com\_get\_opaque}}
\index{yh\_com\_get\_opaque@{yh\_com\_get\_opaque}!commands.c@{commands.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_get\_opaque()}{yh\_com\_get\_opaque()}}
{\footnotesize\ttfamily \label{commands_8c_ad8a4781a26be12a87848234cc184a3bb} 
int yh\+\_\+com\+\_\+get\+\_\+opaque (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{commands_8c_source_l00743}{743}} of file \mbox{\hyperlink{commands_8c_source}{commands.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00743\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00744\ }
\DoxyCodeLine{00745\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(ctx);}
\DoxyCodeLine{00746\ }
\DoxyCodeLine{00747\ \ \ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ response[\mbox{\hyperlink{yubihsm_8h_a706bd8e7adf0de85e6cfb0efc8981d3f}{YH\_MSG\_BUF\_SIZE}}];}
\DoxyCodeLine{00748\ \ \ \textcolor{keywordtype}{size\_t}\ response\_len\ =\ \textcolor{keyword}{sizeof}(response);}
\DoxyCodeLine{00749\ }
\DoxyCodeLine{00750\ \ \ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366}{yh\_rc}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a56e060e71fb8baa0531b3a20848abf37}{yh\_util\_get\_opaque}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].w,\ response,\ \&response\_len);}
\DoxyCodeLine{00751\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{00752\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ get\ opaque\ object:\ \%s\(\backslash\)n"{}},\ \mbox{\hyperlink{lib_2error_8c_a238eedb1e27dbff2a0ab9a3932eb3f8b}{yh\_strerror}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}));}
\DoxyCodeLine{00753\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{00754\ \ \ \}}
\DoxyCodeLine{00755\ }
\DoxyCodeLine{00756\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{util_8c_ad969d220471d10a9f07080b50210f403}{write\_file}}(response,\ response\_len,\ ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}},\ fmt\_to\_fmt(fmt)))\ \{}
\DoxyCodeLine{00757\ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00758\ \ \ \}}
\DoxyCodeLine{00759\ }
\DoxyCodeLine{00760\ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{00761\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_ad8a4781a26be12a87848234cc184a3bb_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_ad8a4781a26be12a87848234cc184a3bb_icgraph}
\end{center}
\end{figure}
\Hypertarget{commands_8c_aaafb1f743869a0068a7d7b6ed1bafb01}\index{commands.c@{commands.c}!yh\_com\_get\_option@{yh\_com\_get\_option}}
\index{yh\_com\_get\_option@{yh\_com\_get\_option}!commands.c@{commands.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_get\_option()}{yh\_com\_get\_option()}}
{\footnotesize\ttfamily \label{commands_8c_aaafb1f743869a0068a7d7b6ed1bafb01} 
int yh\+\_\+com\+\_\+get\+\_\+option (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{commands_8c_source_l00767}{767}} of file \mbox{\hyperlink{commands_8c_source}{commands.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00767\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00768\ }
\DoxyCodeLine{00769\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(ctx);}
\DoxyCodeLine{00770\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(fmt);}
\DoxyCodeLine{00771\ }
\DoxyCodeLine{00772\ \ \ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366}{yh\_rc}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}};}
\DoxyCodeLine{00773\ }
\DoxyCodeLine{00774\ \ \ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ response[\mbox{\hyperlink{yubihsm_8h_a706bd8e7adf0de85e6cfb0efc8981d3f}{YH\_MSG\_BUF\_SIZE}}];}
\DoxyCodeLine{00775\ \ \ \textcolor{keywordtype}{size\_t}\ response\_len\ =\ \textcolor{keyword}{sizeof}(response);}
\DoxyCodeLine{00776\ }
\DoxyCodeLine{00777\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a11871e03c808e2d25737f893e58ed094}{yh\_util\_get\_option}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].o,\ response,\ \&response\_len);}
\DoxyCodeLine{00778\ }
\DoxyCodeLine{00779\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{00780\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ get\ option:\ \%s\(\backslash\)n"{}},\ \mbox{\hyperlink{lib_2error_8c_a238eedb1e27dbff2a0ab9a3932eb3f8b}{yh\_strerror}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}));}
\DoxyCodeLine{00781\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{00782\ \ \ \}}
\DoxyCodeLine{00783\ }
\DoxyCodeLine{00784\ \ \ fprintf(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}},\ \textcolor{stringliteral}{"{}Option\ value\ is:\ "{}});}
\DoxyCodeLine{00785\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t}}\ i\ =\ 0;\ i\ <\ response\_len;\ i++)\ \{}
\DoxyCodeLine{00786\ \ \ \ \ fprintf(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}},\ \textcolor{stringliteral}{"{}\%02x"{}},\ response[i]);}
\DoxyCodeLine{00787\ \ \ \}}
\DoxyCodeLine{00788\ \ \ fprintf(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}},\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{00789\ }
\DoxyCodeLine{00790\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00791\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_aaafb1f743869a0068a7d7b6ed1bafb01_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_aaafb1f743869a0068a7d7b6ed1bafb01_icgraph}
\end{center}
\end{figure}
\Hypertarget{commands_8c_aa1c9a933f4601dae48cd64f911d297aa}\index{commands.c@{commands.c}!yh\_com\_get\_pubkey@{yh\_com\_get\_pubkey}}
\index{yh\_com\_get\_pubkey@{yh\_com\_get\_pubkey}!commands.c@{commands.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_get\_pubkey()}{yh\_com\_get\_pubkey()}}
{\footnotesize\ttfamily \label{commands_8c_aa1c9a933f4601dae48cd64f911d297aa} 
int yh\+\_\+com\+\_\+get\+\_\+pubkey (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{commands_8c_source_l00850}{850}} of file \mbox{\hyperlink{commands_8c_source}{commands.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00850\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00851\ }
\DoxyCodeLine{00852\ \ \ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366}{yh\_rc}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}};}
\DoxyCodeLine{00853\ }
\DoxyCodeLine{00854\ \ \ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ response[\mbox{\hyperlink{yubihsm_8h_a706bd8e7adf0de85e6cfb0efc8981d3f}{YH\_MSG\_BUF\_SIZE}}];}
\DoxyCodeLine{00855\ \ \ \textcolor{keywordtype}{size\_t}\ response\_len\ =\ \textcolor{keyword}{sizeof}(response);}
\DoxyCodeLine{00856\ }
\DoxyCodeLine{00857\ \ \ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55ca}{yh\_algorithm}}\ algo;}
\DoxyCodeLine{00858\ \ \ EVP\_PKEY\ *public\_key\ =\ NULL;}
\DoxyCodeLine{00859\ }
\DoxyCodeLine{00860\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_aa7b8b42156c4bdaf41d8b9758a2fd73f}{yh\_util\_get\_public\_key}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].w,\ response,\ \&response\_len,}
\DoxyCodeLine{00861\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&algo);}
\DoxyCodeLine{00862\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{00863\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ get\ public\ key:\ \%s\(\backslash\)n"{}},\ \mbox{\hyperlink{lib_2error_8c_a238eedb1e27dbff2a0ab9a3932eb3f8b}{yh\_strerror}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}));}
\DoxyCodeLine{00864\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{00865\ \ \ \}}
\DoxyCodeLine{00866\ }
\DoxyCodeLine{00867\ \ \ public\_key\ =\ EVP\_PKEY\_new();}
\DoxyCodeLine{00868\ }
\DoxyCodeLine{00869\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm_8c_a0a67155f2a7970ecb52e4f6aac6bbe84}{yh\_is\_rsa}}(algo))\ \{}
\DoxyCodeLine{00870\ \ \ \ \ RSA\ *rsa\ =\ RSA\_new();}
\DoxyCodeLine{00871\ \ \ \ \ \mbox{\hyperlink{include_2fc_2crypto_2bigint_8hpp_a62125ea4e1d748a4a9c1aed9766f451a}{BIGNUM}}\ *e\ =\ BN\_new();}
\DoxyCodeLine{00872\ \ \ \ \ \mbox{\hyperlink{include_2fc_2crypto_2bigint_8hpp_a62125ea4e1d748a4a9c1aed9766f451a}{BIGNUM}}\ *n\ =\ BN\_bin2bn(response,\ response\_len,\ NULL);}
\DoxyCodeLine{00873\ \ \ \ \ BN\_hex2bn(\&e,\ \textcolor{stringliteral}{"{}10001"{}});}
\DoxyCodeLine{00874\ \ \ \ \ \mbox{\hyperlink{openssl-compat_8c_ada007b0a8f3f9089fed98a22cb2b1554}{RSA\_set0\_key}}(rsa,\ n,\ e,\ NULL);}
\DoxyCodeLine{00875\ \ \ \ \ EVP\_PKEY\_set1\_RSA(public\_key,\ rsa);}
\DoxyCodeLine{00876\ \ \ \ \ RSA\_free(rsa);}
\DoxyCodeLine{00877\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm_8c_a3032a8f45bfad36ed6157b0158dd7921}{yh\_is\_ec}}(algo))\ \{}
\DoxyCodeLine{00878\ \ \ \ \ EC\_KEY\ *eckey\ =\ EC\_KEY\_new();}
\DoxyCodeLine{00879\ \ \ \ \ \textcolor{keywordtype}{int}\ nid\ =\ \mbox{\hyperlink{util_8c_a4e9f3e93eb6ebbc74d142d6a490de752}{algo2nid}}(algo);}
\DoxyCodeLine{00880\ \ \ \ \ EC\_POINT\ *\mbox{\hyperlink{structpoint}{point}};}
\DoxyCodeLine{00881\ \ \ \ \ EC\_GROUP\ *group\ =\ EC\_GROUP\_new\_by\_curve\_name(nid);}
\DoxyCodeLine{00882\ }
\DoxyCodeLine{00883\ \ \ \ \ EC\_GROUP\_set\_asn1\_flag(group,\ nid);}
\DoxyCodeLine{00884\ \ \ \ \ EC\_KEY\_set\_group(eckey,\ group);}
\DoxyCodeLine{00885\ \ \ \ \ \mbox{\hyperlink{structpoint}{point}}\ =\ EC\_POINT\_new(group);}
\DoxyCodeLine{00886\ }
\DoxyCodeLine{00887\ \ \ \ \ memmove(response\ +\ 1,\ response,\ response\_len);}
\DoxyCodeLine{00888\ \ \ \ \ response[0]\ =\ 0x04;\ \textcolor{comment}{//\ hack\ to\ make\ it\ a\ valid\ ec\ pubkey..}}
\DoxyCodeLine{00889\ \ \ \ \ response\_len++;}
\DoxyCodeLine{00890\ }
\DoxyCodeLine{00891\ \ \ \ \ EC\_POINT\_oct2point(group,\ \mbox{\hyperlink{structpoint}{point}},\ response,\ response\_len,\ NULL);}
\DoxyCodeLine{00892\ }
\DoxyCodeLine{00893\ \ \ \ \ EC\_KEY\_set\_public\_key(eckey,\ \mbox{\hyperlink{structpoint}{point}});}
\DoxyCodeLine{00894\ }
\DoxyCodeLine{00895\ \ \ \ \ EVP\_PKEY\_set1\_EC\_KEY(public\_key,\ eckey);}
\DoxyCodeLine{00896\ }
\DoxyCodeLine{00897\ \ \ \ \ EC\_POINT\_free(\mbox{\hyperlink{structpoint}{point}});}
\DoxyCodeLine{00898\ \ \ \ \ EC\_KEY\_free(eckey);}
\DoxyCodeLine{00899\ \ \ \ \ EC\_GROUP\_free(group);}
\DoxyCodeLine{00900\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00901\ \ \ \ \ \textcolor{comment}{//\ NOTE(adma):\ ED25519,\ there\ is\ no\ support\ for\ thi\ in\ OpenSSL,\ so}}
\DoxyCodeLine{00902\ \ \ \ \ \textcolor{comment}{//\ we\ manually\ export\ them}}
\DoxyCodeLine{00903\ \ \ \ \ EVP\_PKEY\_free(public\_key);}
\DoxyCodeLine{00904\ \ \ \ \ \mbox{\hyperlink{util_8c_a8daf6956da2dcd44bc4ff4e7a7959ac0}{write\_ed25519\_key}}(response,\ response\_len,\ ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}},}
\DoxyCodeLine{00905\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ctx-\/>\mbox{\hyperlink{structyubihsm__context_addfaa9a6a08f58bdb5b5a93f2e89ccc2}{out\_fmt}}\ ==\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708aa8908f2c651567ae288c587240e71d3e}{fmt\_PEM}});\ \textcolor{comment}{//\ FIXME:\ do\ something}}
\DoxyCodeLine{00906\ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00907\ \ \ \}}
\DoxyCodeLine{00908\ }
\DoxyCodeLine{00909\ \ \ \textcolor{keywordflow}{if}\ (fmt\ ==\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708aa8908f2c651567ae288c587240e71d3e}{fmt\_PEM}})\ \{}
\DoxyCodeLine{00910\ \ \ \ \ PEM\_write\_PUBKEY(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}},\ public\_key);}
\DoxyCodeLine{00911\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (fmt\ ==\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a701725c70fb214e14a2feee390939a09}{fmt\_binary}})\ \{}
\DoxyCodeLine{00912\ \ \ \ \ i2d\_PUBKEY\_fp(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}},\ public\_key);}
\DoxyCodeLine{00913\ \ \ \}\ \textcolor{comment}{//\ FIXME:\ other\ formats\ or\ error.}}
\DoxyCodeLine{00914\ \ \ EVP\_PKEY\_free(public\_key);}
\DoxyCodeLine{00915\ }
\DoxyCodeLine{00916\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00917\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_aa1c9a933f4601dae48cd64f911d297aa_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_aa1c9a933f4601dae48cd64f911d297aa_icgraph}
\end{center}
\end{figure}
\Hypertarget{commands_8c_af32a8f10f2d022ca8b7816e6f4809a24}\index{commands.c@{commands.c}!yh\_com\_get\_random@{yh\_com\_get\_random}}
\index{yh\_com\_get\_random@{yh\_com\_get\_random}!commands.c@{commands.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_get\_random()}{yh\_com\_get\_random()}}
{\footnotesize\ttfamily \label{commands_8c_af32a8f10f2d022ca8b7816e6f4809a24} 
int yh\+\_\+com\+\_\+get\+\_\+random (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{commands_8c_source_l00797}{797}} of file \mbox{\hyperlink{commands_8c_source}{commands.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00797\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00798\ }
\DoxyCodeLine{00799\ \ \ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ response[\mbox{\hyperlink{yubihsm_8h_a706bd8e7adf0de85e6cfb0efc8981d3f}{YH\_MSG\_BUF\_SIZE}}];}
\DoxyCodeLine{00800\ \ \ \textcolor{keywordtype}{size\_t}\ response\_len\ =\ \textcolor{keyword}{sizeof}(response);}
\DoxyCodeLine{00801\ }
\DoxyCodeLine{00802\ \ \ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366}{yh\_rc}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =}
\DoxyCodeLine{00803\ \ \ \ \ \mbox{\hyperlink{yubihsm_8c_af1bc8ed34687d83701eb3cc673ad4b96}{yh\_util\_get\_pseudo\_random}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].w,\ response,\ \&response\_len);}
\DoxyCodeLine{00804\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{00805\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ get\ pseudo\ random\ bytes:\ \%s\(\backslash\)n"{}},}
\DoxyCodeLine{00806\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{lib_2error_8c_a238eedb1e27dbff2a0ab9a3932eb3f8b}{yh\_strerror}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}));}
\DoxyCodeLine{00807\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{00808\ \ \ \}}
\DoxyCodeLine{00809\ }
\DoxyCodeLine{00810\ \ \ \textcolor{keywordflow}{if}\ (response\_len\ !=\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].w)\ \{}
\DoxyCodeLine{00811\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Wrong\ response\ length\(\backslash\)n"{}});}
\DoxyCodeLine{00812\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{00813\ \ \ \}}
\DoxyCodeLine{00814\ }
\DoxyCodeLine{00815\ \ \ \mbox{\hyperlink{util_8c_ad969d220471d10a9f07080b50210f403}{write\_file}}(response,\ response\_len,\ ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}},\ fmt\_to\_fmt(fmt));}
\DoxyCodeLine{00816\ }
\DoxyCodeLine{00817\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00818\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_af32a8f10f2d022ca8b7816e6f4809a24_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_af32a8f10f2d022ca8b7816e6f4809a24_icgraph}
\end{center}
\end{figure}
\Hypertarget{commands_8c_a408c9e43b8ccb159acb178f2b20f3f77}\index{commands.c@{commands.c}!yh\_com\_get\_storage@{yh\_com\_get\_storage}}
\index{yh\_com\_get\_storage@{yh\_com\_get\_storage}!commands.c@{commands.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_get\_storage()}{yh\_com\_get\_storage()}}
{\footnotesize\ttfamily \label{commands_8c_a408c9e43b8ccb159acb178f2b20f3f77} 
int yh\+\_\+com\+\_\+get\+\_\+storage (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{commands_8c_source_l00823}{823}} of file \mbox{\hyperlink{commands_8c_source}{commands.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00823\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00824\ }
\DoxyCodeLine{00825\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(ctx);}
\DoxyCodeLine{00826\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(fmt);}
\DoxyCodeLine{00827\ }
\DoxyCodeLine{00828\ \ \ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366}{yh\_rc}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}};}
\DoxyCodeLine{00829\ \ \ \mbox{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t}}\ total\_records,\ free\_records,\ free\_pages,\ total\_pages,\ \mbox{\hyperlink{namespacesysio_1_1vm_a0ae6751a77293216df4656dee5081eb2a10108b6260714ad13914454c1dd1ec8f}{page\_size}};}
\DoxyCodeLine{00830\ \ \ total\_records\ =\ free\_records\ =\ free\_pages\ =\ total\_pages\ =\ \mbox{\hyperlink{namespacesysio_1_1vm_a0ae6751a77293216df4656dee5081eb2a10108b6260714ad13914454c1dd1ec8f}{page\_size}}\ =\ 0;}
\DoxyCodeLine{00831\ }
\DoxyCodeLine{00832\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_ae87d5578703775b9d4151a14435f4a73}{yh\_util\_get\_storage\_info}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e,\ \&total\_records,\ \&free\_records,}
\DoxyCodeLine{00833\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&total\_pages,\ \&free\_pages,\ \&page\_size);}
\DoxyCodeLine{00834\ }
\DoxyCodeLine{00835\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{00836\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ get\ storage\ stats:\ \%s\(\backslash\)n"{}},\ \mbox{\hyperlink{lib_2error_8c_a238eedb1e27dbff2a0ab9a3932eb3f8b}{yh\_strerror}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}));}
\DoxyCodeLine{00837\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{00838\ \ \ \}}
\DoxyCodeLine{00839\ \ \ fprintf(stderr,}
\DoxyCodeLine{00840\ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}free\ records:\ \%d/\%d,\ free\ pages:\ \%d/\%d\ page\ size:\ \%d\ bytes\(\backslash\)n"{}},}
\DoxyCodeLine{00841\ \ \ \ \ \ \ \ \ \ \ free\_records,\ total\_records,\ free\_pages,\ total\_pages,\ page\_size);}
\DoxyCodeLine{00842\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00843\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_a408c9e43b8ccb159acb178f2b20f3f77_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_a408c9e43b8ccb159acb178f2b20f3f77_icgraph}
\end{center}
\end{figure}
\Hypertarget{commands_8c_ac8e5bb8ba179bc997ddc73e03423782d}\index{commands.c@{commands.c}!yh\_com\_get\_template@{yh\_com\_get\_template}}
\index{yh\_com\_get\_template@{yh\_com\_get\_template}!commands.c@{commands.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_get\_template()}{yh\_com\_get\_template()}}
{\footnotesize\ttfamily \label{commands_8c_ac8e5bb8ba179bc997ddc73e03423782d} 
int yh\+\_\+com\+\_\+get\+\_\+template (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{commands_8c_source_l01031}{1031}} of file \mbox{\hyperlink{commands_8c_source}{commands.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01031\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01032\ }
\DoxyCodeLine{01033\ \ \ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ response[\mbox{\hyperlink{yubihsm_8h_a706bd8e7adf0de85e6cfb0efc8981d3f}{YH\_MSG\_BUF\_SIZE}}];}
\DoxyCodeLine{01034\ \ \ \textcolor{keywordtype}{size\_t}\ response\_len\ =\ \textcolor{keyword}{sizeof}(response);}
\DoxyCodeLine{01035\ }
\DoxyCodeLine{01036\ \ \ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366}{yh\_rc}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =}
\DoxyCodeLine{01037\ \ \ \ \ \mbox{\hyperlink{yubihsm_8c_a47768ae0e72beba49f02db1baddf4823}{yh\_util\_get\_template}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].w,\ response,\ \&response\_len);}
\DoxyCodeLine{01038\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{01039\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ get\ template\ object:\ \%s\(\backslash\)n"{}},\ \mbox{\hyperlink{lib_2error_8c_a238eedb1e27dbff2a0ab9a3932eb3f8b}{yh\_strerror}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}));}
\DoxyCodeLine{01040\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{01041\ \ \ \}}
\DoxyCodeLine{01042\ }
\DoxyCodeLine{01043\ \ \ \mbox{\hyperlink{util_8c_ad969d220471d10a9f07080b50210f403}{write\_file}}(response,\ response\_len,\ ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}},\ fmt\_to\_fmt(fmt));}
\DoxyCodeLine{01044\ }
\DoxyCodeLine{01045\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{01046\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_ac8e5bb8ba179bc997ddc73e03423782d_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_ac8e5bb8ba179bc997ddc73e03423782d_icgraph}
\end{center}
\end{figure}
\Hypertarget{commands_8c_ac221d587381b78c747d8290320ee4c0a}\index{commands.c@{commands.c}!yh\_com\_get\_wrapped@{yh\_com\_get\_wrapped}}
\index{yh\_com\_get\_wrapped@{yh\_com\_get\_wrapped}!commands.c@{commands.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_get\_wrapped()}{yh\_com\_get\_wrapped()}}
{\footnotesize\ttfamily \label{commands_8c_ac221d587381b78c747d8290320ee4c0a} 
int yh\+\_\+com\+\_\+get\+\_\+wrapped (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{commands_8c_source_l01007}{1007}} of file \mbox{\hyperlink{commands_8c_source}{commands.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01007\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01008\ \ \ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ response[\mbox{\hyperlink{yubihsm_8h_a706bd8e7adf0de85e6cfb0efc8981d3f}{YH\_MSG\_BUF\_SIZE}}];}
\DoxyCodeLine{01009\ \ \ \textcolor{keywordtype}{size\_t}\ response\_len\ =\ \textcolor{keyword}{sizeof}(response);}
\DoxyCodeLine{01010\ \ \ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366}{yh\_rc}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}};}
\DoxyCodeLine{01011\ }
\DoxyCodeLine{01012\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_aa3f473e6dbb9188ad0269b40921c4f5f}{yh\_util\_export\_wrapped}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].w,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[2].b,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[3].w,}
\DoxyCodeLine{01013\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ response,\ \&response\_len);}
\DoxyCodeLine{01014\ }
\DoxyCodeLine{01015\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{01016\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ get\ wrapped\ object:\ \%s\(\backslash\)n"{}},\ \mbox{\hyperlink{lib_2error_8c_a238eedb1e27dbff2a0ab9a3932eb3f8b}{yh\_strerror}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}));}
\DoxyCodeLine{01017\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{01018\ \ \ \}}
\DoxyCodeLine{01019\ }
\DoxyCodeLine{01020\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{util_8c_ad969d220471d10a9f07080b50210f403}{write\_file}}(response,\ response\_len,\ ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}},\ fmt\_to\_fmt(fmt)))\ \{}
\DoxyCodeLine{01021\ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{01022\ \ \ \}}
\DoxyCodeLine{01023\ }
\DoxyCodeLine{01024\ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{01025\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_ac221d587381b78c747d8290320ee4c0a_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_ac221d587381b78c747d8290320ee4c0a_icgraph}
\end{center}
\end{figure}
\Hypertarget{commands_8c_a8de2999193b4caa2d0d1fd2e8451dba1}\index{commands.c@{commands.c}!yh\_com\_hmac@{yh\_com\_hmac}}
\index{yh\_com\_hmac@{yh\_com\_hmac}!commands.c@{commands.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_hmac()}{yh\_com\_hmac()}}
{\footnotesize\ttfamily \label{commands_8c_a8de2999193b4caa2d0d1fd2e8451dba1} 
int yh\+\_\+com\+\_\+hmac (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{commands_8c_source_l01929}{1929}} of file \mbox{\hyperlink{commands_8c_source}{commands.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01929\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01930\ }
\DoxyCodeLine{01931\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(ctx);}
\DoxyCodeLine{01932\ }
\DoxyCodeLine{01933\ \ \ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366}{yh\_rc}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}};}
\DoxyCodeLine{01934\ }
\DoxyCodeLine{01935\ \ \ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ response[\mbox{\hyperlink{yubihsm_8h_a706bd8e7adf0de85e6cfb0efc8981d3f}{YH\_MSG\_BUF\_SIZE}}];}
\DoxyCodeLine{01936\ \ \ \textcolor{keywordtype}{size\_t}\ response\_len\ =\ \textcolor{keyword}{sizeof}(response);}
\DoxyCodeLine{01937\ }
\DoxyCodeLine{01938\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a9000d43fe8cf7313b319f316521eb0c4}{yh\_util\_sign\_hmac}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].w,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[2].x,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[2].\mbox{\hyperlink{yubihsm__pkcs11_8c_a7360b55975153b822efc5217b7734e6a}{len}},}
\DoxyCodeLine{01939\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ response,\ \&response\_len);}
\DoxyCodeLine{01940\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{01941\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ HMAC\ data:\ \%s\(\backslash\)n"{}},\ \mbox{\hyperlink{lib_2error_8c_a238eedb1e27dbff2a0ab9a3932eb3f8b}{yh\_strerror}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}));}
\DoxyCodeLine{01942\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{01943\ \ \ \}}
\DoxyCodeLine{01944\ }
\DoxyCodeLine{01945\ \ \ \mbox{\hyperlink{util_8c_ad969d220471d10a9f07080b50210f403}{write\_file}}(response,\ response\_len,\ ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}},\ fmt\_to\_fmt(fmt));}
\DoxyCodeLine{01946\ }
\DoxyCodeLine{01947\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{01948\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_a8de2999193b4caa2d0d1fd2e8451dba1_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_a8de2999193b4caa2d0d1fd2e8451dba1_icgraph}
\end{center}
\end{figure}
\Hypertarget{commands_8c_ac981267ad1d570af845289dfb0733b8b}\index{commands.c@{commands.c}!yh\_com\_list\_algorithms@{yh\_com\_list\_algorithms}}
\index{yh\_com\_list\_algorithms@{yh\_com\_list\_algorithms}!commands.c@{commands.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_list\_algorithms()}{yh\_com\_list\_algorithms()}}
{\footnotesize\ttfamily \label{commands_8c_ac981267ad1d570af845289dfb0733b8b} 
int yh\+\_\+com\+\_\+list\+\_\+algorithms (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{commands_8c_source_l01079}{1079}} of file \mbox{\hyperlink{commands_8c_source}{commands.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01080\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01081\ }
\DoxyCodeLine{01082\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(ctx);}
\DoxyCodeLine{01083\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}});}
\DoxyCodeLine{01084\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(fmt);}
\DoxyCodeLine{01085\ }
\DoxyCodeLine{01086\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t}}\ i\ =\ 0;\ i\ <\ \textcolor{keyword}{sizeof}(yh\_algorithms)\ /\ \textcolor{keyword}{sizeof}(yh\_algorithms[0]);}
\DoxyCodeLine{01087\ \ \ \ \ \ \ \ i++)\ \{}
\DoxyCodeLine{01088\ \ \ \ \ fprintf(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}},\ \textcolor{stringliteral}{"{}\%s\(\backslash\)n"{}},\ yh\_algorithms[i].name);}
\DoxyCodeLine{01089\ \ \ \}}
\DoxyCodeLine{01090\ }
\DoxyCodeLine{01091\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{01092\ \}}

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_ac981267ad1d570af845289dfb0733b8b_icgraph}
\end{center}
\end{figure}
\Hypertarget{commands_8c_ab7355f80935fb819c440a21d56f181e4}\index{commands.c@{commands.c}!yh\_com\_list\_capabilities@{yh\_com\_list\_capabilities}}
\index{yh\_com\_list\_capabilities@{yh\_com\_list\_capabilities}!commands.c@{commands.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_list\_capabilities()}{yh\_com\_list\_capabilities()}}
{\footnotesize\ttfamily \label{commands_8c_ab7355f80935fb819c440a21d56f181e4} 
int yh\+\_\+com\+\_\+list\+\_\+capabilities (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{commands_8c_source_l01061}{1061}} of file \mbox{\hyperlink{commands_8c_source}{commands.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01062\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01063\ }
\DoxyCodeLine{01064\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(ctx);}
\DoxyCodeLine{01065\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}});}
\DoxyCodeLine{01066\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(fmt);}
\DoxyCodeLine{01067\ }
\DoxyCodeLine{01068\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t}}\ i\ =\ 0;\ i\ <\ \textcolor{keyword}{sizeof}(yh\_capability)\ /\ \textcolor{keyword}{sizeof}(yh\_capability[0]);}
\DoxyCodeLine{01069\ \ \ \ \ \ \ \ i++)\ \{}
\DoxyCodeLine{01070\ \ \ \ \ fprintf(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}},\ \textcolor{stringliteral}{"{}\%-\/30s\ (\%016llx)\(\backslash\)n"{}},\ yh\_capability[i].name,}
\DoxyCodeLine{01071\ \ \ \ \ \ \ \ \ \ \ \ \ 1ULL\ <<\ yh\_capability[i].bit);}
\DoxyCodeLine{01072\ \ \ \}}
\DoxyCodeLine{01073\ }
\DoxyCodeLine{01074\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{01075\ \}}

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_ab7355f80935fb819c440a21d56f181e4_icgraph}
\end{center}
\end{figure}
\Hypertarget{commands_8c_a2b752129687a9ca758661e0b6625b59c}\index{commands.c@{commands.c}!yh\_com\_list\_objects@{yh\_com\_list\_objects}}
\index{yh\_com\_list\_objects@{yh\_com\_list\_objects}!commands.c@{commands.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_list\_objects()}{yh\_com\_list\_objects()}}
{\footnotesize\ttfamily \label{commands_8c_a2b752129687a9ca758661e0b6625b59c} 
int yh\+\_\+com\+\_\+list\+\_\+objects (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{commands_8c_source_l01146}{1146}} of file \mbox{\hyperlink{commands_8c_source}{commands.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01146\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01147\ \ \ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366}{yh\_rc}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}};}
\DoxyCodeLine{01148\ \ \ \mbox{\hyperlink{structyh__object__descriptor}{yh\_object\_descriptor}}\ objects[\mbox{\hyperlink{yubihsm_8h_a331b70d37ded99854638ff5ef0ca9735}{YH\_MAX\_ITEMS\_COUNT}}];}
\DoxyCodeLine{01149\ \ \ \textcolor{keywordtype}{size\_t}\ num\_objects\ =\ \mbox{\hyperlink{yubihsm_8h_a331b70d37ded99854638ff5ef0ca9735}{YH\_MAX\_ITEMS\_COUNT}};}
\DoxyCodeLine{01150\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *label\_arg;}
\DoxyCodeLine{01151\ }
\DoxyCodeLine{01152\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(ctx);}
\DoxyCodeLine{01153\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(fmt);}
\DoxyCodeLine{01154\ }
\DoxyCodeLine{01155\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[6].\mbox{\hyperlink{yubihsm__pkcs11_8c_a7360b55975153b822efc5217b7734e6a}{len}}\ ==\ 0)\ \{}
\DoxyCodeLine{01156\ \ \ \ \ label\_arg\ =\ NULL;}
\DoxyCodeLine{01157\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01158\ \ \ \ \ label\_arg\ =\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[6].s;}
\DoxyCodeLine{01159\ \ \ \}}
\DoxyCodeLine{01160\ }
\DoxyCodeLine{01161\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =}
\DoxyCodeLine{01162\ \ \ \ \ \mbox{\hyperlink{yubihsm_8c_a7cbea7103efff8473ccfaaa35bfc6346}{yh\_util\_list\_objects}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].w,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[2].b,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[3].w,\ \&\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[4].c,}
\DoxyCodeLine{01163\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[5].\mbox{\hyperlink{pointer_8h_aeeddce917cf130d62c370b8f216026dd}{a}},\ label\_arg,\ objects,\ \&num\_objects);}
\DoxyCodeLine{01164\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{01165\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ list\ objects:\ \%s\(\backslash\)n"{}},\ \mbox{\hyperlink{lib_2error_8c_a238eedb1e27dbff2a0ab9a3932eb3f8b}{yh\_strerror}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}));}
\DoxyCodeLine{01166\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{01167\ \ \ \}}
\DoxyCodeLine{01168\ }
\DoxyCodeLine{01169\ \ \ qsort(objects,\ num\_objects,\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structyh__object__descriptor}{yh\_object\_descriptor}}),\ compare\_objects);}
\DoxyCodeLine{01170\ }
\DoxyCodeLine{01171\ \ \ fprintf(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}},\ \textcolor{stringliteral}{"{}Found\ \%zu\ object(s)\(\backslash\)n"{}},\ num\_objects);}
\DoxyCodeLine{01172\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ num\_objects;\ i++)\ \{}
\DoxyCodeLine{01173\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *type\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{01174\ \ \ \ \ \mbox{\hyperlink{yubihsm_8c_afe3d701f7470c1d7b05480e4b6728bf7}{yh\_type\_to\_string}}(objects[i].type,\ \&type);}
\DoxyCodeLine{01175\ \ \ \ \ fprintf(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}},\ \textcolor{stringliteral}{"{}id:\ 0x\%04x,\ type:\ \%s,\ sequence:\ \%hhu\(\backslash\)n"{}},\ objects[i].id,}
\DoxyCodeLine{01176\ \ \ \ \ \ \ \ \ \ \ \ \ type,\ objects[i].sequence);}
\DoxyCodeLine{01177\ \ \ \}}
\DoxyCodeLine{01178\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{01179\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_a2b752129687a9ca758661e0b6625b59c_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_a2b752129687a9ca758661e0b6625b59c_icgraph}
\end{center}
\end{figure}
\Hypertarget{commands_8c_ab98950b39a19499a22ec6b2e874525a5}\index{commands.c@{commands.c}!yh\_com\_list\_sessions@{yh\_com\_list\_sessions}}
\index{yh\_com\_list\_sessions@{yh\_com\_list\_sessions}!commands.c@{commands.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_list\_sessions()}{yh\_com\_list\_sessions()}}
{\footnotesize\ttfamily \label{commands_8c_ab98950b39a19499a22ec6b2e874525a5} 
int yh\+\_\+com\+\_\+list\+\_\+sessions (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{commands_8c_source_l01111}{1111}} of file \mbox{\hyperlink{commands_8c_source}{commands.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01111\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01112\ }
\DoxyCodeLine{01113\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}});}
\DoxyCodeLine{01114\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(fmt);}
\DoxyCodeLine{01115\ }
\DoxyCodeLine{01116\ \ \ \textcolor{keywordflow}{if}\ (ctx-\/>\mbox{\hyperlink{structyubihsm__context_a8c52c1a89cd4334a0225a1fbfba9a930}{connector}}\ ==\ NULL)\ \{}
\DoxyCodeLine{01117\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Not\ connected\(\backslash\)n"{}});}
\DoxyCodeLine{01118\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{01119\ \ \ \}}
\DoxyCodeLine{01120\ }
\DoxyCodeLine{01121\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t}}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{yubihsm_8h_add4e5963a36bd6c9b06c717d705f4c2f}{YH\_MAX\_SESSIONS}};\ i++)\ \{}
\DoxyCodeLine{01122\ \ \ \ \ \textcolor{keywordflow}{if}\ (ctx-\/>\mbox{\hyperlink{structyubihsm__context_a7a959752fa285fb4a7a75921bbfa00fe}{sessions}}[i]\ !=\ NULL)\ \{}
\DoxyCodeLine{01123\ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Session\ \%d\(\backslash\)n"{}},\ i);}
\DoxyCodeLine{01124\ \ \ \ \ \}}
\DoxyCodeLine{01125\ \ \ \}}
\DoxyCodeLine{01126\ }
\DoxyCodeLine{01127\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{01128\ \}}

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_ab98950b39a19499a22ec6b2e874525a5_icgraph}
\end{center}
\end{figure}
\Hypertarget{commands_8c_a65ff18ca1fb6f1b4da386071e1c1a505}\index{commands.c@{commands.c}!yh\_com\_list\_types@{yh\_com\_list\_types}}
\index{yh\_com\_list\_types@{yh\_com\_list\_types}!commands.c@{commands.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_list\_types()}{yh\_com\_list\_types()}}
{\footnotesize\ttfamily \label{commands_8c_a65ff18ca1fb6f1b4da386071e1c1a505} 
int yh\+\_\+com\+\_\+list\+\_\+types (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{commands_8c_source_l01096}{1096}} of file \mbox{\hyperlink{commands_8c_source}{commands.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01096\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01097\ }
\DoxyCodeLine{01098\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(ctx);}
\DoxyCodeLine{01099\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}});}
\DoxyCodeLine{01100\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(fmt);}
\DoxyCodeLine{01101\ }
\DoxyCodeLine{01102\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t}}\ i\ =\ 0;\ i\ <\ \textcolor{keyword}{sizeof}(yh\_types)\ /\ \textcolor{keyword}{sizeof}(yh\_types[0]);\ i++)\ \{}
\DoxyCodeLine{01103\ \ \ \ \ fprintf(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}},\ \textcolor{stringliteral}{"{}\%s\(\backslash\)n"{}},\ yh\_types[i].name);}
\DoxyCodeLine{01104\ \ \ \}}
\DoxyCodeLine{01105\ }
\DoxyCodeLine{01106\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{01107\ \}}

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_a65ff18ca1fb6f1b4da386071e1c1a505_icgraph}
\end{center}
\end{figure}
\Hypertarget{commands_8c_a39d9fd4501c5547cb11e00a3ca37be7e}\index{commands.c@{commands.c}!yh\_com\_noop@{yh\_com\_noop}}
\index{yh\_com\_noop@{yh\_com\_noop}!commands.c@{commands.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_noop()}{yh\_com\_noop()}}
{\footnotesize\ttfamily \label{commands_8c_a39d9fd4501c5547cb11e00a3ca37be7e} 
int yh\+\_\+com\+\_\+noop (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{commands_8c_source_l01050}{1050}} of file \mbox{\hyperlink{commands_8c_source}{commands.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01050\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01051\ }
\DoxyCodeLine{01052\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(ctx);}
\DoxyCodeLine{01053\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}});}
\DoxyCodeLine{01054\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(fmt);}
\DoxyCodeLine{01055\ }
\DoxyCodeLine{01056\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{01057\ \}}

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_a39d9fd4501c5547cb11e00a3ca37be7e_icgraph}
\end{center}
\end{figure}
\Hypertarget{commands_8c_a22f22a25151b12c7573f80563a341368}\index{commands.c@{commands.c}!yh\_com\_open\_session@{yh\_com\_open\_session}}
\index{yh\_com\_open\_session@{yh\_com\_open\_session}!commands.c@{commands.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_open\_session()}{yh\_com\_open\_session()}}
{\footnotesize\ttfamily \label{commands_8c_a22f22a25151b12c7573f80563a341368} 
int yh\+\_\+com\+\_\+open\+\_\+session (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{commands_8c_source_l01208}{1208}} of file \mbox{\hyperlink{commands_8c_source}{commands.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01208\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01209\ }
\DoxyCodeLine{01210\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(fmt);}
\DoxyCodeLine{01211\ }
\DoxyCodeLine{01212\ \ \ \mbox{\hyperlink{structyh__session}{yh\_session}}\ *\mbox{\hyperlink{yubihsm__shell__tests_8c_a06390486523e3578750748be3bea88d4}{ses}}\ =\ NULL;}
\DoxyCodeLine{01213\ \ \ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ session\_id\ =\ 0;}
\DoxyCodeLine{01214\ }
\DoxyCodeLine{01215\ \ \ \textcolor{keywordflow}{if}\ (ctx-\/>\mbox{\hyperlink{structyubihsm__context_a8c52c1a89cd4334a0225a1fbfba9a930}{connector}}\ ==\ NULL)\ \{}
\DoxyCodeLine{01216\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Not\ connected\(\backslash\)n"{}});}
\DoxyCodeLine{01217\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{01218\ \ \ \}}
\DoxyCodeLine{01219\ }
\DoxyCodeLine{01220\ \ \ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366}{yh\_rc}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}};}
\DoxyCodeLine{01221\ }
\DoxyCodeLine{01222\ \ \ \mbox{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t}}\ authkey\ =\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].w;}
\DoxyCodeLine{01223\ }
\DoxyCodeLine{01224\ \textcolor{preprocessor}{\#ifdef\ USE\_YKYH}}
\DoxyCodeLine{01225\ \ \ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ *yh\_context;}
\DoxyCodeLine{01226\ \ \ \textcolor{keywordflow}{if}\ (strncmp(\textcolor{stringliteral}{"{}yk:"{}},\ (\textcolor{keywordtype}{char}\ *)\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].x,\ 3)\ ==\ 0)\ \{}
\DoxyCodeLine{01227\ \ \ \ \ \mbox{\hyperlink{ykyh_8h_a93aafaa60a79c75641302448631ea112}{ykyh\_rc}}\ ykyhrc;}
\DoxyCodeLine{01228\ \ \ \ \ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ card\_cryptogram[\mbox{\hyperlink{yubihsm_8h_afbeafba1cc9582217f57f058a7efd200}{YH\_CONTEXT\_LEN}}\ /\ 2];}
\DoxyCodeLine{01229\ \ \ \ \ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ key\_s\_enc[\mbox{\hyperlink{yubihsm_8h_ac2737b2a34c26d0258d25e34993df391}{YH\_KEY\_LEN}}];}
\DoxyCodeLine{01230\ \ \ \ \ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ key\_s\_mac[\mbox{\hyperlink{yubihsm_8h_ac2737b2a34c26d0258d25e34993df391}{YH\_KEY\_LEN}}];}
\DoxyCodeLine{01231\ \ \ \ \ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ key\_s\_rmac[\mbox{\hyperlink{yubihsm_8h_ac2737b2a34c26d0258d25e34993df391}{YH\_KEY\_LEN}}];}
\DoxyCodeLine{01232\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ key\_s\_enc\_len\ =\ \textcolor{keyword}{sizeof}(key\_s\_enc);}
\DoxyCodeLine{01233\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ key\_s\_mac\_len\ =\ \textcolor{keyword}{sizeof}(key\_s\_mac);}
\DoxyCodeLine{01234\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ key\_s\_rmac\_len\ =\ \textcolor{keyword}{sizeof}(key\_s\_rmac);}
\DoxyCodeLine{01235\ \ \ \ \ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ retries;}
\DoxyCodeLine{01236\ }
\DoxyCodeLine{01237\ \ \ \ \ ykyhrc\ =\ \mbox{\hyperlink{ykyh_8c_a6b53f9d9825a88a6a20352c9734e4a4d}{ykyh\_connect}}(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a2477a831d6082f899d49df85611e6e52}{state}},\ NULL);}
\DoxyCodeLine{01238\ \ \ \ \ \textcolor{keywordflow}{if}\ (ykyhrc\ !=\ \mbox{\hyperlink{ykyh_8h_a93aafaa60a79c75641302448631ea112a40500f2b4bd15d31f1348475e35f2459}{YKYHR\_SUCCESS}})\ \{}
\DoxyCodeLine{01239\ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ connect\ to\ the\ YubiKey:\ \%s\(\backslash\)n"{}},}
\DoxyCodeLine{01240\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{ykyh_2error_8c_a4544a3e0741c078e01233bb1ab541805}{ykyh\_strerror}}(ykyhrc));}
\DoxyCodeLine{01241\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{01242\ \ \ \ \ \}}
\DoxyCodeLine{01243\ }
\DoxyCodeLine{01244\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a296b43eadb1151017ba8e9578b351c5e}{yh\_begin\_create\_session\_ext}}(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a8c52c1a89cd4334a0225a1fbfba9a930}{connector}},\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].w,\ \&yh\_context,}
\DoxyCodeLine{01245\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ card\_cryptogram,\ \textcolor{keyword}{sizeof}(card\_cryptogram),}
\DoxyCodeLine{01246\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\mbox{\hyperlink{yubihsm__shell__tests_8c_a06390486523e3578750748be3bea88d4}{ses}});}
\DoxyCodeLine{01247\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{01248\ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ create\ session:\ \%s\(\backslash\)n"{}},\ \mbox{\hyperlink{lib_2error_8c_a238eedb1e27dbff2a0ab9a3932eb3f8b}{yh\_strerror}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}));}
\DoxyCodeLine{01249\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{01250\ \ \ \ \ \}}
\DoxyCodeLine{01251\ }
\DoxyCodeLine{01252\ \ \ \ \ \textcolor{keywordtype}{char}\ *\mbox{\hyperlink{catch__reporter__console_8cpp_a9b45b3e13bd9167aab02e17e08916231}{name}};}
\DoxyCodeLine{01253\ \ \ \ \ \textcolor{keywordtype}{char}\ *pw;}
\DoxyCodeLine{01254\ \ \ \ \ \textcolor{keywordflow}{if}\ (parse\_yk\_password((\textcolor{keywordtype}{char}\ *)\ (\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].x\ +\ 3),\ \&\mbox{\hyperlink{catch__reporter__console_8cpp_a9b45b3e13bd9167aab02e17e08916231}{name}},\ \&pw)\ ==\ -\/1)\ \{}
\DoxyCodeLine{01255\ \ \ \ \ \ \ fprintf(stderr,}
\DoxyCodeLine{01256\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Failed\ to\ decode\ password,\ format\ must\ be\ "{}}}
\DoxyCodeLine{01257\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}yk:NAME[\%d-\/\%d]:PASSWORD[\%d]\(\backslash\)n"{}},}
\DoxyCodeLine{01258\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{ykyh_8h_ae8331a6f47276895ad08a1cbf3a6a508}{YKYH\_MIN\_NAME\_LEN}},\ \mbox{\hyperlink{ykyh_8h_aba3c1d3e48c3662d8e58a87bc564cc82}{YKYH\_MAX\_NAME\_LEN}},\ \mbox{\hyperlink{ykyh_8h_a00e800150afe4404120c2090461fdf1a}{YKYH\_PW\_LEN}});}
\DoxyCodeLine{01259\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{01260\ \ \ \ \ \}}
\DoxyCodeLine{01261\ }
\DoxyCodeLine{01262\ \ \ \ \ ykyhrc\ =}
\DoxyCodeLine{01263\ \ \ \ \ \ \ \mbox{\hyperlink{ykyh_8c_af6e95562757fb174ae74843f2ec6304a}{ykyh\_calculate}}(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a2477a831d6082f899d49df85611e6e52}{state}},\ \mbox{\hyperlink{catch__reporter__console_8cpp_a9b45b3e13bd9167aab02e17e08916231}{name}},\ yh\_context,\ \mbox{\hyperlink{yubihsm_8h_afbeafba1cc9582217f57f058a7efd200}{YH\_CONTEXT\_LEN}},\ pw,}
\DoxyCodeLine{01264\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ key\_s\_enc,\ \textcolor{keyword}{sizeof}(key\_s\_enc),\ key\_s\_mac,\ \textcolor{keyword}{sizeof}(key\_s\_mac),}
\DoxyCodeLine{01265\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ key\_s\_rmac,\ \textcolor{keyword}{sizeof}(key\_s\_rmac),\ \&retries);}
\DoxyCodeLine{01266\ \ \ \ \ \textcolor{keywordflow}{if}\ (ykyhrc\ !=\ \mbox{\hyperlink{ykyh_8h_a93aafaa60a79c75641302448631ea112a40500f2b4bd15d31f1348475e35f2459}{YKYHR\_SUCCESS}})\ \{}
\DoxyCodeLine{01267\ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ get\ session\ keys\ from\ the\ YubiKey:\ \%s"{}},}
\DoxyCodeLine{01268\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{ykyh_2error_8c_a4544a3e0741c078e01233bb1ab541805}{ykyh\_strerror}}(ykyhrc));}
\DoxyCodeLine{01269\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (ykyhrc\ ==\ \mbox{\hyperlink{ykyh_8h_a93aafaa60a79c75641302448631ea112ae58239391b2ac02c8bb353666cdf9ac8}{YKYHR\_WRONG\_PW}})\ \{}
\DoxyCodeLine{01270\ \ \ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{},\ \%d\ attempts\ remaining"{}},\ retries);}
\DoxyCodeLine{01271\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01272\ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{01273\ }
\DoxyCodeLine{01274\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{01275\ \ \ \ \ \}}
\DoxyCodeLine{01276\ }
\DoxyCodeLine{01277\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =}
\DoxyCodeLine{01278\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm_8c_afbcb5c761339fbcf444be8f338b4614f}{yh\_finish\_create\_session\_ext}}(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a8c52c1a89cd4334a0225a1fbfba9a930}{connector}},\ \mbox{\hyperlink{yubihsm__shell__tests_8c_a06390486523e3578750748be3bea88d4}{ses}},\ key\_s\_enc,}
\DoxyCodeLine{01279\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ key\_s\_enc\_len,\ key\_s\_mac,\ key\_s\_mac\_len,}
\DoxyCodeLine{01280\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ key\_s\_rmac,\ key\_s\_rmac\_len,\ card\_cryptogram,}
\DoxyCodeLine{01281\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{sizeof}(card\_cryptogram));}
\DoxyCodeLine{01282\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{01283\ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ create\ session:\ \%s\(\backslash\)n"{}},\ \mbox{\hyperlink{lib_2error_8c_a238eedb1e27dbff2a0ab9a3932eb3f8b}{yh\_strerror}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}));}
\DoxyCodeLine{01284\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{01285\ \ \ \ \ \}}
\DoxyCodeLine{01286\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01287\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01288\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a3be331dcf8907ff3569e4dc230e1c615}{yh\_create\_session\_derived}}(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a8c52c1a89cd4334a0225a1fbfba9a930}{connector}},\ authkey,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].x,}
\DoxyCodeLine{01289\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].len,\ \textcolor{keyword}{false},\ \&\mbox{\hyperlink{yubihsm__shell__tests_8c_a06390486523e3578750748be3bea88d4}{ses}});}
\DoxyCodeLine{01290\ \ \ \ \ \mbox{\hyperlink{insecure__memzero_8h_a0794f9275fd1036ecba6ff0a901a320b}{insecure\_memzero}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].x,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].\mbox{\hyperlink{yubihsm__pkcs11_8c_a7360b55975153b822efc5217b7734e6a}{len}});}
\DoxyCodeLine{01291\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{01292\ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ create\ session:\ \%s\(\backslash\)n"{}},\ \mbox{\hyperlink{lib_2error_8c_a238eedb1e27dbff2a0ab9a3932eb3f8b}{yh\_strerror}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}));}
\DoxyCodeLine{01293\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{01294\ \ \ \ \ \}}
\DoxyCodeLine{01295\ \textcolor{preprocessor}{\#ifdef\ USE\_YKYH}}
\DoxyCodeLine{01296\ \ \ \}}
\DoxyCodeLine{01297\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01298\ }
\DoxyCodeLine{01299\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a77870209747d5ccd90f9da3aae2bdfa8}{yh\_authenticate\_session}}(\mbox{\hyperlink{yubihsm__shell__tests_8c_a06390486523e3578750748be3bea88d4}{ses}});}
\DoxyCodeLine{01300\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{01301\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ authenticate\ session:\ \%s\(\backslash\)n"{}},\ \mbox{\hyperlink{lib_2error_8c_a238eedb1e27dbff2a0ab9a3932eb3f8b}{yh\_strerror}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}));}
\DoxyCodeLine{01302\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{01303\ \ \ \}}
\DoxyCodeLine{01304\ }
\DoxyCodeLine{01305\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_aeabf472faf1ba8d963b39866e04df6b0}{yh\_get\_session\_id}}(\mbox{\hyperlink{yubihsm__shell__tests_8c_a06390486523e3578750748be3bea88d4}{ses}},\ \&session\_id);}
\DoxyCodeLine{01306\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{01307\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ create\ session:\ \%s\(\backslash\)n"{}},\ \mbox{\hyperlink{lib_2error_8c_a238eedb1e27dbff2a0ab9a3932eb3f8b}{yh\_strerror}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}));}
\DoxyCodeLine{01308\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{01309\ \ \ \}}
\DoxyCodeLine{01310\ }
\DoxyCodeLine{01311\ \ \ \textcolor{keywordflow}{if}\ (ctx-\/>\mbox{\hyperlink{structyubihsm__context_a7a959752fa285fb4a7a75921bbfa00fe}{sessions}}[session\_id]\ !=\ NULL)\ \{}
\DoxyCodeLine{01312\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a1a35f8ae5a739848408633a514e41b2d}{yh\_destroy\_session}}(\&ctx-\/>\mbox{\hyperlink{structyubihsm__context_a7a959752fa285fb4a7a75921bbfa00fe}{sessions}}[session\_id]);}
\DoxyCodeLine{01313\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{01314\ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ destroy\ old\ session\ with\ same\ id\ (\%d):\ \%s\(\backslash\)n"{}},}
\DoxyCodeLine{01315\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ session\_id,\ \mbox{\hyperlink{lib_2error_8c_a238eedb1e27dbff2a0ab9a3932eb3f8b}{yh\_strerror}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}));}
\DoxyCodeLine{01316\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{01317\ \ \ \ \ \}}
\DoxyCodeLine{01318\ \ \ \}}
\DoxyCodeLine{01319\ \ \ ctx-\/>\mbox{\hyperlink{structyubihsm__context_a7a959752fa285fb4a7a75921bbfa00fe}{sessions}}[session\_id]\ =\ \mbox{\hyperlink{yubihsm__shell__tests_8c_a06390486523e3578750748be3bea88d4}{ses}};}
\DoxyCodeLine{01320\ }
\DoxyCodeLine{01321\ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Created\ session\ \%d\(\backslash\)n"{}},\ session\_id);}
\DoxyCodeLine{01322\ }
\DoxyCodeLine{01323\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{01324\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_a22f22a25151b12c7573f80563a341368_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_a22f22a25151b12c7573f80563a341368_icgraph}
\end{center}
\end{figure}
\Hypertarget{commands_8c_ae716e54fae7ba83cb44fe966fbcad9cb}\index{commands.c@{commands.c}!yh\_com\_otp\_aead\_create@{yh\_com\_otp\_aead\_create}}
\index{yh\_com\_otp\_aead\_create@{yh\_com\_otp\_aead\_create}!commands.c@{commands.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_otp\_aead\_create()}{yh\_com\_otp\_aead\_create()}}
{\footnotesize\ttfamily \label{commands_8c_ae716e54fae7ba83cb44fe966fbcad9cb} 
int yh\+\_\+com\+\_\+otp\+\_\+aead\+\_\+create (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{commands_8c_source_l02461}{2461}} of file \mbox{\hyperlink{commands_8c_source}{commands.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02462\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02463\ }
\DoxyCodeLine{02464\ \ \ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ response[\mbox{\hyperlink{yubihsm_8h_a706bd8e7adf0de85e6cfb0efc8981d3f}{YH\_MSG\_BUF\_SIZE}}];}
\DoxyCodeLine{02465\ \ \ \textcolor{keywordtype}{size\_t}\ response\_len\ =\ \textcolor{keyword}{sizeof}(response);}
\DoxyCodeLine{02466\ \ \ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366}{yh\_rc}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}};}
\DoxyCodeLine{02467\ }
\DoxyCodeLine{02468\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[2].\mbox{\hyperlink{yubihsm__pkcs11_8c_a7360b55975153b822efc5217b7734e6a}{len}}\ !=\ 16)\ \{}
\DoxyCodeLine{02469\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Wrong\ length\ key\ supplied,\ has\ to\ be\ 16\ bytes\(\backslash\)n"{}});}
\DoxyCodeLine{02470\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{02471\ \ \ \}}
\DoxyCodeLine{02472\ }
\DoxyCodeLine{02473\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[3].\mbox{\hyperlink{yubihsm__pkcs11_8c_a7360b55975153b822efc5217b7734e6a}{len}}\ !=\ 6)\ \{}
\DoxyCodeLine{02474\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Wrong\ length\ id\ supplied,\ has\ to\ be\ 6\ bytes\(\backslash\)n"{}});}
\DoxyCodeLine{02475\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{02476\ \ \ \}}
\DoxyCodeLine{02477\ }
\DoxyCodeLine{02478\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a82d295a02d9eb628f6dea4b4c01fdec4}{yh\_util\_create\_otp\_aead}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].w,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[2].x,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[3].x,}
\DoxyCodeLine{02479\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ response,\ \&response\_len);}
\DoxyCodeLine{02480\ }
\DoxyCodeLine{02481\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{02482\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ create\ OTP\ AEAD:\ \%s\(\backslash\)n"{}},\ \mbox{\hyperlink{lib_2error_8c_a238eedb1e27dbff2a0ab9a3932eb3f8b}{yh\_strerror}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}));}
\DoxyCodeLine{02483\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{02484\ \ \ \}}
\DoxyCodeLine{02485\ }
\DoxyCodeLine{02486\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{util_8c_ad969d220471d10a9f07080b50210f403}{write\_file}}(response,\ response\_len,\ ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}},\ fmt\_to\_fmt(fmt)))\ \{}
\DoxyCodeLine{02487\ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{02488\ \ \ \}}
\DoxyCodeLine{02489\ }
\DoxyCodeLine{02490\ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{02491\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_ae716e54fae7ba83cb44fe966fbcad9cb_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_ae716e54fae7ba83cb44fe966fbcad9cb_icgraph}
\end{center}
\end{figure}
\Hypertarget{commands_8c_a533707756dfe3a35c9aadf4d288b73d4}\index{commands.c@{commands.c}!yh\_com\_otp\_aead\_random@{yh\_com\_otp\_aead\_random}}
\index{yh\_com\_otp\_aead\_random@{yh\_com\_otp\_aead\_random}!commands.c@{commands.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_otp\_aead\_random()}{yh\_com\_otp\_aead\_random()}}
{\footnotesize\ttfamily \label{commands_8c_a533707756dfe3a35c9aadf4d288b73d4} 
int yh\+\_\+com\+\_\+otp\+\_\+aead\+\_\+random (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{commands_8c_source_l02498}{2498}} of file \mbox{\hyperlink{commands_8c_source}{commands.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02499\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02500\ }
\DoxyCodeLine{02501\ \ \ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ response[\mbox{\hyperlink{yubihsm_8h_a706bd8e7adf0de85e6cfb0efc8981d3f}{YH\_MSG\_BUF\_SIZE}}];}
\DoxyCodeLine{02502\ \ \ \textcolor{keywordtype}{size\_t}\ response\_len\ =\ \textcolor{keyword}{sizeof}(response);}
\DoxyCodeLine{02503\ \ \ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366}{yh\_rc}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}};}
\DoxyCodeLine{02504\ }
\DoxyCodeLine{02505\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =}
\DoxyCodeLine{02506\ \ \ \ \ \mbox{\hyperlink{yubihsm_8c_a4bb1d420f681bc91bd36dc08695dbad6}{yh\_util\_randomize\_otp\_aead}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].w,\ response,\ \&response\_len);}
\DoxyCodeLine{02507\ }
\DoxyCodeLine{02508\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{02509\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ create\ OTP\ AEAD:\ \%s\(\backslash\)n"{}},\ \mbox{\hyperlink{lib_2error_8c_a238eedb1e27dbff2a0ab9a3932eb3f8b}{yh\_strerror}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}));}
\DoxyCodeLine{02510\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{02511\ \ \ \}}
\DoxyCodeLine{02512\ }
\DoxyCodeLine{02513\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{util_8c_ad969d220471d10a9f07080b50210f403}{write\_file}}(response,\ response\_len,\ ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}},\ fmt\_to\_fmt(fmt)))\ \{}
\DoxyCodeLine{02514\ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{02515\ \ \ \}}
\DoxyCodeLine{02516\ }
\DoxyCodeLine{02517\ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{02518\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_a533707756dfe3a35c9aadf4d288b73d4_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_a533707756dfe3a35c9aadf4d288b73d4_icgraph}
\end{center}
\end{figure}
\Hypertarget{commands_8c_ad676312a3ed43f6a3ece63851780aeff}\index{commands.c@{commands.c}!yh\_com\_otp\_decrypt@{yh\_com\_otp\_decrypt}}
\index{yh\_com\_otp\_decrypt@{yh\_com\_otp\_decrypt}!commands.c@{commands.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_otp\_decrypt()}{yh\_com\_otp\_decrypt()}}
{\footnotesize\ttfamily \label{commands_8c_ad676312a3ed43f6a3ece63851780aeff} 
int yh\+\_\+com\+\_\+otp\+\_\+decrypt (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{commands_8c_source_l02526}{2526}} of file \mbox{\hyperlink{commands_8c_source}{commands.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02526\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02527\ \ \ \mbox{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t}}\ useCtr;}
\DoxyCodeLine{02528\ \ \ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ sessionCtr;}
\DoxyCodeLine{02529\ \ \ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ tstph;}
\DoxyCodeLine{02530\ \ \ \mbox{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t}}\ tstpl;}
\DoxyCodeLine{02531\ \ \ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366}{yh\_rc}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}};}
\DoxyCodeLine{02532\ \ \ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ \mbox{\hyperlink{yubico__otp_8c_ab1e1d61db8c48d537faca71988a7c123}{otp}}[16];}
\DoxyCodeLine{02533\ \ \ \textcolor{keywordtype}{size\_t}\ otp\_len\ =\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{yubico__otp_8c_ab1e1d61db8c48d537faca71988a7c123}{otp}});}
\DoxyCodeLine{02534\ }
\DoxyCodeLine{02535\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(ctx);}
\DoxyCodeLine{02536\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(fmt);}
\DoxyCodeLine{02537\ }
\DoxyCodeLine{02538\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[2].\mbox{\hyperlink{yubihsm__pkcs11_8c_a7360b55975153b822efc5217b7734e6a}{len}}\ !=\ 32)\ \{}
\DoxyCodeLine{02539\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Wrong\ length\ OTP\ supplied,\ has\ to\ be\ 16\ bytes\ in\ hex\(\backslash\)n"{}});}
\DoxyCodeLine{02540\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{02541\ \ \ \}}
\DoxyCodeLine{02542\ }
\DoxyCodeLine{02543\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{util_8c_af201e18e3fc54c17b855a6354251247e}{hex\_decode}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[2].\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}},\ \mbox{\hyperlink{yubico__otp_8c_ab1e1d61db8c48d537faca71988a7c123}{otp}},\ \&otp\_len)\ ==\ \textcolor{keyword}{false})\ \{}
\DoxyCodeLine{02544\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ decode\ OTP\(\backslash\)n"{}});}
\DoxyCodeLine{02545\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{02546\ \ \ \}}
\DoxyCodeLine{02547\ }
\DoxyCodeLine{02548\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a3677afe2209a1cae31f70a304e260e28}{yh\_util\_decrypt\_otp}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].w,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[3].x,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[3].\mbox{\hyperlink{yubihsm__pkcs11_8c_a7360b55975153b822efc5217b7734e6a}{len}},\ \mbox{\hyperlink{yubico__otp_8c_ab1e1d61db8c48d537faca71988a7c123}{otp}},}
\DoxyCodeLine{02549\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&useCtr,\ \&sessionCtr,\ \&tstph,\ \&tstpl);}
\DoxyCodeLine{02550\ }
\DoxyCodeLine{02551\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{02552\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ decrypt\ OTP:\ \%s\(\backslash\)n"{}},\ \mbox{\hyperlink{lib_2error_8c_a238eedb1e27dbff2a0ab9a3932eb3f8b}{yh\_strerror}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}));}
\DoxyCodeLine{02553\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{02554\ \ \ \}}
\DoxyCodeLine{02555\ }
\DoxyCodeLine{02556\ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}OTP\ decoded,\ useCtr:\%d,\ sessionCtr:\%d,\ tstph:\%d,\ tstpl:\%d\(\backslash\)n"{}},}
\DoxyCodeLine{02557\ \ \ \ \ \ \ \ \ \ \ useCtr,\ sessionCtr,\ tstph,\ tstpl);}
\DoxyCodeLine{02558\ }
\DoxyCodeLine{02559\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{02560\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_ad676312a3ed43f6a3ece63851780aeff_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_ad676312a3ed43f6a3ece63851780aeff_icgraph}
\end{center}
\end{figure}
\Hypertarget{commands_8c_a95d970cdea5162be25cac2a7f5c420ed}\index{commands.c@{commands.c}!yh\_com\_pecho@{yh\_com\_pecho}}
\index{yh\_com\_pecho@{yh\_com\_pecho}!commands.c@{commands.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_pecho()}{yh\_com\_pecho()}}
{\footnotesize\ttfamily \label{commands_8c_a95d970cdea5162be25cac2a7f5c420ed} 
int yh\+\_\+com\+\_\+pecho (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{commands_8c_source_l01330}{1330}} of file \mbox{\hyperlink{commands_8c_source}{commands.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01330\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01331\ }
\DoxyCodeLine{01332\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(fmt);}
\DoxyCodeLine{01333\ }
\DoxyCodeLine{01334\ \ \ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366}{yh\_rc}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}};}
\DoxyCodeLine{01335\ }
\DoxyCodeLine{01336\ \ \ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ data[\mbox{\hyperlink{yubihsm_8h_a706bd8e7adf0de85e6cfb0efc8981d3f}{YH\_MSG\_BUF\_SIZE}}];}
\DoxyCodeLine{01337\ \ \ \mbox{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t}}\ data\_len;}
\DoxyCodeLine{01338\ }
\DoxyCodeLine{01339\ \ \ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ response[\mbox{\hyperlink{yubihsm_8h_a706bd8e7adf0de85e6cfb0efc8981d3f}{YH\_MSG\_BUF\_SIZE}}];}
\DoxyCodeLine{01340\ \ \ \textcolor{keywordtype}{size\_t}\ response\_len;}
\DoxyCodeLine{01341\ \ \ \mbox{\hyperlink{yubihsm_8h_aa5415bafa9c48dfef0e183d8df504b7e}{yh\_cmd}}\ response\_cmd;}
\DoxyCodeLine{01342\ }
\DoxyCodeLine{01343\ \ \ \textcolor{keywordflow}{if}\ (ctx-\/>\mbox{\hyperlink{structyubihsm__context_a8c52c1a89cd4334a0225a1fbfba9a930}{connector}}\ ==\ NULL)\ \{}
\DoxyCodeLine{01344\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Not\ connected\(\backslash\)n"{}});}
\DoxyCodeLine{01345\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{01346\ \ \ \}}
\DoxyCodeLine{01347\ }
\DoxyCodeLine{01348\ \ \ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ \textcolor{keywordtype}{byte}\ =\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].b;}
\DoxyCodeLine{01349\ }
\DoxyCodeLine{01350\ \ \ \mbox{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t}}\ \mbox{\hyperlink{gmock__stress__test_8cc_afd9db40e3361ae09188795e8cbe19752}{count}}\ =\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].w;}
\DoxyCodeLine{01351\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{gmock__stress__test_8cc_afd9db40e3361ae09188795e8cbe19752}{count}}\ >\ \mbox{\hyperlink{yubihsm_8h_a706bd8e7adf0de85e6cfb0efc8981d3f}{YH\_MSG\_BUF\_SIZE}})\ \{}
\DoxyCodeLine{01352\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Count\ must\ be\ in\ [0,\ \%d]\(\backslash\)n"{}},\ \mbox{\hyperlink{yubihsm_8h_a706bd8e7adf0de85e6cfb0efc8981d3f}{YH\_MSG\_BUF\_SIZE}});}
\DoxyCodeLine{01353\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{01354\ \ \ \}}
\DoxyCodeLine{01355\ }
\DoxyCodeLine{01356\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_adc4bd59a60361844aa0e852efa210105}{memset}}(data,\ \textcolor{keywordtype}{byte},\ \mbox{\hyperlink{gmock__stress__test_8cc_afd9db40e3361ae09188795e8cbe19752}{count}});}
\DoxyCodeLine{01357\ }
\DoxyCodeLine{01358\ \ \ data\_len\ =\ \mbox{\hyperlink{gmock__stress__test_8cc_afd9db40e3361ae09188795e8cbe19752}{count}};}
\DoxyCodeLine{01359\ \ \ response\_len\ =\ \textcolor{keyword}{sizeof}(response);}
\DoxyCodeLine{01360\ }
\DoxyCodeLine{01361\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a799e299be8d4c13dfa2112a60d05480d}{yh\_send\_plain\_msg}}(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a8c52c1a89cd4334a0225a1fbfba9a930}{connector}},\ YHC\_ECHO,\ data,\ data\_len,}
\DoxyCodeLine{01362\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&response\_cmd,\ response,\ \&response\_len);}
\DoxyCodeLine{01363\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{01364\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ send\ ECHO\ command):\ \%s\(\backslash\)n"{}},\ \mbox{\hyperlink{lib_2error_8c_a238eedb1e27dbff2a0ab9a3932eb3f8b}{yh\_strerror}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}));}
\DoxyCodeLine{01365\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{01366\ \ \ \}}
\DoxyCodeLine{01367\ }
\DoxyCodeLine{01368\ \ \ \textcolor{keywordflow}{if}\ (response\_cmd\ ==\ \mbox{\hyperlink{yubihsm_8h_aa5415bafa9c48dfef0e183d8df504b7ea51cdf2ccd6995498e589e8ea6ce2a1f2}{YHC\_ERROR}})\ \{}
\DoxyCodeLine{01369\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Unable\ to\ get\ echo\ data:\ \%s\ (\%x)\(\backslash\)n"{}},}
\DoxyCodeLine{01370\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{lib_2error_8c_a238eedb1e27dbff2a0ab9a3932eb3f8b}{yh\_strerror}}(response[0]),\ response[0]);}
\DoxyCodeLine{01371\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{01372\ \ \ \}}
\DoxyCodeLine{01373\ }
\DoxyCodeLine{01374\ \ \ fprintf(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}},\ \textcolor{stringliteral}{"{}Response\ (\%zu\ bytes):\(\backslash\)n"{}},\ response\_len);}
\DoxyCodeLine{01375\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t}}\ i\ =\ 0;\ i\ <\ response\_len;\ i++)\ \{}
\DoxyCodeLine{01376\ \ \ \ \ \textcolor{keywordflow}{if}\ (i\ \&\&\ !(i\ \%\ 64))}
\DoxyCodeLine{01377\ \ \ \ \ \ \ fprintf(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}},\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{01378\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (i\ \&\&\ !(i\ \%\ 8))}
\DoxyCodeLine{01379\ \ \ \ \ \ \ fprintf(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}},\ \textcolor{stringliteral}{"{}\ "{}});}
\DoxyCodeLine{01380\ \ \ \ \ fprintf(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}},\ \textcolor{stringliteral}{"{}\%02x"{}},\ response[i]);}
\DoxyCodeLine{01381\ \ \ \}}
\DoxyCodeLine{01382\ }
\DoxyCodeLine{01383\ \ \ fprintf(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}},\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{01384\ }
\DoxyCodeLine{01385\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{01386\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_a95d970cdea5162be25cac2a7f5c420ed_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_a95d970cdea5162be25cac2a7f5c420ed_icgraph}
\end{center}
\end{figure}
\Hypertarget{commands_8c_a0abe95eb37069022ed341835938de103}\index{commands.c@{commands.c}!yh\_com\_put\_asymmetric@{yh\_com\_put\_asymmetric}}
\index{yh\_com\_put\_asymmetric@{yh\_com\_put\_asymmetric}!commands.c@{commands.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_put\_asymmetric()}{yh\_com\_put\_asymmetric()}}
{\footnotesize\ttfamily \label{commands_8c_a0abe95eb37069022ed341835938de103} 
int yh\+\_\+com\+\_\+put\+\_\+asymmetric (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{commands_8c_source_l01396}{1396}} of file \mbox{\hyperlink{commands_8c_source}{commands.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01397\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01398\ }
\DoxyCodeLine{01399\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(ctx);}
\DoxyCodeLine{01400\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(fmt);}
\DoxyCodeLine{01401\ }
\DoxyCodeLine{01402\ \ \ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ key[512];}
\DoxyCodeLine{01403\ \ \ \textcolor{keywordtype}{size\_t}\ key\_material\_len\ =\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{yubico__otp_8c_a9246c20bb98ad2b4c60313c053c70f08}{key}});}
\DoxyCodeLine{01404\ \ \ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55ca}{yh\_algorithm}}\ \mbox{\hyperlink{yubihsm_8h_a67bb26eddc39413f8e94c98aedbbd391}{algorithm}};}
\DoxyCodeLine{01405\ }
\DoxyCodeLine{01406\ \ \ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366}{yh\_rc}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}};}
\DoxyCodeLine{01407\ }
\DoxyCodeLine{01408\ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}}\ =\ \mbox{\hyperlink{util_8c_ae88d850a063cdc9ed3c114feab9af651}{read\_private\_key}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[5].x,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[5].\mbox{\hyperlink{yubihsm__pkcs11_8c_a7360b55975153b822efc5217b7734e6a}{len}},\ \&\mbox{\hyperlink{yubihsm_8h_a67bb26eddc39413f8e94c98aedbbd391}{algorithm}},\ key,}
\DoxyCodeLine{01409\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&key\_material\_len,\ \textcolor{keyword}{false});}
\DoxyCodeLine{01410\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}}\ ==\ \textcolor{keyword}{false})\ \{}
\DoxyCodeLine{01411\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Unable\ to\ read\ asymmetric\ key\(\backslash\)n"{}});}
\DoxyCodeLine{01412\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{01413\ \ \ \}}
\DoxyCodeLine{01414\ }
\DoxyCodeLine{01415\ \ \ \textcolor{keywordflow}{switch}\ (\mbox{\hyperlink{yubihsm_8h_a67bb26eddc39413f8e94c98aedbbd391}{algorithm}})\ \{}
\DoxyCodeLine{01416\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caaafe94e6a770edb51c6db84f77d98d2c6}{YH\_ALGO\_RSA\_2048}}:}
\DoxyCodeLine{01417\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caafd3fbd9ed86caf267ccc77cb24d44426}{YH\_ALGO\_RSA\_3072}}:}
\DoxyCodeLine{01418\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caae5963322a0a0f43a1b74faa78e3a7329}{YH\_ALGO\_RSA\_4096}}:}
\DoxyCodeLine{01419\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_ab0ca24007ce6942d2185859560c43e8a}{yh\_util\_import\_rsa\_key}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e,\ \&\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].w,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[2].\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}},\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[3].w,}
\DoxyCodeLine{01420\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[4].c,\ \mbox{\hyperlink{yubihsm_8h_a67bb26eddc39413f8e94c98aedbbd391}{algorithm}},\ key,}
\DoxyCodeLine{01421\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ key\ +\ key\_material\_len\ /\ 2);}
\DoxyCodeLine{01422\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01423\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caaedcbc07d82b18ca5c21eb3379a6cc010}{YH\_ALGO\_EC\_P224}}:}
\DoxyCodeLine{01424\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caae4b191baf5c65f9234120080264d129b}{YH\_ALGO\_EC\_P256}}:}
\DoxyCodeLine{01425\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa31094c17c66e4c365ca3dad353bc8bda}{YH\_ALGO\_EC\_P384}}:}
\DoxyCodeLine{01426\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa05aec903fd67851f968aaa606fe2138a}{YH\_ALGO\_EC\_P521}}:}
\DoxyCodeLine{01427\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caad423056b13955068935dc8b3ac0e65d1}{YH\_ALGO\_EC\_K256}}:}
\DoxyCodeLine{01428\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caabd995726d45b6dd2388775db4767c80d}{YH\_ALGO\_EC\_BP256}}:}
\DoxyCodeLine{01429\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa228fd3332b55c60438dfea6a1b09af36}{YH\_ALGO\_EC\_BP384}}:}
\DoxyCodeLine{01430\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caab9c1be17b7b3f755346ff8c3cca3ed25}{YH\_ALGO\_EC\_BP512}}:}
\DoxyCodeLine{01431\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_adc142d8f397eee024b3c145fa8abad85}{yh\_util\_import\_ec\_key}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e,\ \&\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].w,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[2].\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}},\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[3].w,}
\DoxyCodeLine{01432\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[4].c,\ \mbox{\hyperlink{yubihsm_8h_a67bb26eddc39413f8e94c98aedbbd391}{algorithm}},\ key);}
\DoxyCodeLine{01433\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01434\ }
\DoxyCodeLine{01435\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa68c2c97f16c36f727e41a899d8a7e8bd}{YH\_ALGO\_EC\_ED25519}}:}
\DoxyCodeLine{01436\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a7a886e052bc1571f24c6b7f0c57e2d8c}{yh\_util\_import\_ed\_key}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e,\ \&\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].w,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[2].\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}},\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[3].w,}
\DoxyCodeLine{01437\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[4].c,\ \mbox{\hyperlink{yubihsm_8h_a67bb26eddc39413f8e94c98aedbbd391}{algorithm}},\ key);}
\DoxyCodeLine{01438\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01439\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{01440\ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Unsupported\ algorithm\(\backslash\)n"{}});}
\DoxyCodeLine{01441\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{01442\ \ \ \}}
\DoxyCodeLine{01443\ }
\DoxyCodeLine{01444\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{01445\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ store\ asymmetric\ key:\ \%s\(\backslash\)n"{}},\ \mbox{\hyperlink{lib_2error_8c_a238eedb1e27dbff2a0ab9a3932eb3f8b}{yh\_strerror}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}));}
\DoxyCodeLine{01446\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{01447\ \ \ \}}
\DoxyCodeLine{01448\ }
\DoxyCodeLine{01449\ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Stored\ Asymmetric\ key\ 0x\%04x\(\backslash\)n"{}},\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].w);}
\DoxyCodeLine{01450\ }
\DoxyCodeLine{01451\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{01452\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_a0abe95eb37069022ed341835938de103_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_a0abe95eb37069022ed341835938de103_icgraph}
\end{center}
\end{figure}
\Hypertarget{commands_8c_a3bd17c302789958013e50a2ad9738aea}\index{commands.c@{commands.c}!yh\_com\_put\_authentication@{yh\_com\_put\_authentication}}
\index{yh\_com\_put\_authentication@{yh\_com\_put\_authentication}!commands.c@{commands.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_put\_authentication()}{yh\_com\_put\_authentication()}}
{\footnotesize\ttfamily \label{commands_8c_a3bd17c302789958013e50a2ad9738aea} 
int yh\+\_\+com\+\_\+put\+\_\+authentication (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{commands_8c_source_l01463}{1463}} of file \mbox{\hyperlink{commands_8c_source}{commands.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01464\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01465\ }
\DoxyCodeLine{01466\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(ctx);}
\DoxyCodeLine{01467\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(fmt);}
\DoxyCodeLine{01468\ }
\DoxyCodeLine{01469\ \ \ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366}{yh\_rc}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}};}
\DoxyCodeLine{01470\ }
\DoxyCodeLine{01471\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =}
\DoxyCodeLine{01472\ \ \ \ \ \mbox{\hyperlink{yubihsm_8c_a80b4c4caeb9c768737c2dbf46d9352e4}{yh\_util\_import\_authentication\_key\_derived}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e,\ \&\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].w,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[2].\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}},}
\DoxyCodeLine{01473\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[3].w,\ \&\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[4].c,\ \&\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[5].c,}
\DoxyCodeLine{01474\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[6].x,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[6].\mbox{\hyperlink{yubihsm__pkcs11_8c_a7360b55975153b822efc5217b7734e6a}{len}});}
\DoxyCodeLine{01475\ \ \ \mbox{\hyperlink{insecure__memzero_8h_a0794f9275fd1036ecba6ff0a901a320b}{insecure\_memzero}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[6].x,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[6].\mbox{\hyperlink{yubihsm__pkcs11_8c_a7360b55975153b822efc5217b7734e6a}{len}});}
\DoxyCodeLine{01476\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{01477\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ store\ authkey:\ \%s\(\backslash\)n"{}},\ \mbox{\hyperlink{lib_2error_8c_a238eedb1e27dbff2a0ab9a3932eb3f8b}{yh\_strerror}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}));}
\DoxyCodeLine{01478\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{01479\ \ \ \}}
\DoxyCodeLine{01480\ }
\DoxyCodeLine{01481\ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Stored\ Authentication\ key\ 0x\%04x\(\backslash\)n"{}},\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].w);}
\DoxyCodeLine{01482\ }
\DoxyCodeLine{01483\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{01484\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_a3bd17c302789958013e50a2ad9738aea_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_a3bd17c302789958013e50a2ad9738aea_icgraph}
\end{center}
\end{figure}
\Hypertarget{commands_8c_aed17eea0c4eb877cd1097fbcd8e8e5d0}\index{commands.c@{commands.c}!yh\_com\_put\_hmac@{yh\_com\_put\_hmac}}
\index{yh\_com\_put\_hmac@{yh\_com\_put\_hmac}!commands.c@{commands.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_put\_hmac()}{yh\_com\_put\_hmac()}}
{\footnotesize\ttfamily \label{commands_8c_aed17eea0c4eb877cd1097fbcd8e8e5d0} 
int yh\+\_\+com\+\_\+put\+\_\+hmac (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{commands_8c_source_l01544}{1544}} of file \mbox{\hyperlink{commands_8c_source}{commands.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01544\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01545\ }
\DoxyCodeLine{01546\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(ctx);}
\DoxyCodeLine{01547\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(fmt);}
\DoxyCodeLine{01548\ }
\DoxyCodeLine{01549\ \ \ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366}{yh\_rc}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}};}
\DoxyCodeLine{01550\ }
\DoxyCodeLine{01551\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[6].\mbox{\hyperlink{yubihsm__pkcs11_8c_a7360b55975153b822efc5217b7734e6a}{len}}\ >\ 128)\ \{}
\DoxyCodeLine{01552\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Too\ long\ key\ supplied,\ max\ 128\ bytes\ allowed\(\backslash\)n"{}});}
\DoxyCodeLine{01553\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{01554\ \ \ \}}
\DoxyCodeLine{01555\ }
\DoxyCodeLine{01556\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a19c79faaf10c405864f0179821d551a5}{yh\_util\_import\_hmac\_key}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e,\ \&\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].w,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[2].\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}},\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[3].w,}
\DoxyCodeLine{01557\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[4].c,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[5].\mbox{\hyperlink{pointer_8h_aeeddce917cf130d62c370b8f216026dd}{a}},\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[6].x,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[6].\mbox{\hyperlink{yubihsm__pkcs11_8c_a7360b55975153b822efc5217b7734e6a}{len}});}
\DoxyCodeLine{01558\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{01559\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ store\ HMAC\ key:\ \%s\(\backslash\)n"{}},\ \mbox{\hyperlink{lib_2error_8c_a238eedb1e27dbff2a0ab9a3932eb3f8b}{yh\_strerror}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}));}
\DoxyCodeLine{01560\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{01561\ \ \ \}}
\DoxyCodeLine{01562\ }
\DoxyCodeLine{01563\ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Stored\ HMAC\ key\ 0x\%04x\(\backslash\)n"{}},\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].w);}
\DoxyCodeLine{01564\ }
\DoxyCodeLine{01565\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{01566\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_aed17eea0c4eb877cd1097fbcd8e8e5d0_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_aed17eea0c4eb877cd1097fbcd8e8e5d0_icgraph}
\end{center}
\end{figure}
\Hypertarget{commands_8c_a2be40cf6e90d80392d7aa5e291660f65}\index{commands.c@{commands.c}!yh\_com\_put\_opaque@{yh\_com\_put\_opaque}}
\index{yh\_com\_put\_opaque@{yh\_com\_put\_opaque}!commands.c@{commands.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_put\_opaque()}{yh\_com\_put\_opaque()}}
{\footnotesize\ttfamily \label{commands_8c_a2be40cf6e90d80392d7aa5e291660f65} 
int yh\+\_\+com\+\_\+put\+\_\+opaque (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{commands_8c_source_l01495}{1495}} of file \mbox{\hyperlink{commands_8c_source}{commands.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01495\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01496\ }
\DoxyCodeLine{01497\ \ \ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366}{yh\_rc}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}};}
\DoxyCodeLine{01498\ }
\DoxyCodeLine{01499\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(ctx);}
\DoxyCodeLine{01500\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(fmt);}
\DoxyCodeLine{01501\ }
\DoxyCodeLine{01502\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a1249c920eec24f634d04eaafb90a1ca2}{yh\_util\_import\_opaque}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e,\ \&\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].w,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[2].\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}},\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[3].w,}
\DoxyCodeLine{01503\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[4].c,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[5].\mbox{\hyperlink{pointer_8h_aeeddce917cf130d62c370b8f216026dd}{a}},\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[6].x,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[6].\mbox{\hyperlink{yubihsm__pkcs11_8c_a7360b55975153b822efc5217b7734e6a}{len}});}
\DoxyCodeLine{01504\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{01505\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ store\ opaque\ object:\ \%s\(\backslash\)n"{}},\ \mbox{\hyperlink{lib_2error_8c_a238eedb1e27dbff2a0ab9a3932eb3f8b}{yh\_strerror}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}));}
\DoxyCodeLine{01506\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{01507\ \ \ \}}
\DoxyCodeLine{01508\ }
\DoxyCodeLine{01509\ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Stored\ Opaque\ object\ 0x\%04x\(\backslash\)n"{}},\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].w);}
\DoxyCodeLine{01510\ }
\DoxyCodeLine{01511\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{01512\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_a2be40cf6e90d80392d7aa5e291660f65_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_a2be40cf6e90d80392d7aa5e291660f65_icgraph}
\end{center}
\end{figure}
\Hypertarget{commands_8c_ae400ec3fdd83a82b3c08dd7106c516b9}\index{commands.c@{commands.c}!yh\_com\_put\_option@{yh\_com\_put\_option}}
\index{yh\_com\_put\_option@{yh\_com\_put\_option}!commands.c@{commands.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_put\_option()}{yh\_com\_put\_option()}}
{\footnotesize\ttfamily \label{commands_8c_ae400ec3fdd83a82b3c08dd7106c516b9} 
int yh\+\_\+com\+\_\+put\+\_\+option (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{commands_8c_source_l01519}{1519}} of file \mbox{\hyperlink{commands_8c_source}{commands.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01519\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01520\ }
\DoxyCodeLine{01521\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(ctx);}
\DoxyCodeLine{01522\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(fmt);}
\DoxyCodeLine{01523\ }
\DoxyCodeLine{01524\ \ \ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366}{yh\_rc}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}};}
\DoxyCodeLine{01525\ }
\DoxyCodeLine{01526\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a85ac840aec77cb1ca3c3ce1f2ab26282}{yh\_util\_set\_option}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].o,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[2].\mbox{\hyperlink{yubihsm__pkcs11_8c_a7360b55975153b822efc5217b7734e6a}{len}},\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[2].x);}
\DoxyCodeLine{01527\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{01528\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ store\ option:\ \%s\(\backslash\)n"{}},\ \mbox{\hyperlink{lib_2error_8c_a238eedb1e27dbff2a0ab9a3932eb3f8b}{yh\_strerror}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}));}
\DoxyCodeLine{01529\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{01530\ \ \ \}}
\DoxyCodeLine{01531\ }
\DoxyCodeLine{01532\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{01533\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_ae400ec3fdd83a82b3c08dd7106c516b9_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_ae400ec3fdd83a82b3c08dd7106c516b9_icgraph}
\end{center}
\end{figure}
\Hypertarget{commands_8c_a7ef84380bc19536e4ba9bf62fd44ba93}\index{commands.c@{commands.c}!yh\_com\_put\_otp\_aead\_key@{yh\_com\_put\_otp\_aead\_key}}
\index{yh\_com\_put\_otp\_aead\_key@{yh\_com\_put\_otp\_aead\_key}!commands.c@{commands.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_put\_otp\_aead\_key()}{yh\_com\_put\_otp\_aead\_key()}}
{\footnotesize\ttfamily \label{commands_8c_a7ef84380bc19536e4ba9bf62fd44ba93} 
int yh\+\_\+com\+\_\+put\+\_\+otp\+\_\+aead\+\_\+key (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{commands_8c_source_l02612}{2612}} of file \mbox{\hyperlink{commands_8c_source}{commands.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02613\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02614\ }
\DoxyCodeLine{02615\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(ctx);}
\DoxyCodeLine{02616\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(fmt);}
\DoxyCodeLine{02617\ }
\DoxyCodeLine{02618\ \ \ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366}{yh\_rc}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}};}
\DoxyCodeLine{02619\ }
\DoxyCodeLine{02620\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[6].\mbox{\hyperlink{yubihsm__pkcs11_8c_a7360b55975153b822efc5217b7734e6a}{len}}\ !=\ 16\ \&\&\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[6].\mbox{\hyperlink{yubihsm__pkcs11_8c_a7360b55975153b822efc5217b7734e6a}{len}}\ !=\ 24\ \&\&\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[6].\mbox{\hyperlink{yubihsm__pkcs11_8c_a7360b55975153b822efc5217b7734e6a}{len}}\ !=\ 32)\ \{}
\DoxyCodeLine{02621\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Key\ length\ (\%zu)\ not\ matching,\ should\ be\ 16,\ 24\ or\ 32\(\backslash\)n"{}},}
\DoxyCodeLine{02622\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[6].\mbox{\hyperlink{yubihsm__pkcs11_8c_a7360b55975153b822efc5217b7734e6a}{len}});}
\DoxyCodeLine{02623\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{02624\ \ \ \}}
\DoxyCodeLine{02625\ }
\DoxyCodeLine{02626\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =}
\DoxyCodeLine{02627\ \ \ \ \ \mbox{\hyperlink{yubihsm_8c_addc22271306d847f53321984f41d818b}{yh\_util\_import\_otp\_aead\_key}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e,\ \&\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].w,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[2].\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}},\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[3].w,}
\DoxyCodeLine{02628\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[4].c,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[5].d,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[6].x,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[6].\mbox{\hyperlink{yubihsm__pkcs11_8c_a7360b55975153b822efc5217b7734e6a}{len}});}
\DoxyCodeLine{02629\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{02630\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ store\ OTP\ AEAD\ key:\ \%s\(\backslash\)n"{}},\ \mbox{\hyperlink{lib_2error_8c_a238eedb1e27dbff2a0ab9a3932eb3f8b}{yh\_strerror}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}));}
\DoxyCodeLine{02631\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{02632\ \ \ \}}
\DoxyCodeLine{02633\ }
\DoxyCodeLine{02634\ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Stored\ OTP\ AEAD\ key\ 0x\%04x\(\backslash\)n"{}},\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].w);}
\DoxyCodeLine{02635\ }
\DoxyCodeLine{02636\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{02637\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_a7ef84380bc19536e4ba9bf62fd44ba93_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_a7ef84380bc19536e4ba9bf62fd44ba93_icgraph}
\end{center}
\end{figure}
\Hypertarget{commands_8c_ad1629b955c1d718c65f137c9df3b3332}\index{commands.c@{commands.c}!yh\_com\_put\_template@{yh\_com\_put\_template}}
\index{yh\_com\_put\_template@{yh\_com\_put\_template}!commands.c@{commands.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_put\_template()}{yh\_com\_put\_template()}}
{\footnotesize\ttfamily \label{commands_8c_ad1629b955c1d718c65f137c9df3b3332} 
int yh\+\_\+com\+\_\+put\+\_\+template (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{commands_8c_source_l01645}{1645}} of file \mbox{\hyperlink{commands_8c_source}{commands.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01645\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01646\ }
\DoxyCodeLine{01647\ \ \ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366}{yh\_rc}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}};}
\DoxyCodeLine{01648\ }
\DoxyCodeLine{01649\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(ctx);}
\DoxyCodeLine{01650\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(fmt);}
\DoxyCodeLine{01651\ }
\DoxyCodeLine{01652\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_ae0fc8d6520950868365011d1a9f450f1}{yh\_util\_import\_template}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e,\ \&\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].w,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[2].\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}},\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[3].w,}
\DoxyCodeLine{01653\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[4].c,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[5].\mbox{\hyperlink{pointer_8h_aeeddce917cf130d62c370b8f216026dd}{a}},\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[6].x,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[6].\mbox{\hyperlink{yubihsm__pkcs11_8c_a7360b55975153b822efc5217b7734e6a}{len}});}
\DoxyCodeLine{01654\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{01655\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ store\ template\ object:\ \%s\(\backslash\)n"{}},\ \mbox{\hyperlink{lib_2error_8c_a238eedb1e27dbff2a0ab9a3932eb3f8b}{yh\_strerror}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}));}
\DoxyCodeLine{01656\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{01657\ \ \ \}}
\DoxyCodeLine{01658\ }
\DoxyCodeLine{01659\ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Stored\ Template\ object\ 0x\%04x\(\backslash\)n"{}},\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].w);}
\DoxyCodeLine{01660\ }
\DoxyCodeLine{01661\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{01662\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_ad1629b955c1d718c65f137c9df3b3332_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_ad1629b955c1d718c65f137c9df3b3332_icgraph}
\end{center}
\end{figure}
\Hypertarget{commands_8c_ab2eb73abfe6f6d5a7f17752b3cab227a}\index{commands.c@{commands.c}!yh\_com\_put\_wrapkey@{yh\_com\_put\_wrapkey}}
\index{yh\_com\_put\_wrapkey@{yh\_com\_put\_wrapkey}!commands.c@{commands.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_put\_wrapkey()}{yh\_com\_put\_wrapkey()}}
{\footnotesize\ttfamily \label{commands_8c_ab2eb73abfe6f6d5a7f17752b3cab227a} 
int yh\+\_\+com\+\_\+put\+\_\+wrapkey (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{commands_8c_source_l01577}{1577}} of file \mbox{\hyperlink{commands_8c_source}{commands.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01577\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01578\ \ \ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366}{yh\_rc}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}};}
\DoxyCodeLine{01579\ }
\DoxyCodeLine{01580\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(ctx);}
\DoxyCodeLine{01581\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(fmt);}
\DoxyCodeLine{01582\ \ \ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55ca}{yh\_algorithm}}\ algo;}
\DoxyCodeLine{01583\ }
\DoxyCodeLine{01584\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[6].\mbox{\hyperlink{yubihsm__pkcs11_8c_a7360b55975153b822efc5217b7734e6a}{len}}\ ==\ 16)\ \{}
\DoxyCodeLine{01585\ \ \ \ \ algo\ =\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caae22b228e457c9bdccb5a93d81730b1b1}{YH\_ALGO\_AES128\_CCM\_WRAP}};}
\DoxyCodeLine{01586\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[6].\mbox{\hyperlink{yubihsm__pkcs11_8c_a7360b55975153b822efc5217b7734e6a}{len}}\ ==\ 24)\ \{}
\DoxyCodeLine{01587\ \ \ \ \ algo\ =\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caab739a1d142dacaf37ba13a73e2d83fab}{YH\_ALGO\_AES192\_CCM\_WRAP}};}
\DoxyCodeLine{01588\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[6].\mbox{\hyperlink{yubihsm__pkcs11_8c_a7360b55975153b822efc5217b7734e6a}{len}}\ ==\ 32)\ \{}
\DoxyCodeLine{01589\ \ \ \ \ algo\ =\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa927e2246e5657f946b4da4b71092b022}{YH\_ALGO\_AES256\_CCM\_WRAP}};}
\DoxyCodeLine{01590\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01591\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Key\ length\ not\ matching,\ should\ be\ 16,\ 24\ or\ 32\(\backslash\)n"{}});}
\DoxyCodeLine{01592\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{01593\ \ \ \}}
\DoxyCodeLine{01594\ }
\DoxyCodeLine{01595\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a3a9729ea5b2e299a735b43f2b23e50a7}{yh\_util\_import\_wrap\_key}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e,\ \&\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].w,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[2].\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}},\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[3].w,}
\DoxyCodeLine{01596\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[4].c,\ algo,\ \&\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[5].c,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[6].x,}
\DoxyCodeLine{01597\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[6].\mbox{\hyperlink{yubihsm__pkcs11_8c_a7360b55975153b822efc5217b7734e6a}{len}});}
\DoxyCodeLine{01598\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{01599\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ store\ wrapkey:\ \%s\(\backslash\)n"{}},\ \mbox{\hyperlink{lib_2error_8c_a238eedb1e27dbff2a0ab9a3932eb3f8b}{yh\_strerror}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}));}
\DoxyCodeLine{01600\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{01601\ \ \ \}}
\DoxyCodeLine{01602\ }
\DoxyCodeLine{01603\ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Stored\ Wrap\ key\ 0x\%04x\(\backslash\)n"{}},\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].w);}
\DoxyCodeLine{01604\ }
\DoxyCodeLine{01605\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{01606\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_ab2eb73abfe6f6d5a7f17752b3cab227a_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_ab2eb73abfe6f6d5a7f17752b3cab227a_icgraph}
\end{center}
\end{figure}
\Hypertarget{commands_8c_a6b74f2d2d47796c2432a15cd63183dd1}\index{commands.c@{commands.c}!yh\_com\_put\_wrapped@{yh\_com\_put\_wrapped}}
\index{yh\_com\_put\_wrapped@{yh\_com\_put\_wrapped}!commands.c@{commands.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_put\_wrapped()}{yh\_com\_put\_wrapped()}}
{\footnotesize\ttfamily \label{commands_8c_a6b74f2d2d47796c2432a15cd63183dd1} 
int yh\+\_\+com\+\_\+put\+\_\+wrapped (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{commands_8c_source_l01613}{1613}} of file \mbox{\hyperlink{commands_8c_source}{commands.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01613\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01614\ \ \ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366}{yh\_rc}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}};}
\DoxyCodeLine{01615\ \ \ \mbox{\hyperlink{yubihsm_8h_a2fe39512cb4df34b270a67dbb8e13583}{yh\_object\_type}}\ \mbox{\hyperlink{namespacesysio_1_1chain_a2d924ca9891de9b9edf3ccb582ec7591}{object\_type}};}
\DoxyCodeLine{01616\ \ \ \mbox{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t}}\ object\_id;}
\DoxyCodeLine{01617\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *type\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{01618\ }
\DoxyCodeLine{01619\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(ctx);}
\DoxyCodeLine{01620\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(fmt);}
\DoxyCodeLine{01621\ }
\DoxyCodeLine{01622\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_ae5bf13f9558bb0340468b722accf94d3}{yh\_util\_import\_wrapped}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].w,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[2].x,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[2].\mbox{\hyperlink{yubihsm__pkcs11_8c_a7360b55975153b822efc5217b7734e6a}{len}},}
\DoxyCodeLine{01623\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&object\_type,\ \&object\_id);}
\DoxyCodeLine{01624\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{01625\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ store\ wrapped\ object:\ \%s\(\backslash\)n"{}},\ \mbox{\hyperlink{lib_2error_8c_a238eedb1e27dbff2a0ab9a3932eb3f8b}{yh\_strerror}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}));}
\DoxyCodeLine{01626\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{01627\ \ \ \}}
\DoxyCodeLine{01628\ }
\DoxyCodeLine{01629\ \ \ \mbox{\hyperlink{yubihsm_8c_afe3d701f7470c1d7b05480e4b6728bf7}{yh\_type\_to\_string}}(object\_type,\ \&type);}
\DoxyCodeLine{01630\ }
\DoxyCodeLine{01631\ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Object\ imported\ as\ 0x\%04x\ of\ type\ \%s\(\backslash\)n"{}},\ object\_id,\ type);}
\DoxyCodeLine{01632\ }
\DoxyCodeLine{01633\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{01634\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_a6b74f2d2d47796c2432a15cd63183dd1_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_a6b74f2d2d47796c2432a15cd63183dd1_icgraph}
\end{center}
\end{figure}
\Hypertarget{commands_8c_a5947d870ac856de3880f8b80981e6355}\index{commands.c@{commands.c}!yh\_com\_reset@{yh\_com\_reset}}
\index{yh\_com\_reset@{yh\_com\_reset}!commands.c@{commands.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_reset()}{yh\_com\_reset()}}
{\footnotesize\ttfamily \label{commands_8c_a5947d870ac856de3880f8b80981e6355} 
int yh\+\_\+com\+\_\+reset (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{commands_8c_source_l01953}{1953}} of file \mbox{\hyperlink{commands_8c_source}{commands.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01953\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01954\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(ctx);}
\DoxyCodeLine{01955\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(fmt);}
\DoxyCodeLine{01956\ }
\DoxyCodeLine{01957\ \ \ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366}{yh\_rc}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}};}
\DoxyCodeLine{01958\ }
\DoxyCodeLine{01959\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a5c153fe27877bcc7927d391fb55550af}{yh\_util\_reset\_device}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e);}
\DoxyCodeLine{01960\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366ae4f6537a9d33914ea06c53b015d92ca8}{YHR\_CONNECTION\_ERROR}}\ \&\&\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{01961\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ reset\ device:\ \%s\(\backslash\)n"{}},\ \mbox{\hyperlink{lib_2error_8c_a238eedb1e27dbff2a0ab9a3932eb3f8b}{yh\_strerror}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}));}
\DoxyCodeLine{01962\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{01963\ \ \ \}}
\DoxyCodeLine{01964\ }
\DoxyCodeLine{01965\ \ \ fprintf(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}},\ \textcolor{stringliteral}{"{}Device\ successfully\ reset\(\backslash\)n"{}});}
\DoxyCodeLine{01966\ }
\DoxyCodeLine{01967\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{01968\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_a5947d870ac856de3880f8b80981e6355_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_a5947d870ac856de3880f8b80981e6355_icgraph}
\end{center}
\end{figure}
\Hypertarget{commands_8c_ada05a561c71aebab8f0a53c0d552e027}\index{commands.c@{commands.c}!yh\_com\_set\_cacert@{yh\_com\_set\_cacert}}
\index{yh\_com\_set\_cacert@{yh\_com\_set\_cacert}!commands.c@{commands.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_set\_cacert()}{yh\_com\_set\_cacert()}}
{\footnotesize\ttfamily \label{commands_8c_ada05a561c71aebab8f0a53c0d552e027} 
int yh\+\_\+com\+\_\+set\+\_\+cacert (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{commands_8c_source_l02735}{2735}} of file \mbox{\hyperlink{commands_8c_source}{commands.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02735\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02736\ }
\DoxyCodeLine{02737\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(fmt);}
\DoxyCodeLine{02738\ }
\DoxyCodeLine{02739\ \ \ \textcolor{keywordflow}{if}\ (ctx-\/>\mbox{\hyperlink{structyubihsm__context_a97d98362b0e43b749a9cb75da4793932}{cacert}})\ \{}
\DoxyCodeLine{02740\ \ \ \ \ free(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a97d98362b0e43b749a9cb75da4793932}{cacert}});}
\DoxyCodeLine{02741\ \ \ \}}
\DoxyCodeLine{02742\ \ \ ctx-\/>\mbox{\hyperlink{structyubihsm__context_a97d98362b0e43b749a9cb75da4793932}{cacert}}\ =\ strdup(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}});}
\DoxyCodeLine{02743\ }
\DoxyCodeLine{02744\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{02745\ \}}

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_ada05a561c71aebab8f0a53c0d552e027_icgraph}
\end{center}
\end{figure}
\Hypertarget{commands_8c_aeb72c881aa2699aea40f45fa65cf069b}\index{commands.c@{commands.c}!yh\_com\_set\_log\_index@{yh\_com\_set\_log\_index}}
\index{yh\_com\_set\_log\_index@{yh\_com\_set\_log\_index}!commands.c@{commands.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_set\_log\_index()}{yh\_com\_set\_log\_index()}}
{\footnotesize\ttfamily \label{commands_8c_aeb72c881aa2699aea40f45fa65cf069b} 
int yh\+\_\+com\+\_\+set\+\_\+log\+\_\+index (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{commands_8c_source_l00141}{141}} of file \mbox{\hyperlink{commands_8c_source}{commands.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00141\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00142\ }
\DoxyCodeLine{00143\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(ctx);}
\DoxyCodeLine{00144\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(fmt);}
\DoxyCodeLine{00145\ }
\DoxyCodeLine{00146\ \ \ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366}{yh\_rc}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a9d844855c9066bbea0e4344978dd7fdc}{yh\_util\_set\_log\_index}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].w);}
\DoxyCodeLine{00147\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{00148\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ set\ log\ index:\ \%s\(\backslash\)n"{}},\ \mbox{\hyperlink{lib_2error_8c_a238eedb1e27dbff2a0ab9a3932eb3f8b}{yh\_strerror}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}));}
\DoxyCodeLine{00149\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{00150\ \ \ \}}
\DoxyCodeLine{00151\ }
\DoxyCodeLine{00152\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00153\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_aeb72c881aa2699aea40f45fa65cf069b_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_aeb72c881aa2699aea40f45fa65cf069b_icgraph}
\end{center}
\end{figure}
\Hypertarget{commands_8c_a264ec5c469bd0517814525ef59c8e69e}\index{commands.c@{commands.c}!yh\_com\_set\_proxy@{yh\_com\_set\_proxy}}
\index{yh\_com\_set\_proxy@{yh\_com\_set\_proxy}!commands.c@{commands.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_set\_proxy()}{yh\_com\_set\_proxy()}}
{\footnotesize\ttfamily \label{commands_8c_a264ec5c469bd0517814525ef59c8e69e} 
int yh\+\_\+com\+\_\+set\+\_\+proxy (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{commands_8c_source_l02750}{2750}} of file \mbox{\hyperlink{commands_8c_source}{commands.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02750\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02751\ }
\DoxyCodeLine{02752\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(fmt);}
\DoxyCodeLine{02753\ }
\DoxyCodeLine{02754\ \ \ ctx-\/>\mbox{\hyperlink{structyubihsm__context_aa2578fc399603af54de958824179cae4}{proxy}}\ =\ strdup(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}});}
\DoxyCodeLine{02755\ \ \ \textcolor{keywordflow}{if}\ (ctx-\/>\mbox{\hyperlink{structyubihsm__context_aa2578fc399603af54de958824179cae4}{proxy}})\ \{}
\DoxyCodeLine{02756\ \ \ \ \ free(ctx-\/>\mbox{\hyperlink{structyubihsm__context_aa2578fc399603af54de958824179cae4}{proxy}});}
\DoxyCodeLine{02757\ \ \ \}}
\DoxyCodeLine{02758\ }
\DoxyCodeLine{02759\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{02760\ \}}

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_a264ec5c469bd0517814525ef59c8e69e_icgraph}
\end{center}
\end{figure}
\Hypertarget{commands_8c_af224308de5cdf8e20cbbdcaa6cf7598c}\index{commands.c@{commands.c}!yh\_com\_sign\_attestation\_certificate@{yh\_com\_sign\_attestation\_certificate}}
\index{yh\_com\_sign\_attestation\_certificate@{yh\_com\_sign\_attestation\_certificate}!commands.c@{commands.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_sign\_attestation\_certificate()}{yh\_com\_sign\_attestation\_certificate()}}
{\footnotesize\ttfamily \label{commands_8c_af224308de5cdf8e20cbbdcaa6cf7598c} 
int yh\+\_\+com\+\_\+sign\+\_\+attestation\+\_\+certificate (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{commands_8c_source_l02567}{2567}} of file \mbox{\hyperlink{commands_8c_source}{commands.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02568\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02569\ \ \ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ data[2048];}
\DoxyCodeLine{02570\ \ \ \textcolor{keywordtype}{size\_t}\ data\_len\ =\ \textcolor{keyword}{sizeof}(data);}
\DoxyCodeLine{02571\ \ \ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366}{yh\_rc}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}};}
\DoxyCodeLine{02572\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}}\ =\ -\/1;}
\DoxyCodeLine{02573\ }
\DoxyCodeLine{02574\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a5988faffd97366b188728ff1a7fb6e89}{yh\_util\_sign\_attestation\_certificate}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].w,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[2].w,}
\DoxyCodeLine{02575\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ data,\ \&data\_len);}
\DoxyCodeLine{02576\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{02577\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ attest\ asymmetric\ key:\ \%s\(\backslash\)n"{}},\ \mbox{\hyperlink{lib_2error_8c_a238eedb1e27dbff2a0ab9a3932eb3f8b}{yh\_strerror}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}));}
\DoxyCodeLine{02578\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{02579\ \ \ \}}
\DoxyCodeLine{02580\ }
\DoxyCodeLine{02581\ \ \ X509\ *x509\ =\ X509\_new();}
\DoxyCodeLine{02582\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *ptr\ =\ data;}
\DoxyCodeLine{02583\ \ \ \textcolor{keywordflow}{if}\ (!x509)\ \{}
\DoxyCodeLine{02584\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ allocating\ x509\ structure\(\backslash\)n"{}});}
\DoxyCodeLine{02585\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{02586\ \ \ \}}
\DoxyCodeLine{02587\ \ \ x509\ =\ d2i\_X509(NULL,\ \&ptr,\ data\_len);}
\DoxyCodeLine{02588\ \ \ \textcolor{keywordflow}{if}\ (!x509)\ \{}
\DoxyCodeLine{02589\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ parsing\ x509\ information\(\backslash\)n"{}});}
\DoxyCodeLine{02590\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02591\ \ \ \ \ \textcolor{keywordflow}{if}\ (fmt\ ==\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708add674d756d2c6341a834a330a874b550}{fmt\_base64}}\ ||\ fmt\ ==\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708aa8908f2c651567ae288c587240e71d3e}{fmt\_PEM}})\ \{}
\DoxyCodeLine{02592\ \ \ \ \ \ \ PEM\_write\_X509(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}},\ x509);}
\DoxyCodeLine{02593\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (fmt\ ==\ \mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708a701725c70fb214e14a2feee390939a09}{fmt\_binary}})\ \{}
\DoxyCodeLine{02594\ \ \ \ \ \ \ i2d\_X509\_fp(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}},\ x509);}
\DoxyCodeLine{02595\ \ \ \ \ \}}
\DoxyCodeLine{02596\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}}\ =\ 0;}
\DoxyCodeLine{02597\ \ \ \}}
\DoxyCodeLine{02598\ }
\DoxyCodeLine{02599\ \ \ X509\_free(x509);}
\DoxyCodeLine{02600\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}};}
\DoxyCodeLine{02601\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_af224308de5cdf8e20cbbdcaa6cf7598c_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_af224308de5cdf8e20cbbdcaa6cf7598c_icgraph}
\end{center}
\end{figure}
\Hypertarget{commands_8c_a982058963f9ff020c357030be09e79fc}\index{commands.c@{commands.c}!yh\_com\_sign\_ecdsa@{yh\_com\_sign\_ecdsa}}
\index{yh\_com\_sign\_ecdsa@{yh\_com\_sign\_ecdsa}!commands.c@{commands.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_sign\_ecdsa()}{yh\_com\_sign\_ecdsa()}}
{\footnotesize\ttfamily \label{commands_8c_a982058963f9ff020c357030be09e79fc} 
int yh\+\_\+com\+\_\+sign\+\_\+ecdsa (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{commands_8c_source_l01670}{1670}} of file \mbox{\hyperlink{commands_8c_source}{commands.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01670\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01671\ }
\DoxyCodeLine{01672\ \ \ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366}{yh\_rc}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}};}
\DoxyCodeLine{01673\ }
\DoxyCodeLine{01674\ \ \ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ data[\mbox{\hyperlink{yubihsm_8h_a706bd8e7adf0de85e6cfb0efc8981d3f}{YH\_MSG\_BUF\_SIZE}}];}
\DoxyCodeLine{01675\ \ \ \textcolor{keywordtype}{size\_t}\ data\_len;}
\DoxyCodeLine{01676\ }
\DoxyCodeLine{01677\ \ \ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ response[\mbox{\hyperlink{yubihsm_8h_a706bd8e7adf0de85e6cfb0efc8981d3f}{YH\_MSG\_BUF\_SIZE}}];}
\DoxyCodeLine{01678\ \ \ \textcolor{keywordtype}{size\_t}\ response\_len\ =\ \textcolor{keyword}{sizeof}(response);}
\DoxyCodeLine{01679\ }
\DoxyCodeLine{01680\ \ \ \textcolor{keywordtype}{int}\ hash;}
\DoxyCodeLine{01681\ }
\DoxyCodeLine{01682\ \ \ \textcolor{keywordflow}{switch}\ (\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[2].\mbox{\hyperlink{pointer_8h_aeeddce917cf130d62c370b8f216026dd}{a}})\ \{}
\DoxyCodeLine{01683\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caae9b7b5598c3839a53e4986dc901be244}{YH\_ALGO\_EC\_ECDSA\_SHA1}}:}
\DoxyCodeLine{01684\ \ \ \ \ \ \ hash\ =\ \mbox{\hyperlink{yubihsm_2common_2hash_8h_a488906826f8aaf7e850c35889d560089a970f17bf10faf2a31f535116e97f6b4a}{\_SHA1}};}
\DoxyCodeLine{01685\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01686\ }
\DoxyCodeLine{01687\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa2e5dfe9c79cb0d391d7bf952227268ec}{YH\_ALGO\_EC\_ECDSA\_SHA256}}:}
\DoxyCodeLine{01688\ \ \ \ \ \ \ hash\ =\ \mbox{\hyperlink{yubihsm_2common_2hash_8h_a488906826f8aaf7e850c35889d560089af0ab1a9d65ceafa4ba1f6f177e379258}{\_SHA256}};}
\DoxyCodeLine{01689\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01690\ }
\DoxyCodeLine{01691\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa657d2b30d884aeeff3c024404132ad69}{YH\_ALGO\_EC\_ECDSA\_SHA384}}:}
\DoxyCodeLine{01692\ \ \ \ \ \ \ hash\ =\ \mbox{\hyperlink{yubihsm_2common_2hash_8h_a488906826f8aaf7e850c35889d560089a46254673795a1d78b2d84adbf88d8bb2}{\_SHA384}};}
\DoxyCodeLine{01693\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01694\ }
\DoxyCodeLine{01695\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa44153987efd3466070143dbab77f2d70}{YH\_ALGO\_EC\_ECDSA\_SHA512}}:}
\DoxyCodeLine{01696\ \ \ \ \ \ \ hash\ =\ \mbox{\hyperlink{yubihsm_2common_2hash_8h_a488906826f8aaf7e850c35889d560089a0dbf438178c608dea7392e75c9b7ae2d}{\_SHA512}};}
\DoxyCodeLine{01697\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01698\ }
\DoxyCodeLine{01699\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{01700\ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Invalid\ hash\ algorithm\(\backslash\)n"{}});}
\DoxyCodeLine{01701\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{01702\ \ \ \}}
\DoxyCodeLine{01703\ }
\DoxyCodeLine{01704\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{hash_8c_a062ee0f36e0c16725c22a5d9d964a8cd}{hash\_bytes}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[3].x,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[3].\mbox{\hyperlink{yubihsm__pkcs11_8c_a7360b55975153b822efc5217b7734e6a}{len}},\ hash,\ data,\ \&data\_len)\ ==\ \textcolor{keyword}{false})\ \{}
\DoxyCodeLine{01705\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Unable\ to\ hash\ file\(\backslash\)n"{}});}
\DoxyCodeLine{01706\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{01707\ \ \ \}}
\DoxyCodeLine{01708\ }
\DoxyCodeLine{01709\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a5121c90d3bd745afd8264fef2ef39ace}{yh\_util\_sign\_ecdsa}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].w,\ data,\ data\_len,\ response,}
\DoxyCodeLine{01710\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&response\_len);}
\DoxyCodeLine{01711\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{01712\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ sign\ data\ with\ ecdsa:\ \%s\(\backslash\)n"{}},\ \mbox{\hyperlink{lib_2error_8c_a238eedb1e27dbff2a0ab9a3932eb3f8b}{yh\_strerror}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}));}
\DoxyCodeLine{01713\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{01714\ \ \ \}}
\DoxyCodeLine{01715\ }
\DoxyCodeLine{01716\ \ \ \mbox{\hyperlink{util_8c_ad969d220471d10a9f07080b50210f403}{write\_file}}(response,\ response\_len,\ ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}},\ fmt\_to\_fmt(fmt));}
\DoxyCodeLine{01717\ }
\DoxyCodeLine{01718\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{01719\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_a982058963f9ff020c357030be09e79fc_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_a982058963f9ff020c357030be09e79fc_icgraph}
\end{center}
\end{figure}
\Hypertarget{commands_8c_ac867ca0fc75e87da1a8d924fc587f5b9}\index{commands.c@{commands.c}!yh\_com\_sign\_eddsa@{yh\_com\_sign\_eddsa}}
\index{yh\_com\_sign\_eddsa@{yh\_com\_sign\_eddsa}!commands.c@{commands.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_sign\_eddsa()}{yh\_com\_sign\_eddsa()}}
{\footnotesize\ttfamily \label{commands_8c_ac867ca0fc75e87da1a8d924fc587f5b9} 
int yh\+\_\+com\+\_\+sign\+\_\+eddsa (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{commands_8c_source_l01727}{1727}} of file \mbox{\hyperlink{commands_8c_source}{commands.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01727\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01728\ }
\DoxyCodeLine{01729\ \ \ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366}{yh\_rc}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}};}
\DoxyCodeLine{01730\ }
\DoxyCodeLine{01731\ \ \ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ response[\mbox{\hyperlink{yubihsm_8h_a706bd8e7adf0de85e6cfb0efc8981d3f}{YH\_MSG\_BUF\_SIZE}}];}
\DoxyCodeLine{01732\ \ \ \textcolor{keywordtype}{size\_t}\ response\_len\ =\ \textcolor{keyword}{sizeof}(response);}
\DoxyCodeLine{01733\ }
\DoxyCodeLine{01734\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[2].\mbox{\hyperlink{pointer_8h_aeeddce917cf130d62c370b8f216026dd}{a}}\ !=\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa68c2c97f16c36f727e41a899d8a7e8bd}{YH\_ALGO\_EC\_ED25519}})\ \{}
\DoxyCodeLine{01735\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Invalid\ algorithm\(\backslash\)n"{}});}
\DoxyCodeLine{01736\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{01737\ \ \ \}}
\DoxyCodeLine{01738\ }
\DoxyCodeLine{01739\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a690a5585de21ce82495e139ec1dfdf9d}{yh\_util\_sign\_eddsa}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].w,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[3].x,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[3].\mbox{\hyperlink{yubihsm__pkcs11_8c_a7360b55975153b822efc5217b7734e6a}{len}},}
\DoxyCodeLine{01740\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ response,\ \&response\_len);}
\DoxyCodeLine{01741\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{01742\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ sign\ data\ with\ eddsa:\ \%s\(\backslash\)n"{}},\ \mbox{\hyperlink{lib_2error_8c_a238eedb1e27dbff2a0ab9a3932eb3f8b}{yh\_strerror}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}));}
\DoxyCodeLine{01743\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{01744\ \ \ \}}
\DoxyCodeLine{01745\ }
\DoxyCodeLine{01746\ \ \ \mbox{\hyperlink{util_8c_ad969d220471d10a9f07080b50210f403}{write\_file}}(response,\ response\_len,\ ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}},\ fmt\_to\_fmt(fmt));}
\DoxyCodeLine{01747\ }
\DoxyCodeLine{01748\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{01749\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_ac867ca0fc75e87da1a8d924fc587f5b9_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_ac867ca0fc75e87da1a8d924fc587f5b9_icgraph}
\end{center}
\end{figure}
\Hypertarget{commands_8c_a98cf5e35ce2e4fd5881d8b6e7a890357}\index{commands.c@{commands.c}!yh\_com\_sign\_pkcs1v1\_5@{yh\_com\_sign\_pkcs1v1\_5}}
\index{yh\_com\_sign\_pkcs1v1\_5@{yh\_com\_sign\_pkcs1v1\_5}!commands.c@{commands.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_sign\_pkcs1v1\_5()}{yh\_com\_sign\_pkcs1v1\_5()}}
{\footnotesize\ttfamily \label{commands_8c_a98cf5e35ce2e4fd5881d8b6e7a890357} 
int yh\+\_\+com\+\_\+sign\+\_\+pkcs1v1\+\_\+5 (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{commands_8c_source_l01757}{1757}} of file \mbox{\hyperlink{commands_8c_source}{commands.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01758\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01759\ }
\DoxyCodeLine{01760\ \ \ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366}{yh\_rc}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}};}
\DoxyCodeLine{01761\ }
\DoxyCodeLine{01762\ \ \ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ data[\mbox{\hyperlink{yubihsm_8h_a706bd8e7adf0de85e6cfb0efc8981d3f}{YH\_MSG\_BUF\_SIZE}}];}
\DoxyCodeLine{01763\ \ \ \textcolor{keywordtype}{size\_t}\ data\_len;}
\DoxyCodeLine{01764\ }
\DoxyCodeLine{01765\ \ \ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ response[\mbox{\hyperlink{yubihsm_8h_a706bd8e7adf0de85e6cfb0efc8981d3f}{YH\_MSG\_BUF\_SIZE}}];}
\DoxyCodeLine{01766\ \ \ \textcolor{keywordtype}{size\_t}\ response\_len\ =\ \textcolor{keyword}{sizeof}(response);}
\DoxyCodeLine{01767\ }
\DoxyCodeLine{01768\ \ \ \textcolor{keywordtype}{int}\ hash;}
\DoxyCodeLine{01769\ }
\DoxyCodeLine{01770\ \ \ \textcolor{keywordflow}{switch}\ (\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[2].\mbox{\hyperlink{pointer_8h_aeeddce917cf130d62c370b8f216026dd}{a}})\ \{}
\DoxyCodeLine{01771\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa1982e3db182a679514674f454e2b79ad}{YH\_ALGO\_RSA\_PKCS1\_SHA1}}:}
\DoxyCodeLine{01772\ \ \ \ \ \ \ hash\ =\ \mbox{\hyperlink{yubihsm_2common_2hash_8h_a488906826f8aaf7e850c35889d560089a970f17bf10faf2a31f535116e97f6b4a}{\_SHA1}};}
\DoxyCodeLine{01773\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01774\ }
\DoxyCodeLine{01775\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa18e17370fcf9a829572e57608aff743c}{YH\_ALGO\_RSA\_PKCS1\_SHA256}}:}
\DoxyCodeLine{01776\ \ \ \ \ \ \ hash\ =\ \mbox{\hyperlink{yubihsm_2common_2hash_8h_a488906826f8aaf7e850c35889d560089af0ab1a9d65ceafa4ba1f6f177e379258}{\_SHA256}};}
\DoxyCodeLine{01777\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01778\ }
\DoxyCodeLine{01779\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caafc78c2f62fe0a185c38d2644755fde2c}{YH\_ALGO\_RSA\_PKCS1\_SHA384}}:}
\DoxyCodeLine{01780\ \ \ \ \ \ \ hash\ =\ \mbox{\hyperlink{yubihsm_2common_2hash_8h_a488906826f8aaf7e850c35889d560089a46254673795a1d78b2d84adbf88d8bb2}{\_SHA384}};}
\DoxyCodeLine{01781\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01782\ }
\DoxyCodeLine{01783\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa84e18ba6561d5a834dc8d794504708db}{YH\_ALGO\_RSA\_PKCS1\_SHA512}}:}
\DoxyCodeLine{01784\ \ \ \ \ \ \ hash\ =\ \mbox{\hyperlink{yubihsm_2common_2hash_8h_a488906826f8aaf7e850c35889d560089a0dbf438178c608dea7392e75c9b7ae2d}{\_SHA512}};}
\DoxyCodeLine{01785\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01786\ }
\DoxyCodeLine{01787\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{01788\ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Invalid\ hash\ algorithm\(\backslash\)n"{}});}
\DoxyCodeLine{01789\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{01790\ \ \ \}}
\DoxyCodeLine{01791\ }
\DoxyCodeLine{01792\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{hash_8c_a062ee0f36e0c16725c22a5d9d964a8cd}{hash\_bytes}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[3].x,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[3].\mbox{\hyperlink{yubihsm__pkcs11_8c_a7360b55975153b822efc5217b7734e6a}{len}},\ hash,\ data,\ \&data\_len)\ ==\ \textcolor{keyword}{false})\ \{}
\DoxyCodeLine{01793\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Unable\ to\ hash\ file\(\backslash\)n"{}});}
\DoxyCodeLine{01794\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{01795\ \ \ \}}
\DoxyCodeLine{01796\ }
\DoxyCodeLine{01797\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_aa0a7644b7b368d6aaf8b4aff5e3d19b8}{yh\_util\_sign\_pkcs1v1\_5}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].w,\ \textcolor{keyword}{true},\ data,\ data\_len,}
\DoxyCodeLine{01798\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ response,\ \&response\_len);}
\DoxyCodeLine{01799\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{01800\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ sign\ data\ with\ PKCS\#1v1.5:\ \%s\(\backslash\)n"{}},}
\DoxyCodeLine{01801\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{lib_2error_8c_a238eedb1e27dbff2a0ab9a3932eb3f8b}{yh\_strerror}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}));}
\DoxyCodeLine{01802\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{01803\ \ \ \}}
\DoxyCodeLine{01804\ }
\DoxyCodeLine{01805\ \ \ \mbox{\hyperlink{util_8c_ad969d220471d10a9f07080b50210f403}{write\_file}}(response,\ response\_len,\ ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}},\ fmt\_to\_fmt(fmt));}
\DoxyCodeLine{01806\ }
\DoxyCodeLine{01807\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{01808\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_a98cf5e35ce2e4fd5881d8b6e7a890357_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_a98cf5e35ce2e4fd5881d8b6e7a890357_icgraph}
\end{center}
\end{figure}
\Hypertarget{commands_8c_a1dcbe3dfaa3722ae6e9246527b889627}\index{commands.c@{commands.c}!yh\_com\_sign\_pss@{yh\_com\_sign\_pss}}
\index{yh\_com\_sign\_pss@{yh\_com\_sign\_pss}!commands.c@{commands.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_sign\_pss()}{yh\_com\_sign\_pss()}}
{\footnotesize\ttfamily \label{commands_8c_a1dcbe3dfaa3722ae6e9246527b889627} 
int yh\+\_\+com\+\_\+sign\+\_\+pss (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{commands_8c_source_l01816}{1816}} of file \mbox{\hyperlink{commands_8c_source}{commands.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01816\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01817\ }
\DoxyCodeLine{01818\ \ \ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366}{yh\_rc}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}};}
\DoxyCodeLine{01819\ }
\DoxyCodeLine{01820\ \ \ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ data[\mbox{\hyperlink{yubihsm_8h_a706bd8e7adf0de85e6cfb0efc8981d3f}{YH\_MSG\_BUF\_SIZE}}];}
\DoxyCodeLine{01821\ \ \ \textcolor{keywordtype}{size\_t}\ data\_len;}
\DoxyCodeLine{01822\ }
\DoxyCodeLine{01823\ \ \ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ response[\mbox{\hyperlink{yubihsm_8h_a706bd8e7adf0de85e6cfb0efc8981d3f}{YH\_MSG\_BUF\_SIZE}}];}
\DoxyCodeLine{01824\ \ \ \textcolor{keywordtype}{size\_t}\ response\_len\ =\ \textcolor{keyword}{sizeof}(response);}
\DoxyCodeLine{01825\ }
\DoxyCodeLine{01826\ \ \ \textcolor{keywordtype}{int}\ hash;}
\DoxyCodeLine{01827\ \ \ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55ca}{yh\_algorithm}}\ mgf;}
\DoxyCodeLine{01828\ }
\DoxyCodeLine{01829\ \ \ \textcolor{keywordflow}{switch}\ (\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[2].\mbox{\hyperlink{pointer_8h_aeeddce917cf130d62c370b8f216026dd}{a}})\ \{}
\DoxyCodeLine{01830\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa24d40fa957c584cf2ef0f5b0053b9f32}{YH\_ALGO\_RSA\_PSS\_SHA1}}:}
\DoxyCodeLine{01831\ \ \ \ \ \ \ hash\ =\ \mbox{\hyperlink{yubihsm_2common_2hash_8h_a488906826f8aaf7e850c35889d560089a970f17bf10faf2a31f535116e97f6b4a}{\_SHA1}};}
\DoxyCodeLine{01832\ \ \ \ \ \ \ mgf\ =\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caae1ab21f2df42a56bdc8ff046ed14797a}{YH\_ALGO\_MGF1\_SHA1}};}
\DoxyCodeLine{01833\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01834\ }
\DoxyCodeLine{01835\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caac42381f876f5e7190547cf81021451f5}{YH\_ALGO\_RSA\_PSS\_SHA256}}:}
\DoxyCodeLine{01836\ \ \ \ \ \ \ hash\ =\ \mbox{\hyperlink{yubihsm_2common_2hash_8h_a488906826f8aaf7e850c35889d560089af0ab1a9d65ceafa4ba1f6f177e379258}{\_SHA256}};}
\DoxyCodeLine{01837\ \ \ \ \ \ \ mgf\ =\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caae3f68121c91d613fe450c12fad55eab2}{YH\_ALGO\_MGF1\_SHA256}};}
\DoxyCodeLine{01838\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01839\ }
\DoxyCodeLine{01840\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa144083d6414cb33e8543d51e7d361d05}{YH\_ALGO\_RSA\_PSS\_SHA384}}:}
\DoxyCodeLine{01841\ \ \ \ \ \ \ hash\ =\ \mbox{\hyperlink{yubihsm_2common_2hash_8h_a488906826f8aaf7e850c35889d560089a46254673795a1d78b2d84adbf88d8bb2}{\_SHA384}};}
\DoxyCodeLine{01842\ \ \ \ \ \ \ mgf\ =\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa788440387af34a9aa10a3e5561c8ee31}{YH\_ALGO\_MGF1\_SHA384}};}
\DoxyCodeLine{01843\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01844\ }
\DoxyCodeLine{01845\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa1d5a50a1a53000cd2b2989c17703e2d1}{YH\_ALGO\_RSA\_PSS\_SHA512}}:}
\DoxyCodeLine{01846\ \ \ \ \ \ \ hash\ =\ \mbox{\hyperlink{yubihsm_2common_2hash_8h_a488906826f8aaf7e850c35889d560089a0dbf438178c608dea7392e75c9b7ae2d}{\_SHA512}};}
\DoxyCodeLine{01847\ \ \ \ \ \ \ mgf\ =\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa104308e8fac7553b1d875f149ff133b1}{YH\_ALGO\_MGF1\_SHA512}};}
\DoxyCodeLine{01848\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01849\ }
\DoxyCodeLine{01850\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{01851\ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Invalid\ hash\ algorithm\(\backslash\)n"{}});}
\DoxyCodeLine{01852\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{01853\ \ \ \}}
\DoxyCodeLine{01854\ }
\DoxyCodeLine{01855\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{hash_8c_a062ee0f36e0c16725c22a5d9d964a8cd}{hash\_bytes}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[3].x,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[3].\mbox{\hyperlink{yubihsm__pkcs11_8c_a7360b55975153b822efc5217b7734e6a}{len}},\ hash,\ data,\ \&data\_len)\ ==\ \textcolor{keyword}{false})\ \{}
\DoxyCodeLine{01856\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Unable\ to\ hash\ file\(\backslash\)n"{}});}
\DoxyCodeLine{01857\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{01858\ \ \ \}}
\DoxyCodeLine{01859\ }
\DoxyCodeLine{01860\ \ \ \textcolor{comment}{//\ NOTE(adma):\ Salt\ length\ always\ matches\ the\ length\ of\ the\ hash}}
\DoxyCodeLine{01861\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a944e6f31487857709f032598fd43fef5}{yh\_util\_sign\_pss}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].w,\ data,\ data\_len,\ response,}
\DoxyCodeLine{01862\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&response\_len,\ data\_len,\ mgf);}
\DoxyCodeLine{01863\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{01864\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ sign\ data\ with\ PSS:\ \%s\(\backslash\)n"{}},\ \mbox{\hyperlink{lib_2error_8c_a238eedb1e27dbff2a0ab9a3932eb3f8b}{yh\_strerror}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}));}
\DoxyCodeLine{01865\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{01866\ \ \ \}}
\DoxyCodeLine{01867\ }
\DoxyCodeLine{01868\ \ \ \mbox{\hyperlink{util_8c_ad969d220471d10a9f07080b50210f403}{write\_file}}(response,\ response\_len,\ ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}},\ fmt\_to\_fmt(fmt));}
\DoxyCodeLine{01869\ }
\DoxyCodeLine{01870\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{01871\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_a1dcbe3dfaa3722ae6e9246527b889627_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_a1dcbe3dfaa3722ae6e9246527b889627_icgraph}
\end{center}
\end{figure}
\Hypertarget{commands_8c_a03581158b5703a0ffe866d50d8a3982d}\index{commands.c@{commands.c}!yh\_com\_sign\_ssh\_certificate@{yh\_com\_sign\_ssh\_certificate}}
\index{yh\_com\_sign\_ssh\_certificate@{yh\_com\_sign\_ssh\_certificate}!commands.c@{commands.c}}
\doxysubsubsection{\texorpdfstring{yh\_com\_sign\_ssh\_certificate()}{yh\_com\_sign\_ssh\_certificate()}}
{\footnotesize\ttfamily \label{commands_8c_a03581158b5703a0ffe866d50d8a3982d} 
int yh\+\_\+com\+\_\+sign\+\_\+ssh\+\_\+certificate (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__context}{yubihsm\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{struct_argument}{Argument}} \texorpdfstring{$\ast$}{*}}]{argv}{, }\item[{\mbox{\hyperlink{yubihsm-shell_8h_a78db5959e08d52cc64e7032bf1b1e708}{cmd\+\_\+format}}}]{fmt}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{commands_8c_source_l01995}{1995}} of file \mbox{\hyperlink{commands_8c_source}{commands.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01996\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01997\ }
\DoxyCodeLine{01998\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(fmt);\ \textcolor{comment}{//\ TODO:\ respect\ output\ format}}
\DoxyCodeLine{01999\ }
\DoxyCodeLine{02000\ \ \ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366}{yh\_rc}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}};}
\DoxyCodeLine{02001\ }
\DoxyCodeLine{02002\ \ \ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ data[\mbox{\hyperlink{yubihsm_8h_a706bd8e7adf0de85e6cfb0efc8981d3f}{YH\_MSG\_BUF\_SIZE}}\ +\ 1024];}
\DoxyCodeLine{02003\ \ \ \textcolor{keywordtype}{size\_t}\ response\_len\ =\ \textcolor{keyword}{sizeof}(data);}
\DoxyCodeLine{02004\ }
\DoxyCodeLine{02005\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(data,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[4].x,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[4].\mbox{\hyperlink{yubihsm__pkcs11_8c_a7360b55975153b822efc5217b7734e6a}{len}});}
\DoxyCodeLine{02006\ \ \ response\_len\ -\/=\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[4].len;}
\DoxyCodeLine{02007\ }
\DoxyCodeLine{02008\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a45c32b993856be818a70c0ffad589cbd}{yh\_util\_sign\_ssh\_certificate}}(\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[0].e,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[1].w,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[2].w,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[3].\mbox{\hyperlink{pointer_8h_aeeddce917cf130d62c370b8f216026dd}{a}},}
\DoxyCodeLine{02009\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ data,\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[4].\mbox{\hyperlink{yubihsm__pkcs11_8c_a7360b55975153b822efc5217b7734e6a}{len}},\ data\ +\ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[4].\mbox{\hyperlink{yubihsm__pkcs11_8c_a7360b55975153b822efc5217b7734e6a}{len}},}
\DoxyCodeLine{02010\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&response\_len);}
\DoxyCodeLine{02011\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{02012\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Failed\ to\ get\ certificate\ signature:\ \%s\(\backslash\)n"{}},}
\DoxyCodeLine{02013\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{lib_2error_8c_a238eedb1e27dbff2a0ab9a3932eb3f8b}{yh\_strerror}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}));}
\DoxyCodeLine{02014\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{02015\ \ \ \}}
\DoxyCodeLine{02016\ }
\DoxyCodeLine{02017\ \ \ BIO\ *bio;}
\DoxyCodeLine{02018\ \ \ BIO\ *b64;}
\DoxyCodeLine{02019\ \ \ BUF\_MEM\ *bufferPtr;}
\DoxyCodeLine{02020\ }
\DoxyCodeLine{02021\ \ \ b64\ =\ BIO\_new(BIO\_f\_base64());}
\DoxyCodeLine{02022\ \ \ bio\ =\ BIO\_new(BIO\_s\_mem());}
\DoxyCodeLine{02023\ \ \ bio\ =\ BIO\_push(b64,\ bio);}
\DoxyCodeLine{02024\ }
\DoxyCodeLine{02025\ \ \ (void)\ BIO\_set\_flags(bio,\ BIO\_FLAGS\_BASE64\_NO\_NL);}
\DoxyCodeLine{02026\ \ \ (void)\ BIO\_write(bio,\ data\ +\ 4\ +\ 256,}
\DoxyCodeLine{02027\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}[4].\mbox{\hyperlink{yubihsm__pkcs11_8c_a7360b55975153b822efc5217b7734e6a}{len}}\ +\ response\_len\ -\/\ 4\ -\/}
\DoxyCodeLine{02028\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 256);\ \textcolor{comment}{//\ TODO(adma):\ FIXME,\ unmagify}}
\DoxyCodeLine{02029\ \ \ (void)\ BIO\_flush(bio);}
\DoxyCodeLine{02030\ \ \ (void)\ BIO\_get\_mem\_ptr(bio,\ \&bufferPtr);}
\DoxyCodeLine{02031\ }
\DoxyCodeLine{02032\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *ssh\_cert\_str\ =}
\DoxyCodeLine{02033\ \ \ \ \ \textcolor{stringliteral}{"{}ssh-\/rsa-\/cert-\/v01@openssh.com\ "{}};\ \textcolor{comment}{//\ TODO(adma):\ ECDSA}}
\DoxyCodeLine{02034\ }
\DoxyCodeLine{02035\ \ \ \textcolor{keywordflow}{if}\ (fwrite(ssh\_cert\_str,\ 1,\ strlen(ssh\_cert\_str),\ ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}})\ !=}
\DoxyCodeLine{02036\ \ \ \ \ \ \ \ \ strlen(ssh\_cert\_str)\ ||}
\DoxyCodeLine{02037\ \ \ \ \ \ \ ferror(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}}))\ \{}
\DoxyCodeLine{02038\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Unable\ to\ write\ data\ to\ file\(\backslash\)n"{}});}
\DoxyCodeLine{02039\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{02040\ \ \ \}}
\DoxyCodeLine{02041\ }
\DoxyCodeLine{02042\ \ \ \textcolor{keywordflow}{if}\ (fwrite(bufferPtr-\/>data,\ 1,\ bufferPtr-\/>length,\ ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}})\ !=}
\DoxyCodeLine{02043\ \ \ \ \ \ \ \ \ bufferPtr-\/>length\ ||}
\DoxyCodeLine{02044\ \ \ \ \ \ \ ferror(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}}))\ \{}
\DoxyCodeLine{02045\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Unable\ to\ write\ data\ to\ file\(\backslash\)n"{}});}
\DoxyCodeLine{02046\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{02047\ \ \ \}}
\DoxyCodeLine{02048\ }
\DoxyCodeLine{02049\ \ \ \textcolor{keywordflow}{if}\ (fwrite(\textcolor{stringliteral}{"{}\(\backslash\)n"{}},\ 1,\ 1,\ ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}})\ !=\ 1\ ||\ ferror(ctx-\/>\mbox{\hyperlink{structyubihsm__context_a29e0cb7941d3bd7580d8e23c6e18e67d}{out}}))\ \{}
\DoxyCodeLine{02050\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Unable\ to\ write\ data\ to\ file\(\backslash\)n"{}});}
\DoxyCodeLine{02051\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{02052\ \ \ \}}
\DoxyCodeLine{02053\ }
\DoxyCodeLine{02054\ \ \ (void)\ BIO\_free\_all(bio);\ \textcolor{comment}{//\ TODO:\ fix\ this\ leak.}}
\DoxyCodeLine{02055\ }
\DoxyCodeLine{02056\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{02057\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_a03581158b5703a0ffe866d50d8a3982d_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{commands_8c_a03581158b5703a0ffe866d50d8a3982d_icgraph}
\end{center}
\end{figure}
