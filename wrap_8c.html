<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Wire Sysio: libraries/yubihsm/examples/wrap.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Wire Sysio<span id="projectnumber">&#160;Wire Sysion 1.0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('wrap_8c.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">wrap.c File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;assert.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;<a class="el" href="stdint_8h_source.html">stdint.h</a>&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;<a class="el" href="yubihsm_8h_source.html">yubihsm.h</a>&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for wrap.c:</div>
<div class="dyncontent">
<div class="center"><img src="wrap_8c__incl.png" border="0" usemap="#alibraries_2yubihsm_2examples_2wrap_8c" alt=""/></div>
<map name="alibraries_2yubihsm_2examples_2wrap_8c" id="alibraries_2yubihsm_2examples_2wrap_8c">
<area shape="rect" title=" " alt="" coords="111,5,290,46"/>
<area shape="rect" title=" " alt="" coords="5,94,74,120"/>
<area shape="poly" title=" " alt="" coords="162,49,79,89,77,84,159,44"/>
<area shape="rect" title=" " alt="" coords="63,168,123,193"/>
<area shape="poly" title=" " alt="" coords="189,48,112,156,108,153,185,45"/>
<area shape="rect" href="stdint_8h.html" title=" " alt="" coords="147,168,212,193"/>
<area shape="poly" title=" " alt="" coords="200,47,191,94,185,152,179,151,186,94,194,46"/>
<area shape="rect" title=" " alt="" coords="305,94,368,120"/>
<area shape="poly" title=" " alt="" coords="236,44,305,84,302,88,233,49"/>
<area shape="rect" title=" " alt="" coords="393,94,457,120"/>
<area shape="poly" title=" " alt="" coords="258,44,379,87,377,92,256,49"/>
<area shape="rect" href="yubihsm_8h.html" title=" " alt="" coords="200,94,282,120"/>
<area shape="poly" title=" " alt="" coords="213,45,230,79,225,81,208,48"/>
<area shape="rect" title=" " alt="" coords="102,241,166,267"/>
<area shape="poly" title=" " alt="" coords="174,195,152,230,148,227,170,192"/>
<area shape="rect" title=" " alt="" coords="190,241,257,267"/>
<area shape="poly" title=" " alt="" coords="189,192,210,226,206,229,184,195"/>
<area shape="poly" title=" " alt="" coords="217,123,133,163,131,158,215,118"/>
<area shape="poly" title=" " alt="" coords="233,122,202,157,198,154,229,118"/>
<area shape="rect" title=" " alt="" coords="236,168,310,193"/>
<area shape="poly" title=" " alt="" coords="249,119,264,152,259,154,244,121"/>
<area shape="rect" title=" " alt="" coords="335,168,403,193"/>
<area shape="poly" title=" " alt="" coords="264,118,335,157,332,162,261,123"/>
</map>
</div>
</div>
<p><a href="wrap_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a377ec96b1eb26c7b26b84bb5b0c9a928" id="r_a377ec96b1eb26c7b26b84bb5b0c9a928"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a377ec96b1eb26c7b26b84bb5b0c9a928">DEFAULT_CONNECTOR_URL</a>&#160;&#160;&#160;&quot;http://127.0.0.1:12345&quot;</td></tr>
<tr class="separator:a377ec96b1eb26c7b26b84bb5b0c9a928"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a840291bc02cba5474a4cb46a9b9566fe" id="r_a840291bc02cba5474a4cb46a9b9566fe"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a840291bc02cba5474a4cb46a9b9566fe">main</a> (void)</td></tr>
<tr class="separator:a840291bc02cba5474a4cb46a9b9566fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a870e61ded67e4529500d708a5f1af286" id="r_a870e61ded67e4529500d708a5f1af286"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a870e61ded67e4529500d708a5f1af286">key_label</a> = &quot;label&quot;</td></tr>
<tr class="separator:a870e61ded67e4529500d708a5f1af286"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd7f8a696584d8ab4b9f4d1e1970be37" id="r_abd7f8a696584d8ab4b9f4d1e1970be37"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abd7f8a696584d8ab4b9f4d1e1970be37">password</a> [] = &quot;password&quot;</td></tr>
<tr class="separator:abd7f8a696584d8ab4b9f4d1e1970be37"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a377ec96b1eb26c7b26b84bb5b0c9a928" name="a377ec96b1eb26c7b26b84bb5b0c9a928"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a377ec96b1eb26c7b26b84bb5b0c9a928">&#9670;&#160;</a></span>DEFAULT_CONNECTOR_URL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEFAULT_CONNECTOR_URL&#160;&#160;&#160;&quot;http://127.0.0.1:12345&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="wrap_8c_source.html#l00029">29</a> of file <a class="el" href="wrap_8c_source.html">wrap.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a840291bc02cba5474a4cb46a9b9566fe" name="a840291bc02cba5474a4cb46a9b9566fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a840291bc02cba5474a4cb46a9b9566fe">&#9670;&#160;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="wrap_8c_source.html#l00035">35</a> of file <a class="el" href="wrap_8c_source.html">wrap.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   35</span>               {</div>
<div class="line"><span class="lineno">   36</span>  <a class="code hl_struct" href="structyh__connector.html">yh_connector</a> *connector = NULL;</div>
<div class="line"><span class="lineno">   37</span>  <a class="code hl_struct" href="structyh__session.html">yh_session</a> *<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a> = NULL;</div>
<div class="line"><span class="lineno">   38</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a39fbc5bce29b178582419ae9d31ad252">YHR_GENERIC_ERROR</a>;</div>
<div class="line"><span class="lineno">   39</span> </div>
<div class="line"><span class="lineno">   40</span>  <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> authkey = 1;</div>
<div class="line"><span class="lineno">   41</span> </div>
<div class="line"><span class="lineno">   42</span>  <span class="keyword">const</span> <span class="keywordtype">char</span> *connector_url;</div>
<div class="line"><span class="lineno">   43</span> </div>
<div class="line"><span class="lineno">   44</span>  connector_url = getenv(<span class="stringliteral">&quot;DEFAULT_CONNECTOR_URL&quot;</span>);</div>
<div class="line"><span class="lineno">   45</span>  <span class="keywordflow">if</span> (connector_url == NULL) {</div>
<div class="line"><span class="lineno">   46</span>    connector_url = <a class="code hl_define" href="#a377ec96b1eb26c7b26b84bb5b0c9a928">DEFAULT_CONNECTOR_URL</a>;</div>
<div class="line"><span class="lineno">   47</span>  }</div>
<div class="line"><span class="lineno">   48</span> </div>
<div class="line"><span class="lineno">   49</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#a5392844a98c6220c69fe08d3dcf8f1bc">yh_init</a>();</div>
<div class="line"><span class="lineno">   50</span>  assert(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> == <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>);</div>
<div class="line"><span class="lineno">   51</span> </div>
<div class="line"><span class="lineno">   52</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#a9c700747902a722d6c1d2073277de294">yh_init_connector</a>(connector_url, &amp;connector);</div>
<div class="line"><span class="lineno">   53</span>  assert(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> == <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>);</div>
<div class="line"><span class="lineno">   54</span> </div>
<div class="line"><span class="lineno">   55</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#aa19be6ac70a2a5d1cef8d7e6902fe05f">yh_connect</a>(connector, 0);</div>
<div class="line"><span class="lineno">   56</span>  assert(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> == <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>);</div>
<div class="line"><span class="lineno">   57</span> </div>
<div class="line"><span class="lineno">   58</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#a3be331dcf8907ff3569e4dc230e1c615">yh_create_session_derived</a>(connector, authkey, password,</div>
<div class="line"><span class="lineno">   59</span>                                  <span class="keyword">sizeof</span>(password), <span class="keyword">false</span>, &amp;<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>);</div>
<div class="line"><span class="lineno">   60</span>  assert(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> == <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>);</div>
<div class="line"><span class="lineno">   61</span> </div>
<div class="line"><span class="lineno">   62</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8">yh_authenticate_session</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>);</div>
<div class="line"><span class="lineno">   63</span>  assert(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> == <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>);</div>
<div class="line"><span class="lineno">   64</span> </div>
<div class="line"><span class="lineno">   65</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> session_id;</div>
<div class="line"><span class="lineno">   66</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#aeabf472faf1ba8d963b39866e04df6b0">yh_get_session_id</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, &amp;session_id);</div>
<div class="line"><span class="lineno">   67</span>  assert(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> == <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>);</div>
<div class="line"><span class="lineno">   68</span> </div>
<div class="line"><span class="lineno">   69</span>  <a class="code hl_function" href="namespace_log.html#a83926634a3916d0927abca4aca58a60a">printf</a>(<span class="stringliteral">&quot;Successfully established session %02d\n&quot;</span>, session_id);</div>
<div class="line"><span class="lineno">   70</span> </div>
<div class="line"><span class="lineno">   71</span>  <a class="code hl_struct" href="structyh__capabilities.html">yh_capabilities</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a> = {{0}};</div>
<div class="line"><span class="lineno">   72</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> =</div>
<div class="line"><span class="lineno">   73</span>    <a class="code hl_function" href="yubihsm_8c.html#aab440e1cb671d9ba7a2e7d1243960e42">yh_string_to_capabilities</a>(<span class="stringliteral">&quot;export-wrapped:import-wrapped&quot;</span>, &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>);</div>
<div class="line"><span class="lineno">   74</span>  assert(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> == <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>);</div>
<div class="line"><span class="lineno">   75</span> </div>
<div class="line"><span class="lineno">   76</span>  <a class="code hl_struct" href="structyh__capabilities.html">yh_capabilities</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#afa62e10709d52e5162a732e81369a7ec">delegated_capabilities</a> = {{0}};</div>
<div class="line"><span class="lineno">   77</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#aab440e1cb671d9ba7a2e7d1243960e42">yh_string_to_capabilities</a>(<span class="stringliteral">&quot;sign-ecdsa:exportable-under-wrap&quot;</span>,</div>
<div class="line"><span class="lineno">   78</span>                                  &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#afa62e10709d52e5162a732e81369a7ec">delegated_capabilities</a>); <span class="comment">// delegated</span></div>
<div class="line"><span class="lineno">   79</span>                                                            <span class="comment">// capabilities has</span></div>
<div class="line"><span class="lineno">   80</span>                                                            <span class="comment">// to match the</span></div>
<div class="line"><span class="lineno">   81</span>                                                            <span class="comment">// capabilities of</span></div>
<div class="line"><span class="lineno">   82</span>                                                            <span class="comment">// the object we</span></div>
<div class="line"><span class="lineno">   83</span>                                                            <span class="comment">// want to export</span></div>
<div class="line"><span class="lineno">   84</span>  assert(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> == <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>);</div>
<div class="line"><span class="lineno">   85</span> </div>
<div class="line"><span class="lineno">   86</span>  <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> domain_five = 0;</div>
<div class="line"><span class="lineno">   87</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#a96a4c751a281515d5610adb8fd779438">yh_string_to_domains</a>(<span class="stringliteral">&quot;5&quot;</span>, &amp;domain_five);</div>
<div class="line"><span class="lineno">   88</span>  assert(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> == <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>);</div>
<div class="line"><span class="lineno">   89</span> </div>
<div class="line"><span class="lineno">   90</span>  <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> wrapping_key_id = 0; <span class="comment">// ID 0 lets the device generate an ID</span></div>
<div class="line"><span class="lineno">   91</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> =</div>
<div class="line"><span class="lineno">   92</span>    <a class="code hl_function" href="yubihsm_8c.html#a1f749a696792e7911844629e056d9c15">yh_util_generate_wrap_key</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, &amp;wrapping_key_id, <a class="code hl_variable" href="#a870e61ded67e4529500d708a5f1af286">key_label</a>, domain_five,</div>
<div class="line"><span class="lineno">   93</span>                              &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>, <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa927e2246e5657f946b4da4b71092b022">YH_ALGO_AES256_CCM_WRAP</a>,</div>
<div class="line"><span class="lineno">   94</span>                              &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#afa62e10709d52e5162a732e81369a7ec">delegated_capabilities</a>);</div>
<div class="line"><span class="lineno">   95</span>  assert(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> == <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>);</div>
<div class="line"><span class="lineno">   96</span> </div>
<div class="line"><span class="lineno">   97</span>  <a class="code hl_function" href="namespace_log.html#a83926634a3916d0927abca4aca58a60a">printf</a>(<span class="stringliteral">&quot;Generated wrapping key with ID %04x\n&quot;</span>, wrapping_key_id);</div>
<div class="line"><span class="lineno">   98</span> </div>
<div class="line"><span class="lineno">   99</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105">memset</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>.<a class="code hl_variable" href="structyh__capabilities.html#a5398bad7e61385aa127265ba0a053079">capabilities</a>, 0, <a class="code hl_define" href="yubihsm_8h.html#ad3c904849d17cae0a6f426e8007731d7">YH_CAPABILITIES_LEN</a>);</div>
<div class="line"><span class="lineno">  100</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#aab440e1cb671d9ba7a2e7d1243960e42">yh_string_to_capabilities</a>(<span class="stringliteral">&quot;sign-ecdsa:exportable-under-wrap&quot;</span>,</div>
<div class="line"><span class="lineno">  101</span>                                  &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>);</div>
<div class="line"><span class="lineno">  102</span>  assert(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> == <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>);</div>
<div class="line"><span class="lineno">  103</span> </div>
<div class="line"><span class="lineno">  104</span>  <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> key_id_before = 0; <span class="comment">// ID 0 lets the device generate an ID</span></div>
<div class="line"><span class="lineno">  105</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#a2db9bbd57a908c5c454fc6254f57dcff">yh_util_generate_ec_key</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, &amp;key_id_before, <a class="code hl_variable" href="#a870e61ded67e4529500d708a5f1af286">key_label</a>, domain_five,</div>
<div class="line"><span class="lineno">  106</span>                                &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>, <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caae4b191baf5c65f9234120080264d129b">YH_ALGO_EC_P256</a>);</div>
<div class="line"><span class="lineno">  107</span>  assert(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> == <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>);</div>
<div class="line"><span class="lineno">  108</span> </div>
<div class="line"><span class="lineno">  109</span>  <a class="code hl_function" href="namespace_log.html#a83926634a3916d0927abca4aca58a60a">printf</a>(<span class="stringliteral">&quot;Generated ec key with ID %04x\n&quot;</span>, key_id_before);</div>
<div class="line"><span class="lineno">  110</span> </div>
<div class="line"><span class="lineno">  111</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> public_key_before[512];</div>
<div class="line"><span class="lineno">  112</span>  <span class="keywordtype">size_t</span> public_key_before_len = <span class="keyword">sizeof</span>(public_key_before);</div>
<div class="line"><span class="lineno">  113</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#aa7b8b42156c4bdaf41d8b9758a2fd73f">yh_util_get_public_key</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, key_id_before, public_key_before,</div>
<div class="line"><span class="lineno">  114</span>                               &amp;public_key_before_len, NULL);</div>
<div class="line"><span class="lineno">  115</span>  assert(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> == <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>);</div>
<div class="line"><span class="lineno">  116</span> </div>
<div class="line"><span class="lineno">  117</span>  <a class="code hl_function" href="namespace_log.html#a83926634a3916d0927abca4aca58a60a">printf</a>(<span class="stringliteral">&quot;Public key before (%zu bytes) is:&quot;</span>, public_key_before_len);</div>
<div class="line"><span class="lineno">  118</span>  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; public_key_before_len; i++) {</div>
<div class="line"><span class="lineno">  119</span>    <a class="code hl_function" href="namespace_log.html#a83926634a3916d0927abca4aca58a60a">printf</a>(<span class="stringliteral">&quot; %02x&quot;</span>, public_key_before[i]);</div>
<div class="line"><span class="lineno">  120</span>  }</div>
<div class="line"><span class="lineno">  121</span>  <a class="code hl_function" href="namespace_log.html#a83926634a3916d0927abca4aca58a60a">printf</a>(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><span class="lineno">  122</span> </div>
<div class="line"><span class="lineno">  123</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> wrapped_object[512];</div>
<div class="line"><span class="lineno">  124</span>  <span class="keywordtype">size_t</span> wrapped_object_len = <span class="keyword">sizeof</span>(wrapped_object);</div>
<div class="line"><span class="lineno">  125</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583">yh_object_type</a> object_type_after;</div>
<div class="line"><span class="lineno">  126</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> =</div>
<div class="line"><span class="lineno">  127</span>    <a class="code hl_function" href="yubihsm_8c.html#aa3f473e6dbb9188ad0269b40921c4f5f">yh_util_export_wrapped</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, wrapping_key_id, <a class="code hl_enumvalue" href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583ab71424e16384319d6e6a12f9a3d8ceae">YH_ASYMMETRIC_KEY</a>,</div>
<div class="line"><span class="lineno">  128</span>                           key_id_before, wrapped_object, &amp;wrapped_object_len);</div>
<div class="line"><span class="lineno">  129</span>  assert(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> == <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>);</div>
<div class="line"><span class="lineno">  130</span> </div>
<div class="line"><span class="lineno">  131</span>  <a class="code hl_function" href="namespace_log.html#a83926634a3916d0927abca4aca58a60a">printf</a>(<span class="stringliteral">&quot;Wrapped object (%zu bytes) is:&quot;</span>, wrapped_object_len);</div>
<div class="line"><span class="lineno">  132</span>  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; wrapped_object_len; i++) {</div>
<div class="line"><span class="lineno">  133</span>    <a class="code hl_function" href="namespace_log.html#a83926634a3916d0927abca4aca58a60a">printf</a>(<span class="stringliteral">&quot; %02x&quot;</span>, wrapped_object[i]);</div>
<div class="line"><span class="lineno">  134</span>  }</div>
<div class="line"><span class="lineno">  135</span>  <a class="code hl_function" href="namespace_log.html#a83926634a3916d0927abca4aca58a60a">printf</a>(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><span class="lineno">  136</span> </div>
<div class="line"><span class="lineno">  137</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#ae736702f9463878db4adfd45b6a597f9">yh_util_delete_object</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, key_id_before, <a class="code hl_enumvalue" href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583ab71424e16384319d6e6a12f9a3d8ceae">YH_ASYMMETRIC_KEY</a>);</div>
<div class="line"><span class="lineno">  138</span>  assert(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> == <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>);</div>
<div class="line"><span class="lineno">  139</span> </div>
<div class="line"><span class="lineno">  140</span>  <a class="code hl_function" href="namespace_log.html#a83926634a3916d0927abca4aca58a60a">printf</a>(<span class="stringliteral">&quot;Successfully deleted ec key with ID %04x\n&quot;</span>, key_id_before);</div>
<div class="line"><span class="lineno">  141</span> </div>
<div class="line"><span class="lineno">  142</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> public_key_after[512];</div>
<div class="line"><span class="lineno">  143</span>  <span class="keywordtype">size_t</span> public_key_after_len = <span class="keyword">sizeof</span>(public_key_after);</div>
<div class="line"><span class="lineno">  144</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#aa7b8b42156c4bdaf41d8b9758a2fd73f">yh_util_get_public_key</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, key_id_before, public_key_after,</div>
<div class="line"><span class="lineno">  145</span>                               &amp;public_key_after_len, NULL);</div>
<div class="line"><span class="lineno">  146</span>  assert(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> == <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a9bc4026d75a26dcaa51ba3310d6b8393">YHR_DEVICE_OBJECT_NOT_FOUND</a>);</div>
<div class="line"><span class="lineno">  147</span> </div>
<div class="line"><span class="lineno">  148</span>  <a class="code hl_function" href="namespace_log.html#a83926634a3916d0927abca4aca58a60a">printf</a>(<span class="stringliteral">&quot;Unable to get public key for ec key with ID %04x\n&quot;</span>, key_id_before);</div>
<div class="line"><span class="lineno">  149</span> </div>
<div class="line"><span class="lineno">  150</span>  <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> key_id_after;</div>
<div class="line"><span class="lineno">  151</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#ae5bf13f9558bb0340468b722accf94d3">yh_util_import_wrapped</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, wrapping_key_id, wrapped_object,</div>
<div class="line"><span class="lineno">  152</span>                               wrapped_object_len, &amp;object_type_after,</div>
<div class="line"><span class="lineno">  153</span>                               &amp;key_id_after);</div>
<div class="line"><span class="lineno">  154</span>  assert(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> == <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>);</div>
<div class="line"><span class="lineno">  155</span> </div>
<div class="line"><span class="lineno">  156</span>  <a class="code hl_function" href="namespace_log.html#a83926634a3916d0927abca4aca58a60a">printf</a>(<span class="stringliteral">&quot;Successfully imported wrapped object with ID %04x\n&quot;</span>, key_id_after);</div>
<div class="line"><span class="lineno">  157</span> </div>
<div class="line"><span class="lineno">  158</span>  <span class="keywordflow">if</span> (object_type_after != <a class="code hl_enumvalue" href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583ab71424e16384319d6e6a12f9a3d8ceae">YH_ASYMMETRIC_KEY</a>) {</div>
<div class="line"><span class="lineno">  159</span>    <a class="code hl_function" href="namespace_log.html#a83926634a3916d0927abca4aca58a60a">printf</a>(<span class="stringliteral">&quot;Unexpected odbject type\n&quot;</span>);</div>
<div class="line"><span class="lineno">  160</span>    exit(EXIT_FAILURE);</div>
<div class="line"><span class="lineno">  161</span>  }</div>
<div class="line"><span class="lineno">  162</span> </div>
<div class="line"><span class="lineno">  163</span>  <span class="keywordflow">if</span> (key_id_before != key_id_after) {</div>
<div class="line"><span class="lineno">  164</span>    <a class="code hl_function" href="namespace_log.html#a83926634a3916d0927abca4aca58a60a">printf</a>(<span class="stringliteral">&quot;ID %04x and %04x do not match\n&quot;</span>, key_id_before, key_id_after);</div>
<div class="line"><span class="lineno">  165</span>    exit(EXIT_FAILURE);</div>
<div class="line"><span class="lineno">  166</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  167</span>    <a class="code hl_function" href="namespace_log.html#a83926634a3916d0927abca4aca58a60a">printf</a>(<span class="stringliteral">&quot;ID %04x and %04x match\n&quot;</span>, key_id_before, key_id_after);</div>
<div class="line"><span class="lineno">  168</span>  }</div>
<div class="line"><span class="lineno">  169</span> </div>
<div class="line"><span class="lineno">  170</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#aa7b8b42156c4bdaf41d8b9758a2fd73f">yh_util_get_public_key</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, key_id_after, public_key_after,</div>
<div class="line"><span class="lineno">  171</span>                               &amp;public_key_after_len, NULL);</div>
<div class="line"><span class="lineno">  172</span>  assert(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> == <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>);</div>
<div class="line"><span class="lineno">  173</span> </div>
<div class="line"><span class="lineno">  174</span>  <a class="code hl_function" href="namespace_log.html#a83926634a3916d0927abca4aca58a60a">printf</a>(<span class="stringliteral">&quot;Public key after (%zu bytes) is:&quot;</span>, public_key_after_len);</div>
<div class="line"><span class="lineno">  175</span>  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; public_key_after_len; i++) {</div>
<div class="line"><span class="lineno">  176</span>    <a class="code hl_function" href="namespace_log.html#a83926634a3916d0927abca4aca58a60a">printf</a>(<span class="stringliteral">&quot; %02x&quot;</span>, public_key_after[i]);</div>
<div class="line"><span class="lineno">  177</span>  }</div>
<div class="line"><span class="lineno">  178</span>  <a class="code hl_function" href="namespace_log.html#a83926634a3916d0927abca4aca58a60a">printf</a>(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><span class="lineno">  179</span> </div>
<div class="line"><span class="lineno">  180</span>  <span class="keywordflow">if</span> (public_key_before_len != public_key_after_len ||</div>
<div class="line"><span class="lineno">  181</span>      memcmp(public_key_before, public_key_after, public_key_before_len) != 0) {</div>
<div class="line"><span class="lineno">  182</span>    <a class="code hl_function" href="namespace_log.html#a83926634a3916d0927abca4aca58a60a">printf</a>(<span class="stringliteral">&quot;Public key before and after do not match\n&quot;</span>);</div>
<div class="line"><span class="lineno">  183</span>    exit(EXIT_FAILURE);</div>
<div class="line"><span class="lineno">  184</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  185</span>    <a class="code hl_function" href="namespace_log.html#a83926634a3916d0927abca4aca58a60a">printf</a>(<span class="stringliteral">&quot;Public key before and after match\n&quot;</span>);</div>
<div class="line"><span class="lineno">  186</span>  }</div>
<div class="line"><span class="lineno">  187</span> </div>
<div class="line"><span class="lineno">  188</span>  <a class="code hl_struct" href="structyh__object__descriptor.html">yh_object_descriptor</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a85d991d90970121ba1480cd98d93aab9">object</a>;</div>
<div class="line"><span class="lineno">  189</span> </div>
<div class="line"><span class="lineno">  190</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> =</div>
<div class="line"><span class="lineno">  191</span>    <a class="code hl_function" href="yubihsm_8c.html#a7b5f1f0c1cbca11fbe21e7e4e6b29a1b">yh_util_get_object_info</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, key_id_after, <a class="code hl_enumvalue" href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583ab71424e16384319d6e6a12f9a3d8ceae">YH_ASYMMETRIC_KEY</a>, &amp;<span class="keywordtype">object</span>);</div>
<div class="line"><span class="lineno">  192</span>  assert(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> == <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>);</div>
<div class="line"><span class="lineno">  193</span> </div>
<div class="line"><span class="lineno">  194</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#a61ab8dbab67b1cceb49cd306f8c3f4b1">yh_util_close_session</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>);</div>
<div class="line"><span class="lineno">  195</span>  assert(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> == <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>);</div>
<div class="line"><span class="lineno">  196</span> </div>
<div class="line"><span class="lineno">  197</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#a1a35f8ae5a739848408633a514e41b2d">yh_destroy_session</a>(&amp;<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>);</div>
<div class="line"><span class="lineno">  198</span>  assert(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> == <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>);</div>
<div class="line"><span class="lineno">  199</span> </div>
<div class="line"><span class="lineno">  200</span>  <a class="code hl_function" href="yubihsm_8c.html#ab12d5a42d2219741bd3630b99ed1c7d2">yh_disconnect</a>(connector);</div>
<div class="line"><span class="lineno">  201</span>  assert(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> == <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>);</div>
<div class="line"><span class="lineno">  202</span> </div>
<div class="line"><span class="lineno">  203</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#a36e3d9a07c6689e14a9339ca1ebb7259">yh_exit</a>();</div>
<div class="line"><span class="lineno">  204</span>  assert(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> == <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>);</div>
<div class="line"><span class="lineno">  205</span> </div>
<div class="line"><span class="lineno">  206</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  207</span>}</div>
<div class="ttc" id="aecdh__derive__test_8c_html_a0a2c7706d971796d7dc84fee36d6c84f"><div class="ttname"><a href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a></div><div class="ttdeci">CK_SESSION_HANDLE session</div><div class="ttdef"><b>Definition</b> <a href="ecdh__derive__test_8c_source.html#l00045">ecdh_derive_test.c:45</a></div></div>
<div class="ttc" id="anamespace_log_html_a83926634a3916d0927abca4aca58a60a"><div class="ttname"><a href="namespace_log.html#a83926634a3916d0927abca4aca58a60a">Log::printf</a></div><div class="ttdeci">LOGGING_API void printf(Category category, const char *format,...)</div><div class="ttdef"><b>Definition</b> <a href="_logging_8cpp_source.html#l00030">Logging.cpp:30</a></div></div>
<div class="ttc" id="astdint_8h_html_a273cf69d639a59973b6019625df33e30"><div class="ttname"><a href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a></div><div class="ttdeci">unsigned short uint16_t</div><div class="ttdef"><b>Definition</b> <a href="stdint_8h_source.html#l00125">stdint.h:125</a></div></div>
<div class="ttc" id="astdint_8h_html_aba7bc1797add20fe3efdf37ced1182c5"><div class="ttname"><a href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a></div><div class="ttdeci">unsigned char uint8_t</div><div class="ttdef"><b>Definition</b> <a href="stdint_8h_source.html#l00124">stdint.h:124</a></div></div>
<div class="ttc" id="astructyh__capabilities_html"><div class="ttname"><a href="structyh__capabilities.html">yh_capabilities</a></div><div class="ttdoc">Capabilities representation.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00162">yubihsm.h:162</a></div></div>
<div class="ttc" id="astructyh__capabilities_html_a5398bad7e61385aa127265ba0a053079"><div class="ttname"><a href="structyh__capabilities.html#a5398bad7e61385aa127265ba0a053079">yh_capabilities::capabilities</a></div><div class="ttdeci">uint8_t capabilities[YH_CAPABILITIES_LEN]</div><div class="ttdoc">Capabilities is represented as an 8 byte uint8_t array.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00164">yubihsm.h:164</a></div></div>
<div class="ttc" id="astructyh__connector_html"><div class="ttname"><a href="structyh__connector.html">yh_connector</a></div><div class="ttdef"><b>Definition</b> <a href="lib_2internal_8h_source.html#l00037">internal.h:37</a></div></div>
<div class="ttc" id="astructyh__object__descriptor_html"><div class="ttname"><a href="structyh__object__descriptor.html">yh_object_descriptor</a></div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00540">yubihsm.h:540</a></div></div>
<div class="ttc" id="astructyh__session_html"><div class="ttname"><a href="structyh__session.html">yh_session</a></div><div class="ttdef"><b>Definition</b> <a href="lib_2internal_8h_source.html#l00025">internal.h:25</a></div></div>
<div class="ttc" id="awrap_8c_html_a377ec96b1eb26c7b26b84bb5b0c9a928"><div class="ttname"><a href="#a377ec96b1eb26c7b26b84bb5b0c9a928">DEFAULT_CONNECTOR_URL</a></div><div class="ttdeci">#define DEFAULT_CONNECTOR_URL</div><div class="ttdef"><b>Definition</b> <a href="wrap_8c_source.html#l00029">wrap.c:29</a></div></div>
<div class="ttc" id="awrap_8c_html_a870e61ded67e4529500d708a5f1af286"><div class="ttname"><a href="#a870e61ded67e4529500d708a5f1af286">key_label</a></div><div class="ttdeci">const char * key_label</div><div class="ttdef"><b>Definition</b> <a href="wrap_8c_source.html#l00032">wrap.c:32</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_a1a35f8ae5a739848408633a514e41b2d"><div class="ttname"><a href="yubihsm_8c.html#a1a35f8ae5a739848408633a514e41b2d">yh_destroy_session</a></div><div class="ttdeci">yh_rc yh_destroy_session(yh_session **session)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l00890">yubihsm.c:890</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_a1f749a696792e7911844629e056d9c15"><div class="ttname"><a href="yubihsm_8c.html#a1f749a696792e7911844629e056d9c15">yh_util_generate_wrap_key</a></div><div class="ttdeci">yh_rc yh_util_generate_wrap_key(yh_session *session, uint16_t *key_id, const char *label, uint16_t domains, const yh_capabilities *capabilities, yh_algorithm algorithm, const yh_capabilities *delegated_capabilities)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l02458">yubihsm.c:2458</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_a2db9bbd57a908c5c454fc6254f57dcff"><div class="ttname"><a href="yubihsm_8c.html#a2db9bbd57a908c5c454fc6254f57dcff">yh_util_generate_ec_key</a></div><div class="ttdeci">yh_rc yh_util_generate_ec_key(yh_session *session, uint16_t *key_id, const char *label, uint16_t domains, const yh_capabilities *capabilities, yh_algorithm algorithm)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l01913">yubihsm.c:1913</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_a36e3d9a07c6689e14a9339ca1ebb7259"><div class="ttname"><a href="yubihsm_8c.html#a36e3d9a07c6689e14a9339ca1ebb7259">yh_exit</a></div><div class="ttdeci">yh_rc yh_exit(void)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l03910">yubihsm.c:3910</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_a3be331dcf8907ff3569e4dc230e1c615"><div class="ttname"><a href="yubihsm_8c.html#a3be331dcf8907ff3569e4dc230e1c615">yh_create_session_derived</a></div><div class="ttdeci">yh_rc yh_create_session_derived(yh_connector *connector, uint16_t authkey_id, const uint8_t *password, size_t password_len, bool recreate, yh_session **session)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l00593">yubihsm.c:593</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_a5392844a98c6220c69fe08d3dcf8f1bc"><div class="ttname"><a href="yubihsm_8c.html#a5392844a98c6220c69fe08d3dcf8f1bc">yh_init</a></div><div class="ttdeci">yh_rc yh_init(void)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l03857">yubihsm.c:3857</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_a61ab8dbab67b1cceb49cd306f8c3f4b1"><div class="ttname"><a href="yubihsm_8c.html#a61ab8dbab67b1cceb49cd306f8c3f4b1">yh_util_close_session</a></div><div class="ttdeci">yh_rc yh_util_close_session(yh_session *session)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l01257">yubihsm.c:1257</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_a77870209747d5ccd90f9da3aae2bdfa8"><div class="ttname"><a href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8">yh_authenticate_session</a></div><div class="ttdeci">yh_rc yh_authenticate_session(yh_session *session)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l02927">yubihsm.c:2927</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_a7b5f1f0c1cbca11fbe21e7e4e6b29a1b"><div class="ttname"><a href="yubihsm_8c.html#a7b5f1f0c1cbca11fbe21e7e4e6b29a1b">yh_util_get_object_info</a></div><div class="ttdeci">yh_rc yh_util_get_object_info(yh_session *session, uint16_t id, yh_object_type type, yh_object_descriptor *object)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l01128">yubihsm.c:1128</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_a96a4c751a281515d5610adb8fd779438"><div class="ttname"><a href="yubihsm_8c.html#a96a4c751a281515d5610adb8fd779438">yh_string_to_domains</a></div><div class="ttdeci">yh_rc yh_string_to_domains(const char *domains, uint16_t *result)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l04535">yubihsm.c:4535</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_a9c700747902a722d6c1d2073277de294"><div class="ttname"><a href="yubihsm_8c.html#a9c700747902a722d6c1d2073277de294">yh_init_connector</a></div><div class="ttdeci">yh_rc yh_init_connector(const char *url, yh_connector **connector)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l04024">yubihsm.c:4024</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_aa19be6ac70a2a5d1cef8d7e6902fe05f"><div class="ttname"><a href="yubihsm_8c.html#aa19be6ac70a2a5d1cef8d7e6902fe05f">yh_connect</a></div><div class="ttdeci">yh_rc yh_connect(yh_connector *connector, int timeout)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l04079">yubihsm.c:4079</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_aa3f473e6dbb9188ad0269b40921c4f5f"><div class="ttname"><a href="yubihsm_8c.html#aa3f473e6dbb9188ad0269b40921c4f5f">yh_util_export_wrapped</a></div><div class="ttdeci">yh_rc yh_util_export_wrapped(yh_session *session, uint16_t wrapping_key_id, yh_object_type target_type, uint16_t target_id, uint8_t *out, size_t *out_len)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l02265">yubihsm.c:2265</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_aa7b8b42156c4bdaf41d8b9758a2fd73f"><div class="ttname"><a href="yubihsm_8c.html#aa7b8b42156c4bdaf41d8b9758a2fd73f">yh_util_get_public_key</a></div><div class="ttdeci">yh_rc yh_util_get_public_key(yh_session *session, uint16_t id, uint8_t *data, size_t *data_len, yh_algorithm *algorithm)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l01216">yubihsm.c:1216</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_aab440e1cb671d9ba7a2e7d1243960e42"><div class="ttname"><a href="yubihsm_8c.html#aab440e1cb671d9ba7a2e7d1243960e42">yh_string_to_capabilities</a></div><div class="ttdeci">yh_rc yh_string_to_capabilities(const char *capability, yh_capabilities *result)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l04115">yubihsm.c:4115</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_ab12d5a42d2219741bd3630b99ed1c7d2"><div class="ttname"><a href="yubihsm_8c.html#ab12d5a42d2219741bd3630b99ed1c7d2">yh_disconnect</a></div><div class="ttdeci">yh_rc yh_disconnect(yh_connector *connector)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l04097">yubihsm.c:4097</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_ae5bf13f9558bb0340468b722accf94d3"><div class="ttname"><a href="yubihsm_8c.html#ae5bf13f9558bb0340468b722accf94d3">yh_util_import_wrapped</a></div><div class="ttdeci">yh_rc yh_util_import_wrapped(yh_session *session, uint16_t wrapping_key_id, const uint8_t *in, size_t in_len, yh_object_type *target_type, uint16_t *target_id)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l02309">yubihsm.c:2309</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_ae736702f9463878db4adfd45b6a597f9"><div class="ttname"><a href="yubihsm_8c.html#ae736702f9463878db4adfd45b6a597f9">yh_util_delete_object</a></div><div class="ttdeci">yh_rc yh_util_delete_object(yh_session *session, uint16_t id, yh_object_type type)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l02222">yubihsm.c:2222</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_aeabf472faf1ba8d963b39866e04df6b0"><div class="ttname"><a href="yubihsm_8c.html#aeabf472faf1ba8d963b39866e04df6b0">yh_get_session_id</a></div><div class="ttdeci">yh_rc yh_get_session_id(yh_session *session, uint8_t *sid)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l02915">yubihsm.c:2915</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a2fe39512cb4df34b270a67dbb8e13583"><div class="ttname"><a href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583">yh_object_type</a></div><div class="ttdeci">yh_object_type</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00359">yubihsm.h:359</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a2fe39512cb4df34b270a67dbb8e13583ab71424e16384319d6e6a12f9a3d8ceae"><div class="ttname"><a href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583ab71424e16384319d6e6a12f9a3d8ceae">YH_ASYMMETRIC_KEY</a></div><div class="ttdeci">@ YH_ASYMMETRIC_KEY</div><div class="ttdoc">Asymmetric Key is the private key of an asymmetric key-pair.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00366">yubihsm.h:366</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caa927e2246e5657f946b4da4b71092b022"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa927e2246e5657f946b4da4b71092b022">YH_ALGO_AES256_CCM_WRAP</a></div><div class="ttdeci">@ YH_ALGO_AES256_CCM_WRAP</div><div class="ttdoc">aes256-ccm-wrap</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00474">yubihsm.h:474</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caae4b191baf5c65f9234120080264d129b"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caae4b191baf5c65f9234120080264d129b">YH_ALGO_EC_P256</a></div><div class="ttdeci">@ YH_ALGO_EC_P256</div><div class="ttdoc">ecp256</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00414">yubihsm.h:414</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_ad3c904849d17cae0a6f426e8007731d7"><div class="ttname"><a href="yubihsm_8h.html#ad3c904849d17cae0a6f426e8007731d7">YH_CAPABILITIES_LEN</a></div><div class="ttdeci">#define YH_CAPABILITIES_LEN</div><div class="ttdoc">Length of capabilities array.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00119">yubihsm.h:119</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_ae4f602d2343d01b1727dfd633169d366"><div class="ttname"><a href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a></div><div class="ttdeci">yh_rc</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00170">yubihsm.h:170</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_ae4f602d2343d01b1727dfd633169d366a39fbc5bce29b178582419ae9d31ad252"><div class="ttname"><a href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a39fbc5bce29b178582419ae9d31ad252">YHR_GENERIC_ERROR</a></div><div class="ttdeci">@ YHR_GENERIC_ERROR</div><div class="ttdoc">Return value when encountering an unknown error.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00228">yubihsm.h:228</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815"><div class="ttname"><a href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a></div><div class="ttdeci">@ YHR_SUCCESS</div><div class="ttdoc">Returned value when function was successful.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00172">yubihsm.h:172</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_ae4f602d2343d01b1727dfd633169d366a9bc4026d75a26dcaa51ba3310d6b8393"><div class="ttname"><a href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a9bc4026d75a26dcaa51ba3310d6b8393">YHR_DEVICE_OBJECT_NOT_FOUND</a></div><div class="ttdeci">@ YHR_DEVICE_OBJECT_NOT_FOUND</div><div class="ttdoc">Return value when the object not found on the device.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00218">yubihsm.h:218</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a08393519edfd7c59fb01fb8db97514b5"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a></div><div class="ttdeci">yh_capabilities capabilities</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l01305">yubihsm_pkcs11.c:1305</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a85d991d90970121ba1480cd98d93aab9"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a85d991d90970121ba1480cd98d93aab9">object</a></div><div class="ttdeci">yh_object_descriptor object</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l01544">yubihsm_pkcs11.c:1544</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a9c8d6a4a7a87f74f070e816dca1a547b"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a></div><div class="ttdeci">yh_rc yrc</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l00606">yubihsm_pkcs11.c:606</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_adc4bd59a60361844aa0e852efa210105"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105">memset</a></div><div class="ttdeci">memset(pInfo-&gt;slotDescription, ' ', 64)</div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_afa62e10709d52e5162a732e81369a7ec"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#afa62e10709d52e5162a732e81369a7ec">delegated_capabilities</a></div><div class="ttdeci">yh_capabilities delegated_capabilities</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l01306">yubihsm_pkcs11.c:1306</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="wrap_8c_a840291bc02cba5474a4cb46a9b9566fe_cgraph.png" border="0" usemap="#awrap_8c_a840291bc02cba5474a4cb46a9b9566fe_cgraph" alt=""/></div>
<map name="awrap_8c_a840291bc02cba5474a4cb46a9b9566fe_cgraph" id="awrap_8c_a840291bc02cba5474a4cb46a9b9566fe_cgraph">
<area shape="rect" title=" " alt="" coords="5,774,55,800"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="788,68,856,93"/>
<area shape="poly" title=" " alt="" coords="29,773,35,640,48,431,69,229,84,157,92,132,101,117,137,85,177,59,220,39,265,24,312,13,360,6,457,4,552,12,640,27,715,45,774,62,773,67,714,50,639,32,552,17,457,9,360,12,313,18,266,29,222,44,179,64,140,89,105,121,97,135,89,158,75,230,53,431,40,640,34,774"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="557,245,723,271"/>
<area shape="poly" title=" " alt="" coords="29,774,36,660,50,486,72,321,85,262,93,242,101,231,129,209,159,193,192,180,225,172,295,166,366,170,435,183,498,200,598,236,596,241,497,205,434,188,365,175,295,171,226,177,193,186,162,198,132,214,105,234,97,245,90,264,77,322,56,487,42,661,35,774"/>
<area shape="rect" href="yubihsm_8c.html#aa19be6ac70a2a5d1cef8d7e6902fe05f" title=" " alt="" coords="376,953,464,979"/>
<area shape="poly" title=" " alt="" coords="36,799,43,828,55,863,75,900,104,929,134,946,166,959,235,973,302,976,360,972,360,978,302,981,234,978,165,964,132,951,101,933,71,903,51,866,38,829,31,801"/>
<area shape="rect" href="yubihsm_8c.html#a3be331dcf8907ff3569e4dc230e1c615" title=" " alt="" coords="330,752,509,777"/>
<area shape="poly" title=" " alt="" coords="55,786,154,788,282,784,336,778,337,783,282,790,154,794,55,791"/>
<area shape="rect" href="yubihsm_8c.html#a1a35f8ae5a739848408633a514e41b2d" title=" " alt="" coords="571,1005,709,1031"/>
<area shape="poly" title=" " alt="" coords="34,800,37,838,47,888,68,940,84,963,104,982,138,999,185,1011,242,1019,306,1023,439,1025,556,1021,556,1026,439,1030,305,1029,241,1024,184,1016,136,1004,101,987,80,967,64,943,42,890,32,839,29,801"/>
<area shape="rect" href="yubihsm_8c.html#ab12d5a42d2219741bd3630b99ed1c7d2" title=" " alt="" coords="367,1054,472,1080"/>
<area shape="poly" title=" " alt="" coords="33,800,33,846,41,910,50,944,63,977,81,1008,104,1033,132,1052,162,1065,194,1075,227,1080,293,1083,352,1077,352,1083,293,1088,227,1086,193,1080,160,1070,129,1056,101,1037,76,1011,58,980,45,946,36,911,28,847,28,801"/>
<area shape="rect" href="yubihsm_8c.html#a36e3d9a07c6689e14a9339ca1ebb7259" title=" " alt="" coords="161,1105,224,1131"/>
<area shape="poly" title=" " alt="" coords="35,800,58,946,79,1029,91,1062,105,1084,124,1099,147,1108,145,1113,121,1103,101,1087,86,1064,74,1031,53,947,30,801"/>
<area shape="rect" href="yubihsm_8c.html#aeabf472faf1ba8d963b39866e04df6b0" title=" " alt="" coords="575,853,705,879"/>
<area shape="poly" title=" " alt="" coords="55,788,103,794,560,853,560,858,102,799,55,793"/>
<area shape="rect" href="yubihsm_8c.html#a5392844a98c6220c69fe08d3dcf8f1bc" title=" " alt="" coords="163,1154,222,1180"/>
<area shape="poly" title=" " alt="" coords="35,800,41,871,53,974,74,1075,88,1115,105,1141,124,1155,148,1162,147,1167,122,1160,101,1145,84,1117,69,1077,48,975,35,871,30,801"/>
<area shape="rect" href="yubihsm_8c.html#a9c700747902a722d6c1d2073277de294" title=" " alt="" coords="131,1204,254,1229"/>
<area shape="poly" title=" " alt="" coords="34,800,39,880,50,997,60,1058,72,1114,87,1160,105,1191,118,1201,115,1206,101,1194,82,1162,66,1116,54,1059,45,998,34,880,29,801"/>
<area shape="rect" href="yubihsm_8c.html#aab440e1cb671d9ba7a2e7d1243960e42" title=" " alt="" coords="558,93,722,119"/>
<area shape="poly" title=" " alt="" coords="29,774,36,652,50,462,71,280,85,216,92,194,101,180,150,140,206,111,267,92,330,81,392,77,453,77,557,87,557,93,453,82,393,82,330,86,268,97,208,116,153,144,105,183,97,196,90,217,77,281,55,463,41,652,35,774"/>
<area shape="rect" href="yubihsm_8c.html#a96a4c751a281515d5610adb8fd779438" title=" " alt="" coords="346,904,494,929"/>
<area shape="poly" title=" " alt="" coords="39,799,63,841,81,863,104,881,159,904,218,917,276,923,330,923,330,928,276,928,217,923,157,909,101,885,78,867,59,844,35,802"/>
<area shape="rect" href="yubihsm_8c.html#a61ab8dbab67b1cceb49cd306f8c3f4b1" title=" " alt="" coords="118,600,267,625"/>
<area shape="poly" title=" " alt="" coords="31,773,38,745,51,707,72,668,101,634,105,631,108,635,104,638,76,671,56,709,43,746,36,775"/>
<area shape="rect" href="yubihsm_8c.html#ae736702f9463878db4adfd45b6a597f9" title=" " alt="" coords="121,700,264,725"/>
<area shape="poly" title=" " alt="" coords="45,772,71,752,101,734,115,728,117,733,104,739,74,757,48,776"/>
<area shape="rect" href="yubihsm_8c.html#aa3f473e6dbb9188ad0269b40921c4f5f" title=" " alt="" coords="113,749,272,775"/>
<area shape="poly" title=" " alt="" coords="55,781,98,774,99,779,56,786"/>
<area shape="rect" href="yubihsm_8c.html#a2db9bbd57a908c5c454fc6254f57dcff" title=" " alt="" coords="110,1253,275,1279"/>
<area shape="poly" title=" " alt="" coords="34,800,37,888,47,1021,56,1090,69,1153,85,1205,105,1240,106,1241,102,1245,101,1243,80,1207,64,1154,51,1090,42,1021,32,888,29,800"/>
<area shape="rect" href="yubihsm_8c.html#a1f749a696792e7911844629e056d9c15" title=" " alt="" coords="103,245,282,271"/>
<area shape="poly" title=" " alt="" coords="28,774,29,707,37,602,46,542,59,479,77,417,100,358,129,314,162,279,166,283,133,317,105,360,82,419,64,480,51,542,42,603,34,707,34,774"/>
<area shape="rect" href="yubihsm_8c.html#a7b5f1f0c1cbca11fbe21e7e4e6b29a1b" title=" " alt="" coords="115,473,270,499"/>
<area shape="poly" title=" " alt="" coords="32,773,55,691,75,638,100,586,131,543,164,508,168,511,135,546,105,588,79,640,60,693,37,774"/>
<area shape="rect" href="yubihsm_8c.html#aa7b8b42156c4bdaf41d8b9758a2fd73f" title=" " alt="" coords="116,649,269,675"/>
<area shape="poly" title=" " alt="" coords="35,773,59,729,78,705,101,685,110,679,113,684,104,689,82,709,64,732,39,775"/>
<area shape="rect" href="yubihsm_8c.html#ae5bf13f9558bb0340468b722accf94d3" title=" " alt="" coords="113,372,272,397"/>
<area shape="poly" title=" " alt="" coords="29,774,31,721,40,640,62,548,79,502,100,459,125,428,155,404,158,408,129,432,105,462,84,504,67,549,46,641,36,721,34,774"/>
<area shape="poly" title=" " alt="" coords="653,242,795,103,799,106,657,246"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="787,245,858,271"/>
<area shape="poly" title=" " alt="" coords="723,255,771,255,771,260,723,260"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="781,676,864,701"/>
<area shape="poly" title=" " alt="" coords="700,269,725,288,750,326,762,362,767,396,765,430,760,501,763,542,773,586,789,626,808,661,803,664,785,628,768,588,758,542,755,501,760,430,761,396,757,363,745,328,721,292,696,273"/>
<area shape="poly" title=" " alt="" coords="465,972,521,979,589,979,624,975,658,966,691,954,721,936,745,913,765,887,781,857,793,826,809,766,816,716,822,717,815,767,798,828,786,859,769,889,749,917,724,940,694,958,660,972,625,980,589,984,521,984,464,977"/>
<area shape="poly" title=" " alt="" coords="509,760,612,751,668,742,722,730,782,706,784,711,723,735,669,747,613,756,510,765"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="575,549,705,575"/>
<area shape="poly" title=" " alt="" coords="433,749,612,583,615,587,437,753"/>
<area shape="poly" title=" " alt="" coords="693,546,721,528,744,500,763,469,791,402,808,337,816,286,821,287,813,338,796,403,768,471,748,503,724,532,696,551"/>
<area shape="poly" title=" " alt="" coords="686,573,724,591,768,626,802,662,799,666,764,630,721,596,683,578"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="771,549,874,575"/>
<area shape="poly" title=" " alt="" coords="706,559,755,559,755,564,706,564"/>
<area shape="poly" title=" " alt="" coords="693,1002,721,984,745,953,766,918,782,881,794,843,810,772,817,716,822,717,815,773,799,845,787,883,770,920,750,956,724,988,696,1007"/>
<area shape="poly" title=" " alt="" coords="473,1077,530,1084,596,1085,630,1081,662,1072,693,1059,721,1041,739,1019,755,984,783,892,803,794,815,716,820,717,808,795,788,893,760,986,743,1021,724,1045,696,1064,664,1077,631,1086,596,1090,530,1090,473,1082"/>
<area shape="poly" title=" " alt="" coords="688,850,721,832,749,804,773,773,807,714,811,716,778,776,753,808,724,836,691,855"/>
<area shape="poly" title=" " alt="" coords="722,92,772,85,773,90,723,97"/>
<area shape="poly" title=" " alt="" coords="689,117,724,135,750,157,773,182,807,230,803,233,769,186,746,161,721,140,686,121"/>
<area shape="poly" title=" " alt="" coords="655,117,690,165,710,197,725,231,741,284,749,329,752,409,754,488,760,534,773,586,789,626,807,661,803,664,784,628,768,588,755,535,749,489,747,409,744,330,736,285,720,233,705,200,686,168,651,121"/>
<area shape="poly" title=" " alt="" coords="494,927,548,930,608,928,667,915,695,904,721,889,742,872,759,851,786,804,804,756,814,716,819,717,809,758,791,806,764,854,745,875,724,893,697,909,669,920,608,933,548,936,494,932"/>
<area shape="poly" title=" " alt="" coords="268,612,474,624,599,637,723,656,769,668,767,673,722,662,598,642,473,629,267,617"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="346,498,494,524"/>
<area shape="poly" title=" " alt="" coords="217,597,329,541,363,527,365,532,331,545,219,601"/>
<area shape="poly" title=" " alt="" coords="430,496,616,280,620,284,434,500"/>
<area shape="poly" title=" " alt="" coords="479,522,567,542,566,547,478,527"/>
<area shape="poly" title=" " alt="" coords="264,707,765,688,765,693,265,712"/>
<area shape="poly" title=" " alt="" coords="257,697,281,685,321,651,355,611,382,571,402,537,407,539,387,574,359,614,324,655,283,689,260,701"/>
<area shape="poly" title=" " alt="" coords="249,773,341,789,462,800,527,800,594,794,659,782,722,762,762,738,796,710,799,714,766,743,724,767,660,787,594,800,527,805,462,805,341,795,248,778"/>
<area shape="poly" title=" " alt="" coords="262,746,280,736,305,714,327,689,363,635,390,581,407,537,412,539,395,583,368,638,331,693,309,718,284,740,265,751"/>
<area shape="rect" href="yubihsm_8c.html#a3032a8f45bfad36ed6157b0158dd7921" title=" " alt="" coords="383,1253,456,1279"/>
<area shape="poly" title=" " alt="" coords="275,1263,368,1263,368,1268,275,1268"/>
<area shape="poly" title=" " alt="" coords="211,242,266,205,349,157,449,110,503,91,557,78,615,70,673,68,773,72,773,78,673,73,615,76,558,83,504,96,451,115,351,161,269,209,214,246"/>
<area shape="poly" title=" " alt="" coords="224,242,311,211,370,194,436,180,507,169,580,165,653,170,724,186,765,206,799,232,795,236,762,211,722,191,652,175,580,171,507,175,437,185,371,199,313,216,226,247"/>
<area shape="poly" title=" " alt="" coords="283,259,384,273,442,285,503,301,563,323,622,350,676,385,725,427,741,446,751,465,758,501,762,540,773,586,809,661,804,663,768,588,756,541,753,502,746,467,736,449,721,430,673,389,619,355,561,328,501,306,441,290,383,278,282,265"/>
<area shape="poly" title=" " alt="" coords="207,269,399,485,395,488,203,273"/>
<area shape="poly" title=" " alt="" coords="230,470,771,273,773,278,231,475"/>
<area shape="poly" title=" " alt="" coords="262,470,361,459,419,457,482,458,545,466,608,480,669,502,724,534,745,556,768,589,809,660,805,663,763,592,741,559,721,538,666,507,607,485,544,471,481,464,419,462,361,464,263,475"/>
<area shape="poly" title=" " alt="" coords="270,492,330,498,330,504,269,497"/>
<area shape="poly" title=" " alt="" coords="247,646,281,635,399,593,448,569,508,534,573,490,619,452,721,356,796,280,800,284,725,360,623,456,576,495,511,539,450,574,401,598,283,640,249,651"/>
<area shape="poly" title=" " alt="" coords="270,661,723,679,765,682,765,687,723,684,269,667"/>
<area shape="poly" title=" " alt="" coords="263,646,280,636,298,614,304,590,310,566,328,541,346,529,349,533,332,545,315,568,309,592,302,616,284,640,266,651"/>
<area shape="poly" title=" " alt="" coords="215,369,273,337,356,298,454,259,557,230,603,222,640,221,723,230,773,240,772,245,722,235,640,226,604,228,558,235,455,264,358,302,275,342,218,373"/>
<area shape="poly" title=" " alt="" coords="272,376,371,376,429,381,490,389,552,403,613,422,671,449,724,484,746,507,756,530,762,556,773,586,810,661,805,663,768,588,757,557,751,532,741,510,721,488,669,454,611,427,551,408,489,394,428,386,371,382,272,381"/>
<area shape="poly" title=" " alt="" coords="219,395,383,488,380,493,216,400"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a870e61ded67e4529500d708a5f1af286" name="a870e61ded67e4529500d708a5f1af286"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a870e61ded67e4529500d708a5f1af286">&#9670;&#160;</a></span>key_label</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* key_label = &quot;label&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="wrap_8c_source.html#l00032">32</a> of file <a class="el" href="wrap_8c_source.html">wrap.c</a>.</p>

</div>
</div>
<a id="abd7f8a696584d8ab4b9f4d1e1970be37" name="abd7f8a696584d8ab4b9f4d1e1970be37"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd7f8a696584d8ab4b9f4d1e1970be37">&#9670;&#160;</a></span>password</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> password[] = &quot;password&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="wrap_8c_source.html#l00033">33</a> of file <a class="el" href="wrap_8c_source.html">wrap.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_428556e0652617aa37d2f7d8bcaf7fdf.html">libraries</a></li><li class="navelem"><a class="el" href="dir_63c6fe01b05f3098165849fc89c17214.html">yubihsm</a></li><li class="navelem"><a class="el" href="dir_b40773af9773b1613fd18c79fce56d5c.html">examples</a></li><li class="navelem"><a class="el" href="wrap_8c.html">wrap.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0 </li>
  </ul>
</div>
</body>
</html>
