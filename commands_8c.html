<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Wire Sysio: libraries/yubihsm/src/commands.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Wire Sysio<span id="projectnumber">&#160;Wire Sysion 1.0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('commands_8c.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">commands.c File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;ctype.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &quot;<a class="el" href="commands_8h_source.html">commands.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="yubihsm-shell_8h_source.html">yubihsm-shell.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="insecure__memzero_8h_source.html">../common/insecure_memzero.h</a>&quot;</code><br />
<code>#include &quot;hash.h&quot;</code><br />
<code>#include &quot;util.h&quot;</code><br />
<code>#include &quot;<a class="el" href="openssl-compat_8h_source.html">openssl-compat.h</a>&quot;</code><br />
<code>#include &lt;arpa/inet.h&gt;</code><br />
<code>#include &lt;unistd.h&gt;</code><br />
<code>#include &lt;sys/ioctl.h&gt;</code><br />
<code>#include &lt;openssl/rand.h&gt;</code><br />
<code>#include &lt;openssl/pem.h&gt;</code><br />
<code>#include &lt;openssl/x509.h&gt;</code><br />
<code>#include &lt;sys/time.h&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for commands.c:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c__incl.png" border="0" usemap="#alibraries_2yubihsm_2src_2commands_8c" alt=""/></div>
<map name="alibraries_2yubihsm_2src_2commands_8c" id="alibraries_2yubihsm_2src_2commands_8c">
<area shape="rect" title=" " alt="" coords="723,5,864,46"/>
<area shape="rect" title=" " alt="" coords="5,102,70,127"/>
<area shape="poly" title=" " alt="" coords="723,30,601,34,443,45,266,64,176,79,89,97,81,99,79,94,88,91,175,74,265,59,442,39,601,29,722,25"/>
<area shape="rect" title=" " alt="" coords="43,330,104,356"/>
<area shape="poly" title=" " alt="" coords="723,33,577,42,402,55,249,74,196,84,167,96,144,119,125,146,109,175,98,206,83,266,77,315,72,314,78,265,93,205,105,173,120,143,140,115,164,92,195,79,249,68,402,50,576,36,723,28"/>
<area shape="rect" title=" " alt="" coords="348,102,412,127"/>
<area shape="poly" title=" " alt="" coords="723,38,583,59,504,76,425,97,420,98,419,93,423,91,502,71,583,54,722,32"/>
<area shape="rect" title=" " alt="" coords="436,102,500,127"/>
<area shape="poly" title=" " alt="" coords="723,43,623,65,513,97,509,98,507,93,511,91,622,60,722,38"/>
<area shape="rect" href="commands_8h.html" title=" " alt="" coords="177,102,274,127"/>
<area shape="poly" title=" " alt="" coords="723,36,528,58,410,75,293,97,280,100,279,94,292,91,409,70,527,53,722,31"/>
<area shape="rect" href="yubihsm-shell_8h.html" title=" " alt="" coords="301,183,414,208"/>
<area shape="poly" title=" " alt="" coords="723,29,620,32,505,42,450,51,402,62,363,77,338,96,330,112,330,131,344,168,339,170,325,131,325,111,334,92,361,73,400,57,449,45,504,37,620,27,722,24"/>
<area shape="rect" href="insecure__memzero_8h.html" title=" " alt="" coords="524,94,660,135"/>
<area shape="poly" title=" " alt="" coords="749,49,653,90,651,85,747,44"/>
<area shape="rect" title=" " alt="" coords="685,102,745,127"/>
<area shape="poly" title=" " alt="" coords="778,48,738,92,734,88,774,45"/>
<area shape="rect" title=" " alt="" coords="769,102,818,127"/>
<area shape="poly" title=" " alt="" coords="796,47,796,86,791,86,791,47"/>
<area shape="rect" href="openssl-compat_8h.html" title=" " alt="" coords="842,102,966,127"/>
<area shape="poly" title=" " alt="" coords="820,44,879,90,876,94,817,49"/>
<area shape="rect" title=" " alt="" coords="1012,183,1122,208"/>
<area shape="poly" title=" " alt="" coords="866,41,924,62,980,92,1022,130,1053,168,1049,172,1018,133,977,96,921,66,864,46"/>
<area shape="rect" title=" " alt="" coords="1042,102,1124,127"/>
<area shape="poly" title=" " alt="" coords="863,44,1024,91,1032,94,1030,99,1022,97,861,49"/>
<area shape="rect" title=" " alt="" coords="1148,102,1215,127"/>
<area shape="poly" title=" " alt="" coords="865,34,993,56,1137,91,1142,93,1141,98,1135,97,992,61,864,39"/>
<area shape="rect" title=" " alt="" coords="1240,102,1321,127"/>
<area shape="poly" title=" " alt="" coords="865,31,1031,53,1130,70,1227,91,1236,94,1234,99,1226,97,1129,75,1031,58,864,36"/>
<area shape="rect" title=" " alt="" coords="1344,102,1451,127"/>
<area shape="poly" title=" " alt="" coords="865,29,1076,50,1205,68,1334,91,1346,94,1345,99,1333,97,1204,73,1075,56,864,35"/>
<area shape="rect" title=" " alt="" coords="1475,102,1581,127"/>
<area shape="poly" title=" " alt="" coords="865,27,1129,46,1296,65,1463,91,1477,94,1475,100,1462,97,1295,70,1129,51,864,32"/>
<area shape="rect" title=" " alt="" coords="1606,102,1688,127"/>
<area shape="poly" title=" " alt="" coords="865,24,1001,27,1183,37,1388,57,1492,72,1594,91,1604,94,1602,99,1593,97,1492,77,1387,62,1182,42,1000,32,864,29"/>
<area shape="rect" href="stdint_8h.html" title=" " alt="" coords="320,330,384,356"/>
<area shape="poly" title=" " alt="" coords="231,127,251,195,269,239,292,280,326,318,322,321,287,284,264,241,246,197,226,129"/>
<area shape="rect" href="yubihsm_8h.html" title=" " alt="" coords="145,256,226,282"/>
<area shape="poly" title=" " alt="" coords="225,128,195,242,190,241,220,127"/>
<area shape="poly" title=" " alt="" coords="247,125,325,172,323,177,244,130"/>
<area shape="rect" title=" " alt="" coords="275,404,338,429"/>
<area shape="poly" title=" " alt="" coords="347,357,325,392,320,389,342,354"/>
<area shape="rect" title=" " alt="" coords="363,404,429,429"/>
<area shape="poly" title=" " alt="" coords="362,354,383,389,378,392,357,357"/>
<area shape="poly" title=" " alt="" coords="168,285,107,324,104,319,165,280"/>
<area shape="poly" title=" " alt="" coords="215,280,311,321,309,326,213,285"/>
<area shape="rect" title=" " alt="" coords="128,330,203,356"/>
<area shape="poly" title=" " alt="" coords="185,283,176,316,170,314,180,282"/>
<area shape="rect" title=" " alt="" coords="227,330,296,356"/>
<area shape="poly" title=" " alt="" coords="200,281,240,317,236,321,197,284"/>
<area shape="poly" title=" " alt="" coords="329,211,230,252,228,248,327,206"/>
<area shape="rect" title=" " alt="" coords="386,256,454,282"/>
<area shape="poly" title=" " alt="" coords="370,207,401,243,397,246,366,210"/>
<area shape="rect" href="ykyh_8h.html" title=" " alt="" coords="302,256,362,282"/>
<area shape="poly" title=" " alt="" coords="356,209,344,243,339,241,351,208"/>
<area shape="rect" title=" " alt="" coords="479,256,556,282"/>
<area shape="poly" title=" " alt="" coords="386,206,478,247,475,252,384,211"/>
<area shape="poly" title=" " alt="" coords="338,282,347,314,342,316,333,283"/>
<area shape="poly" title=" " alt="" coords="322,284,286,321,282,317,319,280"/>
<area shape="rect" title=" " alt="" coords="451,183,568,208"/>
<area shape="poly" title=" " alt="" coords="574,137,535,173,532,170,570,133"/>
<area shape="rect" title=" " alt="" coords="592,183,723,208"/>
<area shape="poly" title=" " alt="" coords="867,130,711,180,709,175,865,125"/>
<area shape="rect" title=" " alt="" coords="748,183,847,208"/>
<area shape="poly" title=" " alt="" coords="890,130,827,175,824,171,886,125"/>
<area shape="rect" title=" " alt="" coords="871,183,988,208"/>
<area shape="poly" title=" " alt="" coords="911,127,923,167,918,168,905,128"/>
<area shape="poly" title=" " alt="" coords="930,125,1030,173,1027,178,928,130"/>
</map>
</div>
</div>
<p><a href="commands_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a3c600843ccdac7af506983bc67cb0bc3" id="r_a3c600843ccdac7af506983bc67cb0bc3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3c600843ccdac7af506983bc67cb0bc3">yh_com_audit</a> (<a class="el" href="structyubihsm__context.html">yubihsm_context</a> *ctx, <a class="el" href="struct_argument.html">Argument</a> *<a class="el" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>, <a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a> fmt)</td></tr>
<tr class="separator:a3c600843ccdac7af506983bc67cb0bc3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb72c881aa2699aea40f45fa65cf069b" id="r_aeb72c881aa2699aea40f45fa65cf069b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aeb72c881aa2699aea40f45fa65cf069b">yh_com_set_log_index</a> (<a class="el" href="structyubihsm__context.html">yubihsm_context</a> *ctx, <a class="el" href="struct_argument.html">Argument</a> *<a class="el" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>, <a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a> fmt)</td></tr>
<tr class="separator:aeb72c881aa2699aea40f45fa65cf069b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d821476693df49671598a98e7d6dbca" id="r_a1d821476693df49671598a98e7d6dbca"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1d821476693df49671598a98e7d6dbca">yh_com_blink</a> (<a class="el" href="structyubihsm__context.html">yubihsm_context</a> *ctx, <a class="el" href="struct_argument.html">Argument</a> *<a class="el" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>, <a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a> fmt)</td></tr>
<tr class="separator:a1d821476693df49671598a98e7d6dbca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aabb06b0c16a19b4b22478cb753d8f599" id="r_aabb06b0c16a19b4b22478cb753d8f599"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aabb06b0c16a19b4b22478cb753d8f599">yh_com_close_session</a> (<a class="el" href="structyubihsm__context.html">yubihsm_context</a> *ctx, <a class="el" href="struct_argument.html">Argument</a> *<a class="el" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>, <a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a> fmt)</td></tr>
<tr class="separator:aabb06b0c16a19b4b22478cb753d8f599"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9155cc4306ad97e58a03ead18637f33b" id="r_a9155cc4306ad97e58a03ead18637f33b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9155cc4306ad97e58a03ead18637f33b">yh_com_connect</a> (<a class="el" href="structyubihsm__context.html">yubihsm_context</a> *ctx, <a class="el" href="struct_argument.html">Argument</a> *<a class="el" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>, <a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a> fmt)</td></tr>
<tr class="separator:a9155cc4306ad97e58a03ead18637f33b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8a6eb16c04ad3e525f8be152062ff24" id="r_ad8a6eb16c04ad3e525f8be152062ff24"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad8a6eb16c04ad3e525f8be152062ff24">yh_com_debug_all</a> (<a class="el" href="structyubihsm__context.html">yubihsm_context</a> *ctx, <a class="el" href="struct_argument.html">Argument</a> *<a class="el" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>, <a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a> fmt)</td></tr>
<tr class="separator:ad8a6eb16c04ad3e525f8be152062ff24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af045c2e8a570dc8fed3d339e75d26feb" id="r_af045c2e8a570dc8fed3d339e75d26feb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af045c2e8a570dc8fed3d339e75d26feb">yh_com_debug_error</a> (<a class="el" href="structyubihsm__context.html">yubihsm_context</a> *ctx, <a class="el" href="struct_argument.html">Argument</a> *<a class="el" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>, <a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a> fmt)</td></tr>
<tr class="separator:af045c2e8a570dc8fed3d339e75d26feb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a774b8dbc4c8d855527e518270206bb52" id="r_a774b8dbc4c8d855527e518270206bb52"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a774b8dbc4c8d855527e518270206bb52">yh_com_debug_info</a> (<a class="el" href="structyubihsm__context.html">yubihsm_context</a> *ctx, <a class="el" href="struct_argument.html">Argument</a> *<a class="el" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>, <a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a> fmt)</td></tr>
<tr class="separator:a774b8dbc4c8d855527e518270206bb52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad621ced8cc22f103e049f17717d0b3d8" id="r_ad621ced8cc22f103e049f17717d0b3d8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad621ced8cc22f103e049f17717d0b3d8">yh_com_debug_intermediate</a> (<a class="el" href="structyubihsm__context.html">yubihsm_context</a> *ctx, <a class="el" href="struct_argument.html">Argument</a> *<a class="el" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>, <a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a> fmt)</td></tr>
<tr class="separator:ad621ced8cc22f103e049f17717d0b3d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8470d4c5dc4fa0d300bcf171a16140b" id="r_ac8470d4c5dc4fa0d300bcf171a16140b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac8470d4c5dc4fa0d300bcf171a16140b">yh_com_debug_none</a> (<a class="el" href="structyubihsm__context.html">yubihsm_context</a> *ctx, <a class="el" href="struct_argument.html">Argument</a> *<a class="el" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>, <a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a> fmt)</td></tr>
<tr class="separator:ac8470d4c5dc4fa0d300bcf171a16140b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac67abff009407dcfe773a32d8273969a" id="r_ac67abff009407dcfe773a32d8273969a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac67abff009407dcfe773a32d8273969a">yh_com_debug_raw</a> (<a class="el" href="structyubihsm__context.html">yubihsm_context</a> *ctx, <a class="el" href="struct_argument.html">Argument</a> *<a class="el" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>, <a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a> fmt)</td></tr>
<tr class="separator:ac67abff009407dcfe773a32d8273969a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5cc531118346eb9389b42149112acdc" id="r_af5cc531118346eb9389b42149112acdc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af5cc531118346eb9389b42149112acdc">yh_com_debug_crypto</a> (<a class="el" href="structyubihsm__context.html">yubihsm_context</a> *ctx, <a class="el" href="struct_argument.html">Argument</a> *<a class="el" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>, <a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a> fmt)</td></tr>
<tr class="separator:af5cc531118346eb9389b42149112acdc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea9c5cab32280dc06d4681c02f1b5ccb" id="r_aea9c5cab32280dc06d4681c02f1b5ccb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aea9c5cab32280dc06d4681c02f1b5ccb">yh_com_decrypt_pkcs1v1_5</a> (<a class="el" href="structyubihsm__context.html">yubihsm_context</a> *ctx, <a class="el" href="struct_argument.html">Argument</a> *<a class="el" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>, <a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a> fmt)</td></tr>
<tr class="separator:aea9c5cab32280dc06d4681c02f1b5ccb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f6792710fe36e1bf00cb839f286d473" id="r_a0f6792710fe36e1bf00cb839f286d473"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0f6792710fe36e1bf00cb839f286d473">yh_com_derive_ecdh</a> (<a class="el" href="structyubihsm__context.html">yubihsm_context</a> *ctx, <a class="el" href="struct_argument.html">Argument</a> *<a class="el" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>, <a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a> fmt)</td></tr>
<tr class="separator:a0f6792710fe36e1bf00cb839f286d473"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a18ed75272b213eea9b2ebec190b8c1" id="r_a4a18ed75272b213eea9b2ebec190b8c1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4a18ed75272b213eea9b2ebec190b8c1">yh_com_decrypt_aesccm</a> (<a class="el" href="structyubihsm__context.html">yubihsm_context</a> *ctx, <a class="el" href="struct_argument.html">Argument</a> *<a class="el" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>, <a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a> fmt)</td></tr>
<tr class="separator:a4a18ed75272b213eea9b2ebec190b8c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a115ebd6b436229c152141f64a2405e70" id="r_a115ebd6b436229c152141f64a2405e70"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a115ebd6b436229c152141f64a2405e70">yh_com_encrypt_aesccm</a> (<a class="el" href="structyubihsm__context.html">yubihsm_context</a> *ctx, <a class="el" href="struct_argument.html">Argument</a> *<a class="el" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>, <a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a> fmt)</td></tr>
<tr class="separator:a115ebd6b436229c152141f64a2405e70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac388fd67865728ed4f4267a8a13b248e" id="r_ac388fd67865728ed4f4267a8a13b248e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac388fd67865728ed4f4267a8a13b248e">yh_com_disconnect</a> (<a class="el" href="structyubihsm__context.html">yubihsm_context</a> *ctx, <a class="el" href="struct_argument.html">Argument</a> *<a class="el" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>, <a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a> fmt)</td></tr>
<tr class="separator:ac388fd67865728ed4f4267a8a13b248e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af764906e585805991dd84ec5dc2c060a" id="r_af764906e585805991dd84ec5dc2c060a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af764906e585805991dd84ec5dc2c060a">yh_com_echo</a> (<a class="el" href="structyubihsm__context.html">yubihsm_context</a> *ctx, <a class="el" href="struct_argument.html">Argument</a> *<a class="el" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>, <a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a> fmt)</td></tr>
<tr class="separator:af764906e585805991dd84ec5dc2c060a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1c71ebc2b3f298b6522ab090393c73e" id="r_aa1c71ebc2b3f298b6522ab090393c73e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa1c71ebc2b3f298b6522ab090393c73e">yh_com_generate_asymmetric</a> (<a class="el" href="structyubihsm__context.html">yubihsm_context</a> *ctx, <a class="el" href="struct_argument.html">Argument</a> *<a class="el" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>, <a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a> fmt)</td></tr>
<tr class="separator:aa1c71ebc2b3f298b6522ab090393c73e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2be1be0e0a454965f5a378e4ecb483f0" id="r_a2be1be0e0a454965f5a378e4ecb483f0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2be1be0e0a454965f5a378e4ecb483f0">yh_com_generate_hmac</a> (<a class="el" href="structyubihsm__context.html">yubihsm_context</a> *ctx, <a class="el" href="struct_argument.html">Argument</a> *<a class="el" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>, <a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a> fmt)</td></tr>
<tr class="separator:a2be1be0e0a454965f5a378e4ecb483f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43d7d9dd1659838d79f875e61e59ce52" id="r_a43d7d9dd1659838d79f875e61e59ce52"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a43d7d9dd1659838d79f875e61e59ce52">yh_com_generate_wrap</a> (<a class="el" href="structyubihsm__context.html">yubihsm_context</a> *ctx, <a class="el" href="struct_argument.html">Argument</a> *<a class="el" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>, <a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a> fmt)</td></tr>
<tr class="separator:a43d7d9dd1659838d79f875e61e59ce52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8a4781a26be12a87848234cc184a3bb" id="r_ad8a4781a26be12a87848234cc184a3bb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad8a4781a26be12a87848234cc184a3bb">yh_com_get_opaque</a> (<a class="el" href="structyubihsm__context.html">yubihsm_context</a> *ctx, <a class="el" href="struct_argument.html">Argument</a> *<a class="el" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>, <a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a> fmt)</td></tr>
<tr class="separator:ad8a4781a26be12a87848234cc184a3bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaafb1f743869a0068a7d7b6ed1bafb01" id="r_aaafb1f743869a0068a7d7b6ed1bafb01"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aaafb1f743869a0068a7d7b6ed1bafb01">yh_com_get_option</a> (<a class="el" href="structyubihsm__context.html">yubihsm_context</a> *ctx, <a class="el" href="struct_argument.html">Argument</a> *<a class="el" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>, <a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a> fmt)</td></tr>
<tr class="separator:aaafb1f743869a0068a7d7b6ed1bafb01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af32a8f10f2d022ca8b7816e6f4809a24" id="r_af32a8f10f2d022ca8b7816e6f4809a24"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af32a8f10f2d022ca8b7816e6f4809a24">yh_com_get_random</a> (<a class="el" href="structyubihsm__context.html">yubihsm_context</a> *ctx, <a class="el" href="struct_argument.html">Argument</a> *<a class="el" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>, <a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a> fmt)</td></tr>
<tr class="separator:af32a8f10f2d022ca8b7816e6f4809a24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a408c9e43b8ccb159acb178f2b20f3f77" id="r_a408c9e43b8ccb159acb178f2b20f3f77"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a408c9e43b8ccb159acb178f2b20f3f77">yh_com_get_storage</a> (<a class="el" href="structyubihsm__context.html">yubihsm_context</a> *ctx, <a class="el" href="struct_argument.html">Argument</a> *<a class="el" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>, <a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a> fmt)</td></tr>
<tr class="separator:a408c9e43b8ccb159acb178f2b20f3f77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1c9a933f4601dae48cd64f911d297aa" id="r_aa1c9a933f4601dae48cd64f911d297aa"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa1c9a933f4601dae48cd64f911d297aa">yh_com_get_pubkey</a> (<a class="el" href="structyubihsm__context.html">yubihsm_context</a> *ctx, <a class="el" href="struct_argument.html">Argument</a> *<a class="el" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>, <a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a> fmt)</td></tr>
<tr class="separator:aa1c9a933f4601dae48cd64f911d297aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa7330c81148ba6f4d5c53f7c370ed41" id="r_afa7330c81148ba6f4d5c53f7c370ed41"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afa7330c81148ba6f4d5c53f7c370ed41">yh_com_get_object_info</a> (<a class="el" href="structyubihsm__context.html">yubihsm_context</a> *ctx, <a class="el" href="struct_argument.html">Argument</a> *<a class="el" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>, <a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a> fmt)</td></tr>
<tr class="separator:afa7330c81148ba6f4d5c53f7c370ed41"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac221d587381b78c747d8290320ee4c0a" id="r_ac221d587381b78c747d8290320ee4c0a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac221d587381b78c747d8290320ee4c0a">yh_com_get_wrapped</a> (<a class="el" href="structyubihsm__context.html">yubihsm_context</a> *ctx, <a class="el" href="struct_argument.html">Argument</a> *<a class="el" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>, <a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a> fmt)</td></tr>
<tr class="separator:ac221d587381b78c747d8290320ee4c0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8e5bb8ba179bc997ddc73e03423782d" id="r_ac8e5bb8ba179bc997ddc73e03423782d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac8e5bb8ba179bc997ddc73e03423782d">yh_com_get_template</a> (<a class="el" href="structyubihsm__context.html">yubihsm_context</a> *ctx, <a class="el" href="struct_argument.html">Argument</a> *<a class="el" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>, <a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a> fmt)</td></tr>
<tr class="separator:ac8e5bb8ba179bc997ddc73e03423782d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39d9fd4501c5547cb11e00a3ca37be7e" id="r_a39d9fd4501c5547cb11e00a3ca37be7e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a39d9fd4501c5547cb11e00a3ca37be7e">yh_com_noop</a> (<a class="el" href="structyubihsm__context.html">yubihsm_context</a> *ctx, <a class="el" href="struct_argument.html">Argument</a> *<a class="el" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>, <a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a> fmt)</td></tr>
<tr class="separator:a39d9fd4501c5547cb11e00a3ca37be7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7355f80935fb819c440a21d56f181e4" id="r_ab7355f80935fb819c440a21d56f181e4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab7355f80935fb819c440a21d56f181e4">yh_com_list_capabilities</a> (<a class="el" href="structyubihsm__context.html">yubihsm_context</a> *ctx, <a class="el" href="struct_argument.html">Argument</a> *<a class="el" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>, <a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a> fmt)</td></tr>
<tr class="separator:ab7355f80935fb819c440a21d56f181e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac981267ad1d570af845289dfb0733b8b" id="r_ac981267ad1d570af845289dfb0733b8b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac981267ad1d570af845289dfb0733b8b">yh_com_list_algorithms</a> (<a class="el" href="structyubihsm__context.html">yubihsm_context</a> *ctx, <a class="el" href="struct_argument.html">Argument</a> *<a class="el" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>, <a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a> fmt)</td></tr>
<tr class="separator:ac981267ad1d570af845289dfb0733b8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65ff18ca1fb6f1b4da386071e1c1a505" id="r_a65ff18ca1fb6f1b4da386071e1c1a505"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a65ff18ca1fb6f1b4da386071e1c1a505">yh_com_list_types</a> (<a class="el" href="structyubihsm__context.html">yubihsm_context</a> *ctx, <a class="el" href="struct_argument.html">Argument</a> *<a class="el" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>, <a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a> fmt)</td></tr>
<tr class="separator:a65ff18ca1fb6f1b4da386071e1c1a505"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab98950b39a19499a22ec6b2e874525a5" id="r_ab98950b39a19499a22ec6b2e874525a5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab98950b39a19499a22ec6b2e874525a5">yh_com_list_sessions</a> (<a class="el" href="structyubihsm__context.html">yubihsm_context</a> *ctx, <a class="el" href="struct_argument.html">Argument</a> *<a class="el" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>, <a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a> fmt)</td></tr>
<tr class="separator:ab98950b39a19499a22ec6b2e874525a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b752129687a9ca758661e0b6625b59c" id="r_a2b752129687a9ca758661e0b6625b59c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2b752129687a9ca758661e0b6625b59c">yh_com_list_objects</a> (<a class="el" href="structyubihsm__context.html">yubihsm_context</a> *ctx, <a class="el" href="struct_argument.html">Argument</a> *<a class="el" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>, <a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a> fmt)</td></tr>
<tr class="separator:a2b752129687a9ca758661e0b6625b59c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22f22a25151b12c7573f80563a341368" id="r_a22f22a25151b12c7573f80563a341368"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a22f22a25151b12c7573f80563a341368">yh_com_open_session</a> (<a class="el" href="structyubihsm__context.html">yubihsm_context</a> *ctx, <a class="el" href="struct_argument.html">Argument</a> *<a class="el" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>, <a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a> fmt)</td></tr>
<tr class="separator:a22f22a25151b12c7573f80563a341368"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95d970cdea5162be25cac2a7f5c420ed" id="r_a95d970cdea5162be25cac2a7f5c420ed"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a95d970cdea5162be25cac2a7f5c420ed">yh_com_pecho</a> (<a class="el" href="structyubihsm__context.html">yubihsm_context</a> *ctx, <a class="el" href="struct_argument.html">Argument</a> *<a class="el" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>, <a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a> fmt)</td></tr>
<tr class="separator:a95d970cdea5162be25cac2a7f5c420ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0abe95eb37069022ed341835938de103" id="r_a0abe95eb37069022ed341835938de103"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0abe95eb37069022ed341835938de103">yh_com_put_asymmetric</a> (<a class="el" href="structyubihsm__context.html">yubihsm_context</a> *ctx, <a class="el" href="struct_argument.html">Argument</a> *<a class="el" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>, <a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a> fmt)</td></tr>
<tr class="separator:a0abe95eb37069022ed341835938de103"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3bd17c302789958013e50a2ad9738aea" id="r_a3bd17c302789958013e50a2ad9738aea"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3bd17c302789958013e50a2ad9738aea">yh_com_put_authentication</a> (<a class="el" href="structyubihsm__context.html">yubihsm_context</a> *ctx, <a class="el" href="struct_argument.html">Argument</a> *<a class="el" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>, <a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a> fmt)</td></tr>
<tr class="separator:a3bd17c302789958013e50a2ad9738aea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2be40cf6e90d80392d7aa5e291660f65" id="r_a2be40cf6e90d80392d7aa5e291660f65"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2be40cf6e90d80392d7aa5e291660f65">yh_com_put_opaque</a> (<a class="el" href="structyubihsm__context.html">yubihsm_context</a> *ctx, <a class="el" href="struct_argument.html">Argument</a> *<a class="el" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>, <a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a> fmt)</td></tr>
<tr class="separator:a2be40cf6e90d80392d7aa5e291660f65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae400ec3fdd83a82b3c08dd7106c516b9" id="r_ae400ec3fdd83a82b3c08dd7106c516b9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae400ec3fdd83a82b3c08dd7106c516b9">yh_com_put_option</a> (<a class="el" href="structyubihsm__context.html">yubihsm_context</a> *ctx, <a class="el" href="struct_argument.html">Argument</a> *<a class="el" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>, <a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a> fmt)</td></tr>
<tr class="separator:ae400ec3fdd83a82b3c08dd7106c516b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed17eea0c4eb877cd1097fbcd8e8e5d0" id="r_aed17eea0c4eb877cd1097fbcd8e8e5d0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aed17eea0c4eb877cd1097fbcd8e8e5d0">yh_com_put_hmac</a> (<a class="el" href="structyubihsm__context.html">yubihsm_context</a> *ctx, <a class="el" href="struct_argument.html">Argument</a> *<a class="el" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>, <a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a> fmt)</td></tr>
<tr class="separator:aed17eea0c4eb877cd1097fbcd8e8e5d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2eb73abfe6f6d5a7f17752b3cab227a" id="r_ab2eb73abfe6f6d5a7f17752b3cab227a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab2eb73abfe6f6d5a7f17752b3cab227a">yh_com_put_wrapkey</a> (<a class="el" href="structyubihsm__context.html">yubihsm_context</a> *ctx, <a class="el" href="struct_argument.html">Argument</a> *<a class="el" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>, <a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a> fmt)</td></tr>
<tr class="separator:ab2eb73abfe6f6d5a7f17752b3cab227a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b74f2d2d47796c2432a15cd63183dd1" id="r_a6b74f2d2d47796c2432a15cd63183dd1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6b74f2d2d47796c2432a15cd63183dd1">yh_com_put_wrapped</a> (<a class="el" href="structyubihsm__context.html">yubihsm_context</a> *ctx, <a class="el" href="struct_argument.html">Argument</a> *<a class="el" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>, <a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a> fmt)</td></tr>
<tr class="separator:a6b74f2d2d47796c2432a15cd63183dd1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1629b955c1d718c65f137c9df3b3332" id="r_ad1629b955c1d718c65f137c9df3b3332"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad1629b955c1d718c65f137c9df3b3332">yh_com_put_template</a> (<a class="el" href="structyubihsm__context.html">yubihsm_context</a> *ctx, <a class="el" href="struct_argument.html">Argument</a> *<a class="el" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>, <a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a> fmt)</td></tr>
<tr class="separator:ad1629b955c1d718c65f137c9df3b3332"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a982058963f9ff020c357030be09e79fc" id="r_a982058963f9ff020c357030be09e79fc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a982058963f9ff020c357030be09e79fc">yh_com_sign_ecdsa</a> (<a class="el" href="structyubihsm__context.html">yubihsm_context</a> *ctx, <a class="el" href="struct_argument.html">Argument</a> *<a class="el" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>, <a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a> fmt)</td></tr>
<tr class="separator:a982058963f9ff020c357030be09e79fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac867ca0fc75e87da1a8d924fc587f5b9" id="r_ac867ca0fc75e87da1a8d924fc587f5b9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac867ca0fc75e87da1a8d924fc587f5b9">yh_com_sign_eddsa</a> (<a class="el" href="structyubihsm__context.html">yubihsm_context</a> *ctx, <a class="el" href="struct_argument.html">Argument</a> *<a class="el" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>, <a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a> fmt)</td></tr>
<tr class="separator:ac867ca0fc75e87da1a8d924fc587f5b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98cf5e35ce2e4fd5881d8b6e7a890357" id="r_a98cf5e35ce2e4fd5881d8b6e7a890357"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a98cf5e35ce2e4fd5881d8b6e7a890357">yh_com_sign_pkcs1v1_5</a> (<a class="el" href="structyubihsm__context.html">yubihsm_context</a> *ctx, <a class="el" href="struct_argument.html">Argument</a> *<a class="el" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>, <a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a> fmt)</td></tr>
<tr class="separator:a98cf5e35ce2e4fd5881d8b6e7a890357"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1dcbe3dfaa3722ae6e9246527b889627" id="r_a1dcbe3dfaa3722ae6e9246527b889627"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1dcbe3dfaa3722ae6e9246527b889627">yh_com_sign_pss</a> (<a class="el" href="structyubihsm__context.html">yubihsm_context</a> *ctx, <a class="el" href="struct_argument.html">Argument</a> *<a class="el" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>, <a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a> fmt)</td></tr>
<tr class="separator:a1dcbe3dfaa3722ae6e9246527b889627"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca833cbc2ca7673b00a4f6cb320c97b6" id="r_aca833cbc2ca7673b00a4f6cb320c97b6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aca833cbc2ca7673b00a4f6cb320c97b6">yh_com_get_device_info</a> (<a class="el" href="structyubihsm__context.html">yubihsm_context</a> *ctx, <a class="el" href="struct_argument.html">Argument</a> *<a class="el" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>, <a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a> fmt)</td></tr>
<tr class="separator:aca833cbc2ca7673b00a4f6cb320c97b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8de2999193b4caa2d0d1fd2e8451dba1" id="r_a8de2999193b4caa2d0d1fd2e8451dba1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8de2999193b4caa2d0d1fd2e8451dba1">yh_com_hmac</a> (<a class="el" href="structyubihsm__context.html">yubihsm_context</a> *ctx, <a class="el" href="struct_argument.html">Argument</a> *<a class="el" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>, <a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a> fmt)</td></tr>
<tr class="separator:a8de2999193b4caa2d0d1fd2e8451dba1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5947d870ac856de3880f8b80981e6355" id="r_a5947d870ac856de3880f8b80981e6355"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5947d870ac856de3880f8b80981e6355">yh_com_reset</a> (<a class="el" href="structyubihsm__context.html">yubihsm_context</a> *ctx, <a class="el" href="struct_argument.html">Argument</a> *<a class="el" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>, <a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a> fmt)</td></tr>
<tr class="separator:a5947d870ac856de3880f8b80981e6355"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad490f0e89d33c1300a44bd095eb5562c" id="r_ad490f0e89d33c1300a44bd095eb5562c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad490f0e89d33c1300a44bd095eb5562c">yh_com_delete</a> (<a class="el" href="structyubihsm__context.html">yubihsm_context</a> *ctx, <a class="el" href="struct_argument.html">Argument</a> *<a class="el" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>, <a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a> fmt)</td></tr>
<tr class="separator:ad490f0e89d33c1300a44bd095eb5562c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03581158b5703a0ffe866d50d8a3982d" id="r_a03581158b5703a0ffe866d50d8a3982d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a03581158b5703a0ffe866d50d8a3982d">yh_com_sign_ssh_certificate</a> (<a class="el" href="structyubihsm__context.html">yubihsm_context</a> *ctx, <a class="el" href="struct_argument.html">Argument</a> *<a class="el" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>, <a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a> fmt)</td></tr>
<tr class="separator:a03581158b5703a0ffe866d50d8a3982d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2e50929acc6085cd395d0bd4ddb02db" id="r_ae2e50929acc6085cd395d0bd4ddb02db"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae2e50929acc6085cd395d0bd4ddb02db">yh_com_benchmark</a> (<a class="el" href="structyubihsm__context.html">yubihsm_context</a> *ctx, <a class="el" href="struct_argument.html">Argument</a> *<a class="el" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>, <a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a> fmt)</td></tr>
<tr class="separator:ae2e50929acc6085cd395d0bd4ddb02db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae716e54fae7ba83cb44fe966fbcad9cb" id="r_ae716e54fae7ba83cb44fe966fbcad9cb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae716e54fae7ba83cb44fe966fbcad9cb">yh_com_otp_aead_create</a> (<a class="el" href="structyubihsm__context.html">yubihsm_context</a> *ctx, <a class="el" href="struct_argument.html">Argument</a> *<a class="el" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>, <a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a> fmt)</td></tr>
<tr class="separator:ae716e54fae7ba83cb44fe966fbcad9cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a533707756dfe3a35c9aadf4d288b73d4" id="r_a533707756dfe3a35c9aadf4d288b73d4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a533707756dfe3a35c9aadf4d288b73d4">yh_com_otp_aead_random</a> (<a class="el" href="structyubihsm__context.html">yubihsm_context</a> *ctx, <a class="el" href="struct_argument.html">Argument</a> *<a class="el" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>, <a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a> fmt)</td></tr>
<tr class="separator:a533707756dfe3a35c9aadf4d288b73d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad676312a3ed43f6a3ece63851780aeff" id="r_ad676312a3ed43f6a3ece63851780aeff"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad676312a3ed43f6a3ece63851780aeff">yh_com_otp_decrypt</a> (<a class="el" href="structyubihsm__context.html">yubihsm_context</a> *ctx, <a class="el" href="struct_argument.html">Argument</a> *<a class="el" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>, <a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a> fmt)</td></tr>
<tr class="separator:ad676312a3ed43f6a3ece63851780aeff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af224308de5cdf8e20cbbdcaa6cf7598c" id="r_af224308de5cdf8e20cbbdcaa6cf7598c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af224308de5cdf8e20cbbdcaa6cf7598c">yh_com_sign_attestation_certificate</a> (<a class="el" href="structyubihsm__context.html">yubihsm_context</a> *ctx, <a class="el" href="struct_argument.html">Argument</a> *<a class="el" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>, <a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a> fmt)</td></tr>
<tr class="separator:af224308de5cdf8e20cbbdcaa6cf7598c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ef84380bc19536e4ba9bf62fd44ba93" id="r_a7ef84380bc19536e4ba9bf62fd44ba93"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7ef84380bc19536e4ba9bf62fd44ba93">yh_com_put_otp_aead_key</a> (<a class="el" href="structyubihsm__context.html">yubihsm_context</a> *ctx, <a class="el" href="struct_argument.html">Argument</a> *<a class="el" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>, <a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a> fmt)</td></tr>
<tr class="separator:a7ef84380bc19536e4ba9bf62fd44ba93"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13416d261c1a92415525cbfa63a2dc0c" id="r_a13416d261c1a92415525cbfa63a2dc0c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a13416d261c1a92415525cbfa63a2dc0c">yh_com_generate_otp_aead_key</a> (<a class="el" href="structyubihsm__context.html">yubihsm_context</a> *ctx, <a class="el" href="struct_argument.html">Argument</a> *<a class="el" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>, <a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a> fmt)</td></tr>
<tr class="separator:a13416d261c1a92415525cbfa63a2dc0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38efe7b63355b641f9489d4f95106589" id="r_a38efe7b63355b641f9489d4f95106589"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a38efe7b63355b641f9489d4f95106589">yh_com_decrypt_oaep</a> (<a class="el" href="structyubihsm__context.html">yubihsm_context</a> *ctx, <a class="el" href="struct_argument.html">Argument</a> *<a class="el" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>, <a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a> fmt)</td></tr>
<tr class="separator:a38efe7b63355b641f9489d4f95106589"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada05a561c71aebab8f0a53c0d552e027" id="r_ada05a561c71aebab8f0a53c0d552e027"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ada05a561c71aebab8f0a53c0d552e027">yh_com_set_cacert</a> (<a class="el" href="structyubihsm__context.html">yubihsm_context</a> *ctx, <a class="el" href="struct_argument.html">Argument</a> *<a class="el" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>, <a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a> fmt)</td></tr>
<tr class="separator:ada05a561c71aebab8f0a53c0d552e027"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a264ec5c469bd0517814525ef59c8e69e" id="r_a264ec5c469bd0517814525ef59c8e69e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a264ec5c469bd0517814525ef59c8e69e">yh_com_set_proxy</a> (<a class="el" href="structyubihsm__context.html">yubihsm_context</a> *ctx, <a class="el" href="struct_argument.html">Argument</a> *<a class="el" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>, <a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a> fmt)</td></tr>
<tr class="separator:a264ec5c469bd0517814525ef59c8e69e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0691ab03bd0e40402b2ad5f9a378a541" id="r_a0691ab03bd0e40402b2ad5f9a378a541"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0691ab03bd0e40402b2ad5f9a378a541">yh_com_change_authentication_key</a> (<a class="el" href="structyubihsm__context.html">yubihsm_context</a> *ctx, <a class="el" href="struct_argument.html">Argument</a> *<a class="el" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>, <a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a> fmt)</td></tr>
<tr class="separator:a0691ab03bd0e40402b2ad5f9a378a541"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a3c600843ccdac7af506983bc67cb0bc3" name="a3c600843ccdac7af506983bc67cb0bc3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c600843ccdac7af506983bc67cb0bc3">&#9670;&#160;</a></span>yh_com_audit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int yh_com_audit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__context.html">yubihsm_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_argument.html">Argument</a> *</td>          <td class="paramname"><span class="paramname"><em>argv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a></td>          <td class="paramname"><span class="paramname"><em>fmt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="commands_8c_source.html#l00059">59</a> of file <a class="el" href="commands_8c_source.html">commands.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   59</span>                                                                       {</div>
<div class="line"><span class="lineno">   60</span> </div>
<div class="line"><span class="lineno">   61</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ctx);</div>
<div class="line"><span class="lineno">   62</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(fmt);</div>
<div class="line"><span class="lineno">   63</span> </div>
<div class="line"><span class="lineno">   64</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno">   65</span> </div>
<div class="line"><span class="lineno">   66</span>  <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> unlogged_boot = 0;</div>
<div class="line"><span class="lineno">   67</span>  <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> unlogged_auth = 0;</div>
<div class="line"><span class="lineno">   68</span>  <a class="code hl_struct" href="structyh__log__entry.html">yh_log_entry</a> logs[<a class="code hl_define" href="yubihsm_8h.html#ae10a65a4b5dfaac7c3d64c1ec7b99e82">YH_MAX_LOG_ENTRIES</a>];</div>
<div class="line"><span class="lineno">   69</span>  <span class="keywordtype">size_t</span> n_items = <span class="keyword">sizeof</span>(logs);</div>
<div class="line"><span class="lineno">   70</span> </div>
<div class="line"><span class="lineno">   71</span>  <span class="keywordflow">switch</span> (fmt) {</div>
<div class="line"><span class="lineno">   72</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708a701725c70fb214e14a2feee390939a09">fmt_binary</a>:</div>
<div class="line"><span class="lineno">   73</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708aa8908f2c651567ae288c587240e71d3e">fmt_PEM</a>:</div>
<div class="line"><span class="lineno">   74</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708add674d756d2c6341a834a330a874b550">fmt_base64</a>:</div>
<div class="line"><span class="lineno">   75</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708ad58942468b13601c21c14f2269dbca57">fmt_password</a>:</div>
<div class="line"><span class="lineno">   76</span>      fprintf(stderr,</div>
<div class="line"><span class="lineno">   77</span>              <span class="stringliteral">&quot;The selected output format is not supported for this operation. &quot;</span></div>
<div class="line"><span class="lineno">   78</span>              <span class="stringliteral">&quot;Supported format are \&quot;ASCII\&quot;, \&quot;hex\&quot; and \&quot;default\&quot;\n&quot;</span>);</div>
<div class="line"><span class="lineno">   79</span>      <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">   80</span> </div>
<div class="line"><span class="lineno">   81</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">   82</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">   83</span>  }</div>
<div class="line"><span class="lineno">   84</span> </div>
<div class="line"><span class="lineno">   85</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#a5ae52ad56b7e83baeb33b46104263aa6">yh_util_get_log_entries</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e, &amp;unlogged_boot, &amp;unlogged_auth, logs,</div>
<div class="line"><span class="lineno">   86</span>                                &amp;n_items);</div>
<div class="line"><span class="lineno">   87</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno">   88</span>    fprintf(stderr, <span class="stringliteral">&quot;Failed to get logs: %s\n&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno">   89</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">   90</span>  }</div>
<div class="line"><span class="lineno">   91</span> </div>
<div class="line"><span class="lineno">   92</span>  <span class="keywordtype">char</span> digest_buf[(2 * <a class="code hl_define" href="yubihsm_8h.html#a289ca46f5ef481980f0fad98d727e87a">YH_LOG_DIGEST_SIZE</a>) + 1];</div>
<div class="line"><span class="lineno">   93</span> </div>
<div class="line"><span class="lineno">   94</span>  <span class="keywordflow">switch</span> (ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#addfaa9a6a08f58bdb5b5a93f2e89ccc2">out_fmt</a>) {</div>
<div class="line"><span class="lineno">   95</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708acce29e9764c448874d69cb6c90b02401">fmt_hex</a>:</div>
<div class="line"><span class="lineno">   96</span>      fprintf(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>, <span class="stringliteral">&quot;%04x%04x&quot;</span>, unlogged_boot, unlogged_auth);</div>
<div class="line"><span class="lineno">   97</span>      <span class="keywordflow">for</span> (<a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> i = 0; i &lt; n_items; i++) {</div>
<div class="line"><span class="lineno">   98</span>        <a class="code hl_function" href="util_8c.html#a99b40ed1e5df4e0e59f93585ea38b7c4">format_digest</a>(logs[i].digest, digest_buf, <a class="code hl_define" href="yubihsm_8h.html#a289ca46f5ef481980f0fad98d727e87a">YH_LOG_DIGEST_SIZE</a>);</div>
<div class="line"><span class="lineno">   99</span>        fprintf(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>, <span class="stringliteral">&quot;%04x%02x%04x%04x%04x%04x%02x%08lx%s&quot;</span>, logs[i].number,</div>
<div class="line"><span class="lineno">  100</span>                logs[i].command, logs[i].length, logs[i].session_key,</div>
<div class="line"><span class="lineno">  101</span>                logs[i].target_key, logs[i].second_key, logs[i].result,</div>
<div class="line"><span class="lineno">  102</span>                (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>) logs[i].systick, digest_buf);</div>
<div class="line"><span class="lineno">  103</span>      }</div>
<div class="line"><span class="lineno">  104</span>      fprintf(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>, <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><span class="lineno">  105</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  106</span> </div>
<div class="line"><span class="lineno">  107</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708a4fff5e64ffe63c6c03b00438c0b09282">fmt_ASCII</a>:</div>
<div class="line"><span class="lineno">  108</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">  109</span>      fprintf(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>, <span class="stringliteral">&quot;%d unlogged boots found\n&quot;</span>, unlogged_boot);</div>
<div class="line"><span class="lineno">  110</span>      fprintf(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>, <span class="stringliteral">&quot;%d unlogged authentications found\n&quot;</span>, unlogged_auth);</div>
<div class="line"><span class="lineno">  111</span> </div>
<div class="line"><span class="lineno">  112</span>      <span class="keywordflow">if</span> (n_items == 0) {</div>
<div class="line"><span class="lineno">  113</span>        fprintf(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>, <span class="stringliteral">&quot;No logs to extract\n&quot;</span>);</div>
<div class="line"><span class="lineno">  114</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  115</span>      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (n_items == 1) {</div>
<div class="line"><span class="lineno">  116</span>        fprintf(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>, <span class="stringliteral">&quot;Found 1 item\n&quot;</span>);</div>
<div class="line"><span class="lineno">  117</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  118</span>        fprintf(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>, <span class="stringliteral">&quot;Found %zu items\n&quot;</span>, n_items);</div>
<div class="line"><span class="lineno">  119</span>      }</div>
<div class="line"><span class="lineno">  120</span> </div>
<div class="line"><span class="lineno">  121</span>      <span class="keywordflow">for</span> (<a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> i = 0; i &lt; n_items; i++) {</div>
<div class="line"><span class="lineno">  122</span>        <a class="code hl_function" href="util_8c.html#a99b40ed1e5df4e0e59f93585ea38b7c4">format_digest</a>(logs[i].digest, digest_buf, <a class="code hl_define" href="yubihsm_8h.html#a289ca46f5ef481980f0fad98d727e87a">YH_LOG_DIGEST_SIZE</a>);</div>
<div class="line"><span class="lineno">  123</span>        fprintf(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>,</div>
<div class="line"><span class="lineno">  124</span>                <span class="stringliteral">&quot;item: %5u -- cmd: 0x%02x -- length: %4u -- session key: &quot;</span></div>
<div class="line"><span class="lineno">  125</span>                <span class="stringliteral">&quot;0x%04x -- target key: 0x%04x -- second key: 0x%04x -- &quot;</span></div>
<div class="line"><span class="lineno">  126</span>                <span class="stringliteral">&quot;result: 0x%02x -- tick: %lu -- hash: %s\n&quot;</span>,</div>
<div class="line"><span class="lineno">  127</span>                logs[i].number, logs[i].command, logs[i].length,</div>
<div class="line"><span class="lineno">  128</span>                logs[i].session_key, logs[i].target_key, logs[i].second_key,</div>
<div class="line"><span class="lineno">  129</span>                logs[i].result, (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>) logs[i].systick, digest_buf);</div>
<div class="line"><span class="lineno">  130</span>      }</div>
<div class="line"><span class="lineno">  131</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  132</span>  }</div>
<div class="line"><span class="lineno">  133</span> </div>
<div class="line"><span class="lineno">  134</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  135</span>}</div>
<div class="ttc" id="ahello__driver_8cpp_html_af2efa898e9eed6fe6715279cb1ec35b0"><div class="ttname"><a href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a></div><div class="ttdeci">char ** argv</div><div class="ttdef"><b>Definition</b> <a href="hello__driver_8cpp_source.html#l00052">hello_driver.cpp:52</a></div></div>
<div class="ttc" id="alib_2error_8c_html_a238eedb1e27dbff2a0ab9a3932eb3f8b"><div class="ttname"><a href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a></div><div class="ttdeci">const char * yh_strerror(yh_rc err)</div><div class="ttdef"><b>Definition</b> <a href="lib_2error_8c_source.html#l00065">error.c:65</a></div></div>
<div class="ttc" id="astdint_8h_html_a273cf69d639a59973b6019625df33e30"><div class="ttname"><a href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a></div><div class="ttdeci">unsigned short uint16_t</div><div class="ttdef"><b>Definition</b> <a href="stdint_8h_source.html#l00125">stdint.h:125</a></div></div>
<div class="ttc" id="astructyh__log__entry_html"><div class="ttname"><a href="structyh__log__entry.html">yh_log_entry</a></div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00516">yubihsm.h:516</a></div></div>
<div class="ttc" id="astructyubihsm__context_html_a29e0cb7941d3bd7580d8e23c6e18e67d"><div class="ttname"><a href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">yubihsm_context::out</a></div><div class="ttdeci">FILE * out</div><div class="ttdef"><b>Definition</b> <a href="yubihsm-shell_8h_source.html#l00052">yubihsm-shell.h:52</a></div></div>
<div class="ttc" id="astructyubihsm__context_html_addfaa9a6a08f58bdb5b5a93f2e89ccc2"><div class="ttname"><a href="structyubihsm__context.html#addfaa9a6a08f58bdb5b5a93f2e89ccc2">yubihsm_context::out_fmt</a></div><div class="ttdeci">cmd_format out_fmt</div><div class="ttdef"><b>Definition</b> <a href="yubihsm-shell_8h_source.html#l00054">yubihsm-shell.h:54</a></div></div>
<div class="ttc" id="autil_8c_html_a99b40ed1e5df4e0e59f93585ea38b7c4"><div class="ttname"><a href="util_8c.html#a99b40ed1e5df4e0e59f93585ea38b7c4">format_digest</a></div><div class="ttdeci">void format_digest(uint8_t *digest, char *str, uint16_t len)</div><div class="ttdef"><b>Definition</b> <a href="util_8c_source.html#l00326">util.c:326</a></div></div>
<div class="ttc" id="ayubihsm-shell_8h_html_a78db5959e08d52cc64e7032bf1b1e708a4fff5e64ffe63c6c03b00438c0b09282"><div class="ttname"><a href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708a4fff5e64ffe63c6c03b00438c0b09282">fmt_ASCII</a></div><div class="ttdeci">@ fmt_ASCII</div><div class="ttdef"><b>Definition</b> <a href="yubihsm-shell_8h_source.html#l00036">yubihsm-shell.h:35</a></div></div>
<div class="ttc" id="ayubihsm-shell_8h_html_a78db5959e08d52cc64e7032bf1b1e708a701725c70fb214e14a2feee390939a09"><div class="ttname"><a href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708a701725c70fb214e14a2feee390939a09">fmt_binary</a></div><div class="ttdeci">@ fmt_binary</div><div class="ttdef"><b>Definition</b> <a href="yubihsm-shell_8h_source.html#l00031">yubihsm-shell.h:31</a></div></div>
<div class="ttc" id="ayubihsm-shell_8h_html_a78db5959e08d52cc64e7032bf1b1e708aa8908f2c651567ae288c587240e71d3e"><div class="ttname"><a href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708aa8908f2c651567ae288c587240e71d3e">fmt_PEM</a></div><div class="ttdeci">@ fmt_PEM</div><div class="ttdef"><b>Definition</b> <a href="yubihsm-shell_8h_source.html#l00033">yubihsm-shell.h:33</a></div></div>
<div class="ttc" id="ayubihsm-shell_8h_html_a78db5959e08d52cc64e7032bf1b1e708acce29e9764c448874d69cb6c90b02401"><div class="ttname"><a href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708acce29e9764c448874d69cb6c90b02401">fmt_hex</a></div><div class="ttdeci">@ fmt_hex</div><div class="ttdef"><b>Definition</b> <a href="yubihsm-shell_8h_source.html#l00032">yubihsm-shell.h:32</a></div></div>
<div class="ttc" id="ayubihsm-shell_8h_html_a78db5959e08d52cc64e7032bf1b1e708ad58942468b13601c21c14f2269dbca57"><div class="ttname"><a href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708ad58942468b13601c21c14f2269dbca57">fmt_password</a></div><div class="ttdeci">@ fmt_password</div><div class="ttdef"><b>Definition</b> <a href="yubihsm-shell_8h_source.html#l00034">yubihsm-shell.h:34</a></div></div>
<div class="ttc" id="ayubihsm-shell_8h_html_a78db5959e08d52cc64e7032bf1b1e708add674d756d2c6341a834a330a874b550"><div class="ttname"><a href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708add674d756d2c6341a834a330a874b550">fmt_base64</a></div><div class="ttdeci">@ fmt_base64</div><div class="ttdef"><b>Definition</b> <a href="yubihsm-shell_8h_source.html#l00030">yubihsm-shell.h:30</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_a5ae52ad56b7e83baeb33b46104263aa6"><div class="ttname"><a href="yubihsm_8c.html#a5ae52ad56b7e83baeb33b46104263aa6">yh_util_get_log_entries</a></div><div class="ttdeci">yh_rc yh_util_get_log_entries(yh_session *session, uint16_t *unlogged_boot, uint16_t *unlogged_auth, yh_log_entry *out, size_t *n_items)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l02531">yubihsm.c:2531</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a289ca46f5ef481980f0fad98d727e87a"><div class="ttname"><a href="yubihsm_8h.html#a289ca46f5ef481980f0fad98d727e87a">YH_LOG_DIGEST_SIZE</a></div><div class="ttdeci">#define YH_LOG_DIGEST_SIZE</div><div class="ttdoc">Size that the log digest is truncated to.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00127">yubihsm.h:127</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_ae10a65a4b5dfaac7c3d64c1ec7b99e82"><div class="ttname"><a href="yubihsm_8h.html#ae10a65a4b5dfaac7c3d64c1ec7b99e82">YH_MAX_LOG_ENTRIES</a></div><div class="ttdeci">#define YH_MAX_LOG_ENTRIES</div><div class="ttdoc">Max log entries the device may hold.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00121">yubihsm.h:121</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_ae4f602d2343d01b1727dfd633169d366"><div class="ttname"><a href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a></div><div class="ttdeci">yh_rc</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00170">yubihsm.h:170</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815"><div class="ttname"><a href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a></div><div class="ttdeci">@ YHR_SUCCESS</div><div class="ttdoc">Returned value when function was successful.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00172">yubihsm.h:172</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a86d500a34c624c2cae56bc25a31b12f3"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a></div><div class="ttdeci">#define UNUSED(x)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l00046">yubihsm_pkcs11.c:46</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a9c8d6a4a7a87f74f070e816dca1a547b"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a></div><div class="ttdeci">yh_rc yrc</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l00606">yubihsm_pkcs11.c:606</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_a3c600843ccdac7af506983bc67cb0bc3_cgraph.png" border="0" usemap="#acommands_8c_a3c600843ccdac7af506983bc67cb0bc3_cgraph" alt=""/></div>
<map name="acommands_8c_a3c600843ccdac7af506983bc67cb0bc3_cgraph" id="acommands_8c_a3c600843ccdac7af506983bc67cb0bc3_cgraph">
<area shape="rect" title=" " alt="" coords="5,56,108,82"/>
<area shape="rect" href="util_8c.html#a99b40ed1e5df4e0e59f93585ea38b7c4" title=" " alt="" coords="183,5,283,31"/>
<area shape="poly" title=" " alt="" coords="103,53,171,33,172,38,105,58"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="778,108,861,134"/>
<area shape="poly" title=" " alt="" coords="108,69,370,83,720,108,762,112,762,117,719,113,370,88,108,74"/>
<area shape="rect" href="yubihsm_8c.html#a5ae52ad56b7e83baeb33b46104263aa6" title=" " alt="" coords="156,132,310,158"/>
<area shape="poly" title=" " alt="" coords="90,80,188,123,186,128,87,85"/>
<area shape="poly" title=" " alt="" coords="310,139,762,120,762,126,311,144"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="784,207,855,232"/>
<area shape="poly" title=" " alt="" coords="265,156,359,193,458,225,537,244,617,250,719,242,769,232,770,237,720,247,617,256,536,249,456,230,357,198,263,161"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="358,157,506,183"/>
<area shape="poly" title=" " alt="" coords="311,152,343,156,342,161,310,157"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="554,157,720,183"/>
<area shape="poly" title=" " alt="" coords="506,168,539,168,539,173,506,173"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="572,207,702,232"/>
<area shape="poly" title=" " alt="" coords="489,181,566,200,565,205,488,186"/>
<area shape="poly" title=" " alt="" coords="687,154,762,133,763,139,688,159"/>
<area shape="poly" title=" " alt="" coords="688,181,769,203,768,209,687,186"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="785,157,854,183"/>
<area shape="poly" title=" " alt="" coords="720,168,770,168,770,173,720,173"/>
<area shape="poly" title=" " alt="" coords="697,204,718,193,733,181,742,169,751,156,766,143,771,139,774,144,769,147,755,160,746,173,737,185,721,198,699,208"/>
<area shape="poly" title=" " alt="" coords="703,217,769,217,769,222,703,222"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="768,256,871,282"/>
<area shape="poly" title=" " alt="" coords="688,230,755,249,753,254,687,236"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_a3c600843ccdac7af506983bc67cb0bc3_icgraph.png" border="0" usemap="#acommands_8c_a3c600843ccdac7af506983bc67cb0bc3_icgraph" alt=""/></div>
<map name="acommands_8c_a3c600843ccdac7af506983bc67cb0bc3_icgraph" id="acommands_8c_a3c600843ccdac7af506983bc67cb0bc3_icgraph">
<area shape="rect" title=" " alt="" coords="296,31,398,56"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="280,36,248,32,249,26,281,31"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,31,55,56"/>
<area shape="poly" title=" " alt="" coords="280,46,55,46,55,41,280,41"/>
<area shape="poly" title=" " alt="" coords="88,36,55,42,54,37,87,31"/>
</map>
</div>

</div>
</div>
<a id="ae2e50929acc6085cd395d0bd4ddb02db" name="ae2e50929acc6085cd395d0bd4ddb02db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae2e50929acc6085cd395d0bd4ddb02db">&#9670;&#160;</a></span>yh_com_benchmark()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int yh_com_benchmark </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__context.html">yubihsm_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_argument.html">Argument</a> *</td>          <td class="paramname"><span class="paramname"><em>argv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a></td>          <td class="paramname"><span class="paramname"><em>fmt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="commands_8c_source.html#l02111">2111</a> of file <a class="el" href="commands_8c_source.html">commands.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2111</span>                                                                           {</div>
<div class="line"><span class="lineno"> 2112</span> </div>
<div class="line"><span class="lineno"> 2113</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ctx);</div>
<div class="line"><span class="lineno"> 2114</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(fmt);</div>
<div class="line"><span class="lineno"> 2115</span> </div>
<div class="line"><span class="lineno"> 2116</span>  <span class="keyword">struct </span>{</div>
<div class="line"><span class="lineno"> 2117</span>    <a class="code hl_enumeration" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55ca">yh_algorithm</a> algo;</div>
<div class="line"><span class="lineno"> 2118</span>    <a class="code hl_enumeration" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55ca">yh_algorithm</a> algo2;</div>
<div class="line"><span class="lineno"> 2119</span>    <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#ac6f5a1f1e061f000983f5d5f3ac25dfa">bytes</a>;</div>
<div class="line"><span class="lineno"> 2120</span>    <span class="keyword">const</span> <span class="keywordtype">char</span> *special;</div>
<div class="line"><span class="lineno"> 2121</span>  } benchmarks[] = {</div>
<div class="line"><span class="lineno"> 2122</span>    {<a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caaafe94e6a770edb51c6db84f77d98d2c6">YH_ALGO_RSA_2048</a>, <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa18e17370fcf9a829572e57608aff743c">YH_ALGO_RSA_PKCS1_SHA256</a>, 32, <span class="stringliteral">&quot;&quot;</span>},</div>
<div class="line"><span class="lineno"> 2123</span>    {<a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caafd3fbd9ed86caf267ccc77cb24d44426">YH_ALGO_RSA_3072</a>, <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caafc78c2f62fe0a185c38d2644755fde2c">YH_ALGO_RSA_PKCS1_SHA384</a>, 48, <span class="stringliteral">&quot;&quot;</span>},</div>
<div class="line"><span class="lineno"> 2124</span>    {<a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caae5963322a0a0f43a1b74faa78e3a7329">YH_ALGO_RSA_4096</a>, <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa84e18ba6561d5a834dc8d794504708db">YH_ALGO_RSA_PKCS1_SHA512</a>, 64, <span class="stringliteral">&quot;&quot;</span>},</div>
<div class="line"><span class="lineno"> 2125</span>    {<a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caaafe94e6a770edb51c6db84f77d98d2c6">YH_ALGO_RSA_2048</a>, <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caac42381f876f5e7190547cf81021451f5">YH_ALGO_RSA_PSS_SHA256</a>, 32, <span class="stringliteral">&quot;&quot;</span>},</div>
<div class="line"><span class="lineno"> 2126</span>    {<a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caafd3fbd9ed86caf267ccc77cb24d44426">YH_ALGO_RSA_3072</a>, <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa144083d6414cb33e8543d51e7d361d05">YH_ALGO_RSA_PSS_SHA384</a>, 48, <span class="stringliteral">&quot;&quot;</span>},</div>
<div class="line"><span class="lineno"> 2127</span>    {<a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caae5963322a0a0f43a1b74faa78e3a7329">YH_ALGO_RSA_4096</a>, <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa1d5a50a1a53000cd2b2989c17703e2d1">YH_ALGO_RSA_PSS_SHA512</a>, 64, <span class="stringliteral">&quot;&quot;</span>},</div>
<div class="line"><span class="lineno"> 2128</span>    {<a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caaedcbc07d82b18ca5c21eb3379a6cc010">YH_ALGO_EC_P224</a>, <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caae9b7b5598c3839a53e4986dc901be244">YH_ALGO_EC_ECDSA_SHA1</a>, 20, <span class="stringliteral">&quot;&quot;</span>},</div>
<div class="line"><span class="lineno"> 2129</span>    {<a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caae4b191baf5c65f9234120080264d129b">YH_ALGO_EC_P256</a>, <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa2e5dfe9c79cb0d391d7bf952227268ec">YH_ALGO_EC_ECDSA_SHA256</a>, 32, <span class="stringliteral">&quot;&quot;</span>},</div>
<div class="line"><span class="lineno"> 2130</span>    {<a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa31094c17c66e4c365ca3dad353bc8bda">YH_ALGO_EC_P384</a>, <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa657d2b30d884aeeff3c024404132ad69">YH_ALGO_EC_ECDSA_SHA384</a>, 48, <span class="stringliteral">&quot;&quot;</span>},</div>
<div class="line"><span class="lineno"> 2131</span>    {<a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa05aec903fd67851f968aaa606fe2138a">YH_ALGO_EC_P521</a>, <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa44153987efd3466070143dbab77f2d70">YH_ALGO_EC_ECDSA_SHA512</a>, 66, <span class="stringliteral">&quot;&quot;</span>},</div>
<div class="line"><span class="lineno"> 2132</span>    {<a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caad423056b13955068935dc8b3ac0e65d1">YH_ALGO_EC_K256</a>, <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa2e5dfe9c79cb0d391d7bf952227268ec">YH_ALGO_EC_ECDSA_SHA256</a>, 32, <span class="stringliteral">&quot;&quot;</span>},</div>
<div class="line"><span class="lineno"> 2133</span>    {<a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caabd995726d45b6dd2388775db4767c80d">YH_ALGO_EC_BP256</a>, <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa2e5dfe9c79cb0d391d7bf952227268ec">YH_ALGO_EC_ECDSA_SHA256</a>, 32, <span class="stringliteral">&quot;&quot;</span>},</div>
<div class="line"><span class="lineno"> 2134</span>    {<a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa228fd3332b55c60438dfea6a1b09af36">YH_ALGO_EC_BP384</a>, <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa657d2b30d884aeeff3c024404132ad69">YH_ALGO_EC_ECDSA_SHA384</a>, 48, <span class="stringliteral">&quot;&quot;</span>},</div>
<div class="line"><span class="lineno"> 2135</span>    {<a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caab9c1be17b7b3f755346ff8c3cca3ed25">YH_ALGO_EC_BP512</a>, <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa44153987efd3466070143dbab77f2d70">YH_ALGO_EC_ECDSA_SHA512</a>, 64, <span class="stringliteral">&quot;&quot;</span>},</div>
<div class="line"><span class="lineno"> 2136</span>    {<a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caaedcbc07d82b18ca5c21eb3379a6cc010">YH_ALGO_EC_P224</a>, <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa14b36e4ff3b90d44ace0aa2b2c65ef48">YH_ALGO_EC_ECDH</a>, 56, <span class="stringliteral">&quot;&quot;</span>},</div>
<div class="line"><span class="lineno"> 2137</span>    {<a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caae4b191baf5c65f9234120080264d129b">YH_ALGO_EC_P256</a>, <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa14b36e4ff3b90d44ace0aa2b2c65ef48">YH_ALGO_EC_ECDH</a>, 64, <span class="stringliteral">&quot;&quot;</span>},</div>
<div class="line"><span class="lineno"> 2138</span>    {<a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa31094c17c66e4c365ca3dad353bc8bda">YH_ALGO_EC_P384</a>, <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa14b36e4ff3b90d44ace0aa2b2c65ef48">YH_ALGO_EC_ECDH</a>, 96, <span class="stringliteral">&quot;&quot;</span>},</div>
<div class="line"><span class="lineno"> 2139</span>    {<a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa05aec903fd67851f968aaa606fe2138a">YH_ALGO_EC_P521</a>, <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa14b36e4ff3b90d44ace0aa2b2c65ef48">YH_ALGO_EC_ECDH</a>, 132, <span class="stringliteral">&quot;&quot;</span>},</div>
<div class="line"><span class="lineno"> 2140</span>    {<a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caad423056b13955068935dc8b3ac0e65d1">YH_ALGO_EC_K256</a>, <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa14b36e4ff3b90d44ace0aa2b2c65ef48">YH_ALGO_EC_ECDH</a>, 64, <span class="stringliteral">&quot;&quot;</span>},</div>
<div class="line"><span class="lineno"> 2141</span>    {<a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caabd995726d45b6dd2388775db4767c80d">YH_ALGO_EC_BP256</a>, <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa14b36e4ff3b90d44ace0aa2b2c65ef48">YH_ALGO_EC_ECDH</a>, 64, <span class="stringliteral">&quot;&quot;</span>},</div>
<div class="line"><span class="lineno"> 2142</span>    {<a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa228fd3332b55c60438dfea6a1b09af36">YH_ALGO_EC_BP384</a>, <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa14b36e4ff3b90d44ace0aa2b2c65ef48">YH_ALGO_EC_ECDH</a>, 96, <span class="stringliteral">&quot;&quot;</span>},</div>
<div class="line"><span class="lineno"> 2143</span>    {<a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caab9c1be17b7b3f755346ff8c3cca3ed25">YH_ALGO_EC_BP512</a>, <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa14b36e4ff3b90d44ace0aa2b2c65ef48">YH_ALGO_EC_ECDH</a>, 128, <span class="stringliteral">&quot;&quot;</span>},</div>
<div class="line"><span class="lineno"> 2144</span>    {<a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa68c2c97f16c36f727e41a899d8a7e8bd">YH_ALGO_EC_ED25519</a>, 0, 32, <span class="stringliteral">&quot;32 bytes data&quot;</span>},</div>
<div class="line"><span class="lineno"> 2145</span>    {<a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa68c2c97f16c36f727e41a899d8a7e8bd">YH_ALGO_EC_ED25519</a>, 0, 64, <span class="stringliteral">&quot;64 bytes data&quot;</span>},</div>
<div class="line"><span class="lineno"> 2146</span>    {<a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa68c2c97f16c36f727e41a899d8a7e8bd">YH_ALGO_EC_ED25519</a>, 0, 128, <span class="stringliteral">&quot;128 bytes data&quot;</span>},</div>
<div class="line"><span class="lineno"> 2147</span>    {<a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa68c2c97f16c36f727e41a899d8a7e8bd">YH_ALGO_EC_ED25519</a>, 0, 256, <span class="stringliteral">&quot;256 bytes data&quot;</span>},</div>
<div class="line"><span class="lineno"> 2148</span>    {<a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa68c2c97f16c36f727e41a899d8a7e8bd">YH_ALGO_EC_ED25519</a>, 0, 512, <span class="stringliteral">&quot;512 bytes data&quot;</span>},</div>
<div class="line"><span class="lineno"> 2149</span>    {<a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa68c2c97f16c36f727e41a899d8a7e8bd">YH_ALGO_EC_ED25519</a>, 0, 1024, <span class="stringliteral">&quot;1024 bytes data&quot;</span>},</div>
<div class="line"><span class="lineno"> 2150</span>    {<a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa942e65c8cd0034eebe9a20c2297c7b06">YH_ALGO_HMAC_SHA1</a>, 0, 64, <span class="stringliteral">&quot;&quot;</span>},</div>
<div class="line"><span class="lineno"> 2151</span>    {<a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caab0a0e1eb424b61057f159f1e53311f5c">YH_ALGO_HMAC_SHA256</a>, 0, 64, <span class="stringliteral">&quot;&quot;</span>},</div>
<div class="line"><span class="lineno"> 2152</span>    {<a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa781e7ca62563917d2129bde8ec53401b">YH_ALGO_HMAC_SHA384</a>, 0, 128, <span class="stringliteral">&quot;&quot;</span>},</div>
<div class="line"><span class="lineno"> 2153</span>    {<a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa72d6c7ea77f10e39bbadc8b58d55b9ec">YH_ALGO_HMAC_SHA512</a>, 0, 128, <span class="stringliteral">&quot;&quot;</span>},</div>
<div class="line"><span class="lineno"> 2154</span>    {<a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caae22b228e457c9bdccb5a93d81730b1b1">YH_ALGO_AES128_CCM_WRAP</a>, 0, 0, <span class="stringliteral">&quot;&quot;</span>},</div>
<div class="line"><span class="lineno"> 2155</span>    {<a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caab739a1d142dacaf37ba13a73e2d83fab">YH_ALGO_AES192_CCM_WRAP</a>, 0, 0, <span class="stringliteral">&quot;&quot;</span>},</div>
<div class="line"><span class="lineno"> 2156</span>    {<a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa927e2246e5657f946b4da4b71092b022">YH_ALGO_AES256_CCM_WRAP</a>, 0, 0, <span class="stringliteral">&quot;&quot;</span>},</div>
<div class="line"><span class="lineno"> 2157</span>    {<a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa62e7ba4126ae16faeafb28972a4e0959">YH_ALGO_AES128_YUBICO_OTP</a>, 0, 0, <span class="stringliteral">&quot;&quot;</span>},</div>
<div class="line"><span class="lineno"> 2158</span>    {<a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa62dd31db747b4b7f81d9e30877a0b720">YH_ALGO_AES192_YUBICO_OTP</a>, 0, 0, <span class="stringliteral">&quot;&quot;</span>},</div>
<div class="line"><span class="lineno"> 2159</span>    {<a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caad1558532867577d1d77c84f1ae632acd">YH_ALGO_AES256_YUBICO_OTP</a>, 0, 0, <span class="stringliteral">&quot;&quot;</span>},</div>
<div class="line"><span class="lineno"> 2160</span>    {0, 0, 8, <span class="stringliteral">&quot;Random 8 bytes&quot;</span>},</div>
<div class="line"><span class="lineno"> 2161</span>    {0, 0, 16, <span class="stringliteral">&quot;Random 16 bytes&quot;</span>},</div>
<div class="line"><span class="lineno"> 2162</span>    {0, 0, 32, <span class="stringliteral">&quot;Random 32 bytes&quot;</span>},</div>
<div class="line"><span class="lineno"> 2163</span>    {0, 0, 64, <span class="stringliteral">&quot;Random 64 bytes&quot;</span>},</div>
<div class="line"><span class="lineno"> 2164</span>    {0, 0, 128, <span class="stringliteral">&quot;Random 128 bytes&quot;</span>},</div>
<div class="line"><span class="lineno"> 2165</span>    {0, 0, 256, <span class="stringliteral">&quot;Random 256 bytes&quot;</span>},</div>
<div class="line"><span class="lineno"> 2166</span>    {0, 0, 512, <span class="stringliteral">&quot;Random 512 bytes&quot;</span>},</div>
<div class="line"><span class="lineno"> 2167</span>    {0, 0, 1024, <span class="stringliteral">&quot;Random 1024 bytes&quot;</span>},</div>
<div class="line"><span class="lineno"> 2168</span>    {<a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa461952ba18e7fcd792e480f71c853513">YH_ALGO_AES128_YUBICO_AUTHENTICATION</a>, 0, 0, <span class="stringliteral">&quot;&quot;</span>},</div>
<div class="line"><span class="lineno"> 2169</span>  };</div>
<div class="line"><span class="lineno"> 2170</span> </div>
<div class="line"><span class="lineno"> 2171</span>  <span class="comment">// this is some data for the OTP benchmark</span></div>
<div class="line"><span class="lineno"> 2172</span>  <span class="keyword">const</span> <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubico__otp_8c.html#a485b73836b7b661b3333a70b309ffba6">otp_key</a>[] =</div>
<div class="line"><span class="lineno"> 2173</span>    <span class="stringliteral">&quot;\x00\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0a\x0b\x0c\x0d\x0e\x0f&quot;</span>;</div>
<div class="line"><span class="lineno"> 2174</span>  <span class="keyword">const</span> <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> otp_id[] = <span class="stringliteral">&quot;\x01\x02\x03\x04\x05\x06&quot;</span>;</div>
<div class="line"><span class="lineno"> 2175</span>  <span class="keyword">const</span> <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubico__otp_8c.html#ab1e1d61db8c48d537faca71988a7c123">otp</a>[] =</div>
<div class="line"><span class="lineno"> 2176</span>    <span class="stringliteral">&quot;\x2f\x5d\x71\xa4\x91\x5d\xec\x30\x4a\xa1\x3c\xcf\x97\xbb\x0d\xbb&quot;</span>;</div>
<div class="line"><span class="lineno"> 2177</span>  <span class="keyword">const</span> <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> password[] = <span class="stringliteral">&quot;benchmark&quot;</span>;</div>
<div class="line"><span class="lineno"> 2178</span> </div>
<div class="line"><span class="lineno"> 2179</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].d == 0) {</div>
<div class="line"><span class="lineno"> 2180</span>    fprintf(stderr, <span class="stringliteral">&quot;Benchmark with 0 rounds seems pointless\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 2181</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 2182</span>  }</div>
<div class="line"><span class="lineno"> 2183</span> </div>
<div class="line"><span class="lineno"> 2184</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <span class="keyword">sizeof</span>(benchmarks) / <span class="keyword">sizeof</span>(benchmarks[0]); i++) {</div>
<div class="line"><span class="lineno"> 2185</span>    <span class="keyword">struct </span>timeval total = {0, 0};</div>
<div class="line"><span class="lineno"> 2186</span>    <span class="keyword">struct </span>timeval avg = {0, 0};</div>
<div class="line"><span class="lineno"> 2187</span>    <span class="keyword">struct </span>timeval max = {0, 0};</div>
<div class="line"><span class="lineno"> 2188</span>    <span class="keyword">struct </span>timeval <a class="code hl_function" href="namespacefc.html#aa3ea11c18de71ec23b19c3cc571fb8ff">min</a>;</div>
<div class="line"><span class="lineno"> 2189</span>    <a class="code hl_struct" href="structyh__capabilities.html">yh_capabilities</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a> = {{0}};</div>
<div class="line"><span class="lineno"> 2190</span>    <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 2191</span>    <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> algo_data[1024];</div>
<div class="line"><span class="lineno"> 2192</span>    <span class="keywordtype">size_t</span> algo_len = <span class="keyword">sizeof</span>(algo_data);</div>
<div class="line"><span class="lineno"> 2193</span>    <span class="keyword">const</span> <span class="keywordtype">char</span> *str1 = NULL, *str2 = <span class="stringliteral">&quot;&quot;</span>, *str3 = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><span class="lineno"> 2194</span>    <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <span class="keywordtype">id</span> = <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[2].w;</div>
<div class="line"><span class="lineno"> 2195</span>    <span class="keywordtype">char</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>[<a class="code hl_define" href="yubihsm_8h.html#a431f8b753552a8b2f5f980e871b6d019">YH_OBJ_LABEL_LEN</a> + 1] = {0};</div>
<div class="line"><span class="lineno"> 2196</span>    <a class="code hl_enumeration" href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583">yh_object_type</a> type = 0;</div>
<div class="line"><span class="lineno"> 2197</span><span class="preprocessor">#ifndef _WIN32</span></div>
<div class="line"><span class="lineno"> 2198</span>    <span class="keywordtype">size_t</span> chars = 0;</div>
<div class="line"><span class="lineno"> 2199</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2200</span> </div>
<div class="line"><span class="lineno"> 2201</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[3].<a class="code hl_variable" href="pointer_8h.html#aeeddce917cf130d62c370b8f216026dd">a</a> != 0) {</div>
<div class="line"><span class="lineno"> 2202</span>      <span class="keywordflow">if</span> (<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[3].<a class="code hl_variable" href="pointer_8h.html#aeeddce917cf130d62c370b8f216026dd">a</a> != benchmarks[i].algo &amp;&amp; <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[3].<a class="code hl_variable" href="pointer_8h.html#aeeddce917cf130d62c370b8f216026dd">a</a> != benchmarks[i].algo2) {</div>
<div class="line"><span class="lineno"> 2203</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 2204</span>      }</div>
<div class="line"><span class="lineno"> 2205</span>    }</div>
<div class="line"><span class="lineno"> 2206</span>    <span class="keywordflow">if</span> (benchmarks[i].algo) {</div>
<div class="line"><span class="lineno"> 2207</span>      <a class="code hl_function" href="yubihsm_8c.html#a2a0d369611aa795c62645467062a9acb">yh_algo_to_string</a>(benchmarks[i].algo, &amp;str1);</div>
<div class="line"><span class="lineno"> 2208</span>    }</div>
<div class="line"><span class="lineno"> 2209</span>    <span class="keywordflow">if</span> (benchmarks[i].algo2) {</div>
<div class="line"><span class="lineno"> 2210</span>      str2 = <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><span class="lineno"> 2211</span>      <a class="code hl_function" href="yubihsm_8c.html#a2a0d369611aa795c62645467062a9acb">yh_algo_to_string</a>(benchmarks[i].algo2, &amp;str3);</div>
<div class="line"><span class="lineno"> 2212</span>    }</div>
<div class="line"><span class="lineno"> 2213</span>    <span class="keywordflow">if</span> (str1) {</div>
<div class="line"><span class="lineno"> 2214</span>      snprintf(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>, <a class="code hl_define" href="yubihsm_8h.html#a431f8b753552a8b2f5f980e871b6d019">YH_OBJ_LABEL_LEN</a>, <span class="stringliteral">&quot;Benchmark: %s%s%s&quot;</span>, str1, str2, str3);</div>
<div class="line"><span class="lineno"> 2215</span>    }</div>
<div class="line"><span class="lineno"> 2216</span> </div>
<div class="line"><span class="lineno"> 2217</span>    <span class="keywordflow">if</span> (str1) {</div>
<div class="line"><span class="lineno"> 2218</span><span class="preprocessor">#ifndef _WIN32</span></div>
<div class="line"><span class="lineno"> 2219</span>      chars =</div>
<div class="line"><span class="lineno"> 2220</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2221</span>        fprintf(stderr, <span class="stringliteral">&quot;Doing benchmark setup for %s%s%s...&quot;</span>, str1, str2,</div>
<div class="line"><span class="lineno"> 2222</span>                str3);</div>
<div class="line"><span class="lineno"> 2223</span>    }</div>
<div class="line"><span class="lineno"> 2224</span> </div>
<div class="line"><span class="lineno"> 2225</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="yubihsm_8c.html#a0a67155f2a7970ecb52e4f6aac6bbe84">yh_is_rsa</a>(benchmarks[i].algo)) {</div>
<div class="line"><span class="lineno"> 2226</span>      <span class="keywordflow">if</span> (benchmarks[i].algo2 == <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa18e17370fcf9a829572e57608aff743c">YH_ALGO_RSA_PKCS1_SHA256</a> ||</div>
<div class="line"><span class="lineno"> 2227</span>          benchmarks[i].algo2 == <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caafc78c2f62fe0a185c38d2644755fde2c">YH_ALGO_RSA_PKCS1_SHA384</a> ||</div>
<div class="line"><span class="lineno"> 2228</span>          benchmarks[i].algo2 == <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa84e18ba6561d5a834dc8d794504708db">YH_ALGO_RSA_PKCS1_SHA512</a>) {</div>
<div class="line"><span class="lineno"> 2229</span>        <a class="code hl_function" href="yubihsm_8c.html#aab440e1cb671d9ba7a2e7d1243960e42">yh_string_to_capabilities</a>(<span class="stringliteral">&quot;sign-pkcs&quot;</span>, &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>);</div>
<div class="line"><span class="lineno"> 2230</span>      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (benchmarks[i].algo2 == <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caac42381f876f5e7190547cf81021451f5">YH_ALGO_RSA_PSS_SHA256</a> ||</div>
<div class="line"><span class="lineno"> 2231</span>                 benchmarks[i].algo2 == <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa144083d6414cb33e8543d51e7d361d05">YH_ALGO_RSA_PSS_SHA384</a> ||</div>
<div class="line"><span class="lineno"> 2232</span>                 benchmarks[i].algo2 == <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa1d5a50a1a53000cd2b2989c17703e2d1">YH_ALGO_RSA_PSS_SHA512</a>) {</div>
<div class="line"><span class="lineno"> 2233</span>        <a class="code hl_function" href="yubihsm_8c.html#aab440e1cb671d9ba7a2e7d1243960e42">yh_string_to_capabilities</a>(<span class="stringliteral">&quot;sign-pss&quot;</span>, &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>);</div>
<div class="line"><span class="lineno"> 2234</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2235</span>        fprintf(stderr, <span class="stringliteral">&quot;Unknown benchmark algorithms\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 2236</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 2237</span>      }</div>
<div class="line"><span class="lineno"> 2238</span>      type = <a class="code hl_enumvalue" href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583ab71424e16384319d6e6a12f9a3d8ceae">YH_ASYMMETRIC_KEY</a>;</div>
<div class="line"><span class="lineno"> 2239</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#ab1c62ef2643184a8ad44c569c87712d1">yh_util_generate_rsa_key</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e, &amp;<span class="keywordtype">id</span>, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>, 0xffff,</div>
<div class="line"><span class="lineno"> 2240</span>                                     &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>, benchmarks[i].algo);</div>
<div class="line"><span class="lineno"> 2241</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="yubihsm_8c.html#a3032a8f45bfad36ed6157b0158dd7921">yh_is_ec</a>(benchmarks[i].algo)) {</div>
<div class="line"><span class="lineno"> 2242</span>      <span class="keywordflow">if</span> (benchmarks[i].algo2 == <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caae9b7b5598c3839a53e4986dc901be244">YH_ALGO_EC_ECDSA_SHA1</a> ||</div>
<div class="line"><span class="lineno"> 2243</span>          benchmarks[i].algo2 == <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa2e5dfe9c79cb0d391d7bf952227268ec">YH_ALGO_EC_ECDSA_SHA256</a> ||</div>
<div class="line"><span class="lineno"> 2244</span>          benchmarks[i].algo2 == <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa657d2b30d884aeeff3c024404132ad69">YH_ALGO_EC_ECDSA_SHA384</a> ||</div>
<div class="line"><span class="lineno"> 2245</span>          benchmarks[i].algo2 == <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa44153987efd3466070143dbab77f2d70">YH_ALGO_EC_ECDSA_SHA512</a>) {</div>
<div class="line"><span class="lineno"> 2246</span>        <a class="code hl_function" href="yubihsm_8c.html#aab440e1cb671d9ba7a2e7d1243960e42">yh_string_to_capabilities</a>(<span class="stringliteral">&quot;sign-ecdsa&quot;</span>, &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>);</div>
<div class="line"><span class="lineno"> 2247</span>      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (benchmarks[i].algo2 == <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa14b36e4ff3b90d44ace0aa2b2c65ef48">YH_ALGO_EC_ECDH</a>) {</div>
<div class="line"><span class="lineno"> 2248</span>        <a class="code hl_function" href="yubihsm_8c.html#aab440e1cb671d9ba7a2e7d1243960e42">yh_string_to_capabilities</a>(<span class="stringliteral">&quot;derive-ecdh&quot;</span>, &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>);</div>
<div class="line"><span class="lineno"> 2249</span>        <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#a2db9bbd57a908c5c454fc6254f57dcff">yh_util_generate_ec_key</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e, &amp;<span class="keywordtype">id</span>, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>, 0xffff,</div>
<div class="line"><span class="lineno"> 2250</span>                                      &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>, benchmarks[i].algo);</div>
<div class="line"><span class="lineno"> 2251</span> </div>
<div class="line"><span class="lineno"> 2252</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 2253</span>          fprintf(stderr, <span class="stringliteral">&quot;Failed ECDH setup\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 2254</span>          <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 2255</span>        }</div>
<div class="line"><span class="lineno"> 2256</span>        algo_len--;</div>
<div class="line"><span class="lineno"> 2257</span>        <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> =</div>
<div class="line"><span class="lineno"> 2258</span>          <a class="code hl_function" href="yubihsm_8c.html#aa7b8b42156c4bdaf41d8b9758a2fd73f">yh_util_get_public_key</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e, <span class="keywordtype">id</span>, algo_data + 1, &amp;algo_len, NULL);</div>
<div class="line"><span class="lineno"> 2259</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a> || algo_len != benchmarks[i].bytes) {</div>
<div class="line"><span class="lineno"> 2260</span>          fprintf(stderr, <span class="stringliteral">&quot;Failed to get ECDH pubkey (%zu)\n&quot;</span>, algo_len);</div>
<div class="line"><span class="lineno"> 2261</span>          <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 2262</span>        }</div>
<div class="line"><span class="lineno"> 2263</span>        algo_data[0] = 0x04; <span class="comment">// this is a hack to make it look correct..</span></div>
<div class="line"><span class="lineno"> 2264</span>        algo_len++;</div>
<div class="line"><span class="lineno"> 2265</span>        <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#ae736702f9463878db4adfd45b6a597f9">yh_util_delete_object</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e, <span class="keywordtype">id</span>, <a class="code hl_enumvalue" href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583ab71424e16384319d6e6a12f9a3d8ceae">YH_ASYMMETRIC_KEY</a>);</div>
<div class="line"><span class="lineno"> 2266</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 2267</span>          fprintf(stderr, <span class="stringliteral">&quot;Failed deleting temporary ec key\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 2268</span>          <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 2269</span>        }</div>
<div class="line"><span class="lineno"> 2270</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2271</span>        fprintf(stderr, <span class="stringliteral">&quot;Unknown benchmark algorithms\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 2272</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 2273</span>      }</div>
<div class="line"><span class="lineno"> 2274</span>      type = <a class="code hl_enumvalue" href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583ab71424e16384319d6e6a12f9a3d8ceae">YH_ASYMMETRIC_KEY</a>;</div>
<div class="line"><span class="lineno"> 2275</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#a2db9bbd57a908c5c454fc6254f57dcff">yh_util_generate_ec_key</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e, &amp;<span class="keywordtype">id</span>, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>, 0xffff,</div>
<div class="line"><span class="lineno"> 2276</span>                                    &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>, benchmarks[i].algo);</div>
<div class="line"><span class="lineno"> 2277</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (benchmarks[i].algo == <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa68c2c97f16c36f727e41a899d8a7e8bd">YH_ALGO_EC_ED25519</a>) {</div>
<div class="line"><span class="lineno"> 2278</span>      <a class="code hl_function" href="yubihsm_8c.html#aab440e1cb671d9ba7a2e7d1243960e42">yh_string_to_capabilities</a>(<span class="stringliteral">&quot;sign-eddsa&quot;</span>, &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>);</div>
<div class="line"><span class="lineno"> 2279</span>      type = <a class="code hl_enumvalue" href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583ab71424e16384319d6e6a12f9a3d8ceae">YH_ASYMMETRIC_KEY</a>;</div>
<div class="line"><span class="lineno"> 2280</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#a41f4326fe736e99302442d6a6109edbc">yh_util_generate_ed_key</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e, &amp;<span class="keywordtype">id</span>, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>, 0xffff,</div>
<div class="line"><span class="lineno"> 2281</span>                                    &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>, benchmarks[i].algo);</div>
<div class="line"><span class="lineno"> 2282</span>      str2 = <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><span class="lineno"> 2283</span>      str3 = benchmarks[i].special;</div>
<div class="line"><span class="lineno"> 2284</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="yubihsm_8c.html#acb19de78e7d1aed72abbed5c74c676bc">yh_is_hmac</a>(benchmarks[i].algo)) {</div>
<div class="line"><span class="lineno"> 2285</span>      type = <a class="code hl_enumvalue" href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583a708d85f80fc33743ac26a7c3e43464a9">YH_HMAC_KEY</a>;</div>
<div class="line"><span class="lineno"> 2286</span>      <a class="code hl_function" href="yubihsm_8c.html#aab440e1cb671d9ba7a2e7d1243960e42">yh_string_to_capabilities</a>(<span class="stringliteral">&quot;sign-hmac&quot;</span>, &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>);</div>
<div class="line"><span class="lineno"> 2287</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#a1eac22853548b7ceab92550c22233b18">yh_util_generate_hmac_key</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e, &amp;<span class="keywordtype">id</span>, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>, 0xffff,</div>
<div class="line"><span class="lineno"> 2288</span>                                      &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>, benchmarks[i].algo);</div>
<div class="line"><span class="lineno"> 2289</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (benchmarks[i].algo == <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caae22b228e457c9bdccb5a93d81730b1b1">YH_ALGO_AES128_CCM_WRAP</a> ||</div>
<div class="line"><span class="lineno"> 2290</span>               benchmarks[i].algo == <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caab739a1d142dacaf37ba13a73e2d83fab">YH_ALGO_AES192_CCM_WRAP</a> ||</div>
<div class="line"><span class="lineno"> 2291</span>               benchmarks[i].algo == <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa927e2246e5657f946b4da4b71092b022">YH_ALGO_AES256_CCM_WRAP</a>) {</div>
<div class="line"><span class="lineno"> 2292</span>      type = <a class="code hl_enumvalue" href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583a16f0118db1dac3d0732e7d66630e1dba">YH_WRAP_KEY</a>;</div>
<div class="line"><span class="lineno"> 2293</span>      <a class="code hl_function" href="yubihsm_8c.html#aab440e1cb671d9ba7a2e7d1243960e42">yh_string_to_capabilities</a>(<span class="stringliteral">&quot;export-wrapped,exportable-under-wrap&quot;</span>,</div>
<div class="line"><span class="lineno"> 2294</span>                                &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>);</div>
<div class="line"><span class="lineno"> 2295</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> =</div>
<div class="line"><span class="lineno"> 2296</span>        <a class="code hl_function" href="yubihsm_8c.html#a1f749a696792e7911844629e056d9c15">yh_util_generate_wrap_key</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e, &amp;<span class="keywordtype">id</span>, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>, 0xffff, &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>,</div>
<div class="line"><span class="lineno"> 2297</span>                                  benchmarks[i].algo, &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>);</div>
<div class="line"><span class="lineno"> 2298</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (benchmarks[i].algo == <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa62e7ba4126ae16faeafb28972a4e0959">YH_ALGO_AES128_YUBICO_OTP</a> ||</div>
<div class="line"><span class="lineno"> 2299</span>               benchmarks[i].algo == <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa62dd31db747b4b7f81d9e30877a0b720">YH_ALGO_AES192_YUBICO_OTP</a> ||</div>
<div class="line"><span class="lineno"> 2300</span>               benchmarks[i].algo == <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caad1558532867577d1d77c84f1ae632acd">YH_ALGO_AES256_YUBICO_OTP</a>) {</div>
<div class="line"><span class="lineno"> 2301</span>      type = <a class="code hl_enumvalue" href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583a02c5f683fde147de6a9e1043f971f5f0">YH_OTP_AEAD_KEY</a>;</div>
<div class="line"><span class="lineno"> 2302</span>      <a class="code hl_function" href="yubihsm_8c.html#aab440e1cb671d9ba7a2e7d1243960e42">yh_string_to_capabilities</a>(<span class="stringliteral">&quot;decrypt-otp,create-otp-aead&quot;</span>, &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>);</div>
<div class="line"><span class="lineno"> 2303</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#a9e130d225a8dc003d7a7c0ce4b8ea5e4">yh_util_generate_otp_aead_key</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e, &amp;<span class="keywordtype">id</span>, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>, 0xffff,</div>
<div class="line"><span class="lineno"> 2304</span>                                          &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>, benchmarks[i].algo,</div>
<div class="line"><span class="lineno"> 2305</span>                                          0x12345678);</div>
<div class="line"><span class="lineno"> 2306</span>      <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> == <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 2307</span>        <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#a82d295a02d9eb628f6dea4b4c01fdec4">yh_util_create_otp_aead</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e, <span class="keywordtype">id</span>, <a class="code hl_variable" href="yubico__otp_8c.html#a485b73836b7b661b3333a70b309ffba6">otp_key</a>, otp_id, algo_data,</div>
<div class="line"><span class="lineno"> 2308</span>                                      &amp;algo_len);</div>
<div class="line"><span class="lineno"> 2309</span>      }</div>
<div class="line"><span class="lineno"> 2310</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strncmp(benchmarks[i].special, <span class="stringliteral">&quot;Random &quot;</span>, 7) == 0) {</div>
<div class="line"><span class="lineno"> 2311</span>      str1 = benchmarks[i].special;</div>
<div class="line"><span class="lineno"> 2312</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (benchmarks[i].algo == <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa461952ba18e7fcd792e480f71c853513">YH_ALGO_AES128_YUBICO_AUTHENTICATION</a>) {</div>
<div class="line"><span class="lineno"> 2313</span>      type = <a class="code hl_enumvalue" href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583acee44b775b3c5b6157f0732699935074">YH_AUTHENTICATION_KEY</a>;</div>
<div class="line"><span class="lineno"> 2314</span>      <a class="code hl_function" href="yubihsm_8c.html#aab440e1cb671d9ba7a2e7d1243960e42">yh_string_to_capabilities</a>(<span class="stringliteral">&quot;&quot;</span>, &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>);</div>
<div class="line"><span class="lineno"> 2315</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> =</div>
<div class="line"><span class="lineno"> 2316</span>        <a class="code hl_function" href="yubihsm_8c.html#a80b4c4caeb9c768737c2dbf46d9352e4">yh_util_import_authentication_key_derived</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e, &amp;<span class="keywordtype">id</span>, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>, 0xffff,</div>
<div class="line"><span class="lineno"> 2317</span>                                                  &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>, &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>,</div>
<div class="line"><span class="lineno"> 2318</span>                                                  password, <span class="keyword">sizeof</span>(password));</div>
<div class="line"><span class="lineno"> 2319</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2320</span>      fprintf(stderr, <span class="stringliteral">&quot;Unknown benchmark algorithms\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 2321</span>      <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 2322</span>    }</div>
<div class="line"><span class="lineno"> 2323</span> </div>
<div class="line"><span class="lineno"> 2324</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 2325</span>      fprintf(stderr, <span class="stringliteral">&quot;Failed benchmark setup for %s%s%s\n&quot;</span>, str1, str2, str3);</div>
<div class="line"><span class="lineno"> 2326</span>      <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 2327</span>    }</div>
<div class="line"><span class="lineno"> 2328</span> </div>
<div class="line"><span class="lineno"> 2329</span>    <a class="code hl_function" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105">memset</a>(&amp;min, 0x7f, <span class="keyword">sizeof</span>(min));</div>
<div class="line"><span class="lineno"> 2330</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a538d097420e725c4dad63c3caa9e55bd">j</a> = 0; <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a538d097420e725c4dad63c3caa9e55bd">j</a> &lt; <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].d; <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a538d097420e725c4dad63c3caa9e55bd">j</a>++) {</div>
<div class="line"><span class="lineno"> 2331</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> data[1024];</div>
<div class="line"><span class="lineno"> 2332</span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> out[1024];</div>
<div class="line"><span class="lineno"> 2333</span>      <span class="keywordtype">size_t</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a565e4b6f63fecad4c290b50ee6684ee3">out_len</a> = <span class="keyword">sizeof</span>(out);</div>
<div class="line"><span class="lineno"> 2334</span>      <span class="keyword">struct </span>timeval before, after, result;</div>
<div class="line"><span class="lineno"> 2335</span> </div>
<div class="line"><span class="lineno"> 2336</span>      <a class="code hl_function" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105">memset</a>(data, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a538d097420e725c4dad63c3caa9e55bd">j</a>, <span class="keyword">sizeof</span>(data));</div>
<div class="line"><span class="lineno"> 2337</span>      gettimeofday(&amp;before, NULL);</div>
<div class="line"><span class="lineno"> 2338</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="yubihsm_8c.html#a0a67155f2a7970ecb52e4f6aac6bbe84">yh_is_rsa</a>(benchmarks[i].algo) &amp;&amp;</div>
<div class="line"><span class="lineno"> 2339</span>          (benchmarks[i].algo2 == <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa18e17370fcf9a829572e57608aff743c">YH_ALGO_RSA_PKCS1_SHA256</a> ||</div>
<div class="line"><span class="lineno"> 2340</span>           benchmarks[i].algo2 == <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caafc78c2f62fe0a185c38d2644755fde2c">YH_ALGO_RSA_PKCS1_SHA384</a> ||</div>
<div class="line"><span class="lineno"> 2341</span>           benchmarks[i].algo2 == <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa84e18ba6561d5a834dc8d794504708db">YH_ALGO_RSA_PKCS1_SHA512</a>)) {</div>
<div class="line"><span class="lineno"> 2342</span>        <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#aa0a7644b7b368d6aaf8b4aff5e3d19b8">yh_util_sign_pkcs1v1_5</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e, <span class="keywordtype">id</span>, <span class="keyword">true</span>, data,</div>
<div class="line"><span class="lineno"> 2343</span>                                     benchmarks[i].bytes, out, &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a565e4b6f63fecad4c290b50ee6684ee3">out_len</a>);</div>
<div class="line"><span class="lineno"> 2344</span>      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="yubihsm_8c.html#a0a67155f2a7970ecb52e4f6aac6bbe84">yh_is_rsa</a>(benchmarks[i].algo) &amp;&amp;</div>
<div class="line"><span class="lineno"> 2345</span>                 (benchmarks[i].algo2 == <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caac42381f876f5e7190547cf81021451f5">YH_ALGO_RSA_PSS_SHA256</a> ||</div>
<div class="line"><span class="lineno"> 2346</span>                  benchmarks[i].algo2 == <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa144083d6414cb33e8543d51e7d361d05">YH_ALGO_RSA_PSS_SHA384</a> ||</div>
<div class="line"><span class="lineno"> 2347</span>                  benchmarks[i].algo2 == <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa1d5a50a1a53000cd2b2989c17703e2d1">YH_ALGO_RSA_PSS_SHA512</a>)) {</div>
<div class="line"><span class="lineno"> 2348</span>        <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> =</div>
<div class="line"><span class="lineno"> 2349</span>          <a class="code hl_function" href="yubihsm_8c.html#a944e6f31487857709f032598fd43fef5">yh_util_sign_pss</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e, <span class="keywordtype">id</span>, data, benchmarks[i].bytes, out,</div>
<div class="line"><span class="lineno"> 2350</span>                           &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a565e4b6f63fecad4c290b50ee6684ee3">out_len</a>, benchmarks[i].bytes, <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caae1ab21f2df42a56bdc8ff046ed14797a">YH_ALGO_MGF1_SHA1</a>);</div>
<div class="line"><span class="lineno"> 2351</span>      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="yubihsm_8c.html#a3032a8f45bfad36ed6157b0158dd7921">yh_is_ec</a>(benchmarks[i].algo) &amp;&amp;</div>
<div class="line"><span class="lineno"> 2352</span>                 (benchmarks[i].algo2 == <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caae9b7b5598c3839a53e4986dc901be244">YH_ALGO_EC_ECDSA_SHA1</a> ||</div>
<div class="line"><span class="lineno"> 2353</span>                  benchmarks[i].algo2 == <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa2e5dfe9c79cb0d391d7bf952227268ec">YH_ALGO_EC_ECDSA_SHA256</a> ||</div>
<div class="line"><span class="lineno"> 2354</span>                  benchmarks[i].algo2 == <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa657d2b30d884aeeff3c024404132ad69">YH_ALGO_EC_ECDSA_SHA384</a> ||</div>
<div class="line"><span class="lineno"> 2355</span>                  benchmarks[i].algo2 == <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa44153987efd3466070143dbab77f2d70">YH_ALGO_EC_ECDSA_SHA512</a>)) {</div>
<div class="line"><span class="lineno"> 2356</span>        <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#a5121c90d3bd745afd8264fef2ef39ace">yh_util_sign_ecdsa</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e, <span class="keywordtype">id</span>, data, benchmarks[i].bytes, out,</div>
<div class="line"><span class="lineno"> 2357</span>                                 &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a565e4b6f63fecad4c290b50ee6684ee3">out_len</a>);</div>
<div class="line"><span class="lineno"> 2358</span>      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="yubihsm_8c.html#a3032a8f45bfad36ed6157b0158dd7921">yh_is_ec</a>(benchmarks[i].algo) &amp;&amp;</div>
<div class="line"><span class="lineno"> 2359</span>                 benchmarks[i].algo2 == <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa14b36e4ff3b90d44ace0aa2b2c65ef48">YH_ALGO_EC_ECDH</a>) {</div>
<div class="line"><span class="lineno"> 2360</span>        <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#a2900aee87732f9ec017bd1662bcef7e9">yh_util_derive_ecdh</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e, <span class="keywordtype">id</span>, algo_data, algo_len, out,</div>
<div class="line"><span class="lineno"> 2361</span>                                  &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a565e4b6f63fecad4c290b50ee6684ee3">out_len</a>);</div>
<div class="line"><span class="lineno"> 2362</span>      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (benchmarks[i].algo == <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa68c2c97f16c36f727e41a899d8a7e8bd">YH_ALGO_EC_ED25519</a>) {</div>
<div class="line"><span class="lineno"> 2363</span>        <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#a690a5585de21ce82495e139ec1dfdf9d">yh_util_sign_eddsa</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e, <span class="keywordtype">id</span>, data, benchmarks[i].bytes, out,</div>
<div class="line"><span class="lineno"> 2364</span>                                 &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a565e4b6f63fecad4c290b50ee6684ee3">out_len</a>);</div>
<div class="line"><span class="lineno"> 2365</span>      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="yubihsm_8c.html#acb19de78e7d1aed72abbed5c74c676bc">yh_is_hmac</a>(benchmarks[i].algo)) {</div>
<div class="line"><span class="lineno"> 2366</span>        <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#a9000d43fe8cf7313b319f316521eb0c4">yh_util_sign_hmac</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e, <span class="keywordtype">id</span>, data, benchmarks[i].bytes, out,</div>
<div class="line"><span class="lineno"> 2367</span>                                &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a565e4b6f63fecad4c290b50ee6684ee3">out_len</a>);</div>
<div class="line"><span class="lineno"> 2368</span>      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (benchmarks[i].algo == <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caae22b228e457c9bdccb5a93d81730b1b1">YH_ALGO_AES128_CCM_WRAP</a> ||</div>
<div class="line"><span class="lineno"> 2369</span>                 benchmarks[i].algo == <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caab739a1d142dacaf37ba13a73e2d83fab">YH_ALGO_AES192_CCM_WRAP</a> ||</div>
<div class="line"><span class="lineno"> 2370</span>                 benchmarks[i].algo == <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa927e2246e5657f946b4da4b71092b022">YH_ALGO_AES256_CCM_WRAP</a>) {</div>
<div class="line"><span class="lineno"> 2371</span>        <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> =</div>
<div class="line"><span class="lineno"> 2372</span>          <a class="code hl_function" href="yubihsm_8c.html#aa3f473e6dbb9188ad0269b40921c4f5f">yh_util_export_wrapped</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e, <span class="keywordtype">id</span>, <a class="code hl_enumvalue" href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583a16f0118db1dac3d0732e7d66630e1dba">YH_WRAP_KEY</a>, <span class="keywordtype">id</span>, out, &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a565e4b6f63fecad4c290b50ee6684ee3">out_len</a>);</div>
<div class="line"><span class="lineno"> 2373</span>      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (benchmarks[i].algo == <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa62e7ba4126ae16faeafb28972a4e0959">YH_ALGO_AES128_YUBICO_OTP</a> ||</div>
<div class="line"><span class="lineno"> 2374</span>                 benchmarks[i].algo == <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa62dd31db747b4b7f81d9e30877a0b720">YH_ALGO_AES192_YUBICO_OTP</a> ||</div>
<div class="line"><span class="lineno"> 2375</span>                 benchmarks[i].algo == <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caad1558532867577d1d77c84f1ae632acd">YH_ALGO_AES256_YUBICO_OTP</a>) {</div>
<div class="line"><span class="lineno"> 2376</span>        <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#a3677afe2209a1cae31f70a304e260e28">yh_util_decrypt_otp</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e, <span class="keywordtype">id</span>, algo_data, algo_len, <a class="code hl_variable" href="yubico__otp_8c.html#ab1e1d61db8c48d537faca71988a7c123">otp</a>, NULL,</div>
<div class="line"><span class="lineno"> 2377</span>                                  NULL, NULL, NULL);</div>
<div class="line"><span class="lineno"> 2378</span>      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strncmp(benchmarks[i].special, <span class="stringliteral">&quot;Random &quot;</span>, 7) == 0) {</div>
<div class="line"><span class="lineno"> 2379</span>        <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#af1bc8ed34687d83701eb3cc673ad4b96">yh_util_get_pseudo_random</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e, benchmarks[i].bytes, out,</div>
<div class="line"><span class="lineno"> 2380</span>                                        &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a565e4b6f63fecad4c290b50ee6684ee3">out_len</a>);</div>
<div class="line"><span class="lineno"> 2381</span>      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (benchmarks[i].algo == <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa461952ba18e7fcd792e480f71c853513">YH_ALGO_AES128_YUBICO_AUTHENTICATION</a>) {</div>
<div class="line"><span class="lineno"> 2382</span>        <a class="code hl_struct" href="structyh__session.html">yh_session</a> *<a class="code hl_variable" href="yubihsm__shell__tests_8c.html#a06390486523e3578750748be3bea88d4">ses</a> = NULL;</div>
<div class="line"><span class="lineno"> 2383</span>        <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#a3be331dcf8907ff3569e4dc230e1c615">yh_create_session_derived</a>(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a8c52c1a89cd4334a0225a1fbfba9a930">connector</a>, <span class="keywordtype">id</span>, password,</div>
<div class="line"><span class="lineno"> 2384</span>                                        <span class="keyword">sizeof</span>(password), <span class="keyword">false</span>, &amp;<a class="code hl_variable" href="yubihsm__shell__tests_8c.html#a06390486523e3578750748be3bea88d4">ses</a>);</div>
<div class="line"><span class="lineno"> 2385</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> == <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 2386</span>          <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8">yh_authenticate_session</a>(<a class="code hl_variable" href="yubihsm__shell__tests_8c.html#a06390486523e3578750748be3bea88d4">ses</a>);</div>
<div class="line"><span class="lineno"> 2387</span>        }</div>
<div class="line"><span class="lineno"> 2388</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> == <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 2389</span>          <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#a61ab8dbab67b1cceb49cd306f8c3f4b1">yh_util_close_session</a>(<a class="code hl_variable" href="yubihsm__shell__tests_8c.html#a06390486523e3578750748be3bea88d4">ses</a>);</div>
<div class="line"><span class="lineno"> 2390</span>        }</div>
<div class="line"><span class="lineno"> 2391</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2392</span>        fprintf(stderr, <span class="stringliteral">&quot;Unknown benchmark algorithm\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 2393</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 2394</span>      }</div>
<div class="line"><span class="lineno"> 2395</span> </div>
<div class="line"><span class="lineno"> 2396</span>      gettimeofday(&amp;after, NULL);</div>
<div class="line"><span class="lineno"> 2397</span> </div>
<div class="line"><span class="lineno"> 2398</span>      <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 2399</span>        fprintf(stderr, <span class="stringliteral">&quot;Failed running benchmark %u for %s%s%s\n&quot;</span>, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a538d097420e725c4dad63c3caa9e55bd">j</a>, str1,</div>
<div class="line"><span class="lineno"> 2400</span>                str2, str3);</div>
<div class="line"><span class="lineno"> 2401</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 2402</span>      }</div>
<div class="line"><span class="lineno"> 2403</span> </div>
<div class="line"><span class="lineno"> 2404</span>      time_elapsed(&amp;after, &amp;before, &amp;result);</div>
<div class="line"><span class="lineno"> 2405</span>      <span class="keywordflow">if</span> (time_less(&amp;result, &amp;min)) {</div>
<div class="line"><span class="lineno"> 2406</span>        <a class="code hl_function" href="namespacefc.html#aa3ea11c18de71ec23b19c3cc571fb8ff">min</a> = result;</div>
<div class="line"><span class="lineno"> 2407</span>      }</div>
<div class="line"><span class="lineno"> 2408</span>      <span class="keywordflow">if</span> (time_less(&amp;max, &amp;result)) {</div>
<div class="line"><span class="lineno"> 2409</span>        max = result;</div>
<div class="line"><span class="lineno"> 2410</span>      }</div>
<div class="line"><span class="lineno"> 2411</span>      time_add(&amp;result, &amp;total, &amp;total);</div>
<div class="line"><span class="lineno"> 2412</span>      time_average(&amp;total, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a538d097420e725c4dad63c3caa9e55bd">j</a> + 1, &amp;avg);</div>
<div class="line"><span class="lineno"> 2413</span><span class="preprocessor">#ifndef _WIN32</span></div>
<div class="line"><span class="lineno"> 2414</span>      <span class="keyword">struct </span>winsize w;</div>
<div class="line"><span class="lineno"> 2415</span>      ioctl(fileno(stderr), TIOCGWINSZ, &amp;w);</div>
<div class="line"><span class="lineno"> 2416</span> </div>
<div class="line"><span class="lineno"> 2417</span>      <span class="keywordflow">if</span> (chars &gt; w.ws_col) {</div>
<div class="line"><span class="lineno"> 2418</span>        <span class="comment">// move the cursor up and to column 1</span></div>
<div class="line"><span class="lineno"> 2419</span>        fprintf(stderr, <span class="stringliteral">&quot;\33[%zuF&quot;</span>, chars / w.ws_col);</div>
<div class="line"><span class="lineno"> 2420</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2421</span>        <span class="comment">// if we&#39;re still on same line, just move to column 1</span></div>
<div class="line"><span class="lineno"> 2422</span>        fprintf(stderr, <span class="stringliteral">&quot;\33[1G&quot;</span>);</div>
<div class="line"><span class="lineno"> 2423</span>      }</div>
<div class="line"><span class="lineno"> 2424</span>      <span class="comment">// clear display from cursor</span></div>
<div class="line"><span class="lineno"> 2425</span>      fprintf(stderr, <span class="stringliteral">&quot;\33[J&quot;</span>);</div>
<div class="line"><span class="lineno"> 2426</span>      chars = fprintf(stderr,</div>
<div class="line"><span class="lineno"> 2427</span>                      <span class="stringliteral">&quot;%s%s%s (%u/%d times) total: %ld.%06ld avg: %ld.%06ld &quot;</span></div>
<div class="line"><span class="lineno"> 2428</span>                      <span class="stringliteral">&quot;min: %ld.%06ld max: %ld.%06ld tps: %.06f&quot;</span>,</div>
<div class="line"><span class="lineno"> 2429</span>                      str1, str2, str3, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a538d097420e725c4dad63c3caa9e55bd">j</a> + 1, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].w, total.tv_sec,</div>
<div class="line"><span class="lineno"> 2430</span>                      (<span class="keywordtype">long</span>) total.tv_usec, avg.tv_sec, (<span class="keywordtype">long</span>) avg.tv_usec,</div>
<div class="line"><span class="lineno"> 2431</span>                      <a class="code hl_function" href="namespacefc.html#aa3ea11c18de71ec23b19c3cc571fb8ff">min</a>.tv_sec, (<span class="keywordtype">long</span>) <a class="code hl_function" href="namespacefc.html#aa3ea11c18de71ec23b19c3cc571fb8ff">min</a>.tv_usec, max.tv_sec,</div>
<div class="line"><span class="lineno"> 2432</span>                      (<span class="keywordtype">long</span>) max.tv_usec, time_tps(&amp;total, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a538d097420e725c4dad63c3caa9e55bd">j</a> + 1));</div>
<div class="line"><span class="lineno"> 2433</span>      fflush(stderr);</div>
<div class="line"><span class="lineno"> 2434</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2435</span>    }</div>
<div class="line"><span class="lineno"> 2436</span><span class="preprocessor">#ifdef _WIN32</span></div>
<div class="line"><span class="lineno"> 2437</span>    fprintf(stderr,</div>
<div class="line"><span class="lineno"> 2438</span>            <span class="stringliteral">&quot;%s%s%s (%d times) total: %ld.%06ld avg: %ld.%06ld &quot;</span></div>
<div class="line"><span class="lineno"> 2439</span>            <span class="stringliteral">&quot;min: %ld.%06ld max: %ld.%06ld tps: %.06f&quot;</span>,</div>
<div class="line"><span class="lineno"> 2440</span>            str1, str2, str3, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].w, total.tv_sec, (<span class="keywordtype">long</span>) total.tv_usec,</div>
<div class="line"><span class="lineno"> 2441</span>            avg.tv_sec, (<span class="keywordtype">long</span>) avg.tv_usec, <a class="code hl_function" href="namespacefc.html#aa3ea11c18de71ec23b19c3cc571fb8ff">min</a>.tv_sec, (<span class="keywordtype">long</span>) <a class="code hl_function" href="namespacefc.html#aa3ea11c18de71ec23b19c3cc571fb8ff">min</a>.tv_usec,</div>
<div class="line"><span class="lineno"> 2442</span>            max.tv_sec, (<span class="keywordtype">long</span>) max.tv_usec, time_tps(&amp;total, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].w));</div>
<div class="line"><span class="lineno"> 2443</span> </div>
<div class="line"><span class="lineno"> 2444</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2445</span>    fprintf(stderr, <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 2446</span>    <span class="keywordflow">if</span> (type != 0) {</div>
<div class="line"><span class="lineno"> 2447</span>      <a class="code hl_function" href="yubihsm_8c.html#ae736702f9463878db4adfd45b6a597f9">yh_util_delete_object</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e, <span class="keywordtype">id</span>, type);</div>
<div class="line"><span class="lineno"> 2448</span>    }</div>
<div class="line"><span class="lineno"> 2449</span>  }</div>
<div class="line"><span class="lineno"> 2450</span> </div>
<div class="line"><span class="lineno"> 2451</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 2452</span>}</div>
<div class="ttc" id="anamespacefc_html_aa3ea11c18de71ec23b19c3cc571fb8ff"><div class="ttname"><a href="namespacefc.html#aa3ea11c18de71ec23b19c3cc571fb8ff">fc::min</a></div><div class="ttdeci">const T &amp; min(const T &amp;a, const T &amp;b)</div><div class="ttdef"><b>Definition</b> <a href="utility_8hpp_source.html#l00140">utility.hpp:140</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_ac6f5a1f1e061f000983f5d5f3ac25dfa"><div class="ttname"><a href="namespacesysio_1_1chain.html#ac6f5a1f1e061f000983f5d5f3ac25dfa">sysio::chain::bytes</a></div><div class="ttdeci">vector&lt; char &gt; bytes</div><div class="ttdef"><b>Definition</b> <a href="chain_2include_2sysio_2chain_2types_8hpp_source.html#l00243">types.hpp:243</a></div></div>
<div class="ttc" id="apointer_8h_html_aeeddce917cf130d62c370b8f216026dd"><div class="ttname"><a href="pointer_8h.html#aeeddce917cf130d62c370b8f216026dd">a</a></div><div class="ttdeci">const GenericPointer&lt; typename T::ValueType &gt; T2 T::AllocatorType &amp; a</div><div class="ttdef"><b>Definition</b> <a href="pointer_8h_source.html#l01181">pointer.h:1181</a></div></div>
<div class="ttc" id="astdint_8h_html_a435d1572bf3f880d55459d9805097f62"><div class="ttname"><a href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a></div><div class="ttdeci">unsigned int uint32_t</div><div class="ttdef"><b>Definition</b> <a href="stdint_8h_source.html#l00126">stdint.h:126</a></div></div>
<div class="ttc" id="astdint_8h_html_aba7bc1797add20fe3efdf37ced1182c5"><div class="ttname"><a href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a></div><div class="ttdeci">unsigned char uint8_t</div><div class="ttdef"><b>Definition</b> <a href="stdint_8h_source.html#l00124">stdint.h:124</a></div></div>
<div class="ttc" id="astructyh__capabilities_html"><div class="ttname"><a href="structyh__capabilities.html">yh_capabilities</a></div><div class="ttdoc">Capabilities representation.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00162">yubihsm.h:162</a></div></div>
<div class="ttc" id="astructyh__session_html"><div class="ttname"><a href="structyh__session.html">yh_session</a></div><div class="ttdef"><b>Definition</b> <a href="lib_2internal_8h_source.html#l00025">internal.h:25</a></div></div>
<div class="ttc" id="astructyubihsm__context_html_a8c52c1a89cd4334a0225a1fbfba9a930"><div class="ttname"><a href="structyubihsm__context.html#a8c52c1a89cd4334a0225a1fbfba9a930">yubihsm_context::connector</a></div><div class="ttdeci">yh_connector * connector</div><div class="ttdef"><b>Definition</b> <a href="yubihsm-shell_8h_source.html#l00048">yubihsm-shell.h:48</a></div></div>
<div class="ttc" id="ayubico__otp_8c_html_a485b73836b7b661b3333a70b309ffba6"><div class="ttname"><a href="yubico__otp_8c.html#a485b73836b7b661b3333a70b309ffba6">otp_key</a></div><div class="ttdeci">const uint8_t otp_key[]</div><div class="ttdef"><b>Definition</b> <a href="yubico__otp_8c_source.html#l00037">yubico_otp.c:37</a></div></div>
<div class="ttc" id="ayubico__otp_8c_html_ab1e1d61db8c48d537faca71988a7c123"><div class="ttname"><a href="yubico__otp_8c.html#ab1e1d61db8c48d537faca71988a7c123">otp</a></div><div class="ttdeci">uint8_t otp[32]</div><div class="ttdef"><b>Definition</b> <a href="yubico__otp_8c_source.html#l00049">yubico_otp.c:49</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_a0a67155f2a7970ecb52e4f6aac6bbe84"><div class="ttname"><a href="yubihsm_8c.html#a0a67155f2a7970ecb52e4f6aac6bbe84">yh_is_rsa</a></div><div class="ttdeci">bool yh_is_rsa(yh_algorithm algorithm)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l04245">yubihsm.c:4245</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_a1eac22853548b7ceab92550c22233b18"><div class="ttname"><a href="yubihsm_8c.html#a1eac22853548b7ceab92550c22233b18">yh_util_generate_hmac_key</a></div><div class="ttdeci">yh_rc yh_util_generate_hmac_key(yh_session *session, uint16_t *key_id, const char *label, uint16_t domains, const yh_capabilities *capabilities, yh_algorithm algorithm)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l01992">yubihsm.c:1992</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_a1f749a696792e7911844629e056d9c15"><div class="ttname"><a href="yubihsm_8c.html#a1f749a696792e7911844629e056d9c15">yh_util_generate_wrap_key</a></div><div class="ttdeci">yh_rc yh_util_generate_wrap_key(yh_session *session, uint16_t *key_id, const char *label, uint16_t domains, const yh_capabilities *capabilities, yh_algorithm algorithm, const yh_capabilities *delegated_capabilities)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l02458">yubihsm.c:2458</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_a2900aee87732f9ec017bd1662bcef7e9"><div class="ttname"><a href="yubihsm_8c.html#a2900aee87732f9ec017bd1662bcef7e9">yh_util_derive_ecdh</a></div><div class="ttdeci">yh_rc yh_util_derive_ecdh(yh_session *session, uint16_t key_id, const uint8_t *in, size_t in_len, uint8_t *out, size_t *out_len)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l02174">yubihsm.c:2174</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_a2a0d369611aa795c62645467062a9acb"><div class="ttname"><a href="yubihsm_8c.html#a2a0d369611aa795c62645467062a9acb">yh_algo_to_string</a></div><div class="ttdeci">yh_rc yh_algo_to_string(yh_algorithm algo, char const **result)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l04384">yubihsm.c:4384</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_a2db9bbd57a908c5c454fc6254f57dcff"><div class="ttname"><a href="yubihsm_8c.html#a2db9bbd57a908c5c454fc6254f57dcff">yh_util_generate_ec_key</a></div><div class="ttdeci">yh_rc yh_util_generate_ec_key(yh_session *session, uint16_t *key_id, const char *label, uint16_t domains, const yh_capabilities *capabilities, yh_algorithm algorithm)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l01913">yubihsm.c:1913</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_a3032a8f45bfad36ed6157b0158dd7921"><div class="ttname"><a href="yubihsm_8c.html#a3032a8f45bfad36ed6157b0158dd7921">yh_is_ec</a></div><div class="ttdeci">bool yh_is_ec(yh_algorithm algorithm)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l04260">yubihsm.c:4260</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_a3677afe2209a1cae31f70a304e260e28"><div class="ttname"><a href="yubihsm_8c.html#a3677afe2209a1cae31f70a304e260e28">yh_util_decrypt_otp</a></div><div class="ttdeci">yh_rc yh_util_decrypt_otp(yh_session *session, uint16_t key_id, const uint8_t *aead, size_t aead_len, const uint8_t *otp, uint16_t *useCtr, uint8_t *sessionCtr, uint8_t *tstph, uint16_t *tstpl)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l03261">yubihsm.c:3261</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_a3be331dcf8907ff3569e4dc230e1c615"><div class="ttname"><a href="yubihsm_8c.html#a3be331dcf8907ff3569e4dc230e1c615">yh_create_session_derived</a></div><div class="ttdeci">yh_rc yh_create_session_derived(yh_connector *connector, uint16_t authkey_id, const uint8_t *password, size_t password_len, bool recreate, yh_session **session)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l00593">yubihsm.c:593</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_a41f4326fe736e99302442d6a6109edbc"><div class="ttname"><a href="yubihsm_8c.html#a41f4326fe736e99302442d6a6109edbc">yh_util_generate_ed_key</a></div><div class="ttdeci">yh_rc yh_util_generate_ed_key(yh_session *session, uint16_t *key_id, const char *label, uint16_t domains, const yh_capabilities *capabilities, yh_algorithm algorithm)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l01926">yubihsm.c:1926</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_a5121c90d3bd745afd8264fef2ef39ace"><div class="ttname"><a href="yubihsm_8c.html#a5121c90d3bd745afd8264fef2ef39ace">yh_util_sign_ecdsa</a></div><div class="ttdeci">yh_rc yh_util_sign_ecdsa(yh_session *session, uint16_t key_id, const uint8_t *in, size_t in_len, uint8_t *out, size_t *out_len)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l01411">yubihsm.c:1411</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_a61ab8dbab67b1cceb49cd306f8c3f4b1"><div class="ttname"><a href="yubihsm_8c.html#a61ab8dbab67b1cceb49cd306f8c3f4b1">yh_util_close_session</a></div><div class="ttdeci">yh_rc yh_util_close_session(yh_session *session)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l01257">yubihsm.c:1257</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_a690a5585de21ce82495e139ec1dfdf9d"><div class="ttname"><a href="yubihsm_8c.html#a690a5585de21ce82495e139ec1dfdf9d">yh_util_sign_eddsa</a></div><div class="ttdeci">yh_rc yh_util_sign_eddsa(yh_session *session, uint16_t key_id, const uint8_t *in, size_t in_len, uint8_t *out, size_t *out_len)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l01470">yubihsm.c:1470</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_a77870209747d5ccd90f9da3aae2bdfa8"><div class="ttname"><a href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8">yh_authenticate_session</a></div><div class="ttdeci">yh_rc yh_authenticate_session(yh_session *session)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l02927">yubihsm.c:2927</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_a80b4c4caeb9c768737c2dbf46d9352e4"><div class="ttname"><a href="yubihsm_8c.html#a80b4c4caeb9c768737c2dbf46d9352e4">yh_util_import_authentication_key_derived</a></div><div class="ttdeci">yh_rc yh_util_import_authentication_key_derived(yh_session *session, uint16_t *key_id, const char *label, uint16_t domains, const yh_capabilities *capabilities, const yh_capabilities *delegated_capabilities, const uint8_t *password, size_t password_len)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l03064">yubihsm.c:3064</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_a82d295a02d9eb628f6dea4b4c01fdec4"><div class="ttname"><a href="yubihsm_8c.html#a82d295a02d9eb628f6dea4b4c01fdec4">yh_util_create_otp_aead</a></div><div class="ttdeci">yh_rc yh_util_create_otp_aead(yh_session *session, uint16_t key_id, const uint8_t *key, const uint8_t *private_id, uint8_t *out, size_t *out_len)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l03179">yubihsm.c:3179</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_a9000d43fe8cf7313b319f316521eb0c4"><div class="ttname"><a href="yubihsm_8c.html#a9000d43fe8cf7313b319f316521eb0c4">yh_util_sign_hmac</a></div><div class="ttdeci">yh_rc yh_util_sign_hmac(yh_session *session, uint16_t key_id, const uint8_t *in, size_t in_len, uint8_t *out, size_t *out_len)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l01520">yubihsm.c:1520</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_a944e6f31487857709f032598fd43fef5"><div class="ttname"><a href="yubihsm_8c.html#a944e6f31487857709f032598fd43fef5">yh_util_sign_pss</a></div><div class="ttdeci">yh_rc yh_util_sign_pss(yh_session *session, uint16_t key_id, const uint8_t *in, size_t in_len, uint8_t *out, size_t *out_len, size_t salt_len, yh_algorithm mgf1Algo)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l01346">yubihsm.c:1346</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_a9e130d225a8dc003d7a7c0ce4b8ea5e4"><div class="ttname"><a href="yubihsm_8c.html#a9e130d225a8dc003d7a7c0ce4b8ea5e4">yh_util_generate_otp_aead_key</a></div><div class="ttdeci">yh_rc yh_util_generate_otp_aead_key(yh_session *session, uint16_t *key_id, const char *label, uint16_t domains, const yh_capabilities *capabilities, yh_algorithm algorithm, uint32_t nonce_id)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l03422">yubihsm.c:3422</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_aa0a7644b7b368d6aaf8b4aff5e3d19b8"><div class="ttname"><a href="yubihsm_8c.html#aa0a7644b7b368d6aaf8b4aff5e3d19b8">yh_util_sign_pkcs1v1_5</a></div><div class="ttdeci">yh_rc yh_util_sign_pkcs1v1_5(yh_session *session, uint16_t key_id, bool hashed, const uint8_t *in, size_t in_len, uint8_t *out, size_t *out_len)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l01287">yubihsm.c:1287</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_aa3f473e6dbb9188ad0269b40921c4f5f"><div class="ttname"><a href="yubihsm_8c.html#aa3f473e6dbb9188ad0269b40921c4f5f">yh_util_export_wrapped</a></div><div class="ttdeci">yh_rc yh_util_export_wrapped(yh_session *session, uint16_t wrapping_key_id, yh_object_type target_type, uint16_t target_id, uint8_t *out, size_t *out_len)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l02265">yubihsm.c:2265</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_aa7b8b42156c4bdaf41d8b9758a2fd73f"><div class="ttname"><a href="yubihsm_8c.html#aa7b8b42156c4bdaf41d8b9758a2fd73f">yh_util_get_public_key</a></div><div class="ttdeci">yh_rc yh_util_get_public_key(yh_session *session, uint16_t id, uint8_t *data, size_t *data_len, yh_algorithm *algorithm)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l01216">yubihsm.c:1216</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_aab440e1cb671d9ba7a2e7d1243960e42"><div class="ttname"><a href="yubihsm_8c.html#aab440e1cb671d9ba7a2e7d1243960e42">yh_string_to_capabilities</a></div><div class="ttdeci">yh_rc yh_string_to_capabilities(const char *capability, yh_capabilities *result)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l04115">yubihsm.c:4115</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_ab1c62ef2643184a8ad44c569c87712d1"><div class="ttname"><a href="yubihsm_8c.html#ab1c62ef2643184a8ad44c569c87712d1">yh_util_generate_rsa_key</a></div><div class="ttdeci">yh_rc yh_util_generate_rsa_key(yh_session *session, uint16_t *key_id, const char *label, uint16_t domains, const yh_capabilities *capabilities, yh_algorithm algorithm)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l01900">yubihsm.c:1900</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_acb19de78e7d1aed72abbed5c74c676bc"><div class="ttname"><a href="yubihsm_8c.html#acb19de78e7d1aed72abbed5c74c676bc">yh_is_hmac</a></div><div class="ttdeci">bool yh_is_hmac(yh_algorithm algorithm)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l04293">yubihsm.c:4293</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_ae736702f9463878db4adfd45b6a597f9"><div class="ttname"><a href="yubihsm_8c.html#ae736702f9463878db4adfd45b6a597f9">yh_util_delete_object</a></div><div class="ttdeci">yh_rc yh_util_delete_object(yh_session *session, uint16_t id, yh_object_type type)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l02222">yubihsm.c:2222</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_af1bc8ed34687d83701eb3cc673ad4b96"><div class="ttname"><a href="yubihsm_8c.html#af1bc8ed34687d83701eb3cc673ad4b96">yh_util_get_pseudo_random</a></div><div class="ttdeci">yh_rc yh_util_get_pseudo_random(yh_session *session, size_t len, uint8_t *out, size_t *out_len)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l01560">yubihsm.c:1560</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a2fe39512cb4df34b270a67dbb8e13583"><div class="ttname"><a href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583">yh_object_type</a></div><div class="ttdeci">yh_object_type</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00359">yubihsm.h:359</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a2fe39512cb4df34b270a67dbb8e13583a02c5f683fde147de6a9e1043f971f5f0"><div class="ttname"><a href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583a02c5f683fde147de6a9e1043f971f5f0">YH_OTP_AEAD_KEY</a></div><div class="ttdeci">@ YH_OTP_AEAD_KEY</div><div class="ttdoc">OTP AEAD Key is a secret key used to decrypt Yubico OTP values.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00376">yubihsm.h:376</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a2fe39512cb4df34b270a67dbb8e13583a16f0118db1dac3d0732e7d66630e1dba"><div class="ttname"><a href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583a16f0118db1dac3d0732e7d66630e1dba">YH_WRAP_KEY</a></div><div class="ttdeci">@ YH_WRAP_KEY</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00369">yubihsm.h:369</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a2fe39512cb4df34b270a67dbb8e13583a708d85f80fc33743ac26a7c3e43464a9"><div class="ttname"><a href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583a708d85f80fc33743ac26a7c3e43464a9">YH_HMAC_KEY</a></div><div class="ttdeci">@ YH_HMAC_KEY</div><div class="ttdoc">HMAC Key is a secret key used when computing and verifying HMAC signatures.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00371">yubihsm.h:371</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a2fe39512cb4df34b270a67dbb8e13583ab71424e16384319d6e6a12f9a3d8ceae"><div class="ttname"><a href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583ab71424e16384319d6e6a12f9a3d8ceae">YH_ASYMMETRIC_KEY</a></div><div class="ttdeci">@ YH_ASYMMETRIC_KEY</div><div class="ttdoc">Asymmetric Key is the private key of an asymmetric key-pair.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00366">yubihsm.h:366</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a2fe39512cb4df34b270a67dbb8e13583acee44b775b3c5b6157f0732699935074"><div class="ttname"><a href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583acee44b775b3c5b6157f0732699935074">YH_AUTHENTICATION_KEY</a></div><div class="ttdeci">@ YH_AUTHENTICATION_KEY</div><div class="ttdoc">Authentication Key is used to establish Sessions with a device.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00364">yubihsm.h:364</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a431f8b753552a8b2f5f980e871b6d019"><div class="ttname"><a href="yubihsm_8h.html#a431f8b753552a8b2f5f980e871b6d019">YH_OBJ_LABEL_LEN</a></div><div class="ttdeci">#define YH_OBJ_LABEL_LEN</div><div class="ttdoc">Max length of object labels.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00123">yubihsm.h:123</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55ca"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55ca">yh_algorithm</a></div><div class="ttdeci">yh_algorithm</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00390">yubihsm.h:390</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caa05aec903fd67851f968aaa606fe2138a"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa05aec903fd67851f968aaa606fe2138a">YH_ALGO_EC_P521</a></div><div class="ttdeci">@ YH_ALGO_EC_P521</div><div class="ttdoc">ecp521</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00418">yubihsm.h:418</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caa144083d6414cb33e8543d51e7d361d05"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa144083d6414cb33e8543d51e7d361d05">YH_ALGO_RSA_PSS_SHA384</a></div><div class="ttdeci">@ YH_ALGO_RSA_PSS_SHA384</div><div class="ttdoc">rsa-pss-sha384</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00404">yubihsm.h:404</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caa14b36e4ff3b90d44ace0aa2b2c65ef48"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa14b36e4ff3b90d44ace0aa2b2c65ef48">YH_ALGO_EC_ECDH</a></div><div class="ttdeci">@ YH_ALGO_EC_ECDH</div><div class="ttdoc">ecdh</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00438">yubihsm.h:438</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caa18e17370fcf9a829572e57608aff743c"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa18e17370fcf9a829572e57608aff743c">YH_ALGO_RSA_PKCS1_SHA256</a></div><div class="ttdeci">@ YH_ALGO_RSA_PKCS1_SHA256</div><div class="ttdoc">rsa-pkcs1-sha256</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00394">yubihsm.h:394</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caa1d5a50a1a53000cd2b2989c17703e2d1"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa1d5a50a1a53000cd2b2989c17703e2d1">YH_ALGO_RSA_PSS_SHA512</a></div><div class="ttdeci">@ YH_ALGO_RSA_PSS_SHA512</div><div class="ttdoc">rsa-pss-sha512</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00406">yubihsm.h:406</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caa228fd3332b55c60438dfea6a1b09af36"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa228fd3332b55c60438dfea6a1b09af36">YH_ALGO_EC_BP384</a></div><div class="ttdeci">@ YH_ALGO_EC_BP384</div><div class="ttdoc">ecbp384</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00424">yubihsm.h:424</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caa2e5dfe9c79cb0d391d7bf952227268ec"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa2e5dfe9c79cb0d391d7bf952227268ec">YH_ALGO_EC_ECDSA_SHA256</a></div><div class="ttdeci">@ YH_ALGO_EC_ECDSA_SHA256</div><div class="ttdoc">ecdsa-sha256</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00476">yubihsm.h:476</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caa31094c17c66e4c365ca3dad353bc8bda"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa31094c17c66e4c365ca3dad353bc8bda">YH_ALGO_EC_P384</a></div><div class="ttdeci">@ YH_ALGO_EC_P384</div><div class="ttdoc">ecp384</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00416">yubihsm.h:416</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caa44153987efd3466070143dbab77f2d70"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa44153987efd3466070143dbab77f2d70">YH_ALGO_EC_ECDSA_SHA512</a></div><div class="ttdeci">@ YH_ALGO_EC_ECDSA_SHA512</div><div class="ttdoc">ecdsa-sha512</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00480">yubihsm.h:480</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caa461952ba18e7fcd792e480f71c853513"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa461952ba18e7fcd792e480f71c853513">YH_ALGO_AES128_YUBICO_AUTHENTICATION</a></div><div class="ttdeci">@ YH_ALGO_AES128_YUBICO_AUTHENTICATION</div><div class="ttdoc">aes128-yubico-authentication</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00466">yubihsm.h:466</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caa62dd31db747b4b7f81d9e30877a0b720"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa62dd31db747b4b7f81d9e30877a0b720">YH_ALGO_AES192_YUBICO_OTP</a></div><div class="ttdeci">@ YH_ALGO_AES192_YUBICO_OTP</div><div class="ttdoc">aes192-yubico-otp</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00468">yubihsm.h:468</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caa62e7ba4126ae16faeafb28972a4e0959"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa62e7ba4126ae16faeafb28972a4e0959">YH_ALGO_AES128_YUBICO_OTP</a></div><div class="ttdeci">@ YH_ALGO_AES128_YUBICO_OTP</div><div class="ttdoc">aes128-yubico-otp</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00464">yubihsm.h:464</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caa657d2b30d884aeeff3c024404132ad69"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa657d2b30d884aeeff3c024404132ad69">YH_ALGO_EC_ECDSA_SHA384</a></div><div class="ttdeci">@ YH_ALGO_EC_ECDSA_SHA384</div><div class="ttdoc">ecdsa-sha384</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00478">yubihsm.h:478</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caa68c2c97f16c36f727e41a899d8a7e8bd"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa68c2c97f16c36f727e41a899d8a7e8bd">YH_ALGO_EC_ED25519</a></div><div class="ttdeci">@ YH_ALGO_EC_ED25519</div><div class="ttdoc">ed25519</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00482">yubihsm.h:482</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caa72d6c7ea77f10e39bbadc8b58d55b9ec"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa72d6c7ea77f10e39bbadc8b58d55b9ec">YH_ALGO_HMAC_SHA512</a></div><div class="ttdeci">@ YH_ALGO_HMAC_SHA512</div><div class="ttdoc">hmac-sha512</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00434">yubihsm.h:434</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caa781e7ca62563917d2129bde8ec53401b"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa781e7ca62563917d2129bde8ec53401b">YH_ALGO_HMAC_SHA384</a></div><div class="ttdeci">@ YH_ALGO_HMAC_SHA384</div><div class="ttdoc">hmac-sha384</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00432">yubihsm.h:432</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caa84e18ba6561d5a834dc8d794504708db"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa84e18ba6561d5a834dc8d794504708db">YH_ALGO_RSA_PKCS1_SHA512</a></div><div class="ttdeci">@ YH_ALGO_RSA_PKCS1_SHA512</div><div class="ttdoc">rsa-pkcs1-sha512</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00398">yubihsm.h:398</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caa927e2246e5657f946b4da4b71092b022"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa927e2246e5657f946b4da4b71092b022">YH_ALGO_AES256_CCM_WRAP</a></div><div class="ttdeci">@ YH_ALGO_AES256_CCM_WRAP</div><div class="ttdoc">aes256-ccm-wrap</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00474">yubihsm.h:474</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caa942e65c8cd0034eebe9a20c2297c7b06"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa942e65c8cd0034eebe9a20c2297c7b06">YH_ALGO_HMAC_SHA1</a></div><div class="ttdeci">@ YH_ALGO_HMAC_SHA1</div><div class="ttdoc">hmac-sha1</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00428">yubihsm.h:428</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caaafe94e6a770edb51c6db84f77d98d2c6"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caaafe94e6a770edb51c6db84f77d98d2c6">YH_ALGO_RSA_2048</a></div><div class="ttdeci">@ YH_ALGO_RSA_2048</div><div class="ttdoc">rsa2048</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00408">yubihsm.h:408</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caab0a0e1eb424b61057f159f1e53311f5c"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caab0a0e1eb424b61057f159f1e53311f5c">YH_ALGO_HMAC_SHA256</a></div><div class="ttdeci">@ YH_ALGO_HMAC_SHA256</div><div class="ttdoc">hmac-sha256</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00430">yubihsm.h:430</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caab739a1d142dacaf37ba13a73e2d83fab"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caab739a1d142dacaf37ba13a73e2d83fab">YH_ALGO_AES192_CCM_WRAP</a></div><div class="ttdeci">@ YH_ALGO_AES192_CCM_WRAP</div><div class="ttdoc">aes192-ccm-wrap</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00472">yubihsm.h:472</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caab9c1be17b7b3f755346ff8c3cca3ed25"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caab9c1be17b7b3f755346ff8c3cca3ed25">YH_ALGO_EC_BP512</a></div><div class="ttdeci">@ YH_ALGO_EC_BP512</div><div class="ttdoc">ecbp512</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00426">yubihsm.h:426</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caabd995726d45b6dd2388775db4767c80d"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caabd995726d45b6dd2388775db4767c80d">YH_ALGO_EC_BP256</a></div><div class="ttdeci">@ YH_ALGO_EC_BP256</div><div class="ttdoc">ecbp256</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00422">yubihsm.h:422</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caac42381f876f5e7190547cf81021451f5"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caac42381f876f5e7190547cf81021451f5">YH_ALGO_RSA_PSS_SHA256</a></div><div class="ttdeci">@ YH_ALGO_RSA_PSS_SHA256</div><div class="ttdoc">rsa-pss-sha256</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00402">yubihsm.h:402</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caad1558532867577d1d77c84f1ae632acd"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caad1558532867577d1d77c84f1ae632acd">YH_ALGO_AES256_YUBICO_OTP</a></div><div class="ttdeci">@ YH_ALGO_AES256_YUBICO_OTP</div><div class="ttdoc">aes256-yubico-otp</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00470">yubihsm.h:470</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caad423056b13955068935dc8b3ac0e65d1"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caad423056b13955068935dc8b3ac0e65d1">YH_ALGO_EC_K256</a></div><div class="ttdeci">@ YH_ALGO_EC_K256</div><div class="ttdoc">eck256</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00420">yubihsm.h:420</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caae1ab21f2df42a56bdc8ff046ed14797a"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caae1ab21f2df42a56bdc8ff046ed14797a">YH_ALGO_MGF1_SHA1</a></div><div class="ttdeci">@ YH_ALGO_MGF1_SHA1</div><div class="ttdoc">mgf1-sha1</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00454">yubihsm.h:454</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caae22b228e457c9bdccb5a93d81730b1b1"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caae22b228e457c9bdccb5a93d81730b1b1">YH_ALGO_AES128_CCM_WRAP</a></div><div class="ttdeci">@ YH_ALGO_AES128_CCM_WRAP</div><div class="ttdoc">aes128-ccm-wrap</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00448">yubihsm.h:448</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caae4b191baf5c65f9234120080264d129b"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caae4b191baf5c65f9234120080264d129b">YH_ALGO_EC_P256</a></div><div class="ttdeci">@ YH_ALGO_EC_P256</div><div class="ttdoc">ecp256</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00414">yubihsm.h:414</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caae5963322a0a0f43a1b74faa78e3a7329"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caae5963322a0a0f43a1b74faa78e3a7329">YH_ALGO_RSA_4096</a></div><div class="ttdeci">@ YH_ALGO_RSA_4096</div><div class="ttdoc">rsa4096</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00412">yubihsm.h:412</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caae9b7b5598c3839a53e4986dc901be244"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caae9b7b5598c3839a53e4986dc901be244">YH_ALGO_EC_ECDSA_SHA1</a></div><div class="ttdeci">@ YH_ALGO_EC_ECDSA_SHA1</div><div class="ttdoc">ecdsa-sha1</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00436">yubihsm.h:436</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caaedcbc07d82b18ca5c21eb3379a6cc010"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caaedcbc07d82b18ca5c21eb3379a6cc010">YH_ALGO_EC_P224</a></div><div class="ttdeci">@ YH_ALGO_EC_P224</div><div class="ttdoc">ecp224</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00484">yubihsm.h:484</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caafc78c2f62fe0a185c38d2644755fde2c"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caafc78c2f62fe0a185c38d2644755fde2c">YH_ALGO_RSA_PKCS1_SHA384</a></div><div class="ttdeci">@ YH_ALGO_RSA_PKCS1_SHA384</div><div class="ttdoc">rsa-pkcs1-sha384</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00396">yubihsm.h:396</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caafd3fbd9ed86caf267ccc77cb24d44426"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caafd3fbd9ed86caf267ccc77cb24d44426">YH_ALGO_RSA_3072</a></div><div class="ttdeci">@ YH_ALGO_RSA_3072</div><div class="ttdoc">rsa3072</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00410">yubihsm.h:410</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a08393519edfd7c59fb01fb8db97514b5"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a></div><div class="ttdeci">yh_capabilities capabilities</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l01305">yubihsm_pkcs11.c:1305</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a22f45a3cb4f074e609f58ebaeef0ecf9"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a></div><div class="ttdeci">char * label</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l01883">yubihsm_pkcs11.c:1883</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a538d097420e725c4dad63c3caa9e55bd"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a538d097420e725c4dad63c3caa9e55bd">j</a></div><div class="ttdeci">uint16_t j</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l00465">yubihsm_pkcs11.c:465</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a565e4b6f63fecad4c290b50ee6684ee3"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a565e4b6f63fecad4c290b50ee6684ee3">out_len</a></div><div class="ttdeci">size_t out_len</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l05000">yubihsm_pkcs11.c:5000</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_adc4bd59a60361844aa0e852efa210105"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105">memset</a></div><div class="ttdeci">memset(pInfo-&gt;slotDescription, ' ', 64)</div></div>
<div class="ttc" id="ayubihsm__shell__tests_8c_html_a06390486523e3578750748be3bea88d4"><div class="ttname"><a href="yubihsm__shell__tests_8c.html#a06390486523e3578750748be3bea88d4">ses</a></div><div class="ttdeci">yh_session * ses</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__shell__tests_8c_source.html#l00028">yubihsm_shell_tests.c:28</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_ae2e50929acc6085cd395d0bd4ddb02db_cgraph.png" border="0" usemap="#acommands_8c_ae2e50929acc6085cd395d0bd4ddb02db_cgraph" alt=""/></div>
<map name="acommands_8c_ae2e50929acc6085cd395d0bd4ddb02db_cgraph" id="acommands_8c_ae2e50929acc6085cd395d0bd4ddb02db_cgraph">
<area shape="rect" title=" " alt="" coords="5,1188,144,1214"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="1154,149,1223,175"/>
<area shape="poly" title=" " alt="" coords="73,1188,79,1024,95,751,110,603,130,465,156,348,172,301,189,264,257,154,291,110,328,74,369,45,416,24,472,12,538,8,787,8,875,5,944,4,977,7,1011,15,1048,28,1090,48,1117,66,1140,89,1174,134,1170,138,1136,92,1114,70,1088,53,1046,33,1010,20,976,12,944,9,875,10,787,13,538,13,472,17,418,29,371,50,331,78,295,114,262,157,194,266,177,303,161,349,135,466,115,604,101,751,84,1024,79,1188"/>
<area shape="rect" href="yubihsm_8c.html#a2a0d369611aa795c62645467062a9acb" title=" " alt="" coords="724,301,848,327"/>
<area shape="poly" title=" " alt="" coords="73,1188,77,1045,92,812,106,688,127,573,154,478,171,441,190,413,215,386,244,363,307,328,377,305,450,291,522,286,592,286,709,298,709,303,592,292,522,291,450,297,378,310,309,333,247,368,219,390,194,416,175,444,159,480,132,575,112,689,97,813,82,1045,79,1188"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="924,909,1089,935"/>
<area shape="poly" title=" " alt="" coords="74,1187,79,1130,95,1044,110,998,130,952,156,909,190,872,232,837,273,809,313,786,353,768,392,756,432,748,471,745,511,745,593,757,680,779,877,844,931,869,977,898,974,902,929,874,875,849,678,784,592,762,511,751,471,750,432,754,394,761,355,773,316,791,276,813,235,842,194,876,161,912,135,954,115,1000,101,1046,84,1130,79,1188"/>
<area shape="rect" href="yubihsm_8c.html#a3be331dcf8907ff3569e4dc230e1c615" title=" " alt="" coords="696,859,876,884"/>
<area shape="poly" title=" " alt="" coords="121,1185,191,1168,293,1156,425,1146,555,1129,607,1116,647,1097,672,1077,695,1053,732,998,758,943,774,898,779,900,763,945,736,1001,699,1056,676,1081,650,1102,609,1121,556,1135,426,1151,294,1161,192,1173,122,1190"/>
<area shape="rect" href="yubihsm_8c.html#a3032a8f45bfad36ed6157b0158dd7921" title=" " alt="" coords="502,1669,576,1695"/>
<area shape="poly" title=" " alt="" coords="80,1214,94,1294,118,1414,134,1476,152,1532,172,1578,193,1608,230,1619,309,1637,488,1671,487,1676,308,1642,229,1625,190,1612,167,1581,147,1534,129,1477,113,1415,88,1295,75,1215"/>
<area shape="rect" href="yubihsm_8c.html#acb19de78e7d1aed72abbed5c74c676bc" title=" " alt="" coords="241,1719,332,1744"/>
<area shape="poly" title=" " alt="" coords="80,1214,90,1311,112,1460,128,1537,147,1609,169,1667,194,1706,209,1717,227,1724,225,1729,206,1722,190,1709,164,1669,142,1610,123,1539,107,1461,85,1312,74,1214"/>
<area shape="rect" href="yubihsm_8c.html#a0a67155f2a7970ecb52e4f6aac6bbe84" title=" " alt="" coords="500,1795,578,1820"/>
<area shape="poly" title=" " alt="" coords="79,1214,88,1320,108,1485,123,1571,142,1649,166,1713,179,1737,193,1755,214,1768,243,1778,322,1793,409,1801,485,1804,485,1810,408,1806,321,1798,242,1783,211,1773,190,1759,175,1740,161,1715,137,1651,118,1572,102,1485,82,1321,74,1214"/>
<area shape="rect" href="yubihsm_8c.html#aab440e1cb671d9ba7a2e7d1243960e42" title=" " alt="" coords="924,251,1088,276"/>
<area shape="poly" title=" " alt="" coords="73,1188,75,1033,79,913,87,779,101,643,122,517,135,461,151,412,169,371,190,341,228,302,271,271,318,245,368,226,420,211,474,201,583,193,691,198,791,210,878,227,947,244,946,249,877,232,790,215,691,203,584,199,475,207,421,216,370,231,320,250,274,275,232,306,194,344,174,374,156,414,140,462,127,518,107,643,93,779,84,913,80,1034,78,1188"/>
<area shape="rect" href="yubihsm_8c.html#a61ab8dbab67b1cceb49cd306f8c3f4b1" title=" " alt="" coords="464,961,614,987"/>
<area shape="poly" title=" " alt="" coords="78,1187,92,1153,115,1108,147,1062,168,1041,190,1024,221,1007,253,994,321,976,388,968,449,966,449,971,389,973,322,981,255,999,223,1012,193,1028,171,1045,151,1065,119,1111,96,1155,83,1189"/>
<area shape="rect" href="yubihsm_8c.html#a82d295a02d9eb628f6dea4b4c01fdec4" title=" " alt="" coords="458,1567,620,1592"/>
<area shape="poly" title=" " alt="" coords="79,1214,85,1268,102,1348,117,1392,136,1434,162,1473,193,1507,226,1520,289,1535,443,1562,442,1568,288,1540,225,1525,190,1511,158,1477,132,1437,112,1394,97,1350,80,1269,74,1214"/>
<area shape="rect" href="yubihsm_8c.html#a3677afe2209a1cae31f70a304e260e28" title=" " alt="" coords="472,1617,606,1643"/>
<area shape="poly" title=" " alt="" coords="78,1214,81,1277,96,1370,110,1421,131,1471,158,1518,193,1557,229,1571,296,1587,457,1615,456,1621,295,1592,227,1577,190,1562,154,1521,126,1474,105,1423,91,1371,76,1277,73,1214"/>
<area shape="rect" href="yubihsm_8c.html#ae736702f9463878db4adfd45b6a597f9" title=" " alt="" coords="468,1011,611,1036"/>
<area shape="poly" title=" " alt="" coords="81,1186,121,1127,153,1094,190,1067,255,1040,324,1025,392,1017,452,1016,452,1021,392,1023,325,1030,257,1045,193,1071,156,1098,125,1130,85,1189"/>
<area shape="rect" href="yubihsm_8c.html#a2900aee87732f9ec017bd1662bcef7e9" title=" " alt="" coords="471,1239,607,1264"/>
<area shape="poly" title=" " alt="" coords="144,1206,456,1240,455,1245,144,1211"/>
<area shape="rect" href="yubihsm_8c.html#aa3f473e6dbb9188ad0269b40921c4f5f" title=" " alt="" coords="460,1061,618,1087"/>
<area shape="poly" title=" " alt="" coords="85,1186,128,1144,158,1121,191,1104,254,1084,321,1072,386,1067,444,1066,444,1071,386,1072,322,1077,256,1089,193,1109,161,1126,131,1148,89,1190"/>
<area shape="rect" href="yubihsm_8c.html#a2db9bbd57a908c5c454fc6254f57dcff" title=" " alt="" coords="204,1669,370,1695"/>
<area shape="poly" title=" " alt="" coords="80,1214,93,1301,117,1432,133,1500,151,1562,172,1614,194,1648,207,1660,204,1664,190,1652,167,1616,146,1564,128,1501,112,1433,88,1302,75,1215"/>
<area shape="rect" href="yubihsm_8c.html#a41f4326fe736e99302442d6a6109edbc" title=" " alt="" coords="204,1869,370,1895"/>
<area shape="poly" title=" " alt="" coords="79,1214,85,1336,103,1530,118,1633,138,1727,163,1805,178,1834,194,1857,195,1858,191,1862,190,1860,173,1837,158,1807,133,1728,113,1634,98,1531,80,1336,74,1214"/>
<area shape="rect" href="yubihsm_8c.html#a1eac22853548b7ceab92550c22233b18" title=" " alt="" coords="448,352,631,378"/>
<area shape="poly" title=" " alt="" coords="74,1188,79,1057,97,845,112,733,132,629,157,542,173,508,190,482,214,457,241,436,303,403,369,382,431,370,433,375,370,387,305,408,244,440,217,461,194,485,177,511,162,544,137,630,117,734,102,846,85,1057,79,1188"/>
<area shape="rect" href="yubihsm_8c.html#a9e130d225a8dc003d7a7c0ce4b8ea5e4" title=" " alt="" coords="468,831,610,872"/>
<area shape="poly" title=" " alt="" coords="75,1187,83,1138,102,1067,117,1029,136,992,161,957,190,927,219,906,252,889,320,865,390,852,453,847,453,852,390,857,322,870,254,894,222,910,193,931,165,960,141,994,122,1031,107,1069,88,1139,80,1188"/>
<area shape="rect" href="yubihsm_8c.html#ab1c62ef2643184a8ad44c569c87712d1" title=" " alt="" coords="202,1820,372,1846"/>
<area shape="poly" title=" " alt="" coords="79,1214,88,1326,108,1503,124,1595,143,1681,166,1751,179,1779,194,1799,206,1810,203,1814,190,1803,175,1781,161,1753,138,1682,119,1596,103,1503,83,1327,74,1215"/>
<area shape="rect" href="yubihsm_8c.html#a1f749a696792e7911844629e056d9c15" title=" " alt="" coords="450,491,629,516"/>
<area shape="poly" title=" " alt="" coords="73,1188,78,1062,93,861,108,755,128,658,155,579,171,549,190,527,221,504,256,489,293,479,332,474,407,475,473,484,472,490,407,480,332,479,294,484,258,494,224,509,193,531,176,552,160,581,133,660,113,756,99,861,83,1062,79,1188"/>
<area shape="rect" href="yubihsm_8c.html#af1bc8ed34687d83701eb3cc673ad4b96" title=" " alt="" coords="472,897,606,937"/>
<area shape="poly" title=" " alt="" coords="76,1187,87,1146,108,1088,142,1028,164,1001,190,977,221,958,254,943,324,922,394,912,457,910,457,915,395,917,325,927,256,948,223,963,193,982,168,1004,146,1031,113,1091,92,1147,81,1189"/>
<area shape="rect" href="yubihsm_8c.html#aa7b8b42156c4bdaf41d8b9758a2fd73f" title=" " alt="" coords="462,1517,616,1543"/>
<area shape="poly" title=" " alt="" coords="80,1214,89,1261,109,1327,123,1363,142,1398,165,1430,193,1457,227,1470,291,1485,448,1514,447,1519,290,1491,226,1476,190,1462,161,1434,138,1401,119,1366,104,1329,84,1262,75,1215"/>
<area shape="rect" href="yubihsm_8c.html#a80b4c4caeb9c768737c2dbf46d9352e4" title=" " alt="" coords="192,541,382,581"/>
<area shape="poly" title=" " alt="" coords="74,1187,83,1075,104,899,120,806,139,720,162,648,175,620,190,598,199,588,203,592,194,601,180,622,167,650,144,721,125,807,110,900,89,1076,79,1188"/>
<area shape="rect" href="yubihsm_8c.html#a5121c90d3bd745afd8264fef2ef39ace" title=" " alt="" coords="473,1351,605,1376"/>
<area shape="poly" title=" " alt="" coords="92,1212,135,1248,163,1268,193,1284,260,1310,331,1329,458,1353,457,1358,330,1334,259,1315,191,1289,160,1272,132,1253,88,1216"/>
<area shape="rect" href="yubihsm_8c.html#a690a5585de21ce82495e139ec1dfdf9d" title=" " alt="" coords="473,1405,605,1431"/>
<area shape="poly" title=" " alt="" coords="84,1213,124,1277,155,1315,193,1345,258,1376,328,1397,396,1409,457,1415,457,1420,395,1414,326,1402,256,1381,190,1350,151,1318,120,1281,80,1215"/>
<area shape="rect" href="yubihsm_8c.html#a9000d43fe8cf7313b319f316521eb0c4" title=" " alt="" coords="474,1455,604,1480"/>
<area shape="poly" title=" " alt="" coords="81,1213,93,1252,114,1306,147,1362,169,1387,193,1408,213,1418,239,1427,308,1442,460,1460,459,1465,308,1447,238,1433,211,1423,190,1412,165,1391,143,1365,110,1308,88,1254,76,1215"/>
<area shape="rect" href="yubihsm_8c.html#aa0a7644b7b368d6aaf8b4aff5e3d19b8" title=" " alt="" coords="459,1163,619,1188"/>
<area shape="poly" title=" " alt="" coords="144,1195,443,1178,444,1183,144,1200"/>
<area shape="rect" href="yubihsm_8c.html#a944e6f31487857709f032598fd43fef5" title=" " alt="" coords="480,1295,598,1320"/>
<area shape="poly" title=" " alt="" coords="113,1212,192,1237,337,1270,465,1293,464,1299,336,1275,191,1242,111,1217"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="1147,859,1230,884"/>
<area shape="poly" title=" " alt="" coords="848,299,905,293,970,295,1003,301,1035,310,1064,325,1091,344,1104,360,1117,382,1137,438,1154,507,1166,583,1182,733,1189,843,1184,844,1177,734,1161,584,1149,508,1132,440,1112,384,1100,364,1087,348,1061,329,1033,315,1002,306,969,300,905,298,848,304"/>
<area shape="poly" title=" " alt="" coords="1008,908,1178,189,1183,191,1013,910"/>
<area shape="poly" title=" " alt="" coords="1055,906,1131,885,1133,890,1056,911"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="1153,1440,1224,1466"/>
<area shape="poly" title=" " alt="" coords="1077,934,1091,945,1114,982,1133,1037,1149,1103,1162,1176,1180,1320,1188,1425,1183,1425,1174,1320,1157,1177,1144,1105,1128,1039,1109,985,1087,948,1074,938"/>
<area shape="poly" title=" " alt="" coords="876,869,1131,869,1131,874,876,874"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="941,959,1072,984"/>
<area shape="poly" title=" " alt="" coords="836,883,877,901,892,913,902,924,911,935,925,945,934,950,932,955,922,950,907,939,897,928,888,917,874,906,834,888"/>
<area shape="poly" title=" " alt="" coords="1062,956,1088,945,1128,920,1161,893,1164,897,1131,924,1090,950,1064,961"/>
<area shape="poly" title=" " alt="" coords="1065,983,1091,1002,1111,1035,1128,1083,1157,1205,1176,1330,1187,1424,1182,1425,1171,1331,1151,1206,1123,1085,1106,1038,1087,1005,1062,987"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="1137,959,1240,984"/>
<area shape="poly" title=" " alt="" coords="1072,969,1121,969,1121,974,1072,974"/>
<area shape="poly" title=" " alt="" coords="1046,248,1088,229,1158,183,1161,187,1090,234,1048,253"/>
<area shape="poly" title=" " alt="" coords="1066,275,1091,294,1115,339,1136,402,1152,479,1165,563,1181,726,1189,843,1183,844,1176,726,1159,563,1146,480,1130,404,1111,341,1087,297,1063,279"/>
<area shape="poly" title=" " alt="" coords="1012,277,1186,1425,1180,1425,1007,277"/>
<area shape="poly" title=" " alt="" coords="613,966,631,958,646,947,663,923,670,899,670,873,667,848,664,822,665,796,674,772,695,749,729,732,775,721,830,715,889,715,948,718,1004,726,1053,736,1090,749,1119,768,1143,793,1177,843,1172,846,1139,796,1116,772,1088,754,1052,741,1004,731,948,724,889,720,830,721,776,726,731,737,698,754,679,775,671,798,670,822,672,847,676,873,676,899,668,926,650,951,634,963,615,971"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="712,1112,860,1138"/>
<area shape="poly" title=" " alt="" coords="615,979,650,996,662,1008,669,1020,676,1044,682,1068,698,1091,716,1103,713,1107,694,1095,677,1070,670,1045,664,1022,658,1011,647,1000,613,984"/>
<area shape="poly" title=" " alt="" coords="791,1111,809,1077,838,1032,876,985,922,944,929,940,932,944,925,948,880,988,842,1035,814,1080,796,1113"/>
<area shape="poly" title=" " alt="" coords="805,1109,972,992,975,996,808,1114"/>
<area shape="poly" title=" " alt="" coords="621,1586,742,1595,882,1598,948,1594,1007,1586,1055,1573,1087,1554,1103,1533,1115,1507,1123,1475,1129,1438,1133,1355,1130,1264,1122,1082,1123,1005,1134,945,1147,918,1164,895,1168,898,1152,921,1140,947,1129,1006,1127,1082,1136,1264,1138,1355,1134,1439,1128,1476,1120,1508,1107,1536,1091,1558,1057,1578,1008,1592,949,1600,882,1603,742,1600,621,1591"/>
<area shape="poly" title=" " alt="" coords="622,1584,637,1592,650,1603,668,1626,679,1649,685,1673,687,1697,682,1744,670,1791,659,1836,656,1881,659,1902,666,1923,679,1943,698,1963,747,2000,795,2027,843,2042,891,2047,940,2041,988,2026,1037,1999,1087,1963,1100,1949,1112,1929,1133,1876,1149,1810,1162,1736,1178,1589,1184,1481,1189,1481,1183,1590,1167,1737,1155,1811,1138,1878,1117,1931,1105,1952,1091,1967,1040,2004,990,2030,941,2047,891,2052,842,2047,793,2032,744,2005,695,1967,675,1946,661,1925,654,1903,650,1881,654,1835,665,1789,677,1743,682,1697,680,1674,674,1651,663,1629,646,1607,634,1597,620,1589"/>
<area shape="poly" title=" " alt="" coords="619,1570,647,1554,686,1508,718,1456,741,1399,759,1341,770,1285,777,1233,782,1153,787,1153,782,1233,775,1286,764,1343,746,1401,723,1458,691,1511,650,1558,622,1574"/>
<area shape="poly" title=" " alt="" coords="607,1635,728,1644,872,1647,941,1644,1003,1635,1054,1622,1073,1613,1087,1602,1095,1587,1103,1563,1113,1489,1118,1391,1121,1282,1124,1071,1128,992,1134,945,1147,918,1164,895,1168,898,1152,921,1140,947,1133,993,1129,1071,1126,1282,1124,1391,1118,1489,1108,1564,1100,1590,1091,1605,1075,1617,1055,1627,1004,1641,942,1649,872,1652,728,1649,607,1640"/>
<area shape="poly" title=" " alt="" coords="608,1631,631,1640,650,1655,669,1681,681,1707,688,1733,690,1759,683,1811,669,1862,656,1912,652,1961,655,1985,663,2008,677,2030,698,2052,717,2056,762,2059,892,2061,1023,2058,1068,2055,1088,2051,1102,2034,1116,2010,1139,1946,1156,1867,1168,1779,1181,1606,1185,1481,1190,1481,1187,1606,1173,1780,1161,1868,1144,1948,1121,2012,1107,2037,1090,2055,1069,2060,1023,2063,892,2066,762,2064,716,2061,695,2057,673,2033,658,2010,650,1986,647,1961,651,1911,664,1861,678,1810,684,1759,682,1733,676,1708,665,1683,646,1659,628,1645,606,1636"/>
<area shape="poly" title=" " alt="" coords="606,1624,628,1616,647,1603,690,1551,723,1492,748,1428,764,1363,775,1299,781,1241,783,1154,788,1154,786,1242,780,1300,770,1364,753,1430,728,1494,694,1554,650,1607,630,1620,608,1629"/>
<area shape="poly" title=" " alt="" coords="610,1017,630,1010,646,998,664,974,670,950,670,924,667,898,664,873,665,847,674,823,695,800,729,783,775,773,829,769,887,769,1003,781,1090,800,1131,820,1165,846,1162,850,1128,825,1088,805,1002,786,887,775,829,774,775,778,730,788,698,804,679,826,671,848,670,872,673,898,676,924,676,950,668,976,650,1001,632,1014,612,1022"/>
<area shape="poly" title=" " alt="" coords="612,1032,650,1047,665,1057,675,1069,684,1080,698,1091,724,1104,721,1108,695,1095,680,1084,671,1072,661,1061,647,1051,610,1037"/>
<area shape="poly" title=" " alt="" coords="608,1245,666,1239,734,1228,806,1212,874,1188,898,1171,922,1153,948,1143,971,1138,1011,1135,1049,1128,1068,1119,1087,1103,1102,1084,1111,1067,1118,1031,1121,991,1125,969,1135,945,1165,895,1170,898,1139,947,1131,971,1126,992,1123,1031,1117,1068,1107,1087,1091,1107,1071,1124,1051,1134,1012,1140,971,1144,949,1148,925,1158,901,1176,877,1193,807,1217,735,1234,667,1245,608,1251"/>
<area shape="poly" title=" " alt="" coords="599,1262,649,1280,787,1364,872,1416,925,1444,980,1455,1037,1460,1137,1456,1137,1462,1037,1465,979,1460,923,1449,869,1421,784,1368,647,1285,597,1267"/>
<area shape="poly" title=" " alt="" coords="569,1236,647,1199,747,1144,750,1148,650,1203,572,1241"/>
<area shape="poly" title=" " alt="" coords="618,1064,633,1057,646,1047,664,1023,671,997,671,971,667,945,664,918,665,892,674,867,695,844,728,828,776,821,833,819,896,822,1025,838,1132,857,1131,862,1024,843,896,828,833,824,776,826,730,833,698,848,678,870,670,893,669,918,672,944,676,971,676,998,669,1025,650,1051,636,1062,620,1069"/>
<area shape="poly" title=" " alt="" coords="606,1085,706,1106,704,1111,605,1090"/>
<area shape="poly" title=" " alt="" coords="370,1680,487,1680,487,1685,370,1685"/>
<area shape="rect" href="yubihsm_8c.html#a16fbf4426acbf42695c4ec4738b6ae8a" title=" " alt="" coords="502,1869,576,1895"/>
<area shape="poly" title=" " alt="" coords="370,1880,487,1880,487,1885,370,1885"/>
<area shape="poly" title=" " alt="" coords="541,351,554,300,583,226,603,188,629,150,659,117,695,91,749,63,797,46,843,38,887,38,932,44,979,56,1090,90,1131,111,1165,137,1162,141,1128,115,1088,95,978,61,931,49,887,43,843,43,799,51,751,68,698,95,663,121,633,154,608,190,588,229,559,301,546,353"/>
<area shape="poly" title=" " alt="" coords="631,355,751,349,887,350,952,354,1009,363,1057,376,1091,395,1115,428,1135,478,1151,539,1164,607,1181,743,1189,843,1183,844,1175,743,1158,608,1146,540,1130,479,1110,431,1087,399,1055,381,1008,368,951,359,887,355,752,354,631,360"/>
<area shape="poly" title=" " alt="" coords="561,376,607,417,631,445,651,477,662,517,667,569,667,692,668,755,672,813,681,861,698,895,718,914,738,924,758,929,779,931,825,933,850,939,877,951,903,971,925,995,974,1030,1015,1054,1053,1081,1091,1126,1114,1164,1133,1205,1161,1289,1178,1366,1187,1424,1182,1425,1173,1367,1156,1291,1128,1207,1109,1167,1087,1129,1049,1085,1012,1058,971,1034,922,999,899,975,874,955,849,944,824,938,779,936,757,935,736,929,715,918,694,899,676,863,667,813,663,755,662,692,662,569,657,518,646,479,627,448,604,421,557,380"/>
<area shape="poly" title=" " alt="" coords="561,376,608,417,632,445,651,477,676,543,687,601,689,655,686,706,682,757,680,811,684,871,699,940,714,985,733,1028,771,1097,766,1100,729,1030,709,987,694,942,679,872,675,811,677,756,681,705,684,655,682,602,670,545,646,479,627,448,604,421,557,380"/>
<area shape="poly" title=" " alt="" coords="548,830,595,726,622,657,646,586,654,540,656,499,649,426,648,392,653,358,667,323,694,287,715,268,736,257,756,251,777,249,822,249,875,242,1139,173,1140,178,876,248,822,255,777,255,757,256,738,262,718,273,698,291,672,326,658,359,653,392,654,426,661,499,660,541,651,587,627,659,600,728,553,832"/>
<area shape="poly" title=" " alt="" coords="546,830,566,789,598,737,641,687,667,665,695,648,751,622,802,602,850,589,896,583,942,586,989,597,1038,617,1091,648,1114,667,1133,690,1162,744,1179,798,1187,843,1182,844,1173,799,1157,746,1129,693,1110,671,1087,652,1035,622,987,602,941,591,897,588,851,594,804,607,753,627,698,653,670,670,645,691,602,741,571,791,551,832"/>
<area shape="poly" title=" " alt="" coords="612,860,632,869,650,883,665,903,673,924,675,963,677,1002,684,1021,698,1040,720,1057,742,1065,787,1067,810,1067,833,1070,856,1079,878,1098,898,1129,907,1161,907,1192,903,1222,898,1253,898,1283,906,1313,926,1343,944,1361,962,1372,999,1381,1041,1385,1090,1398,1153,1430,1150,1435,1088,1403,1040,1390,998,1386,960,1376,941,1365,922,1347,901,1315,893,1283,893,1252,897,1222,901,1191,901,1162,894,1132,874,1101,853,1084,832,1075,810,1072,787,1072,741,1070,717,1062,694,1044,679,1024,672,1004,670,964,668,925,661,906,646,887,629,874,609,865"/>
<area shape="poly" title=" " alt="" coords="612,859,632,869,650,883,669,910,677,936,678,963,676,989,673,1014,674,1040,681,1065,698,1091,711,1102,708,1106,694,1095,676,1068,669,1041,668,1014,670,988,673,962,672,937,664,912,646,887,629,873,609,864"/>
<area shape="poly" title=" " alt="" coords="372,1822,484,1810,485,1816,372,1827"/>
<area shape="poly" title=" " alt="" coords="556,488,602,447,626,420,646,389,659,353,663,320,657,257,654,227,657,197,669,169,695,141,728,125,774,116,827,114,886,117,1001,130,1089,141,1140,149,1139,154,1089,146,1000,135,885,122,827,120,774,122,730,130,698,146,674,172,662,199,659,227,662,256,668,320,664,355,651,391,630,423,606,451,560,492"/>
<area shape="poly" title=" " alt="" coords="589,488,692,468,757,461,826,459,897,464,967,479,1033,505,1063,524,1091,546,1120,579,1144,617,1161,658,1174,701,1187,781,1190,843,1185,843,1182,782,1168,702,1156,660,1139,619,1116,582,1087,550,1060,528,1030,510,966,484,897,469,826,464,757,466,693,473,590,493"/>
<area shape="poly" title=" " alt="" coords="625,515,650,534,669,560,682,586,689,612,692,638,687,688,676,738,664,788,660,838,662,863,669,888,681,913,698,939,718,958,738,969,759,973,781,975,827,978,852,985,877,1000,935,1050,987,1106,1034,1167,1075,1228,1140,1342,1178,1424,1174,1427,1135,1345,1071,1231,1030,1170,983,1110,931,1054,874,1004,850,990,826,983,780,980,758,978,736,974,715,962,694,943,676,916,664,890,657,863,655,838,659,787,671,737,682,687,686,638,684,613,677,588,665,563,646,537,622,519"/>
<area shape="poly" title=" " alt="" coords="626,515,650,534,662,551,670,573,681,626,686,689,687,757,686,891,690,947,699,991,713,1021,730,1051,765,1099,761,1102,725,1054,708,1024,694,992,684,948,681,891,681,757,680,689,676,627,665,575,657,554,646,537,622,519"/>
<area shape="poly" title=" " alt="" coords="605,905,628,896,646,882,662,859,668,836,667,789,665,765,666,742,675,720,695,699,729,681,776,670,831,663,890,662,950,665,1006,672,1054,684,1090,699,1110,712,1126,729,1153,768,1172,808,1183,843,1178,845,1167,810,1148,770,1122,732,1106,716,1088,703,1052,689,1005,678,950,670,890,667,831,669,777,675,731,686,698,703,680,722,672,743,670,765,672,789,674,837,667,862,650,885,630,901,607,910"/>
<area shape="poly" title=" " alt="" coords="607,923,630,933,650,947,665,965,672,984,676,1020,678,1056,685,1074,698,1091,713,1103,710,1107,694,1095,680,1076,673,1057,670,1021,667,985,660,968,646,951,627,937,605,928"/>
<area shape="poly" title=" " alt="" coords="617,1536,738,1546,879,1549,946,1546,1006,1538,1054,1525,1087,1506,1102,1487,1113,1463,1126,1399,1130,1323,1128,1239,1122,1072,1124,1000,1134,945,1148,918,1164,895,1168,898,1152,921,1140,947,1129,1001,1127,1072,1134,1239,1135,1323,1131,1400,1118,1464,1106,1490,1091,1510,1056,1530,1007,1544,946,1551,879,1555,738,1551,616,1542"/>
<area shape="poly" title=" " alt="" coords="618,1532,635,1540,650,1552,669,1578,682,1603,688,1629,690,1655,683,1707,670,1758,657,1808,652,1857,655,1881,663,1904,677,1926,698,1948,717,1952,762,1955,892,1957,1023,1954,1068,1951,1088,1947,1100,1933,1112,1914,1132,1863,1148,1799,1161,1728,1177,1586,1184,1481,1189,1481,1182,1586,1166,1729,1153,1800,1137,1865,1116,1917,1104,1936,1090,1951,1069,1956,1023,1959,892,1962,761,1960,716,1957,695,1953,673,1930,659,1906,650,1882,647,1857,652,1807,665,1757,678,1706,685,1655,683,1630,677,1605,665,1580,646,1556,632,1545,615,1537"/>
<area shape="poly" title=" " alt="" coords="607,1514,628,1505,647,1491,680,1452,708,1407,730,1360,747,1311,770,1221,780,1153,785,1153,775,1222,752,1313,735,1362,712,1410,684,1455,650,1495,631,1509,610,1519"/>
<area shape="poly" title=" " alt="" coords="314,538,366,505,429,476,493,459,576,444,671,433,772,427,871,428,961,438,1037,458,1067,472,1091,490,1110,516,1127,555,1154,655,1175,761,1186,843,1181,843,1169,762,1149,656,1122,557,1105,519,1087,493,1064,477,1035,463,960,443,870,433,772,432,672,438,577,449,494,464,431,481,368,510,317,542"/>
<area shape="rect" href="yubihsm_8c.html#ac154da7ac6dc0a7b4b3a6cdff9433da8" title=" " alt="" coords="430,548,648,574"/>
<area shape="poly" title=" " alt="" coords="383,558,414,558,414,564,383,564"/>
<area shape="poly" title=" " alt="" coords="621,545,646,527,669,492,677,457,675,422,668,386,662,351,661,315,670,279,694,243,727,221,774,203,833,190,898,179,1031,166,1139,161,1139,166,1031,171,898,184,834,195,776,209,729,226,698,247,675,281,666,315,667,350,674,385,680,421,682,457,674,494,650,531,624,550"/>
<area shape="poly" title=" " alt="" coords="593,545,694,527,757,521,825,520,895,525,964,538,1030,562,1091,597,1118,623,1139,653,1156,687,1169,722,1184,789,1189,843,1184,844,1178,790,1163,723,1151,689,1135,656,1114,627,1087,602,1028,567,963,543,894,530,825,525,758,527,695,532,594,550"/>
<area shape="poly" title=" " alt="" coords="549,573,594,674,651,819,662,870,664,912,672,950,682,969,698,990,720,1007,742,1015,787,1018,810,1018,833,1022,856,1031,878,1050,898,1081,906,1112,907,1143,903,1173,899,1203,899,1232,906,1262,926,1293,944,1310,963,1320,1001,1328,1043,1333,1066,1340,1090,1352,1135,1388,1170,1426,1166,1430,1131,1392,1088,1356,1064,1345,1042,1338,1000,1333,961,1325,941,1314,922,1296,902,1264,894,1233,894,1202,897,1172,901,1142,901,1113,893,1083,874,1053,853,1036,832,1027,810,1024,787,1023,740,1020,717,1011,694,993,677,972,667,952,659,912,656,870,646,820,589,676,544,575"/>
<area shape="poly" title=" " alt="" coords="549,573,596,673,625,745,651,819,664,882,668,934,675,983,684,1010,699,1041,724,1074,754,1101,751,1105,720,1078,694,1044,679,1012,669,985,662,934,659,883,646,820,620,747,591,676,545,575"/>
<area shape="poly" title=" " alt="" coords="606,1364,714,1361,779,1353,847,1340,914,1320,979,1292,1037,1254,1063,1231,1087,1205,1108,1172,1119,1142,1122,1112,1121,1083,1118,1020,1123,984,1135,945,1148,919,1164,895,1169,898,1153,921,1139,947,1128,985,1124,1020,1127,1083,1127,1113,1124,1143,1113,1174,1091,1208,1067,1234,1041,1258,981,1296,916,1325,848,1345,780,1358,715,1366,606,1370"/>
<area shape="poly" title=" " alt="" coords="607,1369,630,1378,650,1391,671,1416,680,1441,686,1467,699,1497,749,1595,788,1674,810,1709,839,1740,876,1770,925,1799,970,1818,1009,1827,1028,1826,1047,1822,1087,1799,1105,1778,1122,1744,1149,1654,1169,1557,1181,1481,1186,1482,1174,1558,1155,1655,1127,1746,1110,1780,1091,1803,1049,1827,1029,1832,1009,1833,968,1824,922,1803,873,1774,835,1744,806,1712,783,1677,745,1597,694,1499,681,1469,675,1442,666,1419,647,1395,627,1383,605,1374"/>
<area shape="poly" title=" " alt="" coords="605,1351,627,1342,647,1331,691,1289,727,1240,754,1191,772,1151,777,1153,759,1193,731,1243,695,1292,650,1335,629,1347,606,1356"/>
<area shape="poly" title=" " alt="" coords="606,1427,713,1436,777,1436,844,1430,912,1418,977,1396,1036,1364,1063,1344,1087,1321,1104,1290,1114,1248,1119,1197,1120,1140,1122,1029,1126,982,1134,945,1148,919,1164,895,1168,898,1152,921,1140,947,1131,983,1128,1030,1126,1141,1124,1197,1119,1249,1109,1292,1091,1324,1066,1348,1039,1369,979,1401,913,1423,845,1435,777,1441,713,1441,606,1432"/>
<area shape="poly" title=" " alt="" coords="607,1417,630,1426,650,1440,661,1456,668,1476,675,1526,675,1586,672,1650,670,1713,671,1771,680,1819,687,1836,698,1850,730,1868,776,1881,831,1889,891,1891,952,1888,1007,1880,1054,1867,1087,1850,1108,1824,1125,1785,1141,1735,1153,1680,1172,1567,1182,1481,1187,1482,1177,1568,1159,1681,1146,1737,1130,1787,1112,1827,1091,1854,1056,1872,1008,1885,952,1893,891,1896,831,1894,775,1886,728,1873,695,1854,683,1839,675,1820,666,1772,665,1713,667,1649,670,1586,669,1527,663,1478,656,1459,646,1444,628,1430,605,1422"/>
<area shape="poly" title=" " alt="" coords="605,1407,627,1399,647,1387,674,1361,697,1332,735,1267,760,1203,776,1152,781,1154,765,1205,739,1269,702,1335,678,1365,650,1391,629,1404,607,1412"/>
<area shape="poly" title=" " alt="" coords="588,1478,692,1500,757,1507,827,1510,899,1505,968,1489,1032,1461,1061,1442,1087,1419,1099,1403,1108,1382,1120,1329,1125,1264,1125,1193,1122,1052,1125,992,1134,945,1148,918,1164,895,1168,898,1152,921,1140,947,1130,993,1127,1052,1130,1193,1130,1264,1126,1329,1114,1384,1104,1406,1091,1423,1064,1447,1034,1466,969,1494,899,1510,827,1515,757,1513,691,1505,587,1484"/>
<area shape="poly" title=" " alt="" coords="605,1475,630,1486,650,1503,660,1519,666,1539,673,1588,671,1707,669,1769,671,1825,680,1870,688,1887,698,1900,730,1919,776,1932,832,1939,892,1942,952,1939,1008,1931,1054,1918,1087,1900,1110,1871,1129,1826,1145,1769,1157,1705,1175,1577,1183,1481,1188,1481,1180,1578,1163,1706,1150,1770,1134,1827,1114,1874,1091,1904,1056,1923,1009,1936,952,1944,892,1947,831,1945,775,1937,728,1924,695,1904,683,1890,675,1872,666,1825,664,1769,666,1707,667,1588,661,1540,655,1521,646,1507,627,1490,603,1479"/>
<area shape="poly" title=" " alt="" coords="604,1461,626,1454,647,1441,678,1410,705,1373,726,1333,743,1292,767,1214,779,1153,784,1154,772,1215,748,1294,731,1336,709,1376,682,1413,650,1446,629,1459,605,1466"/>
<area shape="poly" title=" " alt="" coords="620,1181,678,1183,743,1180,811,1169,875,1148,890,1139,899,1128,922,1103,968,1071,1007,1050,1044,1029,1087,995,1134,944,1169,896,1173,899,1138,947,1091,999,1047,1033,1009,1055,971,1076,925,1107,903,1132,893,1143,877,1153,812,1174,744,1185,678,1188,620,1187"/>
<area shape="poly" title=" " alt="" coords="571,1187,649,1224,767,1277,817,1304,877,1344,892,1358,901,1371,910,1382,925,1393,979,1417,1036,1433,1091,1443,1138,1448,1137,1453,1090,1448,1035,1438,977,1422,922,1398,906,1386,897,1374,888,1361,874,1348,815,1308,765,1282,647,1229,569,1191"/>
<area shape="poly" title=" " alt="" coords="605,1160,704,1139,706,1144,606,1165"/>
<area shape="poly" title=" " alt="" coords="598,1302,658,1295,728,1284,803,1266,875,1240,889,1232,898,1223,922,1204,948,1194,971,1189,1012,1186,1050,1180,1068,1170,1087,1154,1106,1129,1116,1105,1120,1081,1120,1058,1120,1006,1124,977,1135,945,1165,896,1169,898,1139,947,1129,978,1125,1006,1126,1058,1125,1082,1121,1106,1110,1131,1091,1157,1071,1175,1052,1185,1013,1192,971,1194,949,1199,925,1209,902,1227,892,1236,877,1245,804,1271,729,1289,658,1300,599,1307"/>
<area shape="poly" title=" " alt="" coords="600,1315,625,1323,650,1336,666,1351,675,1366,684,1380,698,1395,755,1435,804,1461,856,1479,924,1494,970,1503,1006,1506,1043,1503,1088,1494,1121,1484,1150,1471,1152,1476,1122,1489,1090,1500,1043,1508,1006,1511,969,1508,923,1500,854,1484,801,1466,752,1440,695,1399,679,1383,671,1368,662,1354,647,1340,623,1328,598,1320"/>
<area shape="poly" title=" " alt="" coords="598,1295,623,1286,647,1275,684,1246,718,1212,766,1149,771,1152,722,1216,688,1250,650,1279,625,1291,600,1300"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_ae2e50929acc6085cd395d0bd4ddb02db_icgraph.png" border="0" usemap="#acommands_8c_ae2e50929acc6085cd395d0bd4ddb02db_icgraph" alt=""/></div>
<map name="acommands_8c_ae2e50929acc6085cd395d0bd4ddb02db_icgraph" id="acommands_8c_ae2e50929acc6085cd395d0bd4ddb02db_icgraph">
<area shape="rect" title=" " alt="" coords="296,5,434,31"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="281,21,248,21,248,16,281,16"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,55,31"/>
<area shape="poly" title=" " alt="" coords="87,21,55,21,55,16,87,16"/>
</map>
</div>

</div>
</div>
<a id="a1d821476693df49671598a98e7d6dbca" name="a1d821476693df49671598a98e7d6dbca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d821476693df49671598a98e7d6dbca">&#9670;&#160;</a></span>yh_com_blink()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int yh_com_blink </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__context.html">yubihsm_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_argument.html">Argument</a> *</td>          <td class="paramname"><span class="paramname"><em>argv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a></td>          <td class="paramname"><span class="paramname"><em>fmt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="commands_8c_source.html#l00159">159</a> of file <a class="el" href="commands_8c_source.html">commands.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  159</span>                                                                       {</div>
<div class="line"><span class="lineno">  160</span> </div>
<div class="line"><span class="lineno">  161</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(fmt);</div>
<div class="line"><span class="lineno">  162</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ctx);</div>
<div class="line"><span class="lineno">  163</span> </div>
<div class="line"><span class="lineno">  164</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#ad112fe09ee88d595333fa87e8059717b">yh_util_blink_device</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].b);</div>
<div class="line"><span class="lineno">  165</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno">  166</span>    fprintf(stderr, <span class="stringliteral">&quot;Failed to blink the device: %s\n&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno">  167</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  168</span>  }</div>
<div class="line"><span class="lineno">  169</span> </div>
<div class="line"><span class="lineno">  170</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  171</span>}</div>
<div class="ttc" id="ayubihsm_8c_html_ad112fe09ee88d595333fa87e8059717b"><div class="ttname"><a href="yubihsm_8c.html#ad112fe09ee88d595333fa87e8059717b">yh_util_blink_device</a></div><div class="ttdeci">yh_rc yh_util_blink_device(yh_session *session, uint8_t seconds)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l03766">yubihsm.c:3766</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_a1d821476693df49671598a98e7d6dbca_cgraph.png" border="0" usemap="#acommands_8c_a1d821476693df49671598a98e7d6dbca_cgraph" alt=""/></div>
<map name="acommands_8c_a1d821476693df49671598a98e7d6dbca_cgraph" id="acommands_8c_a1d821476693df49671598a98e7d6dbca_cgraph">
<area shape="rect" title=" " alt="" coords="5,179,107,204"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="761,153,844,179"/>
<area shape="poly" title=" " alt="" coords="107,190,293,189,498,181,703,169,745,167,745,172,703,174,498,186,293,194,107,195"/>
<area shape="rect" href="yubihsm_8c.html#ad112fe09ee88d595333fa87e8059717b" title=" " alt="" coords="155,153,293,179"/>
<area shape="poly" title=" " alt="" coords="106,181,139,176,139,182,107,187"/>
<area shape="poly" title=" " alt="" coords="293,164,745,164,745,169,293,169"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="341,103,489,128"/>
<area shape="poly" title=" " alt="" coords="275,150,349,130,350,135,276,155"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="537,53,703,79"/>
<area shape="poly" title=" " alt="" coords="471,99,548,81,549,86,472,105"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="555,103,685,128"/>
<area shape="poly" title=" " alt="" coords="489,113,540,113,540,118,489,118"/>
<area shape="poly" title=" " alt="" coords="682,77,704,88,720,101,729,114,738,127,752,140,757,143,754,148,749,144,734,130,725,117,716,105,701,92,680,82"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="767,55,838,80"/>
<area shape="poly" title=" " alt="" coords="703,64,751,64,751,70,703,69"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="768,5,836,31"/>
<area shape="poly" title=" " alt="" coords="671,50,752,28,754,34,673,55"/>
<area shape="poly" title=" " alt="" coords="670,126,746,148,745,153,668,132"/>
<area shape="poly" title=" " alt="" coords="671,99,751,78,752,83,673,105"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="751,104,854,130"/>
<area shape="poly" title=" " alt="" coords="686,113,735,114,735,119,686,119"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_a1d821476693df49671598a98e7d6dbca_icgraph.png" border="0" usemap="#acommands_8c_a1d821476693df49671598a98e7d6dbca_icgraph" alt=""/></div>
<map name="acommands_8c_a1d821476693df49671598a98e7d6dbca_icgraph" id="acommands_8c_a1d821476693df49671598a98e7d6dbca_icgraph">
<area shape="rect" title=" " alt="" coords="296,31,397,56"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="280,36,248,32,249,26,281,31"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,31,55,56"/>
<area shape="poly" title=" " alt="" coords="280,46,55,46,55,41,280,41"/>
<area shape="poly" title=" " alt="" coords="88,36,55,42,54,37,87,31"/>
</map>
</div>

</div>
</div>
<a id="a0691ab03bd0e40402b2ad5f9a378a541" name="a0691ab03bd0e40402b2ad5f9a378a541"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0691ab03bd0e40402b2ad5f9a378a541">&#9670;&#160;</a></span>yh_com_change_authentication_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int yh_com_change_authentication_key </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__context.html">yubihsm_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_argument.html">Argument</a> *</td>          <td class="paramname"><span class="paramname"><em>argv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a></td>          <td class="paramname"><span class="paramname"><em>fmt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="commands_8c_source.html#l02767">2767</a> of file <a class="el" href="commands_8c_source.html">commands.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2768</span>                                                     {</div>
<div class="line"><span class="lineno"> 2769</span> </div>
<div class="line"><span class="lineno"> 2770</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(fmt);</div>
<div class="line"><span class="lineno"> 2771</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ctx);</div>
<div class="line"><span class="lineno"> 2772</span> </div>
<div class="line"><span class="lineno"> 2773</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#a8761bd8bcffcee4af737bda255ce5e53">yh_util_change_authentication_key_derived</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e, &amp;<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].w,</div>
<div class="line"><span class="lineno"> 2774</span>                                                        <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[2].x, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[2].<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>);</div>
<div class="line"><span class="lineno"> 2775</span>  <a class="code hl_define" href="insecure__memzero_8h.html#a0794f9275fd1036ecba6ff0a901a320b">insecure_memzero</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[2].x, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[2].<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>);</div>
<div class="line"><span class="lineno"> 2776</span> </div>
<div class="line"><span class="lineno"> 2777</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 2778</span>    fprintf(stderr, <span class="stringliteral">&quot;Failed to change authentication key: %s\n&quot;</span>,</div>
<div class="line"><span class="lineno"> 2779</span>            <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 2780</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 2781</span>  }</div>
<div class="line"><span class="lineno"> 2782</span> </div>
<div class="line"><span class="lineno"> 2783</span>  fprintf(stderr, <span class="stringliteral">&quot;Changed Authentication key 0x%04x\n&quot;</span>, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].w);</div>
<div class="line"><span class="lineno"> 2784</span> </div>
<div class="line"><span class="lineno"> 2785</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 2786</span>}</div>
<div class="ttc" id="ainsecure__memzero_8h_html_a0794f9275fd1036ecba6ff0a901a320b"><div class="ttname"><a href="insecure__memzero_8h.html#a0794f9275fd1036ecba6ff0a901a320b">insecure_memzero</a></div><div class="ttdeci">#define insecure_memzero(buf, len)</div><div class="ttdef"><b>Definition</b> <a href="insecure__memzero_8h_source.html#l00031">insecure_memzero.h:31</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_a8761bd8bcffcee4af737bda255ce5e53"><div class="ttname"><a href="yubihsm_8c.html#a8761bd8bcffcee4af737bda255ce5e53">yh_util_change_authentication_key_derived</a></div><div class="ttdeci">yh_rc yh_util_change_authentication_key_derived(yh_session *session, uint16_t *key_id, const uint8_t *password, size_t password_len)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l03155">yubihsm.c:3155</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a7360b55975153b822efc5217b7734e6a"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a></div><div class="ttdeci">size_t len</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l04771">yubihsm_pkcs11.c:4771</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_a0691ab03bd0e40402b2ad5f9a378a541_cgraph.png" border="0" usemap="#acommands_8c_a0691ab03bd0e40402b2ad5f9a378a541_cgraph" alt=""/></div>
<map name="acommands_8c_a0691ab03bd0e40402b2ad5f9a378a541_cgraph" id="acommands_8c_a0691ab03bd0e40402b2ad5f9a378a541_cgraph">
<area shape="rect" title=" " alt="" coords="5,22,238,48"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="1222,94,1305,120"/>
<area shape="poly" title=" " alt="" coords="238,22,427,9,641,3,878,3,926,5,975,11,1070,33,1155,60,1220,85,1218,90,1153,65,1069,38,974,17,926,10,878,8,641,8,427,14,238,27"/>
<area shape="rect" href="yubihsm_8c.html#a8761bd8bcffcee4af737bda255ce5e53" title=" " alt="" coords="286,42,482,83"/>
<area shape="poly" title=" " alt="" coords="239,44,271,48,270,53,238,50"/>
<area shape="poly" title=" " alt="" coords="483,62,787,72,1164,93,1207,97,1206,103,1164,99,787,78,482,67"/>
<area shape="rect" href="yubihsm_8c.html#a8f229874e387887d7c5b4c7e6e07db8e" title=" " alt="" coords="530,119,754,145"/>
<area shape="poly" title=" " alt="" coords="463,81,577,112,576,117,462,86"/>
<area shape="poly" title=" " alt="" coords="755,125,1206,106,1206,112,755,130"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="1228,243,1299,269"/>
<area shape="poly" title=" " alt="" coords="684,143,803,180,900,208,999,229,1114,244,1213,251,1212,256,1113,249,998,235,899,214,802,185,682,148"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="802,144,951,170"/>
<area shape="poly" title=" " alt="" coords="755,142,787,145,787,150,755,147"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="999,144,1164,170"/>
<area shape="poly" title=" " alt="" coords="951,155,983,155,983,160,951,160"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="1016,194,1146,220"/>
<area shape="poly" title=" " alt="" coords="934,168,1011,187,1009,192,932,173"/>
<area shape="poly" title=" " alt="" coords="1130,141,1206,120,1208,125,1131,146"/>
<area shape="poly" title=" " alt="" coords="1143,168,1165,179,1181,192,1191,204,1200,217,1214,230,1218,233,1215,237,1210,234,1196,220,1186,207,1177,195,1163,184,1141,173"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="1230,144,1298,170"/>
<area shape="poly" title=" " alt="" coords="1165,155,1214,155,1214,160,1165,160"/>
<area shape="poly" title=" " alt="" coords="1141,191,1163,180,1177,169,1186,157,1196,144,1210,130,1217,125,1220,130,1214,134,1200,147,1191,160,1181,172,1165,185,1143,196"/>
<area shape="poly" title=" " alt="" coords="1132,218,1214,240,1212,245,1131,223"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="1212,194,1315,220"/>
<area shape="poly" title=" " alt="" coords="1147,204,1196,204,1196,209,1147,209"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_a0691ab03bd0e40402b2ad5f9a378a541_icgraph.png" border="0" usemap="#acommands_8c_a0691ab03bd0e40402b2ad5f9a378a541_icgraph" alt=""/></div>
<map name="acommands_8c_a0691ab03bd0e40402b2ad5f9a378a541_icgraph" id="acommands_8c_a0691ab03bd0e40402b2ad5f9a378a541_icgraph">
<area shape="rect" title=" " alt="" coords="296,5,528,31"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="280,21,248,21,248,16,280,16"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,55,31"/>
<area shape="poly" title=" " alt="" coords="87,21,55,21,55,16,87,16"/>
</map>
</div>

</div>
</div>
<a id="aabb06b0c16a19b4b22478cb753d8f599" name="aabb06b0c16a19b4b22478cb753d8f599"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aabb06b0c16a19b4b22478cb753d8f599">&#9670;&#160;</a></span>yh_com_close_session()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int yh_com_close_session </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__context.html">yubihsm_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_argument.html">Argument</a> *</td>          <td class="paramname"><span class="paramname"><em>argv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a></td>          <td class="paramname"><span class="paramname"><em>fmt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="commands_8c_source.html#l00176">176</a> of file <a class="el" href="commands_8c_source.html">commands.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  176</span>                                                                               {</div>
<div class="line"><span class="lineno">  177</span> </div>
<div class="line"><span class="lineno">  178</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(fmt);</div>
<div class="line"><span class="lineno">  179</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> session_id = 0;</div>
<div class="line"><span class="lineno">  180</span> </div>
<div class="line"><span class="lineno">  181</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#aeabf472faf1ba8d963b39866e04df6b0">yh_get_session_id</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e, &amp;session_id);</div>
<div class="line"><span class="lineno">  182</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno">  183</span>    fprintf(stderr, <span class="stringliteral">&quot;Failed to get session id: %s\n&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno">  184</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  185</span>  }</div>
<div class="line"><span class="lineno">  186</span> </div>
<div class="line"><span class="lineno">  187</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#a61ab8dbab67b1cceb49cd306f8c3f4b1">yh_util_close_session</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e);</div>
<div class="line"><span class="lineno">  188</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno">  189</span>    fprintf(stderr, <span class="stringliteral">&quot;Failed to close session: %s\n&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno">  190</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  191</span>  }</div>
<div class="line"><span class="lineno">  192</span> </div>
<div class="line"><span class="lineno">  193</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#a1a35f8ae5a739848408633a514e41b2d">yh_destroy_session</a>(&amp;<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e);</div>
<div class="line"><span class="lineno">  194</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno">  195</span>    fprintf(stderr, <span class="stringliteral">&quot;Failed to destroy session: %s\n&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno">  196</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  197</span>  }</div>
<div class="line"><span class="lineno">  198</span> </div>
<div class="line"><span class="lineno">  199</span>  ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a7a959752fa285fb4a7a75921bbfa00fe">sessions</a>[session_id] = NULL;</div>
<div class="line"><span class="lineno">  200</span> </div>
<div class="line"><span class="lineno">  201</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  202</span>}</div>
<div class="ttc" id="astructyubihsm__context_html_a7a959752fa285fb4a7a75921bbfa00fe"><div class="ttname"><a href="structyubihsm__context.html#a7a959752fa285fb4a7a75921bbfa00fe">yubihsm_context::sessions</a></div><div class="ttdeci">yh_session * sessions[YH_MAX_SESSIONS]</div><div class="ttdef"><b>Definition</b> <a href="yubihsm-shell_8h_source.html#l00050">yubihsm-shell.h:50</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_a1a35f8ae5a739848408633a514e41b2d"><div class="ttname"><a href="yubihsm_8c.html#a1a35f8ae5a739848408633a514e41b2d">yh_destroy_session</a></div><div class="ttdeci">yh_rc yh_destroy_session(yh_session **session)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l00890">yubihsm.c:890</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_aeabf472faf1ba8d963b39866e04df6b0"><div class="ttname"><a href="yubihsm_8c.html#aeabf472faf1ba8d963b39866e04df6b0">yh_get_session_id</a></div><div class="ttdeci">yh_rc yh_get_session_id(yh_session *session, uint8_t *sid)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l02915">yubihsm.c:2915</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_aabb06b0c16a19b4b22478cb753d8f599_cgraph.png" border="0" usemap="#acommands_8c_aabb06b0c16a19b4b22478cb753d8f599_cgraph" alt=""/></div>
<map name="acommands_8c_aabb06b0c16a19b4b22478cb753d8f599_cgraph" id="acommands_8c_aabb06b0c16a19b4b22478cb753d8f599_cgraph">
<area shape="rect" title=" " alt="" coords="5,63,163,89"/>
<area shape="rect" href="yubihsm_8c.html#a1a35f8ae5a739848408633a514e41b2d" title=" " alt="" coords="414,38,551,64"/>
<area shape="poly" title=" " alt="" coords="163,69,398,54,398,59,163,74"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="828,114,911,140"/>
<area shape="poly" title=" " alt="" coords="128,60,244,32,321,18,406,7,497,3,590,7,682,21,771,48,813,73,846,101,843,105,809,77,769,53,681,26,590,12,497,8,407,13,321,23,245,37,129,65"/>
<area shape="rect" href="yubihsm_8c.html#aeabf472faf1ba8d963b39866e04df6b0" title=" " alt="" coords="221,89,350,114"/>
<area shape="poly" title=" " alt="" coords="164,84,206,89,205,94,163,89"/>
<area shape="rect" href="yubihsm_8c.html#a61ab8dbab67b1cceb49cd306f8c3f4b1" title=" " alt="" coords="211,139,360,165"/>
<area shape="poly" title=" " alt="" coords="118,87,212,124,231,131,229,136,210,129,116,92"/>
<area shape="poly" title=" " alt="" coords="551,50,655,59,713,68,770,80,831,104,829,109,769,85,712,73,655,64,551,55"/>
<area shape="poly" title=" " alt="" coords="351,102,812,122,812,127,350,107"/>
<area shape="poly" title=" " alt="" coords="360,146,812,127,812,132,360,152"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="408,190,556,216"/>
<area shape="poly" title=" " alt="" coords="339,163,415,183,414,188,338,168"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="604,239,770,265"/>
<area shape="poly" title=" " alt="" coords="539,214,616,233,615,238,538,219"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="622,190,752,216"/>
<area shape="poly" title=" " alt="" coords="556,200,607,200,607,206,556,206"/>
<area shape="poly" title=" " alt="" coords="750,237,768,226,784,209,792,190,800,171,816,150,820,146,824,151,820,154,804,173,797,192,789,211,771,230,752,241"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="834,214,905,240"/>
<area shape="poly" title=" " alt="" coords="770,238,818,231,819,237,771,243"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="835,263,904,289"/>
<area shape="poly" title=" " alt="" coords="771,261,820,267,819,272,770,266"/>
<area shape="poly" title=" " alt="" coords="722,187,769,168,824,144,826,149,771,173,724,192"/>
<area shape="poly" title=" " alt="" coords="753,209,819,218,818,223,752,214"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="818,165,921,190"/>
<area shape="poly" title=" " alt="" coords="752,191,802,184,802,190,753,196"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_aabb06b0c16a19b4b22478cb753d8f599_icgraph.png" border="0" usemap="#acommands_8c_aabb06b0c16a19b4b22478cb753d8f599_icgraph" alt=""/></div>
<map name="acommands_8c_aabb06b0c16a19b4b22478cb753d8f599_icgraph" id="acommands_8c_aabb06b0c16a19b4b22478cb753d8f599_icgraph">
<area shape="rect" title=" " alt="" coords="296,5,453,31"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="280,21,248,21,248,16,280,16"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,55,31"/>
<area shape="poly" title=" " alt="" coords="87,21,55,21,55,16,87,16"/>
</map>
</div>

</div>
</div>
<a id="a9155cc4306ad97e58a03ead18637f33b" name="a9155cc4306ad97e58a03ead18637f33b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9155cc4306ad97e58a03ead18637f33b">&#9670;&#160;</a></span>yh_com_connect()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int yh_com_connect </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__context.html">yubihsm_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_argument.html">Argument</a> *</td>          <td class="paramname"><span class="paramname"><em>argv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a></td>          <td class="paramname"><span class="paramname"><em>fmt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="commands_8c_source.html#l00206">206</a> of file <a class="el" href="commands_8c_source.html">commands.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  206</span>                                                                         {</div>
<div class="line"><span class="lineno">  207</span> </div>
<div class="line"><span class="lineno">  208</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>);</div>
<div class="line"><span class="lineno">  209</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(fmt);</div>
<div class="line"><span class="lineno">  210</span>  <span class="keywordtype">int</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a3d854b6efad16a16e4d7b4539d4fc71f">ret</a> = -1;</div>
<div class="line"><span class="lineno">  211</span> </div>
<div class="line"><span class="lineno">  212</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno">  213</span>  <a class="code hl_struct" href="structyh__connector.html">yh_connector</a> **connectors = calloc(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a260f9000b86a557d5d758d498f8e0f51">n_connectors</a>, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structyh__connector.html">yh_connector</a> *));</div>
<div class="line"><span class="lineno">  214</span>  <span class="keywordflow">if</span> (connectors == NULL) {</div>
<div class="line"><span class="lineno">  215</span>    fprintf(stderr, <span class="stringliteral">&quot;Failed allocating memory\n&quot;</span>);</div>
<div class="line"><span class="lineno">  216</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  217</span>  }</div>
<div class="line"><span class="lineno">  218</span> </div>
<div class="line"><span class="lineno">  219</span>  <span class="keywordtype">int</span> <a class="code hl_variable" href="namespacehost__functions__tests__1.html#a8496a24b5236a2dc07bb4f2930d88342">idx</a> = -1;</div>
<div class="line"><span class="lineno">  220</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a260f9000b86a557d5d758d498f8e0f51">n_connectors</a>; i++) {</div>
<div class="line"><span class="lineno">  221</span>    <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#a9c700747902a722d6c1d2073277de294">yh_init_connector</a>(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#ae6f60d6cb3833712a87ecdb42088ccc1">connector_list</a>[i], &amp;connectors[i]);</div>
<div class="line"><span class="lineno">  222</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno">  223</span>      fprintf(stderr, <span class="stringliteral">&quot;Failed initializing connector\n&quot;</span>);</div>
<div class="line"><span class="lineno">  224</span>      <span class="keywordflow">goto</span> cleanup;</div>
<div class="line"><span class="lineno">  225</span>    }</div>
<div class="line"><span class="lineno">  226</span>    <span class="keywordflow">if</span> (ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a97d98362b0e43b749a9cb75da4793932">cacert</a>) {</div>
<div class="line"><span class="lineno">  227</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="yubihsm_8c.html#a9addbfae4cdb70b819986e7769cdd102">yh_set_connector_option</a>(connectors[i], <a class="code hl_enumvalue" href="yubihsm_8h.html#a59400bce0478b88e048d5e62b2b0b015aef4e49a3018eee6219e6fdee93b32386">YH_CONNECTOR_HTTPS_CA</a>,</div>
<div class="line"><span class="lineno">  228</span>                                  ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a97d98362b0e43b749a9cb75da4793932">cacert</a>) != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno">  229</span>        fprintf(stderr, <span class="stringliteral">&quot;Failed setting HTTPS CA\n&quot;</span>);</div>
<div class="line"><span class="lineno">  230</span>        <span class="keywordflow">goto</span> cleanup;</div>
<div class="line"><span class="lineno">  231</span>      }</div>
<div class="line"><span class="lineno">  232</span>    }</div>
<div class="line"><span class="lineno">  233</span>    <span class="keywordflow">if</span> (ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#aa2578fc399603af54de958824179cae4">proxy</a>) {</div>
<div class="line"><span class="lineno">  234</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="yubihsm_8c.html#a9addbfae4cdb70b819986e7769cdd102">yh_set_connector_option</a>(connectors[i], <a class="code hl_enumvalue" href="yubihsm_8h.html#a59400bce0478b88e048d5e62b2b0b015a90c65d2ccea0060d121c9c60b3a8b2df">YH_CONNECTOR_PROXY_SERVER</a>,</div>
<div class="line"><span class="lineno">  235</span>                                  ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#aa2578fc399603af54de958824179cae4">proxy</a>) != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno">  236</span>        fprintf(stderr, <span class="stringliteral">&quot;Failed setting proxy server\n&quot;</span>);</div>
<div class="line"><span class="lineno">  237</span>        <span class="keywordflow">goto</span> cleanup;</div>
<div class="line"><span class="lineno">  238</span>      }</div>
<div class="line"><span class="lineno">  239</span>    }</div>
<div class="line"><span class="lineno">  240</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="yubihsm_8c.html#aa19be6ac70a2a5d1cef8d7e6902fe05f">yh_connect</a>(connectors[i], 0) != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno">  241</span>      fprintf(stderr, <span class="stringliteral">&quot;Failed connecting &#39;%s&#39;\n&quot;</span>, ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#ae6f60d6cb3833712a87ecdb42088ccc1">connector_list</a>[i]);</div>
<div class="line"><span class="lineno">  242</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  243</span>    }</div>
<div class="line"><span class="lineno">  244</span>    <a class="code hl_variable" href="namespacehost__functions__tests__1.html#a8496a24b5236a2dc07bb4f2930d88342">idx</a> = i;</div>
<div class="line"><span class="lineno">  245</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  246</span>  }</div>
<div class="line"><span class="lineno">  247</span> </div>
<div class="line"><span class="lineno">  248</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a260f9000b86a557d5d758d498f8e0f51">n_connectors</a>; i++) {</div>
<div class="line"><span class="lineno">  249</span>    <span class="keywordflow">if</span> (i == idx) {</div>
<div class="line"><span class="lineno">  250</span>      ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a8c52c1a89cd4334a0225a1fbfba9a930">connector</a> = connectors[i];</div>
<div class="line"><span class="lineno">  251</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  252</span>      <a class="code hl_function" href="yubihsm_8c.html#ab12d5a42d2219741bd3630b99ed1c7d2">yh_disconnect</a>(connectors[i]);</div>
<div class="line"><span class="lineno">  253</span>    }</div>
<div class="line"><span class="lineno">  254</span>  }</div>
<div class="line"><span class="lineno">  255</span> </div>
<div class="line"><span class="lineno">  256</span>  <span class="keywordflow">if</span> (idx &gt;= 0) {</div>
<div class="line"><span class="lineno">  257</span>    <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a3d854b6efad16a16e4d7b4539d4fc71f">ret</a> = 0;</div>
<div class="line"><span class="lineno">  258</span> </div>
<div class="line"><span class="lineno">  259</span>    (void) <a class="code hl_function" href="commands_8h.html#a5530032f495d88f8b95a38f8fcd50da8">yh_com_keepalive_on</a>(NULL, NULL, <a class="code hl_enumvalue" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740">fmt_nofmt</a>);</div>
<div class="line"><span class="lineno">  260</span>  }</div>
<div class="line"><span class="lineno">  261</span> </div>
<div class="line"><span class="lineno">  262</span>cleanup:</div>
<div class="line"><span class="lineno">  263</span>  free(connectors);</div>
<div class="line"><span class="lineno">  264</span> </div>
<div class="line"><span class="lineno">  265</span>  <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a3d854b6efad16a16e4d7b4539d4fc71f">ret</a>;</div>
<div class="line"><span class="lineno">  266</span>}</div>
<div class="ttc" id="acommands_8h_html_a5530032f495d88f8b95a38f8fcd50da8"><div class="ttname"><a href="commands_8h.html#a5530032f495d88f8b95a38f8fcd50da8">yh_com_keepalive_on</a></div><div class="ttdeci">int yh_com_keepalive_on(yubihsm_context *ctx, Argument *argv, cmd_format fmt)</div><div class="ttdef"><b>Definition</b> <a href="src_2main_8c_source.html#l00763">main.c:763</a></div></div>
<div class="ttc" id="anamespacehost__functions__tests__1_html_a8496a24b5236a2dc07bb4f2930d88342"><div class="ttname"><a href="namespacehost__functions__tests__1.html#a8496a24b5236a2dc07bb4f2930d88342">host_functions_tests_1.idx</a></div><div class="ttdeci">int idx</div><div class="ttdef"><b>Definition</b> <a href="host__functions__tests__1_8py_source.html#l00021">host_functions_tests_1.py:21</a></div></div>
<div class="ttc" id="astructyh__connector_html"><div class="ttname"><a href="structyh__connector.html">yh_connector</a></div><div class="ttdef"><b>Definition</b> <a href="lib_2internal_8h_source.html#l00037">internal.h:37</a></div></div>
<div class="ttc" id="astructyubihsm__context_html_a260f9000b86a557d5d758d498f8e0f51"><div class="ttname"><a href="structyubihsm__context.html#a260f9000b86a557d5d758d498f8e0f51">yubihsm_context::n_connectors</a></div><div class="ttdeci">int n_connectors</div><div class="ttdef"><b>Definition</b> <a href="yubihsm-shell_8h_source.html#l00049">yubihsm-shell.h:49</a></div></div>
<div class="ttc" id="astructyubihsm__context_html_a97d98362b0e43b749a9cb75da4793932"><div class="ttname"><a href="structyubihsm__context.html#a97d98362b0e43b749a9cb75da4793932">yubihsm_context::cacert</a></div><div class="ttdeci">char * cacert</div><div class="ttdef"><b>Definition</b> <a href="yubihsm-shell_8h_source.html#l00055">yubihsm-shell.h:55</a></div></div>
<div class="ttc" id="astructyubihsm__context_html_aa2578fc399603af54de958824179cae4"><div class="ttname"><a href="structyubihsm__context.html#aa2578fc399603af54de958824179cae4">yubihsm_context::proxy</a></div><div class="ttdeci">char * proxy</div><div class="ttdef"><b>Definition</b> <a href="yubihsm-shell_8h_source.html#l00056">yubihsm-shell.h:56</a></div></div>
<div class="ttc" id="astructyubihsm__context_html_ae6f60d6cb3833712a87ecdb42088ccc1"><div class="ttname"><a href="structyubihsm__context.html#ae6f60d6cb3833712a87ecdb42088ccc1">yubihsm_context::connector_list</a></div><div class="ttdeci">char ** connector_list</div><div class="ttdef"><b>Definition</b> <a href="yubihsm-shell_8h_source.html#l00047">yubihsm-shell.h:47</a></div></div>
<div class="ttc" id="ayubihsm-shell_8h_html_a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740"><div class="ttname"><a href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708a499429c2fb9763bdca869915d60d3740">fmt_nofmt</a></div><div class="ttdeci">@ fmt_nofmt</div><div class="ttdef"><b>Definition</b> <a href="yubihsm-shell_8h_source.html#l00029">yubihsm-shell.h:29</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_a9addbfae4cdb70b819986e7769cdd102"><div class="ttname"><a href="yubihsm_8c.html#a9addbfae4cdb70b819986e7769cdd102">yh_set_connector_option</a></div><div class="ttdeci">yh_rc yh_set_connector_option(yh_connector *connector, yh_connector_option opt, const void *val)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l04063">yubihsm.c:4063</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_a9c700747902a722d6c1d2073277de294"><div class="ttname"><a href="yubihsm_8c.html#a9c700747902a722d6c1d2073277de294">yh_init_connector</a></div><div class="ttdeci">yh_rc yh_init_connector(const char *url, yh_connector **connector)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l04024">yubihsm.c:4024</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_aa19be6ac70a2a5d1cef8d7e6902fe05f"><div class="ttname"><a href="yubihsm_8c.html#aa19be6ac70a2a5d1cef8d7e6902fe05f">yh_connect</a></div><div class="ttdeci">yh_rc yh_connect(yh_connector *connector, int timeout)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l04079">yubihsm.c:4079</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_ab12d5a42d2219741bd3630b99ed1c7d2"><div class="ttname"><a href="yubihsm_8c.html#ab12d5a42d2219741bd3630b99ed1c7d2">yh_disconnect</a></div><div class="ttdeci">yh_rc yh_disconnect(yh_connector *connector)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l04097">yubihsm.c:4097</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a59400bce0478b88e048d5e62b2b0b015a90c65d2ccea0060d121c9c60b3a8b2df"><div class="ttname"><a href="yubihsm_8h.html#a59400bce0478b88e048d5e62b2b0b015a90c65d2ccea0060d121c9c60b3a8b2df">YH_CONNECTOR_PROXY_SERVER</a></div><div class="ttdeci">@ YH_CONNECTOR_PROXY_SERVER</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00506">yubihsm.h:506</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a59400bce0478b88e048d5e62b2b0b015aef4e49a3018eee6219e6fdee93b32386"><div class="ttname"><a href="yubihsm_8h.html#a59400bce0478b88e048d5e62b2b0b015aef4e49a3018eee6219e6fdee93b32386">YH_CONNECTOR_HTTPS_CA</a></div><div class="ttdeci">@ YH_CONNECTOR_HTTPS_CA</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00503">yubihsm.h:503</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a3d854b6efad16a16e4d7b4539d4fc71f"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a3d854b6efad16a16e4d7b4539d4fc71f">ret</a></div><div class="ttdeci">CK_RV ret</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l00973">yubihsm_pkcs11.c:973</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_a9155cc4306ad97e58a03ead18637f33b_cgraph.png" border="0" usemap="#acommands_8c_a9155cc4306ad97e58a03ead18637f33b_cgraph" alt=""/></div>
<map name="acommands_8c_a9155cc4306ad97e58a03ead18637f33b_cgraph" id="acommands_8c_a9155cc4306ad97e58a03ead18637f33b_cgraph">
<area shape="rect" title=" " alt="" coords="5,104,126,130"/>
<area shape="rect" href="src_2main_8c.html#a5530032f495d88f8b95a38f8fcd50da8" title=" " alt="" coords="182,5,332,31"/>
<area shape="poly" title=" " alt="" coords="81,101,121,71,172,40,185,34,187,39,175,45,124,75,84,106"/>
<area shape="rect" href="yubihsm_8c.html#aa19be6ac70a2a5d1cef8d7e6902fe05f" title=" " alt="" coords="213,55,301,80"/>
<area shape="poly" title=" " alt="" coords="118,101,197,80,198,85,119,106"/>
<area shape="rect" href="yubihsm_8c.html#ab12d5a42d2219741bd3630b99ed1c7d2" title=" " alt="" coords="204,104,310,130"/>
<area shape="poly" title=" " alt="" coords="126,114,188,114,188,120,126,120"/>
<area shape="rect" href="yubihsm_8c.html#a9c700747902a722d6c1d2073277de294" title=" " alt="" coords="195,153,318,179"/>
<area shape="poly" title=" " alt="" coords="119,128,190,146,188,151,118,133"/>
<area shape="rect" href="yubihsm_8c.html#a9addbfae4cdb70b819986e7769cdd102" title=" " alt="" coords="174,203,340,228"/>
<area shape="poly" title=" " alt="" coords="84,128,124,159,175,189,187,195,185,199,172,194,121,163,81,132"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="388,80,471,106"/>
<area shape="poly" title=" " alt="" coords="302,71,373,82,372,87,301,77"/>
<area shape="poly" title=" " alt="" coords="310,107,372,98,373,103,311,112"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_a9155cc4306ad97e58a03ead18637f33b_icgraph.png" border="0" usemap="#acommands_8c_a9155cc4306ad97e58a03ead18637f33b_icgraph" alt=""/></div>
<map name="acommands_8c_a9155cc4306ad97e58a03ead18637f33b_icgraph" id="acommands_8c_a9155cc4306ad97e58a03ead18637f33b_icgraph">
<area shape="rect" title=" " alt="" coords="296,31,416,56"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="280,36,248,31,248,26,281,30"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,31,55,56"/>
<area shape="poly" title=" " alt="" coords="281,46,55,46,55,41,281,41"/>
<area shape="poly" title=" " alt="" coords="88,36,55,42,54,37,87,31"/>
</map>
</div>

</div>
</div>
<a id="ad8a6eb16c04ad3e525f8be152062ff24" name="ad8a6eb16c04ad3e525f8be152062ff24"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad8a6eb16c04ad3e525f8be152062ff24">&#9670;&#160;</a></span>yh_com_debug_all()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int yh_com_debug_all </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__context.html">yubihsm_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_argument.html">Argument</a> *</td>          <td class="paramname"><span class="paramname"><em>argv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a></td>          <td class="paramname"><span class="paramname"><em>fmt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="commands_8c_source.html#l00270">270</a> of file <a class="el" href="commands_8c_source.html">commands.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  270</span>                                                                           {</div>
<div class="line"><span class="lineno">  271</span> </div>
<div class="line"><span class="lineno">  272</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ctx);</div>
<div class="line"><span class="lineno">  273</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>);</div>
<div class="line"><span class="lineno">  274</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(fmt);</div>
<div class="line"><span class="lineno">  275</span> </div>
<div class="line"><span class="lineno">  276</span>  <a class="code hl_function" href="yubihsm_8c.html#a24c3146e51242256af505961e763f417">yh_set_verbosity</a>(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a8c52c1a89cd4334a0225a1fbfba9a930">connector</a>, <a class="code hl_define" href="yubihsm_8h.html#a15dbe0ac973691939ca6e9148b181ccd">YH_VERB_ALL</a>);</div>
<div class="line"><span class="lineno">  277</span>  fprintf(stderr, <span class="stringliteral">&quot;Debug messages enabled\n&quot;</span>);</div>
<div class="line"><span class="lineno">  278</span> </div>
<div class="line"><span class="lineno">  279</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  280</span>}</div>
<div class="ttc" id="ayubihsm_8c_html_a24c3146e51242256af505961e763f417"><div class="ttname"><a href="yubihsm_8c.html#a24c3146e51242256af505961e763f417">yh_set_verbosity</a></div><div class="ttdeci">yh_rc yh_set_verbosity(yh_connector *connector, uint8_t verbosity)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l03825">yubihsm.c:3825</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a15dbe0ac973691939ca6e9148b181ccd"><div class="ttname"><a href="yubihsm_8h.html#a15dbe0ac973691939ca6e9148b181ccd">YH_VERB_ALL</a></div><div class="ttdeci">#define YH_VERB_ALL</div><div class="ttdoc">Debug level all. All previous options enabled.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00145">yubihsm.h:145</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_ad8a6eb16c04ad3e525f8be152062ff24_cgraph.png" border="0" usemap="#acommands_8c_ad8a6eb16c04ad3e525f8be152062ff24_cgraph" alt=""/></div>
<map name="acommands_8c_ad8a6eb16c04ad3e525f8be152062ff24_cgraph" id="acommands_8c_ad8a6eb16c04ad3e525f8be152062ff24_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,135,31"/>
<area shape="rect" href="yubihsm_8c.html#a24c3146e51242256af505961e763f417" title=" " alt="" coords="183,5,303,31"/>
<area shape="poly" title=" " alt="" coords="135,16,167,16,167,21,135,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_ad8a6eb16c04ad3e525f8be152062ff24_icgraph.png" border="0" usemap="#acommands_8c_ad8a6eb16c04ad3e525f8be152062ff24_icgraph" alt=""/></div>
<map name="acommands_8c_ad8a6eb16c04ad3e525f8be152062ff24_icgraph" id="acommands_8c_ad8a6eb16c04ad3e525f8be152062ff24_icgraph">
<area shape="rect" title=" " alt="" coords="296,5,425,31"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="280,21,248,21,248,16,280,16"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,55,31"/>
<area shape="poly" title=" " alt="" coords="87,21,55,21,55,16,87,16"/>
</map>
</div>

</div>
</div>
<a id="af5cc531118346eb9389b42149112acdc" name="af5cc531118346eb9389b42149112acdc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5cc531118346eb9389b42149112acdc">&#9670;&#160;</a></span>yh_com_debug_crypto()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int yh_com_debug_crypto </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__context.html">yubihsm_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_argument.html">Argument</a> *</td>          <td class="paramname"><span class="paramname"><em>argv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a></td>          <td class="paramname"><span class="paramname"><em>fmt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="commands_8c_source.html#l00391">391</a> of file <a class="el" href="commands_8c_source.html">commands.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  391</span>                                                                              {</div>
<div class="line"><span class="lineno">  392</span> </div>
<div class="line"><span class="lineno">  393</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ctx);</div>
<div class="line"><span class="lineno">  394</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>);</div>
<div class="line"><span class="lineno">  395</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(fmt);</div>
<div class="line"><span class="lineno">  396</span> </div>
<div class="line"><span class="lineno">  397</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> yh_verbosity;</div>
<div class="line"><span class="lineno">  398</span> </div>
<div class="line"><span class="lineno">  399</span>  <a class="code hl_function" href="yubihsm_8c.html#a17d49ccb12b100e98d8b99585a705444">yh_get_verbosity</a>(&amp;yh_verbosity);</div>
<div class="line"><span class="lineno">  400</span>  yh_verbosity ^= <a class="code hl_define" href="yubihsm_8h.html#a8881b983de3922f9abb5d1fcc99216e2">YH_VERB_CRYPTO</a>;</div>
<div class="line"><span class="lineno">  401</span> </div>
<div class="line"><span class="lineno">  402</span>  <span class="keywordflow">if</span> (yh_verbosity &amp; <a class="code hl_define" href="yubihsm_8h.html#a8881b983de3922f9abb5d1fcc99216e2">YH_VERB_CRYPTO</a>)</div>
<div class="line"><span class="lineno">  403</span>    fprintf(stderr, <span class="stringliteral">&quot;Crypto messages on\n&quot;</span>);</div>
<div class="line"><span class="lineno">  404</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  405</span>    fprintf(stderr, <span class="stringliteral">&quot;Crypto messages off\n&quot;</span>);</div>
<div class="line"><span class="lineno">  406</span> </div>
<div class="line"><span class="lineno">  407</span>  <a class="code hl_function" href="yubihsm_8c.html#a24c3146e51242256af505961e763f417">yh_set_verbosity</a>(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a8c52c1a89cd4334a0225a1fbfba9a930">connector</a>, yh_verbosity);</div>
<div class="line"><span class="lineno">  408</span> </div>
<div class="line"><span class="lineno">  409</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  410</span>}</div>
<div class="ttc" id="ayubihsm_8c_html_a17d49ccb12b100e98d8b99585a705444"><div class="ttname"><a href="yubihsm_8c.html#a17d49ccb12b100e98d8b99585a705444">yh_get_verbosity</a></div><div class="ttdeci">yh_rc yh_get_verbosity(uint8_t *verbosity)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l03837">yubihsm.c:3837</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a8881b983de3922f9abb5d1fcc99216e2"><div class="ttname"><a href="yubihsm_8h.html#a8881b983de3922f9abb5d1fcc99216e2">YH_VERB_CRYPTO</a></div><div class="ttdeci">#define YH_VERB_CRYPTO</div><div class="ttdoc">Debug level crypto. Crypto results printed out.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00137">yubihsm.h:137</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_af5cc531118346eb9389b42149112acdc_cgraph.png" border="0" usemap="#acommands_8c_af5cc531118346eb9389b42149112acdc_cgraph" alt=""/></div>
<map name="acommands_8c_af5cc531118346eb9389b42149112acdc_cgraph" id="acommands_8c_af5cc531118346eb9389b42149112acdc_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,158,56"/>
<area shape="rect" href="yubihsm_8c.html#a17d49ccb12b100e98d8b99585a705444" title=" " alt="" coords="206,5,326,31"/>
<area shape="poly" title=" " alt="" coords="158,30,190,26,190,31,159,36"/>
<area shape="rect" href="yubihsm_8c.html#a24c3146e51242256af505961e763f417" title=" " alt="" coords="206,55,326,80"/>
<area shape="poly" title=" " alt="" coords="159,51,190,55,190,60,158,56"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_af5cc531118346eb9389b42149112acdc_icgraph.png" border="0" usemap="#acommands_8c_af5cc531118346eb9389b42149112acdc_icgraph" alt=""/></div>
<map name="acommands_8c_af5cc531118346eb9389b42149112acdc_icgraph" id="acommands_8c_af5cc531118346eb9389b42149112acdc_icgraph">
<area shape="rect" title=" " alt="" coords="296,5,448,31"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="281,21,248,21,248,16,281,16"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,55,31"/>
<area shape="poly" title=" " alt="" coords="87,21,55,21,55,16,87,16"/>
</map>
</div>

</div>
</div>
<a id="af045c2e8a570dc8fed3d339e75d26feb" name="af045c2e8a570dc8fed3d339e75d26feb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af045c2e8a570dc8fed3d339e75d26feb">&#9670;&#160;</a></span>yh_com_debug_error()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int yh_com_debug_error </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__context.html">yubihsm_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_argument.html">Argument</a> *</td>          <td class="paramname"><span class="paramname"><em>argv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a></td>          <td class="paramname"><span class="paramname"><em>fmt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="commands_8c_source.html#l00284">284</a> of file <a class="el" href="commands_8c_source.html">commands.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  284</span>                                                                             {</div>
<div class="line"><span class="lineno">  285</span> </div>
<div class="line"><span class="lineno">  286</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ctx);</div>
<div class="line"><span class="lineno">  287</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>);</div>
<div class="line"><span class="lineno">  288</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(fmt);</div>
<div class="line"><span class="lineno">  289</span> </div>
<div class="line"><span class="lineno">  290</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> yh_verbosity;</div>
<div class="line"><span class="lineno">  291</span> </div>
<div class="line"><span class="lineno">  292</span>  <a class="code hl_function" href="yubihsm_8c.html#a17d49ccb12b100e98d8b99585a705444">yh_get_verbosity</a>(&amp;yh_verbosity);</div>
<div class="line"><span class="lineno">  293</span>  yh_verbosity ^= <a class="code hl_define" href="yubihsm_8h.html#a978bb82a3974b6778aadb56fa450e8ca">YH_VERB_ERR</a>;</div>
<div class="line"><span class="lineno">  294</span> </div>
<div class="line"><span class="lineno">  295</span>  <span class="keywordflow">if</span> (yh_verbosity &amp; <a class="code hl_define" href="yubihsm_8h.html#a978bb82a3974b6778aadb56fa450e8ca">YH_VERB_ERR</a>)</div>
<div class="line"><span class="lineno">  296</span>    fprintf(stderr, <span class="stringliteral">&quot;Error messages on\n&quot;</span>);</div>
<div class="line"><span class="lineno">  297</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  298</span>    fprintf(stderr, <span class="stringliteral">&quot;Error messages off\n&quot;</span>);</div>
<div class="line"><span class="lineno">  299</span> </div>
<div class="line"><span class="lineno">  300</span>  <a class="code hl_function" href="yubihsm_8c.html#a24c3146e51242256af505961e763f417">yh_set_verbosity</a>(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a8c52c1a89cd4334a0225a1fbfba9a930">connector</a>, yh_verbosity);</div>
<div class="line"><span class="lineno">  301</span> </div>
<div class="line"><span class="lineno">  302</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  303</span>}</div>
<div class="ttc" id="ayubihsm_8h_html_a978bb82a3974b6778aadb56fa450e8ca"><div class="ttname"><a href="yubihsm_8h.html#a978bb82a3974b6778aadb56fa450e8ca">YH_VERB_ERR</a></div><div class="ttdeci">#define YH_VERB_ERR</div><div class="ttdoc">Debug level error. Error messages printed out.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00143">yubihsm.h:143</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_af045c2e8a570dc8fed3d339e75d26feb_cgraph.png" border="0" usemap="#acommands_8c_af045c2e8a570dc8fed3d339e75d26feb_cgraph" alt=""/></div>
<map name="acommands_8c_af045c2e8a570dc8fed3d339e75d26feb_cgraph" id="acommands_8c_af045c2e8a570dc8fed3d339e75d26feb_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,148,56"/>
<area shape="rect" href="yubihsm_8c.html#a17d49ccb12b100e98d8b99585a705444" title=" " alt="" coords="196,5,316,31"/>
<area shape="poly" title=" " alt="" coords="148,31,180,26,181,31,149,36"/>
<area shape="rect" href="yubihsm_8c.html#a24c3146e51242256af505961e763f417" title=" " alt="" coords="196,55,316,80"/>
<area shape="poly" title=" " alt="" coords="149,50,180,55,180,60,148,56"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_af045c2e8a570dc8fed3d339e75d26feb_icgraph.png" border="0" usemap="#acommands_8c_af045c2e8a570dc8fed3d339e75d26feb_icgraph" alt=""/></div>
<map name="acommands_8c_af045c2e8a570dc8fed3d339e75d26feb_icgraph" id="acommands_8c_af045c2e8a570dc8fed3d339e75d26feb_icgraph">
<area shape="rect" title=" " alt="" coords="296,5,438,31"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="280,21,248,21,248,16,280,16"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,55,31"/>
<area shape="poly" title=" " alt="" coords="87,21,55,21,55,16,87,16"/>
</map>
</div>

</div>
</div>
<a id="a774b8dbc4c8d855527e518270206bb52" name="a774b8dbc4c8d855527e518270206bb52"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a774b8dbc4c8d855527e518270206bb52">&#9670;&#160;</a></span>yh_com_debug_info()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int yh_com_debug_info </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__context.html">yubihsm_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_argument.html">Argument</a> *</td>          <td class="paramname"><span class="paramname"><em>argv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a></td>          <td class="paramname"><span class="paramname"><em>fmt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="commands_8c_source.html#l00307">307</a> of file <a class="el" href="commands_8c_source.html">commands.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  307</span>                                                                            {</div>
<div class="line"><span class="lineno">  308</span> </div>
<div class="line"><span class="lineno">  309</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ctx);</div>
<div class="line"><span class="lineno">  310</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>);</div>
<div class="line"><span class="lineno">  311</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(fmt);</div>
<div class="line"><span class="lineno">  312</span> </div>
<div class="line"><span class="lineno">  313</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> yh_verbosity;</div>
<div class="line"><span class="lineno">  314</span> </div>
<div class="line"><span class="lineno">  315</span>  <a class="code hl_function" href="yubihsm_8c.html#a17d49ccb12b100e98d8b99585a705444">yh_get_verbosity</a>(&amp;yh_verbosity);</div>
<div class="line"><span class="lineno">  316</span>  yh_verbosity ^= <a class="code hl_define" href="yubihsm_8h.html#a2ac0b183de01f2dc9f64372e6c66bba4">YH_VERB_INFO</a>;</div>
<div class="line"><span class="lineno">  317</span> </div>
<div class="line"><span class="lineno">  318</span>  <span class="keywordflow">if</span> (yh_verbosity &amp; <a class="code hl_define" href="yubihsm_8h.html#a2ac0b183de01f2dc9f64372e6c66bba4">YH_VERB_INFO</a>)</div>
<div class="line"><span class="lineno">  319</span>    fprintf(stderr, <span class="stringliteral">&quot;Info messages on\n&quot;</span>);</div>
<div class="line"><span class="lineno">  320</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  321</span>    fprintf(stderr, <span class="stringliteral">&quot;Info messages off\n&quot;</span>);</div>
<div class="line"><span class="lineno">  322</span> </div>
<div class="line"><span class="lineno">  323</span>  <a class="code hl_function" href="yubihsm_8c.html#a24c3146e51242256af505961e763f417">yh_set_verbosity</a>(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a8c52c1a89cd4334a0225a1fbfba9a930">connector</a>, yh_verbosity);</div>
<div class="line"><span class="lineno">  324</span> </div>
<div class="line"><span class="lineno">  325</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  326</span>}</div>
<div class="ttc" id="ayubihsm_8h_html_a2ac0b183de01f2dc9f64372e6c66bba4"><div class="ttname"><a href="yubihsm_8h.html#a2ac0b183de01f2dc9f64372e6c66bba4">YH_VERB_INFO</a></div><div class="ttdeci">#define YH_VERB_INFO</div><div class="ttdoc">Debug level info. General information messages printed out.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00141">yubihsm.h:141</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_a774b8dbc4c8d855527e518270206bb52_cgraph.png" border="0" usemap="#acommands_8c_a774b8dbc4c8d855527e518270206bb52_cgraph" alt=""/></div>
<map name="acommands_8c_a774b8dbc4c8d855527e518270206bb52_cgraph" id="acommands_8c_a774b8dbc4c8d855527e518270206bb52_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,143,56"/>
<area shape="rect" href="yubihsm_8c.html#a17d49ccb12b100e98d8b99585a705444" title=" " alt="" coords="191,5,311,31"/>
<area shape="poly" title=" " alt="" coords="143,31,174,26,175,32,144,36"/>
<area shape="rect" href="yubihsm_8c.html#a24c3146e51242256af505961e763f417" title=" " alt="" coords="191,55,311,80"/>
<area shape="poly" title=" " alt="" coords="144,50,175,55,175,60,143,55"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_a774b8dbc4c8d855527e518270206bb52_icgraph.png" border="0" usemap="#acommands_8c_a774b8dbc4c8d855527e518270206bb52_icgraph" alt=""/></div>
<map name="acommands_8c_a774b8dbc4c8d855527e518270206bb52_icgraph" id="acommands_8c_a774b8dbc4c8d855527e518270206bb52_icgraph">
<area shape="rect" title=" " alt="" coords="296,5,433,31"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="280,21,249,21,249,16,280,16"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,55,31"/>
<area shape="poly" title=" " alt="" coords="87,21,55,21,55,16,87,16"/>
</map>
</div>

</div>
</div>
<a id="ad621ced8cc22f103e049f17717d0b3d8" name="ad621ced8cc22f103e049f17717d0b3d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad621ced8cc22f103e049f17717d0b3d8">&#9670;&#160;</a></span>yh_com_debug_intermediate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int yh_com_debug_intermediate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__context.html">yubihsm_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_argument.html">Argument</a> *</td>          <td class="paramname"><span class="paramname"><em>argv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a></td>          <td class="paramname"><span class="paramname"><em>fmt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="commands_8c_source.html#l00330">330</a> of file <a class="el" href="commands_8c_source.html">commands.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  331</span>                                              {</div>
<div class="line"><span class="lineno">  332</span> </div>
<div class="line"><span class="lineno">  333</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ctx);</div>
<div class="line"><span class="lineno">  334</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>);</div>
<div class="line"><span class="lineno">  335</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(fmt);</div>
<div class="line"><span class="lineno">  336</span> </div>
<div class="line"><span class="lineno">  337</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> yh_verbosity;</div>
<div class="line"><span class="lineno">  338</span> </div>
<div class="line"><span class="lineno">  339</span>  <a class="code hl_function" href="yubihsm_8c.html#a17d49ccb12b100e98d8b99585a705444">yh_get_verbosity</a>(&amp;yh_verbosity);</div>
<div class="line"><span class="lineno">  340</span>  yh_verbosity ^= <a class="code hl_define" href="yubihsm_8h.html#af507fefd9d19bfd531277a6c6cb56452">YH_VERB_INTERMEDIATE</a>;</div>
<div class="line"><span class="lineno">  341</span> </div>
<div class="line"><span class="lineno">  342</span>  <span class="keywordflow">if</span> (yh_verbosity &amp; <a class="code hl_define" href="yubihsm_8h.html#af507fefd9d19bfd531277a6c6cb56452">YH_VERB_INTERMEDIATE</a>)</div>
<div class="line"><span class="lineno">  343</span>    fprintf(stderr, <span class="stringliteral">&quot;Intermediate messages on\n&quot;</span>);</div>
<div class="line"><span class="lineno">  344</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  345</span>    fprintf(stderr, <span class="stringliteral">&quot;Intermediate messages off\n&quot;</span>);</div>
<div class="line"><span class="lineno">  346</span> </div>
<div class="line"><span class="lineno">  347</span>  <a class="code hl_function" href="yubihsm_8c.html#a24c3146e51242256af505961e763f417">yh_set_verbosity</a>(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a8c52c1a89cd4334a0225a1fbfba9a930">connector</a>, yh_verbosity);</div>
<div class="line"><span class="lineno">  348</span> </div>
<div class="line"><span class="lineno">  349</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  350</span>}</div>
<div class="ttc" id="ayubihsm_8h_html_af507fefd9d19bfd531277a6c6cb56452"><div class="ttname"><a href="yubihsm_8h.html#af507fefd9d19bfd531277a6c6cb56452">YH_VERB_INTERMEDIATE</a></div><div class="ttdeci">#define YH_VERB_INTERMEDIATE</div><div class="ttdoc">Debug level intermediate. Intermediate results printed out.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00135">yubihsm.h:135</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_ad621ced8cc22f103e049f17717d0b3d8_cgraph.png" border="0" usemap="#acommands_8c_ad621ced8cc22f103e049f17717d0b3d8_cgraph" alt=""/></div>
<map name="acommands_8c_ad621ced8cc22f103e049f17717d0b3d8_cgraph" id="acommands_8c_ad621ced8cc22f103e049f17717d0b3d8_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,193,56"/>
<area shape="rect" href="yubihsm_8c.html#a17d49ccb12b100e98d8b99585a705444" title=" " alt="" coords="241,5,361,31"/>
<area shape="poly" title=" " alt="" coords="193,29,225,25,225,30,193,34"/>
<area shape="rect" href="yubihsm_8c.html#a24c3146e51242256af505961e763f417" title=" " alt="" coords="241,55,361,80"/>
<area shape="poly" title=" " alt="" coords="193,52,225,56,225,61,193,57"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_ad621ced8cc22f103e049f17717d0b3d8_icgraph.png" border="0" usemap="#acommands_8c_ad621ced8cc22f103e049f17717d0b3d8_icgraph" alt=""/></div>
<map name="acommands_8c_ad621ced8cc22f103e049f17717d0b3d8_icgraph" id="acommands_8c_ad621ced8cc22f103e049f17717d0b3d8_icgraph">
<area shape="rect" title=" " alt="" coords="296,5,483,31"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="280,21,248,21,248,16,280,16"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,55,31"/>
<area shape="poly" title=" " alt="" coords="87,21,55,21,55,16,87,16"/>
</map>
</div>

</div>
</div>
<a id="ac8470d4c5dc4fa0d300bcf171a16140b" name="ac8470d4c5dc4fa0d300bcf171a16140b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8470d4c5dc4fa0d300bcf171a16140b">&#9670;&#160;</a></span>yh_com_debug_none()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int yh_com_debug_none </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__context.html">yubihsm_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_argument.html">Argument</a> *</td>          <td class="paramname"><span class="paramname"><em>argv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a></td>          <td class="paramname"><span class="paramname"><em>fmt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="commands_8c_source.html#l00354">354</a> of file <a class="el" href="commands_8c_source.html">commands.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  354</span>                                                                            {</div>
<div class="line"><span class="lineno">  355</span> </div>
<div class="line"><span class="lineno">  356</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ctx);</div>
<div class="line"><span class="lineno">  357</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>);</div>
<div class="line"><span class="lineno">  358</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(fmt);</div>
<div class="line"><span class="lineno">  359</span> </div>
<div class="line"><span class="lineno">  360</span>  <a class="code hl_function" href="yubihsm_8c.html#a24c3146e51242256af505961e763f417">yh_set_verbosity</a>(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a8c52c1a89cd4334a0225a1fbfba9a930">connector</a>, <a class="code hl_define" href="yubihsm_8h.html#aa11030bbf6092d8934236958e9478084">YH_VERB_QUIET</a>);</div>
<div class="line"><span class="lineno">  361</span>  fprintf(stderr, <span class="stringliteral">&quot;Debug messages disabled\n&quot;</span>);</div>
<div class="line"><span class="lineno">  362</span> </div>
<div class="line"><span class="lineno">  363</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  364</span>}</div>
<div class="ttc" id="ayubihsm_8h_html_aa11030bbf6092d8934236958e9478084"><div class="ttname"><a href="yubihsm_8h.html#aa11030bbf6092d8934236958e9478084">YH_VERB_QUIET</a></div><div class="ttdeci">#define YH_VERB_QUIET</div><div class="ttdoc">Debug level quiet. No messages printed out.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00133">yubihsm.h:133</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_ac8470d4c5dc4fa0d300bcf171a16140b_cgraph.png" border="0" usemap="#acommands_8c_ac8470d4c5dc4fa0d300bcf171a16140b_cgraph" alt=""/></div>
<map name="acommands_8c_ac8470d4c5dc4fa0d300bcf171a16140b_cgraph" id="acommands_8c_ac8470d4c5dc4fa0d300bcf171a16140b_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,150,31"/>
<area shape="rect" href="yubihsm_8c.html#a24c3146e51242256af505961e763f417" title=" " alt="" coords="198,5,318,31"/>
<area shape="poly" title=" " alt="" coords="150,16,182,16,182,21,150,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_ac8470d4c5dc4fa0d300bcf171a16140b_icgraph.png" border="0" usemap="#acommands_8c_ac8470d4c5dc4fa0d300bcf171a16140b_icgraph" alt=""/></div>
<map name="acommands_8c_ac8470d4c5dc4fa0d300bcf171a16140b_icgraph" id="acommands_8c_ac8470d4c5dc4fa0d300bcf171a16140b_icgraph">
<area shape="rect" title=" " alt="" coords="296,5,440,31"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="280,21,248,21,248,16,280,16"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,55,31"/>
<area shape="poly" title=" " alt="" coords="87,21,55,21,55,16,87,16"/>
</map>
</div>

</div>
</div>
<a id="ac67abff009407dcfe773a32d8273969a" name="ac67abff009407dcfe773a32d8273969a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac67abff009407dcfe773a32d8273969a">&#9670;&#160;</a></span>yh_com_debug_raw()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int yh_com_debug_raw </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__context.html">yubihsm_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_argument.html">Argument</a> *</td>          <td class="paramname"><span class="paramname"><em>argv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a></td>          <td class="paramname"><span class="paramname"><em>fmt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="commands_8c_source.html#l00368">368</a> of file <a class="el" href="commands_8c_source.html">commands.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  368</span>                                                                           {</div>
<div class="line"><span class="lineno">  369</span> </div>
<div class="line"><span class="lineno">  370</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ctx);</div>
<div class="line"><span class="lineno">  371</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>);</div>
<div class="line"><span class="lineno">  372</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(fmt);</div>
<div class="line"><span class="lineno">  373</span> </div>
<div class="line"><span class="lineno">  374</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> yh_verbosity;</div>
<div class="line"><span class="lineno">  375</span> </div>
<div class="line"><span class="lineno">  376</span>  <a class="code hl_function" href="yubihsm_8c.html#a17d49ccb12b100e98d8b99585a705444">yh_get_verbosity</a>(&amp;yh_verbosity);</div>
<div class="line"><span class="lineno">  377</span>  yh_verbosity ^= <a class="code hl_define" href="yubihsm_8h.html#a4ead07ea7b1232808085d4bdbc7eb5b9">YH_VERB_RAW</a>;</div>
<div class="line"><span class="lineno">  378</span> </div>
<div class="line"><span class="lineno">  379</span>  <span class="keywordflow">if</span> (yh_verbosity &amp; <a class="code hl_define" href="yubihsm_8h.html#a4ead07ea7b1232808085d4bdbc7eb5b9">YH_VERB_RAW</a>)</div>
<div class="line"><span class="lineno">  380</span>    fprintf(stderr, <span class="stringliteral">&quot;Raw messages on\n&quot;</span>);</div>
<div class="line"><span class="lineno">  381</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  382</span>    fprintf(stderr, <span class="stringliteral">&quot;Raw messages off\n&quot;</span>);</div>
<div class="line"><span class="lineno">  383</span> </div>
<div class="line"><span class="lineno">  384</span>  <a class="code hl_function" href="yubihsm_8c.html#a24c3146e51242256af505961e763f417">yh_set_verbosity</a>(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a8c52c1a89cd4334a0225a1fbfba9a930">connector</a>, yh_verbosity);</div>
<div class="line"><span class="lineno">  385</span> </div>
<div class="line"><span class="lineno">  386</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  387</span>}</div>
<div class="ttc" id="ayubihsm_8h_html_a4ead07ea7b1232808085d4bdbc7eb5b9"><div class="ttname"><a href="yubihsm_8h.html#a4ead07ea7b1232808085d4bdbc7eb5b9">YH_VERB_RAW</a></div><div class="ttdeci">#define YH_VERB_RAW</div><div class="ttdoc">Debug level raw. Raw messages printed out.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00139">yubihsm.h:139</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_ac67abff009407dcfe773a32d8273969a_cgraph.png" border="0" usemap="#acommands_8c_ac67abff009407dcfe773a32d8273969a_cgraph" alt=""/></div>
<map name="acommands_8c_ac67abff009407dcfe773a32d8273969a_cgraph" id="acommands_8c_ac67abff009407dcfe773a32d8273969a_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,143,56"/>
<area shape="rect" href="yubihsm_8c.html#a17d49ccb12b100e98d8b99585a705444" title=" " alt="" coords="191,5,311,31"/>
<area shape="poly" title=" " alt="" coords="143,31,174,26,175,32,144,36"/>
<area shape="rect" href="yubihsm_8c.html#a24c3146e51242256af505961e763f417" title=" " alt="" coords="191,55,311,80"/>
<area shape="poly" title=" " alt="" coords="144,50,175,55,175,60,143,55"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_ac67abff009407dcfe773a32d8273969a_icgraph.png" border="0" usemap="#acommands_8c_ac67abff009407dcfe773a32d8273969a_icgraph" alt=""/></div>
<map name="acommands_8c_ac67abff009407dcfe773a32d8273969a_icgraph" id="acommands_8c_ac67abff009407dcfe773a32d8273969a_icgraph">
<area shape="rect" title=" " alt="" coords="296,5,433,31"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="280,21,249,21,249,16,280,16"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,55,31"/>
<area shape="poly" title=" " alt="" coords="87,21,55,21,55,16,87,16"/>
</map>
</div>

</div>
</div>
<a id="a4a18ed75272b213eea9b2ebec190b8c1" name="a4a18ed75272b213eea9b2ebec190b8c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a18ed75272b213eea9b2ebec190b8c1">&#9670;&#160;</a></span>yh_com_decrypt_aesccm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int yh_com_decrypt_aesccm </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__context.html">yubihsm_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_argument.html">Argument</a> *</td>          <td class="paramname"><span class="paramname"><em>argv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a></td>          <td class="paramname"><span class="paramname"><em>fmt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="commands_8c_source.html#l00501">501</a> of file <a class="el" href="commands_8c_source.html">commands.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  502</span>                                          {</div>
<div class="line"><span class="lineno">  503</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno">  504</span> </div>
<div class="line"><span class="lineno">  505</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ctx);</div>
<div class="line"><span class="lineno">  506</span> </div>
<div class="line"><span class="lineno">  507</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> response[<a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a>];</div>
<div class="line"><span class="lineno">  508</span>  <span class="keywordtype">size_t</span> response_len = <span class="keyword">sizeof</span>(response);</div>
<div class="line"><span class="lineno">  509</span> </div>
<div class="line"><span class="lineno">  510</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#a550567a0f56d8536b9b5f34e905da7ec">yh_util_unwrap_data</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].w, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[2].x, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[2].<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>,</div>
<div class="line"><span class="lineno">  511</span>                            response, &amp;response_len);</div>
<div class="line"><span class="lineno">  512</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno">  513</span>    fprintf(stderr, <span class="stringliteral">&quot;Failed to decrypt data: %s\n&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno">  514</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  515</span>  }</div>
<div class="line"><span class="lineno">  516</span> </div>
<div class="line"><span class="lineno">  517</span>  <a class="code hl_function" href="util_8c.html#ad969d220471d10a9f07080b50210f403">write_file</a>(response, response_len, ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>, fmt_to_fmt(fmt));</div>
<div class="line"><span class="lineno">  518</span> </div>
<div class="line"><span class="lineno">  519</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  520</span>}</div>
<div class="ttc" id="autil_8c_html_ad969d220471d10a9f07080b50210f403"><div class="ttname"><a href="util_8c.html#ad969d220471d10a9f07080b50210f403">write_file</a></div><div class="ttdeci">bool write_file(const uint8_t *buf, size_t buf_len, FILE *fp, format_t format)</div><div class="ttdef"><b>Definition</b> <a href="util_8c_source.html#l00559">util.c:559</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_a550567a0f56d8536b9b5f34e905da7ec"><div class="ttname"><a href="yubihsm_8c.html#a550567a0f56d8536b9b5f34e905da7ec">yh_util_unwrap_data</a></div><div class="ttdeci">yh_rc yh_util_unwrap_data(yh_session *session, uint16_t key_id, const uint8_t *in, size_t in_len, uint8_t *out, size_t *out_len)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l03716">yubihsm.c:3716</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a706bd8e7adf0de85e6cfb0efc8981d3f"><div class="ttname"><a href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a></div><div class="ttdeci">#define YH_MSG_BUF_SIZE</div><div class="ttdoc">Maximum length of message buffer.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00093">yubihsm.h:93</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_a4a18ed75272b213eea9b2ebec190b8c1_cgraph.png" border="0" usemap="#acommands_8c_a4a18ed75272b213eea9b2ebec190b8c1_cgraph" alt=""/></div>
<map name="acommands_8c_a4a18ed75272b213eea9b2ebec190b8c1_cgraph" id="acommands_8c_a4a18ed75272b213eea9b2ebec190b8c1_cgraph">
<area shape="rect" title=" " alt="" coords="5,56,176,82"/>
<area shape="rect" href="util_8c.html#ad969d220471d10a9f07080b50210f403" title=" " alt="" coords="257,5,330,31"/>
<area shape="poly" title=" " alt="" coords="144,53,241,28,243,33,146,58"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="832,108,915,134"/>
<area shape="poly" title=" " alt="" coords="176,70,443,84,774,108,816,112,816,117,773,113,442,90,176,75"/>
<area shape="rect" href="yubihsm_8c.html#a550567a0f56d8536b9b5f34e905da7ec" title=" " alt="" coords="224,132,364,158"/>
<area shape="poly" title=" " alt="" coords="128,80,244,124,242,129,126,85"/>
<area shape="poly" title=" " alt="" coords="364,139,816,120,816,126,364,145"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="838,207,909,232"/>
<area shape="poly" title=" " alt="" coords="324,156,413,193,511,226,590,245,671,250,773,242,823,232,824,237,774,247,671,256,590,250,510,231,411,198,321,161"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="412,157,560,183"/>
<area shape="poly" title=" " alt="" coords="365,151,397,156,396,161,364,157"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="608,157,774,183"/>
<area shape="poly" title=" " alt="" coords="560,168,593,168,593,173,560,173"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="626,207,756,232"/>
<area shape="poly" title=" " alt="" coords="543,181,620,200,619,205,542,186"/>
<area shape="poly" title=" " alt="" coords="741,154,816,133,817,139,742,159"/>
<area shape="poly" title=" " alt="" coords="742,181,823,203,822,209,741,186"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="839,157,908,183"/>
<area shape="poly" title=" " alt="" coords="774,168,824,168,824,173,774,173"/>
<area shape="poly" title=" " alt="" coords="751,204,772,193,787,181,796,169,805,156,820,143,825,139,828,144,823,147,809,160,800,173,791,185,775,198,753,208"/>
<area shape="poly" title=" " alt="" coords="757,217,823,217,823,222,757,222"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="822,256,925,282"/>
<area shape="poly" title=" " alt="" coords="742,230,809,249,807,254,741,236"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_a4a18ed75272b213eea9b2ebec190b8c1_icgraph.png" border="0" usemap="#acommands_8c_a4a18ed75272b213eea9b2ebec190b8c1_icgraph" alt=""/></div>
<map name="acommands_8c_a4a18ed75272b213eea9b2ebec190b8c1_icgraph" id="acommands_8c_a4a18ed75272b213eea9b2ebec190b8c1_icgraph">
<area shape="rect" title=" " alt="" coords="296,5,466,31"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="280,21,248,21,248,16,280,16"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,55,31"/>
<area shape="poly" title=" " alt="" coords="87,21,55,21,55,16,87,16"/>
</map>
</div>

</div>
</div>
<a id="a38efe7b63355b641f9489d4f95106589" name="a38efe7b63355b641f9489d4f95106589"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38efe7b63355b641f9489d4f95106589">&#9670;&#160;</a></span>yh_com_decrypt_oaep()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int yh_com_decrypt_oaep </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__context.html">yubihsm_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_argument.html">Argument</a> *</td>          <td class="paramname"><span class="paramname"><em>argv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a></td>          <td class="paramname"><span class="paramname"><em>fmt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="commands_8c_source.html#l02676">2676</a> of file <a class="el" href="commands_8c_source.html">commands.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2676</span>                                                                              {</div>
<div class="line"><span class="lineno"> 2677</span> </div>
<div class="line"><span class="lineno"> 2678</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 2679</span> </div>
<div class="line"><span class="lineno"> 2680</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> response[<a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a>];</div>
<div class="line"><span class="lineno"> 2681</span>  <span class="keywordtype">size_t</span> response_len = <span class="keyword">sizeof</span>(response);</div>
<div class="line"><span class="lineno"> 2682</span> </div>
<div class="line"><span class="lineno"> 2683</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>[64];</div>
<div class="line"><span class="lineno"> 2684</span>  <span class="keywordtype">size_t</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ae76ac4adc41ec92427b4a14cd3385c1b">label_len</a> = <span class="keyword">sizeof</span>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>);</div>
<div class="line"><span class="lineno"> 2685</span> </div>
<div class="line"><span class="lineno"> 2686</span>  <span class="keywordtype">int</span> hash;</div>
<div class="line"><span class="lineno"> 2687</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55ca">yh_algorithm</a> mgf;</div>
<div class="line"><span class="lineno"> 2688</span> </div>
<div class="line"><span class="lineno"> 2689</span>  <span class="keywordflow">switch</span> (<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[2].<a class="code hl_variable" href="pointer_8h.html#aeeddce917cf130d62c370b8f216026dd">a</a>) {</div>
<div class="line"><span class="lineno"> 2690</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caae9e58613e12b0f9f445e620f1dd77e1d">YH_ALGO_RSA_OAEP_SHA1</a>:</div>
<div class="line"><span class="lineno"> 2691</span>      hash = <a class="code hl_enumvalue" href="yubihsm_2common_2hash_8h.html#a488906826f8aaf7e850c35889d560089a970f17bf10faf2a31f535116e97f6b4a">_SHA1</a>;</div>
<div class="line"><span class="lineno"> 2692</span>      mgf = <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caae1ab21f2df42a56bdc8ff046ed14797a">YH_ALGO_MGF1_SHA1</a>;</div>
<div class="line"><span class="lineno"> 2693</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2694</span> </div>
<div class="line"><span class="lineno"> 2695</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa590665f5e23f996daeba0a2586b2ff33">YH_ALGO_RSA_OAEP_SHA256</a>:</div>
<div class="line"><span class="lineno"> 2696</span>      hash = <a class="code hl_enumvalue" href="yubihsm_2common_2hash_8h.html#a488906826f8aaf7e850c35889d560089af0ab1a9d65ceafa4ba1f6f177e379258">_SHA256</a>;</div>
<div class="line"><span class="lineno"> 2697</span>      mgf = <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caae3f68121c91d613fe450c12fad55eab2">YH_ALGO_MGF1_SHA256</a>;</div>
<div class="line"><span class="lineno"> 2698</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2699</span> </div>
<div class="line"><span class="lineno"> 2700</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caab2580ffabb9b08affd0f7803fb1536cd">YH_ALGO_RSA_OAEP_SHA384</a>:</div>
<div class="line"><span class="lineno"> 2701</span>      hash = <a class="code hl_enumvalue" href="yubihsm_2common_2hash_8h.html#a488906826f8aaf7e850c35889d560089a46254673795a1d78b2d84adbf88d8bb2">_SHA384</a>;</div>
<div class="line"><span class="lineno"> 2702</span>      mgf = <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa788440387af34a9aa10a3e5561c8ee31">YH_ALGO_MGF1_SHA384</a>;</div>
<div class="line"><span class="lineno"> 2703</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2704</span> </div>
<div class="line"><span class="lineno"> 2705</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caaa4c2625511af2c17ed83da552d3dc5f6">YH_ALGO_RSA_OAEP_SHA512</a>:</div>
<div class="line"><span class="lineno"> 2706</span>      hash = <a class="code hl_enumvalue" href="yubihsm_2common_2hash_8h.html#a488906826f8aaf7e850c35889d560089a0dbf438178c608dea7392e75c9b7ae2d">_SHA512</a>;</div>
<div class="line"><span class="lineno"> 2707</span>      mgf = <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa104308e8fac7553b1d875f149ff133b1">YH_ALGO_MGF1_SHA512</a>;</div>
<div class="line"><span class="lineno"> 2708</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2709</span> </div>
<div class="line"><span class="lineno"> 2710</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 2711</span>      fprintf(stderr, <span class="stringliteral">&quot;Invalid hash algorithm\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 2712</span>      <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 2713</span>  }</div>
<div class="line"><span class="lineno"> 2714</span> </div>
<div class="line"><span class="lineno"> 2715</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="hash_8c.html#a062ee0f36e0c16725c22a5d9d964a8cd">hash_bytes</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[4].x, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[4].<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>, hash, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>, &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ae76ac4adc41ec92427b4a14cd3385c1b">label_len</a>) == <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 2716</span>    fprintf(stderr, <span class="stringliteral">&quot;Unable to hash data\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 2717</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 2718</span>  }</div>
<div class="line"><span class="lineno"> 2719</span> </div>
<div class="line"><span class="lineno"> 2720</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#aa939f8764ed0cca27884d9c8f640ac14">yh_util_decrypt_oaep</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].w, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[3].x, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[3].<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>,</div>
<div class="line"><span class="lineno"> 2721</span>                             response, &amp;response_len, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ae76ac4adc41ec92427b4a14cd3385c1b">label_len</a>, mgf);</div>
<div class="line"><span class="lineno"> 2722</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 2723</span>    fprintf(stderr, <span class="stringliteral">&quot;Failed to decrypt data with OAEP: %s\n&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 2724</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 2725</span>  }</div>
<div class="line"><span class="lineno"> 2726</span> </div>
<div class="line"><span class="lineno"> 2727</span>  <a class="code hl_function" href="util_8c.html#ad969d220471d10a9f07080b50210f403">write_file</a>(response, response_len, ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>, fmt_to_fmt(fmt));</div>
<div class="line"><span class="lineno"> 2728</span> </div>
<div class="line"><span class="lineno"> 2729</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 2730</span>}</div>
<div class="ttc" id="ahash_8c_html_a062ee0f36e0c16725c22a5d9d964a8cd"><div class="ttname"><a href="hash_8c.html#a062ee0f36e0c16725c22a5d9d964a8cd">hash_bytes</a></div><div class="ttdeci">bool hash_bytes(const uint8_t *in, size_t len, hash_t hash, uint8_t *out, size_t *out_len)</div><div class="ttdef"><b>Definition</b> <a href="hash_8c_source.html#l00090">hash.c:90</a></div></div>
<div class="ttc" id="ayubihsm_2common_2hash_8h_html_a488906826f8aaf7e850c35889d560089a0dbf438178c608dea7392e75c9b7ae2d"><div class="ttname"><a href="yubihsm_2common_2hash_8h.html#a488906826f8aaf7e850c35889d560089a0dbf438178c608dea7392e75c9b7ae2d">_SHA512</a></div><div class="ttdeci">@ _SHA512</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_2common_2hash_8h_source.html#l00038">hash.h:38</a></div></div>
<div class="ttc" id="ayubihsm_2common_2hash_8h_html_a488906826f8aaf7e850c35889d560089a46254673795a1d78b2d84adbf88d8bb2"><div class="ttname"><a href="yubihsm_2common_2hash_8h.html#a488906826f8aaf7e850c35889d560089a46254673795a1d78b2d84adbf88d8bb2">_SHA384</a></div><div class="ttdeci">@ _SHA384</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_2common_2hash_8h_source.html#l00037">hash.h:37</a></div></div>
<div class="ttc" id="ayubihsm_2common_2hash_8h_html_a488906826f8aaf7e850c35889d560089a970f17bf10faf2a31f535116e97f6b4a"><div class="ttname"><a href="yubihsm_2common_2hash_8h.html#a488906826f8aaf7e850c35889d560089a970f17bf10faf2a31f535116e97f6b4a">_SHA1</a></div><div class="ttdeci">@ _SHA1</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_2common_2hash_8h_source.html#l00035">hash.h:35</a></div></div>
<div class="ttc" id="ayubihsm_2common_2hash_8h_html_a488906826f8aaf7e850c35889d560089af0ab1a9d65ceafa4ba1f6f177e379258"><div class="ttname"><a href="yubihsm_2common_2hash_8h.html#a488906826f8aaf7e850c35889d560089af0ab1a9d65ceafa4ba1f6f177e379258">_SHA256</a></div><div class="ttdeci">@ _SHA256</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_2common_2hash_8h_source.html#l00036">hash.h:36</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_aa939f8764ed0cca27884d9c8f640ac14"><div class="ttname"><a href="yubihsm_8c.html#aa939f8764ed0cca27884d9c8f640ac14">yh_util_decrypt_oaep</a></div><div class="ttdeci">yh_rc yh_util_decrypt_oaep(yh_session *session, uint16_t key_id, const uint8_t *in, size_t in_len, uint8_t *out, size_t *out_len, const uint8_t *label, size_t label_len, yh_algorithm mgf1Algo)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l02107">yubihsm.c:2107</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caa104308e8fac7553b1d875f149ff133b1"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa104308e8fac7553b1d875f149ff133b1">YH_ALGO_MGF1_SHA512</a></div><div class="ttdeci">@ YH_ALGO_MGF1_SHA512</div><div class="ttdoc">mgf1-sha512</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00460">yubihsm.h:460</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caa590665f5e23f996daeba0a2586b2ff33"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa590665f5e23f996daeba0a2586b2ff33">YH_ALGO_RSA_OAEP_SHA256</a></div><div class="ttdeci">@ YH_ALGO_RSA_OAEP_SHA256</div><div class="ttdoc">rsa-oaep-sha256</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00442">yubihsm.h:442</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caa788440387af34a9aa10a3e5561c8ee31"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa788440387af34a9aa10a3e5561c8ee31">YH_ALGO_MGF1_SHA384</a></div><div class="ttdeci">@ YH_ALGO_MGF1_SHA384</div><div class="ttdoc">mgf1-sha384</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00458">yubihsm.h:458</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caaa4c2625511af2c17ed83da552d3dc5f6"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caaa4c2625511af2c17ed83da552d3dc5f6">YH_ALGO_RSA_OAEP_SHA512</a></div><div class="ttdeci">@ YH_ALGO_RSA_OAEP_SHA512</div><div class="ttdoc">rsa-oaep-sha512</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00446">yubihsm.h:446</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caab2580ffabb9b08affd0f7803fb1536cd"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caab2580ffabb9b08affd0f7803fb1536cd">YH_ALGO_RSA_OAEP_SHA384</a></div><div class="ttdeci">@ YH_ALGO_RSA_OAEP_SHA384</div><div class="ttdoc">rsa-oaep-sha384</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00444">yubihsm.h:444</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caae3f68121c91d613fe450c12fad55eab2"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caae3f68121c91d613fe450c12fad55eab2">YH_ALGO_MGF1_SHA256</a></div><div class="ttdeci">@ YH_ALGO_MGF1_SHA256</div><div class="ttdoc">mgf1-sha256</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00456">yubihsm.h:456</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caae9e58613e12b0f9f445e620f1dd77e1d"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caae9e58613e12b0f9f445e620f1dd77e1d">YH_ALGO_RSA_OAEP_SHA1</a></div><div class="ttdeci">@ YH_ALGO_RSA_OAEP_SHA1</div><div class="ttdoc">rsa-oaep-sha1</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00440">yubihsm.h:440</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_ae76ac4adc41ec92427b4a14cd3385c1b"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#ae76ac4adc41ec92427b4a14cd3385c1b">label_len</a></div><div class="ttdeci">size_t label_len</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l04938">yubihsm_pkcs11.c:4938</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_a38efe7b63355b641f9489d4f95106589_cgraph.png" border="0" usemap="#acommands_8c_a38efe7b63355b641f9489d4f95106589_cgraph" alt=""/></div>
<map name="acommands_8c_a38efe7b63355b641f9489d4f95106589_cgraph" id="acommands_8c_a38efe7b63355b641f9489d4f95106589_cgraph">
<area shape="rect" title=" " alt="" coords="5,119,158,144"/>
<area shape="rect" href="hash_8c.html#a062ee0f36e0c16725c22a5d9d964a8cd" title=" " alt="" coords="234,19,322,44"/>
<area shape="poly" title=" " alt="" coords="108,116,236,49,239,54,110,120"/>
<area shape="rect" href="util_8c.html#ad969d220471d10a9f07080b50210f403" title=" " alt="" coords="241,93,314,119"/>
<area shape="poly" title=" " alt="" coords="158,119,226,110,226,115,159,124"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="818,205,901,231"/>
<area shape="poly" title=" " alt="" coords="111,142,155,161,206,178,289,196,374,209,542,222,691,223,802,219,802,225,691,229,542,227,373,214,288,201,205,183,153,166,109,147"/>
<area shape="rect" href="yubihsm_8c.html#aa939f8764ed0cca27884d9c8f640ac14" title=" " alt="" coords="206,143,350,168"/>
<area shape="poly" title=" " alt="" coords="159,138,191,142,190,147,158,143"/>
<area shape="rect" href="hash_8c.html#a2de35447908a9afccca42825a87854fb" title=" " alt="" coords="435,5,509,31"/>
<area shape="poly" title=" " alt="" coords="322,26,419,19,420,24,323,31"/>
<area shape="poly" title=" " alt="" coords="336,166,398,178,510,192,622,202,802,213,802,219,622,208,510,197,398,183,335,172"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="824,107,895,132"/>
<area shape="poly" title=" " alt="" coords="324,139,405,119,514,99,636,87,699,87,760,92,810,102,809,107,759,97,698,92,636,92,514,104,407,124,325,145"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="398,143,546,168"/>
<area shape="poly" title=" " alt="" coords="351,153,382,153,382,158,351,158"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="594,107,760,132"/>
<area shape="poly" title=" " alt="" coords="546,140,585,133,586,138,547,145"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="612,156,742,182"/>
<area shape="poly" title=" " alt="" coords="547,158,597,161,596,166,546,163"/>
<area shape="poly" title=" " alt="" coords="739,131,761,141,777,154,786,166,795,179,809,192,814,195,811,200,806,196,791,183,782,170,773,158,758,146,737,135"/>
<area shape="poly" title=" " alt="" coords="760,117,808,117,808,122,760,122"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="825,57,894,83"/>
<area shape="poly" title=" " alt="" coords="727,103,809,81,811,86,728,109"/>
<area shape="poly" title=" " alt="" coords="728,180,803,200,802,206,727,185"/>
<area shape="poly" title=" " alt="" coords="727,153,808,130,809,136,728,158"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="808,156,911,182"/>
<area shape="poly" title=" " alt="" coords="743,166,792,166,792,172,743,172"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_a38efe7b63355b641f9489d4f95106589_icgraph.png" border="0" usemap="#acommands_8c_a38efe7b63355b641f9489d4f95106589_icgraph" alt=""/></div>
<map name="acommands_8c_a38efe7b63355b641f9489d4f95106589_icgraph" id="acommands_8c_a38efe7b63355b641f9489d4f95106589_icgraph">
<area shape="rect" title=" " alt="" coords="296,5,448,31"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="281,21,248,21,248,16,281,16"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,55,31"/>
<area shape="poly" title=" " alt="" coords="87,21,55,21,55,16,87,16"/>
</map>
</div>

</div>
</div>
<a id="aea9c5cab32280dc06d4681c02f1b5ccb" name="aea9c5cab32280dc06d4681c02f1b5ccb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea9c5cab32280dc06d4681c02f1b5ccb">&#9670;&#160;</a></span>yh_com_decrypt_pkcs1v1_5()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int yh_com_decrypt_pkcs1v1_5 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__context.html">yubihsm_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_argument.html">Argument</a> *</td>          <td class="paramname"><span class="paramname"><em>argv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a></td>          <td class="paramname"><span class="paramname"><em>fmt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="commands_8c_source.html#l00417">417</a> of file <a class="el" href="commands_8c_source.html">commands.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  418</span>                                             {</div>
<div class="line"><span class="lineno">  419</span> </div>
<div class="line"><span class="lineno">  420</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno">  421</span> </div>
<div class="line"><span class="lineno">  422</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ctx);</div>
<div class="line"><span class="lineno">  423</span> </div>
<div class="line"><span class="lineno">  424</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> response[<a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a>];</div>
<div class="line"><span class="lineno">  425</span>  <span class="keywordtype">size_t</span> response_len = <span class="keyword">sizeof</span>(response);</div>
<div class="line"><span class="lineno">  426</span> </div>
<div class="line"><span class="lineno">  427</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#a5ebf6932cd2e68b9a23787c27fde3e26">yh_util_decrypt_pkcs1v1_5</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].w, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[2].x, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[2].<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>,</div>
<div class="line"><span class="lineno">  428</span>                                  response, &amp;response_len);</div>
<div class="line"><span class="lineno">  429</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno">  430</span>    fprintf(stderr, <span class="stringliteral">&quot;Failed to decrypt data: %s\n&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno">  431</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  432</span>  }</div>
<div class="line"><span class="lineno">  433</span> </div>
<div class="line"><span class="lineno">  434</span>  <a class="code hl_function" href="util_8c.html#ad969d220471d10a9f07080b50210f403">write_file</a>(response, response_len, ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>, fmt_to_fmt(fmt));</div>
<div class="line"><span class="lineno">  435</span> </div>
<div class="line"><span class="lineno">  436</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  437</span>}</div>
<div class="ttc" id="ayubihsm_8c_html_a5ebf6932cd2e68b9a23787c27fde3e26"><div class="ttname"><a href="yubihsm_8c.html#a5ebf6932cd2e68b9a23787c27fde3e26">yh_util_decrypt_pkcs1v1_5</a></div><div class="ttdeci">yh_rc yh_util_decrypt_pkcs1v1_5(yh_session *session, uint16_t key_id, const uint8_t *in, size_t in_len, uint8_t *out, size_t *out_len)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l02059">yubihsm.c:2059</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_aea9c5cab32280dc06d4681c02f1b5ccb_cgraph.png" border="0" usemap="#acommands_8c_aea9c5cab32280dc06d4681c02f1b5ccb_cgraph" alt=""/></div>
<map name="acommands_8c_aea9c5cab32280dc06d4681c02f1b5ccb_cgraph" id="acommands_8c_aea9c5cab32280dc06d4681c02f1b5ccb_cgraph">
<area shape="rect" title=" " alt="" coords="5,56,193,82"/>
<area shape="rect" href="util_8c.html#ad969d220471d10a9f07080b50210f403" title=" " alt="" coords="294,5,367,31"/>
<area shape="poly" title=" " alt="" coords="160,53,278,27,279,32,162,58"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="888,108,971,134"/>
<area shape="poly" title=" " alt="" coords="193,70,478,84,830,108,872,112,872,117,829,113,478,89,193,75"/>
<area shape="rect" href="yubihsm_8c.html#a5ebf6932cd2e68b9a23787c27fde3e26" title=" " alt="" coords="241,132,420,158"/>
<area shape="poly" title=" " alt="" coords="142,80,275,124,273,129,140,85"/>
<area shape="poly" title=" " alt="" coords="420,139,872,120,872,126,420,144"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="894,207,965,232"/>
<area shape="poly" title=" " alt="" coords="365,156,469,193,568,224,647,243,727,250,829,242,879,232,880,237,830,247,727,255,646,248,567,229,467,198,363,161"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="468,157,616,183"/>
<area shape="poly" title=" " alt="" coords="421,153,453,157,453,162,420,158"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="664,157,830,183"/>
<area shape="poly" title=" " alt="" coords="616,168,649,168,649,173,616,173"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="682,207,812,232"/>
<area shape="poly" title=" " alt="" coords="599,181,676,200,675,205,598,186"/>
<area shape="poly" title=" " alt="" coords="797,154,872,133,873,139,798,159"/>
<area shape="poly" title=" " alt="" coords="798,181,879,203,878,209,797,186"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="895,157,964,183"/>
<area shape="poly" title=" " alt="" coords="830,168,880,168,880,173,830,173"/>
<area shape="poly" title=" " alt="" coords="807,204,828,193,843,181,852,169,861,156,876,143,881,139,884,144,879,147,865,160,856,173,847,185,831,198,809,208"/>
<area shape="poly" title=" " alt="" coords="813,217,879,217,879,222,813,222"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="878,256,981,282"/>
<area shape="poly" title=" " alt="" coords="798,230,865,249,863,254,797,236"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_aea9c5cab32280dc06d4681c02f1b5ccb_icgraph.png" border="0" usemap="#acommands_8c_aea9c5cab32280dc06d4681c02f1b5ccb_icgraph" alt=""/></div>
<map name="acommands_8c_aea9c5cab32280dc06d4681c02f1b5ccb_icgraph" id="acommands_8c_aea9c5cab32280dc06d4681c02f1b5ccb_icgraph">
<area shape="rect" title=" " alt="" coords="296,31,483,56"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="280,33,248,29,249,24,281,28"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,31,55,56"/>
<area shape="poly" title=" " alt="" coords="280,46,55,46,55,41,280,41"/>
<area shape="poly" title=" " alt="" coords="88,36,55,42,54,37,87,31"/>
</map>
</div>

</div>
</div>
<a id="ad490f0e89d33c1300a44bd095eb5562c" name="ad490f0e89d33c1300a44bd095eb5562c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad490f0e89d33c1300a44bd095eb5562c">&#9670;&#160;</a></span>yh_com_delete()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int yh_com_delete </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__context.html">yubihsm_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_argument.html">Argument</a> *</td>          <td class="paramname"><span class="paramname"><em>argv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a></td>          <td class="paramname"><span class="paramname"><em>fmt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="commands_8c_source.html#l01975">1975</a> of file <a class="el" href="commands_8c_source.html">commands.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1975</span>                                                                        {</div>
<div class="line"><span class="lineno"> 1976</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ctx);</div>
<div class="line"><span class="lineno"> 1977</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(fmt);</div>
<div class="line"><span class="lineno"> 1978</span> </div>
<div class="line"><span class="lineno"> 1979</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#ae736702f9463878db4adfd45b6a597f9">yh_util_delete_object</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].w, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[2].t);</div>
<div class="line"><span class="lineno"> 1980</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 1981</span>    fprintf(stderr, <span class="stringliteral">&quot;Failed to delete object: %s\n&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 1982</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 1983</span>  } <span class="comment">// TODO(adma): the order of the arguments should be changed to id and type</span></div>
<div class="line"><span class="lineno"> 1984</span> </div>
<div class="line"><span class="lineno"> 1985</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1986</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_ad490f0e89d33c1300a44bd095eb5562c_cgraph.png" border="0" usemap="#acommands_8c_ad490f0e89d33c1300a44bd095eb5562c_cgraph" alt=""/></div>
<map name="acommands_8c_ad490f0e89d33c1300a44bd095eb5562c_cgraph" id="acommands_8c_ad490f0e89d33c1300a44bd095eb5562c_cgraph">
<area shape="rect" title=" " alt="" coords="5,179,115,204"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="774,153,857,179"/>
<area shape="poly" title=" " alt="" coords="115,190,306,189,511,181,716,169,758,167,758,172,716,174,511,186,306,194,115,195"/>
<area shape="rect" href="yubihsm_8c.html#ae736702f9463878db4adfd45b6a597f9" title=" " alt="" coords="163,153,306,179"/>
<area shape="poly" title=" " alt="" coords="115,181,147,176,148,181,116,186"/>
<area shape="poly" title=" " alt="" coords="307,164,758,164,758,169,307,169"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="354,103,502,128"/>
<area shape="poly" title=" " alt="" coords="286,150,361,130,363,135,287,155"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="550,53,716,79"/>
<area shape="poly" title=" " alt="" coords="484,99,561,81,562,86,485,105"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="568,103,698,128"/>
<area shape="poly" title=" " alt="" coords="502,113,553,113,553,118,502,118"/>
<area shape="poly" title=" " alt="" coords="695,77,717,88,733,101,742,114,751,127,765,140,770,143,767,148,762,144,747,130,738,117,729,105,714,92,693,82"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="780,55,851,80"/>
<area shape="poly" title=" " alt="" coords="716,64,764,64,764,70,716,69"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="781,5,850,31"/>
<area shape="poly" title=" " alt="" coords="684,50,765,28,767,34,686,55"/>
<area shape="poly" title=" " alt="" coords="683,126,759,148,758,153,681,132"/>
<area shape="poly" title=" " alt="" coords="684,99,764,78,765,83,686,105"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="764,104,867,130"/>
<area shape="poly" title=" " alt="" coords="699,113,748,114,748,119,699,119"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_ad490f0e89d33c1300a44bd095eb5562c_icgraph.png" border="0" usemap="#acommands_8c_ad490f0e89d33c1300a44bd095eb5562c_icgraph" alt=""/></div>
<map name="acommands_8c_ad490f0e89d33c1300a44bd095eb5562c_icgraph" id="acommands_8c_ad490f0e89d33c1300a44bd095eb5562c_icgraph">
<area shape="rect" title=" " alt="" coords="296,31,405,56"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="280,36,248,31,248,26,281,31"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,31,55,56"/>
<area shape="poly" title=" " alt="" coords="280,46,55,46,55,41,280,41"/>
<area shape="poly" title=" " alt="" coords="88,36,55,42,54,37,87,31"/>
</map>
</div>

</div>
</div>
<a id="a0f6792710fe36e1bf00cb839f286d473" name="a0f6792710fe36e1bf00cb839f286d473"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f6792710fe36e1bf00cb839f286d473">&#9670;&#160;</a></span>yh_com_derive_ecdh()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int yh_com_derive_ecdh </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__context.html">yubihsm_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_argument.html">Argument</a> *</td>          <td class="paramname"><span class="paramname"><em>argv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a></td>          <td class="paramname"><span class="paramname"><em>fmt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="commands_8c_source.html#l00444">444</a> of file <a class="el" href="commands_8c_source.html">commands.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  444</span>                                                                             {</div>
<div class="line"><span class="lineno">  445</span> </div>
<div class="line"><span class="lineno">  446</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ctx);</div>
<div class="line"><span class="lineno">  447</span> </div>
<div class="line"><span class="lineno">  448</span>  BIO *bio = BIO_new(BIO_s_mem());</div>
<div class="line"><span class="lineno">  449</span>  <span class="keywordflow">if</span> (bio == NULL) {</div>
<div class="line"><span class="lineno">  450</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  451</span>  }</div>
<div class="line"><span class="lineno">  452</span> </div>
<div class="line"><span class="lineno">  453</span>  (void) BIO_write(bio, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[2].x, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[2].<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>);</div>
<div class="line"><span class="lineno">  454</span> </div>
<div class="line"><span class="lineno">  455</span>  EVP_PKEY *<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a931987c85fd408a620505ee9a1aa6f58">pubkey</a> = PEM_read_bio_PUBKEY(bio, NULL, NULL, NULL);</div>
<div class="line"><span class="lineno">  456</span>  BIO_free_all(bio);</div>
<div class="line"><span class="lineno">  457</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a931987c85fd408a620505ee9a1aa6f58">pubkey</a> == NULL) {</div>
<div class="line"><span class="lineno">  458</span>    fprintf(stderr, <span class="stringliteral">&quot;Failed to load public key\n&quot;</span>);</div>
<div class="line"><span class="lineno">  459</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  460</span>  }</div>
<div class="line"><span class="lineno">  461</span>  <span class="keywordflow">if</span> (EVP_PKEY_base_id(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a931987c85fd408a620505ee9a1aa6f58">pubkey</a>) != EVP_PKEY_EC) {</div>
<div class="line"><span class="lineno">  462</span>    EVP_PKEY_free(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a931987c85fd408a620505ee9a1aa6f58">pubkey</a>);</div>
<div class="line"><span class="lineno">  463</span>    fprintf(stderr, <span class="stringliteral">&quot;Key is not an EC key.\n&quot;</span>);</div>
<div class="line"><span class="lineno">  464</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  465</span>  }</div>
<div class="line"><span class="lineno">  466</span> </div>
<div class="line"><span class="lineno">  467</span>  EC_KEY *ec = EVP_PKEY_get1_EC_KEY(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a931987c85fd408a620505ee9a1aa6f58">pubkey</a>);</div>
<div class="line"><span class="lineno">  468</span>  EVP_PKEY_free(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a931987c85fd408a620505ee9a1aa6f58">pubkey</a>);</div>
<div class="line"><span class="lineno">  469</span>  <span class="keywordflow">if</span> (ec == NULL) {</div>
<div class="line"><span class="lineno">  470</span>    fprintf(stderr, <span class="stringliteral">&quot;Failed to retrive key.\n&quot;</span>);</div>
<div class="line"><span class="lineno">  471</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  472</span>  }</div>
<div class="line"><span class="lineno">  473</span> </div>
<div class="line"><span class="lineno">  474</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> data[<a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a>];</div>
<div class="line"><span class="lineno">  475</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *ptr = data;</div>
<div class="line"><span class="lineno">  476</span>  <span class="keywordtype">size_t</span> data_len = i2o_ECPublicKey(ec, &amp;ptr);</div>
<div class="line"><span class="lineno">  477</span> </div>
<div class="line"><span class="lineno">  478</span>  EC_KEY_free(ec);</div>
<div class="line"><span class="lineno">  479</span> </div>
<div class="line"><span class="lineno">  480</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno">  481</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> response[<a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a>];</div>
<div class="line"><span class="lineno">  482</span>  <span class="keywordtype">size_t</span> response_len = <span class="keyword">sizeof</span>(response);</div>
<div class="line"><span class="lineno">  483</span> </div>
<div class="line"><span class="lineno">  484</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#a2900aee87732f9ec017bd1662bcef7e9">yh_util_derive_ecdh</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].w, data, data_len, response,</div>
<div class="line"><span class="lineno">  485</span>                            &amp;response_len);</div>
<div class="line"><span class="lineno">  486</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno">  487</span>    fprintf(stderr, <span class="stringliteral">&quot;Failed to do key exchange: %s\n&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno">  488</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  489</span>  }</div>
<div class="line"><span class="lineno">  490</span> </div>
<div class="line"><span class="lineno">  491</span>  <a class="code hl_function" href="util_8c.html#ad969d220471d10a9f07080b50210f403">write_file</a>(response, response_len, ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>, fmt_to_fmt(fmt));</div>
<div class="line"><span class="lineno">  492</span> </div>
<div class="line"><span class="lineno">  493</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  494</span>}</div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a931987c85fd408a620505ee9a1aa6f58"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a931987c85fd408a620505ee9a1aa6f58">pubkey</a></div><div class="ttdeci">CK_BYTE_PTR pubkey</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l04984">yubihsm_pkcs11.c:4984</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_a0f6792710fe36e1bf00cb839f286d473_cgraph.png" border="0" usemap="#acommands_8c_a0f6792710fe36e1bf00cb839f286d473_cgraph" alt=""/></div>
<map name="acommands_8c_a0f6792710fe36e1bf00cb839f286d473_cgraph" id="acommands_8c_a0f6792710fe36e1bf00cb839f286d473_cgraph">
<area shape="rect" title=" " alt="" coords="5,56,150,82"/>
<area shape="rect" href="util_8c.html#ad969d220471d10a9f07080b50210f403" title=" " alt="" coords="229,5,302,31"/>
<area shape="poly" title=" " alt="" coords="127,53,213,29,215,35,129,58"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="802,108,885,134"/>
<area shape="poly" title=" " alt="" coords="150,70,412,84,744,108,786,112,786,117,743,113,412,89,150,75"/>
<area shape="rect" href="yubihsm_8c.html#a2900aee87732f9ec017bd1662bcef7e9" title=" " alt="" coords="198,132,334,158"/>
<area shape="poly" title=" " alt="" coords="113,80,219,123,217,128,111,85"/>
<area shape="poly" title=" " alt="" coords="334,139,786,120,787,126,334,145"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="808,207,879,232"/>
<area shape="poly" title=" " alt="" coords="295,156,383,193,481,226,560,245,641,250,743,242,793,232,794,237,744,247,641,256,560,250,480,231,381,198,293,161"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="382,157,530,183"/>
<area shape="poly" title=" " alt="" coords="335,151,367,156,366,161,334,157"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="578,157,744,183"/>
<area shape="poly" title=" " alt="" coords="530,168,563,168,563,173,530,173"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="596,207,726,232"/>
<area shape="poly" title=" " alt="" coords="513,181,590,200,589,205,512,186"/>
<area shape="poly" title=" " alt="" coords="711,154,786,133,787,139,712,159"/>
<area shape="poly" title=" " alt="" coords="712,181,793,203,792,209,711,186"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="809,157,878,183"/>
<area shape="poly" title=" " alt="" coords="744,168,794,168,794,173,744,173"/>
<area shape="poly" title=" " alt="" coords="721,204,742,193,757,181,766,169,775,156,790,143,795,139,798,144,793,147,779,160,770,173,761,185,745,198,723,208"/>
<area shape="poly" title=" " alt="" coords="727,217,793,217,793,222,727,222"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="792,256,895,282"/>
<area shape="poly" title=" " alt="" coords="712,230,779,249,777,254,711,236"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_a0f6792710fe36e1bf00cb839f286d473_icgraph.png" border="0" usemap="#acommands_8c_a0f6792710fe36e1bf00cb839f286d473_icgraph" alt=""/></div>
<map name="acommands_8c_a0f6792710fe36e1bf00cb839f286d473_icgraph" id="acommands_8c_a0f6792710fe36e1bf00cb839f286d473_icgraph">
<area shape="rect" title=" " alt="" coords="296,31,440,56"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="280,35,248,30,249,25,281,29"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,31,55,56"/>
<area shape="poly" title=" " alt="" coords="281,46,55,46,55,41,281,41"/>
<area shape="poly" title=" " alt="" coords="88,36,55,42,54,37,87,31"/>
</map>
</div>

</div>
</div>
<a id="ac388fd67865728ed4f4267a8a13b248e" name="ac388fd67865728ed4f4267a8a13b248e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac388fd67865728ed4f4267a8a13b248e">&#9670;&#160;</a></span>yh_com_disconnect()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int yh_com_disconnect </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__context.html">yubihsm_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_argument.html">Argument</a> *</td>          <td class="paramname"><span class="paramname"><em>argv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a></td>          <td class="paramname"><span class="paramname"><em>fmt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="commands_8c_source.html#l00550">550</a> of file <a class="el" href="commands_8c_source.html">commands.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  550</span>                                                                            {</div>
<div class="line"><span class="lineno">  551</span> </div>
<div class="line"><span class="lineno">  552</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>);</div>
<div class="line"><span class="lineno">  553</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(fmt);</div>
<div class="line"><span class="lineno">  554</span> </div>
<div class="line"><span class="lineno">  555</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno">  556</span> </div>
<div class="line"><span class="lineno">  557</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_define" href="yubihsm_8h.html#add4e5963a36bd6c9b06c717d705f4c2f">YH_MAX_SESSIONS</a>; i++) {</div>
<div class="line"><span class="lineno">  558</span>    <span class="keywordflow">if</span> (ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a7a959752fa285fb4a7a75921bbfa00fe">sessions</a>[i]) {</div>
<div class="line"><span class="lineno">  559</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#a1a35f8ae5a739848408633a514e41b2d">yh_destroy_session</a>(&amp;ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a7a959752fa285fb4a7a75921bbfa00fe">sessions</a>[i]);</div>
<div class="line"><span class="lineno">  560</span>      <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno">  561</span>        fprintf(stderr, <span class="stringliteral">&quot;Failed to destroy session: %s\n&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno">  562</span>      }</div>
<div class="line"><span class="lineno">  563</span>      ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a7a959752fa285fb4a7a75921bbfa00fe">sessions</a>[i] = NULL;</div>
<div class="line"><span class="lineno">  564</span>    }</div>
<div class="line"><span class="lineno">  565</span>  }</div>
<div class="line"><span class="lineno">  566</span> </div>
<div class="line"><span class="lineno">  567</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#ab12d5a42d2219741bd3630b99ed1c7d2">yh_disconnect</a>(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a8c52c1a89cd4334a0225a1fbfba9a930">connector</a>);</div>
<div class="line"><span class="lineno">  568</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno">  569</span>    fprintf(stderr, <span class="stringliteral">&quot;Unable to disconnect: %s\n&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno">  570</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  571</span>  }</div>
<div class="line"><span class="lineno">  572</span>  ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a8c52c1a89cd4334a0225a1fbfba9a930">connector</a> = NULL;</div>
<div class="line"><span class="lineno">  573</span> </div>
<div class="line"><span class="lineno">  574</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  575</span>}</div>
<div class="ttc" id="ayubihsm_8h_html_add4e5963a36bd6c9b06c717d705f4c2f"><div class="ttname"><a href="yubihsm_8h.html#add4e5963a36bd6c9b06c717d705f4c2f">YH_MAX_SESSIONS</a></div><div class="ttdeci">#define YH_MAX_SESSIONS</div><div class="ttdoc">Max sessions the device may hold.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00105">yubihsm.h:105</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_ac388fd67865728ed4f4267a8a13b248e_cgraph.png" border="0" usemap="#acommands_8c_ac388fd67865728ed4f4267a8a13b248e_cgraph" alt=""/></div>
<map name="acommands_8c_ac388fd67865728ed4f4267a8a13b248e_cgraph" id="acommands_8c_ac388fd67865728ed4f4267a8a13b248e_cgraph">
<area shape="rect" title=" " alt="" coords="5,56,143,82"/>
<area shape="rect" href="yubihsm_8c.html#a1a35f8ae5a739848408633a514e41b2d" title=" " alt="" coords="191,5,328,31"/>
<area shape="poly" title=" " alt="" coords="123,53,195,33,196,38,125,58"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="376,56,459,82"/>
<area shape="poly" title=" " alt="" coords="143,66,360,66,360,72,143,72"/>
<area shape="rect" href="yubihsm_8c.html#ab12d5a42d2219741bd3630b99ed1c7d2" title=" " alt="" coords="207,107,312,132"/>
<area shape="poly" title=" " alt="" coords="125,80,196,100,195,105,123,85"/>
<area shape="poly" title=" " alt="" coords="303,29,362,48,360,53,301,34"/>
<area shape="poly" title=" " alt="" coords="301,104,360,84,362,89,303,109"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_ac388fd67865728ed4f4267a8a13b248e_icgraph.png" border="0" usemap="#acommands_8c_ac388fd67865728ed4f4267a8a13b248e_icgraph" alt=""/></div>
<map name="acommands_8c_ac388fd67865728ed4f4267a8a13b248e_icgraph" id="acommands_8c_ac388fd67865728ed4f4267a8a13b248e_icgraph">
<area shape="rect" title=" " alt="" coords="296,5,433,31"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="280,21,249,21,249,16,280,16"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,55,31"/>
<area shape="poly" title=" " alt="" coords="87,21,55,21,55,16,87,16"/>
</map>
</div>

</div>
</div>
<a id="af764906e585805991dd84ec5dc2c060a" name="af764906e585805991dd84ec5dc2c060a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af764906e585805991dd84ec5dc2c060a">&#9670;&#160;</a></span>yh_com_echo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int yh_com_echo </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__context.html">yubihsm_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_argument.html">Argument</a> *</td>          <td class="paramname"><span class="paramname"><em>argv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a></td>          <td class="paramname"><span class="paramname"><em>fmt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="commands_8c_source.html#l00582">582</a> of file <a class="el" href="commands_8c_source.html">commands.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  582</span>                                                                      {</div>
<div class="line"><span class="lineno">  583</span> </div>
<div class="line"><span class="lineno">  584</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ctx);</div>
<div class="line"><span class="lineno">  585</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(fmt);</div>
<div class="line"><span class="lineno">  586</span> </div>
<div class="line"><span class="lineno">  587</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno">  588</span> </div>
<div class="line"><span class="lineno">  589</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> data[<a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a>];</div>
<div class="line"><span class="lineno">  590</span>  <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> data_len;</div>
<div class="line"><span class="lineno">  591</span> </div>
<div class="line"><span class="lineno">  592</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> response[<a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a>];</div>
<div class="line"><span class="lineno">  593</span>  <span class="keywordtype">size_t</span> response_len;</div>
<div class="line"><span class="lineno">  594</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7e">yh_cmd</a> response_cmd;</div>
<div class="line"><span class="lineno">  595</span> </div>
<div class="line"><span class="lineno">  596</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <span class="keywordtype">byte</span> = <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].b;</div>
<div class="line"><span class="lineno">  597</span> </div>
<div class="line"><span class="lineno">  598</span>  <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="code hl_variable" href="gmock__stress__test_8cc.html#afd9db40e3361ae09188795e8cbe19752">count</a> = <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[2].w;</div>
<div class="line"><span class="lineno">  599</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="gmock__stress__test_8cc.html#afd9db40e3361ae09188795e8cbe19752">count</a> &gt; <a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a>) {</div>
<div class="line"><span class="lineno">  600</span>    fprintf(stderr, <span class="stringliteral">&quot;Count must be in [0, %d]\n&quot;</span>, <a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a>);</div>
<div class="line"><span class="lineno">  601</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  602</span>  }</div>
<div class="line"><span class="lineno">  603</span> </div>
<div class="line"><span class="lineno">  604</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105">memset</a>(data, <span class="keywordtype">byte</span>, <a class="code hl_variable" href="gmock__stress__test_8cc.html#afd9db40e3361ae09188795e8cbe19752">count</a>);</div>
<div class="line"><span class="lineno">  605</span> </div>
<div class="line"><span class="lineno">  606</span>  data_len = <a class="code hl_variable" href="gmock__stress__test_8cc.html#afd9db40e3361ae09188795e8cbe19752">count</a>;</div>
<div class="line"><span class="lineno">  607</span>  response_len = <span class="keyword">sizeof</span>(response);</div>
<div class="line"><span class="lineno">  608</span> </div>
<div class="line"><span class="lineno">  609</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a">yh_send_secure_msg</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e, YHC_ECHO, data, data_len, &amp;response_cmd,</div>
<div class="line"><span class="lineno">  610</span>                           response, &amp;response_len);</div>
<div class="line"><span class="lineno">  611</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno">  612</span>    fprintf(stderr, <span class="stringliteral">&quot;Failed to send ECHO command: %s\n&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno">  613</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  614</span>  }</div>
<div class="line"><span class="lineno">  615</span> </div>
<div class="line"><span class="lineno">  616</span>  <span class="keywordflow">if</span> (response_cmd == <a class="code hl_enumvalue" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7ea51cdf2ccd6995498e589e8ea6ce2a1f2">YHC_ERROR</a>) {</div>
<div class="line"><span class="lineno">  617</span>    fprintf(stderr, <span class="stringliteral">&quot;Unable to get echo data: %s (%x)\n&quot;</span>,</div>
<div class="line"><span class="lineno">  618</span>            <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(response[0]), response[0]);</div>
<div class="line"><span class="lineno">  619</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  620</span>  }</div>
<div class="line"><span class="lineno">  621</span> </div>
<div class="line"><span class="lineno">  622</span>  fprintf(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>, <span class="stringliteral">&quot;Response (%zu bytes):\n&quot;</span>, response_len);</div>
<div class="line"><span class="lineno">  623</span>  <span class="keywordflow">for</span> (<a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> i = 0; i &lt; response_len; i++) {</div>
<div class="line"><span class="lineno">  624</span>    <span class="keywordflow">if</span> (i &amp;&amp; !(i % 64))</div>
<div class="line"><span class="lineno">  625</span>      fprintf(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>, <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><span class="lineno">  626</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i &amp;&amp; !(i % 8))</div>
<div class="line"><span class="lineno">  627</span>      fprintf(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>, <span class="stringliteral">&quot; &quot;</span>);</div>
<div class="line"><span class="lineno">  628</span>    fprintf(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>, <span class="stringliteral">&quot;%02x&quot;</span>, response[i]);</div>
<div class="line"><span class="lineno">  629</span>  }</div>
<div class="line"><span class="lineno">  630</span> </div>
<div class="line"><span class="lineno">  631</span>  fprintf(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>, <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><span class="lineno">  632</span> </div>
<div class="line"><span class="lineno">  633</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  634</span>}</div>
<div class="ttc" id="agmock__stress__test_8cc_html_afd9db40e3361ae09188795e8cbe19752"><div class="ttname"><a href="gmock__stress__test_8cc.html#afd9db40e3361ae09188795e8cbe19752">count</a></div><div class="ttdeci">int * count</div><div class="ttdef"><b>Definition</b> <a href="gmock__stress__test_8cc_source.html#l00177">gmock_stress_test.cc:177</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_a4c26f003b72e800e9c934bca922a404a"><div class="ttname"><a href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a">yh_send_secure_msg</a></div><div class="ttdeci">yh_rc yh_send_secure_msg(yh_session *session, yh_cmd cmd, const uint8_t *data, size_t data_len, yh_cmd *response_cmd, uint8_t *response, size_t *response_len)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l00416">yubihsm.c:416</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_aa5415bafa9c48dfef0e183d8df504b7e"><div class="ttname"><a href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7e">yh_cmd</a></div><div class="ttdeci">yh_cmd</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00243">yubihsm.h:243</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_aa5415bafa9c48dfef0e183d8df504b7ea51cdf2ccd6995498e589e8ea6ce2a1f2"><div class="ttname"><a href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7ea51cdf2ccd6995498e589e8ea6ce2a1f2">YHC_ERROR</a></div><div class="ttdeci">@ YHC_ERROR</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00348">yubihsm.h:348</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_af764906e585805991dd84ec5dc2c060a_cgraph.png" border="0" usemap="#acommands_8c_af764906e585805991dd84ec5dc2c060a_cgraph" alt=""/></div>
<map name="acommands_8c_af764906e585805991dd84ec5dc2c060a_cgraph" id="acommands_8c_af764906e585805991dd84ec5dc2c060a_cgraph">
<area shape="rect" title=" " alt="" coords="5,80,108,106"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="583,5,651,31"/>
<area shape="poly" title=" " alt="" coords="104,77,155,65,270,46,385,33,567,18,568,23,386,38,271,51,156,70,105,82"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="156,80,304,106"/>
<area shape="poly" title=" " alt="" coords="108,90,140,90,140,96,108,96"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="575,104,659,130"/>
<area shape="poly" title=" " alt="" coords="105,104,156,116,257,135,336,146,416,149,517,140,560,131,561,136,518,145,416,154,336,152,256,140,155,121,104,109"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="352,55,517,80"/>
<area shape="poly" title=" " alt="" coords="304,81,336,77,337,82,304,86"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="370,104,500,130"/>
<area shape="poly" title=" " alt="" coords="304,99,355,105,354,110,304,104"/>
<area shape="poly" title=" " alt="" coords="484,51,567,29,569,34,486,57"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="581,55,653,80"/>
<area shape="poly" title=" " alt="" coords="518,65,566,65,566,70,518,70"/>
<area shape="poly" title=" " alt="" coords="486,78,561,99,560,104,484,84"/>
<area shape="poly" title=" " alt="" coords="484,101,566,78,567,84,486,106"/>
<area shape="poly" title=" " alt="" coords="500,114,560,114,560,120,500,120"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="565,153,669,179"/>
<area shape="poly" title=" " alt="" coords="486,128,553,146,551,151,484,133"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_af764906e585805991dd84ec5dc2c060a_icgraph.png" border="0" usemap="#acommands_8c_af764906e585805991dd84ec5dc2c060a_icgraph" alt=""/></div>
<map name="acommands_8c_af764906e585805991dd84ec5dc2c060a_icgraph" id="acommands_8c_af764906e585805991dd84ec5dc2c060a_icgraph">
<area shape="rect" title=" " alt="" coords="296,5,398,31"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="280,21,248,21,248,16,280,16"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,55,31"/>
<area shape="poly" title=" " alt="" coords="87,21,55,21,55,16,87,16"/>
</map>
</div>

</div>
</div>
<a id="a115ebd6b436229c152141f64a2405e70" name="a115ebd6b436229c152141f64a2405e70"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a115ebd6b436229c152141f64a2405e70">&#9670;&#160;</a></span>yh_com_encrypt_aesccm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int yh_com_encrypt_aesccm </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__context.html">yubihsm_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_argument.html">Argument</a> *</td>          <td class="paramname"><span class="paramname"><em>argv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a></td>          <td class="paramname"><span class="paramname"><em>fmt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="commands_8c_source.html#l00527">527</a> of file <a class="el" href="commands_8c_source.html">commands.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  528</span>                                          {</div>
<div class="line"><span class="lineno">  529</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno">  530</span> </div>
<div class="line"><span class="lineno">  531</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ctx);</div>
<div class="line"><span class="lineno">  532</span> </div>
<div class="line"><span class="lineno">  533</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> response[<a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a>];</div>
<div class="line"><span class="lineno">  534</span>  <span class="keywordtype">size_t</span> response_len = <span class="keyword">sizeof</span>(response);</div>
<div class="line"><span class="lineno">  535</span> </div>
<div class="line"><span class="lineno">  536</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#a7c2e101be04ad1546d99d5600e732eca">yh_util_wrap_data</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].w, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[2].x, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[2].<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>,</div>
<div class="line"><span class="lineno">  537</span>                          response, &amp;response_len);</div>
<div class="line"><span class="lineno">  538</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno">  539</span>    fprintf(stderr, <span class="stringliteral">&quot;Failed to encrypt data: %s\n&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno">  540</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  541</span>  }</div>
<div class="line"><span class="lineno">  542</span> </div>
<div class="line"><span class="lineno">  543</span>  <a class="code hl_function" href="util_8c.html#ad969d220471d10a9f07080b50210f403">write_file</a>(response, response_len, ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>, fmt_to_fmt(fmt));</div>
<div class="line"><span class="lineno">  544</span> </div>
<div class="line"><span class="lineno">  545</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  546</span>}</div>
<div class="ttc" id="ayubihsm_8c_html_a7c2e101be04ad1546d99d5600e732eca"><div class="ttname"><a href="yubihsm_8c.html#a7c2e101be04ad1546d99d5600e732eca">yh_util_wrap_data</a></div><div class="ttdeci">yh_rc yh_util_wrap_data(yh_session *session, uint16_t key_id, const uint8_t *in, size_t in_len, uint8_t *out, size_t *out_len)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l03667">yubihsm.c:3667</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_a115ebd6b436229c152141f64a2405e70_cgraph.png" border="0" usemap="#acommands_8c_a115ebd6b436229c152141f64a2405e70_cgraph" alt=""/></div>
<map name="acommands_8c_a115ebd6b436229c152141f64a2405e70_cgraph" id="acommands_8c_a115ebd6b436229c152141f64a2405e70_cgraph">
<area shape="rect" title=" " alt="" coords="5,56,176,82"/>
<area shape="rect" href="util_8c.html#ad969d220471d10a9f07080b50210f403" title=" " alt="" coords="250,5,324,31"/>
<area shape="poly" title=" " alt="" coords="143,53,235,29,236,34,144,58"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="818,108,901,134"/>
<area shape="poly" title=" " alt="" coords="176,70,437,84,760,108,802,112,802,117,759,113,437,90,176,75"/>
<area shape="rect" href="yubihsm_8c.html#a7c2e101be04ad1546d99d5600e732eca" title=" " alt="" coords="224,132,350,158"/>
<area shape="poly" title=" " alt="" coords="127,80,239,124,237,129,125,85"/>
<area shape="poly" title=" " alt="" coords="350,140,802,121,802,126,350,145"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="824,207,895,232"/>
<area shape="poly" title=" " alt="" coords="315,156,399,193,497,226,576,245,657,251,759,242,809,232,810,237,760,247,657,256,575,251,496,231,397,198,313,161"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="398,157,546,183"/>
<area shape="poly" title=" " alt="" coords="351,151,383,155,382,161,350,156"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="594,157,760,183"/>
<area shape="poly" title=" " alt="" coords="546,168,579,168,579,173,546,173"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="612,207,742,232"/>
<area shape="poly" title=" " alt="" coords="529,181,606,200,605,205,528,186"/>
<area shape="poly" title=" " alt="" coords="727,154,802,133,803,139,728,159"/>
<area shape="poly" title=" " alt="" coords="728,181,809,203,808,209,727,186"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="825,157,894,183"/>
<area shape="poly" title=" " alt="" coords="760,168,810,168,810,173,760,173"/>
<area shape="poly" title=" " alt="" coords="737,204,758,193,773,181,782,169,791,156,806,143,811,139,814,144,809,147,795,160,786,173,777,185,761,198,739,208"/>
<area shape="poly" title=" " alt="" coords="743,217,809,217,809,222,743,222"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="808,256,911,282"/>
<area shape="poly" title=" " alt="" coords="728,230,795,249,793,254,727,236"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_a115ebd6b436229c152141f64a2405e70_icgraph.png" border="0" usemap="#acommands_8c_a115ebd6b436229c152141f64a2405e70_icgraph" alt=""/></div>
<map name="acommands_8c_a115ebd6b436229c152141f64a2405e70_icgraph" id="acommands_8c_a115ebd6b436229c152141f64a2405e70_icgraph">
<area shape="rect" title=" " alt="" coords="296,5,466,31"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="280,21,248,21,248,16,280,16"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,55,31"/>
<area shape="poly" title=" " alt="" coords="87,21,55,21,55,16,87,16"/>
</map>
</div>

</div>
</div>
<a id="aa1c71ebc2b3f298b6522ab090393c73e" name="aa1c71ebc2b3f298b6522ab090393c73e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa1c71ebc2b3f298b6522ab090393c73e">&#9670;&#160;</a></span>yh_com_generate_asymmetric()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int yh_com_generate_asymmetric </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__context.html">yubihsm_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_argument.html">Argument</a> *</td>          <td class="paramname"><span class="paramname"><em>argv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a></td>          <td class="paramname"><span class="paramname"><em>fmt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="commands_8c_source.html#l00644">644</a> of file <a class="el" href="commands_8c_source.html">commands.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  645</span>                                               {</div>
<div class="line"><span class="lineno">  646</span> </div>
<div class="line"><span class="lineno">  647</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ctx);</div>
<div class="line"><span class="lineno">  648</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(fmt);</div>
<div class="line"><span class="lineno">  649</span> </div>
<div class="line"><span class="lineno">  650</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno">  651</span> </div>
<div class="line"><span class="lineno">  652</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="yubihsm_8c.html#a0a67155f2a7970ecb52e4f6aac6bbe84">yh_is_rsa</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[5].<a class="code hl_variable" href="pointer_8h.html#aeeddce917cf130d62c370b8f216026dd">a</a>)) {</div>
<div class="line"><span class="lineno">  653</span>    <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#ab1c62ef2643184a8ad44c569c87712d1">yh_util_generate_rsa_key</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e, &amp;<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].w, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[2].<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a>, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[3].w,</div>
<div class="line"><span class="lineno">  654</span>                                   &amp;<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[4].c, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[5].<a class="code hl_variable" href="pointer_8h.html#aeeddce917cf130d62c370b8f216026dd">a</a>);</div>
<div class="line"><span class="lineno">  655</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="yubihsm_8c.html#a3032a8f45bfad36ed6157b0158dd7921">yh_is_ec</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[5].<a class="code hl_variable" href="pointer_8h.html#aeeddce917cf130d62c370b8f216026dd">a</a>)) {</div>
<div class="line"><span class="lineno">  656</span>    <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#a2db9bbd57a908c5c454fc6254f57dcff">yh_util_generate_ec_key</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e, &amp;<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].w, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[2].<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a>, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[3].w,</div>
<div class="line"><span class="lineno">  657</span>                                  &amp;<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[4].c, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[5].<a class="code hl_variable" href="pointer_8h.html#aeeddce917cf130d62c370b8f216026dd">a</a>);</div>
<div class="line"><span class="lineno">  658</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="yubihsm_8c.html#a16fbf4426acbf42695c4ec4738b6ae8a">yh_is_ed</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[5].<a class="code hl_variable" href="pointer_8h.html#aeeddce917cf130d62c370b8f216026dd">a</a>)) {</div>
<div class="line"><span class="lineno">  659</span>    <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#a41f4326fe736e99302442d6a6109edbc">yh_util_generate_ed_key</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e, &amp;<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].w, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[2].<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a>, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[3].w,</div>
<div class="line"><span class="lineno">  660</span>                                  &amp;<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[4].c, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[5].<a class="code hl_variable" href="pointer_8h.html#aeeddce917cf130d62c370b8f216026dd">a</a>);</div>
<div class="line"><span class="lineno">  661</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  662</span>    fprintf(stderr, <span class="stringliteral">&quot;Invalid algorithm %d\n&quot;</span>, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[5].<a class="code hl_variable" href="pointer_8h.html#aeeddce917cf130d62c370b8f216026dd">a</a>);</div>
<div class="line"><span class="lineno">  663</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  664</span>  }</div>
<div class="line"><span class="lineno">  665</span> </div>
<div class="line"><span class="lineno">  666</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno">  667</span>    fprintf(stderr, <span class="stringliteral">&quot;Failed to generate asymmetric key: %s\n&quot;</span>,</div>
<div class="line"><span class="lineno">  668</span>            <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno">  669</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  670</span>  }</div>
<div class="line"><span class="lineno">  671</span> </div>
<div class="line"><span class="lineno">  672</span>  fprintf(stderr, <span class="stringliteral">&quot;Generated Asymmetric key 0x%04x\n&quot;</span>, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].w);</div>
<div class="line"><span class="lineno">  673</span> </div>
<div class="line"><span class="lineno">  674</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  675</span>}</div>
<div class="ttc" id="ayubihsm_8c_html_a16fbf4426acbf42695c4ec4738b6ae8a"><div class="ttname"><a href="yubihsm_8c.html#a16fbf4426acbf42695c4ec4738b6ae8a">yh_is_ed</a></div><div class="ttdeci">bool yh_is_ed(yh_algorithm algorithm)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l04280">yubihsm.c:4280</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a506da415c9307c897ca9be93acfe1d0f"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a></div><div class="ttdeci">char * s</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l00524">yubihsm_pkcs11.c:524</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_aa1c71ebc2b3f298b6522ab090393c73e_cgraph.png" border="0" usemap="#acommands_8c_aa1c71ebc2b3f298b6522ab090393c73e_cgraph" alt=""/></div>
<map name="acommands_8c_aa1c71ebc2b3f298b6522ab090393c73e_cgraph" id="acommands_8c_aa1c71ebc2b3f298b6522ab090393c73e_cgraph">
<area shape="rect" title=" " alt="" coords="5,157,205,183"/>
<area shape="rect" href="yubihsm_8c.html#a3032a8f45bfad36ed6157b0158dd7921" title=" " alt="" coords="472,31,545,56"/>
<area shape="poly" title=" " alt="" coords="147,154,252,121,456,57,458,62,253,126,149,159"/>
<area shape="rect" href="yubihsm_8c.html#a16fbf4426acbf42695c4ec4738b6ae8a" title=" " alt="" coords="472,157,545,183"/>
<area shape="poly" title=" " alt="" coords="170,154,287,139,355,137,422,142,458,150,457,155,422,147,355,142,288,144,170,159"/>
<area shape="rect" href="yubihsm_8c.html#a0a67155f2a7970ecb52e4f6aac6bbe84" title=" " alt="" coords="470,281,547,307"/>
<area shape="poly" title=" " alt="" coords="118,182,140,207,171,238,210,269,254,292,305,305,359,309,410,307,454,302,455,307,410,312,359,314,304,310,252,297,207,273,168,242,136,211,114,185"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="296,157,379,183"/>
<area shape="poly" title=" " alt="" coords="205,168,280,168,280,173,205,173"/>
<area shape="rect" href="yubihsm_8c.html#a2db9bbd57a908c5c454fc6254f57dcff" title=" " alt="" coords="255,5,420,31"/>
<area shape="poly" title=" " alt="" coords="118,155,173,104,211,75,251,48,278,35,280,40,254,52,214,79,177,108,121,159"/>
<area shape="rect" href="yubihsm_8c.html#a41f4326fe736e99302442d6a6109edbc" title=" " alt="" coords="255,207,420,232"/>
<area shape="poly" title=" " alt="" coords="170,181,259,200,258,205,169,186"/>
<area shape="rect" href="yubihsm_8c.html#ab1c62ef2643184a8ad44c569c87712d1" title=" " alt="" coords="253,256,422,282"/>
<area shape="poly" title=" " alt="" coords="130,181,186,211,254,242,270,248,268,253,252,247,183,216,128,186"/>
<area shape="poly" title=" " alt="" coords="421,28,457,33,456,39,420,33"/>
<area shape="poly" title=" " alt="" coords="385,204,421,193,456,183,458,188,423,198,386,209"/>
<area shape="poly" title=" " alt="" coords="423,279,455,284,454,289,422,284"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_aa1c71ebc2b3f298b6522ab090393c73e_icgraph.png" border="0" usemap="#acommands_8c_aa1c71ebc2b3f298b6522ab090393c73e_icgraph" alt=""/></div>
<map name="acommands_8c_aa1c71ebc2b3f298b6522ab090393c73e_icgraph" id="acommands_8c_aa1c71ebc2b3f298b6522ab090393c73e_icgraph">
<area shape="rect" title=" " alt="" coords="296,31,495,56"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="280,33,248,29,249,24,281,28"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,31,55,56"/>
<area shape="poly" title=" " alt="" coords="280,46,55,46,55,41,280,41"/>
<area shape="poly" title=" " alt="" coords="88,36,55,42,54,37,87,31"/>
</map>
</div>

</div>
</div>
<a id="a2be1be0e0a454965f5a378e4ecb483f0" name="a2be1be0e0a454965f5a378e4ecb483f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2be1be0e0a454965f5a378e4ecb483f0">&#9670;&#160;</a></span>yh_com_generate_hmac()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int yh_com_generate_hmac </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__context.html">yubihsm_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_argument.html">Argument</a> *</td>          <td class="paramname"><span class="paramname"><em>argv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a></td>          <td class="paramname"><span class="paramname"><em>fmt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="commands_8c_source.html#l00685">685</a> of file <a class="el" href="commands_8c_source.html">commands.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  685</span>                                                                               {</div>
<div class="line"><span class="lineno">  686</span> </div>
<div class="line"><span class="lineno">  687</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ctx);</div>
<div class="line"><span class="lineno">  688</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(fmt);</div>
<div class="line"><span class="lineno">  689</span> </div>
<div class="line"><span class="lineno">  690</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno">  691</span> </div>
<div class="line"><span class="lineno">  692</span>  <span class="keywordflow">if</span> (!<a class="code hl_function" href="yubihsm_8c.html#acb19de78e7d1aed72abbed5c74c676bc">yh_is_hmac</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[5].<a class="code hl_variable" href="pointer_8h.html#aeeddce917cf130d62c370b8f216026dd">a</a>)) {</div>
<div class="line"><span class="lineno">  693</span>    fprintf(stderr, <span class="stringliteral">&quot;Invalid algorithm: %d\n&quot;</span>, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[5].<a class="code hl_variable" href="pointer_8h.html#aeeddce917cf130d62c370b8f216026dd">a</a>);</div>
<div class="line"><span class="lineno">  694</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  695</span>  }</div>
<div class="line"><span class="lineno">  696</span> </div>
<div class="line"><span class="lineno">  697</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#a1eac22853548b7ceab92550c22233b18">yh_util_generate_hmac_key</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e, &amp;<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].w, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[2].<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a>, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[3].w,</div>
<div class="line"><span class="lineno">  698</span>                                  &amp;<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[4].c, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[5].<a class="code hl_variable" href="pointer_8h.html#aeeddce917cf130d62c370b8f216026dd">a</a>);</div>
<div class="line"><span class="lineno">  699</span> </div>
<div class="line"><span class="lineno">  700</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno">  701</span>    fprintf(stderr, <span class="stringliteral">&quot;Failed to generate HMAC key: %s\n&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno">  702</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  703</span>  }</div>
<div class="line"><span class="lineno">  704</span> </div>
<div class="line"><span class="lineno">  705</span>  fprintf(stderr, <span class="stringliteral">&quot;Generated HMAC key 0x%04x\n&quot;</span>, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].w);</div>
<div class="line"><span class="lineno">  706</span> </div>
<div class="line"><span class="lineno">  707</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  708</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_a2be1be0e0a454965f5a378e4ecb483f0_cgraph.png" border="0" usemap="#acommands_8c_a2be1be0e0a454965f5a378e4ecb483f0_cgraph" alt=""/></div>
<map name="acommands_8c_a2be1be0e0a454965f5a378e4ecb483f0_cgraph" id="acommands_8c_a2be1be0e0a454965f5a378e4ecb483f0_cgraph">
<area shape="rect" title=" " alt="" coords="5,105,169,131"/>
<area shape="rect" href="yubihsm_8c.html#acb19de78e7d1aed72abbed5c74c676bc" title=" " alt="" coords="263,56,354,82"/>
<area shape="poly" title=" " alt="" coords="147,102,247,80,248,85,149,107"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="868,179,951,204"/>
<area shape="poly" title=" " alt="" coords="151,129,217,141,430,170,644,186,755,190,852,190,852,195,755,195,644,191,430,175,216,146,150,134"/>
<area shape="rect" href="yubihsm_8c.html#a1eac22853548b7ceab92550c22233b18" title=" " alt="" coords="217,105,400,131"/>
<area shape="poly" title=" " alt="" coords="169,116,201,116,201,121,169,121"/>
<area shape="poly" title=" " alt="" coords="379,129,448,141,672,169,852,185,852,190,672,174,448,146,378,134"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="874,80,945,106"/>
<area shape="poly" title=" " alt="" coords="379,102,448,90,628,61,708,57,810,65,860,75,859,80,809,70,708,62,629,66,448,95,380,107"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="875,5,944,31"/>
<area shape="poly" title=" " alt="" coords="370,102,399,92,422,75,432,67,447,60,503,43,560,30,675,16,779,11,860,13,860,18,779,17,676,21,561,35,504,48,449,65,435,72,425,80,401,97,372,107"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="448,105,596,131"/>
<area shape="poly" title=" " alt="" coords="400,116,433,116,433,121,400,121"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="644,80,810,106"/>
<area shape="poly" title=" " alt="" coords="596,106,628,102,629,108,597,112"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="662,129,792,155"/>
<area shape="poly" title=" " alt="" coords="597,124,647,130,646,135,596,129"/>
<area shape="poly" title=" " alt="" coords="789,104,811,115,827,127,836,140,845,152,859,165,864,169,861,173,856,170,841,156,832,143,823,131,808,119,787,109"/>
<area shape="poly" title=" " alt="" coords="810,90,858,90,858,96,810,96"/>
<area shape="poly" title=" " alt="" coords="759,77,861,35,863,40,761,82"/>
<area shape="poly" title=" " alt="" coords="778,153,853,174,852,179,777,158"/>
<area shape="poly" title=" " alt="" coords="777,126,858,104,859,109,778,131"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="858,129,961,155"/>
<area shape="poly" title=" " alt="" coords="793,140,842,140,842,145,793,145"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_a2be1be0e0a454965f5a378e4ecb483f0_icgraph.png" border="0" usemap="#acommands_8c_a2be1be0e0a454965f5a378e4ecb483f0_icgraph" alt=""/></div>
<map name="acommands_8c_a2be1be0e0a454965f5a378e4ecb483f0_icgraph" id="acommands_8c_a2be1be0e0a454965f5a378e4ecb483f0_icgraph">
<area shape="rect" title=" " alt="" coords="296,31,459,56"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="280,34,248,30,249,25,281,29"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,31,55,56"/>
<area shape="poly" title=" " alt="" coords="280,46,55,46,55,41,280,41"/>
<area shape="poly" title=" " alt="" coords="88,36,55,42,54,37,87,31"/>
</map>
</div>

</div>
</div>
<a id="a13416d261c1a92415525cbfa63a2dc0c" name="a13416d261c1a92415525cbfa63a2dc0c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a13416d261c1a92415525cbfa63a2dc0c">&#9670;&#160;</a></span>yh_com_generate_otp_aead_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int yh_com_generate_otp_aead_key </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__context.html">yubihsm_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_argument.html">Argument</a> *</td>          <td class="paramname"><span class="paramname"><em>argv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a></td>          <td class="paramname"><span class="paramname"><em>fmt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="commands_8c_source.html#l02648">2648</a> of file <a class="el" href="commands_8c_source.html">commands.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2649</span>                                                 {</div>
<div class="line"><span class="lineno"> 2650</span> </div>
<div class="line"><span class="lineno"> 2651</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ctx);</div>
<div class="line"><span class="lineno"> 2652</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(fmt);</div>
<div class="line"><span class="lineno"> 2653</span> </div>
<div class="line"><span class="lineno"> 2654</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 2655</span> </div>
<div class="line"><span class="lineno"> 2656</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> =</div>
<div class="line"><span class="lineno"> 2657</span>    <a class="code hl_function" href="yubihsm_8c.html#a9e130d225a8dc003d7a7c0ce4b8ea5e4">yh_util_generate_otp_aead_key</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e, &amp;<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].w, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[2].<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a>, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[3].w,</div>
<div class="line"><span class="lineno"> 2658</span>                                  &amp;<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[4].c, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[5].<a class="code hl_variable" href="pointer_8h.html#aeeddce917cf130d62c370b8f216026dd">a</a>, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[6].d);</div>
<div class="line"><span class="lineno"> 2659</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 2660</span>    fprintf(stderr, <span class="stringliteral">&quot;Failed to generate OTP AEAD key: %s\n&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 2661</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 2662</span>  }</div>
<div class="line"><span class="lineno"> 2663</span> </div>
<div class="line"><span class="lineno"> 2664</span>  fprintf(stderr, <span class="stringliteral">&quot;Generated OTP AEAD key 0x%04x\n&quot;</span>, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].w);</div>
<div class="line"><span class="lineno"> 2665</span> </div>
<div class="line"><span class="lineno"> 2666</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 2667</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_a13416d261c1a92415525cbfa63a2dc0c_cgraph.png" border="0" usemap="#acommands_8c_a13416d261c1a92415525cbfa63a2dc0c_cgraph" alt=""/></div>
<map name="acommands_8c_a13416d261c1a92415525cbfa63a2dc0c_cgraph" id="acommands_8c_a13416d261c1a92415525cbfa63a2dc0c_cgraph">
<area shape="rect" title=" " alt="" coords="5,172,155,213"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="812,179,895,204"/>
<area shape="poly" title=" " alt="" coords="155,190,796,189,796,194,155,195"/>
<area shape="rect" href="yubihsm_8c.html#a9e130d225a8dc003d7a7c0ce4b8ea5e4" title=" " alt="" coords="203,98,344,138"/>
<area shape="poly" title=" " alt="" coords="134,169,204,142,206,147,136,174"/>
<area shape="poly" title=" " alt="" coords="345,132,392,141,504,157,616,170,796,185,796,191,615,175,504,163,392,146,344,137"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="818,80,889,106"/>
<area shape="poly" title=" " alt="" coords="344,98,427,81,529,67,642,59,698,60,754,65,804,75,803,80,753,70,698,65,642,65,530,72,428,87,345,103"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="819,5,888,31"/>
<area shape="poly" title=" " alt="" coords="308,95,347,75,391,58,505,34,620,21,724,15,804,14,804,20,724,20,621,26,506,39,393,63,349,80,310,100"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="392,105,540,131"/>
<area shape="poly" title=" " alt="" coords="344,116,377,116,377,121,344,121"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="588,80,754,106"/>
<area shape="poly" title=" " alt="" coords="540,106,572,102,573,108,541,112"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="606,129,736,155"/>
<area shape="poly" title=" " alt="" coords="541,124,591,130,590,135,540,129"/>
<area shape="poly" title=" " alt="" coords="733,104,755,115,771,127,780,140,789,152,803,165,808,169,805,173,800,170,785,156,776,143,767,131,752,119,731,109"/>
<area shape="poly" title=" " alt="" coords="754,90,802,90,802,96,754,96"/>
<area shape="poly" title=" " alt="" coords="703,77,805,35,807,40,705,82"/>
<area shape="poly" title=" " alt="" coords="722,153,797,174,796,179,721,158"/>
<area shape="poly" title=" " alt="" coords="721,126,802,104,803,109,722,131"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="802,129,905,155"/>
<area shape="poly" title=" " alt="" coords="737,140,786,140,786,145,737,145"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_a13416d261c1a92415525cbfa63a2dc0c_icgraph.png" border="0" usemap="#acommands_8c_a13416d261c1a92415525cbfa63a2dc0c_icgraph" alt=""/></div>
<map name="acommands_8c_a13416d261c1a92415525cbfa63a2dc0c_icgraph" id="acommands_8c_a13416d261c1a92415525cbfa63a2dc0c_icgraph">
<area shape="rect" title=" " alt="" coords="296,23,445,64"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="280,34,248,30,249,25,281,29"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,31,55,56"/>
<area shape="poly" title=" " alt="" coords="280,46,55,46,55,41,280,41"/>
<area shape="poly" title=" " alt="" coords="88,36,55,42,54,37,87,31"/>
</map>
</div>

</div>
</div>
<a id="a43d7d9dd1659838d79f875e61e59ce52" name="a43d7d9dd1659838d79f875e61e59ce52"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43d7d9dd1659838d79f875e61e59ce52">&#9670;&#160;</a></span>yh_com_generate_wrap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int yh_com_generate_wrap </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__context.html">yubihsm_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_argument.html">Argument</a> *</td>          <td class="paramname"><span class="paramname"><em>argv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a></td>          <td class="paramname"><span class="paramname"><em>fmt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="commands_8c_source.html#l00719">719</a> of file <a class="el" href="commands_8c_source.html">commands.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  719</span>                                                                               {</div>
<div class="line"><span class="lineno">  720</span> </div>
<div class="line"><span class="lineno">  721</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ctx);</div>
<div class="line"><span class="lineno">  722</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(fmt);</div>
<div class="line"><span class="lineno">  723</span> </div>
<div class="line"><span class="lineno">  724</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno">  725</span> </div>
<div class="line"><span class="lineno">  726</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#a1f749a696792e7911844629e056d9c15">yh_util_generate_wrap_key</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e, &amp;<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].w, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[2].<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a>, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[3].w,</div>
<div class="line"><span class="lineno">  727</span>                                  &amp;<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[4].c, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[6].<a class="code hl_variable" href="pointer_8h.html#aeeddce917cf130d62c370b8f216026dd">a</a>, &amp;<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[5].c);</div>
<div class="line"><span class="lineno">  728</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno">  729</span>    fprintf(stderr, <span class="stringliteral">&quot;Failed to generate wrapping key: %s\n&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno">  730</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  731</span>  }</div>
<div class="line"><span class="lineno">  732</span> </div>
<div class="line"><span class="lineno">  733</span>  fprintf(stderr, <span class="stringliteral">&quot;Generated Wrap key 0x%04x\n&quot;</span>, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].w);</div>
<div class="line"><span class="lineno">  734</span> </div>
<div class="line"><span class="lineno">  735</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  736</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_a43d7d9dd1659838d79f875e61e59ce52_cgraph.png" border="0" usemap="#acommands_8c_a43d7d9dd1659838d79f875e61e59ce52_cgraph" alt=""/></div>
<map name="acommands_8c_a43d7d9dd1659838d79f875e61e59ce52_cgraph" id="acommands_8c_a43d7d9dd1659838d79f875e61e59ce52_cgraph">
<area shape="rect" title=" " alt="" coords="5,180,165,206"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="860,179,943,204"/>
<area shape="poly" title=" " alt="" coords="165,190,844,189,844,194,165,195"/>
<area shape="rect" href="yubihsm_8c.html#a1f749a696792e7911844629e056d9c15" title=" " alt="" coords="213,105,392,131"/>
<area shape="poly" title=" " alt="" coords="124,177,247,134,249,139,126,182"/>
<area shape="poly" title=" " alt="" coords="372,129,440,141,664,169,844,185,844,190,664,174,440,146,371,134"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="866,80,937,106"/>
<area shape="poly" title=" " alt="" coords="371,102,440,90,620,61,700,57,802,65,852,75,851,80,801,70,700,62,621,66,440,95,372,107"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="867,5,936,31"/>
<area shape="poly" title=" " alt="" coords="328,102,379,80,439,60,554,37,669,24,772,18,851,15,851,21,772,23,669,30,555,43,441,65,381,85,331,107"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="440,105,588,131"/>
<area shape="poly" title=" " alt="" coords="392,116,424,116,424,121,392,121"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="636,80,802,106"/>
<area shape="poly" title=" " alt="" coords="588,106,620,102,621,108,589,112"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="654,129,784,155"/>
<area shape="poly" title=" " alt="" coords="589,124,639,130,638,135,588,129"/>
<area shape="poly" title=" " alt="" coords="781,104,803,115,819,127,828,140,837,152,851,165,856,169,853,173,848,170,833,156,824,143,815,131,800,119,779,109"/>
<area shape="poly" title=" " alt="" coords="802,90,850,90,850,96,802,96"/>
<area shape="poly" title=" " alt="" coords="751,77,853,35,855,40,753,82"/>
<area shape="poly" title=" " alt="" coords="770,153,845,174,844,179,769,158"/>
<area shape="poly" title=" " alt="" coords="769,126,850,104,851,109,770,131"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="850,129,953,155"/>
<area shape="poly" title=" " alt="" coords="785,140,834,140,834,145,785,145"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_a43d7d9dd1659838d79f875e61e59ce52_icgraph.png" border="0" usemap="#acommands_8c_a43d7d9dd1659838d79f875e61e59ce52_icgraph" alt=""/></div>
<map name="acommands_8c_a43d7d9dd1659838d79f875e61e59ce52_icgraph" id="acommands_8c_a43d7d9dd1659838d79f875e61e59ce52_icgraph">
<area shape="rect" title=" " alt="" coords="296,31,455,56"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="280,34,248,30,248,25,281,29"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,31,55,56"/>
<area shape="poly" title=" " alt="" coords="281,46,55,46,55,41,281,41"/>
<area shape="poly" title=" " alt="" coords="88,36,55,42,54,37,87,31"/>
</map>
</div>

</div>
</div>
<a id="aca833cbc2ca7673b00a4f6cb320c97b6" name="aca833cbc2ca7673b00a4f6cb320c97b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca833cbc2ca7673b00a4f6cb320c97b6">&#9670;&#160;</a></span>yh_com_get_device_info()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int yh_com_get_device_info </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__context.html">yubihsm_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_argument.html">Argument</a> *</td>          <td class="paramname"><span class="paramname"><em>argv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a></td>          <td class="paramname"><span class="paramname"><em>fmt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="commands_8c_source.html#l01876">1876</a> of file <a class="el" href="commands_8c_source.html">commands.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1877</span>                                           {</div>
<div class="line"><span class="lineno"> 1878</span> </div>
<div class="line"><span class="lineno"> 1879</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>);</div>
<div class="line"><span class="lineno"> 1880</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(fmt);</div>
<div class="line"><span class="lineno"> 1881</span> </div>
<div class="line"><span class="lineno"> 1882</span>  <span class="keywordflow">if</span> (ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a8c52c1a89cd4334a0225a1fbfba9a930">connector</a> == NULL) {</div>
<div class="line"><span class="lineno"> 1883</span>    fprintf(stderr, <span class="stringliteral">&quot;Not connected\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1884</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 1885</span>  }</div>
<div class="line"><span class="lineno"> 1886</span> </div>
<div class="line"><span class="lineno"> 1887</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 1888</span> </div>
<div class="line"><span class="lineno"> 1889</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a5bd4e4c943762926c8f653b6224cced2">major</a>;</div>
<div class="line"><span class="lineno"> 1890</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ae2f416b0a34b7beb4ed3873d791ac393">minor</a>;</div>
<div class="line"><span class="lineno"> 1891</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a00c54fad5fef8d31eb75c1163468005b">patch</a>;</div>
<div class="line"><span class="lineno"> 1892</span>  <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a1149ca4bd0659030412db8e77bebdf88">serial</a>;</div>
<div class="line"><span class="lineno"> 1893</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> log_total;</div>
<div class="line"><span class="lineno"> 1894</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> log_used;</div>
<div class="line"><span class="lineno"> 1895</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55ca">yh_algorithm</a> algorithms[<a class="code hl_define" href="yubihsm_8h.html#a6f472329e64b5720ed637fa886aea8c8">YH_MAX_ALGORITHM_COUNT</a>];</div>
<div class="line"><span class="lineno"> 1896</span>  <span class="keywordtype">size_t</span> n_algorithms = <span class="keyword">sizeof</span>(algorithms);</div>
<div class="line"><span class="lineno"> 1897</span> </div>
<div class="line"><span class="lineno"> 1898</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> =</div>
<div class="line"><span class="lineno"> 1899</span>    <a class="code hl_function" href="yubihsm_8c.html#a6ab558e1426359cc78e7a362f8b3acd9">yh_util_get_device_info</a>(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a8c52c1a89cd4334a0225a1fbfba9a930">connector</a>, &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a5bd4e4c943762926c8f653b6224cced2">major</a>, &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ae2f416b0a34b7beb4ed3873d791ac393">minor</a>, &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a00c54fad5fef8d31eb75c1163468005b">patch</a>, &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a1149ca4bd0659030412db8e77bebdf88">serial</a>,</div>
<div class="line"><span class="lineno"> 1900</span>                            &amp;log_total, &amp;log_used, algorithms, &amp;n_algorithms);</div>
<div class="line"><span class="lineno"> 1901</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 1902</span>    fprintf(stderr, <span class="stringliteral">&quot;Failed to get device info: %s\n&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 1903</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 1904</span>  }</div>
<div class="line"><span class="lineno"> 1905</span> </div>
<div class="line"><span class="lineno"> 1906</span>  fprintf(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>, <span class="stringliteral">&quot;Version number:\t\t%hhu.%hhu.%hhu\n&quot;</span>, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a5bd4e4c943762926c8f653b6224cced2">major</a>, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ae2f416b0a34b7beb4ed3873d791ac393">minor</a>, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a00c54fad5fef8d31eb75c1163468005b">patch</a>);</div>
<div class="line"><span class="lineno"> 1907</span>  fprintf(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>, <span class="stringliteral">&quot;Serial number:\t\t%u\n&quot;</span>, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a1149ca4bd0659030412db8e77bebdf88">serial</a>);</div>
<div class="line"><span class="lineno"> 1908</span>  fprintf(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>, <span class="stringliteral">&quot;Log used:\t\t%d/%d\n&quot;</span>, log_used, log_total);</div>
<div class="line"><span class="lineno"> 1909</span> </div>
<div class="line"><span class="lineno"> 1910</span>  fprintf(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>, <span class="stringliteral">&quot;Supported algorithms:\t&quot;</span>);</div>
<div class="line"><span class="lineno"> 1911</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; n_algorithms; i++) {</div>
<div class="line"><span class="lineno"> 1912</span>    <span class="keyword">const</span> <span class="keywordtype">char</span> *algo_str;</div>
<div class="line"><span class="lineno"> 1913</span>    <a class="code hl_function" href="yubihsm_8c.html#a2a0d369611aa795c62645467062a9acb">yh_algo_to_string</a>(algorithms[i], &amp;algo_str);</div>
<div class="line"><span class="lineno"> 1914</span>    fprintf(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>, <span class="stringliteral">&quot;%s, &quot;</span>, algo_str);</div>
<div class="line"><span class="lineno"> 1915</span>    <span class="keywordflow">if</span> ((i + 1) % 3 == 0 &amp;&amp; i != 0) {</div>
<div class="line"><span class="lineno"> 1916</span>      fprintf(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>, <span class="stringliteral">&quot;\n\t\t\t&quot;</span>);</div>
<div class="line"><span class="lineno"> 1917</span>    }</div>
<div class="line"><span class="lineno"> 1918</span>  }</div>
<div class="line"><span class="lineno"> 1919</span>  fprintf(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>, <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1920</span> </div>
<div class="line"><span class="lineno"> 1921</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1922</span>}</div>
<div class="ttc" id="ayubihsm_8c_html_a6ab558e1426359cc78e7a362f8b3acd9"><div class="ttname"><a href="yubihsm_8c.html#a6ab558e1426359cc78e7a362f8b3acd9">yh_util_get_device_info</a></div><div class="ttdeci">yh_rc yh_util_get_device_info(yh_connector *connector, uint8_t *major, uint8_t *minor, uint8_t *patch, uint32_t *serial, uint8_t *log_total, uint8_t *log_used, yh_algorithm *algorithms, size_t *n_algorithms)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l00938">yubihsm.c:938</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a6f472329e64b5720ed637fa886aea8c8"><div class="ttname"><a href="yubihsm_8h.html#a6f472329e64b5720ed637fa886aea8c8">YH_MAX_ALGORITHM_COUNT</a></div><div class="ttdeci">#define YH_MAX_ALGORITHM_COUNT</div><div class="ttdoc">Max number of algorithms defined here.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00383">yubihsm.h:383</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a00c54fad5fef8d31eb75c1163468005b"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a00c54fad5fef8d31eb75c1163468005b">patch</a></div><div class="ttdeci">uint8_t patch</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l00548">yubihsm_pkcs11.c:548</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a1149ca4bd0659030412db8e77bebdf88"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a1149ca4bd0659030412db8e77bebdf88">serial</a></div><div class="ttdeci">uint32_t serial</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l00611">yubihsm_pkcs11.c:611</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a5bd4e4c943762926c8f653b6224cced2"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a5bd4e4c943762926c8f653b6224cced2">major</a></div><div class="ttdeci">uint8_t major</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l00546">yubihsm_pkcs11.c:546</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_ae2f416b0a34b7beb4ed3873d791ac393"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#ae2f416b0a34b7beb4ed3873d791ac393">minor</a></div><div class="ttdeci">uint8_t minor</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l00547">yubihsm_pkcs11.c:547</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_aca833cbc2ca7673b00a4f6cb320c97b6_cgraph.png" border="0" usemap="#acommands_8c_aca833cbc2ca7673b00a4f6cb320c97b6_cgraph" alt=""/></div>
<map name="acommands_8c_aca833cbc2ca7673b00a4f6cb320c97b6_cgraph" id="acommands_8c_aca833cbc2ca7673b00a4f6cb320c97b6_cgraph">
<area shape="rect" title=" " alt="" coords="5,56,171,82"/>
<area shape="rect" href="yubihsm_8c.html#a2a0d369611aa795c62645467062a9acb" title=" " alt="" coords="430,5,554,31"/>
<area shape="poly" title=" " alt="" coords="171,54,218,48,415,24,415,29,219,53,171,59"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="608,81,692,107"/>
<area shape="poly" title=" " alt="" coords="171,69,560,85,593,87,592,92,560,90,171,74"/>
<area shape="rect" href="yubihsm_8c.html#a6ab558e1426359cc78e7a362f8b3acd9" title=" " alt="" coords="219,107,376,132"/>
<area shape="poly" title=" " alt="" coords="145,80,227,100,226,105,144,85"/>
<area shape="poly" title=" " alt="" coords="523,29,562,48,610,72,607,76,559,53,520,34"/>
<area shape="poly" title=" " alt="" coords="376,111,592,96,593,101,377,117"/>
<area shape="rect" href="yubihsm_8c.html#a799e299be8d4c13dfa2112a60d05480d" title=" " alt="" coords="424,157,560,183"/>
<area shape="poly" title=" " alt="" coords="350,130,426,150,425,155,349,136"/>
<area shape="poly" title=" " alt="" coords="520,154,559,136,607,112,610,117,562,141,523,159"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="614,157,686,183"/>
<area shape="poly" title=" " alt="" coords="561,168,599,168,599,173,561,173"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_aca833cbc2ca7673b00a4f6cb320c97b6_icgraph.png" border="0" usemap="#acommands_8c_aca833cbc2ca7673b00a4f6cb320c97b6_icgraph" alt=""/></div>
<map name="acommands_8c_aca833cbc2ca7673b00a4f6cb320c97b6_icgraph" id="acommands_8c_aca833cbc2ca7673b00a4f6cb320c97b6_icgraph">
<area shape="rect" title=" " alt="" coords="296,31,461,56"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="280,34,248,30,249,25,281,29"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,31,55,56"/>
<area shape="poly" title=" " alt="" coords="280,46,55,46,55,41,280,41"/>
<area shape="poly" title=" " alt="" coords="88,36,55,42,54,37,87,31"/>
</map>
</div>

</div>
</div>
<a id="afa7330c81148ba6f4d5c53f7c370ed41" name="afa7330c81148ba6f4d5c53f7c370ed41"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa7330c81148ba6f4d5c53f7c370ed41">&#9670;&#160;</a></span>yh_com_get_object_info()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int yh_com_get_object_info </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__context.html">yubihsm_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_argument.html">Argument</a> *</td>          <td class="paramname"><span class="paramname"><em>argv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a></td>          <td class="paramname"><span class="paramname"><em>fmt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="commands_8c_source.html#l00924">924</a> of file <a class="el" href="commands_8c_source.html">commands.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  925</span>                                           {</div>
<div class="line"><span class="lineno">  926</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno">  927</span>  <a class="code hl_struct" href="structyh__object__descriptor.html">yh_object_descriptor</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a85d991d90970121ba1480cd98d93aab9">object</a>;</div>
<div class="line"><span class="lineno">  928</span> </div>
<div class="line"><span class="lineno">  929</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ctx);</div>
<div class="line"><span class="lineno">  930</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(fmt);</div>
<div class="line"><span class="lineno">  931</span> </div>
<div class="line"><span class="lineno">  932</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#a7b5f1f0c1cbca11fbe21e7e4e6b29a1b">yh_util_get_object_info</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].w, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[2].b, &amp;<span class="keywordtype">object</span>);</div>
<div class="line"><span class="lineno">  933</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno">  934</span>    fprintf(stderr, <span class="stringliteral">&quot;Failed to get object info: %s\n&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno">  935</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  936</span>  }</div>
<div class="line"><span class="lineno">  937</span> </div>
<div class="line"><span class="lineno">  938</span>  <span class="keywordtype">char</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a5420fd4d2f76428942c2716b1cb7e863">domains</a>[256] = {0};</div>
<div class="line"><span class="lineno">  939</span>  <span class="keyword">const</span> <span class="keywordtype">char</span> *cap[<span class="keyword">sizeof</span>(yh_capability) / <span class="keyword">sizeof</span>(yh_capability[0])];</div>
<div class="line"><span class="lineno">  940</span>  <span class="keywordtype">size_t</span> n_cap = <span class="keyword">sizeof</span>(yh_capability) / <span class="keyword">sizeof</span>(yh_capability[0]);</div>
<div class="line"><span class="lineno">  941</span>  <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code hl_variable" href="yubihsm_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a>;</div>
<div class="line"><span class="lineno">  942</span>  <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code hl_variable" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a> = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><span class="lineno">  943</span>  <span class="keyword">const</span> <span class="keywordtype">char</span> *extra_algo = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><span class="lineno">  944</span>  <a class="code hl_function" href="yubihsm_8c.html#afe3d701f7470c1d7b05480e4b6728bf7">yh_type_to_string</a>(<span class="keywordtype">object</span>.type, &amp;type);</div>
<div class="line"><span class="lineno">  945</span>  <span class="keywordflow">if</span> (<span class="keywordtype">object</span>.<a class="code hl_variable" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>) {</div>
<div class="line"><span class="lineno">  946</span>    <a class="code hl_function" href="yubihsm_8c.html#a2a0d369611aa795c62645467062a9acb">yh_algo_to_string</a>(<span class="keywordtype">object</span>.<a class="code hl_variable" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>, &amp;<a class="code hl_variable" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>);</div>
<div class="line"><span class="lineno">  947</span>    extra_algo = <span class="stringliteral">&quot;, algorithm: &quot;</span>;</div>
<div class="line"><span class="lineno">  948</span>  }</div>
<div class="line"><span class="lineno">  949</span>  <a class="code hl_function" href="yubihsm_8c.html#a0100df295f7ecf0d0cc90052aac20586">yh_domains_to_string</a>(<span class="keywordtype">object</span>.<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a5420fd4d2f76428942c2716b1cb7e863">domains</a>, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a5420fd4d2f76428942c2716b1cb7e863">domains</a>, 255);</div>
<div class="line"><span class="lineno">  950</span> </div>
<div class="line"><span class="lineno">  951</span>  fprintf(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>,</div>
<div class="line"><span class="lineno">  952</span>          <span class="stringliteral">&quot;id: 0x%04x, type: %s%s%s, label: \&quot;%s\&quot;, length: %d, &quot;</span></div>
<div class="line"><span class="lineno">  953</span>          <span class="stringliteral">&quot;domains: %s, sequence: %hhu, origin: &quot;</span>,</div>
<div class="line"><span class="lineno">  954</span>          <span class="keywordtype">object</span>.id, type, extra_algo, <a class="code hl_variable" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>, <span class="keywordtype">object</span>.label, <span class="keywordtype">object</span>.len,</div>
<div class="line"><span class="lineno">  955</span>          <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a5420fd4d2f76428942c2716b1cb7e863">domains</a>, <span class="keywordtype">object</span>.sequence);</div>
<div class="line"><span class="lineno">  956</span> </div>
<div class="line"><span class="lineno">  957</span>  <span class="keywordflow">if</span> (<span class="keywordtype">object</span>.origin &amp; <a class="code hl_define" href="yubihsm_8h.html#a1b233ade526e2b1a6313e2e2d892bd88">YH_ORIGIN_GENERATED</a>) {</div>
<div class="line"><span class="lineno">  958</span>    fprintf(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>, <span class="stringliteral">&quot;generated&quot;</span>);</div>
<div class="line"><span class="lineno">  959</span>  }</div>
<div class="line"><span class="lineno">  960</span>  <span class="keywordflow">if</span> (<span class="keywordtype">object</span>.origin &amp; <a class="code hl_define" href="yubihsm_8h.html#a1b58deb7ffe0ac04a240e07923a8a613">YH_ORIGIN_IMPORTED</a>) {</div>
<div class="line"><span class="lineno">  961</span>    fprintf(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>, <span class="stringliteral">&quot;imported&quot;</span>);</div>
<div class="line"><span class="lineno">  962</span>  }</div>
<div class="line"><span class="lineno">  963</span>  <span class="keywordflow">if</span> (<span class="keywordtype">object</span>.origin &amp; <a class="code hl_define" href="yubihsm_8h.html#a03f1a4cf5b57bc3a4eababaee26aa801">YH_ORIGIN_IMPORTED_WRAPPED</a>) {</div>
<div class="line"><span class="lineno">  964</span>    fprintf(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>, <span class="stringliteral">&quot;:imported_wrapped&quot;</span>);</div>
<div class="line"><span class="lineno">  965</span>  }</div>
<div class="line"><span class="lineno">  966</span> </div>
<div class="line"><span class="lineno">  967</span>  fprintf(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>, <span class="stringliteral">&quot;, capabilities: &quot;</span>);</div>
<div class="line"><span class="lineno">  968</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="yubihsm_8c.html#ac46bac75dfd0a4358a4e6b432a50e48a">yh_capabilities_to_strings</a>(&amp;<span class="keywordtype">object</span>.<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a08393519edfd7c59fb01fb8db97514b5">capabilities</a>, cap, &amp;n_cap) !=</div>
<div class="line"><span class="lineno">  969</span>      <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno">  970</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code hl_define" href="yubihsm_8h.html#ad3c904849d17cae0a6f426e8007731d7">YH_CAPABILITIES_LEN</a>; i++) {</div>
<div class="line"><span class="lineno">  971</span>      fprintf(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>, <span class="stringliteral">&quot;0x%02x%s&quot;</span>, <span class="keywordtype">object</span>.capabilities.capabilities[i],</div>
<div class="line"><span class="lineno">  972</span>              i &lt; <a class="code hl_define" href="yubihsm_8h.html#ad3c904849d17cae0a6f426e8007731d7">YH_CAPABILITIES_LEN</a> - 1 ? <span class="stringliteral">&quot; &quot;</span> : <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno">  973</span>    }</div>
<div class="line"><span class="lineno">  974</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  975</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; n_cap; i++) {</div>
<div class="line"><span class="lineno">  976</span>      fprintf(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>, <span class="stringliteral">&quot;%s%s&quot;</span>, cap[i], i &lt; n_cap - 1 ? <span class="stringliteral">&quot;:&quot;</span> : <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno">  977</span>    }</div>
<div class="line"><span class="lineno">  978</span>  }</div>
<div class="line"><span class="lineno">  979</span>  <span class="keywordflow">if</span> (<span class="keywordtype">object</span>.type == <a class="code hl_enumvalue" href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583a16f0118db1dac3d0732e7d66630e1dba">YH_WRAP_KEY</a> || <span class="keywordtype">object</span>.type == <a class="code hl_enumvalue" href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583acee44b775b3c5b6157f0732699935074">YH_AUTHENTICATION_KEY</a>) {</div>
<div class="line"><span class="lineno">  980</span>    fprintf(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>, <span class="stringliteral">&quot;, delegated_capabilities: &quot;</span>);</div>
<div class="line"><span class="lineno">  981</span>    n_cap = <span class="keyword">sizeof</span>(yh_capability) / <span class="keyword">sizeof</span>(yh_capability[0]);</div>
<div class="line"><span class="lineno">  982</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="yubihsm_8c.html#ac46bac75dfd0a4358a4e6b432a50e48a">yh_capabilities_to_strings</a>(&amp;<span class="keywordtype">object</span>.<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#afa62e10709d52e5162a732e81369a7ec">delegated_capabilities</a>, cap,</div>
<div class="line"><span class="lineno">  983</span>                                   &amp;n_cap) != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno">  984</span>      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code hl_define" href="yubihsm_8h.html#ad3c904849d17cae0a6f426e8007731d7">YH_CAPABILITIES_LEN</a>; i++) {</div>
<div class="line"><span class="lineno">  985</span>        fprintf(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>, <span class="stringliteral">&quot;0x%02x%s&quot;</span>,</div>
<div class="line"><span class="lineno">  986</span>                <span class="keywordtype">object</span>.delegated_capabilities.capabilities[i],</div>
<div class="line"><span class="lineno">  987</span>                i &lt; <a class="code hl_define" href="yubihsm_8h.html#ad3c904849d17cae0a6f426e8007731d7">YH_CAPABILITIES_LEN</a> - 1 ? <span class="stringliteral">&quot; &quot;</span> : <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno">  988</span>      }</div>
<div class="line"><span class="lineno">  989</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  990</span>      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; n_cap; i++) {</div>
<div class="line"><span class="lineno">  991</span>        fprintf(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>, <span class="stringliteral">&quot;%s%s&quot;</span>, cap[i], i &lt; n_cap - 1 ? <span class="stringliteral">&quot;:&quot;</span> : <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno">  992</span>      }</div>
<div class="line"><span class="lineno">  993</span>    }</div>
<div class="line"><span class="lineno">  994</span>  }</div>
<div class="line"><span class="lineno">  995</span>  fprintf(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>, <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><span class="lineno">  996</span> </div>
<div class="line"><span class="lineno">  997</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  998</span>}</div>
<div class="ttc" id="astructyh__object__descriptor_html"><div class="ttname"><a href="structyh__object__descriptor.html">yh_object_descriptor</a></div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00540">yubihsm.h:540</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_a0100df295f7ecf0d0cc90052aac20586"><div class="ttname"><a href="yubihsm_8c.html#a0100df295f7ecf0d0cc90052aac20586">yh_domains_to_string</a></div><div class="ttdeci">yh_rc yh_domains_to_string(uint16_t domains, char *string, size_t max_len)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l04587">yubihsm.c:4587</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_a7b5f1f0c1cbca11fbe21e7e4e6b29a1b"><div class="ttname"><a href="yubihsm_8c.html#a7b5f1f0c1cbca11fbe21e7e4e6b29a1b">yh_util_get_object_info</a></div><div class="ttdeci">yh_rc yh_util_get_object_info(yh_session *session, uint16_t id, yh_object_type type, yh_object_descriptor *object)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l01128">yubihsm.c:1128</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_ac46bac75dfd0a4358a4e6b432a50e48a"><div class="ttname"><a href="yubihsm_8c.html#ac46bac75dfd0a4358a4e6b432a50e48a">yh_capabilities_to_strings</a></div><div class="ttdeci">yh_rc yh_capabilities_to_strings(const yh_capabilities *num, const char *result[], size_t *n_result)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l04168">yubihsm.c:4168</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_afe3d701f7470c1d7b05480e4b6728bf7"><div class="ttname"><a href="yubihsm_8c.html#afe3d701f7470c1d7b05480e4b6728bf7">yh_type_to_string</a></div><div class="ttdeci">yh_rc yh_type_to_string(yh_object_type type, char const **result)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l04424">yubihsm.c:4424</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a03f1a4cf5b57bc3a4eababaee26aa801"><div class="ttname"><a href="yubihsm_8h.html#a03f1a4cf5b57bc3a4eababaee26aa801">YH_ORIGIN_IMPORTED_WRAPPED</a></div><div class="ttdeci">#define YH_ORIGIN_IMPORTED_WRAPPED</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00697">yubihsm.h:697</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a1b233ade526e2b1a6313e2e2d892bd88"><div class="ttname"><a href="yubihsm_8h.html#a1b233ade526e2b1a6313e2e2d892bd88">YH_ORIGIN_GENERATED</a></div><div class="ttdeci">#define YH_ORIGIN_GENERATED</div><div class="ttdoc">The object was generated on the device.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00692">yubihsm.h:692</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a1b58deb7ffe0ac04a240e07923a8a613"><div class="ttname"><a href="yubihsm_8h.html#a1b58deb7ffe0ac04a240e07923a8a613">YH_ORIGIN_IMPORTED</a></div><div class="ttdeci">#define YH_ORIGIN_IMPORTED</div><div class="ttdoc">The object was imported into the device.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00694">yubihsm.h:694</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a1d127017fb298b889f4ba24752d08b8e"><div class="ttname"><a href="yubihsm_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a></div><div class="ttdeci">yh_object_type type</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00672">yubihsm.h:672</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a67bb26eddc39413f8e94c98aedbbd391"><div class="ttname"><a href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a></div><div class="ttdeci">yh_algorithm algorithm</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00619">yubihsm.h:619</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_ad3c904849d17cae0a6f426e8007731d7"><div class="ttname"><a href="yubihsm_8h.html#ad3c904849d17cae0a6f426e8007731d7">YH_CAPABILITIES_LEN</a></div><div class="ttdeci">#define YH_CAPABILITIES_LEN</div><div class="ttdoc">Length of capabilities array.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00119">yubihsm.h:119</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a5420fd4d2f76428942c2716b1cb7e863"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a5420fd4d2f76428942c2716b1cb7e863">domains</a></div><div class="ttdeci">uint16_t domains</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l01926">yubihsm_pkcs11.c:1926</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a85d991d90970121ba1480cd98d93aab9"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a85d991d90970121ba1480cd98d93aab9">object</a></div><div class="ttdeci">yh_object_descriptor object</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l01544">yubihsm_pkcs11.c:1544</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_afa62e10709d52e5162a732e81369a7ec"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#afa62e10709d52e5162a732e81369a7ec">delegated_capabilities</a></div><div class="ttdeci">yh_capabilities delegated_capabilities</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l01306">yubihsm_pkcs11.c:1306</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_afa7330c81148ba6f4d5c53f7c370ed41_cgraph.png" border="0" usemap="#acommands_8c_afa7330c81148ba6f4d5c53f7c370ed41_cgraph" alt=""/></div>
<map name="acommands_8c_afa7330c81148ba6f4d5c53f7c370ed41_cgraph" id="acommands_8c_afa7330c81148ba6f4d5c53f7c370ed41_cgraph">
<area shape="rect" title=" " alt="" coords="5,104,168,130"/>
<area shape="rect" href="yubihsm_8c.html#a2a0d369611aa795c62645467062a9acb" title=" " alt="" coords="430,25,554,51"/>
<area shape="poly" title=" " alt="" coords="134,101,215,81,414,46,415,51,216,86,136,106"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="838,133,921,159"/>
<area shape="poly" title=" " alt="" coords="108,101,156,75,215,49,310,19,388,6,467,4,566,10,677,14,724,22,781,45,805,61,828,80,862,119,858,122,824,84,802,65,778,50,723,27,677,19,566,15,466,9,388,11,312,25,217,54,158,79,110,106"/>
<area shape="rect" href="yubihsm_8c.html#ac46bac75dfd0a4358a4e6b432a50e48a" title=" " alt="" coords="634,126,760,166"/>
<area shape="poly" title=" " alt="" coords="168,118,619,140,618,145,168,123"/>
<area shape="rect" href="yubihsm_8c.html#a0100df295f7ecf0d0cc90052aac20586" title=" " alt="" coords="219,240,367,266"/>
<area shape="poly" title=" " alt="" coords="101,128,149,176,182,203,217,226,227,231,224,236,214,231,178,207,145,180,98,132"/>
<area shape="rect" href="yubihsm_8c.html#afe3d701f7470c1d7b05480e4b6728bf7" title=" " alt="" coords="430,76,554,102"/>
<area shape="poly" title=" " alt="" coords="168,108,415,91,415,97,168,114"/>
<area shape="rect" href="yubihsm_8c.html#a7b5f1f0c1cbca11fbe21e7e4e6b29a1b" title=" " alt="" coords="216,191,370,216"/>
<area shape="poly" title=" " alt="" coords="120,128,247,182,245,187,118,133"/>
<area shape="poly" title=" " alt="" coords="555,38,662,51,722,64,781,82,818,101,851,122,848,126,816,105,779,87,721,69,661,57,554,44"/>
<area shape="poly" title=" " alt="" coords="760,143,822,143,822,149,760,149"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="845,212,914,238"/>
<area shape="poly" title=" " alt="" coords="747,164,835,203,833,208,745,169"/>
<area shape="poly" title=" " alt="" coords="555,87,661,94,780,111,830,125,828,130,779,117,660,100,555,93"/>
<area shape="poly" title=" " alt="" coords="371,203,558,200,669,191,779,175,829,162,831,167,780,181,669,196,558,205,371,208"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="844,325,915,351"/>
<area shape="poly" title=" " alt="" coords="350,214,371,225,387,239,396,252,405,265,419,277,471,302,526,321,583,334,639,341,745,346,828,341,829,347,745,351,639,347,582,339,524,326,469,307,417,282,401,269,392,255,383,242,369,230,348,219"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="418,241,566,267"/>
<area shape="poly" title=" " alt="" coords="347,214,425,234,424,239,346,219"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="614,241,780,267"/>
<area shape="poly" title=" " alt="" coords="566,251,599,251,599,257,566,257"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="632,291,762,316"/>
<area shape="poly" title=" " alt="" coords="549,265,626,284,625,289,548,270"/>
<area shape="poly" title=" " alt="" coords="738,238,778,220,817,194,851,167,854,171,820,198,781,224,740,243"/>
<area shape="poly" title=" " alt="" coords="780,238,829,230,830,235,781,243"/>
<area shape="poly" title=" " alt="" coords="755,265,781,276,806,293,829,312,836,316,833,320,826,316,802,297,778,280,753,270"/>
<area shape="poly" title=" " alt="" coords="760,288,778,277,795,259,804,241,812,221,826,198,852,168,856,171,830,201,817,223,809,243,800,262,781,281,763,292"/>
<area shape="poly" title=" " alt="" coords="763,313,829,326,828,331,762,318"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="828,276,931,302"/>
<area shape="poly" title=" " alt="" coords="762,295,812,291,812,297,763,301"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_afa7330c81148ba6f4d5c53f7c370ed41_icgraph.png" border="0" usemap="#acommands_8c_afa7330c81148ba6f4d5c53f7c370ed41_icgraph" alt=""/></div>
<map name="acommands_8c_afa7330c81148ba6f4d5c53f7c370ed41_icgraph" id="acommands_8c_afa7330c81148ba6f4d5c53f7c370ed41_icgraph">
<area shape="rect" title=" " alt="" coords="296,31,458,56"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="280,34,248,30,249,25,281,29"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,31,55,56"/>
<area shape="poly" title=" " alt="" coords="280,46,55,46,55,41,280,41"/>
<area shape="poly" title=" " alt="" coords="88,36,55,42,54,37,87,31"/>
</map>
</div>

</div>
</div>
<a id="ad8a4781a26be12a87848234cc184a3bb" name="ad8a4781a26be12a87848234cc184a3bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad8a4781a26be12a87848234cc184a3bb">&#9670;&#160;</a></span>yh_com_get_opaque()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int yh_com_get_opaque </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__context.html">yubihsm_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_argument.html">Argument</a> *</td>          <td class="paramname"><span class="paramname"><em>argv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a></td>          <td class="paramname"><span class="paramname"><em>fmt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="commands_8c_source.html#l00743">743</a> of file <a class="el" href="commands_8c_source.html">commands.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  743</span>                                                                            {</div>
<div class="line"><span class="lineno">  744</span> </div>
<div class="line"><span class="lineno">  745</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ctx);</div>
<div class="line"><span class="lineno">  746</span> </div>
<div class="line"><span class="lineno">  747</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> response[<a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a>];</div>
<div class="line"><span class="lineno">  748</span>  <span class="keywordtype">size_t</span> response_len = <span class="keyword">sizeof</span>(response);</div>
<div class="line"><span class="lineno">  749</span> </div>
<div class="line"><span class="lineno">  750</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#a56e060e71fb8baa0531b3a20848abf37">yh_util_get_opaque</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].w, response, &amp;response_len);</div>
<div class="line"><span class="lineno">  751</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno">  752</span>    fprintf(stderr, <span class="stringliteral">&quot;Failed to get opaque object: %s\n&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno">  753</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  754</span>  }</div>
<div class="line"><span class="lineno">  755</span> </div>
<div class="line"><span class="lineno">  756</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="util_8c.html#ad969d220471d10a9f07080b50210f403">write_file</a>(response, response_len, ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>, fmt_to_fmt(fmt))) {</div>
<div class="line"><span class="lineno">  757</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  758</span>  }</div>
<div class="line"><span class="lineno">  759</span> </div>
<div class="line"><span class="lineno">  760</span>  <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  761</span>}</div>
<div class="ttc" id="ayubihsm_8c_html_a56e060e71fb8baa0531b3a20848abf37"><div class="ttname"><a href="yubihsm_8c.html#a56e060e71fb8baa0531b3a20848abf37">yh_util_get_opaque</a></div><div class="ttdeci">yh_rc yh_util_get_opaque(yh_session *session, uint16_t object_id, uint8_t *out, size_t *out_len)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l02636">yubihsm.c:2636</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_ad8a4781a26be12a87848234cc184a3bb_cgraph.png" border="0" usemap="#acommands_8c_ad8a4781a26be12a87848234cc184a3bb_cgraph" alt=""/></div>
<map name="acommands_8c_ad8a4781a26be12a87848234cc184a3bb_cgraph" id="acommands_8c_ad8a4781a26be12a87848234cc184a3bb_cgraph">
<area shape="rect" title=" " alt="" coords="5,56,147,82"/>
<area shape="rect" href="util_8c.html#ad969d220471d10a9f07080b50210f403" title=" " alt="" coords="225,5,298,31"/>
<area shape="poly" title=" " alt="" coords="125,53,209,30,210,35,127,58"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="796,108,879,134"/>
<area shape="poly" title=" " alt="" coords="147,70,407,84,738,108,780,112,780,117,737,113,407,89,147,75"/>
<area shape="rect" href="yubihsm_8c.html#a56e060e71fb8baa0531b3a20848abf37" title=" " alt="" coords="195,132,328,158"/>
<area shape="poly" title=" " alt="" coords="111,80,215,123,213,128,109,85"/>
<area shape="poly" title=" " alt="" coords="328,139,780,120,780,126,329,145"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="802,207,873,232"/>
<area shape="poly" title=" " alt="" coords="290,156,377,193,475,226,554,245,635,251,737,242,787,232,788,237,738,247,635,256,554,250,474,231,375,198,288,161"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="376,157,524,183"/>
<area shape="poly" title=" " alt="" coords="329,151,361,155,360,161,328,156"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="572,157,738,183"/>
<area shape="poly" title=" " alt="" coords="524,168,557,168,557,173,524,173"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="590,207,720,232"/>
<area shape="poly" title=" " alt="" coords="507,181,584,200,583,205,506,186"/>
<area shape="poly" title=" " alt="" coords="705,154,780,133,781,139,706,159"/>
<area shape="poly" title=" " alt="" coords="706,181,787,203,786,209,705,186"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="803,157,872,183"/>
<area shape="poly" title=" " alt="" coords="738,168,788,168,788,173,738,173"/>
<area shape="poly" title=" " alt="" coords="715,204,736,193,751,181,760,169,769,156,784,143,789,139,792,144,787,147,773,160,764,173,755,185,739,198,717,208"/>
<area shape="poly" title=" " alt="" coords="721,217,787,217,787,222,721,222"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="786,256,889,282"/>
<area shape="poly" title=" " alt="" coords="706,230,773,249,771,254,705,236"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_ad8a4781a26be12a87848234cc184a3bb_icgraph.png" border="0" usemap="#acommands_8c_ad8a4781a26be12a87848234cc184a3bb_icgraph" alt=""/></div>
<map name="acommands_8c_ad8a4781a26be12a87848234cc184a3bb_icgraph" id="acommands_8c_ad8a4781a26be12a87848234cc184a3bb_icgraph">
<area shape="rect" title=" " alt="" coords="296,31,437,56"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="280,35,248,30,249,25,281,29"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,31,55,56"/>
<area shape="poly" title=" " alt="" coords="281,46,55,46,55,41,281,41"/>
<area shape="poly" title=" " alt="" coords="88,36,55,42,54,37,87,31"/>
</map>
</div>

</div>
</div>
<a id="aaafb1f743869a0068a7d7b6ed1bafb01" name="aaafb1f743869a0068a7d7b6ed1bafb01"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaafb1f743869a0068a7d7b6ed1bafb01">&#9670;&#160;</a></span>yh_com_get_option()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int yh_com_get_option </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__context.html">yubihsm_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_argument.html">Argument</a> *</td>          <td class="paramname"><span class="paramname"><em>argv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a></td>          <td class="paramname"><span class="paramname"><em>fmt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="commands_8c_source.html#l00767">767</a> of file <a class="el" href="commands_8c_source.html">commands.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  767</span>                                                                            {</div>
<div class="line"><span class="lineno">  768</span> </div>
<div class="line"><span class="lineno">  769</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ctx);</div>
<div class="line"><span class="lineno">  770</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(fmt);</div>
<div class="line"><span class="lineno">  771</span> </div>
<div class="line"><span class="lineno">  772</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno">  773</span> </div>
<div class="line"><span class="lineno">  774</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> response[<a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a>];</div>
<div class="line"><span class="lineno">  775</span>  <span class="keywordtype">size_t</span> response_len = <span class="keyword">sizeof</span>(response);</div>
<div class="line"><span class="lineno">  776</span> </div>
<div class="line"><span class="lineno">  777</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#a11871e03c808e2d25737f893e58ed094">yh_util_get_option</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].o, response, &amp;response_len);</div>
<div class="line"><span class="lineno">  778</span> </div>
<div class="line"><span class="lineno">  779</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno">  780</span>    fprintf(stderr, <span class="stringliteral">&quot;Failed to get option: %s\n&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno">  781</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  782</span>  }</div>
<div class="line"><span class="lineno">  783</span> </div>
<div class="line"><span class="lineno">  784</span>  fprintf(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>, <span class="stringliteral">&quot;Option value is: &quot;</span>);</div>
<div class="line"><span class="lineno">  785</span>  <span class="keywordflow">for</span> (<a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> i = 0; i &lt; response_len; i++) {</div>
<div class="line"><span class="lineno">  786</span>    fprintf(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>, <span class="stringliteral">&quot;%02x&quot;</span>, response[i]);</div>
<div class="line"><span class="lineno">  787</span>  }</div>
<div class="line"><span class="lineno">  788</span>  fprintf(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>, <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><span class="lineno">  789</span> </div>
<div class="line"><span class="lineno">  790</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  791</span>}</div>
<div class="ttc" id="ayubihsm_8c_html_a11871e03c808e2d25737f893e58ed094"><div class="ttname"><a href="yubihsm_8c.html#a11871e03c808e2d25737f893e58ed094">yh_util_get_option</a></div><div class="ttdeci">yh_rc yh_util_get_option(yh_session *session, yh_option option, uint8_t *out, size_t *out_len)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l03584">yubihsm.c:3584</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_aaafb1f743869a0068a7d7b6ed1bafb01_cgraph.png" border="0" usemap="#acommands_8c_aaafb1f743869a0068a7d7b6ed1bafb01_cgraph" alt=""/></div>
<map name="acommands_8c_aaafb1f743869a0068a7d7b6ed1bafb01_cgraph" id="acommands_8c_aaafb1f743869a0068a7d7b6ed1bafb01_cgraph">
<area shape="rect" title=" " alt="" coords="5,179,140,204"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="782,153,865,179"/>
<area shape="poly" title=" " alt="" coords="140,190,314,189,519,181,724,169,766,167,766,172,724,174,519,186,314,194,140,195"/>
<area shape="rect" href="yubihsm_8c.html#a11871e03c808e2d25737f893e58ed094" title=" " alt="" coords="188,153,314,179"/>
<area shape="poly" title=" " alt="" coords="140,179,172,175,173,180,141,185"/>
<area shape="poly" title=" " alt="" coords="314,164,766,164,766,169,314,169"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="362,103,510,128"/>
<area shape="poly" title=" " alt="" coords="300,150,372,130,373,135,301,155"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="558,53,724,79"/>
<area shape="poly" title=" " alt="" coords="492,99,569,81,570,86,493,105"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="576,103,706,128"/>
<area shape="poly" title=" " alt="" coords="510,113,561,113,561,118,510,118"/>
<area shape="poly" title=" " alt="" coords="703,77,725,88,741,101,750,114,759,127,773,140,778,143,775,148,770,144,755,130,746,117,737,105,722,92,701,82"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="788,55,859,80"/>
<area shape="poly" title=" " alt="" coords="724,64,772,64,772,70,724,69"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="789,5,858,31"/>
<area shape="poly" title=" " alt="" coords="692,50,773,28,775,34,694,55"/>
<area shape="poly" title=" " alt="" coords="691,126,767,148,766,153,689,132"/>
<area shape="poly" title=" " alt="" coords="692,99,772,78,773,83,694,105"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="772,104,875,130"/>
<area shape="poly" title=" " alt="" coords="707,113,756,114,756,119,707,119"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_aaafb1f743869a0068a7d7b6ed1bafb01_icgraph.png" border="0" usemap="#acommands_8c_aaafb1f743869a0068a7d7b6ed1bafb01_icgraph" alt=""/></div>
<map name="acommands_8c_aaafb1f743869a0068a7d7b6ed1bafb01_icgraph" id="acommands_8c_aaafb1f743869a0068a7d7b6ed1bafb01_icgraph">
<area shape="rect" title=" " alt="" coords="296,5,430,31"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="280,21,248,21,248,16,280,16"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,55,31"/>
<area shape="poly" title=" " alt="" coords="87,21,55,21,55,16,87,16"/>
</map>
</div>

</div>
</div>
<a id="aa1c9a933f4601dae48cd64f911d297aa" name="aa1c9a933f4601dae48cd64f911d297aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa1c9a933f4601dae48cd64f911d297aa">&#9670;&#160;</a></span>yh_com_get_pubkey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int yh_com_get_pubkey </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__context.html">yubihsm_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_argument.html">Argument</a> *</td>          <td class="paramname"><span class="paramname"><em>argv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a></td>          <td class="paramname"><span class="paramname"><em>fmt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="commands_8c_source.html#l00850">850</a> of file <a class="el" href="commands_8c_source.html">commands.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  850</span>                                                                            {</div>
<div class="line"><span class="lineno">  851</span> </div>
<div class="line"><span class="lineno">  852</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno">  853</span> </div>
<div class="line"><span class="lineno">  854</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> response[<a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a>];</div>
<div class="line"><span class="lineno">  855</span>  <span class="keywordtype">size_t</span> response_len = <span class="keyword">sizeof</span>(response);</div>
<div class="line"><span class="lineno">  856</span> </div>
<div class="line"><span class="lineno">  857</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55ca">yh_algorithm</a> algo;</div>
<div class="line"><span class="lineno">  858</span>  EVP_PKEY *public_key = NULL;</div>
<div class="line"><span class="lineno">  859</span> </div>
<div class="line"><span class="lineno">  860</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#aa7b8b42156c4bdaf41d8b9758a2fd73f">yh_util_get_public_key</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].w, response, &amp;response_len,</div>
<div class="line"><span class="lineno">  861</span>                               &amp;algo);</div>
<div class="line"><span class="lineno">  862</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno">  863</span>    fprintf(stderr, <span class="stringliteral">&quot;Failed to get public key: %s\n&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno">  864</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  865</span>  }</div>
<div class="line"><span class="lineno">  866</span> </div>
<div class="line"><span class="lineno">  867</span>  public_key = EVP_PKEY_new();</div>
<div class="line"><span class="lineno">  868</span> </div>
<div class="line"><span class="lineno">  869</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="yubihsm_8c.html#a0a67155f2a7970ecb52e4f6aac6bbe84">yh_is_rsa</a>(algo)) {</div>
<div class="line"><span class="lineno">  870</span>    RSA *rsa = RSA_new();</div>
<div class="line"><span class="lineno">  871</span>    <a class="code hl_typedef" href="include_2fc_2crypto_2bigint_8hpp.html#a62125ea4e1d748a4a9c1aed9766f451a">BIGNUM</a> *e = BN_new();</div>
<div class="line"><span class="lineno">  872</span>    <a class="code hl_typedef" href="include_2fc_2crypto_2bigint_8hpp.html#a62125ea4e1d748a4a9c1aed9766f451a">BIGNUM</a> *n = BN_bin2bn(response, response_len, NULL);</div>
<div class="line"><span class="lineno">  873</span>    BN_hex2bn(&amp;e, <span class="stringliteral">&quot;10001&quot;</span>);</div>
<div class="line"><span class="lineno">  874</span>    <a class="code hl_function" href="openssl-compat_8c.html#ada007b0a8f3f9089fed98a22cb2b1554">RSA_set0_key</a>(rsa, n, e, NULL);</div>
<div class="line"><span class="lineno">  875</span>    EVP_PKEY_set1_RSA(public_key, rsa);</div>
<div class="line"><span class="lineno">  876</span>    RSA_free(rsa);</div>
<div class="line"><span class="lineno">  877</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="yubihsm_8c.html#a3032a8f45bfad36ed6157b0158dd7921">yh_is_ec</a>(algo)) {</div>
<div class="line"><span class="lineno">  878</span>    EC_KEY *eckey = EC_KEY_new();</div>
<div class="line"><span class="lineno">  879</span>    <span class="keywordtype">int</span> nid = <a class="code hl_function" href="util_8c.html#a4e9f3e93eb6ebbc74d142d6a490de752">algo2nid</a>(algo);</div>
<div class="line"><span class="lineno">  880</span>    EC_POINT *<a class="code hl_struct" href="structpoint.html">point</a>;</div>
<div class="line"><span class="lineno">  881</span>    EC_GROUP *<a class="code hl_variable" href="namespaceupload.html#a9d33d66de17175dced88ffe95f079226">group</a> = EC_GROUP_new_by_curve_name(nid);</div>
<div class="line"><span class="lineno">  882</span> </div>
<div class="line"><span class="lineno">  883</span>    EC_GROUP_set_asn1_flag(group, nid);</div>
<div class="line"><span class="lineno">  884</span>    EC_KEY_set_group(eckey, group);</div>
<div class="line"><span class="lineno">  885</span>    <a class="code hl_struct" href="structpoint.html">point</a> = EC_POINT_new(group);</div>
<div class="line"><span class="lineno">  886</span> </div>
<div class="line"><span class="lineno">  887</span>    memmove(response + 1, response, response_len);</div>
<div class="line"><span class="lineno">  888</span>    response[0] = 0x04; <span class="comment">// hack to make it a valid ec pubkey..</span></div>
<div class="line"><span class="lineno">  889</span>    response_len++;</div>
<div class="line"><span class="lineno">  890</span> </div>
<div class="line"><span class="lineno">  891</span>    EC_POINT_oct2point(group, <a class="code hl_struct" href="structpoint.html">point</a>, response, response_len, NULL);</div>
<div class="line"><span class="lineno">  892</span> </div>
<div class="line"><span class="lineno">  893</span>    EC_KEY_set_public_key(eckey, <a class="code hl_struct" href="structpoint.html">point</a>);</div>
<div class="line"><span class="lineno">  894</span> </div>
<div class="line"><span class="lineno">  895</span>    EVP_PKEY_set1_EC_KEY(public_key, eckey);</div>
<div class="line"><span class="lineno">  896</span> </div>
<div class="line"><span class="lineno">  897</span>    EC_POINT_free(<a class="code hl_struct" href="structpoint.html">point</a>);</div>
<div class="line"><span class="lineno">  898</span>    EC_KEY_free(eckey);</div>
<div class="line"><span class="lineno">  899</span>    EC_GROUP_free(group);</div>
<div class="line"><span class="lineno">  900</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  901</span>    <span class="comment">// NOTE(adma): ED25519, there is no support for thi in OpenSSL, so</span></div>
<div class="line"><span class="lineno">  902</span>    <span class="comment">// we manually export them</span></div>
<div class="line"><span class="lineno">  903</span>    EVP_PKEY_free(public_key);</div>
<div class="line"><span class="lineno">  904</span>    <a class="code hl_function" href="util_8c.html#a8daf6956da2dcd44bc4ff4e7a7959ac0">write_ed25519_key</a>(response, response_len, ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>,</div>
<div class="line"><span class="lineno">  905</span>                      ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#addfaa9a6a08f58bdb5b5a93f2e89ccc2">out_fmt</a> == <a class="code hl_enumvalue" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708aa8908f2c651567ae288c587240e71d3e">fmt_PEM</a>); <span class="comment">// FIXME: do something</span></div>
<div class="line"><span class="lineno">  906</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  907</span>  }</div>
<div class="line"><span class="lineno">  908</span> </div>
<div class="line"><span class="lineno">  909</span>  <span class="keywordflow">if</span> (fmt == <a class="code hl_enumvalue" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708aa8908f2c651567ae288c587240e71d3e">fmt_PEM</a>) {</div>
<div class="line"><span class="lineno">  910</span>    PEM_write_PUBKEY(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>, public_key);</div>
<div class="line"><span class="lineno">  911</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (fmt == <a class="code hl_enumvalue" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708a701725c70fb214e14a2feee390939a09">fmt_binary</a>) {</div>
<div class="line"><span class="lineno">  912</span>    i2d_PUBKEY_fp(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>, public_key);</div>
<div class="line"><span class="lineno">  913</span>  } <span class="comment">// FIXME: other formats or error.</span></div>
<div class="line"><span class="lineno">  914</span>  EVP_PKEY_free(public_key);</div>
<div class="line"><span class="lineno">  915</span> </div>
<div class="line"><span class="lineno">  916</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  917</span>}</div>
<div class="ttc" id="ainclude_2fc_2crypto_2bigint_8hpp_html_a62125ea4e1d748a4a9c1aed9766f451a"><div class="ttname"><a href="include_2fc_2crypto_2bigint_8hpp.html#a62125ea4e1d748a4a9c1aed9766f451a">BIGNUM</a></div><div class="ttdeci">bignum_st BIGNUM</div><div class="ttdef"><b>Definition</b> <a href="include_2fc_2crypto_2bigint_8hpp_source.html#l00007">bigint.hpp:7</a></div></div>
<div class="ttc" id="anamespaceupload_html_a9d33d66de17175dced88ffe95f079226"><div class="ttname"><a href="namespaceupload.html#a9d33d66de17175dced88ffe95f079226">upload.group</a></div><div class="ttdeci">group</div><div class="ttdef"><b>Definition</b> <a href="googlemock_2scripts_2upload_8py_source.html#l00397">upload.py:397</a></div></div>
<div class="ttc" id="aopenssl-compat_8c_html_ada007b0a8f3f9089fed98a22cb2b1554"><div class="ttname"><a href="openssl-compat_8c.html#ada007b0a8f3f9089fed98a22cb2b1554">RSA_set0_key</a></div><div class="ttdeci">int RSA_set0_key(RSA *r, BIGNUM *n, BIGNUM *e, BIGNUM *d)</div><div class="ttdef"><b>Definition</b> <a href="openssl-compat_8c_source.html#l00013">openssl-compat.c:13</a></div></div>
<div class="ttc" id="astructpoint_html"><div class="ttname"><a href="structpoint.html">point</a></div><div class="ttdef"><b>Definition</b> <a href="_benchmark_8cpp_source.html#l00004">Benchmark.cpp:5</a></div></div>
<div class="ttc" id="autil_8c_html_a4e9f3e93eb6ebbc74d142d6a490de752"><div class="ttname"><a href="util_8c.html#a4e9f3e93eb6ebbc74d142d6a490de752">algo2nid</a></div><div class="ttdeci">int algo2nid(yh_algorithm algo)</div><div class="ttdef"><b>Definition</b> <a href="util_8c_source.html#l00335">util.c:335</a></div></div>
<div class="ttc" id="autil_8c_html_a8daf6956da2dcd44bc4ff4e7a7959ac0"><div class="ttname"><a href="util_8c.html#a8daf6956da2dcd44bc4ff4e7a7959ac0">write_ed25519_key</a></div><div class="ttdeci">bool write_ed25519_key(uint8_t *buf, size_t buf_len, FILE *fp, bool b64_encode)</div><div class="ttdef"><b>Definition</b> <a href="util_8c_source.html#l00622">util.c:622</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_aa1c9a933f4601dae48cd64f911d297aa_cgraph.png" border="0" usemap="#acommands_8c_aa1c9a933f4601dae48cd64f911d297aa_cgraph" alt=""/></div>
<map name="acommands_8c_aa1c9a933f4601dae48cd64f911d297aa_cgraph" id="acommands_8c_aa1c9a933f4601dae48cd64f911d297aa_cgraph">
<area shape="rect" title=" " alt="" coords="5,232,147,258"/>
<area shape="rect" href="util_8c.html#a4e9f3e93eb6ebbc74d142d6a490de752" title=" " alt="" coords="237,5,306,31"/>
<area shape="poly" title=" " alt="" coords="79,231,92,193,115,142,149,88,169,62,193,40,221,25,223,30,196,44,173,66,153,91,120,145,97,195,84,233"/>
<area shape="rect" href="openssl-compat_8c.html#ada007b0a8f3f9089fed98a22cb2b1554" title=" " alt="" coords="217,55,326,80"/>
<area shape="poly" title=" " alt="" coords="83,230,125,168,156,131,193,97,213,85,216,89,196,102,160,134,129,171,87,233"/>
<area shape="rect" href="util_8c.html#a8daf6956da2dcd44bc4ff4e7a7959ac0" title=" " alt="" coords="608,105,742,131"/>
<area shape="poly" title=" " alt="" coords="139,229,194,217,595,132,596,137,195,222,140,234"/>
<area shape="rect" href="yubihsm_8c.html#a3032a8f45bfad36ed6157b0158dd7921" title=" " alt="" coords="235,408,308,434"/>
<area shape="poly" title=" " alt="" coords="87,257,129,318,160,354,196,387,222,402,219,406,193,391,157,358,125,321,83,260"/>
<area shape="rect" href="yubihsm_8c.html#a0a67155f2a7970ecb52e4f6aac6bbe84" title=" " alt="" coords="233,457,310,483"/>
<area shape="poly" title=" " alt="" coords="84,257,97,294,120,344,153,398,173,423,196,444,219,457,217,462,193,448,169,426,149,401,115,347,92,296,79,259"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="816,305,899,331"/>
<area shape="poly" title=" " alt="" coords="135,256,195,268,393,298,592,313,703,316,800,316,800,322,703,322,592,318,392,303,194,273,134,261"/>
<area shape="rect" href="yubihsm_8c.html#aa7b8b42156c4bdaf41d8b9758a2fd73f" title=" " alt="" coords="195,232,348,258"/>
<area shape="poly" title=" " alt="" coords="147,242,179,242,179,248,147,248"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="822,207,893,232"/>
<area shape="poly" title=" " alt="" coords="720,129,759,148,784,170,807,192,814,197,812,201,804,196,780,174,756,152,718,134"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="823,156,892,182"/>
<area shape="poly" title=" " alt="" coords="725,129,809,153,808,158,723,134"/>
<area shape="rect" href="util_8c.html#ad969d220471d10a9f07080b50210f403" title=" " alt="" coords="821,105,894,131"/>
<area shape="poly" title=" " alt="" coords="742,116,805,116,805,121,742,121"/>
<area shape="poly" title=" " alt="" coords="333,229,396,217,497,199,576,187,656,183,758,192,808,202,807,207,757,197,656,189,577,192,498,204,396,222,334,234"/>
<area shape="poly" title=" " alt="" coords="334,256,396,268,620,296,800,312,800,317,619,301,396,273,333,261"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="396,232,544,258"/>
<area shape="poly" title=" " alt="" coords="349,242,381,242,381,248,349,248"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="592,207,758,232"/>
<area shape="poly" title=" " alt="" coords="544,233,576,229,577,234,545,238"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="610,256,740,282"/>
<area shape="poly" title=" " alt="" coords="545,251,595,257,594,262,544,256"/>
<area shape="poly" title=" " alt="" coords="758,217,806,217,806,222,758,222"/>
<area shape="poly" title=" " alt="" coords="723,203,808,180,809,185,725,209"/>
<area shape="poly" title=" " alt="" coords="737,231,759,241,775,254,784,266,793,279,807,292,812,295,809,300,804,296,789,283,780,270,771,258,756,246,735,235"/>
<area shape="poly" title=" " alt="" coords="725,253,806,230,807,236,726,258"/>
<area shape="poly" title=" " alt="" coords="726,280,801,300,800,306,725,285"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="806,256,909,282"/>
<area shape="poly" title=" " alt="" coords="741,266,790,266,790,272,741,272"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_aa1c9a933f4601dae48cd64f911d297aa_icgraph.png" border="0" usemap="#acommands_8c_aa1c9a933f4601dae48cd64f911d297aa_icgraph" alt=""/></div>
<map name="acommands_8c_aa1c9a933f4601dae48cd64f911d297aa_icgraph" id="acommands_8c_aa1c9a933f4601dae48cd64f911d297aa_icgraph">
<area shape="rect" title=" " alt="" coords="296,31,437,56"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="280,35,248,30,249,25,281,29"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,31,55,56"/>
<area shape="poly" title=" " alt="" coords="281,46,55,46,55,41,281,41"/>
<area shape="poly" title=" " alt="" coords="88,36,55,42,54,37,87,31"/>
</map>
</div>

</div>
</div>
<a id="af32a8f10f2d022ca8b7816e6f4809a24" name="af32a8f10f2d022ca8b7816e6f4809a24"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af32a8f10f2d022ca8b7816e6f4809a24">&#9670;&#160;</a></span>yh_com_get_random()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int yh_com_get_random </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__context.html">yubihsm_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_argument.html">Argument</a> *</td>          <td class="paramname"><span class="paramname"><em>argv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a></td>          <td class="paramname"><span class="paramname"><em>fmt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="commands_8c_source.html#l00797">797</a> of file <a class="el" href="commands_8c_source.html">commands.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  797</span>                                                                            {</div>
<div class="line"><span class="lineno">  798</span> </div>
<div class="line"><span class="lineno">  799</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> response[<a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a>];</div>
<div class="line"><span class="lineno">  800</span>  <span class="keywordtype">size_t</span> response_len = <span class="keyword">sizeof</span>(response);</div>
<div class="line"><span class="lineno">  801</span> </div>
<div class="line"><span class="lineno">  802</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> =</div>
<div class="line"><span class="lineno">  803</span>    <a class="code hl_function" href="yubihsm_8c.html#af1bc8ed34687d83701eb3cc673ad4b96">yh_util_get_pseudo_random</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].w, response, &amp;response_len);</div>
<div class="line"><span class="lineno">  804</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno">  805</span>    fprintf(stderr, <span class="stringliteral">&quot;Failed to get pseudo random bytes: %s\n&quot;</span>,</div>
<div class="line"><span class="lineno">  806</span>            <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno">  807</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  808</span>  }</div>
<div class="line"><span class="lineno">  809</span> </div>
<div class="line"><span class="lineno">  810</span>  <span class="keywordflow">if</span> (response_len != <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].w) {</div>
<div class="line"><span class="lineno">  811</span>    fprintf(stderr, <span class="stringliteral">&quot;Wrong response length\n&quot;</span>);</div>
<div class="line"><span class="lineno">  812</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  813</span>  }</div>
<div class="line"><span class="lineno">  814</span> </div>
<div class="line"><span class="lineno">  815</span>  <a class="code hl_function" href="util_8c.html#ad969d220471d10a9f07080b50210f403">write_file</a>(response, response_len, ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>, fmt_to_fmt(fmt));</div>
<div class="line"><span class="lineno">  816</span> </div>
<div class="line"><span class="lineno">  817</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  818</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_af32a8f10f2d022ca8b7816e6f4809a24_cgraph.png" border="0" usemap="#acommands_8c_af32a8f10f2d022ca8b7816e6f4809a24_cgraph" alt=""/></div>
<map name="acommands_8c_af32a8f10f2d022ca8b7816e6f4809a24_cgraph" id="acommands_8c_af32a8f10f2d022ca8b7816e6f4809a24_cgraph">
<area shape="rect" title=" " alt="" coords="5,147,148,172"/>
<area shape="rect" href="util_8c.html#ad969d220471d10a9f07080b50210f403" title=" " alt="" coords="226,89,299,115"/>
<area shape="poly" title=" " alt="" coords="120,144,210,115,211,120,122,149"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="797,153,880,179"/>
<area shape="poly" title=" " alt="" coords="118,170,196,189,278,197,362,201,527,197,673,185,781,172,782,177,673,191,527,202,362,206,278,202,195,194,117,176"/>
<area shape="rect" href="yubihsm_8c.html#af1bc8ed34687d83701eb3cc673ad4b96" title=" " alt="" coords="196,139,329,180"/>
<area shape="poly" title=" " alt="" coords="148,157,180,157,180,162,148,162"/>
<area shape="poly" title=" " alt="" coords="329,158,781,163,781,168,329,163"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="377,103,525,128"/>
<area shape="poly" title=" " alt="" coords="329,141,378,130,379,135,330,147"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="573,53,739,79"/>
<area shape="poly" title=" " alt="" coords="507,99,584,81,585,86,508,105"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="591,103,721,128"/>
<area shape="poly" title=" " alt="" coords="525,113,576,113,576,118,525,118"/>
<area shape="poly" title=" " alt="" coords="718,77,740,88,756,101,765,114,774,127,788,140,793,143,790,148,785,144,770,130,761,117,752,105,737,92,716,82"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="803,55,874,80"/>
<area shape="poly" title=" " alt="" coords="739,64,787,64,787,70,739,69"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="804,5,872,31"/>
<area shape="poly" title=" " alt="" coords="707,50,788,28,790,34,709,55"/>
<area shape="poly" title=" " alt="" coords="706,126,782,148,781,153,704,132"/>
<area shape="poly" title=" " alt="" coords="707,99,787,78,788,83,709,105"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="787,104,890,130"/>
<area shape="poly" title=" " alt="" coords="722,113,771,114,771,119,722,119"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_af32a8f10f2d022ca8b7816e6f4809a24_icgraph.png" border="0" usemap="#acommands_8c_af32a8f10f2d022ca8b7816e6f4809a24_icgraph" alt=""/></div>
<map name="acommands_8c_af32a8f10f2d022ca8b7816e6f4809a24_icgraph" id="acommands_8c_af32a8f10f2d022ca8b7816e6f4809a24_icgraph">
<area shape="rect" title=" " alt="" coords="296,31,438,56"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="280,35,248,30,249,25,281,29"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,31,55,56"/>
<area shape="poly" title=" " alt="" coords="281,46,55,46,55,41,281,41"/>
<area shape="poly" title=" " alt="" coords="88,36,55,42,54,37,87,31"/>
</map>
</div>

</div>
</div>
<a id="a408c9e43b8ccb159acb178f2b20f3f77" name="a408c9e43b8ccb159acb178f2b20f3f77"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a408c9e43b8ccb159acb178f2b20f3f77">&#9670;&#160;</a></span>yh_com_get_storage()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int yh_com_get_storage </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__context.html">yubihsm_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_argument.html">Argument</a> *</td>          <td class="paramname"><span class="paramname"><em>argv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a></td>          <td class="paramname"><span class="paramname"><em>fmt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="commands_8c_source.html#l00823">823</a> of file <a class="el" href="commands_8c_source.html">commands.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  823</span>                                                                             {</div>
<div class="line"><span class="lineno">  824</span> </div>
<div class="line"><span class="lineno">  825</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ctx);</div>
<div class="line"><span class="lineno">  826</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(fmt);</div>
<div class="line"><span class="lineno">  827</span> </div>
<div class="line"><span class="lineno">  828</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno">  829</span>  <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> total_records, free_records, free_pages, total_pages, <a class="code hl_enumvalue" href="namespacesysio_1_1vm.html#a0ae6751a77293216df4656dee5081eb2a10108b6260714ad13914454c1dd1ec8f">page_size</a>;</div>
<div class="line"><span class="lineno">  830</span>  total_records = free_records = free_pages = total_pages = <a class="code hl_enumvalue" href="namespacesysio_1_1vm.html#a0ae6751a77293216df4656dee5081eb2a10108b6260714ad13914454c1dd1ec8f">page_size</a> = 0;</div>
<div class="line"><span class="lineno">  831</span> </div>
<div class="line"><span class="lineno">  832</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#ae87d5578703775b9d4151a14435f4a73">yh_util_get_storage_info</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e, &amp;total_records, &amp;free_records,</div>
<div class="line"><span class="lineno">  833</span>                                 &amp;total_pages, &amp;free_pages, &amp;page_size);</div>
<div class="line"><span class="lineno">  834</span> </div>
<div class="line"><span class="lineno">  835</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno">  836</span>    fprintf(stderr, <span class="stringliteral">&quot;Failed to get storage stats: %s\n&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno">  837</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  838</span>  }</div>
<div class="line"><span class="lineno">  839</span>  fprintf(stderr,</div>
<div class="line"><span class="lineno">  840</span>          <span class="stringliteral">&quot;free records: %d/%d, free pages: %d/%d page size: %d bytes\n&quot;</span>,</div>
<div class="line"><span class="lineno">  841</span>          free_records, total_records, free_pages, total_pages, page_size);</div>
<div class="line"><span class="lineno">  842</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  843</span>}</div>
<div class="ttc" id="anamespacesysio_1_1vm_html_a0ae6751a77293216df4656dee5081eb2a10108b6260714ad13914454c1dd1ec8f"><div class="ttname"><a href="namespacesysio_1_1vm.html#a0ae6751a77293216df4656dee5081eb2a10108b6260714ad13914454c1dd1ec8f">sysio::vm::page_size</a></div><div class="ttdeci">@ page_size</div><div class="ttdef"><b>Definition</b> <a href="sys-vm_2include_2sysio_2sysio_2vm_2constants_8hpp_source.html#l00017">constants.hpp:17</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_ae87d5578703775b9d4151a14435f4a73"><div class="ttname"><a href="yubihsm_8c.html#ae87d5578703775b9d4151a14435f4a73">yh_util_get_storage_info</a></div><div class="ttdeci">yh_rc yh_util_get_storage_info(yh_session *session, uint16_t *total_records, uint16_t *free_records, uint16_t *total_pages, uint16_t *free_pages, uint16_t *page_size)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l03610">yubihsm.c:3610</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_a408c9e43b8ccb159acb178f2b20f3f77_cgraph.png" border="0" usemap="#acommands_8c_a408c9e43b8ccb159acb178f2b20f3f77_cgraph" alt=""/></div>
<map name="acommands_8c_a408c9e43b8ccb159acb178f2b20f3f77_cgraph" id="acommands_8c_a408c9e43b8ccb159acb178f2b20f3f77_cgraph">
<area shape="rect" title=" " alt="" coords="5,179,148,204"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="826,153,909,179"/>
<area shape="poly" title=" " alt="" coords="148,190,358,189,563,181,768,169,810,167,810,172,768,174,563,186,358,194,148,195"/>
<area shape="rect" href="yubihsm_8c.html#ae87d5578703775b9d4151a14435f4a73" title=" " alt="" coords="196,153,358,179"/>
<area shape="poly" title=" " alt="" coords="148,180,180,176,180,181,148,185"/>
<area shape="poly" title=" " alt="" coords="358,164,810,164,810,169,358,169"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="406,103,554,128"/>
<area shape="poly" title=" " alt="" coords="331,150,410,130,412,135,332,155"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="602,53,768,79"/>
<area shape="poly" title=" " alt="" coords="536,99,613,81,614,86,537,105"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="620,103,750,128"/>
<area shape="poly" title=" " alt="" coords="554,113,605,113,605,118,554,118"/>
<area shape="poly" title=" " alt="" coords="747,77,769,88,785,101,794,114,803,127,817,140,822,143,819,148,814,144,799,130,790,117,781,105,766,92,745,82"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="832,55,903,80"/>
<area shape="poly" title=" " alt="" coords="768,64,816,64,816,70,768,69"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="833,5,902,31"/>
<area shape="poly" title=" " alt="" coords="736,50,817,28,819,34,738,55"/>
<area shape="poly" title=" " alt="" coords="735,126,811,148,810,153,733,132"/>
<area shape="poly" title=" " alt="" coords="736,99,816,78,817,83,738,105"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="816,104,919,130"/>
<area shape="poly" title=" " alt="" coords="751,113,800,114,800,119,751,119"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_a408c9e43b8ccb159acb178f2b20f3f77_icgraph.png" border="0" usemap="#acommands_8c_a408c9e43b8ccb159acb178f2b20f3f77_icgraph" alt=""/></div>
<map name="acommands_8c_a408c9e43b8ccb159acb178f2b20f3f77_icgraph" id="acommands_8c_a408c9e43b8ccb159acb178f2b20f3f77_icgraph">
<area shape="rect" title=" " alt="" coords="296,31,438,56"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="280,35,248,30,249,25,281,29"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,31,55,56"/>
<area shape="poly" title=" " alt="" coords="281,46,55,46,55,41,281,41"/>
<area shape="poly" title=" " alt="" coords="88,36,55,42,54,37,87,31"/>
</map>
</div>

</div>
</div>
<a id="ac8e5bb8ba179bc997ddc73e03423782d" name="ac8e5bb8ba179bc997ddc73e03423782d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8e5bb8ba179bc997ddc73e03423782d">&#9670;&#160;</a></span>yh_com_get_template()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int yh_com_get_template </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__context.html">yubihsm_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_argument.html">Argument</a> *</td>          <td class="paramname"><span class="paramname"><em>argv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a></td>          <td class="paramname"><span class="paramname"><em>fmt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="commands_8c_source.html#l01031">1031</a> of file <a class="el" href="commands_8c_source.html">commands.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1031</span>                                                                              {</div>
<div class="line"><span class="lineno"> 1032</span> </div>
<div class="line"><span class="lineno"> 1033</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> response[<a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a>];</div>
<div class="line"><span class="lineno"> 1034</span>  <span class="keywordtype">size_t</span> response_len = <span class="keyword">sizeof</span>(response);</div>
<div class="line"><span class="lineno"> 1035</span> </div>
<div class="line"><span class="lineno"> 1036</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> =</div>
<div class="line"><span class="lineno"> 1037</span>    <a class="code hl_function" href="yubihsm_8c.html#a47768ae0e72beba49f02db1baddf4823">yh_util_get_template</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].w, response, &amp;response_len);</div>
<div class="line"><span class="lineno"> 1038</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 1039</span>    fprintf(stderr, <span class="stringliteral">&quot;Failed to get template object: %s\n&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 1040</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 1041</span>  }</div>
<div class="line"><span class="lineno"> 1042</span> </div>
<div class="line"><span class="lineno"> 1043</span>  <a class="code hl_function" href="util_8c.html#ad969d220471d10a9f07080b50210f403">write_file</a>(response, response_len, ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>, fmt_to_fmt(fmt));</div>
<div class="line"><span class="lineno"> 1044</span> </div>
<div class="line"><span class="lineno"> 1045</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1046</span>}</div>
<div class="ttc" id="ayubihsm_8c_html_a47768ae0e72beba49f02db1baddf4823"><div class="ttname"><a href="yubihsm_8c.html#a47768ae0e72beba49f02db1baddf4823">yh_util_get_template</a></div><div class="ttdeci">yh_rc yh_util_get_template(yh_session *session, uint16_t object_id, uint8_t *out, size_t *out_len)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l02805">yubihsm.c:2805</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_ac8e5bb8ba179bc997ddc73e03423782d_cgraph.png" border="0" usemap="#acommands_8c_ac8e5bb8ba179bc997ddc73e03423782d_cgraph" alt=""/></div>
<map name="acommands_8c_ac8e5bb8ba179bc997ddc73e03423782d_cgraph" id="acommands_8c_ac8e5bb8ba179bc997ddc73e03423782d_cgraph">
<area shape="rect" title=" " alt="" coords="5,56,155,82"/>
<area shape="rect" href="util_8c.html#ad969d220471d10a9f07080b50210f403" title=" " alt="" coords="237,5,310,31"/>
<area shape="poly" title=" " alt="" coords="131,53,221,29,222,34,133,58"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="812,108,895,134"/>
<area shape="poly" title=" " alt="" coords="155,70,419,84,754,108,796,112,796,117,753,113,419,89,155,75"/>
<area shape="rect" href="yubihsm_8c.html#a47768ae0e72beba49f02db1baddf4823" title=" " alt="" coords="203,132,344,158"/>
<area shape="poly" title=" " alt="" coords="116,80,226,124,224,129,114,85"/>
<area shape="poly" title=" " alt="" coords="344,139,796,120,796,126,344,145"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="818,207,889,232"/>
<area shape="poly" title=" " alt="" coords="303,156,393,193,491,225,571,245,651,250,753,242,803,232,804,237,754,247,651,256,570,250,490,231,391,198,301,161"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="392,157,540,183"/>
<area shape="poly" title=" " alt="" coords="345,151,377,156,376,161,344,157"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="588,157,754,183"/>
<area shape="poly" title=" " alt="" coords="540,168,573,168,573,173,540,173"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="606,207,736,232"/>
<area shape="poly" title=" " alt="" coords="523,181,600,200,599,205,522,186"/>
<area shape="poly" title=" " alt="" coords="721,154,796,133,797,139,722,159"/>
<area shape="poly" title=" " alt="" coords="722,181,803,203,802,209,721,186"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="819,157,888,183"/>
<area shape="poly" title=" " alt="" coords="754,168,804,168,804,173,754,173"/>
<area shape="poly" title=" " alt="" coords="731,204,752,193,767,181,776,169,785,156,800,143,805,139,808,144,803,147,789,160,780,173,771,185,755,198,733,208"/>
<area shape="poly" title=" " alt="" coords="737,217,803,217,803,222,737,222"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="802,256,905,282"/>
<area shape="poly" title=" " alt="" coords="722,230,789,249,787,254,721,236"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_ac8e5bb8ba179bc997ddc73e03423782d_icgraph.png" border="0" usemap="#acommands_8c_ac8e5bb8ba179bc997ddc73e03423782d_icgraph" alt=""/></div>
<map name="acommands_8c_ac8e5bb8ba179bc997ddc73e03423782d_icgraph" id="acommands_8c_ac8e5bb8ba179bc997ddc73e03423782d_icgraph">
<area shape="rect" title=" " alt="" coords="296,31,445,56"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="280,34,248,30,249,25,281,29"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,31,55,56"/>
<area shape="poly" title=" " alt="" coords="280,46,55,46,55,41,280,41"/>
<area shape="poly" title=" " alt="" coords="88,36,55,42,54,37,87,31"/>
</map>
</div>

</div>
</div>
<a id="ac221d587381b78c747d8290320ee4c0a" name="ac221d587381b78c747d8290320ee4c0a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac221d587381b78c747d8290320ee4c0a">&#9670;&#160;</a></span>yh_com_get_wrapped()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int yh_com_get_wrapped </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__context.html">yubihsm_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_argument.html">Argument</a> *</td>          <td class="paramname"><span class="paramname"><em>argv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a></td>          <td class="paramname"><span class="paramname"><em>fmt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="commands_8c_source.html#l01007">1007</a> of file <a class="el" href="commands_8c_source.html">commands.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1007</span>                                                                             {</div>
<div class="line"><span class="lineno"> 1008</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> response[<a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a>];</div>
<div class="line"><span class="lineno"> 1009</span>  <span class="keywordtype">size_t</span> response_len = <span class="keyword">sizeof</span>(response);</div>
<div class="line"><span class="lineno"> 1010</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 1011</span> </div>
<div class="line"><span class="lineno"> 1012</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#aa3f473e6dbb9188ad0269b40921c4f5f">yh_util_export_wrapped</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].w, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[2].b, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[3].w,</div>
<div class="line"><span class="lineno"> 1013</span>                               response, &amp;response_len);</div>
<div class="line"><span class="lineno"> 1014</span> </div>
<div class="line"><span class="lineno"> 1015</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 1016</span>    fprintf(stderr, <span class="stringliteral">&quot;Failed to get wrapped object: %s\n&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 1017</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 1018</span>  }</div>
<div class="line"><span class="lineno"> 1019</span> </div>
<div class="line"><span class="lineno"> 1020</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="util_8c.html#ad969d220471d10a9f07080b50210f403">write_file</a>(response, response_len, ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>, fmt_to_fmt(fmt))) {</div>
<div class="line"><span class="lineno"> 1021</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1022</span>  }</div>
<div class="line"><span class="lineno"> 1023</span> </div>
<div class="line"><span class="lineno"> 1024</span>  <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 1025</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_ac221d587381b78c747d8290320ee4c0a_cgraph.png" border="0" usemap="#acommands_8c_ac221d587381b78c747d8290320ee4c0a_cgraph" alt=""/></div>
<map name="acommands_8c_ac221d587381b78c747d8290320ee4c0a_cgraph" id="acommands_8c_ac221d587381b78c747d8290320ee4c0a_cgraph">
<area shape="rect" title=" " alt="" coords="5,153,154,179"/>
<area shape="rect" href="util_8c.html#ad969d220471d10a9f07080b50210f403" title=" " alt="" coords="244,104,318,130"/>
<area shape="poly" title=" " alt="" coords="134,150,229,127,230,132,136,155"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="828,153,911,179"/>
<area shape="poly" title=" " alt="" coords="134,177,202,189,288,195,376,198,548,194,700,183,812,171,812,176,700,188,549,199,376,203,288,201,201,194,133,182"/>
<area shape="rect" href="yubihsm_8c.html#aa3f473e6dbb9188ad0269b40921c4f5f" title=" " alt="" coords="202,153,360,179"/>
<area shape="poly" title=" " alt="" coords="154,164,186,164,186,169,154,169"/>
<area shape="poly" title=" " alt="" coords="361,164,812,164,812,169,361,169"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="408,103,556,128"/>
<area shape="poly" title=" " alt="" coords="334,150,413,130,414,135,336,155"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="604,53,770,79"/>
<area shape="poly" title=" " alt="" coords="538,99,615,81,616,86,539,105"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="622,103,752,128"/>
<area shape="poly" title=" " alt="" coords="556,113,607,113,607,118,556,118"/>
<area shape="poly" title=" " alt="" coords="749,77,771,88,787,101,796,114,805,127,819,140,824,143,821,148,816,144,801,130,792,117,783,105,768,92,747,82"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="834,55,905,80"/>
<area shape="poly" title=" " alt="" coords="770,64,818,64,818,70,770,69"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="835,5,904,31"/>
<area shape="poly" title=" " alt="" coords="738,50,819,28,821,34,740,55"/>
<area shape="poly" title=" " alt="" coords="737,126,813,148,812,153,735,132"/>
<area shape="poly" title=" " alt="" coords="738,99,818,78,819,83,740,105"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="818,104,921,130"/>
<area shape="poly" title=" " alt="" coords="753,113,802,114,802,119,753,119"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_ac221d587381b78c747d8290320ee4c0a_icgraph.png" border="0" usemap="#acommands_8c_ac221d587381b78c747d8290320ee4c0a_icgraph" alt=""/></div>
<map name="acommands_8c_ac221d587381b78c747d8290320ee4c0a_icgraph" id="acommands_8c_ac221d587381b78c747d8290320ee4c0a_icgraph">
<area shape="rect" title=" " alt="" coords="296,31,444,56"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="280,35,248,30,249,25,281,29"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,31,55,56"/>
<area shape="poly" title=" " alt="" coords="280,46,55,46,55,41,280,41"/>
<area shape="poly" title=" " alt="" coords="88,36,55,42,54,37,87,31"/>
</map>
</div>

</div>
</div>
<a id="a8de2999193b4caa2d0d1fd2e8451dba1" name="a8de2999193b4caa2d0d1fd2e8451dba1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8de2999193b4caa2d0d1fd2e8451dba1">&#9670;&#160;</a></span>yh_com_hmac()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int yh_com_hmac </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__context.html">yubihsm_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_argument.html">Argument</a> *</td>          <td class="paramname"><span class="paramname"><em>argv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a></td>          <td class="paramname"><span class="paramname"><em>fmt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="commands_8c_source.html#l01929">1929</a> of file <a class="el" href="commands_8c_source.html">commands.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1929</span>                                                                      {</div>
<div class="line"><span class="lineno"> 1930</span> </div>
<div class="line"><span class="lineno"> 1931</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ctx);</div>
<div class="line"><span class="lineno"> 1932</span> </div>
<div class="line"><span class="lineno"> 1933</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 1934</span> </div>
<div class="line"><span class="lineno"> 1935</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> response[<a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a>];</div>
<div class="line"><span class="lineno"> 1936</span>  <span class="keywordtype">size_t</span> response_len = <span class="keyword">sizeof</span>(response);</div>
<div class="line"><span class="lineno"> 1937</span> </div>
<div class="line"><span class="lineno"> 1938</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#a9000d43fe8cf7313b319f316521eb0c4">yh_util_sign_hmac</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].w, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[2].x, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[2].<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>,</div>
<div class="line"><span class="lineno"> 1939</span>                          response, &amp;response_len);</div>
<div class="line"><span class="lineno"> 1940</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 1941</span>    fprintf(stderr, <span class="stringliteral">&quot;Failed to HMAC data: %s\n&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 1942</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 1943</span>  }</div>
<div class="line"><span class="lineno"> 1944</span> </div>
<div class="line"><span class="lineno"> 1945</span>  <a class="code hl_function" href="util_8c.html#ad969d220471d10a9f07080b50210f403">write_file</a>(response, response_len, ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>, fmt_to_fmt(fmt));</div>
<div class="line"><span class="lineno"> 1946</span> </div>
<div class="line"><span class="lineno"> 1947</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1948</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_a8de2999193b4caa2d0d1fd2e8451dba1_cgraph.png" border="0" usemap="#acommands_8c_a8de2999193b4caa2d0d1fd2e8451dba1_cgraph" alt=""/></div>
<map name="acommands_8c_a8de2999193b4caa2d0d1fd2e8451dba1_cgraph" id="acommands_8c_a8de2999193b4caa2d0d1fd2e8451dba1_cgraph">
<area shape="rect" title=" " alt="" coords="5,56,112,82"/>
<area shape="rect" href="util_8c.html#ad969d220471d10a9f07080b50210f403" title=" " alt="" coords="188,5,261,31"/>
<area shape="poly" title=" " alt="" coords="102,53,172,31,174,36,104,58"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="757,108,840,134"/>
<area shape="poly" title=" " alt="" coords="112,69,365,83,699,108,741,112,741,117,698,113,365,89,112,74"/>
<area shape="rect" href="yubihsm_8c.html#a9000d43fe8cf7313b319f316521eb0c4" title=" " alt="" coords="160,132,289,158"/>
<area shape="poly" title=" " alt="" coords="90,80,182,123,180,128,88,85"/>
<area shape="poly" title=" " alt="" coords="289,139,741,120,742,126,290,145"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="763,207,834,232"/>
<area shape="poly" title=" " alt="" coords="253,156,338,193,436,226,515,245,596,251,698,242,748,232,749,237,699,247,596,256,514,251,435,231,336,198,251,161"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="337,157,485,183"/>
<area shape="poly" title=" " alt="" coords="290,151,322,155,321,161,289,156"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="533,157,699,183"/>
<area shape="poly" title=" " alt="" coords="485,168,518,168,518,173,485,173"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="551,207,681,232"/>
<area shape="poly" title=" " alt="" coords="468,181,545,200,544,205,467,186"/>
<area shape="poly" title=" " alt="" coords="666,154,741,133,742,139,667,159"/>
<area shape="poly" title=" " alt="" coords="667,181,748,203,747,209,666,186"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="764,157,832,183"/>
<area shape="poly" title=" " alt="" coords="699,168,749,168,749,173,699,173"/>
<area shape="poly" title=" " alt="" coords="676,204,697,193,712,181,721,169,730,156,745,143,750,139,753,144,748,147,734,160,725,173,716,185,700,198,678,208"/>
<area shape="poly" title=" " alt="" coords="682,217,748,217,748,222,682,222"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="747,256,850,282"/>
<area shape="poly" title=" " alt="" coords="667,230,734,249,732,254,666,236"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_a8de2999193b4caa2d0d1fd2e8451dba1_icgraph.png" border="0" usemap="#acommands_8c_a8de2999193b4caa2d0d1fd2e8451dba1_icgraph" alt=""/></div>
<map name="acommands_8c_a8de2999193b4caa2d0d1fd2e8451dba1_icgraph" id="acommands_8c_a8de2999193b4caa2d0d1fd2e8451dba1_icgraph">
<area shape="rect" title=" " alt="" coords="296,5,402,31"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="280,21,248,21,248,16,280,16"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,55,31"/>
<area shape="poly" title=" " alt="" coords="87,21,55,21,55,16,87,16"/>
</map>
</div>

</div>
</div>
<a id="ac981267ad1d570af845289dfb0733b8b" name="ac981267ad1d570af845289dfb0733b8b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac981267ad1d570af845289dfb0733b8b">&#9670;&#160;</a></span>yh_com_list_algorithms()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int yh_com_list_algorithms </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__context.html">yubihsm_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_argument.html">Argument</a> *</td>          <td class="paramname"><span class="paramname"><em>argv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a></td>          <td class="paramname"><span class="paramname"><em>fmt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="commands_8c_source.html#l01079">1079</a> of file <a class="el" href="commands_8c_source.html">commands.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1080</span>                                           {</div>
<div class="line"><span class="lineno"> 1081</span> </div>
<div class="line"><span class="lineno"> 1082</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ctx);</div>
<div class="line"><span class="lineno"> 1083</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>);</div>
<div class="line"><span class="lineno"> 1084</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(fmt);</div>
<div class="line"><span class="lineno"> 1085</span> </div>
<div class="line"><span class="lineno"> 1086</span>  <span class="keywordflow">for</span> (<a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> i = 0; i &lt; <span class="keyword">sizeof</span>(yh_algorithms) / <span class="keyword">sizeof</span>(yh_algorithms[0]);</div>
<div class="line"><span class="lineno"> 1087</span>       i++) {</div>
<div class="line"><span class="lineno"> 1088</span>    fprintf(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>, <span class="stringliteral">&quot;%s\n&quot;</span>, yh_algorithms[i].name);</div>
<div class="line"><span class="lineno"> 1089</span>  }</div>
<div class="line"><span class="lineno"> 1090</span> </div>
<div class="line"><span class="lineno"> 1091</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1092</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_ac981267ad1d570af845289dfb0733b8b_icgraph.png" border="0" usemap="#acommands_8c_ac981267ad1d570af845289dfb0733b8b_icgraph" alt=""/></div>
<map name="acommands_8c_ac981267ad1d570af845289dfb0733b8b_icgraph" id="acommands_8c_ac981267ad1d570af845289dfb0733b8b_icgraph">
<area shape="rect" title=" " alt="" coords="296,5,454,31"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="280,21,248,21,248,16,280,16"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,55,31"/>
<area shape="poly" title=" " alt="" coords="87,21,55,21,55,16,87,16"/>
</map>
</div>

</div>
</div>
<a id="ab7355f80935fb819c440a21d56f181e4" name="ab7355f80935fb819c440a21d56f181e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab7355f80935fb819c440a21d56f181e4">&#9670;&#160;</a></span>yh_com_list_capabilities()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int yh_com_list_capabilities </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__context.html">yubihsm_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_argument.html">Argument</a> *</td>          <td class="paramname"><span class="paramname"><em>argv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a></td>          <td class="paramname"><span class="paramname"><em>fmt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="commands_8c_source.html#l01061">1061</a> of file <a class="el" href="commands_8c_source.html">commands.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1062</span>                                             {</div>
<div class="line"><span class="lineno"> 1063</span> </div>
<div class="line"><span class="lineno"> 1064</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ctx);</div>
<div class="line"><span class="lineno"> 1065</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>);</div>
<div class="line"><span class="lineno"> 1066</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(fmt);</div>
<div class="line"><span class="lineno"> 1067</span> </div>
<div class="line"><span class="lineno"> 1068</span>  <span class="keywordflow">for</span> (<a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> i = 0; i &lt; <span class="keyword">sizeof</span>(yh_capability) / <span class="keyword">sizeof</span>(yh_capability[0]);</div>
<div class="line"><span class="lineno"> 1069</span>       i++) {</div>
<div class="line"><span class="lineno"> 1070</span>    fprintf(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>, <span class="stringliteral">&quot;%-30s (%016llx)\n&quot;</span>, yh_capability[i].name,</div>
<div class="line"><span class="lineno"> 1071</span>            1ULL &lt;&lt; yh_capability[i].bit);</div>
<div class="line"><span class="lineno"> 1072</span>  }</div>
<div class="line"><span class="lineno"> 1073</span> </div>
<div class="line"><span class="lineno"> 1074</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1075</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_ab7355f80935fb819c440a21d56f181e4_icgraph.png" border="0" usemap="#acommands_8c_ab7355f80935fb819c440a21d56f181e4_icgraph" alt=""/></div>
<map name="acommands_8c_ab7355f80935fb819c440a21d56f181e4_icgraph" id="acommands_8c_ab7355f80935fb819c440a21d56f181e4_icgraph">
<area shape="rect" title=" " alt="" coords="296,5,459,31"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="281,21,249,21,249,16,281,16"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,55,31"/>
<area shape="poly" title=" " alt="" coords="87,21,55,21,55,16,87,16"/>
</map>
</div>

</div>
</div>
<a id="a2b752129687a9ca758661e0b6625b59c" name="a2b752129687a9ca758661e0b6625b59c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b752129687a9ca758661e0b6625b59c">&#9670;&#160;</a></span>yh_com_list_objects()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int yh_com_list_objects </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__context.html">yubihsm_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_argument.html">Argument</a> *</td>          <td class="paramname"><span class="paramname"><em>argv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a></td>          <td class="paramname"><span class="paramname"><em>fmt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="commands_8c_source.html#l01146">1146</a> of file <a class="el" href="commands_8c_source.html">commands.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1146</span>                                                                              {</div>
<div class="line"><span class="lineno"> 1147</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 1148</span>  <a class="code hl_struct" href="structyh__object__descriptor.html">yh_object_descriptor</a> objects[<a class="code hl_define" href="yubihsm_8h.html#a331b70d37ded99854638ff5ef0ca9735">YH_MAX_ITEMS_COUNT</a>];</div>
<div class="line"><span class="lineno"> 1149</span>  <span class="keywordtype">size_t</span> num_objects = <a class="code hl_define" href="yubihsm_8h.html#a331b70d37ded99854638ff5ef0ca9735">YH_MAX_ITEMS_COUNT</a>;</div>
<div class="line"><span class="lineno"> 1150</span>  <span class="keyword">const</span> <span class="keywordtype">char</span> *label_arg;</div>
<div class="line"><span class="lineno"> 1151</span> </div>
<div class="line"><span class="lineno"> 1152</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ctx);</div>
<div class="line"><span class="lineno"> 1153</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(fmt);</div>
<div class="line"><span class="lineno"> 1154</span> </div>
<div class="line"><span class="lineno"> 1155</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[6].<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> == 0) {</div>
<div class="line"><span class="lineno"> 1156</span>    label_arg = NULL;</div>
<div class="line"><span class="lineno"> 1157</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1158</span>    label_arg = <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[6].s;</div>
<div class="line"><span class="lineno"> 1159</span>  }</div>
<div class="line"><span class="lineno"> 1160</span> </div>
<div class="line"><span class="lineno"> 1161</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> =</div>
<div class="line"><span class="lineno"> 1162</span>    <a class="code hl_function" href="yubihsm_8c.html#a7cbea7103efff8473ccfaaa35bfc6346">yh_util_list_objects</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].w, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[2].b, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[3].w, &amp;<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[4].c,</div>
<div class="line"><span class="lineno"> 1163</span>                         <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[5].<a class="code hl_variable" href="pointer_8h.html#aeeddce917cf130d62c370b8f216026dd">a</a>, label_arg, objects, &amp;num_objects);</div>
<div class="line"><span class="lineno"> 1164</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 1165</span>    fprintf(stderr, <span class="stringliteral">&quot;Failed to list objects: %s\n&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 1166</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 1167</span>  }</div>
<div class="line"><span class="lineno"> 1168</span> </div>
<div class="line"><span class="lineno"> 1169</span>  qsort(objects, num_objects, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structyh__object__descriptor.html">yh_object_descriptor</a>), compare_objects);</div>
<div class="line"><span class="lineno"> 1170</span> </div>
<div class="line"><span class="lineno"> 1171</span>  fprintf(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>, <span class="stringliteral">&quot;Found %zu object(s)\n&quot;</span>, num_objects);</div>
<div class="line"><span class="lineno"> 1172</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; num_objects; i++) {</div>
<div class="line"><span class="lineno"> 1173</span>    <span class="keyword">const</span> <span class="keywordtype">char</span> *type = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><span class="lineno"> 1174</span>    <a class="code hl_function" href="yubihsm_8c.html#afe3d701f7470c1d7b05480e4b6728bf7">yh_type_to_string</a>(objects[i].type, &amp;type);</div>
<div class="line"><span class="lineno"> 1175</span>    fprintf(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>, <span class="stringliteral">&quot;id: 0x%04x, type: %s, sequence: %hhu\n&quot;</span>, objects[i].id,</div>
<div class="line"><span class="lineno"> 1176</span>            type, objects[i].sequence);</div>
<div class="line"><span class="lineno"> 1177</span>  }</div>
<div class="line"><span class="lineno"> 1178</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1179</span>}</div>
<div class="ttc" id="ayubihsm_8c_html_a7cbea7103efff8473ccfaaa35bfc6346"><div class="ttname"><a href="yubihsm_8c.html#a7cbea7103efff8473ccfaaa35bfc6346">yh_util_list_objects</a></div><div class="ttdeci">yh_rc yh_util_list_objects(yh_session *session, uint16_t id, yh_object_type type, uint16_t domains, const yh_capabilities *capabilities, yh_algorithm algorithm, const char *label, yh_object_descriptor *objects, size_t *n_objects)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l01030">yubihsm.c:1030</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a331b70d37ded99854638ff5ef0ca9735"><div class="ttname"><a href="yubihsm_8h.html#a331b70d37ded99854638ff5ef0ca9735">YH_MAX_ITEMS_COUNT</a></div><div class="ttdeci">#define YH_MAX_ITEMS_COUNT</div><div class="ttdoc">Max items the device may hold.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00103">yubihsm.h:103</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_a2b752129687a9ca758661e0b6625b59c_cgraph.png" border="0" usemap="#acommands_8c_a2b752129687a9ca758661e0b6625b59c_cgraph" alt=""/></div>
<map name="acommands_8c_a2b752129687a9ca758661e0b6625b59c_cgraph" id="acommands_8c_a2b752129687a9ca758661e0b6625b59c_cgraph">
<area shape="rect" title=" " alt="" coords="5,28,146,54"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="794,79,877,105"/>
<area shape="poly" title=" " alt="" coords="146,26,260,12,409,3,490,4,574,10,656,22,737,41,800,69,798,74,735,46,655,27,573,15,490,9,409,8,261,17,146,31"/>
<area shape="rect" href="yubihsm_8c.html#afe3d701f7470c1d7b05480e4b6728bf7" title=" " alt="" coords="386,28,510,54"/>
<area shape="poly" title=" " alt="" coords="146,38,370,38,370,44,146,44"/>
<area shape="rect" href="yubihsm_8c.html#a7cbea7103efff8473ccfaaa35bfc6346" title=" " alt="" coords="194,154,326,179"/>
<area shape="poly" title=" " alt="" coords="98,52,228,142,225,147,95,57"/>
<area shape="poly" title=" " alt="" coords="511,44,736,70,779,78,778,83,735,76,510,49"/>
<area shape="poly" title=" " alt="" coords="316,150,374,138,486,122,597,109,778,93,778,98,598,114,486,127,374,144,317,156"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="800,179,871,205"/>
<area shape="poly" title=" " alt="" coords="314,177,395,195,500,211,617,220,677,219,735,214,785,204,786,210,736,220,677,225,617,225,499,216,394,200,313,183"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="801,254,870,279"/>
<area shape="poly" title=" " alt="" coords="284,177,325,199,375,219,488,243,603,257,706,263,786,265,786,270,706,268,602,262,487,248,373,224,323,204,281,182"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="374,154,522,179"/>
<area shape="poly" title=" " alt="" coords="327,164,359,164,359,169,327,169"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="570,179,736,205"/>
<area shape="poly" title=" " alt="" coords="523,173,555,177,554,182,522,178"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="588,130,718,155"/>
<area shape="poly" title=" " alt="" coords="522,155,572,149,573,154,523,160"/>
<area shape="poly" title=" " alt="" coords="713,176,734,165,749,154,758,142,767,129,782,115,789,110,792,115,785,119,771,132,762,145,753,157,737,170,715,181"/>
<area shape="poly" title=" " alt="" coords="736,189,784,189,784,194,736,194"/>
<area shape="poly" title=" " alt="" coords="687,203,789,245,787,250,685,208"/>
<area shape="poly" title=" " alt="" coords="701,126,778,105,779,110,703,132"/>
<area shape="poly" title=" " alt="" coords="704,153,785,176,784,181,703,158"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="784,130,887,155"/>
<area shape="poly" title=" " alt="" coords="719,140,768,140,768,145,719,145"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_a2b752129687a9ca758661e0b6625b59c_icgraph.png" border="0" usemap="#acommands_8c_a2b752129687a9ca758661e0b6625b59c_icgraph" alt=""/></div>
<map name="acommands_8c_a2b752129687a9ca758661e0b6625b59c_icgraph" id="acommands_8c_a2b752129687a9ca758661e0b6625b59c_icgraph">
<area shape="rect" title=" " alt="" coords="296,31,436,56"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="280,35,248,30,249,25,281,30"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,31,55,56"/>
<area shape="poly" title=" " alt="" coords="281,46,55,46,55,41,281,41"/>
<area shape="poly" title=" " alt="" coords="88,36,55,42,54,37,87,31"/>
</map>
</div>

</div>
</div>
<a id="ab98950b39a19499a22ec6b2e874525a5" name="ab98950b39a19499a22ec6b2e874525a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab98950b39a19499a22ec6b2e874525a5">&#9670;&#160;</a></span>yh_com_list_sessions()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int yh_com_list_sessions </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__context.html">yubihsm_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_argument.html">Argument</a> *</td>          <td class="paramname"><span class="paramname"><em>argv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a></td>          <td class="paramname"><span class="paramname"><em>fmt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="commands_8c_source.html#l01111">1111</a> of file <a class="el" href="commands_8c_source.html">commands.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1111</span>                                                                               {</div>
<div class="line"><span class="lineno"> 1112</span> </div>
<div class="line"><span class="lineno"> 1113</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>);</div>
<div class="line"><span class="lineno"> 1114</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(fmt);</div>
<div class="line"><span class="lineno"> 1115</span> </div>
<div class="line"><span class="lineno"> 1116</span>  <span class="keywordflow">if</span> (ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a8c52c1a89cd4334a0225a1fbfba9a930">connector</a> == NULL) {</div>
<div class="line"><span class="lineno"> 1117</span>    fprintf(stderr, <span class="stringliteral">&quot;Not connected\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1118</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 1119</span>  }</div>
<div class="line"><span class="lineno"> 1120</span> </div>
<div class="line"><span class="lineno"> 1121</span>  <span class="keywordflow">for</span> (<a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> i = 0; i &lt; <a class="code hl_define" href="yubihsm_8h.html#add4e5963a36bd6c9b06c717d705f4c2f">YH_MAX_SESSIONS</a>; i++) {</div>
<div class="line"><span class="lineno"> 1122</span>    <span class="keywordflow">if</span> (ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a7a959752fa285fb4a7a75921bbfa00fe">sessions</a>[i] != NULL) {</div>
<div class="line"><span class="lineno"> 1123</span>      fprintf(stderr, <span class="stringliteral">&quot;Session %d\n&quot;</span>, i);</div>
<div class="line"><span class="lineno"> 1124</span>    }</div>
<div class="line"><span class="lineno"> 1125</span>  }</div>
<div class="line"><span class="lineno"> 1126</span> </div>
<div class="line"><span class="lineno"> 1127</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1128</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_ab98950b39a19499a22ec6b2e874525a5_icgraph.png" border="0" usemap="#acommands_8c_ab98950b39a19499a22ec6b2e874525a5_icgraph" alt=""/></div>
<map name="acommands_8c_ab98950b39a19499a22ec6b2e874525a5_icgraph" id="acommands_8c_ab98950b39a19499a22ec6b2e874525a5_icgraph">
<area shape="rect" title=" " alt="" coords="296,5,446,31"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="281,21,248,21,248,16,281,16"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,55,31"/>
<area shape="poly" title=" " alt="" coords="87,21,55,21,55,16,87,16"/>
</map>
</div>

</div>
</div>
<a id="a65ff18ca1fb6f1b4da386071e1c1a505" name="a65ff18ca1fb6f1b4da386071e1c1a505"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65ff18ca1fb6f1b4da386071e1c1a505">&#9670;&#160;</a></span>yh_com_list_types()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int yh_com_list_types </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__context.html">yubihsm_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_argument.html">Argument</a> *</td>          <td class="paramname"><span class="paramname"><em>argv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a></td>          <td class="paramname"><span class="paramname"><em>fmt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="commands_8c_source.html#l01096">1096</a> of file <a class="el" href="commands_8c_source.html">commands.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1096</span>                                                                            {</div>
<div class="line"><span class="lineno"> 1097</span> </div>
<div class="line"><span class="lineno"> 1098</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ctx);</div>
<div class="line"><span class="lineno"> 1099</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>);</div>
<div class="line"><span class="lineno"> 1100</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(fmt);</div>
<div class="line"><span class="lineno"> 1101</span> </div>
<div class="line"><span class="lineno"> 1102</span>  <span class="keywordflow">for</span> (<a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> i = 0; i &lt; <span class="keyword">sizeof</span>(yh_types) / <span class="keyword">sizeof</span>(yh_types[0]); i++) {</div>
<div class="line"><span class="lineno"> 1103</span>    fprintf(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>, <span class="stringliteral">&quot;%s\n&quot;</span>, yh_types[i].name);</div>
<div class="line"><span class="lineno"> 1104</span>  }</div>
<div class="line"><span class="lineno"> 1105</span> </div>
<div class="line"><span class="lineno"> 1106</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1107</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_a65ff18ca1fb6f1b4da386071e1c1a505_icgraph.png" border="0" usemap="#acommands_8c_a65ff18ca1fb6f1b4da386071e1c1a505_icgraph" alt=""/></div>
<map name="acommands_8c_a65ff18ca1fb6f1b4da386071e1c1a505_icgraph" id="acommands_8c_a65ff18ca1fb6f1b4da386071e1c1a505_icgraph">
<area shape="rect" title=" " alt="" coords="296,5,426,31"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="280,21,249,21,249,16,280,16"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,55,31"/>
<area shape="poly" title=" " alt="" coords="87,21,55,21,55,16,87,16"/>
</map>
</div>

</div>
</div>
<a id="a39d9fd4501c5547cb11e00a3ca37be7e" name="a39d9fd4501c5547cb11e00a3ca37be7e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a39d9fd4501c5547cb11e00a3ca37be7e">&#9670;&#160;</a></span>yh_com_noop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int yh_com_noop </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__context.html">yubihsm_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_argument.html">Argument</a> *</td>          <td class="paramname"><span class="paramname"><em>argv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a></td>          <td class="paramname"><span class="paramname"><em>fmt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="commands_8c_source.html#l01050">1050</a> of file <a class="el" href="commands_8c_source.html">commands.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1050</span>                                                                      {</div>
<div class="line"><span class="lineno"> 1051</span> </div>
<div class="line"><span class="lineno"> 1052</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ctx);</div>
<div class="line"><span class="lineno"> 1053</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>);</div>
<div class="line"><span class="lineno"> 1054</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(fmt);</div>
<div class="line"><span class="lineno"> 1055</span> </div>
<div class="line"><span class="lineno"> 1056</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1057</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_a39d9fd4501c5547cb11e00a3ca37be7e_icgraph.png" border="0" usemap="#acommands_8c_a39d9fd4501c5547cb11e00a3ca37be7e_icgraph" alt=""/></div>
<map name="acommands_8c_a39d9fd4501c5547cb11e00a3ca37be7e_icgraph" id="acommands_8c_a39d9fd4501c5547cb11e00a3ca37be7e_icgraph">
<area shape="rect" title=" " alt="" coords="296,5,398,31"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="280,21,248,21,248,16,280,16"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,55,31"/>
<area shape="poly" title=" " alt="" coords="87,21,55,21,55,16,87,16"/>
</map>
</div>

</div>
</div>
<a id="a22f22a25151b12c7573f80563a341368" name="a22f22a25151b12c7573f80563a341368"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a22f22a25151b12c7573f80563a341368">&#9670;&#160;</a></span>yh_com_open_session()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int yh_com_open_session </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__context.html">yubihsm_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_argument.html">Argument</a> *</td>          <td class="paramname"><span class="paramname"><em>argv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a></td>          <td class="paramname"><span class="paramname"><em>fmt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="commands_8c_source.html#l01208">1208</a> of file <a class="el" href="commands_8c_source.html">commands.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1208</span>                                                                              {</div>
<div class="line"><span class="lineno"> 1209</span> </div>
<div class="line"><span class="lineno"> 1210</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(fmt);</div>
<div class="line"><span class="lineno"> 1211</span> </div>
<div class="line"><span class="lineno"> 1212</span>  <a class="code hl_struct" href="structyh__session.html">yh_session</a> *<a class="code hl_variable" href="yubihsm__shell__tests_8c.html#a06390486523e3578750748be3bea88d4">ses</a> = NULL;</div>
<div class="line"><span class="lineno"> 1213</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> session_id = 0;</div>
<div class="line"><span class="lineno"> 1214</span> </div>
<div class="line"><span class="lineno"> 1215</span>  <span class="keywordflow">if</span> (ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a8c52c1a89cd4334a0225a1fbfba9a930">connector</a> == NULL) {</div>
<div class="line"><span class="lineno"> 1216</span>    fprintf(stderr, <span class="stringliteral">&quot;Not connected\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1217</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 1218</span>  }</div>
<div class="line"><span class="lineno"> 1219</span> </div>
<div class="line"><span class="lineno"> 1220</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 1221</span> </div>
<div class="line"><span class="lineno"> 1222</span>  <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> authkey = <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].w;</div>
<div class="line"><span class="lineno"> 1223</span> </div>
<div class="line"><span class="lineno"> 1224</span><span class="preprocessor">#ifdef USE_YKYH</span></div>
<div class="line"><span class="lineno"> 1225</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *yh_context;</div>
<div class="line"><span class="lineno"> 1226</span>  <span class="keywordflow">if</span> (strncmp(<span class="stringliteral">&quot;yk:&quot;</span>, (<span class="keywordtype">char</span> *) <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].x, 3) == 0) {</div>
<div class="line"><span class="lineno"> 1227</span>    <a class="code hl_enumeration" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112">ykyh_rc</a> ykyhrc;</div>
<div class="line"><span class="lineno"> 1228</span>    <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> card_cryptogram[<a class="code hl_define" href="yubihsm_8h.html#afbeafba1cc9582217f57f058a7efd200">YH_CONTEXT_LEN</a> / 2];</div>
<div class="line"><span class="lineno"> 1229</span>    <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> key_s_enc[<a class="code hl_define" href="yubihsm_8h.html#ac2737b2a34c26d0258d25e34993df391">YH_KEY_LEN</a>];</div>
<div class="line"><span class="lineno"> 1230</span>    <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> key_s_mac[<a class="code hl_define" href="yubihsm_8h.html#ac2737b2a34c26d0258d25e34993df391">YH_KEY_LEN</a>];</div>
<div class="line"><span class="lineno"> 1231</span>    <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> key_s_rmac[<a class="code hl_define" href="yubihsm_8h.html#ac2737b2a34c26d0258d25e34993df391">YH_KEY_LEN</a>];</div>
<div class="line"><span class="lineno"> 1232</span>    <span class="keywordtype">size_t</span> key_s_enc_len = <span class="keyword">sizeof</span>(key_s_enc);</div>
<div class="line"><span class="lineno"> 1233</span>    <span class="keywordtype">size_t</span> key_s_mac_len = <span class="keyword">sizeof</span>(key_s_mac);</div>
<div class="line"><span class="lineno"> 1234</span>    <span class="keywordtype">size_t</span> key_s_rmac_len = <span class="keyword">sizeof</span>(key_s_rmac);</div>
<div class="line"><span class="lineno"> 1235</span>    <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> retries;</div>
<div class="line"><span class="lineno"> 1236</span> </div>
<div class="line"><span class="lineno"> 1237</span>    ykyhrc = <a class="code hl_function" href="ykyh_8c.html#a6b53f9d9825a88a6a20352c9734e4a4d">ykyh_connect</a>(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a2477a831d6082f899d49df85611e6e52">state</a>, NULL);</div>
<div class="line"><span class="lineno"> 1238</span>    <span class="keywordflow">if</span> (ykyhrc != <a class="code hl_enumvalue" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112a40500f2b4bd15d31f1348475e35f2459">YKYHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 1239</span>      fprintf(stderr, <span class="stringliteral">&quot;Failed to connect to the YubiKey: %s\n&quot;</span>,</div>
<div class="line"><span class="lineno"> 1240</span>              <a class="code hl_function" href="ykyh_2error_8c.html#a4544a3e0741c078e01233bb1ab541805">ykyh_strerror</a>(ykyhrc));</div>
<div class="line"><span class="lineno"> 1241</span>      <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 1242</span>    }</div>
<div class="line"><span class="lineno"> 1243</span> </div>
<div class="line"><span class="lineno"> 1244</span>    <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#a296b43eadb1151017ba8e9578b351c5e">yh_begin_create_session_ext</a>(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a8c52c1a89cd4334a0225a1fbfba9a930">connector</a>, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].w, &amp;yh_context,</div>
<div class="line"><span class="lineno"> 1245</span>                                      card_cryptogram, <span class="keyword">sizeof</span>(card_cryptogram),</div>
<div class="line"><span class="lineno"> 1246</span>                                      &amp;<a class="code hl_variable" href="yubihsm__shell__tests_8c.html#a06390486523e3578750748be3bea88d4">ses</a>);</div>
<div class="line"><span class="lineno"> 1247</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 1248</span>      fprintf(stderr, <span class="stringliteral">&quot;Failed to create session: %s\n&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 1249</span>      <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 1250</span>    }</div>
<div class="line"><span class="lineno"> 1251</span> </div>
<div class="line"><span class="lineno"> 1252</span>    <span class="keywordtype">char</span> *<a class="code hl_variable" href="catch__reporter__console_8cpp.html#a9b45b3e13bd9167aab02e17e08916231">name</a>;</div>
<div class="line"><span class="lineno"> 1253</span>    <span class="keywordtype">char</span> *pw;</div>
<div class="line"><span class="lineno"> 1254</span>    <span class="keywordflow">if</span> (parse_yk_password((<span class="keywordtype">char</span> *) (<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].x + 3), &amp;<a class="code hl_variable" href="catch__reporter__console_8cpp.html#a9b45b3e13bd9167aab02e17e08916231">name</a>, &amp;pw) == -1) {</div>
<div class="line"><span class="lineno"> 1255</span>      fprintf(stderr,</div>
<div class="line"><span class="lineno"> 1256</span>              <span class="stringliteral">&quot;Failed to decode password, format must be &quot;</span></div>
<div class="line"><span class="lineno"> 1257</span>              <span class="stringliteral">&quot;yk:NAME[%d-%d]:PASSWORD[%d]\n&quot;</span>,</div>
<div class="line"><span class="lineno"> 1258</span>              <a class="code hl_define" href="ykyh_8h.html#ae8331a6f47276895ad08a1cbf3a6a508">YKYH_MIN_NAME_LEN</a>, <a class="code hl_define" href="ykyh_8h.html#aba3c1d3e48c3662d8e58a87bc564cc82">YKYH_MAX_NAME_LEN</a>, <a class="code hl_define" href="ykyh_8h.html#a00e800150afe4404120c2090461fdf1a">YKYH_PW_LEN</a>);</div>
<div class="line"><span class="lineno"> 1259</span>      <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 1260</span>    }</div>
<div class="line"><span class="lineno"> 1261</span> </div>
<div class="line"><span class="lineno"> 1262</span>    ykyhrc =</div>
<div class="line"><span class="lineno"> 1263</span>      <a class="code hl_function" href="ykyh_8c.html#af6e95562757fb174ae74843f2ec6304a">ykyh_calculate</a>(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a2477a831d6082f899d49df85611e6e52">state</a>, <a class="code hl_variable" href="catch__reporter__console_8cpp.html#a9b45b3e13bd9167aab02e17e08916231">name</a>, yh_context, <a class="code hl_define" href="yubihsm_8h.html#afbeafba1cc9582217f57f058a7efd200">YH_CONTEXT_LEN</a>, pw,</div>
<div class="line"><span class="lineno"> 1264</span>                     key_s_enc, <span class="keyword">sizeof</span>(key_s_enc), key_s_mac, <span class="keyword">sizeof</span>(key_s_mac),</div>
<div class="line"><span class="lineno"> 1265</span>                     key_s_rmac, <span class="keyword">sizeof</span>(key_s_rmac), &amp;retries);</div>
<div class="line"><span class="lineno"> 1266</span>    <span class="keywordflow">if</span> (ykyhrc != <a class="code hl_enumvalue" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112a40500f2b4bd15d31f1348475e35f2459">YKYHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 1267</span>      fprintf(stderr, <span class="stringliteral">&quot;Failed to get session keys from the YubiKey: %s&quot;</span>,</div>
<div class="line"><span class="lineno"> 1268</span>              <a class="code hl_function" href="ykyh_2error_8c.html#a4544a3e0741c078e01233bb1ab541805">ykyh_strerror</a>(ykyhrc));</div>
<div class="line"><span class="lineno"> 1269</span>      <span class="keywordflow">if</span> (ykyhrc == <a class="code hl_enumvalue" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112ae58239391b2ac02c8bb353666cdf9ac8">YKYHR_WRONG_PW</a>) {</div>
<div class="line"><span class="lineno"> 1270</span>        fprintf(stderr, <span class="stringliteral">&quot;, %d attempts remaining&quot;</span>, retries);</div>
<div class="line"><span class="lineno"> 1271</span>      }</div>
<div class="line"><span class="lineno"> 1272</span>      fprintf(stderr, <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1273</span> </div>
<div class="line"><span class="lineno"> 1274</span>      <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 1275</span>    }</div>
<div class="line"><span class="lineno"> 1276</span> </div>
<div class="line"><span class="lineno"> 1277</span>    <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> =</div>
<div class="line"><span class="lineno"> 1278</span>      <a class="code hl_function" href="yubihsm_8c.html#afbcb5c761339fbcf444be8f338b4614f">yh_finish_create_session_ext</a>(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a8c52c1a89cd4334a0225a1fbfba9a930">connector</a>, <a class="code hl_variable" href="yubihsm__shell__tests_8c.html#a06390486523e3578750748be3bea88d4">ses</a>, key_s_enc,</div>
<div class="line"><span class="lineno"> 1279</span>                                   key_s_enc_len, key_s_mac, key_s_mac_len,</div>
<div class="line"><span class="lineno"> 1280</span>                                   key_s_rmac, key_s_rmac_len, card_cryptogram,</div>
<div class="line"><span class="lineno"> 1281</span>                                   <span class="keyword">sizeof</span>(card_cryptogram));</div>
<div class="line"><span class="lineno"> 1282</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 1283</span>      fprintf(stderr, <span class="stringliteral">&quot;Failed to create session: %s\n&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 1284</span>      <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 1285</span>    }</div>
<div class="line"><span class="lineno"> 1286</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1287</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1288</span>    <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#a3be331dcf8907ff3569e4dc230e1c615">yh_create_session_derived</a>(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a8c52c1a89cd4334a0225a1fbfba9a930">connector</a>, authkey, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].x,</div>
<div class="line"><span class="lineno"> 1289</span>                                    <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].len, <span class="keyword">false</span>, &amp;<a class="code hl_variable" href="yubihsm__shell__tests_8c.html#a06390486523e3578750748be3bea88d4">ses</a>);</div>
<div class="line"><span class="lineno"> 1290</span>    <a class="code hl_define" href="insecure__memzero_8h.html#a0794f9275fd1036ecba6ff0a901a320b">insecure_memzero</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].x, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>);</div>
<div class="line"><span class="lineno"> 1291</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 1292</span>      fprintf(stderr, <span class="stringliteral">&quot;Failed to create session: %s\n&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 1293</span>      <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 1294</span>    }</div>
<div class="line"><span class="lineno"> 1295</span><span class="preprocessor">#ifdef USE_YKYH</span></div>
<div class="line"><span class="lineno"> 1296</span>  }</div>
<div class="line"><span class="lineno"> 1297</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1298</span> </div>
<div class="line"><span class="lineno"> 1299</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8">yh_authenticate_session</a>(<a class="code hl_variable" href="yubihsm__shell__tests_8c.html#a06390486523e3578750748be3bea88d4">ses</a>);</div>
<div class="line"><span class="lineno"> 1300</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 1301</span>    fprintf(stderr, <span class="stringliteral">&quot;Failed to authenticate session: %s\n&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 1302</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 1303</span>  }</div>
<div class="line"><span class="lineno"> 1304</span> </div>
<div class="line"><span class="lineno"> 1305</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#aeabf472faf1ba8d963b39866e04df6b0">yh_get_session_id</a>(<a class="code hl_variable" href="yubihsm__shell__tests_8c.html#a06390486523e3578750748be3bea88d4">ses</a>, &amp;session_id);</div>
<div class="line"><span class="lineno"> 1306</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 1307</span>    fprintf(stderr, <span class="stringliteral">&quot;Failed to create session: %s\n&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 1308</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 1309</span>  }</div>
<div class="line"><span class="lineno"> 1310</span> </div>
<div class="line"><span class="lineno"> 1311</span>  <span class="keywordflow">if</span> (ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a7a959752fa285fb4a7a75921bbfa00fe">sessions</a>[session_id] != NULL) {</div>
<div class="line"><span class="lineno"> 1312</span>    <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#a1a35f8ae5a739848408633a514e41b2d">yh_destroy_session</a>(&amp;ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a7a959752fa285fb4a7a75921bbfa00fe">sessions</a>[session_id]);</div>
<div class="line"><span class="lineno"> 1313</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 1314</span>      fprintf(stderr, <span class="stringliteral">&quot;Failed to destroy old session with same id (%d): %s\n&quot;</span>,</div>
<div class="line"><span class="lineno"> 1315</span>              session_id, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 1316</span>      <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 1317</span>    }</div>
<div class="line"><span class="lineno"> 1318</span>  }</div>
<div class="line"><span class="lineno"> 1319</span>  ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a7a959752fa285fb4a7a75921bbfa00fe">sessions</a>[session_id] = <a class="code hl_variable" href="yubihsm__shell__tests_8c.html#a06390486523e3578750748be3bea88d4">ses</a>;</div>
<div class="line"><span class="lineno"> 1320</span> </div>
<div class="line"><span class="lineno"> 1321</span>  fprintf(stderr, <span class="stringliteral">&quot;Created session %d\n&quot;</span>, session_id);</div>
<div class="line"><span class="lineno"> 1322</span> </div>
<div class="line"><span class="lineno"> 1323</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1324</span>}</div>
<div class="ttc" id="acatch__reporter__console_8cpp_html_a9b45b3e13bd9167aab02e17e08916231"><div class="ttname"><a href="catch__reporter__console_8cpp.html#a9b45b3e13bd9167aab02e17e08916231">name</a></div><div class="ttdeci">std::string name</div><div class="ttdef"><b>Definition</b> <a href="catch__reporter__console_8cpp_source.html#l00186">catch_reporter_console.cpp:186</a></div></div>
<div class="ttc" id="astructyubihsm__context_html_a2477a831d6082f899d49df85611e6e52"><div class="ttname"><a href="structyubihsm__context.html#a2477a831d6082f899d49df85611e6e52">yubihsm_context::state</a></div><div class="ttdeci">ykyh_state * state</div><div class="ttdef"><b>Definition</b> <a href="yubihsm-shell_8h_source.html#l00051">yubihsm-shell.h:51</a></div></div>
<div class="ttc" id="aykyh_2error_8c_html_a4544a3e0741c078e01233bb1ab541805"><div class="ttname"><a href="ykyh_2error_8c.html#a4544a3e0741c078e01233bb1ab541805">ykyh_strerror</a></div><div class="ttdeci">const char * ykyh_strerror(ykyh_rc err)</div><div class="ttdef"><b>Definition</b> <a href="ykyh_2error_8c_source.html#l00040">error.c:40</a></div></div>
<div class="ttc" id="aykyh_8c_html_a6b53f9d9825a88a6a20352c9734e4a4d"><div class="ttname"><a href="ykyh_8c.html#a6b53f9d9825a88a6a20352c9734e4a4d">ykyh_connect</a></div><div class="ttdeci">ykyh_rc ykyh_connect(ykyh_state *state, const char *wanted)</div><div class="ttdef"><b>Definition</b> <a href="ykyh_8c_source.html#l00092">ykyh.c:92</a></div></div>
<div class="ttc" id="aykyh_8c_html_af6e95562757fb174ae74843f2ec6304a"><div class="ttname"><a href="ykyh_8c.html#af6e95562757fb174ae74843f2ec6304a">ykyh_calculate</a></div><div class="ttdeci">ykyh_rc ykyh_calculate(ykyh_state *state, const char *name, uint8_t *context, size_t context_len, const char *pw, uint8_t *key_s_enc, size_t key_s_enc_len, uint8_t *key_s_mac, size_t key_s_mac_len, uint8_t *key_s_rmac, size_t key_s_rmac_len, uint8_t *retries)</div><div class="ttdef"><b>Definition</b> <a href="ykyh_8c_source.html#l00403">ykyh.c:403</a></div></div>
<div class="ttc" id="aykyh_8h_html_a00e800150afe4404120c2090461fdf1a"><div class="ttname"><a href="ykyh_8h.html#a00e800150afe4404120c2090461fdf1a">YKYH_PW_LEN</a></div><div class="ttdeci">#define YKYH_PW_LEN</div><div class="ttdef"><b>Definition</b> <a href="ykyh_8h_source.html#l00067">ykyh.h:67</a></div></div>
<div class="ttc" id="aykyh_8h_html_a93aafaa60a79c75641302448631ea112"><div class="ttname"><a href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112">ykyh_rc</a></div><div class="ttdeci">ykyh_rc</div><div class="ttdef"><b>Definition</b> <a href="ykyh_8h_source.html#l00076">ykyh.h:76</a></div></div>
<div class="ttc" id="aykyh_8h_html_a93aafaa60a79c75641302448631ea112a40500f2b4bd15d31f1348475e35f2459"><div class="ttname"><a href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112a40500f2b4bd15d31f1348475e35f2459">YKYHR_SUCCESS</a></div><div class="ttdeci">@ YKYHR_SUCCESS</div><div class="ttdef"><b>Definition</b> <a href="ykyh_8h_source.html#l00077">ykyh.h:77</a></div></div>
<div class="ttc" id="aykyh_8h_html_a93aafaa60a79c75641302448631ea112ae58239391b2ac02c8bb353666cdf9ac8"><div class="ttname"><a href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112ae58239391b2ac02c8bb353666cdf9ac8">YKYHR_WRONG_PW</a></div><div class="ttdeci">@ YKYHR_WRONG_PW</div><div class="ttdef"><b>Definition</b> <a href="ykyh_8h_source.html#l00081">ykyh.h:81</a></div></div>
<div class="ttc" id="aykyh_8h_html_aba3c1d3e48c3662d8e58a87bc564cc82"><div class="ttname"><a href="ykyh_8h.html#aba3c1d3e48c3662d8e58a87bc564cc82">YKYH_MAX_NAME_LEN</a></div><div class="ttdeci">#define YKYH_MAX_NAME_LEN</div><div class="ttdef"><b>Definition</b> <a href="ykyh_8h_source.html#l00065">ykyh.h:65</a></div></div>
<div class="ttc" id="aykyh_8h_html_ae8331a6f47276895ad08a1cbf3a6a508"><div class="ttname"><a href="ykyh_8h.html#ae8331a6f47276895ad08a1cbf3a6a508">YKYH_MIN_NAME_LEN</a></div><div class="ttdeci">#define YKYH_MIN_NAME_LEN</div><div class="ttdef"><b>Definition</b> <a href="ykyh_8h_source.html#l00064">ykyh.h:64</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_a296b43eadb1151017ba8e9578b351c5e"><div class="ttname"><a href="yubihsm_8c.html#a296b43eadb1151017ba8e9578b351c5e">yh_begin_create_session_ext</a></div><div class="ttdeci">yh_rc yh_begin_create_session_ext(yh_connector *connector, uint16_t authkey_id, uint8_t **context, uint8_t *card_cryptogram, size_t card_cryptogram_len, yh_session **session)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l00751">yubihsm.c:751</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_afbcb5c761339fbcf444be8f338b4614f"><div class="ttname"><a href="yubihsm_8c.html#afbcb5c761339fbcf444be8f338b4614f">yh_finish_create_session_ext</a></div><div class="ttdeci">yh_rc yh_finish_create_session_ext(yh_connector *connector, yh_session *session, const uint8_t *key_senc, size_t key_senc_len, const uint8_t *key_smac, size_t key_smac_len, const uint8_t *key_srmac, size_t key_srmac_len, uint8_t *card_cryptogram, size_t card_cryptogram_len)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l00847">yubihsm.c:847</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_ac2737b2a34c26d0258d25e34993df391"><div class="ttname"><a href="yubihsm_8h.html#ac2737b2a34c26d0258d25e34993df391">YH_KEY_LEN</a></div><div class="ttdeci">#define YH_KEY_LEN</div><div class="ttdoc">Length of authentication keys.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00095">yubihsm.h:95</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_afbeafba1cc9582217f57f058a7efd200"><div class="ttname"><a href="yubihsm_8h.html#afbeafba1cc9582217f57f058a7efd200">YH_CONTEXT_LEN</a></div><div class="ttdeci">#define YH_CONTEXT_LEN</div><div class="ttdoc">Length of context array for authentication.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00089">yubihsm.h:89</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_a22f22a25151b12c7573f80563a341368_cgraph.png" border="0" usemap="#acommands_8c_a22f22a25151b12c7573f80563a341368_cgraph" alt=""/></div>
<map name="acommands_8c_a22f22a25151b12c7573f80563a341368_cgraph" id="acommands_8c_a22f22a25151b12c7573f80563a341368_cgraph">
<area shape="rect" title=" " alt="" coords="5,279,160,305"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="215,406,380,432"/>
<area shape="poly" title=" " alt="" coords="108,303,262,396,259,400,105,308"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="686,185,770,210"/>
<area shape="poly" title=" " alt="" coords="88,278,105,249,131,212,165,174,206,145,265,116,317,95,366,83,413,77,461,79,512,87,629,120,672,143,706,172,703,176,669,148,627,125,510,92,461,84,414,82,367,88,319,100,267,121,209,149,169,178,135,215,110,251,93,280"/>
<area shape="rect" href="yubihsm_8c.html#a296b43eadb1151017ba8e9578b351c5e" title=" " alt="" coords="435,7,628,33"/>
<area shape="poly" title=" " alt="" coords="84,278,94,233,116,170,133,136,153,104,177,75,206,50,256,25,311,10,366,4,419,3,419,9,367,9,312,15,258,30,209,54,181,78,157,107,137,139,121,172,99,235,89,280"/>
<area shape="rect" href="yubihsm_8c.html#a3be331dcf8907ff3569e4dc230e1c615" title=" " alt="" coords="208,159,387,185"/>
<area shape="poly" title=" " alt="" coords="98,277,145,240,206,202,237,188,239,193,209,207,148,245,101,281"/>
<area shape="rect" href="yubihsm_8c.html#a1a35f8ae5a739848408633a514e41b2d" title=" " alt="" coords="229,217,366,242"/>
<area shape="poly" title=" " alt="" coords="129,276,235,245,237,250,130,281"/>
<area shape="rect" href="yubihsm_8c.html#afbcb5c761339fbcf444be8f338b4614f" title=" " alt="" coords="435,362,628,388"/>
<area shape="poly" title=" " alt="" coords="157,303,444,356,443,361,156,308"/>
<area shape="rect" href="yubihsm_8c.html#aeabf472faf1ba8d963b39866e04df6b0" title=" " alt="" coords="233,273,362,298"/>
<area shape="poly" title=" " alt="" coords="160,287,217,285,217,291,160,293"/>
<area shape="rect" href="ykyh_8c.html#af6e95562757fb174ae74843f2ec6304a" title=" " alt="" coords="243,463,352,489"/>
<area shape="poly" title=" " alt="" coords="94,304,137,370,170,408,209,442,232,455,230,460,206,446,167,412,133,373,89,307"/>
<area shape="rect" href="ykyh_8c.html#a6b53f9d9825a88a6a20352c9734e4a4d" title=" " alt="" coords="246,565,348,590"/>
<area shape="poly" title=" " alt="" coords="92,304,136,390,170,446,210,500,238,529,267,553,263,557,234,532,206,503,166,449,131,393,87,307"/>
<area shape="rect" href="ykyh_2error_8c.html#a4544a3e0741c078e01233bb1ab541805" title=" " alt="" coords="483,665,580,690"/>
<area shape="poly" title=" " alt="" coords="88,305,95,360,114,440,130,484,151,527,177,567,209,601,238,622,270,639,339,662,408,673,468,677,468,682,407,678,338,667,268,644,236,626,206,605,173,570,146,530,125,486,109,442,90,361,82,306"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="692,387,764,413"/>
<area shape="poly" title=" " alt="" coords="380,413,677,400,677,405,380,418"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="498,463,566,489"/>
<area shape="poly" title=" " alt="" coords="354,430,483,462,482,467,352,435"/>
<area shape="poly" title=" " alt="" coords="322,403,434,347,532,308,575,291,627,265,696,218,699,222,630,269,577,296,534,313,436,352,325,408"/>
<area shape="poly" title=" " alt="" coords="547,32,587,80,631,146,661,207,687,270,721,372,716,373,682,272,656,209,626,148,582,83,543,35"/>
<area shape="poly" title=" " alt="" coords="594,31,630,50,712,170,707,173,627,54,592,36"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="676,83,780,109"/>
<area shape="poly" title=" " alt="" coords="577,31,629,50,686,74,684,79,627,55,575,36"/>
<area shape="poly" title=" " alt="" coords="348,156,406,145,476,136,553,134,629,144,664,157,696,174,693,178,662,162,628,149,553,139,477,141,407,150,349,161"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="466,159,597,185"/>
<area shape="poly" title=" " alt="" coords="388,170,451,170,451,175,388,175"/>
<area shape="poly" title=" " alt="" coords="546,184,708,374,704,377,542,187"/>
<area shape="poly" title=" " alt="" coords="598,178,671,188,671,193,597,183"/>
<area shape="poly" title=" " alt="" coords="566,156,678,113,680,118,568,161"/>
<area shape="poly" title=" " alt="" coords="366,222,671,199,671,204,367,227"/>
<area shape="poly" title=" " alt="" coords="629,385,677,391,676,396,628,390"/>
<area shape="poly" title=" " alt="" coords="592,359,627,341,655,314,679,283,713,223,717,226,684,286,659,317,630,345,594,364"/>
<area shape="poly" title=" " alt="" coords="362,273,485,251,628,222,670,211,672,216,629,227,486,256,363,278"/>
<area shape="poly" title=" " alt="" coords="336,487,394,504,469,516,509,519,549,518,589,511,627,499,652,485,675,466,708,425,712,428,678,469,655,489,629,504,590,517,550,523,509,524,468,522,393,509,335,492"/>
<area shape="poly" title=" " alt="" coords="352,474,482,474,482,479,352,479"/>
<area shape="poly" title=" " alt="" coords="349,578,409,578,481,572,556,555,593,542,627,525,655,504,678,478,712,426,716,429,682,481,658,508,630,529,595,547,558,560,481,577,409,583,349,584"/>
<area shape="poly" title=" " alt="" coords="328,562,485,493,487,498,330,567"/>
<area shape="rect" href="ykyh_8c.html#a9a87b4e80e8f980badba176c4b713e13" title=" " alt="" coords="470,615,593,641"/>
<area shape="poly" title=" " alt="" coords="350,586,455,609,454,614,348,591"/>
<area shape="poly" title=" " alt="" coords="320,589,371,620,436,651,469,662,467,667,434,656,369,624,317,593"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_a22f22a25151b12c7573f80563a341368_icgraph.png" border="0" usemap="#acommands_8c_a22f22a25151b12c7573f80563a341368_icgraph" alt=""/></div>
<map name="acommands_8c_a22f22a25151b12c7573f80563a341368_icgraph" id="acommands_8c_a22f22a25151b12c7573f80563a341368_icgraph">
<area shape="rect" title=" " alt="" coords="296,31,450,56"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="280,34,248,30,249,25,281,29"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,31,55,56"/>
<area shape="poly" title=" " alt="" coords="280,46,55,46,55,41,280,41"/>
<area shape="poly" title=" " alt="" coords="88,36,55,42,54,37,87,31"/>
</map>
</div>

</div>
</div>
<a id="ae716e54fae7ba83cb44fe966fbcad9cb" name="ae716e54fae7ba83cb44fe966fbcad9cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae716e54fae7ba83cb44fe966fbcad9cb">&#9670;&#160;</a></span>yh_com_otp_aead_create()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int yh_com_otp_aead_create </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__context.html">yubihsm_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_argument.html">Argument</a> *</td>          <td class="paramname"><span class="paramname"><em>argv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a></td>          <td class="paramname"><span class="paramname"><em>fmt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="commands_8c_source.html#l02461">2461</a> of file <a class="el" href="commands_8c_source.html">commands.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2462</span>                                           {</div>
<div class="line"><span class="lineno"> 2463</span> </div>
<div class="line"><span class="lineno"> 2464</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> response[<a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a>];</div>
<div class="line"><span class="lineno"> 2465</span>  <span class="keywordtype">size_t</span> response_len = <span class="keyword">sizeof</span>(response);</div>
<div class="line"><span class="lineno"> 2466</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 2467</span> </div>
<div class="line"><span class="lineno"> 2468</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[2].<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> != 16) {</div>
<div class="line"><span class="lineno"> 2469</span>    fprintf(stderr, <span class="stringliteral">&quot;Wrong length key supplied, has to be 16 bytes\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 2470</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 2471</span>  }</div>
<div class="line"><span class="lineno"> 2472</span> </div>
<div class="line"><span class="lineno"> 2473</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[3].<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> != 6) {</div>
<div class="line"><span class="lineno"> 2474</span>    fprintf(stderr, <span class="stringliteral">&quot;Wrong length id supplied, has to be 6 bytes\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 2475</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 2476</span>  }</div>
<div class="line"><span class="lineno"> 2477</span> </div>
<div class="line"><span class="lineno"> 2478</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#a82d295a02d9eb628f6dea4b4c01fdec4">yh_util_create_otp_aead</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].w, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[2].x, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[3].x,</div>
<div class="line"><span class="lineno"> 2479</span>                                response, &amp;response_len);</div>
<div class="line"><span class="lineno"> 2480</span> </div>
<div class="line"><span class="lineno"> 2481</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 2482</span>    fprintf(stderr, <span class="stringliteral">&quot;Failed to create OTP AEAD: %s\n&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 2483</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 2484</span>  }</div>
<div class="line"><span class="lineno"> 2485</span> </div>
<div class="line"><span class="lineno"> 2486</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="util_8c.html#ad969d220471d10a9f07080b50210f403">write_file</a>(response, response_len, ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>, fmt_to_fmt(fmt))) {</div>
<div class="line"><span class="lineno"> 2487</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 2488</span>  }</div>
<div class="line"><span class="lineno"> 2489</span> </div>
<div class="line"><span class="lineno"> 2490</span>  <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 2491</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_ae716e54fae7ba83cb44fe966fbcad9cb_cgraph.png" border="0" usemap="#acommands_8c_ae716e54fae7ba83cb44fe966fbcad9cb_cgraph" alt=""/></div>
<map name="acommands_8c_ae716e54fae7ba83cb44fe966fbcad9cb_cgraph" id="acommands_8c_ae716e54fae7ba83cb44fe966fbcad9cb_cgraph">
<area shape="rect" title=" " alt="" coords="5,56,176,82"/>
<area shape="rect" href="util_8c.html#ad969d220471d10a9f07080b50210f403" title=" " alt="" coords="268,5,342,31"/>
<area shape="poly" title=" " alt="" coords="147,53,252,28,254,33,149,58"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="854,108,937,134"/>
<area shape="poly" title=" " alt="" coords="176,70,452,84,796,108,838,112,838,117,795,113,451,89,176,75"/>
<area shape="rect" href="yubihsm_8c.html#a82d295a02d9eb628f6dea4b4c01fdec4" title=" " alt="" coords="224,132,386,158"/>
<area shape="poly" title=" " alt="" coords="130,80,253,124,251,129,128,85"/>
<area shape="poly" title=" " alt="" coords="386,139,838,120,838,126,386,144"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="860,207,931,232"/>
<area shape="poly" title=" " alt="" coords="338,156,435,193,534,225,613,244,693,250,795,242,845,232,846,237,796,247,693,255,612,249,532,230,433,198,336,161"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="434,157,582,183"/>
<area shape="poly" title=" " alt="" coords="387,152,419,156,418,162,386,158"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="630,157,796,183"/>
<area shape="poly" title=" " alt="" coords="582,168,615,168,615,173,582,173"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="648,207,778,232"/>
<area shape="poly" title=" " alt="" coords="565,181,642,200,641,205,564,186"/>
<area shape="poly" title=" " alt="" coords="763,154,838,133,839,139,764,159"/>
<area shape="poly" title=" " alt="" coords="764,181,845,203,844,209,763,186"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="861,157,930,183"/>
<area shape="poly" title=" " alt="" coords="796,168,846,168,846,173,796,173"/>
<area shape="poly" title=" " alt="" coords="773,204,794,193,809,181,818,169,827,156,842,143,847,139,850,144,845,147,831,160,822,173,813,185,797,198,775,208"/>
<area shape="poly" title=" " alt="" coords="779,217,845,217,845,222,779,222"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="844,256,947,282"/>
<area shape="poly" title=" " alt="" coords="764,230,831,249,829,254,763,236"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_ae716e54fae7ba83cb44fe966fbcad9cb_icgraph.png" border="0" usemap="#acommands_8c_ae716e54fae7ba83cb44fe966fbcad9cb_icgraph" alt=""/></div>
<map name="acommands_8c_ae716e54fae7ba83cb44fe966fbcad9cb_icgraph" id="acommands_8c_ae716e54fae7ba83cb44fe966fbcad9cb_icgraph">
<area shape="rect" title=" " alt="" coords="296,5,466,31"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="280,21,248,21,248,16,280,16"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,55,31"/>
<area shape="poly" title=" " alt="" coords="87,21,55,21,55,16,87,16"/>
</map>
</div>

</div>
</div>
<a id="a533707756dfe3a35c9aadf4d288b73d4" name="a533707756dfe3a35c9aadf4d288b73d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a533707756dfe3a35c9aadf4d288b73d4">&#9670;&#160;</a></span>yh_com_otp_aead_random()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int yh_com_otp_aead_random </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__context.html">yubihsm_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_argument.html">Argument</a> *</td>          <td class="paramname"><span class="paramname"><em>argv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a></td>          <td class="paramname"><span class="paramname"><em>fmt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="commands_8c_source.html#l02498">2498</a> of file <a class="el" href="commands_8c_source.html">commands.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2499</span>                                           {</div>
<div class="line"><span class="lineno"> 2500</span> </div>
<div class="line"><span class="lineno"> 2501</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> response[<a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a>];</div>
<div class="line"><span class="lineno"> 2502</span>  <span class="keywordtype">size_t</span> response_len = <span class="keyword">sizeof</span>(response);</div>
<div class="line"><span class="lineno"> 2503</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 2504</span> </div>
<div class="line"><span class="lineno"> 2505</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> =</div>
<div class="line"><span class="lineno"> 2506</span>    <a class="code hl_function" href="yubihsm_8c.html#a4bb1d420f681bc91bd36dc08695dbad6">yh_util_randomize_otp_aead</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].w, response, &amp;response_len);</div>
<div class="line"><span class="lineno"> 2507</span> </div>
<div class="line"><span class="lineno"> 2508</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 2509</span>    fprintf(stderr, <span class="stringliteral">&quot;Failed to create OTP AEAD: %s\n&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 2510</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 2511</span>  }</div>
<div class="line"><span class="lineno"> 2512</span> </div>
<div class="line"><span class="lineno"> 2513</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="util_8c.html#ad969d220471d10a9f07080b50210f403">write_file</a>(response, response_len, ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>, fmt_to_fmt(fmt))) {</div>
<div class="line"><span class="lineno"> 2514</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 2515</span>  }</div>
<div class="line"><span class="lineno"> 2516</span> </div>
<div class="line"><span class="lineno"> 2517</span>  <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 2518</span>}</div>
<div class="ttc" id="ayubihsm_8c_html_a4bb1d420f681bc91bd36dc08695dbad6"><div class="ttname"><a href="yubihsm_8c.html#a4bb1d420f681bc91bd36dc08695dbad6">yh_util_randomize_otp_aead</a></div><div class="ttdeci">yh_rc yh_util_randomize_otp_aead(yh_session *session, uint16_t key_id, uint8_t *out, size_t *out_len)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l03223">yubihsm.c:3223</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_a533707756dfe3a35c9aadf4d288b73d4_cgraph.png" border="0" usemap="#acommands_8c_a533707756dfe3a35c9aadf4d288b73d4_cgraph" alt=""/></div>
<map name="acommands_8c_a533707756dfe3a35c9aadf4d288b73d4_cgraph" id="acommands_8c_a533707756dfe3a35c9aadf4d288b73d4_cgraph">
<area shape="rect" title=" " alt="" coords="5,153,183,179"/>
<area shape="rect" href="util_8c.html#ad969d220471d10a9f07080b50210f403" title=" " alt="" coords="287,104,360,130"/>
<area shape="poly" title=" " alt="" coords="157,150,271,125,273,130,158,155"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="885,153,968,179"/>
<area shape="poly" title=" " alt="" coords="155,177,231,189,321,195,414,197,594,193,752,182,869,170,869,176,753,187,594,198,414,202,321,200,230,194,154,182"/>
<area shape="rect" href="yubihsm_8c.html#a4bb1d420f681bc91bd36dc08695dbad6" title=" " alt="" coords="231,153,417,179"/>
<area shape="poly" title=" " alt="" coords="183,164,215,164,215,169,183,169"/>
<area shape="poly" title=" " alt="" coords="418,164,869,164,869,169,418,169"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="465,103,613,128"/>
<area shape="poly" title=" " alt="" coords="381,150,466,130,468,135,382,155"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="661,53,827,79"/>
<area shape="poly" title=" " alt="" coords="595,99,672,81,673,86,596,105"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="679,103,809,128"/>
<area shape="poly" title=" " alt="" coords="613,113,664,113,664,118,613,118"/>
<area shape="poly" title=" " alt="" coords="806,77,828,88,844,101,853,114,862,127,876,140,881,143,878,148,873,144,858,130,849,117,840,105,825,92,804,82"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="891,55,962,80"/>
<area shape="poly" title=" " alt="" coords="827,64,875,64,875,70,827,69"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="892,5,960,31"/>
<area shape="poly" title=" " alt="" coords="795,50,876,28,878,34,797,55"/>
<area shape="poly" title=" " alt="" coords="794,126,870,148,869,153,792,132"/>
<area shape="poly" title=" " alt="" coords="795,99,875,78,876,83,797,105"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="875,104,978,130"/>
<area shape="poly" title=" " alt="" coords="810,113,859,114,859,119,810,119"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_a533707756dfe3a35c9aadf4d288b73d4_icgraph.png" border="0" usemap="#acommands_8c_a533707756dfe3a35c9aadf4d288b73d4_icgraph" alt=""/></div>
<map name="acommands_8c_a533707756dfe3a35c9aadf4d288b73d4_icgraph" id="acommands_8c_a533707756dfe3a35c9aadf4d288b73d4_icgraph">
<area shape="rect" title=" " alt="" coords="296,31,473,56"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="280,34,248,30,249,24,281,28"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,31,55,56"/>
<area shape="poly" title=" " alt="" coords="280,46,55,46,55,41,280,41"/>
<area shape="poly" title=" " alt="" coords="88,36,55,42,54,37,87,31"/>
</map>
</div>

</div>
</div>
<a id="ad676312a3ed43f6a3ece63851780aeff" name="ad676312a3ed43f6a3ece63851780aeff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad676312a3ed43f6a3ece63851780aeff">&#9670;&#160;</a></span>yh_com_otp_decrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int yh_com_otp_decrypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__context.html">yubihsm_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_argument.html">Argument</a> *</td>          <td class="paramname"><span class="paramname"><em>argv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a></td>          <td class="paramname"><span class="paramname"><em>fmt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="commands_8c_source.html#l02526">2526</a> of file <a class="el" href="commands_8c_source.html">commands.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2526</span>                                                                             {</div>
<div class="line"><span class="lineno"> 2527</span>  <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> useCtr;</div>
<div class="line"><span class="lineno"> 2528</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> sessionCtr;</div>
<div class="line"><span class="lineno"> 2529</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> tstph;</div>
<div class="line"><span class="lineno"> 2530</span>  <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> tstpl;</div>
<div class="line"><span class="lineno"> 2531</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 2532</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="yubico__otp_8c.html#ab1e1d61db8c48d537faca71988a7c123">otp</a>[16];</div>
<div class="line"><span class="lineno"> 2533</span>  <span class="keywordtype">size_t</span> otp_len = <span class="keyword">sizeof</span>(<a class="code hl_variable" href="yubico__otp_8c.html#ab1e1d61db8c48d537faca71988a7c123">otp</a>);</div>
<div class="line"><span class="lineno"> 2534</span> </div>
<div class="line"><span class="lineno"> 2535</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ctx);</div>
<div class="line"><span class="lineno"> 2536</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(fmt);</div>
<div class="line"><span class="lineno"> 2537</span> </div>
<div class="line"><span class="lineno"> 2538</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[2].<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> != 32) {</div>
<div class="line"><span class="lineno"> 2539</span>    fprintf(stderr, <span class="stringliteral">&quot;Wrong length OTP supplied, has to be 16 bytes in hex\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 2540</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 2541</span>  }</div>
<div class="line"><span class="lineno"> 2542</span> </div>
<div class="line"><span class="lineno"> 2543</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="util_8c.html#af201e18e3fc54c17b855a6354251247e">hex_decode</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[2].<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a>, <a class="code hl_variable" href="yubico__otp_8c.html#ab1e1d61db8c48d537faca71988a7c123">otp</a>, &amp;otp_len) == <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 2544</span>    fprintf(stderr, <span class="stringliteral">&quot;Failed to decode OTP\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 2545</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 2546</span>  }</div>
<div class="line"><span class="lineno"> 2547</span> </div>
<div class="line"><span class="lineno"> 2548</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#a3677afe2209a1cae31f70a304e260e28">yh_util_decrypt_otp</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].w, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[3].x, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[3].<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>, <a class="code hl_variable" href="yubico__otp_8c.html#ab1e1d61db8c48d537faca71988a7c123">otp</a>,</div>
<div class="line"><span class="lineno"> 2549</span>                            &amp;useCtr, &amp;sessionCtr, &amp;tstph, &amp;tstpl);</div>
<div class="line"><span class="lineno"> 2550</span> </div>
<div class="line"><span class="lineno"> 2551</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 2552</span>    fprintf(stderr, <span class="stringliteral">&quot;Failed to decrypt OTP: %s\n&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 2553</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 2554</span>  }</div>
<div class="line"><span class="lineno"> 2555</span> </div>
<div class="line"><span class="lineno"> 2556</span>  fprintf(stderr, <span class="stringliteral">&quot;OTP decoded, useCtr:%d, sessionCtr:%d, tstph:%d, tstpl:%d\n&quot;</span>,</div>
<div class="line"><span class="lineno"> 2557</span>          useCtr, sessionCtr, tstph, tstpl);</div>
<div class="line"><span class="lineno"> 2558</span> </div>
<div class="line"><span class="lineno"> 2559</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 2560</span>}</div>
<div class="ttc" id="autil_8c_html_af201e18e3fc54c17b855a6354251247e"><div class="ttname"><a href="util_8c.html#af201e18e3fc54c17b855a6354251247e">hex_decode</a></div><div class="ttdeci">bool hex_decode(const char *in, uint8_t *out, size_t *len)</div><div class="ttdef"><b>Definition</b> <a href="util_8c_source.html#l00524">util.c:524</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_ad676312a3ed43f6a3ece63851780aeff_cgraph.png" border="0" usemap="#acommands_8c_ad676312a3ed43f6a3ece63851780aeff_cgraph" alt=""/></div>
<map name="acommands_8c_ad676312a3ed43f6a3ece63851780aeff_cgraph" id="acommands_8c_ad676312a3ed43f6a3ece63851780aeff_cgraph">
<area shape="rect" title=" " alt="" coords="5,56,148,82"/>
<area shape="rect" href="util_8c.html#af201e18e3fc54c17b855a6354251247e" title=" " alt="" coords="217,5,308,31"/>
<area shape="poly" title=" " alt="" coords="126,53,202,32,203,37,127,58"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="798,108,881,134"/>
<area shape="poly" title=" " alt="" coords="148,69,409,84,740,108,782,112,782,117,739,113,408,89,148,75"/>
<area shape="rect" href="yubihsm_8c.html#a3677afe2209a1cae31f70a304e260e28" title=" " alt="" coords="196,132,330,158"/>
<area shape="poly" title=" " alt="" coords="111,80,217,123,215,128,109,85"/>
<area shape="poly" title=" " alt="" coords="330,139,782,120,783,126,331,145"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="804,207,875,232"/>
<area shape="poly" title=" " alt="" coords="292,156,379,193,477,226,556,245,637,251,739,242,789,232,790,237,740,247,637,256,556,250,476,231,377,198,290,161"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="378,157,526,183"/>
<area shape="poly" title=" " alt="" coords="331,151,363,156,362,161,330,156"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="574,157,740,183"/>
<area shape="poly" title=" " alt="" coords="526,168,559,168,559,173,526,173"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="592,207,722,232"/>
<area shape="poly" title=" " alt="" coords="509,181,586,200,585,205,508,186"/>
<area shape="poly" title=" " alt="" coords="707,154,782,133,783,139,708,159"/>
<area shape="poly" title=" " alt="" coords="708,181,789,203,788,209,707,186"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="805,157,874,183"/>
<area shape="poly" title=" " alt="" coords="740,168,790,168,790,173,740,173"/>
<area shape="poly" title=" " alt="" coords="717,204,738,193,753,181,762,169,771,156,786,143,791,139,794,144,789,147,775,160,766,173,757,185,741,198,719,208"/>
<area shape="poly" title=" " alt="" coords="723,217,789,217,789,222,723,222"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="788,256,891,282"/>
<area shape="poly" title=" " alt="" coords="708,230,775,249,773,254,707,236"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_ad676312a3ed43f6a3ece63851780aeff_icgraph.png" border="0" usemap="#acommands_8c_ad676312a3ed43f6a3ece63851780aeff_icgraph" alt=""/></div>
<map name="acommands_8c_ad676312a3ed43f6a3ece63851780aeff_icgraph" id="acommands_8c_ad676312a3ed43f6a3ece63851780aeff_icgraph">
<area shape="rect" title=" " alt="" coords="296,5,438,31"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="280,21,248,21,248,16,280,16"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,55,31"/>
<area shape="poly" title=" " alt="" coords="87,21,55,21,55,16,87,16"/>
</map>
</div>

</div>
</div>
<a id="a95d970cdea5162be25cac2a7f5c420ed" name="a95d970cdea5162be25cac2a7f5c420ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95d970cdea5162be25cac2a7f5c420ed">&#9670;&#160;</a></span>yh_com_pecho()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int yh_com_pecho </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__context.html">yubihsm_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_argument.html">Argument</a> *</td>          <td class="paramname"><span class="paramname"><em>argv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a></td>          <td class="paramname"><span class="paramname"><em>fmt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="commands_8c_source.html#l01330">1330</a> of file <a class="el" href="commands_8c_source.html">commands.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1330</span>                                                                       {</div>
<div class="line"><span class="lineno"> 1331</span> </div>
<div class="line"><span class="lineno"> 1332</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(fmt);</div>
<div class="line"><span class="lineno"> 1333</span> </div>
<div class="line"><span class="lineno"> 1334</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 1335</span> </div>
<div class="line"><span class="lineno"> 1336</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> data[<a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a>];</div>
<div class="line"><span class="lineno"> 1337</span>  <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> data_len;</div>
<div class="line"><span class="lineno"> 1338</span> </div>
<div class="line"><span class="lineno"> 1339</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> response[<a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a>];</div>
<div class="line"><span class="lineno"> 1340</span>  <span class="keywordtype">size_t</span> response_len;</div>
<div class="line"><span class="lineno"> 1341</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7e">yh_cmd</a> response_cmd;</div>
<div class="line"><span class="lineno"> 1342</span> </div>
<div class="line"><span class="lineno"> 1343</span>  <span class="keywordflow">if</span> (ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a8c52c1a89cd4334a0225a1fbfba9a930">connector</a> == NULL) {</div>
<div class="line"><span class="lineno"> 1344</span>    fprintf(stderr, <span class="stringliteral">&quot;Not connected\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1345</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 1346</span>  }</div>
<div class="line"><span class="lineno"> 1347</span> </div>
<div class="line"><span class="lineno"> 1348</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <span class="keywordtype">byte</span> = <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].b;</div>
<div class="line"><span class="lineno"> 1349</span> </div>
<div class="line"><span class="lineno"> 1350</span>  <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="code hl_variable" href="gmock__stress__test_8cc.html#afd9db40e3361ae09188795e8cbe19752">count</a> = <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].w;</div>
<div class="line"><span class="lineno"> 1351</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="gmock__stress__test_8cc.html#afd9db40e3361ae09188795e8cbe19752">count</a> &gt; <a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a>) {</div>
<div class="line"><span class="lineno"> 1352</span>    fprintf(stderr, <span class="stringliteral">&quot;Count must be in [0, %d]\n&quot;</span>, <a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a>);</div>
<div class="line"><span class="lineno"> 1353</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 1354</span>  }</div>
<div class="line"><span class="lineno"> 1355</span> </div>
<div class="line"><span class="lineno"> 1356</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105">memset</a>(data, <span class="keywordtype">byte</span>, <a class="code hl_variable" href="gmock__stress__test_8cc.html#afd9db40e3361ae09188795e8cbe19752">count</a>);</div>
<div class="line"><span class="lineno"> 1357</span> </div>
<div class="line"><span class="lineno"> 1358</span>  data_len = <a class="code hl_variable" href="gmock__stress__test_8cc.html#afd9db40e3361ae09188795e8cbe19752">count</a>;</div>
<div class="line"><span class="lineno"> 1359</span>  response_len = <span class="keyword">sizeof</span>(response);</div>
<div class="line"><span class="lineno"> 1360</span> </div>
<div class="line"><span class="lineno"> 1361</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#a799e299be8d4c13dfa2112a60d05480d">yh_send_plain_msg</a>(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a8c52c1a89cd4334a0225a1fbfba9a930">connector</a>, YHC_ECHO, data, data_len,</div>
<div class="line"><span class="lineno"> 1362</span>                          &amp;response_cmd, response, &amp;response_len);</div>
<div class="line"><span class="lineno"> 1363</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 1364</span>    fprintf(stderr, <span class="stringliteral">&quot;Failed to send ECHO command): %s\n&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 1365</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 1366</span>  }</div>
<div class="line"><span class="lineno"> 1367</span> </div>
<div class="line"><span class="lineno"> 1368</span>  <span class="keywordflow">if</span> (response_cmd == <a class="code hl_enumvalue" href="yubihsm_8h.html#aa5415bafa9c48dfef0e183d8df504b7ea51cdf2ccd6995498e589e8ea6ce2a1f2">YHC_ERROR</a>) {</div>
<div class="line"><span class="lineno"> 1369</span>    fprintf(stderr, <span class="stringliteral">&quot;Unable to get echo data: %s (%x)\n&quot;</span>,</div>
<div class="line"><span class="lineno"> 1370</span>            <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(response[0]), response[0]);</div>
<div class="line"><span class="lineno"> 1371</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 1372</span>  }</div>
<div class="line"><span class="lineno"> 1373</span> </div>
<div class="line"><span class="lineno"> 1374</span>  fprintf(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>, <span class="stringliteral">&quot;Response (%zu bytes):\n&quot;</span>, response_len);</div>
<div class="line"><span class="lineno"> 1375</span>  <span class="keywordflow">for</span> (<a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> i = 0; i &lt; response_len; i++) {</div>
<div class="line"><span class="lineno"> 1376</span>    <span class="keywordflow">if</span> (i &amp;&amp; !(i % 64))</div>
<div class="line"><span class="lineno"> 1377</span>      fprintf(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>, <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1378</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i &amp;&amp; !(i % 8))</div>
<div class="line"><span class="lineno"> 1379</span>      fprintf(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>, <span class="stringliteral">&quot; &quot;</span>);</div>
<div class="line"><span class="lineno"> 1380</span>    fprintf(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>, <span class="stringliteral">&quot;%02x&quot;</span>, response[i]);</div>
<div class="line"><span class="lineno"> 1381</span>  }</div>
<div class="line"><span class="lineno"> 1382</span> </div>
<div class="line"><span class="lineno"> 1383</span>  fprintf(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>, <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1384</span> </div>
<div class="line"><span class="lineno"> 1385</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1386</span>}</div>
<div class="ttc" id="ayubihsm_8c_html_a799e299be8d4c13dfa2112a60d05480d"><div class="ttname"><a href="yubihsm_8c.html#a799e299be8d4c13dfa2112a60d05480d">yh_send_plain_msg</a></div><div class="ttdeci">yh_rc yh_send_plain_msg(yh_connector *connector, yh_cmd cmd, const uint8_t *data, size_t data_len, yh_cmd *response_cmd, uint8_t *response, size_t *response_len)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l00126">yubihsm.c:126</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_a95d970cdea5162be25cac2a7f5c420ed_cgraph.png" border="0" usemap="#acommands_8c_a95d970cdea5162be25cac2a7f5c420ed_cgraph" alt=""/></div>
<map name="acommands_8c_a95d970cdea5162be25cac2a7f5c420ed_cgraph" id="acommands_8c_a95d970cdea5162be25cac2a7f5c420ed_cgraph">
<area shape="rect" title=" " alt="" coords="5,55,115,80"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="197,5,265,31"/>
<area shape="poly" title=" " alt="" coords="107,51,181,30,183,35,108,57"/>
<area shape="rect" href="yubihsm_8c.html#a799e299be8d4c13dfa2112a60d05480d" title=" " alt="" coords="163,55,299,80"/>
<area shape="poly" title=" " alt="" coords="115,65,147,65,147,70,115,70"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="347,104,430,130"/>
<area shape="poly" title=" " alt="" coords="110,78,163,90,252,103,332,110,331,116,251,108,162,95,109,84"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="353,55,424,80"/>
<area shape="poly" title=" " alt="" coords="299,65,337,65,337,70,299,70"/>
<area shape="poly" title=" " alt="" coords="275,78,333,97,332,102,274,84"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_a95d970cdea5162be25cac2a7f5c420ed_icgraph.png" border="0" usemap="#acommands_8c_a95d970cdea5162be25cac2a7f5c420ed_icgraph" alt=""/></div>
<map name="acommands_8c_a95d970cdea5162be25cac2a7f5c420ed_icgraph" id="acommands_8c_a95d970cdea5162be25cac2a7f5c420ed_icgraph">
<area shape="rect" title=" " alt="" coords="296,5,405,31"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="280,21,248,21,248,16,280,16"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,55,31"/>
<area shape="poly" title=" " alt="" coords="87,21,55,21,55,16,87,16"/>
</map>
</div>

</div>
</div>
<a id="a0abe95eb37069022ed341835938de103" name="a0abe95eb37069022ed341835938de103"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0abe95eb37069022ed341835938de103">&#9670;&#160;</a></span>yh_com_put_asymmetric()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int yh_com_put_asymmetric </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__context.html">yubihsm_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_argument.html">Argument</a> *</td>          <td class="paramname"><span class="paramname"><em>argv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a></td>          <td class="paramname"><span class="paramname"><em>fmt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="commands_8c_source.html#l01396">1396</a> of file <a class="el" href="commands_8c_source.html">commands.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1397</span>                                          {</div>
<div class="line"><span class="lineno"> 1398</span> </div>
<div class="line"><span class="lineno"> 1399</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ctx);</div>
<div class="line"><span class="lineno"> 1400</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(fmt);</div>
<div class="line"><span class="lineno"> 1401</span> </div>
<div class="line"><span class="lineno"> 1402</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> key[512];</div>
<div class="line"><span class="lineno"> 1403</span>  <span class="keywordtype">size_t</span> key_material_len = <span class="keyword">sizeof</span>(<a class="code hl_variable" href="yubico__otp_8c.html#a9246c20bb98ad2b4c60313c053c70f08">key</a>);</div>
<div class="line"><span class="lineno"> 1404</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55ca">yh_algorithm</a> <a class="code hl_variable" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>;</div>
<div class="line"><span class="lineno"> 1405</span> </div>
<div class="line"><span class="lineno"> 1406</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 1407</span> </div>
<div class="line"><span class="lineno"> 1408</span>  <span class="keywordtype">bool</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a3d854b6efad16a16e4d7b4539d4fc71f">ret</a> = <a class="code hl_function" href="util_8c.html#ae88d850a063cdc9ed3c114feab9af651">read_private_key</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[5].x, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[5].<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>, &amp;<a class="code hl_variable" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>, key,</div>
<div class="line"><span class="lineno"> 1409</span>                              &amp;key_material_len, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1410</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a3d854b6efad16a16e4d7b4539d4fc71f">ret</a> == <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 1411</span>    fprintf(stderr, <span class="stringliteral">&quot;Unable to read asymmetric key\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1412</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 1413</span>  }</div>
<div class="line"><span class="lineno"> 1414</span> </div>
<div class="line"><span class="lineno"> 1415</span>  <span class="keywordflow">switch</span> (<a class="code hl_variable" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>) {</div>
<div class="line"><span class="lineno"> 1416</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caaafe94e6a770edb51c6db84f77d98d2c6">YH_ALGO_RSA_2048</a>:</div>
<div class="line"><span class="lineno"> 1417</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caafd3fbd9ed86caf267ccc77cb24d44426">YH_ALGO_RSA_3072</a>:</div>
<div class="line"><span class="lineno"> 1418</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caae5963322a0a0f43a1b74faa78e3a7329">YH_ALGO_RSA_4096</a>:</div>
<div class="line"><span class="lineno"> 1419</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#ab0ca24007ce6942d2185859560c43e8a">yh_util_import_rsa_key</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e, &amp;<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].w, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[2].<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a>, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[3].w,</div>
<div class="line"><span class="lineno"> 1420</span>                                   &amp;<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[4].c, <a class="code hl_variable" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>, key,</div>
<div class="line"><span class="lineno"> 1421</span>                                   key + key_material_len / 2);</div>
<div class="line"><span class="lineno"> 1422</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1423</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caaedcbc07d82b18ca5c21eb3379a6cc010">YH_ALGO_EC_P224</a>:</div>
<div class="line"><span class="lineno"> 1424</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caae4b191baf5c65f9234120080264d129b">YH_ALGO_EC_P256</a>:</div>
<div class="line"><span class="lineno"> 1425</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa31094c17c66e4c365ca3dad353bc8bda">YH_ALGO_EC_P384</a>:</div>
<div class="line"><span class="lineno"> 1426</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa05aec903fd67851f968aaa606fe2138a">YH_ALGO_EC_P521</a>:</div>
<div class="line"><span class="lineno"> 1427</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caad423056b13955068935dc8b3ac0e65d1">YH_ALGO_EC_K256</a>:</div>
<div class="line"><span class="lineno"> 1428</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caabd995726d45b6dd2388775db4767c80d">YH_ALGO_EC_BP256</a>:</div>
<div class="line"><span class="lineno"> 1429</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa228fd3332b55c60438dfea6a1b09af36">YH_ALGO_EC_BP384</a>:</div>
<div class="line"><span class="lineno"> 1430</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caab9c1be17b7b3f755346ff8c3cca3ed25">YH_ALGO_EC_BP512</a>:</div>
<div class="line"><span class="lineno"> 1431</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#adc142d8f397eee024b3c145fa8abad85">yh_util_import_ec_key</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e, &amp;<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].w, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[2].<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a>, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[3].w,</div>
<div class="line"><span class="lineno"> 1432</span>                                  &amp;<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[4].c, <a class="code hl_variable" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>, key);</div>
<div class="line"><span class="lineno"> 1433</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1434</span> </div>
<div class="line"><span class="lineno"> 1435</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa68c2c97f16c36f727e41a899d8a7e8bd">YH_ALGO_EC_ED25519</a>:</div>
<div class="line"><span class="lineno"> 1436</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#a7a886e052bc1571f24c6b7f0c57e2d8c">yh_util_import_ed_key</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e, &amp;<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].w, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[2].<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a>, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[3].w,</div>
<div class="line"><span class="lineno"> 1437</span>                                  &amp;<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[4].c, <a class="code hl_variable" href="yubihsm_8h.html#a67bb26eddc39413f8e94c98aedbbd391">algorithm</a>, key);</div>
<div class="line"><span class="lineno"> 1438</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1439</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 1440</span>      fprintf(stderr, <span class="stringliteral">&quot;Unsupported algorithm\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1441</span>      <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 1442</span>  }</div>
<div class="line"><span class="lineno"> 1443</span> </div>
<div class="line"><span class="lineno"> 1444</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 1445</span>    fprintf(stderr, <span class="stringliteral">&quot;Failed to store asymmetric key: %s\n&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 1446</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 1447</span>  }</div>
<div class="line"><span class="lineno"> 1448</span> </div>
<div class="line"><span class="lineno"> 1449</span>  fprintf(stderr, <span class="stringliteral">&quot;Stored Asymmetric key 0x%04x\n&quot;</span>, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].w);</div>
<div class="line"><span class="lineno"> 1450</span> </div>
<div class="line"><span class="lineno"> 1451</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1452</span>}</div>
<div class="ttc" id="autil_8c_html_ae88d850a063cdc9ed3c114feab9af651"><div class="ttname"><a href="util_8c.html#ae88d850a063cdc9ed3c114feab9af651">read_private_key</a></div><div class="ttdeci">bool read_private_key(uint8_t *buf, size_t len, yh_algorithm *algo, uint8_t *bytes, size_t *bytes_len, bool internal_repr)</div><div class="ttdef"><b>Definition</b> <a href="util_8c_source.html#l00116">util.c:116</a></div></div>
<div class="ttc" id="ayubico__otp_8c_html_a9246c20bb98ad2b4c60313c053c70f08"><div class="ttname"><a href="yubico__otp_8c.html#a9246c20bb98ad2b4c60313c053c70f08">key</a></div><div class="ttdeci">uint8_t key[16]</div><div class="ttdef"><b>Definition</b> <a href="yubico__otp_8c_source.html#l00041">yubico_otp.c:41</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_a7a886e052bc1571f24c6b7f0c57e2d8c"><div class="ttname"><a href="yubihsm_8c.html#a7a886e052bc1571f24c6b7f0c57e2d8c">yh_util_import_ed_key</a></div><div class="ttdeci">yh_rc yh_util_import_ed_key(yh_session *session, uint16_t *key_id, const char *label, uint16_t domains, const yh_capabilities *capabilities, yh_algorithm algorithm, const uint8_t *k)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l01727">yubihsm.c:1727</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_ab0ca24007ce6942d2185859560c43e8a"><div class="ttname"><a href="yubihsm_8c.html#ab0ca24007ce6942d2185859560c43e8a">yh_util_import_rsa_key</a></div><div class="ttdeci">yh_rc yh_util_import_rsa_key(yh_session *session, uint16_t *key_id, const char *label, uint16_t domains, const yh_capabilities *capabilities, yh_algorithm algorithm, const uint8_t *p, const uint8_t *q)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l01655">yubihsm.c:1655</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_adc142d8f397eee024b3c145fa8abad85"><div class="ttname"><a href="yubihsm_8c.html#adc142d8f397eee024b3c145fa8abad85">yh_util_import_ec_key</a></div><div class="ttdeci">yh_rc yh_util_import_ec_key(yh_session *session, uint16_t *key_id, const char *label, uint16_t domains, const yh_capabilities *capabilities, yh_algorithm algorithm, const uint8_t *s)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l01689">yubihsm.c:1689</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_a0abe95eb37069022ed341835938de103_cgraph.png" border="0" usemap="#acommands_8c_a0abe95eb37069022ed341835938de103_cgraph" alt=""/></div>
<map name="acommands_8c_a0abe95eb37069022ed341835938de103_cgraph" id="acommands_8c_a0abe95eb37069022ed341835938de103_cgraph">
<area shape="rect" title=" " alt="" coords="5,204,173,230"/>
<area shape="rect" href="util_8c.html#ae88d850a063cdc9ed3c114feab9af651" title=" " alt="" coords="238,103,358,128"/>
<area shape="poly" title=" " alt="" coords="113,201,220,145,248,132,250,137,222,150,115,206"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="459,252,542,278"/>
<area shape="poly" title=" " alt="" coords="125,201,176,186,240,174,309,173,344,178,377,189,394,200,403,213,412,226,425,239,445,248,443,253,423,243,407,230,399,216,390,204,375,194,343,184,309,178,241,180,177,191,127,206"/>
<area shape="rect" href="yubihsm_8c.html#adc142d8f397eee024b3c145fa8abad85" title=" " alt="" coords="223,204,374,230"/>
<area shape="poly" title=" " alt="" coords="173,214,207,214,207,220,173,220"/>
<area shape="rect" href="yubihsm_8c.html#a7a886e052bc1571f24c6b7f0c57e2d8c" title=" " alt="" coords="223,253,374,279"/>
<area shape="poly" title=" " alt="" coords="147,228,226,247,225,252,146,233"/>
<area shape="rect" href="yubihsm_8c.html#ab0ca24007ce6942d2185859560c43e8a" title=" " alt="" coords="221,303,376,328"/>
<area shape="poly" title=" " alt="" coords="112,228,161,258,222,289,236,295,234,300,220,294,158,263,109,232"/>
<area shape="rect" href="util_8c.html#a7b6341d8eb3648b8fd1c33f74deddff7" title=" " alt="" coords="436,104,566,130"/>
<area shape="poly" title=" " alt="" coords="359,113,420,114,420,119,359,119"/>
<area shape="rect" href="openssl-compat_8c.html#a4f4b9ece6db658890011cfcf730d18f1" title=" " alt="" coords="424,153,577,179"/>
<area shape="poly" title=" " alt="" coords="353,126,432,146,431,152,352,132"/>
<area shape="rect" href="openssl-compat_8c.html#ad0eaa8f2e87045d4abd7b3fc94ab4694" title=" " alt="" coords="436,203,565,228"/>
<area shape="poly" title=" " alt="" coords="340,127,377,145,392,157,402,168,411,179,425,189,434,194,432,199,423,194,408,183,398,172,388,161,375,150,338,131"/>
<area shape="rect" href="openssl-compat_8c.html#a96e6deebb87bafb81f7bde3df63e59f3" title=" " alt="" coords="446,5,555,31"/>
<area shape="poly" title=" " alt="" coords="318,100,365,70,423,40,437,34,439,39,425,45,367,75,321,104"/>
<area shape="rect" href="util_8c.html#ab5b6fbe2bcd184aaefd83f06e0eb022a" title=" " alt="" coords="446,55,556,80"/>
<area shape="poly" title=" " alt="" coords="355,99,430,82,431,87,356,105"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="625,203,697,228"/>
<area shape="poly" title=" " alt="" coords="555,128,579,139,612,163,640,189,636,193,609,167,576,143,553,133"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="627,55,695,80"/>
<area shape="poly" title=" " alt="" coords="556,65,611,65,611,70,556,70"/>
<area shape="poly" title=" " alt="" coords="356,228,445,249,444,254,355,233"/>
<area shape="poly" title=" " alt="" coords="375,263,444,263,444,268,375,268"/>
<area shape="poly" title=" " alt="" coords="377,319,423,318,474,314,527,304,576,288,611,265,638,238,642,242,614,270,578,293,528,310,475,319,423,324,377,324"/>
<area shape="poly" title=" " alt="" coords="352,299,443,276,445,281,353,305"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_a0abe95eb37069022ed341835938de103_icgraph.png" border="0" usemap="#acommands_8c_a0abe95eb37069022ed341835938de103_icgraph" alt=""/></div>
<map name="acommands_8c_a0abe95eb37069022ed341835938de103_icgraph" id="acommands_8c_a0abe95eb37069022ed341835938de103_icgraph">
<area shape="rect" title=" " alt="" coords="296,31,463,56"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="280,34,248,30,249,25,281,29"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,31,55,56"/>
<area shape="poly" title=" " alt="" coords="281,46,55,46,55,41,281,41"/>
<area shape="poly" title=" " alt="" coords="88,36,55,42,54,37,87,31"/>
</map>
</div>

</div>
</div>
<a id="a3bd17c302789958013e50a2ad9738aea" name="a3bd17c302789958013e50a2ad9738aea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3bd17c302789958013e50a2ad9738aea">&#9670;&#160;</a></span>yh_com_put_authentication()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int yh_com_put_authentication </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__context.html">yubihsm_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_argument.html">Argument</a> *</td>          <td class="paramname"><span class="paramname"><em>argv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a></td>          <td class="paramname"><span class="paramname"><em>fmt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="commands_8c_source.html#l01463">1463</a> of file <a class="el" href="commands_8c_source.html">commands.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1464</span>                                              {</div>
<div class="line"><span class="lineno"> 1465</span> </div>
<div class="line"><span class="lineno"> 1466</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ctx);</div>
<div class="line"><span class="lineno"> 1467</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(fmt);</div>
<div class="line"><span class="lineno"> 1468</span> </div>
<div class="line"><span class="lineno"> 1469</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 1470</span> </div>
<div class="line"><span class="lineno"> 1471</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> =</div>
<div class="line"><span class="lineno"> 1472</span>    <a class="code hl_function" href="yubihsm_8c.html#a80b4c4caeb9c768737c2dbf46d9352e4">yh_util_import_authentication_key_derived</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e, &amp;<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].w, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[2].<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a>,</div>
<div class="line"><span class="lineno"> 1473</span>                                              <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[3].w, &amp;<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[4].c, &amp;<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[5].c,</div>
<div class="line"><span class="lineno"> 1474</span>                                              <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[6].x, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[6].<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>);</div>
<div class="line"><span class="lineno"> 1475</span>  <a class="code hl_define" href="insecure__memzero_8h.html#a0794f9275fd1036ecba6ff0a901a320b">insecure_memzero</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[6].x, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[6].<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>);</div>
<div class="line"><span class="lineno"> 1476</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 1477</span>    fprintf(stderr, <span class="stringliteral">&quot;Failed to store authkey: %s\n&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 1478</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 1479</span>  }</div>
<div class="line"><span class="lineno"> 1480</span> </div>
<div class="line"><span class="lineno"> 1481</span>  fprintf(stderr, <span class="stringliteral">&quot;Stored Authentication key 0x%04x\n&quot;</span>, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].w);</div>
<div class="line"><span class="lineno"> 1482</span> </div>
<div class="line"><span class="lineno"> 1483</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1484</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_a3bd17c302789958013e50a2ad9738aea_cgraph.png" border="0" usemap="#acommands_8c_a3bd17c302789958013e50a2ad9738aea_cgraph" alt=""/></div>
<map name="acommands_8c_a3bd17c302789958013e50a2ad9738aea_cgraph" id="acommands_8c_a3bd17c302789958013e50a2ad9738aea_cgraph">
<area shape="rect" title=" " alt="" coords="5,203,186,228"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="1158,180,1241,206"/>
<area shape="poly" title=" " alt="" coords="186,221,368,234,580,241,814,241,904,237,994,227,1142,202,1143,207,995,232,905,242,814,246,580,246,368,239,186,226"/>
<area shape="rect" href="yubihsm_8c.html#a80b4c4caeb9c768737c2dbf46d9352e4" title=" " alt="" coords="234,166,424,206"/>
<area shape="poly" title=" " alt="" coords="186,202,218,197,218,203,186,207"/>
<area shape="poly" title=" " alt="" coords="425,199,656,232,795,248,935,260,1019,270,1055,270,1099,260,1139,240,1173,214,1176,218,1142,244,1101,265,1055,275,1018,275,934,265,795,253,656,237,424,204"/>
<area shape="rect" href="yubihsm_8c.html#ac154da7ac6dc0a7b4b3a6cdff9433da8" title=" " alt="" coords="472,105,690,131"/>
<area shape="poly" title=" " alt="" coords="406,163,515,133,516,138,408,168"/>
<area shape="poly" title=" " alt="" coords="662,129,739,141,963,168,1143,185,1142,191,962,173,738,146,661,134"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="1164,80,1235,106"/>
<area shape="poly" title=" " alt="" coords="662,102,738,90,919,61,999,57,1100,65,1150,75,1149,80,1100,70,998,62,919,67,739,95,663,107"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="1166,5,1234,31"/>
<area shape="poly" title=" " alt="" coords="612,102,670,80,738,60,853,39,967,26,1150,16,1150,22,968,32,853,44,739,65,671,85,614,107"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="738,105,887,131"/>
<area shape="poly" title=" " alt="" coords="691,116,723,116,723,121,691,121"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="935,80,1100,106"/>
<area shape="poly" title=" " alt="" coords="886,106,919,102,919,108,887,112"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="952,129,1082,155"/>
<area shape="poly" title=" " alt="" coords="887,124,937,130,937,135,887,129"/>
<area shape="poly" title=" " alt="" coords="1079,104,1101,115,1117,127,1127,140,1136,152,1150,165,1156,170,1153,174,1146,170,1132,156,1122,143,1113,131,1099,119,1077,109"/>
<area shape="poly" title=" " alt="" coords="1101,90,1148,90,1148,96,1101,96"/>
<area shape="poly" title=" " alt="" coords="1050,77,1151,35,1153,40,1052,82"/>
<area shape="poly" title=" " alt="" coords="1067,153,1144,175,1142,180,1066,158"/>
<area shape="poly" title=" " alt="" coords="1067,126,1148,104,1150,109,1068,131"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="1148,129,1251,155"/>
<area shape="poly" title=" " alt="" coords="1083,140,1132,140,1132,145,1083,145"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_a3bd17c302789958013e50a2ad9738aea_icgraph.png" border="0" usemap="#acommands_8c_a3bd17c302789958013e50a2ad9738aea_icgraph" alt=""/></div>
<map name="acommands_8c_a3bd17c302789958013e50a2ad9738aea_icgraph" id="acommands_8c_a3bd17c302789958013e50a2ad9738aea_icgraph">
<area shape="rect" title=" " alt="" coords="296,31,476,56"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="280,33,248,30,249,24,281,28"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,31,55,56"/>
<area shape="poly" title=" " alt="" coords="280,46,55,46,55,41,280,41"/>
<area shape="poly" title=" " alt="" coords="88,36,55,42,54,37,87,31"/>
</map>
</div>

</div>
</div>
<a id="aed17eea0c4eb877cd1097fbcd8e8e5d0" name="aed17eea0c4eb877cd1097fbcd8e8e5d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed17eea0c4eb877cd1097fbcd8e8e5d0">&#9670;&#160;</a></span>yh_com_put_hmac()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int yh_com_put_hmac </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__context.html">yubihsm_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_argument.html">Argument</a> *</td>          <td class="paramname"><span class="paramname"><em>argv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a></td>          <td class="paramname"><span class="paramname"><em>fmt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="commands_8c_source.html#l01544">1544</a> of file <a class="el" href="commands_8c_source.html">commands.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1544</span>                                                                          {</div>
<div class="line"><span class="lineno"> 1545</span> </div>
<div class="line"><span class="lineno"> 1546</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ctx);</div>
<div class="line"><span class="lineno"> 1547</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(fmt);</div>
<div class="line"><span class="lineno"> 1548</span> </div>
<div class="line"><span class="lineno"> 1549</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 1550</span> </div>
<div class="line"><span class="lineno"> 1551</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[6].<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> &gt; 128) {</div>
<div class="line"><span class="lineno"> 1552</span>    fprintf(stderr, <span class="stringliteral">&quot;Too long key supplied, max 128 bytes allowed\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1553</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 1554</span>  }</div>
<div class="line"><span class="lineno"> 1555</span> </div>
<div class="line"><span class="lineno"> 1556</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#a19c79faaf10c405864f0179821d551a5">yh_util_import_hmac_key</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e, &amp;<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].w, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[2].<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a>, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[3].w,</div>
<div class="line"><span class="lineno"> 1557</span>                                &amp;<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[4].c, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[5].<a class="code hl_variable" href="pointer_8h.html#aeeddce917cf130d62c370b8f216026dd">a</a>, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[6].x, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[6].<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>);</div>
<div class="line"><span class="lineno"> 1558</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 1559</span>    fprintf(stderr, <span class="stringliteral">&quot;Failed to store HMAC key: %s\n&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 1560</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 1561</span>  }</div>
<div class="line"><span class="lineno"> 1562</span> </div>
<div class="line"><span class="lineno"> 1563</span>  fprintf(stderr, <span class="stringliteral">&quot;Stored HMAC key 0x%04x\n&quot;</span>, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].w);</div>
<div class="line"><span class="lineno"> 1564</span> </div>
<div class="line"><span class="lineno"> 1565</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1566</span>}</div>
<div class="ttc" id="ayubihsm_8c_html_a19c79faaf10c405864f0179821d551a5"><div class="ttname"><a href="yubihsm_8c.html#a19c79faaf10c405864f0179821d551a5">yh_util_import_hmac_key</a></div><div class="ttdeci">yh_rc yh_util_import_hmac_key(yh_session *session, uint16_t *key_id, const char *label, uint16_t domains, const yh_capabilities *capabilities, yh_algorithm algorithm, const uint8_t *key, size_t key_len)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l01750">yubihsm.c:1750</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_aed17eea0c4eb877cd1097fbcd8e8e5d0_cgraph.png" border="0" usemap="#acommands_8c_aed17eea0c4eb877cd1097fbcd8e8e5d0_cgraph" alt=""/></div>
<map name="acommands_8c_aed17eea0c4eb877cd1097fbcd8e8e5d0_cgraph" id="acommands_8c_aed17eea0c4eb877cd1097fbcd8e8e5d0_cgraph">
<area shape="rect" title=" " alt="" coords="5,180,137,206"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="822,179,905,204"/>
<area shape="poly" title=" " alt="" coords="137,190,806,189,806,194,137,195"/>
<area shape="rect" href="yubihsm_8c.html#a19c79faaf10c405864f0179821d551a5" title=" " alt="" coords="185,105,354,131"/>
<area shape="poly" title=" " alt="" coords="106,177,218,135,219,140,108,182"/>
<area shape="poly" title=" " alt="" coords="336,129,402,141,626,169,806,185,806,190,625,174,402,146,335,134"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="828,80,899,106"/>
<area shape="poly" title=" " alt="" coords="336,102,402,90,582,60,662,57,764,65,814,75,813,80,763,70,662,62,583,66,402,95,337,107"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="829,5,898,31"/>
<area shape="poly" title=" " alt="" coords="294,102,343,80,401,60,516,37,631,24,734,17,814,15,814,21,735,23,632,29,517,42,403,65,345,85,297,107"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="402,105,550,131"/>
<area shape="poly" title=" " alt="" coords="354,116,386,116,386,121,354,121"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="598,80,764,106"/>
<area shape="poly" title=" " alt="" coords="550,106,582,102,583,108,551,112"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="616,129,746,155"/>
<area shape="poly" title=" " alt="" coords="551,124,601,130,600,135,550,129"/>
<area shape="poly" title=" " alt="" coords="743,104,765,115,781,127,790,140,799,152,813,165,818,169,815,173,810,170,795,156,786,143,777,131,762,119,741,109"/>
<area shape="poly" title=" " alt="" coords="764,90,812,90,812,96,764,96"/>
<area shape="poly" title=" " alt="" coords="713,77,815,35,817,40,715,82"/>
<area shape="poly" title=" " alt="" coords="732,153,807,174,806,179,731,158"/>
<area shape="poly" title=" " alt="" coords="731,126,812,104,813,109,732,131"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="812,129,915,155"/>
<area shape="poly" title=" " alt="" coords="747,140,796,140,796,145,747,145"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_aed17eea0c4eb877cd1097fbcd8e8e5d0_icgraph.png" border="0" usemap="#acommands_8c_aed17eea0c4eb877cd1097fbcd8e8e5d0_icgraph" alt=""/></div>
<map name="acommands_8c_aed17eea0c4eb877cd1097fbcd8e8e5d0_icgraph" id="acommands_8c_aed17eea0c4eb877cd1097fbcd8e8e5d0_icgraph">
<area shape="rect" title=" " alt="" coords="296,5,427,31"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="280,21,248,21,248,16,280,16"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,55,31"/>
<area shape="poly" title=" " alt="" coords="87,21,55,21,55,16,87,16"/>
</map>
</div>

</div>
</div>
<a id="a2be40cf6e90d80392d7aa5e291660f65" name="a2be40cf6e90d80392d7aa5e291660f65"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2be40cf6e90d80392d7aa5e291660f65">&#9670;&#160;</a></span>yh_com_put_opaque()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int yh_com_put_opaque </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__context.html">yubihsm_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_argument.html">Argument</a> *</td>          <td class="paramname"><span class="paramname"><em>argv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a></td>          <td class="paramname"><span class="paramname"><em>fmt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="commands_8c_source.html#l01495">1495</a> of file <a class="el" href="commands_8c_source.html">commands.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1495</span>                                                                            {</div>
<div class="line"><span class="lineno"> 1496</span> </div>
<div class="line"><span class="lineno"> 1497</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 1498</span> </div>
<div class="line"><span class="lineno"> 1499</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ctx);</div>
<div class="line"><span class="lineno"> 1500</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(fmt);</div>
<div class="line"><span class="lineno"> 1501</span> </div>
<div class="line"><span class="lineno"> 1502</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#a1249c920eec24f634d04eaafb90a1ca2">yh_util_import_opaque</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e, &amp;<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].w, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[2].<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a>, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[3].w,</div>
<div class="line"><span class="lineno"> 1503</span>                              &amp;<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[4].c, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[5].<a class="code hl_variable" href="pointer_8h.html#aeeddce917cf130d62c370b8f216026dd">a</a>, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[6].x, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[6].<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>);</div>
<div class="line"><span class="lineno"> 1504</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 1505</span>    fprintf(stderr, <span class="stringliteral">&quot;Failed to store opaque object: %s\n&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 1506</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 1507</span>  }</div>
<div class="line"><span class="lineno"> 1508</span> </div>
<div class="line"><span class="lineno"> 1509</span>  fprintf(stderr, <span class="stringliteral">&quot;Stored Opaque object 0x%04x\n&quot;</span>, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].w);</div>
<div class="line"><span class="lineno"> 1510</span> </div>
<div class="line"><span class="lineno"> 1511</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1512</span>}</div>
<div class="ttc" id="ayubihsm_8c_html_a1249c920eec24f634d04eaafb90a1ca2"><div class="ttname"><a href="yubihsm_8c.html#a1249c920eec24f634d04eaafb90a1ca2">yh_util_import_opaque</a></div><div class="ttdeci">yh_rc yh_util_import_opaque(yh_session *session, uint16_t *object_id, const char *label, uint16_t domains, const yh_capabilities *capabilities, yh_algorithm algorithm, const uint8_t *in, size_t in_len)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l02666">yubihsm.c:2666</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_a2be40cf6e90d80392d7aa5e291660f65_cgraph.png" border="0" usemap="#acommands_8c_a2be40cf6e90d80392d7aa5e291660f65_cgraph" alt=""/></div>
<map name="acommands_8c_a2be40cf6e90d80392d7aa5e291660f65_cgraph" id="acommands_8c_a2be40cf6e90d80392d7aa5e291660f65_cgraph">
<area shape="rect" title=" " alt="" coords="5,180,147,206"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="814,179,897,204"/>
<area shape="poly" title=" " alt="" coords="147,190,798,189,798,194,147,195"/>
<area shape="rect" href="yubihsm_8c.html#a1249c920eec24f634d04eaafb90a1ca2" title=" " alt="" coords="195,105,346,131"/>
<area shape="poly" title=" " alt="" coords="111,177,219,135,221,140,113,182"/>
<area shape="poly" title=" " alt="" coords="332,129,394,141,618,170,798,185,798,190,617,175,394,146,331,134"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="820,80,891,106"/>
<area shape="poly" title=" " alt="" coords="331,102,394,90,495,72,574,60,654,56,756,65,806,75,805,80,755,70,654,62,575,65,496,77,394,95,332,107"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="821,5,890,31"/>
<area shape="poly" title=" " alt="" coords="293,102,338,79,393,58,508,35,623,21,726,16,806,15,806,20,726,21,623,27,508,40,395,63,340,84,295,107"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="394,105,542,131"/>
<area shape="poly" title=" " alt="" coords="347,116,379,116,379,121,347,121"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="590,80,756,106"/>
<area shape="poly" title=" " alt="" coords="542,106,574,102,575,108,543,112"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="608,129,738,155"/>
<area shape="poly" title=" " alt="" coords="543,124,593,130,592,135,542,129"/>
<area shape="poly" title=" " alt="" coords="735,104,757,115,773,127,782,140,791,152,805,165,810,169,807,173,802,170,787,156,778,143,769,131,754,119,733,109"/>
<area shape="poly" title=" " alt="" coords="756,90,804,90,804,96,756,96"/>
<area shape="poly" title=" " alt="" coords="705,77,807,35,809,40,707,82"/>
<area shape="poly" title=" " alt="" coords="724,153,799,174,798,179,723,158"/>
<area shape="poly" title=" " alt="" coords="723,126,804,104,805,109,724,131"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="804,129,907,155"/>
<area shape="poly" title=" " alt="" coords="739,140,788,140,788,145,739,145"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_a2be40cf6e90d80392d7aa5e291660f65_icgraph.png" border="0" usemap="#acommands_8c_a2be40cf6e90d80392d7aa5e291660f65_icgraph" alt=""/></div>
<map name="acommands_8c_a2be40cf6e90d80392d7aa5e291660f65_icgraph" id="acommands_8c_a2be40cf6e90d80392d7aa5e291660f65_icgraph">
<area shape="rect" title=" " alt="" coords="296,31,437,56"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="280,35,248,30,249,25,281,29"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,31,55,56"/>
<area shape="poly" title=" " alt="" coords="281,46,55,46,55,41,281,41"/>
<area shape="poly" title=" " alt="" coords="88,36,55,42,54,37,87,31"/>
</map>
</div>

</div>
</div>
<a id="ae400ec3fdd83a82b3c08dd7106c516b9" name="ae400ec3fdd83a82b3c08dd7106c516b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae400ec3fdd83a82b3c08dd7106c516b9">&#9670;&#160;</a></span>yh_com_put_option()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int yh_com_put_option </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__context.html">yubihsm_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_argument.html">Argument</a> *</td>          <td class="paramname"><span class="paramname"><em>argv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a></td>          <td class="paramname"><span class="paramname"><em>fmt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="commands_8c_source.html#l01519">1519</a> of file <a class="el" href="commands_8c_source.html">commands.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1519</span>                                                                            {</div>
<div class="line"><span class="lineno"> 1520</span> </div>
<div class="line"><span class="lineno"> 1521</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ctx);</div>
<div class="line"><span class="lineno"> 1522</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(fmt);</div>
<div class="line"><span class="lineno"> 1523</span> </div>
<div class="line"><span class="lineno"> 1524</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 1525</span> </div>
<div class="line"><span class="lineno"> 1526</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#a85ac840aec77cb1ca3c3ce1f2ab26282">yh_util_set_option</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].o, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[2].<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[2].x);</div>
<div class="line"><span class="lineno"> 1527</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 1528</span>    fprintf(stderr, <span class="stringliteral">&quot;Failed to store option: %s\n&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 1529</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 1530</span>  }</div>
<div class="line"><span class="lineno"> 1531</span> </div>
<div class="line"><span class="lineno"> 1532</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1533</span>}</div>
<div class="ttc" id="ayubihsm_8c_html_a85ac840aec77cb1ca3c3ce1f2ab26282"><div class="ttname"><a href="yubihsm_8c.html#a85ac840aec77cb1ca3c3ce1f2ab26282">yh_util_set_option</a></div><div class="ttdeci">yh_rc yh_util_set_option(yh_session *session, yh_option option, size_t len, uint8_t *val)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l03537">yubihsm.c:3537</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_ae400ec3fdd83a82b3c08dd7106c516b9_cgraph.png" border="0" usemap="#acommands_8c_ae400ec3fdd83a82b3c08dd7106c516b9_cgraph" alt=""/></div>
<map name="acommands_8c_ae400ec3fdd83a82b3c08dd7106c516b9_cgraph" id="acommands_8c_ae400ec3fdd83a82b3c08dd7106c516b9_cgraph">
<area shape="rect" title=" " alt="" coords="5,7,140,33"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="782,9,865,34"/>
<area shape="poly" title=" " alt="" coords="140,13,396,4,559,3,724,8,766,12,766,17,724,13,559,9,396,9,140,19"/>
<area shape="rect" href="yubihsm_8c.html#a85ac840aec77cb1ca3c3ce1f2ab26282" title=" " alt="" coords="188,33,314,58"/>
<area shape="poly" title=" " alt="" coords="141,27,173,32,172,37,140,32"/>
<area shape="poly" title=" " alt="" coords="314,40,766,21,766,26,314,45"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="788,107,859,133"/>
<area shape="poly" title=" " alt="" coords="279,56,363,94,461,127,540,146,621,151,723,143,773,133,774,138,724,148,621,157,539,151,460,132,361,99,277,61"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="362,58,510,84"/>
<area shape="poly" title=" " alt="" coords="315,51,347,56,346,61,314,57"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="558,58,724,84"/>
<area shape="poly" title=" " alt="" coords="510,68,543,68,543,73,510,73"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="576,107,706,133"/>
<area shape="poly" title=" " alt="" coords="493,82,570,100,569,106,492,87"/>
<area shape="poly" title=" " alt="" coords="691,55,766,34,767,39,692,60"/>
<area shape="poly" title=" " alt="" coords="692,82,773,104,772,109,691,87"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="789,58,858,84"/>
<area shape="poly" title=" " alt="" coords="724,68,774,68,774,73,724,73"/>
<area shape="poly" title=" " alt="" coords="701,104,722,94,737,82,746,70,755,57,770,43,775,40,778,44,773,48,759,61,750,73,741,86,725,98,703,109"/>
<area shape="poly" title=" " alt="" coords="707,117,773,117,773,123,707,123"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="772,157,875,182"/>
<area shape="poly" title=" " alt="" coords="692,131,759,149,757,154,691,136"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_ae400ec3fdd83a82b3c08dd7106c516b9_icgraph.png" border="0" usemap="#acommands_8c_ae400ec3fdd83a82b3c08dd7106c516b9_icgraph" alt=""/></div>
<map name="acommands_8c_ae400ec3fdd83a82b3c08dd7106c516b9_icgraph" id="acommands_8c_ae400ec3fdd83a82b3c08dd7106c516b9_icgraph">
<area shape="rect" title=" " alt="" coords="296,5,430,31"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="280,21,248,21,248,16,280,16"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,55,31"/>
<area shape="poly" title=" " alt="" coords="87,21,55,21,55,16,87,16"/>
</map>
</div>

</div>
</div>
<a id="a7ef84380bc19536e4ba9bf62fd44ba93" name="a7ef84380bc19536e4ba9bf62fd44ba93"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ef84380bc19536e4ba9bf62fd44ba93">&#9670;&#160;</a></span>yh_com_put_otp_aead_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int yh_com_put_otp_aead_key </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__context.html">yubihsm_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_argument.html">Argument</a> *</td>          <td class="paramname"><span class="paramname"><em>argv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a></td>          <td class="paramname"><span class="paramname"><em>fmt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="commands_8c_source.html#l02612">2612</a> of file <a class="el" href="commands_8c_source.html">commands.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2613</span>                                            {</div>
<div class="line"><span class="lineno"> 2614</span> </div>
<div class="line"><span class="lineno"> 2615</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ctx);</div>
<div class="line"><span class="lineno"> 2616</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(fmt);</div>
<div class="line"><span class="lineno"> 2617</span> </div>
<div class="line"><span class="lineno"> 2618</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 2619</span> </div>
<div class="line"><span class="lineno"> 2620</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[6].<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> != 16 &amp;&amp; <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[6].<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> != 24 &amp;&amp; <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[6].<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> != 32) {</div>
<div class="line"><span class="lineno"> 2621</span>    fprintf(stderr, <span class="stringliteral">&quot;Key length (%zu) not matching, should be 16, 24 or 32\n&quot;</span>,</div>
<div class="line"><span class="lineno"> 2622</span>            <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[6].<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>);</div>
<div class="line"><span class="lineno"> 2623</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 2624</span>  }</div>
<div class="line"><span class="lineno"> 2625</span> </div>
<div class="line"><span class="lineno"> 2626</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> =</div>
<div class="line"><span class="lineno"> 2627</span>    <a class="code hl_function" href="yubihsm_8c.html#addc22271306d847f53321984f41d818b">yh_util_import_otp_aead_key</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e, &amp;<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].w, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[2].<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a>, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[3].w,</div>
<div class="line"><span class="lineno"> 2628</span>                                &amp;<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[4].c, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[5].d, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[6].x, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[6].<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>);</div>
<div class="line"><span class="lineno"> 2629</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 2630</span>    fprintf(stderr, <span class="stringliteral">&quot;Failed to store OTP AEAD key: %s\n&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 2631</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 2632</span>  }</div>
<div class="line"><span class="lineno"> 2633</span> </div>
<div class="line"><span class="lineno"> 2634</span>  fprintf(stderr, <span class="stringliteral">&quot;Stored OTP AEAD key 0x%04x\n&quot;</span>, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].w);</div>
<div class="line"><span class="lineno"> 2635</span> </div>
<div class="line"><span class="lineno"> 2636</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 2637</span>}</div>
<div class="ttc" id="ayubihsm_8c_html_addc22271306d847f53321984f41d818b"><div class="ttname"><a href="yubihsm_8c.html#addc22271306d847f53321984f41d818b">yh_util_import_otp_aead_key</a></div><div class="ttdeci">yh_rc yh_util_import_otp_aead_key(yh_session *session, uint16_t *key_id, const char *label, uint16_t domains, const yh_capabilities *capabilities, uint32_t nonce_id, const uint8_t *in, size_t in_len)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l03337">yubihsm.c:3337</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_a7ef84380bc19536e4ba9bf62fd44ba93_cgraph.png" border="0" usemap="#acommands_8c_a7ef84380bc19536e4ba9bf62fd44ba93_cgraph" alt=""/></div>
<map name="acommands_8c_a7ef84380bc19536e4ba9bf62fd44ba93_cgraph" id="acommands_8c_a7ef84380bc19536e4ba9bf62fd44ba93_cgraph">
<area shape="rect" title=" " alt="" coords="5,180,186,206"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="829,179,912,204"/>
<area shape="poly" title=" " alt="" coords="186,190,813,189,813,194,186,195"/>
<area shape="rect" href="yubihsm_8c.html#addc22271306d847f53321984f41d818b" title=" " alt="" coords="234,98,361,138"/>
<area shape="poly" title=" " alt="" coords="132,177,225,142,227,147,133,182"/>
<area shape="poly" title=" " alt="" coords="362,131,409,141,521,158,633,171,813,186,813,191,632,176,520,163,409,146,361,136"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="835,80,906,106"/>
<area shape="poly" title=" " alt="" coords="361,100,442,83,545,67,658,59,715,60,771,65,821,75,820,80,770,70,715,65,658,65,545,73,443,88,362,105"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="836,5,904,31"/>
<area shape="poly" title=" " alt="" coords="330,95,367,76,408,60,522,35,637,21,741,15,821,14,821,20,741,20,638,26,523,40,410,65,369,81,333,100"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="409,105,557,131"/>
<area shape="poly" title=" " alt="" coords="361,116,394,116,394,121,361,121"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="605,80,771,106"/>
<area shape="poly" title=" " alt="" coords="557,106,589,102,590,108,558,112"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="623,129,753,155"/>
<area shape="poly" title=" " alt="" coords="558,124,608,130,607,135,557,129"/>
<area shape="poly" title=" " alt="" coords="750,104,772,115,788,127,797,140,806,152,820,165,825,169,822,173,817,170,802,156,793,143,784,131,769,119,748,109"/>
<area shape="poly" title=" " alt="" coords="771,90,819,90,819,96,771,96"/>
<area shape="poly" title=" " alt="" coords="720,77,822,35,824,40,722,82"/>
<area shape="poly" title=" " alt="" coords="739,153,814,174,813,179,738,158"/>
<area shape="poly" title=" " alt="" coords="738,126,819,104,820,109,739,131"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="819,129,922,155"/>
<area shape="poly" title=" " alt="" coords="754,140,803,140,803,145,754,145"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_a7ef84380bc19536e4ba9bf62fd44ba93_icgraph.png" border="0" usemap="#acommands_8c_a7ef84380bc19536e4ba9bf62fd44ba93_icgraph" alt=""/></div>
<map name="acommands_8c_a7ef84380bc19536e4ba9bf62fd44ba93_icgraph" id="acommands_8c_a7ef84380bc19536e4ba9bf62fd44ba93_icgraph">
<area shape="rect" title=" " alt="" coords="296,5,476,31"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="280,21,249,21,249,16,280,16"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,55,31"/>
<area shape="poly" title=" " alt="" coords="87,21,55,21,55,16,87,16"/>
</map>
</div>

</div>
</div>
<a id="ad1629b955c1d718c65f137c9df3b3332" name="ad1629b955c1d718c65f137c9df3b3332"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad1629b955c1d718c65f137c9df3b3332">&#9670;&#160;</a></span>yh_com_put_template()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int yh_com_put_template </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__context.html">yubihsm_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_argument.html">Argument</a> *</td>          <td class="paramname"><span class="paramname"><em>argv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a></td>          <td class="paramname"><span class="paramname"><em>fmt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="commands_8c_source.html#l01645">1645</a> of file <a class="el" href="commands_8c_source.html">commands.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1645</span>                                                                              {</div>
<div class="line"><span class="lineno"> 1646</span> </div>
<div class="line"><span class="lineno"> 1647</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 1648</span> </div>
<div class="line"><span class="lineno"> 1649</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ctx);</div>
<div class="line"><span class="lineno"> 1650</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(fmt);</div>
<div class="line"><span class="lineno"> 1651</span> </div>
<div class="line"><span class="lineno"> 1652</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#ae0fc8d6520950868365011d1a9f450f1">yh_util_import_template</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e, &amp;<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].w, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[2].<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a>, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[3].w,</div>
<div class="line"><span class="lineno"> 1653</span>                                &amp;<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[4].c, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[5].<a class="code hl_variable" href="pointer_8h.html#aeeddce917cf130d62c370b8f216026dd">a</a>, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[6].x, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[6].<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>);</div>
<div class="line"><span class="lineno"> 1654</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 1655</span>    fprintf(stderr, <span class="stringliteral">&quot;Failed to store template object: %s\n&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 1656</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 1657</span>  }</div>
<div class="line"><span class="lineno"> 1658</span> </div>
<div class="line"><span class="lineno"> 1659</span>  fprintf(stderr, <span class="stringliteral">&quot;Stored Template object 0x%04x\n&quot;</span>, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].w);</div>
<div class="line"><span class="lineno"> 1660</span> </div>
<div class="line"><span class="lineno"> 1661</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1662</span>}</div>
<div class="ttc" id="ayubihsm_8c_html_ae0fc8d6520950868365011d1a9f450f1"><div class="ttname"><a href="yubihsm_8c.html#ae0fc8d6520950868365011d1a9f450f1">yh_util_import_template</a></div><div class="ttdeci">yh_rc yh_util_import_template(yh_session *session, uint16_t *object_id, const char *label, uint16_t domains, const yh_capabilities *capabilities, yh_algorithm algorithm, const uint8_t *in, size_t in_len)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l02835">yubihsm.c:2835</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_ad1629b955c1d718c65f137c9df3b3332_cgraph.png" border="0" usemap="#acommands_8c_ad1629b955c1d718c65f137c9df3b3332_cgraph" alt=""/></div>
<map name="acommands_8c_ad1629b955c1d718c65f137c9df3b3332_cgraph" id="acommands_8c_ad1629b955c1d718c65f137c9df3b3332_cgraph">
<area shape="rect" title=" " alt="" coords="5,180,155,206"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="830,179,913,204"/>
<area shape="poly" title=" " alt="" coords="155,190,814,189,814,194,155,195"/>
<area shape="rect" href="yubihsm_8c.html#ae0fc8d6520950868365011d1a9f450f1" title=" " alt="" coords="203,105,362,131"/>
<area shape="poly" title=" " alt="" coords="116,177,230,134,232,139,118,182"/>
<area shape="poly" title=" " alt="" coords="346,129,410,141,634,169,814,185,814,190,633,175,410,146,345,134"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="836,80,907,106"/>
<area shape="poly" title=" " alt="" coords="346,102,410,90,511,72,590,60,670,57,772,65,822,75,821,80,771,70,670,62,591,65,512,78,410,95,347,107"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="837,5,906,31"/>
<area shape="poly" title=" " alt="" coords="306,102,353,79,409,58,524,35,639,22,742,16,822,15,822,20,742,21,639,27,525,40,411,63,355,84,308,107"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="410,105,558,131"/>
<area shape="poly" title=" " alt="" coords="362,116,395,116,395,121,362,121"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="606,80,772,106"/>
<area shape="poly" title=" " alt="" coords="558,106,590,102,591,108,559,112"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="624,129,754,155"/>
<area shape="poly" title=" " alt="" coords="559,124,609,130,608,135,558,129"/>
<area shape="poly" title=" " alt="" coords="751,104,773,115,789,127,798,140,807,152,821,165,826,169,823,173,818,170,803,156,794,143,785,131,770,119,749,109"/>
<area shape="poly" title=" " alt="" coords="772,90,820,90,820,96,772,96"/>
<area shape="poly" title=" " alt="" coords="721,77,823,35,825,40,723,82"/>
<area shape="poly" title=" " alt="" coords="740,153,815,174,814,179,739,158"/>
<area shape="poly" title=" " alt="" coords="739,126,820,104,821,109,740,131"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="820,129,923,155"/>
<area shape="poly" title=" " alt="" coords="755,140,804,140,804,145,755,145"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_ad1629b955c1d718c65f137c9df3b3332_icgraph.png" border="0" usemap="#acommands_8c_ad1629b955c1d718c65f137c9df3b3332_icgraph" alt=""/></div>
<map name="acommands_8c_ad1629b955c1d718c65f137c9df3b3332_icgraph" id="acommands_8c_ad1629b955c1d718c65f137c9df3b3332_icgraph">
<area shape="rect" title=" " alt="" coords="296,31,445,56"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="280,34,248,30,249,25,281,29"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,31,55,56"/>
<area shape="poly" title=" " alt="" coords="280,46,55,46,55,41,280,41"/>
<area shape="poly" title=" " alt="" coords="88,36,55,42,54,37,87,31"/>
</map>
</div>

</div>
</div>
<a id="ab2eb73abfe6f6d5a7f17752b3cab227a" name="ab2eb73abfe6f6d5a7f17752b3cab227a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab2eb73abfe6f6d5a7f17752b3cab227a">&#9670;&#160;</a></span>yh_com_put_wrapkey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int yh_com_put_wrapkey </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__context.html">yubihsm_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_argument.html">Argument</a> *</td>          <td class="paramname"><span class="paramname"><em>argv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a></td>          <td class="paramname"><span class="paramname"><em>fmt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="commands_8c_source.html#l01577">1577</a> of file <a class="el" href="commands_8c_source.html">commands.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1577</span>                                                                             {</div>
<div class="line"><span class="lineno"> 1578</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 1579</span> </div>
<div class="line"><span class="lineno"> 1580</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ctx);</div>
<div class="line"><span class="lineno"> 1581</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(fmt);</div>
<div class="line"><span class="lineno"> 1582</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55ca">yh_algorithm</a> algo;</div>
<div class="line"><span class="lineno"> 1583</span> </div>
<div class="line"><span class="lineno"> 1584</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[6].<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> == 16) {</div>
<div class="line"><span class="lineno"> 1585</span>    algo = <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caae22b228e457c9bdccb5a93d81730b1b1">YH_ALGO_AES128_CCM_WRAP</a>;</div>
<div class="line"><span class="lineno"> 1586</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[6].<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> == 24) {</div>
<div class="line"><span class="lineno"> 1587</span>    algo = <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caab739a1d142dacaf37ba13a73e2d83fab">YH_ALGO_AES192_CCM_WRAP</a>;</div>
<div class="line"><span class="lineno"> 1588</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[6].<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> == 32) {</div>
<div class="line"><span class="lineno"> 1589</span>    algo = <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa927e2246e5657f946b4da4b71092b022">YH_ALGO_AES256_CCM_WRAP</a>;</div>
<div class="line"><span class="lineno"> 1590</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1591</span>    fprintf(stderr, <span class="stringliteral">&quot;Key length not matching, should be 16, 24 or 32\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1592</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 1593</span>  }</div>
<div class="line"><span class="lineno"> 1594</span> </div>
<div class="line"><span class="lineno"> 1595</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#a3a9729ea5b2e299a735b43f2b23e50a7">yh_util_import_wrap_key</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e, &amp;<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].w, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[2].<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a>, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[3].w,</div>
<div class="line"><span class="lineno"> 1596</span>                                &amp;<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[4].c, algo, &amp;<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[5].c, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[6].x,</div>
<div class="line"><span class="lineno"> 1597</span>                                <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[6].<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>);</div>
<div class="line"><span class="lineno"> 1598</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 1599</span>    fprintf(stderr, <span class="stringliteral">&quot;Failed to store wrapkey: %s\n&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 1600</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 1601</span>  }</div>
<div class="line"><span class="lineno"> 1602</span> </div>
<div class="line"><span class="lineno"> 1603</span>  fprintf(stderr, <span class="stringliteral">&quot;Stored Wrap key 0x%04x\n&quot;</span>, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].w);</div>
<div class="line"><span class="lineno"> 1604</span> </div>
<div class="line"><span class="lineno"> 1605</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1606</span>}</div>
<div class="ttc" id="ayubihsm_8c_html_a3a9729ea5b2e299a735b43f2b23e50a7"><div class="ttname"><a href="yubihsm_8c.html#a3a9729ea5b2e299a735b43f2b23e50a7">yh_util_import_wrap_key</a></div><div class="ttdeci">yh_rc yh_util_import_wrap_key(yh_session *session, uint16_t *key_id, const char *label, uint16_t domains, const yh_capabilities *capabilities, yh_algorithm algorithm, const yh_capabilities *delegated_capabilities, const uint8_t *in, size_t in_len)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l02363">yubihsm.c:2363</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_ab2eb73abfe6f6d5a7f17752b3cab227a_cgraph.png" border="0" usemap="#acommands_8c_ab2eb73abfe6f6d5a7f17752b3cab227a_cgraph" alt=""/></div>
<map name="acommands_8c_ab2eb73abfe6f6d5a7f17752b3cab227a_cgraph" id="acommands_8c_ab2eb73abfe6f6d5a7f17752b3cab227a_cgraph">
<area shape="rect" title=" " alt="" coords="5,180,154,206"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="835,179,918,204"/>
<area shape="poly" title=" " alt="" coords="154,190,819,189,819,194,154,195"/>
<area shape="rect" href="yubihsm_8c.html#a3a9729ea5b2e299a735b43f2b23e50a7" title=" " alt="" coords="202,105,367,131"/>
<area shape="poly" title=" " alt="" coords="116,177,231,134,233,139,118,182"/>
<area shape="poly" title=" " alt="" coords="350,129,415,141,639,169,819,185,819,190,638,174,415,146,349,134"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="841,80,912,106"/>
<area shape="poly" title=" " alt="" coords="350,102,415,90,516,73,595,60,675,57,777,65,827,75,826,80,776,70,675,62,596,66,517,78,415,95,350,107"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="842,5,910,31"/>
<area shape="poly" title=" " alt="" coords="309,102,357,80,414,60,529,37,644,23,747,17,827,15,827,21,748,22,644,29,530,42,416,65,359,85,311,107"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="415,105,563,131"/>
<area shape="poly" title=" " alt="" coords="367,116,399,116,399,121,367,121"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="611,80,777,106"/>
<area shape="poly" title=" " alt="" coords="563,106,595,102,596,108,564,112"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="629,129,759,155"/>
<area shape="poly" title=" " alt="" coords="564,124,614,130,613,135,563,129"/>
<area shape="poly" title=" " alt="" coords="756,104,778,115,794,127,803,140,812,152,826,165,831,169,828,173,823,170,808,156,799,143,790,131,775,119,754,109"/>
<area shape="poly" title=" " alt="" coords="777,90,825,90,825,96,777,96"/>
<area shape="poly" title=" " alt="" coords="726,77,828,35,830,40,728,82"/>
<area shape="poly" title=" " alt="" coords="745,153,820,174,819,179,744,158"/>
<area shape="poly" title=" " alt="" coords="744,126,825,104,826,109,745,131"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="825,129,928,155"/>
<area shape="poly" title=" " alt="" coords="760,140,809,140,809,145,760,145"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_ab2eb73abfe6f6d5a7f17752b3cab227a_icgraph.png" border="0" usemap="#acommands_8c_ab2eb73abfe6f6d5a7f17752b3cab227a_icgraph" alt=""/></div>
<map name="acommands_8c_ab2eb73abfe6f6d5a7f17752b3cab227a_icgraph" id="acommands_8c_ab2eb73abfe6f6d5a7f17752b3cab227a_icgraph">
<area shape="rect" title=" " alt="" coords="296,31,444,56"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="280,35,248,30,249,25,281,29"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,31,55,56"/>
<area shape="poly" title=" " alt="" coords="280,46,55,46,55,41,280,41"/>
<area shape="poly" title=" " alt="" coords="88,36,55,42,54,37,87,31"/>
</map>
</div>

</div>
</div>
<a id="a6b74f2d2d47796c2432a15cd63183dd1" name="a6b74f2d2d47796c2432a15cd63183dd1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b74f2d2d47796c2432a15cd63183dd1">&#9670;&#160;</a></span>yh_com_put_wrapped()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int yh_com_put_wrapped </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__context.html">yubihsm_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_argument.html">Argument</a> *</td>          <td class="paramname"><span class="paramname"><em>argv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a></td>          <td class="paramname"><span class="paramname"><em>fmt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="commands_8c_source.html#l01613">1613</a> of file <a class="el" href="commands_8c_source.html">commands.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1613</span>                                                                             {</div>
<div class="line"><span class="lineno"> 1614</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 1615</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583">yh_object_type</a> <a class="code hl_enumeration" href="namespacesysio_1_1chain.html#a2d924ca9891de9b9edf3ccb582ec7591">object_type</a>;</div>
<div class="line"><span class="lineno"> 1616</span>  <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> object_id;</div>
<div class="line"><span class="lineno"> 1617</span>  <span class="keyword">const</span> <span class="keywordtype">char</span> *type = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><span class="lineno"> 1618</span> </div>
<div class="line"><span class="lineno"> 1619</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ctx);</div>
<div class="line"><span class="lineno"> 1620</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(fmt);</div>
<div class="line"><span class="lineno"> 1621</span> </div>
<div class="line"><span class="lineno"> 1622</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#ae5bf13f9558bb0340468b722accf94d3">yh_util_import_wrapped</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].w, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[2].x, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[2].<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>,</div>
<div class="line"><span class="lineno"> 1623</span>                               &amp;object_type, &amp;object_id);</div>
<div class="line"><span class="lineno"> 1624</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 1625</span>    fprintf(stderr, <span class="stringliteral">&quot;Failed to store wrapped object: %s\n&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 1626</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 1627</span>  }</div>
<div class="line"><span class="lineno"> 1628</span> </div>
<div class="line"><span class="lineno"> 1629</span>  <a class="code hl_function" href="yubihsm_8c.html#afe3d701f7470c1d7b05480e4b6728bf7">yh_type_to_string</a>(object_type, &amp;type);</div>
<div class="line"><span class="lineno"> 1630</span> </div>
<div class="line"><span class="lineno"> 1631</span>  fprintf(stderr, <span class="stringliteral">&quot;Object imported as 0x%04x of type %s\n&quot;</span>, object_id, type);</div>
<div class="line"><span class="lineno"> 1632</span> </div>
<div class="line"><span class="lineno"> 1633</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1634</span>}</div>
<div class="ttc" id="anamespacesysio_1_1chain_html_a2d924ca9891de9b9edf3ccb582ec7591"><div class="ttname"><a href="namespacesysio_1_1chain.html#a2d924ca9891de9b9edf3ccb582ec7591">sysio::chain::object_type</a></div><div class="ttdeci">object_type</div><div class="ttdef"><b>Definition</b> <a href="chain_2include_2sysio_2chain_2types_8hpp_source.html#l00135">types.hpp:136</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_ae5bf13f9558bb0340468b722accf94d3"><div class="ttname"><a href="yubihsm_8c.html#ae5bf13f9558bb0340468b722accf94d3">yh_util_import_wrapped</a></div><div class="ttdeci">yh_rc yh_util_import_wrapped(yh_session *session, uint16_t wrapping_key_id, const uint8_t *in, size_t in_len, yh_object_type *target_type, uint16_t *target_id)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l02309">yubihsm.c:2309</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_a6b74f2d2d47796c2432a15cd63183dd1_cgraph.png" border="0" usemap="#acommands_8c_a6b74f2d2d47796c2432a15cd63183dd1_cgraph" alt=""/></div>
<map name="acommands_8c_a6b74f2d2d47796c2432a15cd63183dd1_cgraph" id="acommands_8c_a6b74f2d2d47796c2432a15cd63183dd1_cgraph">
<area shape="rect" title=" " alt="" coords="5,37,154,62"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="828,87,911,113"/>
<area shape="poly" title=" " alt="" coords="154,34,201,28,362,12,489,3,550,5,615,12,687,27,771,50,834,77,832,82,769,55,686,32,614,18,550,10,489,8,363,17,202,34,154,39"/>
<area shape="rect" href="yubihsm_8c.html#afe3d701f7470c1d7b05480e4b6728bf7" title=" " alt="" coords="420,37,544,62"/>
<area shape="poly" title=" " alt="" coords="154,47,404,47,404,52,154,52"/>
<area shape="rect" href="yubihsm_8c.html#ae5bf13f9558bb0340468b722accf94d3" title=" " alt="" coords="202,113,360,138"/>
<area shape="poly" title=" " alt="" coords="117,61,231,104,230,109,115,66"/>
<area shape="poly" title=" " alt="" coords="545,52,770,79,813,86,812,92,769,84,544,58"/>
<area shape="poly" title=" " alt="" coords="360,120,812,100,812,105,361,125"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="834,187,905,213"/>
<area shape="poly" title=" " alt="" coords="313,137,409,174,508,205,587,225,667,231,769,223,819,213,820,218,770,228,667,236,586,230,506,211,407,179,311,142"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="408,138,556,164"/>
<area shape="poly" title=" " alt="" coords="360,133,393,137,392,142,360,138"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="604,138,770,164"/>
<area shape="poly" title=" " alt="" coords="556,148,589,148,589,154,556,154"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="622,187,752,213"/>
<area shape="poly" title=" " alt="" coords="539,162,616,181,615,186,538,167"/>
<area shape="poly" title=" " alt="" coords="735,135,812,113,813,118,737,140"/>
<area shape="poly" title=" " alt="" coords="738,162,819,184,818,189,737,167"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="835,138,904,164"/>
<area shape="poly" title=" " alt="" coords="770,148,820,148,820,154,770,154"/>
<area shape="poly" title=" " alt="" coords="747,184,768,174,783,162,792,150,801,137,816,124,823,119,826,123,819,128,805,141,796,153,787,166,771,179,749,189"/>
<area shape="poly" title=" " alt="" coords="753,198,819,198,819,203,753,203"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="818,237,921,262"/>
<area shape="poly" title=" " alt="" coords="738,211,805,230,803,235,737,216"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_a6b74f2d2d47796c2432a15cd63183dd1_icgraph.png" border="0" usemap="#acommands_8c_a6b74f2d2d47796c2432a15cd63183dd1_icgraph" alt=""/></div>
<map name="acommands_8c_a6b74f2d2d47796c2432a15cd63183dd1_icgraph" id="acommands_8c_a6b74f2d2d47796c2432a15cd63183dd1_icgraph">
<area shape="rect" title=" " alt="" coords="296,31,444,56"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="280,35,248,30,249,25,281,29"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,31,55,56"/>
<area shape="poly" title=" " alt="" coords="280,46,55,46,55,41,280,41"/>
<area shape="poly" title=" " alt="" coords="88,36,55,42,54,37,87,31"/>
</map>
</div>

</div>
</div>
<a id="a5947d870ac856de3880f8b80981e6355" name="a5947d870ac856de3880f8b80981e6355"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5947d870ac856de3880f8b80981e6355">&#9670;&#160;</a></span>yh_com_reset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int yh_com_reset </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__context.html">yubihsm_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_argument.html">Argument</a> *</td>          <td class="paramname"><span class="paramname"><em>argv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a></td>          <td class="paramname"><span class="paramname"><em>fmt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="commands_8c_source.html#l01953">1953</a> of file <a class="el" href="commands_8c_source.html">commands.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1953</span>                                                                       {</div>
<div class="line"><span class="lineno"> 1954</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ctx);</div>
<div class="line"><span class="lineno"> 1955</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(fmt);</div>
<div class="line"><span class="lineno"> 1956</span> </div>
<div class="line"><span class="lineno"> 1957</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 1958</span> </div>
<div class="line"><span class="lineno"> 1959</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#a5c153fe27877bcc7927d391fb55550af">yh_util_reset_device</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e);</div>
<div class="line"><span class="lineno"> 1960</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366ae4f6537a9d33914ea06c53b015d92ca8">YHR_CONNECTION_ERROR</a> &amp;&amp; <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 1961</span>    fprintf(stderr, <span class="stringliteral">&quot;Failed to reset device: %s\n&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 1962</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 1963</span>  }</div>
<div class="line"><span class="lineno"> 1964</span> </div>
<div class="line"><span class="lineno"> 1965</span>  fprintf(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>, <span class="stringliteral">&quot;Device successfully reset\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1966</span> </div>
<div class="line"><span class="lineno"> 1967</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1968</span>}</div>
<div class="ttc" id="ayubihsm_8c_html_a5c153fe27877bcc7927d391fb55550af"><div class="ttname"><a href="yubihsm_8c.html#a5c153fe27877bcc7927d391fb55550af">yh_util_reset_device</a></div><div class="ttdeci">yh_rc yh_util_reset_device(yh_session *session)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l03796">yubihsm.c:3796</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_ae4f602d2343d01b1727dfd633169d366ae4f6537a9d33914ea06c53b015d92ca8"><div class="ttname"><a href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366ae4f6537a9d33914ea06c53b015d92ca8">YHR_CONNECTION_ERROR</a></div><div class="ttdeci">@ YHR_CONNECTION_ERROR</div><div class="ttdoc">Returned value when a connection error was encountered.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00178">yubihsm.h:178</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_a5947d870ac856de3880f8b80981e6355_cgraph.png" border="0" usemap="#acommands_8c_a5947d870ac856de3880f8b80981e6355_cgraph" alt=""/></div>
<map name="acommands_8c_a5947d870ac856de3880f8b80981e6355_cgraph" id="acommands_8c_a5947d870ac856de3880f8b80981e6355_cgraph">
<area shape="rect" title=" " alt="" coords="5,179,109,204"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="765,153,848,179"/>
<area shape="poly" title=" " alt="" coords="109,190,297,189,502,181,707,169,749,167,749,172,707,174,502,186,297,194,109,195"/>
<area shape="rect" href="yubihsm_8c.html#a5c153fe27877bcc7927d391fb55550af" title=" " alt="" coords="157,153,297,179"/>
<area shape="poly" title=" " alt="" coords="109,181,141,176,142,182,109,186"/>
<area shape="poly" title=" " alt="" coords="297,164,749,164,749,169,297,169"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="345,103,493,128"/>
<area shape="poly" title=" " alt="" coords="278,150,352,130,354,135,279,155"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="541,53,707,79"/>
<area shape="poly" title=" " alt="" coords="475,99,552,81,553,86,476,105"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="559,103,689,128"/>
<area shape="poly" title=" " alt="" coords="493,113,544,113,544,118,493,118"/>
<area shape="poly" title=" " alt="" coords="686,77,708,88,724,101,733,114,742,127,756,140,761,143,758,148,753,144,738,130,729,117,720,105,705,92,684,82"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="771,55,842,80"/>
<area shape="poly" title=" " alt="" coords="707,64,755,64,755,70,707,69"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="772,5,840,31"/>
<area shape="poly" title=" " alt="" coords="675,50,756,28,758,34,677,55"/>
<area shape="poly" title=" " alt="" coords="674,126,750,148,749,153,672,132"/>
<area shape="poly" title=" " alt="" coords="675,99,755,78,756,83,677,105"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="755,104,858,130"/>
<area shape="poly" title=" " alt="" coords="690,113,739,114,739,119,690,119"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_a5947d870ac856de3880f8b80981e6355_icgraph.png" border="0" usemap="#acommands_8c_a5947d870ac856de3880f8b80981e6355_icgraph" alt=""/></div>
<map name="acommands_8c_a5947d870ac856de3880f8b80981e6355_icgraph" id="acommands_8c_a5947d870ac856de3880f8b80981e6355_icgraph">
<area shape="rect" title=" " alt="" coords="296,31,399,56"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="280,36,248,31,249,26,281,31"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,31,55,56"/>
<area shape="poly" title=" " alt="" coords="280,46,55,46,55,41,280,41"/>
<area shape="poly" title=" " alt="" coords="88,36,55,42,54,37,87,31"/>
</map>
</div>

</div>
</div>
<a id="ada05a561c71aebab8f0a53c0d552e027" name="ada05a561c71aebab8f0a53c0d552e027"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada05a561c71aebab8f0a53c0d552e027">&#9670;&#160;</a></span>yh_com_set_cacert()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int yh_com_set_cacert </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__context.html">yubihsm_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_argument.html">Argument</a> *</td>          <td class="paramname"><span class="paramname"><em>argv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a></td>          <td class="paramname"><span class="paramname"><em>fmt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="commands_8c_source.html#l02735">2735</a> of file <a class="el" href="commands_8c_source.html">commands.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2735</span>                                                                            {</div>
<div class="line"><span class="lineno"> 2736</span> </div>
<div class="line"><span class="lineno"> 2737</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(fmt);</div>
<div class="line"><span class="lineno"> 2738</span> </div>
<div class="line"><span class="lineno"> 2739</span>  <span class="keywordflow">if</span> (ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a97d98362b0e43b749a9cb75da4793932">cacert</a>) {</div>
<div class="line"><span class="lineno"> 2740</span>    free(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a97d98362b0e43b749a9cb75da4793932">cacert</a>);</div>
<div class="line"><span class="lineno"> 2741</span>  }</div>
<div class="line"><span class="lineno"> 2742</span>  ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a97d98362b0e43b749a9cb75da4793932">cacert</a> = strdup(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a>);</div>
<div class="line"><span class="lineno"> 2743</span> </div>
<div class="line"><span class="lineno"> 2744</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 2745</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_ada05a561c71aebab8f0a53c0d552e027_icgraph.png" border="0" usemap="#acommands_8c_ada05a561c71aebab8f0a53c0d552e027_icgraph" alt=""/></div>
<map name="acommands_8c_ada05a561c71aebab8f0a53c0d552e027_icgraph" id="acommands_8c_ada05a561c71aebab8f0a53c0d552e027_icgraph">
<area shape="rect" title=" " alt="" coords="296,5,431,31"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="281,21,248,21,248,16,281,16"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,55,31"/>
<area shape="poly" title=" " alt="" coords="87,21,55,21,55,16,87,16"/>
</map>
</div>

</div>
</div>
<a id="aeb72c881aa2699aea40f45fa65cf069b" name="aeb72c881aa2699aea40f45fa65cf069b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb72c881aa2699aea40f45fa65cf069b">&#9670;&#160;</a></span>yh_com_set_log_index()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int yh_com_set_log_index </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__context.html">yubihsm_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_argument.html">Argument</a> *</td>          <td class="paramname"><span class="paramname"><em>argv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a></td>          <td class="paramname"><span class="paramname"><em>fmt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="commands_8c_source.html#l00141">141</a> of file <a class="el" href="commands_8c_source.html">commands.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  141</span>                                                                               {</div>
<div class="line"><span class="lineno">  142</span> </div>
<div class="line"><span class="lineno">  143</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(ctx);</div>
<div class="line"><span class="lineno">  144</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(fmt);</div>
<div class="line"><span class="lineno">  145</span> </div>
<div class="line"><span class="lineno">  146</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#a9d844855c9066bbea0e4344978dd7fdc">yh_util_set_log_index</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].w);</div>
<div class="line"><span class="lineno">  147</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno">  148</span>    fprintf(stderr, <span class="stringliteral">&quot;Failed to set log index: %s\n&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno">  149</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  150</span>  }</div>
<div class="line"><span class="lineno">  151</span> </div>
<div class="line"><span class="lineno">  152</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  153</span>}</div>
<div class="ttc" id="ayubihsm_8c_html_a9d844855c9066bbea0e4344978dd7fdc"><div class="ttname"><a href="yubihsm_8c.html#a9d844855c9066bbea0e4344978dd7fdc">yh_util_set_log_index</a></div><div class="ttdeci">yh_rc yh_util_set_log_index(yh_session *session, uint16_t index)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l02606">yubihsm.c:2606</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_aeb72c881aa2699aea40f45fa65cf069b_cgraph.png" border="0" usemap="#acommands_8c_aeb72c881aa2699aea40f45fa65cf069b_cgraph" alt=""/></div>
<map name="acommands_8c_aeb72c881aa2699aea40f45fa65cf069b_cgraph" id="acommands_8c_aeb72c881aa2699aea40f45fa65cf069b_cgraph">
<area shape="rect" title=" " alt="" coords="5,8,160,33"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="822,9,905,35"/>
<area shape="poly" title=" " alt="" coords="160,13,427,4,595,3,764,8,806,12,806,17,764,14,595,9,427,9,160,19"/>
<area shape="rect" href="yubihsm_8c.html#a9d844855c9066bbea0e4344978dd7fdc" title=" " alt="" coords="208,33,354,59"/>
<area shape="poly" title=" " alt="" coords="160,28,192,32,192,37,160,33"/>
<area shape="poly" title=" " alt="" coords="354,40,806,21,806,27,355,45"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="828,108,899,133"/>
<area shape="poly" title=" " alt="" coords="311,57,403,94,502,126,581,145,661,151,763,143,813,133,814,138,764,148,661,157,580,151,500,131,401,99,309,62"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="402,58,550,84"/>
<area shape="poly" title=" " alt="" coords="355,53,387,57,386,62,354,58"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="598,58,764,84"/>
<area shape="poly" title=" " alt="" coords="550,68,583,68,583,74,550,74"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="616,108,746,133"/>
<area shape="poly" title=" " alt="" coords="533,82,610,101,609,106,532,87"/>
<area shape="poly" title=" " alt="" coords="731,55,806,34,807,40,732,60"/>
<area shape="poly" title=" " alt="" coords="732,82,813,104,812,109,731,87"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="829,58,898,84"/>
<area shape="poly" title=" " alt="" coords="764,68,814,68,814,74,764,74"/>
<area shape="poly" title=" " alt="" coords="741,105,762,94,777,82,786,70,795,57,810,44,815,40,818,45,813,48,799,61,790,73,781,86,765,99,743,109"/>
<area shape="poly" title=" " alt="" coords="747,118,813,118,813,123,747,123"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="812,157,915,183"/>
<area shape="poly" title=" " alt="" coords="732,131,799,150,797,155,731,136"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_aeb72c881aa2699aea40f45fa65cf069b_icgraph.png" border="0" usemap="#acommands_8c_aeb72c881aa2699aea40f45fa65cf069b_icgraph" alt=""/></div>
<map name="acommands_8c_aeb72c881aa2699aea40f45fa65cf069b_icgraph" id="acommands_8c_aeb72c881aa2699aea40f45fa65cf069b_icgraph">
<area shape="rect" title=" " alt="" coords="296,31,450,56"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="280,34,248,30,249,25,281,29"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,31,55,56"/>
<area shape="poly" title=" " alt="" coords="280,46,55,46,55,41,280,41"/>
<area shape="poly" title=" " alt="" coords="88,36,55,42,54,37,87,31"/>
</map>
</div>

</div>
</div>
<a id="a264ec5c469bd0517814525ef59c8e69e" name="a264ec5c469bd0517814525ef59c8e69e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a264ec5c469bd0517814525ef59c8e69e">&#9670;&#160;</a></span>yh_com_set_proxy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int yh_com_set_proxy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__context.html">yubihsm_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_argument.html">Argument</a> *</td>          <td class="paramname"><span class="paramname"><em>argv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a></td>          <td class="paramname"><span class="paramname"><em>fmt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="commands_8c_source.html#l02750">2750</a> of file <a class="el" href="commands_8c_source.html">commands.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2750</span>                                                                           {</div>
<div class="line"><span class="lineno"> 2751</span> </div>
<div class="line"><span class="lineno"> 2752</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(fmt);</div>
<div class="line"><span class="lineno"> 2753</span> </div>
<div class="line"><span class="lineno"> 2754</span>  ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#aa2578fc399603af54de958824179cae4">proxy</a> = strdup(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a>);</div>
<div class="line"><span class="lineno"> 2755</span>  <span class="keywordflow">if</span> (ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#aa2578fc399603af54de958824179cae4">proxy</a>) {</div>
<div class="line"><span class="lineno"> 2756</span>    free(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#aa2578fc399603af54de958824179cae4">proxy</a>);</div>
<div class="line"><span class="lineno"> 2757</span>  }</div>
<div class="line"><span class="lineno"> 2758</span> </div>
<div class="line"><span class="lineno"> 2759</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 2760</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_a264ec5c469bd0517814525ef59c8e69e_icgraph.png" border="0" usemap="#acommands_8c_a264ec5c469bd0517814525ef59c8e69e_icgraph" alt=""/></div>
<map name="acommands_8c_a264ec5c469bd0517814525ef59c8e69e_icgraph" id="acommands_8c_a264ec5c469bd0517814525ef59c8e69e_icgraph">
<area shape="rect" title=" " alt="" coords="296,5,427,31"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="280,21,248,21,248,16,280,16"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,55,31"/>
<area shape="poly" title=" " alt="" coords="87,21,55,21,55,16,87,16"/>
</map>
</div>

</div>
</div>
<a id="af224308de5cdf8e20cbbdcaa6cf7598c" name="af224308de5cdf8e20cbbdcaa6cf7598c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af224308de5cdf8e20cbbdcaa6cf7598c">&#9670;&#160;</a></span>yh_com_sign_attestation_certificate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int yh_com_sign_attestation_certificate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__context.html">yubihsm_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_argument.html">Argument</a> *</td>          <td class="paramname"><span class="paramname"><em>argv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a></td>          <td class="paramname"><span class="paramname"><em>fmt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="commands_8c_source.html#l02567">2567</a> of file <a class="el" href="commands_8c_source.html">commands.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2568</span>                                                        {</div>
<div class="line"><span class="lineno"> 2569</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> data[2048];</div>
<div class="line"><span class="lineno"> 2570</span>  <span class="keywordtype">size_t</span> data_len = <span class="keyword">sizeof</span>(data);</div>
<div class="line"><span class="lineno"> 2571</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 2572</span>  <span class="keywordtype">int</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a3d854b6efad16a16e4d7b4539d4fc71f">ret</a> = -1;</div>
<div class="line"><span class="lineno"> 2573</span> </div>
<div class="line"><span class="lineno"> 2574</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#a5988faffd97366b188728ff1a7fb6e89">yh_util_sign_attestation_certificate</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].w, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[2].w,</div>
<div class="line"><span class="lineno"> 2575</span>                                             data, &amp;data_len);</div>
<div class="line"><span class="lineno"> 2576</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 2577</span>    fprintf(stderr, <span class="stringliteral">&quot;Failed to attest asymmetric key: %s\n&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 2578</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 2579</span>  }</div>
<div class="line"><span class="lineno"> 2580</span> </div>
<div class="line"><span class="lineno"> 2581</span>  X509 *x509 = X509_new();</div>
<div class="line"><span class="lineno"> 2582</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *ptr = data;</div>
<div class="line"><span class="lineno"> 2583</span>  <span class="keywordflow">if</span> (!x509) {</div>
<div class="line"><span class="lineno"> 2584</span>    fprintf(stderr, <span class="stringliteral">&quot;Failed allocating x509 structure\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 2585</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 2586</span>  }</div>
<div class="line"><span class="lineno"> 2587</span>  x509 = d2i_X509(NULL, &amp;ptr, data_len);</div>
<div class="line"><span class="lineno"> 2588</span>  <span class="keywordflow">if</span> (!x509) {</div>
<div class="line"><span class="lineno"> 2589</span>    fprintf(stderr, <span class="stringliteral">&quot;Failed parsing x509 information\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 2590</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2591</span>    <span class="keywordflow">if</span> (fmt == <a class="code hl_enumvalue" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708add674d756d2c6341a834a330a874b550">fmt_base64</a> || fmt == <a class="code hl_enumvalue" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708aa8908f2c651567ae288c587240e71d3e">fmt_PEM</a>) {</div>
<div class="line"><span class="lineno"> 2592</span>      PEM_write_X509(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>, x509);</div>
<div class="line"><span class="lineno"> 2593</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (fmt == <a class="code hl_enumvalue" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708a701725c70fb214e14a2feee390939a09">fmt_binary</a>) {</div>
<div class="line"><span class="lineno"> 2594</span>      i2d_X509_fp(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>, x509);</div>
<div class="line"><span class="lineno"> 2595</span>    }</div>
<div class="line"><span class="lineno"> 2596</span>    <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a3d854b6efad16a16e4d7b4539d4fc71f">ret</a> = 0;</div>
<div class="line"><span class="lineno"> 2597</span>  }</div>
<div class="line"><span class="lineno"> 2598</span> </div>
<div class="line"><span class="lineno"> 2599</span>  X509_free(x509);</div>
<div class="line"><span class="lineno"> 2600</span>  <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a3d854b6efad16a16e4d7b4539d4fc71f">ret</a>;</div>
<div class="line"><span class="lineno"> 2601</span>}</div>
<div class="ttc" id="ayubihsm_8c_html_a5988faffd97366b188728ff1a7fb6e89"><div class="ttname"><a href="yubihsm_8c.html#a5988faffd97366b188728ff1a7fb6e89">yh_util_sign_attestation_certificate</a></div><div class="ttdeci">yh_rc yh_util_sign_attestation_certificate(yh_session *session, uint16_t key_id, uint16_t attest_id, uint8_t *out, size_t *out_len)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l03495">yubihsm.c:3495</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_af224308de5cdf8e20cbbdcaa6cf7598c_cgraph.png" border="0" usemap="#acommands_8c_af224308de5cdf8e20cbbdcaa6cf7598c_cgraph" alt=""/></div>
<map name="acommands_8c_af224308de5cdf8e20cbbdcaa6cf7598c_cgraph" id="acommands_8c_af224308de5cdf8e20cbbdcaa6cf7598c_cgraph">
<area shape="rect" title=" " alt="" coords="5,168,172,209"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="846,153,929,179"/>
<area shape="poly" title=" " alt="" coords="172,188,220,189,378,189,630,179,830,167,830,173,631,184,378,194,220,194,172,193"/>
<area shape="rect" href="yubihsm_8c.html#a5988faffd97366b188728ff1a7fb6e89" title=" " alt="" coords="220,139,378,180"/>
<area shape="poly" title=" " alt="" coords="172,175,204,170,204,175,172,180"/>
<area shape="poly" title=" " alt="" coords="379,158,830,163,830,168,379,163"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="426,103,574,128"/>
<area shape="poly" title=" " alt="" coords="378,140,423,130,424,135,379,145"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="622,53,788,79"/>
<area shape="poly" title=" " alt="" coords="556,99,633,81,634,86,557,105"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="640,103,770,128"/>
<area shape="poly" title=" " alt="" coords="574,113,625,113,625,118,574,118"/>
<area shape="poly" title=" " alt="" coords="767,77,789,88,805,101,814,114,823,127,837,140,842,143,839,148,834,144,819,130,810,117,801,105,786,92,765,82"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="852,55,923,80"/>
<area shape="poly" title=" " alt="" coords="788,64,836,64,836,70,788,69"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="853,5,922,31"/>
<area shape="poly" title=" " alt="" coords="756,50,837,28,839,34,758,55"/>
<area shape="poly" title=" " alt="" coords="755,126,831,148,830,153,753,132"/>
<area shape="poly" title=" " alt="" coords="756,99,836,78,837,83,758,105"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="836,104,939,130"/>
<area shape="poly" title=" " alt="" coords="771,113,820,114,820,119,771,119"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_af224308de5cdf8e20cbbdcaa6cf7598c_icgraph.png" border="0" usemap="#acommands_8c_af224308de5cdf8e20cbbdcaa6cf7598c_icgraph" alt=""/></div>
<map name="acommands_8c_af224308de5cdf8e20cbbdcaa6cf7598c_icgraph" id="acommands_8c_af224308de5cdf8e20cbbdcaa6cf7598c_icgraph">
<area shape="rect" title=" " alt="" coords="296,23,462,64"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="280,34,248,30,249,25,281,29"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,31,55,56"/>
<area shape="poly" title=" " alt="" coords="281,46,55,46,55,41,281,41"/>
<area shape="poly" title=" " alt="" coords="88,36,55,42,54,37,87,31"/>
</map>
</div>

</div>
</div>
<a id="a982058963f9ff020c357030be09e79fc" name="a982058963f9ff020c357030be09e79fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a982058963f9ff020c357030be09e79fc">&#9670;&#160;</a></span>yh_com_sign_ecdsa()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int yh_com_sign_ecdsa </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__context.html">yubihsm_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_argument.html">Argument</a> *</td>          <td class="paramname"><span class="paramname"><em>argv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a></td>          <td class="paramname"><span class="paramname"><em>fmt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="commands_8c_source.html#l01670">1670</a> of file <a class="el" href="commands_8c_source.html">commands.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1670</span>                                                                            {</div>
<div class="line"><span class="lineno"> 1671</span> </div>
<div class="line"><span class="lineno"> 1672</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 1673</span> </div>
<div class="line"><span class="lineno"> 1674</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> data[<a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a>];</div>
<div class="line"><span class="lineno"> 1675</span>  <span class="keywordtype">size_t</span> data_len;</div>
<div class="line"><span class="lineno"> 1676</span> </div>
<div class="line"><span class="lineno"> 1677</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> response[<a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a>];</div>
<div class="line"><span class="lineno"> 1678</span>  <span class="keywordtype">size_t</span> response_len = <span class="keyword">sizeof</span>(response);</div>
<div class="line"><span class="lineno"> 1679</span> </div>
<div class="line"><span class="lineno"> 1680</span>  <span class="keywordtype">int</span> hash;</div>
<div class="line"><span class="lineno"> 1681</span> </div>
<div class="line"><span class="lineno"> 1682</span>  <span class="keywordflow">switch</span> (<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[2].<a class="code hl_variable" href="pointer_8h.html#aeeddce917cf130d62c370b8f216026dd">a</a>) {</div>
<div class="line"><span class="lineno"> 1683</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caae9b7b5598c3839a53e4986dc901be244">YH_ALGO_EC_ECDSA_SHA1</a>:</div>
<div class="line"><span class="lineno"> 1684</span>      hash = <a class="code hl_enumvalue" href="yubihsm_2common_2hash_8h.html#a488906826f8aaf7e850c35889d560089a970f17bf10faf2a31f535116e97f6b4a">_SHA1</a>;</div>
<div class="line"><span class="lineno"> 1685</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1686</span> </div>
<div class="line"><span class="lineno"> 1687</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa2e5dfe9c79cb0d391d7bf952227268ec">YH_ALGO_EC_ECDSA_SHA256</a>:</div>
<div class="line"><span class="lineno"> 1688</span>      hash = <a class="code hl_enumvalue" href="yubihsm_2common_2hash_8h.html#a488906826f8aaf7e850c35889d560089af0ab1a9d65ceafa4ba1f6f177e379258">_SHA256</a>;</div>
<div class="line"><span class="lineno"> 1689</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1690</span> </div>
<div class="line"><span class="lineno"> 1691</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa657d2b30d884aeeff3c024404132ad69">YH_ALGO_EC_ECDSA_SHA384</a>:</div>
<div class="line"><span class="lineno"> 1692</span>      hash = <a class="code hl_enumvalue" href="yubihsm_2common_2hash_8h.html#a488906826f8aaf7e850c35889d560089a46254673795a1d78b2d84adbf88d8bb2">_SHA384</a>;</div>
<div class="line"><span class="lineno"> 1693</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1694</span> </div>
<div class="line"><span class="lineno"> 1695</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa44153987efd3466070143dbab77f2d70">YH_ALGO_EC_ECDSA_SHA512</a>:</div>
<div class="line"><span class="lineno"> 1696</span>      hash = <a class="code hl_enumvalue" href="yubihsm_2common_2hash_8h.html#a488906826f8aaf7e850c35889d560089a0dbf438178c608dea7392e75c9b7ae2d">_SHA512</a>;</div>
<div class="line"><span class="lineno"> 1697</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1698</span> </div>
<div class="line"><span class="lineno"> 1699</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 1700</span>      fprintf(stderr, <span class="stringliteral">&quot;Invalid hash algorithm\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1701</span>      <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 1702</span>  }</div>
<div class="line"><span class="lineno"> 1703</span> </div>
<div class="line"><span class="lineno"> 1704</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="hash_8c.html#a062ee0f36e0c16725c22a5d9d964a8cd">hash_bytes</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[3].x, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[3].<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>, hash, data, &amp;data_len) == <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 1705</span>    fprintf(stderr, <span class="stringliteral">&quot;Unable to hash file\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1706</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 1707</span>  }</div>
<div class="line"><span class="lineno"> 1708</span> </div>
<div class="line"><span class="lineno"> 1709</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#a5121c90d3bd745afd8264fef2ef39ace">yh_util_sign_ecdsa</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].w, data, data_len, response,</div>
<div class="line"><span class="lineno"> 1710</span>                           &amp;response_len);</div>
<div class="line"><span class="lineno"> 1711</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 1712</span>    fprintf(stderr, <span class="stringliteral">&quot;Failed to sign data with ecdsa: %s\n&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 1713</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 1714</span>  }</div>
<div class="line"><span class="lineno"> 1715</span> </div>
<div class="line"><span class="lineno"> 1716</span>  <a class="code hl_function" href="util_8c.html#ad969d220471d10a9f07080b50210f403">write_file</a>(response, response_len, ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>, fmt_to_fmt(fmt));</div>
<div class="line"><span class="lineno"> 1717</span> </div>
<div class="line"><span class="lineno"> 1718</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1719</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_a982058963f9ff020c357030be09e79fc_cgraph.png" border="0" usemap="#acommands_8c_a982058963f9ff020c357030be09e79fc_cgraph" alt=""/></div>
<map name="acommands_8c_a982058963f9ff020c357030be09e79fc_cgraph" id="acommands_8c_a982058963f9ff020c357030be09e79fc_cgraph">
<area shape="rect" title=" " alt="" coords="5,119,146,144"/>
<area shape="rect" href="hash_8c.html#a062ee0f36e0c16725c22a5d9d964a8cd" title=" " alt="" coords="216,19,304,44"/>
<area shape="poly" title=" " alt="" coords="100,116,220,50,222,54,103,120"/>
<area shape="rect" href="util_8c.html#ad969d220471d10a9f07080b50210f403" title=" " alt="" coords="223,93,296,119"/>
<area shape="poly" title=" " alt="" coords="146,119,207,111,208,116,146,124"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="794,205,877,231"/>
<area shape="poly" title=" " alt="" coords="104,142,146,161,194,178,275,196,358,209,522,223,668,224,778,220,778,225,668,229,522,228,357,215,274,202,193,183,144,166,101,147"/>
<area shape="rect" href="yubihsm_8c.html#a5121c90d3bd745afd8264fef2ef39ace" title=" " alt="" coords="194,143,326,168"/>
<area shape="poly" title=" " alt="" coords="146,138,178,142,178,148,146,143"/>
<area shape="rect" href="hash_8c.html#a2de35447908a9afccca42825a87854fb" title=" " alt="" coords="411,5,485,31"/>
<area shape="poly" title=" " alt="" coords="304,26,396,19,396,24,304,31"/>
<area shape="poly" title=" " alt="" coords="314,166,374,178,486,192,598,203,778,213,778,219,597,208,486,198,374,183,313,172"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="800,107,871,132"/>
<area shape="poly" title=" " alt="" coords="305,140,385,119,492,99,613,87,675,87,736,92,786,102,785,107,735,97,675,92,614,93,493,104,387,125,306,145"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="374,143,522,168"/>
<area shape="poly" title=" " alt="" coords="327,153,359,153,359,158,327,158"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="570,107,736,132"/>
<area shape="poly" title=" " alt="" coords="522,140,561,133,562,138,523,145"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="588,156,718,182"/>
<area shape="poly" title=" " alt="" coords="523,158,573,161,572,166,522,163"/>
<area shape="poly" title=" " alt="" coords="715,131,737,141,753,154,762,166,771,179,785,192,790,195,787,200,782,196,767,183,758,170,749,158,734,146,713,135"/>
<area shape="poly" title=" " alt="" coords="736,117,784,117,784,122,736,122"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="801,57,870,83"/>
<area shape="poly" title=" " alt="" coords="703,103,785,81,787,86,704,109"/>
<area shape="poly" title=" " alt="" coords="704,180,779,200,778,206,703,185"/>
<area shape="poly" title=" " alt="" coords="703,153,784,130,785,136,704,158"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="784,156,887,182"/>
<area shape="poly" title=" " alt="" coords="719,166,768,166,768,172,719,172"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_a982058963f9ff020c357030be09e79fc_icgraph.png" border="0" usemap="#acommands_8c_a982058963f9ff020c357030be09e79fc_icgraph" alt=""/></div>
<map name="acommands_8c_a982058963f9ff020c357030be09e79fc_icgraph" id="acommands_8c_a982058963f9ff020c357030be09e79fc_icgraph">
<area shape="rect" title=" " alt="" coords="296,31,436,56"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="280,35,248,30,249,25,281,30"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,31,55,56"/>
<area shape="poly" title=" " alt="" coords="281,46,55,46,55,41,281,41"/>
<area shape="poly" title=" " alt="" coords="88,36,55,42,54,37,87,31"/>
</map>
</div>

</div>
</div>
<a id="ac867ca0fc75e87da1a8d924fc587f5b9" name="ac867ca0fc75e87da1a8d924fc587f5b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac867ca0fc75e87da1a8d924fc587f5b9">&#9670;&#160;</a></span>yh_com_sign_eddsa()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int yh_com_sign_eddsa </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__context.html">yubihsm_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_argument.html">Argument</a> *</td>          <td class="paramname"><span class="paramname"><em>argv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a></td>          <td class="paramname"><span class="paramname"><em>fmt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="commands_8c_source.html#l01727">1727</a> of file <a class="el" href="commands_8c_source.html">commands.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1727</span>                                                                            {</div>
<div class="line"><span class="lineno"> 1728</span> </div>
<div class="line"><span class="lineno"> 1729</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 1730</span> </div>
<div class="line"><span class="lineno"> 1731</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> response[<a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a>];</div>
<div class="line"><span class="lineno"> 1732</span>  <span class="keywordtype">size_t</span> response_len = <span class="keyword">sizeof</span>(response);</div>
<div class="line"><span class="lineno"> 1733</span> </div>
<div class="line"><span class="lineno"> 1734</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[2].<a class="code hl_variable" href="pointer_8h.html#aeeddce917cf130d62c370b8f216026dd">a</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa68c2c97f16c36f727e41a899d8a7e8bd">YH_ALGO_EC_ED25519</a>) {</div>
<div class="line"><span class="lineno"> 1735</span>    fprintf(stderr, <span class="stringliteral">&quot;Invalid algorithm\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1736</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 1737</span>  }</div>
<div class="line"><span class="lineno"> 1738</span> </div>
<div class="line"><span class="lineno"> 1739</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#a690a5585de21ce82495e139ec1dfdf9d">yh_util_sign_eddsa</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].w, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[3].x, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[3].<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>,</div>
<div class="line"><span class="lineno"> 1740</span>                           response, &amp;response_len);</div>
<div class="line"><span class="lineno"> 1741</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 1742</span>    fprintf(stderr, <span class="stringliteral">&quot;Failed to sign data with eddsa: %s\n&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 1743</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 1744</span>  }</div>
<div class="line"><span class="lineno"> 1745</span> </div>
<div class="line"><span class="lineno"> 1746</span>  <a class="code hl_function" href="util_8c.html#ad969d220471d10a9f07080b50210f403">write_file</a>(response, response_len, ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>, fmt_to_fmt(fmt));</div>
<div class="line"><span class="lineno"> 1747</span> </div>
<div class="line"><span class="lineno"> 1748</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1749</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_ac867ca0fc75e87da1a8d924fc587f5b9_cgraph.png" border="0" usemap="#acommands_8c_ac867ca0fc75e87da1a8d924fc587f5b9_cgraph" alt=""/></div>
<map name="acommands_8c_ac867ca0fc75e87da1a8d924fc587f5b9_cgraph" id="acommands_8c_ac867ca0fc75e87da1a8d924fc587f5b9_cgraph">
<area shape="rect" title=" " alt="" coords="5,56,146,82"/>
<area shape="rect" href="util_8c.html#ad969d220471d10a9f07080b50210f403" title=" " alt="" coords="223,5,296,31"/>
<area shape="poly" title=" " alt="" coords="124,53,207,30,209,35,126,58"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="794,108,877,134"/>
<area shape="poly" title=" " alt="" coords="146,69,406,84,736,108,778,112,778,117,735,113,405,89,146,75"/>
<area shape="rect" href="yubihsm_8c.html#a690a5585de21ce82495e139ec1dfdf9d" title=" " alt="" coords="194,132,326,158"/>
<area shape="poly" title=" " alt="" coords="110,80,214,123,212,128,108,85"/>
<area shape="poly" title=" " alt="" coords="326,139,778,121,778,126,326,145"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="800,207,871,232"/>
<area shape="poly" title=" " alt="" coords="289,156,375,193,473,226,552,245,633,251,735,242,785,232,786,237,736,247,633,256,552,250,472,231,373,198,286,161"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="374,157,522,183"/>
<area shape="poly" title=" " alt="" coords="327,151,359,155,358,161,326,156"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="570,157,736,183"/>
<area shape="poly" title=" " alt="" coords="522,168,555,168,555,173,522,173"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="588,207,718,232"/>
<area shape="poly" title=" " alt="" coords="505,181,582,200,581,205,504,186"/>
<area shape="poly" title=" " alt="" coords="703,154,778,133,779,139,704,159"/>
<area shape="poly" title=" " alt="" coords="704,181,785,203,784,209,703,186"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="801,157,870,183"/>
<area shape="poly" title=" " alt="" coords="736,168,786,168,786,173,736,173"/>
<area shape="poly" title=" " alt="" coords="713,204,734,193,749,181,758,169,767,156,782,143,787,139,790,144,785,147,771,160,762,173,753,185,737,198,715,208"/>
<area shape="poly" title=" " alt="" coords="719,217,785,217,785,222,719,222"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="784,256,887,282"/>
<area shape="poly" title=" " alt="" coords="704,230,771,249,769,254,703,236"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_ac867ca0fc75e87da1a8d924fc587f5b9_icgraph.png" border="0" usemap="#acommands_8c_ac867ca0fc75e87da1a8d924fc587f5b9_icgraph" alt=""/></div>
<map name="acommands_8c_ac867ca0fc75e87da1a8d924fc587f5b9_icgraph" id="acommands_8c_ac867ca0fc75e87da1a8d924fc587f5b9_icgraph">
<area shape="rect" title=" " alt="" coords="296,31,436,56"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="280,35,248,30,249,25,281,30"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,31,55,56"/>
<area shape="poly" title=" " alt="" coords="281,46,55,46,55,41,281,41"/>
<area shape="poly" title=" " alt="" coords="88,36,55,42,54,37,87,31"/>
</map>
</div>

</div>
</div>
<a id="a98cf5e35ce2e4fd5881d8b6e7a890357" name="a98cf5e35ce2e4fd5881d8b6e7a890357"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a98cf5e35ce2e4fd5881d8b6e7a890357">&#9670;&#160;</a></span>yh_com_sign_pkcs1v1_5()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int yh_com_sign_pkcs1v1_5 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__context.html">yubihsm_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_argument.html">Argument</a> *</td>          <td class="paramname"><span class="paramname"><em>argv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a></td>          <td class="paramname"><span class="paramname"><em>fmt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="commands_8c_source.html#l01757">1757</a> of file <a class="el" href="commands_8c_source.html">commands.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1758</span>                                          {</div>
<div class="line"><span class="lineno"> 1759</span> </div>
<div class="line"><span class="lineno"> 1760</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 1761</span> </div>
<div class="line"><span class="lineno"> 1762</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> data[<a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a>];</div>
<div class="line"><span class="lineno"> 1763</span>  <span class="keywordtype">size_t</span> data_len;</div>
<div class="line"><span class="lineno"> 1764</span> </div>
<div class="line"><span class="lineno"> 1765</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> response[<a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a>];</div>
<div class="line"><span class="lineno"> 1766</span>  <span class="keywordtype">size_t</span> response_len = <span class="keyword">sizeof</span>(response);</div>
<div class="line"><span class="lineno"> 1767</span> </div>
<div class="line"><span class="lineno"> 1768</span>  <span class="keywordtype">int</span> hash;</div>
<div class="line"><span class="lineno"> 1769</span> </div>
<div class="line"><span class="lineno"> 1770</span>  <span class="keywordflow">switch</span> (<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[2].<a class="code hl_variable" href="pointer_8h.html#aeeddce917cf130d62c370b8f216026dd">a</a>) {</div>
<div class="line"><span class="lineno"> 1771</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa1982e3db182a679514674f454e2b79ad">YH_ALGO_RSA_PKCS1_SHA1</a>:</div>
<div class="line"><span class="lineno"> 1772</span>      hash = <a class="code hl_enumvalue" href="yubihsm_2common_2hash_8h.html#a488906826f8aaf7e850c35889d560089a970f17bf10faf2a31f535116e97f6b4a">_SHA1</a>;</div>
<div class="line"><span class="lineno"> 1773</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1774</span> </div>
<div class="line"><span class="lineno"> 1775</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa18e17370fcf9a829572e57608aff743c">YH_ALGO_RSA_PKCS1_SHA256</a>:</div>
<div class="line"><span class="lineno"> 1776</span>      hash = <a class="code hl_enumvalue" href="yubihsm_2common_2hash_8h.html#a488906826f8aaf7e850c35889d560089af0ab1a9d65ceafa4ba1f6f177e379258">_SHA256</a>;</div>
<div class="line"><span class="lineno"> 1777</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1778</span> </div>
<div class="line"><span class="lineno"> 1779</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caafc78c2f62fe0a185c38d2644755fde2c">YH_ALGO_RSA_PKCS1_SHA384</a>:</div>
<div class="line"><span class="lineno"> 1780</span>      hash = <a class="code hl_enumvalue" href="yubihsm_2common_2hash_8h.html#a488906826f8aaf7e850c35889d560089a46254673795a1d78b2d84adbf88d8bb2">_SHA384</a>;</div>
<div class="line"><span class="lineno"> 1781</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1782</span> </div>
<div class="line"><span class="lineno"> 1783</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa84e18ba6561d5a834dc8d794504708db">YH_ALGO_RSA_PKCS1_SHA512</a>:</div>
<div class="line"><span class="lineno"> 1784</span>      hash = <a class="code hl_enumvalue" href="yubihsm_2common_2hash_8h.html#a488906826f8aaf7e850c35889d560089a0dbf438178c608dea7392e75c9b7ae2d">_SHA512</a>;</div>
<div class="line"><span class="lineno"> 1785</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1786</span> </div>
<div class="line"><span class="lineno"> 1787</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 1788</span>      fprintf(stderr, <span class="stringliteral">&quot;Invalid hash algorithm\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1789</span>      <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 1790</span>  }</div>
<div class="line"><span class="lineno"> 1791</span> </div>
<div class="line"><span class="lineno"> 1792</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="hash_8c.html#a062ee0f36e0c16725c22a5d9d964a8cd">hash_bytes</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[3].x, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[3].<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>, hash, data, &amp;data_len) == <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 1793</span>    fprintf(stderr, <span class="stringliteral">&quot;Unable to hash file\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1794</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 1795</span>  }</div>
<div class="line"><span class="lineno"> 1796</span> </div>
<div class="line"><span class="lineno"> 1797</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#aa0a7644b7b368d6aaf8b4aff5e3d19b8">yh_util_sign_pkcs1v1_5</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].w, <span class="keyword">true</span>, data, data_len,</div>
<div class="line"><span class="lineno"> 1798</span>                               response, &amp;response_len);</div>
<div class="line"><span class="lineno"> 1799</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 1800</span>    fprintf(stderr, <span class="stringliteral">&quot;Failed to sign data with PKCS#1v1.5: %s\n&quot;</span>,</div>
<div class="line"><span class="lineno"> 1801</span>            <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 1802</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 1803</span>  }</div>
<div class="line"><span class="lineno"> 1804</span> </div>
<div class="line"><span class="lineno"> 1805</span>  <a class="code hl_function" href="util_8c.html#ad969d220471d10a9f07080b50210f403">write_file</a>(response, response_len, ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>, fmt_to_fmt(fmt));</div>
<div class="line"><span class="lineno"> 1806</span> </div>
<div class="line"><span class="lineno"> 1807</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1808</span>}</div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caa1982e3db182a679514674f454e2b79ad"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa1982e3db182a679514674f454e2b79ad">YH_ALGO_RSA_PKCS1_SHA1</a></div><div class="ttdeci">@ YH_ALGO_RSA_PKCS1_SHA1</div><div class="ttdoc">rsa-pkcs1-sha1</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00392">yubihsm.h:392</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_a98cf5e35ce2e4fd5881d8b6e7a890357_cgraph.png" border="0" usemap="#acommands_8c_a98cf5e35ce2e4fd5881d8b6e7a890357_cgraph" alt=""/></div>
<map name="acommands_8c_a98cf5e35ce2e4fd5881d8b6e7a890357_cgraph" id="acommands_8c_a98cf5e35ce2e4fd5881d8b6e7a890357_cgraph">
<area shape="rect" title=" " alt="" coords="5,119,174,144"/>
<area shape="rect" href="hash_8c.html#a062ee0f36e0c16725c22a5d9d964a8cd" title=" " alt="" coords="258,19,346,44"/>
<area shape="poly" title=" " alt="" coords="118,116,257,49,260,54,120,120"/>
<area shape="rect" href="util_8c.html#ad969d220471d10a9f07080b50210f403" title=" " alt="" coords="265,93,338,119"/>
<area shape="poly" title=" " alt="" coords="174,119,250,110,250,115,175,124"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="850,205,933,231"/>
<area shape="poly" title=" " alt="" coords="121,142,168,161,222,178,307,195,395,207,568,220,721,222,834,219,834,224,721,228,568,226,394,213,307,200,221,183,166,166,119,147"/>
<area shape="rect" href="yubihsm_8c.html#aa0a7644b7b368d6aaf8b4aff5e3d19b8" title=" " alt="" coords="222,143,382,168"/>
<area shape="poly" title=" " alt="" coords="175,138,206,142,206,147,174,144"/>
<area shape="rect" href="hash_8c.html#a2de35447908a9afccca42825a87854fb" title=" " alt="" coords="467,5,541,31"/>
<area shape="poly" title=" " alt="" coords="346,26,452,19,452,24,347,31"/>
<area shape="poly" title=" " alt="" coords="363,166,430,178,654,202,834,213,834,218,654,207,430,183,362,172"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="856,107,927,132"/>
<area shape="poly" title=" " alt="" coords="348,139,431,119,541,99,666,87,730,87,792,92,842,102,841,107,791,97,729,92,666,92,542,104,432,124,350,145"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="430,143,578,168"/>
<area shape="poly" title=" " alt="" coords="383,153,414,153,414,158,383,158"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="626,107,792,132"/>
<area shape="poly" title=" " alt="" coords="578,140,617,133,618,138,579,145"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="644,156,774,182"/>
<area shape="poly" title=" " alt="" coords="579,158,629,161,628,166,578,163"/>
<area shape="poly" title=" " alt="" coords="771,131,793,141,809,154,818,166,827,179,841,192,846,195,843,200,838,196,823,183,814,170,805,158,790,146,769,135"/>
<area shape="poly" title=" " alt="" coords="792,117,840,117,840,122,792,122"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="857,57,926,83"/>
<area shape="poly" title=" " alt="" coords="759,103,841,81,843,86,760,109"/>
<area shape="poly" title=" " alt="" coords="760,180,835,200,834,206,759,185"/>
<area shape="poly" title=" " alt="" coords="759,153,840,130,841,136,760,158"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="840,156,943,182"/>
<area shape="poly" title=" " alt="" coords="775,166,824,166,824,172,775,172"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_a98cf5e35ce2e4fd5881d8b6e7a890357_icgraph.png" border="0" usemap="#acommands_8c_a98cf5e35ce2e4fd5881d8b6e7a890357_icgraph" alt=""/></div>
<map name="acommands_8c_a98cf5e35ce2e4fd5881d8b6e7a890357_icgraph" id="acommands_8c_a98cf5e35ce2e4fd5881d8b6e7a890357_icgraph">
<area shape="rect" title=" " alt="" coords="296,31,464,56"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="280,34,248,30,249,24,281,29"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,31,55,56"/>
<area shape="poly" title=" " alt="" coords="280,46,55,46,55,41,280,41"/>
<area shape="poly" title=" " alt="" coords="88,36,55,42,54,37,87,31"/>
</map>
</div>

</div>
</div>
<a id="a1dcbe3dfaa3722ae6e9246527b889627" name="a1dcbe3dfaa3722ae6e9246527b889627"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1dcbe3dfaa3722ae6e9246527b889627">&#9670;&#160;</a></span>yh_com_sign_pss()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int yh_com_sign_pss </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__context.html">yubihsm_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_argument.html">Argument</a> *</td>          <td class="paramname"><span class="paramname"><em>argv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a></td>          <td class="paramname"><span class="paramname"><em>fmt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="commands_8c_source.html#l01816">1816</a> of file <a class="el" href="commands_8c_source.html">commands.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1816</span>                                                                          {</div>
<div class="line"><span class="lineno"> 1817</span> </div>
<div class="line"><span class="lineno"> 1818</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 1819</span> </div>
<div class="line"><span class="lineno"> 1820</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> data[<a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a>];</div>
<div class="line"><span class="lineno"> 1821</span>  <span class="keywordtype">size_t</span> data_len;</div>
<div class="line"><span class="lineno"> 1822</span> </div>
<div class="line"><span class="lineno"> 1823</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> response[<a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a>];</div>
<div class="line"><span class="lineno"> 1824</span>  <span class="keywordtype">size_t</span> response_len = <span class="keyword">sizeof</span>(response);</div>
<div class="line"><span class="lineno"> 1825</span> </div>
<div class="line"><span class="lineno"> 1826</span>  <span class="keywordtype">int</span> hash;</div>
<div class="line"><span class="lineno"> 1827</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55ca">yh_algorithm</a> mgf;</div>
<div class="line"><span class="lineno"> 1828</span> </div>
<div class="line"><span class="lineno"> 1829</span>  <span class="keywordflow">switch</span> (<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[2].<a class="code hl_variable" href="pointer_8h.html#aeeddce917cf130d62c370b8f216026dd">a</a>) {</div>
<div class="line"><span class="lineno"> 1830</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa24d40fa957c584cf2ef0f5b0053b9f32">YH_ALGO_RSA_PSS_SHA1</a>:</div>
<div class="line"><span class="lineno"> 1831</span>      hash = <a class="code hl_enumvalue" href="yubihsm_2common_2hash_8h.html#a488906826f8aaf7e850c35889d560089a970f17bf10faf2a31f535116e97f6b4a">_SHA1</a>;</div>
<div class="line"><span class="lineno"> 1832</span>      mgf = <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caae1ab21f2df42a56bdc8ff046ed14797a">YH_ALGO_MGF1_SHA1</a>;</div>
<div class="line"><span class="lineno"> 1833</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1834</span> </div>
<div class="line"><span class="lineno"> 1835</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caac42381f876f5e7190547cf81021451f5">YH_ALGO_RSA_PSS_SHA256</a>:</div>
<div class="line"><span class="lineno"> 1836</span>      hash = <a class="code hl_enumvalue" href="yubihsm_2common_2hash_8h.html#a488906826f8aaf7e850c35889d560089af0ab1a9d65ceafa4ba1f6f177e379258">_SHA256</a>;</div>
<div class="line"><span class="lineno"> 1837</span>      mgf = <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caae3f68121c91d613fe450c12fad55eab2">YH_ALGO_MGF1_SHA256</a>;</div>
<div class="line"><span class="lineno"> 1838</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1839</span> </div>
<div class="line"><span class="lineno"> 1840</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa144083d6414cb33e8543d51e7d361d05">YH_ALGO_RSA_PSS_SHA384</a>:</div>
<div class="line"><span class="lineno"> 1841</span>      hash = <a class="code hl_enumvalue" href="yubihsm_2common_2hash_8h.html#a488906826f8aaf7e850c35889d560089a46254673795a1d78b2d84adbf88d8bb2">_SHA384</a>;</div>
<div class="line"><span class="lineno"> 1842</span>      mgf = <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa788440387af34a9aa10a3e5561c8ee31">YH_ALGO_MGF1_SHA384</a>;</div>
<div class="line"><span class="lineno"> 1843</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1844</span> </div>
<div class="line"><span class="lineno"> 1845</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa1d5a50a1a53000cd2b2989c17703e2d1">YH_ALGO_RSA_PSS_SHA512</a>:</div>
<div class="line"><span class="lineno"> 1846</span>      hash = <a class="code hl_enumvalue" href="yubihsm_2common_2hash_8h.html#a488906826f8aaf7e850c35889d560089a0dbf438178c608dea7392e75c9b7ae2d">_SHA512</a>;</div>
<div class="line"><span class="lineno"> 1847</span>      mgf = <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa104308e8fac7553b1d875f149ff133b1">YH_ALGO_MGF1_SHA512</a>;</div>
<div class="line"><span class="lineno"> 1848</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1849</span> </div>
<div class="line"><span class="lineno"> 1850</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 1851</span>      fprintf(stderr, <span class="stringliteral">&quot;Invalid hash algorithm\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1852</span>      <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 1853</span>  }</div>
<div class="line"><span class="lineno"> 1854</span> </div>
<div class="line"><span class="lineno"> 1855</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="hash_8c.html#a062ee0f36e0c16725c22a5d9d964a8cd">hash_bytes</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[3].x, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[3].<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>, hash, data, &amp;data_len) == <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 1856</span>    fprintf(stderr, <span class="stringliteral">&quot;Unable to hash file\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1857</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 1858</span>  }</div>
<div class="line"><span class="lineno"> 1859</span> </div>
<div class="line"><span class="lineno"> 1860</span>  <span class="comment">// NOTE(adma): Salt length always matches the length of the hash</span></div>
<div class="line"><span class="lineno"> 1861</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#a944e6f31487857709f032598fd43fef5">yh_util_sign_pss</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].w, data, data_len, response,</div>
<div class="line"><span class="lineno"> 1862</span>                         &amp;response_len, data_len, mgf);</div>
<div class="line"><span class="lineno"> 1863</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 1864</span>    fprintf(stderr, <span class="stringliteral">&quot;Failed to sign data with PSS: %s\n&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 1865</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 1866</span>  }</div>
<div class="line"><span class="lineno"> 1867</span> </div>
<div class="line"><span class="lineno"> 1868</span>  <a class="code hl_function" href="util_8c.html#ad969d220471d10a9f07080b50210f403">write_file</a>(response, response_len, ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>, fmt_to_fmt(fmt));</div>
<div class="line"><span class="lineno"> 1869</span> </div>
<div class="line"><span class="lineno"> 1870</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1871</span>}</div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caa24d40fa957c584cf2ef0f5b0053b9f32"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa24d40fa957c584cf2ef0f5b0053b9f32">YH_ALGO_RSA_PSS_SHA1</a></div><div class="ttdeci">@ YH_ALGO_RSA_PSS_SHA1</div><div class="ttdoc">rsa-pss-sha1</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00400">yubihsm.h:400</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_a1dcbe3dfaa3722ae6e9246527b889627_cgraph.png" border="0" usemap="#acommands_8c_a1dcbe3dfaa3722ae6e9246527b889627_cgraph" alt=""/></div>
<map name="acommands_8c_a1dcbe3dfaa3722ae6e9246527b889627_cgraph" id="acommands_8c_a1dcbe3dfaa3722ae6e9246527b889627_cgraph">
<area shape="rect" title=" " alt="" coords="5,119,132,144"/>
<area shape="rect" href="hash_8c.html#a062ee0f36e0c16725c22a5d9d964a8cd" title=" " alt="" coords="195,19,283,44"/>
<area shape="poly" title=" " alt="" coords="91,116,201,50,203,55,94,120"/>
<area shape="rect" href="util_8c.html#ad969d220471d10a9f07080b50210f403" title=" " alt="" coords="202,93,276,119"/>
<area shape="poly" title=" " alt="" coords="132,119,186,111,187,116,133,125"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="766,205,849,231"/>
<area shape="poly" title=" " alt="" coords="96,143,135,161,180,178,259,197,339,211,420,220,499,224,642,225,750,220,750,226,643,231,499,230,420,225,339,216,257,203,179,183,133,166,93,147"/>
<area shape="rect" href="yubihsm_8c.html#a944e6f31487857709f032598fd43fef5" title=" " alt="" coords="180,143,298,168"/>
<area shape="poly" title=" " alt="" coords="133,138,165,142,164,148,132,143"/>
<area shape="rect" href="hash_8c.html#a2de35447908a9afccca42825a87854fb" title=" " alt="" coords="383,5,457,31"/>
<area shape="poly" title=" " alt="" coords="283,26,367,19,368,25,284,31"/>
<area shape="poly" title=" " alt="" coords="290,166,346,178,458,193,570,203,750,214,750,219,569,209,458,198,346,183,289,172"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="772,107,843,132"/>
<area shape="poly" title=" " alt="" coords="284,139,363,119,469,99,587,87,648,87,708,92,758,102,757,107,707,97,648,92,588,93,469,105,364,124,285,145"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="346,143,494,168"/>
<area shape="poly" title=" " alt="" coords="298,153,330,153,330,158,298,158"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="542,107,708,132"/>
<area shape="poly" title=" " alt="" coords="494,140,533,133,534,138,495,145"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="560,156,690,182"/>
<area shape="poly" title=" " alt="" coords="495,158,545,161,544,166,494,163"/>
<area shape="poly" title=" " alt="" coords="687,131,709,141,725,154,734,166,743,179,757,192,762,195,759,200,754,196,739,183,730,170,721,158,706,146,685,135"/>
<area shape="poly" title=" " alt="" coords="708,117,756,117,756,122,708,122"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="773,57,842,83"/>
<area shape="poly" title=" " alt="" coords="675,103,757,81,759,86,676,109"/>
<area shape="poly" title=" " alt="" coords="676,180,751,200,750,206,675,185"/>
<area shape="poly" title=" " alt="" coords="675,153,756,130,757,136,676,158"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="756,156,859,182"/>
<area shape="poly" title=" " alt="" coords="691,166,740,166,740,172,691,172"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_a1dcbe3dfaa3722ae6e9246527b889627_icgraph.png" border="0" usemap="#acommands_8c_a1dcbe3dfaa3722ae6e9246527b889627_icgraph" alt=""/></div>
<map name="acommands_8c_a1dcbe3dfaa3722ae6e9246527b889627_icgraph" id="acommands_8c_a1dcbe3dfaa3722ae6e9246527b889627_icgraph">
<area shape="rect" title=" " alt="" coords="296,31,422,56"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="280,35,248,31,249,26,281,30"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,31,55,56"/>
<area shape="poly" title=" " alt="" coords="281,46,55,46,55,41,281,41"/>
<area shape="poly" title=" " alt="" coords="88,36,55,42,54,37,87,31"/>
</map>
</div>

</div>
</div>
<a id="a03581158b5703a0ffe866d50d8a3982d" name="a03581158b5703a0ffe866d50d8a3982d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03581158b5703a0ffe866d50d8a3982d">&#9670;&#160;</a></span>yh_com_sign_ssh_certificate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int yh_com_sign_ssh_certificate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__context.html">yubihsm_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_argument.html">Argument</a> *</td>          <td class="paramname"><span class="paramname"><em>argv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="yubihsm-shell_8h.html#a78db5959e08d52cc64e7032bf1b1e708">cmd_format</a></td>          <td class="paramname"><span class="paramname"><em>fmt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="commands_8c_source.html#l01995">1995</a> of file <a class="el" href="commands_8c_source.html">commands.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1996</span>                                                {</div>
<div class="line"><span class="lineno"> 1997</span> </div>
<div class="line"><span class="lineno"> 1998</span>  <a class="code hl_define" href="yubihsm__pkcs11_8c.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(fmt); <span class="comment">// TODO: respect output format</span></div>
<div class="line"><span class="lineno"> 1999</span> </div>
<div class="line"><span class="lineno"> 2000</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 2001</span> </div>
<div class="line"><span class="lineno"> 2002</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> data[<a class="code hl_define" href="yubihsm_8h.html#a706bd8e7adf0de85e6cfb0efc8981d3f">YH_MSG_BUF_SIZE</a> + 1024];</div>
<div class="line"><span class="lineno"> 2003</span>  <span class="keywordtype">size_t</span> response_len = <span class="keyword">sizeof</span>(data);</div>
<div class="line"><span class="lineno"> 2004</span> </div>
<div class="line"><span class="lineno"> 2005</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(data, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[4].x, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[4].<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>);</div>
<div class="line"><span class="lineno"> 2006</span>  response_len -= <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[4].len;</div>
<div class="line"><span class="lineno"> 2007</span> </div>
<div class="line"><span class="lineno"> 2008</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#a45c32b993856be818a70c0ffad589cbd">yh_util_sign_ssh_certificate</a>(<a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[0].e, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[1].w, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[2].w, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[3].<a class="code hl_variable" href="pointer_8h.html#aeeddce917cf130d62c370b8f216026dd">a</a>,</div>
<div class="line"><span class="lineno"> 2009</span>                                     data, <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[4].<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>, data + <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[4].<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>,</div>
<div class="line"><span class="lineno"> 2010</span>                                     &amp;response_len);</div>
<div class="line"><span class="lineno"> 2011</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 2012</span>    fprintf(stderr, <span class="stringliteral">&quot;Failed to get certificate signature: %s\n&quot;</span>,</div>
<div class="line"><span class="lineno"> 2013</span>            <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 2014</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 2015</span>  }</div>
<div class="line"><span class="lineno"> 2016</span> </div>
<div class="line"><span class="lineno"> 2017</span>  BIO *bio;</div>
<div class="line"><span class="lineno"> 2018</span>  BIO *b64;</div>
<div class="line"><span class="lineno"> 2019</span>  BUF_MEM *bufferPtr;</div>
<div class="line"><span class="lineno"> 2020</span> </div>
<div class="line"><span class="lineno"> 2021</span>  b64 = BIO_new(BIO_f_base64());</div>
<div class="line"><span class="lineno"> 2022</span>  bio = BIO_new(BIO_s_mem());</div>
<div class="line"><span class="lineno"> 2023</span>  bio = BIO_push(b64, bio);</div>
<div class="line"><span class="lineno"> 2024</span> </div>
<div class="line"><span class="lineno"> 2025</span>  (void) BIO_set_flags(bio, BIO_FLAGS_BASE64_NO_NL);</div>
<div class="line"><span class="lineno"> 2026</span>  (void) BIO_write(bio, data + 4 + 256,</div>
<div class="line"><span class="lineno"> 2027</span>                   <a class="code hl_variable" href="hello__driver_8cpp.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[4].<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> + response_len - 4 -</div>
<div class="line"><span class="lineno"> 2028</span>                     256); <span class="comment">// TODO(adma): FIXME, unmagify</span></div>
<div class="line"><span class="lineno"> 2029</span>  (void) BIO_flush(bio);</div>
<div class="line"><span class="lineno"> 2030</span>  (void) BIO_get_mem_ptr(bio, &amp;bufferPtr);</div>
<div class="line"><span class="lineno"> 2031</span> </div>
<div class="line"><span class="lineno"> 2032</span>  <span class="keyword">const</span> <span class="keywordtype">char</span> *ssh_cert_str =</div>
<div class="line"><span class="lineno"> 2033</span>    <span class="stringliteral">&quot;ssh-rsa-cert-v01@openssh.com &quot;</span>; <span class="comment">// TODO(adma): ECDSA</span></div>
<div class="line"><span class="lineno"> 2034</span> </div>
<div class="line"><span class="lineno"> 2035</span>  <span class="keywordflow">if</span> (fwrite(ssh_cert_str, 1, strlen(ssh_cert_str), ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>) !=</div>
<div class="line"><span class="lineno"> 2036</span>        strlen(ssh_cert_str) ||</div>
<div class="line"><span class="lineno"> 2037</span>      ferror(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>)) {</div>
<div class="line"><span class="lineno"> 2038</span>    fprintf(stderr, <span class="stringliteral">&quot;Unable to write data to file\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 2039</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 2040</span>  }</div>
<div class="line"><span class="lineno"> 2041</span> </div>
<div class="line"><span class="lineno"> 2042</span>  <span class="keywordflow">if</span> (fwrite(bufferPtr-&gt;data, 1, bufferPtr-&gt;length, ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>) !=</div>
<div class="line"><span class="lineno"> 2043</span>        bufferPtr-&gt;length ||</div>
<div class="line"><span class="lineno"> 2044</span>      ferror(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>)) {</div>
<div class="line"><span class="lineno"> 2045</span>    fprintf(stderr, <span class="stringliteral">&quot;Unable to write data to file\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 2046</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 2047</span>  }</div>
<div class="line"><span class="lineno"> 2048</span> </div>
<div class="line"><span class="lineno"> 2049</span>  <span class="keywordflow">if</span> (fwrite(<span class="stringliteral">&quot;\n&quot;</span>, 1, 1, ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>) != 1 || ferror(ctx-&gt;<a class="code hl_variable" href="structyubihsm__context.html#a29e0cb7941d3bd7580d8e23c6e18e67d">out</a>)) {</div>
<div class="line"><span class="lineno"> 2050</span>    fprintf(stderr, <span class="stringliteral">&quot;Unable to write data to file\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 2051</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 2052</span>  }</div>
<div class="line"><span class="lineno"> 2053</span> </div>
<div class="line"><span class="lineno"> 2054</span>  (void) BIO_free_all(bio); <span class="comment">// TODO: fix this leak.</span></div>
<div class="line"><span class="lineno"> 2055</span> </div>
<div class="line"><span class="lineno"> 2056</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 2057</span>}</div>
<div class="ttc" id="ayubihsm_8c_html_a45c32b993856be818a70c0ffad589cbd"><div class="ttname"><a href="yubihsm_8c.html#a45c32b993856be818a70c0ffad589cbd">yh_util_sign_ssh_certificate</a></div><div class="ttdeci">yh_rc yh_util_sign_ssh_certificate(yh_session *session, uint16_t key_id, uint16_t template_id, yh_algorithm sig_algo, const uint8_t *in, size_t in_len, uint8_t *out, size_t *out_len)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l02745">yubihsm.c:2745</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_ae785d5badbf1f08b491af31f32a135a1"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a></div><div class="ttdeci">memcpy((char *) pInfo-&gt;slotDescription, s, l)</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_a03581158b5703a0ffe866d50d8a3982d_cgraph.png" border="0" usemap="#acommands_8c_a03581158b5703a0ffe866d50d8a3982d_cgraph" alt=""/></div>
<map name="acommands_8c_a03581158b5703a0ffe866d50d8a3982d_cgraph" id="acommands_8c_a03581158b5703a0ffe866d50d8a3982d_cgraph">
<area shape="rect" title=" " alt="" coords="5,80,196,106"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="900,5,971,31"/>
<area shape="poly" title=" " alt="" coords="172,77,243,65,456,33,550,22,670,13,753,11,836,13,885,14,884,19,836,18,753,16,670,18,550,27,457,38,244,70,173,82"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="894,153,977,179"/>
<area shape="poly" title=" " alt="" coords="172,104,244,116,457,144,670,161,781,164,878,164,878,170,781,170,670,166,456,149,243,121,171,109"/>
<area shape="rect" href="yubihsm_8c.html#a45c32b993856be818a70c0ffad589cbd" title=" " alt="" coords="244,80,426,106"/>
<area shape="poly" title=" " alt="" coords="196,90,228,90,228,96,196,96"/>
<area shape="poly" title=" " alt="" coords="405,77,474,65,703,36,884,19,884,25,703,41,474,70,406,82"/>
<area shape="poly" title=" " alt="" coords="405,104,474,116,698,143,878,159,878,165,698,149,474,121,404,109"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="474,80,622,106"/>
<area shape="poly" title=" " alt="" coords="426,90,459,90,459,96,426,96"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="670,55,836,80"/>
<area shape="poly" title=" " alt="" coords="622,81,654,77,655,82,623,86"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="688,104,818,130"/>
<area shape="poly" title=" " alt="" coords="623,99,673,105,672,110,622,104"/>
<area shape="poly" title=" " alt="" coords="803,51,884,29,885,34,804,57"/>
<area shape="poly" title=" " alt="" coords="815,79,837,89,853,102,862,114,871,127,885,140,890,143,887,148,882,144,867,131,858,118,849,106,834,94,813,83"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="901,55,970,80"/>
<area shape="poly" title=" " alt="" coords="836,65,886,65,886,70,836,70"/>
<area shape="poly" title=" " alt="" coords="813,101,834,91,849,79,858,67,867,54,882,40,887,37,890,41,885,44,871,57,862,70,853,83,837,95,815,106"/>
<area shape="poly" title=" " alt="" coords="804,128,879,148,878,154,803,133"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="884,104,987,130"/>
<area shape="poly" title=" " alt="" coords="819,114,868,114,868,120,819,120"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="commands_8c_a03581158b5703a0ffe866d50d8a3982d_icgraph.png" border="0" usemap="#acommands_8c_a03581158b5703a0ffe866d50d8a3982d_icgraph" alt=""/></div>
<map name="acommands_8c_a03581158b5703a0ffe866d50d8a3982d_icgraph" id="acommands_8c_a03581158b5703a0ffe866d50d8a3982d_icgraph">
<area shape="rect" title=" " alt="" coords="296,31,486,56"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="280,33,248,29,249,24,281,28"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,31,55,56"/>
<area shape="poly" title=" " alt="" coords="281,46,55,46,55,41,281,41"/>
<area shape="poly" title=" " alt="" coords="88,36,55,42,54,37,87,31"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_428556e0652617aa37d2f7d8bcaf7fdf.html">libraries</a></li><li class="navelem"><a class="el" href="dir_63c6fe01b05f3098165849fc89c17214.html">yubihsm</a></li><li class="navelem"><a class="el" href="dir_cbab2aa3b8ca6070936586c5dc86eccd.html">src</a></li><li class="navelem"><a class="el" href="commands_8c.html">commands.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0 </li>
  </ul>
</div>
</body>
</html>
