<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Wire Sysio: sysio::chain::block_log Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Wire Sysio<span id="projectnumber">&#160;Wire Sysion 1.0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('classsysio_1_1chain_1_1block__log.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pub-static-attribs">Static Public Attributes</a> &#124;
<a href="classsysio_1_1chain_1_1block__log-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">sysio::chain::block_log Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="block__log_8hpp_source.html">block_log.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a5e277b1da07f22d861b769530b837f1d" id="r_a5e277b1da07f22d861b769530b837f1d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5e277b1da07f22d861b769530b837f1d">block_log</a> (const <a class="el" href="classfc_1_1path.html">fc::path</a> &amp;data_dir, std::optional&lt; <a class="el" href="structsysio_1_1chain_1_1block__log__prune__config.html">block_log_prune_config</a> &gt; prune_config)</td></tr>
<tr class="separator:a5e277b1da07f22d861b769530b837f1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44334e862c35e26e7973371da450bbb8" id="r_a44334e862c35e26e7973371da450bbb8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a44334e862c35e26e7973371da450bbb8">block_log</a> (<a class="el" href="classsysio_1_1chain_1_1block__log.html">block_log</a> &amp;&amp;other)</td></tr>
<tr class="separator:a44334e862c35e26e7973371da450bbb8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45c70cce7837458f4519a52979632e8d" id="r_a45c70cce7837458f4519a52979632e8d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a45c70cce7837458f4519a52979632e8d">~block_log</a> ()</td></tr>
<tr class="separator:a45c70cce7837458f4519a52979632e8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca2eca093aee072fc3f599a7c642a227" id="r_aca2eca093aee072fc3f599a7c642a227"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aca2eca093aee072fc3f599a7c642a227">append</a> (const <a class="el" href="namespacesysio_1_1chain.html#aa10ee348c57604b615bc8570f6685102">signed_block_ptr</a> &amp;b)</td></tr>
<tr class="separator:aca2eca093aee072fc3f599a7c642a227"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44ab2b550fcc2be7e0b0e98faabd1f21" id="r_a44ab2b550fcc2be7e0b0e98faabd1f21"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a44ab2b550fcc2be7e0b0e98faabd1f21">flush</a> ()</td></tr>
<tr class="separator:a44ab2b550fcc2be7e0b0e98faabd1f21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7c368f1aa0e3e827d619228c4e144bd" id="r_af7c368f1aa0e3e827d619228c4e144bd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af7c368f1aa0e3e827d619228c4e144bd">reset</a> (const <a class="el" href="structsysio_1_1chain_1_1genesis__state.html">genesis_state</a> &amp;gs, const <a class="el" href="namespacesysio_1_1chain.html#aa10ee348c57604b615bc8570f6685102">signed_block_ptr</a> &amp;genesis_block)</td></tr>
<tr class="separator:af7c368f1aa0e3e827d619228c4e144bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3217851a8fecc2e132751c35c1cb097" id="r_ad3217851a8fecc2e132751c35c1cb097"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad3217851a8fecc2e132751c35c1cb097">reset</a> (const <a class="el" href="structsysio_1_1chain_1_1chain__id__type.html">chain_id_type</a> &amp;chain_id, <a class="el" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="el" href="#ac5f1c1e78e72414fbf9bae75da42303e">first_block_num</a>)</td></tr>
<tr class="separator:ad3217851a8fecc2e132751c35c1cb097"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8649ead0a8c1e670284a8880747ee1bf" id="r_a8649ead0a8c1e670284a8880747ee1bf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacesysio_1_1chain.html#aa10ee348c57604b615bc8570f6685102">signed_block_ptr</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8649ead0a8c1e670284a8880747ee1bf">read_block</a> (<a class="el" href="stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a> file_pos) const</td></tr>
<tr class="separator:a8649ead0a8c1e670284a8880747ee1bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab651ea69962e02a5386194e4d7e055a0" id="r_ab651ea69962e02a5386194e4d7e055a0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab651ea69962e02a5386194e4d7e055a0">read_block_header</a> (<a class="el" href="structsysio_1_1chain_1_1block__header.html">block_header</a> &amp;bh, <a class="el" href="stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a> file_pos) const</td></tr>
<tr class="separator:ab651ea69962e02a5386194e4d7e055a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99c59d29b262144ad99eacc827f76107" id="r_a99c59d29b262144ad99eacc827f76107"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacesysio_1_1chain.html#aa10ee348c57604b615bc8570f6685102">signed_block_ptr</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a99c59d29b262144ad99eacc827f76107">read_block_by_num</a> (<a class="el" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> block_num) const</td></tr>
<tr class="separator:a99c59d29b262144ad99eacc827f76107"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ffacf2e1c69079d8c847a61d99b6219" id="r_a6ffacf2e1c69079d8c847a61d99b6219"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacesysio_1_1chain.html#a4b8e4b7ed9dcd18ee75d0de62e88aa17">block_id_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6ffacf2e1c69079d8c847a61d99b6219">read_block_id_by_num</a> (<a class="el" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> block_num) const</td></tr>
<tr class="separator:a6ffacf2e1c69079d8c847a61d99b6219"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93b930af1b79483fd4969b3eb4f9d08b" id="r_a93b930af1b79483fd4969b3eb4f9d08b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacesysio_1_1chain.html#aa10ee348c57604b615bc8570f6685102">signed_block_ptr</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a93b930af1b79483fd4969b3eb4f9d08b">read_block_by_id</a> (const <a class="el" href="namespacesysio_1_1chain.html#a4b8e4b7ed9dcd18ee75d0de62e88aa17">block_id_type</a> &amp;<a class="el" href="code__cache_8cpp.html#aa0efefe21f4700d78692edc823e763be">id</a>) const</td></tr>
<tr class="separator:a93b930af1b79483fd4969b3eb4f9d08b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad95f8bb0f2ccd5d0fd4db1a13eb3106a" id="r_ad95f8bb0f2ccd5d0fd4db1a13eb3106a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad95f8bb0f2ccd5d0fd4db1a13eb3106a">get_block_pos</a> (<a class="el" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> block_num) const</td></tr>
<tr class="separator:ad95f8bb0f2ccd5d0fd4db1a13eb3106a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2aa6dabbd33531db434a5e7325fde2e6" id="r_a2aa6dabbd33531db434a5e7325fde2e6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacesysio_1_1chain.html#aa10ee348c57604b615bc8570f6685102">signed_block_ptr</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2aa6dabbd33531db434a5e7325fde2e6">read_head</a> () const</td></tr>
<tr class="separator:a2aa6dabbd33531db434a5e7325fde2e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae787e7866ebfcd4c5dd5632c15c07c88" id="r_ae787e7866ebfcd4c5dd5632c15c07c88"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="namespacesysio_1_1chain.html#aa10ee348c57604b615bc8570f6685102">signed_block_ptr</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae787e7866ebfcd4c5dd5632c15c07c88">head</a> () const</td></tr>
<tr class="separator:ae787e7866ebfcd4c5dd5632c15c07c88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d0b6ecf420faffc4f00ba6af3d0af99" id="r_a4d0b6ecf420faffc4f00ba6af3d0af99"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="namespacesysio_1_1chain.html#a4b8e4b7ed9dcd18ee75d0de62e88aa17">block_id_type</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4d0b6ecf420faffc4f00ba6af3d0af99">head_id</a> () const</td></tr>
<tr class="separator:a4d0b6ecf420faffc4f00ba6af3d0af99"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5f1c1e78e72414fbf9bae75da42303e" id="r_ac5f1c1e78e72414fbf9bae75da42303e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac5f1c1e78e72414fbf9bae75da42303e">first_block_num</a> () const</td></tr>
<tr class="separator:ac5f1c1e78e72414fbf9bae75da42303e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-methods" name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a28d7828f2ef978077453c8b0f97f5c04" id="r_a28d7828f2ef978077453c8b0f97f5c04"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classfc_1_1path.html">fc::path</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a28d7828f2ef978077453c8b0f97f5c04">repair_log</a> (const <a class="el" href="classfc_1_1path.html">fc::path</a> &amp;data_dir, <a class="el" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> truncate_at_block=0, const char *reversible_block_dir_name=&quot;&quot;)</td></tr>
<tr class="separator:a28d7828f2ef978077453c8b0f97f5c04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c03de4dfe3908668418da4620af63e3" id="r_a0c03de4dfe3908668418da4620af63e3"><td class="memItemLeft" align="right" valign="top">static std::optional&lt; <a class="el" href="structsysio_1_1chain_1_1genesis__state.html">genesis_state</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0c03de4dfe3908668418da4620af63e3">extract_genesis_state</a> (const <a class="el" href="classfc_1_1path.html">fc::path</a> &amp;data_dir)</td></tr>
<tr class="separator:a0c03de4dfe3908668418da4620af63e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad17bd0904611f780b5d49ad14b363208" id="r_ad17bd0904611f780b5d49ad14b363208"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="structsysio_1_1chain_1_1chain__id__type.html">chain_id_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad17bd0904611f780b5d49ad14b363208">extract_chain_id</a> (const <a class="el" href="classfc_1_1path.html">fc::path</a> &amp;data_dir)</td></tr>
<tr class="separator:ad17bd0904611f780b5d49ad14b363208"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa470fc3f2a09d1204b1321ecd0fbed33" id="r_aa470fc3f2a09d1204b1321ecd0fbed33"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa470fc3f2a09d1204b1321ecd0fbed33">construct_index</a> (const <a class="el" href="classfc_1_1path.html">fc::path</a> &amp;block_file_name, const <a class="el" href="classfc_1_1path.html">fc::path</a> &amp;index_file_name)</td></tr>
<tr class="separator:aa470fc3f2a09d1204b1321ecd0fbed33"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad760661c5030845b1369fee21e08a909" id="r_ad760661c5030845b1369fee21e08a909"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad760661c5030845b1369fee21e08a909">contains_genesis_state</a> (<a class="el" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> version, <a class="el" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="el" href="#ac5f1c1e78e72414fbf9bae75da42303e">first_block_num</a>)</td></tr>
<tr class="separator:ad760661c5030845b1369fee21e08a909"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a370e648384d16b6d60ca211921501cc6" id="r_a370e648384d16b6d60ca211921501cc6"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a370e648384d16b6d60ca211921501cc6">contains_chain_id</a> (<a class="el" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> version, <a class="el" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="el" href="#ac5f1c1e78e72414fbf9bae75da42303e">first_block_num</a>)</td></tr>
<tr class="separator:a370e648384d16b6d60ca211921501cc6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5afbeabca60a1f842b83c107ec54cf99" id="r_a5afbeabca60a1f842b83c107ec54cf99"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5afbeabca60a1f842b83c107ec54cf99">is_supported_version</a> (<a class="el" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> version)</td></tr>
<tr class="separator:a5afbeabca60a1f842b83c107ec54cf99"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65b017352bcd2bdea5ed9d68af7215d1" id="r_a65b017352bcd2bdea5ed9d68af7215d1"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a65b017352bcd2bdea5ed9d68af7215d1">is_pruned_log</a> (const <a class="el" href="classfc_1_1path.html">fc::path</a> &amp;data_dir)</td></tr>
<tr class="separator:a65b017352bcd2bdea5ed9d68af7215d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00f24c3412cd6231b93394e2bbcea904" id="r_a00f24c3412cd6231b93394e2bbcea904"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a00f24c3412cd6231b93394e2bbcea904">trim_blocklog_front</a> (const <a class="el" href="classfc_1_1path.html">fc::path</a> &amp;<a class="el" href="programs_2sysio-launcher_2main_8cpp.html#a3426d59b828f63d073d546fed967330e">block_dir</a>, const <a class="el" href="classfc_1_1path.html">fc::path</a> &amp;temp_dir, <a class="el" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> truncate_at_block)</td></tr>
<tr class="separator:a00f24c3412cd6231b93394e2bbcea904"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-attribs" name="pub-static-attribs"></a>
Static Public Attributes</h2></td></tr>
<tr class="memitem:a02319a8bef22b7a167f17314c00b1ac1" id="r_a02319a8bef22b7a167f17314c00b1ac1"><td class="memItemLeft" align="right" valign="top">static const <a class="el" href="stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a02319a8bef22b7a167f17314c00b1ac1">npos</a> = std::numeric_limits&lt;<a class="el" href="stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a>&gt;::max()</td></tr>
<tr class="separator:a02319a8bef22b7a167f17314c00b1ac1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f0f031e0f64def456185998d462d35d" id="r_a8f0f031e0f64def456185998d462d35d"><td class="memItemLeft" align="right" valign="top">static const <a class="el" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8f0f031e0f64def456185998d462d35d">min_supported_version</a> = 1</td></tr>
<tr class="separator:a8f0f031e0f64def456185998d462d35d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add7716a8093b81e1a51ed52897e97770" id="r_add7716a8093b81e1a51ed52897e97770"><td class="memItemLeft" align="right" valign="top">static const <a class="el" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#add7716a8093b81e1a51ed52897e97770">max_supported_version</a> = 3</td></tr>
<tr class="separator:add7716a8093b81e1a51ed52897e97770"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock">
<p class="definition">Definition at line <a class="el" href="block__log_8hpp_source.html#l00045">45</a> of file <a class="el" href="block__log_8hpp_source.html">block_log.hpp</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a5e277b1da07f22d861b769530b837f1d" name="a5e277b1da07f22d861b769530b837f1d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e277b1da07f22d861b769530b837f1d">&#9670;&#160;</a></span>block_log() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sysio::chain::block_log::block_log </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classfc_1_1path.html">fc::path</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>data_dir</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::optional&lt; <a class="el" href="structsysio_1_1chain_1_1block__log__prune__config.html">block_log_prune_config</a> &gt;</td>          <td class="paramname"><span class="paramname"><em>prune_config</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="block__log_8cpp_source.html#l00222">222</a> of file <a class="el" href="block__log_8cpp_source.html">block_log.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  223</span>   :my(<span class="keyword">new</span> detail::block_log_impl(prune_config)) {</div>
<div class="line"><span class="lineno">  224</span>      open(data_dir);</div>
<div class="line"><span class="lineno">  225</span>   }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a44334e862c35e26e7973371da450bbb8" name="a44334e862c35e26e7973371da450bbb8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44334e862c35e26e7973371da450bbb8">&#9670;&#160;</a></span>block_log() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sysio::chain::block_log::block_log </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classsysio_1_1chain_1_1block__log.html">block_log</a> &amp;&amp;</td>          <td class="paramname"><span class="paramname"><em>other</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="block__log_8cpp_source.html#l00227">227</a> of file <a class="el" href="block__log_8cpp_source.html">block_log.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  227</span>                                         {</div>
<div class="line"><span class="lineno">  228</span>      my = std::move(<a class="code hl_enumvalue" href="namespace_c_l_i_1_1detail.html#ad707439590ee4ceafd3f41e0b5390617a795f3202b17cb6bc3d4b771d8c6c9eaf">other</a>.my);</div>
<div class="line"><span class="lineno">  229</span>   }</div>
<div class="ttc" id="anamespace_c_l_i_1_1detail_html_ad707439590ee4ceafd3f41e0b5390617a795f3202b17cb6bc3d4b771d8c6c9eaf"><div class="ttname"><a href="namespace_c_l_i_1_1detail.html#ad707439590ee4ceafd3f41e0b5390617a795f3202b17cb6bc3d4b771d8c6c9eaf">CLI::detail::object_category::other</a></div><div class="ttdeci">@ other</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a45c70cce7837458f4519a52979632e8d" name="a45c70cce7837458f4519a52979632e8d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a45c70cce7837458f4519a52979632e8d">&#9670;&#160;</a></span>~block_log()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sysio::chain::block_log::~block_log </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="block__log_8cpp_source.html#l00231">231</a> of file <a class="el" href="block__log_8cpp_source.html">block_log.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  231</span>                         {</div>
<div class="line"><span class="lineno">  232</span>      <span class="keywordflow">if</span> (my) {</div>
<div class="line"><span class="lineno">  233</span>         <a class="code hl_function" href="#a44ab2b550fcc2be7e0b0e98faabd1f21">flush</a>();</div>
<div class="line"><span class="lineno">  234</span>         my-&gt;try_exit_vacuum();</div>
<div class="line"><span class="lineno">  235</span>         my-&gt;close();</div>
<div class="line"><span class="lineno">  236</span>         my.reset();</div>
<div class="line"><span class="lineno">  237</span>      }</div>
<div class="line"><span class="lineno">  238</span>   }</div>
<div class="ttc" id="aclasssysio_1_1chain_1_1block__log_html_a44ab2b550fcc2be7e0b0e98faabd1f21"><div class="ttname"><a href="#a44ab2b550fcc2be7e0b0e98faabd1f21">sysio::chain::block_log::flush</a></div><div class="ttdeci">void flush()</div><div class="ttdef"><b>Definition</b> <a href="block__log_8cpp_source.html#l00426">block_log.cpp:426</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classsysio_1_1chain_1_1block__log_a45c70cce7837458f4519a52979632e8d_cgraph.png" border="0" usemap="#aclasssysio_1_1chain_1_1block__log_a45c70cce7837458f4519a52979632e8d_cgraph" alt=""/></div>
<map name="aclasssysio_1_1chain_1_1block__log_a45c70cce7837458f4519a52979632e8d_cgraph" id="aclasssysio_1_1chain_1_1block__log_a45c70cce7837458f4519a52979632e8d_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,136,46"/>
<area shape="rect" href="classsysio_1_1chain_1_1block__log.html#a44ab2b550fcc2be7e0b0e98faabd1f21" title=" " alt="" coords="184,5,314,46"/>
<area shape="poly" title=" " alt="" coords="136,23,168,23,168,28,136,28"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="aca2eca093aee072fc3f599a7c642a227" name="aca2eca093aee072fc3f599a7c642a227"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca2eca093aee072fc3f599a7c642a227">&#9670;&#160;</a></span>append()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sysio::chain::block_log::append </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespacesysio_1_1chain.html#aa10ee348c57604b615bc8570f6685102">signed_block_ptr</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>b</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="block__log_8cpp_source.html#l00358">358</a> of file <a class="el" href="block__log_8cpp_source.html">block_log.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  358</span>                                                   {</div>
<div class="line"><span class="lineno">  359</span>      my-&gt;append(b);</div>
<div class="line"><span class="lineno">  360</span>   }</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classsysio_1_1chain_1_1block__log_aca2eca093aee072fc3f599a7c642a227_icgraph.png" border="0" usemap="#aclasssysio_1_1chain_1_1block__log_aca2eca093aee072fc3f599a7c642a227_icgraph" alt=""/></div>
<map name="aclasssysio_1_1chain_1_1block__log_aca2eca093aee072fc3f599a7c642a227_icgraph" id="aclasssysio_1_1chain_1_1block__log_aca2eca093aee072fc3f599a7c642a227_icgraph">
<area shape="rect" title=" " alt="" coords="1452,88,1582,129"/>
<area shape="rect" href="structsysio_1_1chain_1_1controller__impl.html#ad0130874bac31eb408dd6e766084b814" title=" " alt="" coords="1251,88,1404,129"/>
<area shape="poly" title=" " alt="" coords="1436,111,1404,111,1404,106,1436,106"/>
<area shape="rect" href="structsysio_1_1chain_1_1controller__impl.html#abde6bacce9f720ad552d0e342c52d3b4" title="finalize_block" alt="" coords="1051,5,1203,46"/>
<area shape="poly" title=" " alt="" coords="1261,84,1178,49,1180,44,1263,79"/>
<area shape="rect" href="structsysio_1_1chain_1_1controller__impl.html#af15d89f9220ba97aa5c521e643746587" title=" " alt="" coords="622,109,803,150"/>
<area shape="poly" title=" " alt="" coords="1236,114,803,129,803,124,1236,109"/>
<area shape="rect" href="structsysio_1_1chain_1_1controller__impl.html#ac2d3794f1bd0ff1bd5837d8ead15d289" title=" " alt="" coords="414,167,566,207"/>
<area shape="poly" title=" " alt="" coords="1236,122,1204,126,803,164,567,184,567,179,802,159,1203,120,1236,117"/>
<area shape="rect" href="structsysio_1_1chain_1_1controller__impl.html#aaf795677a1a49a35ac1a819a1a157929" title=" " alt="" coords="851,55,1003,95"/>
<area shape="poly" title=" " alt="" coords="1036,51,1004,59,1003,54,1035,46"/>
<area shape="poly" title=" " alt="" coords="1019,80,1251,99,1251,105,1018,85"/>
<area shape="poly" title=" " alt="" coords="836,101,796,111,794,106,835,96"/>
<area shape="rect" href="structsysio_1_1chain_1_1controller__impl.html#a2fe4194f0202db6c18bc17572b2adaa2" title=" " alt="" coords="406,52,574,93"/>
<area shape="poly" title=" " alt="" coords="836,77,575,76,575,70,836,72"/>
<area shape="rect" href="structsysio_1_1chain_1_1controller__impl.html#a9efbc515682ae5dede91184c36af73f7" title=" " alt="" coords="5,81,158,122"/>
<area shape="poly" title=" " alt="" coords="607,128,158,108,158,102,607,122"/>
<area shape="poly" title=" " alt="" coords="617,157,568,170,566,165,616,152"/>
<area shape="poly" title=" " alt="" coords="616,108,571,96,572,91,617,102"/>
<area shape="rect" href="structsysio_1_1chain_1_1controller__impl.html#a9a9e4b6fe15eb93e63ac98af9f170647" title=" " alt="" coords="206,52,358,93"/>
<area shape="poly" title=" " alt="" coords="391,75,359,75,359,70,391,70"/>
<area shape="poly" title=" " alt="" coords="191,88,158,93,158,88,190,83"/>
</map>
</div>

</div>
</div>
<a id="aa470fc3f2a09d1204b1321ecd0fbed33" name="aa470fc3f2a09d1204b1321ecd0fbed33"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa470fc3f2a09d1204b1321ecd0fbed33">&#9670;&#160;</a></span>construct_index()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void sysio::chain::block_log::construct_index </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classfc_1_1path.html">fc::path</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>block_file_name</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classfc_1_1path.html">fc::path</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>index_file_name</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="block__log_8cpp_source.html#l00726">726</a> of file <a class="el" href="block__log_8cpp_source.html">block_log.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  726</span>                                                                                               {</div>
<div class="line"><span class="lineno">  727</span>      detail::reverse_iterator block_log_iter;</div>
<div class="line"><span class="lineno">  728</span> </div>
<div class="line"><span class="lineno">  729</span>      <a class="code hl_define" href="logger_8hpp.html#a831cf08dc63704c11fd154132c6e8bdb">ilog</a>(<span class="stringliteral">&quot;Will read existing blocks.log file ${file}&quot;</span>, (<span class="stringliteral">&quot;file&quot;</span>, block_file_name.<a class="code hl_function" href="classfc_1_1path.html#ab1eae2062df4ea01435348ec52fb3784">generic_string</a>()));</div>
<div class="line"><span class="lineno">  730</span>      <a class="code hl_define" href="logger_8hpp.html#a831cf08dc63704c11fd154132c6e8bdb">ilog</a>(<span class="stringliteral">&quot;Will write new blocks.index file ${file}&quot;</span>, (<span class="stringliteral">&quot;file&quot;</span>, index_file_name.<a class="code hl_function" href="classfc_1_1path.html#ab1eae2062df4ea01435348ec52fb3784">generic_string</a>()));</div>
<div class="line"><span class="lineno">  731</span> </div>
<div class="line"><span class="lineno">  732</span>      <span class="comment">//for a pruned log, this will still return blocks in the count that have been removed. that&#39;s okay and desirable</span></div>
<div class="line"><span class="lineno">  733</span>      <span class="keyword">const</span> <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> num_blocks = block_log_iter.open(block_file_name);</div>
<div class="line"><span class="lineno">  734</span> </div>
<div class="line"><span class="lineno">  735</span>      <a class="code hl_define" href="logger_8hpp.html#a831cf08dc63704c11fd154132c6e8bdb">ilog</a>(<span class="stringliteral">&quot;block log version= ${version}&quot;</span>, (<span class="stringliteral">&quot;version&quot;</span>, block_log_iter.version()));</div>
<div class="line"><span class="lineno">  736</span> </div>
<div class="line"><span class="lineno">  737</span>      <span class="keywordflow">if</span> (num_blocks == 0) {</div>
<div class="line"><span class="lineno">  738</span>         <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  739</span>      }</div>
<div class="line"><span class="lineno">  740</span> </div>
<div class="line"><span class="lineno">  741</span>      <a class="code hl_define" href="logger_8hpp.html#a831cf08dc63704c11fd154132c6e8bdb">ilog</a>(<span class="stringliteral">&quot;first block= ${first}         last block= ${last}&quot;</span>,</div>
<div class="line"><span class="lineno">  742</span>           (<span class="stringliteral">&quot;first&quot;</span>, block_log_iter.first_block_num())(<span class="stringliteral">&quot;last&quot;</span>, (block_log_iter.first_block_num() + num_blocks)));</div>
<div class="line"><span class="lineno">  743</span> </div>
<div class="line"><span class="lineno">  744</span>      detail::index_writer index(index_file_name, num_blocks);</div>
<div class="line"><span class="lineno">  745</span>      <a class="code hl_typedef" href="stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a> position;</div>
<div class="line"><span class="lineno">  746</span>      <span class="keywordflow">while</span> ((position = block_log_iter.previous()) != <a class="code hl_variable" href="#a02319a8bef22b7a167f17314c00b1ac1">npos</a>) {</div>
<div class="line"><span class="lineno">  747</span>         index.write(position);</div>
<div class="line"><span class="lineno">  748</span>      }</div>
<div class="line"><span class="lineno">  749</span>   }</div>
<div class="ttc" id="aclassfc_1_1path_html_ab1eae2062df4ea01435348ec52fb3784"><div class="ttname"><a href="classfc_1_1path.html#ab1eae2062df4ea01435348ec52fb3784">fc::path::generic_string</a></div><div class="ttdeci">std::string generic_string() const</div><div class="ttdef"><b>Definition</b> <a href="filesystem_8cpp_source.html#l00101">filesystem.cpp:101</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1block__log_html_a02319a8bef22b7a167f17314c00b1ac1"><div class="ttname"><a href="#a02319a8bef22b7a167f17314c00b1ac1">sysio::chain::block_log::npos</a></div><div class="ttdeci">static const uint64_t npos</div><div class="ttdef"><b>Definition</b> <a href="block__log_8hpp_source.html#l00073">block_log.hpp:73</a></div></div>
<div class="ttc" id="alogger_8hpp_html_a831cf08dc63704c11fd154132c6e8bdb"><div class="ttname"><a href="logger_8hpp.html#a831cf08dc63704c11fd154132c6e8bdb">ilog</a></div><div class="ttdeci">#define ilog(FORMAT,...)</div><div class="ttdef"><b>Definition</b> <a href="logger_8hpp_source.html#l00118">logger.hpp:118</a></div></div>
<div class="ttc" id="astdint_8h_html_a435d1572bf3f880d55459d9805097f62"><div class="ttname"><a href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a></div><div class="ttdeci">unsigned int uint32_t</div><div class="ttdef"><b>Definition</b> <a href="stdint_8h_source.html#l00126">stdint.h:126</a></div></div>
<div class="ttc" id="astdint_8h_html_aec6fcb673ff035718c238c8c9d544c47"><div class="ttname"><a href="stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a></div><div class="ttdeci">unsigned __int64 uint64_t</div><div class="ttdef"><b>Definition</b> <a href="stdint_8h_source.html#l00136">stdint.h:136</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classsysio_1_1chain_1_1block__log_aa470fc3f2a09d1204b1321ecd0fbed33_cgraph.png" border="0" usemap="#aclasssysio_1_1chain_1_1block__log_aa470fc3f2a09d1204b1321ecd0fbed33_cgraph" alt=""/></div>
<map name="aclasssysio_1_1chain_1_1block__log_aa470fc3f2a09d1204b1321ecd0fbed33_cgraph" id="aclasssysio_1_1chain_1_1block__log_aa470fc3f2a09d1204b1321ecd0fbed33_cgraph">
<area shape="rect" title=" " alt="" coords="5,136,151,176"/>
<area shape="rect" href="classsysio_1_1chain_1_1detail_1_1reverse__iterator.html#a94e575ab0b79f63dd812a760fa033c22" title=" " alt="" coords="212,5,362,61"/>
<area shape="poly" title=" " alt="" coords="109,133,197,78,217,67,219,71,200,82,112,137"/>
<area shape="rect" href="classfc_1_1path.html#ab1eae2062df4ea01435348ec52fb3784" title=" " alt="" coords="434,88,588,114"/>
<area shape="poly" title=" " alt="" coords="148,132,198,121,313,107,419,101,419,106,313,112,199,126,149,138"/>
<area shape="rect" href="classsysio_1_1chain_1_1detail_1_1reverse__iterator.html#a6cf878c882d8660a8cabb078c87941c8" title=" " alt="" coords="209,136,364,176"/>
<area shape="poly" title=" " alt="" coords="151,153,193,153,193,158,151,158"/>
<area shape="rect" href="classsysio_1_1chain_1_1detail_1_1reverse__iterator.html#abecf09db69d7954c4ed2f8cc620a66e1" title=" " alt="" coords="199,201,375,242"/>
<area shape="poly" title=" " alt="" coords="146,174,206,193,204,198,144,179"/>
<area shape="rect" href="classsysio_1_1chain_1_1detail_1_1reverse__iterator.html#ab4b22a3cb9633f8b0ede802e9507d1f4" title=" " alt="" coords="202,266,372,307"/>
<area shape="poly" title=" " alt="" coords="102,175,146,213,200,251,211,257,209,262,197,255,142,217,99,179"/>
<area shape="poly" title=" " alt="" coords="364,134,440,116,441,121,366,139"/>
<area shape="rect" href="namespacefc.html#afb668c55fd6ee73e1fcd67e77d8f6009" title=" " alt="" coords="433,142,589,167"/>
<area shape="poly" title=" " alt="" coords="365,153,418,152,418,158,365,158"/>
<area shape="rect" href="classsysio_1_1chain_1_1block__log.html#a5afbeabca60a1f842b83c107ec54cf99" title=" " alt="" coords="423,192,599,232"/>
<area shape="poly" title=" " alt="" coords="366,173,413,185,412,190,364,178"/>
</map>
</div>

</div>
</div>
<a id="a370e648384d16b6d60ca211921501cc6" name="a370e648384d16b6d60ca211921501cc6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a370e648384d16b6d60ca211921501cc6">&#9670;&#160;</a></span>contains_chain_id()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool sysio::chain::block_log::contains_chain_id </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a></td>          <td class="paramname"><span class="paramname"><em>version</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a></td>          <td class="paramname"><span class="paramname"><em>first_block_num</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="block__log_8cpp_source.html#l01168">1168</a> of file <a class="el" href="block__log_8cpp_source.html">block_log.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1168</span>                                                                               {</div>
<div class="line"><span class="lineno"> 1169</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="namespacewebsocketpp_1_1http_1_1parser_1_1state.html#a12f378e0c6dbf373781e7988ee4a0853a08c88a938bc459c7997b48f74248752f">version</a> &gt;= 3 &amp;&amp; <a class="code hl_function" href="#ac5f1c1e78e72414fbf9bae75da42303e">first_block_num</a> &gt; 1;</div>
<div class="line"><span class="lineno"> 1170</span>   }</div>
<div class="ttc" id="aclasssysio_1_1chain_1_1block__log_html_ac5f1c1e78e72414fbf9bae75da42303e"><div class="ttname"><a href="#ac5f1c1e78e72414fbf9bae75da42303e">sysio::chain::block_log::first_block_num</a></div><div class="ttdeci">uint32_t first_block_num() const</div><div class="ttdef"><b>Definition</b> <a href="block__log_8cpp_source.html#l00706">block_log.cpp:706</a></div></div>
<div class="ttc" id="anamespacewebsocketpp_1_1http_1_1parser_1_1state_html_a12f378e0c6dbf373781e7988ee4a0853a08c88a938bc459c7997b48f74248752f"><div class="ttname"><a href="namespacewebsocketpp_1_1http_1_1parser_1_1state.html#a12f378e0c6dbf373781e7988ee4a0853a08c88a938bc459c7997b48f74248752f">websocketpp::http::parser::state::version</a></div><div class="ttdeci">@ version</div><div class="ttdef"><b>Definition</b> <a href="fc_2vendor_2websocketpp_2websocketpp_2http_2parser_8hpp_source.html#l00047">parser.hpp:47</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classsysio_1_1chain_1_1block__log_a370e648384d16b6d60ca211921501cc6_icgraph.png" border="0" usemap="#aclasssysio_1_1chain_1_1block__log_a370e648384d16b6d60ca211921501cc6_icgraph" alt=""/></div>
<map name="aclasssysio_1_1chain_1_1block__log_a370e648384d16b6d60ca211921501cc6_icgraph" id="aclasssysio_1_1chain_1_1block__log_a370e648384d16b6d60ca211921501cc6_icgraph">
<area shape="rect" title=" " alt="" coords="175,5,332,46"/>
<area shape="rect" href="structsysio_1_1chain_1_1trim__data.html#ab5de810b1245a1ebff191bda8b98c9a1" title=" " alt="" coords="5,5,127,46"/>
<area shape="poly" title=" " alt="" coords="159,28,127,28,127,23,159,23"/>
</map>
</div>

</div>
</div>
<a id="ad760661c5030845b1369fee21e08a909" name="ad760661c5030845b1369fee21e08a909"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad760661c5030845b1369fee21e08a909">&#9670;&#160;</a></span>contains_genesis_state()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool sysio::chain::block_log::contains_genesis_state </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a></td>          <td class="paramname"><span class="paramname"><em>version</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a></td>          <td class="paramname"><span class="paramname"><em>first_block_num</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="block__log_8cpp_source.html#l01164">1164</a> of file <a class="el" href="block__log_8cpp_source.html">block_log.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1164</span>                                                                                    {</div>
<div class="line"><span class="lineno"> 1165</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="namespacewebsocketpp_1_1http_1_1parser_1_1state.html#a12f378e0c6dbf373781e7988ee4a0853a08c88a938bc459c7997b48f74248752f">version</a> &lt;= 2 || <a class="code hl_function" href="#ac5f1c1e78e72414fbf9bae75da42303e">first_block_num</a> == 1;</div>
<div class="line"><span class="lineno"> 1166</span>   }</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classsysio_1_1chain_1_1block__log_ad760661c5030845b1369fee21e08a909_icgraph.png" border="0" usemap="#aclasssysio_1_1chain_1_1block__log_ad760661c5030845b1369fee21e08a909_icgraph" alt=""/></div>
<map name="aclasssysio_1_1chain_1_1block__log_ad760661c5030845b1369fee21e08a909_icgraph" id="aclasssysio_1_1chain_1_1block__log_ad760661c5030845b1369fee21e08a909_icgraph">
<area shape="rect" title=" " alt="" coords="258,49,448,90"/>
<area shape="rect" href="classsysio_1_1chain_1_1detail_1_1block__log__impl.html#a4bf087087dcea405e245031d4f9db5a4" title=" " alt="" coords="5,5,210,61"/>
<area shape="poly" title=" " alt="" coords="242,56,210,51,211,46,243,50"/>
<area shape="rect" href="structsysio_1_1chain_1_1trim__data.html#ab5de810b1245a1ebff191bda8b98c9a1" title=" " alt="" coords="47,85,168,126"/>
<area shape="poly" title=" " alt="" coords="243,88,169,99,168,94,242,83"/>
</map>
</div>

</div>
</div>
<a id="ad17bd0904611f780b5d49ad14b363208" name="ad17bd0904611f780b5d49ad14b363208"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad17bd0904611f780b5d49ad14b363208">&#9670;&#160;</a></span>extract_chain_id()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structsysio_1_1chain_1_1chain__id__type.html">chain_id_type</a> sysio::chain::block_log::extract_chain_id </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classfc_1_1path.html">fc::path</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>data_dir</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="block__log_8cpp_source.html#l00977">977</a> of file <a class="el" href="block__log_8cpp_source.html">block_log.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  977</span>                                                                     {</div>
<div class="line"><span class="lineno">  978</span>      <span class="keywordflow">return</span> *(<a class="code hl_function" href="classsysio_1_1chain_1_1detail_1_1block__log__impl.html#a9e4742cc31b5b751d1f6fae18cb42455">detail::block_log_impl::extract_chain_context&lt;chain_id_type&gt;</a>(data_dir, [](std::fstream&amp; block_stream, <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> version, <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="code hl_function" href="#ac5f1c1e78e72414fbf9bae75da42303e">first_block_num</a> ) -&gt; std::optional&lt;chain_id_type&gt; {</div>
<div class="line"><span class="lineno">  979</span>         <span class="comment">// supported versions either contain a genesis state, or else the chain id only</span></div>
<div class="line"><span class="lineno">  980</span>         <span class="keywordflow">if</span> (<a class="code hl_function" href="#ad760661c5030845b1369fee21e08a909">contains_genesis_state</a>(version, <a class="code hl_function" href="#ac5f1c1e78e72414fbf9bae75da42303e">first_block_num</a>)) {</div>
<div class="line"><span class="lineno">  981</span>            genesis_state <a class="code hl_function" href="namespace_xbyak_1_1util.html#a051ad68b75c300988da81d4804273b56">gs</a>;</div>
<div class="line"><span class="lineno">  982</span>            <a class="code hl_function" href="namespacefc_1_1raw.html#a0b442d98ceb22dd5a6ae84745e43ffab">fc::raw::unpack</a>(block_stream, gs);</div>
<div class="line"><span class="lineno">  983</span>            <span class="keywordflow">return</span> <a class="code hl_function" href="namespace_xbyak_1_1util.html#a051ad68b75c300988da81d4804273b56">gs</a>.compute_chain_id();</div>
<div class="line"><span class="lineno">  984</span>         }</div>
<div class="line"><span class="lineno">  985</span>         <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( <a class="code hl_function" href="#a370e648384d16b6d60ca211921501cc6">contains_chain_id</a>(version, <a class="code hl_function" href="#ac5f1c1e78e72414fbf9bae75da42303e">first_block_num</a>), block_log_exception,</div>
<div class="line"><span class="lineno">  986</span>                     <span class="stringliteral">&quot;Block log error! version: ${version} with first_block_num: ${num} does not contain a &quot;</span></div>
<div class="line"><span class="lineno">  987</span>                     <span class="stringliteral">&quot;chain id or genesis state, so the chain id cannot be determined.&quot;</span>,</div>
<div class="line"><span class="lineno">  988</span>                     (<span class="stringliteral">&quot;version&quot;</span>, version)(<span class="stringliteral">&quot;num&quot;</span>, <a class="code hl_function" href="#ac5f1c1e78e72414fbf9bae75da42303e">first_block_num</a>) );</div>
<div class="line"><span class="lineno">  989</span>         chain_id_type chain_id;</div>
<div class="line"><span class="lineno">  990</span>         <a class="code hl_function" href="namespacefc_1_1raw.html#a0b442d98ceb22dd5a6ae84745e43ffab">fc::raw::unpack</a>(block_stream, chain_id);</div>
<div class="line"><span class="lineno">  991</span>         <span class="keywordflow">return</span> chain_id;</div>
<div class="line"><span class="lineno">  992</span>      }));</div>
<div class="line"><span class="lineno">  993</span>   }</div>
<div class="ttc" id="achain_2include_2sysio_2chain_2exceptions_8hpp_html_a40c2826a6fba35c1ffbf912bdf559792"><div class="ttname"><a href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a></div><div class="ttdeci">#define SYS_ASSERT(expr, exc_type, FORMAT,...)</div><div class="ttdef"><b>Definition</b> <a href="chain_2include_2sysio_2chain_2exceptions_8hpp_source.html#l00007">exceptions.hpp:7</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1block__log_html_a370e648384d16b6d60ca211921501cc6"><div class="ttname"><a href="#a370e648384d16b6d60ca211921501cc6">sysio::chain::block_log::contains_chain_id</a></div><div class="ttdeci">static bool contains_chain_id(uint32_t version, uint32_t first_block_num)</div><div class="ttdef"><b>Definition</b> <a href="block__log_8cpp_source.html#l01168">block_log.cpp:1168</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1block__log_html_ad760661c5030845b1369fee21e08a909"><div class="ttname"><a href="#ad760661c5030845b1369fee21e08a909">sysio::chain::block_log::contains_genesis_state</a></div><div class="ttdeci">static bool contains_genesis_state(uint32_t version, uint32_t first_block_num)</div><div class="ttdef"><b>Definition</b> <a href="block__log_8cpp_source.html#l01164">block_log.cpp:1164</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1detail_1_1block__log__impl_html_a9e4742cc31b5b751d1f6fae18cb42455"><div class="ttname"><a href="classsysio_1_1chain_1_1detail_1_1block__log__impl.html#a9e4742cc31b5b751d1f6fae18cb42455">sysio::chain::detail::block_log_impl::extract_chain_context</a></div><div class="ttdeci">static std::optional&lt; ChainContext &gt; extract_chain_context(const fc::path &amp;data_dir, Lambda &amp;&amp;lambda)</div><div class="ttdef"><b>Definition</b> <a href="block__log_8cpp_source.html#l00942">block_log.cpp:942</a></div></div>
<div class="ttc" id="anamespace_xbyak_1_1util_html_a051ad68b75c300988da81d4804273b56"><div class="ttname"><a href="namespace_xbyak_1_1util.html#a051ad68b75c300988da81d4804273b56">Xbyak::util::gs</a></div><div class="ttdeci">static const Segment gs(Segment::gs)</div></div>
<div class="ttc" id="anamespacefc_1_1raw_html_a0b442d98ceb22dd5a6ae84745e43ffab"><div class="ttname"><a href="namespacefc_1_1raw.html#a0b442d98ceb22dd5a6ae84745e43ffab">fc::raw::unpack</a></div><div class="ttdeci">void unpack(Stream &amp;s, std::deque&lt; T &gt; &amp;value)</div><div class="ttdef"><b>Definition</b> <a href="raw_8hpp_source.html#l00540">raw.hpp:540</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classsysio_1_1chain_1_1block__log_ad17bd0904611f780b5d49ad14b363208_cgraph.png" border="0" usemap="#aclasssysio_1_1chain_1_1block__log_ad17bd0904611f780b5d49ad14b363208_cgraph" alt=""/></div>
<map name="aclasssysio_1_1chain_1_1block__log_ad17bd0904611f780b5d49ad14b363208_cgraph" id="aclasssysio_1_1chain_1_1block__log_ad17bd0904611f780b5d49ad14b363208_cgraph">
<area shape="rect" title=" " alt="" coords="5,67,154,108"/>
<area shape="rect" href="classsysio_1_1chain_1_1detail_1_1block__log__impl.html#a9e4742cc31b5b751d1f6fae18cb42455" title=" " alt="" coords="202,14,365,70"/>
<area shape="poly" title=" " alt="" coords="153,68,186,61,187,66,155,74"/>
<area shape="rect" href="namespacefc_1_1raw.html#a0b442d98ceb22dd5a6ae84745e43ffab" title=" " alt="" coords="228,119,339,144"/>
<area shape="poly" title=" " alt="" coords="155,101,213,114,212,119,153,106"/>
<area shape="rect" href="namespacefc.html#ab123bfeadf918cc293ecad88bca7c499" title=" " alt="" coords="420,5,527,31"/>
<area shape="poly" title=" " alt="" coords="365,29,404,24,404,30,365,34"/>
<area shape="rect" href="namespacefc.html#a6855142912d4cfb89281ba0c7f4938a2" title=" " alt="" coords="413,55,533,80"/>
<area shape="poly" title=" " alt="" coords="365,50,398,55,397,60,365,56"/>
<area shape="poly" title=" " alt="" coords="251,120,245,110,249,100,262,94,283,92,306,95,318,101,316,106,305,100,283,97,263,99,253,104,250,109,256,117"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classsysio_1_1chain_1_1block__log_ad17bd0904611f780b5d49ad14b363208_icgraph.png" border="0" usemap="#aclasssysio_1_1chain_1_1block__log_ad17bd0904611f780b5d49ad14b363208_icgraph" alt=""/></div>
<map name="aclasssysio_1_1chain_1_1block__log_ad17bd0904611f780b5d49ad14b363208_icgraph" id="aclasssysio_1_1chain_1_1block__log_ad17bd0904611f780b5d49ad14b363208_icgraph">
<area shape="rect" title=" " alt="" coords="372,399,520,439"/>
<area shape="rect" href="classsysio_1_1testing_1_1base__tester.html#af7edc9d3783d21f8f736cf864482bdea" title=" " alt="" coords="189,365,324,406"/>
<area shape="poly" title=" " alt="" coords="356,406,324,400,325,395,357,401"/>
<area shape="rect" href="classsysio_1_1chain__plugin.html#a0192ac61f3f59d4fdf2dcbbd2c7104ca" title=" " alt="" coords="190,431,322,471"/>
<area shape="poly" title=" " alt="" coords="357,437,323,442,323,437,356,431"/>
<area shape="rect" href="classsysio_1_1testing_1_1base__tester.html#a3fad525eaa1221febd10c786e9dbaaf0" title=" " alt="" coords="5,5,141,46"/>
<area shape="poly" title=" " alt="" coords="249,351,239,290,219,213,186,133,165,95,139,61,124,48,128,44,143,57,169,92,191,131,224,212,244,289,254,350"/>
<area shape="rect" href="classsysio_1_1testing_1_1base__tester.html#a4bc45ee8335f6a9c99bfb044b07f7719" title=" " alt="" coords="5,71,141,111"/>
<area shape="poly" title=" " alt="" coords="245,351,232,302,210,242,180,181,160,152,139,126,124,114,127,110,143,122,165,149,184,178,215,240,237,300,250,349"/>
<area shape="rect" href="classsysio_1_1testing_1_1base__tester.html#a1cbd6f5fc5407a94f5f7b811559cd4f8" title=" " alt="" coords="5,136,141,177"/>
<area shape="poly" title=" " alt="" coords="240,352,201,273,173,230,139,192,122,179,126,175,142,188,177,227,206,270,244,350"/>
<area shape="rect" href="classsysio_1_1testing_1_1base__tester.html#a95257d0bdd37cb42fc3165ea1da98b93" title=" " alt="" coords="5,201,141,242"/>
<area shape="poly" title=" " alt="" coords="230,354,190,306,139,257,120,245,123,240,142,253,194,302,234,351"/>
<area shape="rect" href="classsysio_1_1testing_1_1base__tester.html#a934fa5023a748e09f2396f0e15717024" title=" " alt="" coords="5,267,141,307"/>
<area shape="poly" title=" " alt="" coords="206,360,139,323,115,310,118,305,142,318,208,355"/>
<area shape="rect" href="classsysio_1_1testing_1_1base__tester.html#a096f06629ea18d76bab94b524b056fa2" title=" " alt="" coords="5,332,141,373"/>
<area shape="poly" title=" " alt="" coords="173,373,140,367,141,362,174,368"/>
<area shape="rect" href="classsysio_1_1testing_1_1base__tester.html#ae6248366957999d23ec595271f91ba5e" title=" " alt="" coords="5,397,141,438"/>
<area shape="poly" title=" " alt="" coords="174,403,141,409,140,403,173,398"/>
<area shape="rect" href="classsysio_1_1testing_1_1base__tester.html#ae1a7cc9d4def2eb719d95680e5da6e43" title=" " alt="" coords="5,463,141,503"/>
<area shape="poly" title=" " alt="" coords="200,416,190,421,142,452,119,464,116,460,139,447,187,417,197,411"/>
<area shape="rect" href="classsysio_1_1testing_1_1base__tester.html#aec628f7d49e3600f9863554c5d7c9036" title=" " alt="" coords="5,528,141,569"/>
<area shape="poly" title=" " alt="" coords="194,418,191,421,174,445,167,468,160,492,143,517,127,529,123,525,139,513,155,489,162,466,169,442,187,417,190,414"/>
<area shape="rect" href="classsysio_1_1testing_1_1base__tester.html#a3eb533660c9e2e024d5dfb3f72a9f884" title=" " alt="" coords="5,593,141,634"/>
<area shape="poly" title=" " alt="" coords="193,418,191,421,177,441,170,461,167,500,164,540,157,560,143,582,128,595,125,591,139,579,152,558,159,538,162,499,165,460,172,439,187,417,189,415"/>
<area shape="rect" href="classsysio_1_1testing_1_1base__tester.html#aa94514bfa2c9891911d4bf3d03da3cc8" title=" " alt="" coords="5,659,141,699"/>
<area shape="poly" title=" " alt="" coords="193,418,191,421,174,450,166,478,165,505,167,532,170,560,168,588,161,617,143,647,129,660,125,657,139,644,156,615,163,587,164,560,162,533,160,505,161,477,169,448,186,417,189,415"/>
<area shape="rect" href="classsysio_1_1testing_1_1base__tester.html#abc8727b39ac2db73bed6613f22307daf" title=" " alt="" coords="5,724,141,765"/>
<area shape="poly" title=" " alt="" coords="192,418,191,420,170,459,162,495,162,530,167,565,172,600,173,636,164,673,143,713,130,725,126,722,139,709,159,671,167,635,167,600,162,565,157,530,157,494,165,457,186,418,188,415"/>
</map>
</div>

</div>
</div>
<a id="a0c03de4dfe3908668418da4620af63e3" name="a0c03de4dfe3908668418da4620af63e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c03de4dfe3908668418da4620af63e3">&#9670;&#160;</a></span>extract_genesis_state()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::optional&lt; <a class="el" href="structsysio_1_1chain_1_1genesis__state.html">genesis_state</a> &gt; sysio::chain::block_log::extract_genesis_state </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classfc_1_1path.html">fc::path</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>data_dir</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="block__log_8cpp_source.html#l00964">964</a> of file <a class="el" href="block__log_8cpp_source.html">block_log.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  964</span>                                                                                       {</div>
<div class="line"><span class="lineno">  965</span>      <span class="keywordflow">return</span> <a class="code hl_function" href="classsysio_1_1chain_1_1detail_1_1block__log__impl.html#a9e4742cc31b5b751d1f6fae18cb42455">detail::block_log_impl::extract_chain_context&lt;genesis_state&gt;</a>(data_dir, [](std::fstream&amp; block_stream, <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> version, <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="code hl_function" href="#ac5f1c1e78e72414fbf9bae75da42303e">first_block_num</a> ) -&gt; std::optional&lt;genesis_state&gt; {</div>
<div class="line"><span class="lineno">  966</span>         <span class="keywordflow">if</span> (<a class="code hl_function" href="#ad760661c5030845b1369fee21e08a909">contains_genesis_state</a>(version, <a class="code hl_function" href="#ac5f1c1e78e72414fbf9bae75da42303e">first_block_num</a>)) {</div>
<div class="line"><span class="lineno">  967</span>            genesis_state <a class="code hl_function" href="namespace_xbyak_1_1util.html#a051ad68b75c300988da81d4804273b56">gs</a>;</div>
<div class="line"><span class="lineno">  968</span>            <a class="code hl_function" href="namespacefc_1_1raw.html#a0b442d98ceb22dd5a6ae84745e43ffab">fc::raw::unpack</a>(block_stream, gs);</div>
<div class="line"><span class="lineno">  969</span>            <span class="keywordflow">return</span> <a class="code hl_function" href="namespace_xbyak_1_1util.html#a051ad68b75c300988da81d4804273b56">gs</a>;</div>
<div class="line"><span class="lineno">  970</span>         }</div>
<div class="line"><span class="lineno">  971</span> </div>
<div class="line"><span class="lineno">  972</span>         <span class="comment">// current versions only have a genesis state if they start with block number 1</span></div>
<div class="line"><span class="lineno">  973</span>         <span class="keywordflow">return</span> std::optional&lt;genesis_state&gt;();</div>
<div class="line"><span class="lineno">  974</span>      });</div>
<div class="line"><span class="lineno">  975</span>   }</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classsysio_1_1chain_1_1block__log_a0c03de4dfe3908668418da4620af63e3_cgraph.png" border="0" usemap="#aclasssysio_1_1chain_1_1block__log_a0c03de4dfe3908668418da4620af63e3_cgraph" alt=""/></div>
<map name="aclasssysio_1_1chain_1_1block__log_a0c03de4dfe3908668418da4620af63e3_cgraph" id="aclasssysio_1_1chain_1_1block__log_a0c03de4dfe3908668418da4620af63e3_cgraph">
<area shape="rect" title=" " alt="" coords="5,67,187,108"/>
<area shape="rect" href="classsysio_1_1chain_1_1detail_1_1block__log__impl.html#a9e4742cc31b5b751d1f6fae18cb42455" title=" " alt="" coords="235,14,398,70"/>
<area shape="poly" title=" " alt="" coords="187,66,219,60,220,65,188,71"/>
<area shape="rect" href="namespacefc_1_1raw.html#a0b442d98ceb22dd5a6ae84745e43ffab" title=" " alt="" coords="261,119,372,144"/>
<area shape="poly" title=" " alt="" coords="188,103,246,115,245,120,187,108"/>
<area shape="rect" href="namespacefc.html#ab123bfeadf918cc293ecad88bca7c499" title=" " alt="" coords="452,5,560,31"/>
<area shape="poly" title=" " alt="" coords="398,29,437,24,437,30,398,34"/>
<area shape="rect" href="namespacefc.html#a6855142912d4cfb89281ba0c7f4938a2" title=" " alt="" coords="446,55,566,80"/>
<area shape="poly" title=" " alt="" coords="398,50,431,55,430,60,398,56"/>
<area shape="poly" title=" " alt="" coords="284,120,278,110,282,100,295,94,316,92,339,95,351,101,349,106,338,100,316,97,296,99,286,104,283,109,289,117"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classsysio_1_1chain_1_1block__log_a0c03de4dfe3908668418da4620af63e3_icgraph.png" border="0" usemap="#aclasssysio_1_1chain_1_1block__log_a0c03de4dfe3908668418da4620af63e3_icgraph" alt=""/></div>
<map name="aclasssysio_1_1chain_1_1block__log_a0c03de4dfe3908668418da4620af63e3_icgraph" id="aclasssysio_1_1chain_1_1block__log_a0c03de4dfe3908668418da4620af63e3_icgraph">
<area shape="rect" title=" " alt="" coords="186,5,367,46"/>
<area shape="rect" href="classsysio_1_1chain__plugin.html#a0192ac61f3f59d4fdf2dcbbd2c7104ca" title=" " alt="" coords="5,5,138,46"/>
<area shape="poly" title=" " alt="" coords="170,28,138,28,138,23,170,23"/>
</map>
</div>

</div>
</div>
<a id="ac5f1c1e78e72414fbf9bae75da42303e" name="ac5f1c1e78e72414fbf9bae75da42303e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac5f1c1e78e72414fbf9bae75da42303e">&#9670;&#160;</a></span>first_block_num()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> sysio::chain::block_log::first_block_num </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="block__log_8cpp_source.html#l00706">706</a> of file <a class="el" href="block__log_8cpp_source.html">block_log.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  706</span>                                             {</div>
<div class="line"><span class="lineno">  707</span>      <span class="keywordflow">return</span> my-&gt;first_block_num;</div>
<div class="line"><span class="lineno">  708</span>   }</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classsysio_1_1chain_1_1block__log_ac5f1c1e78e72414fbf9bae75da42303e_icgraph.png" border="0" usemap="#aclasssysio_1_1chain_1_1block__log_ac5f1c1e78e72414fbf9bae75da42303e_icgraph" alt=""/></div>
<map name="aclasssysio_1_1chain_1_1block__log_ac5f1c1e78e72414fbf9bae75da42303e_icgraph" id="aclasssysio_1_1chain_1_1block__log_ac5f1c1e78e72414fbf9bae75da42303e_icgraph">
<area shape="rect" title=" " alt="" coords="1460,203,1605,243"/>
<area shape="rect" href="structsysio_1_1chain_1_1controller__impl.html#a8618218d7168450c383cde9860d57706" title=" " alt="" coords="1251,36,1412,92"/>
<area shape="poly" title=" " alt="" coords="1502,193,1460,149,1410,106,1392,95,1395,91,1413,102,1464,146,1506,189"/>
<area shape="rect" href="structsysio_1_1chain_1_1controller__impl.html#ad0130874bac31eb408dd6e766084b814" title=" " alt="" coords="1255,116,1408,157"/>
<area shape="poly" title=" " alt="" coords="1472,198,1411,171,1384,160,1386,155,1413,166,1474,193"/>
<area shape="rect" href="structblocklog.html#ab8fb32dc3425a85102c05fe4a1c1fd62" title=" " alt="" coords="1268,181,1395,206"/>
<area shape="poly" title=" " alt="" coords="1444,213,1395,206,1395,200,1445,208"/>
<area shape="rect" href="structsysio_1_1chain_1_1controller__impl.html#a90da90c73cb32b5e5ec498da5e02753f" title=" " alt="" coords="1255,231,1408,271"/>
<area shape="poly" title=" " alt="" coords="1445,238,1409,243,1408,238,1444,233"/>
<area shape="rect" href="structsysio_1_1chain_1_1controller__impl.html#a7863870ecde398ac7def54e4814db6bc" title=" " alt="" coords="1255,296,1408,337"/>
<area shape="poly" title=" " alt="" coords="1479,253,1413,285,1385,298,1382,293,1411,281,1476,248"/>
<area shape="rect" href="structsysio_1_1chain_1_1controller__impl.html#a18bcf25847599b0f9caa6566364bb0ac" title=" " alt="" coords="1255,361,1408,402"/>
<area shape="poly" title=" " alt="" coords="1508,257,1467,304,1413,351,1392,363,1389,358,1410,346,1463,301,1504,254"/>
<area shape="rect" href="structsysio_1_1chain_1_1controller__impl.html#abde6bacce9f720ad552d0e342c52d3b4" title="finalize_block" alt="" coords="1051,116,1203,157"/>
<area shape="poly" title=" " alt="" coords="1240,139,1204,139,1204,134,1240,134"/>
<area shape="rect" href="structsysio_1_1chain_1_1controller__impl.html#af15d89f9220ba97aa5c521e643746587" title=" " alt="" coords="622,63,803,103"/>
<area shape="poly" title=" " alt="" coords="1243,115,1203,107,1096,95,988,88,803,84,803,79,988,82,1096,89,1204,102,1244,109"/>
<area shape="rect" href="structsysio_1_1chain_1_1controller__impl.html#ac2d3794f1bd0ff1bd5837d8ead15d289" title=" " alt="" coords="414,5,566,46"/>
<area shape="poly" title=" " alt="" coords="1261,112,1250,107,1227,92,1202,80,1116,58,1027,42,938,31,850,24,690,20,567,23,567,18,690,15,851,19,938,26,1028,37,1118,53,1204,75,1229,87,1253,102,1264,107"/>
<area shape="rect" href="structsysio_1_1chain_1_1controller__impl.html#aaf795677a1a49a35ac1a819a1a157929" title=" " alt="" coords="851,119,1003,159"/>
<area shape="poly" title=" " alt="" coords="1035,140,1003,141,1003,135,1035,135"/>
<area shape="poly" title=" " alt="" coords="1018,160,1051,166,1127,172,1203,166,1260,155,1261,160,1204,171,1127,177,1051,171,1018,166"/>
<area shape="poly" title=" " alt="" coords="835,118,792,107,794,101,836,113"/>
<area shape="rect" href="structsysio_1_1chain_1_1controller__impl.html#a2fe4194f0202db6c18bc17572b2adaa2" title=" " alt="" coords="406,120,574,161"/>
<area shape="poly" title=" " alt="" coords="836,142,575,143,575,137,836,137"/>
<area shape="rect" href="structsysio_1_1chain_1_1controller__impl.html#a9efbc515682ae5dede91184c36af73f7" title=" " alt="" coords="5,92,158,133"/>
<area shape="poly" title=" " alt="" coords="607,91,158,111,158,106,607,85"/>
<area shape="poly" title=" " alt="" coords="616,61,566,48,568,43,617,56"/>
<area shape="poly" title=" " alt="" coords="617,110,572,122,571,117,616,105"/>
<area shape="rect" href="structsysio_1_1chain_1_1controller__impl.html#a9a9e4b6fe15eb93e63ac98af9f170647" title=" " alt="" coords="206,120,358,161"/>
<area shape="poly" title=" " alt="" coords="391,143,359,143,359,138,391,138"/>
<area shape="poly" title=" " alt="" coords="190,130,158,126,158,120,190,125"/>
<area shape="rect" href="programs_2sysio-blocklog_2main_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627" title=" " alt="" coords="1102,232,1152,257"/>
<area shape="poly" title=" " alt="" coords="1263,213,1153,241,1152,236,1261,208"/>
</map>
</div>

</div>
</div>
<a id="a44ab2b550fcc2be7e0b0e98faabd1f21" name="a44ab2b550fcc2be7e0b0e98faabd1f21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44ab2b550fcc2be7e0b0e98faabd1f21">&#9670;&#160;</a></span>flush()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sysio::chain::block_log::flush </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="block__log_8cpp_source.html#l00426">426</a> of file <a class="el" href="block__log_8cpp_source.html">block_log.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  426</span>                         {</div>
<div class="line"><span class="lineno">  427</span>      my-&gt;flush();</div>
<div class="line"><span class="lineno">  428</span>   }</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classsysio_1_1chain_1_1block__log_a44ab2b550fcc2be7e0b0e98faabd1f21_icgraph.png" border="0" usemap="#aclasssysio_1_1chain_1_1block__log_a44ab2b550fcc2be7e0b0e98faabd1f21_icgraph" alt=""/></div>
<map name="aclasssysio_1_1chain_1_1block__log_a44ab2b550fcc2be7e0b0e98faabd1f21_icgraph" id="aclasssysio_1_1chain_1_1block__log_a44ab2b550fcc2be7e0b0e98faabd1f21_icgraph">
<area shape="rect" title=" " alt="" coords="184,5,314,46"/>
<area shape="rect" href="classsysio_1_1chain_1_1block__log.html#a45c70cce7837458f4519a52979632e8d" title=" " alt="" coords="5,5,136,46"/>
<area shape="poly" title=" " alt="" coords="168,28,136,28,136,23,168,23"/>
</map>
</div>

</div>
</div>
<a id="ad95f8bb0f2ccd5d0fd4db1a13eb3106a" name="ad95f8bb0f2ccd5d0fd4db1a13eb3106a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad95f8bb0f2ccd5d0fd4db1a13eb3106a">&#9670;&#160;</a></span>get_block_pos()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a> sysio::chain::block_log::get_block_pos </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a></td>          <td class="paramname"><span class="paramname"><em>block_num</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return offset of block in file, or <a class="el" href="#a02319a8bef22b7a167f17314c00b1ac1">block_log::npos</a> if it does not exist. </p>

<p class="definition">Definition at line <a class="el" href="block__log_8cpp_source.html#l00667">667</a> of file <a class="el" href="block__log_8cpp_source.html">block_log.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  667</span>                                                             {</div>
<div class="line"><span class="lineno">  668</span>      <span class="keywordflow">return</span> my-&gt;get_block_pos(block_num);</div>
<div class="line"><span class="lineno">  669</span>   }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae787e7866ebfcd4c5dd5632c15c07c88" name="ae787e7866ebfcd4c5dd5632c15c07c88"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae787e7866ebfcd4c5dd5632c15c07c88">&#9670;&#160;</a></span>head()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="namespacesysio_1_1chain.html#aa10ee348c57604b615bc8570f6685102">signed_block_ptr</a> &amp; sysio::chain::block_log::head </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="block__log_8cpp_source.html#l00698">698</a> of file <a class="el" href="block__log_8cpp_source.html">block_log.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  698</span>                                                {</div>
<div class="line"><span class="lineno">  699</span>      <span class="keywordflow">return</span> my-&gt;head;</div>
<div class="line"><span class="lineno">  700</span>   }</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classsysio_1_1chain_1_1block__log_ae787e7866ebfcd4c5dd5632c15c07c88_icgraph.png" border="0" usemap="#aclasssysio_1_1chain_1_1block__log_ae787e7866ebfcd4c5dd5632c15c07c88_icgraph" alt=""/></div>
<map name="aclasssysio_1_1chain_1_1block__log_ae787e7866ebfcd4c5dd5632c15c07c88_icgraph" id="aclasssysio_1_1chain_1_1block__log_ae787e7866ebfcd4c5dd5632c15c07c88_icgraph">
<area shape="rect" title=" " alt="" coords="1452,279,1582,319"/>
<area shape="rect" href="structsysio_1_1chain_1_1controller__impl.html#ad0130874bac31eb408dd6e766084b814" title=" " alt="" coords="1251,113,1404,154"/>
<area shape="poly" title=" " alt="" coords="1479,270,1351,156,1354,152,1482,266"/>
<area shape="rect" href="structsysio_1_1chain_1_1controller__impl.html#a9a9e4b6fe15eb93e63ac98af9f170647" title=" " alt="" coords="206,120,358,161"/>
<area shape="poly" title=" " alt="" coords="1436,277,1403,270,1267,249,1128,244,711,244,658,242,605,236,501,215,408,189,335,164,337,159,410,184,502,210,606,231,659,237,711,239,1129,239,1267,243,1404,264,1438,272"/>
<area shape="rect" href="structsysio_1_1chain_1_1controller__impl.html#a90da90c73cb32b5e5ec498da5e02753f" title=" " alt="" coords="1251,279,1404,319"/>
<area shape="poly" title=" " alt="" coords="1436,302,1404,302,1404,296,1436,296"/>
<area shape="rect" href="structsysio_1_1chain_1_1controller__impl.html#a7863870ecde398ac7def54e4814db6bc" title=" " alt="" coords="1251,344,1404,385"/>
<area shape="poly" title=" " alt="" coords="1442,327,1389,346,1388,341,1441,322"/>
<area shape="rect" href="structsysio_1_1chain_1_1controller__impl.html#a18bcf25847599b0f9caa6566364bb0ac" title=" " alt="" coords="1251,409,1404,450"/>
<area shape="poly" title=" " alt="" coords="1486,332,1449,366,1405,399,1382,411,1380,407,1402,394,1446,362,1483,328"/>
<area shape="rect" href="structsysio_1_1chain_1_1controller__impl.html#abde6bacce9f720ad552d0e342c52d3b4" title="finalize_block" alt="" coords="1051,113,1203,154"/>
<area shape="poly" title=" " alt="" coords="1236,136,1204,136,1204,131,1236,131"/>
<area shape="rect" href="structsysio_1_1chain_1_1controller__impl.html#af15d89f9220ba97aa5c521e643746587" title=" " alt="" coords="622,63,803,103"/>
<area shape="poly" title=" " alt="" coords="1241,112,1203,104,1096,92,988,86,803,83,803,78,988,80,1096,87,1204,99,1242,107"/>
<area shape="rect" href="structsysio_1_1chain_1_1controller__impl.html#ac2d3794f1bd0ff1bd5837d8ead15d289" title=" " alt="" coords="414,5,566,46"/>
<area shape="poly" title=" " alt="" coords="1277,108,1241,91,1203,78,1116,58,1027,44,850,27,690,22,567,24,567,19,690,17,850,22,1027,38,1117,53,1204,72,1243,86,1280,103"/>
<area shape="rect" href="structsysio_1_1chain_1_1controller__impl.html#aaf795677a1a49a35ac1a819a1a157929" title=" " alt="" coords="851,116,1003,157"/>
<area shape="poly" title=" " alt="" coords="1035,138,1003,138,1003,133,1035,132"/>
<area shape="poly" title=" " alt="" coords="1018,158,1051,163,1127,169,1203,163,1258,152,1259,157,1204,168,1127,175,1051,168,1018,163"/>
<area shape="poly" title=" " alt="" coords="835,116,796,107,798,101,836,111"/>
<area shape="rect" href="structsysio_1_1chain_1_1controller__impl.html#a2fe4194f0202db6c18bc17572b2adaa2" title=" " alt="" coords="406,120,574,161"/>
<area shape="poly" title=" " alt="" coords="836,140,575,142,575,137,836,134"/>
<area shape="rect" href="structsysio_1_1chain_1_1controller__impl.html#a9efbc515682ae5dede91184c36af73f7" title=" " alt="" coords="5,92,158,133"/>
<area shape="poly" title=" " alt="" coords="607,91,158,111,158,106,607,85"/>
<area shape="poly" title=" " alt="" coords="616,61,566,48,568,43,617,56"/>
<area shape="poly" title=" " alt="" coords="617,110,572,122,571,117,616,105"/>
<area shape="poly" title=" " alt="" coords="391,143,359,143,359,138,391,138"/>
<area shape="poly" title=" " alt="" coords="190,130,158,126,158,120,190,125"/>
</map>
</div>

</div>
</div>
<a id="a4d0b6ecf420faffc4f00ba6af3d0af99" name="a4d0b6ecf420faffc4f00ba6af3d0af99"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d0b6ecf420faffc4f00ba6af3d0af99">&#9670;&#160;</a></span>head_id()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="namespacesysio_1_1chain.html#a4b8e4b7ed9dcd18ee75d0de62e88aa17">block_id_type</a> &amp; sysio::chain::block_log::head_id </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="block__log_8cpp_source.html#l00702">702</a> of file <a class="el" href="block__log_8cpp_source.html">block_log.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  702</span>                                                   {</div>
<div class="line"><span class="lineno">  703</span>      <span class="keywordflow">return</span> my-&gt;head_id;</div>
<div class="line"><span class="lineno">  704</span>   }</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classsysio_1_1chain_1_1block__log_a4d0b6ecf420faffc4f00ba6af3d0af99_icgraph.png" border="0" usemap="#aclasssysio_1_1chain_1_1block__log_a4d0b6ecf420faffc4f00ba6af3d0af99_icgraph" alt=""/></div>
<map name="aclasssysio_1_1chain_1_1block__log_a4d0b6ecf420faffc4f00ba6af3d0af99_icgraph" id="aclasssysio_1_1chain_1_1block__log_a4d0b6ecf420faffc4f00ba6af3d0af99_icgraph">
<area shape="rect" title=" " alt="" coords="1452,88,1582,129"/>
<area shape="rect" href="structsysio_1_1chain_1_1controller__impl.html#ad0130874bac31eb408dd6e766084b814" title=" " alt="" coords="1251,88,1404,129"/>
<area shape="poly" title=" " alt="" coords="1436,111,1404,111,1404,106,1436,106"/>
<area shape="rect" href="structsysio_1_1chain_1_1controller__impl.html#abde6bacce9f720ad552d0e342c52d3b4" title="finalize_block" alt="" coords="1051,5,1203,46"/>
<area shape="poly" title=" " alt="" coords="1261,84,1178,49,1180,44,1263,79"/>
<area shape="rect" href="structsysio_1_1chain_1_1controller__impl.html#af15d89f9220ba97aa5c521e643746587" title=" " alt="" coords="622,109,803,150"/>
<area shape="poly" title=" " alt="" coords="1236,114,803,129,803,124,1236,109"/>
<area shape="rect" href="structsysio_1_1chain_1_1controller__impl.html#ac2d3794f1bd0ff1bd5837d8ead15d289" title=" " alt="" coords="414,167,566,207"/>
<area shape="poly" title=" " alt="" coords="1236,122,1204,126,803,164,567,184,567,179,802,159,1203,120,1236,117"/>
<area shape="rect" href="structsysio_1_1chain_1_1controller__impl.html#aaf795677a1a49a35ac1a819a1a157929" title=" " alt="" coords="851,55,1003,95"/>
<area shape="poly" title=" " alt="" coords="1036,51,1004,59,1003,54,1035,46"/>
<area shape="poly" title=" " alt="" coords="1019,80,1251,99,1251,105,1018,85"/>
<area shape="poly" title=" " alt="" coords="836,101,796,111,794,106,835,96"/>
<area shape="rect" href="structsysio_1_1chain_1_1controller__impl.html#a2fe4194f0202db6c18bc17572b2adaa2" title=" " alt="" coords="406,52,574,93"/>
<area shape="poly" title=" " alt="" coords="836,77,575,76,575,70,836,72"/>
<area shape="rect" href="structsysio_1_1chain_1_1controller__impl.html#a9efbc515682ae5dede91184c36af73f7" title=" " alt="" coords="5,81,158,122"/>
<area shape="poly" title=" " alt="" coords="607,128,158,108,158,102,607,122"/>
<area shape="poly" title=" " alt="" coords="617,157,568,170,566,165,616,152"/>
<area shape="poly" title=" " alt="" coords="616,108,571,96,572,91,617,102"/>
<area shape="rect" href="structsysio_1_1chain_1_1controller__impl.html#a9a9e4b6fe15eb93e63ac98af9f170647" title=" " alt="" coords="206,52,358,93"/>
<area shape="poly" title=" " alt="" coords="391,75,359,75,359,70,391,70"/>
<area shape="poly" title=" " alt="" coords="191,88,158,93,158,88,190,83"/>
</map>
</div>

</div>
</div>
<a id="a65b017352bcd2bdea5ed9d68af7215d1" name="a65b017352bcd2bdea5ed9d68af7215d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65b017352bcd2bdea5ed9d68af7215d1">&#9670;&#160;</a></span>is_pruned_log()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool sysio::chain::block_log::is_pruned_log </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classfc_1_1path.html">fc::path</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>data_dir</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="block__log_8cpp_source.html#l00995">995</a> of file <a class="el" href="block__log_8cpp_source.html">block_log.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  995</span>                                                       {</div>
<div class="line"><span class="lineno">  996</span>      <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="code hl_enumvalue" href="namespacewebsocketpp_1_1http_1_1parser_1_1state.html#a12f378e0c6dbf373781e7988ee4a0853a08c88a938bc459c7997b48f74248752f">version</a> = 0;</div>
<div class="line"><span class="lineno">  997</span>      <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno">  998</span>         <a class="code hl_class" href="classfc_1_1cfile.html">fc::cfile</a> log_file;</div>
<div class="line"><span class="lineno">  999</span>         log_file.<a class="code hl_function" href="classfc_1_1cfile.html#ac4a0191d7846c07a907d3c7eb35e848d">set_file_path</a>(data_dir / <span class="stringliteral">&quot;blocks.log&quot;</span>);</div>
<div class="line"><span class="lineno"> 1000</span>         log_file.<a class="code hl_function" href="classfc_1_1cfile.html#a9e01adaeee108420312ed271133a2d7d">open</a>(<span class="stringliteral">&quot;rb&quot;</span>);</div>
<div class="line"><span class="lineno"> 1001</span>         <a class="code hl_function" href="namespacefc_1_1raw.html#a0b442d98ceb22dd5a6ae84745e43ffab">fc::raw::unpack</a>(log_file, version);</div>
<div class="line"><span class="lineno"> 1002</span>      }</div>
<div class="line"><span class="lineno"> 1003</span>      <span class="keywordflow">catch</span>(...) {</div>
<div class="line"><span class="lineno"> 1004</span>         <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1005</span>      }</div>
<div class="line"><span class="lineno"> 1006</span>      <span class="keywordflow">return</span> detail::is_pruned_log_and_mask_version(version);</div>
<div class="line"><span class="lineno"> 1007</span>   }</div>
<div class="ttc" id="aclassfc_1_1cfile_html"><div class="ttname"><a href="classfc_1_1cfile.html">fc::cfile</a></div><div class="ttdef"><b>Definition</b> <a href="cfile_8hpp_source.html#l00031">cfile.hpp:31</a></div></div>
<div class="ttc" id="aclassfc_1_1cfile_html_a9e01adaeee108420312ed271133a2d7d"><div class="ttname"><a href="classfc_1_1cfile.html#a9e01adaeee108420312ed271133a2d7d">fc::cfile::open</a></div><div class="ttdeci">void open(const char *mode)</div><div class="ttdef"><b>Definition</b> <a href="cfile_8hpp_source.html#l00065">cfile.hpp:65</a></div></div>
<div class="ttc" id="aclassfc_1_1cfile_html_ac4a0191d7846c07a907d3c7eb35e848d"><div class="ttname"><a href="classfc_1_1cfile.html#ac4a0191d7846c07a907d3c7eb35e848d">fc::cfile::set_file_path</a></div><div class="ttdeci">void set_file_path(fc::path file_path)</div><div class="ttdef"><b>Definition</b> <a href="cfile_8hpp_source.html#l00037">cfile.hpp:37</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classsysio_1_1chain_1_1block__log_a65b017352bcd2bdea5ed9d68af7215d1_cgraph.png" border="0" usemap="#aclasssysio_1_1chain_1_1block__log_a65b017352bcd2bdea5ed9d68af7215d1_cgraph" alt=""/></div>
<map name="aclasssysio_1_1chain_1_1block__log_a65b017352bcd2bdea5ed9d68af7215d1_cgraph" id="aclasssysio_1_1chain_1_1block__log_a65b017352bcd2bdea5ed9d68af7215d1_cgraph">
<area shape="rect" title=" " alt="" coords="5,96,139,137"/>
<area shape="rect" href="classfc_1_1cfile.html#a9e01adaeee108420312ed271133a2d7d" title=" " alt="" coords="210,55,310,80"/>
<area shape="poly" title=" " alt="" coords="138,97,194,82,195,87,140,102"/>
<area shape="rect" href="classfc_1_1cfile.html#ac4a0191d7846c07a907d3c7eb35e848d" title=" " alt="" coords="187,104,333,130"/>
<area shape="poly" title=" " alt="" coords="139,114,171,114,171,120,139,120"/>
<area shape="rect" href="namespacefc_1_1raw.html#a0b442d98ceb22dd5a6ae84745e43ffab" title=" " alt="" coords="204,177,316,203"/>
<area shape="poly" title=" " alt="" coords="127,135,211,169,209,174,125,140"/>
<area shape="rect" href="classfc_1_1cfile.html#a3b11f29f74860527a8bba66e4ae0317d" title=" " alt="" coords="381,29,484,55"/>
<area shape="poly" title=" " alt="" coords="310,58,365,49,366,55,311,63"/>
<area shape="rect" href="classfc_1_1path.html#ab1eae2062df4ea01435348ec52fb3784" title=" " alt="" coords="532,55,687,80"/>
<area shape="poly" title=" " alt="" coords="311,65,517,65,517,70,311,70"/>
<area shape="poly" title=" " alt="" coords="403,30,398,21,401,11,413,5,433,3,454,5,465,12,462,16,452,10,433,8,415,10,405,15,403,20,408,28"/>
<area shape="poly" title=" " alt="" coords="485,47,517,52,516,57,484,52"/>
<area shape="poly" title=" " alt="" coords="231,178,225,169,228,159,240,153,260,151,281,153,292,160,289,164,279,158,260,156,242,158,232,163,230,168,235,176"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classsysio_1_1chain_1_1block__log_a65b017352bcd2bdea5ed9d68af7215d1_icgraph.png" border="0" usemap="#aclasssysio_1_1chain_1_1block__log_a65b017352bcd2bdea5ed9d68af7215d1_icgraph" alt=""/></div>
<map name="aclasssysio_1_1chain_1_1block__log_a65b017352bcd2bdea5ed9d68af7215d1_icgraph" id="aclasssysio_1_1chain_1_1block__log_a65b017352bcd2bdea5ed9d68af7215d1_icgraph">
<area shape="rect" title=" " alt="" coords="275,5,408,46"/>
<area shape="rect" href="structblocklog.html#a9a8b4159b641c6ee906cbdc9f8a162d8" title=" " alt="" coords="103,13,227,38"/>
<area shape="poly" title=" " alt="" coords="259,28,228,28,228,23,259,23"/>
<area shape="rect" href="programs_2sysio-blocklog_2main_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627" title=" " alt="" coords="5,13,55,38"/>
<area shape="poly" title=" " alt="" coords="87,28,55,28,55,23,87,23"/>
</map>
</div>

</div>
</div>
<a id="a5afbeabca60a1f842b83c107ec54cf99" name="a5afbeabca60a1f842b83c107ec54cf99"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5afbeabca60a1f842b83c107ec54cf99">&#9670;&#160;</a></span>is_supported_version()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool sysio::chain::block_log::is_supported_version </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a></td>          <td class="paramname"><span class="paramname"><em>version</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="block__log_8cpp_source.html#l01172">1172</a> of file <a class="el" href="block__log_8cpp_source.html">block_log.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1172</span>                                                        {</div>
<div class="line"><span class="lineno"> 1173</span>      <span class="keywordflow">return</span> std::clamp(version, <a class="code hl_variable" href="#a8f0f031e0f64def456185998d462d35d">min_supported_version</a>, <a class="code hl_variable" href="#add7716a8093b81e1a51ed52897e97770">max_supported_version</a>) == <a class="code hl_enumvalue" href="namespacewebsocketpp_1_1http_1_1parser_1_1state.html#a12f378e0c6dbf373781e7988ee4a0853a08c88a938bc459c7997b48f74248752f">version</a>;</div>
<div class="line"><span class="lineno"> 1174</span>   }</div>
<div class="ttc" id="aclasssysio_1_1chain_1_1block__log_html_a8f0f031e0f64def456185998d462d35d"><div class="ttname"><a href="#a8f0f031e0f64def456185998d462d35d">sysio::chain::block_log::min_supported_version</a></div><div class="ttdeci">static const uint32_t min_supported_version</div><div class="ttdef"><b>Definition</b> <a href="block__log_8hpp_source.html#l00075">block_log.hpp:75</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1block__log_html_add7716a8093b81e1a51ed52897e97770"><div class="ttname"><a href="#add7716a8093b81e1a51ed52897e97770">sysio::chain::block_log::max_supported_version</a></div><div class="ttdeci">static const uint32_t max_supported_version</div><div class="ttdef"><b>Definition</b> <a href="block__log_8hpp_source.html#l00076">block_log.hpp:76</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classsysio_1_1chain_1_1block__log_a5afbeabca60a1f842b83c107ec54cf99_icgraph.png" border="0" usemap="#aclasssysio_1_1chain_1_1block__log_a5afbeabca60a1f842b83c107ec54cf99_icgraph" alt=""/></div>
<map name="aclasssysio_1_1chain_1_1block__log_a5afbeabca60a1f842b83c107ec54cf99_icgraph" id="aclasssysio_1_1chain_1_1block__log_a5afbeabca60a1f842b83c107ec54cf99_icgraph">
<area shape="rect" title=" " alt="" coords="402,39,578,79"/>
<area shape="rect" href="classsysio_1_1chain_1_1detail_1_1reverse__iterator.html#a6cf878c882d8660a8cabb078c87941c8" title=" " alt="" coords="199,5,354,46"/>
<area shape="poly" title=" " alt="" coords="386,46,354,40,355,35,387,40"/>
<area shape="rect" href="structsysio_1_1chain_1_1trim__data.html#ab5de810b1245a1ebff191bda8b98c9a1" title=" " alt="" coords="216,71,337,111"/>
<area shape="poly" title=" " alt="" coords="387,77,338,85,337,79,387,72"/>
<area shape="rect" href="classsysio_1_1chain_1_1block__log.html#aa470fc3f2a09d1204b1321ecd0fbed33" title=" " alt="" coords="5,5,151,46"/>
<area shape="poly" title=" " alt="" coords="183,28,151,28,151,23,183,23"/>
</map>
</div>

</div>
</div>
<a id="a8649ead0a8c1e670284a8880747ee1bf" name="a8649ead0a8c1e670284a8880747ee1bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8649ead0a8c1e670284a8880747ee1bf">&#9670;&#160;</a></span>read_block()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacesysio_1_1chain.html#aa10ee348c57604b615bc8570f6685102">signed_block_ptr</a> sysio::chain::block_log::read_block </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a></td>          <td class="paramname"><span class="paramname"><em>file_pos</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="block__log_8cpp_source.html#l00612">612</a> of file <a class="el" href="block__log_8cpp_source.html">block_log.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  612</span>                                                           {</div>
<div class="line"><span class="lineno">  613</span>      my-&gt;check_open_files();</div>
<div class="line"><span class="lineno">  614</span> </div>
<div class="line"><span class="lineno">  615</span>      my-&gt;block_file.seek(pos);</div>
<div class="line"><span class="lineno">  616</span>      <a class="code hl_typedef" href="namespacesysio_1_1chain.html#aa10ee348c57604b615bc8570f6685102">signed_block_ptr</a> result = std::make_shared&lt;signed_block&gt;();</div>
<div class="line"><span class="lineno">  617</span>      <span class="keyword">auto</span> <a class="code hl_function" href="namespace_xbyak_1_1util.html#a4b2aef26182d21706896022467868f7c">ds</a> = my-&gt;block_file.create_datastream();</div>
<div class="line"><span class="lineno">  618</span>      <a class="code hl_function" href="namespacefc_1_1raw.html#a0b442d98ceb22dd5a6ae84745e43ffab">fc::raw::unpack</a>(ds, *result);</div>
<div class="line"><span class="lineno">  619</span>      <span class="keywordflow">return</span> result;</div>
<div class="line"><span class="lineno">  620</span>   }</div>
<div class="ttc" id="anamespace_xbyak_1_1util_html_a4b2aef26182d21706896022467868f7c"><div class="ttname"><a href="namespace_xbyak_1_1util.html#a4b2aef26182d21706896022467868f7c">Xbyak::util::ds</a></div><div class="ttdeci">static const Segment ds(Segment::ds)</div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_aa10ee348c57604b615bc8570f6685102"><div class="ttname"><a href="namespacesysio_1_1chain.html#aa10ee348c57604b615bc8570f6685102">sysio::chain::signed_block_ptr</a></div><div class="ttdeci">std::shared_ptr&lt; signed_block &gt; signed_block_ptr</div><div class="ttdef"><b>Definition</b> <a href="block_8hpp_source.html#l00105">block.hpp:105</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classsysio_1_1chain_1_1block__log_a8649ead0a8c1e670284a8880747ee1bf_cgraph.png" border="0" usemap="#aclasssysio_1_1chain_1_1block__log_a8649ead0a8c1e670284a8880747ee1bf_cgraph" alt=""/></div>
<map name="aclasssysio_1_1chain_1_1block__log_a8649ead0a8c1e670284a8880747ee1bf_cgraph" id="aclasssysio_1_1chain_1_1block__log_a8649ead0a8c1e670284a8880747ee1bf_cgraph">
<area shape="rect" title=" " alt="" coords="5,22,136,62"/>
<area shape="rect" href="namespacefc_1_1raw.html#a0b442d98ceb22dd5a6ae84745e43ffab" title=" " alt="" coords="184,29,295,55"/>
<area shape="poly" title=" " alt="" coords="136,40,168,40,168,45,136,45"/>
<area shape="poly" title=" " alt="" coords="211,30,205,21,208,11,220,5,239,3,260,5,271,12,268,16,258,10,239,8,222,10,212,15,210,20,215,28"/>
</map>
</div>

</div>
</div>
<a id="a93b930af1b79483fd4969b3eb4f9d08b" name="a93b930af1b79483fd4969b3eb4f9d08b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a93b930af1b79483fd4969b3eb4f9d08b">&#9670;&#160;</a></span>read_block_by_id()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacesysio_1_1chain.html#aa10ee348c57604b615bc8570f6685102">signed_block_ptr</a> sysio::chain::block_log::read_block_by_id </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespacesysio_1_1chain.html#a4b8e4b7ed9dcd18ee75d0de62e88aa17">block_id_type</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>id</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="block__log_8hpp_source.html#l00060">60</a> of file <a class="el" href="block__log_8hpp_source.html">block_log.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   60</span>                                                                         {</div>
<div class="line"><span class="lineno">   61</span>            <span class="keywordflow">return</span> <a class="code hl_function" href="#a99c59d29b262144ad99eacc827f76107">read_block_by_num</a>(<a class="code hl_function" href="structsysio_1_1chain_1_1block__header.html#a39d57e33ef8d3f6ba59b4c458f0ae375">block_header::num_from_id</a>(<span class="keywordtype">id</span>));</div>
<div class="line"><span class="lineno">   62</span>         }</div>
<div class="ttc" id="aclasssysio_1_1chain_1_1block__log_html_a99c59d29b262144ad99eacc827f76107"><div class="ttname"><a href="#a99c59d29b262144ad99eacc827f76107">sysio::chain::block_log::read_block_by_num</a></div><div class="ttdeci">signed_block_ptr read_block_by_num(uint32_t block_num) const</div><div class="ttdef"><b>Definition</b> <a href="block__log_8cpp_source.html#l00630">block_log.cpp:630</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1block__header_html_a39d57e33ef8d3f6ba59b4c458f0ae375"><div class="ttname"><a href="structsysio_1_1chain_1_1block__header.html#a39d57e33ef8d3f6ba59b4c458f0ae375">sysio::chain::block_header::num_from_id</a></div><div class="ttdeci">static uint32_t num_from_id(const block_id_type &amp;id)</div><div class="ttdef"><b>Definition</b> <a href="block__header_8cpp_source.html#l00013">block_header.cpp:13</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classsysio_1_1chain_1_1block__log_a93b930af1b79483fd4969b3eb4f9d08b_cgraph.png" border="0" usemap="#aclasssysio_1_1chain_1_1block__log_a93b930af1b79483fd4969b3eb4f9d08b_cgraph" alt=""/></div>
<map name="aclasssysio_1_1chain_1_1block__log_a93b930af1b79483fd4969b3eb4f9d08b_cgraph" id="aclasssysio_1_1chain_1_1block__log_a93b930af1b79483fd4969b3eb4f9d08b_cgraph">
<area shape="rect" title=" " alt="" coords="5,39,160,79"/>
<area shape="rect" href="structsysio_1_1chain_1_1block__header.html#a39d57e33ef8d3f6ba59b4c458f0ae375" title=" " alt="" coords="217,5,368,46"/>
<area shape="poly" title=" " alt="" coords="159,44,201,37,202,43,160,49"/>
<area shape="rect" href="classsysio_1_1chain_1_1block__log.html#a99c59d29b262144ad99eacc827f76107" title=" " alt="" coords="208,71,377,111"/>
<area shape="poly" title=" " alt="" coords="160,68,192,73,191,78,159,73"/>
<area shape="rect" href="namespacefc.html#afb668c55fd6ee73e1fcd67e77d8f6009" title=" " alt="" coords="425,13,581,38"/>
<area shape="poly" title=" " alt="" coords="368,23,410,23,410,28,368,28"/>
</map>
</div>

</div>
</div>
<a id="a99c59d29b262144ad99eacc827f76107" name="a99c59d29b262144ad99eacc827f76107"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a99c59d29b262144ad99eacc827f76107">&#9670;&#160;</a></span>read_block_by_num()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacesysio_1_1chain.html#aa10ee348c57604b615bc8570f6685102">signed_block_ptr</a> sysio::chain::block_log::read_block_by_num </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a></td>          <td class="paramname"><span class="paramname"><em>block_num</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="block__log_8cpp_source.html#l00630">630</a> of file <a class="el" href="block__log_8cpp_source.html">block_log.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  630</span>                                                                        {</div>
<div class="line"><span class="lineno">  631</span>      <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno">  632</span>         <a class="code hl_typedef" href="namespacesysio_1_1chain.html#aa10ee348c57604b615bc8570f6685102">signed_block_ptr</a> b;</div>
<div class="line"><span class="lineno">  633</span>         <a class="code hl_typedef" href="stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a> pos = <a class="code hl_function" href="#ad95f8bb0f2ccd5d0fd4db1a13eb3106a">get_block_pos</a>(block_num);</div>
<div class="line"><span class="lineno">  634</span>         <span class="keywordflow">if</span> (pos != <a class="code hl_variable" href="#a02319a8bef22b7a167f17314c00b1ac1">npos</a>) {</div>
<div class="line"><span class="lineno">  635</span>            b = <a class="code hl_function" href="#a8649ead0a8c1e670284a8880747ee1bf">read_block</a>(pos);</div>
<div class="line"><span class="lineno">  636</span>            <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>(b-&gt;block_num() == block_num, reversible_blocks_exception,</div>
<div class="line"><span class="lineno">  637</span>                      <span class="stringliteral">&quot;Wrong block was read from block log.&quot;</span>, (<span class="stringliteral">&quot;returned&quot;</span>, b-&gt;block_num())(<span class="stringliteral">&quot;expected&quot;</span>, block_num));</div>
<div class="line"><span class="lineno">  638</span>         }</div>
<div class="line"><span class="lineno">  639</span>         <span class="keywordflow">return</span> b;</div>
<div class="line"><span class="lineno">  640</span>      } <a class="code hl_define" href="exception_8hpp.html#ae70bfa24f5a3bc0917382b3c17fc033c">FC_LOG_AND_RETHROW</a>()</div>
<div class="line"><span class="lineno">  641</span>   }</div>
<div class="ttc" id="aclasssysio_1_1chain_1_1block__log_html_a8649ead0a8c1e670284a8880747ee1bf"><div class="ttname"><a href="#a8649ead0a8c1e670284a8880747ee1bf">sysio::chain::block_log::read_block</a></div><div class="ttdeci">signed_block_ptr read_block(uint64_t file_pos) const</div><div class="ttdef"><b>Definition</b> <a href="block__log_8cpp_source.html#l00612">block_log.cpp:612</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1block__log_html_ad95f8bb0f2ccd5d0fd4db1a13eb3106a"><div class="ttname"><a href="#ad95f8bb0f2ccd5d0fd4db1a13eb3106a">sysio::chain::block_log::get_block_pos</a></div><div class="ttdeci">uint64_t get_block_pos(uint32_t block_num) const</div><div class="ttdef"><b>Definition</b> <a href="block__log_8cpp_source.html#l00667">block_log.cpp:667</a></div></div>
<div class="ttc" id="aexception_8hpp_html_ae70bfa24f5a3bc0917382b3c17fc033c"><div class="ttname"><a href="exception_8hpp.html#ae70bfa24f5a3bc0917382b3c17fc033c">FC_LOG_AND_RETHROW</a></div><div class="ttdeci">#define FC_LOG_AND_RETHROW()</div><div class="ttdef"><b>Definition</b> <a href="exception_8hpp_source.html#l00411">exception.hpp:411</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classsysio_1_1chain_1_1block__log_a99c59d29b262144ad99eacc827f76107_icgraph.png" border="0" usemap="#aclasssysio_1_1chain_1_1block__log_a99c59d29b262144ad99eacc827f76107_icgraph" alt=""/></div>
<map name="aclasssysio_1_1chain_1_1block__log_a99c59d29b262144ad99eacc827f76107_icgraph" id="aclasssysio_1_1chain_1_1block__log_a99c59d29b262144ad99eacc827f76107_icgraph">
<area shape="rect" title=" " alt="" coords="408,63,577,103"/>
<area shape="rect" href="classsysio_1_1chain_1_1block__log.html#a93b930af1b79483fd4969b3eb4f9d08b" title=" " alt="" coords="206,5,360,46"/>
<area shape="poly" title=" " alt="" coords="400,61,359,49,361,44,402,55"/>
<area shape="rect" href="structblocklog.html#ab8fb32dc3425a85102c05fe4a1c1fd62" title=" " alt="" coords="220,70,346,96"/>
<area shape="poly" title=" " alt="" coords="393,86,346,86,346,80,393,80"/>
<area shape="rect" href="structsysio_1_1chain_1_1controller__impl.html#a9a9e4b6fe15eb93e63ac98af9f170647" title=" " alt="" coords="207,120,359,161"/>
<area shape="poly" title=" " alt="" coords="402,110,360,122,359,117,401,105"/>
<area shape="rect" href="programs_2sysio-blocklog_2main_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627" title=" " alt="" coords="57,70,106,96"/>
<area shape="poly" title=" " alt="" coords="204,86,107,86,107,80,204,80"/>
<area shape="rect" href="structsysio_1_1chain_1_1controller__impl.html#a9efbc515682ae5dede91184c36af73f7" title=" " alt="" coords="5,120,158,161"/>
<area shape="poly" title=" " alt="" coords="191,143,158,143,158,138,191,138"/>
</map>
</div>

</div>
</div>
<a id="ab651ea69962e02a5386194e4d7e055a0" name="ab651ea69962e02a5386194e4d7e055a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab651ea69962e02a5386194e4d7e055a0">&#9670;&#160;</a></span>read_block_header()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sysio::chain::block_log::read_block_header </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsysio_1_1chain_1_1block__header.html">block_header</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>bh</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a></td>          <td class="paramname"><span class="paramname"><em>file_pos</em></span>&#160;) const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="block__log_8cpp_source.html#l00622">622</a> of file <a class="el" href="block__log_8cpp_source.html">block_log.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  622</span>                                                                        {</div>
<div class="line"><span class="lineno">  623</span>      my-&gt;check_open_files();</div>
<div class="line"><span class="lineno">  624</span> </div>
<div class="line"><span class="lineno">  625</span>      my-&gt;block_file.seek(pos);</div>
<div class="line"><span class="lineno">  626</span>      <span class="keyword">auto</span> <a class="code hl_function" href="namespace_xbyak_1_1util.html#a4b2aef26182d21706896022467868f7c">ds</a> = my-&gt;block_file.create_datastream();</div>
<div class="line"><span class="lineno">  627</span>      <a class="code hl_function" href="namespacefc_1_1raw.html#a0b442d98ceb22dd5a6ae84745e43ffab">fc::raw::unpack</a>(ds, bh);</div>
<div class="line"><span class="lineno">  628</span>   }</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classsysio_1_1chain_1_1block__log_ab651ea69962e02a5386194e4d7e055a0_cgraph.png" border="0" usemap="#aclasssysio_1_1chain_1_1block__log_ab651ea69962e02a5386194e4d7e055a0_cgraph" alt=""/></div>
<map name="aclasssysio_1_1chain_1_1block__log_ab651ea69962e02a5386194e4d7e055a0_cgraph" id="aclasssysio_1_1chain_1_1block__log_ab651ea69962e02a5386194e4d7e055a0_cgraph">
<area shape="rect" title=" " alt="" coords="5,22,168,62"/>
<area shape="rect" href="namespacefc_1_1raw.html#a0b442d98ceb22dd5a6ae84745e43ffab" title=" " alt="" coords="216,29,327,55"/>
<area shape="poly" title=" " alt="" coords="168,40,200,40,200,45,168,45"/>
<area shape="poly" title=" " alt="" coords="240,30,234,21,238,11,251,5,271,3,294,5,305,12,303,16,292,10,271,8,252,10,242,15,239,20,245,27"/>
</map>
</div>

</div>
</div>
<a id="a6ffacf2e1c69079d8c847a61d99b6219" name="a6ffacf2e1c69079d8c847a61d99b6219"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ffacf2e1c69079d8c847a61d99b6219">&#9670;&#160;</a></span>read_block_id_by_num()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacesysio_1_1chain.html#a4b8e4b7ed9dcd18ee75d0de62e88aa17">block_id_type</a> sysio::chain::block_log::read_block_id_by_num </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a></td>          <td class="paramname"><span class="paramname"><em>block_num</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="block__log_8cpp_source.html#l00643">643</a> of file <a class="el" href="block__log_8cpp_source.html">block_log.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  643</span>                                                                        {</div>
<div class="line"><span class="lineno">  644</span>      <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno">  645</span>         <a class="code hl_typedef" href="stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a> pos = <a class="code hl_function" href="#ad95f8bb0f2ccd5d0fd4db1a13eb3106a">get_block_pos</a>(block_num);</div>
<div class="line"><span class="lineno">  646</span>         <span class="keywordflow">if</span> (pos != <a class="code hl_variable" href="#a02319a8bef22b7a167f17314c00b1ac1">npos</a>) {</div>
<div class="line"><span class="lineno">  647</span>            block_header <a class="code hl_function" href="namespace_xbyak_1_1util.html#a9e90a2a9ab98a5658ae7b19641255d87">bh</a>;</div>
<div class="line"><span class="lineno">  648</span>            <a class="code hl_function" href="#ab651ea69962e02a5386194e4d7e055a0">read_block_header</a>(bh, pos);</div>
<div class="line"><span class="lineno">  649</span>            <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>(<a class="code hl_function" href="namespace_xbyak_1_1util.html#a9e90a2a9ab98a5658ae7b19641255d87">bh</a>.block_num() == block_num, reversible_blocks_exception,</div>
<div class="line"><span class="lineno">  650</span>                       <span class="stringliteral">&quot;Wrong block header was read from block log.&quot;</span>, (<span class="stringliteral">&quot;returned&quot;</span>, <a class="code hl_function" href="namespace_xbyak_1_1util.html#a9e90a2a9ab98a5658ae7b19641255d87">bh</a>.block_num())(<span class="stringliteral">&quot;expected&quot;</span>, block_num));</div>
<div class="line"><span class="lineno">  651</span>            <span class="keywordflow">return</span> <a class="code hl_function" href="namespace_xbyak_1_1util.html#a9e90a2a9ab98a5658ae7b19641255d87">bh</a>.calculate_id();</div>
<div class="line"><span class="lineno">  652</span>         }</div>
<div class="line"><span class="lineno">  653</span>         <span class="keywordflow">return</span> {};</div>
<div class="line"><span class="lineno">  654</span>      } <a class="code hl_define" href="exception_8hpp.html#ae70bfa24f5a3bc0917382b3c17fc033c">FC_LOG_AND_RETHROW</a>()</div>
<div class="line"><span class="lineno">  655</span>   }</div>
<div class="ttc" id="aclasssysio_1_1chain_1_1block__log_html_ab651ea69962e02a5386194e4d7e055a0"><div class="ttname"><a href="#ab651ea69962e02a5386194e4d7e055a0">sysio::chain::block_log::read_block_header</a></div><div class="ttdeci">void read_block_header(block_header &amp;bh, uint64_t file_pos) const</div><div class="ttdef"><b>Definition</b> <a href="block__log_8cpp_source.html#l00622">block_log.cpp:622</a></div></div>
<div class="ttc" id="anamespace_xbyak_1_1util_html_a9e90a2a9ab98a5658ae7b19641255d87"><div class="ttname"><a href="namespace_xbyak_1_1util.html#a9e90a2a9ab98a5658ae7b19641255d87">Xbyak::util::bh</a></div><div class="ttdeci">static const Reg8 bh(Operand::BH)</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2aa6dabbd33531db434a5e7325fde2e6" name="a2aa6dabbd33531db434a5e7325fde2e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2aa6dabbd33531db434a5e7325fde2e6">&#9670;&#160;</a></span>read_head()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacesysio_1_1chain.html#aa10ee348c57604b615bc8570f6685102">signed_block_ptr</a> sysio::chain::block_log::read_head </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="block__log_8cpp_source.html#l00671">671</a> of file <a class="el" href="block__log_8cpp_source.html">block_log.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  671</span>                                              {</div>
<div class="line"><span class="lineno">  672</span>      my-&gt;check_open_files();</div>
<div class="line"><span class="lineno">  673</span> </div>
<div class="line"><span class="lineno">  674</span>      <a class="code hl_typedef" href="stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a> pos;</div>
<div class="line"><span class="lineno">  675</span> </div>
<div class="line"><span class="lineno">  676</span>      <span class="comment">// Check that the file is not empty</span></div>
<div class="line"><span class="lineno">  677</span>      my-&gt;block_file.seek_end(0);</div>
<div class="line"><span class="lineno">  678</span>      <span class="keywordflow">if</span> (my-&gt;block_file.tellp() &lt;= <span class="keyword">sizeof</span>(pos))</div>
<div class="line"><span class="lineno">  679</span>         <span class="keywordflow">return</span> {};</div>
<div class="line"><span class="lineno">  680</span> </div>
<div class="line"><span class="lineno">  681</span>      <span class="comment">//figure out if this is a pruned log or not. we can&#39;t just look at the configuration since</span></div>
<div class="line"><span class="lineno">  682</span>      <span class="comment">// read_head() is called early on, and this isn&#39;t hot enough to warrant a member bool to track it</span></div>
<div class="line"><span class="lineno">  683</span>      my-&gt;block_file.seek(0);</div>
<div class="line"><span class="lineno">  684</span>      <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> current_version;</div>
<div class="line"><span class="lineno">  685</span>      <a class="code hl_function" href="namespacefc_1_1raw.html#a0b442d98ceb22dd5a6ae84745e43ffab">fc::raw::unpack</a>(my-&gt;block_file, current_version);</div>
<div class="line"><span class="lineno">  686</span>      <span class="keyword">const</span> <span class="keywordtype">bool</span> is_currently_pruned = detail::is_pruned_log_and_mask_version(current_version);</div>
<div class="line"><span class="lineno">  687</span> </div>
<div class="line"><span class="lineno">  688</span>      my-&gt;block_file.seek_end(0);</div>
<div class="line"><span class="lineno">  689</span>      <span class="keywordflow">if</span>(is_currently_pruned)</div>
<div class="line"><span class="lineno">  690</span>         my-&gt;block_file.skip(-<span class="keyword">sizeof</span>(<a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>)); <span class="comment">//skip the trailer containing block count</span></div>
<div class="line"><span class="lineno">  691</span>      my-&gt;block_file.skip(-<span class="keyword">sizeof</span>(pos));</div>
<div class="line"><span class="lineno">  692</span>      <a class="code hl_function" href="namespacefc_1_1raw.html#a0b442d98ceb22dd5a6ae84745e43ffab">fc::raw::unpack</a>(my-&gt;block_file, pos);</div>
<div class="line"><span class="lineno">  693</span>      <span class="keywordflow">if</span> (pos != <a class="code hl_variable" href="#a02319a8bef22b7a167f17314c00b1ac1">npos</a>)</div>
<div class="line"><span class="lineno">  694</span>         <span class="keywordflow">return</span> <a class="code hl_function" href="#a8649ead0a8c1e670284a8880747ee1bf">read_block</a>(pos);</div>
<div class="line"><span class="lineno">  695</span>      <span class="keywordflow">return</span> {};</div>
<div class="line"><span class="lineno">  696</span>   }</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classsysio_1_1chain_1_1block__log_a2aa6dabbd33531db434a5e7325fde2e6_cgraph.png" border="0" usemap="#aclasssysio_1_1chain_1_1block__log_a2aa6dabbd33531db434a5e7325fde2e6_cgraph" alt=""/></div>
<map name="aclasssysio_1_1chain_1_1block__log_a2aa6dabbd33531db434a5e7325fde2e6_cgraph" id="aclasssysio_1_1chain_1_1block__log_a2aa6dabbd33531db434a5e7325fde2e6_cgraph">
<area shape="rect" title=" " alt="" coords="5,22,136,62"/>
<area shape="rect" href="namespacefc_1_1raw.html#a0b442d98ceb22dd5a6ae84745e43ffab" title=" " alt="" coords="184,29,295,55"/>
<area shape="poly" title=" " alt="" coords="136,40,168,40,168,45,136,45"/>
<area shape="poly" title=" " alt="" coords="211,30,205,21,208,11,220,5,239,3,260,5,271,12,268,16,258,10,239,8,222,10,212,15,210,20,215,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classsysio_1_1chain_1_1block__log_a2aa6dabbd33531db434a5e7325fde2e6_icgraph.png" border="0" usemap="#aclasssysio_1_1chain_1_1block__log_a2aa6dabbd33531db434a5e7325fde2e6_icgraph" alt=""/></div>
<map name="aclasssysio_1_1chain_1_1block__log_a2aa6dabbd33531db434a5e7325fde2e6_icgraph" id="aclasssysio_1_1chain_1_1block__log_a2aa6dabbd33531db434a5e7325fde2e6_icgraph">
<area shape="rect" title=" " alt="" coords="277,5,407,46"/>
<area shape="rect" href="structblocklog.html#ab8fb32dc3425a85102c05fe4a1c1fd62" title=" " alt="" coords="103,13,229,38"/>
<area shape="poly" title=" " alt="" coords="262,28,229,28,229,23,262,23"/>
<area shape="rect" href="programs_2sysio-blocklog_2main_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627" title=" " alt="" coords="5,13,55,38"/>
<area shape="poly" title=" " alt="" coords="87,28,55,28,55,23,87,23"/>
</map>
</div>

</div>
</div>
<a id="a28d7828f2ef978077453c8b0f97f5c04" name="a28d7828f2ef978077453c8b0f97f5c04"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a28d7828f2ef978077453c8b0f97f5c04">&#9670;&#160;</a></span>repair_log()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfc_1_1path.html">fc::path</a> sysio::chain::block_log::repair_log </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classfc_1_1path.html">fc::path</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>data_dir</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a></td>          <td class="paramname"><span class="paramname"><em>truncate_at_block</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>reversible_block_dir_name</em></span><span class="paramdefsep"> = </span><span class="paramdefval">&quot;&quot;</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="block__log_8cpp_source.html#l00751">751</a> of file <a class="el" href="block__log_8cpp_source.html">block_log.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  751</span>                                                                                                                         {</div>
<div class="line"><span class="lineno">  752</span>      <a class="code hl_define" href="logger_8hpp.html#a831cf08dc63704c11fd154132c6e8bdb">ilog</a>(<span class="stringliteral">&quot;Recovering Block Log...&quot;</span>);</div>
<div class="line"><span class="lineno">  753</span>      <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( <a class="code hl_function" href="namespacefc.html#ab123bfeadf918cc293ecad88bca7c499">fc::is_directory</a>(data_dir) &amp;&amp; <a class="code hl_function" href="namespacefc.html#a6855142912d4cfb89281ba0c7f4938a2">fc::is_regular_file</a>(data_dir / <span class="stringliteral">&quot;blocks.log&quot;</span>), block_log_not_found,</div>
<div class="line"><span class="lineno">  754</span>                 <span class="stringliteral">&quot;Block log not found in &#39;${blocks_dir}&#39;&quot;</span>, (<span class="stringliteral">&quot;blocks_dir&quot;</span>, data_dir)          );</div>
<div class="line"><span class="lineno">  755</span> </div>
<div class="line"><span class="lineno">  756</span>      <span class="keyword">auto</span> now = <a class="code hl_function" href="classfc_1_1time__point.html#aa164ff1268a16d4b32afcff181f6100e">fc::time_point::now</a>();</div>
<div class="line"><span class="lineno">  757</span> </div>
<div class="line"><span class="lineno">  758</span>      <span class="keyword">auto</span> blocks_dir = <a class="code hl_function" href="namespacefc.html#ac7ca5987762ad2fba3d278b956067171">fc::canonical</a>( data_dir );</div>
<div class="line"><span class="lineno">  759</span>      <span class="keywordflow">if</span>( blocks_dir.filename().generic_string() == <span class="stringliteral">&quot;.&quot;</span> ) {</div>
<div class="line"><span class="lineno">  760</span>         blocks_dir = blocks_dir.parent_path();</div>
<div class="line"><span class="lineno">  761</span>      }</div>
<div class="line"><span class="lineno">  762</span>      <span class="keyword">auto</span> backup_dir = blocks_dir.parent_path();</div>
<div class="line"><span class="lineno">  763</span>      <span class="keyword">auto</span> blocks_dir_name = blocks_dir.filename();</div>
<div class="line"><span class="lineno">  764</span>      <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( blocks_dir_name.generic_string() != <span class="stringliteral">&quot;.&quot;</span>, block_log_exception, <span class="stringliteral">&quot;Invalid path to blocks directory&quot;</span> );</div>
<div class="line"><span class="lineno">  765</span>      backup_dir = backup_dir / blocks_dir_name.generic_string().append(<span class="stringliteral">&quot;-&quot;</span>).append( now );</div>
<div class="line"><span class="lineno">  766</span> </div>
<div class="line"><span class="lineno">  767</span>      <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( !<a class="code hl_function" href="namespacefc.html#a3fcf0d920aea28014aacae50a51d8485">fc::exists</a>(backup_dir), block_log_backup_dir_exist,</div>
<div class="line"><span class="lineno">  768</span>                 <span class="stringliteral">&quot;Cannot move existing blocks directory to already existing directory &#39;${new_blocks_dir}&#39;&quot;</span>,</div>
<div class="line"><span class="lineno">  769</span>                 (<span class="stringliteral">&quot;new_blocks_dir&quot;</span>, backup_dir) );</div>
<div class="line"><span class="lineno">  770</span> </div>
<div class="line"><span class="lineno">  771</span>      <a class="code hl_function" href="namespacefc.html#a067b275100894b82b6cf3aa85e804ea5">fc::rename</a>( blocks_dir, backup_dir );</div>
<div class="line"><span class="lineno">  772</span>      <a class="code hl_define" href="logger_8hpp.html#a831cf08dc63704c11fd154132c6e8bdb">ilog</a>( <span class="stringliteral">&quot;Moved existing blocks directory to backup location: &#39;${new_blocks_dir}&#39;&quot;</span>, (<span class="stringliteral">&quot;new_blocks_dir&quot;</span>, backup_dir) );</div>
<div class="line"><span class="lineno">  773</span> </div>
<div class="line"><span class="lineno">  774</span>      <span class="keywordflow">if</span> (strlen(reversible_block_dir_name) &amp;&amp; <a class="code hl_function" href="namespacefc.html#ab123bfeadf918cc293ecad88bca7c499">fc::is_directory</a>(blocks_dir/reversible_block_dir_name)) {</div>
<div class="line"><span class="lineno">  775</span>         <a class="code hl_function" href="namespacefc.html#a067b275100894b82b6cf3aa85e804ea5">fc::rename</a>(blocks_dir/ reversible_block_dir_name, backup_dir/ reversible_block_dir_name);</div>
<div class="line"><span class="lineno">  776</span>      }</div>
<div class="line"><span class="lineno">  777</span> </div>
<div class="line"><span class="lineno">  778</span>      <a class="code hl_function" href="namespacefc.html#a76b0787468a9f403087b71a894c07ce2">fc::create_directories</a>(blocks_dir);</div>
<div class="line"><span class="lineno">  779</span>      <span class="keyword">auto</span> block_log_path = blocks_dir / <span class="stringliteral">&quot;blocks.log&quot;</span>;</div>
<div class="line"><span class="lineno">  780</span> </div>
<div class="line"><span class="lineno">  781</span>      <a class="code hl_define" href="logger_8hpp.html#a831cf08dc63704c11fd154132c6e8bdb">ilog</a>( <span class="stringliteral">&quot;Reconstructing &#39;${new_block_log}&#39; from backed up block log&quot;</span>, (<span class="stringliteral">&quot;new_block_log&quot;</span>, block_log_path) );</div>
<div class="line"><span class="lineno">  782</span> </div>
<div class="line"><span class="lineno">  783</span>      std::fstream  old_block_stream;</div>
<div class="line"><span class="lineno">  784</span>      std::fstream  new_block_stream;</div>
<div class="line"><span class="lineno">  785</span> </div>
<div class="line"><span class="lineno">  786</span>      old_block_stream.open( (backup_dir / <span class="stringliteral">&quot;blocks.log&quot;</span>).generic_string().c_str(), <a class="code hl_define" href="block__log_8cpp.html#a3497123c2fea68436d49bf8958cb4a16">LOG_READ</a> );</div>
<div class="line"><span class="lineno">  787</span>      new_block_stream.open( block_log_path.generic_string().c_str(), <a class="code hl_define" href="block__log_8cpp.html#aaf68571e96842f6a43dab5c1a97cd923">LOG_WRITE</a> );</div>
<div class="line"><span class="lineno">  788</span> </div>
<div class="line"><span class="lineno">  789</span>      old_block_stream.seekg( 0, std::ios::end );</div>
<div class="line"><span class="lineno">  790</span>      <a class="code hl_typedef" href="stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a> end_pos = old_block_stream.tellg();</div>
<div class="line"><span class="lineno">  791</span>      old_block_stream.seekg( 0 );</div>
<div class="line"><span class="lineno">  792</span> </div>
<div class="line"><span class="lineno">  793</span>      <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="code hl_enumvalue" href="namespacewebsocketpp_1_1http_1_1parser_1_1state.html#a12f378e0c6dbf373781e7988ee4a0853a08c88a938bc459c7997b48f74248752f">version</a> = 0;</div>
<div class="line"><span class="lineno">  794</span>      old_block_stream.read( (<span class="keywordtype">char</span>*)&amp;version, <span class="keyword">sizeof</span>(version) );</div>
<div class="line"><span class="lineno">  795</span>      <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( version &gt; 0, block_log_exception, <span class="stringliteral">&quot;Block log was not setup properly&quot;</span> );</div>
<div class="line"><span class="lineno">  796</span>      <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( <a class="code hl_function" href="#a5afbeabca60a1f842b83c107ec54cf99">is_supported_version</a>(version), block_log_unsupported_version,</div>
<div class="line"><span class="lineno">  797</span>                 <span class="stringliteral">&quot;Unsupported version of block log. Block log version is ${version} while code supports version(s) [${min},${max}]&quot;</span>,</div>
<div class="line"><span class="lineno">  798</span>                 (<span class="stringliteral">&quot;version&quot;</span>, version)(<span class="stringliteral">&quot;min&quot;</span>, <a class="code hl_variable" href="#a8f0f031e0f64def456185998d462d35d">block_log::min_supported_version</a>)(<span class="stringliteral">&quot;max&quot;</span>, <a class="code hl_variable" href="#add7716a8093b81e1a51ed52897e97770">block_log::max_supported_version</a>) );</div>
<div class="line"><span class="lineno">  799</span> </div>
<div class="line"><span class="lineno">  800</span>      new_block_stream.write( (<span class="keywordtype">char</span>*)&amp;version, <span class="keyword">sizeof</span>(version) );</div>
<div class="line"><span class="lineno">  801</span> </div>
<div class="line"><span class="lineno">  802</span>      <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="code hl_function" href="#ac5f1c1e78e72414fbf9bae75da42303e">first_block_num</a> = 1;</div>
<div class="line"><span class="lineno">  803</span>      <span class="keywordflow">if</span> (version != 1) {</div>
<div class="line"><span class="lineno">  804</span>         old_block_stream.read ( (<span class="keywordtype">char</span>*)&amp;<a class="code hl_function" href="#ac5f1c1e78e72414fbf9bae75da42303e">first_block_num</a>, <span class="keyword">sizeof</span>(<a class="code hl_function" href="#ac5f1c1e78e72414fbf9bae75da42303e">first_block_num</a>) );</div>
<div class="line"><span class="lineno">  805</span> </div>
<div class="line"><span class="lineno">  806</span>         <span class="comment">// this assert is only here since repair_log is only used for --hard-replay-blockchain, which removes any</span></div>
<div class="line"><span class="lineno">  807</span>         <span class="comment">// existing state, if another API needs to use it, this can be removed and the check for the first block&#39;s</span></div>
<div class="line"><span class="lineno">  808</span>         <span class="comment">// previous block id will need to accommodate this.</span></div>
<div class="line"><span class="lineno">  809</span>         <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( <a class="code hl_function" href="#ac5f1c1e78e72414fbf9bae75da42303e">first_block_num</a> == 1, block_log_exception,</div>
<div class="line"><span class="lineno">  810</span>                     <span class="stringliteral">&quot;Block log ${file} must contain a genesis state and start at block number 1.  This block log &quot;</span></div>
<div class="line"><span class="lineno">  811</span>                     <span class="stringliteral">&quot;starts at block number ${first_block_num}.&quot;</span>,</div>
<div class="line"><span class="lineno">  812</span>                     (<span class="stringliteral">&quot;file&quot;</span>, (backup_dir / <span class="stringliteral">&quot;blocks.log&quot;</span>).generic_string())(<span class="stringliteral">&quot;first_block_num&quot;</span>, <a class="code hl_function" href="#ac5f1c1e78e72414fbf9bae75da42303e">first_block_num</a>));</div>
<div class="line"><span class="lineno">  813</span> </div>
<div class="line"><span class="lineno">  814</span>         new_block_stream.write( (<span class="keywordtype">char</span>*)&amp;<a class="code hl_function" href="#ac5f1c1e78e72414fbf9bae75da42303e">first_block_num</a>, <span class="keyword">sizeof</span>(<a class="code hl_function" href="#ac5f1c1e78e72414fbf9bae75da42303e">first_block_num</a>) );</div>
<div class="line"><span class="lineno">  815</span>      }</div>
<div class="line"><span class="lineno">  816</span> </div>
<div class="line"><span class="lineno">  817</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="#ad760661c5030845b1369fee21e08a909">contains_genesis_state</a>(version, <a class="code hl_function" href="#ac5f1c1e78e72414fbf9bae75da42303e">first_block_num</a>)) {</div>
<div class="line"><span class="lineno">  818</span>         genesis_state <a class="code hl_function" href="namespace_xbyak_1_1util.html#a051ad68b75c300988da81d4804273b56">gs</a>;</div>
<div class="line"><span class="lineno">  819</span>         <a class="code hl_function" href="namespacefc_1_1raw.html#a0b442d98ceb22dd5a6ae84745e43ffab">fc::raw::unpack</a>(old_block_stream, gs);</div>
<div class="line"><span class="lineno">  820</span> </div>
<div class="line"><span class="lineno">  821</span>         <span class="keyword">auto</span> data = <a class="code hl_function" href="namespacefc_1_1raw.html#a3a18d8161aa5b4f4f02b6fcfdff5e5d1">fc::raw::pack</a>( gs );</div>
<div class="line"><span class="lineno">  822</span>         new_block_stream.write( data.data(), data.size() );</div>
<div class="line"><span class="lineno">  823</span>      }</div>
<div class="line"><span class="lineno">  824</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="#a370e648384d16b6d60ca211921501cc6">contains_chain_id</a>(version, <a class="code hl_function" href="#ac5f1c1e78e72414fbf9bae75da42303e">first_block_num</a>)) {</div>
<div class="line"><span class="lineno">  825</span>         chain_id_type chain_id;</div>
<div class="line"><span class="lineno">  826</span>         old_block_stream &gt;&gt; chain_id;</div>
<div class="line"><span class="lineno">  827</span> </div>
<div class="line"><span class="lineno">  828</span>         new_block_stream &lt;&lt; chain_id;</div>
<div class="line"><span class="lineno">  829</span>      }</div>
<div class="line"><span class="lineno">  830</span>      <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  831</span>         <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a1bfa656552ea0534b2c91ee0fe33f850">SYS_THROW</a>( block_log_exception,</div>
<div class="line"><span class="lineno">  832</span>                    <span class="stringliteral">&quot;Block log ${file} is not supported. version: ${ver} and first_block_num: ${fbn} does not contain &quot;</span></div>
<div class="line"><span class="lineno">  833</span>                    <span class="stringliteral">&quot;a genesis_state nor a chain_id.&quot;</span>,</div>
<div class="line"><span class="lineno">  834</span>                    (<span class="stringliteral">&quot;file&quot;</span>, (backup_dir / <span class="stringliteral">&quot;blocks.log&quot;</span>).generic_string())(<span class="stringliteral">&quot;ver&quot;</span>, version)(<span class="stringliteral">&quot;fbn&quot;</span>, <a class="code hl_function" href="#ac5f1c1e78e72414fbf9bae75da42303e">first_block_num</a>));</div>
<div class="line"><span class="lineno">  835</span>      }</div>
<div class="line"><span class="lineno">  836</span> </div>
<div class="line"><span class="lineno">  837</span>      <span class="keywordflow">if</span> (version != 1) {</div>
<div class="line"><span class="lineno">  838</span>         <span class="keyword">auto</span> expected_totem = <a class="code hl_variable" href="#a02319a8bef22b7a167f17314c00b1ac1">npos</a>;</div>
<div class="line"><span class="lineno">  839</span>         std::decay_t&lt;<span class="keyword">decltype</span>(<a class="code hl_variable" href="#a02319a8bef22b7a167f17314c00b1ac1">npos</a>)&gt; actual_totem;</div>
<div class="line"><span class="lineno">  840</span>         old_block_stream.read ( (<span class="keywordtype">char</span>*)&amp;actual_totem, <span class="keyword">sizeof</span>(actual_totem) );</div>
<div class="line"><span class="lineno">  841</span> </div>
<div class="line"><span class="lineno">  842</span>         <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>(actual_totem == expected_totem, block_log_exception,</div>
<div class="line"><span class="lineno">  843</span>                    <span class="stringliteral">&quot;Expected separator between block log header and blocks was not found( expected: ${e}, actual: ${a} )&quot;</span>,</div>
<div class="line"><span class="lineno">  844</span>                    (<span class="stringliteral">&quot;e&quot;</span>, <a class="code hl_function" href="namespacefc.html#aab567c89004d329f560014d9943afcd6">fc::to_hex</a>((<span class="keywordtype">char</span>*)&amp;expected_totem, <span class="keyword">sizeof</span>(expected_totem) ))(<span class="stringliteral">&quot;a&quot;</span>, <a class="code hl_function" href="namespacefc.html#aab567c89004d329f560014d9943afcd6">fc::to_hex</a>((<span class="keywordtype">char</span>*)&amp;actual_totem, <span class="keyword">sizeof</span>(actual_totem) )));</div>
<div class="line"><span class="lineno">  845</span> </div>
<div class="line"><span class="lineno">  846</span>         new_block_stream.write( (<span class="keywordtype">char</span>*)&amp;actual_totem, <span class="keyword">sizeof</span>(actual_totem) );</div>
<div class="line"><span class="lineno">  847</span>      }</div>
<div class="line"><span class="lineno">  848</span> </div>
<div class="line"><span class="lineno">  849</span>      std::exception_ptr          except_ptr;</div>
<div class="line"><span class="lineno">  850</span>      vector&lt;char&gt;                incomplete_block_data;</div>
<div class="line"><span class="lineno">  851</span>      std::optional&lt;signed_block&gt; bad_block;</div>
<div class="line"><span class="lineno">  852</span>      <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>                    block_num = 0;</div>
<div class="line"><span class="lineno">  853</span> </div>
<div class="line"><span class="lineno">  854</span>      <a class="code hl_typedef" href="namespacesysio_1_1chain.html#a4b8e4b7ed9dcd18ee75d0de62e88aa17">block_id_type</a> <a class="code hl_function" href="namespaceutf8.html#aedaf9315740d4f25b43c188b02b5bcd0">previous</a>;</div>
<div class="line"><span class="lineno">  855</span> </div>
<div class="line"><span class="lineno">  856</span>      <a class="code hl_typedef" href="stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a> pos = old_block_stream.tellg();</div>
<div class="line"><span class="lineno">  857</span>      <span class="keywordflow">while</span>( pos &lt; end_pos ) {</div>
<div class="line"><span class="lineno">  858</span>         signed_block tmp;</div>
<div class="line"><span class="lineno">  859</span> </div>
<div class="line"><span class="lineno">  860</span>         <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno">  861</span>            <a class="code hl_function" href="namespacefc_1_1raw.html#a0b442d98ceb22dd5a6ae84745e43ffab">fc::raw::unpack</a>(old_block_stream, tmp);</div>
<div class="line"><span class="lineno">  862</span>         } <span class="keywordflow">catch</span>( ... ) {</div>
<div class="line"><span class="lineno">  863</span>            except_ptr = std::current_exception();</div>
<div class="line"><span class="lineno">  864</span>            incomplete_block_data.resize( end_pos - pos );</div>
<div class="line"><span class="lineno">  865</span>            old_block_stream.read( incomplete_block_data.data(), incomplete_block_data.size() );</div>
<div class="line"><span class="lineno">  866</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  867</span>         }</div>
<div class="line"><span class="lineno">  868</span> </div>
<div class="line"><span class="lineno">  869</span>         <span class="keyword">auto</span> <span class="keywordtype">id</span> = tmp.calculate_id();</div>
<div class="line"><span class="lineno">  870</span>         <span class="keywordflow">if</span>( <a class="code hl_function" href="structsysio_1_1chain_1_1block__header.html#a39d57e33ef8d3f6ba59b4c458f0ae375">block_header::num_from_id</a>(previous) + 1 != <a class="code hl_function" href="structsysio_1_1chain_1_1block__header.html#a39d57e33ef8d3f6ba59b4c458f0ae375">block_header::num_from_id</a>(<span class="keywordtype">id</span>) ) {</div>
<div class="line"><span class="lineno">  871</span>            <a class="code hl_define" href="logger_8hpp.html#a9e3cdbaecd5a34b42956e888f7326fad">elog</a>( <span class="stringliteral">&quot;Block ${num} (${id}) skips blocks. Previous block in block log is block ${prev_num} (${previous})&quot;</span>,</div>
<div class="line"><span class="lineno">  872</span>                  (<span class="stringliteral">&quot;num&quot;</span>, <a class="code hl_function" href="structsysio_1_1chain_1_1block__header.html#a39d57e33ef8d3f6ba59b4c458f0ae375">block_header::num_from_id</a>(<span class="keywordtype">id</span>))(<span class="stringliteral">&quot;id&quot;</span>, <span class="keywordtype">id</span>)</div>
<div class="line"><span class="lineno">  873</span>                  (<span class="stringliteral">&quot;prev_num&quot;</span>, <a class="code hl_function" href="structsysio_1_1chain_1_1block__header.html#a39d57e33ef8d3f6ba59b4c458f0ae375">block_header::num_from_id</a>(previous))(<span class="stringliteral">&quot;previous&quot;</span>, previous) );</div>
<div class="line"><span class="lineno">  874</span>         }</div>
<div class="line"><span class="lineno">  875</span>         <span class="keywordflow">if</span>( previous != tmp.previous ) {</div>
<div class="line"><span class="lineno">  876</span>            <a class="code hl_define" href="logger_8hpp.html#a9e3cdbaecd5a34b42956e888f7326fad">elog</a>( <span class="stringliteral">&quot;Block ${num} (${id}) does not link back to previous block. &quot;</span></div>
<div class="line"><span class="lineno">  877</span>                  <span class="stringliteral">&quot;Expected previous: ${expected}. Actual previous: ${actual}.&quot;</span>,</div>
<div class="line"><span class="lineno">  878</span>                  (<span class="stringliteral">&quot;num&quot;</span>, <a class="code hl_function" href="structsysio_1_1chain_1_1block__header.html#a39d57e33ef8d3f6ba59b4c458f0ae375">block_header::num_from_id</a>(<span class="keywordtype">id</span>))(<span class="stringliteral">&quot;id&quot;</span>, <span class="keywordtype">id</span>)(<span class="stringliteral">&quot;expected&quot;</span>, previous)(<span class="stringliteral">&quot;actual&quot;</span>, tmp.previous) );</div>
<div class="line"><span class="lineno">  879</span>         }</div>
<div class="line"><span class="lineno">  880</span>         <a class="code hl_function" href="namespaceutf8.html#aedaf9315740d4f25b43c188b02b5bcd0">previous</a> = <a class="code hl_variable" href="code__cache_8cpp.html#aa0efefe21f4700d78692edc823e763be">id</a>;</div>
<div class="line"><span class="lineno">  881</span> </div>
<div class="line"><span class="lineno">  882</span>         <a class="code hl_typedef" href="stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a> tmp_pos = std::numeric_limits&lt;uint64_t&gt;::max();</div>
<div class="line"><span class="lineno">  883</span>         <span class="keywordflow">if</span>( (<span class="keyword">static_cast&lt;</span><a class="code hl_typedef" href="stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a><span class="keyword">&gt;</span>(old_block_stream.tellg()) + <span class="keyword">sizeof</span>(pos)) &lt;= end_pos ) {</div>
<div class="line"><span class="lineno">  884</span>            old_block_stream.read( <span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(&amp;tmp_pos), <span class="keyword">sizeof</span>(tmp_pos) );</div>
<div class="line"><span class="lineno">  885</span>         }</div>
<div class="line"><span class="lineno">  886</span>         <span class="keywordflow">if</span>( pos != tmp_pos ) {</div>
<div class="line"><span class="lineno">  887</span>            bad_block.emplace(std::move(tmp));</div>
<div class="line"><span class="lineno">  888</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  889</span>         }</div>
<div class="line"><span class="lineno">  890</span> </div>
<div class="line"><span class="lineno">  891</span>         <span class="keyword">auto</span> data = <a class="code hl_function" href="namespacefc_1_1raw.html#a3a18d8161aa5b4f4f02b6fcfdff5e5d1">fc::raw::pack</a>(tmp);</div>
<div class="line"><span class="lineno">  892</span>         new_block_stream.write( data.data(), data.size() );</div>
<div class="line"><span class="lineno">  893</span>         new_block_stream.write( <span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(&amp;pos), <span class="keyword">sizeof</span>(pos) );</div>
<div class="line"><span class="lineno">  894</span>         block_num = tmp.block_num();</div>
<div class="line"><span class="lineno">  895</span>         <span class="keywordflow">if</span>(block_num % 1000 == 0)</div>
<div class="line"><span class="lineno">  896</span>            <a class="code hl_define" href="logger_8hpp.html#a831cf08dc63704c11fd154132c6e8bdb">ilog</a>( <span class="stringliteral">&quot;Recovered block ${num}&quot;</span>, (<span class="stringliteral">&quot;num&quot;</span>, block_num) );</div>
<div class="line"><span class="lineno">  897</span>         pos = new_block_stream.tellp();</div>
<div class="line"><span class="lineno">  898</span>         <span class="keywordflow">if</span>( block_num == truncate_at_block )</div>
<div class="line"><span class="lineno">  899</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  900</span>      }</div>
<div class="line"><span class="lineno">  901</span> </div>
<div class="line"><span class="lineno">  902</span>      <span class="keywordflow">if</span>( bad_block ) {</div>
<div class="line"><span class="lineno">  903</span>         <a class="code hl_define" href="logger_8hpp.html#a831cf08dc63704c11fd154132c6e8bdb">ilog</a>( <span class="stringliteral">&quot;Recovered only up to block number ${num}. Last block in block log was not properly committed:\n${last_block}&quot;</span>,</div>
<div class="line"><span class="lineno">  904</span>               (<span class="stringliteral">&quot;num&quot;</span>, block_num)(<span class="stringliteral">&quot;last_block&quot;</span>, *bad_block) );</div>
<div class="line"><span class="lineno">  905</span>      } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( except_ptr ) {</div>
<div class="line"><span class="lineno">  906</span>         std::string error_msg;</div>
<div class="line"><span class="lineno">  907</span> </div>
<div class="line"><span class="lineno">  908</span>         <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno">  909</span>            std::rethrow_exception(except_ptr);</div>
<div class="line"><span class="lineno">  910</span>         } <span class="keywordflow">catch</span>( <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1exception.html">fc::exception</a>&amp; e ) {</div>
<div class="line"><span class="lineno">  911</span>            error_msg = e.<a class="code hl_function" href="classfc_1_1exception.html#ab1104818bf0d9b6a29f0dfe036cf97f6">what</a>();</div>
<div class="line"><span class="lineno">  912</span>         } <span class="keywordflow">catch</span>( <span class="keyword">const</span> std::exception&amp; e ) {</div>
<div class="line"><span class="lineno">  913</span>            error_msg = e.what();</div>
<div class="line"><span class="lineno">  914</span>         } <span class="keywordflow">catch</span>( ... ) {</div>
<div class="line"><span class="lineno">  915</span>            error_msg = <span class="stringliteral">&quot;unrecognized exception&quot;</span>;</div>
<div class="line"><span class="lineno">  916</span>         }</div>
<div class="line"><span class="lineno">  917</span> </div>
<div class="line"><span class="lineno">  918</span>         <a class="code hl_define" href="logger_8hpp.html#a831cf08dc63704c11fd154132c6e8bdb">ilog</a>( <span class="stringliteral">&quot;Recovered only up to block number ${num}. &quot;</span></div>
<div class="line"><span class="lineno">  919</span>               <span class="stringliteral">&quot;The block ${next_num} could not be deserialized from the block log due to error:\n${error_msg}&quot;</span>,</div>
<div class="line"><span class="lineno">  920</span>               (<span class="stringliteral">&quot;num&quot;</span>, block_num)(<span class="stringliteral">&quot;next_num&quot;</span>, block_num+1)(<span class="stringliteral">&quot;error_msg&quot;</span>, error_msg) );</div>
<div class="line"><span class="lineno">  921</span> </div>
<div class="line"><span class="lineno">  922</span>         <span class="keyword">auto</span> tail_path = blocks_dir / std::string(<span class="stringliteral">&quot;blocks-bad-tail-&quot;</span>).append( now ).append(<span class="stringliteral">&quot;.log&quot;</span>);</div>
<div class="line"><span class="lineno">  923</span>         <span class="keywordflow">if</span>( !<a class="code hl_function" href="namespacefc.html#a3fcf0d920aea28014aacae50a51d8485">fc::exists</a>(tail_path) &amp;&amp; incomplete_block_data.size() &gt; 0 ) {</div>
<div class="line"><span class="lineno">  924</span>            std::fstream tail_stream;</div>
<div class="line"><span class="lineno">  925</span>            tail_stream.open( tail_path.generic_string().c_str(), <a class="code hl_define" href="block__log_8cpp.html#aaf68571e96842f6a43dab5c1a97cd923">LOG_WRITE</a> );</div>
<div class="line"><span class="lineno">  926</span>            tail_stream.write( incomplete_block_data.data(), incomplete_block_data.size() );</div>
<div class="line"><span class="lineno">  927</span> </div>
<div class="line"><span class="lineno">  928</span>            <a class="code hl_define" href="logger_8hpp.html#a831cf08dc63704c11fd154132c6e8bdb">ilog</a>( <span class="stringliteral">&quot;Data at tail end of block log which should contain the (incomplete) serialization of block ${num} &quot;</span></div>
<div class="line"><span class="lineno">  929</span>                  <span class="stringliteral">&quot;has been written out to &#39;${tail_path}&#39;.&quot;</span>,</div>
<div class="line"><span class="lineno">  930</span>                  (<span class="stringliteral">&quot;num&quot;</span>, block_num+1)(<span class="stringliteral">&quot;tail_path&quot;</span>, tail_path) );</div>
<div class="line"><span class="lineno">  931</span>         }</div>
<div class="line"><span class="lineno">  932</span>      } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( block_num == truncate_at_block &amp;&amp; pos &lt; end_pos ) {</div>
<div class="line"><span class="lineno">  933</span>         <a class="code hl_define" href="logger_8hpp.html#a831cf08dc63704c11fd154132c6e8bdb">ilog</a>( <span class="stringliteral">&quot;Stopped recovery of block log early at specified block number: ${stop}.&quot;</span>, (<span class="stringliteral">&quot;stop&quot;</span>, truncate_at_block) );</div>
<div class="line"><span class="lineno">  934</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  935</span>         <a class="code hl_define" href="logger_8hpp.html#a831cf08dc63704c11fd154132c6e8bdb">ilog</a>( <span class="stringliteral">&quot;Existing block log was undamaged. Recovered all irreversible blocks up to block number ${num}.&quot;</span>, (<span class="stringliteral">&quot;num&quot;</span>, block_num) );</div>
<div class="line"><span class="lineno">  936</span>      }</div>
<div class="line"><span class="lineno">  937</span> </div>
<div class="line"><span class="lineno">  938</span>      <span class="keywordflow">return</span> backup_dir;</div>
<div class="line"><span class="lineno">  939</span>   }</div>
<div class="ttc" id="ablock__log_8cpp_html_a3497123c2fea68436d49bf8958cb4a16"><div class="ttname"><a href="block__log_8cpp.html#a3497123c2fea68436d49bf8958cb4a16">LOG_READ</a></div><div class="ttdeci">#define LOG_READ</div><div class="ttdef"><b>Definition</b> <a href="block__log_8cpp_source.html#l00009">block_log.cpp:9</a></div></div>
<div class="ttc" id="ablock__log_8cpp_html_aaf68571e96842f6a43dab5c1a97cd923"><div class="ttname"><a href="block__log_8cpp.html#aaf68571e96842f6a43dab5c1a97cd923">LOG_WRITE</a></div><div class="ttdeci">#define LOG_WRITE</div><div class="ttdef"><b>Definition</b> <a href="block__log_8cpp_source.html#l00010">block_log.cpp:10</a></div></div>
<div class="ttc" id="achain_2include_2sysio_2chain_2exceptions_8hpp_html_a1bfa656552ea0534b2c91ee0fe33f850"><div class="ttname"><a href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a1bfa656552ea0534b2c91ee0fe33f850">SYS_THROW</a></div><div class="ttdeci">#define SYS_THROW(exc_type, FORMAT,...)</div><div class="ttdef"><b>Definition</b> <a href="chain_2include_2sysio_2chain_2exceptions_8hpp_source.html#l00013">exceptions.hpp:13</a></div></div>
<div class="ttc" id="aclassfc_1_1exception_html"><div class="ttname"><a href="classfc_1_1exception.html">fc::exception</a></div><div class="ttdoc">Used to generate a useful error report when an exception is thrown.</div><div class="ttdef"><b>Definition</b> <a href="exception_8hpp_source.html#l00057">exception.hpp:58</a></div></div>
<div class="ttc" id="aclassfc_1_1exception_html_ab1104818bf0d9b6a29f0dfe036cf97f6"><div class="ttname"><a href="classfc_1_1exception.html#ab1104818bf0d9b6a29f0dfe036cf97f6">fc::exception::what</a></div><div class="ttdeci">const char * what() const noexcept override</div><div class="ttdef"><b>Definition</b> <a href="exception_8cpp_source.html#l00121">exception.cpp:121</a></div></div>
<div class="ttc" id="aclassfc_1_1time__point_html_aa164ff1268a16d4b32afcff181f6100e"><div class="ttname"><a href="classfc_1_1time__point.html#aa164ff1268a16d4b32afcff181f6100e">fc::time_point::now</a></div><div class="ttdeci">static time_point now()</div><div class="ttdef"><b>Definition</b> <a href="time_8cpp_source.html#l00014">time.cpp:14</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1block__log_html_a5afbeabca60a1f842b83c107ec54cf99"><div class="ttname"><a href="#a5afbeabca60a1f842b83c107ec54cf99">sysio::chain::block_log::is_supported_version</a></div><div class="ttdeci">static bool is_supported_version(uint32_t version)</div><div class="ttdef"><b>Definition</b> <a href="block__log_8cpp_source.html#l01172">block_log.cpp:1172</a></div></div>
<div class="ttc" id="acode__cache_8cpp_html_aa0efefe21f4700d78692edc823e763be"><div class="ttname"><a href="code__cache_8cpp.html#aa0efefe21f4700d78692edc823e763be">id</a></div><div class="ttdeci">uint64_t id</div><div class="ttdef"><b>Definition</b> <a href="code__cache_8cpp_source.html#l00000">code_cache.cpp:0</a></div></div>
<div class="ttc" id="alogger_8hpp_html_a9e3cdbaecd5a34b42956e888f7326fad"><div class="ttname"><a href="logger_8hpp.html#a9e3cdbaecd5a34b42956e888f7326fad">elog</a></div><div class="ttdeci">#define elog(FORMAT,...)</div><div class="ttdef"><b>Definition</b> <a href="logger_8hpp_source.html#l00130">logger.hpp:130</a></div></div>
<div class="ttc" id="anamespacefc_1_1raw_html_a3a18d8161aa5b4f4f02b6fcfdff5e5d1"><div class="ttname"><a href="namespacefc_1_1raw.html#a3a18d8161aa5b4f4f02b6fcfdff5e5d1">fc::raw::pack</a></div><div class="ttdeci">void pack(Stream &amp;s, const std::deque&lt; T &gt; &amp;value)</div><div class="ttdef"><b>Definition</b> <a href="raw_8hpp_source.html#l00531">raw.hpp:531</a></div></div>
<div class="ttc" id="anamespacefc_html_a067b275100894b82b6cf3aa85e804ea5"><div class="ttname"><a href="namespacefc.html#a067b275100894b82b6cf3aa85e804ea5">fc::rename</a></div><div class="ttdeci">void rename(const path &amp;from, const path &amp;to)</div><div class="ttdef"><b>Definition</b> <a href="filesystem_8cpp_source.html#l00326">filesystem.cpp:326</a></div></div>
<div class="ttc" id="anamespacefc_html_a3fcf0d920aea28014aacae50a51d8485"><div class="ttname"><a href="namespacefc.html#a3fcf0d920aea28014aacae50a51d8485">fc::exists</a></div><div class="ttdeci">bool exists(const path &amp;p)</div><div class="ttdef"><b>Definition</b> <a href="filesystem_8cpp_source.html#l00217">filesystem.cpp:217</a></div></div>
<div class="ttc" id="anamespacefc_html_a6855142912d4cfb89281ba0c7f4938a2"><div class="ttname"><a href="namespacefc.html#a6855142912d4cfb89281ba0c7f4938a2">fc::is_regular_file</a></div><div class="ttdeci">bool is_regular_file(const path &amp;p)</div><div class="ttdef"><b>Definition</b> <a href="filesystem_8cpp_source.html#l00226">filesystem.cpp:226</a></div></div>
<div class="ttc" id="anamespacefc_html_a76b0787468a9f403087b71a894c07ce2"><div class="ttname"><a href="namespacefc.html#a76b0787468a9f403087b71a894c07ce2">fc::create_directories</a></div><div class="ttdeci">void create_directories(const path &amp;p)</div><div class="ttdef"><b>Definition</b> <a href="filesystem_8cpp_source.html#l00218">filesystem.cpp:218</a></div></div>
<div class="ttc" id="anamespacefc_html_aab567c89004d329f560014d9943afcd6"><div class="ttname"><a href="namespacefc.html#aab567c89004d329f560014d9943afcd6">fc::to_hex</a></div><div class="ttdeci">fc::string to_hex(const char *d, uint32_t s)</div><div class="ttdef"><b>Definition</b> <a href="hex_8cpp_source.html#l00017">hex.cpp:17</a></div></div>
<div class="ttc" id="anamespacefc_html_ab123bfeadf918cc293ecad88bca7c499"><div class="ttname"><a href="namespacefc.html#ab123bfeadf918cc293ecad88bca7c499">fc::is_directory</a></div><div class="ttdeci">bool is_directory(const path &amp;p)</div><div class="ttdef"><b>Definition</b> <a href="filesystem_8cpp_source.html#l00225">filesystem.cpp:225</a></div></div>
<div class="ttc" id="anamespacefc_html_ac7ca5987762ad2fba3d278b956067171"><div class="ttname"><a href="namespacefc.html#ac7ca5987762ad2fba3d278b956067171">fc::canonical</a></div><div class="ttdeci">path canonical(const path &amp;p)</div><div class="ttdef"><b>Definition</b> <a href="filesystem_8cpp_source.html#l00357">filesystem.cpp:357</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_a4b8e4b7ed9dcd18ee75d0de62e88aa17"><div class="ttname"><a href="namespacesysio_1_1chain.html#a4b8e4b7ed9dcd18ee75d0de62e88aa17">sysio::chain::block_id_type</a></div><div class="ttdeci">fc::sha256 block_id_type</div><div class="ttdef"><b>Definition</b> <a href="chain_2include_2sysio_2chain_2types_8hpp_source.html#l00231">types.hpp:231</a></div></div>
<div class="ttc" id="anamespaceutf8_html_aedaf9315740d4f25b43c188b02b5bcd0"><div class="ttname"><a href="namespaceutf8.html#aedaf9315740d4f25b43c188b02b5bcd0">utf8::previous</a></div><div class="ttdeci">uint32_t previous(octet_iterator &amp;it, octet_iterator pass_start)</div><div class="ttdoc">Deprecated in versions that include &quot;prior&quot;.</div><div class="ttdef"><b>Definition</b> <a href="checked_8h_source.html#l00179">checked.h:179</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classsysio_1_1chain_1_1block__log_a28d7828f2ef978077453c8b0f97f5c04_cgraph.png" border="0" usemap="#aclasssysio_1_1chain_1_1block__log_a28d7828f2ef978077453c8b0f97f5c04_cgraph" alt=""/></div>
<map name="aclasssysio_1_1chain_1_1block__log_a28d7828f2ef978077453c8b0f97f5c04_cgraph" id="aclasssysio_1_1chain_1_1block__log_a28d7828f2ef978077453c8b0f97f5c04_cgraph">
<area shape="rect" title=" " alt="" coords="5,339,136,380"/>
<area shape="rect" href="structsysio_1_1chain_1_1block__header.html#a84daf28c790313cfaffff12e2a962cdb" title=" " alt="" coords="377,51,515,92"/>
<area shape="poly" title=" " alt="" coords="71,339,79,288,98,221,112,185,131,152,154,121,182,95,224,73,270,60,317,56,361,57,361,62,317,61,271,66,226,78,185,99,158,124,135,154,117,188,103,222,84,289,76,340"/>
<area shape="rect" href="structsysio_1_1chain_1_1block__header.html#a39d57e33ef8d3f6ba59b4c458f0ae375" title=" " alt="" coords="575,51,726,92"/>
<area shape="poly" title=" " alt="" coords="70,339,76,281,92,204,106,163,126,123,151,87,182,56,229,29,280,12,334,4,390,4,444,9,495,19,583,43,581,48,494,24,443,14,389,9,335,9,282,17,231,33,185,61,155,90,130,126,111,165,97,205,81,282,75,339"/>
<area shape="rect" href="structsysio_1_1chain_1_1block__header.html#ab1f18a64cbf39c54da83f75c9632f9cd" title=" " alt="" coords="184,109,328,149"/>
<area shape="poly" title=" " alt="" coords="76,338,90,301,113,253,143,204,182,159,185,156,189,160,186,163,148,207,118,256,95,303,81,340"/>
<area shape="rect" href="namespacefc.html#ac7ca5987762ad2fba3d278b956067171" title=" " alt="" coords="208,420,304,446"/>
<area shape="poly" title=" " alt="" coords="118,378,185,407,199,412,198,417,183,412,116,383"/>
<area shape="rect" href="namespacefc.html#a76b0787468a9f403087b71a894c07ce2" title=" " alt="" coords="184,174,328,199"/>
<area shape="poly" title=" " alt="" coords="80,338,119,274,148,239,182,208,188,205,191,209,185,213,152,243,123,278,84,341"/>
<area shape="rect" href="namespacefc.html#a3fcf0d920aea28014aacae50a51d8485" title=" " alt="" coords="218,272,294,298"/>
<area shape="poly" title=" " alt="" coords="114,336,183,307,203,299,204,304,185,312,117,341"/>
<area shape="rect" href="namespacefc.html#ab123bfeadf918cc293ecad88bca7c499" title=" " alt="" coords="202,322,310,347"/>
<area shape="poly" title=" " alt="" coords="136,348,186,341,187,347,137,354"/>
<area shape="rect" href="namespacefc.html#a6855142912d4cfb89281ba0c7f4938a2" title=" " alt="" coords="196,371,316,397"/>
<area shape="poly" title=" " alt="" coords="137,366,181,371,180,377,136,371"/>
<area shape="rect" href="classfc_1_1time__point.html#aa164ff1268a16d4b32afcff181f6100e" title=" " alt="" coords="190,543,322,569"/>
<area shape="poly" title=" " alt="" coords="82,379,97,412,120,453,149,494,185,530,190,533,187,537,182,534,145,498,115,456,93,415,77,382"/>
<area shape="rect" href="namespacefc_1_1raw.html#a3a18d8161aa5b4f4f02b6fcfdff5e5d1" title=" " alt="" coords="207,494,304,519"/>
<area shape="poly" title=" " alt="" coords="96,379,185,456,222,483,219,487,182,461,92,383"/>
<area shape="rect" href="namespacefc.html#a067b275100894b82b6cf3aa85e804ea5" title=" " alt="" coords="214,223,298,249"/>
<area shape="poly" title=" " alt="" coords="88,337,129,297,182,258,199,249,201,254,185,262,132,301,92,341"/>
<area shape="rect" href="namespacefc.html#aab567c89004d329f560014d9943afcd6" title=" " alt="" coords="216,616,296,642"/>
<area shape="poly" title=" " alt="" coords="81,380,118,472,148,528,186,579,217,606,214,610,182,583,144,531,113,474,76,382"/>
<area shape="rect" href="namespacefc_1_1raw.html#a0b442d98ceb22dd5a6ae84745e43ffab" title=" " alt="" coords="200,690,312,715"/>
<area shape="poly" title=" " alt="" coords="78,380,89,432,109,503,141,581,162,618,186,653,216,679,212,683,182,656,157,621,136,583,104,505,84,433,73,381"/>
<area shape="rect" href="classfc_1_1exception.html#ab1104818bf0d9b6a29f0dfe036cf97f6" title=" " alt="" coords="190,739,322,765"/>
<area shape="poly" title=" " alt="" coords="75,380,79,446,94,539,108,589,127,638,153,685,186,726,187,728,184,732,182,730,149,688,123,641,103,591,89,540,73,447,69,381"/>
<area shape="poly" title=" " alt="" coords="516,69,560,69,560,74,516,74"/>
<area shape="rect" href="namespacefc.html#afb668c55fd6ee73e1fcd67e77d8f6009" title=" " alt="" coords="785,74,941,99"/>
<area shape="poly" title=" " alt="" coords="726,74,770,77,769,83,726,80"/>
<area shape="poly" title=" " alt="" coords="325,106,362,94,363,99,326,111"/>
<area shape="poly" title=" " alt="" coords="328,125,513,117,736,101,769,97,770,103,737,106,514,122,329,130"/>
<area shape="rect" href="structsysio_1_1chain_1_1block__header.html#a71165691e3205b1f4dd847b5c6bc5b22" title=" " alt="" coords="381,166,511,207"/>
<area shape="poly" title=" " alt="" coords="326,147,367,160,365,165,325,153"/>
<area shape="rect" href="classfc_1_1sha256.html#a474784de7d6213b855abd7e952df5e36" title=" " alt="" coords="591,174,710,199"/>
<area shape="poly" title=" " alt="" coords="512,184,576,184,576,189,512,189"/>
<area shape="rect" href="classfc_1_1sha256_1_1encoder.html#a4d8b8181e912194cf98a56164671adf8" title=" " alt="" coords="795,151,931,192"/>
<area shape="poly" title=" " alt="" coords="710,180,779,175,779,180,710,185"/>
<area shape="rect" href="classfc_1_1sha256_1_1encoder.html#a4a246dfb33e3eb78ba167446bee92e30" title=" " alt="" coords="795,217,931,257"/>
<area shape="poly" title=" " alt="" coords="708,197,780,215,779,220,707,202"/>
<area shape="rect" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d" title=" " alt="" coords="989,159,1104,185"/>
<area shape="poly" title=" " alt="" coords="932,169,973,169,973,174,932,174"/>
<area shape="rect" href="namespacefc.html#a2bbff129626558fab1e343fcd5ad8bc5" title=" " alt="" coords="396,231,497,257"/>
<area shape="poly" title=" " alt="" coords="303,420,326,407,361,375,390,338,430,269,435,272,394,341,365,379,330,411,305,424"/>
<area shape="poly" title=" " alt="" coords="302,197,388,224,386,229,300,202"/>
<area shape="rect" href="classfc_1_1mock__time__traits.html#a0bed781012a73b8c15882648397b56be" title=" " alt="" coords="376,502,516,543"/>
<area shape="poly" title=" " alt="" coords="322,542,360,535,361,540,323,547"/>
<area shape="rect" href="classfc_1_1mock__time__traits.html#adddeebdf472c33f927827c111ddbf0b1" title=" " alt="" coords="376,567,516,608"/>
<area shape="poly" title=" " alt="" coords="323,564,361,571,360,576,322,570"/>
<area shape="rect" href="classfc_1_1time__point.html#ab46781dcaab4880902bc136f36e39e5e" title=" " alt="" coords="380,633,513,673"/>
<area shape="poly" title=" " alt="" coords="306,567,329,578,354,597,378,618,386,623,383,627,374,622,351,601,327,582,304,572"/>
<area shape="rect" href="classfc_1_1time__point.html#abfea5efbe9ef58024cda814395ee9945" title=" " alt="" coords="380,437,513,477"/>
<area shape="poly" title=" " alt="" coords="304,540,327,530,351,510,374,488,383,483,386,487,378,493,354,514,329,534,306,545"/>
<area shape="rect" href="classfc_1_1mock__time__traits.html#a0d7245b32fd62b3bc712f658250cc4db" title=" " alt="" coords="564,510,737,535"/>
<area shape="poly" title=" " alt="" coords="517,520,549,520,549,525,517,525"/>
<area shape="poly" title=" " alt="" coords="225,495,219,485,222,475,235,469,256,467,278,470,290,476,287,481,277,475,256,472,236,474,226,479,224,484,229,492"/>
<area shape="poly" title=" " alt="" coords="298,235,380,238,380,244,298,240"/>
<area shape="poly" title=" " alt="" coords="225,617,219,608,222,598,235,592,256,590,278,592,290,599,287,603,277,597,256,595,236,597,226,602,224,607,229,614"/>
<area shape="poly" title=" " alt="" coords="225,691,219,681,222,671,235,665,256,663,278,666,290,672,287,677,277,671,256,668,236,670,226,675,224,680,229,688"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classsysio_1_1chain_1_1block__log_a28d7828f2ef978077453c8b0f97f5c04_icgraph.png" border="0" usemap="#aclasssysio_1_1chain_1_1block__log_a28d7828f2ef978077453c8b0f97f5c04_icgraph" alt=""/></div>
<map name="aclasssysio_1_1chain_1_1block__log_a28d7828f2ef978077453c8b0f97f5c04_icgraph" id="aclasssysio_1_1chain_1_1block__log_a28d7828f2ef978077453c8b0f97f5c04_icgraph">
<area shape="rect" title=" " alt="" coords="366,5,496,46"/>
<area shape="rect" href="classsysio_1_1chain__plugin.html#a408e8154def42cdb8be9832b602e0046" title=" " alt="" coords="186,5,318,46"/>
<area shape="poly" title=" " alt="" coords="351,28,318,28,318,23,351,23"/>
<area shape="rect" href="classsysio_1_1chain__plugin.html#a0192ac61f3f59d4fdf2dcbbd2c7104ca" title=" " alt="" coords="5,5,138,46"/>
<area shape="poly" title=" " alt="" coords="170,28,138,28,138,23,170,23"/>
</map>
</div>

</div>
</div>
<a id="ad3217851a8fecc2e132751c35c1cb097" name="ad3217851a8fecc2e132751c35c1cb097"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3217851a8fecc2e132751c35c1cb097">&#9670;&#160;</a></span>reset() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sysio::chain::block_log::reset </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structsysio_1_1chain_1_1chain__id__type.html">chain_id_type</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>chain_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a></td>          <td class="paramname"><span class="paramname"><em>first_block_num</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="block__log_8cpp_source.html#l00597">597</a> of file <a class="el" href="block__log_8cpp_source.html">block_log.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  597</span>                                                                                  {</div>
<div class="line"><span class="lineno">  598</span>      <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( <a class="code hl_function" href="#ac5f1c1e78e72414fbf9bae75da42303e">first_block_num</a> &gt; 1, block_log_exception,</div>
<div class="line"><span class="lineno">  599</span>                  <span class="stringliteral">&quot;Block log version ${ver} needs to be created with a genesis state if starting from block number 1.&quot;</span> );</div>
<div class="line"><span class="lineno">  600</span>      my-&gt;reset(chain_id, <a class="code hl_typedef" href="namespacesysio_1_1chain.html#aa10ee348c57604b615bc8570f6685102">signed_block_ptr</a>(), <a class="code hl_function" href="#ac5f1c1e78e72414fbf9bae75da42303e">first_block_num</a>);</div>
<div class="line"><span class="lineno">  601</span>   }</div>
</div><!-- fragment -->
</div>
</div>
<a id="af7c368f1aa0e3e827d619228c4e144bd" name="af7c368f1aa0e3e827d619228c4e144bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af7c368f1aa0e3e827d619228c4e144bd">&#9670;&#160;</a></span>reset() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sysio::chain::block_log::reset </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structsysio_1_1chain_1_1genesis__state.html">genesis_state</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>gs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacesysio_1_1chain.html#aa10ee348c57604b615bc8570f6685102">signed_block_ptr</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>genesis_block</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="block__log_8cpp_source.html#l00593">593</a> of file <a class="el" href="block__log_8cpp_source.html">block_log.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  593</span>                                                                                       {</div>
<div class="line"><span class="lineno">  594</span>      my-&gt;reset(gs, first_block, 1);</div>
<div class="line"><span class="lineno">  595</span>   }</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classsysio_1_1chain_1_1block__log_af7c368f1aa0e3e827d619228c4e144bd_icgraph.png" border="0" usemap="#aclasssysio_1_1chain_1_1block__log_af7c368f1aa0e3e827d619228c4e144bd_icgraph" alt=""/></div>
<map name="aclasssysio_1_1chain_1_1block__log_af7c368f1aa0e3e827d619228c4e144bd_icgraph" id="aclasssysio_1_1chain_1_1block__log_af7c368f1aa0e3e827d619228c4e144bd_icgraph">
<area shape="rect" title=" " alt="" coords="206,71,336,111"/>
<area shape="rect" href="structsysio_1_1chain_1_1controller__impl.html#a90da90c73cb32b5e5ec498da5e02753f" title=" " alt="" coords="5,5,158,46"/>
<area shape="poly" title=" " alt="" coords="195,68,142,49,143,44,196,63"/>
<area shape="rect" href="structsysio_1_1chain_1_1controller__impl.html#a7863870ecde398ac7def54e4814db6bc" title=" " alt="" coords="5,71,158,111"/>
<area shape="poly" title=" " alt="" coords="190,94,158,94,158,88,190,88"/>
<area shape="rect" href="structsysio_1_1chain_1_1controller__impl.html#a18bcf25847599b0f9caa6566364bb0ac" title=" " alt="" coords="5,136,158,177"/>
<area shape="poly" title=" " alt="" coords="196,119,143,138,142,133,195,114"/>
</map>
</div>

</div>
</div>
<a id="a00f24c3412cd6231b93394e2bbcea904" name="a00f24c3412cd6231b93394e2bbcea904"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a00f24c3412cd6231b93394e2bbcea904">&#9670;&#160;</a></span>trim_blocklog_front()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool sysio::chain::block_log::trim_blocklog_front </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classfc_1_1path.html">fc::path</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>block_dir</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classfc_1_1path.html">fc::path</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>temp_dir</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a></td>          <td class="paramname"><span class="paramname"><em>truncate_at_block</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="block__log_8cpp_source.html#l01190">1190</a> of file <a class="el" href="block__log_8cpp_source.html">block_log.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1190</span>                                                                                                                  {</div>
<div class="line"><span class="lineno"> 1191</span>      <span class="keyword">using namespace </span><a class="code hl_namespace" href="namespacestd.html">std</a>;</div>
<div class="line"><span class="lineno"> 1192</span>      <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( <a class="code hl_variable" href="programs_2sysio-launcher_2main_8cpp.html#a3426d59b828f63d073d546fed967330e">block_dir</a> != temp_dir, block_log_exception, <span class="stringliteral">&quot;block_dir and temp_dir need to be different directories&quot;</span> );</div>
<div class="line"><span class="lineno"> 1193</span>      <a class="code hl_define" href="logger_8hpp.html#a831cf08dc63704c11fd154132c6e8bdb">ilog</a>(<span class="stringliteral">&quot;In directory ${dir} will trim all blocks before block ${n} from blocks.log and blocks.index.&quot;</span>,</div>
<div class="line"><span class="lineno"> 1194</span>           (<span class="stringliteral">&quot;dir&quot;</span>, <a class="code hl_variable" href="programs_2sysio-launcher_2main_8cpp.html#a3426d59b828f63d073d546fed967330e">block_dir</a>.generic_string())(<span class="stringliteral">&quot;n&quot;</span>, truncate_at_block));</div>
<div class="line"><span class="lineno"> 1195</span>      trim_data original_block_log(<a class="code hl_variable" href="programs_2sysio-launcher_2main_8cpp.html#a3426d59b828f63d073d546fed967330e">block_dir</a>);</div>
<div class="line"><span class="lineno"> 1196</span>      <span class="keywordflow">if</span> (truncate_at_block &lt;= original_block_log.first_block) {</div>
<div class="line"><span class="lineno"> 1197</span>         <a class="code hl_define" href="logger_8hpp.html#a831cf08dc63704c11fd154132c6e8bdb">ilog</a>(<span class="stringliteral">&quot;There are no blocks before block ${n} so do nothing.&quot;</span>, (<span class="stringliteral">&quot;n&quot;</span>, truncate_at_block));</div>
<div class="line"><span class="lineno"> 1198</span>         <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1199</span>      }</div>
<div class="line"><span class="lineno"> 1200</span>      <span class="keywordflow">if</span> (truncate_at_block &gt; original_block_log.last_block) {</div>
<div class="line"><span class="lineno"> 1201</span>         <a class="code hl_define" href="logger_8hpp.html#a831cf08dc63704c11fd154132c6e8bdb">ilog</a>(<span class="stringliteral">&quot;All blocks are before block ${n} so do nothing (trim front would delete entire blocks.log).&quot;</span>, (<span class="stringliteral">&quot;n&quot;</span>, truncate_at_block));</div>
<div class="line"><span class="lineno"> 1202</span>         <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1203</span>      }</div>
<div class="line"><span class="lineno"> 1204</span> </div>
<div class="line"><span class="lineno"> 1205</span>      <span class="comment">// ****** create the new block log file and write out the header for the file</span></div>
<div class="line"><span class="lineno"> 1206</span>      <a class="code hl_function" href="namespacefc.html#a76b0787468a9f403087b71a894c07ce2">fc::create_directories</a>(temp_dir);</div>
<div class="line"><span class="lineno"> 1207</span>      <a class="code hl_class" href="classfc_1_1path.html">fc::path</a> new_block_filename = <a class="code hl_variable" href="namespacevalidate__reflection.html#a4d36594f2363ca67854bebf3a1447a6a">temp_dir</a> / <span class="stringliteral">&quot;blocks.log&quot;</span>;</div>
<div class="line"><span class="lineno"> 1208</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="namespacefc.html#a0db76f35dc060918029b16de918b1e84">fc::remove</a>(new_block_filename)) {</div>
<div class="line"><span class="lineno"> 1209</span>         <a class="code hl_define" href="logger_8hpp.html#a831cf08dc63704c11fd154132c6e8bdb">ilog</a>(<span class="stringliteral">&quot;Removing old blocks.out file&quot;</span>);</div>
<div class="line"><span class="lineno"> 1210</span>      }</div>
<div class="line"><span class="lineno"> 1211</span>      <a class="code hl_class" href="classfc_1_1cfile.html">fc::cfile</a> new_block_file;</div>
<div class="line"><span class="lineno"> 1212</span>      new_block_file.<a class="code hl_function" href="classfc_1_1cfile.html#ac4a0191d7846c07a907d3c7eb35e848d">set_file_path</a>(new_block_filename);</div>
<div class="line"><span class="lineno"> 1213</span>      <span class="comment">// need to open as append since the file doesn&#39;t already exist, then reopen without append to allow writing the</span></div>
<div class="line"><span class="lineno"> 1214</span>      <span class="comment">// file in any order</span></div>
<div class="line"><span class="lineno"> 1215</span>      new_block_file.<a class="code hl_function" href="classfc_1_1cfile.html#a9e01adaeee108420312ed271133a2d7d">open</a>( <a class="code hl_define" href="block__log_8cpp.html#ac45b3ac31205498f15768648d162af9c">LOG_WRITE_C</a> );</div>
<div class="line"><span class="lineno"> 1216</span>      new_block_file.<a class="code hl_function" href="classfc_1_1cfile.html#a25b3bbb8ed2f690b750a197380153985">close</a>();</div>
<div class="line"><span class="lineno"> 1217</span>      new_block_file.<a class="code hl_function" href="classfc_1_1cfile.html#a9e01adaeee108420312ed271133a2d7d">open</a>( <a class="code hl_define" href="block__log_8cpp.html#a644b2e9b450d4e270de82f6fd641d064">LOG_RW_C</a> );</div>
<div class="line"><span class="lineno"> 1218</span> </div>
<div class="line"><span class="lineno"> 1219</span>      <span class="keyword">static_assert</span>( <a class="code hl_variable" href="#add7716a8093b81e1a51ed52897e97770">block_log::max_supported_version</a> == 3,</div>
<div class="line"><span class="lineno"> 1220</span>                     <span class="stringliteral">&quot;Code was written to support version 3 format, need to update this code for latest format.&quot;</span> );</div>
<div class="line"><span class="lineno"> 1221</span>      <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="code hl_enumvalue" href="namespacewebsocketpp_1_1http_1_1parser_1_1state.html#a12f378e0c6dbf373781e7988ee4a0853a08c88a938bc459c7997b48f74248752f">version</a> = <a class="code hl_variable" href="#add7716a8093b81e1a51ed52897e97770">block_log::max_supported_version</a>;</div>
<div class="line"><span class="lineno"> 1222</span>      new_block_file.<a class="code hl_function" href="classfc_1_1cfile.html#a6eb4fe4530480f13c6cf773a7f1e3847">seek</a>(0);</div>
<div class="line"><span class="lineno"> 1223</span>      new_block_file.<a class="code hl_function" href="classfc_1_1cfile.html#af6ad44b8179f355db75a9d01de931235">write</a>((<span class="keywordtype">char</span>*)&amp;version, <span class="keyword">sizeof</span>(version));</div>
<div class="line"><span class="lineno"> 1224</span>      new_block_file.<a class="code hl_function" href="classfc_1_1cfile.html#af6ad44b8179f355db75a9d01de931235">write</a>((<span class="keywordtype">char</span>*)&amp;truncate_at_block, <span class="keyword">sizeof</span>(truncate_at_block));</div>
<div class="line"><span class="lineno"> 1225</span> </div>
<div class="line"><span class="lineno"> 1226</span>      new_block_file &lt;&lt; original_block_log.chain_id;</div>
<div class="line"><span class="lineno"> 1227</span> </div>
<div class="line"><span class="lineno"> 1228</span>      <span class="comment">// append a totem to indicate the division between blocks and header</span></div>
<div class="line"><span class="lineno"> 1229</span>      <span class="keyword">auto</span> totem = <a class="code hl_variable" href="#a02319a8bef22b7a167f17314c00b1ac1">block_log::npos</a>;</div>
<div class="line"><span class="lineno"> 1230</span>      new_block_file.<a class="code hl_function" href="classfc_1_1cfile.html#af6ad44b8179f355db75a9d01de931235">write</a>((<span class="keywordtype">char</span>*)&amp;totem, <span class="keyword">sizeof</span>(totem));</div>
<div class="line"><span class="lineno"> 1231</span> </div>
<div class="line"><span class="lineno"> 1232</span>      <span class="keyword">const</span> <span class="keyword">auto</span> new_block_file_first_block_pos = new_block_file.<a class="code hl_function" href="classfc_1_1cfile.html#abc92fc8d64550b772a69ca1b63f75bfb">tellp</a>();</div>
<div class="line"><span class="lineno"> 1233</span>      <span class="comment">// ****** end of new block log header</span></div>
<div class="line"><span class="lineno"> 1234</span> </div>
<div class="line"><span class="lineno"> 1235</span>      <span class="comment">// copy over remainder of block log to new block log</span></div>
<div class="line"><span class="lineno"> 1236</span>      <span class="keyword">auto</span> buffer =  make_unique&lt;char[]&gt;(<a class="code hl_variable" href="classsysio_1_1chain_1_1detail_1_1reverse__iterator.html#a52163ca3aca71df680e1b934d8bfb187">detail::reverse_iterator::_buf_len</a>);</div>
<div class="line"><span class="lineno"> 1237</span>      <span class="keywordtype">char</span>* <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a855e99b645b13e7905d074d02fe0bff5">buf</a> =  buffer.get();</div>
<div class="line"><span class="lineno"> 1238</span> </div>
<div class="line"><span class="lineno"> 1239</span>      <span class="comment">// offset bytes to shift from old blocklog position to new blocklog position</span></div>
<div class="line"><span class="lineno"> 1240</span>      <span class="keyword">const</span> <a class="code hl_typedef" href="stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a> original_file_block_pos = original_block_log.block_pos(truncate_at_block);</div>
<div class="line"><span class="lineno"> 1241</span>      <span class="keyword">const</span> <a class="code hl_typedef" href="stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a> pos_delta = original_file_block_pos - new_block_file_first_block_pos;</div>
<div class="line"><span class="lineno"> 1242</span>      <span class="keyword">auto</span> status = fseek(original_block_log.blk_in, 0, SEEK_END);</div>
<div class="line"><span class="lineno"> 1243</span>      <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( status == 0, block_log_exception, <span class="stringliteral">&quot;blocks.log seek failed&quot;</span> );</div>
<div class="line"><span class="lineno"> 1244</span> </div>
<div class="line"><span class="lineno"> 1245</span>      <span class="comment">// all blocks to copy to the new blocklog</span></div>
<div class="line"><span class="lineno"> 1246</span>      <span class="keyword">const</span> <a class="code hl_typedef" href="stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a> to_write = ftell(original_block_log.blk_in) - original_file_block_pos;</div>
<div class="line"><span class="lineno"> 1247</span>      <span class="keyword">const</span> <span class="keyword">auto</span> pos_size = <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a>);</div>
<div class="line"><span class="lineno"> 1248</span> </div>
<div class="line"><span class="lineno"> 1249</span>      <span class="comment">// start with the last block&#39;s position stored at the end of the block</span></div>
<div class="line"><span class="lineno"> 1250</span>      <a class="code hl_typedef" href="stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a> original_pos = ftell(original_block_log.blk_in) - pos_size;</div>
<div class="line"><span class="lineno"> 1251</span> </div>
<div class="line"><span class="lineno"> 1252</span>      <span class="keyword">const</span> <span class="keyword">auto</span> num_blocks = original_block_log.last_block - truncate_at_block + 1;</div>
<div class="line"><span class="lineno"> 1253</span> </div>
<div class="line"><span class="lineno"> 1254</span>      <a class="code hl_class" href="classfc_1_1path.html">fc::path</a> new_index_filename = <a class="code hl_variable" href="namespacevalidate__reflection.html#a4d36594f2363ca67854bebf3a1447a6a">temp_dir</a> / <span class="stringliteral">&quot;blocks.index&quot;</span>;</div>
<div class="line"><span class="lineno"> 1255</span>      detail::index_writer index(new_index_filename, num_blocks);</div>
<div class="line"><span class="lineno"> 1256</span> </div>
<div class="line"><span class="lineno"> 1257</span>      <a class="code hl_typedef" href="stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a> read_size = 0;</div>
<div class="line"><span class="lineno"> 1258</span>      <a class="code hl_typedef" href="stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a> write_size = 0;</div>
<div class="line"><span class="lineno"> 1259</span>      <span class="keywordflow">for</span>(<a class="code hl_typedef" href="stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a> to_write_remaining = to_write; to_write_remaining &gt; 0; to_write_remaining -= write_size) {</div>
<div class="line"><span class="lineno"> 1260</span>         read_size = to_write_remaining;</div>
<div class="line"><span class="lineno"> 1261</span>         <span class="keywordflow">if</span> (read_size &gt; <a class="code hl_variable" href="classsysio_1_1chain_1_1detail_1_1reverse__iterator.html#a52163ca3aca71df680e1b934d8bfb187">detail::reverse_iterator::_buf_len</a>) {</div>
<div class="line"><span class="lineno"> 1262</span>            read_size = <a class="code hl_variable" href="classsysio_1_1chain_1_1detail_1_1reverse__iterator.html#a52163ca3aca71df680e1b934d8bfb187">detail::reverse_iterator::_buf_len</a>;</div>
<div class="line"><span class="lineno"> 1263</span>         }</div>
<div class="line"><span class="lineno"> 1264</span> </div>
<div class="line"><span class="lineno"> 1265</span>         <span class="comment">// read in the previous contiguous memory into the read buffer</span></div>
<div class="line"><span class="lineno"> 1266</span>         <span class="keyword">const</span> <span class="keyword">auto</span> start_of_blk_buffer_pos = original_file_block_pos + to_write_remaining - read_size;</div>
<div class="line"><span class="lineno"> 1267</span>         status = fseek(original_block_log.blk_in, start_of_blk_buffer_pos, SEEK_SET);</div>
<div class="line"><span class="lineno"> 1268</span>         <span class="keyword">const</span> <span class="keyword">auto</span> num_read = fread(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a855e99b645b13e7905d074d02fe0bff5">buf</a>, read_size, 1, original_block_log.blk_in);</div>
<div class="line"><span class="lineno"> 1269</span>         <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( num_read == 1, block_log_exception, <span class="stringliteral">&quot;blocks.log read failed&quot;</span> );</div>
<div class="line"><span class="lineno"> 1270</span> </div>
<div class="line"><span class="lineno"> 1271</span>         <span class="comment">// walk this memory section to adjust block position to match the adjusted location</span></div>
<div class="line"><span class="lineno"> 1272</span>         <span class="comment">// of the block start and store in the new index file</span></div>
<div class="line"><span class="lineno"> 1273</span>         write_size = read_size;</div>
<div class="line"><span class="lineno"> 1274</span>         <span class="keywordflow">while</span>(original_pos &gt;= start_of_blk_buffer_pos) {</div>
<div class="line"><span class="lineno"> 1275</span>            <span class="keyword">const</span> <span class="keyword">auto</span> buffer_index = original_pos - start_of_blk_buffer_pos;</div>
<div class="line"><span class="lineno"> 1276</span>            <a class="code hl_typedef" href="stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a> pos_content = read_buffer&lt;uint64_t&gt;(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a855e99b645b13e7905d074d02fe0bff5">buf</a> + buffer_index);</div>
<div class="line"><span class="lineno"> 1277</span> </div>
<div class="line"><span class="lineno"> 1278</span>            <span class="keywordflow">if</span> ( (pos_content - start_of_blk_buffer_pos) &gt; 0 &amp;&amp; (pos_content - start_of_blk_buffer_pos) &lt; pos_size ) {</div>
<div class="line"><span class="lineno"> 1279</span>               <span class="comment">// avoid the whole 8 bytes that contains a blk pos being split by the buffer</span></div>
<div class="line"><span class="lineno"> 1280</span>               write_size = read_size - (pos_content - start_of_blk_buffer_pos);</div>
<div class="line"><span class="lineno"> 1281</span>            }</div>
<div class="line"><span class="lineno"> 1282</span>            <span class="keyword">const</span> <span class="keyword">auto</span> start_of_this_block = pos_content;</div>
<div class="line"><span class="lineno"> 1283</span>            pos_content = start_of_this_block - pos_delta;</div>
<div class="line"><span class="lineno"> 1284</span>            write_buffer&lt;uint64_t&gt;(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a855e99b645b13e7905d074d02fe0bff5">buf</a> + buffer_index, &amp;pos_content);</div>
<div class="line"><span class="lineno"> 1285</span>            index.write(pos_content);</div>
<div class="line"><span class="lineno"> 1286</span>            original_pos = start_of_this_block - pos_size;</div>
<div class="line"><span class="lineno"> 1287</span>         }</div>
<div class="line"><span class="lineno"> 1288</span>         new_block_file.<a class="code hl_function" href="classfc_1_1cfile.html#a6eb4fe4530480f13c6cf773a7f1e3847">seek</a>(new_block_file_first_block_pos + to_write_remaining - write_size);</div>
<div class="line"><span class="lineno"> 1289</span>         <a class="code hl_typedef" href="stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a> offset = read_size - write_size;</div>
<div class="line"><span class="lineno"> 1290</span>         new_block_file.<a class="code hl_function" href="classfc_1_1cfile.html#af6ad44b8179f355db75a9d01de931235">write</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a855e99b645b13e7905d074d02fe0bff5">buf</a>+offset, write_size);</div>
<div class="line"><span class="lineno"> 1291</span>      }</div>
<div class="line"><span class="lineno"> 1292</span> </div>
<div class="line"><span class="lineno"> 1293</span>      fclose(original_block_log.blk_in);</div>
<div class="line"><span class="lineno"> 1294</span>      original_block_log.blk_in = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 1295</span>      new_block_file.<a class="code hl_function" href="classfc_1_1cfile.html#a2e03001fc7d98a010f98c56fb7c62a69">flush</a>();</div>
<div class="line"><span class="lineno"> 1296</span>      new_block_file.<a class="code hl_function" href="classfc_1_1cfile.html#a25b3bbb8ed2f690b750a197380153985">close</a>();</div>
<div class="line"><span class="lineno"> 1297</span> </div>
<div class="line"><span class="lineno"> 1298</span>      <a class="code hl_class" href="classfc_1_1path.html">fc::path</a> old_log = <a class="code hl_variable" href="namespacevalidate__reflection.html#a4d36594f2363ca67854bebf3a1447a6a">temp_dir</a> / <span class="stringliteral">&quot;old.log&quot;</span>;</div>
<div class="line"><span class="lineno"> 1299</span>      <a class="code hl_function" href="namespacefc.html#a067b275100894b82b6cf3aa85e804ea5">rename</a>(original_block_log.block_file_name, old_log);</div>
<div class="line"><span class="lineno"> 1300</span>      <a class="code hl_function" href="namespacefc.html#a067b275100894b82b6cf3aa85e804ea5">rename</a>(new_block_filename, original_block_log.block_file_name);</div>
<div class="line"><span class="lineno"> 1301</span>      <a class="code hl_class" href="classfc_1_1path.html">fc::path</a> old_ind = <a class="code hl_variable" href="namespacevalidate__reflection.html#a4d36594f2363ca67854bebf3a1447a6a">temp_dir</a> / <span class="stringliteral">&quot;old.index&quot;</span>;</div>
<div class="line"><span class="lineno"> 1302</span>      <a class="code hl_function" href="namespacefc.html#a067b275100894b82b6cf3aa85e804ea5">rename</a>(original_block_log.index_file_name, old_ind);</div>
<div class="line"><span class="lineno"> 1303</span>      <a class="code hl_function" href="namespacefc.html#a067b275100894b82b6cf3aa85e804ea5">rename</a>(new_index_filename, original_block_log.index_file_name);</div>
<div class="line"><span class="lineno"> 1304</span> </div>
<div class="line"><span class="lineno"> 1305</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1306</span>   }</div>
<div class="ttc" id="ablock__log_8cpp_html_a644b2e9b450d4e270de82f6fd641d064"><div class="ttname"><a href="block__log_8cpp.html#a644b2e9b450d4e270de82f6fd641d064">LOG_RW_C</a></div><div class="ttdeci">#define LOG_RW_C</div><div class="ttdef"><b>Definition</b> <a href="block__log_8cpp_source.html#l00013">block_log.cpp:13</a></div></div>
<div class="ttc" id="ablock__log_8cpp_html_ac45b3ac31205498f15768648d162af9c"><div class="ttname"><a href="block__log_8cpp.html#ac45b3ac31205498f15768648d162af9c">LOG_WRITE_C</a></div><div class="ttdeci">#define LOG_WRITE_C</div><div class="ttdef"><b>Definition</b> <a href="block__log_8cpp_source.html#l00012">block_log.cpp:12</a></div></div>
<div class="ttc" id="aclassfc_1_1cfile_html_a25b3bbb8ed2f690b750a197380153985"><div class="ttname"><a href="classfc_1_1cfile.html#a25b3bbb8ed2f690b750a197380153985">fc::cfile::close</a></div><div class="ttdeci">void close()</div><div class="ttdef"><b>Definition</b> <a href="cfile_8hpp_source.html#l00202">cfile.hpp:202</a></div></div>
<div class="ttc" id="aclassfc_1_1cfile_html_a2e03001fc7d98a010f98c56fb7c62a69"><div class="ttname"><a href="classfc_1_1cfile.html#a2e03001fc7d98a010f98c56fb7c62a69">fc::cfile::flush</a></div><div class="ttdeci">void flush()</div><div class="ttdef"><b>Definition</b> <a href="cfile_8hpp_source.html#l00135">cfile.hpp:135</a></div></div>
<div class="ttc" id="aclassfc_1_1cfile_html_a6eb4fe4530480f13c6cf773a7f1e3847"><div class="ttname"><a href="classfc_1_1cfile.html#a6eb4fe4530480f13c6cf773a7f1e3847">fc::cfile::seek</a></div><div class="ttdeci">void seek(long loc)</div><div class="ttdef"><b>Definition</b> <a href="cfile_8hpp_source.html#l00087">cfile.hpp:87</a></div></div>
<div class="ttc" id="aclassfc_1_1cfile_html_abc92fc8d64550b772a69ca1b63f75bfb"><div class="ttname"><a href="classfc_1_1cfile.html#abc92fc8d64550b772a69ca1b63f75bfb">fc::cfile::tellp</a></div><div class="ttdeci">size_t tellp() const</div><div class="ttdef"><b>Definition</b> <a href="cfile_8hpp_source.html#l00079">cfile.hpp:79</a></div></div>
<div class="ttc" id="aclassfc_1_1cfile_html_af6ad44b8179f355db75a9d01de931235"><div class="ttname"><a href="classfc_1_1cfile.html#af6ad44b8179f355db75a9d01de931235">fc::cfile::write</a></div><div class="ttdeci">void write(const char *d, size_t n)</div><div class="ttdef"><b>Definition</b> <a href="cfile_8hpp_source.html#l00127">cfile.hpp:127</a></div></div>
<div class="ttc" id="aclassfc_1_1path_html"><div class="ttname"><a href="classfc_1_1path.html">fc::path</a></div><div class="ttdoc">wraps boost::filesystem::path to provide platform independent path manipulation.</div><div class="ttdef"><b>Definition</b> <a href="filesystem_8hpp_source.html#l00028">filesystem.hpp:28</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1detail_1_1reverse__iterator_html_a52163ca3aca71df680e1b934d8bfb187"><div class="ttname"><a href="classsysio_1_1chain_1_1detail_1_1reverse__iterator.html#a52163ca3aca71df680e1b934d8bfb187">sysio::chain::detail::reverse_iterator::_buf_len</a></div><div class="ttdeci">static uint32_t _buf_len</div><div class="ttdef"><b>Definition</b> <a href="block__log_8cpp_source.html#l00154">block_log.cpp:154</a></div></div>
<div class="ttc" id="anamespacefc_html_a0db76f35dc060918029b16de918b1e84"><div class="ttname"><a href="namespacefc.html#a0db76f35dc060918029b16de918b1e84">fc::remove</a></div><div class="ttdeci">bool remove(const path &amp;p)</div><div class="ttdef"><b>Definition</b> <a href="filesystem_8cpp_source.html#l00350">filesystem.cpp:350</a></div></div>
<div class="ttc" id="anamespacestd_html"><div class="ttname"><a href="namespacestd.html">std</a></div><div class="ttdef"><b>Definition</b> <a href="name_8hpp_source.html#l00106">name.hpp:106</a></div></div>
<div class="ttc" id="anamespacevalidate__reflection_html_a4d36594f2363ca67854bebf3a1447a6a"><div class="ttname"><a href="namespacevalidate__reflection.html#a4d36594f2363ca67854bebf3a1447a6a">validate_reflection.temp_dir</a></div><div class="ttdeci">temp_dir</div><div class="ttdef"><b>Definition</b> <a href="validate__reflection_8py_source.html#l00051">validate_reflection.py:51</a></div></div>
<div class="ttc" id="aprograms_2sysio-launcher_2main_8cpp_html_a3426d59b828f63d073d546fed967330e"><div class="ttname"><a href="programs_2sysio-launcher_2main_8cpp.html#a3426d59b828f63d073d546fed967330e">block_dir</a></div><div class="ttdeci">const string block_dir</div><div class="ttdef"><b>Definition</b> <a href="programs_2sysio-launcher_2main_8cpp_source.html#l00048">main.cpp:48</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a855e99b645b13e7905d074d02fe0bff5"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a855e99b645b13e7905d074d02fe0bff5">buf</a></div><div class="ttdeci">uint8_t buf[2048]</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l04770">yubihsm_pkcs11.c:4770</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classsysio_1_1chain_1_1block__log_a00f24c3412cd6231b93394e2bbcea904_cgraph.png" border="0" usemap="#aclasssysio_1_1chain_1_1block__log_a00f24c3412cd6231b93394e2bbcea904_cgraph" alt=""/></div>
<map name="aclasssysio_1_1chain_1_1block__log_a00f24c3412cd6231b93394e2bbcea904_cgraph" id="aclasssysio_1_1chain_1_1block__log_a00f24c3412cd6231b93394e2bbcea904_cgraph">
<area shape="rect" title=" " alt="" coords="5,261,169,302"/>
<area shape="rect" href="structsysio_1_1chain_1_1trim__data.html#a031c642ba68c0e0cb6e834d5b59244c9" title=" " alt="" coords="229,5,350,46"/>
<area shape="poly" title=" " alt="" coords="93,260,109,218,135,164,170,107,215,56,218,53,221,57,219,60,174,110,139,167,114,220,98,262"/>
<area shape="rect" href="classfc_1_1cfile.html#a25b3bbb8ed2f690b750a197380153985" title=" " alt="" coords="238,70,342,96"/>
<area shape="poly" title=" " alt="" coords="96,260,140,185,174,142,215,105,223,100,226,104,218,109,178,146,145,188,100,263"/>
<area shape="rect" href="namespacefc.html#a76b0787468a9f403087b71a894c07ce2" title=" " alt="" coords="218,120,362,145"/>
<area shape="poly" title=" " alt="" coords="102,259,149,207,181,179,215,154,223,150,226,154,218,159,184,183,153,211,106,263"/>
<area shape="rect" href="classfc_1_1cfile.html#a2e03001fc7d98a010f98c56fb7c62a69" title=" " alt="" coords="439,246,539,272"/>
<area shape="poly" title=" " alt="" coords="169,274,423,260,424,265,169,280"/>
<area shape="rect" href="classfc_1_1cfile.html#a9e01adaeee108420312ed271133a2d7d" title=" " alt="" coords="240,320,340,345"/>
<area shape="poly" title=" " alt="" coords="170,300,225,314,224,319,169,305"/>
<area shape="rect" href="namespacefc.html#a0db76f35dc060918029b16de918b1e84" title=" " alt="" coords="248,169,332,194"/>
<area shape="poly" title=" " alt="" coords="118,258,163,231,216,203,232,196,234,201,218,208,166,235,121,263"/>
<area shape="rect" href="namespacefc.html#a067b275100894b82b6cf3aa85e804ea5" title=" " alt="" coords="248,218,332,244"/>
<area shape="poly" title=" " alt="" coords="169,259,232,242,234,248,170,264"/>
<area shape="rect" href="classfc_1_1cfile.html#a6eb4fe4530480f13c6cf773a7f1e3847" title=" " alt="" coords="439,421,539,446"/>
<area shape="poly" title=" " alt="" coords="120,300,165,328,218,355,326,393,424,418,423,423,324,398,216,360,162,333,117,305"/>
<area shape="rect" href="classfc_1_1cfile.html#ac4a0191d7846c07a907d3c7eb35e848d" title=" " alt="" coords="217,421,363,446"/>
<area shape="poly" title=" " alt="" coords="108,301,156,349,218,399,240,412,237,416,215,404,152,353,105,304"/>
<area shape="rect" href="classfc_1_1cfile.html#abc92fc8d64550b772a69ca1b63f75bfb" title=" " alt="" coords="242,470,338,496"/>
<area shape="poly" title=" " alt="" coords="100,301,118,335,144,377,178,420,218,457,229,463,226,468,215,461,174,423,140,380,114,338,96,304"/>
<area shape="rect" href="classfc_1_1cfile.html#af6ad44b8179f355db75a9d01de931235" title=" " alt="" coords="439,520,539,545"/>
<area shape="poly" title=" " alt="" coords="96,302,109,346,133,403,169,460,192,485,218,506,268,529,322,540,375,543,423,540,424,545,375,548,321,545,266,534,215,511,188,489,165,464,128,406,104,348,91,303"/>
<area shape="rect" href="namespacefc.html#afb668c55fd6ee73e1fcd67e77d8f6009" title=" " alt="" coords="411,13,567,38"/>
<area shape="poly" title=" " alt="" coords="351,23,396,23,396,28,351,28"/>
<area shape="rect" href="namespacefc.html#a2bbff129626558fab1e343fcd5ad8bc5" title=" " alt="" coords="438,169,540,194"/>
<area shape="poly" title=" " alt="" coords="346,143,424,163,422,168,344,148"/>
<area shape="rect" href="classfc_1_1path.html#ab1eae2062df4ea01435348ec52fb3784" title=" " alt="" coords="615,372,770,397"/>
<area shape="poly" title=" " alt="" coords="529,270,569,289,622,324,666,359,663,363,619,328,566,293,527,275"/>
<area shape="poly" title=" " alt="" coords="341,325,446,321,507,324,568,332,613,345,653,362,651,367,611,350,567,338,507,329,446,326,341,330"/>
<area shape="rect" href="classfc_1_1cfile.html#a3b11f29f74860527a8bba66e4ae0317d" title=" " alt="" coords="438,372,541,397"/>
<area shape="poly" title=" " alt="" coords="341,343,423,364,421,370,340,348"/>
<area shape="poly" title=" " alt="" coords="541,382,600,382,600,387,541,387"/>
<area shape="poly" title=" " alt="" coords="456,373,449,363,453,353,467,347,489,345,514,348,526,354,524,359,512,353,489,350,468,352,457,357,455,362,460,370"/>
<area shape="poly" title=" " alt="" coords="332,179,423,179,423,184,332,184"/>
<area shape="poly" title=" " alt="" coords="331,218,423,195,424,200,333,223"/>
<area shape="poly" title=" " alt="" coords="539,419,621,399,623,404,540,424"/>
<area shape="rect" href="classfc_1_1cfile.html#aba9b5dcf06d12cc653b8eb4224351ff7" title=" " alt="" coords="416,470,562,496"/>
<area shape="poly" title=" " alt="" coords="338,480,400,480,400,486,338,486"/>
<area shape="poly" title=" " alt="" coords="539,518,566,506,597,484,626,458,670,408,674,411,630,461,601,488,569,511,541,523"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classsysio_1_1chain_1_1block__log_a00f24c3412cd6231b93394e2bbcea904_icgraph.png" border="0" usemap="#aclasssysio_1_1chain_1_1block__log_a00f24c3412cd6231b93394e2bbcea904_icgraph" alt=""/></div>
<map name="aclasssysio_1_1chain_1_1block__log_a00f24c3412cd6231b93394e2bbcea904_icgraph" id="aclasssysio_1_1chain_1_1block__log_a00f24c3412cd6231b93394e2bbcea904_icgraph">
<area shape="rect" title=" " alt="" coords="282,5,445,46"/>
<area shape="rect" href="programs_2sysio-blocklog_2main_8cpp.html#ace4e6c78c84c1c16b0486d5833afd9f2" title=" " alt="" coords="103,13,234,38"/>
<area shape="poly" title=" " alt="" coords="267,28,234,28,234,23,267,23"/>
<area shape="rect" href="programs_2sysio-blocklog_2main_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627" title=" " alt="" coords="5,13,55,38"/>
<area shape="poly" title=" " alt="" coords="87,28,55,28,55,23,87,23"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="add7716a8093b81e1a51ed52897e97770" name="add7716a8093b81e1a51ed52897e97770"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add7716a8093b81e1a51ed52897e97770">&#9670;&#160;</a></span>max_supported_version</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> sysio::chain::block_log::max_supported_version = 3</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>History: Version 1: complete block log from genesis Version 2: adds optional partial block log, cannot be used for replay without snapshot this is in the form of an first_block_num that is written immediately after the version Version 3: improvement on version 2 to not require the genesis state be provided when not starting from block 1 </p>

<p class="definition">Definition at line <a class="el" href="block__log_8hpp_source.html#l00076">76</a> of file <a class="el" href="block__log_8hpp_source.html">block_log.hpp</a>.</p>

</div>
</div>
<a id="a8f0f031e0f64def456185998d462d35d" name="a8f0f031e0f64def456185998d462d35d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f0f031e0f64def456185998d462d35d">&#9670;&#160;</a></span>min_supported_version</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> sysio::chain::block_log::min_supported_version = 1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="block__log_8hpp_source.html#l00075">75</a> of file <a class="el" href="block__log_8hpp_source.html">block_log.hpp</a>.</p>

</div>
</div>
<a id="a02319a8bef22b7a167f17314c00b1ac1" name="a02319a8bef22b7a167f17314c00b1ac1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02319a8bef22b7a167f17314c00b1ac1">&#9670;&#160;</a></span>npos</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a> sysio::chain::block_log::npos = std::numeric_limits&lt;<a class="el" href="stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a>&gt;::max()</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="block__log_8hpp_source.html#l00073">73</a> of file <a class="el" href="block__log_8hpp_source.html">block_log.hpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>libraries/chain/include/sysio/chain/<a class="el" href="block__log_8hpp_source.html">block_log.hpp</a></li>
<li>libraries/chain/<a class="el" href="block__log_8cpp_source.html">block_log.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacesysio.html">sysio</a></li><li class="navelem"><a class="el" href="namespacesysio_1_1chain.html">chain</a></li><li class="navelem"><a class="el" href="classsysio_1_1chain_1_1block__log.html">block_log</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0 </li>
  </ul>
</div>
</body>
</html>
