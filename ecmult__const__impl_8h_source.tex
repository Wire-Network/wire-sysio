\doxysection{ecmult\+\_\+const\+\_\+impl.\+h}
\hypertarget{ecmult__const__impl_8h_source}{}\label{ecmult__const__impl_8h_source}\index{libraries/fc/secp256k1/secp256k1/src/ecmult\_const\_impl.h@{libraries/fc/secp256k1/secp256k1/src/ecmult\_const\_impl.h}}
\mbox{\hyperlink{ecmult__const__impl_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00001}00001\ \textcolor{comment}{/***********************************************************************}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00002}00002\ \textcolor{comment}{\ *\ Copyright\ (c)\ 2015\ Pieter\ Wuille,\ Andrew\ Poelstra\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00003}00003\ \textcolor{comment}{\ *\ Distributed\ under\ the\ MIT\ software\ license,\ see\ the\ accompanying\ \ \ \ *}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00004}00004\ \textcolor{comment}{\ *\ file\ COPYING\ or\ https://www.opensource.org/licenses/mit-\/license.php.*}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00005}00005\ \textcolor{comment}{\ ***********************************************************************/}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00006}00006\ }
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00007}00007\ \textcolor{preprocessor}{\#ifndef\ SECP256K1\_ECMULT\_CONST\_IMPL\_H}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00008}00008\ \textcolor{preprocessor}{\#define\ SECP256K1\_ECMULT\_CONST\_IMPL\_H}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00009}00009\ }
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00010}00010\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{scalar_8h}{scalar.h}}"{}}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00011}00011\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{group_8h}{group.h}}"{}}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00012}00012\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{ecmult__const_8h}{ecmult\_const.h}}"{}}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00013}00013\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{ecmult__impl_8h}{ecmult\_impl.h}}"{}}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00014}00014\ }
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00021}00021\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ secp256k1\_ecmult\_odd\_multiples\_table\_globalz\_windowa(\mbox{\hyperlink{structsecp256k1__ge}{secp256k1\_ge}}\ *pre,\ \mbox{\hyperlink{structsecp256k1__fe}{secp256k1\_fe}}\ *globalz,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structsecp256k1__gej}{secp256k1\_gej}}\ *\mbox{\hyperlink{pointer_8h_aeeddce917cf130d62c370b8f216026dd}{a}})\ \{}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00022}00022\ \ \ \ \ \mbox{\hyperlink{structsecp256k1__fe}{secp256k1\_fe}}\ zr[\mbox{\hyperlink{ecmult_8h_a97c6c6e5aa98f202eec77c4c931e02f1}{ECMULT\_TABLE\_SIZE}}(\mbox{\hyperlink{ecmult__impl_8h_a6216c81c6adbb8796c55fe0c8d3b6718}{WINDOW\_A}})];}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00023}00023\ }
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00024}00024\ \ \ \ \ secp256k1\_ecmult\_odd\_multiples\_table(\mbox{\hyperlink{ecmult_8h_a97c6c6e5aa98f202eec77c4c931e02f1}{ECMULT\_TABLE\_SIZE}}(\mbox{\hyperlink{ecmult__impl_8h_a6216c81c6adbb8796c55fe0c8d3b6718}{WINDOW\_A}}),\ pre,\ zr,\ globalz,\ \mbox{\hyperlink{pointer_8h_aeeddce917cf130d62c370b8f216026dd}{a}});}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00025}00025\ \ \ \ \ secp256k1\_ge\_table\_set\_globalz(\mbox{\hyperlink{ecmult_8h_a97c6c6e5aa98f202eec77c4c931e02f1}{ECMULT\_TABLE\_SIZE}}(\mbox{\hyperlink{ecmult__impl_8h_a6216c81c6adbb8796c55fe0c8d3b6718}{WINDOW\_A}}),\ pre,\ zr);}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00026}00026\ \}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00027}00027\ }
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00028}00028\ \textcolor{comment}{/*\ This\ is\ like\ \`{}ECMULT\_TABLE\_GET\_GE`\ but\ is\ constant\ time\ */}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00029}\mbox{\hyperlink{ecmult__const__impl_8h_a541e7c0e2d2f68e2b1b03729d93b4ca7}{00029}}\ \textcolor{preprocessor}{\#define\ ECMULT\_CONST\_TABLE\_GET\_GE(r,pre,n,w)\ do\ \{\ \(\backslash\)}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00030}00030\ \textcolor{preprocessor}{\ \ \ \ int\ m\ =\ 0;\ \(\backslash\)}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00031}00031\ \textcolor{preprocessor}{\ \ \ \ }\textcolor{comment}{/*\ Extract\ the\ sign-\/bit\ for\ a\ constant\ time\ absolute-\/value.\ */}\textcolor{preprocessor}{\ \(\backslash\)}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00032}00032\ \textcolor{preprocessor}{\ \ \ \ int\ mask\ =\ (n)\ >>\ (sizeof(n)\ *\ CHAR\_BIT\ -\/\ 1);\ \(\backslash\)}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00033}00033\ \textcolor{preprocessor}{\ \ \ \ int\ abs\_n\ =\ ((n)\ +\ mask)\ \string^\ mask;\ \(\backslash\)}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00034}00034\ \textcolor{preprocessor}{\ \ \ \ int\ idx\_n\ =\ abs\_n\ >>\ 1;\ \(\backslash\)}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00035}00035\ \textcolor{preprocessor}{\ \ \ \ secp256k1\_fe\ neg\_y;\ \(\backslash\)}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00036}00036\ \textcolor{preprocessor}{\ \ \ \ VERIFY\_CHECK(((n)\ \&\ 1)\ ==\ 1);\ \(\backslash\)}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00037}00037\ \textcolor{preprocessor}{\ \ \ \ VERIFY\_CHECK((n)\ >=\ -\/((1\ <<\ ((w)-\/1))\ -\/\ 1));\ \(\backslash\)}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00038}00038\ \textcolor{preprocessor}{\ \ \ \ VERIFY\_CHECK((n)\ <=\ \ ((1\ <<\ ((w)-\/1))\ -\/\ 1));\ \(\backslash\)}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00039}00039\ \textcolor{preprocessor}{\ \ \ \ VERIFY\_SETUP(secp256k1\_fe\_clear(\&(r)-\/>x));\ \(\backslash\)}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00040}00040\ \textcolor{preprocessor}{\ \ \ \ VERIFY\_SETUP(secp256k1\_fe\_clear(\&(r)-\/>y));\ \(\backslash\)}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00041}00041\ \textcolor{preprocessor}{\ \ \ \ }\textcolor{comment}{/*\ Unconditionally\ set\ r-\/>x\ =\ (pre)[m].x.\ r-\/>y\ =\ (pre)[m].y.\ because\ it's\ either\ the\ correct\ one\ \(\backslash\)}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00042}00042\ \textcolor{comment}{\ \ \ \ \ *\ or\ will\ get\ replaced\ in\ the\ later\ iterations,\ this\ is\ needed\ to\ make\ sure\ \`{}r`\ is\ initialized.\ */}\textcolor{preprocessor}{\ \(\backslash\)}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00043}00043\ \textcolor{preprocessor}{\ \ \ \ (r)-\/>x\ =\ (pre)[m].x;\ \(\backslash\)}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00044}00044\ \textcolor{preprocessor}{\ \ \ \ (r)-\/>y\ =\ (pre)[m].y;\ \(\backslash\)}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00045}00045\ \textcolor{preprocessor}{\ \ \ \ for\ (m\ =\ 1;\ m\ <\ ECMULT\_TABLE\_SIZE(w);\ m++)\ \{\ \(\backslash\)}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00046}00046\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ }\textcolor{comment}{/*\ This\ loop\ is\ used\ to\ avoid\ secret\ data\ in\ array\ indices.\ See}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00047}00047\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ the\ comment\ in\ ecmult\_gen\_impl.h\ for\ rationale.\ */}\textcolor{preprocessor}{\ \(\backslash\)}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00048}00048\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ secp256k1\_fe\_cmov(\&(r)-\/>x,\ \&(pre)[m].x,\ m\ ==\ idx\_n);\ \(\backslash\)}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00049}00049\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ secp256k1\_fe\_cmov(\&(r)-\/>y,\ \&(pre)[m].y,\ m\ ==\ idx\_n);\ \(\backslash\)}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00050}00050\ \textcolor{preprocessor}{\ \ \ \ \}\ \(\backslash\)}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00051}00051\ \textcolor{preprocessor}{\ \ \ \ (r)-\/>infinity\ =\ 0;\ \(\backslash\)}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00052}00052\ \textcolor{preprocessor}{\ \ \ \ secp256k1\_fe\_negate(\&neg\_y,\ \&(r)-\/>y,\ 1);\ \(\backslash\)}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00053}00053\ \textcolor{preprocessor}{\ \ \ \ secp256k1\_fe\_cmov(\&(r)-\/>y,\ \&neg\_y,\ (n)\ !=\ abs\_n);\ \(\backslash\)}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00054}00054\ \textcolor{preprocessor}{\}\ while(0)}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00055}00055\ }
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00069}00069\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{int}\ secp256k1\_wnaf\_const(\textcolor{keywordtype}{int}\ *wnaf,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structsecp256k1__scalar}{secp256k1\_scalar}}\ *scalar,\ \textcolor{keywordtype}{int}\ w,\ \textcolor{keywordtype}{int}\ size)\ \{}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00070}00070\ \ \ \ \ \textcolor{keywordtype}{int}\ global\_sign;}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00071}00071\ \ \ \ \ \textcolor{keywordtype}{int}\ skew;}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00072}00072\ \ \ \ \ \textcolor{keywordtype}{int}\ word\ =\ 0;}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00073}00073\ }
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00074}00074\ \ \ \ \ \textcolor{comment}{/*\ 1\ 2\ 3\ */}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00075}00075\ \ \ \ \ \textcolor{keywordtype}{int}\ u\_last;}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00076}00076\ \ \ \ \ \textcolor{keywordtype}{int}\ u;}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00077}00077\ }
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00078}00078\ \ \ \ \ \textcolor{keywordtype}{int}\ flip;}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00079}00079\ \ \ \ \ \mbox{\hyperlink{structsecp256k1__scalar}{secp256k1\_scalar}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}}\ =\ *scalar;}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00080}00080\ }
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00081}00081\ \ \ \ \ \mbox{\hyperlink{fc_2secp256k1_2secp256k1_2src_2util_8h_aca8ac5ae73fd966db106de59160a178b}{VERIFY\_CHECK}}(w\ >\ 0);}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00082}00082\ \ \ \ \ \mbox{\hyperlink{fc_2secp256k1_2secp256k1_2src_2util_8h_aca8ac5ae73fd966db106de59160a178b}{VERIFY\_CHECK}}(size\ >\ 0);}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00083}00083\ }
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00084}00084\ \ \ \ \ \textcolor{comment}{/*\ Note\ that\ we\ cannot\ handle\ even\ numbers\ by\ negating\ them\ to\ be\ odd,\ as\ is}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00085}00085\ \textcolor{comment}{\ \ \ \ \ *\ done\ in\ other\ implementations,\ since\ if\ our\ scalars\ were\ specified\ to\ have}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00086}00086\ \textcolor{comment}{\ \ \ \ \ *\ width\ <\ 256\ for\ performance\ reasons,\ their\ negations\ would\ have\ width\ 256}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00087}00087\ \textcolor{comment}{\ \ \ \ \ *\ and\ we'd\ lose\ any\ performance\ benefit.\ Instead,\ we\ use\ a\ variation\ of\ a}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00088}00088\ \textcolor{comment}{\ \ \ \ \ *\ technique\ from\ Section\ 4.2\ of\ the\ Okeya/Tagaki\ paper,\ which\ is\ to\ add\ 1\ to\ the}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00089}00089\ \textcolor{comment}{\ \ \ \ \ *\ number\ we\ are\ encoding\ when\ it\ is\ even,\ returning\ a\ skew\ value\ indicating}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00090}00090\ \textcolor{comment}{\ \ \ \ \ *\ this,\ and\ having\ the\ caller\ compensate\ after\ doing\ the\ multiplication.}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00091}00091\ \textcolor{comment}{\ \ \ \ \ *}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00092}00092\ \textcolor{comment}{\ \ \ \ \ *\ In\ fact,\ we\ \_do\_\ want\ to\ negate\ numbers\ to\ minimize\ their\ bit-\/lengths\ (and\ in}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00093}00093\ \textcolor{comment}{\ \ \ \ \ *\ particular,\ to\ ensure\ that\ the\ outputs\ from\ the\ endomorphism-\/split\ fit\ into}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00094}00094\ \textcolor{comment}{\ \ \ \ \ *\ 128\ bits).\ If\ we\ negate,\ the\ parity\ of\ our\ number\ flips,\ affecting\ whether}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00095}00095\ \textcolor{comment}{\ \ \ \ \ *\ we\ want\ to\ add\ to\ the\ scalar\ to\ ensure\ that\ it's\ odd.\ */}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00096}00096\ \ \ \ \ flip\ =\ secp256k1\_scalar\_is\_high(\&\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}});}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00097}00097\ \ \ \ \ skew\ =\ flip\ \string^\ secp256k1\_scalar\_is\_even(\&\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}});}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00098}00098\ \ \ \ \ secp256k1\_scalar\_cadd\_bit(\&\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}},\ 0,\ skew);}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00099}00099\ \ \ \ \ global\_sign\ =\ secp256k1\_scalar\_cond\_negate(\&\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}},\ flip);}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00100}00100\ }
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00101}00101\ \ \ \ \ \textcolor{comment}{/*\ 4\ */}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00102}00102\ \ \ \ \ u\_last\ =\ secp256k1\_scalar\_shr\_int(\&\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}},\ w);}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00103}00103\ \ \ \ \ \textcolor{keywordflow}{do}\ \{}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00104}00104\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ even;}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00105}00105\ }
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00106}00106\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ 4.1\ 4.4\ */}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00107}00107\ \ \ \ \ \ \ \ \ u\ =\ secp256k1\_scalar\_shr\_int(\&\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}},\ w);}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00108}00108\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ 4.2\ */}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00109}00109\ \ \ \ \ \ \ \ \ even\ =\ ((u\ \&\ 1)\ ==\ 0);}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00110}00110\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ In\ contrast\ to\ the\ original\ algorithm,\ u\_last\ is\ always\ >\ 0\ and}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00111}00111\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ therefore\ we\ do\ not\ need\ to\ check\ its\ sign.\ In\ particular,\ it's\ easy}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00112}00112\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ to\ see\ that\ u\_last\ is\ never\ <\ 0\ because\ u\ is\ never\ <\ 0.\ Moreover,}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00113}00113\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ u\_last\ is\ never\ =\ 0\ because\ u\ is\ never\ even\ after\ a\ loop}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00114}00114\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ iteration.\ The\ same\ holds\ analogously\ for\ the\ initial\ value\ of}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00115}00115\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ u\_last\ (in\ the\ first\ loop\ iteration).\ */}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00116}00116\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{fc_2secp256k1_2secp256k1_2src_2util_8h_aca8ac5ae73fd966db106de59160a178b}{VERIFY\_CHECK}}(u\_last\ >\ 0);}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00117}00117\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{fc_2secp256k1_2secp256k1_2src_2util_8h_aca8ac5ae73fd966db106de59160a178b}{VERIFY\_CHECK}}((u\_last\ \&\ 1)\ ==\ 1);}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00118}00118\ \ \ \ \ \ \ \ \ u\ +=\ even;}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00119}00119\ \ \ \ \ \ \ \ \ u\_last\ -\/=\ even\ *\ (1\ <<\ w);}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00120}00120\ }
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00121}00121\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ 4.3,\ adapted\ for\ global\ sign\ change\ */}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00122}00122\ \ \ \ \ \ \ \ \ wnaf[word++]\ =\ u\_last\ *\ global\_sign;}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00123}00123\ }
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00124}00124\ \ \ \ \ \ \ \ \ u\_last\ =\ u;}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00125}00125\ \ \ \ \ \}\ \textcolor{keywordflow}{while}\ (word\ *\ w\ <\ size);}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00126}00126\ \ \ \ \ wnaf[word]\ =\ u\ *\ global\_sign;}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00127}00127\ }
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00128}00128\ \ \ \ \ \mbox{\hyperlink{fc_2secp256k1_2secp256k1_2src_2util_8h_aca8ac5ae73fd966db106de59160a178b}{VERIFY\_CHECK}}(secp256k1\_scalar\_is\_zero(\&\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}}));}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00129}00129\ \ \ \ \ \mbox{\hyperlink{fc_2secp256k1_2secp256k1_2src_2util_8h_aca8ac5ae73fd966db106de59160a178b}{VERIFY\_CHECK}}(word\ ==\ \mbox{\hyperlink{ecmult__impl_8h_ade3191685190c40779d2de9d0664216d}{WNAF\_SIZE\_BITS}}(size,\ w));}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00130}00130\ \ \ \ \ \textcolor{keywordflow}{return}\ skew;}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00131}00131\ \}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00132}00132\ }
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00133}00133\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ secp256k1\_ecmult\_const(\mbox{\hyperlink{structsecp256k1__gej}{secp256k1\_gej}}\ *\mbox{\hyperlink{bn_8cpp_af0a5201ca8846f05f25435b41d7f39f7}{r}},\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structsecp256k1__ge}{secp256k1\_ge}}\ *\mbox{\hyperlink{pointer_8h_aeeddce917cf130d62c370b8f216026dd}{a}},\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structsecp256k1__scalar}{secp256k1\_scalar}}\ *scalar,\ \textcolor{keywordtype}{int}\ size)\ \{}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00134}00134\ \ \ \ \ \mbox{\hyperlink{structsecp256k1__ge}{secp256k1\_ge}}\ pre\_a[\mbox{\hyperlink{ecmult_8h_a97c6c6e5aa98f202eec77c4c931e02f1}{ECMULT\_TABLE\_SIZE}}(\mbox{\hyperlink{ecmult__impl_8h_a6216c81c6adbb8796c55fe0c8d3b6718}{WINDOW\_A}})];}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00135}00135\ \ \ \ \ \mbox{\hyperlink{structsecp256k1__ge}{secp256k1\_ge}}\ tmpa;}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00136}00136\ \ \ \ \ \mbox{\hyperlink{structsecp256k1__fe}{secp256k1\_fe}}\ Z;}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00137}00137\ }
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00138}00138\ \ \ \ \ \textcolor{keywordtype}{int}\ skew\_1;}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00139}00139\ \ \ \ \ \mbox{\hyperlink{structsecp256k1__ge}{secp256k1\_ge}}\ pre\_a\_lam[\mbox{\hyperlink{ecmult_8h_a97c6c6e5aa98f202eec77c4c931e02f1}{ECMULT\_TABLE\_SIZE}}(\mbox{\hyperlink{ecmult__impl_8h_a6216c81c6adbb8796c55fe0c8d3b6718}{WINDOW\_A}})];}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00140}00140\ \ \ \ \ \textcolor{keywordtype}{int}\ wnaf\_lam[1\ +\ \mbox{\hyperlink{ecmult__impl_8h_a23d9fb349265ae338b9977f7f7aab065}{WNAF\_SIZE}}(\mbox{\hyperlink{ecmult__impl_8h_a6216c81c6adbb8796c55fe0c8d3b6718}{WINDOW\_A}}\ -\/\ 1)];}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00141}00141\ \ \ \ \ \textcolor{keywordtype}{int}\ skew\_lam;}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00142}00142\ \ \ \ \ \mbox{\hyperlink{structsecp256k1__scalar}{secp256k1\_scalar}}\ q\_1,\ q\_lam;}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00143}00143\ \ \ \ \ \textcolor{keywordtype}{int}\ wnaf\_1[1\ +\ \mbox{\hyperlink{ecmult__impl_8h_a23d9fb349265ae338b9977f7f7aab065}{WNAF\_SIZE}}(\mbox{\hyperlink{ecmult__impl_8h_a6216c81c6adbb8796c55fe0c8d3b6718}{WINDOW\_A}}\ -\/\ 1)];}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00144}00144\ }
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00145}00145\ \ \ \ \ \textcolor{keywordtype}{int}\ i;}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00146}00146\ }
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00147}00147\ \ \ \ \ \textcolor{comment}{/*\ build\ wnaf\ representation\ for\ q.\ */}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00148}00148\ \ \ \ \ \textcolor{keywordtype}{int}\ rsize\ =\ size;}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00149}00149\ \ \ \ \ \textcolor{keywordflow}{if}\ (size\ >\ 128)\ \{}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00150}00150\ \ \ \ \ \ \ \ \ rsize\ =\ 128;}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00151}00151\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ split\ q\ into\ q\_1\ and\ q\_lam\ (where\ q\ =\ q\_1\ +\ q\_lam*lambda,\ and\ q\_1\ and\ q\_lam\ are\ \string~128\ bit)\ */}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00152}00152\ \ \ \ \ \ \ \ \ secp256k1\_scalar\_split\_lambda(\&q\_1,\ \&q\_lam,\ scalar);}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00153}00153\ \ \ \ \ \ \ \ \ skew\_1\ \ \ =\ secp256k1\_wnaf\_const(wnaf\_1,\ \ \ \&q\_1,\ \ \ \mbox{\hyperlink{ecmult__impl_8h_a6216c81c6adbb8796c55fe0c8d3b6718}{WINDOW\_A}}\ -\/\ 1,\ 128);}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00154}00154\ \ \ \ \ \ \ \ \ skew\_lam\ =\ secp256k1\_wnaf\_const(wnaf\_lam,\ \&q\_lam,\ \mbox{\hyperlink{ecmult__impl_8h_a6216c81c6adbb8796c55fe0c8d3b6718}{WINDOW\_A}}\ -\/\ 1,\ 128);}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00155}00155\ \ \ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00156}00156\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00157}00157\ \ \ \ \ \ \ \ \ skew\_1\ \ \ =\ secp256k1\_wnaf\_const(wnaf\_1,\ scalar,\ \mbox{\hyperlink{ecmult__impl_8h_a6216c81c6adbb8796c55fe0c8d3b6718}{WINDOW\_A}}\ -\/\ 1,\ size);}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00158}00158\ \ \ \ \ \ \ \ \ skew\_lam\ =\ 0;}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00159}00159\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00160}00160\ }
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00161}00161\ \ \ \ \ \textcolor{comment}{/*\ Calculate\ odd\ multiples\ of\ a.}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00162}00162\ \textcolor{comment}{\ \ \ \ \ *\ All\ multiples\ are\ brought\ to\ the\ same\ Z\ 'denominator',\ which\ is\ stored}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00163}00163\ \textcolor{comment}{\ \ \ \ \ *\ in\ Z.\ Due\ to\ secp256k1'\ isomorphism\ we\ can\ do\ all\ operations\ pretending}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00164}00164\ \textcolor{comment}{\ \ \ \ \ *\ that\ the\ Z\ coordinate\ was\ 1,\ use\ affine\ addition\ formulae,\ and\ correct}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00165}00165\ \textcolor{comment}{\ \ \ \ \ *\ the\ Z\ coordinate\ of\ the\ result\ once\ at\ the\ end.}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00166}00166\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00167}00167\ \ \ \ \ \mbox{\hyperlink{fc_2secp256k1_2secp256k1_2src_2util_8h_aca8ac5ae73fd966db106de59160a178b}{VERIFY\_CHECK}}(!\mbox{\hyperlink{pointer_8h_aeeddce917cf130d62c370b8f216026dd}{a}}-\/>infinity);}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00168}00168\ \ \ \ \ secp256k1\_gej\_set\_ge(\mbox{\hyperlink{bn_8cpp_af0a5201ca8846f05f25435b41d7f39f7}{r}},\ \mbox{\hyperlink{pointer_8h_aeeddce917cf130d62c370b8f216026dd}{a}});}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00169}00169\ \ \ \ \ secp256k1\_ecmult\_odd\_multiples\_table\_globalz\_windowa(pre\_a,\ \&Z,\ \mbox{\hyperlink{bn_8cpp_af0a5201ca8846f05f25435b41d7f39f7}{r}});}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00170}00170\ \ \ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0;\ i\ <\ \mbox{\hyperlink{ecmult_8h_a97c6c6e5aa98f202eec77c4c931e02f1}{ECMULT\_TABLE\_SIZE}}(\mbox{\hyperlink{ecmult__impl_8h_a6216c81c6adbb8796c55fe0c8d3b6718}{WINDOW\_A}});\ i++)\ \{}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00171}00171\ \ \ \ \ \ \ \ \ secp256k1\_fe\_normalize\_weak(\&pre\_a[i].y);}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00172}00172\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00173}00173\ \ \ \ \ \textcolor{keywordflow}{if}\ (size\ >\ 128)\ \{}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00174}00174\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0;\ i\ <\ \mbox{\hyperlink{ecmult_8h_a97c6c6e5aa98f202eec77c4c931e02f1}{ECMULT\_TABLE\_SIZE}}(\mbox{\hyperlink{ecmult__impl_8h_a6216c81c6adbb8796c55fe0c8d3b6718}{WINDOW\_A}});\ i++)\ \{}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00175}00175\ \ \ \ \ \ \ \ \ \ \ \ \ secp256k1\_ge\_mul\_lambda(\&pre\_a\_lam[i],\ \&pre\_a[i]);}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00176}00176\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00177}00177\ }
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00178}00178\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00179}00179\ }
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00180}00180\ \ \ \ \ \textcolor{comment}{/*\ first\ loop\ iteration\ (separated\ out\ so\ we\ can\ directly\ set\ r,\ rather}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00181}00181\ \textcolor{comment}{\ \ \ \ \ *\ than\ having\ it\ start\ at\ infinity,\ get\ doubled\ several\ times,\ then\ have}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00182}00182\ \textcolor{comment}{\ \ \ \ \ *\ its\ new\ value\ added\ to\ it)\ */}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00183}00183\ \ \ \ \ i\ =\ wnaf\_1[\mbox{\hyperlink{ecmult__impl_8h_ade3191685190c40779d2de9d0664216d}{WNAF\_SIZE\_BITS}}(rsize,\ \mbox{\hyperlink{ecmult__impl_8h_a6216c81c6adbb8796c55fe0c8d3b6718}{WINDOW\_A}}\ -\/\ 1)];}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00184}00184\ \ \ \ \ \mbox{\hyperlink{fc_2secp256k1_2secp256k1_2src_2util_8h_aca8ac5ae73fd966db106de59160a178b}{VERIFY\_CHECK}}(i\ !=\ 0);}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00185}00185\ \ \ \ \ \mbox{\hyperlink{ecmult__const__impl_8h_a541e7c0e2d2f68e2b1b03729d93b4ca7}{ECMULT\_CONST\_TABLE\_GET\_GE}}(\&tmpa,\ pre\_a,\ i,\ \mbox{\hyperlink{ecmult__impl_8h_a6216c81c6adbb8796c55fe0c8d3b6718}{WINDOW\_A}});}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00186}00186\ \ \ \ \ secp256k1\_gej\_set\_ge(\mbox{\hyperlink{bn_8cpp_af0a5201ca8846f05f25435b41d7f39f7}{r}},\ \&tmpa);}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00187}00187\ \ \ \ \ \textcolor{keywordflow}{if}\ (size\ >\ 128)\ \{}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00188}00188\ \ \ \ \ \ \ \ \ i\ =\ wnaf\_lam[\mbox{\hyperlink{ecmult__impl_8h_ade3191685190c40779d2de9d0664216d}{WNAF\_SIZE\_BITS}}(rsize,\ \mbox{\hyperlink{ecmult__impl_8h_a6216c81c6adbb8796c55fe0c8d3b6718}{WINDOW\_A}}\ -\/\ 1)];}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00189}00189\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{fc_2secp256k1_2secp256k1_2src_2util_8h_aca8ac5ae73fd966db106de59160a178b}{VERIFY\_CHECK}}(i\ !=\ 0);}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00190}00190\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{ecmult__const__impl_8h_a541e7c0e2d2f68e2b1b03729d93b4ca7}{ECMULT\_CONST\_TABLE\_GET\_GE}}(\&tmpa,\ pre\_a\_lam,\ i,\ \mbox{\hyperlink{ecmult__impl_8h_a6216c81c6adbb8796c55fe0c8d3b6718}{WINDOW\_A}});}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00191}00191\ \ \ \ \ \ \ \ \ secp256k1\_gej\_add\_ge(\mbox{\hyperlink{bn_8cpp_af0a5201ca8846f05f25435b41d7f39f7}{r}},\ \mbox{\hyperlink{bn_8cpp_af0a5201ca8846f05f25435b41d7f39f7}{r}},\ \&tmpa);}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00192}00192\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00193}00193\ \ \ \ \ \textcolor{comment}{/*\ remaining\ loop\ iterations\ */}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00194}00194\ \ \ \ \ \textcolor{keywordflow}{for}\ (i\ =\ \mbox{\hyperlink{ecmult__impl_8h_ade3191685190c40779d2de9d0664216d}{WNAF\_SIZE\_BITS}}(rsize,\ \mbox{\hyperlink{ecmult__impl_8h_a6216c81c6adbb8796c55fe0c8d3b6718}{WINDOW\_A}}\ -\/\ 1)\ -\/\ 1;\ i\ >=\ 0;\ i-\/-\/)\ \{}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00195}00195\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ n;}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00196}00196\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a538d097420e725c4dad63c3caa9e55bd}{j}};}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00197}00197\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a538d097420e725c4dad63c3caa9e55bd}{j}}\ =\ 0;\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a538d097420e725c4dad63c3caa9e55bd}{j}}\ <\ \mbox{\hyperlink{ecmult__impl_8h_a6216c81c6adbb8796c55fe0c8d3b6718}{WINDOW\_A}}\ -\/\ 1;\ ++\mbox{\hyperlink{yubihsm__pkcs11_8c_a538d097420e725c4dad63c3caa9e55bd}{j}})\ \{}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00198}00198\ \ \ \ \ \ \ \ \ \ \ \ \ secp256k1\_gej\_double(\mbox{\hyperlink{bn_8cpp_af0a5201ca8846f05f25435b41d7f39f7}{r}},\ \mbox{\hyperlink{bn_8cpp_af0a5201ca8846f05f25435b41d7f39f7}{r}});}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00199}00199\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00200}00200\ }
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00201}00201\ \ \ \ \ \ \ \ \ n\ =\ wnaf\_1[i];}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00202}00202\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{ecmult__const__impl_8h_a541e7c0e2d2f68e2b1b03729d93b4ca7}{ECMULT\_CONST\_TABLE\_GET\_GE}}(\&tmpa,\ pre\_a,\ n,\ \mbox{\hyperlink{ecmult__impl_8h_a6216c81c6adbb8796c55fe0c8d3b6718}{WINDOW\_A}});}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00203}00203\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{fc_2secp256k1_2secp256k1_2src_2util_8h_aca8ac5ae73fd966db106de59160a178b}{VERIFY\_CHECK}}(n\ !=\ 0);}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00204}00204\ \ \ \ \ \ \ \ \ secp256k1\_gej\_add\_ge(\mbox{\hyperlink{bn_8cpp_af0a5201ca8846f05f25435b41d7f39f7}{r}},\ \mbox{\hyperlink{bn_8cpp_af0a5201ca8846f05f25435b41d7f39f7}{r}},\ \&tmpa);}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00205}00205\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (size\ >\ 128)\ \{}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00206}00206\ \ \ \ \ \ \ \ \ \ \ \ \ n\ =\ wnaf\_lam[i];}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00207}00207\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{ecmult__const__impl_8h_a541e7c0e2d2f68e2b1b03729d93b4ca7}{ECMULT\_CONST\_TABLE\_GET\_GE}}(\&tmpa,\ pre\_a\_lam,\ n,\ \mbox{\hyperlink{ecmult__impl_8h_a6216c81c6adbb8796c55fe0c8d3b6718}{WINDOW\_A}});}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00208}00208\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{fc_2secp256k1_2secp256k1_2src_2util_8h_aca8ac5ae73fd966db106de59160a178b}{VERIFY\_CHECK}}(n\ !=\ 0);}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00209}00209\ \ \ \ \ \ \ \ \ \ \ \ \ secp256k1\_gej\_add\_ge(\mbox{\hyperlink{bn_8cpp_af0a5201ca8846f05f25435b41d7f39f7}{r}},\ \mbox{\hyperlink{bn_8cpp_af0a5201ca8846f05f25435b41d7f39f7}{r}},\ \&tmpa);}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00210}00210\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00211}00211\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00212}00212\ }
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00213}00213\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00214}00214\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Correct\ for\ wNAF\ skew\ */}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00215}00215\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structsecp256k1__gej}{secp256k1\_gej}}\ tmpj;}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00216}00216\ }
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00217}00217\ \ \ \ \ \ \ \ \ secp256k1\_ge\_neg(\&tmpa,\ \&pre\_a[0]);}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00218}00218\ \ \ \ \ \ \ \ \ secp256k1\_gej\_add\_ge(\&tmpj,\ \mbox{\hyperlink{bn_8cpp_af0a5201ca8846f05f25435b41d7f39f7}{r}},\ \&tmpa);}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00219}00219\ \ \ \ \ \ \ \ \ secp256k1\_gej\_cmov(\mbox{\hyperlink{bn_8cpp_af0a5201ca8846f05f25435b41d7f39f7}{r}},\ \&tmpj,\ skew\_1);}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00220}00220\ }
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00221}00221\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (size\ >\ 128)\ \{}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00222}00222\ \ \ \ \ \ \ \ \ \ \ \ \ secp256k1\_ge\_neg(\&tmpa,\ \&pre\_a\_lam[0]);}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00223}00223\ \ \ \ \ \ \ \ \ \ \ \ \ secp256k1\_gej\_add\_ge(\&tmpj,\ \mbox{\hyperlink{bn_8cpp_af0a5201ca8846f05f25435b41d7f39f7}{r}},\ \&tmpa);}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00224}00224\ \ \ \ \ \ \ \ \ \ \ \ \ secp256k1\_gej\_cmov(\mbox{\hyperlink{bn_8cpp_af0a5201ca8846f05f25435b41d7f39f7}{r}},\ \&tmpj,\ skew\_lam);}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00225}00225\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00226}00226\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00227}00227\ }
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00228}00228\ \ \ \ \ secp256k1\_fe\_mul(\&\mbox{\hyperlink{bn_8cpp_af0a5201ca8846f05f25435b41d7f39f7}{r}}-\/>z,\ \&\mbox{\hyperlink{bn_8cpp_af0a5201ca8846f05f25435b41d7f39f7}{r}}-\/>z,\ \&Z);}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00229}00229\ \}}
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00230}00230\ }
\DoxyCodeLine{\Hypertarget{ecmult__const__impl_8h_source_l00231}00231\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{/*\ SECP256K1\_ECMULT\_CONST\_IMPL\_H\ */}\textcolor{preprocessor}{}}

\end{DoxyCode}
