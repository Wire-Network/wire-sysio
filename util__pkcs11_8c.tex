\doxysection{libraries/yubihsm/pkcs11/util\+\_\+pkcs11.c File Reference}
\hypertarget{util__pkcs11_8c}{}\label{util__pkcs11_8c}\index{libraries/yubihsm/pkcs11/util\_pkcs11.c@{libraries/yubihsm/pkcs11/util\_pkcs11.c}}
{\ttfamily \#include $<$ctype.\+h$>$}\newline
{\ttfamily \#include $<$yubihsm.\+h$>$}\newline
{\ttfamily \#include $<$pkcs11y.\+h$>$}\newline
{\ttfamily \#include $<$string.\+h$>$}\newline
{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include $<$pthread.\+h$>$}\newline
{\ttfamily \#include $<$arpa/inet.\+h$>$}\newline
{\ttfamily \#include $<$openssl/ec.\+h$>$}\newline
{\ttfamily \#include $<$openssl/ecdsa.\+h$>$}\newline
{\ttfamily \#include $<$openssl/rsa.\+h$>$}\newline
{\ttfamily \#include $<$openssl/x509.\+h$>$}\newline
{\ttfamily \#include "{}util\+\_\+pkcs11.\+h"{}}\newline
{\ttfamily \#include "{}debug\+\_\+p11.\+h"{}}\newline
{\ttfamily \#include "{}../common/util.\+h"{}}\newline
{\ttfamily \#include "{}../common/openssl-\/compat.\+h"{}}\newline
Include dependency graph for util\+\_\+pkcs11.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{util__pkcs11_8c__incl}
\end{center}
\end{figure}
\doxysubsubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{util__pkcs11_8c_a3fef844d0ea67080b66b3a4d5f0a9ec8}{ASN1\+\_\+\+OID}}~0x06
\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
CK\+\_\+\+RV \mbox{\hyperlink{util__pkcs11_8c_a064731f36eb972f687b4059dc5f340db}{get\+\_\+mechanism\+\_\+list}} (\mbox{\hyperlink{structyubihsm__pkcs11__slot}{yubihsm\+\_\+pkcs11\+\_\+slot}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}}, \mbox{\hyperlink{pkcs11_8h_a29744979fe73c2061a1d39987f063679}{CK\+\_\+\+MECHANISM\+\_\+\+TYPE\+\_\+\+PTR}} \mbox{\hyperlink{yubihsm__pkcs11_8c_a837cbbce04f92271824debc2c15b6ab6}{p\+Mechanism\+List}}, \mbox{\hyperlink{pkcs11_8h_a2c6426aaa1ca6dd1f48a01b8490482fa}{CK\+\_\+\+ULONG\+\_\+\+PTR}} \mbox{\hyperlink{gmock__stress__test_8cc_afd9db40e3361ae09188795e8cbe19752}{count}})
\item 
bool \mbox{\hyperlink{util__pkcs11_8c_a95f1c61424aa67f782a360e59c6cee84}{get\+\_\+mechanism\+\_\+info}} (\mbox{\hyperlink{structyubihsm__pkcs11__slot}{yubihsm\+\_\+pkcs11\+\_\+slot}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}}, CK\+\_\+\+MECHANISM\+\_\+\+TYPE type, \mbox{\hyperlink{pkcs11_8h_a19a155cbd39a0b5099741d385f1db7b9}{CK\+\_\+\+MECHANISM\+\_\+\+INFO\+\_\+\+PTR}} \mbox{\hyperlink{yubihsm__pkcs11_8c_a05dd610acfc36d8ca4581d4d22ae1521}{p\+Info}})
\item 
bool \mbox{\hyperlink{util__pkcs11_8c_a4680d9c4ecced6ef98ac202480bd53fd}{parse\+\_\+hex}} (\mbox{\hyperlink{pkcs11_8h_aee7068a12537d85d824edb4249e7ca4e}{CK\+\_\+\+UTF8\+CHAR\+\_\+\+PTR}} hex, \mbox{\hyperlink{pkcs11_8h_a35181858a3b7a0a81f49d180d8f446ef}{CK\+\_\+\+ULONG}} hex\+\_\+len, \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t}} \texorpdfstring{$\ast$}{*}parsed)
\item 
bool \mbox{\hyperlink{util__pkcs11_8c_a700b4fbb8f17dde6dc3a96957951674f}{create\+\_\+session}} (\mbox{\hyperlink{structyubihsm__pkcs11__slot}{yubihsm\+\_\+pkcs11\+\_\+slot}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}}, CK\+\_\+\+FLAGS \mbox{\hyperlink{yubihsm__pkcs11_8c_ae0ed371842ace71a7886a6134ecbcb62}{flags}}, \mbox{\hyperlink{pkcs11_8h_a28172afc989b647ca7909d036198afa6}{CK\+\_\+\+SESSION\+\_\+\+HANDLE\+\_\+\+PTR}} \mbox{\hyperlink{yubihsm__pkcs11_8c_a4af2a29df94c09021ad1646463da9201}{ph\+Session}})
\item 
CK\+\_\+\+RV \mbox{\hyperlink{util__pkcs11_8c_acc3b093830e7126a8655e9b8ec77ad10}{get\+\_\+attribute}} (CK\+\_\+\+ATTRIBUTE\+\_\+\+TYPE type, \mbox{\hyperlink{structyh__object__descriptor}{yh\+\_\+object\+\_\+descriptor}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{yubihsm__pkcs11_8c_a85d991d90970121ba1480cd98d93aab9}{object}}, \mbox{\hyperlink{pkcs11_8h_a88e8d2cf99e26f3b3f86a0a698b0ab64}{CK\+\_\+\+VOID\+\_\+\+PTR}} \mbox{\hyperlink{pkcs11_8h_a32aff7c6c4cd253fdf6563677afab5ce}{value}}, \mbox{\hyperlink{pkcs11_8h_a2c6426aaa1ca6dd1f48a01b8490482fa}{CK\+\_\+\+ULONG\+\_\+\+PTR}} length, \mbox{\hyperlink{structyh__session}{yh\+\_\+session}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{ecdh__derive__test_8c_a0a2c7706d971796d7dc84fee36d6c84f}{session}})
\item 
CK\+\_\+\+RV \mbox{\hyperlink{util__pkcs11_8c_a5c8c35826a58c280a290c49a5a1e5b03}{get\+\_\+attribute\+\_\+ecsession\+\_\+key}} (CK\+\_\+\+ATTRIBUTE\+\_\+\+TYPE type, \mbox{\hyperlink{structecdh__session__key}{ecdh\+\_\+session\+\_\+key}} \texorpdfstring{$\ast$}{*}key, \mbox{\hyperlink{pkcs11_8h_a88e8d2cf99e26f3b3f86a0a698b0ab64}{CK\+\_\+\+VOID\+\_\+\+PTR}} \mbox{\hyperlink{pkcs11_8h_a32aff7c6c4cd253fdf6563677afab5ce}{value}}, \mbox{\hyperlink{pkcs11_8h_a2c6426aaa1ca6dd1f48a01b8490482fa}{CK\+\_\+\+ULONG\+\_\+\+PTR}} length)
\item 
void \mbox{\hyperlink{util__pkcs11_8c_abbef2f6ae8466dee723f94497bdea3bf}{delete\+\_\+object\+\_\+from\+\_\+cache}} (\mbox{\hyperlink{structyubihsm__pkcs11__object__desc}{yubihsm\+\_\+pkcs11\+\_\+object\+\_\+desc}} \texorpdfstring{$\ast$}{*}objects, CK\+\_\+\+OBJECT\+\_\+\+HANDLE obj\+Handle)
\item 
\mbox{\hyperlink{structyubihsm__pkcs11__object__desc}{yubihsm\+\_\+pkcs11\+\_\+object\+\_\+desc}} \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{util__pkcs11_8c_a85589628d7732ef01a3f80a25d217c8c}{get\+\_\+object\+\_\+desc}} (\mbox{\hyperlink{structyh__session}{yh\+\_\+session}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{ecdh__derive__test_8c_a0a2c7706d971796d7dc84fee36d6c84f}{session}}, \mbox{\hyperlink{structyubihsm__pkcs11__object__desc}{yubihsm\+\_\+pkcs11\+\_\+object\+\_\+desc}} \texorpdfstring{$\ast$}{*}objects, CK\+\_\+\+OBJECT\+\_\+\+HANDLE obj\+Handle)
\item 
bool \mbox{\hyperlink{util__pkcs11_8c_ae8ed437178cb69b0fed6916747368344}{check\+\_\+sign\+\_\+mechanism}} (\mbox{\hyperlink{structyubihsm__pkcs11__slot}{yubihsm\+\_\+pkcs11\+\_\+slot}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}}, \mbox{\hyperlink{pkcs11_8h_ab943ac89d1b0f6f3631d3361da0d52a1}{CK\+\_\+\+MECHANISM\+\_\+\+PTR}} \mbox{\hyperlink{yubihsm__pkcs11_8c_ab0dca4e7a2bfa74ab9cae5b8c1995647}{p\+Mechanism}})
\item 
bool \mbox{\hyperlink{util__pkcs11_8c_a87b96fbdfd225d8124f0a6f6d6538292}{check\+\_\+verify\+\_\+mechanism}} (\mbox{\hyperlink{structyubihsm__pkcs11__slot}{yubihsm\+\_\+pkcs11\+\_\+slot}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}}, \mbox{\hyperlink{pkcs11_8h_ab943ac89d1b0f6f3631d3361da0d52a1}{CK\+\_\+\+MECHANISM\+\_\+\+PTR}} \mbox{\hyperlink{yubihsm__pkcs11_8c_ab0dca4e7a2bfa74ab9cae5b8c1995647}{p\+Mechanism}})
\item 
bool \mbox{\hyperlink{util__pkcs11_8c_a5ce40fa3ee245e65d99ee4cec7a1dd0c}{check\+\_\+decrypt\+\_\+mechanism}} (\mbox{\hyperlink{structyubihsm__pkcs11__slot}{yubihsm\+\_\+pkcs11\+\_\+slot}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}}, \mbox{\hyperlink{pkcs11_8h_ab943ac89d1b0f6f3631d3361da0d52a1}{CK\+\_\+\+MECHANISM\+\_\+\+PTR}} \mbox{\hyperlink{yubihsm__pkcs11_8c_ab0dca4e7a2bfa74ab9cae5b8c1995647}{p\+Mechanism}})
\item 
bool \mbox{\hyperlink{util__pkcs11_8c_a1a99061c5c316d6427b27f8d506338bf}{check\+\_\+encrypt\+\_\+mechanism}} (\mbox{\hyperlink{structyubihsm__pkcs11__slot}{yubihsm\+\_\+pkcs11\+\_\+slot}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}}, \mbox{\hyperlink{pkcs11_8h_ab943ac89d1b0f6f3631d3361da0d52a1}{CK\+\_\+\+MECHANISM\+\_\+\+PTR}} \mbox{\hyperlink{yubihsm__pkcs11_8c_ab0dca4e7a2bfa74ab9cae5b8c1995647}{p\+Mechanism}})
\item 
bool \mbox{\hyperlink{util__pkcs11_8c_a61664b3bfbd62e9ac2da4ed66be23dbc}{check\+\_\+digest\+\_\+mechanism}} (\mbox{\hyperlink{pkcs11_8h_ab943ac89d1b0f6f3631d3361da0d52a1}{CK\+\_\+\+MECHANISM\+\_\+\+PTR}} \mbox{\hyperlink{yubihsm__pkcs11_8c_ab0dca4e7a2bfa74ab9cae5b8c1995647}{p\+Mechanism}})
\item 
bool \mbox{\hyperlink{util__pkcs11_8c_a83e06a2ae90589d9fad186cad9ed5ede}{check\+\_\+wrap\+\_\+mechanism}} (\mbox{\hyperlink{structyubihsm__pkcs11__slot}{yubihsm\+\_\+pkcs11\+\_\+slot}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}}, \mbox{\hyperlink{pkcs11_8h_ab943ac89d1b0f6f3631d3361da0d52a1}{CK\+\_\+\+MECHANISM\+\_\+\+PTR}} \mbox{\hyperlink{yubihsm__pkcs11_8c_ab0dca4e7a2bfa74ab9cae5b8c1995647}{p\+Mechanism}})
\item 
CK\+\_\+\+RV \mbox{\hyperlink{util__pkcs11_8c_ace7396cb0c7b79d711f41031943387aa}{apply\+\_\+sign\+\_\+mechanism\+\_\+init}} (\mbox{\hyperlink{structyubihsm__pkcs11__op__info}{yubihsm\+\_\+pkcs11\+\_\+op\+\_\+info}} \texorpdfstring{$\ast$}{*}op\+\_\+info)
\item 
CK\+\_\+\+RV \mbox{\hyperlink{util__pkcs11_8c_a2e8c2b6402f7944b9684ad16a8ab7f66}{apply\+\_\+verify\+\_\+mechanism\+\_\+init}} (\mbox{\hyperlink{structyubihsm__pkcs11__op__info}{yubihsm\+\_\+pkcs11\+\_\+op\+\_\+info}} \texorpdfstring{$\ast$}{*}op\+\_\+info)
\item 
CK\+\_\+\+RV \mbox{\hyperlink{util__pkcs11_8c_a915e620459f4f98eca94bff5913cfac5}{apply\+\_\+decrypt\+\_\+mechanism\+\_\+init}} (\mbox{\hyperlink{structyubihsm__pkcs11__op__info}{yubihsm\+\_\+pkcs11\+\_\+op\+\_\+info}} \texorpdfstring{$\ast$}{*}op\+\_\+info)
\item 
CK\+\_\+\+RV \mbox{\hyperlink{util__pkcs11_8c_a50a795ac4e657d1813394e49cd4650d0}{apply\+\_\+digest\+\_\+mechanism\+\_\+init}} (\mbox{\hyperlink{structyubihsm__pkcs11__op__info}{yubihsm\+\_\+pkcs11\+\_\+op\+\_\+info}} \texorpdfstring{$\ast$}{*}op\+\_\+info)
\item 
CK\+\_\+\+RV \mbox{\hyperlink{util__pkcs11_8c_a7f8862404103da790412c45be35b0087}{apply\+\_\+sign\+\_\+mechanism\+\_\+update}} (\mbox{\hyperlink{structyubihsm__pkcs11__op__info}{yubihsm\+\_\+pkcs11\+\_\+op\+\_\+info}} \texorpdfstring{$\ast$}{*}op\+\_\+info, \mbox{\hyperlink{pkcs11_8h_a7bc6919a7c3c372056fa7e18343a0b37}{CK\+\_\+\+BYTE\+\_\+\+PTR}} in, \mbox{\hyperlink{pkcs11_8h_a35181858a3b7a0a81f49d180d8f446ef}{CK\+\_\+\+ULONG}} \mbox{\hyperlink{yubihsm__pkcs11_8c_af352138fec1245efdaee143f770c01ef}{in\+\_\+len}})
\item 
CK\+\_\+\+RV \mbox{\hyperlink{util__pkcs11_8c_ad4fbb6f5ecdd69ce7a332f613a89a9a7}{apply\+\_\+verify\+\_\+mechanism\+\_\+update}} (\mbox{\hyperlink{structyubihsm__pkcs11__op__info}{yubihsm\+\_\+pkcs11\+\_\+op\+\_\+info}} \texorpdfstring{$\ast$}{*}op\+\_\+info, \mbox{\hyperlink{pkcs11_8h_a7bc6919a7c3c372056fa7e18343a0b37}{CK\+\_\+\+BYTE\+\_\+\+PTR}} in, \mbox{\hyperlink{pkcs11_8h_a35181858a3b7a0a81f49d180d8f446ef}{CK\+\_\+\+ULONG}} \mbox{\hyperlink{yubihsm__pkcs11_8c_af352138fec1245efdaee143f770c01ef}{in\+\_\+len}})
\item 
CK\+\_\+\+RV \mbox{\hyperlink{util__pkcs11_8c_a7fe9865366124c43dfbc7db9e710384d}{apply\+\_\+decrypt\+\_\+mechanism\+\_\+update}} (\mbox{\hyperlink{structyubihsm__pkcs11__op__info}{yubihsm\+\_\+pkcs11\+\_\+op\+\_\+info}} \texorpdfstring{$\ast$}{*}op\+\_\+info, \mbox{\hyperlink{pkcs11_8h_a7bc6919a7c3c372056fa7e18343a0b37}{CK\+\_\+\+BYTE\+\_\+\+PTR}} in, \mbox{\hyperlink{pkcs11_8h_a35181858a3b7a0a81f49d180d8f446ef}{CK\+\_\+\+ULONG}} \mbox{\hyperlink{yubihsm__pkcs11_8c_af352138fec1245efdaee143f770c01ef}{in\+\_\+len}})
\item 
CK\+\_\+\+RV \mbox{\hyperlink{util__pkcs11_8c_a5aa664d8466537659db8d185d8e5683c}{apply\+\_\+encrypt\+\_\+mechanism\+\_\+update}} (\mbox{\hyperlink{structyubihsm__pkcs11__op__info}{yubihsm\+\_\+pkcs11\+\_\+op\+\_\+info}} \texorpdfstring{$\ast$}{*}op\+\_\+info, \mbox{\hyperlink{pkcs11_8h_a7bc6919a7c3c372056fa7e18343a0b37}{CK\+\_\+\+BYTE\+\_\+\+PTR}} in, \mbox{\hyperlink{pkcs11_8h_a35181858a3b7a0a81f49d180d8f446ef}{CK\+\_\+\+ULONG}} \mbox{\hyperlink{yubihsm__pkcs11_8c_af352138fec1245efdaee143f770c01ef}{in\+\_\+len}})
\item 
CK\+\_\+\+RV \mbox{\hyperlink{util__pkcs11_8c_a86347633f97ab81b8e9b49e4bd754d3f}{apply\+\_\+digest\+\_\+mechanism\+\_\+update}} (\mbox{\hyperlink{structyubihsm__pkcs11__op__info}{yubihsm\+\_\+pkcs11\+\_\+op\+\_\+info}} \texorpdfstring{$\ast$}{*}op\+\_\+info, \mbox{\hyperlink{pkcs11_8h_a7bc6919a7c3c372056fa7e18343a0b37}{CK\+\_\+\+BYTE\+\_\+\+PTR}} in, \mbox{\hyperlink{pkcs11_8h_a35181858a3b7a0a81f49d180d8f446ef}{CK\+\_\+\+ULONG}} \mbox{\hyperlink{yubihsm__pkcs11_8c_af352138fec1245efdaee143f770c01ef}{in\+\_\+len}})
\item 
CK\+\_\+\+RV \mbox{\hyperlink{util__pkcs11_8c_a785bd4bd444e619e6e5e12b2e392f086}{apply\+\_\+sign\+\_\+mechanism\+\_\+finalize}} (\mbox{\hyperlink{structyubihsm__pkcs11__op__info}{yubihsm\+\_\+pkcs11\+\_\+op\+\_\+info}} \texorpdfstring{$\ast$}{*}op\+\_\+info)
\item 
CK\+\_\+\+RV \mbox{\hyperlink{util__pkcs11_8c_a138a4c041c2fbb12771cf392f72d6188}{apply\+\_\+verify\+\_\+mechanism\+\_\+finalize}} (\mbox{\hyperlink{structyubihsm__pkcs11__op__info}{yubihsm\+\_\+pkcs11\+\_\+op\+\_\+info}} \texorpdfstring{$\ast$}{*}op\+\_\+info \+\_\+\+\_\+attribute((unused)))
\item 
CK\+\_\+\+RV \mbox{\hyperlink{util__pkcs11_8c_a381f03f93cbea0e2be45ac088614b17d}{apply\+\_\+decrypt\+\_\+mechanism\+\_\+finalize}} (\mbox{\hyperlink{structyubihsm__pkcs11__op__info}{yubihsm\+\_\+pkcs11\+\_\+op\+\_\+info}} \texorpdfstring{$\ast$}{*}op\+\_\+info \+\_\+\+\_\+attribute((unused)))
\item 
CK\+\_\+\+RV \mbox{\hyperlink{util__pkcs11_8c_a926a181770971fd05600d16f93acd39e}{apply\+\_\+digest\+\_\+mechanism\+\_\+finalize}} (\mbox{\hyperlink{structyubihsm__pkcs11__op__info}{yubihsm\+\_\+pkcs11\+\_\+op\+\_\+info}} \texorpdfstring{$\ast$}{*}op\+\_\+info)
\item 
CK\+\_\+\+RV \mbox{\hyperlink{util__pkcs11_8c_ab17f6ba85432d715def5185e7832c9e8}{perform\+\_\+verify}} (\mbox{\hyperlink{structyh__session}{yh\+\_\+session}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{ecdh__derive__test_8c_a0a2c7706d971796d7dc84fee36d6c84f}{session}}, \mbox{\hyperlink{structyubihsm__pkcs11__op__info}{yubihsm\+\_\+pkcs11\+\_\+op\+\_\+info}} \texorpdfstring{$\ast$}{*}op\+\_\+info, \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t}} \texorpdfstring{$\ast$}{*}signature, \mbox{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t}} signature\+\_\+len)
\item 
CK\+\_\+\+RV \mbox{\hyperlink{util__pkcs11_8c_a547f9032e3bcd7d6a5a810e94822e337}{perform\+\_\+signature}} (\mbox{\hyperlink{structyh__session}{yh\+\_\+session}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{ecdh__derive__test_8c_a0a2c7706d971796d7dc84fee36d6c84f}{session}}, \mbox{\hyperlink{structyubihsm__pkcs11__op__info}{yubihsm\+\_\+pkcs11\+\_\+op\+\_\+info}} \texorpdfstring{$\ast$}{*}op\+\_\+info, \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t}} \texorpdfstring{$\ast$}{*}signature, \mbox{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t}} \texorpdfstring{$\ast$}{*}signature\+\_\+len)
\item 
CK\+\_\+\+RV \mbox{\hyperlink{util__pkcs11_8c_a89815aa1db935281716a2b4d5520da8f}{perform\+\_\+decrypt}} (\mbox{\hyperlink{structyh__session}{yh\+\_\+session}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{ecdh__derive__test_8c_a0a2c7706d971796d7dc84fee36d6c84f}{session}}, \mbox{\hyperlink{structyubihsm__pkcs11__op__info}{yubihsm\+\_\+pkcs11\+\_\+op\+\_\+info}} \texorpdfstring{$\ast$}{*}op\+\_\+info, \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t}} \texorpdfstring{$\ast$}{*}data, \mbox{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t}} \texorpdfstring{$\ast$}{*}data\+\_\+len)
\item 
CK\+\_\+\+RV \mbox{\hyperlink{util__pkcs11_8c_aeb9c5d4717c977e42f88669d5ff26286}{perform\+\_\+encrypt}} (\mbox{\hyperlink{structyh__session}{yh\+\_\+session}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{ecdh__derive__test_8c_a0a2c7706d971796d7dc84fee36d6c84f}{session}}, \mbox{\hyperlink{structyubihsm__pkcs11__op__info}{yubihsm\+\_\+pkcs11\+\_\+op\+\_\+info}} \texorpdfstring{$\ast$}{*}op\+\_\+info, \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t}} \texorpdfstring{$\ast$}{*}data, \mbox{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t}} \texorpdfstring{$\ast$}{*}data\+\_\+len)
\item 
CK\+\_\+\+RV \mbox{\hyperlink{util__pkcs11_8c_a302f2929b31dff615158d284b2f56e79}{perform\+\_\+digest}} (\mbox{\hyperlink{structyubihsm__pkcs11__op__info}{yubihsm\+\_\+pkcs11\+\_\+op\+\_\+info}} \texorpdfstring{$\ast$}{*}op\+\_\+info, \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t}} \texorpdfstring{$\ast$}{*}digest, \mbox{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{yubihsm__pkcs11_8c_aa7984cb33ffce49c6276aa9cd928a5a6}{digest\+\_\+len}})
\item 
bool \mbox{\hyperlink{util__pkcs11_8c_a6959529c0513c47315e393d4e4827619}{sign\+\_\+mechanism\+\_\+cleanup}} (\mbox{\hyperlink{structyubihsm__pkcs11__op__info}{yubihsm\+\_\+pkcs11\+\_\+op\+\_\+info}} \texorpdfstring{$\ast$}{*}op\+\_\+info)
\item 
bool \mbox{\hyperlink{util__pkcs11_8c_a16a62896091be5cd8b7537d7f01d3f21}{verify\+\_\+mechanism\+\_\+cleanup}} (\mbox{\hyperlink{structyubihsm__pkcs11__op__info}{yubihsm\+\_\+pkcs11\+\_\+op\+\_\+info}} \texorpdfstring{$\ast$}{*}op\+\_\+info)
\item 
bool \mbox{\hyperlink{util__pkcs11_8c_a16357f17413edbce1da86168fb464074}{decrypt\+\_\+mechanism\+\_\+cleanup}} (\mbox{\hyperlink{structyubihsm__pkcs11__op__info}{yubihsm\+\_\+pkcs11\+\_\+op\+\_\+info}} \texorpdfstring{$\ast$}{*}op\+\_\+info)
\item 
bool \mbox{\hyperlink{util__pkcs11_8c_acf9d727a7620788445bc9ce264046b05}{digest\+\_\+mechanism\+\_\+cleanup}} (\mbox{\hyperlink{structyubihsm__pkcs11__op__info}{yubihsm\+\_\+pkcs11\+\_\+op\+\_\+info}} \texorpdfstring{$\ast$}{*}op\+\_\+info)
\item 
\mbox{\hyperlink{pkcs11_8h_a35181858a3b7a0a81f49d180d8f446ef}{CK\+\_\+\+ULONG}} \mbox{\hyperlink{util__pkcs11_8c_ac9a2fa09ddebb577ec5a919ad3a26d5d}{get\+\_\+digest\+\_\+bytelength}} (CK\+\_\+\+MECHANISM\+\_\+\+TYPE m)
\item 
bool \mbox{\hyperlink{util__pkcs11_8c_a7c0da3eb6986b1e9466392de8eb4b9f5}{is\+\_\+\+RSA\+\_\+sign\+\_\+mechanism}} (CK\+\_\+\+MECHANISM\+\_\+\+TYPE m)
\item 
bool \mbox{\hyperlink{util__pkcs11_8c_a8a3a4cd4d71d1a0489be171682cb9ece}{is\+\_\+\+RSA\+\_\+decrypt\+\_\+mechanism}} (CK\+\_\+\+MECHANISM\+\_\+\+TYPE m)
\item 
bool \mbox{\hyperlink{util__pkcs11_8c_a3f1010425d5308dfa15d696b4853c68c}{is\+\_\+hashed\+\_\+mechanism}} (CK\+\_\+\+MECHANISM\+\_\+\+TYPE m)
\item 
bool \mbox{\hyperlink{util__pkcs11_8c_a0040a19f3ec5afc2b8717e10860d55bc}{is\+\_\+\+PKCS1v1\+\_\+5\+\_\+sign\+\_\+mechanism}} (CK\+\_\+\+MECHANISM\+\_\+\+TYPE m)
\item 
bool \mbox{\hyperlink{util__pkcs11_8c_a03746a942ba1eaafbec20b675463ee00}{is\+\_\+\+ECDSA\+\_\+sign\+\_\+mechanism}} (CK\+\_\+\+MECHANISM\+\_\+\+TYPE m)
\item 
bool \mbox{\hyperlink{util__pkcs11_8c_a34722aea70286e920362e216c048f629}{is\+\_\+\+PSS\+\_\+sign\+\_\+mechanism}} (CK\+\_\+\+MECHANISM\+\_\+\+TYPE m)
\item 
bool \mbox{\hyperlink{util__pkcs11_8c_a3da5875af7a71b11ee5ead6b160d1ff4}{is\+\_\+\+HMAC\+\_\+sign\+\_\+mechanism}} (CK\+\_\+\+MECHANISM\+\_\+\+TYPE m)
\item 
\mbox{\hyperlink{structyubihsm__pkcs11__slot}{yubihsm\+\_\+pkcs11\+\_\+slot}} \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{util__pkcs11_8c_a79a44d844efebfc64db6cf5836754539}{get\+\_\+slot}} (\mbox{\hyperlink{structyubihsm__pkcs11__context}{yubihsm\+\_\+pkcs11\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{pkcs11_8h_a35181858a3b7a0a81f49d180d8f446ef}{CK\+\_\+\+ULONG}} \mbox{\hyperlink{code__cache_8cpp_aa0efefe21f4700d78692edc823e763be}{id}})
\item 
void \mbox{\hyperlink{util__pkcs11_8c_a3754cf5cb42a5e282658cf94f405574e}{release\+\_\+slot}} (\mbox{\hyperlink{structyubihsm__pkcs11__context}{yubihsm\+\_\+pkcs11\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{structyubihsm__pkcs11__slot}{yubihsm\+\_\+pkcs11\+\_\+slot}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}})
\item 
CK\+\_\+\+RV \mbox{\hyperlink{util__pkcs11_8c_a45da02427ecf4427e4c4c181bdd9891b}{get\+\_\+session}} (\mbox{\hyperlink{structyubihsm__pkcs11__context}{yubihsm\+\_\+pkcs11\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, CK\+\_\+\+SESSION\+\_\+\+HANDLE \mbox{\hyperlink{yubihsm__pkcs11_8c_a1907ffdf44b24385d6e575396ea79806}{h\+Session}}, \mbox{\hyperlink{structyubihsm__pkcs11__session}{yubihsm\+\_\+pkcs11\+\_\+session}} \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}\mbox{\hyperlink{ecdh__derive__test_8c_a0a2c7706d971796d7dc84fee36d6c84f}{session}}, int session\+\_\+state)
\item 
bool \mbox{\hyperlink{util__pkcs11_8c_a85ea84ffb047281f34a733572f67b254}{delete\+\_\+session}} (\mbox{\hyperlink{structyubihsm__pkcs11__context}{yubihsm\+\_\+pkcs11\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{pkcs11_8h_a28172afc989b647ca7909d036198afa6}{CK\+\_\+\+SESSION\+\_\+\+HANDLE\+\_\+\+PTR}} \mbox{\hyperlink{yubihsm__pkcs11_8c_a4af2a29df94c09021ad1646463da9201}{ph\+Session}})
\item 
void \mbox{\hyperlink{util__pkcs11_8c_aa7658e32c6ee781921b7e80a9d1fe2f8}{release\+\_\+session}} (\mbox{\hyperlink{structyubihsm__pkcs11__context}{yubihsm\+\_\+pkcs11\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, \mbox{\hyperlink{structyubihsm__pkcs11__session}{yubihsm\+\_\+pkcs11\+\_\+session}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{ecdh__derive__test_8c_a0a2c7706d971796d7dc84fee36d6c84f}{session}})
\item 
void \mbox{\hyperlink{util__pkcs11_8c_a7f93d30a54aef41540b4c31d8b2be064}{set\+\_\+native\+\_\+locking}} (\mbox{\hyperlink{structyubihsm__pkcs11__context}{yubihsm\+\_\+pkcs11\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx)
\item 
bool \mbox{\hyperlink{util__pkcs11_8c_a101ef72541fc11b032da224f8735117a}{add\+\_\+connectors}} (\mbox{\hyperlink{structyubihsm__pkcs11__context}{yubihsm\+\_\+pkcs11\+\_\+context}} \texorpdfstring{$\ast$}{*}ctx, int n\+\_\+connectors, char \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}connector\+\_\+names, \mbox{\hyperlink{structyh__connector}{yh\+\_\+connector}} \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}connectors)
\item 
CK\+\_\+\+RV \mbox{\hyperlink{util__pkcs11_8c_a03b553175220c8747145497de5032100}{set\+\_\+template\+\_\+attribute}} (\mbox{\hyperlink{yubihsm__pkcs11_8h_ade78776cf4e2dd3e25c4170aeb4edc63}{yubihsm\+\_\+pkcs11\+\_\+attribute}} \texorpdfstring{$\ast$}{*}attribute, void \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{pkcs11_8h_a32aff7c6c4cd253fdf6563677afab5ce}{value}})
\item 
CK\+\_\+\+RV \mbox{\hyperlink{util__pkcs11_8c_ab6a02fb5fc61b638c0f202f561d42445}{parse\+\_\+rsa\+\_\+template}} (\mbox{\hyperlink{pkcs11_8h_a5db3536793782f135785609e4a849fc6}{CK\+\_\+\+ATTRIBUTE\+\_\+\+PTR}} \mbox{\hyperlink{yubihsm__pkcs11_8c_aa4c2296db6853afc30383aec1a404972}{p\+Template}}, \mbox{\hyperlink{pkcs11_8h_a35181858a3b7a0a81f49d180d8f446ef}{CK\+\_\+\+ULONG}} \mbox{\hyperlink{yubihsm__pkcs11_8c_a490d37150a3d116225298faf1cb780b6}{ul\+Count}}, \mbox{\hyperlink{structyubihsm__pkcs11__object__template}{yubihsm\+\_\+pkcs11\+\_\+object\+\_\+template}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{yubihsm__pkcs11_8c_a53ef06e29c840024a683512c1acd791a}{template}})
\item 
CK\+\_\+\+RV \mbox{\hyperlink{util__pkcs11_8c_a67949ebcead5efdd41af1683033d525e}{parse\+\_\+ec\+\_\+template}} (\mbox{\hyperlink{pkcs11_8h_a5db3536793782f135785609e4a849fc6}{CK\+\_\+\+ATTRIBUTE\+\_\+\+PTR}} \mbox{\hyperlink{yubihsm__pkcs11_8c_aa4c2296db6853afc30383aec1a404972}{p\+Template}}, \mbox{\hyperlink{pkcs11_8h_a35181858a3b7a0a81f49d180d8f446ef}{CK\+\_\+\+ULONG}} \mbox{\hyperlink{yubihsm__pkcs11_8c_a490d37150a3d116225298faf1cb780b6}{ul\+Count}}, \mbox{\hyperlink{structyubihsm__pkcs11__object__template}{yubihsm\+\_\+pkcs11\+\_\+object\+\_\+template}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{yubihsm__pkcs11_8c_a53ef06e29c840024a683512c1acd791a}{template}})
\item 
CK\+\_\+\+RV \mbox{\hyperlink{util__pkcs11_8c_a7bf21a80e49d821dfcc0b5e97c056a69}{parse\+\_\+hmac\+\_\+template}} (\mbox{\hyperlink{pkcs11_8h_a5db3536793782f135785609e4a849fc6}{CK\+\_\+\+ATTRIBUTE\+\_\+\+PTR}} \mbox{\hyperlink{yubihsm__pkcs11_8c_aa4c2296db6853afc30383aec1a404972}{p\+Template}}, \mbox{\hyperlink{pkcs11_8h_a35181858a3b7a0a81f49d180d8f446ef}{CK\+\_\+\+ULONG}} \mbox{\hyperlink{yubihsm__pkcs11_8c_a490d37150a3d116225298faf1cb780b6}{ul\+Count}}, \mbox{\hyperlink{structyubihsm__pkcs11__object__template}{yubihsm\+\_\+pkcs11\+\_\+object\+\_\+template}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{yubihsm__pkcs11_8c_a53ef06e29c840024a683512c1acd791a}{template}}, bool generate)
\item 
CK\+\_\+\+RV \mbox{\hyperlink{util__pkcs11_8c_a3ae0dc7de593ff0d92ff81baaae9d5cb}{parse\+\_\+rsa\+\_\+generate\+\_\+template}} (\mbox{\hyperlink{pkcs11_8h_a5db3536793782f135785609e4a849fc6}{CK\+\_\+\+ATTRIBUTE\+\_\+\+PTR}} \mbox{\hyperlink{yubihsm__pkcs11_8c_ade5d8be372cb742833a442592301a68b}{p\+Public\+Key\+Template}}, \mbox{\hyperlink{pkcs11_8h_a35181858a3b7a0a81f49d180d8f446ef}{CK\+\_\+\+ULONG}} \mbox{\hyperlink{yubihsm__pkcs11_8c_aa7504c440c5b75cdd4386b6d56c6116c}{ul\+Public\+Key\+Attribute\+Count}}, \mbox{\hyperlink{pkcs11_8h_a5db3536793782f135785609e4a849fc6}{CK\+\_\+\+ATTRIBUTE\+\_\+\+PTR}} \mbox{\hyperlink{yubihsm__pkcs11_8c_aa0bd9585bb6c1f50e5c0c72da9d48cb9}{p\+Private\+Key\+Template}}, \mbox{\hyperlink{pkcs11_8h_a35181858a3b7a0a81f49d180d8f446ef}{CK\+\_\+\+ULONG}} \mbox{\hyperlink{yubihsm__pkcs11_8c_a062bc7ed451133876d988fb653844af4}{ul\+Private\+Key\+Attribute\+Count}}, \mbox{\hyperlink{structyubihsm__pkcs11__object__template}{yubihsm\+\_\+pkcs11\+\_\+object\+\_\+template}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{yubihsm__pkcs11_8c_a53ef06e29c840024a683512c1acd791a}{template}})
\item 
int \mbox{\hyperlink{util__pkcs11_8c_a66eb3d4688d7e1358a14b6c86b2158f9}{parse\+\_\+id\+\_\+value}} (void \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{pkcs11_8h_a32aff7c6c4cd253fdf6563677afab5ce}{value}}, \mbox{\hyperlink{pkcs11_8h_a35181858a3b7a0a81f49d180d8f446ef}{CK\+\_\+\+ULONG}} \mbox{\hyperlink{yubihsm__pkcs11_8c_a7360b55975153b822efc5217b7734e6a}{len}})
\item 
CK\+\_\+\+RV \mbox{\hyperlink{util__pkcs11_8c_a2413ad4604ce34308256962fb1098ec7}{parse\+\_\+ec\+\_\+generate\+\_\+template}} (\mbox{\hyperlink{pkcs11_8h_a5db3536793782f135785609e4a849fc6}{CK\+\_\+\+ATTRIBUTE\+\_\+\+PTR}} \mbox{\hyperlink{yubihsm__pkcs11_8c_ade5d8be372cb742833a442592301a68b}{p\+Public\+Key\+Template}}, \mbox{\hyperlink{pkcs11_8h_a35181858a3b7a0a81f49d180d8f446ef}{CK\+\_\+\+ULONG}} \mbox{\hyperlink{yubihsm__pkcs11_8c_aa7504c440c5b75cdd4386b6d56c6116c}{ul\+Public\+Key\+Attribute\+Count}}, \mbox{\hyperlink{pkcs11_8h_a5db3536793782f135785609e4a849fc6}{CK\+\_\+\+ATTRIBUTE\+\_\+\+PTR}} \mbox{\hyperlink{yubihsm__pkcs11_8c_aa0bd9585bb6c1f50e5c0c72da9d48cb9}{p\+Private\+Key\+Template}}, \mbox{\hyperlink{pkcs11_8h_a35181858a3b7a0a81f49d180d8f446ef}{CK\+\_\+\+ULONG}} \mbox{\hyperlink{yubihsm__pkcs11_8c_a062bc7ed451133876d988fb653844af4}{ul\+Private\+Key\+Attribute\+Count}}, \mbox{\hyperlink{structyubihsm__pkcs11__object__template}{yubihsm\+\_\+pkcs11\+\_\+object\+\_\+template}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{yubihsm__pkcs11_8c_a53ef06e29c840024a683512c1acd791a}{template}})
\item 
CK\+\_\+\+RV \mbox{\hyperlink{util__pkcs11_8c_a63b36e79f7eb240fe1de611008509389}{parse\+\_\+wrap\+\_\+template}} (\mbox{\hyperlink{pkcs11_8h_a5db3536793782f135785609e4a849fc6}{CK\+\_\+\+ATTRIBUTE\+\_\+\+PTR}} \mbox{\hyperlink{yubihsm__pkcs11_8c_aa4c2296db6853afc30383aec1a404972}{p\+Template}}, \mbox{\hyperlink{pkcs11_8h_a35181858a3b7a0a81f49d180d8f446ef}{CK\+\_\+\+ULONG}} \mbox{\hyperlink{yubihsm__pkcs11_8c_a490d37150a3d116225298faf1cb780b6}{ul\+Count}}, \mbox{\hyperlink{structyubihsm__pkcs11__object__template}{yubihsm\+\_\+pkcs11\+\_\+object\+\_\+template}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{yubihsm__pkcs11_8c_a53ef06e29c840024a683512c1acd791a}{template}}, bool generate)
\item 
CK\+\_\+\+RV \mbox{\hyperlink{util__pkcs11_8c_a1a7af578cd3ef13f8ae12652086c7a18}{populate\+\_\+template}} (int type, void \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{yubihsm__pkcs11_8c_a85d991d90970121ba1480cd98d93aab9}{object}}, \mbox{\hyperlink{pkcs11_8h_a5db3536793782f135785609e4a849fc6}{CK\+\_\+\+ATTRIBUTE\+\_\+\+PTR}} \mbox{\hyperlink{yubihsm__pkcs11_8c_aa4c2296db6853afc30383aec1a404972}{p\+Template}}, \mbox{\hyperlink{pkcs11_8h_a35181858a3b7a0a81f49d180d8f446ef}{CK\+\_\+\+ULONG}} \mbox{\hyperlink{yubihsm__pkcs11_8c_a490d37150a3d116225298faf1cb780b6}{ul\+Count}}, \mbox{\hyperlink{structyh__session}{yh\+\_\+session}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{ecdh__derive__test_8c_a0a2c7706d971796d7dc84fee36d6c84f}{session}})
\item 
CK\+\_\+\+RV \mbox{\hyperlink{util__pkcs11_8c_a5a10abc0d61cfd172e37c78948354243}{validate\+\_\+derive\+\_\+key\+\_\+attribute}} (CK\+\_\+\+ATTRIBUTE\+\_\+\+TYPE type, void \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{pkcs11_8h_a32aff7c6c4cd253fdf6563677afab5ce}{value}})
\end{DoxyCompactItemize}


\doxysubsection{Macro Definition Documentation}
\Hypertarget{util__pkcs11_8c_a3fef844d0ea67080b66b3a4d5f0a9ec8}\index{util\_pkcs11.c@{util\_pkcs11.c}!ASN1\_OID@{ASN1\_OID}}
\index{ASN1\_OID@{ASN1\_OID}!util\_pkcs11.c@{util\_pkcs11.c}}
\doxysubsubsection{\texorpdfstring{ASN1\_OID}{ASN1\_OID}}
{\footnotesize\ttfamily \label{util__pkcs11_8c_a3fef844d0ea67080b66b3a4d5f0a9ec8} 
\#define ASN1\+\_\+\+OID~0x06}



Definition at line \mbox{\hyperlink{util__pkcs11_8c_source_l00041}{41}} of file \mbox{\hyperlink{util__pkcs11_8c_source}{util\+\_\+pkcs11.\+c}}.



\doxysubsection{Function Documentation}
\Hypertarget{util__pkcs11_8c_a101ef72541fc11b032da224f8735117a}\index{util\_pkcs11.c@{util\_pkcs11.c}!add\_connectors@{add\_connectors}}
\index{add\_connectors@{add\_connectors}!util\_pkcs11.c@{util\_pkcs11.c}}
\doxysubsubsection{\texorpdfstring{add\_connectors()}{add\_connectors()}}
{\footnotesize\ttfamily \label{util__pkcs11_8c_a101ef72541fc11b032da224f8735117a} 
bool add\+\_\+connectors (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__pkcs11__context}{yubihsm\+\_\+pkcs11\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{int}]{n\+\_\+connectors}{, }\item[{char \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}}]{connector\+\_\+names}{, }\item[{\mbox{\hyperlink{structyh__connector}{yh\+\_\+connector}} \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}}]{connectors}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{util__pkcs11_8c_source_l02924}{2924}} of file \mbox{\hyperlink{util__pkcs11_8c_source}{util\+\_\+pkcs11.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02925\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02926\ \ \ \textcolor{keywordflow}{if}\ (ctx-\/>\mbox{\hyperlink{structyubihsm__pkcs11__context_ab22edea4554a2ea96e4e63954f6769a7}{slots}}.\mbox{\hyperlink{struct_list_ab1a74efd973a8efd990b05788152fd95}{head}}\ ==\ NULL)\ \{}
\DoxyCodeLine{02927\ \ \ \ \ \mbox{\hyperlink{list_8c_ac6c8b33b4100dfc73c933f3e936f86a1}{list\_create}}(\&ctx-\/>\mbox{\hyperlink{structyubihsm__pkcs11__context_ab22edea4554a2ea96e4e63954f6769a7}{slots}},\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structyubihsm__pkcs11__slot}{yubihsm\_pkcs11\_slot}}),\ free\_pkcs11\_slot);}
\DoxyCodeLine{02928\ \ \ \}}
\DoxyCodeLine{02929\ }
\DoxyCodeLine{02930\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ n\_connectors;\ i++)\ \{}
\DoxyCodeLine{02931\ \ \ \ \ \mbox{\hyperlink{structyubihsm__pkcs11__slot}{yubihsm\_pkcs11\_slot}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}};}
\DoxyCodeLine{02932\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_adc4bd59a60361844aa0e852efa210105}{memset}}(\&\mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}},\ 0,\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structyubihsm__pkcs11__slot}{yubihsm\_pkcs11\_slot}}));}
\DoxyCodeLine{02933\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}}.\mbox{\hyperlink{structyubihsm__pkcs11__slot_a7a8ed452594de0255b468210b42f2383}{id}}\ =\ i;}
\DoxyCodeLine{02934\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}}.\mbox{\hyperlink{structyubihsm__pkcs11__slot_aafd95d05495095288b23294aaae56caf}{connector\_name}}\ =\ strdup(connector\_names[i]);}
\DoxyCodeLine{02935\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}}.\mbox{\hyperlink{structyubihsm__pkcs11__slot_acb2adb2735c7e7fed62553254305888a}{max\_session\_id}}\ =\ 1;}
\DoxyCodeLine{02936\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}}.\mbox{\hyperlink{structyubihsm__pkcs11__slot_aafd95d05495095288b23294aaae56caf}{connector\_name}})\ \{}
\DoxyCodeLine{02937\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{02938\ \ \ \ \ \}}
\DoxyCodeLine{02939\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}}.\mbox{\hyperlink{structyubihsm__pkcs11__slot_a8022d3426b090c01b082636562f7c013}{connector}}\ =\ connectors[i];}
\DoxyCodeLine{02940\ \ \ \ \ \textcolor{keywordflow}{if}\ (ctx-\/>\mbox{\hyperlink{structyubihsm__pkcs11__context_a8fd07ddac920f2f93a360fb466b15e5f}{create\_mutex}}\ !=\ NULL)\ \{}
\DoxyCodeLine{02941\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (ctx-\/>\mbox{\hyperlink{structyubihsm__pkcs11__context_a8fd07ddac920f2f93a360fb466b15e5f}{create\_mutex}}(\&\mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}}.\mbox{\hyperlink{structyubihsm__pkcs11__slot_a3ecfa0dfb39d722e9a0fad07a8d9334d}{mutex}})\ !=\ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}})\ \{}
\DoxyCodeLine{02942\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{02943\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02944\ \ \ \ \ \}}
\DoxyCodeLine{02945\ \ \ \ \ \mbox{\hyperlink{list_8c_ac6c8b33b4100dfc73c933f3e936f86a1}{list\_create}}(\&\mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}}.\mbox{\hyperlink{structyubihsm__pkcs11__slot_ab8e6a1f9aba139c1561f21304649b43a}{pkcs11\_sessions}},\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structyubihsm__pkcs11__session}{yubihsm\_pkcs11\_session}}),\ NULL);}
\DoxyCodeLine{02946\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{list_8c_a06a2b45f704182a7d152c88d0507700c}{list\_append}}(\&ctx-\/>\mbox{\hyperlink{structyubihsm__pkcs11__context_ab22edea4554a2ea96e4e63954f6769a7}{slots}},\ (\textcolor{keywordtype}{void}\ *)\ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}})\ !=\ \textcolor{keyword}{true})\ \{}
\DoxyCodeLine{02947\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{02948\ \ \ \ \ \}}
\DoxyCodeLine{02949\ \ \ \}}
\DoxyCodeLine{02950\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{02951\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{util__pkcs11_8c_a101ef72541fc11b032da224f8735117a_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=332pt]{util__pkcs11_8c_a101ef72541fc11b032da224f8735117a_icgraph}
\end{center}
\end{figure}
\Hypertarget{util__pkcs11_8c_a381f03f93cbea0e2be45ac088614b17d}\index{util\_pkcs11.c@{util\_pkcs11.c}!apply\_decrypt\_mechanism\_finalize@{apply\_decrypt\_mechanism\_finalize}}
\index{apply\_decrypt\_mechanism\_finalize@{apply\_decrypt\_mechanism\_finalize}!util\_pkcs11.c@{util\_pkcs11.c}}
\doxysubsubsection{\texorpdfstring{apply\_decrypt\_mechanism\_finalize()}{apply\_decrypt\_mechanism\_finalize()}}
{\footnotesize\ttfamily \label{util__pkcs11_8c_a381f03f93cbea0e2be45ac088614b17d} 
CK\+\_\+\+RV apply\+\_\+decrypt\+\_\+mechanism\+\_\+finalize (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__pkcs11__op__info}{yubihsm\+\_\+pkcs11\+\_\+op\+\_\+info}} \texorpdfstring{$\ast$}{*}op\+\_\+info }]{\+\_\+\+\_\+attribute}{(unused)}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{util__pkcs11_8c_source_l02156}{2156}} of file \mbox{\hyperlink{util__pkcs11_8c_source}{util\+\_\+pkcs11.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02157\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02158\ }
\DoxyCodeLine{02159\ \ \ op\_info-\/>op.decrypt.finalized\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{02160\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}};}
\DoxyCodeLine{02161\ \}}

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=277pt]{util__pkcs11_8c_a381f03f93cbea0e2be45ac088614b17d_icgraph}
\end{center}
\end{figure}
\Hypertarget{util__pkcs11_8c_a915e620459f4f98eca94bff5913cfac5}\index{util\_pkcs11.c@{util\_pkcs11.c}!apply\_decrypt\_mechanism\_init@{apply\_decrypt\_mechanism\_init}}
\index{apply\_decrypt\_mechanism\_init@{apply\_decrypt\_mechanism\_init}!util\_pkcs11.c@{util\_pkcs11.c}}
\doxysubsubsection{\texorpdfstring{apply\_decrypt\_mechanism\_init()}{apply\_decrypt\_mechanism\_init()}}
{\footnotesize\ttfamily \label{util__pkcs11_8c_a915e620459f4f98eca94bff5913cfac5} 
CK\+\_\+\+RV apply\+\_\+decrypt\+\_\+mechanism\+\_\+init (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__pkcs11__op__info}{yubihsm\+\_\+pkcs11\+\_\+op\+\_\+info}} \texorpdfstring{$\ast$}{*}}]{op\+\_\+info}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{util__pkcs11_8c_source_l01884}{1884}} of file \mbox{\hyperlink{util__pkcs11_8c_source}{util\+\_\+pkcs11.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01884\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01885\ }
\DoxyCodeLine{01886\ \ \ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ac226105a253c6fda70b44e14a525007a}{buffer\_length}}\ =\ 0;}
\DoxyCodeLine{01887\ \ \ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_a511016f53f468cbe53728403a03df05a}{decrypt}}.\mbox{\hyperlink{structdecrypt__info_a7c05d8f6e2fa380b34b2f5331259b13d}{finalized}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01888\ }
\DoxyCodeLine{01889\ \ \ \textcolor{keywordflow}{switch}\ (op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a261664672f3ef63ab3a20b864627c49a}{mechanism}}.\mbox{\hyperlink{structmechanism_afeb8198b0f33f94f4520c0ffbc584a9a}{mechanism}})\ \{}
\DoxyCodeLine{01890\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a08a8e0f2109de3ff3bfe26f220447a2e}{CKM\_RSA\_PKCS}}:}
\DoxyCodeLine{01891\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a69da8859ad1e6b4f424d071b42ea4a0c}{CKM\_RSA\_PKCS\_OAEP}}:}
\DoxyCodeLine{01892\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11y_8h_a631efbda997696a7f7ce71df0e3e779a}{CKM\_YUBICO\_AES\_CCM\_WRAP}}:}
\DoxyCodeLine{01893\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}};}
\DoxyCodeLine{01894\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{01895\ \ \ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a2e3ed21e5ffba18d940d164aaec64a2a}{DBG\_ERR}}(\textcolor{stringliteral}{"{}Mechanism\ \%lu\ not\ supported"{}},\ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a261664672f3ef63ab3a20b864627c49a}{mechanism}}.\mbox{\hyperlink{structmechanism_afeb8198b0f33f94f4520c0ffbc584a9a}{mechanism}});}
\DoxyCodeLine{01896\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a0664e99597a479c7fce5b19411cfc1b1}{CKR\_MECHANISM\_INVALID}};}
\DoxyCodeLine{01897\ \ \ \}}
\DoxyCodeLine{01898\ }
\DoxyCodeLine{01899\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}};}
\DoxyCodeLine{01900\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{util__pkcs11_8c_a915e620459f4f98eca94bff5913cfac5_cgraph}
\end{center}
\end{figure}
\Hypertarget{util__pkcs11_8c_a7fe9865366124c43dfbc7db9e710384d}\index{util\_pkcs11.c@{util\_pkcs11.c}!apply\_decrypt\_mechanism\_update@{apply\_decrypt\_mechanism\_update}}
\index{apply\_decrypt\_mechanism\_update@{apply\_decrypt\_mechanism\_update}!util\_pkcs11.c@{util\_pkcs11.c}}
\doxysubsubsection{\texorpdfstring{apply\_decrypt\_mechanism\_update()}{apply\_decrypt\_mechanism\_update()}}
{\footnotesize\ttfamily \label{util__pkcs11_8c_a7fe9865366124c43dfbc7db9e710384d} 
CK\+\_\+\+RV apply\+\_\+decrypt\+\_\+mechanism\+\_\+update (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__pkcs11__op__info}{yubihsm\+\_\+pkcs11\+\_\+op\+\_\+info}} \texorpdfstring{$\ast$}{*}}]{op\+\_\+info}{, }\item[{\mbox{\hyperlink{pkcs11_8h_a7bc6919a7c3c372056fa7e18343a0b37}{CK\+\_\+\+BYTE\+\_\+\+PTR}}}]{in}{, }\item[{\mbox{\hyperlink{pkcs11_8h_a35181858a3b7a0a81f49d180d8f446ef}{CK\+\_\+\+ULONG}}}]{in\+\_\+len}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{util__pkcs11_8c_source_l02053}{2053}} of file \mbox{\hyperlink{util__pkcs11_8c_source}{util\+\_\+pkcs11.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02054\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02055\ }
\DoxyCodeLine{02056\ \ \ \textcolor{keywordflow}{switch}\ (op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a261664672f3ef63ab3a20b864627c49a}{mechanism}}.\mbox{\hyperlink{structmechanism_afeb8198b0f33f94f4520c0ffbc584a9a}{mechanism}})\ \{}
\DoxyCodeLine{02057\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a08a8e0f2109de3ff3bfe26f220447a2e}{CKM\_RSA\_PKCS}}:}
\DoxyCodeLine{02058\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a69da8859ad1e6b4f424d071b42ea4a0c}{CKM\_RSA\_PKCS\_OAEP}}:}
\DoxyCodeLine{02059\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11y_8h_a631efbda997696a7f7ce71df0e3e779a}{CKM\_YUBICO\_AES\_CCM\_WRAP}}:}
\DoxyCodeLine{02060\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ac226105a253c6fda70b44e14a525007a}{buffer\_length}}\ +\ \mbox{\hyperlink{yubihsm__pkcs11_8c_af352138fec1245efdaee143f770c01ef}{in\_len}}\ >\ \textcolor{keyword}{sizeof}(op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ad4fd174ba5f77aad7e1f1c66079529ba}{buffer}}))\ \{}
\DoxyCodeLine{02061\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a9a521148fda788ca98f4fdbb6d3b9438}{CKR\_DATA\_LEN\_RANGE}};}
\DoxyCodeLine{02062\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02063\ }
\DoxyCodeLine{02064\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ad4fd174ba5f77aad7e1f1c66079529ba}{buffer}}\ +\ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ac226105a253c6fda70b44e14a525007a}{buffer\_length}},\ in,\ \mbox{\hyperlink{yubihsm__pkcs11_8c_af352138fec1245efdaee143f770c01ef}{in\_len}});}
\DoxyCodeLine{02065\ \ \ \ \ \ \ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ac226105a253c6fda70b44e14a525007a}{buffer\_length}}\ +=\ \mbox{\hyperlink{yubihsm__pkcs11_8c_af352138fec1245efdaee143f770c01ef}{in\_len}};}
\DoxyCodeLine{02066\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02067\ }
\DoxyCodeLine{02068\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{02069\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a91150ecacbaa624fcc7d861f1b54f57c}{CKR\_FUNCTION\_FAILED}};}
\DoxyCodeLine{02070\ \ \ \}}
\DoxyCodeLine{02071\ }
\DoxyCodeLine{02072\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}};}
\DoxyCodeLine{02073\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{util__pkcs11_8c_a7fe9865366124c43dfbc7db9e710384d_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=277pt]{util__pkcs11_8c_a7fe9865366124c43dfbc7db9e710384d_icgraph}
\end{center}
\end{figure}
\Hypertarget{util__pkcs11_8c_a926a181770971fd05600d16f93acd39e}\index{util\_pkcs11.c@{util\_pkcs11.c}!apply\_digest\_mechanism\_finalize@{apply\_digest\_mechanism\_finalize}}
\index{apply\_digest\_mechanism\_finalize@{apply\_digest\_mechanism\_finalize}!util\_pkcs11.c@{util\_pkcs11.c}}
\doxysubsubsection{\texorpdfstring{apply\_digest\_mechanism\_finalize()}{apply\_digest\_mechanism\_finalize()}}
{\footnotesize\ttfamily \label{util__pkcs11_8c_a926a181770971fd05600d16f93acd39e} 
CK\+\_\+\+RV apply\+\_\+digest\+\_\+mechanism\+\_\+finalize (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__pkcs11__op__info}{yubihsm\+\_\+pkcs11\+\_\+op\+\_\+info}} \texorpdfstring{$\ast$}{*}}]{op\+\_\+info}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{util__pkcs11_8c_source_l02163}{2163}} of file \mbox{\hyperlink{util__pkcs11_8c_source}{util\+\_\+pkcs11.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02163\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02164\ }
\DoxyCodeLine{02165\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}};}
\DoxyCodeLine{02166\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}}\ =\ EVP\_DigestFinal\_ex(op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_a06ea7ebdd4f4e99dec979ed3576e5722}{digest}}.\mbox{\hyperlink{structdigest__info_acf5534c1229554d54bf0e71dd544db81}{md\_ctx}},\ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ad4fd174ba5f77aad7e1f1c66079529ba}{buffer}},}
\DoxyCodeLine{02167\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ac226105a253c6fda70b44e14a525007a}{buffer\_length}});}
\DoxyCodeLine{02168\ }
\DoxyCodeLine{02169\ \ \ EVP\_MD\_CTX\_destroy(op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_a06ea7ebdd4f4e99dec979ed3576e5722}{digest}}.\mbox{\hyperlink{structdigest__info_acf5534c1229554d54bf0e71dd544db81}{md\_ctx}});}
\DoxyCodeLine{02170\ \ \ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_a06ea7ebdd4f4e99dec979ed3576e5722}{digest}}.\mbox{\hyperlink{structdigest__info_acf5534c1229554d54bf0e71dd544db81}{md\_ctx}}\ =\ NULL;}
\DoxyCodeLine{02171\ }
\DoxyCodeLine{02172\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}}\ !=\ 1)\ \{}
\DoxyCodeLine{02173\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a91150ecacbaa624fcc7d861f1b54f57c}{CKR\_FUNCTION\_FAILED}};}
\DoxyCodeLine{02174\ \ \ \}}
\DoxyCodeLine{02175\ }
\DoxyCodeLine{02176\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}};}
\DoxyCodeLine{02177\ \}}

\end{DoxyCode}
\Hypertarget{util__pkcs11_8c_a50a795ac4e657d1813394e49cd4650d0}\index{util\_pkcs11.c@{util\_pkcs11.c}!apply\_digest\_mechanism\_init@{apply\_digest\_mechanism\_init}}
\index{apply\_digest\_mechanism\_init@{apply\_digest\_mechanism\_init}!util\_pkcs11.c@{util\_pkcs11.c}}
\doxysubsubsection{\texorpdfstring{apply\_digest\_mechanism\_init()}{apply\_digest\_mechanism\_init()}}
{\footnotesize\ttfamily \label{util__pkcs11_8c_a50a795ac4e657d1813394e49cd4650d0} 
CK\+\_\+\+RV apply\+\_\+digest\+\_\+mechanism\+\_\+init (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__pkcs11__op__info}{yubihsm\+\_\+pkcs11\+\_\+op\+\_\+info}} \texorpdfstring{$\ast$}{*}}]{op\+\_\+info}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{util__pkcs11_8c_source_l01902}{1902}} of file \mbox{\hyperlink{util__pkcs11_8c_source}{util\+\_\+pkcs11.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01902\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01903\ }
\DoxyCodeLine{01904\ \ \ \textcolor{keyword}{const}\ EVP\_MD\ *md\ =\ NULL;}
\DoxyCodeLine{01905\ }
\DoxyCodeLine{01906\ \ \ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ac226105a253c6fda70b44e14a525007a}{buffer\_length}}\ =\ 0;}
\DoxyCodeLine{01907\ }
\DoxyCodeLine{01908\ \ \ \textcolor{keywordflow}{switch}\ (op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a261664672f3ef63ab3a20b864627c49a}{mechanism}}.\mbox{\hyperlink{structmechanism_afeb8198b0f33f94f4520c0ffbc584a9a}{mechanism}})\ \{}
\DoxyCodeLine{01909\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_af1818a1c453a84f01f2e868307ca8fed}{CKM\_SHA\_1}}:}
\DoxyCodeLine{01910\ \ \ \ \ \ \ md\ =\ EVP\_sha1();}
\DoxyCodeLine{01911\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01912\ }
\DoxyCodeLine{01913\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a4d11f88ae3bea2f748f275c03b54a648}{CKM\_SHA256}}:}
\DoxyCodeLine{01914\ \ \ \ \ \ \ md\ =\ EVP\_sha256();}
\DoxyCodeLine{01915\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01916\ }
\DoxyCodeLine{01917\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a9278e01971ca83cdd07e4b8e07a00bc8}{CKM\_SHA384}}:}
\DoxyCodeLine{01918\ \ \ \ \ \ \ md\ =\ EVP\_sha384();}
\DoxyCodeLine{01919\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01920\ }
\DoxyCodeLine{01921\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a9bf4bf7375a24e1010cc8e0139608fd5}{CKM\_SHA512}}:}
\DoxyCodeLine{01922\ \ \ \ \ \ \ md\ =\ EVP\_sha512();}
\DoxyCodeLine{01923\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01924\ }
\DoxyCodeLine{01925\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{01926\ \ \ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a2e3ed21e5ffba18d940d164aaec64a2a}{DBG\_ERR}}(\textcolor{stringliteral}{"{}Mechanism\ \%lu\ not\ supported"{}},\ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a261664672f3ef63ab3a20b864627c49a}{mechanism}}.\mbox{\hyperlink{structmechanism_afeb8198b0f33f94f4520c0ffbc584a9a}{mechanism}});}
\DoxyCodeLine{01927\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a0664e99597a479c7fce5b19411cfc1b1}{CKR\_MECHANISM\_INVALID}};}
\DoxyCodeLine{01928\ \ \ \}}
\DoxyCodeLine{01929\ }
\DoxyCodeLine{01930\ \ \ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_a06ea7ebdd4f4e99dec979ed3576e5722}{digest}}.\mbox{\hyperlink{structdigest__info_acf5534c1229554d54bf0e71dd544db81}{md\_ctx}}\ =\ EVP\_MD\_CTX\_create();}
\DoxyCodeLine{01931\ }
\DoxyCodeLine{01932\ \ \ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_a06ea7ebdd4f4e99dec979ed3576e5722}{digest}}.\mbox{\hyperlink{structdigest__info_aedb88e03528275703ea081d85882efc0}{is\_multipart}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01933\ }
\DoxyCodeLine{01934\ \ \ \textcolor{keywordflow}{if}\ (EVP\_DigestInit\_ex(op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_a06ea7ebdd4f4e99dec979ed3576e5722}{digest}}.\mbox{\hyperlink{structdigest__info_acf5534c1229554d54bf0e71dd544db81}{md\_ctx}},\ md,\ NULL)\ ==\ 0)\ \{}
\DoxyCodeLine{01935\ \ \ \ \ EVP\_MD\_CTX\_destroy(op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_a06ea7ebdd4f4e99dec979ed3576e5722}{digest}}.\mbox{\hyperlink{structdigest__info_acf5534c1229554d54bf0e71dd544db81}{md\_ctx}});}
\DoxyCodeLine{01936\ \ \ \ \ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_a06ea7ebdd4f4e99dec979ed3576e5722}{digest}}.\mbox{\hyperlink{structdigest__info_acf5534c1229554d54bf0e71dd544db81}{md\_ctx}}\ =\ NULL;}
\DoxyCodeLine{01937\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a91150ecacbaa624fcc7d861f1b54f57c}{CKR\_FUNCTION\_FAILED}};}
\DoxyCodeLine{01938\ \ \ \}}
\DoxyCodeLine{01939\ }
\DoxyCodeLine{01940\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}};}
\DoxyCodeLine{01941\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{util__pkcs11_8c_a50a795ac4e657d1813394e49cd4650d0_cgraph}
\end{center}
\end{figure}
\Hypertarget{util__pkcs11_8c_a86347633f97ab81b8e9b49e4bd754d3f}\index{util\_pkcs11.c@{util\_pkcs11.c}!apply\_digest\_mechanism\_update@{apply\_digest\_mechanism\_update}}
\index{apply\_digest\_mechanism\_update@{apply\_digest\_mechanism\_update}!util\_pkcs11.c@{util\_pkcs11.c}}
\doxysubsubsection{\texorpdfstring{apply\_digest\_mechanism\_update()}{apply\_digest\_mechanism\_update()}}
{\footnotesize\ttfamily \label{util__pkcs11_8c_a86347633f97ab81b8e9b49e4bd754d3f} 
CK\+\_\+\+RV apply\+\_\+digest\+\_\+mechanism\+\_\+update (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__pkcs11__op__info}{yubihsm\+\_\+pkcs11\+\_\+op\+\_\+info}} \texorpdfstring{$\ast$}{*}}]{op\+\_\+info}{, }\item[{\mbox{\hyperlink{pkcs11_8h_a7bc6919a7c3c372056fa7e18343a0b37}{CK\+\_\+\+BYTE\+\_\+\+PTR}}}]{in}{, }\item[{\mbox{\hyperlink{pkcs11_8h_a35181858a3b7a0a81f49d180d8f446ef}{CK\+\_\+\+ULONG}}}]{in\+\_\+len}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{util__pkcs11_8c_source_l02095}{2095}} of file \mbox{\hyperlink{util__pkcs11_8c_source}{util\+\_\+pkcs11.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02096\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02097\ }
\DoxyCodeLine{02098\ \ \ \textcolor{keywordflow}{switch}\ (op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a261664672f3ef63ab3a20b864627c49a}{mechanism}}.\mbox{\hyperlink{structmechanism_afeb8198b0f33f94f4520c0ffbc584a9a}{mechanism}})\ \{}
\DoxyCodeLine{02099\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_af1818a1c453a84f01f2e868307ca8fed}{CKM\_SHA\_1}}:}
\DoxyCodeLine{02100\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a4d11f88ae3bea2f748f275c03b54a648}{CKM\_SHA256}}:}
\DoxyCodeLine{02101\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a9278e01971ca83cdd07e4b8e07a00bc8}{CKM\_SHA384}}:}
\DoxyCodeLine{02102\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a9bf4bf7375a24e1010cc8e0139608fd5}{CKM\_SHA512}}:}
\DoxyCodeLine{02103\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (EVP\_DigestUpdate(op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_a06ea7ebdd4f4e99dec979ed3576e5722}{digest}}.\mbox{\hyperlink{structdigest__info_acf5534c1229554d54bf0e71dd544db81}{md\_ctx}},\ in,\ \mbox{\hyperlink{yubihsm__pkcs11_8c_af352138fec1245efdaee143f770c01ef}{in\_len}})\ !=\ 1)\ \{}
\DoxyCodeLine{02104\ \ \ \ \ \ \ \ \ EVP\_MD\_CTX\_destroy(op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_a06ea7ebdd4f4e99dec979ed3576e5722}{digest}}.\mbox{\hyperlink{structdigest__info_acf5534c1229554d54bf0e71dd544db81}{md\_ctx}});}
\DoxyCodeLine{02105\ \ \ \ \ \ \ \ \ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_a06ea7ebdd4f4e99dec979ed3576e5722}{digest}}.\mbox{\hyperlink{structdigest__info_acf5534c1229554d54bf0e71dd544db81}{md\_ctx}}\ =\ NULL;}
\DoxyCodeLine{02106\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a91150ecacbaa624fcc7d861f1b54f57c}{CKR\_FUNCTION\_FAILED}};}
\DoxyCodeLine{02107\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02108\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02109\ }
\DoxyCodeLine{02110\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{02111\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a91150ecacbaa624fcc7d861f1b54f57c}{CKR\_FUNCTION\_FAILED}};}
\DoxyCodeLine{02112\ \ \ \}}
\DoxyCodeLine{02113\ }
\DoxyCodeLine{02114\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}};}
\DoxyCodeLine{02115\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{util__pkcs11_8c_a86347633f97ab81b8e9b49e4bd754d3f_cgraph}
\end{center}
\end{figure}
\Hypertarget{util__pkcs11_8c_a5aa664d8466537659db8d185d8e5683c}\index{util\_pkcs11.c@{util\_pkcs11.c}!apply\_encrypt\_mechanism\_update@{apply\_encrypt\_mechanism\_update}}
\index{apply\_encrypt\_mechanism\_update@{apply\_encrypt\_mechanism\_update}!util\_pkcs11.c@{util\_pkcs11.c}}
\doxysubsubsection{\texorpdfstring{apply\_encrypt\_mechanism\_update()}{apply\_encrypt\_mechanism\_update()}}
{\footnotesize\ttfamily \label{util__pkcs11_8c_a5aa664d8466537659db8d185d8e5683c} 
CK\+\_\+\+RV apply\+\_\+encrypt\+\_\+mechanism\+\_\+update (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__pkcs11__op__info}{yubihsm\+\_\+pkcs11\+\_\+op\+\_\+info}} \texorpdfstring{$\ast$}{*}}]{op\+\_\+info}{, }\item[{\mbox{\hyperlink{pkcs11_8h_a7bc6919a7c3c372056fa7e18343a0b37}{CK\+\_\+\+BYTE\+\_\+\+PTR}}}]{in}{, }\item[{\mbox{\hyperlink{pkcs11_8h_a35181858a3b7a0a81f49d180d8f446ef}{CK\+\_\+\+ULONG}}}]{in\+\_\+len}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{util__pkcs11_8c_source_l02075}{2075}} of file \mbox{\hyperlink{util__pkcs11_8c_source}{util\+\_\+pkcs11.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02076\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02077\ }
\DoxyCodeLine{02078\ \ \ \textcolor{keywordflow}{switch}\ (op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a261664672f3ef63ab3a20b864627c49a}{mechanism}}.\mbox{\hyperlink{structmechanism_afeb8198b0f33f94f4520c0ffbc584a9a}{mechanism}})\ \{}
\DoxyCodeLine{02079\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11y_8h_a631efbda997696a7f7ce71df0e3e779a}{CKM\_YUBICO\_AES\_CCM\_WRAP}}:}
\DoxyCodeLine{02080\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ac226105a253c6fda70b44e14a525007a}{buffer\_length}}\ +\ \mbox{\hyperlink{yubihsm__pkcs11_8c_af352138fec1245efdaee143f770c01ef}{in\_len}}\ >\ \textcolor{keyword}{sizeof}(op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ad4fd174ba5f77aad7e1f1c66079529ba}{buffer}}))\ \{}
\DoxyCodeLine{02081\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a9a521148fda788ca98f4fdbb6d3b9438}{CKR\_DATA\_LEN\_RANGE}};}
\DoxyCodeLine{02082\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02083\ }
\DoxyCodeLine{02084\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ad4fd174ba5f77aad7e1f1c66079529ba}{buffer}}\ +\ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ac226105a253c6fda70b44e14a525007a}{buffer\_length}},\ in,\ \mbox{\hyperlink{yubihsm__pkcs11_8c_af352138fec1245efdaee143f770c01ef}{in\_len}});}
\DoxyCodeLine{02085\ \ \ \ \ \ \ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ac226105a253c6fda70b44e14a525007a}{buffer\_length}}\ +=\ \mbox{\hyperlink{yubihsm__pkcs11_8c_af352138fec1245efdaee143f770c01ef}{in\_len}};}
\DoxyCodeLine{02086\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02087\ }
\DoxyCodeLine{02088\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{02089\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a91150ecacbaa624fcc7d861f1b54f57c}{CKR\_FUNCTION\_FAILED}};}
\DoxyCodeLine{02090\ \ \ \}}
\DoxyCodeLine{02091\ }
\DoxyCodeLine{02092\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}};}
\DoxyCodeLine{02093\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{util__pkcs11_8c_a5aa664d8466537659db8d185d8e5683c_cgraph}
\end{center}
\end{figure}
\Hypertarget{util__pkcs11_8c_a785bd4bd444e619e6e5e12b2e392f086}\index{util\_pkcs11.c@{util\_pkcs11.c}!apply\_sign\_mechanism\_finalize@{apply\_sign\_mechanism\_finalize}}
\index{apply\_sign\_mechanism\_finalize@{apply\_sign\_mechanism\_finalize}!util\_pkcs11.c@{util\_pkcs11.c}}
\doxysubsubsection{\texorpdfstring{apply\_sign\_mechanism\_finalize()}{apply\_sign\_mechanism\_finalize()}}
{\footnotesize\ttfamily \label{util__pkcs11_8c_a785bd4bd444e619e6e5e12b2e392f086} 
CK\+\_\+\+RV apply\+\_\+sign\+\_\+mechanism\+\_\+finalize (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__pkcs11__op__info}{yubihsm\+\_\+pkcs11\+\_\+op\+\_\+info}} \texorpdfstring{$\ast$}{*}}]{op\+\_\+info}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{util__pkcs11_8c_source_l02117}{2117}} of file \mbox{\hyperlink{util__pkcs11_8c_source}{util\+\_\+pkcs11.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02117\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02118\ }
\DoxyCodeLine{02119\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{util__pkcs11_8c_a3f1010425d5308dfa15d696b4853c68c}{is\_hashed\_mechanism}}(op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a261664672f3ef63ab3a20b864627c49a}{mechanism}}.\mbox{\hyperlink{structmechanism_afeb8198b0f33f94f4520c0ffbc584a9a}{mechanism}}))\ \{}
\DoxyCodeLine{02120\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}};}
\DoxyCodeLine{02121\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}}\ =\ EVP\_DigestFinal\_ex(op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_af6e088c2d57f2582d353bec69b48c023}{sign}}.\mbox{\hyperlink{structsign__info_a575aca68f9e4dec0e3cc9de8bc560725}{md\_ctx}},\ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ad4fd174ba5f77aad7e1f1c66079529ba}{buffer}},}
\DoxyCodeLine{02122\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ac226105a253c6fda70b44e14a525007a}{buffer\_length}});}
\DoxyCodeLine{02123\ }
\DoxyCodeLine{02124\ \ \ \ \ EVP\_MD\_CTX\_destroy(op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_af6e088c2d57f2582d353bec69b48c023}{sign}}.\mbox{\hyperlink{structsign__info_a575aca68f9e4dec0e3cc9de8bc560725}{md\_ctx}});}
\DoxyCodeLine{02125\ \ \ \ \ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_af6e088c2d57f2582d353bec69b48c023}{sign}}.\mbox{\hyperlink{structsign__info_a575aca68f9e4dec0e3cc9de8bc560725}{md\_ctx}}\ =\ NULL;}
\DoxyCodeLine{02126\ }
\DoxyCodeLine{02127\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}}\ !=\ 1)\ \{}
\DoxyCodeLine{02128\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a91150ecacbaa624fcc7d861f1b54f57c}{CKR\_FUNCTION\_FAILED}};}
\DoxyCodeLine{02129\ \ \ \ \ \}}
\DoxyCodeLine{02130\ \ \ \}}
\DoxyCodeLine{02131\ }
\DoxyCodeLine{02132\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{util__pkcs11_8c_a03746a942ba1eaafbec20b675463ee00}{is\_ECDSA\_sign\_mechanism}}(op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a261664672f3ef63ab3a20b864627c49a}{mechanism}}.\mbox{\hyperlink{structmechanism_afeb8198b0f33f94f4520c0ffbc584a9a}{mechanism}}))\ \{}
\DoxyCodeLine{02133\ \ \ \ \ \textcolor{keywordflow}{if}\ (op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ac226105a253c6fda70b44e14a525007a}{buffer\_length}}\ <\ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_af6e088c2d57f2582d353bec69b48c023}{sign}}.\mbox{\hyperlink{structsign__info_ae691c5b3f66d72902403622f40a5a94f}{sig\_len}}\ /\ 2)\ \{}
\DoxyCodeLine{02134\ \ \ \ \ \ \ \mbox{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t}}\ padding\ =}
\DoxyCodeLine{02135\ \ \ \ \ \ \ \ \ (op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_af6e088c2d57f2582d353bec69b48c023}{sign}}.\mbox{\hyperlink{structsign__info_ae691c5b3f66d72902403622f40a5a94f}{sig\_len}}\ /\ 2)\ -\/\ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ac226105a253c6fda70b44e14a525007a}{buffer\_length}};}
\DoxyCodeLine{02136\ \ \ \ \ \ \ memmove(op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ad4fd174ba5f77aad7e1f1c66079529ba}{buffer}}\ +\ padding,\ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ad4fd174ba5f77aad7e1f1c66079529ba}{buffer}},}
\DoxyCodeLine{02137\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ac226105a253c6fda70b44e14a525007a}{buffer\_length}});}
\DoxyCodeLine{02138\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_adc4bd59a60361844aa0e852efa210105}{memset}}(op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ad4fd174ba5f77aad7e1f1c66079529ba}{buffer}},\ 0,\ padding);}
\DoxyCodeLine{02139\ \ \ \ \ \ \ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ac226105a253c6fda70b44e14a525007a}{buffer\_length}}\ +=\ padding;}
\DoxyCodeLine{02140\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ac226105a253c6fda70b44e14a525007a}{buffer\_length}}\ >\ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_af6e088c2d57f2582d353bec69b48c023}{sign}}.\mbox{\hyperlink{structsign__info_ae691c5b3f66d72902403622f40a5a94f}{sig\_len}}\ /\ 2)\ \{}
\DoxyCodeLine{02141\ \ \ \ \ \ \ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ac226105a253c6fda70b44e14a525007a}{buffer\_length}}\ =\ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_af6e088c2d57f2582d353bec69b48c023}{sign}}.\mbox{\hyperlink{structsign__info_ae691c5b3f66d72902403622f40a5a94f}{sig\_len}}\ /\ 2;}
\DoxyCodeLine{02142\ \ \ \ \ \}}
\DoxyCodeLine{02143\ \ \ \}}
\DoxyCodeLine{02144\ }
\DoxyCodeLine{02145\ \ \ \textcolor{comment}{//\ TODO(adma):\ check\ if\ more\ steps\ are\ need\ for\ PSS\ or\ ECDSA}}
\DoxyCodeLine{02146\ }
\DoxyCodeLine{02147\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}};}
\DoxyCodeLine{02148\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{util__pkcs11_8c_a785bd4bd444e619e6e5e12b2e392f086_cgraph}
\end{center}
\end{figure}
\Hypertarget{util__pkcs11_8c_ace7396cb0c7b79d711f41031943387aa}\index{util\_pkcs11.c@{util\_pkcs11.c}!apply\_sign\_mechanism\_init@{apply\_sign\_mechanism\_init}}
\index{apply\_sign\_mechanism\_init@{apply\_sign\_mechanism\_init}!util\_pkcs11.c@{util\_pkcs11.c}}
\doxysubsubsection{\texorpdfstring{apply\_sign\_mechanism\_init()}{apply\_sign\_mechanism\_init()}}
{\footnotesize\ttfamily \label{util__pkcs11_8c_ace7396cb0c7b79d711f41031943387aa} 
CK\+\_\+\+RV apply\+\_\+sign\+\_\+mechanism\+\_\+init (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__pkcs11__op__info}{yubihsm\+\_\+pkcs11\+\_\+op\+\_\+info}} \texorpdfstring{$\ast$}{*}}]{op\+\_\+info}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{util__pkcs11_8c_source_l01763}{1763}} of file \mbox{\hyperlink{util__pkcs11_8c_source}{util\+\_\+pkcs11.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01763\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01764\ }
\DoxyCodeLine{01765\ \ \ \textcolor{keyword}{const}\ EVP\_MD\ *md\ =\ NULL;}
\DoxyCodeLine{01766\ }
\DoxyCodeLine{01767\ \ \ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ac226105a253c6fda70b44e14a525007a}{buffer\_length}}\ =\ 0;}
\DoxyCodeLine{01768\ }
\DoxyCodeLine{01769\ \ \ \textcolor{keywordflow}{switch}\ (op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a261664672f3ef63ab3a20b864627c49a}{mechanism}}.\mbox{\hyperlink{structmechanism_afeb8198b0f33f94f4520c0ffbc584a9a}{mechanism}})\ \{}
\DoxyCodeLine{01770\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a08a8e0f2109de3ff3bfe26f220447a2e}{CKM\_RSA\_PKCS}}:}
\DoxyCodeLine{01771\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ad4f5697408b23623c904df2b1ca8a9f1}{CKM\_RSA\_PKCS\_PSS}}:}
\DoxyCodeLine{01772\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ab4a7299a144f0ef52cee06893cc60483}{CKM\_ECDSA}}:}
\DoxyCodeLine{01773\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a1eb3f4cee46e624bfbbc6889e1e5bc06}{CKM\_SHA\_1\_HMAC}}:}
\DoxyCodeLine{01774\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a839f51ab9e78e866f1d3773b8466b011}{CKM\_SHA256\_HMAC}}:}
\DoxyCodeLine{01775\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a97ee18b73f21e8047fadc8a0aa12f23a}{CKM\_SHA384\_HMAC}}:}
\DoxyCodeLine{01776\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ae1b850f9141aa407e45b02fa3ade3759}{CKM\_SHA512\_HMAC}}:}
\DoxyCodeLine{01777\ \ \ \ \ \ \ \textcolor{comment}{//\ NOTE(adma):\ no\ hash\ required\ for\ these\ mechanisms}}
\DoxyCodeLine{01778\ \ \ \ \ \ \ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_af6e088c2d57f2582d353bec69b48c023}{sign}}.\mbox{\hyperlink{structsign__info_a575aca68f9e4dec0e3cc9de8bc560725}{md\_ctx}}\ =\ NULL;}
\DoxyCodeLine{01779\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}};}
\DoxyCodeLine{01780\ }
\DoxyCodeLine{01781\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a9b5d495ac404ebbce07d1f58436ee31d}{CKM\_SHA1\_RSA\_PKCS}}:}
\DoxyCodeLine{01782\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ad5943f11b67c32a40d4d6687e9cbb64b}{CKM\_SHA1\_RSA\_PKCS\_PSS}}:}
\DoxyCodeLine{01783\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a0911727b2cd926b9209f24bf50bc555a}{CKM\_ECDSA\_SHA1}}:}
\DoxyCodeLine{01784\ \ \ \ \ \ \ md\ =\ EVP\_sha1();}
\DoxyCodeLine{01785\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01786\ }
\DoxyCodeLine{01787\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ae24525658e8df0829c24236ee7614d1f}{CKM\_SHA256\_RSA\_PKCS}}:}
\DoxyCodeLine{01788\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ad336fbe2d222fc913c70dd56fabf7f7e}{CKM\_SHA256\_RSA\_PKCS\_PSS}}:}
\DoxyCodeLine{01789\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ac7f12f2ee83f0ca3b309b22e5b48e486}{CKM\_ECDSA\_SHA256}}:}
\DoxyCodeLine{01790\ \ \ \ \ \ \ md\ =\ EVP\_sha256();}
\DoxyCodeLine{01791\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01792\ }
\DoxyCodeLine{01793\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ad8d3d34082b7e18f4f173804cf5b959b}{CKM\_SHA384\_RSA\_PKCS}}:}
\DoxyCodeLine{01794\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ae5a8bfa905dc8dab5b2130a8bb6b23fb}{CKM\_SHA384\_RSA\_PKCS\_PSS}}:}
\DoxyCodeLine{01795\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ab4aaed0f4b4146b812c6cff25828fcfd}{CKM\_ECDSA\_SHA384}}:}
\DoxyCodeLine{01796\ \ \ \ \ \ \ md\ =\ EVP\_sha384();}
\DoxyCodeLine{01797\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01798\ }
\DoxyCodeLine{01799\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a6c0c89dfd22474095772f87d25c6a17d}{CKM\_SHA512\_RSA\_PKCS}}:}
\DoxyCodeLine{01800\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a67393bc84515cf68048ca3b3bb8b39a0}{CKM\_SHA512\_RSA\_PKCS\_PSS}}:}
\DoxyCodeLine{01801\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a69a7674eee1a8069128923037b504e59}{CKM\_ECDSA\_SHA512}}:}
\DoxyCodeLine{01802\ \ \ \ \ \ \ md\ =\ EVP\_sha512();}
\DoxyCodeLine{01803\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01804\ }
\DoxyCodeLine{01805\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{01806\ \ \ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a2e3ed21e5ffba18d940d164aaec64a2a}{DBG\_ERR}}(\textcolor{stringliteral}{"{}Mechanism\ \%lu\ not\ supported"{}},\ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a261664672f3ef63ab3a20b864627c49a}{mechanism}}.\mbox{\hyperlink{structmechanism_afeb8198b0f33f94f4520c0ffbc584a9a}{mechanism}});}
\DoxyCodeLine{01807\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a0664e99597a479c7fce5b19411cfc1b1}{CKR\_MECHANISM\_INVALID}};}
\DoxyCodeLine{01808\ \ \ \}}
\DoxyCodeLine{01809\ }
\DoxyCodeLine{01810\ \ \ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_af6e088c2d57f2582d353bec69b48c023}{sign}}.\mbox{\hyperlink{structsign__info_a575aca68f9e4dec0e3cc9de8bc560725}{md\_ctx}}\ =\ EVP\_MD\_CTX\_create();}
\DoxyCodeLine{01811\ }
\DoxyCodeLine{01812\ \ \ \textcolor{keywordflow}{if}\ (EVP\_DigestInit\_ex(op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_af6e088c2d57f2582d353bec69b48c023}{sign}}.\mbox{\hyperlink{structsign__info_a575aca68f9e4dec0e3cc9de8bc560725}{md\_ctx}},\ md,\ NULL)\ ==\ 0)\ \{}
\DoxyCodeLine{01813\ \ \ \ \ EVP\_MD\_CTX\_destroy(op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_af6e088c2d57f2582d353bec69b48c023}{sign}}.\mbox{\hyperlink{structsign__info_a575aca68f9e4dec0e3cc9de8bc560725}{md\_ctx}});}
\DoxyCodeLine{01814\ \ \ \ \ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_af6e088c2d57f2582d353bec69b48c023}{sign}}.\mbox{\hyperlink{structsign__info_a575aca68f9e4dec0e3cc9de8bc560725}{md\_ctx}}\ =\ NULL;}
\DoxyCodeLine{01815\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a91150ecacbaa624fcc7d861f1b54f57c}{CKR\_FUNCTION\_FAILED}};}
\DoxyCodeLine{01816\ \ \ \}}
\DoxyCodeLine{01817\ }
\DoxyCodeLine{01818\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}};}
\DoxyCodeLine{01819\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{util__pkcs11_8c_ace7396cb0c7b79d711f41031943387aa_cgraph}
\end{center}
\end{figure}
\Hypertarget{util__pkcs11_8c_a7f8862404103da790412c45be35b0087}\index{util\_pkcs11.c@{util\_pkcs11.c}!apply\_sign\_mechanism\_update@{apply\_sign\_mechanism\_update}}
\index{apply\_sign\_mechanism\_update@{apply\_sign\_mechanism\_update}!util\_pkcs11.c@{util\_pkcs11.c}}
\doxysubsubsection{\texorpdfstring{apply\_sign\_mechanism\_update()}{apply\_sign\_mechanism\_update()}}
{\footnotesize\ttfamily \label{util__pkcs11_8c_a7f8862404103da790412c45be35b0087} 
CK\+\_\+\+RV apply\+\_\+sign\+\_\+mechanism\+\_\+update (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__pkcs11__op__info}{yubihsm\+\_\+pkcs11\+\_\+op\+\_\+info}} \texorpdfstring{$\ast$}{*}}]{op\+\_\+info}{, }\item[{\mbox{\hyperlink{pkcs11_8h_a7bc6919a7c3c372056fa7e18343a0b37}{CK\+\_\+\+BYTE\+\_\+\+PTR}}}]{in}{, }\item[{\mbox{\hyperlink{pkcs11_8h_a35181858a3b7a0a81f49d180d8f446ef}{CK\+\_\+\+ULONG}}}]{in\+\_\+len}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{util__pkcs11_8c_source_l01943}{1943}} of file \mbox{\hyperlink{util__pkcs11_8c_source}{util\+\_\+pkcs11.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01944\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01945\ }
\DoxyCodeLine{01946\ \ \ \textcolor{keywordflow}{switch}\ (op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a261664672f3ef63ab3a20b864627c49a}{mechanism}}.\mbox{\hyperlink{structmechanism_afeb8198b0f33f94f4520c0ffbc584a9a}{mechanism}})\ \{}
\DoxyCodeLine{01947\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a08a8e0f2109de3ff3bfe26f220447a2e}{CKM\_RSA\_PKCS}}:}
\DoxyCodeLine{01948\ \ \ \ \ \ \ \textcolor{comment}{//\ NOTE(adma):\ Specs\ say\ there\ should\ be\ enough\ space\ for\ PKCS\#1\ padding}}
\DoxyCodeLine{01949\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ac226105a253c6fda70b44e14a525007a}{buffer\_length}}\ +\ \mbox{\hyperlink{yubihsm__pkcs11_8c_af352138fec1245efdaee143f770c01ef}{in\_len}}\ >}
\DoxyCodeLine{01950\ \ \ \ \ \ \ \ \ \ \ (op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_af6e088c2d57f2582d353bec69b48c023}{sign}}.\mbox{\hyperlink{structsign__info_afd7db6cf92f86b7cf17daf9eb3bcb8fc}{key\_len}}\ +\ 7)\ /\ 8\ -\/\ 11)\ \{}
\DoxyCodeLine{01951\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a9a521148fda788ca98f4fdbb6d3b9438}{CKR\_DATA\_LEN\_RANGE}};}
\DoxyCodeLine{01952\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01953\ }
\DoxyCodeLine{01954\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ad4fd174ba5f77aad7e1f1c66079529ba}{buffer}}\ +\ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ac226105a253c6fda70b44e14a525007a}{buffer\_length}},\ in,\ \mbox{\hyperlink{yubihsm__pkcs11_8c_af352138fec1245efdaee143f770c01ef}{in\_len}});}
\DoxyCodeLine{01955\ \ \ \ \ \ \ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ac226105a253c6fda70b44e14a525007a}{buffer\_length}}\ +=\ \mbox{\hyperlink{yubihsm__pkcs11_8c_af352138fec1245efdaee143f770c01ef}{in\_len}};}
\DoxyCodeLine{01956\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01957\ }
\DoxyCodeLine{01958\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ab4a7299a144f0ef52cee06893cc60483}{CKM\_ECDSA}}:}
\DoxyCodeLine{01959\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ac226105a253c6fda70b44e14a525007a}{buffer\_length}}\ +\ \mbox{\hyperlink{yubihsm__pkcs11_8c_af352138fec1245efdaee143f770c01ef}{in\_len}}\ >\ 128)\ \{}
\DoxyCodeLine{01960\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ NOTE(adma):\ Specs\ say\ ECDSA\ only\ supports\ data\ up\ to\ 1024\ bit}}
\DoxyCodeLine{01961\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a9a521148fda788ca98f4fdbb6d3b9438}{CKR\_DATA\_LEN\_RANGE}};}
\DoxyCodeLine{01962\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01963\ }
\DoxyCodeLine{01964\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ad4fd174ba5f77aad7e1f1c66079529ba}{buffer}}\ +\ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ac226105a253c6fda70b44e14a525007a}{buffer\_length}},\ in,\ \mbox{\hyperlink{yubihsm__pkcs11_8c_af352138fec1245efdaee143f770c01ef}{in\_len}});}
\DoxyCodeLine{01965\ \ \ \ \ \ \ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ac226105a253c6fda70b44e14a525007a}{buffer\_length}}\ +=\ \mbox{\hyperlink{yubihsm__pkcs11_8c_af352138fec1245efdaee143f770c01ef}{in\_len}};}
\DoxyCodeLine{01966\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01967\ }
\DoxyCodeLine{01968\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ad4f5697408b23623c904df2b1ca8a9f1}{CKM\_RSA\_PKCS\_PSS}}:}
\DoxyCodeLine{01969\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a1eb3f4cee46e624bfbbc6889e1e5bc06}{CKM\_SHA\_1\_HMAC}}:}
\DoxyCodeLine{01970\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a839f51ab9e78e866f1d3773b8466b011}{CKM\_SHA256\_HMAC}}:}
\DoxyCodeLine{01971\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a97ee18b73f21e8047fadc8a0aa12f23a}{CKM\_SHA384\_HMAC}}:}
\DoxyCodeLine{01972\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ae1b850f9141aa407e45b02fa3ade3759}{CKM\_SHA512\_HMAC}}:}
\DoxyCodeLine{01973\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ac226105a253c6fda70b44e14a525007a}{buffer\_length}}\ +\ \mbox{\hyperlink{yubihsm__pkcs11_8c_af352138fec1245efdaee143f770c01ef}{in\_len}}\ >\ \textcolor{keyword}{sizeof}(op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ad4fd174ba5f77aad7e1f1c66079529ba}{buffer}}))\ \{}
\DoxyCodeLine{01974\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a9a521148fda788ca98f4fdbb6d3b9438}{CKR\_DATA\_LEN\_RANGE}};}
\DoxyCodeLine{01975\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01976\ }
\DoxyCodeLine{01977\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ad4fd174ba5f77aad7e1f1c66079529ba}{buffer}}\ +\ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ac226105a253c6fda70b44e14a525007a}{buffer\_length}},\ in,\ \mbox{\hyperlink{yubihsm__pkcs11_8c_af352138fec1245efdaee143f770c01ef}{in\_len}});}
\DoxyCodeLine{01978\ \ \ \ \ \ \ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ac226105a253c6fda70b44e14a525007a}{buffer\_length}}\ +=\ \mbox{\hyperlink{yubihsm__pkcs11_8c_af352138fec1245efdaee143f770c01ef}{in\_len}};}
\DoxyCodeLine{01979\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01980\ }
\DoxyCodeLine{01981\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a9b5d495ac404ebbce07d1f58436ee31d}{CKM\_SHA1\_RSA\_PKCS}}:}
\DoxyCodeLine{01982\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ae24525658e8df0829c24236ee7614d1f}{CKM\_SHA256\_RSA\_PKCS}}:}
\DoxyCodeLine{01983\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ad8d3d34082b7e18f4f173804cf5b959b}{CKM\_SHA384\_RSA\_PKCS}}:}
\DoxyCodeLine{01984\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a6c0c89dfd22474095772f87d25c6a17d}{CKM\_SHA512\_RSA\_PKCS}}:}
\DoxyCodeLine{01985\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ad5943f11b67c32a40d4d6687e9cbb64b}{CKM\_SHA1\_RSA\_PKCS\_PSS}}:}
\DoxyCodeLine{01986\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ad336fbe2d222fc913c70dd56fabf7f7e}{CKM\_SHA256\_RSA\_PKCS\_PSS}}:}
\DoxyCodeLine{01987\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ae5a8bfa905dc8dab5b2130a8bb6b23fb}{CKM\_SHA384\_RSA\_PKCS\_PSS}}:}
\DoxyCodeLine{01988\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a67393bc84515cf68048ca3b3bb8b39a0}{CKM\_SHA512\_RSA\_PKCS\_PSS}}:}
\DoxyCodeLine{01989\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a0911727b2cd926b9209f24bf50bc555a}{CKM\_ECDSA\_SHA1}}:}
\DoxyCodeLine{01990\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ac7f12f2ee83f0ca3b309b22e5b48e486}{CKM\_ECDSA\_SHA256}}:}
\DoxyCodeLine{01991\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ab4aaed0f4b4146b812c6cff25828fcfd}{CKM\_ECDSA\_SHA384}}:}
\DoxyCodeLine{01992\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a69a7674eee1a8069128923037b504e59}{CKM\_ECDSA\_SHA512}}:}
\DoxyCodeLine{01993\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (EVP\_DigestUpdate(op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_af6e088c2d57f2582d353bec69b48c023}{sign}}.\mbox{\hyperlink{structsign__info_a575aca68f9e4dec0e3cc9de8bc560725}{md\_ctx}},\ in,\ \mbox{\hyperlink{yubihsm__pkcs11_8c_af352138fec1245efdaee143f770c01ef}{in\_len}})\ !=\ 1)\ \{}
\DoxyCodeLine{01994\ \ \ \ \ \ \ \ \ EVP\_MD\_CTX\_destroy(op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_af6e088c2d57f2582d353bec69b48c023}{sign}}.\mbox{\hyperlink{structsign__info_a575aca68f9e4dec0e3cc9de8bc560725}{md\_ctx}});}
\DoxyCodeLine{01995\ \ \ \ \ \ \ \ \ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_af6e088c2d57f2582d353bec69b48c023}{sign}}.\mbox{\hyperlink{structsign__info_a575aca68f9e4dec0e3cc9de8bc560725}{md\_ctx}}\ =\ NULL;}
\DoxyCodeLine{01996\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a91150ecacbaa624fcc7d861f1b54f57c}{CKR\_FUNCTION\_FAILED}};}
\DoxyCodeLine{01997\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01998\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01999\ }
\DoxyCodeLine{02000\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{02001\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a91150ecacbaa624fcc7d861f1b54f57c}{CKR\_FUNCTION\_FAILED}};}
\DoxyCodeLine{02002\ \ \ \}}
\DoxyCodeLine{02003\ }
\DoxyCodeLine{02004\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}};}
\DoxyCodeLine{02005\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{util__pkcs11_8c_a7f8862404103da790412c45be35b0087_cgraph}
\end{center}
\end{figure}
\Hypertarget{util__pkcs11_8c_a138a4c041c2fbb12771cf392f72d6188}\index{util\_pkcs11.c@{util\_pkcs11.c}!apply\_verify\_mechanism\_finalize@{apply\_verify\_mechanism\_finalize}}
\index{apply\_verify\_mechanism\_finalize@{apply\_verify\_mechanism\_finalize}!util\_pkcs11.c@{util\_pkcs11.c}}
\doxysubsubsection{\texorpdfstring{apply\_verify\_mechanism\_finalize()}{apply\_verify\_mechanism\_finalize()}}
{\footnotesize\ttfamily \label{util__pkcs11_8c_a138a4c041c2fbb12771cf392f72d6188} 
CK\+\_\+\+RV apply\+\_\+verify\+\_\+mechanism\+\_\+finalize (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__pkcs11__op__info}{yubihsm\+\_\+pkcs11\+\_\+op\+\_\+info}} \texorpdfstring{$\ast$}{*}op\+\_\+info }]{\+\_\+\+\_\+attribute}{(unused)}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{util__pkcs11_8c_source_l02150}{2150}} of file \mbox{\hyperlink{util__pkcs11_8c_source}{util\+\_\+pkcs11.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02151\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02152\ }
\DoxyCodeLine{02153\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}};}
\DoxyCodeLine{02154\ \}}

\end{DoxyCode}
\Hypertarget{util__pkcs11_8c_a2e8c2b6402f7944b9684ad16a8ab7f66}\index{util\_pkcs11.c@{util\_pkcs11.c}!apply\_verify\_mechanism\_init@{apply\_verify\_mechanism\_init}}
\index{apply\_verify\_mechanism\_init@{apply\_verify\_mechanism\_init}!util\_pkcs11.c@{util\_pkcs11.c}}
\doxysubsubsection{\texorpdfstring{apply\_verify\_mechanism\_init()}{apply\_verify\_mechanism\_init()}}
{\footnotesize\ttfamily \label{util__pkcs11_8c_a2e8c2b6402f7944b9684ad16a8ab7f66} 
CK\+\_\+\+RV apply\+\_\+verify\+\_\+mechanism\+\_\+init (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__pkcs11__op__info}{yubihsm\+\_\+pkcs11\+\_\+op\+\_\+info}} \texorpdfstring{$\ast$}{*}}]{op\+\_\+info}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{util__pkcs11_8c_source_l01821}{1821}} of file \mbox{\hyperlink{util__pkcs11_8c_source}{util\+\_\+pkcs11.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01821\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01822\ }
\DoxyCodeLine{01823\ \ \ \textcolor{keyword}{const}\ EVP\_MD\ *md\ =\ NULL;}
\DoxyCodeLine{01824\ }
\DoxyCodeLine{01825\ \ \ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ac226105a253c6fda70b44e14a525007a}{buffer\_length}}\ =\ 0;}
\DoxyCodeLine{01826\ \ \ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_a769d855aca7e13b69c58abd1de1bb410}{verify}}.\mbox{\hyperlink{structverify__info_a69841d9be2ea9074f4a8dd3972c532cf}{padding}}\ =\ 0;}
\DoxyCodeLine{01827\ \ \ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_a769d855aca7e13b69c58abd1de1bb410}{verify}}.\mbox{\hyperlink{structverify__info_a8e050dd7549467897d666046c1754aaf}{saltLen}}\ =\ 0;}
\DoxyCodeLine{01828\ \ \ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_a769d855aca7e13b69c58abd1de1bb410}{verify}}.\mbox{\hyperlink{structverify__info_ae1b2e1bec7e3c36d68558b61401cf5df}{mgf1md}}\ =\ NULL;}
\DoxyCodeLine{01829\ \ \ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_a769d855aca7e13b69c58abd1de1bb410}{verify}}.\mbox{\hyperlink{structverify__info_a9547582fc2ac4625f9029f6d285bdb68}{md}}\ =\ NULL;}
\DoxyCodeLine{01830\ \ \ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_a769d855aca7e13b69c58abd1de1bb410}{verify}}.\mbox{\hyperlink{structverify__info_a920d34cab9f1b9ddcaf849d5b08c921d}{md\_ctx}}\ =\ NULL;}
\DoxyCodeLine{01831\ }
\DoxyCodeLine{01832\ \ \ \textcolor{keywordflow}{switch}\ (op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a261664672f3ef63ab3a20b864627c49a}{mechanism}}.\mbox{\hyperlink{structmechanism_afeb8198b0f33f94f4520c0ffbc584a9a}{mechanism}})\ \{}
\DoxyCodeLine{01833\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a08a8e0f2109de3ff3bfe26f220447a2e}{CKM\_RSA\_PKCS}}:}
\DoxyCodeLine{01834\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ad4f5697408b23623c904df2b1ca8a9f1}{CKM\_RSA\_PKCS\_PSS}}:}
\DoxyCodeLine{01835\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ab4a7299a144f0ef52cee06893cc60483}{CKM\_ECDSA}}:}
\DoxyCodeLine{01836\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a1eb3f4cee46e624bfbbc6889e1e5bc06}{CKM\_SHA\_1\_HMAC}}:}
\DoxyCodeLine{01837\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a839f51ab9e78e866f1d3773b8466b011}{CKM\_SHA256\_HMAC}}:}
\DoxyCodeLine{01838\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a97ee18b73f21e8047fadc8a0aa12f23a}{CKM\_SHA384\_HMAC}}:}
\DoxyCodeLine{01839\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ae1b850f9141aa407e45b02fa3ade3759}{CKM\_SHA512\_HMAC}}:}
\DoxyCodeLine{01840\ \ \ \ \ \ \ \textcolor{comment}{//\ NOTE(adma):\ no\ hash\ required\ for\ these\ mechanisms}}
\DoxyCodeLine{01841\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}};}
\DoxyCodeLine{01842\ }
\DoxyCodeLine{01843\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a9b5d495ac404ebbce07d1f58436ee31d}{CKM\_SHA1\_RSA\_PKCS}}:}
\DoxyCodeLine{01844\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ad5943f11b67c32a40d4d6687e9cbb64b}{CKM\_SHA1\_RSA\_PKCS\_PSS}}:}
\DoxyCodeLine{01845\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a0911727b2cd926b9209f24bf50bc555a}{CKM\_ECDSA\_SHA1}}:}
\DoxyCodeLine{01846\ \ \ \ \ \ \ md\ =\ EVP\_sha1();}
\DoxyCodeLine{01847\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01848\ }
\DoxyCodeLine{01849\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ae24525658e8df0829c24236ee7614d1f}{CKM\_SHA256\_RSA\_PKCS}}:}
\DoxyCodeLine{01850\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ad336fbe2d222fc913c70dd56fabf7f7e}{CKM\_SHA256\_RSA\_PKCS\_PSS}}:}
\DoxyCodeLine{01851\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ac7f12f2ee83f0ca3b309b22e5b48e486}{CKM\_ECDSA\_SHA256}}:}
\DoxyCodeLine{01852\ \ \ \ \ \ \ md\ =\ EVP\_sha256();}
\DoxyCodeLine{01853\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01854\ }
\DoxyCodeLine{01855\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ad8d3d34082b7e18f4f173804cf5b959b}{CKM\_SHA384\_RSA\_PKCS}}:}
\DoxyCodeLine{01856\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ae5a8bfa905dc8dab5b2130a8bb6b23fb}{CKM\_SHA384\_RSA\_PKCS\_PSS}}:}
\DoxyCodeLine{01857\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ab4aaed0f4b4146b812c6cff25828fcfd}{CKM\_ECDSA\_SHA384}}:}
\DoxyCodeLine{01858\ \ \ \ \ \ \ md\ =\ EVP\_sha384();}
\DoxyCodeLine{01859\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01860\ }
\DoxyCodeLine{01861\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a6c0c89dfd22474095772f87d25c6a17d}{CKM\_SHA512\_RSA\_PKCS}}:}
\DoxyCodeLine{01862\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a67393bc84515cf68048ca3b3bb8b39a0}{CKM\_SHA512\_RSA\_PKCS\_PSS}}:}
\DoxyCodeLine{01863\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a69a7674eee1a8069128923037b504e59}{CKM\_ECDSA\_SHA512}}:}
\DoxyCodeLine{01864\ \ \ \ \ \ \ md\ =\ EVP\_sha512();}
\DoxyCodeLine{01865\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01866\ }
\DoxyCodeLine{01867\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{01868\ \ \ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a2e3ed21e5ffba18d940d164aaec64a2a}{DBG\_ERR}}(\textcolor{stringliteral}{"{}Mechanism\ \%lu\ not\ supported"{}},\ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a261664672f3ef63ab3a20b864627c49a}{mechanism}}.\mbox{\hyperlink{structmechanism_afeb8198b0f33f94f4520c0ffbc584a9a}{mechanism}});}
\DoxyCodeLine{01869\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a0664e99597a479c7fce5b19411cfc1b1}{CKR\_MECHANISM\_INVALID}};}
\DoxyCodeLine{01870\ \ \ \}}
\DoxyCodeLine{01871\ }
\DoxyCodeLine{01872\ \ \ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_a769d855aca7e13b69c58abd1de1bb410}{verify}}.\mbox{\hyperlink{structverify__info_a9547582fc2ac4625f9029f6d285bdb68}{md}}\ =\ md;}
\DoxyCodeLine{01873\ \ \ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_a769d855aca7e13b69c58abd1de1bb410}{verify}}.\mbox{\hyperlink{structverify__info_a920d34cab9f1b9ddcaf849d5b08c921d}{md\_ctx}}\ =\ EVP\_MD\_CTX\_create();}
\DoxyCodeLine{01874\ \ \ \textcolor{keywordflow}{if}\ (op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_a769d855aca7e13b69c58abd1de1bb410}{verify}}.\mbox{\hyperlink{structverify__info_a920d34cab9f1b9ddcaf849d5b08c921d}{md\_ctx}}\ ==\ NULL)\ \{}
\DoxyCodeLine{01875\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a91150ecacbaa624fcc7d861f1b54f57c}{CKR\_FUNCTION\_FAILED}};}
\DoxyCodeLine{01876\ \ \ \}}
\DoxyCodeLine{01877\ \ \ \textcolor{keywordflow}{if}\ (EVP\_DigestInit(op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_a769d855aca7e13b69c58abd1de1bb410}{verify}}.\mbox{\hyperlink{structverify__info_a920d34cab9f1b9ddcaf849d5b08c921d}{md\_ctx}},\ md)\ ==\ 0)\ \{}
\DoxyCodeLine{01878\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a91150ecacbaa624fcc7d861f1b54f57c}{CKR\_FUNCTION\_FAILED}};}
\DoxyCodeLine{01879\ \ \ \}}
\DoxyCodeLine{01880\ }
\DoxyCodeLine{01881\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}};}
\DoxyCodeLine{01882\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{util__pkcs11_8c_a2e8c2b6402f7944b9684ad16a8ab7f66_cgraph}
\end{center}
\end{figure}
\Hypertarget{util__pkcs11_8c_ad4fbb6f5ecdd69ce7a332f613a89a9a7}\index{util\_pkcs11.c@{util\_pkcs11.c}!apply\_verify\_mechanism\_update@{apply\_verify\_mechanism\_update}}
\index{apply\_verify\_mechanism\_update@{apply\_verify\_mechanism\_update}!util\_pkcs11.c@{util\_pkcs11.c}}
\doxysubsubsection{\texorpdfstring{apply\_verify\_mechanism\_update()}{apply\_verify\_mechanism\_update()}}
{\footnotesize\ttfamily \label{util__pkcs11_8c_ad4fbb6f5ecdd69ce7a332f613a89a9a7} 
CK\+\_\+\+RV apply\+\_\+verify\+\_\+mechanism\+\_\+update (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__pkcs11__op__info}{yubihsm\+\_\+pkcs11\+\_\+op\+\_\+info}} \texorpdfstring{$\ast$}{*}}]{op\+\_\+info}{, }\item[{\mbox{\hyperlink{pkcs11_8h_a7bc6919a7c3c372056fa7e18343a0b37}{CK\+\_\+\+BYTE\+\_\+\+PTR}}}]{in}{, }\item[{\mbox{\hyperlink{pkcs11_8h_a35181858a3b7a0a81f49d180d8f446ef}{CK\+\_\+\+ULONG}}}]{in\+\_\+len}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{util__pkcs11_8c_source_l02007}{2007}} of file \mbox{\hyperlink{util__pkcs11_8c_source}{util\+\_\+pkcs11.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02008\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02009\ }
\DoxyCodeLine{02010\ \ \ \textcolor{keywordflow}{switch}\ (op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a261664672f3ef63ab3a20b864627c49a}{mechanism}}.\mbox{\hyperlink{structmechanism_afeb8198b0f33f94f4520c0ffbc584a9a}{mechanism}})\ \{}
\DoxyCodeLine{02011\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a1eb3f4cee46e624bfbbc6889e1e5bc06}{CKM\_SHA\_1\_HMAC}}:}
\DoxyCodeLine{02012\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a839f51ab9e78e866f1d3773b8466b011}{CKM\_SHA256\_HMAC}}:}
\DoxyCodeLine{02013\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a97ee18b73f21e8047fadc8a0aa12f23a}{CKM\_SHA384\_HMAC}}:}
\DoxyCodeLine{02014\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ae1b850f9141aa407e45b02fa3ade3759}{CKM\_SHA512\_HMAC}}:}
\DoxyCodeLine{02015\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a08a8e0f2109de3ff3bfe26f220447a2e}{CKM\_RSA\_PKCS}}:}
\DoxyCodeLine{02016\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ad4f5697408b23623c904df2b1ca8a9f1}{CKM\_RSA\_PKCS\_PSS}}:}
\DoxyCodeLine{02017\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ab4a7299a144f0ef52cee06893cc60483}{CKM\_ECDSA}}:}
\DoxyCodeLine{02018\ \ \ \ \ \ \ \textcolor{comment}{//\ NOTE(adma):\ no\ hash\ required\ for\ these\ mechanisms}}
\DoxyCodeLine{02019\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ac226105a253c6fda70b44e14a525007a}{buffer\_length}}\ +\ \mbox{\hyperlink{yubihsm__pkcs11_8c_af352138fec1245efdaee143f770c01ef}{in\_len}}\ >\ \textcolor{keyword}{sizeof}(op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ad4fd174ba5f77aad7e1f1c66079529ba}{buffer}}))\ \{}
\DoxyCodeLine{02020\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a9a521148fda788ca98f4fdbb6d3b9438}{CKR\_DATA\_LEN\_RANGE}};}
\DoxyCodeLine{02021\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02022\ }
\DoxyCodeLine{02023\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ad4fd174ba5f77aad7e1f1c66079529ba}{buffer}}\ +\ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ac226105a253c6fda70b44e14a525007a}{buffer\_length}},\ in,\ \mbox{\hyperlink{yubihsm__pkcs11_8c_af352138fec1245efdaee143f770c01ef}{in\_len}});}
\DoxyCodeLine{02024\ \ \ \ \ \ \ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ac226105a253c6fda70b44e14a525007a}{buffer\_length}}\ +=\ \mbox{\hyperlink{yubihsm__pkcs11_8c_af352138fec1245efdaee143f770c01ef}{in\_len}};}
\DoxyCodeLine{02025\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02026\ }
\DoxyCodeLine{02027\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a9b5d495ac404ebbce07d1f58436ee31d}{CKM\_SHA1\_RSA\_PKCS}}:}
\DoxyCodeLine{02028\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ad5943f11b67c32a40d4d6687e9cbb64b}{CKM\_SHA1\_RSA\_PKCS\_PSS}}:}
\DoxyCodeLine{02029\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a0911727b2cd926b9209f24bf50bc555a}{CKM\_ECDSA\_SHA1}}:}
\DoxyCodeLine{02030\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ae24525658e8df0829c24236ee7614d1f}{CKM\_SHA256\_RSA\_PKCS}}:}
\DoxyCodeLine{02031\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ad336fbe2d222fc913c70dd56fabf7f7e}{CKM\_SHA256\_RSA\_PKCS\_PSS}}:}
\DoxyCodeLine{02032\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ac7f12f2ee83f0ca3b309b22e5b48e486}{CKM\_ECDSA\_SHA256}}:}
\DoxyCodeLine{02033\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ad8d3d34082b7e18f4f173804cf5b959b}{CKM\_SHA384\_RSA\_PKCS}}:}
\DoxyCodeLine{02034\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ae5a8bfa905dc8dab5b2130a8bb6b23fb}{CKM\_SHA384\_RSA\_PKCS\_PSS}}:}
\DoxyCodeLine{02035\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ab4aaed0f4b4146b812c6cff25828fcfd}{CKM\_ECDSA\_SHA384}}:}
\DoxyCodeLine{02036\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a6c0c89dfd22474095772f87d25c6a17d}{CKM\_SHA512\_RSA\_PKCS}}:}
\DoxyCodeLine{02037\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a67393bc84515cf68048ca3b3bb8b39a0}{CKM\_SHA512\_RSA\_PKCS\_PSS}}:}
\DoxyCodeLine{02038\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a69a7674eee1a8069128923037b504e59}{CKM\_ECDSA\_SHA512}}:}
\DoxyCodeLine{02039\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (EVP\_DigestUpdate(op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_a769d855aca7e13b69c58abd1de1bb410}{verify}}.\mbox{\hyperlink{structverify__info_a920d34cab9f1b9ddcaf849d5b08c921d}{md\_ctx}},\ in,\ \mbox{\hyperlink{yubihsm__pkcs11_8c_af352138fec1245efdaee143f770c01ef}{in\_len}})\ !=\ 1)\ \{}
\DoxyCodeLine{02040\ \ \ \ \ \ \ \ \ EVP\_MD\_CTX\_destroy(op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_a769d855aca7e13b69c58abd1de1bb410}{verify}}.\mbox{\hyperlink{structverify__info_a920d34cab9f1b9ddcaf849d5b08c921d}{md\_ctx}});}
\DoxyCodeLine{02041\ \ \ \ \ \ \ \ \ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_af6e088c2d57f2582d353bec69b48c023}{sign}}.\mbox{\hyperlink{structsign__info_a575aca68f9e4dec0e3cc9de8bc560725}{md\_ctx}}\ =\ NULL;}
\DoxyCodeLine{02042\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a91150ecacbaa624fcc7d861f1b54f57c}{CKR\_FUNCTION\_FAILED}};}
\DoxyCodeLine{02043\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02044\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02045\ }
\DoxyCodeLine{02046\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{02047\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a91150ecacbaa624fcc7d861f1b54f57c}{CKR\_FUNCTION\_FAILED}};}
\DoxyCodeLine{02048\ \ \ \}}
\DoxyCodeLine{02049\ }
\DoxyCodeLine{02050\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}};}
\DoxyCodeLine{02051\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{util__pkcs11_8c_ad4fbb6f5ecdd69ce7a332f613a89a9a7_cgraph}
\end{center}
\end{figure}
\Hypertarget{util__pkcs11_8c_a5ce40fa3ee245e65d99ee4cec7a1dd0c}\index{util\_pkcs11.c@{util\_pkcs11.c}!check\_decrypt\_mechanism@{check\_decrypt\_mechanism}}
\index{check\_decrypt\_mechanism@{check\_decrypt\_mechanism}!util\_pkcs11.c@{util\_pkcs11.c}}
\doxysubsubsection{\texorpdfstring{check\_decrypt\_mechanism()}{check\_decrypt\_mechanism()}}
{\footnotesize\ttfamily \label{util__pkcs11_8c_a5ce40fa3ee245e65d99ee4cec7a1dd0c} 
bool check\+\_\+decrypt\+\_\+mechanism (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__pkcs11__slot}{yubihsm\+\_\+pkcs11\+\_\+slot}} \texorpdfstring{$\ast$}{*}}]{slot}{, }\item[{\mbox{\hyperlink{pkcs11_8h_ab943ac89d1b0f6f3631d3361da0d52a1}{CK\+\_\+\+MECHANISM\+\_\+\+PTR}}}]{p\+Mechanism}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{util__pkcs11_8c_source_l01678}{1678}} of file \mbox{\hyperlink{util__pkcs11_8c_source}{util\+\_\+pkcs11.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01679\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01680\ }
\DoxyCodeLine{01681\ \ \ CK\_MECHANISM\_TYPE\ mechanisms[128];}
\DoxyCodeLine{01682\ \ \ \mbox{\hyperlink{pkcs11_8h_a35181858a3b7a0a81f49d180d8f446ef}{CK\_ULONG}}\ \mbox{\hyperlink{gmock__stress__test_8cc_afd9db40e3361ae09188795e8cbe19752}{count}}\ =\ 128;}
\DoxyCodeLine{01683\ }
\DoxyCodeLine{01684\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{util__pkcs11_8c_a8a3a4cd4d71d1a0489be171682cb9ece}{is\_RSA\_decrypt\_mechanism}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_ab0dca4e7a2bfa74ab9cae5b8c1995647}{pMechanism}}-\/>\mbox{\hyperlink{structck__mechanism_a01c48c2e7afe52b7b1acfa9c2e6fe030}{mechanism}})\ ==\ \textcolor{keyword}{false}\ \&\&}
\DoxyCodeLine{01685\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ab0dca4e7a2bfa74ab9cae5b8c1995647}{pMechanism}}-\/>\mbox{\hyperlink{structck__mechanism_a01c48c2e7afe52b7b1acfa9c2e6fe030}{mechanism}}\ !=\ \mbox{\hyperlink{pkcs11y_8h_a631efbda997696a7f7ce71df0e3e779a}{CKM\_YUBICO\_AES\_CCM\_WRAP}})\ \{}
\DoxyCodeLine{01686\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01687\ \ \ \}}
\DoxyCodeLine{01688\ }
\DoxyCodeLine{01689\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{util__pkcs11_8c_a064731f36eb972f687b4059dc5f340db}{get\_mechanism\_list}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}},\ mechanisms,\ \&\mbox{\hyperlink{gmock__stress__test_8cc_afd9db40e3361ae09188795e8cbe19752}{count}})\ !=\ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}})\ \{}
\DoxyCodeLine{01690\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01691\ \ \ \}}
\DoxyCodeLine{01692\ }
\DoxyCodeLine{01693\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{pkcs11_8h_a35181858a3b7a0a81f49d180d8f446ef}{CK\_ULONG}}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{gmock__stress__test_8cc_afd9db40e3361ae09188795e8cbe19752}{count}};\ i++)\ \{}
\DoxyCodeLine{01694\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_ab0dca4e7a2bfa74ab9cae5b8c1995647}{pMechanism}}-\/>\mbox{\hyperlink{structck__mechanism_a01c48c2e7afe52b7b1acfa9c2e6fe030}{mechanism}}\ ==\ mechanisms[i])\ \{}
\DoxyCodeLine{01695\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01696\ \ \ \ \ \}}
\DoxyCodeLine{01697\ \ \ \}}
\DoxyCodeLine{01698\ }
\DoxyCodeLine{01699\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01700\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{util__pkcs11_8c_a5ce40fa3ee245e65d99ee4cec7a1dd0c_cgraph}
\end{center}
\end{figure}
\Hypertarget{util__pkcs11_8c_a61664b3bfbd62e9ac2da4ed66be23dbc}\index{util\_pkcs11.c@{util\_pkcs11.c}!check\_digest\_mechanism@{check\_digest\_mechanism}}
\index{check\_digest\_mechanism@{check\_digest\_mechanism}!util\_pkcs11.c@{util\_pkcs11.c}}
\doxysubsubsection{\texorpdfstring{check\_digest\_mechanism()}{check\_digest\_mechanism()}}
{\footnotesize\ttfamily \label{util__pkcs11_8c_a61664b3bfbd62e9ac2da4ed66be23dbc} 
bool check\+\_\+digest\+\_\+mechanism (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{pkcs11_8h_ab943ac89d1b0f6f3631d3361da0d52a1}{CK\+\_\+\+MECHANISM\+\_\+\+PTR}}}]{p\+Mechanism}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{util__pkcs11_8c_source_l01725}{1725}} of file \mbox{\hyperlink{util__pkcs11_8c_source}{util\+\_\+pkcs11.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01725\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01726\ }
\DoxyCodeLine{01727\ \ \ \textcolor{keywordflow}{switch}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_ab0dca4e7a2bfa74ab9cae5b8c1995647}{pMechanism}}-\/>\mbox{\hyperlink{structck__mechanism_a01c48c2e7afe52b7b1acfa9c2e6fe030}{mechanism}})\ \{}
\DoxyCodeLine{01728\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_af1818a1c453a84f01f2e868307ca8fed}{CKM\_SHA\_1}}:}
\DoxyCodeLine{01729\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a4d11f88ae3bea2f748f275c03b54a648}{CKM\_SHA256}}:}
\DoxyCodeLine{01730\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a9278e01971ca83cdd07e4b8e07a00bc8}{CKM\_SHA384}}:}
\DoxyCodeLine{01731\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a9bf4bf7375a24e1010cc8e0139608fd5}{CKM\_SHA512}}:}
\DoxyCodeLine{01732\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01733\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{01734\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01735\ \ \ \}}
\DoxyCodeLine{01736\ }
\DoxyCodeLine{01737\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01738\ \}}

\end{DoxyCode}
\Hypertarget{util__pkcs11_8c_a1a99061c5c316d6427b27f8d506338bf}\index{util\_pkcs11.c@{util\_pkcs11.c}!check\_encrypt\_mechanism@{check\_encrypt\_mechanism}}
\index{check\_encrypt\_mechanism@{check\_encrypt\_mechanism}!util\_pkcs11.c@{util\_pkcs11.c}}
\doxysubsubsection{\texorpdfstring{check\_encrypt\_mechanism()}{check\_encrypt\_mechanism()}}
{\footnotesize\ttfamily \label{util__pkcs11_8c_a1a99061c5c316d6427b27f8d506338bf} 
bool check\+\_\+encrypt\+\_\+mechanism (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__pkcs11__slot}{yubihsm\+\_\+pkcs11\+\_\+slot}} \texorpdfstring{$\ast$}{*}}]{slot}{, }\item[{\mbox{\hyperlink{pkcs11_8h_ab943ac89d1b0f6f3631d3361da0d52a1}{CK\+\_\+\+MECHANISM\+\_\+\+PTR}}}]{p\+Mechanism}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{util__pkcs11_8c_source_l01702}{1702}} of file \mbox{\hyperlink{util__pkcs11_8c_source}{util\+\_\+pkcs11.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01703\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01704\ }
\DoxyCodeLine{01705\ \ \ CK\_MECHANISM\_TYPE\ mechanisms[128];}
\DoxyCodeLine{01706\ \ \ \mbox{\hyperlink{pkcs11_8h_a35181858a3b7a0a81f49d180d8f446ef}{CK\_ULONG}}\ \mbox{\hyperlink{gmock__stress__test_8cc_afd9db40e3361ae09188795e8cbe19752}{count}}\ =\ 128;}
\DoxyCodeLine{01707\ }
\DoxyCodeLine{01708\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_ab0dca4e7a2bfa74ab9cae5b8c1995647}{pMechanism}}-\/>\mbox{\hyperlink{structck__mechanism_a01c48c2e7afe52b7b1acfa9c2e6fe030}{mechanism}}\ !=\ \mbox{\hyperlink{pkcs11y_8h_a631efbda997696a7f7ce71df0e3e779a}{CKM\_YUBICO\_AES\_CCM\_WRAP}})\ \{}
\DoxyCodeLine{01709\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01710\ \ \ \}}
\DoxyCodeLine{01711\ }
\DoxyCodeLine{01712\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{util__pkcs11_8c_a064731f36eb972f687b4059dc5f340db}{get\_mechanism\_list}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}},\ mechanisms,\ \&\mbox{\hyperlink{gmock__stress__test_8cc_afd9db40e3361ae09188795e8cbe19752}{count}})\ !=\ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}})\ \{}
\DoxyCodeLine{01713\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01714\ \ \ \}}
\DoxyCodeLine{01715\ }
\DoxyCodeLine{01716\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{pkcs11_8h_a35181858a3b7a0a81f49d180d8f446ef}{CK\_ULONG}}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{gmock__stress__test_8cc_afd9db40e3361ae09188795e8cbe19752}{count}};\ i++)\ \{}
\DoxyCodeLine{01717\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_ab0dca4e7a2bfa74ab9cae5b8c1995647}{pMechanism}}-\/>\mbox{\hyperlink{structck__mechanism_a01c48c2e7afe52b7b1acfa9c2e6fe030}{mechanism}}\ ==\ mechanisms[i])\ \{}
\DoxyCodeLine{01718\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01719\ \ \ \ \ \}}
\DoxyCodeLine{01720\ \ \ \}}
\DoxyCodeLine{01721\ }
\DoxyCodeLine{01722\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01723\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{util__pkcs11_8c_a1a99061c5c316d6427b27f8d506338bf_cgraph}
\end{center}
\end{figure}
\Hypertarget{util__pkcs11_8c_ae8ed437178cb69b0fed6916747368344}\index{util\_pkcs11.c@{util\_pkcs11.c}!check\_sign\_mechanism@{check\_sign\_mechanism}}
\index{check\_sign\_mechanism@{check\_sign\_mechanism}!util\_pkcs11.c@{util\_pkcs11.c}}
\doxysubsubsection{\texorpdfstring{check\_sign\_mechanism()}{check\_sign\_mechanism()}}
{\footnotesize\ttfamily \label{util__pkcs11_8c_ae8ed437178cb69b0fed6916747368344} 
bool check\+\_\+sign\+\_\+mechanism (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__pkcs11__slot}{yubihsm\+\_\+pkcs11\+\_\+slot}} \texorpdfstring{$\ast$}{*}}]{slot}{, }\item[{\mbox{\hyperlink{pkcs11_8h_ab943ac89d1b0f6f3631d3361da0d52a1}{CK\+\_\+\+MECHANISM\+\_\+\+PTR}}}]{p\+Mechanism}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{util__pkcs11_8c_source_l01646}{1646}} of file \mbox{\hyperlink{util__pkcs11_8c_source}{util\+\_\+pkcs11.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01647\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01648\ }
\DoxyCodeLine{01649\ \ \ CK\_MECHANISM\_TYPE\ mechanisms[128];}
\DoxyCodeLine{01650\ \ \ \mbox{\hyperlink{pkcs11_8h_a35181858a3b7a0a81f49d180d8f446ef}{CK\_ULONG}}\ \mbox{\hyperlink{gmock__stress__test_8cc_afd9db40e3361ae09188795e8cbe19752}{count}}\ =\ 128;}
\DoxyCodeLine{01651\ }
\DoxyCodeLine{01652\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{util__pkcs11_8c_a7c0da3eb6986b1e9466392de8eb4b9f5}{is\_RSA\_sign\_mechanism}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_ab0dca4e7a2bfa74ab9cae5b8c1995647}{pMechanism}}-\/>\mbox{\hyperlink{structck__mechanism_a01c48c2e7afe52b7b1acfa9c2e6fe030}{mechanism}})\ ==\ \textcolor{keyword}{false}\ \&\&}
\DoxyCodeLine{01653\ \ \ \ \ \ \ \mbox{\hyperlink{util__pkcs11_8c_a03746a942ba1eaafbec20b675463ee00}{is\_ECDSA\_sign\_mechanism}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_ab0dca4e7a2bfa74ab9cae5b8c1995647}{pMechanism}}-\/>\mbox{\hyperlink{structck__mechanism_a01c48c2e7afe52b7b1acfa9c2e6fe030}{mechanism}})\ ==\ \textcolor{keyword}{false}\ \&\&}
\DoxyCodeLine{01654\ \ \ \ \ \ \ \mbox{\hyperlink{util__pkcs11_8c_a3da5875af7a71b11ee5ead6b160d1ff4}{is\_HMAC\_sign\_mechanism}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_ab0dca4e7a2bfa74ab9cae5b8c1995647}{pMechanism}}-\/>\mbox{\hyperlink{structck__mechanism_a01c48c2e7afe52b7b1acfa9c2e6fe030}{mechanism}})\ ==\ \textcolor{keyword}{false})\ \{}
\DoxyCodeLine{01655\ }
\DoxyCodeLine{01656\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01657\ \ \ \}}
\DoxyCodeLine{01658\ }
\DoxyCodeLine{01659\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{util__pkcs11_8c_a064731f36eb972f687b4059dc5f340db}{get\_mechanism\_list}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}},\ mechanisms,\ \&\mbox{\hyperlink{gmock__stress__test_8cc_afd9db40e3361ae09188795e8cbe19752}{count}})\ !=\ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}})\ \{}
\DoxyCodeLine{01660\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01661\ \ \ \}}
\DoxyCodeLine{01662\ }
\DoxyCodeLine{01663\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{pkcs11_8h_a35181858a3b7a0a81f49d180d8f446ef}{CK\_ULONG}}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{gmock__stress__test_8cc_afd9db40e3361ae09188795e8cbe19752}{count}};\ i++)\ \{}
\DoxyCodeLine{01664\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_ab0dca4e7a2bfa74ab9cae5b8c1995647}{pMechanism}}-\/>\mbox{\hyperlink{structck__mechanism_a01c48c2e7afe52b7b1acfa9c2e6fe030}{mechanism}}\ ==\ mechanisms[i])\ \{}
\DoxyCodeLine{01665\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01666\ \ \ \ \ \}}
\DoxyCodeLine{01667\ \ \ \}}
\DoxyCodeLine{01668\ }
\DoxyCodeLine{01669\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01670\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{util__pkcs11_8c_ae8ed437178cb69b0fed6916747368344_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{util__pkcs11_8c_ae8ed437178cb69b0fed6916747368344_icgraph}
\end{center}
\end{figure}
\Hypertarget{util__pkcs11_8c_a87b96fbdfd225d8124f0a6f6d6538292}\index{util\_pkcs11.c@{util\_pkcs11.c}!check\_verify\_mechanism@{check\_verify\_mechanism}}
\index{check\_verify\_mechanism@{check\_verify\_mechanism}!util\_pkcs11.c@{util\_pkcs11.c}}
\doxysubsubsection{\texorpdfstring{check\_verify\_mechanism()}{check\_verify\_mechanism()}}
{\footnotesize\ttfamily \label{util__pkcs11_8c_a87b96fbdfd225d8124f0a6f6d6538292} 
bool check\+\_\+verify\+\_\+mechanism (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__pkcs11__slot}{yubihsm\+\_\+pkcs11\+\_\+slot}} \texorpdfstring{$\ast$}{*}}]{slot}{, }\item[{\mbox{\hyperlink{pkcs11_8h_ab943ac89d1b0f6f3631d3361da0d52a1}{CK\+\_\+\+MECHANISM\+\_\+\+PTR}}}]{p\+Mechanism}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{util__pkcs11_8c_source_l01672}{1672}} of file \mbox{\hyperlink{util__pkcs11_8c_source}{util\+\_\+pkcs11.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01673\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01674\ }
\DoxyCodeLine{01675\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{util__pkcs11_8c_ae8ed437178cb69b0fed6916747368344}{check\_sign\_mechanism}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}},\ \mbox{\hyperlink{yubihsm__pkcs11_8c_ab0dca4e7a2bfa74ab9cae5b8c1995647}{pMechanism}});}
\DoxyCodeLine{01676\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{util__pkcs11_8c_a87b96fbdfd225d8124f0a6f6d6538292_cgraph}
\end{center}
\end{figure}
\Hypertarget{util__pkcs11_8c_a83e06a2ae90589d9fad186cad9ed5ede}\index{util\_pkcs11.c@{util\_pkcs11.c}!check\_wrap\_mechanism@{check\_wrap\_mechanism}}
\index{check\_wrap\_mechanism@{check\_wrap\_mechanism}!util\_pkcs11.c@{util\_pkcs11.c}}
\doxysubsubsection{\texorpdfstring{check\_wrap\_mechanism()}{check\_wrap\_mechanism()}}
{\footnotesize\ttfamily \label{util__pkcs11_8c_a83e06a2ae90589d9fad186cad9ed5ede} 
bool check\+\_\+wrap\+\_\+mechanism (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__pkcs11__slot}{yubihsm\+\_\+pkcs11\+\_\+slot}} \texorpdfstring{$\ast$}{*}}]{slot}{, }\item[{\mbox{\hyperlink{pkcs11_8h_ab943ac89d1b0f6f3631d3361da0d52a1}{CK\+\_\+\+MECHANISM\+\_\+\+PTR}}}]{p\+Mechanism}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{util__pkcs11_8c_source_l01740}{1740}} of file \mbox{\hyperlink{util__pkcs11_8c_source}{util\+\_\+pkcs11.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01741\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01742\ }
\DoxyCodeLine{01743\ \ \ CK\_MECHANISM\_TYPE\ mechanisms[128];}
\DoxyCodeLine{01744\ \ \ \mbox{\hyperlink{pkcs11_8h_a35181858a3b7a0a81f49d180d8f446ef}{CK\_ULONG}}\ \mbox{\hyperlink{gmock__stress__test_8cc_afd9db40e3361ae09188795e8cbe19752}{count}}\ =\ 128;}
\DoxyCodeLine{01745\ }
\DoxyCodeLine{01746\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_ab0dca4e7a2bfa74ab9cae5b8c1995647}{pMechanism}}-\/>\mbox{\hyperlink{structck__mechanism_a01c48c2e7afe52b7b1acfa9c2e6fe030}{mechanism}}\ !=\ \mbox{\hyperlink{pkcs11y_8h_a631efbda997696a7f7ce71df0e3e779a}{CKM\_YUBICO\_AES\_CCM\_WRAP}})\ \{}
\DoxyCodeLine{01747\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01748\ \ \ \}}
\DoxyCodeLine{01749\ }
\DoxyCodeLine{01750\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{util__pkcs11_8c_a064731f36eb972f687b4059dc5f340db}{get\_mechanism\_list}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}},\ mechanisms,\ \&\mbox{\hyperlink{gmock__stress__test_8cc_afd9db40e3361ae09188795e8cbe19752}{count}})\ !=\ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}})\ \{}
\DoxyCodeLine{01751\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01752\ \ \ \}}
\DoxyCodeLine{01753\ }
\DoxyCodeLine{01754\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{pkcs11_8h_a35181858a3b7a0a81f49d180d8f446ef}{CK\_ULONG}}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{gmock__stress__test_8cc_afd9db40e3361ae09188795e8cbe19752}{count}};\ i++)\ \{}
\DoxyCodeLine{01755\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_ab0dca4e7a2bfa74ab9cae5b8c1995647}{pMechanism}}-\/>\mbox{\hyperlink{structck__mechanism_a01c48c2e7afe52b7b1acfa9c2e6fe030}{mechanism}}\ ==\ mechanisms[i])\ \{}
\DoxyCodeLine{01756\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01757\ \ \ \ \ \}}
\DoxyCodeLine{01758\ \ \ \}}
\DoxyCodeLine{01759\ }
\DoxyCodeLine{01760\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01761\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{util__pkcs11_8c_a83e06a2ae90589d9fad186cad9ed5ede_cgraph}
\end{center}
\end{figure}
\Hypertarget{util__pkcs11_8c_a700b4fbb8f17dde6dc3a96957951674f}\index{util\_pkcs11.c@{util\_pkcs11.c}!create\_session@{create\_session}}
\index{create\_session@{create\_session}!util\_pkcs11.c@{util\_pkcs11.c}}
\doxysubsubsection{\texorpdfstring{create\_session()}{create\_session()}}
{\footnotesize\ttfamily \label{util__pkcs11_8c_a700b4fbb8f17dde6dc3a96957951674f} 
bool create\+\_\+session (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__pkcs11__slot}{yubihsm\+\_\+pkcs11\+\_\+slot}} \texorpdfstring{$\ast$}{*}}]{slot}{, }\item[{CK\+\_\+\+FLAGS}]{flags}{, }\item[{\mbox{\hyperlink{pkcs11_8h_a28172afc989b647ca7909d036198afa6}{CK\+\_\+\+SESSION\+\_\+\+HANDLE\+\_\+\+PTR}}}]{ph\+Session}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{util__pkcs11_8c_source_l00491}{491}} of file \mbox{\hyperlink{util__pkcs11_8c_source}{util\+\_\+pkcs11.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00492\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00493\ }
\DoxyCodeLine{00494\ \ \ \textcolor{keywordtype}{bool}\ authed\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00495\ \ \ \mbox{\hyperlink{structyubihsm__pkcs11__session}{yubihsm\_pkcs11\_session}}\ \mbox{\hyperlink{ecdh__derive__test_8c_a0a2c7706d971796d7dc84fee36d6c84f}{session}};}
\DoxyCodeLine{00496\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_adc4bd59a60361844aa0e852efa210105}{memset}}(\&\mbox{\hyperlink{ecdh__derive__test_8c_a0a2c7706d971796d7dc84fee36d6c84f}{session}},\ 0,\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{ecdh__derive__test_8c_a0a2c7706d971796d7dc84fee36d6c84f}{session}}));}
\DoxyCodeLine{00497\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__slot_ab8e6a1f9aba139c1561f21304649b43a}{pkcs11\_sessions}}.\mbox{\hyperlink{struct_list_ab1a74efd973a8efd990b05788152fd95}{head}})\ \{}
\DoxyCodeLine{00498\ \ \ \ \ \mbox{\hyperlink{structyubihsm__pkcs11__session}{yubihsm\_pkcs11\_session}}\ *\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}}\ =}
\DoxyCodeLine{00499\ \ \ \ \ \ \ (\mbox{\hyperlink{structyubihsm__pkcs11__session}{yubihsm\_pkcs11\_session}}\ *)\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__slot_ab8e6a1f9aba139c1561f21304649b43a}{pkcs11\_sessions}}.\mbox{\hyperlink{struct_list_ab1a74efd973a8efd990b05788152fd95}{head}}-\/>\mbox{\hyperlink{struct_list_item_a788104e1ae9d59a384497766e5203f20}{data}};}
\DoxyCodeLine{00500\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a506da415c9307c897ca9be93acfe1d0f}{s}}-\/>session\_state\ \&\ \mbox{\hyperlink{yubihsm__pkcs11_8h_ace6bd3fe1cbfdd8d2f55b2679cf6fce4}{SESSION\_AUTHENTICATED}})\ \{}
\DoxyCodeLine{00501\ \ \ \ \ \ \ authed\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00502\ \ \ \ \ \}}
\DoxyCodeLine{00503\ \ \ \}}
\DoxyCodeLine{00504\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_ae0ed371842ace71a7886a6134ecbcb62}{flags}}\ \&\ \mbox{\hyperlink{pkcs11_8h_a49615820fe3b72c616fb71cfbe6957a4}{CKF\_RW\_SESSION}})\ \{}
\DoxyCodeLine{00505\ \ \ \ \ \mbox{\hyperlink{ecdh__derive__test_8c_a0a2c7706d971796d7dc84fee36d6c84f}{session}}.session\_state\ =}
\DoxyCodeLine{00506\ \ \ \ \ \ \ authed\ ?\ \mbox{\hyperlink{yubihsm__pkcs11_8h_a12ef82fba1bb65ec44ebfd41d42554f1a72bd07cb581cbf8c4f255db11973f575}{SESSION\_AUTHENTICATED\_RW}}\ :\ \mbox{\hyperlink{yubihsm__pkcs11_8h_a12ef82fba1bb65ec44ebfd41d42554f1af048891d1d2cd3ce2368a5c2218a8012}{SESSION\_RESERVED\_RW}};}
\DoxyCodeLine{00507\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00508\ \ \ \ \ \mbox{\hyperlink{ecdh__derive__test_8c_a0a2c7706d971796d7dc84fee36d6c84f}{session}}.session\_state\ =}
\DoxyCodeLine{00509\ \ \ \ \ \ \ authed\ ?\ \mbox{\hyperlink{yubihsm__pkcs11_8h_a12ef82fba1bb65ec44ebfd41d42554f1a7cd356610204420cc1297af1fe200a0c}{SESSION\_AUTHENTICATED\_RO}}\ :\ \mbox{\hyperlink{yubihsm__pkcs11_8h_a12ef82fba1bb65ec44ebfd41d42554f1ae392f5a08a54bc920f84c36836d6daf8}{SESSION\_RESERVED\_RO}};}
\DoxyCodeLine{00510\ \ \ \}}
\DoxyCodeLine{00511\ \ \ \mbox{\hyperlink{ecdh__derive__test_8c_a0a2c7706d971796d7dc84fee36d6c84f}{session}}.id\ =\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__slot_acb2adb2735c7e7fed62553254305888a}{max\_session\_id}}++;}
\DoxyCodeLine{00512\ \ \ \mbox{\hyperlink{ecdh__derive__test_8c_a0a2c7706d971796d7dc84fee36d6c84f}{session}}.slot\ =\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}};}
\DoxyCodeLine{00513\ \ \ \mbox{\hyperlink{list_8c_ac6c8b33b4100dfc73c933f3e936f86a1}{list\_create}}(\&\mbox{\hyperlink{ecdh__derive__test_8c_a0a2c7706d971796d7dc84fee36d6c84f}{session}}.ecdh\_session\_keys,\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structecdh__session__key}{ecdh\_session\_key}}),\ NULL);}
\DoxyCodeLine{00514\ \ \ *\mbox{\hyperlink{yubihsm__pkcs11_8c_a4af2a29df94c09021ad1646463da9201}{phSession}}\ =\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__slot_a7a8ed452594de0255b468210b42f2383}{id}}\ <<\ 16)\ +\ \mbox{\hyperlink{ecdh__derive__test_8c_a0a2c7706d971796d7dc84fee36d6c84f}{session}}.id;}
\DoxyCodeLine{00515\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{list_8c_a06a2b45f704182a7d152c88d0507700c}{list\_append}}(\&\mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__slot_ab8e6a1f9aba139c1561f21304649b43a}{pkcs11\_sessions}},\ (\textcolor{keywordtype}{void}\ *)\ \&\mbox{\hyperlink{ecdh__derive__test_8c_a0a2c7706d971796d7dc84fee36d6c84f}{session}});}
\DoxyCodeLine{00516\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{util__pkcs11_8c_a700b4fbb8f17dde6dc3a96957951674f_cgraph}
\end{center}
\end{figure}
\Hypertarget{util__pkcs11_8c_a16357f17413edbce1da86168fb464074}\index{util\_pkcs11.c@{util\_pkcs11.c}!decrypt\_mechanism\_cleanup@{decrypt\_mechanism\_cleanup}}
\index{decrypt\_mechanism\_cleanup@{decrypt\_mechanism\_cleanup}!util\_pkcs11.c@{util\_pkcs11.c}}
\doxysubsubsection{\texorpdfstring{decrypt\_mechanism\_cleanup()}{decrypt\_mechanism\_cleanup()}}
{\footnotesize\ttfamily \label{util__pkcs11_8c_a16357f17413edbce1da86168fb464074} 
bool decrypt\+\_\+mechanism\+\_\+cleanup (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__pkcs11__op__info}{yubihsm\+\_\+pkcs11\+\_\+op\+\_\+info}} \texorpdfstring{$\ast$}{*}}]{op\+\_\+info}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{util__pkcs11_8c_source_l02566}{2566}} of file \mbox{\hyperlink{util__pkcs11_8c_source}{util\+\_\+pkcs11.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02566\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02567\ }
\DoxyCodeLine{02568\ \ \ (void)\ op\_info;}
\DoxyCodeLine{02569\ }
\DoxyCodeLine{02570\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{02571\ \}}

\end{DoxyCode}
\Hypertarget{util__pkcs11_8c_abbef2f6ae8466dee723f94497bdea3bf}\index{util\_pkcs11.c@{util\_pkcs11.c}!delete\_object\_from\_cache@{delete\_object\_from\_cache}}
\index{delete\_object\_from\_cache@{delete\_object\_from\_cache}!util\_pkcs11.c@{util\_pkcs11.c}}
\doxysubsubsection{\texorpdfstring{delete\_object\_from\_cache()}{delete\_object\_from\_cache()}}
{\footnotesize\ttfamily \label{util__pkcs11_8c_abbef2f6ae8466dee723f94497bdea3bf} 
void delete\+\_\+object\+\_\+from\+\_\+cache (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__pkcs11__object__desc}{yubihsm\+\_\+pkcs11\+\_\+object\+\_\+desc}} \texorpdfstring{$\ast$}{*}}]{objects}{, }\item[{CK\+\_\+\+OBJECT\+\_\+\+HANDLE}]{obj\+Handle}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{util__pkcs11_8c_source_l01571}{1571}} of file \mbox{\hyperlink{util__pkcs11_8c_source}{util\+\_\+pkcs11.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01572\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01573\ \ \ \mbox{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t}}\ \textcolor{keywordtype}{id}\ =\ objHandle\ \&\ 0xffff;}
\DoxyCodeLine{01574\ \ \ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ type\ =\ objHandle\ >>\ 16;}
\DoxyCodeLine{01575\ \ \ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ sequence\ =\ objHandle\ >>\ 24;}
\DoxyCodeLine{01576\ }
\DoxyCodeLine{01577\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t}}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{yubihsm_8h_a331b70d37ded99854638ff5ef0ca9735}{YH\_MAX\_ITEMS\_COUNT}};\ i++)\ \{}
\DoxyCodeLine{01578\ \ \ \ \ \textcolor{keywordflow}{if}\ (objects[i].\textcolor{keywordtype}{object}.\textcolor{keywordtype}{id}\ ==\ \textcolor{keywordtype}{id}\ \&\&}
\DoxyCodeLine{01579\ \ \ \ \ \ \ \ \ (objects[i].\textcolor{keywordtype}{object}.type\ \&\ 0x7f)\ ==\ (type\ \&\ 0x7f)\ \&\&}
\DoxyCodeLine{01580\ \ \ \ \ \ \ \ \ objects[i].\textcolor{keywordtype}{object}.sequence\ ==\ sequence)\ \{}
\DoxyCodeLine{01581\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_adc4bd59a60361844aa0e852efa210105}{memset}}(\&objects[i],\ 0,\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structyubihsm__pkcs11__object__desc}{yubihsm\_pkcs11\_object\_desc}}));}
\DoxyCodeLine{01582\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01583\ \ \ \ \ \}}
\DoxyCodeLine{01584\ \ \ \}}
\DoxyCodeLine{01585\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=266pt]{util__pkcs11_8c_abbef2f6ae8466dee723f94497bdea3bf_cgraph}
\end{center}
\end{figure}
\Hypertarget{util__pkcs11_8c_a85ea84ffb047281f34a733572f67b254}\index{util\_pkcs11.c@{util\_pkcs11.c}!delete\_session@{delete\_session}}
\index{delete\_session@{delete\_session}!util\_pkcs11.c@{util\_pkcs11.c}}
\doxysubsubsection{\texorpdfstring{delete\_session()}{delete\_session()}}
{\footnotesize\ttfamily \label{util__pkcs11_8c_a85ea84ffb047281f34a733572f67b254} 
bool delete\+\_\+session (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__pkcs11__context}{yubihsm\+\_\+pkcs11\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{pkcs11_8h_a28172afc989b647ca7909d036198afa6}{CK\+\_\+\+SESSION\+\_\+\+HANDLE\+\_\+\+PTR}}}]{ph\+Session}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{util__pkcs11_8c_source_l02831}{2831}} of file \mbox{\hyperlink{util__pkcs11_8c_source}{util\+\_\+pkcs11.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02832\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02833\ \ \ \mbox{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t}}\ \mbox{\hyperlink{pkcs11_8h_abed4fb4d15e18c668b783ad68448fed7}{slot\_id}}\ =\ *\mbox{\hyperlink{yubihsm__pkcs11_8c_a4af2a29df94c09021ad1646463da9201}{phSession}}\ >>\ 16;}
\DoxyCodeLine{02834\ \ \ \mbox{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t}}\ session\_id\ =\ *\mbox{\hyperlink{yubihsm__pkcs11_8c_a4af2a29df94c09021ad1646463da9201}{phSession}}\ \&\ 0xffff;}
\DoxyCodeLine{02835\ \ \ \mbox{\hyperlink{structyubihsm__pkcs11__slot}{yubihsm\_pkcs11\_slot}}\ *\mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}}\ =\ \mbox{\hyperlink{util__pkcs11_8c_a79a44d844efebfc64db6cf5836754539}{get\_slot}}(ctx,\ \mbox{\hyperlink{pkcs11_8h_abed4fb4d15e18c668b783ad68448fed7}{slot\_id}});}
\DoxyCodeLine{02836\ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02837\ }
\DoxyCodeLine{02838\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}})\ \{}
\DoxyCodeLine{02839\ \ \ \ \ \mbox{\hyperlink{struct_list_item}{ListItem}}\ *item\ =}
\DoxyCodeLine{02840\ \ \ \ \ \ \ \mbox{\hyperlink{list_8c_ac048645b0cd40b78c89aad9e770d4aab}{list\_get}}(\&\mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__slot_ab8e6a1f9aba139c1561f21304649b43a}{pkcs11\_sessions}},\ \&session\_id,\ compare\_session);}
\DoxyCodeLine{02841\ \ \ \ \ \textcolor{keywordflow}{if}\ (item)\ \{}
\DoxyCodeLine{02842\ \ \ \ \ \ \ \mbox{\hyperlink{list_8c_a2c9f1765436e9a3631f048b71f17f33c}{list\_delete}}(\&\mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__slot_ab8e6a1f9aba139c1561f21304649b43a}{pkcs11\_sessions}},\ item);}
\DoxyCodeLine{02843\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}}\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{02844\ \ \ \ \ \}}
\DoxyCodeLine{02845\ \ \ \ \ \mbox{\hyperlink{util__pkcs11_8c_a3754cf5cb42a5e282658cf94f405574e}{release\_slot}}(ctx,\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}});}
\DoxyCodeLine{02846\ \ \ \}}
\DoxyCodeLine{02847\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a3d854b6efad16a16e4d7b4539d4fc71f}{ret}};}
\DoxyCodeLine{02848\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=349pt]{util__pkcs11_8c_a85ea84ffb047281f34a733572f67b254_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=328pt]{util__pkcs11_8c_a85ea84ffb047281f34a733572f67b254_icgraph}
\end{center}
\end{figure}
\Hypertarget{util__pkcs11_8c_acf9d727a7620788445bc9ce264046b05}\index{util\_pkcs11.c@{util\_pkcs11.c}!digest\_mechanism\_cleanup@{digest\_mechanism\_cleanup}}
\index{digest\_mechanism\_cleanup@{digest\_mechanism\_cleanup}!util\_pkcs11.c@{util\_pkcs11.c}}
\doxysubsubsection{\texorpdfstring{digest\_mechanism\_cleanup()}{digest\_mechanism\_cleanup()}}
{\footnotesize\ttfamily \label{util__pkcs11_8c_acf9d727a7620788445bc9ce264046b05} 
bool digest\+\_\+mechanism\+\_\+cleanup (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__pkcs11__op__info}{yubihsm\+\_\+pkcs11\+\_\+op\+\_\+info}} \texorpdfstring{$\ast$}{*}}]{op\+\_\+info}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{util__pkcs11_8c_source_l02573}{2573}} of file \mbox{\hyperlink{util__pkcs11_8c_source}{util\+\_\+pkcs11.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02573\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02574\ }
\DoxyCodeLine{02575\ \ \ \textcolor{keywordflow}{if}\ (op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_a06ea7ebdd4f4e99dec979ed3576e5722}{digest}}.\mbox{\hyperlink{structdigest__info_acf5534c1229554d54bf0e71dd544db81}{md\_ctx}}\ !=\ NULL)\ \{}
\DoxyCodeLine{02576\ \ \ \ \ EVP\_MD\_CTX\_destroy(op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_a06ea7ebdd4f4e99dec979ed3576e5722}{digest}}.\mbox{\hyperlink{structdigest__info_acf5534c1229554d54bf0e71dd544db81}{md\_ctx}});}
\DoxyCodeLine{02577\ \ \ \ \ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_a06ea7ebdd4f4e99dec979ed3576e5722}{digest}}.\mbox{\hyperlink{structdigest__info_acf5534c1229554d54bf0e71dd544db81}{md\_ctx}}\ =\ NULL;}
\DoxyCodeLine{02578\ \ \ \}}
\DoxyCodeLine{02579\ }
\DoxyCodeLine{02580\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{02581\ \}}

\end{DoxyCode}
\Hypertarget{util__pkcs11_8c_acc3b093830e7126a8655e9b8ec77ad10}\index{util\_pkcs11.c@{util\_pkcs11.c}!get\_attribute@{get\_attribute}}
\index{get\_attribute@{get\_attribute}!util\_pkcs11.c@{util\_pkcs11.c}}
\doxysubsubsection{\texorpdfstring{get\_attribute()}{get\_attribute()}}
{\footnotesize\ttfamily \label{util__pkcs11_8c_acc3b093830e7126a8655e9b8ec77ad10} 
CK\+\_\+\+RV get\+\_\+attribute (\begin{DoxyParamCaption}\item[{CK\+\_\+\+ATTRIBUTE\+\_\+\+TYPE}]{type}{, }\item[{\mbox{\hyperlink{structyh__object__descriptor}{yh\+\_\+object\+\_\+descriptor}} \texorpdfstring{$\ast$}{*}}]{object}{, }\item[{\mbox{\hyperlink{pkcs11_8h_a88e8d2cf99e26f3b3f86a0a698b0ab64}{CK\+\_\+\+VOID\+\_\+\+PTR}}}]{value}{, }\item[{\mbox{\hyperlink{pkcs11_8h_a2c6426aaa1ca6dd1f48a01b8490482fa}{CK\+\_\+\+ULONG\+\_\+\+PTR}}}]{length}{, }\item[{\mbox{\hyperlink{structyh__session}{yh\+\_\+session}} \texorpdfstring{$\ast$}{*}}]{session}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{util__pkcs11_8c_source_l01455}{1455}} of file \mbox{\hyperlink{util__pkcs11_8c_source}{util\+\_\+pkcs11.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01457\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01458\ }
\DoxyCodeLine{01459\ \ \ \mbox{\hyperlink{pkcs11_8h_a51e605f881c86838bf12d70707b57b85}{CK\_BYTE}}\ tmp[2048];}
\DoxyCodeLine{01460\ \ \ \mbox{\hyperlink{pkcs11_8h_a88e8d2cf99e26f3b3f86a0a698b0ab64}{CK\_VOID\_PTR}}\ ptr;}
\DoxyCodeLine{01461\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{pkcs11_8h_a32aff7c6c4cd253fdf6563677afab5ce}{value}}\ ==\ NULL)\ \{}
\DoxyCodeLine{01462\ \ \ \ \ \textcolor{comment}{//\ NOTE(adma):\ we\ just\ need\ the\ length,\ use\ a\ scratchpad\ for\ the\ data}}
\DoxyCodeLine{01463\ \ \ \ \ ptr\ =\ tmp;}
\DoxyCodeLine{01464\ \ \ \ \ *length\ =\ \textcolor{keyword}{sizeof}(tmp);}
\DoxyCodeLine{01465\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01466\ \ \ \ \ \textcolor{comment}{//\ NOTE(adma):\ otherwise\ actually\ save\ the\ data}}
\DoxyCodeLine{01467\ \ \ \ \ ptr\ =\ \mbox{\hyperlink{pkcs11_8h_a32aff7c6c4cd253fdf6563677afab5ce}{value}};}
\DoxyCodeLine{01468\ \ \ \}}
\DoxyCodeLine{01469\ }
\DoxyCodeLine{01470\ \ \ \textcolor{keywordflow}{switch}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a85d991d90970121ba1480cd98d93aab9}{object}}-\/>\mbox{\hyperlink{structyh__object__descriptor_ab8c1b3cc5b859e3c89eb228fa0763165}{type}})\ \{}
\DoxyCodeLine{01471\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a2fe39512cb4df34b270a67dbb8e13583a5d37b7418d50b420621e6a6eb2700de4}{YH\_OPAQUE}}:}
\DoxyCodeLine{01472\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ get\_attribute\_opaque(type,\ \textcolor{keywordtype}{object},\ ptr,\ length,\ \mbox{\hyperlink{ecdh__derive__test_8c_a0a2c7706d971796d7dc84fee36d6c84f}{session}});}
\DoxyCodeLine{01473\ }
\DoxyCodeLine{01474\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a2fe39512cb4df34b270a67dbb8e13583a16f0118db1dac3d0732e7d66630e1dba}{YH\_WRAP\_KEY}}:}
\DoxyCodeLine{01475\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a2fe39512cb4df34b270a67dbb8e13583a708d85f80fc33743ac26a7c3e43464a9}{YH\_HMAC\_KEY}}:}
\DoxyCodeLine{01476\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ get\_attribute\_secret\_key(type,\ \textcolor{keywordtype}{object},\ ptr,\ length);}
\DoxyCodeLine{01477\ }
\DoxyCodeLine{01478\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a2fe39512cb4df34b270a67dbb8e13583ab71424e16384319d6e6a12f9a3d8ceae}{YH\_ASYMMETRIC\_KEY}}:}
\DoxyCodeLine{01479\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ get\_attribute\_private\_key(type,\ \textcolor{keywordtype}{object},\ ptr,\ length,\ \mbox{\hyperlink{ecdh__derive__test_8c_a0a2c7706d971796d7dc84fee36d6c84f}{session}});}
\DoxyCodeLine{01480\ \ \ \ \ \textcolor{keywordflow}{case}\ 0x80\ |\ \mbox{\hyperlink{yubihsm_8h_a2fe39512cb4df34b270a67dbb8e13583ab71424e16384319d6e6a12f9a3d8ceae}{YH\_ASYMMETRIC\_KEY}}:}
\DoxyCodeLine{01481\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ get\_attribute\_public\_key(type,\ \textcolor{keywordtype}{object},\ ptr,\ length,\ \mbox{\hyperlink{ecdh__derive__test_8c_a0a2c7706d971796d7dc84fee36d6c84f}{session}});}
\DoxyCodeLine{01482\ }
\DoxyCodeLine{01483\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a2fe39512cb4df34b270a67dbb8e13583a96244762de5ce4175e60157239e7a097}{YH\_TEMPLATE}}:}
\DoxyCodeLine{01484\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a2fe39512cb4df34b270a67dbb8e13583acee44b775b3c5b6157f0732699935074}{YH\_AUTHENTICATION\_KEY}}:}
\DoxyCodeLine{01485\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a2fe39512cb4df34b270a67dbb8e13583a02c5f683fde147de6a9e1043f971f5f0}{YH\_OTP\_AEAD\_KEY}}:}
\DoxyCodeLine{01486\ \ \ \ \ \ \ \textcolor{comment}{//\ TODO:\ do\ something\ good\ here.}}
\DoxyCodeLine{01487\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01488\ \ \ \}\ \textcolor{comment}{//\ TODO(adma):\ try\ to\ check\ common\ attributes\ in\ some\ convenience\ function}}
\DoxyCodeLine{01489\ }
\DoxyCodeLine{01490\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}};}
\DoxyCodeLine{01491\ \}}

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=282pt]{util__pkcs11_8c_acc3b093830e7126a8655e9b8ec77ad10_icgraph}
\end{center}
\end{figure}
\Hypertarget{util__pkcs11_8c_a5c8c35826a58c280a290c49a5a1e5b03}\index{util\_pkcs11.c@{util\_pkcs11.c}!get\_attribute\_ecsession\_key@{get\_attribute\_ecsession\_key}}
\index{get\_attribute\_ecsession\_key@{get\_attribute\_ecsession\_key}!util\_pkcs11.c@{util\_pkcs11.c}}
\doxysubsubsection{\texorpdfstring{get\_attribute\_ecsession\_key()}{get\_attribute\_ecsession\_key()}}
{\footnotesize\ttfamily \label{util__pkcs11_8c_a5c8c35826a58c280a290c49a5a1e5b03} 
CK\+\_\+\+RV get\+\_\+attribute\+\_\+ecsession\+\_\+key (\begin{DoxyParamCaption}\item[{CK\+\_\+\+ATTRIBUTE\+\_\+\+TYPE}]{type}{, }\item[{\mbox{\hyperlink{structecdh__session__key}{ecdh\+\_\+session\+\_\+key}} \texorpdfstring{$\ast$}{*}}]{key}{, }\item[{\mbox{\hyperlink{pkcs11_8h_a88e8d2cf99e26f3b3f86a0a698b0ab64}{CK\+\_\+\+VOID\+\_\+\+PTR}}}]{value}{, }\item[{\mbox{\hyperlink{pkcs11_8h_a2c6426aaa1ca6dd1f48a01b8490482fa}{CK\+\_\+\+ULONG\+\_\+\+PTR}}}]{length}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{util__pkcs11_8c_source_l01493}{1493}} of file \mbox{\hyperlink{util__pkcs11_8c_source}{util\+\_\+pkcs11.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01494\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01495\ }
\DoxyCodeLine{01496\ \ \ \mbox{\hyperlink{pkcs11_8h_a51e605f881c86838bf12d70707b57b85}{CK\_BYTE}}\ tmp[2048];}
\DoxyCodeLine{01497\ \ \ \mbox{\hyperlink{pkcs11_8h_a88e8d2cf99e26f3b3f86a0a698b0ab64}{CK\_VOID\_PTR}}\ ptr;}
\DoxyCodeLine{01498\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{pkcs11_8h_a32aff7c6c4cd253fdf6563677afab5ce}{value}}\ ==\ NULL)\ \{}
\DoxyCodeLine{01499\ \ \ \ \ ptr\ =\ tmp;}
\DoxyCodeLine{01500\ \ \ \ \ *length\ =\ \textcolor{keyword}{sizeof}(tmp);}
\DoxyCodeLine{01501\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01502\ \ \ \ \ ptr\ =\ \mbox{\hyperlink{pkcs11_8h_a32aff7c6c4cd253fdf6563677afab5ce}{value}};}
\DoxyCodeLine{01503\ \ \ \}}
\DoxyCodeLine{01504\ }
\DoxyCodeLine{01505\ \ \ \textcolor{keywordflow}{switch}\ (type)\ \{}
\DoxyCodeLine{01506\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_af867d3ae9286fe0f8cab4995bb6af337}{CKA\_CLASS}}:}
\DoxyCodeLine{01507\ \ \ \ \ \ \ *((CK\_OBJECT\_CLASS\ *)\ ptr)\ =\ \mbox{\hyperlink{pkcs11_8h_a35306ac9f52ce0f9f45ac66b8bc4dcc7}{CKO\_SECRET\_KEY}};}
\DoxyCodeLine{01508\ \ \ \ \ \ \ *length\ =\ \textcolor{keyword}{sizeof}(CK\_OBJECT\_CLASS);}
\DoxyCodeLine{01509\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01510\ }
\DoxyCodeLine{01511\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_aa438b88cbcb8a921288eeefba5613274}{CKA\_KEY\_TYPE}}:}
\DoxyCodeLine{01512\ \ \ \ \ \ \ *((CK\_KEY\_TYPE\ *)\ ptr)\ =\ \mbox{\hyperlink{pkcs11_8h_aaf8c226acc7ea8b6b9e021465b1ae65b}{CKK\_GENERIC\_SECRET}};}
\DoxyCodeLine{01513\ \ \ \ \ \ \ *length\ =\ \textcolor{keyword}{sizeof}(CK\_KEY\_TYPE);}
\DoxyCodeLine{01514\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01515\ }
\DoxyCodeLine{01516\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a2846a5a41835defa47716ccc3bcc4913}{CKA\_ID}}:\ \{}
\DoxyCodeLine{01517\ \ \ \ \ \ \ CK\_OBJECT\_HANDLE\ *\textcolor{keywordtype}{id}\ =\ ptr;}
\DoxyCodeLine{01518\ \ \ \ \ \ \ *\textcolor{keywordtype}{id}\ =\ key-\/>id;}
\DoxyCodeLine{01519\ \ \ \ \ \ \ *length\ =\ \textcolor{keyword}{sizeof}(CK\_OBJECT\_HANDLE);}
\DoxyCodeLine{01520\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01521\ \ \ \ \ \}}
\DoxyCodeLine{01522\ }
\DoxyCodeLine{01523\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_acf009a991c04b5c4305cc76356225aa7}{CKA\_LABEL}}:}
\DoxyCodeLine{01524\ \ \ \ \ \ \ *length\ =\ strlen(key-\/>label);}
\DoxyCodeLine{01525\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(ptr,\ key-\/>label,\ *length);}
\DoxyCodeLine{01526\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01527\ }
\DoxyCodeLine{01528\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a7f7089933d976e82f882eda6efcf7e66}{CKA\_LOCAL}}:}
\DoxyCodeLine{01529\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a05c1c460160443a739c6e0ce47ae3fc8}{CKA\_TOKEN}}:}
\DoxyCodeLine{01530\ \ \ \ \ \ \ *((\mbox{\hyperlink{pkcs11_8h_a9dc289e62be691f41a9c6b875789b1f2}{CK\_BBOOL}}\ *)\ ptr)\ =\ \mbox{\hyperlink{pkcs11_8h_a1df8841072c48f0b511ccad3bbb25812}{CK\_FALSE}};}
\DoxyCodeLine{01531\ \ \ \ \ \ \ *length\ =\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{pkcs11_8h_a9dc289e62be691f41a9c6b875789b1f2}{CK\_BBOOL}});}
\DoxyCodeLine{01532\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01533\ }
\DoxyCodeLine{01534\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ab495c20657f01d79e1a6ca49d2c8472e}{CKA\_DESTROYABLE}}:}
\DoxyCodeLine{01535\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_acf37955a2a229d208289962c6f1183b8}{CKA\_EXTRACTABLE}}:}
\DoxyCodeLine{01536\ \ \ \ \ \ \ *((\mbox{\hyperlink{pkcs11_8h_a9dc289e62be691f41a9c6b875789b1f2}{CK\_BBOOL}}\ *)\ ptr)\ =\ \mbox{\hyperlink{pkcs11_8h_a76edf786ed8cccb1b3d2cf9e9f0800cd}{CK\_TRUE}};}
\DoxyCodeLine{01537\ \ \ \ \ \ \ *length\ =\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{pkcs11_8h_a9dc289e62be691f41a9c6b875789b1f2}{CK\_BBOOL}});}
\DoxyCodeLine{01538\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01539\ }
\DoxyCodeLine{01540\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ab65b14615d388fc862c82a8d1e163f84}{CKA\_DERIVE}}:}
\DoxyCodeLine{01541\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a013b845980a36573e16b427bbf88117c}{CKA\_NEVER\_EXTRACTABLE}}:}
\DoxyCodeLine{01542\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a5fe5fb4a38ca6781c50e4cba8a2af0d6}{CKA\_SENSITIVE}}:}
\DoxyCodeLine{01543\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ac103aa0452ee58ef0161eeab8283e419}{CKA\_ALWAYS\_SENSITIVE}}:}
\DoxyCodeLine{01544\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a39688e3f665848ca7868f2ca37aa1aed}{CKA\_MODIFIABLE}}:}
\DoxyCodeLine{01545\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a92925cbe2a1b3d50dd56f8af0f770a69}{CKA\_COPYABLE}}:}
\DoxyCodeLine{01546\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a6ffd14ad7386d9aa7178e841a964a87e}{CKA\_SIGN}}:}
\DoxyCodeLine{01547\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a66386b8788c722385f26c73832bdab54}{CKA\_SIGN\_RECOVER}}:}
\DoxyCodeLine{01548\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_aa50a7c624907155b7c12bbca983ca5a7}{CKA\_ALWAYS\_AUTHENTICATE}}:}
\DoxyCodeLine{01549\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a9a9a988131e4e93d0758e43c555bdc97}{CKA\_UNWRAP}}:}
\DoxyCodeLine{01550\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_af7a34bb656aa7e2b7e813dab0a6ac7b7}{CKA\_WRAP}}:}
\DoxyCodeLine{01551\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a9e4fb07743f4dcca88f094f222725f73}{CKA\_WRAP\_WITH\_TRUSTED}}:}
\DoxyCodeLine{01552\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a84c89cd9def639cb4a58145063b7bd42}{CKA\_VERIFY}}:}
\DoxyCodeLine{01553\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ad427016a08d7b8f0d8fe910b907e9b44}{CKA\_ENCRYPT}}:}
\DoxyCodeLine{01554\ \ \ \ \ \ \ *((\mbox{\hyperlink{pkcs11_8h_a9dc289e62be691f41a9c6b875789b1f2}{CK\_BBOOL}}\ *)\ ptr)\ =\ \mbox{\hyperlink{pkcs11_8h_a1df8841072c48f0b511ccad3bbb25812}{CK\_FALSE}};}
\DoxyCodeLine{01555\ \ \ \ \ \ \ *length\ =\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{pkcs11_8h_a9dc289e62be691f41a9c6b875789b1f2}{CK\_BBOOL}});}
\DoxyCodeLine{01556\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01557\ }
\DoxyCodeLine{01558\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a799f3b28e5c856ef4229d12257818841}{CKA\_VALUE}}:}
\DoxyCodeLine{01559\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(ptr,\ key-\/>ecdh\_key,\ key-\/>len);}
\DoxyCodeLine{01560\ \ \ \ \ \ \ *length\ =\ key-\/>len;}
\DoxyCodeLine{01561\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01562\ }
\DoxyCodeLine{01563\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{01564\ \ \ \ \ \ \ *length\ =\ \mbox{\hyperlink{pkcs11_8h_a76782288a47c99c6e6ff3dc667f0e3ef}{CK\_UNAVAILABLE\_INFORMATION}};}
\DoxyCodeLine{01565\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a0afbefc1a4ce05ba5faea1778eb602ca}{CKR\_ATTRIBUTE\_TYPE\_INVALID}};}
\DoxyCodeLine{01566\ \ \ \}}
\DoxyCodeLine{01567\ }
\DoxyCodeLine{01568\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}};}
\DoxyCodeLine{01569\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=310pt]{util__pkcs11_8c_a5c8c35826a58c280a290c49a5a1e5b03_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{util__pkcs11_8c_a5c8c35826a58c280a290c49a5a1e5b03_icgraph}
\end{center}
\end{figure}
\Hypertarget{util__pkcs11_8c_ac9a2fa09ddebb577ec5a919ad3a26d5d}\index{util\_pkcs11.c@{util\_pkcs11.c}!get\_digest\_bytelength@{get\_digest\_bytelength}}
\index{get\_digest\_bytelength@{get\_digest\_bytelength}!util\_pkcs11.c@{util\_pkcs11.c}}
\doxysubsubsection{\texorpdfstring{get\_digest\_bytelength()}{get\_digest\_bytelength()}}
{\footnotesize\ttfamily \label{util__pkcs11_8c_ac9a2fa09ddebb577ec5a919ad3a26d5d} 
\mbox{\hyperlink{pkcs11_8h_a35181858a3b7a0a81f49d180d8f446ef}{CK\+\_\+\+ULONG}} get\+\_\+digest\+\_\+bytelength (\begin{DoxyParamCaption}\item[{CK\+\_\+\+MECHANISM\+\_\+\+TYPE}]{m}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{util__pkcs11_8c_source_l02583}{2583}} of file \mbox{\hyperlink{util__pkcs11_8c_source}{util\+\_\+pkcs11.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02583\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02584\ }
\DoxyCodeLine{02585\ \ \ \textcolor{keywordflow}{switch}\ (m)\ \{}
\DoxyCodeLine{02586\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_af1818a1c453a84f01f2e868307ca8fed}{CKM\_SHA\_1}}:}
\DoxyCodeLine{02587\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 20;}
\DoxyCodeLine{02588\ }
\DoxyCodeLine{02589\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a4d11f88ae3bea2f748f275c03b54a648}{CKM\_SHA256}}:}
\DoxyCodeLine{02590\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 32;}
\DoxyCodeLine{02591\ }
\DoxyCodeLine{02592\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a9278e01971ca83cdd07e4b8e07a00bc8}{CKM\_SHA384}}:}
\DoxyCodeLine{02593\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 48;}
\DoxyCodeLine{02594\ }
\DoxyCodeLine{02595\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a9bf4bf7375a24e1010cc8e0139608fd5}{CKM\_SHA512}}:}
\DoxyCodeLine{02596\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 64;}
\DoxyCodeLine{02597\ }
\DoxyCodeLine{02598\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{02599\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02600\ \ \ \}}
\DoxyCodeLine{02601\ }
\DoxyCodeLine{02602\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{02603\ \}}

\end{DoxyCode}
\Hypertarget{util__pkcs11_8c_a95f1c61424aa67f782a360e59c6cee84}\index{util\_pkcs11.c@{util\_pkcs11.c}!get\_mechanism\_info@{get\_mechanism\_info}}
\index{get\_mechanism\_info@{get\_mechanism\_info}!util\_pkcs11.c@{util\_pkcs11.c}}
\doxysubsubsection{\texorpdfstring{get\_mechanism\_info()}{get\_mechanism\_info()}}
{\footnotesize\ttfamily \label{util__pkcs11_8c_a95f1c61424aa67f782a360e59c6cee84} 
bool get\+\_\+mechanism\+\_\+info (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__pkcs11__slot}{yubihsm\+\_\+pkcs11\+\_\+slot}} \texorpdfstring{$\ast$}{*}}]{slot}{, }\item[{CK\+\_\+\+MECHANISM\+\_\+\+TYPE}]{type}{, }\item[{\mbox{\hyperlink{pkcs11_8h_a19a155cbd39a0b5099741d385f1db7b9}{CK\+\_\+\+MECHANISM\+\_\+\+INFO\+\_\+\+PTR}}}]{p\+Info}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{util__pkcs11_8c_source_l00313}{313}} of file \mbox{\hyperlink{util__pkcs11_8c_source}{util\+\_\+pkcs11.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00314\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00315\ }
\DoxyCodeLine{00316\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__slot_ac4313bd333015ea2ae50240ed379da60}{n\_algorithms}}\ ==\ 0)\ \{}
\DoxyCodeLine{00317\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__slot_ac4313bd333015ea2ae50240ed379da60}{n\_algorithms}}\ =\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__slot_acc712b62a1eba2487a602bc84f2567cf}{algorithms}})\ /\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__slot_acc712b62a1eba2487a602bc84f2567cf}{algorithms}}[0]);}
\DoxyCodeLine{00318\ \ \ \ \ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366}{yh\_rc}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =}
\DoxyCodeLine{00319\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm_8c_a6ab558e1426359cc78e7a362f8b3acd9}{yh\_util\_get\_device\_info}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__slot_a8022d3426b090c01b082636562f7c013}{connector}},\ NULL,\ NULL,\ NULL,\ NULL,\ NULL,}
\DoxyCodeLine{00320\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ NULL,\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__slot_acc712b62a1eba2487a602bc84f2567cf}{algorithms}},\ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__slot_ac4313bd333015ea2ae50240ed379da60}{n\_algorithms}});}
\DoxyCodeLine{00321\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{00322\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00323\ \ \ \ \ \}}
\DoxyCodeLine{00324\ \ \ \}}
\DoxyCodeLine{00325\ }
\DoxyCodeLine{00326\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a05dd610acfc36d8ca4581d4d22ae1521}{pInfo}}-\/>\mbox{\hyperlink{structck__slot__info_ad23902c9bb73c7da64bb65cb4f9bea4f}{flags}}\ =\ 0;}
\DoxyCodeLine{00327\ \ \ \textcolor{keywordflow}{switch}\ (type)\ \{}
\DoxyCodeLine{00328\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a08a8e0f2109de3ff3bfe26f220447a2e}{CKM\_RSA\_PKCS}}:}
\DoxyCodeLine{00329\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a05dd610acfc36d8ca4581d4d22ae1521}{pInfo}}-\/>\mbox{\hyperlink{structck__slot__info_ad23902c9bb73c7da64bb65cb4f9bea4f}{flags}}\ =\ \mbox{\hyperlink{pkcs11_8h_acd1d6f14eb6ae040a3c7e015c7c1932a}{CKF\_DECRYPT}};}
\DoxyCodeLine{00330\ }
\DoxyCodeLine{00331\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a9b5d495ac404ebbce07d1f58436ee31d}{CKM\_SHA1\_RSA\_PKCS}}:}
\DoxyCodeLine{00332\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ae24525658e8df0829c24236ee7614d1f}{CKM\_SHA256\_RSA\_PKCS}}:}
\DoxyCodeLine{00333\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ad8d3d34082b7e18f4f173804cf5b959b}{CKM\_SHA384\_RSA\_PKCS}}:}
\DoxyCodeLine{00334\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a6c0c89dfd22474095772f87d25c6a17d}{CKM\_SHA512\_RSA\_PKCS}}:}
\DoxyCodeLine{00335\ \ \ \ \ \ \ find\_minmax\_rsa\_key\_length\_in\_bits(\mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__slot_acc712b62a1eba2487a602bc84f2567cf}{algorithms}},\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__slot_ac4313bd333015ea2ae50240ed379da60}{n\_algorithms}},}
\DoxyCodeLine{00336\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a05dd610acfc36d8ca4581d4d22ae1521}{pInfo}}-\/>ulMinKeySize,}
\DoxyCodeLine{00337\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a05dd610acfc36d8ca4581d4d22ae1521}{pInfo}}-\/>ulMaxKeySize);}
\DoxyCodeLine{00338\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a05dd610acfc36d8ca4581d4d22ae1521}{pInfo}}-\/>\mbox{\hyperlink{structck__slot__info_ad23902c9bb73c7da64bb65cb4f9bea4f}{flags}}\ |=\ \mbox{\hyperlink{pkcs11_8h_aea7a734e6feea5f300b8c188807b6f76}{CKF\_HW}}\ |\ \mbox{\hyperlink{pkcs11_8h_aabafbd0a0b5159b08d81f4c63f8665e1}{CKF\_SIGN}};}
\DoxyCodeLine{00339\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00340\ }
\DoxyCodeLine{00341\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ad4f5697408b23623c904df2b1ca8a9f1}{CKM\_RSA\_PKCS\_PSS}}:}
\DoxyCodeLine{00342\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ad5943f11b67c32a40d4d6687e9cbb64b}{CKM\_SHA1\_RSA\_PKCS\_PSS}}:}
\DoxyCodeLine{00343\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ad336fbe2d222fc913c70dd56fabf7f7e}{CKM\_SHA256\_RSA\_PKCS\_PSS}}:}
\DoxyCodeLine{00344\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ae5a8bfa905dc8dab5b2130a8bb6b23fb}{CKM\_SHA384\_RSA\_PKCS\_PSS}}:}
\DoxyCodeLine{00345\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a67393bc84515cf68048ca3b3bb8b39a0}{CKM\_SHA512\_RSA\_PKCS\_PSS}}:}
\DoxyCodeLine{00346\ \ \ \ \ \ \ find\_minmax\_rsa\_key\_length\_in\_bits(\mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__slot_acc712b62a1eba2487a602bc84f2567cf}{algorithms}},\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__slot_ac4313bd333015ea2ae50240ed379da60}{n\_algorithms}},}
\DoxyCodeLine{00347\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a05dd610acfc36d8ca4581d4d22ae1521}{pInfo}}-\/>ulMinKeySize,}
\DoxyCodeLine{00348\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a05dd610acfc36d8ca4581d4d22ae1521}{pInfo}}-\/>ulMaxKeySize);}
\DoxyCodeLine{00349\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a05dd610acfc36d8ca4581d4d22ae1521}{pInfo}}-\/>\mbox{\hyperlink{structck__slot__info_ad23902c9bb73c7da64bb65cb4f9bea4f}{flags}}\ =\ \mbox{\hyperlink{pkcs11_8h_aea7a734e6feea5f300b8c188807b6f76}{CKF\_HW}}\ |\ \mbox{\hyperlink{pkcs11_8h_aabafbd0a0b5159b08d81f4c63f8665e1}{CKF\_SIGN}};}
\DoxyCodeLine{00350\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00351\ }
\DoxyCodeLine{00352\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a69da8859ad1e6b4f424d071b42ea4a0c}{CKM\_RSA\_PKCS\_OAEP}}:}
\DoxyCodeLine{00353\ \ \ \ \ \ \ find\_minmax\_rsa\_key\_length\_in\_bits(\mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__slot_acc712b62a1eba2487a602bc84f2567cf}{algorithms}},\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__slot_ac4313bd333015ea2ae50240ed379da60}{n\_algorithms}},}
\DoxyCodeLine{00354\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a05dd610acfc36d8ca4581d4d22ae1521}{pInfo}}-\/>ulMinKeySize,}
\DoxyCodeLine{00355\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a05dd610acfc36d8ca4581d4d22ae1521}{pInfo}}-\/>ulMaxKeySize);}
\DoxyCodeLine{00356\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a05dd610acfc36d8ca4581d4d22ae1521}{pInfo}}-\/>\mbox{\hyperlink{structck__slot__info_ad23902c9bb73c7da64bb65cb4f9bea4f}{flags}}\ =\ \mbox{\hyperlink{pkcs11_8h_aea7a734e6feea5f300b8c188807b6f76}{CKF\_HW}}\ |\ \mbox{\hyperlink{pkcs11_8h_acd1d6f14eb6ae040a3c7e015c7c1932a}{CKF\_DECRYPT}};}
\DoxyCodeLine{00357\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00358\ }
\DoxyCodeLine{00359\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a3afa7970e62cb983de2f2b46af9ac43f}{CKM\_RSA\_PKCS\_KEY\_PAIR\_GEN}}:}
\DoxyCodeLine{00360\ \ \ \ \ \ \ find\_minmax\_rsa\_key\_length\_in\_bits(\mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__slot_acc712b62a1eba2487a602bc84f2567cf}{algorithms}},\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__slot_ac4313bd333015ea2ae50240ed379da60}{n\_algorithms}},}
\DoxyCodeLine{00361\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a05dd610acfc36d8ca4581d4d22ae1521}{pInfo}}-\/>ulMinKeySize,}
\DoxyCodeLine{00362\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a05dd610acfc36d8ca4581d4d22ae1521}{pInfo}}-\/>ulMaxKeySize);}
\DoxyCodeLine{00363\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a05dd610acfc36d8ca4581d4d22ae1521}{pInfo}}-\/>\mbox{\hyperlink{structck__slot__info_ad23902c9bb73c7da64bb65cb4f9bea4f}{flags}}\ =\ \mbox{\hyperlink{pkcs11_8h_aea7a734e6feea5f300b8c188807b6f76}{CKF\_HW}}\ |\ \mbox{\hyperlink{pkcs11_8h_a65d664264811a9964c30b46967f471d3}{CKF\_GENERATE\_KEY\_PAIR}};}
\DoxyCodeLine{00364\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00365\ }
\DoxyCodeLine{00366\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a95733c79b5297ea9ac28476e680ad4fa}{CKM\_EC\_KEY\_PAIR\_GEN}}:}
\DoxyCodeLine{00367\ \ \ \ \ \ \ find\_minmax\_ec\_key\_length\_in\_bits(\mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__slot_acc712b62a1eba2487a602bc84f2567cf}{algorithms}},\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__slot_ac4313bd333015ea2ae50240ed379da60}{n\_algorithms}},}
\DoxyCodeLine{00368\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a05dd610acfc36d8ca4581d4d22ae1521}{pInfo}}-\/>ulMinKeySize,}
\DoxyCodeLine{00369\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a05dd610acfc36d8ca4581d4d22ae1521}{pInfo}}-\/>ulMaxKeySize);}
\DoxyCodeLine{00370\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a05dd610acfc36d8ca4581d4d22ae1521}{pInfo}}-\/>\mbox{\hyperlink{structck__slot__info_ad23902c9bb73c7da64bb65cb4f9bea4f}{flags}}\ =\ \mbox{\hyperlink{pkcs11_8h_aea7a734e6feea5f300b8c188807b6f76}{CKF\_HW}}\ |\ \mbox{\hyperlink{pkcs11_8h_a65d664264811a9964c30b46967f471d3}{CKF\_GENERATE\_KEY\_PAIR}}\ |\ \mbox{\hyperlink{pkcs11_8h_a605a609c288ffcd840a307f4d4458cbb}{CKF\_EC\_F\_P}}\ |}
\DoxyCodeLine{00371\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{pkcs11_8h_a827fe376bd75e653038cd5af22f8e069}{CKF\_EC\_ECPARAMETERS}}\ |\ \mbox{\hyperlink{pkcs11_8h_a1084ffbde21a69579b39084c3ec866de}{CKF\_EC\_UNCOMPRESS}};}
\DoxyCodeLine{00372\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00373\ }
\DoxyCodeLine{00374\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a1eb3f4cee46e624bfbbc6889e1e5bc06}{CKM\_SHA\_1\_HMAC}}:}
\DoxyCodeLine{00375\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a05dd610acfc36d8ca4581d4d22ae1521}{pInfo}}-\/>ulMaxKeySize\ =\ 64\ *\ 8;}
\DoxyCodeLine{00376\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a05dd610acfc36d8ca4581d4d22ae1521}{pInfo}}-\/>ulMinKeySize\ =\ 1;}
\DoxyCodeLine{00377\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a05dd610acfc36d8ca4581d4d22ae1521}{pInfo}}-\/>\mbox{\hyperlink{structck__slot__info_ad23902c9bb73c7da64bb65cb4f9bea4f}{flags}}\ =\ \mbox{\hyperlink{pkcs11_8h_aea7a734e6feea5f300b8c188807b6f76}{CKF\_HW}}\ |\ \mbox{\hyperlink{pkcs11_8h_aabafbd0a0b5159b08d81f4c63f8665e1}{CKF\_SIGN}}\ |\ \mbox{\hyperlink{pkcs11_8h_a2abb8871b559a956beb841e811a0acf3}{CKF\_VERIFY}};}
\DoxyCodeLine{00378\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00379\ }
\DoxyCodeLine{00380\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a839f51ab9e78e866f1d3773b8466b011}{CKM\_SHA256\_HMAC}}:}
\DoxyCodeLine{00381\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a05dd610acfc36d8ca4581d4d22ae1521}{pInfo}}-\/>ulMaxKeySize\ =\ 64\ *\ 8;}
\DoxyCodeLine{00382\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a05dd610acfc36d8ca4581d4d22ae1521}{pInfo}}-\/>ulMinKeySize\ =\ 1;}
\DoxyCodeLine{00383\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a05dd610acfc36d8ca4581d4d22ae1521}{pInfo}}-\/>\mbox{\hyperlink{structck__slot__info_ad23902c9bb73c7da64bb65cb4f9bea4f}{flags}}\ =\ \mbox{\hyperlink{pkcs11_8h_aea7a734e6feea5f300b8c188807b6f76}{CKF\_HW}}\ |\ \mbox{\hyperlink{pkcs11_8h_aabafbd0a0b5159b08d81f4c63f8665e1}{CKF\_SIGN}}\ |\ \mbox{\hyperlink{pkcs11_8h_a2abb8871b559a956beb841e811a0acf3}{CKF\_VERIFY}};}
\DoxyCodeLine{00384\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00385\ }
\DoxyCodeLine{00386\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a97ee18b73f21e8047fadc8a0aa12f23a}{CKM\_SHA384\_HMAC}}:}
\DoxyCodeLine{00387\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a05dd610acfc36d8ca4581d4d22ae1521}{pInfo}}-\/>ulMaxKeySize\ =\ 128\ *\ 8;}
\DoxyCodeLine{00388\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a05dd610acfc36d8ca4581d4d22ae1521}{pInfo}}-\/>ulMinKeySize\ =\ 1;}
\DoxyCodeLine{00389\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a05dd610acfc36d8ca4581d4d22ae1521}{pInfo}}-\/>\mbox{\hyperlink{structck__slot__info_ad23902c9bb73c7da64bb65cb4f9bea4f}{flags}}\ =\ \mbox{\hyperlink{pkcs11_8h_aea7a734e6feea5f300b8c188807b6f76}{CKF\_HW}}\ |\ \mbox{\hyperlink{pkcs11_8h_aabafbd0a0b5159b08d81f4c63f8665e1}{CKF\_SIGN}}\ |\ \mbox{\hyperlink{pkcs11_8h_a2abb8871b559a956beb841e811a0acf3}{CKF\_VERIFY}};}
\DoxyCodeLine{00390\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00391\ }
\DoxyCodeLine{00392\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ae1b850f9141aa407e45b02fa3ade3759}{CKM\_SHA512\_HMAC}}:}
\DoxyCodeLine{00393\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a05dd610acfc36d8ca4581d4d22ae1521}{pInfo}}-\/>ulMaxKeySize\ =\ 128\ *\ 8;}
\DoxyCodeLine{00394\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a05dd610acfc36d8ca4581d4d22ae1521}{pInfo}}-\/>ulMinKeySize\ =\ 1;}
\DoxyCodeLine{00395\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a05dd610acfc36d8ca4581d4d22ae1521}{pInfo}}-\/>\mbox{\hyperlink{structck__slot__info_ad23902c9bb73c7da64bb65cb4f9bea4f}{flags}}\ =\ \mbox{\hyperlink{pkcs11_8h_aea7a734e6feea5f300b8c188807b6f76}{CKF\_HW}}\ |\ \mbox{\hyperlink{pkcs11_8h_aabafbd0a0b5159b08d81f4c63f8665e1}{CKF\_SIGN}}\ |\ \mbox{\hyperlink{pkcs11_8h_a2abb8871b559a956beb841e811a0acf3}{CKF\_VERIFY}};}
\DoxyCodeLine{00396\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00397\ }
\DoxyCodeLine{00398\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ab4a7299a144f0ef52cee06893cc60483}{CKM\_ECDSA}}:}
\DoxyCodeLine{00399\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a0911727b2cd926b9209f24bf50bc555a}{CKM\_ECDSA\_SHA1}}:}
\DoxyCodeLine{00400\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ac7f12f2ee83f0ca3b309b22e5b48e486}{CKM\_ECDSA\_SHA256}}:}
\DoxyCodeLine{00401\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ab4aaed0f4b4146b812c6cff25828fcfd}{CKM\_ECDSA\_SHA384}}:}
\DoxyCodeLine{00402\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a69a7674eee1a8069128923037b504e59}{CKM\_ECDSA\_SHA512}}:}
\DoxyCodeLine{00403\ \ \ \ \ \ \ \textcolor{comment}{//\ should\ all\ ecdsa\ mechanisms\ have\ all\ keylengths?\ or\ should\ they\ be}}
\DoxyCodeLine{00404\ \ \ \ \ \ \ \textcolor{comment}{//\ bounded\ to\ length\ of\ hash?}}
\DoxyCodeLine{00405\ \ \ \ \ \ \ find\_minmax\_ec\_key\_length\_in\_bits(\mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__slot_acc712b62a1eba2487a602bc84f2567cf}{algorithms}},\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__slot_ac4313bd333015ea2ae50240ed379da60}{n\_algorithms}},}
\DoxyCodeLine{00406\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a05dd610acfc36d8ca4581d4d22ae1521}{pInfo}}-\/>ulMinKeySize,}
\DoxyCodeLine{00407\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a05dd610acfc36d8ca4581d4d22ae1521}{pInfo}}-\/>ulMaxKeySize);}
\DoxyCodeLine{00408\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a05dd610acfc36d8ca4581d4d22ae1521}{pInfo}}-\/>\mbox{\hyperlink{structck__slot__info_ad23902c9bb73c7da64bb65cb4f9bea4f}{flags}}\ =\ \mbox{\hyperlink{pkcs11_8h_aea7a734e6feea5f300b8c188807b6f76}{CKF\_HW}}\ |\ \mbox{\hyperlink{pkcs11_8h_aabafbd0a0b5159b08d81f4c63f8665e1}{CKF\_SIGN}}\ |\ \mbox{\hyperlink{pkcs11_8h_a605a609c288ffcd840a307f4d4458cbb}{CKF\_EC\_F\_P}}\ |\ \mbox{\hyperlink{pkcs11_8h_a827fe376bd75e653038cd5af22f8e069}{CKF\_EC\_ECPARAMETERS}}\ |}
\DoxyCodeLine{00409\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{pkcs11_8h_a1084ffbde21a69579b39084c3ec866de}{CKF\_EC\_UNCOMPRESS}};}
\DoxyCodeLine{00410\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00411\ }
\DoxyCodeLine{00412\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a2d5867eec8e2621a31f108010f2dce97}{CKM\_ECDH1\_DERIVE}}:}
\DoxyCodeLine{00413\ \ \ \ \ \ \ find\_minmax\_ec\_key\_length\_in\_bits(\mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__slot_acc712b62a1eba2487a602bc84f2567cf}{algorithms}},\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__slot_ac4313bd333015ea2ae50240ed379da60}{n\_algorithms}},}
\DoxyCodeLine{00414\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a05dd610acfc36d8ca4581d4d22ae1521}{pInfo}}-\/>ulMinKeySize,}
\DoxyCodeLine{00415\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a05dd610acfc36d8ca4581d4d22ae1521}{pInfo}}-\/>ulMaxKeySize);}
\DoxyCodeLine{00416\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a05dd610acfc36d8ca4581d4d22ae1521}{pInfo}}-\/>\mbox{\hyperlink{structck__slot__info_ad23902c9bb73c7da64bb65cb4f9bea4f}{flags}}\ =\ \mbox{\hyperlink{pkcs11_8h_aea7a734e6feea5f300b8c188807b6f76}{CKF\_HW}}\ |\ \mbox{\hyperlink{pkcs11_8h_a23c6556641b62243c52ddc5f683889e5}{CKF\_DERIVE}}\ |\ \mbox{\hyperlink{pkcs11_8h_a605a609c288ffcd840a307f4d4458cbb}{CKF\_EC\_F\_P}}\ |\ \mbox{\hyperlink{pkcs11_8h_a827fe376bd75e653038cd5af22f8e069}{CKF\_EC\_ECPARAMETERS}}\ |}
\DoxyCodeLine{00417\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{pkcs11_8h_a1084ffbde21a69579b39084c3ec866de}{CKF\_EC\_UNCOMPRESS}};}
\DoxyCodeLine{00418\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00419\ }
\DoxyCodeLine{00420\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_af1818a1c453a84f01f2e868307ca8fed}{CKM\_SHA\_1}}:}
\DoxyCodeLine{00421\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a05dd610acfc36d8ca4581d4d22ae1521}{pInfo}}-\/>ulMaxKeySize\ =\ 0;\ \textcolor{comment}{//\ NOTE(adma):\ ignored}}
\DoxyCodeLine{00422\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a05dd610acfc36d8ca4581d4d22ae1521}{pInfo}}-\/>ulMinKeySize\ =\ 0;\ \textcolor{comment}{//\ NOTE(adma):\ ignored}}
\DoxyCodeLine{00423\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a05dd610acfc36d8ca4581d4d22ae1521}{pInfo}}-\/>\mbox{\hyperlink{structck__slot__info_ad23902c9bb73c7da64bb65cb4f9bea4f}{flags}}\ =\ \mbox{\hyperlink{pkcs11_8h_a229d4341889a170fb829e3a63736c202}{CKF\_DIGEST}};}
\DoxyCodeLine{00424\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00425\ }
\DoxyCodeLine{00426\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a4d11f88ae3bea2f748f275c03b54a648}{CKM\_SHA256}}:}
\DoxyCodeLine{00427\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a05dd610acfc36d8ca4581d4d22ae1521}{pInfo}}-\/>ulMaxKeySize\ =\ 0;\ \textcolor{comment}{//\ NOTE(adma):\ ignored}}
\DoxyCodeLine{00428\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a05dd610acfc36d8ca4581d4d22ae1521}{pInfo}}-\/>ulMinKeySize\ =\ 0;\ \textcolor{comment}{//\ NOTE(adma):\ ignored}}
\DoxyCodeLine{00429\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a05dd610acfc36d8ca4581d4d22ae1521}{pInfo}}-\/>\mbox{\hyperlink{structck__slot__info_ad23902c9bb73c7da64bb65cb4f9bea4f}{flags}}\ =\ \mbox{\hyperlink{pkcs11_8h_a229d4341889a170fb829e3a63736c202}{CKF\_DIGEST}};}
\DoxyCodeLine{00430\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00431\ }
\DoxyCodeLine{00432\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a9278e01971ca83cdd07e4b8e07a00bc8}{CKM\_SHA384}}:}
\DoxyCodeLine{00433\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a05dd610acfc36d8ca4581d4d22ae1521}{pInfo}}-\/>ulMaxKeySize\ =\ 0;\ \textcolor{comment}{//\ NOTE(adma):\ ignored}}
\DoxyCodeLine{00434\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a05dd610acfc36d8ca4581d4d22ae1521}{pInfo}}-\/>ulMinKeySize\ =\ 0;\ \textcolor{comment}{//\ NOTE(adma):\ ignored}}
\DoxyCodeLine{00435\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a05dd610acfc36d8ca4581d4d22ae1521}{pInfo}}-\/>\mbox{\hyperlink{structck__slot__info_ad23902c9bb73c7da64bb65cb4f9bea4f}{flags}}\ =\ \mbox{\hyperlink{pkcs11_8h_a229d4341889a170fb829e3a63736c202}{CKF\_DIGEST}};}
\DoxyCodeLine{00436\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00437\ }
\DoxyCodeLine{00438\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a9bf4bf7375a24e1010cc8e0139608fd5}{CKM\_SHA512}}:}
\DoxyCodeLine{00439\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a05dd610acfc36d8ca4581d4d22ae1521}{pInfo}}-\/>ulMaxKeySize\ =\ 0;\ \textcolor{comment}{//\ NOTE(adma):\ ignored}}
\DoxyCodeLine{00440\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a05dd610acfc36d8ca4581d4d22ae1521}{pInfo}}-\/>ulMinKeySize\ =\ 0;\ \textcolor{comment}{//\ NOTE(adma):\ ignored}}
\DoxyCodeLine{00441\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a05dd610acfc36d8ca4581d4d22ae1521}{pInfo}}-\/>\mbox{\hyperlink{structck__slot__info_ad23902c9bb73c7da64bb65cb4f9bea4f}{flags}}\ =\ \mbox{\hyperlink{pkcs11_8h_a229d4341889a170fb829e3a63736c202}{CKF\_DIGEST}};}
\DoxyCodeLine{00442\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00443\ }
\DoxyCodeLine{00444\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11y_8h_a631efbda997696a7f7ce71df0e3e779a}{CKM\_YUBICO\_AES\_CCM\_WRAP}}:}
\DoxyCodeLine{00445\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a05dd610acfc36d8ca4581d4d22ae1521}{pInfo}}-\/>ulMaxKeySize\ =\ 256;}
\DoxyCodeLine{00446\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a05dd610acfc36d8ca4581d4d22ae1521}{pInfo}}-\/>ulMinKeySize\ =\ 128;}
\DoxyCodeLine{00447\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a05dd610acfc36d8ca4581d4d22ae1521}{pInfo}}-\/>\mbox{\hyperlink{structck__slot__info_ad23902c9bb73c7da64bb65cb4f9bea4f}{flags}}\ =\ \mbox{\hyperlink{pkcs11_8h_aea7a734e6feea5f300b8c188807b6f76}{CKF\_HW}}\ |\ \mbox{\hyperlink{pkcs11_8h_a59bfbfe9b1d0e00f597c24ef0298800e}{CKF\_WRAP}}\ |\ \mbox{\hyperlink{pkcs11_8h_ac2643984bf74f2cb5809609bbd65139c}{CKF\_UNWRAP}}\ |\ \mbox{\hyperlink{pkcs11_8h_a7dde8a50600132eb8094044d1f0998d2}{CKF\_ENCRYPT}}\ |\ \mbox{\hyperlink{pkcs11_8h_acd1d6f14eb6ae040a3c7e015c7c1932a}{CKF\_DECRYPT}};}
\DoxyCodeLine{00448\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00449\ }
\DoxyCodeLine{00450\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a8eb5ca4355d60dcf974107f95e38784b}{CKM\_GENERIC\_SECRET\_KEY\_GEN}}:}
\DoxyCodeLine{00451\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a05dd610acfc36d8ca4581d4d22ae1521}{pInfo}}-\/>ulMaxKeySize\ =}
\DoxyCodeLine{00452\ \ \ \ \ \ \ \ \ 128\ *\ 8;\ \textcolor{comment}{//\ NOTE:\ 128*8\ is\ max\ key\ size\ for\ sha512-\/hmac\ keys}}
\DoxyCodeLine{00453\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a05dd610acfc36d8ca4581d4d22ae1521}{pInfo}}-\/>ulMinKeySize\ =\ 1;}
\DoxyCodeLine{00454\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a05dd610acfc36d8ca4581d4d22ae1521}{pInfo}}-\/>\mbox{\hyperlink{structck__slot__info_ad23902c9bb73c7da64bb65cb4f9bea4f}{flags}}\ =\ \mbox{\hyperlink{pkcs11_8h_aea7a734e6feea5f300b8c188807b6f76}{CKF\_HW}}\ |\ \mbox{\hyperlink{pkcs11_8h_aad6849aadd67cb59175fc72c854d033a}{CKF\_GENERATE}};}
\DoxyCodeLine{00455\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00456\ }
\DoxyCodeLine{00457\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00458\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00459\ \ \ \}}
\DoxyCodeLine{00460\ }
\DoxyCodeLine{00461\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00462\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{util__pkcs11_8c_a95f1c61424aa67f782a360e59c6cee84_cgraph}
\end{center}
\end{figure}
\Hypertarget{util__pkcs11_8c_a064731f36eb972f687b4059dc5f340db}\index{util\_pkcs11.c@{util\_pkcs11.c}!get\_mechanism\_list@{get\_mechanism\_list}}
\index{get\_mechanism\_list@{get\_mechanism\_list}!util\_pkcs11.c@{util\_pkcs11.c}}
\doxysubsubsection{\texorpdfstring{get\_mechanism\_list()}{get\_mechanism\_list()}}
{\footnotesize\ttfamily \label{util__pkcs11_8c_a064731f36eb972f687b4059dc5f340db} 
CK\+\_\+\+RV get\+\_\+mechanism\+\_\+list (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__pkcs11__slot}{yubihsm\+\_\+pkcs11\+\_\+slot}} \texorpdfstring{$\ast$}{*}}]{slot}{, }\item[{\mbox{\hyperlink{pkcs11_8h_a29744979fe73c2061a1d39987f063679}{CK\+\_\+\+MECHANISM\+\_\+\+TYPE\+\_\+\+PTR}}}]{p\+Mechanism\+List}{, }\item[{\mbox{\hyperlink{pkcs11_8h_a2c6426aaa1ca6dd1f48a01b8490482fa}{CK\+\_\+\+ULONG\+\_\+\+PTR}}}]{count}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{util__pkcs11_8c_source_l00073}{73}} of file \mbox{\hyperlink{util__pkcs11_8c_source}{util\+\_\+pkcs11.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00075\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00076\ }
\DoxyCodeLine{00077\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__slot_ac4313bd333015ea2ae50240ed379da60}{n\_algorithms}}\ ==\ 0)\ \{}
\DoxyCodeLine{00078\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__slot_ac4313bd333015ea2ae50240ed379da60}{n\_algorithms}}\ =\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__slot_acc712b62a1eba2487a602bc84f2567cf}{algorithms}})\ /\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__slot_acc712b62a1eba2487a602bc84f2567cf}{algorithms}}[0]);}
\DoxyCodeLine{00079\ \ \ \ \ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366}{yh\_rc}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =}
\DoxyCodeLine{00080\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm_8c_a6ab558e1426359cc78e7a362f8b3acd9}{yh\_util\_get\_device\_info}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__slot_a8022d3426b090c01b082636562f7c013}{connector}},\ NULL,\ NULL,\ NULL,\ NULL,\ NULL,}
\DoxyCodeLine{00081\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ NULL,\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__slot_acc712b62a1eba2487a602bc84f2567cf}{algorithms}},\ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__slot_ac4313bd333015ea2ae50240ed379da60}{n\_algorithms}});}
\DoxyCodeLine{00082\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{00083\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a91150ecacbaa624fcc7d861f1b54f57c}{CKR\_FUNCTION\_FAILED}};}
\DoxyCodeLine{00084\ \ \ \ \ \}}
\DoxyCodeLine{00085\ \ \ \}}
\DoxyCodeLine{00086\ }
\DoxyCodeLine{00087\ \ \ CK\_MECHANISM\_TYPE\ buffer[128];\ \textcolor{comment}{//\ NOTE:\ this\ is\ a\ bit\ hardcoded,\ but\ much\ more}}
\DoxyCodeLine{00088\ \ \ \textcolor{comment}{//\ than\ what\ we\ might\ add\ below.}}
\DoxyCodeLine{00089\ \ \ \mbox{\hyperlink{pkcs11_8h_a35181858a3b7a0a81f49d180d8f446ef}{CK\_ULONG}}\ items\ =\ 0;}
\DoxyCodeLine{00090\ }
\DoxyCodeLine{00091\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__slot_ac4313bd333015ea2ae50240ed379da60}{n\_algorithms}};\ i++)\ \{}
\DoxyCodeLine{00092\ \ \ \ \ \textcolor{keywordflow}{switch}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__slot_acc712b62a1eba2487a602bc84f2567cf}{algorithms}}[i])\ \{}
\DoxyCodeLine{00093\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa1982e3db182a679514674f454e2b79ad}{YH\_ALGO\_RSA\_PKCS1\_SHA1}}:}
\DoxyCodeLine{00094\ \ \ \ \ \ \ \ \ add\_mech(buffer,\ \&items,\ \mbox{\hyperlink{pkcs11_8h_a08a8e0f2109de3ff3bfe26f220447a2e}{CKM\_RSA\_PKCS}});}
\DoxyCodeLine{00095\ \ \ \ \ \ \ \ \ add\_mech(buffer,\ \&items,\ \mbox{\hyperlink{pkcs11_8h_a9b5d495ac404ebbce07d1f58436ee31d}{CKM\_SHA1\_RSA\_PKCS}});}
\DoxyCodeLine{00096\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00097\ }
\DoxyCodeLine{00098\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa18e17370fcf9a829572e57608aff743c}{YH\_ALGO\_RSA\_PKCS1\_SHA256}}:}
\DoxyCodeLine{00099\ \ \ \ \ \ \ \ \ add\_mech(buffer,\ \&items,\ \mbox{\hyperlink{pkcs11_8h_a08a8e0f2109de3ff3bfe26f220447a2e}{CKM\_RSA\_PKCS}});}
\DoxyCodeLine{00100\ \ \ \ \ \ \ \ \ add\_mech(buffer,\ \&items,\ \mbox{\hyperlink{pkcs11_8h_ae24525658e8df0829c24236ee7614d1f}{CKM\_SHA256\_RSA\_PKCS}});}
\DoxyCodeLine{00101\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00102\ }
\DoxyCodeLine{00103\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caafc78c2f62fe0a185c38d2644755fde2c}{YH\_ALGO\_RSA\_PKCS1\_SHA384}}:}
\DoxyCodeLine{00104\ \ \ \ \ \ \ \ \ add\_mech(buffer,\ \&items,\ \mbox{\hyperlink{pkcs11_8h_a08a8e0f2109de3ff3bfe26f220447a2e}{CKM\_RSA\_PKCS}});}
\DoxyCodeLine{00105\ \ \ \ \ \ \ \ \ add\_mech(buffer,\ \&items,\ \mbox{\hyperlink{pkcs11_8h_ad8d3d34082b7e18f4f173804cf5b959b}{CKM\_SHA384\_RSA\_PKCS}});}
\DoxyCodeLine{00106\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00107\ }
\DoxyCodeLine{00108\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa84e18ba6561d5a834dc8d794504708db}{YH\_ALGO\_RSA\_PKCS1\_SHA512}}:}
\DoxyCodeLine{00109\ \ \ \ \ \ \ \ \ add\_mech(buffer,\ \&items,\ \mbox{\hyperlink{pkcs11_8h_a08a8e0f2109de3ff3bfe26f220447a2e}{CKM\_RSA\_PKCS}});}
\DoxyCodeLine{00110\ \ \ \ \ \ \ \ \ add\_mech(buffer,\ \&items,\ \mbox{\hyperlink{pkcs11_8h_a6c0c89dfd22474095772f87d25c6a17d}{CKM\_SHA512\_RSA\_PKCS}});}
\DoxyCodeLine{00111\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00112\ }
\DoxyCodeLine{00113\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa24d40fa957c584cf2ef0f5b0053b9f32}{YH\_ALGO\_RSA\_PSS\_SHA1}}:}
\DoxyCodeLine{00114\ \ \ \ \ \ \ \ \ add\_mech(buffer,\ \&items,\ \mbox{\hyperlink{pkcs11_8h_ad4f5697408b23623c904df2b1ca8a9f1}{CKM\_RSA\_PKCS\_PSS}});}
\DoxyCodeLine{00115\ \ \ \ \ \ \ \ \ add\_mech(buffer,\ \&items,\ \mbox{\hyperlink{pkcs11_8h_ad5943f11b67c32a40d4d6687e9cbb64b}{CKM\_SHA1\_RSA\_PKCS\_PSS}});}
\DoxyCodeLine{00116\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00117\ }
\DoxyCodeLine{00118\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caac42381f876f5e7190547cf81021451f5}{YH\_ALGO\_RSA\_PSS\_SHA256}}:}
\DoxyCodeLine{00119\ \ \ \ \ \ \ \ \ add\_mech(buffer,\ \&items,\ \mbox{\hyperlink{pkcs11_8h_ad4f5697408b23623c904df2b1ca8a9f1}{CKM\_RSA\_PKCS\_PSS}});}
\DoxyCodeLine{00120\ \ \ \ \ \ \ \ \ add\_mech(buffer,\ \&items,\ \mbox{\hyperlink{pkcs11_8h_ad336fbe2d222fc913c70dd56fabf7f7e}{CKM\_SHA256\_RSA\_PKCS\_PSS}});}
\DoxyCodeLine{00121\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00122\ }
\DoxyCodeLine{00123\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa144083d6414cb33e8543d51e7d361d05}{YH\_ALGO\_RSA\_PSS\_SHA384}}:}
\DoxyCodeLine{00124\ \ \ \ \ \ \ \ \ add\_mech(buffer,\ \&items,\ \mbox{\hyperlink{pkcs11_8h_ad4f5697408b23623c904df2b1ca8a9f1}{CKM\_RSA\_PKCS\_PSS}});}
\DoxyCodeLine{00125\ \ \ \ \ \ \ \ \ add\_mech(buffer,\ \&items,\ \mbox{\hyperlink{pkcs11_8h_ae5a8bfa905dc8dab5b2130a8bb6b23fb}{CKM\_SHA384\_RSA\_PKCS\_PSS}});}
\DoxyCodeLine{00126\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00127\ }
\DoxyCodeLine{00128\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa1d5a50a1a53000cd2b2989c17703e2d1}{YH\_ALGO\_RSA\_PSS\_SHA512}}:}
\DoxyCodeLine{00129\ \ \ \ \ \ \ \ \ add\_mech(buffer,\ \&items,\ \mbox{\hyperlink{pkcs11_8h_ad4f5697408b23623c904df2b1ca8a9f1}{CKM\_RSA\_PKCS\_PSS}});}
\DoxyCodeLine{00130\ \ \ \ \ \ \ \ \ add\_mech(buffer,\ \&items,\ \mbox{\hyperlink{pkcs11_8h_a67393bc84515cf68048ca3b3bb8b39a0}{CKM\_SHA512\_RSA\_PKCS\_PSS}});}
\DoxyCodeLine{00131\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00132\ }
\DoxyCodeLine{00133\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caaafe94e6a770edb51c6db84f77d98d2c6}{YH\_ALGO\_RSA\_2048}}:}
\DoxyCodeLine{00134\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caafd3fbd9ed86caf267ccc77cb24d44426}{YH\_ALGO\_RSA\_3072}}:}
\DoxyCodeLine{00135\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caae5963322a0a0f43a1b74faa78e3a7329}{YH\_ALGO\_RSA\_4096}}:}
\DoxyCodeLine{00136\ \ \ \ \ \ \ \ \ add\_mech(buffer,\ \&items,\ \mbox{\hyperlink{pkcs11_8h_a3afa7970e62cb983de2f2b46af9ac43f}{CKM\_RSA\_PKCS\_KEY\_PAIR\_GEN}});}
\DoxyCodeLine{00137\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00138\ }
\DoxyCodeLine{00139\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caaedcbc07d82b18ca5c21eb3379a6cc010}{YH\_ALGO\_EC\_P224}}:}
\DoxyCodeLine{00140\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caae4b191baf5c65f9234120080264d129b}{YH\_ALGO\_EC\_P256}}:}
\DoxyCodeLine{00141\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa31094c17c66e4c365ca3dad353bc8bda}{YH\_ALGO\_EC\_P384}}:}
\DoxyCodeLine{00142\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa05aec903fd67851f968aaa606fe2138a}{YH\_ALGO\_EC\_P521}}:}
\DoxyCodeLine{00143\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caad423056b13955068935dc8b3ac0e65d1}{YH\_ALGO\_EC\_K256}}:}
\DoxyCodeLine{00144\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caabd995726d45b6dd2388775db4767c80d}{YH\_ALGO\_EC\_BP256}}:}
\DoxyCodeLine{00145\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa228fd3332b55c60438dfea6a1b09af36}{YH\_ALGO\_EC\_BP384}}:}
\DoxyCodeLine{00146\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caab9c1be17b7b3f755346ff8c3cca3ed25}{YH\_ALGO\_EC\_BP512}}:}
\DoxyCodeLine{00147\ \ \ \ \ \ \ \ \ add\_mech(buffer,\ \&items,\ \mbox{\hyperlink{pkcs11_8h_a95733c79b5297ea9ac28476e680ad4fa}{CKM\_EC\_KEY\_PAIR\_GEN}});}
\DoxyCodeLine{00148\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00149\ }
\DoxyCodeLine{00150\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa942e65c8cd0034eebe9a20c2297c7b06}{YH\_ALGO\_HMAC\_SHA1}}:}
\DoxyCodeLine{00151\ \ \ \ \ \ \ \ \ add\_mech(buffer,\ \&items,\ \mbox{\hyperlink{pkcs11_8h_a1eb3f4cee46e624bfbbc6889e1e5bc06}{CKM\_SHA\_1\_HMAC}});}
\DoxyCodeLine{00152\ \ \ \ \ \ \ \ \ add\_mech(buffer,\ \&items,\ \mbox{\hyperlink{pkcs11_8h_a8eb5ca4355d60dcf974107f95e38784b}{CKM\_GENERIC\_SECRET\_KEY\_GEN}});}
\DoxyCodeLine{00153\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00154\ }
\DoxyCodeLine{00155\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caab0a0e1eb424b61057f159f1e53311f5c}{YH\_ALGO\_HMAC\_SHA256}}:}
\DoxyCodeLine{00156\ \ \ \ \ \ \ \ \ add\_mech(buffer,\ \&items,\ \mbox{\hyperlink{pkcs11_8h_a839f51ab9e78e866f1d3773b8466b011}{CKM\_SHA256\_HMAC}});}
\DoxyCodeLine{00157\ \ \ \ \ \ \ \ \ add\_mech(buffer,\ \&items,\ \mbox{\hyperlink{pkcs11_8h_a8eb5ca4355d60dcf974107f95e38784b}{CKM\_GENERIC\_SECRET\_KEY\_GEN}});}
\DoxyCodeLine{00158\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00159\ }
\DoxyCodeLine{00160\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa781e7ca62563917d2129bde8ec53401b}{YH\_ALGO\_HMAC\_SHA384}}:}
\DoxyCodeLine{00161\ \ \ \ \ \ \ \ \ add\_mech(buffer,\ \&items,\ \mbox{\hyperlink{pkcs11_8h_a97ee18b73f21e8047fadc8a0aa12f23a}{CKM\_SHA384\_HMAC}});}
\DoxyCodeLine{00162\ \ \ \ \ \ \ \ \ add\_mech(buffer,\ \&items,\ \mbox{\hyperlink{pkcs11_8h_a8eb5ca4355d60dcf974107f95e38784b}{CKM\_GENERIC\_SECRET\_KEY\_GEN}});}
\DoxyCodeLine{00163\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00164\ }
\DoxyCodeLine{00165\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa72d6c7ea77f10e39bbadc8b58d55b9ec}{YH\_ALGO\_HMAC\_SHA512}}:}
\DoxyCodeLine{00166\ \ \ \ \ \ \ \ \ add\_mech(buffer,\ \&items,\ \mbox{\hyperlink{pkcs11_8h_ae1b850f9141aa407e45b02fa3ade3759}{CKM\_SHA512\_HMAC}});}
\DoxyCodeLine{00167\ \ \ \ \ \ \ \ \ add\_mech(buffer,\ \&items,\ \mbox{\hyperlink{pkcs11_8h_a8eb5ca4355d60dcf974107f95e38784b}{CKM\_GENERIC\_SECRET\_KEY\_GEN}});}
\DoxyCodeLine{00168\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00169\ }
\DoxyCodeLine{00170\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caae9b7b5598c3839a53e4986dc901be244}{YH\_ALGO\_EC\_ECDSA\_SHA1}}:}
\DoxyCodeLine{00171\ \ \ \ \ \ \ \ \ add\_mech(buffer,\ \&items,\ \mbox{\hyperlink{pkcs11_8h_ab4a7299a144f0ef52cee06893cc60483}{CKM\_ECDSA}});}
\DoxyCodeLine{00172\ \ \ \ \ \ \ \ \ add\_mech(buffer,\ \&items,\ \mbox{\hyperlink{pkcs11_8h_a0911727b2cd926b9209f24bf50bc555a}{CKM\_ECDSA\_SHA1}});}
\DoxyCodeLine{00173\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00174\ }
\DoxyCodeLine{00175\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa2e5dfe9c79cb0d391d7bf952227268ec}{YH\_ALGO\_EC\_ECDSA\_SHA256}}:}
\DoxyCodeLine{00176\ \ \ \ \ \ \ \ \ add\_mech(buffer,\ \&items,\ \mbox{\hyperlink{pkcs11_8h_ab4a7299a144f0ef52cee06893cc60483}{CKM\_ECDSA}});}
\DoxyCodeLine{00177\ \ \ \ \ \ \ \ \ add\_mech(buffer,\ \&items,\ \mbox{\hyperlink{pkcs11_8h_ac7f12f2ee83f0ca3b309b22e5b48e486}{CKM\_ECDSA\_SHA256}});}
\DoxyCodeLine{00178\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00179\ }
\DoxyCodeLine{00180\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa657d2b30d884aeeff3c024404132ad69}{YH\_ALGO\_EC\_ECDSA\_SHA384}}:}
\DoxyCodeLine{00181\ \ \ \ \ \ \ \ \ add\_mech(buffer,\ \&items,\ \mbox{\hyperlink{pkcs11_8h_ab4a7299a144f0ef52cee06893cc60483}{CKM\_ECDSA}});}
\DoxyCodeLine{00182\ \ \ \ \ \ \ \ \ add\_mech(buffer,\ \&items,\ \mbox{\hyperlink{pkcs11_8h_ab4aaed0f4b4146b812c6cff25828fcfd}{CKM\_ECDSA\_SHA384}});}
\DoxyCodeLine{00183\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00184\ }
\DoxyCodeLine{00185\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa44153987efd3466070143dbab77f2d70}{YH\_ALGO\_EC\_ECDSA\_SHA512}}:}
\DoxyCodeLine{00186\ \ \ \ \ \ \ \ \ add\_mech(buffer,\ \&items,\ \mbox{\hyperlink{pkcs11_8h_ab4a7299a144f0ef52cee06893cc60483}{CKM\_ECDSA}});}
\DoxyCodeLine{00187\ \ \ \ \ \ \ \ \ add\_mech(buffer,\ \&items,\ \mbox{\hyperlink{pkcs11_8h_a69a7674eee1a8069128923037b504e59}{CKM\_ECDSA\_SHA512}});}
\DoxyCodeLine{00188\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00189\ }
\DoxyCodeLine{00190\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa14b36e4ff3b90d44ace0aa2b2c65ef48}{YH\_ALGO\_EC\_ECDH}}:}
\DoxyCodeLine{00191\ \ \ \ \ \ \ \ \ add\_mech(buffer,\ \&items,\ \mbox{\hyperlink{pkcs11_8h_a2d5867eec8e2621a31f108010f2dce97}{CKM\_ECDH1\_DERIVE}});}
\DoxyCodeLine{00192\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00193\ }
\DoxyCodeLine{00194\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caae9e58613e12b0f9f445e620f1dd77e1d}{YH\_ALGO\_RSA\_OAEP\_SHA1}}:}
\DoxyCodeLine{00195\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa590665f5e23f996daeba0a2586b2ff33}{YH\_ALGO\_RSA\_OAEP\_SHA256}}:}
\DoxyCodeLine{00196\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caab2580ffabb9b08affd0f7803fb1536cd}{YH\_ALGO\_RSA\_OAEP\_SHA384}}:}
\DoxyCodeLine{00197\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caaa4c2625511af2c17ed83da552d3dc5f6}{YH\_ALGO\_RSA\_OAEP\_SHA512}}:}
\DoxyCodeLine{00198\ \ \ \ \ \ \ \ \ add\_mech(buffer,\ \&items,\ \mbox{\hyperlink{pkcs11_8h_a69da8859ad1e6b4f424d071b42ea4a0c}{CKM\_RSA\_PKCS\_OAEP}});}
\DoxyCodeLine{00199\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00200\ }
\DoxyCodeLine{00201\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caae22b228e457c9bdccb5a93d81730b1b1}{YH\_ALGO\_AES128\_CCM\_WRAP}}:}
\DoxyCodeLine{00202\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caab739a1d142dacaf37ba13a73e2d83fab}{YH\_ALGO\_AES192\_CCM\_WRAP}}:}
\DoxyCodeLine{00203\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa927e2246e5657f946b4da4b71092b022}{YH\_ALGO\_AES256\_CCM\_WRAP}}:}
\DoxyCodeLine{00204\ \ \ \ \ \ \ \ \ add\_mech(buffer,\ \&items,\ \mbox{\hyperlink{pkcs11y_8h_a631efbda997696a7f7ce71df0e3e779a}{CKM\_YUBICO\_AES\_CCM\_WRAP}});}
\DoxyCodeLine{00205\ \ \ \ \ \ \ \ \ add\_mech(buffer,\ \&items,\ \mbox{\hyperlink{pkcs11_8h_a8eb5ca4355d60dcf974107f95e38784b}{CKM\_GENERIC\_SECRET\_KEY\_GEN}});}
\DoxyCodeLine{00206\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00207\ }
\DoxyCodeLine{00208\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ NOTE:\ there\ are\ algorithms\ don't\ have\ corresponding\ mechanisms}}
\DoxyCodeLine{00209\ \ \ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00210\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00211\ \ \ \ \ \}}
\DoxyCodeLine{00212\ \ \ \}}
\DoxyCodeLine{00213\ }
\DoxyCodeLine{00214\ \ \ \textcolor{comment}{//\ NOTE(adma):\ manually\ add\ digest\ mechanisms}}
\DoxyCodeLine{00215\ \ \ add\_mech(buffer,\ \&items,\ \mbox{\hyperlink{pkcs11_8h_af1818a1c453a84f01f2e868307ca8fed}{CKM\_SHA\_1}});}
\DoxyCodeLine{00216\ \ \ add\_mech(buffer,\ \&items,\ \mbox{\hyperlink{pkcs11_8h_a4d11f88ae3bea2f748f275c03b54a648}{CKM\_SHA256}});}
\DoxyCodeLine{00217\ \ \ add\_mech(buffer,\ \&items,\ \mbox{\hyperlink{pkcs11_8h_a9278e01971ca83cdd07e4b8e07a00bc8}{CKM\_SHA384}});}
\DoxyCodeLine{00218\ \ \ add\_mech(buffer,\ \&items,\ \mbox{\hyperlink{pkcs11_8h_a9bf4bf7375a24e1010cc8e0139608fd5}{CKM\_SHA512}});}
\DoxyCodeLine{00219\ }
\DoxyCodeLine{00220\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a837cbbce04f92271824debc2c15b6ab6}{pMechanismList}}\ !=\ NULL)\ \{}
\DoxyCodeLine{00221\ \ \ \ \ \textcolor{keywordflow}{if}\ (items\ >\ *\mbox{\hyperlink{gmock__stress__test_8cc_afd9db40e3361ae09188795e8cbe19752}{count}})\ \{}
\DoxyCodeLine{00222\ \ \ \ \ \ \ *\mbox{\hyperlink{gmock__stress__test_8cc_afd9db40e3361ae09188795e8cbe19752}{count}}\ =\ items;}
\DoxyCodeLine{00223\ }
\DoxyCodeLine{00224\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a9f2ea08f0e13c3fc129863fdd46352b6}{CKR\_BUFFER\_TOO\_SMALL}};}
\DoxyCodeLine{00225\ \ \ \ \ \}}
\DoxyCodeLine{00226\ }
\DoxyCodeLine{00227\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a837cbbce04f92271824debc2c15b6ab6}{pMechanismList}},\ buffer,\ \textcolor{keyword}{sizeof}(CK\_MECHANISM\_TYPE)\ *\ items);}
\DoxyCodeLine{00228\ \ \ \}}
\DoxyCodeLine{00229\ }
\DoxyCodeLine{00230\ \ \ *\mbox{\hyperlink{gmock__stress__test_8cc_afd9db40e3361ae09188795e8cbe19752}{count}}\ =\ items;}
\DoxyCodeLine{00231\ }
\DoxyCodeLine{00232\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}};}
\DoxyCodeLine{00233\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{util__pkcs11_8c_a064731f36eb972f687b4059dc5f340db_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{util__pkcs11_8c_a064731f36eb972f687b4059dc5f340db_icgraph}
\end{center}
\end{figure}
\Hypertarget{util__pkcs11_8c_a85589628d7732ef01a3f80a25d217c8c}\index{util\_pkcs11.c@{util\_pkcs11.c}!get\_object\_desc@{get\_object\_desc}}
\index{get\_object\_desc@{get\_object\_desc}!util\_pkcs11.c@{util\_pkcs11.c}}
\doxysubsubsection{\texorpdfstring{get\_object\_desc()}{get\_object\_desc()}}
{\footnotesize\ttfamily \label{util__pkcs11_8c_a85589628d7732ef01a3f80a25d217c8c} 
\mbox{\hyperlink{structyubihsm__pkcs11__object__desc}{yubihsm\+\_\+pkcs11\+\_\+object\+\_\+desc}} \texorpdfstring{$\ast$}{*} get\+\_\+object\+\_\+desc (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyh__session}{yh\+\_\+session}} \texorpdfstring{$\ast$}{*}}]{session}{, }\item[{\mbox{\hyperlink{structyubihsm__pkcs11__object__desc}{yubihsm\+\_\+pkcs11\+\_\+object\+\_\+desc}} \texorpdfstring{$\ast$}{*}}]{objects}{, }\item[{CK\+\_\+\+OBJECT\+\_\+\+HANDLE}]{obj\+Handle}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{util__pkcs11_8c_source_l01587}{1587}} of file \mbox{\hyperlink{util__pkcs11_8c_source}{util\+\_\+pkcs11.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01589\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01590\ }
\DoxyCodeLine{01591\ \ \ \mbox{\hyperlink{structyubihsm__pkcs11__object__desc}{yubihsm\_pkcs11\_object\_desc}}\ *\textcolor{keywordtype}{object}\ =\ NULL;}
\DoxyCodeLine{01592\ \ \ \mbox{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t}}\ \textcolor{keywordtype}{id}\ =\ objHandle\ \&\ 0xffff;}
\DoxyCodeLine{01593\ \ \ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ type\ =\ objHandle\ >>\ 16;}
\DoxyCodeLine{01594\ \ \ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ sequence\ =\ objHandle\ >>\ 24;}
\DoxyCodeLine{01595\ }
\DoxyCodeLine{01596\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t}}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{yubihsm_8h_a331b70d37ded99854638ff5ef0ca9735}{YH\_MAX\_ITEMS\_COUNT}};\ i++)\ \{}
\DoxyCodeLine{01597\ \ \ \ \ \textcolor{keywordflow}{if}\ (objects[i].\textcolor{keywordtype}{object}.\textcolor{keywordtype}{id}\ ==\ \textcolor{keywordtype}{id}\ \&\&}
\DoxyCodeLine{01598\ \ \ \ \ \ \ \ \ (objects[i].\textcolor{keywordtype}{object}.type\ \&\ 0x7f)\ ==\ (type\ \&\ 0x7f)\ \&\&}
\DoxyCodeLine{01599\ \ \ \ \ \ \ \ \ objects[i].\textcolor{keywordtype}{object}.sequence\ ==\ sequence)\ \{}
\DoxyCodeLine{01600\ \ \ \ \ \ \ \textcolor{keywordtype}{object}\ =\ \&objects[i];}
\DoxyCodeLine{01601\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01602\ \ \ \ \ \}}
\DoxyCodeLine{01603\ \ \ \}}
\DoxyCodeLine{01604\ }
\DoxyCodeLine{01605\ \ \ \textcolor{keywordflow}{if}\ (!\textcolor{keywordtype}{object})\ \{}
\DoxyCodeLine{01606\ \ \ \ \ \mbox{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t}}\ low;}
\DoxyCodeLine{01607\ \ \ \ \ \textcolor{keyword}{struct\ }timeval\ *low\_time\ =\ NULL;}
\DoxyCodeLine{01608\ }
\DoxyCodeLine{01609\ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t}}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{yubihsm_8h_a331b70d37ded99854638ff5ef0ca9735}{YH\_MAX\_ITEMS\_COUNT}};\ i++)\ \{}
\DoxyCodeLine{01610\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (objects[i].tv.tv\_sec\ ==\ 0)\ \{}
\DoxyCodeLine{01611\ \ \ \ \ \ \ \ \ low\ =\ i;}
\DoxyCodeLine{01612\ \ \ \ \ \ \ \ \ low\_time\ =\ \&objects[i].\mbox{\hyperlink{structyubihsm__pkcs11__object__desc_a8fbfc27b288552f10bfbfdc03e193b5f}{tv}};}
\DoxyCodeLine{01613\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01614\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01615\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!low\_time\ ||\ objects[i].tv.tv\_sec\ <\ low\_time-\/>tv\_sec\ ||}
\DoxyCodeLine{01616\ \ \ \ \ \ \ \ \ \ \ \ \ (objects[i].tv.tv\_sec\ ==\ low\_time-\/>tv\_sec\ \&\&}
\DoxyCodeLine{01617\ \ \ \ \ \ \ \ \ \ \ \ \ \ objects[i].tv.tv\_usec\ <\ low\_time-\/>tv\_usec))\ \{}
\DoxyCodeLine{01618\ }
\DoxyCodeLine{01619\ \ \ \ \ \ \ \ \ \ \ low\_time\ =\ \&objects[i].\mbox{\hyperlink{structyubihsm__pkcs11__object__desc_a8fbfc27b288552f10bfbfdc03e193b5f}{tv}};}
\DoxyCodeLine{01620\ \ \ \ \ \ \ \ \ \ \ low\ =\ i;}
\DoxyCodeLine{01621\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01622\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01623\ \ \ \ \ \}}
\DoxyCodeLine{01624\ \ \ \ \ \textcolor{keywordtype}{object}\ =\ \&objects[low];}
\DoxyCodeLine{01625\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_adc4bd59a60361844aa0e852efa210105}{memset}}(\textcolor{keywordtype}{object},\ 0,\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structyubihsm__pkcs11__object__desc}{yubihsm\_pkcs11\_object\_desc}}));}
\DoxyCodeLine{01626\ \ \ \}}
\DoxyCodeLine{01627\ }
\DoxyCodeLine{01628\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{yubihsm__pkcs11_8c_a85d991d90970121ba1480cd98d93aab9}{object}}-\/>filled)\ \{}
\DoxyCodeLine{01629\ \ \ \ \ \mbox{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t}}\ real\_type\ =}
\DoxyCodeLine{01630\ \ \ \ \ \ \ type\ \&\ \string~0x80;\ \textcolor{comment}{//\ NOTE(adma):\ public\ key\ are\ not\ real\ objects}}
\DoxyCodeLine{01631\ \ \ \ \ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366}{yh\_rc}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a97917e1d5a9fa5e8b7a4495dc9234ac7}{rc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a7b5f1f0c1cbca11fbe21e7e4e6b29a1b}{yh\_util\_get\_object\_info}}(\mbox{\hyperlink{ecdh__derive__test_8c_a0a2c7706d971796d7dc84fee36d6c84f}{session}},\ \textcolor{keywordtype}{id},\ real\_type,\ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a85d991d90970121ba1480cd98d93aab9}{object}}-\/>object);}
\DoxyCodeLine{01632\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a97917e1d5a9fa5e8b7a4495dc9234ac7}{rc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{01633\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ NULL;}
\DoxyCodeLine{01634\ \ \ \ \ \}}
\DoxyCodeLine{01635\ }
\DoxyCodeLine{01636\ \ \ \ \ \textcolor{keywordtype}{object}-\/>filled\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01637\ \ \ \}}
\DoxyCodeLine{01638\ }
\DoxyCodeLine{01639\ \ \ \textcolor{keywordtype}{object}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__object__desc_a6029acaef1678d77702d2c51fb75540a}{object}}.\mbox{\hyperlink{structyh__object__descriptor_ab8c1b3cc5b859e3c89eb228fa0763165}{type}}\ =\ \mbox{\hyperlink{yubihsm_8h_a1d127017fb298b889f4ba24752d08b8e}{type}};}
\DoxyCodeLine{01640\ }
\DoxyCodeLine{01641\ \ \ gettimeofday(\&\mbox{\hyperlink{yubihsm__pkcs11_8c_a85d991d90970121ba1480cd98d93aab9}{object}}-\/>tv,\ NULL);}
\DoxyCodeLine{01642\ }
\DoxyCodeLine{01643\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a85d991d90970121ba1480cd98d93aab9}{object}};}
\DoxyCodeLine{01644\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{util__pkcs11_8c_a85589628d7732ef01a3f80a25d217c8c_cgraph}
\end{center}
\end{figure}
\Hypertarget{util__pkcs11_8c_a45da02427ecf4427e4c4c181bdd9891b}\index{util\_pkcs11.c@{util\_pkcs11.c}!get\_session@{get\_session}}
\index{get\_session@{get\_session}!util\_pkcs11.c@{util\_pkcs11.c}}
\doxysubsubsection{\texorpdfstring{get\_session()}{get\_session()}}
{\footnotesize\ttfamily \label{util__pkcs11_8c_a45da02427ecf4427e4c4c181bdd9891b} 
CK\+\_\+\+RV get\+\_\+session (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__pkcs11__context}{yubihsm\+\_\+pkcs11\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{CK\+\_\+\+SESSION\+\_\+\+HANDLE}]{h\+Session}{, }\item[{\mbox{\hyperlink{structyubihsm__pkcs11__session}{yubihsm\+\_\+pkcs11\+\_\+session}} \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}}]{session}{, }\item[{int}]{session\+\_\+state}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{util__pkcs11_8c_source_l02789}{2789}} of file \mbox{\hyperlink{util__pkcs11_8c_source}{util\+\_\+pkcs11.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02790\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02791\ \ \ \mbox{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t}}\ \mbox{\hyperlink{pkcs11_8h_abed4fb4d15e18c668b783ad68448fed7}{slot\_id}}\ =\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a1907ffdf44b24385d6e575396ea79806}{hSession}}\ >>\ 16;}
\DoxyCodeLine{02792\ \ \ \mbox{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t}}\ session\_id\ =\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a1907ffdf44b24385d6e575396ea79806}{hSession}}\ \&\ 0xffff;}
\DoxyCodeLine{02793\ }
\DoxyCodeLine{02794\ \ \ \mbox{\hyperlink{structyubihsm__pkcs11__slot}{yubihsm\_pkcs11\_slot}}\ *\mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}}\ =\ \mbox{\hyperlink{util__pkcs11_8c_a79a44d844efebfc64db6cf5836754539}{get\_slot}}(ctx,\ \mbox{\hyperlink{pkcs11_8h_abed4fb4d15e18c668b783ad68448fed7}{slot\_id}});}
\DoxyCodeLine{02795\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}}\ ==\ NULL)\ \{}
\DoxyCodeLine{02796\ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a2e3ed21e5ffba18d940d164aaec64a2a}{DBG\_ERR}}(\textcolor{stringliteral}{"{}Slot\ \%d\ doesn't\ exist"{}},\ \mbox{\hyperlink{pkcs11_8h_abed4fb4d15e18c668b783ad68448fed7}{slot\_id}});}
\DoxyCodeLine{02797\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a441e417965e26e5a4b08df9993311689}{CKR\_SESSION\_HANDLE\_INVALID}};}
\DoxyCodeLine{02798\ \ \ \}}
\DoxyCodeLine{02799\ }
\DoxyCodeLine{02800\ \ \ \mbox{\hyperlink{struct_list_item}{ListItem}}\ *item\ =}
\DoxyCodeLine{02801\ \ \ \ \ \mbox{\hyperlink{list_8c_ac048645b0cd40b78c89aad9e770d4aab}{list\_get}}(\&\mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__slot_ab8e6a1f9aba139c1561f21304649b43a}{pkcs11\_sessions}},\ \&session\_id,\ compare\_session);}
\DoxyCodeLine{02802\ \ \ \textcolor{keywordflow}{if}\ (item\ ==\ NULL)\ \{}
\DoxyCodeLine{02803\ \ \ \ \ \mbox{\hyperlink{util__pkcs11_8c_a3754cf5cb42a5e282658cf94f405574e}{release\_slot}}(ctx,\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}});}
\DoxyCodeLine{02804\ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a2e3ed21e5ffba18d940d164aaec64a2a}{DBG\_ERR}}(\textcolor{stringliteral}{"{}Session\ \%d\ doesn't\ exist"{}},\ session\_id);}
\DoxyCodeLine{02805\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a441e417965e26e5a4b08df9993311689}{CKR\_SESSION\_HANDLE\_INVALID}};}
\DoxyCodeLine{02806\ \ \ \}}
\DoxyCodeLine{02807\ }
\DoxyCodeLine{02808\ \ \ *\mbox{\hyperlink{ecdh__derive__test_8c_a0a2c7706d971796d7dc84fee36d6c84f}{session}}\ =\ (\mbox{\hyperlink{structyubihsm__pkcs11__session}{yubihsm\_pkcs11\_session}}\ *)\ item-\/>\mbox{\hyperlink{struct_list_item_a788104e1ae9d59a384497766e5203f20}{data}};}
\DoxyCodeLine{02809\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{structstate}{state}}\ =\ (int)\ (*session)-\/>session\_state;}
\DoxyCodeLine{02810\ \ \ \textcolor{keywordflow}{if}\ (session\_state\ ==\ 0\ ||\ ((session\_state\ \&\ \mbox{\hyperlink{structstate}{state}})\ ==\ \mbox{\hyperlink{structstate}{state}}))\ \{}
\DoxyCodeLine{02811\ \ \ \ \ \textcolor{comment}{//\ NOTE(thorduri):\ slot\ is\ locked.}}
\DoxyCodeLine{02812\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}};}
\DoxyCodeLine{02813\ \ \ \}}
\DoxyCodeLine{02814\ }
\DoxyCodeLine{02815\ \ \ CK\_RV\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}}\ =\ \mbox{\hyperlink{pkcs11_8h_a441e417965e26e5a4b08df9993311689}{CKR\_SESSION\_HANDLE\_INVALID}};}
\DoxyCodeLine{02816\ \ \ \textcolor{keywordflow}{if}\ (session\_state\ ==\ \mbox{\hyperlink{yubihsm__pkcs11_8h_ace6bd3fe1cbfdd8d2f55b2679cf6fce4}{SESSION\_AUTHENTICATED}})\ \{}
\DoxyCodeLine{02817\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}}\ =\ \mbox{\hyperlink{pkcs11_8h_ac06517dfda93d4636ff63eb000125ad4}{CKR\_USER\_NOT\_LOGGED\_IN}};}
\DoxyCodeLine{02818\ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a2e3ed21e5ffba18d940d164aaec64a2a}{DBG\_ERR}}(\textcolor{stringliteral}{"{}Session\ user\ not\ logged\ in"{}});}
\DoxyCodeLine{02819\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (session\_state\ ==\ \mbox{\hyperlink{yubihsm__pkcs11_8h_a12ef82fba1bb65ec44ebfd41d42554f1a72bd07cb581cbf8c4f255db11973f575}{SESSION\_AUTHENTICATED\_RW}})\ \{}
\DoxyCodeLine{02820\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}}\ =\ \mbox{\hyperlink{pkcs11_8h_a3baafacbda3a24510a3ab8ed044a7329}{CKR\_SESSION\_READ\_ONLY}};}
\DoxyCodeLine{02821\ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a2e3ed21e5ffba18d940d164aaec64a2a}{DBG\_ERR}}(\textcolor{stringliteral}{"{}Session\ read\ only"{}});}
\DoxyCodeLine{02822\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (session\_state\ ==\ \mbox{\hyperlink{yubihsm__pkcs11_8h_a240b748f148bcec16dc38f0e631bc54a}{SESSION\_NOT\_AUTHENTICATED}})\ \{}
\DoxyCodeLine{02823\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}}\ =\ \mbox{\hyperlink{pkcs11_8h_aa9cd64ba03077e1ade9f6a27633a038b}{CKR\_USER\_ALREADY\_LOGGED\_IN}};}
\DoxyCodeLine{02824\ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a2e3ed21e5ffba18d940d164aaec64a2a}{DBG\_ERR}}(\textcolor{stringliteral}{"{}Session\ user\ already\ logged\ in"{}});}
\DoxyCodeLine{02825\ \ \ \}}
\DoxyCodeLine{02826\ }
\DoxyCodeLine{02827\ \ \ \mbox{\hyperlink{util__pkcs11_8c_a3754cf5cb42a5e282658cf94f405574e}{release\_slot}}(ctx,\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}});}
\DoxyCodeLine{02828\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}};}
\DoxyCodeLine{02829\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=337pt]{util__pkcs11_8c_a45da02427ecf4427e4c4c181bdd9891b_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=315pt]{util__pkcs11_8c_a45da02427ecf4427e4c4c181bdd9891b_icgraph}
\end{center}
\end{figure}
\Hypertarget{util__pkcs11_8c_a79a44d844efebfc64db6cf5836754539}\index{util\_pkcs11.c@{util\_pkcs11.c}!get\_slot@{get\_slot}}
\index{get\_slot@{get\_slot}!util\_pkcs11.c@{util\_pkcs11.c}}
\doxysubsubsection{\texorpdfstring{get\_slot()}{get\_slot()}}
{\footnotesize\ttfamily \label{util__pkcs11_8c_a79a44d844efebfc64db6cf5836754539} 
\mbox{\hyperlink{structyubihsm__pkcs11__slot}{yubihsm\+\_\+pkcs11\+\_\+slot}} \texorpdfstring{$\ast$}{*} get\+\_\+slot (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__pkcs11__context}{yubihsm\+\_\+pkcs11\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{pkcs11_8h_a35181858a3b7a0a81f49d180d8f446ef}{CK\+\_\+\+ULONG}}}]{id}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{util__pkcs11_8c_source_l02766}{2766}} of file \mbox{\hyperlink{util__pkcs11_8c_source}{util\+\_\+pkcs11.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02766\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02767\ }
\DoxyCodeLine{02768\ \ \ \mbox{\hyperlink{struct_list_item}{ListItem}}\ *item\ =\ \mbox{\hyperlink{list_8c_ac048645b0cd40b78c89aad9e770d4aab}{list\_get}}(\&ctx-\/>\mbox{\hyperlink{structyubihsm__pkcs11__context_ab22edea4554a2ea96e4e63954f6769a7}{slots}},\ \&\textcolor{keywordtype}{id},\ compare\_slot);}
\DoxyCodeLine{02769\ \ \ \textcolor{keywordflow}{if}\ (item)\ \{}
\DoxyCodeLine{02770\ \ \ \ \ \mbox{\hyperlink{structyubihsm__pkcs11__slot}{yubihsm\_pkcs11\_slot}}\ *\mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}}\ =\ (\mbox{\hyperlink{structyubihsm__pkcs11__slot}{yubihsm\_pkcs11\_slot}}\ *)\ item-\/>\mbox{\hyperlink{struct_list_item_a788104e1ae9d59a384497766e5203f20}{data}};}
\DoxyCodeLine{02771\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__slot_a3ecfa0dfb39d722e9a0fad07a8d9334d}{mutex}}\ !=\ NULL)\ \{}
\DoxyCodeLine{02772\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (ctx-\/>\mbox{\hyperlink{structyubihsm__pkcs11__context_a499767227a12b9a3309bfd1220dc8ed9}{lock\_mutex}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__slot_a3ecfa0dfb39d722e9a0fad07a8d9334d}{mutex}})\ !=\ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}})\ \{}
\DoxyCodeLine{02773\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ NULL;}
\DoxyCodeLine{02774\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02775\ \ \ \ \ \}}
\DoxyCodeLine{02776\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}};}
\DoxyCodeLine{02777\ \ \ \}}
\DoxyCodeLine{02778\ }
\DoxyCodeLine{02779\ \ \ \textcolor{keywordflow}{return}\ NULL;}
\DoxyCodeLine{02780\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=214pt]{util__pkcs11_8c_a79a44d844efebfc64db6cf5836754539_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{util__pkcs11_8c_a79a44d844efebfc64db6cf5836754539_icgraph}
\end{center}
\end{figure}
\Hypertarget{util__pkcs11_8c_a03746a942ba1eaafbec20b675463ee00}\index{util\_pkcs11.c@{util\_pkcs11.c}!is\_ECDSA\_sign\_mechanism@{is\_ECDSA\_sign\_mechanism}}
\index{is\_ECDSA\_sign\_mechanism@{is\_ECDSA\_sign\_mechanism}!util\_pkcs11.c@{util\_pkcs11.c}}
\doxysubsubsection{\texorpdfstring{is\_ECDSA\_sign\_mechanism()}{is\_ECDSA\_sign\_mechanism()}}
{\footnotesize\ttfamily \label{util__pkcs11_8c_a03746a942ba1eaafbec20b675463ee00} 
bool is\+\_\+\+ECDSA\+\_\+sign\+\_\+mechanism (\begin{DoxyParamCaption}\item[{CK\+\_\+\+MECHANISM\+\_\+\+TYPE}]{m}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{util__pkcs11_8c_source_l02690}{2690}} of file \mbox{\hyperlink{util__pkcs11_8c_source}{util\+\_\+pkcs11.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02690\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02691\ }
\DoxyCodeLine{02692\ \ \ \textcolor{keywordflow}{switch}\ (m)\ \{}
\DoxyCodeLine{02693\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ab4a7299a144f0ef52cee06893cc60483}{CKM\_ECDSA}}:}
\DoxyCodeLine{02694\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a0911727b2cd926b9209f24bf50bc555a}{CKM\_ECDSA\_SHA1}}:}
\DoxyCodeLine{02695\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ac7f12f2ee83f0ca3b309b22e5b48e486}{CKM\_ECDSA\_SHA256}}:}
\DoxyCodeLine{02696\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ab4aaed0f4b4146b812c6cff25828fcfd}{CKM\_ECDSA\_SHA384}}:}
\DoxyCodeLine{02697\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a69a7674eee1a8069128923037b504e59}{CKM\_ECDSA\_SHA512}}:}
\DoxyCodeLine{02698\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{02699\ }
\DoxyCodeLine{02700\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{02701\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02702\ \ \ \}}
\DoxyCodeLine{02703\ }
\DoxyCodeLine{02704\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{02705\ \}}

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{util__pkcs11_8c_a03746a942ba1eaafbec20b675463ee00_icgraph}
\end{center}
\end{figure}
\Hypertarget{util__pkcs11_8c_a3f1010425d5308dfa15d696b4853c68c}\index{util\_pkcs11.c@{util\_pkcs11.c}!is\_hashed\_mechanism@{is\_hashed\_mechanism}}
\index{is\_hashed\_mechanism@{is\_hashed\_mechanism}!util\_pkcs11.c@{util\_pkcs11.c}}
\doxysubsubsection{\texorpdfstring{is\_hashed\_mechanism()}{is\_hashed\_mechanism()}}
{\footnotesize\ttfamily \label{util__pkcs11_8c_a3f1010425d5308dfa15d696b4853c68c} 
bool is\+\_\+hashed\+\_\+mechanism (\begin{DoxyParamCaption}\item[{CK\+\_\+\+MECHANISM\+\_\+\+TYPE}]{m}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{util__pkcs11_8c_source_l02645}{2645}} of file \mbox{\hyperlink{util__pkcs11_8c_source}{util\+\_\+pkcs11.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02645\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02646\ }
\DoxyCodeLine{02647\ \ \ \textcolor{keywordflow}{switch}\ (m)\ \{}
\DoxyCodeLine{02648\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a9b5d495ac404ebbce07d1f58436ee31d}{CKM\_SHA1\_RSA\_PKCS}}:}
\DoxyCodeLine{02649\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ae24525658e8df0829c24236ee7614d1f}{CKM\_SHA256\_RSA\_PKCS}}:}
\DoxyCodeLine{02650\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ad8d3d34082b7e18f4f173804cf5b959b}{CKM\_SHA384\_RSA\_PKCS}}:}
\DoxyCodeLine{02651\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a6c0c89dfd22474095772f87d25c6a17d}{CKM\_SHA512\_RSA\_PKCS}}:}
\DoxyCodeLine{02652\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ad5943f11b67c32a40d4d6687e9cbb64b}{CKM\_SHA1\_RSA\_PKCS\_PSS}}:}
\DoxyCodeLine{02653\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ad336fbe2d222fc913c70dd56fabf7f7e}{CKM\_SHA256\_RSA\_PKCS\_PSS}}:}
\DoxyCodeLine{02654\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ae5a8bfa905dc8dab5b2130a8bb6b23fb}{CKM\_SHA384\_RSA\_PKCS\_PSS}}:}
\DoxyCodeLine{02655\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a67393bc84515cf68048ca3b3bb8b39a0}{CKM\_SHA512\_RSA\_PKCS\_PSS}}:}
\DoxyCodeLine{02656\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a0911727b2cd926b9209f24bf50bc555a}{CKM\_ECDSA\_SHA1}}:}
\DoxyCodeLine{02657\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ac7f12f2ee83f0ca3b309b22e5b48e486}{CKM\_ECDSA\_SHA256}}:}
\DoxyCodeLine{02658\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ab4aaed0f4b4146b812c6cff25828fcfd}{CKM\_ECDSA\_SHA384}}:}
\DoxyCodeLine{02659\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a69a7674eee1a8069128923037b504e59}{CKM\_ECDSA\_SHA512}}:}
\DoxyCodeLine{02660\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_af1818a1c453a84f01f2e868307ca8fed}{CKM\_SHA\_1}}:}
\DoxyCodeLine{02661\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a4d11f88ae3bea2f748f275c03b54a648}{CKM\_SHA256}}:}
\DoxyCodeLine{02662\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a9278e01971ca83cdd07e4b8e07a00bc8}{CKM\_SHA384}}:}
\DoxyCodeLine{02663\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a9bf4bf7375a24e1010cc8e0139608fd5}{CKM\_SHA512}}:}
\DoxyCodeLine{02664\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{02665\ }
\DoxyCodeLine{02666\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{02667\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02668\ \ \ \}}
\DoxyCodeLine{02669\ }
\DoxyCodeLine{02670\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{02671\ \}}

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{util__pkcs11_8c_a3f1010425d5308dfa15d696b4853c68c_icgraph}
\end{center}
\end{figure}
\Hypertarget{util__pkcs11_8c_a3da5875af7a71b11ee5ead6b160d1ff4}\index{util\_pkcs11.c@{util\_pkcs11.c}!is\_HMAC\_sign\_mechanism@{is\_HMAC\_sign\_mechanism}}
\index{is\_HMAC\_sign\_mechanism@{is\_HMAC\_sign\_mechanism}!util\_pkcs11.c@{util\_pkcs11.c}}
\doxysubsubsection{\texorpdfstring{is\_HMAC\_sign\_mechanism()}{is\_HMAC\_sign\_mechanism()}}
{\footnotesize\ttfamily \label{util__pkcs11_8c_a3da5875af7a71b11ee5ead6b160d1ff4} 
bool is\+\_\+\+HMAC\+\_\+sign\+\_\+mechanism (\begin{DoxyParamCaption}\item[{CK\+\_\+\+MECHANISM\+\_\+\+TYPE}]{m}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{util__pkcs11_8c_source_l02724}{2724}} of file \mbox{\hyperlink{util__pkcs11_8c_source}{util\+\_\+pkcs11.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02724\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02725\ }
\DoxyCodeLine{02726\ \ \ \textcolor{keywordflow}{switch}\ (m)\ \{}
\DoxyCodeLine{02727\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a1eb3f4cee46e624bfbbc6889e1e5bc06}{CKM\_SHA\_1\_HMAC}}:}
\DoxyCodeLine{02728\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a839f51ab9e78e866f1d3773b8466b011}{CKM\_SHA256\_HMAC}}:}
\DoxyCodeLine{02729\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a97ee18b73f21e8047fadc8a0aa12f23a}{CKM\_SHA384\_HMAC}}:}
\DoxyCodeLine{02730\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ae1b850f9141aa407e45b02fa3ade3759}{CKM\_SHA512\_HMAC}}:}
\DoxyCodeLine{02731\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{02732\ }
\DoxyCodeLine{02733\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{02734\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02735\ \ \ \}}
\DoxyCodeLine{02736\ }
\DoxyCodeLine{02737\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{02738\ \}}

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{util__pkcs11_8c_a3da5875af7a71b11ee5ead6b160d1ff4_icgraph}
\end{center}
\end{figure}
\Hypertarget{util__pkcs11_8c_a0040a19f3ec5afc2b8717e10860d55bc}\index{util\_pkcs11.c@{util\_pkcs11.c}!is\_PKCS1v1\_5\_sign\_mechanism@{is\_PKCS1v1\_5\_sign\_mechanism}}
\index{is\_PKCS1v1\_5\_sign\_mechanism@{is\_PKCS1v1\_5\_sign\_mechanism}!util\_pkcs11.c@{util\_pkcs11.c}}
\doxysubsubsection{\texorpdfstring{is\_PKCS1v1\_5\_sign\_mechanism()}{is\_PKCS1v1\_5\_sign\_mechanism()}}
{\footnotesize\ttfamily \label{util__pkcs11_8c_a0040a19f3ec5afc2b8717e10860d55bc} 
bool is\+\_\+\+PKCS1v1\+\_\+5\+\_\+sign\+\_\+mechanism (\begin{DoxyParamCaption}\item[{CK\+\_\+\+MECHANISM\+\_\+\+TYPE}]{m}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{util__pkcs11_8c_source_l02673}{2673}} of file \mbox{\hyperlink{util__pkcs11_8c_source}{util\+\_\+pkcs11.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02673\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02674\ }
\DoxyCodeLine{02675\ \ \ \textcolor{keywordflow}{switch}\ (m)\ \{}
\DoxyCodeLine{02676\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a08a8e0f2109de3ff3bfe26f220447a2e}{CKM\_RSA\_PKCS}}:}
\DoxyCodeLine{02677\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a9b5d495ac404ebbce07d1f58436ee31d}{CKM\_SHA1\_RSA\_PKCS}}:}
\DoxyCodeLine{02678\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ae24525658e8df0829c24236ee7614d1f}{CKM\_SHA256\_RSA\_PKCS}}:}
\DoxyCodeLine{02679\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ad8d3d34082b7e18f4f173804cf5b959b}{CKM\_SHA384\_RSA\_PKCS}}:}
\DoxyCodeLine{02680\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a6c0c89dfd22474095772f87d25c6a17d}{CKM\_SHA512\_RSA\_PKCS}}:}
\DoxyCodeLine{02681\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{02682\ }
\DoxyCodeLine{02683\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{02684\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02685\ \ \ \}}
\DoxyCodeLine{02686\ }
\DoxyCodeLine{02687\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{02688\ \}}

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=306pt]{util__pkcs11_8c_a0040a19f3ec5afc2b8717e10860d55bc_icgraph}
\end{center}
\end{figure}
\Hypertarget{util__pkcs11_8c_a34722aea70286e920362e216c048f629}\index{util\_pkcs11.c@{util\_pkcs11.c}!is\_PSS\_sign\_mechanism@{is\_PSS\_sign\_mechanism}}
\index{is\_PSS\_sign\_mechanism@{is\_PSS\_sign\_mechanism}!util\_pkcs11.c@{util\_pkcs11.c}}
\doxysubsubsection{\texorpdfstring{is\_PSS\_sign\_mechanism()}{is\_PSS\_sign\_mechanism()}}
{\footnotesize\ttfamily \label{util__pkcs11_8c_a34722aea70286e920362e216c048f629} 
bool is\+\_\+\+PSS\+\_\+sign\+\_\+mechanism (\begin{DoxyParamCaption}\item[{CK\+\_\+\+MECHANISM\+\_\+\+TYPE}]{m}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{util__pkcs11_8c_source_l02707}{2707}} of file \mbox{\hyperlink{util__pkcs11_8c_source}{util\+\_\+pkcs11.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02707\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02708\ }
\DoxyCodeLine{02709\ \ \ \textcolor{keywordflow}{switch}\ (m)\ \{}
\DoxyCodeLine{02710\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ad4f5697408b23623c904df2b1ca8a9f1}{CKM\_RSA\_PKCS\_PSS}}:}
\DoxyCodeLine{02711\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ad5943f11b67c32a40d4d6687e9cbb64b}{CKM\_SHA1\_RSA\_PKCS\_PSS}}:}
\DoxyCodeLine{02712\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ad336fbe2d222fc913c70dd56fabf7f7e}{CKM\_SHA256\_RSA\_PKCS\_PSS}}:}
\DoxyCodeLine{02713\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ae5a8bfa905dc8dab5b2130a8bb6b23fb}{CKM\_SHA384\_RSA\_PKCS\_PSS}}:}
\DoxyCodeLine{02714\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a67393bc84515cf68048ca3b3bb8b39a0}{CKM\_SHA512\_RSA\_PKCS\_PSS}}:}
\DoxyCodeLine{02715\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{02716\ }
\DoxyCodeLine{02717\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{02718\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02719\ \ \ \}}
\DoxyCodeLine{02720\ }
\DoxyCodeLine{02721\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{02722\ \}}

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=338pt]{util__pkcs11_8c_a34722aea70286e920362e216c048f629_icgraph}
\end{center}
\end{figure}
\Hypertarget{util__pkcs11_8c_a8a3a4cd4d71d1a0489be171682cb9ece}\index{util\_pkcs11.c@{util\_pkcs11.c}!is\_RSA\_decrypt\_mechanism@{is\_RSA\_decrypt\_mechanism}}
\index{is\_RSA\_decrypt\_mechanism@{is\_RSA\_decrypt\_mechanism}!util\_pkcs11.c@{util\_pkcs11.c}}
\doxysubsubsection{\texorpdfstring{is\_RSA\_decrypt\_mechanism()}{is\_RSA\_decrypt\_mechanism()}}
{\footnotesize\ttfamily \label{util__pkcs11_8c_a8a3a4cd4d71d1a0489be171682cb9ece} 
bool is\+\_\+\+RSA\+\_\+decrypt\+\_\+mechanism (\begin{DoxyParamCaption}\item[{CK\+\_\+\+MECHANISM\+\_\+\+TYPE}]{m}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{util__pkcs11_8c_source_l02627}{2627}} of file \mbox{\hyperlink{util__pkcs11_8c_source}{util\+\_\+pkcs11.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02627\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02628\ }
\DoxyCodeLine{02629\ \ \ \textcolor{keywordflow}{switch}\ (m)\ \{}
\DoxyCodeLine{02630\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a08a8e0f2109de3ff3bfe26f220447a2e}{CKM\_RSA\_PKCS}}:}
\DoxyCodeLine{02631\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a9b5d495ac404ebbce07d1f58436ee31d}{CKM\_SHA1\_RSA\_PKCS}}:}
\DoxyCodeLine{02632\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ae24525658e8df0829c24236ee7614d1f}{CKM\_SHA256\_RSA\_PKCS}}:}
\DoxyCodeLine{02633\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ad8d3d34082b7e18f4f173804cf5b959b}{CKM\_SHA384\_RSA\_PKCS}}:}
\DoxyCodeLine{02634\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a6c0c89dfd22474095772f87d25c6a17d}{CKM\_SHA512\_RSA\_PKCS}}:}
\DoxyCodeLine{02635\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a69da8859ad1e6b4f424d071b42ea4a0c}{CKM\_RSA\_PKCS\_OAEP}}:}
\DoxyCodeLine{02636\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{02637\ }
\DoxyCodeLine{02638\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{02639\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02640\ \ \ \}}
\DoxyCodeLine{02641\ }
\DoxyCodeLine{02642\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{02643\ \}}

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{util__pkcs11_8c_a8a3a4cd4d71d1a0489be171682cb9ece_icgraph}
\end{center}
\end{figure}
\Hypertarget{util__pkcs11_8c_a7c0da3eb6986b1e9466392de8eb4b9f5}\index{util\_pkcs11.c@{util\_pkcs11.c}!is\_RSA\_sign\_mechanism@{is\_RSA\_sign\_mechanism}}
\index{is\_RSA\_sign\_mechanism@{is\_RSA\_sign\_mechanism}!util\_pkcs11.c@{util\_pkcs11.c}}
\doxysubsubsection{\texorpdfstring{is\_RSA\_sign\_mechanism()}{is\_RSA\_sign\_mechanism()}}
{\footnotesize\ttfamily \label{util__pkcs11_8c_a7c0da3eb6986b1e9466392de8eb4b9f5} 
bool is\+\_\+\+RSA\+\_\+sign\+\_\+mechanism (\begin{DoxyParamCaption}\item[{CK\+\_\+\+MECHANISM\+\_\+\+TYPE}]{m}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{util__pkcs11_8c_source_l02605}{2605}} of file \mbox{\hyperlink{util__pkcs11_8c_source}{util\+\_\+pkcs11.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02605\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02606\ }
\DoxyCodeLine{02607\ \ \ \textcolor{keywordflow}{switch}\ (m)\ \{}
\DoxyCodeLine{02608\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a08a8e0f2109de3ff3bfe26f220447a2e}{CKM\_RSA\_PKCS}}:}
\DoxyCodeLine{02609\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a9b5d495ac404ebbce07d1f58436ee31d}{CKM\_SHA1\_RSA\_PKCS}}:}
\DoxyCodeLine{02610\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ae24525658e8df0829c24236ee7614d1f}{CKM\_SHA256\_RSA\_PKCS}}:}
\DoxyCodeLine{02611\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ad8d3d34082b7e18f4f173804cf5b959b}{CKM\_SHA384\_RSA\_PKCS}}:}
\DoxyCodeLine{02612\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a6c0c89dfd22474095772f87d25c6a17d}{CKM\_SHA512\_RSA\_PKCS}}:}
\DoxyCodeLine{02613\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ad4f5697408b23623c904df2b1ca8a9f1}{CKM\_RSA\_PKCS\_PSS}}:}
\DoxyCodeLine{02614\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ad5943f11b67c32a40d4d6687e9cbb64b}{CKM\_SHA1\_RSA\_PKCS\_PSS}}:}
\DoxyCodeLine{02615\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ad336fbe2d222fc913c70dd56fabf7f7e}{CKM\_SHA256\_RSA\_PKCS\_PSS}}:}
\DoxyCodeLine{02616\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a67393bc84515cf68048ca3b3bb8b39a0}{CKM\_SHA512\_RSA\_PKCS\_PSS}}:}
\DoxyCodeLine{02617\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ae5a8bfa905dc8dab5b2130a8bb6b23fb}{CKM\_SHA384\_RSA\_PKCS\_PSS}}:}
\DoxyCodeLine{02618\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{02619\ }
\DoxyCodeLine{02620\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{02621\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02622\ \ \ \}}
\DoxyCodeLine{02623\ }
\DoxyCodeLine{02624\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{02625\ \}}

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{util__pkcs11_8c_a7c0da3eb6986b1e9466392de8eb4b9f5_icgraph}
\end{center}
\end{figure}
\Hypertarget{util__pkcs11_8c_a2413ad4604ce34308256962fb1098ec7}\index{util\_pkcs11.c@{util\_pkcs11.c}!parse\_ec\_generate\_template@{parse\_ec\_generate\_template}}
\index{parse\_ec\_generate\_template@{parse\_ec\_generate\_template}!util\_pkcs11.c@{util\_pkcs11.c}}
\doxysubsubsection{\texorpdfstring{parse\_ec\_generate\_template()}{parse\_ec\_generate\_template()}}
{\footnotesize\ttfamily \label{util__pkcs11_8c_a2413ad4604ce34308256962fb1098ec7} 
CK\+\_\+\+RV parse\+\_\+ec\+\_\+generate\+\_\+template (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{pkcs11_8h_a5db3536793782f135785609e4a849fc6}{CK\+\_\+\+ATTRIBUTE\+\_\+\+PTR}}}]{p\+Public\+Key\+Template}{, }\item[{\mbox{\hyperlink{pkcs11_8h_a35181858a3b7a0a81f49d180d8f446ef}{CK\+\_\+\+ULONG}}}]{ul\+Public\+Key\+Attribute\+Count}{, }\item[{\mbox{\hyperlink{pkcs11_8h_a5db3536793782f135785609e4a849fc6}{CK\+\_\+\+ATTRIBUTE\+\_\+\+PTR}}}]{p\+Private\+Key\+Template}{, }\item[{\mbox{\hyperlink{pkcs11_8h_a35181858a3b7a0a81f49d180d8f446ef}{CK\+\_\+\+ULONG}}}]{ul\+Private\+Key\+Attribute\+Count}{, }\item[{\mbox{\hyperlink{structyubihsm__pkcs11__object__template}{yubihsm\+\_\+pkcs11\+\_\+object\+\_\+template}} \texorpdfstring{$\ast$}{*}}]{template}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{util__pkcs11_8c_source_l03570}{3570}} of file \mbox{\hyperlink{util__pkcs11_8c_source}{util\+\_\+pkcs11.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{03574\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03575\ }
\DoxyCodeLine{03576\ \ \ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ *ecparams\ =\ NULL;}
\DoxyCodeLine{03577\ \ \ \mbox{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t}}\ ecparams\_len\ =\ 0;}
\DoxyCodeLine{03578\ \ \ \textcolor{keywordtype}{bool}\ label\_set\ =\ \mbox{\hyperlink{pkcs11_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}};}
\DoxyCodeLine{03579\ \ \ CK\_RV\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}};}
\DoxyCodeLine{03580\ }
\DoxyCodeLine{03581\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_adc4bd59a60361844aa0e852efa210105}{memset}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a53ef06e29c840024a683512c1acd791a}{template}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__object__template_a22edd3acceb711249d7593e73ad0d7f3}{label}},\ 0,\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a53ef06e29c840024a683512c1acd791a}{template}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__object__template_a22edd3acceb711249d7593e73ad0d7f3}{label}}));}
\DoxyCodeLine{03582\ }
\DoxyCodeLine{03583\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{pkcs11_8h_a35181858a3b7a0a81f49d180d8f446ef}{CK\_ULONG}}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{yubihsm__pkcs11_8c_aa7504c440c5b75cdd4386b6d56c6116c}{ulPublicKeyAttributeCount}};\ i++)\ \{}
\DoxyCodeLine{03584\ \ \ \ \ \textcolor{keywordflow}{switch}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_ade5d8be372cb742833a442592301a68b}{pPublicKeyTemplate}}[i].type)\ \{}
\DoxyCodeLine{03585\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_af867d3ae9286fe0f8cab4995bb6af337}{CKA\_CLASS}}:}
\DoxyCodeLine{03586\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (*((\mbox{\hyperlink{pkcs11_8h_a2c6426aaa1ca6dd1f48a01b8490482fa}{CK\_ULONG\_PTR}})\ \mbox{\hyperlink{yubihsm__pkcs11_8c_ade5d8be372cb742833a442592301a68b}{pPublicKeyTemplate}}[i].pValue)\ !=\ \mbox{\hyperlink{pkcs11_8h_a105a73f3224e9745296afdf322c0d3d1}{CKO\_PUBLIC\_KEY}})\ \{}
\DoxyCodeLine{03587\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a2e3ed21e5ffba18d940d164aaec64a2a}{DBG\_ERR}}(\textcolor{stringliteral}{"{}CKA\_CLASS\ inconsistent\ in\ PublicKeyTemplate"{}});}
\DoxyCodeLine{03588\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a98d78208707bfa2c51d6f051af1794e9}{CKR\_TEMPLATE\_INCONSISTENT}};}
\DoxyCodeLine{03589\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03590\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03591\ }
\DoxyCodeLine{03592\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_aa438b88cbcb8a921288eeefba5613274}{CKA\_KEY\_TYPE}}:}
\DoxyCodeLine{03593\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (*((\mbox{\hyperlink{pkcs11_8h_a2c6426aaa1ca6dd1f48a01b8490482fa}{CK\_ULONG\_PTR}})\ \mbox{\hyperlink{yubihsm__pkcs11_8c_ade5d8be372cb742833a442592301a68b}{pPublicKeyTemplate}}[i].pValue)\ !=\ \mbox{\hyperlink{pkcs11_8h_ae95493c017b9901d9d1c96354119eadb}{CKK\_EC}})\ \{}
\DoxyCodeLine{03594\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a2e3ed21e5ffba18d940d164aaec64a2a}{DBG\_ERR}}(\textcolor{stringliteral}{"{}CKA\_KEY\_TYPE\ inconsistent\ in\ PublicKeyTemplate"{}});}
\DoxyCodeLine{03595\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a98d78208707bfa2c51d6f051af1794e9}{CKR\_TEMPLATE\_INCONSISTENT}};}
\DoxyCodeLine{03596\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03597\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03598\ }
\DoxyCodeLine{03599\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a2846a5a41835defa47716ccc3bcc4913}{CKA\_ID}}:}
\DoxyCodeLine{03600\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a53ef06e29c840024a683512c1acd791a}{template}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__object__template_ad1b0e5ec887cae21e37a4b852a66727a}{id}}\ ==\ 0)\ \{}
\DoxyCodeLine{03601\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \textcolor{keywordtype}{id}\ =\ \mbox{\hyperlink{util__pkcs11_8c_a66eb3d4688d7e1358a14b6c86b2158f9}{parse\_id\_value}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_ade5d8be372cb742833a442592301a68b}{pPublicKeyTemplate}}[i].pValue,}
\DoxyCodeLine{03602\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ade5d8be372cb742833a442592301a68b}{pPublicKeyTemplate}}[i].ulValueLen);}
\DoxyCodeLine{03603\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\textcolor{keywordtype}{id}\ ==\ -\/1)\ \{}
\DoxyCodeLine{03604\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a2e3ed21e5ffba18d940d164aaec64a2a}{DBG\_ERR}}(\textcolor{stringliteral}{"{}CKA\_ID\ invalid\ in\ PublicKeyTemplate"{}});}
\DoxyCodeLine{03605\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_ab818f05c56d56675438515a7ba5ebb70}{CKR\_ATTRIBUTE\_VALUE\_INVALID}};}
\DoxyCodeLine{03606\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03607\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{template}-\/>id\ =\ \mbox{\hyperlink{code__cache_8cpp_aa0efefe21f4700d78692edc823e763be}{id}};}
\DoxyCodeLine{03608\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03609\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a2e3ed21e5ffba18d940d164aaec64a2a}{DBG\_ERR}}(\textcolor{stringliteral}{"{}CKA\_ID\ inconsistent\ in\ PublicKeyTemplate"{}});}
\DoxyCodeLine{03610\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a98d78208707bfa2c51d6f051af1794e9}{CKR\_TEMPLATE\_INCONSISTENT}};}
\DoxyCodeLine{03611\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03612\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03613\ }
\DoxyCodeLine{03614\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_af4e399d748bfe19cf956386179e0c3da}{CKA\_EC\_PARAMS}}:}
\DoxyCodeLine{03615\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (ecparams\ ==\ NULL)\ \{}
\DoxyCodeLine{03616\ \ \ \ \ \ \ \ \ \ \ ecparams\ =\ (\mbox{\hyperlink{pkcs11_8h_a7bc6919a7c3c372056fa7e18343a0b37}{CK\_BYTE\_PTR}})\ \mbox{\hyperlink{yubihsm__pkcs11_8c_ade5d8be372cb742833a442592301a68b}{pPublicKeyTemplate}}[i].pValue;}
\DoxyCodeLine{03617\ \ \ \ \ \ \ \ \ \ \ ecparams\_len\ =\ \mbox{\hyperlink{yubihsm__pkcs11_8c_ade5d8be372cb742833a442592301a68b}{pPublicKeyTemplate}}[i].ulValueLen;}
\DoxyCodeLine{03618\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03619\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a2e3ed21e5ffba18d940d164aaec64a2a}{DBG\_ERR}}(\textcolor{stringliteral}{"{}CKA\_PUBLIC\_EXPONENT\ inconsistent\ in\ PublicKeyTemplate"{}});}
\DoxyCodeLine{03620\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a98d78208707bfa2c51d6f051af1794e9}{CKR\_TEMPLATE\_INCONSISTENT}};}
\DoxyCodeLine{03621\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03622\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03623\ }
\DoxyCodeLine{03624\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_acf009a991c04b5c4305cc76356225aa7}{CKA\_LABEL}}:}
\DoxyCodeLine{03625\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_ade5d8be372cb742833a442592301a68b}{pPublicKeyTemplate}}[i].ulValueLen\ >\ \mbox{\hyperlink{yubihsm_8h_a431f8b753552a8b2f5f980e871b6d019}{YH\_OBJ\_LABEL\_LEN}})\ \{}
\DoxyCodeLine{03626\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a2e3ed21e5ffba18d940d164aaec64a2a}{DBG\_ERR}}(\textcolor{stringliteral}{"{}CKA\_LABEL\ invalid\ in\ PublicKeyTemplate"{}});}
\DoxyCodeLine{03627\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_ab818f05c56d56675438515a7ba5ebb70}{CKR\_ATTRIBUTE\_VALUE\_INVALID}};}
\DoxyCodeLine{03628\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03629\ }
\DoxyCodeLine{03630\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a53ef06e29c840024a683512c1acd791a}{template}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__object__template_a22edd3acceb711249d7593e73ad0d7f3}{label}},\ \mbox{\hyperlink{yubihsm__pkcs11_8c_ade5d8be372cb742833a442592301a68b}{pPublicKeyTemplate}}[i].pValue,}
\DoxyCodeLine{03631\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ade5d8be372cb742833a442592301a68b}{pPublicKeyTemplate}}[i].ulValueLen);}
\DoxyCodeLine{03632\ }
\DoxyCodeLine{03633\ \ \ \ \ \ \ \ \ label\_set\ =\ \mbox{\hyperlink{pkcs11_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}};}
\DoxyCodeLine{03634\ }
\DoxyCodeLine{03635\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03636\ }
\DoxyCodeLine{03637\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a05c1c460160443a739c6e0ce47ae3fc8}{CKA\_TOKEN}}:}
\DoxyCodeLine{03638\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}}\ =\ check\_bool\_attribute(\mbox{\hyperlink{yubihsm__pkcs11_8c_ade5d8be372cb742833a442592301a68b}{pPublicKeyTemplate}}[i].pValue,\ \textcolor{keyword}{true}))\ !=}
\DoxyCodeLine{03639\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}})\ \{}
\DoxyCodeLine{03640\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a2e3ed21e5ffba18d940d164aaec64a2a}{DBG\_ERR}}(\textcolor{stringliteral}{"{}Boolean\ truth\ check\ failed\ for\ attribute\ 0x\%lx"{}},}
\DoxyCodeLine{03641\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ade5d8be372cb742833a442592301a68b}{pPublicKeyTemplate}}[i].type);}
\DoxyCodeLine{03642\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}};}
\DoxyCodeLine{03643\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03644\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03645\ }
\DoxyCodeLine{03646\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a39688e3f665848ca7868f2ca37aa1aed}{CKA\_MODIFIABLE}}:}
\DoxyCodeLine{03647\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_aa26224c75961163975e3de4347940401}{CKA\_DECRYPT}}:}
\DoxyCodeLine{03648\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a6ffd14ad7386d9aa7178e841a964a87e}{CKA\_SIGN}}:}
\DoxyCodeLine{03649\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_af7a34bb656aa7e2b7e813dab0a6ac7b7}{CKA\_WRAP}}:}
\DoxyCodeLine{03650\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a9a9a988131e4e93d0758e43c555bdc97}{CKA\_UNWRAP}}:}
\DoxyCodeLine{03651\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}}\ =\ check\_bool\_attribute(\mbox{\hyperlink{yubihsm__pkcs11_8c_ade5d8be372cb742833a442592301a68b}{pPublicKeyTemplate}}[i].pValue,\ \textcolor{keyword}{false}))\ !=}
\DoxyCodeLine{03652\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}})\ \{}
\DoxyCodeLine{03653\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a2e3ed21e5ffba18d940d164aaec64a2a}{DBG\_ERR}}(\textcolor{stringliteral}{"{}Boolean\ false\ check\ failed\ for\ attribute\ 0x\%lx"{}},}
\DoxyCodeLine{03654\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ade5d8be372cb742833a442592301a68b}{pPublicKeyTemplate}}[i].type);}
\DoxyCodeLine{03655\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}};}
\DoxyCodeLine{03656\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03657\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03658\ }
\DoxyCodeLine{03659\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a84c89cd9def639cb4a58145063b7bd42}{CKA\_VERIFY}}:}
\DoxyCodeLine{03660\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ad427016a08d7b8f0d8fe910b907e9b44}{CKA\_ENCRYPT}}:}
\DoxyCodeLine{03661\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a92925cbe2a1b3d50dd56f8af0f770a69}{CKA\_COPYABLE}}:}
\DoxyCodeLine{03662\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a5244a0b0719c79614044460bdcf34d11}{CKA\_PRIVATE}}:}
\DoxyCodeLine{03663\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_acf37955a2a229d208289962c6f1183b8}{CKA\_EXTRACTABLE}}:}
\DoxyCodeLine{03664\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ab65b14615d388fc862c82a8d1e163f84}{CKA\_DERIVE}}:}
\DoxyCodeLine{03665\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03666\ }
\DoxyCodeLine{03667\ \ \ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{03668\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a2e3ed21e5ffba18d940d164aaec64a2a}{DBG\_ERR}}(\textcolor{stringliteral}{"{}invalid\ attribute\ type\ in\ PublicKeyTemplate:\ 0x\%lx\(\backslash\)n"{}},}
\DoxyCodeLine{03669\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ade5d8be372cb742833a442592301a68b}{pPublicKeyTemplate}}[i].type);}
\DoxyCodeLine{03670\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a0afbefc1a4ce05ba5faea1778eb602ca}{CKR\_ATTRIBUTE\_TYPE\_INVALID}};}
\DoxyCodeLine{03671\ \ \ \ \ \}}
\DoxyCodeLine{03672\ \ \ \}}
\DoxyCodeLine{03673\ }
\DoxyCodeLine{03674\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{pkcs11_8h_a35181858a3b7a0a81f49d180d8f446ef}{CK\_ULONG}}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a062bc7ed451133876d988fb653844af4}{ulPrivateKeyAttributeCount}};\ i++)\ \{}
\DoxyCodeLine{03675\ \ \ \ \ \textcolor{keywordflow}{switch}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_aa0bd9585bb6c1f50e5c0c72da9d48cb9}{pPrivateKeyTemplate}}[i].type)\ \{}
\DoxyCodeLine{03676\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_af867d3ae9286fe0f8cab4995bb6af337}{CKA\_CLASS}}:}
\DoxyCodeLine{03677\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (*((\mbox{\hyperlink{pkcs11_8h_a2c6426aaa1ca6dd1f48a01b8490482fa}{CK\_ULONG\_PTR}})\ \mbox{\hyperlink{yubihsm__pkcs11_8c_aa0bd9585bb6c1f50e5c0c72da9d48cb9}{pPrivateKeyTemplate}}[i].pValue)\ !=}
\DoxyCodeLine{03678\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{pkcs11_8h_a8aa610efb7f7dd562bce4576250753a8}{CKO\_PRIVATE\_KEY}})\ \{}
\DoxyCodeLine{03679\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a2e3ed21e5ffba18d940d164aaec64a2a}{DBG\_ERR}}(\textcolor{stringliteral}{"{}CKA\_CLASS\ inconsistent\ in\ PrivateKeyTemplate"{}});}
\DoxyCodeLine{03680\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a98d78208707bfa2c51d6f051af1794e9}{CKR\_TEMPLATE\_INCONSISTENT}};}
\DoxyCodeLine{03681\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03682\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03683\ }
\DoxyCodeLine{03684\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_aa438b88cbcb8a921288eeefba5613274}{CKA\_KEY\_TYPE}}:}
\DoxyCodeLine{03685\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (*((\mbox{\hyperlink{pkcs11_8h_a2c6426aaa1ca6dd1f48a01b8490482fa}{CK\_ULONG\_PTR}})\ \mbox{\hyperlink{yubihsm__pkcs11_8c_aa0bd9585bb6c1f50e5c0c72da9d48cb9}{pPrivateKeyTemplate}}[i].pValue)\ !=\ \mbox{\hyperlink{pkcs11_8h_ae95493c017b9901d9d1c96354119eadb}{CKK\_EC}})\ \{}
\DoxyCodeLine{03686\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a2e3ed21e5ffba18d940d164aaec64a2a}{DBG\_ERR}}(\textcolor{stringliteral}{"{}CKA\_KEY\_TYPE\ inconsistent\ in\ PrivateKeyTemplate"{}});}
\DoxyCodeLine{03687\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a98d78208707bfa2c51d6f051af1794e9}{CKR\_TEMPLATE\_INCONSISTENT}};}
\DoxyCodeLine{03688\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03689\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03690\ }
\DoxyCodeLine{03691\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a2846a5a41835defa47716ccc3bcc4913}{CKA\_ID}}:\ \{}
\DoxyCodeLine{03692\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \textcolor{keywordtype}{id}\ =\ \mbox{\hyperlink{util__pkcs11_8c_a66eb3d4688d7e1358a14b6c86b2158f9}{parse\_id\_value}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_aa0bd9585bb6c1f50e5c0c72da9d48cb9}{pPrivateKeyTemplate}}[i].pValue,}
\DoxyCodeLine{03693\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_aa0bd9585bb6c1f50e5c0c72da9d48cb9}{pPrivateKeyTemplate}}[i].ulValueLen);}
\DoxyCodeLine{03694\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\textcolor{keywordtype}{id}\ ==\ -\/1)\ \{}
\DoxyCodeLine{03695\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a2e3ed21e5ffba18d940d164aaec64a2a}{DBG\_ERR}}(\textcolor{stringliteral}{"{}CKA\_ID\ invalid\ in\ PrivateKeyTemplate"{}});}
\DoxyCodeLine{03696\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_ab818f05c56d56675438515a7ba5ebb70}{CKR\_ATTRIBUTE\_VALUE\_INVALID}};}
\DoxyCodeLine{03697\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03698\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a53ef06e29c840024a683512c1acd791a}{template}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__object__template_ad1b0e5ec887cae21e37a4b852a66727a}{id}}\ !=\ 0\ \&\&\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a53ef06e29c840024a683512c1acd791a}{template}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__object__template_ad1b0e5ec887cae21e37a4b852a66727a}{id}}\ !=\ \textcolor{keywordtype}{id})\ \{}
\DoxyCodeLine{03699\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a2e3ed21e5ffba18d940d164aaec64a2a}{DBG\_ERR}}(\textcolor{stringliteral}{"{}CKA\_ID\ inconsistent\ in\ PrivateKeyTemplate"{}});}
\DoxyCodeLine{03700\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a98d78208707bfa2c51d6f051af1794e9}{CKR\_TEMPLATE\_INCONSISTENT}};}
\DoxyCodeLine{03701\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03702\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{template}-\/>id\ =\ \mbox{\hyperlink{code__cache_8cpp_aa0efefe21f4700d78692edc823e763be}{id}};}
\DoxyCodeLine{03703\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03704\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03705\ }
\DoxyCodeLine{03706\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a6ffd14ad7386d9aa7178e841a964a87e}{CKA\_SIGN}}:}
\DoxyCodeLine{03707\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}}\ =\ \mbox{\hyperlink{util__pkcs11_8c_a03b553175220c8747145497de5032100}{set\_template\_attribute}}(\&\mbox{\hyperlink{yubihsm__pkcs11_8c_a53ef06e29c840024a683512c1acd791a}{template}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__object__template_a10f570d27a0e5b375f3e5e32f09c2c84}{sign}},}
\DoxyCodeLine{03708\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_aa0bd9585bb6c1f50e5c0c72da9d48cb9}{pPrivateKeyTemplate}}[i].pValue))\ !=}
\DoxyCodeLine{03709\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}})\ \{}
\DoxyCodeLine{03710\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a2e3ed21e5ffba18d940d164aaec64a2a}{DBG\_ERR}}(\textcolor{stringliteral}{"{}CKA\_SIGN\ inconsistent\ in\ PrivateKeyTemplate"{}});}
\DoxyCodeLine{03711\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}};}
\DoxyCodeLine{03712\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03713\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03714\ }
\DoxyCodeLine{03715\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_acf37955a2a229d208289962c6f1183b8}{CKA\_EXTRACTABLE}}:}
\DoxyCodeLine{03716\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}}\ =\ \mbox{\hyperlink{util__pkcs11_8c_a03b553175220c8747145497de5032100}{set\_template\_attribute}}(\&\mbox{\hyperlink{yubihsm__pkcs11_8c_a53ef06e29c840024a683512c1acd791a}{template}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__object__template_a30a6882cb36864acc3e27baaf38ff0f1}{exportable}},}
\DoxyCodeLine{03717\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_aa0bd9585bb6c1f50e5c0c72da9d48cb9}{pPrivateKeyTemplate}}[i].pValue))\ !=}
\DoxyCodeLine{03718\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}})\ \{}
\DoxyCodeLine{03719\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a2e3ed21e5ffba18d940d164aaec64a2a}{DBG\_ERR}}(\textcolor{stringliteral}{"{}CKA\_EXTRACTABLE\ inconsistent\ in\ PrivateKeyTemplate"{}});}
\DoxyCodeLine{03720\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}};}
\DoxyCodeLine{03721\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03722\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03723\ }
\DoxyCodeLine{03724\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ab65b14615d388fc862c82a8d1e163f84}{CKA\_DERIVE}}:}
\DoxyCodeLine{03725\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}}\ =\ \mbox{\hyperlink{util__pkcs11_8c_a03b553175220c8747145497de5032100}{set\_template\_attribute}}(\&\mbox{\hyperlink{yubihsm__pkcs11_8c_a53ef06e29c840024a683512c1acd791a}{template}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__object__template_a42d6ff195518eae194d4ca0abd64301f}{derive}},}
\DoxyCodeLine{03726\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_aa0bd9585bb6c1f50e5c0c72da9d48cb9}{pPrivateKeyTemplate}}[i].pValue))\ !=}
\DoxyCodeLine{03727\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}})\ \{}
\DoxyCodeLine{03728\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a2e3ed21e5ffba18d940d164aaec64a2a}{DBG\_ERR}}(\textcolor{stringliteral}{"{}CKA\_DERIVE\ inconsistent\ in\ PrivateKeyTemplate"{}});}
\DoxyCodeLine{03729\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}};}
\DoxyCodeLine{03730\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03731\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03732\ }
\DoxyCodeLine{03733\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_acf009a991c04b5c4305cc76356225aa7}{CKA\_LABEL}}:}
\DoxyCodeLine{03734\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_aa0bd9585bb6c1f50e5c0c72da9d48cb9}{pPrivateKeyTemplate}}[i].ulValueLen\ >\ \mbox{\hyperlink{yubihsm_8h_a431f8b753552a8b2f5f980e871b6d019}{YH\_OBJ\_LABEL\_LEN}})\ \{}
\DoxyCodeLine{03735\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a2e3ed21e5ffba18d940d164aaec64a2a}{DBG\_ERR}}(\textcolor{stringliteral}{"{}CKA\_LABEL\ invalid\ in\ PrivateKeyTemplate"{}});}
\DoxyCodeLine{03736\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_ab818f05c56d56675438515a7ba5ebb70}{CKR\_ATTRIBUTE\_VALUE\_INVALID}};}
\DoxyCodeLine{03737\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03738\ }
\DoxyCodeLine{03739\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (label\_set\ ==\ \mbox{\hyperlink{pkcs11_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}})\ \{}
\DoxyCodeLine{03740\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (memcmp(\mbox{\hyperlink{yubihsm__pkcs11_8c_a53ef06e29c840024a683512c1acd791a}{template}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__object__template_a22edd3acceb711249d7593e73ad0d7f3}{label}},\ \mbox{\hyperlink{yubihsm__pkcs11_8c_aa0bd9585bb6c1f50e5c0c72da9d48cb9}{pPrivateKeyTemplate}}[i].pValue,}
\DoxyCodeLine{03741\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_aa0bd9585bb6c1f50e5c0c72da9d48cb9}{pPrivateKeyTemplate}}[i].ulValueLen)\ !=\ 0)\ \{}
\DoxyCodeLine{03742\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a2e3ed21e5ffba18d940d164aaec64a2a}{DBG\_ERR}}(\textcolor{stringliteral}{"{}CKA\_LABEL\ inconsistent\ in\ PrivateKeyTemplate"{}});}
\DoxyCodeLine{03743\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a98d78208707bfa2c51d6f051af1794e9}{CKR\_TEMPLATE\_INCONSISTENT}};}
\DoxyCodeLine{03744\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03745\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03746\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a53ef06e29c840024a683512c1acd791a}{template}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__object__template_a22edd3acceb711249d7593e73ad0d7f3}{label}},\ \mbox{\hyperlink{yubihsm__pkcs11_8c_aa0bd9585bb6c1f50e5c0c72da9d48cb9}{pPrivateKeyTemplate}}[i].pValue,}
\DoxyCodeLine{03747\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_aa0bd9585bb6c1f50e5c0c72da9d48cb9}{pPrivateKeyTemplate}}[i].ulValueLen);}
\DoxyCodeLine{03748\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03749\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03750\ }
\DoxyCodeLine{03751\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a05c1c460160443a739c6e0ce47ae3fc8}{CKA\_TOKEN}}:}
\DoxyCodeLine{03752\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a5fe5fb4a38ca6781c50e4cba8a2af0d6}{CKA\_SENSITIVE}}:}
\DoxyCodeLine{03753\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a5244a0b0719c79614044460bdcf34d11}{CKA\_PRIVATE}}:}
\DoxyCodeLine{03754\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ab495c20657f01d79e1a6ca49d2c8472e}{CKA\_DESTROYABLE}}:}
\DoxyCodeLine{03755\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}}\ =\ check\_bool\_attribute(\mbox{\hyperlink{yubihsm__pkcs11_8c_aa0bd9585bb6c1f50e5c0c72da9d48cb9}{pPrivateKeyTemplate}}[i].pValue,\ \textcolor{keyword}{true}))\ !=}
\DoxyCodeLine{03756\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}})\ \{}
\DoxyCodeLine{03757\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a2e3ed21e5ffba18d940d164aaec64a2a}{DBG\_ERR}}(\textcolor{stringliteral}{"{}Boolean\ truth\ check\ failed\ for\ attribute\ 0x\%lx"{}},}
\DoxyCodeLine{03758\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_aa0bd9585bb6c1f50e5c0c72da9d48cb9}{pPrivateKeyTemplate}}[i].type);}
\DoxyCodeLine{03759\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}};}
\DoxyCodeLine{03760\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03761\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03762\ }
\DoxyCodeLine{03763\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a9a9a988131e4e93d0758e43c555bdc97}{CKA\_UNWRAP}}:}
\DoxyCodeLine{03764\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_af7a34bb656aa7e2b7e813dab0a6ac7b7}{CKA\_WRAP}}:}
\DoxyCodeLine{03765\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a39688e3f665848ca7868f2ca37aa1aed}{CKA\_MODIFIABLE}}:}
\DoxyCodeLine{03766\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a92925cbe2a1b3d50dd56f8af0f770a69}{CKA\_COPYABLE}}:}
\DoxyCodeLine{03767\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ad427016a08d7b8f0d8fe910b907e9b44}{CKA\_ENCRYPT}}:}
\DoxyCodeLine{03768\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a84c89cd9def639cb4a58145063b7bd42}{CKA\_VERIFY}}:}
\DoxyCodeLine{03769\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}}\ =\ check\_bool\_attribute(\mbox{\hyperlink{yubihsm__pkcs11_8c_aa0bd9585bb6c1f50e5c0c72da9d48cb9}{pPrivateKeyTemplate}}[i].pValue,\ \textcolor{keyword}{false}))\ !=}
\DoxyCodeLine{03770\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}})\ \{}
\DoxyCodeLine{03771\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a2e3ed21e5ffba18d940d164aaec64a2a}{DBG\_ERR}}(\textcolor{stringliteral}{"{}Boolean\ false\ check\ failed\ for\ attribute\ 0x\%lx"{}},}
\DoxyCodeLine{03772\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_aa0bd9585bb6c1f50e5c0c72da9d48cb9}{pPrivateKeyTemplate}}[i].type);}
\DoxyCodeLine{03773\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}};}
\DoxyCodeLine{03774\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03775\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03776\ }
\DoxyCodeLine{03777\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_afef7cb3cf999a4ea9962e780c3e6e1cf}{CKA\_SUBJECT}}:}
\DoxyCodeLine{03778\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_aa26224c75961163975e3de4347940401}{CKA\_DECRYPT}}:}
\DoxyCodeLine{03779\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03780\ }
\DoxyCodeLine{03781\ \ \ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{03782\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a0afbefc1a4ce05ba5faea1778eb602ca}{CKR\_ATTRIBUTE\_TYPE\_INVALID}};}
\DoxyCodeLine{03783\ \ \ \ \ \}}
\DoxyCodeLine{03784\ \ \ \}}
\DoxyCodeLine{03785\ }
\DoxyCodeLine{03786\ \ \ \textcolor{keywordflow}{if}\ (ecparams\ ==\ NULL)\ \{}
\DoxyCodeLine{03787\ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a2e3ed21e5ffba18d940d164aaec64a2a}{DBG\_ERR}}(\textcolor{stringliteral}{"{}CKA\_ECPARAMS\ not\ set"{}});}
\DoxyCodeLine{03788\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_acfcd3a766f4ce45e10b89243cfe9f07e}{CKR\_TEMPLATE\_INCOMPLETE}};}
\DoxyCodeLine{03789\ \ \ \}}
\DoxyCodeLine{03790\ }
\DoxyCodeLine{03791\ \ \ \mbox{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a8b142e2a51f6b9b8760f9132119673b6}{key\_len}};}
\DoxyCodeLine{03792\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}}\ =\ parse\_ecparams(ecparams,\ ecparams\_len,\ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a53ef06e29c840024a683512c1acd791a}{template}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__object__template_ad180a15b1f1a790679f9e5af6716b191}{algorithm}},\ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a8b142e2a51f6b9b8760f9132119673b6}{key\_len}});}
\DoxyCodeLine{03793\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}}\ !=\ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}})\ \{}
\DoxyCodeLine{03794\ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a2e3ed21e5ffba18d940d164aaec64a2a}{DBG\_ERR}}(\textcolor{stringliteral}{"{}Failed\ to\ parse\ CKA\_ECPARAMS"{}});}
\DoxyCodeLine{03795\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}};}
\DoxyCodeLine{03796\ \ \ \}}
\DoxyCodeLine{03797\ }
\DoxyCodeLine{03798\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}};}
\DoxyCodeLine{03799\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{util__pkcs11_8c_a2413ad4604ce34308256962fb1098ec7_cgraph}
\end{center}
\end{figure}
\Hypertarget{util__pkcs11_8c_a67949ebcead5efdd41af1683033d525e}\index{util\_pkcs11.c@{util\_pkcs11.c}!parse\_ec\_template@{parse\_ec\_template}}
\index{parse\_ec\_template@{parse\_ec\_template}!util\_pkcs11.c@{util\_pkcs11.c}}
\doxysubsubsection{\texorpdfstring{parse\_ec\_template()}{parse\_ec\_template()}}
{\footnotesize\ttfamily \label{util__pkcs11_8c_a67949ebcead5efdd41af1683033d525e} 
CK\+\_\+\+RV parse\+\_\+ec\+\_\+template (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{pkcs11_8h_a5db3536793782f135785609e4a849fc6}{CK\+\_\+\+ATTRIBUTE\+\_\+\+PTR}}}]{p\+Template}{, }\item[{\mbox{\hyperlink{pkcs11_8h_a35181858a3b7a0a81f49d180d8f446ef}{CK\+\_\+\+ULONG}}}]{ul\+Count}{, }\item[{\mbox{\hyperlink{structyubihsm__pkcs11__object__template}{yubihsm\+\_\+pkcs11\+\_\+object\+\_\+template}} \texorpdfstring{$\ast$}{*}}]{template}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{util__pkcs11_8c_source_l03150}{3150}} of file \mbox{\hyperlink{util__pkcs11_8c_source}{util\+\_\+pkcs11.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{03151\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03152\ }
\DoxyCodeLine{03153\ \ \ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ *ecparams\ =\ NULL;}
\DoxyCodeLine{03154\ \ \ \mbox{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t}}\ ecparams\_len;}
\DoxyCodeLine{03155\ \ \ CK\_RV\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}};}
\DoxyCodeLine{03156\ }
\DoxyCodeLine{03157\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{pkcs11_8h_a35181858a3b7a0a81f49d180d8f446ef}{CK\_ULONG}}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a490d37150a3d116225298faf1cb780b6}{ulCount}};\ i++)\ \{}
\DoxyCodeLine{03158\ \ \ \ \ \textcolor{keywordflow}{switch}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_aa4c2296db6853afc30383aec1a404972}{pTemplate}}[i].type)\ \{}
\DoxyCodeLine{03159\ }
\DoxyCodeLine{03160\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a799f3b28e5c856ef4229d12257818841}{CKA\_VALUE}}:}
\DoxyCodeLine{03161\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a53ef06e29c840024a683512c1acd791a}{template}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__object__template_aa7e23493c41030819bd65ab687c604a7}{obj}}.\mbox{\hyperlink{structyubihsm__pkcs11__object__template_acbc6f8ad9110ca09d862eaf06691897b}{buf}}\ ==\ NULL)\ \{}
\DoxyCodeLine{03162\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{template}-\/>obj.buf\ =\ (\mbox{\hyperlink{pkcs11_8h_a7bc6919a7c3c372056fa7e18343a0b37}{CK\_BYTE\_PTR}})\ \mbox{\hyperlink{yubihsm__pkcs11_8c_aa4c2296db6853afc30383aec1a404972}{pTemplate}}[i].pValue;}
\DoxyCodeLine{03163\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{template}-\/>objlen\ =\ \mbox{\hyperlink{yubihsm__pkcs11_8c_aa4c2296db6853afc30383aec1a404972}{pTemplate}}[i].ulValueLen;}
\DoxyCodeLine{03164\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03165\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a98d78208707bfa2c51d6f051af1794e9}{CKR\_TEMPLATE\_INCONSISTENT}};}
\DoxyCodeLine{03166\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03167\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03168\ }
\DoxyCodeLine{03169\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_af4e399d748bfe19cf956386179e0c3da}{CKA\_EC\_PARAMS}}:}
\DoxyCodeLine{03170\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (ecparams\ ==\ NULL)\ \{}
\DoxyCodeLine{03171\ \ \ \ \ \ \ \ \ \ \ ecparams\ =\ (\mbox{\hyperlink{pkcs11_8h_a7bc6919a7c3c372056fa7e18343a0b37}{CK\_BYTE\_PTR}})\ \mbox{\hyperlink{yubihsm__pkcs11_8c_aa4c2296db6853afc30383aec1a404972}{pTemplate}}[i].pValue;}
\DoxyCodeLine{03172\ \ \ \ \ \ \ \ \ \ \ ecparams\_len\ =\ \mbox{\hyperlink{yubihsm__pkcs11_8c_aa4c2296db6853afc30383aec1a404972}{pTemplate}}[i].ulValueLen;}
\DoxyCodeLine{03173\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03174\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a98d78208707bfa2c51d6f051af1794e9}{CKR\_TEMPLATE\_INCONSISTENT}};}
\DoxyCodeLine{03175\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03176\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03177\ }
\DoxyCodeLine{03178\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a6ffd14ad7386d9aa7178e841a964a87e}{CKA\_SIGN}}:}
\DoxyCodeLine{03179\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}}\ =\ \mbox{\hyperlink{util__pkcs11_8c_a03b553175220c8747145497de5032100}{set\_template\_attribute}}(\&\mbox{\hyperlink{yubihsm__pkcs11_8c_a53ef06e29c840024a683512c1acd791a}{template}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__object__template_a10f570d27a0e5b375f3e5e32f09c2c84}{sign}},}
\DoxyCodeLine{03180\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_aa4c2296db6853afc30383aec1a404972}{pTemplate}}[i].pValue))\ !=\ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}})\ \{}
\DoxyCodeLine{03181\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}};}
\DoxyCodeLine{03182\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03183\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03184\ }
\DoxyCodeLine{03185\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ab65b14615d388fc862c82a8d1e163f84}{CKA\_DERIVE}}:}
\DoxyCodeLine{03186\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}}\ =\ \mbox{\hyperlink{util__pkcs11_8c_a03b553175220c8747145497de5032100}{set\_template\_attribute}}(\&\mbox{\hyperlink{yubihsm__pkcs11_8c_a53ef06e29c840024a683512c1acd791a}{template}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__object__template_a42d6ff195518eae194d4ca0abd64301f}{derive}},}
\DoxyCodeLine{03187\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_aa4c2296db6853afc30383aec1a404972}{pTemplate}}[i].pValue))\ !=\ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}})\ \{}
\DoxyCodeLine{03188\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}};}
\DoxyCodeLine{03189\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03190\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03191\ }
\DoxyCodeLine{03192\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a05c1c460160443a739c6e0ce47ae3fc8}{CKA\_TOKEN}}:}
\DoxyCodeLine{03193\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a5244a0b0719c79614044460bdcf34d11}{CKA\_PRIVATE}}:}
\DoxyCodeLine{03194\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a5fe5fb4a38ca6781c50e4cba8a2af0d6}{CKA\_SENSITIVE}}:}
\DoxyCodeLine{03195\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}}\ =\ check\_bool\_attribute(\mbox{\hyperlink{yubihsm__pkcs11_8c_aa4c2296db6853afc30383aec1a404972}{pTemplate}}[i].pValue,\ \textcolor{keyword}{true}))\ !=\ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}})\ \{}
\DoxyCodeLine{03196\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}};}
\DoxyCodeLine{03197\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03198\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03199\ }
\DoxyCodeLine{03200\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_af867d3ae9286fe0f8cab4995bb6af337}{CKA\_CLASS}}:}
\DoxyCodeLine{03201\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_aa438b88cbcb8a921288eeefba5613274}{CKA\_KEY\_TYPE}}:}
\DoxyCodeLine{03202\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_afef7cb3cf999a4ea9962e780c3e6e1cf}{CKA\_SUBJECT}}:}
\DoxyCodeLine{03203\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a2846a5a41835defa47716ccc3bcc4913}{CKA\_ID}}:}
\DoxyCodeLine{03204\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_acf009a991c04b5c4305cc76356225aa7}{CKA\_LABEL}}:}
\DoxyCodeLine{03205\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_acf37955a2a229d208289962c6f1183b8}{CKA\_EXTRACTABLE}}:}
\DoxyCodeLine{03206\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03207\ }
\DoxyCodeLine{03208\ \ \ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{03209\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a0afbefc1a4ce05ba5faea1778eb602ca}{CKR\_ATTRIBUTE\_TYPE\_INVALID}};}
\DoxyCodeLine{03210\ \ \ \ \ \}}
\DoxyCodeLine{03211\ \ \ \}}
\DoxyCodeLine{03212\ \ \ \textcolor{keywordflow}{if}\ (ecparams\ \&\&\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a53ef06e29c840024a683512c1acd791a}{template}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__object__template_aa7e23493c41030819bd65ab687c604a7}{obj}}.\mbox{\hyperlink{structyubihsm__pkcs11__object__template_acbc6f8ad9110ca09d862eaf06691897b}{buf}})\ \{}
\DoxyCodeLine{03213\ \ \ \ \ \mbox{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a8b142e2a51f6b9b8760f9132119673b6}{key\_len}};}
\DoxyCodeLine{03214\ \ \ \ \ CK\_RV\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}}\ =}
\DoxyCodeLine{03215\ \ \ \ \ \ \ parse\_ecparams(ecparams,\ ecparams\_len,\ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a53ef06e29c840024a683512c1acd791a}{template}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__object__template_ad180a15b1f1a790679f9e5af6716b191}{algorithm}},\ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_a8b142e2a51f6b9b8760f9132119673b6}{key\_len}});}
\DoxyCodeLine{03216\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}}\ !=\ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}})\ \{}
\DoxyCodeLine{03217\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}};}
\DoxyCodeLine{03218\ \ \ \ \ \}}
\DoxyCodeLine{03219\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a8b142e2a51f6b9b8760f9132119673b6}{key\_len}}\ !=\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a53ef06e29c840024a683512c1acd791a}{template}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__object__template_aee63938d6c8d1867137146053020d61a}{objlen}})\ \{}
\DoxyCodeLine{03220\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_ab818f05c56d56675438515a7ba5ebb70}{CKR\_ATTRIBUTE\_VALUE\_INVALID}};}
\DoxyCodeLine{03221\ \ \ \ \ \}}
\DoxyCodeLine{03222\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03223\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a98d78208707bfa2c51d6f051af1794e9}{CKR\_TEMPLATE\_INCONSISTENT}};}
\DoxyCodeLine{03224\ \ \ \}}
\DoxyCodeLine{03225\ }
\DoxyCodeLine{03226\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}};}
\DoxyCodeLine{03227\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=327pt]{util__pkcs11_8c_a67949ebcead5efdd41af1683033d525e_cgraph}
\end{center}
\end{figure}
\Hypertarget{util__pkcs11_8c_a4680d9c4ecced6ef98ac202480bd53fd}\index{util\_pkcs11.c@{util\_pkcs11.c}!parse\_hex@{parse\_hex}}
\index{parse\_hex@{parse\_hex}!util\_pkcs11.c@{util\_pkcs11.c}}
\doxysubsubsection{\texorpdfstring{parse\_hex()}{parse\_hex()}}
{\footnotesize\ttfamily \label{util__pkcs11_8c_a4680d9c4ecced6ef98ac202480bd53fd} 
bool parse\+\_\+hex (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{pkcs11_8h_aee7068a12537d85d824edb4249e7ca4e}{CK\+\_\+\+UTF8\+CHAR\+\_\+\+PTR}}}]{hex}{, }\item[{\mbox{\hyperlink{pkcs11_8h_a35181858a3b7a0a81f49d180d8f446ef}{CK\+\_\+\+ULONG}}}]{hex\+\_\+len}{, }\item[{\mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t}} \texorpdfstring{$\ast$}{*}}]{parsed}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{util__pkcs11_8c_source_l00464}{464}} of file \mbox{\hyperlink{util__pkcs11_8c_source}{util\+\_\+pkcs11.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00464\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00465\ }
\DoxyCodeLine{00466\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a538d097420e725c4dad63c3caa9e55bd}{j}}\ =\ 0;}
\DoxyCodeLine{00467\ }
\DoxyCodeLine{00468\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{pkcs11_8h_a35181858a3b7a0a81f49d180d8f446ef}{CK\_ULONG}}\ i\ =\ 0;\ i\ <\ hex\_len;\ i\ +=\ 2)\ \{}
\DoxyCodeLine{00469\ \ \ \ \ \textcolor{keywordflow}{if}\ (isxdigit(hex[i])\ ==\ 0\ ||\ isxdigit(hex[i\ +\ 1])\ ==\ 0)\ \{}
\DoxyCodeLine{00470\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00471\ \ \ \ \ \}}
\DoxyCodeLine{00472\ }
\DoxyCodeLine{00473\ \ \ \ \ \textcolor{keywordflow}{if}\ (isdigit(hex[i]))\ \{}
\DoxyCodeLine{00474\ \ \ \ \ \ \ parsed[\mbox{\hyperlink{yubihsm__pkcs11_8c_a538d097420e725c4dad63c3caa9e55bd}{j}}]\ =\ (\mbox{\hyperlink{namespacesysio_1_1chain__apis_a14107dc373dfcfea6980bc2f5fa80a83}{hex}}[i]\ -\/\ \textcolor{charliteral}{'0'})\ <<\ 4;}
\DoxyCodeLine{00475\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00476\ \ \ \ \ \ \ parsed[\mbox{\hyperlink{yubihsm__pkcs11_8c_a538d097420e725c4dad63c3caa9e55bd}{j}}]\ =\ (tolower(hex[i])\ -\/\ \textcolor{charliteral}{'a'}\ +\ 10)\ <<\ 4;}
\DoxyCodeLine{00477\ \ \ \ \ \}}
\DoxyCodeLine{00478\ }
\DoxyCodeLine{00479\ \ \ \ \ \textcolor{keywordflow}{if}\ (isdigit(hex[i\ +\ 1]))\ \{}
\DoxyCodeLine{00480\ \ \ \ \ \ \ parsed[\mbox{\hyperlink{yubihsm__pkcs11_8c_a538d097420e725c4dad63c3caa9e55bd}{j}}]\ |=\ (\mbox{\hyperlink{namespacesysio_1_1chain__apis_a14107dc373dfcfea6980bc2f5fa80a83}{hex}}[i\ +\ 1]\ -\/\ \textcolor{charliteral}{'0'});}
\DoxyCodeLine{00481\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00482\ \ \ \ \ \ \ parsed[\mbox{\hyperlink{yubihsm__pkcs11_8c_a538d097420e725c4dad63c3caa9e55bd}{j}}]\ |=\ (tolower(hex[i\ +\ 1])\ -\/\ \textcolor{charliteral}{'a'}\ +\ 10);}
\DoxyCodeLine{00483\ \ \ \ \ \}}
\DoxyCodeLine{00484\ }
\DoxyCodeLine{00485\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a538d097420e725c4dad63c3caa9e55bd}{j}}++;}
\DoxyCodeLine{00486\ \ \ \}}
\DoxyCodeLine{00487\ }
\DoxyCodeLine{00488\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00489\ \}}

\end{DoxyCode}
\Hypertarget{util__pkcs11_8c_a7bf21a80e49d821dfcc0b5e97c056a69}\index{util\_pkcs11.c@{util\_pkcs11.c}!parse\_hmac\_template@{parse\_hmac\_template}}
\index{parse\_hmac\_template@{parse\_hmac\_template}!util\_pkcs11.c@{util\_pkcs11.c}}
\doxysubsubsection{\texorpdfstring{parse\_hmac\_template()}{parse\_hmac\_template()}}
{\footnotesize\ttfamily \label{util__pkcs11_8c_a7bf21a80e49d821dfcc0b5e97c056a69} 
CK\+\_\+\+RV parse\+\_\+hmac\+\_\+template (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{pkcs11_8h_a5db3536793782f135785609e4a849fc6}{CK\+\_\+\+ATTRIBUTE\+\_\+\+PTR}}}]{p\+Template}{, }\item[{\mbox{\hyperlink{pkcs11_8h_a35181858a3b7a0a81f49d180d8f446ef}{CK\+\_\+\+ULONG}}}]{ul\+Count}{, }\item[{\mbox{\hyperlink{structyubihsm__pkcs11__object__template}{yubihsm\+\_\+pkcs11\+\_\+object\+\_\+template}} \texorpdfstring{$\ast$}{*}}]{template}{, }\item[{bool}]{generate}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{util__pkcs11_8c_source_l03229}{3229}} of file \mbox{\hyperlink{util__pkcs11_8c_source}{util\+\_\+pkcs11.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{03231\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03232\ }
\DoxyCodeLine{03233\ \ \ CK\_RV\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}};}
\DoxyCodeLine{03234\ }
\DoxyCodeLine{03235\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{pkcs11_8h_a35181858a3b7a0a81f49d180d8f446ef}{CK\_ULONG}}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a490d37150a3d116225298faf1cb780b6}{ulCount}};\ i++)\ \{}
\DoxyCodeLine{03236\ \ \ \ \ \textcolor{keywordflow}{switch}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_aa4c2296db6853afc30383aec1a404972}{pTemplate}}[i].type)\ \{}
\DoxyCodeLine{03237\ }
\DoxyCodeLine{03238\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a799f3b28e5c856ef4229d12257818841}{CKA\_VALUE}}:}
\DoxyCodeLine{03239\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (generate\ ==\ \textcolor{keyword}{false}\ \&\&\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a53ef06e29c840024a683512c1acd791a}{template}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__object__template_aa7e23493c41030819bd65ab687c604a7}{obj}}.\mbox{\hyperlink{structyubihsm__pkcs11__object__template_acbc6f8ad9110ca09d862eaf06691897b}{buf}}\ ==\ NULL)\ \{}
\DoxyCodeLine{03240\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ TODO:\ consider\ hanshing\ the\ key\ here\ if\ it's\ longer\ than\ blocklen}}
\DoxyCodeLine{03241\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{template}-\/>obj.buf\ =\ (\mbox{\hyperlink{pkcs11_8h_a7bc6919a7c3c372056fa7e18343a0b37}{CK\_BYTE\_PTR}})\ \mbox{\hyperlink{yubihsm__pkcs11_8c_aa4c2296db6853afc30383aec1a404972}{pTemplate}}[i].pValue;}
\DoxyCodeLine{03242\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{template}-\/>objlen\ =\ \mbox{\hyperlink{yubihsm__pkcs11_8c_aa4c2296db6853afc30383aec1a404972}{pTemplate}}[i].ulValueLen;}
\DoxyCodeLine{03243\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03244\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a98d78208707bfa2c51d6f051af1794e9}{CKR\_TEMPLATE\_INCONSISTENT}};}
\DoxyCodeLine{03245\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03246\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03247\ }
\DoxyCodeLine{03248\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a6ffd14ad7386d9aa7178e841a964a87e}{CKA\_SIGN}}:}
\DoxyCodeLine{03249\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}}\ =\ \mbox{\hyperlink{util__pkcs11_8c_a03b553175220c8747145497de5032100}{set\_template\_attribute}}(\&\mbox{\hyperlink{yubihsm__pkcs11_8c_a53ef06e29c840024a683512c1acd791a}{template}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__object__template_a10f570d27a0e5b375f3e5e32f09c2c84}{sign}},}
\DoxyCodeLine{03250\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_aa4c2296db6853afc30383aec1a404972}{pTemplate}}[i].pValue))\ !=\ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}})\ \{}
\DoxyCodeLine{03251\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}};}
\DoxyCodeLine{03252\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03253\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03254\ }
\DoxyCodeLine{03255\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a84c89cd9def639cb4a58145063b7bd42}{CKA\_VERIFY}}:}
\DoxyCodeLine{03256\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}}\ =\ \mbox{\hyperlink{util__pkcs11_8c_a03b553175220c8747145497de5032100}{set\_template\_attribute}}(\&\mbox{\hyperlink{yubihsm__pkcs11_8c_a53ef06e29c840024a683512c1acd791a}{template}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__object__template_a81add48bb33e8bb51a7f1047ec451baa}{verify}},}
\DoxyCodeLine{03257\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_aa4c2296db6853afc30383aec1a404972}{pTemplate}}[i].pValue))\ !=\ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}})\ \{}
\DoxyCodeLine{03258\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}};}
\DoxyCodeLine{03259\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03260\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03261\ }
\DoxyCodeLine{03262\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_aa438b88cbcb8a921288eeefba5613274}{CKA\_KEY\_TYPE}}:}
\DoxyCodeLine{03263\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (*((\mbox{\hyperlink{pkcs11_8h_a2c6426aaa1ca6dd1f48a01b8490482fa}{CK\_ULONG\_PTR}})\ \mbox{\hyperlink{yubihsm__pkcs11_8c_aa4c2296db6853afc30383aec1a404972}{pTemplate}}[i].pValue))\ \{}
\DoxyCodeLine{03264\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_aec5006f9a0e144d9b43af3a1f1e4a38f}{CKK\_SHA\_1\_HMAC}}:}
\DoxyCodeLine{03265\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{template}-\/>algorithm\ =\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa942e65c8cd0034eebe9a20c2297c7b06}{YH\_ALGO\_HMAC\_SHA1}};}
\DoxyCodeLine{03266\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03267\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a18c67174b20896678c69e34922b3a98e}{CKK\_SHA256\_HMAC}}:}
\DoxyCodeLine{03268\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{template}-\/>algorithm\ =\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caab0a0e1eb424b61057f159f1e53311f5c}{YH\_ALGO\_HMAC\_SHA256}};}
\DoxyCodeLine{03269\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03270\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_aa9eb99690661eacb44520c2b68cc7536}{CKK\_SHA384\_HMAC}}:}
\DoxyCodeLine{03271\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{template}-\/>algorithm\ =\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa781e7ca62563917d2129bde8ec53401b}{YH\_ALGO\_HMAC\_SHA384}};}
\DoxyCodeLine{03272\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03273\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_af8c8d01e700c153527f112335b5d4065}{CKK\_SHA512\_HMAC}}:}
\DoxyCodeLine{03274\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{template}-\/>algorithm\ =\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caa72d6c7ea77f10e39bbadc8b58d55b9ec}{YH\_ALGO\_HMAC\_SHA512}};}
\DoxyCodeLine{03275\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03276\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{03277\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a98d78208707bfa2c51d6f051af1794e9}{CKR\_TEMPLATE\_INCONSISTENT}};}
\DoxyCodeLine{03278\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03279\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03280\ }
\DoxyCodeLine{03281\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a05c1c460160443a739c6e0ce47ae3fc8}{CKA\_TOKEN}}:}
\DoxyCodeLine{03282\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}}\ =\ check\_bool\_attribute(\mbox{\hyperlink{yubihsm__pkcs11_8c_aa4c2296db6853afc30383aec1a404972}{pTemplate}}[i].pValue,\ \textcolor{keyword}{true}))\ !=\ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}})\ \{}
\DoxyCodeLine{03283\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}};}
\DoxyCodeLine{03284\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03285\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03286\ }
\DoxyCodeLine{03287\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_af867d3ae9286fe0f8cab4995bb6af337}{CKA\_CLASS}}:}
\DoxyCodeLine{03288\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_afef7cb3cf999a4ea9962e780c3e6e1cf}{CKA\_SUBJECT}}:}
\DoxyCodeLine{03289\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a2846a5a41835defa47716ccc3bcc4913}{CKA\_ID}}:}
\DoxyCodeLine{03290\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_acf009a991c04b5c4305cc76356225aa7}{CKA\_LABEL}}:}
\DoxyCodeLine{03291\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_acf37955a2a229d208289962c6f1183b8}{CKA\_EXTRACTABLE}}:}
\DoxyCodeLine{03292\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03293\ }
\DoxyCodeLine{03294\ \ \ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{03295\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a0afbefc1a4ce05ba5faea1778eb602ca}{CKR\_ATTRIBUTE\_TYPE\_INVALID}};}
\DoxyCodeLine{03296\ \ \ \ \ \}}
\DoxyCodeLine{03297\ \ \ \}}
\DoxyCodeLine{03298\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a53ef06e29c840024a683512c1acd791a}{template}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__object__template_ad180a15b1f1a790679f9e5af6716b191}{algorithm}}\ \&\&\ (generate\ ==\ \textcolor{keyword}{true}\ ||\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a53ef06e29c840024a683512c1acd791a}{template}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__object__template_aa7e23493c41030819bd65ab687c604a7}{obj}}.\mbox{\hyperlink{structyubihsm__pkcs11__object__template_acbc6f8ad9110ca09d862eaf06691897b}{buf}}))\ \{}
\DoxyCodeLine{03299\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}};}
\DoxyCodeLine{03300\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03301\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a98d78208707bfa2c51d6f051af1794e9}{CKR\_TEMPLATE\_INCONSISTENT}};}
\DoxyCodeLine{03302\ \ \ \}}
\DoxyCodeLine{03303\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=341pt]{util__pkcs11_8c_a7bf21a80e49d821dfcc0b5e97c056a69_cgraph}
\end{center}
\end{figure}
\Hypertarget{util__pkcs11_8c_a66eb3d4688d7e1358a14b6c86b2158f9}\index{util\_pkcs11.c@{util\_pkcs11.c}!parse\_id\_value@{parse\_id\_value}}
\index{parse\_id\_value@{parse\_id\_value}!util\_pkcs11.c@{util\_pkcs11.c}}
\doxysubsubsection{\texorpdfstring{parse\_id\_value()}{parse\_id\_value()}}
{\footnotesize\ttfamily \label{util__pkcs11_8c_a66eb3d4688d7e1358a14b6c86b2158f9} 
int parse\+\_\+id\+\_\+value (\begin{DoxyParamCaption}\item[{void \texorpdfstring{$\ast$}{*}}]{value}{, }\item[{\mbox{\hyperlink{pkcs11_8h_a35181858a3b7a0a81f49d180d8f446ef}{CK\+\_\+\+ULONG}}}]{len}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{util__pkcs11_8c_source_l03556}{3556}} of file \mbox{\hyperlink{util__pkcs11_8c_source}{util\+\_\+pkcs11.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{03556\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03557\ \ \ \textcolor{keywordflow}{switch}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a7360b55975153b822efc5217b7734e6a}{len}})\ \{}
\DoxyCodeLine{03558\ \ \ \ \ \textcolor{keywordflow}{case}\ 0:}
\DoxyCodeLine{03559\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{03560\ \ \ \ \ \textcolor{keywordflow}{case}\ 1:}
\DoxyCodeLine{03561\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ *(\mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ *)\ \mbox{\hyperlink{pkcs11_8h_a32aff7c6c4cd253fdf6563677afab5ce}{value}};}
\DoxyCodeLine{03562\ \ \ \ \ \textcolor{keywordflow}{case}\ 2:}
\DoxyCodeLine{03563\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ ntohs(*(\mbox{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t}}\ *)\ \mbox{\hyperlink{pkcs11_8h_a32aff7c6c4cd253fdf6563677afab5ce}{value}});}
\DoxyCodeLine{03564\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{03565\ \ \ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a8c4742440a149ad8bcb5d58ae76c5ed3}{DBG\_INFO}}(\textcolor{stringliteral}{"{}Supplied\ id\ is\ long,\ truncating\ it\ (was\ \%lu\ bytes)"{}},\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a7360b55975153b822efc5217b7734e6a}{len}});}
\DoxyCodeLine{03566\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ ntohs(*(\mbox{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t}}\ *)\ \mbox{\hyperlink{pkcs11_8h_a32aff7c6c4cd253fdf6563677afab5ce}{value}});}
\DoxyCodeLine{03567\ \ \ \}}
\DoxyCodeLine{03568\ \}}

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{util__pkcs11_8c_a66eb3d4688d7e1358a14b6c86b2158f9_icgraph}
\end{center}
\end{figure}
\Hypertarget{util__pkcs11_8c_a3ae0dc7de593ff0d92ff81baaae9d5cb}\index{util\_pkcs11.c@{util\_pkcs11.c}!parse\_rsa\_generate\_template@{parse\_rsa\_generate\_template}}
\index{parse\_rsa\_generate\_template@{parse\_rsa\_generate\_template}!util\_pkcs11.c@{util\_pkcs11.c}}
\doxysubsubsection{\texorpdfstring{parse\_rsa\_generate\_template()}{parse\_rsa\_generate\_template()}}
{\footnotesize\ttfamily \label{util__pkcs11_8c_a3ae0dc7de593ff0d92ff81baaae9d5cb} 
CK\+\_\+\+RV parse\+\_\+rsa\+\_\+generate\+\_\+template (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{pkcs11_8h_a5db3536793782f135785609e4a849fc6}{CK\+\_\+\+ATTRIBUTE\+\_\+\+PTR}}}]{p\+Public\+Key\+Template}{, }\item[{\mbox{\hyperlink{pkcs11_8h_a35181858a3b7a0a81f49d180d8f446ef}{CK\+\_\+\+ULONG}}}]{ul\+Public\+Key\+Attribute\+Count}{, }\item[{\mbox{\hyperlink{pkcs11_8h_a5db3536793782f135785609e4a849fc6}{CK\+\_\+\+ATTRIBUTE\+\_\+\+PTR}}}]{p\+Private\+Key\+Template}{, }\item[{\mbox{\hyperlink{pkcs11_8h_a35181858a3b7a0a81f49d180d8f446ef}{CK\+\_\+\+ULONG}}}]{ul\+Private\+Key\+Attribute\+Count}{, }\item[{\mbox{\hyperlink{structyubihsm__pkcs11__object__template}{yubihsm\+\_\+pkcs11\+\_\+object\+\_\+template}} \texorpdfstring{$\ast$}{*}}]{template}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{util__pkcs11_8c_source_l03305}{3305}} of file \mbox{\hyperlink{util__pkcs11_8c_source}{util\+\_\+pkcs11.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{03309\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03310\ }
\DoxyCodeLine{03311\ \ \ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ *e\ =\ NULL;}
\DoxyCodeLine{03312\ \ \ \textcolor{keywordtype}{bool}\ label\_set\ =\ \mbox{\hyperlink{pkcs11_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}};}
\DoxyCodeLine{03313\ \ \ CK\_RV\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}};}
\DoxyCodeLine{03314\ }
\DoxyCodeLine{03315\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_adc4bd59a60361844aa0e852efa210105}{memset}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a53ef06e29c840024a683512c1acd791a}{template}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__object__template_a22edd3acceb711249d7593e73ad0d7f3}{label}},\ 0,\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a53ef06e29c840024a683512c1acd791a}{template}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__object__template_a22edd3acceb711249d7593e73ad0d7f3}{label}}));}
\DoxyCodeLine{03316\ }
\DoxyCodeLine{03317\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{pkcs11_8h_a35181858a3b7a0a81f49d180d8f446ef}{CK\_ULONG}}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{yubihsm__pkcs11_8c_aa7504c440c5b75cdd4386b6d56c6116c}{ulPublicKeyAttributeCount}};\ i++)\ \{}
\DoxyCodeLine{03318\ \ \ \ \ \textcolor{keywordflow}{switch}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_ade5d8be372cb742833a442592301a68b}{pPublicKeyTemplate}}[i].type)\ \{}
\DoxyCodeLine{03319\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_af867d3ae9286fe0f8cab4995bb6af337}{CKA\_CLASS}}:}
\DoxyCodeLine{03320\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (*((\mbox{\hyperlink{pkcs11_8h_a2c6426aaa1ca6dd1f48a01b8490482fa}{CK\_ULONG\_PTR}})\ \mbox{\hyperlink{yubihsm__pkcs11_8c_ade5d8be372cb742833a442592301a68b}{pPublicKeyTemplate}}[i].pValue)\ !=\ \mbox{\hyperlink{pkcs11_8h_a105a73f3224e9745296afdf322c0d3d1}{CKO\_PUBLIC\_KEY}})\ \{}
\DoxyCodeLine{03321\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a2e3ed21e5ffba18d940d164aaec64a2a}{DBG\_ERR}}(\textcolor{stringliteral}{"{}CKA\_CLASS\ inconsistent\ in\ PublicKeyTemplate"{}});}
\DoxyCodeLine{03322\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a98d78208707bfa2c51d6f051af1794e9}{CKR\_TEMPLATE\_INCONSISTENT}};}
\DoxyCodeLine{03323\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03324\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03325\ }
\DoxyCodeLine{03326\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_aa438b88cbcb8a921288eeefba5613274}{CKA\_KEY\_TYPE}}:}
\DoxyCodeLine{03327\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (*((\mbox{\hyperlink{pkcs11_8h_a2c6426aaa1ca6dd1f48a01b8490482fa}{CK\_ULONG\_PTR}})\ \mbox{\hyperlink{yubihsm__pkcs11_8c_ade5d8be372cb742833a442592301a68b}{pPublicKeyTemplate}}[i].pValue)\ !=\ \mbox{\hyperlink{pkcs11_8h_a354731675f1ecc116e220b58b32636a1}{CKK\_RSA}})\ \{}
\DoxyCodeLine{03328\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a2e3ed21e5ffba18d940d164aaec64a2a}{DBG\_ERR}}(\textcolor{stringliteral}{"{}CKA\_KEY\_TYPE\ inconsistent\ in\ PublicKeyTemplate"{}});}
\DoxyCodeLine{03329\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a98d78208707bfa2c51d6f051af1794e9}{CKR\_TEMPLATE\_INCONSISTENT}};}
\DoxyCodeLine{03330\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03331\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03332\ }
\DoxyCodeLine{03333\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a2846a5a41835defa47716ccc3bcc4913}{CKA\_ID}}:}
\DoxyCodeLine{03334\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a53ef06e29c840024a683512c1acd791a}{template}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__object__template_ad1b0e5ec887cae21e37a4b852a66727a}{id}}\ ==\ 0)\ \{}
\DoxyCodeLine{03335\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \textcolor{keywordtype}{id}\ =\ \mbox{\hyperlink{util__pkcs11_8c_a66eb3d4688d7e1358a14b6c86b2158f9}{parse\_id\_value}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_ade5d8be372cb742833a442592301a68b}{pPublicKeyTemplate}}[i].pValue,}
\DoxyCodeLine{03336\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ade5d8be372cb742833a442592301a68b}{pPublicKeyTemplate}}[i].ulValueLen);}
\DoxyCodeLine{03337\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\textcolor{keywordtype}{id}\ ==\ -\/1)\ \{}
\DoxyCodeLine{03338\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a2e3ed21e5ffba18d940d164aaec64a2a}{DBG\_ERR}}(\textcolor{stringliteral}{"{}CKA\_ID\ invalid\ in\ PublicKeyTemplate"{}});}
\DoxyCodeLine{03339\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_ab818f05c56d56675438515a7ba5ebb70}{CKR\_ATTRIBUTE\_VALUE\_INVALID}};}
\DoxyCodeLine{03340\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03341\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{template}-\/>id\ =\ \mbox{\hyperlink{code__cache_8cpp_aa0efefe21f4700d78692edc823e763be}{id}};}
\DoxyCodeLine{03342\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03343\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a2e3ed21e5ffba18d940d164aaec64a2a}{DBG\_ERR}}(\textcolor{stringliteral}{"{}CKA\_ID\ inconsistent\ in\ PublicKeyTemplate"{}});}
\DoxyCodeLine{03344\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a98d78208707bfa2c51d6f051af1794e9}{CKR\_TEMPLATE\_INCONSISTENT}};}
\DoxyCodeLine{03345\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03346\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03347\ }
\DoxyCodeLine{03348\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a3560a0897e67ea3584c5e5d6b49997a9}{CKA\_PUBLIC\_EXPONENT}}:}
\DoxyCodeLine{03349\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (e\ ==\ NULL)\ \{}
\DoxyCodeLine{03350\ \ \ \ \ \ \ \ \ \ \ e\ =\ (\mbox{\hyperlink{pkcs11_8h_a7bc6919a7c3c372056fa7e18343a0b37}{CK\_BYTE\_PTR}})\ \mbox{\hyperlink{yubihsm__pkcs11_8c_ade5d8be372cb742833a442592301a68b}{pPublicKeyTemplate}}[i].pValue;}
\DoxyCodeLine{03351\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!((\mbox{\hyperlink{yubihsm__pkcs11_8c_ade5d8be372cb742833a442592301a68b}{pPublicKeyTemplate}}[i].ulValueLen\ ==\ 3\ \&\&}
\DoxyCodeLine{03352\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ memcmp(e,\ \textcolor{stringliteral}{"{}\(\backslash\)x01\(\backslash\)x00\(\backslash\)x01"{}},\ 3)\ ==\ 0)\ ||}
\DoxyCodeLine{03353\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\mbox{\hyperlink{yubihsm__pkcs11_8c_ade5d8be372cb742833a442592301a68b}{pPublicKeyTemplate}}[i].ulValueLen\ ==\ 4\ \&\&}
\DoxyCodeLine{03354\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ memcmp(e,\ \textcolor{stringliteral}{"{}\(\backslash\)x00\(\backslash\)x01\(\backslash\)x00\(\backslash\)x01"{}},\ 4)\ ==\ 0)))\ \{}
\DoxyCodeLine{03355\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a2e3ed21e5ffba18d940d164aaec64a2a}{DBG\_ERR}}(\textcolor{stringliteral}{"{}CKA\_PUBLIC\_EXPONENT\ invalid\ in\ PublicKeyTemplate"{}});}
\DoxyCodeLine{03356\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_ab818f05c56d56675438515a7ba5ebb70}{CKR\_ATTRIBUTE\_VALUE\_INVALID}};}
\DoxyCodeLine{03357\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03358\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03359\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a2e3ed21e5ffba18d940d164aaec64a2a}{DBG\_ERR}}(\textcolor{stringliteral}{"{}CKA\_PUBLIC\_EXPONENT\ inconsistent\ in\ PublicKeyTemplate"{}});}
\DoxyCodeLine{03360\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a98d78208707bfa2c51d6f051af1794e9}{CKR\_TEMPLATE\_INCONSISTENT}};}
\DoxyCodeLine{03361\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03362\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03363\ }
\DoxyCodeLine{03364\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ace277af7e7da877d65a25411a22a6b39}{CKA\_MODULUS\_BITS}}:}
\DoxyCodeLine{03365\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (*((\mbox{\hyperlink{pkcs11_8h_a2c6426aaa1ca6dd1f48a01b8490482fa}{CK\_ULONG\_PTR}})\ \mbox{\hyperlink{yubihsm__pkcs11_8c_ade5d8be372cb742833a442592301a68b}{pPublicKeyTemplate}}[i].pValue))\ \{}
\DoxyCodeLine{03366\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 2048:}
\DoxyCodeLine{03367\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{template}-\/>algorithm\ =\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caaafe94e6a770edb51c6db84f77d98d2c6}{YH\_ALGO\_RSA\_2048}};}
\DoxyCodeLine{03368\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03369\ }
\DoxyCodeLine{03370\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 3072:}
\DoxyCodeLine{03371\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{template}-\/>algorithm\ =\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caafd3fbd9ed86caf267ccc77cb24d44426}{YH\_ALGO\_RSA\_3072}};}
\DoxyCodeLine{03372\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03373\ }
\DoxyCodeLine{03374\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 4096:}
\DoxyCodeLine{03375\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{template}-\/>algorithm\ =\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caae5963322a0a0f43a1b74faa78e3a7329}{YH\_ALGO\_RSA\_4096}};}
\DoxyCodeLine{03376\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03377\ }
\DoxyCodeLine{03378\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{03379\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a2e3ed21e5ffba18d940d164aaec64a2a}{DBG\_ERR}}(\textcolor{stringliteral}{"{}CKA\_MODULUS\_BITS\ wrong\ length\ in\ PublicKeyTemplate\ (\%lu)"{}},}
\DoxyCodeLine{03380\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *((\mbox{\hyperlink{pkcs11_8h_a2c6426aaa1ca6dd1f48a01b8490482fa}{CK\_ULONG\_PTR}})\ \mbox{\hyperlink{yubihsm__pkcs11_8c_ade5d8be372cb742833a442592301a68b}{pPublicKeyTemplate}}[i].pValue));}
\DoxyCodeLine{03381\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_ab818f05c56d56675438515a7ba5ebb70}{CKR\_ATTRIBUTE\_VALUE\_INVALID}};}
\DoxyCodeLine{03382\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03383\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03384\ }
\DoxyCodeLine{03385\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_acf009a991c04b5c4305cc76356225aa7}{CKA\_LABEL}}:}
\DoxyCodeLine{03386\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_ade5d8be372cb742833a442592301a68b}{pPublicKeyTemplate}}[i].ulValueLen\ >\ \mbox{\hyperlink{yubihsm_8h_a431f8b753552a8b2f5f980e871b6d019}{YH\_OBJ\_LABEL\_LEN}})\ \{}
\DoxyCodeLine{03387\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a2e3ed21e5ffba18d940d164aaec64a2a}{DBG\_ERR}}(\textcolor{stringliteral}{"{}CKA\_LABEL\ invalid\ in\ PublicKeyTemplate"{}});}
\DoxyCodeLine{03388\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_ab818f05c56d56675438515a7ba5ebb70}{CKR\_ATTRIBUTE\_VALUE\_INVALID}};}
\DoxyCodeLine{03389\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03390\ }
\DoxyCodeLine{03391\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a53ef06e29c840024a683512c1acd791a}{template}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__object__template_a22edd3acceb711249d7593e73ad0d7f3}{label}},\ \mbox{\hyperlink{yubihsm__pkcs11_8c_ade5d8be372cb742833a442592301a68b}{pPublicKeyTemplate}}[i].pValue,}
\DoxyCodeLine{03392\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ade5d8be372cb742833a442592301a68b}{pPublicKeyTemplate}}[i].ulValueLen);}
\DoxyCodeLine{03393\ }
\DoxyCodeLine{03394\ \ \ \ \ \ \ \ \ label\_set\ =\ \mbox{\hyperlink{pkcs11_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}};}
\DoxyCodeLine{03395\ }
\DoxyCodeLine{03396\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03397\ }
\DoxyCodeLine{03398\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a05c1c460160443a739c6e0ce47ae3fc8}{CKA\_TOKEN}}:}
\DoxyCodeLine{03399\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}}\ =\ check\_bool\_attribute(\mbox{\hyperlink{yubihsm__pkcs11_8c_ade5d8be372cb742833a442592301a68b}{pPublicKeyTemplate}}[i].pValue,\ \textcolor{keyword}{true}))\ !=}
\DoxyCodeLine{03400\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}})\ \{}
\DoxyCodeLine{03401\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a2e3ed21e5ffba18d940d164aaec64a2a}{DBG\_ERR}}(\textcolor{stringliteral}{"{}Boolean\ truth\ check\ failed\ for\ attribute\ 0x\%lx"{}},}
\DoxyCodeLine{03402\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ade5d8be372cb742833a442592301a68b}{pPublicKeyTemplate}}[i].type);}
\DoxyCodeLine{03403\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}};}
\DoxyCodeLine{03404\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03405\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03406\ }
\DoxyCodeLine{03407\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a39688e3f665848ca7868f2ca37aa1aed}{CKA\_MODIFIABLE}}:}
\DoxyCodeLine{03408\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_aa26224c75961163975e3de4347940401}{CKA\_DECRYPT}}:}
\DoxyCodeLine{03409\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a6ffd14ad7386d9aa7178e841a964a87e}{CKA\_SIGN}}:}
\DoxyCodeLine{03410\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a9a9a988131e4e93d0758e43c555bdc97}{CKA\_UNWRAP}}:}
\DoxyCodeLine{03411\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}}\ =\ check\_bool\_attribute(\mbox{\hyperlink{yubihsm__pkcs11_8c_ade5d8be372cb742833a442592301a68b}{pPublicKeyTemplate}}[i].pValue,\ \textcolor{keyword}{false}))\ !=}
\DoxyCodeLine{03412\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}})\ \{}
\DoxyCodeLine{03413\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a2e3ed21e5ffba18d940d164aaec64a2a}{DBG\_ERR}}(\textcolor{stringliteral}{"{}Boolean\ false\ check\ failed\ for\ attribute\ 0x\%lx"{}},}
\DoxyCodeLine{03414\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ade5d8be372cb742833a442592301a68b}{pPublicKeyTemplate}}[i].type);}
\DoxyCodeLine{03415\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}};}
\DoxyCodeLine{03416\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03417\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03418\ }
\DoxyCodeLine{03419\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_af7a34bb656aa7e2b7e813dab0a6ac7b7}{CKA\_WRAP}}:}
\DoxyCodeLine{03420\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a84c89cd9def639cb4a58145063b7bd42}{CKA\_VERIFY}}:}
\DoxyCodeLine{03421\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ad427016a08d7b8f0d8fe910b907e9b44}{CKA\_ENCRYPT}}:}
\DoxyCodeLine{03422\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_acf37955a2a229d208289962c6f1183b8}{CKA\_EXTRACTABLE}}:}
\DoxyCodeLine{03423\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a5244a0b0719c79614044460bdcf34d11}{CKA\_PRIVATE}}:}
\DoxyCodeLine{03424\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a92925cbe2a1b3d50dd56f8af0f770a69}{CKA\_COPYABLE}}:}
\DoxyCodeLine{03425\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ab495c20657f01d79e1a6ca49d2c8472e}{CKA\_DESTROYABLE}}:}
\DoxyCodeLine{03426\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03427\ }
\DoxyCodeLine{03428\ \ \ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{03429\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a2e3ed21e5ffba18d940d164aaec64a2a}{DBG\_ERR}}(\textcolor{stringliteral}{"{}invalid\ attribute\ type\ in\ PublicKeyTemplate:\ 0x\%lx"{}},}
\DoxyCodeLine{03430\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ade5d8be372cb742833a442592301a68b}{pPublicKeyTemplate}}[i].type);}
\DoxyCodeLine{03431\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a0afbefc1a4ce05ba5faea1778eb602ca}{CKR\_ATTRIBUTE\_TYPE\_INVALID}};}
\DoxyCodeLine{03432\ \ \ \ \ \}}
\DoxyCodeLine{03433\ \ \ \}}
\DoxyCodeLine{03434\ }
\DoxyCodeLine{03435\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{pkcs11_8h_a35181858a3b7a0a81f49d180d8f446ef}{CK\_ULONG}}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a062bc7ed451133876d988fb653844af4}{ulPrivateKeyAttributeCount}};\ i++)\ \{}
\DoxyCodeLine{03436\ \ \ \ \ \textcolor{keywordflow}{switch}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_aa0bd9585bb6c1f50e5c0c72da9d48cb9}{pPrivateKeyTemplate}}[i].type)\ \{}
\DoxyCodeLine{03437\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_af867d3ae9286fe0f8cab4995bb6af337}{CKA\_CLASS}}:}
\DoxyCodeLine{03438\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (*((\mbox{\hyperlink{pkcs11_8h_a2c6426aaa1ca6dd1f48a01b8490482fa}{CK\_ULONG\_PTR}})\ \mbox{\hyperlink{yubihsm__pkcs11_8c_aa0bd9585bb6c1f50e5c0c72da9d48cb9}{pPrivateKeyTemplate}}[i].pValue)\ !=}
\DoxyCodeLine{03439\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{pkcs11_8h_a8aa610efb7f7dd562bce4576250753a8}{CKO\_PRIVATE\_KEY}})\ \{}
\DoxyCodeLine{03440\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a2e3ed21e5ffba18d940d164aaec64a2a}{DBG\_ERR}}(\textcolor{stringliteral}{"{}CKA\_CLASS\ inconsistent\ in\ PrivateKeyTemplate"{}});}
\DoxyCodeLine{03441\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a98d78208707bfa2c51d6f051af1794e9}{CKR\_TEMPLATE\_INCONSISTENT}};}
\DoxyCodeLine{03442\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03443\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03444\ }
\DoxyCodeLine{03445\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_aa438b88cbcb8a921288eeefba5613274}{CKA\_KEY\_TYPE}}:}
\DoxyCodeLine{03446\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (*((\mbox{\hyperlink{pkcs11_8h_a2c6426aaa1ca6dd1f48a01b8490482fa}{CK\_ULONG\_PTR}})\ \mbox{\hyperlink{yubihsm__pkcs11_8c_aa0bd9585bb6c1f50e5c0c72da9d48cb9}{pPrivateKeyTemplate}}[i].pValue)\ !=\ \mbox{\hyperlink{pkcs11_8h_a354731675f1ecc116e220b58b32636a1}{CKK\_RSA}})\ \{}
\DoxyCodeLine{03447\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a2e3ed21e5ffba18d940d164aaec64a2a}{DBG\_ERR}}(\textcolor{stringliteral}{"{}CKA\_KEY\_TYPE\ inconsistent\ in\ PrivateKeyTemplate"{}});}
\DoxyCodeLine{03448\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a98d78208707bfa2c51d6f051af1794e9}{CKR\_TEMPLATE\_INCONSISTENT}};}
\DoxyCodeLine{03449\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03450\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03451\ }
\DoxyCodeLine{03452\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a2846a5a41835defa47716ccc3bcc4913}{CKA\_ID}}:\ \{}
\DoxyCodeLine{03453\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \textcolor{keywordtype}{id}\ =\ \mbox{\hyperlink{util__pkcs11_8c_a66eb3d4688d7e1358a14b6c86b2158f9}{parse\_id\_value}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_aa0bd9585bb6c1f50e5c0c72da9d48cb9}{pPrivateKeyTemplate}}[i].pValue,}
\DoxyCodeLine{03454\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_aa0bd9585bb6c1f50e5c0c72da9d48cb9}{pPrivateKeyTemplate}}[i].ulValueLen);}
\DoxyCodeLine{03455\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\textcolor{keywordtype}{id}\ ==\ -\/1)\ \{}
\DoxyCodeLine{03456\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a2e3ed21e5ffba18d940d164aaec64a2a}{DBG\_ERR}}(\textcolor{stringliteral}{"{}CKA\_ID\ invalid\ in\ PrivateKeyTemplate"{}});}
\DoxyCodeLine{03457\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_ab818f05c56d56675438515a7ba5ebb70}{CKR\_ATTRIBUTE\_VALUE\_INVALID}};}
\DoxyCodeLine{03458\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03459\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a53ef06e29c840024a683512c1acd791a}{template}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__object__template_ad1b0e5ec887cae21e37a4b852a66727a}{id}}\ !=\ 0\ \&\&\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a53ef06e29c840024a683512c1acd791a}{template}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__object__template_ad1b0e5ec887cae21e37a4b852a66727a}{id}}\ !=\ \textcolor{keywordtype}{id})\ \{}
\DoxyCodeLine{03460\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a2e3ed21e5ffba18d940d164aaec64a2a}{DBG\_ERR}}(\textcolor{stringliteral}{"{}CKA\_ID\ inconsistent\ in\ PrivateKeyTemplate"{}});}
\DoxyCodeLine{03461\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a98d78208707bfa2c51d6f051af1794e9}{CKR\_TEMPLATE\_INCONSISTENT}};}
\DoxyCodeLine{03462\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03463\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{template}-\/>id\ =\ \mbox{\hyperlink{code__cache_8cpp_aa0efefe21f4700d78692edc823e763be}{id}};}
\DoxyCodeLine{03464\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03465\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03466\ }
\DoxyCodeLine{03467\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_aa26224c75961163975e3de4347940401}{CKA\_DECRYPT}}:}
\DoxyCodeLine{03468\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}}\ =\ \mbox{\hyperlink{util__pkcs11_8c_a03b553175220c8747145497de5032100}{set\_template\_attribute}}(\&\mbox{\hyperlink{yubihsm__pkcs11_8c_a53ef06e29c840024a683512c1acd791a}{template}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__object__template_a11816ed4ec4908d99d1fc35935f4bf52}{decrypt}},}
\DoxyCodeLine{03469\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_aa0bd9585bb6c1f50e5c0c72da9d48cb9}{pPrivateKeyTemplate}}[i].pValue))\ !=}
\DoxyCodeLine{03470\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}})\ \{}
\DoxyCodeLine{03471\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a2e3ed21e5ffba18d940d164aaec64a2a}{DBG\_ERR}}(\textcolor{stringliteral}{"{}CKA\_DECRYPT\ inconsistent\ in\ PrivateKeyTemplate"{}});}
\DoxyCodeLine{03472\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}};}
\DoxyCodeLine{03473\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03474\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03475\ }
\DoxyCodeLine{03476\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a6ffd14ad7386d9aa7178e841a964a87e}{CKA\_SIGN}}:}
\DoxyCodeLine{03477\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}}\ =\ \mbox{\hyperlink{util__pkcs11_8c_a03b553175220c8747145497de5032100}{set\_template\_attribute}}(\&\mbox{\hyperlink{yubihsm__pkcs11_8c_a53ef06e29c840024a683512c1acd791a}{template}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__object__template_a10f570d27a0e5b375f3e5e32f09c2c84}{sign}},}
\DoxyCodeLine{03478\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_aa0bd9585bb6c1f50e5c0c72da9d48cb9}{pPrivateKeyTemplate}}[i].pValue))\ !=}
\DoxyCodeLine{03479\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}})\ \{}
\DoxyCodeLine{03480\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a2e3ed21e5ffba18d940d164aaec64a2a}{DBG\_ERR}}(\textcolor{stringliteral}{"{}CKA\_SIGN\ inconsistent\ in\ PrivateKeyTemplate"{}});}
\DoxyCodeLine{03481\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}};}
\DoxyCodeLine{03482\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03483\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03484\ }
\DoxyCodeLine{03485\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_acf37955a2a229d208289962c6f1183b8}{CKA\_EXTRACTABLE}}:}
\DoxyCodeLine{03486\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}}\ =\ \mbox{\hyperlink{util__pkcs11_8c_a03b553175220c8747145497de5032100}{set\_template\_attribute}}(\&\mbox{\hyperlink{yubihsm__pkcs11_8c_a53ef06e29c840024a683512c1acd791a}{template}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__object__template_a30a6882cb36864acc3e27baaf38ff0f1}{exportable}},}
\DoxyCodeLine{03487\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_aa0bd9585bb6c1f50e5c0c72da9d48cb9}{pPrivateKeyTemplate}}[i].pValue))\ !=}
\DoxyCodeLine{03488\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}})\ \{}
\DoxyCodeLine{03489\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a2e3ed21e5ffba18d940d164aaec64a2a}{DBG\_ERR}}(\textcolor{stringliteral}{"{}CKA\_EXTRACTABLE\ inconsistent\ in\ PrivateKeyTemplate"{}});}
\DoxyCodeLine{03490\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}};}
\DoxyCodeLine{03491\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03492\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03493\ }
\DoxyCodeLine{03494\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_acf009a991c04b5c4305cc76356225aa7}{CKA\_LABEL}}:}
\DoxyCodeLine{03495\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_aa0bd9585bb6c1f50e5c0c72da9d48cb9}{pPrivateKeyTemplate}}[i].ulValueLen\ >\ \mbox{\hyperlink{yubihsm_8h_a431f8b753552a8b2f5f980e871b6d019}{YH\_OBJ\_LABEL\_LEN}})\ \{}
\DoxyCodeLine{03496\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a2e3ed21e5ffba18d940d164aaec64a2a}{DBG\_ERR}}(\textcolor{stringliteral}{"{}CKA\_LABEL\ invalid\ in\ PrivateKeyTemplate"{}});}
\DoxyCodeLine{03497\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_ab818f05c56d56675438515a7ba5ebb70}{CKR\_ATTRIBUTE\_VALUE\_INVALID}};}
\DoxyCodeLine{03498\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03499\ }
\DoxyCodeLine{03500\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (label\_set\ ==\ \mbox{\hyperlink{pkcs11_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}})\ \{}
\DoxyCodeLine{03501\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (memcmp(\mbox{\hyperlink{yubihsm__pkcs11_8c_a53ef06e29c840024a683512c1acd791a}{template}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__object__template_a22edd3acceb711249d7593e73ad0d7f3}{label}},\ \mbox{\hyperlink{yubihsm__pkcs11_8c_aa0bd9585bb6c1f50e5c0c72da9d48cb9}{pPrivateKeyTemplate}}[i].pValue,}
\DoxyCodeLine{03502\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_aa0bd9585bb6c1f50e5c0c72da9d48cb9}{pPrivateKeyTemplate}}[i].ulValueLen)\ !=\ 0)\ \{}
\DoxyCodeLine{03503\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a2e3ed21e5ffba18d940d164aaec64a2a}{DBG\_ERR}}(\textcolor{stringliteral}{"{}CKA\_LABEL\ inconsistent\ in\ PrivateKeyTemplate"{}});}
\DoxyCodeLine{03504\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a98d78208707bfa2c51d6f051af1794e9}{CKR\_TEMPLATE\_INCONSISTENT}};}
\DoxyCodeLine{03505\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03506\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03507\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a53ef06e29c840024a683512c1acd791a}{template}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__object__template_a22edd3acceb711249d7593e73ad0d7f3}{label}},\ \mbox{\hyperlink{yubihsm__pkcs11_8c_aa0bd9585bb6c1f50e5c0c72da9d48cb9}{pPrivateKeyTemplate}}[i].pValue,}
\DoxyCodeLine{03508\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_aa0bd9585bb6c1f50e5c0c72da9d48cb9}{pPrivateKeyTemplate}}[i].ulValueLen);}
\DoxyCodeLine{03509\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03510\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03511\ }
\DoxyCodeLine{03512\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a05c1c460160443a739c6e0ce47ae3fc8}{CKA\_TOKEN}}:}
\DoxyCodeLine{03513\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a5fe5fb4a38ca6781c50e4cba8a2af0d6}{CKA\_SENSITIVE}}:}
\DoxyCodeLine{03514\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a5244a0b0719c79614044460bdcf34d11}{CKA\_PRIVATE}}:}
\DoxyCodeLine{03515\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ab495c20657f01d79e1a6ca49d2c8472e}{CKA\_DESTROYABLE}}:}
\DoxyCodeLine{03516\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}}\ =\ check\_bool\_attribute(\mbox{\hyperlink{yubihsm__pkcs11_8c_aa0bd9585bb6c1f50e5c0c72da9d48cb9}{pPrivateKeyTemplate}}[i].pValue,\ \textcolor{keyword}{true}))\ !=}
\DoxyCodeLine{03517\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}})\ \{}
\DoxyCodeLine{03518\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a2e3ed21e5ffba18d940d164aaec64a2a}{DBG\_ERR}}(\textcolor{stringliteral}{"{}Boolean\ truth\ check\ failed\ for\ attribute\ 0x\%lx"{}},}
\DoxyCodeLine{03519\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_aa0bd9585bb6c1f50e5c0c72da9d48cb9}{pPrivateKeyTemplate}}[i].type);}
\DoxyCodeLine{03520\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}};}
\DoxyCodeLine{03521\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03522\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03523\ }
\DoxyCodeLine{03524\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_af7a34bb656aa7e2b7e813dab0a6ac7b7}{CKA\_WRAP}}:}
\DoxyCodeLine{03525\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a39688e3f665848ca7868f2ca37aa1aed}{CKA\_MODIFIABLE}}:}
\DoxyCodeLine{03526\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a92925cbe2a1b3d50dd56f8af0f770a69}{CKA\_COPYABLE}}:}
\DoxyCodeLine{03527\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ad427016a08d7b8f0d8fe910b907e9b44}{CKA\_ENCRYPT}}:}
\DoxyCodeLine{03528\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a84c89cd9def639cb4a58145063b7bd42}{CKA\_VERIFY}}:}
\DoxyCodeLine{03529\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}}\ =\ check\_bool\_attribute(\mbox{\hyperlink{yubihsm__pkcs11_8c_aa0bd9585bb6c1f50e5c0c72da9d48cb9}{pPrivateKeyTemplate}}[i].pValue,\ \textcolor{keyword}{false}))\ !=}
\DoxyCodeLine{03530\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}})\ \{}
\DoxyCodeLine{03531\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a2e3ed21e5ffba18d940d164aaec64a2a}{DBG\_ERR}}(\textcolor{stringliteral}{"{}Boolean\ false\ check\ failed\ for\ attribute\ 0x\%lx"{}},}
\DoxyCodeLine{03532\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_aa0bd9585bb6c1f50e5c0c72da9d48cb9}{pPrivateKeyTemplate}}[i].type);}
\DoxyCodeLine{03533\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}};}
\DoxyCodeLine{03534\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03535\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03536\ }
\DoxyCodeLine{03537\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a9a9a988131e4e93d0758e43c555bdc97}{CKA\_UNWRAP}}:}
\DoxyCodeLine{03538\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_afef7cb3cf999a4ea9962e780c3e6e1cf}{CKA\_SUBJECT}}:}
\DoxyCodeLine{03539\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03540\ }
\DoxyCodeLine{03541\ \ \ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{03542\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a2e3ed21e5ffba18d940d164aaec64a2a}{DBG\_ERR}}(\textcolor{stringliteral}{"{}invalid\ attribute\ type\ in\ PrivateKeyTemplate:\ 0x\%lx"{}},}
\DoxyCodeLine{03543\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_aa0bd9585bb6c1f50e5c0c72da9d48cb9}{pPrivateKeyTemplate}}[i].type);}
\DoxyCodeLine{03544\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a0afbefc1a4ce05ba5faea1778eb602ca}{CKR\_ATTRIBUTE\_TYPE\_INVALID}};}
\DoxyCodeLine{03545\ \ \ \ \ \}}
\DoxyCodeLine{03546\ \ \ \}}
\DoxyCodeLine{03547\ }
\DoxyCodeLine{03548\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a53ef06e29c840024a683512c1acd791a}{template}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__object__template_ad180a15b1f1a790679f9e5af6716b191}{algorithm}}\ ==\ 0)\ \{}
\DoxyCodeLine{03549\ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a2e3ed21e5ffba18d940d164aaec64a2a}{DBG\_ERR}}(\textcolor{stringliteral}{"{}No\ RSA\ bitlength\ set"{}});}
\DoxyCodeLine{03550\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_acfcd3a766f4ce45e10b89243cfe9f07e}{CKR\_TEMPLATE\_INCOMPLETE}};}
\DoxyCodeLine{03551\ \ \ \}}
\DoxyCodeLine{03552\ }
\DoxyCodeLine{03553\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}};}
\DoxyCodeLine{03554\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=330pt]{util__pkcs11_8c_a3ae0dc7de593ff0d92ff81baaae9d5cb_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=246pt]{util__pkcs11_8c_a3ae0dc7de593ff0d92ff81baaae9d5cb_icgraph}
\end{center}
\end{figure}
\Hypertarget{util__pkcs11_8c_ab6a02fb5fc61b638c0f202f561d42445}\index{util\_pkcs11.c@{util\_pkcs11.c}!parse\_rsa\_template@{parse\_rsa\_template}}
\index{parse\_rsa\_template@{parse\_rsa\_template}!util\_pkcs11.c@{util\_pkcs11.c}}
\doxysubsubsection{\texorpdfstring{parse\_rsa\_template()}{parse\_rsa\_template()}}
{\footnotesize\ttfamily \label{util__pkcs11_8c_ab6a02fb5fc61b638c0f202f561d42445} 
CK\+\_\+\+RV parse\+\_\+rsa\+\_\+template (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{pkcs11_8h_a5db3536793782f135785609e4a849fc6}{CK\+\_\+\+ATTRIBUTE\+\_\+\+PTR}}}]{p\+Template}{, }\item[{\mbox{\hyperlink{pkcs11_8h_a35181858a3b7a0a81f49d180d8f446ef}{CK\+\_\+\+ULONG}}}]{ul\+Count}{, }\item[{\mbox{\hyperlink{structyubihsm__pkcs11__object__template}{yubihsm\+\_\+pkcs11\+\_\+object\+\_\+template}} \texorpdfstring{$\ast$}{*}}]{template}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{util__pkcs11_8c_source_l02976}{2976}} of file \mbox{\hyperlink{util__pkcs11_8c_source}{util\+\_\+pkcs11.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02977\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02978\ }
\DoxyCodeLine{02979\ \ \ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ *e\ =\ NULL;}
\DoxyCodeLine{02980\ \ \ \mbox{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t}}\ primelen\ =\ 0;}
\DoxyCodeLine{02981\ \ \ CK\_RV\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}};}
\DoxyCodeLine{02982\ }
\DoxyCodeLine{02983\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{pkcs11_8h_a35181858a3b7a0a81f49d180d8f446ef}{CK\_ULONG}}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a490d37150a3d116225298faf1cb780b6}{ulCount}};\ i++)\ \{}
\DoxyCodeLine{02984\ \ \ \ \ \textcolor{keywordflow}{switch}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_aa4c2296db6853afc30383aec1a404972}{pTemplate}}[i].type)\ \{}
\DoxyCodeLine{02985\ }
\DoxyCodeLine{02986\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a56db29b456158a6805ee49051715ceca}{CKA\_PRIME\_1}}:}
\DoxyCodeLine{02987\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a53ef06e29c840024a683512c1acd791a}{template}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__object__template_aa7e23493c41030819bd65ab687c604a7}{obj}}.\mbox{\hyperlink{structyubihsm__pkcs11__object__template_a63b0dbd1182e372d6a05a5321fe0bd0e}{rsa}}.p\ ==\ NULL)\ \{}
\DoxyCodeLine{02988\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{template}-\/>obj.rsa.p\ =\ (\mbox{\hyperlink{pkcs11_8h_a7bc6919a7c3c372056fa7e18343a0b37}{CK\_BYTE\_PTR}})\ \mbox{\hyperlink{yubihsm__pkcs11_8c_aa4c2296db6853afc30383aec1a404972}{pTemplate}}[i].pValue;}
\DoxyCodeLine{02989\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_aa4c2296db6853afc30383aec1a404972}{pTemplate}}[i].ulValueLen\ \%\ 2\ !=\ 0)\ \{}
\DoxyCodeLine{02990\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_aa4c2296db6853afc30383aec1a404972}{pTemplate}}[i].ulValueLen-\/-\/;}
\DoxyCodeLine{02991\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{template}-\/>obj.rsa.p++;}
\DoxyCodeLine{02992\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02993\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (primelen\ ==\ 0\ ||\ primelen\ ==\ \mbox{\hyperlink{yubihsm__pkcs11_8c_aa4c2296db6853afc30383aec1a404972}{pTemplate}}[i].ulValueLen)\ \{}
\DoxyCodeLine{02994\ \ \ \ \ \ \ \ \ \ \ \ \ primelen\ =\ \mbox{\hyperlink{yubihsm__pkcs11_8c_aa4c2296db6853afc30383aec1a404972}{pTemplate}}[i].ulValueLen;}
\DoxyCodeLine{02995\ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02996\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a98d78208707bfa2c51d6f051af1794e9}{CKR\_TEMPLATE\_INCONSISTENT}};}
\DoxyCodeLine{02997\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02998\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02999\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a98d78208707bfa2c51d6f051af1794e9}{CKR\_TEMPLATE\_INCONSISTENT}};}
\DoxyCodeLine{03000\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03001\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03002\ }
\DoxyCodeLine{03003\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a93ab45da1c5f54840b624cccb5cde45a}{CKA\_PRIME\_2}}:}
\DoxyCodeLine{03004\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a53ef06e29c840024a683512c1acd791a}{template}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__object__template_aa7e23493c41030819bd65ab687c604a7}{obj}}.\mbox{\hyperlink{structyubihsm__pkcs11__object__template_a63b0dbd1182e372d6a05a5321fe0bd0e}{rsa}}.q\ ==\ NULL)\ \{}
\DoxyCodeLine{03005\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{template}-\/>obj.rsa.q\ =\ (\mbox{\hyperlink{pkcs11_8h_a7bc6919a7c3c372056fa7e18343a0b37}{CK\_BYTE\_PTR}})\ \mbox{\hyperlink{yubihsm__pkcs11_8c_aa4c2296db6853afc30383aec1a404972}{pTemplate}}[i].pValue;}
\DoxyCodeLine{03006\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_aa4c2296db6853afc30383aec1a404972}{pTemplate}}[i].ulValueLen\ \%\ 2\ !=\ 0)\ \{}
\DoxyCodeLine{03007\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_aa4c2296db6853afc30383aec1a404972}{pTemplate}}[i].ulValueLen-\/-\/;}
\DoxyCodeLine{03008\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{template}-\/>obj.rsa.q++;}
\DoxyCodeLine{03009\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03010\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (primelen\ ==\ 0\ ||\ primelen\ ==\ \mbox{\hyperlink{yubihsm__pkcs11_8c_aa4c2296db6853afc30383aec1a404972}{pTemplate}}[i].ulValueLen)\ \{}
\DoxyCodeLine{03011\ \ \ \ \ \ \ \ \ \ \ \ \ primelen\ =\ \mbox{\hyperlink{yubihsm__pkcs11_8c_aa4c2296db6853afc30383aec1a404972}{pTemplate}}[i].ulValueLen;}
\DoxyCodeLine{03012\ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03013\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a98d78208707bfa2c51d6f051af1794e9}{CKR\_TEMPLATE\_INCONSISTENT}};}
\DoxyCodeLine{03014\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03015\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03016\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a98d78208707bfa2c51d6f051af1794e9}{CKR\_TEMPLATE\_INCONSISTENT}};}
\DoxyCodeLine{03017\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03018\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03019\ }
\DoxyCodeLine{03020\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a3560a0897e67ea3584c5e5d6b49997a9}{CKA\_PUBLIC\_EXPONENT}}:}
\DoxyCodeLine{03021\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (e\ ==\ NULL)\ \{}
\DoxyCodeLine{03022\ \ \ \ \ \ \ \ \ \ \ e\ =\ (\mbox{\hyperlink{pkcs11_8h_a7bc6919a7c3c372056fa7e18343a0b37}{CK\_BYTE\_PTR}})\ \mbox{\hyperlink{yubihsm__pkcs11_8c_aa4c2296db6853afc30383aec1a404972}{pTemplate}}[i].pValue;}
\DoxyCodeLine{03023\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_aa4c2296db6853afc30383aec1a404972}{pTemplate}}[i].ulValueLen\ !=\ 3\ ||}
\DoxyCodeLine{03024\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ memcmp(e,\ \textcolor{stringliteral}{"{}\(\backslash\)x01\(\backslash\)x00\(\backslash\)x01"{}},\ 3)\ !=\ 0)\ \{}
\DoxyCodeLine{03025\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_ab818f05c56d56675438515a7ba5ebb70}{CKR\_ATTRIBUTE\_VALUE\_INVALID}};}
\DoxyCodeLine{03026\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03027\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03028\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a98d78208707bfa2c51d6f051af1794e9}{CKR\_TEMPLATE\_INCONSISTENT}};}
\DoxyCodeLine{03029\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03030\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03031\ }
\DoxyCodeLine{03032\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a6ffd14ad7386d9aa7178e841a964a87e}{CKA\_SIGN}}:}
\DoxyCodeLine{03033\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}}\ =\ \mbox{\hyperlink{util__pkcs11_8c_a03b553175220c8747145497de5032100}{set\_template\_attribute}}(\&\mbox{\hyperlink{yubihsm__pkcs11_8c_a53ef06e29c840024a683512c1acd791a}{template}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__object__template_a10f570d27a0e5b375f3e5e32f09c2c84}{sign}},}
\DoxyCodeLine{03034\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_aa4c2296db6853afc30383aec1a404972}{pTemplate}}[i].pValue))\ !=\ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}})\ \{}
\DoxyCodeLine{03035\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}};}
\DoxyCodeLine{03036\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03037\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03038\ }
\DoxyCodeLine{03039\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_aa26224c75961163975e3de4347940401}{CKA\_DECRYPT}}:}
\DoxyCodeLine{03040\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}}\ =\ \mbox{\hyperlink{util__pkcs11_8c_a03b553175220c8747145497de5032100}{set\_template\_attribute}}(\&\mbox{\hyperlink{yubihsm__pkcs11_8c_a53ef06e29c840024a683512c1acd791a}{template}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__object__template_a11816ed4ec4908d99d1fc35935f4bf52}{decrypt}},}
\DoxyCodeLine{03041\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_aa4c2296db6853afc30383aec1a404972}{pTemplate}}[i].pValue))\ !=\ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}})\ \{}
\DoxyCodeLine{03042\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}};}
\DoxyCodeLine{03043\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03044\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03045\ }
\DoxyCodeLine{03046\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a05c1c460160443a739c6e0ce47ae3fc8}{CKA\_TOKEN}}:}
\DoxyCodeLine{03047\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a5244a0b0719c79614044460bdcf34d11}{CKA\_PRIVATE}}:}
\DoxyCodeLine{03048\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a5fe5fb4a38ca6781c50e4cba8a2af0d6}{CKA\_SENSITIVE}}:}
\DoxyCodeLine{03049\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}}\ =\ check\_bool\_attribute(\mbox{\hyperlink{yubihsm__pkcs11_8c_aa4c2296db6853afc30383aec1a404972}{pTemplate}}[i].pValue,\ \textcolor{keyword}{true}))\ !=\ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}})\ \{}
\DoxyCodeLine{03050\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}};}
\DoxyCodeLine{03051\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03052\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03053\ }
\DoxyCodeLine{03054\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a505044b8a4656ed27cf95f5f43c2c0c0}{CKA\_MODULUS}}:}
\DoxyCodeLine{03055\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a24dbc6c47c74f94256e9a86b047a44c8}{CKA\_PRIVATE\_EXPONENT}}:}
\DoxyCodeLine{03056\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a6c8501b0588f7ce31f993d75928b8f79}{CKA\_EXPONENT\_1}}:}
\DoxyCodeLine{03057\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a750faa17ba348fd5f5a8594b849eaaa5}{CKA\_EXPONENT\_2}}:}
\DoxyCodeLine{03058\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ab17da8a57cccda55b7f6b8be7b8d5aca}{CKA\_COEFFICIENT}}:}
\DoxyCodeLine{03059\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_af867d3ae9286fe0f8cab4995bb6af337}{CKA\_CLASS}}:}
\DoxyCodeLine{03060\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_aa438b88cbcb8a921288eeefba5613274}{CKA\_KEY\_TYPE}}:}
\DoxyCodeLine{03061\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_afef7cb3cf999a4ea9962e780c3e6e1cf}{CKA\_SUBJECT}}:}
\DoxyCodeLine{03062\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a2846a5a41835defa47716ccc3bcc4913}{CKA\_ID}}:}
\DoxyCodeLine{03063\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_acf009a991c04b5c4305cc76356225aa7}{CKA\_LABEL}}:}
\DoxyCodeLine{03064\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_acf37955a2a229d208289962c6f1183b8}{CKA\_EXTRACTABLE}}:}
\DoxyCodeLine{03065\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03066\ }
\DoxyCodeLine{03067\ \ \ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{03068\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a0afbefc1a4ce05ba5faea1778eb602ca}{CKR\_ATTRIBUTE\_TYPE\_INVALID}};}
\DoxyCodeLine{03069\ \ \ \ \ \}}
\DoxyCodeLine{03070\ \ \ \}}
\DoxyCodeLine{03071\ \ \ \textcolor{keywordflow}{if}\ (e\ \&\&\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a53ef06e29c840024a683512c1acd791a}{template}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__object__template_aa7e23493c41030819bd65ab687c604a7}{obj}}.\mbox{\hyperlink{structyubihsm__pkcs11__object__template_a63b0dbd1182e372d6a05a5321fe0bd0e}{rsa}}.p\ \&\&\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a53ef06e29c840024a683512c1acd791a}{template}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__object__template_aa7e23493c41030819bd65ab687c604a7}{obj}}.\mbox{\hyperlink{structyubihsm__pkcs11__object__template_a63b0dbd1182e372d6a05a5321fe0bd0e}{rsa}}.q)\ \{}
\DoxyCodeLine{03072\ \ \ \ \ \textcolor{keyword}{template}-\/>objlen\ =\ primelen;}
\DoxyCodeLine{03073\ \ \ \ \ \textcolor{keywordflow}{switch}\ (primelen)\ \{}
\DoxyCodeLine{03074\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 128:}
\DoxyCodeLine{03075\ \ \ \ \ \ \ \ \ \textcolor{keyword}{template}-\/>algorithm\ =\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caaafe94e6a770edb51c6db84f77d98d2c6}{YH\_ALGO\_RSA\_2048}};}
\DoxyCodeLine{03076\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03077\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 192:}
\DoxyCodeLine{03078\ \ \ \ \ \ \ \ \ \textcolor{keyword}{template}-\/>algorithm\ =\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caafd3fbd9ed86caf267ccc77cb24d44426}{YH\_ALGO\_RSA\_3072}};}
\DoxyCodeLine{03079\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03080\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 256:}
\DoxyCodeLine{03081\ \ \ \ \ \ \ \ \ \textcolor{keyword}{template}-\/>algorithm\ =\ \mbox{\hyperlink{yubihsm_8h_a498937b5a72accbb0ef21bb1dcdd55caae5963322a0a0f43a1b74faa78e3a7329}{YH\_ALGO\_RSA\_4096}};}
\DoxyCodeLine{03082\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03083\ \ \ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{03084\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_ab818f05c56d56675438515a7ba5ebb70}{CKR\_ATTRIBUTE\_VALUE\_INVALID}};}
\DoxyCodeLine{03085\ \ \ \ \ \}}
\DoxyCodeLine{03086\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03087\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a98d78208707bfa2c51d6f051af1794e9}{CKR\_TEMPLATE\_INCONSISTENT}};}
\DoxyCodeLine{03088\ \ \ \}}
\DoxyCodeLine{03089\ }
\DoxyCodeLine{03090\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}};}
\DoxyCodeLine{03091\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=330pt]{util__pkcs11_8c_ab6a02fb5fc61b638c0f202f561d42445_cgraph}
\end{center}
\end{figure}
\Hypertarget{util__pkcs11_8c_a63b36e79f7eb240fe1de611008509389}\index{util\_pkcs11.c@{util\_pkcs11.c}!parse\_wrap\_template@{parse\_wrap\_template}}
\index{parse\_wrap\_template@{parse\_wrap\_template}!util\_pkcs11.c@{util\_pkcs11.c}}
\doxysubsubsection{\texorpdfstring{parse\_wrap\_template()}{parse\_wrap\_template()}}
{\footnotesize\ttfamily \label{util__pkcs11_8c_a63b36e79f7eb240fe1de611008509389} 
CK\+\_\+\+RV parse\+\_\+wrap\+\_\+template (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{pkcs11_8h_a5db3536793782f135785609e4a849fc6}{CK\+\_\+\+ATTRIBUTE\+\_\+\+PTR}}}]{p\+Template}{, }\item[{\mbox{\hyperlink{pkcs11_8h_a35181858a3b7a0a81f49d180d8f446ef}{CK\+\_\+\+ULONG}}}]{ul\+Count}{, }\item[{\mbox{\hyperlink{structyubihsm__pkcs11__object__template}{yubihsm\+\_\+pkcs11\+\_\+object\+\_\+template}} \texorpdfstring{$\ast$}{*}}]{template}{, }\item[{bool}]{generate}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{util__pkcs11_8c_source_l03801}{3801}} of file \mbox{\hyperlink{util__pkcs11_8c_source}{util\+\_\+pkcs11.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{03803\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03804\ }
\DoxyCodeLine{03805\ \ \ CK\_RV\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}};}
\DoxyCodeLine{03806\ }
\DoxyCodeLine{03807\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{pkcs11_8h_a35181858a3b7a0a81f49d180d8f446ef}{CK\_ULONG}}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a490d37150a3d116225298faf1cb780b6}{ulCount}};\ i++)\ \{}
\DoxyCodeLine{03808\ \ \ \ \ \textcolor{keywordflow}{switch}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_aa4c2296db6853afc30383aec1a404972}{pTemplate}}[i].type)\ \{}
\DoxyCodeLine{03809\ }
\DoxyCodeLine{03810\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a799f3b28e5c856ef4229d12257818841}{CKA\_VALUE}}:}
\DoxyCodeLine{03811\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (generate\ ==\ \textcolor{keyword}{false}\ \&\&\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a53ef06e29c840024a683512c1acd791a}{template}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__object__template_aa7e23493c41030819bd65ab687c604a7}{obj}}.\mbox{\hyperlink{structyubihsm__pkcs11__object__template_acbc6f8ad9110ca09d862eaf06691897b}{buf}}\ ==\ NULL)\ \{}
\DoxyCodeLine{03812\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{template}-\/>obj.buf\ =\ (\mbox{\hyperlink{pkcs11_8h_a7bc6919a7c3c372056fa7e18343a0b37}{CK\_BYTE\_PTR}})\ \mbox{\hyperlink{yubihsm__pkcs11_8c_aa4c2296db6853afc30383aec1a404972}{pTemplate}}[i].pValue;}
\DoxyCodeLine{03813\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{template}-\/>objlen\ =\ \mbox{\hyperlink{yubihsm__pkcs11_8c_aa4c2296db6853afc30383aec1a404972}{pTemplate}}[i].ulValueLen;}
\DoxyCodeLine{03814\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03815\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a98d78208707bfa2c51d6f051af1794e9}{CKR\_TEMPLATE\_INCONSISTENT}};}
\DoxyCodeLine{03816\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03817\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03818\ }
\DoxyCodeLine{03819\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_af7a34bb656aa7e2b7e813dab0a6ac7b7}{CKA\_WRAP}}:}
\DoxyCodeLine{03820\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}}\ =\ \mbox{\hyperlink{util__pkcs11_8c_a03b553175220c8747145497de5032100}{set\_template\_attribute}}(\&\mbox{\hyperlink{yubihsm__pkcs11_8c_a53ef06e29c840024a683512c1acd791a}{template}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__object__template_a139e6333451b0bd3b6ab6f347c3ecede}{wrap}},}
\DoxyCodeLine{03821\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_aa4c2296db6853afc30383aec1a404972}{pTemplate}}[i].pValue))\ !=\ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}})\ \{}
\DoxyCodeLine{03822\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}};}
\DoxyCodeLine{03823\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03824\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03825\ }
\DoxyCodeLine{03826\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a9a9a988131e4e93d0758e43c555bdc97}{CKA\_UNWRAP}}:}
\DoxyCodeLine{03827\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}}\ =\ \mbox{\hyperlink{util__pkcs11_8c_a03b553175220c8747145497de5032100}{set\_template\_attribute}}(\&\mbox{\hyperlink{yubihsm__pkcs11_8c_a53ef06e29c840024a683512c1acd791a}{template}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__object__template_ab25f77df8d63b4e988b4b3cc6daa973c}{unwrap}},}
\DoxyCodeLine{03828\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_aa4c2296db6853afc30383aec1a404972}{pTemplate}}[i].pValue))\ !=\ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}})\ \{}
\DoxyCodeLine{03829\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}};}
\DoxyCodeLine{03830\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03831\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03832\ }
\DoxyCodeLine{03833\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_ad427016a08d7b8f0d8fe910b907e9b44}{CKA\_ENCRYPT}}:}
\DoxyCodeLine{03834\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}}\ =\ \mbox{\hyperlink{util__pkcs11_8c_a03b553175220c8747145497de5032100}{set\_template\_attribute}}(\&\mbox{\hyperlink{yubihsm__pkcs11_8c_a53ef06e29c840024a683512c1acd791a}{template}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__object__template_a9a386dfe41e927efc0796adcfdcda5a7}{encrypt}},}
\DoxyCodeLine{03835\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_aa4c2296db6853afc30383aec1a404972}{pTemplate}}[i].pValue))\ !=\ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}})\ \{}
\DoxyCodeLine{03836\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}};}
\DoxyCodeLine{03837\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03838\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03839\ }
\DoxyCodeLine{03840\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_aa26224c75961163975e3de4347940401}{CKA\_DECRYPT}}:}
\DoxyCodeLine{03841\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}}\ =\ \mbox{\hyperlink{util__pkcs11_8c_a03b553175220c8747145497de5032100}{set\_template\_attribute}}(\&\mbox{\hyperlink{yubihsm__pkcs11_8c_a53ef06e29c840024a683512c1acd791a}{template}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__object__template_a11816ed4ec4908d99d1fc35935f4bf52}{decrypt}},}
\DoxyCodeLine{03842\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_aa4c2296db6853afc30383aec1a404972}{pTemplate}}[i].pValue))\ !=\ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}})\ \{}
\DoxyCodeLine{03843\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}};}
\DoxyCodeLine{03844\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03845\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03846\ }
\DoxyCodeLine{03847\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a05c1c460160443a739c6e0ce47ae3fc8}{CKA\_TOKEN}}:}
\DoxyCodeLine{03848\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}}\ =\ check\_bool\_attribute(\mbox{\hyperlink{yubihsm__pkcs11_8c_aa4c2296db6853afc30383aec1a404972}{pTemplate}}[i].pValue,\ \textcolor{keyword}{true}))\ !=\ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}})\ \{}
\DoxyCodeLine{03849\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}};}
\DoxyCodeLine{03850\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03851\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03852\ }
\DoxyCodeLine{03853\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_aa438b88cbcb8a921288eeefba5613274}{CKA\_KEY\_TYPE}}:}
\DoxyCodeLine{03854\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_af867d3ae9286fe0f8cab4995bb6af337}{CKA\_CLASS}}:}
\DoxyCodeLine{03855\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_afef7cb3cf999a4ea9962e780c3e6e1cf}{CKA\_SUBJECT}}:}
\DoxyCodeLine{03856\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a2846a5a41835defa47716ccc3bcc4913}{CKA\_ID}}:}
\DoxyCodeLine{03857\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_acf009a991c04b5c4305cc76356225aa7}{CKA\_LABEL}}:}
\DoxyCodeLine{03858\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_acf37955a2a229d208289962c6f1183b8}{CKA\_EXTRACTABLE}}:}
\DoxyCodeLine{03859\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03860\ }
\DoxyCodeLine{03861\ \ \ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{03862\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a0afbefc1a4ce05ba5faea1778eb602ca}{CKR\_ATTRIBUTE\_TYPE\_INVALID}};}
\DoxyCodeLine{03863\ \ \ \ \ \}}
\DoxyCodeLine{03864\ \ \ \}}
\DoxyCodeLine{03865\ \ \ \textcolor{keywordflow}{if}\ (generate\ ==\ \textcolor{keyword}{true}\ ||\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a53ef06e29c840024a683512c1acd791a}{template}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__object__template_aa7e23493c41030819bd65ab687c604a7}{obj}}.\mbox{\hyperlink{structyubihsm__pkcs11__object__template_acbc6f8ad9110ca09d862eaf06691897b}{buf}})\ \{}
\DoxyCodeLine{03866\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}};}
\DoxyCodeLine{03867\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03868\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a98d78208707bfa2c51d6f051af1794e9}{CKR\_TEMPLATE\_INCONSISTENT}};}
\DoxyCodeLine{03869\ \ \ \}}
\DoxyCodeLine{03870\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=338pt]{util__pkcs11_8c_a63b36e79f7eb240fe1de611008509389_cgraph}
\end{center}
\end{figure}
\Hypertarget{util__pkcs11_8c_a89815aa1db935281716a2b4d5520da8f}\index{util\_pkcs11.c@{util\_pkcs11.c}!perform\_decrypt@{perform\_decrypt}}
\index{perform\_decrypt@{perform\_decrypt}!util\_pkcs11.c@{util\_pkcs11.c}}
\doxysubsubsection{\texorpdfstring{perform\_decrypt()}{perform\_decrypt()}}
{\footnotesize\ttfamily \label{util__pkcs11_8c_a89815aa1db935281716a2b4d5520da8f} 
CK\+\_\+\+RV perform\+\_\+decrypt (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyh__session}{yh\+\_\+session}} \texorpdfstring{$\ast$}{*}}]{session}{, }\item[{\mbox{\hyperlink{structyubihsm__pkcs11__op__info}{yubihsm\+\_\+pkcs11\+\_\+op\+\_\+info}} \texorpdfstring{$\ast$}{*}}]{op\+\_\+info}{, }\item[{\mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t}} \texorpdfstring{$\ast$}{*}}]{data}{, }\item[{\mbox{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t}} \texorpdfstring{$\ast$}{*}}]{data\+\_\+len}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{util__pkcs11_8c_source_l02463}{2463}} of file \mbox{\hyperlink{util__pkcs11_8c_source}{util\+\_\+pkcs11.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02464\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02465\ }
\DoxyCodeLine{02466\ \ \ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366}{yh\_rc}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}};}
\DoxyCodeLine{02467\ \ \ \textcolor{keywordtype}{size\_t}\ outlen\ =\ \textcolor{keyword}{sizeof}(op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ad4fd174ba5f77aad7e1f1c66079529ba}{buffer}});}
\DoxyCodeLine{02468\ }
\DoxyCodeLine{02469\ \ \ \textcolor{keywordflow}{if}\ (op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a261664672f3ef63ab3a20b864627c49a}{mechanism}}.\mbox{\hyperlink{structmechanism_afeb8198b0f33f94f4520c0ffbc584a9a}{mechanism}}\ ==\ \mbox{\hyperlink{pkcs11_8h_a08a8e0f2109de3ff3bfe26f220447a2e}{CKM\_RSA\_PKCS}})\ \{}
\DoxyCodeLine{02470\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a5ebf6932cd2e68b9a23787c27fde3e26}{yh\_util\_decrypt\_pkcs1v1\_5}}(\mbox{\hyperlink{ecdh__derive__test_8c_a0a2c7706d971796d7dc84fee36d6c84f}{session}},\ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_a511016f53f468cbe53728403a03df05a}{decrypt}}.\mbox{\hyperlink{structdecrypt__info_aabd5d6d63519e0dbd40321bf2d201afa}{key\_id}},}
\DoxyCodeLine{02471\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ad4fd174ba5f77aad7e1f1c66079529ba}{buffer}},\ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ac226105a253c6fda70b44e14a525007a}{buffer\_length}},}
\DoxyCodeLine{02472\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ad4fd174ba5f77aad7e1f1c66079529ba}{buffer}},\ \&outlen);}
\DoxyCodeLine{02473\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a261664672f3ef63ab3a20b864627c49a}{mechanism}}.\mbox{\hyperlink{structmechanism_afeb8198b0f33f94f4520c0ffbc584a9a}{mechanism}}\ ==\ \mbox{\hyperlink{pkcs11_8h_a69da8859ad1e6b4f424d071b42ea4a0c}{CKM\_RSA\_PKCS\_OAEP}})\ \{}
\DoxyCodeLine{02474\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =}
\DoxyCodeLine{02475\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm_8c_aa939f8764ed0cca27884d9c8f640ac14}{yh\_util\_decrypt\_oaep}}(\mbox{\hyperlink{ecdh__derive__test_8c_a0a2c7706d971796d7dc84fee36d6c84f}{session}},\ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_a511016f53f468cbe53728403a03df05a}{decrypt}}.\mbox{\hyperlink{structdecrypt__info_aabd5d6d63519e0dbd40321bf2d201afa}{key\_id}},\ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ad4fd174ba5f77aad7e1f1c66079529ba}{buffer}},}
\DoxyCodeLine{02476\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ac226105a253c6fda70b44e14a525007a}{buffer\_length}},\ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ad4fd174ba5f77aad7e1f1c66079529ba}{buffer}},\ \&outlen,}
\DoxyCodeLine{02477\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a261664672f3ef63ab3a20b864627c49a}{mechanism}}.\mbox{\hyperlink{structmechanism_a8b470fe3b4b86e373f85264f1d2df962}{oaep}}.label,}
\DoxyCodeLine{02478\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a261664672f3ef63ab3a20b864627c49a}{mechanism}}.\mbox{\hyperlink{structmechanism_a8b470fe3b4b86e373f85264f1d2df962}{oaep}}.label\_len,}
\DoxyCodeLine{02479\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a261664672f3ef63ab3a20b864627c49a}{mechanism}}.\mbox{\hyperlink{structmechanism_a8b470fe3b4b86e373f85264f1d2df962}{oaep}}.mgf1Algo);}
\DoxyCodeLine{02480\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a261664672f3ef63ab3a20b864627c49a}{mechanism}}.\mbox{\hyperlink{structmechanism_afeb8198b0f33f94f4520c0ffbc584a9a}{mechanism}}\ ==\ \mbox{\hyperlink{pkcs11y_8h_a631efbda997696a7f7ce71df0e3e779a}{CKM\_YUBICO\_AES\_CCM\_WRAP}})\ \{}
\DoxyCodeLine{02481\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =}
\DoxyCodeLine{02482\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm_8c_a550567a0f56d8536b9b5f34e905da7ec}{yh\_util\_unwrap\_data}}(\mbox{\hyperlink{ecdh__derive__test_8c_a0a2c7706d971796d7dc84fee36d6c84f}{session}},\ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_a511016f53f468cbe53728403a03df05a}{decrypt}}.\mbox{\hyperlink{structdecrypt__info_aabd5d6d63519e0dbd40321bf2d201afa}{key\_id}},\ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ad4fd174ba5f77aad7e1f1c66079529ba}{buffer}},}
\DoxyCodeLine{02483\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ac226105a253c6fda70b44e14a525007a}{buffer\_length}},\ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ad4fd174ba5f77aad7e1f1c66079529ba}{buffer}},\ \&outlen);}
\DoxyCodeLine{02484\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02485\ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a2e3ed21e5ffba18d940d164aaec64a2a}{DBG\_ERR}}(\textcolor{stringliteral}{"{}Mechanism\ \%lu\ not\ supported"{}},\ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a261664672f3ef63ab3a20b864627c49a}{mechanism}}.\mbox{\hyperlink{structmechanism_afeb8198b0f33f94f4520c0ffbc584a9a}{mechanism}});}
\DoxyCodeLine{02486\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a0664e99597a479c7fce5b19411cfc1b1}{CKR\_MECHANISM\_INVALID}};}
\DoxyCodeLine{02487\ \ \ \}}
\DoxyCodeLine{02488\ }
\DoxyCodeLine{02489\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{02490\ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a2e3ed21e5ffba18d940d164aaec64a2a}{DBG\_ERR}}(\textcolor{stringliteral}{"{}Decryption\ failed:\ \%s"{}},\ \mbox{\hyperlink{lib_2error_8c_a238eedb1e27dbff2a0ab9a3932eb3f8b}{yh\_strerror}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}));}
\DoxyCodeLine{02491\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a91150ecacbaa624fcc7d861f1b54f57c}{CKR\_FUNCTION\_FAILED}};}
\DoxyCodeLine{02492\ \ \ \}}
\DoxyCodeLine{02493\ }
\DoxyCodeLine{02494\ \ \ \textcolor{keywordflow}{if}\ (outlen\ >\ *data\_len)\ \{}
\DoxyCodeLine{02495\ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a2e3ed21e5ffba18d940d164aaec64a2a}{DBG\_ERR}}(\textcolor{stringliteral}{"{}Data\ won't\ fit\ in\ buffer\ \%zu\ >\ \%d"{}},\ outlen,\ *data\_len);}
\DoxyCodeLine{02496\ \ \ \ \ *data\_len\ =\ outlen;}
\DoxyCodeLine{02497\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a9f2ea08f0e13c3fc129863fdd46352b6}{CKR\_BUFFER\_TOO\_SMALL}};}
\DoxyCodeLine{02498\ \ \ \}}
\DoxyCodeLine{02499\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(data,\ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ad4fd174ba5f77aad7e1f1c66079529ba}{buffer}},\ outlen);}
\DoxyCodeLine{02500\ \ \ *data\_len\ =\ outlen;}
\DoxyCodeLine{02501\ }
\DoxyCodeLine{02502\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}};}
\DoxyCodeLine{02503\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{util__pkcs11_8c_a89815aa1db935281716a2b4d5520da8f_cgraph}
\end{center}
\end{figure}
\Hypertarget{util__pkcs11_8c_a302f2929b31dff615158d284b2f56e79}\index{util\_pkcs11.c@{util\_pkcs11.c}!perform\_digest@{perform\_digest}}
\index{perform\_digest@{perform\_digest}!util\_pkcs11.c@{util\_pkcs11.c}}
\doxysubsubsection{\texorpdfstring{perform\_digest()}{perform\_digest()}}
{\footnotesize\ttfamily \label{util__pkcs11_8c_a302f2929b31dff615158d284b2f56e79} 
CK\+\_\+\+RV perform\+\_\+digest (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__pkcs11__op__info}{yubihsm\+\_\+pkcs11\+\_\+op\+\_\+info}} \texorpdfstring{$\ast$}{*}}]{op\+\_\+info}{, }\item[{\mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t}} \texorpdfstring{$\ast$}{*}}]{digest}{, }\item[{\mbox{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t}} \texorpdfstring{$\ast$}{*}}]{digest\+\_\+len}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{util__pkcs11_8c_source_l02533}{2533}} of file \mbox{\hyperlink{util__pkcs11_8c_source}{util\+\_\+pkcs11.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02534\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02535\ }
\DoxyCodeLine{02536\ \ \ \textcolor{keywordflow}{if}\ (op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ac226105a253c6fda70b44e14a525007a}{buffer\_length}}\ >\ *\mbox{\hyperlink{yubihsm__pkcs11_8c_aa7984cb33ffce49c6276aa9cd928a5a6}{digest\_len}})\ \{}
\DoxyCodeLine{02537\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a9f2ea08f0e13c3fc129863fdd46352b6}{CKR\_BUFFER\_TOO\_SMALL}};}
\DoxyCodeLine{02538\ \ \ \}}
\DoxyCodeLine{02539\ }
\DoxyCodeLine{02540\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(digest,\ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ad4fd174ba5f77aad7e1f1c66079529ba}{buffer}},\ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ac226105a253c6fda70b44e14a525007a}{buffer\_length}});}
\DoxyCodeLine{02541\ \ \ *\mbox{\hyperlink{yubihsm__pkcs11_8c_aa7984cb33ffce49c6276aa9cd928a5a6}{digest\_len}}\ =\ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ac226105a253c6fda70b44e14a525007a}{buffer\_length}};}
\DoxyCodeLine{02542\ }
\DoxyCodeLine{02543\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}};}
\DoxyCodeLine{02544\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=250pt]{util__pkcs11_8c_a302f2929b31dff615158d284b2f56e79_cgraph}
\end{center}
\end{figure}
\Hypertarget{util__pkcs11_8c_aeb9c5d4717c977e42f88669d5ff26286}\index{util\_pkcs11.c@{util\_pkcs11.c}!perform\_encrypt@{perform\_encrypt}}
\index{perform\_encrypt@{perform\_encrypt}!util\_pkcs11.c@{util\_pkcs11.c}}
\doxysubsubsection{\texorpdfstring{perform\_encrypt()}{perform\_encrypt()}}
{\footnotesize\ttfamily \label{util__pkcs11_8c_aeb9c5d4717c977e42f88669d5ff26286} 
CK\+\_\+\+RV perform\+\_\+encrypt (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyh__session}{yh\+\_\+session}} \texorpdfstring{$\ast$}{*}}]{session}{, }\item[{\mbox{\hyperlink{structyubihsm__pkcs11__op__info}{yubihsm\+\_\+pkcs11\+\_\+op\+\_\+info}} \texorpdfstring{$\ast$}{*}}]{op\+\_\+info}{, }\item[{\mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t}} \texorpdfstring{$\ast$}{*}}]{data}{, }\item[{\mbox{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t}} \texorpdfstring{$\ast$}{*}}]{data\+\_\+len}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{util__pkcs11_8c_source_l02505}{2505}} of file \mbox{\hyperlink{util__pkcs11_8c_source}{util\+\_\+pkcs11.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02506\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02507\ }
\DoxyCodeLine{02508\ \ \ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366}{yh\_rc}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}};}
\DoxyCodeLine{02509\ \ \ \textcolor{keywordtype}{size\_t}\ outlen\ =\ \textcolor{keyword}{sizeof}(op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ad4fd174ba5f77aad7e1f1c66079529ba}{buffer}});}
\DoxyCodeLine{02510\ }
\DoxyCodeLine{02511\ \ \ \textcolor{keywordflow}{if}\ (op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a261664672f3ef63ab3a20b864627c49a}{mechanism}}.\mbox{\hyperlink{structmechanism_afeb8198b0f33f94f4520c0ffbc584a9a}{mechanism}}\ ==\ \mbox{\hyperlink{pkcs11y_8h_a631efbda997696a7f7ce71df0e3e779a}{CKM\_YUBICO\_AES\_CCM\_WRAP}})\ \{}
\DoxyCodeLine{02512\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =}
\DoxyCodeLine{02513\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm_8c_a7c2e101be04ad1546d99d5600e732eca}{yh\_util\_wrap\_data}}(\mbox{\hyperlink{ecdh__derive__test_8c_a0a2c7706d971796d7dc84fee36d6c84f}{session}},\ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_a511016f53f468cbe53728403a03df05a}{decrypt}}.\mbox{\hyperlink{structdecrypt__info_aabd5d6d63519e0dbd40321bf2d201afa}{key\_id}},\ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ad4fd174ba5f77aad7e1f1c66079529ba}{buffer}},}
\DoxyCodeLine{02514\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ac226105a253c6fda70b44e14a525007a}{buffer\_length}},\ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ad4fd174ba5f77aad7e1f1c66079529ba}{buffer}},\ \&outlen);}
\DoxyCodeLine{02515\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02516\ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a2e3ed21e5ffba18d940d164aaec64a2a}{DBG\_ERR}}(\textcolor{stringliteral}{"{}Mechanism\ \%lu\ not\ supported"{}},\ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a261664672f3ef63ab3a20b864627c49a}{mechanism}}.\mbox{\hyperlink{structmechanism_afeb8198b0f33f94f4520c0ffbc584a9a}{mechanism}});}
\DoxyCodeLine{02517\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a0664e99597a479c7fce5b19411cfc1b1}{CKR\_MECHANISM\_INVALID}};}
\DoxyCodeLine{02518\ \ \ \}}
\DoxyCodeLine{02519\ }
\DoxyCodeLine{02520\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{02521\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a91150ecacbaa624fcc7d861f1b54f57c}{CKR\_FUNCTION\_FAILED}};}
\DoxyCodeLine{02522\ \ \ \}}
\DoxyCodeLine{02523\ }
\DoxyCodeLine{02524\ \ \ \textcolor{keywordflow}{if}\ (outlen\ >\ *data\_len)\ \{}
\DoxyCodeLine{02525\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a9f2ea08f0e13c3fc129863fdd46352b6}{CKR\_BUFFER\_TOO\_SMALL}};}
\DoxyCodeLine{02526\ \ \ \}}
\DoxyCodeLine{02527\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(data,\ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ad4fd174ba5f77aad7e1f1c66079529ba}{buffer}},\ outlen);}
\DoxyCodeLine{02528\ \ \ *data\_len\ =\ outlen;}
\DoxyCodeLine{02529\ }
\DoxyCodeLine{02530\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}};}
\DoxyCodeLine{02531\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{util__pkcs11_8c_aeb9c5d4717c977e42f88669d5ff26286_cgraph}
\end{center}
\end{figure}
\Hypertarget{util__pkcs11_8c_a547f9032e3bcd7d6a5a810e94822e337}\index{util\_pkcs11.c@{util\_pkcs11.c}!perform\_signature@{perform\_signature}}
\index{perform\_signature@{perform\_signature}!util\_pkcs11.c@{util\_pkcs11.c}}
\doxysubsubsection{\texorpdfstring{perform\_signature()}{perform\_signature()}}
{\footnotesize\ttfamily \label{util__pkcs11_8c_a547f9032e3bcd7d6a5a810e94822e337} 
CK\+\_\+\+RV perform\+\_\+signature (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyh__session}{yh\+\_\+session}} \texorpdfstring{$\ast$}{*}}]{session}{, }\item[{\mbox{\hyperlink{structyubihsm__pkcs11__op__info}{yubihsm\+\_\+pkcs11\+\_\+op\+\_\+info}} \texorpdfstring{$\ast$}{*}}]{op\+\_\+info}{, }\item[{\mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t}} \texorpdfstring{$\ast$}{*}}]{signature}{, }\item[{\mbox{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t}} \texorpdfstring{$\ast$}{*}}]{signature\+\_\+len}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{util__pkcs11_8c_source_l02410}{2410}} of file \mbox{\hyperlink{util__pkcs11_8c_source}{util\+\_\+pkcs11.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02411\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02412\ }
\DoxyCodeLine{02413\ \ \ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366}{yh\_rc}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}};}
\DoxyCodeLine{02414\ \ \ \textcolor{keywordtype}{size\_t}\ outlen\ =\ \textcolor{keyword}{sizeof}(op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ad4fd174ba5f77aad7e1f1c66079529ba}{buffer}});}
\DoxyCodeLine{02415\ }
\DoxyCodeLine{02416\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{util__pkcs11_8c_a7c0da3eb6986b1e9466392de8eb4b9f5}{is\_RSA\_sign\_mechanism}}(op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a261664672f3ef63ab3a20b864627c49a}{mechanism}}.\mbox{\hyperlink{structmechanism_afeb8198b0f33f94f4520c0ffbc584a9a}{mechanism}}))\ \{}
\DoxyCodeLine{02417\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{util__pkcs11_8c_a34722aea70286e920362e216c048f629}{is\_PSS\_sign\_mechanism}}(op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a261664672f3ef63ab3a20b864627c49a}{mechanism}}.\mbox{\hyperlink{structmechanism_afeb8198b0f33f94f4520c0ffbc584a9a}{mechanism}}))\ \{}
\DoxyCodeLine{02418\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a944e6f31487857709f032598fd43fef5}{yh\_util\_sign\_pss}}(\mbox{\hyperlink{ecdh__derive__test_8c_a0a2c7706d971796d7dc84fee36d6c84f}{session}},\ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_af6e088c2d57f2582d353bec69b48c023}{sign}}.\mbox{\hyperlink{structsign__info_a78845a7498c7d284694674fede0d9cc8}{key\_id}},\ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ad4fd174ba5f77aad7e1f1c66079529ba}{buffer}},}
\DoxyCodeLine{02419\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ac226105a253c6fda70b44e14a525007a}{buffer\_length}},\ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ad4fd174ba5f77aad7e1f1c66079529ba}{buffer}},\ \&outlen,}
\DoxyCodeLine{02420\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a261664672f3ef63ab3a20b864627c49a}{mechanism}}.\mbox{\hyperlink{structmechanism_ac8e33c4d8b2b2ec42e7a942f3c157328}{pss}}.salt\_len,}
\DoxyCodeLine{02421\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a261664672f3ef63ab3a20b864627c49a}{mechanism}}.\mbox{\hyperlink{structmechanism_ac8e33c4d8b2b2ec42e7a942f3c157328}{pss}}.mgf1Algo);}
\DoxyCodeLine{02422\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02423\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_aa0a7644b7b368d6aaf8b4aff5e3d19b8}{yh\_util\_sign\_pkcs1v1\_5}}(\mbox{\hyperlink{ecdh__derive__test_8c_a0a2c7706d971796d7dc84fee36d6c84f}{session}},\ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_af6e088c2d57f2582d353bec69b48c023}{sign}}.\mbox{\hyperlink{structsign__info_a78845a7498c7d284694674fede0d9cc8}{key\_id}},}
\DoxyCodeLine{02424\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{util__pkcs11_8c_a3f1010425d5308dfa15d696b4853c68c}{is\_hashed\_mechanism}}(}
\DoxyCodeLine{02425\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a261664672f3ef63ab3a20b864627c49a}{mechanism}}.\mbox{\hyperlink{structmechanism_afeb8198b0f33f94f4520c0ffbc584a9a}{mechanism}}),}
\DoxyCodeLine{02426\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ad4fd174ba5f77aad7e1f1c66079529ba}{buffer}},\ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ac226105a253c6fda70b44e14a525007a}{buffer\_length}},}
\DoxyCodeLine{02427\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ad4fd174ba5f77aad7e1f1c66079529ba}{buffer}},\ \&outlen);}
\DoxyCodeLine{02428\ \ \ \ \ \}}
\DoxyCodeLine{02429\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{util__pkcs11_8c_a03746a942ba1eaafbec20b675463ee00}{is\_ECDSA\_sign\_mechanism}}(op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a261664672f3ef63ab3a20b864627c49a}{mechanism}}.\mbox{\hyperlink{structmechanism_afeb8198b0f33f94f4520c0ffbc584a9a}{mechanism}}))\ \{}
\DoxyCodeLine{02430\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a5121c90d3bd745afd8264fef2ef39ace}{yh\_util\_sign\_ecdsa}}(\mbox{\hyperlink{ecdh__derive__test_8c_a0a2c7706d971796d7dc84fee36d6c84f}{session}},\ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_af6e088c2d57f2582d353bec69b48c023}{sign}}.\mbox{\hyperlink{structsign__info_a78845a7498c7d284694674fede0d9cc8}{key\_id}},\ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ad4fd174ba5f77aad7e1f1c66079529ba}{buffer}},}
\DoxyCodeLine{02431\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ac226105a253c6fda70b44e14a525007a}{buffer\_length}},\ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ad4fd174ba5f77aad7e1f1c66079529ba}{buffer}},\ \&outlen);}
\DoxyCodeLine{02432\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{util__pkcs11_8c_a3da5875af7a71b11ee5ead6b160d1ff4}{is\_HMAC\_sign\_mechanism}}(op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a261664672f3ef63ab3a20b864627c49a}{mechanism}}.\mbox{\hyperlink{structmechanism_afeb8198b0f33f94f4520c0ffbc584a9a}{mechanism}}))\ \{}
\DoxyCodeLine{02433\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_a9000d43fe8cf7313b319f316521eb0c4}{yh\_util\_sign\_hmac}}(\mbox{\hyperlink{ecdh__derive__test_8c_a0a2c7706d971796d7dc84fee36d6c84f}{session}},\ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_af6e088c2d57f2582d353bec69b48c023}{sign}}.\mbox{\hyperlink{structsign__info_a78845a7498c7d284694674fede0d9cc8}{key\_id}},\ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ad4fd174ba5f77aad7e1f1c66079529ba}{buffer}},}
\DoxyCodeLine{02434\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ac226105a253c6fda70b44e14a525007a}{buffer\_length}},\ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ad4fd174ba5f77aad7e1f1c66079529ba}{buffer}},\ \&outlen);}
\DoxyCodeLine{02435\ }
\DoxyCodeLine{02436\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02437\ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a2e3ed21e5ffba18d940d164aaec64a2a}{DBG\_ERR}}(\textcolor{stringliteral}{"{}Mechanism\ \%lu\ not\ supported"{}},\ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a261664672f3ef63ab3a20b864627c49a}{mechanism}}.\mbox{\hyperlink{structmechanism_afeb8198b0f33f94f4520c0ffbc584a9a}{mechanism}});}
\DoxyCodeLine{02438\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a0664e99597a479c7fce5b19411cfc1b1}{CKR\_MECHANISM\_INVALID}};}
\DoxyCodeLine{02439\ \ \ \}}
\DoxyCodeLine{02440\ }
\DoxyCodeLine{02441\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{02442\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a91150ecacbaa624fcc7d861f1b54f57c}{CKR\_FUNCTION\_FAILED}};}
\DoxyCodeLine{02443\ \ \ \}}
\DoxyCodeLine{02444\ }
\DoxyCodeLine{02445\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{util__pkcs11_8c_a03746a942ba1eaafbec20b675463ee00}{is\_ECDSA\_sign\_mechanism}}(op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a261664672f3ef63ab3a20b864627c49a}{mechanism}}.\mbox{\hyperlink{structmechanism_afeb8198b0f33f94f4520c0ffbc584a9a}{mechanism}}))\ \{}
\DoxyCodeLine{02446\ \ \ \ \ \textcolor{comment}{//\ NOTE(adma):\ ECDSA,\ we\ must\ remove\ the\ DER\ encoding\ and\ only}}
\DoxyCodeLine{02447\ \ \ \ \ \textcolor{comment}{//\ return\ R,S\ as\ required\ by\ the\ specs}}
\DoxyCodeLine{02448\ \ \ \ \ \textcolor{keywordflow}{if}\ (strip\_DER\_encoding\_from\_ECSIG(op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ad4fd174ba5f77aad7e1f1c66079529ba}{buffer}},\ \&outlen,}
\DoxyCodeLine{02449\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_af6e088c2d57f2582d353bec69b48c023}{sign}}.\mbox{\hyperlink{structsign__info_ae691c5b3f66d72902403622f40a5a94f}{sig\_len}})\ ==\ \textcolor{keyword}{false})\ \{}
\DoxyCodeLine{02450\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a91150ecacbaa624fcc7d861f1b54f57c}{CKR\_FUNCTION\_FAILED}};}
\DoxyCodeLine{02451\ \ \ \ \ \}}
\DoxyCodeLine{02452\ \ \ \}}
\DoxyCodeLine{02453\ }
\DoxyCodeLine{02454\ \ \ \textcolor{keywordflow}{if}\ (outlen\ >\ *signature\_len)\ \{}
\DoxyCodeLine{02455\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a9f2ea08f0e13c3fc129863fdd46352b6}{CKR\_BUFFER\_TOO\_SMALL}};}
\DoxyCodeLine{02456\ \ \ \}}
\DoxyCodeLine{02457\ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(signature,\ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ad4fd174ba5f77aad7e1f1c66079529ba}{buffer}},\ outlen);}
\DoxyCodeLine{02458\ \ \ *signature\_len\ =\ outlen;}
\DoxyCodeLine{02459\ }
\DoxyCodeLine{02460\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}};}
\DoxyCodeLine{02461\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{util__pkcs11_8c_a547f9032e3bcd7d6a5a810e94822e337_cgraph}
\end{center}
\end{figure}
\Hypertarget{util__pkcs11_8c_ab17f6ba85432d715def5185e7832c9e8}\index{util\_pkcs11.c@{util\_pkcs11.c}!perform\_verify@{perform\_verify}}
\index{perform\_verify@{perform\_verify}!util\_pkcs11.c@{util\_pkcs11.c}}
\doxysubsubsection{\texorpdfstring{perform\_verify()}{perform\_verify()}}
{\footnotesize\ttfamily \label{util__pkcs11_8c_ab17f6ba85432d715def5185e7832c9e8} 
CK\+\_\+\+RV perform\+\_\+verify (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyh__session}{yh\+\_\+session}} \texorpdfstring{$\ast$}{*}}]{session}{, }\item[{\mbox{\hyperlink{structyubihsm__pkcs11__op__info}{yubihsm\+\_\+pkcs11\+\_\+op\+\_\+info}} \texorpdfstring{$\ast$}{*}}]{op\+\_\+info}{, }\item[{\mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t}} \texorpdfstring{$\ast$}{*}}]{signature}{, }\item[{\mbox{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t}}}]{signature\+\_\+len}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{util__pkcs11_8c_source_l02225}{2225}} of file \mbox{\hyperlink{util__pkcs11_8c_source}{util\+\_\+pkcs11.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02226\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02227\ }
\DoxyCodeLine{02228\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{util__pkcs11_8c_a3da5875af7a71b11ee5ead6b160d1ff4}{is\_HMAC\_sign\_mechanism}}(op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a261664672f3ef63ab3a20b864627c49a}{mechanism}}.\mbox{\hyperlink{structmechanism_afeb8198b0f33f94f4520c0ffbc584a9a}{mechanism}}))\ \{}
\DoxyCodeLine{02229\ \ \ \ \ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366}{yh\_rc}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}};}
\DoxyCodeLine{02230\ \ \ \ \ \textcolor{keywordtype}{bool}\ verified\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02231\ }
\DoxyCodeLine{02232\ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ =\ \mbox{\hyperlink{yubihsm_8c_ab37ae2f7fc6857b420e173284130686d}{yh\_util\_verify\_hmac}}(\mbox{\hyperlink{ecdh__derive__test_8c_a0a2c7706d971796d7dc84fee36d6c84f}{session}},\ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_a769d855aca7e13b69c58abd1de1bb410}{verify}}.\mbox{\hyperlink{structverify__info_a1e8b3790ebac9ac474f5c7e932b228a0}{key\_id}},\ signature,}
\DoxyCodeLine{02233\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ signature\_len,\ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ad4fd174ba5f77aad7e1f1c66079529ba}{buffer}},}
\DoxyCodeLine{02234\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ac226105a253c6fda70b44e14a525007a}{buffer\_length}},\ \&verified);}
\DoxyCodeLine{02235\ }
\DoxyCodeLine{02236\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a9c8d6a4a7a87f74f070e816dca1a547b}{yrc}}\ !=\ \mbox{\hyperlink{yubihsm_8h_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815}{YHR\_SUCCESS}})\ \{}
\DoxyCodeLine{02237\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a91150ecacbaa624fcc7d861f1b54f57c}{CKR\_FUNCTION\_FAILED}};}
\DoxyCodeLine{02238\ \ \ \ \ \}}
\DoxyCodeLine{02239\ }
\DoxyCodeLine{02240\ \ \ \ \ \textcolor{keywordflow}{if}\ (verified\ ==\ \textcolor{keyword}{false})\ \{}
\DoxyCodeLine{02241\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a4027a099409c7d9bbc650c766e605903}{CKR\_SIGNATURE\_INVALID}};}
\DoxyCodeLine{02242\ \ \ \ \ \}}
\DoxyCodeLine{02243\ }
\DoxyCodeLine{02244\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}};}
\DoxyCodeLine{02245\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02246\ \ \ \ \ CK\_RV\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}};}
\DoxyCodeLine{02247\ \ \ \ \ EVP\_PKEY\ *key\ =\ EVP\_PKEY\_new();}
\DoxyCodeLine{02248\ \ \ \ \ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ md\_data[EVP\_MAX\_MD\_SIZE];}
\DoxyCodeLine{02249\ \ \ \ \ \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}}\ *md\ =\ md\_data;}
\DoxyCodeLine{02250\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ md\_len\ =\ \textcolor{keyword}{sizeof}(md\_data);}
\DoxyCodeLine{02251\ \ \ \ \ EVP\_PKEY\_CTX\ *ctx\ =\ NULL;}
\DoxyCodeLine{02252\ }
\DoxyCodeLine{02253\ \ \ \ \ \textcolor{keywordflow}{if}\ (key\ ==\ NULL)\ \{}
\DoxyCodeLine{02254\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}}\ =\ \mbox{\hyperlink{pkcs11_8h_a91150ecacbaa624fcc7d861f1b54f57c}{CKR\_FUNCTION\_FAILED}};}
\DoxyCodeLine{02255\ \ \ \ \ \ \ \textcolor{keywordflow}{goto}\ pv\_failure;}
\DoxyCodeLine{02256\ \ \ \ \ \}}
\DoxyCodeLine{02257\ }
\DoxyCodeLine{02258\ \ \ \ \ \textcolor{keywordflow}{if}\ (load\_public\_key(\mbox{\hyperlink{ecdh__derive__test_8c_a0a2c7706d971796d7dc84fee36d6c84f}{session}},\ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_a769d855aca7e13b69c58abd1de1bb410}{verify}}.\mbox{\hyperlink{structverify__info_a1e8b3790ebac9ac474f5c7e932b228a0}{key\_id}},\ key)\ ==\ \textcolor{keyword}{false})\ \{}
\DoxyCodeLine{02259\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}}\ =\ \mbox{\hyperlink{pkcs11_8h_a91150ecacbaa624fcc7d861f1b54f57c}{CKR\_FUNCTION\_FAILED}};}
\DoxyCodeLine{02260\ \ \ \ \ \ \ \textcolor{keywordflow}{goto}\ pv\_failure;}
\DoxyCodeLine{02261\ \ \ \ \ \}}
\DoxyCodeLine{02262\ }
\DoxyCodeLine{02263\ \ \ \ \ ctx\ =\ EVP\_PKEY\_CTX\_new(key,\ NULL);}
\DoxyCodeLine{02264\ \ \ \ \ \textcolor{keywordflow}{if}\ (ctx\ ==\ NULL)\ \{}
\DoxyCodeLine{02265\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}}\ =\ \mbox{\hyperlink{pkcs11_8h_a91150ecacbaa624fcc7d861f1b54f57c}{CKR\_FUNCTION\_FAILED}};}
\DoxyCodeLine{02266\ \ \ \ \ \ \ \textcolor{keywordflow}{goto}\ pv\_failure;}
\DoxyCodeLine{02267\ \ \ \ \ \}}
\DoxyCodeLine{02268\ \ \ \ \ \textcolor{keywordflow}{if}\ (EVP\_PKEY\_verify\_init(ctx)\ <=\ 0)\ \{}
\DoxyCodeLine{02269\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}}\ =\ \mbox{\hyperlink{pkcs11_8h_a91150ecacbaa624fcc7d861f1b54f57c}{CKR\_FUNCTION\_FAILED}};}
\DoxyCodeLine{02270\ \ \ \ \ \ \ \textcolor{keywordflow}{goto}\ pv\_failure;}
\DoxyCodeLine{02271\ \ \ \ \ \}}
\DoxyCodeLine{02272\ }
\DoxyCodeLine{02273\ \ \ \ \ \textcolor{keywordtype}{int}\ res;}
\DoxyCodeLine{02274\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ data[2048];}
\DoxyCodeLine{02275\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{util__pkcs11_8c_a3f1010425d5308dfa15d696b4853c68c}{is\_hashed\_mechanism}}(op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a261664672f3ef63ab3a20b864627c49a}{mechanism}}.\mbox{\hyperlink{structmechanism_afeb8198b0f33f94f4520c0ffbc584a9a}{mechanism}}))\ \{}
\DoxyCodeLine{02276\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (EVP\_DigestFinal\_ex(op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_a769d855aca7e13b69c58abd1de1bb410}{verify}}.\mbox{\hyperlink{structverify__info_a920d34cab9f1b9ddcaf849d5b08c921d}{md\_ctx}},\ md,\ \&md\_len)\ <=\ 0)\ \{}
\DoxyCodeLine{02277\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}}\ =\ \mbox{\hyperlink{pkcs11_8h_a91150ecacbaa624fcc7d861f1b54f57c}{CKR\_FUNCTION\_FAILED}};}
\DoxyCodeLine{02278\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{goto}\ pv\_failure;}
\DoxyCodeLine{02279\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02280\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (EVP\_PKEY\_base\_id(key)\ ==\ EVP\_PKEY\_RSA)\ \{}
\DoxyCodeLine{02281\ \ \ \ \ \ \ \textcolor{keyword}{const}\ EVP\_MD\ *md\_type;}
\DoxyCodeLine{02282\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ di\_len;}
\DoxyCodeLine{02283\ }
\DoxyCodeLine{02284\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a261664672f3ef63ab3a20b864627c49a}{mechanism}}.\mbox{\hyperlink{structmechanism_afeb8198b0f33f94f4520c0ffbc584a9a}{mechanism}}\ ==\ \mbox{\hyperlink{pkcs11_8h_ad4f5697408b23623c904df2b1ca8a9f1}{CKM\_RSA\_PKCS\_PSS}})\ \{}
\DoxyCodeLine{02285\ \ \ \ \ \ \ \ \ md\ =\ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ad4fd174ba5f77aad7e1f1c66079529ba}{buffer}};}
\DoxyCodeLine{02286\ \ \ \ \ \ \ \ \ md\_len\ =\ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ac226105a253c6fda70b44e14a525007a}{buffer\_length}};}
\DoxyCodeLine{02287\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02288\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{util_8c_ad370ce9b010ffc168e85acb7c8412caf}{parse\_NID}}(op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ad4fd174ba5f77aad7e1f1c66079529ba}{buffer}},\ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ac226105a253c6fda70b44e14a525007a}{buffer\_length}},\ \&md\_type,\ \&di\_len);}
\DoxyCodeLine{02289\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (md\_type\ ==\ EVP\_md\_null())\ \{}
\DoxyCodeLine{02290\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}}\ =\ \mbox{\hyperlink{pkcs11_8h_a1740789d62501fea6688fb211b02d1a2}{CKR\_DATA\_INVALID}};}
\DoxyCodeLine{02291\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{goto}\ pv\_failure;}
\DoxyCodeLine{02292\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02293\ }
\DoxyCodeLine{02294\ \ \ \ \ \ \ \ \ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_a769d855aca7e13b69c58abd1de1bb410}{verify}}.\mbox{\hyperlink{structverify__info_a9547582fc2ac4625f9029f6d285bdb68}{md}}\ =\ md\_type;}
\DoxyCodeLine{02295\ \ \ \ \ \ \ \ \ md\ =\ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ad4fd174ba5f77aad7e1f1c66079529ba}{buffer}}\ +\ di\_len;}
\DoxyCodeLine{02296\ \ \ \ \ \ \ \ \ md\_len\ =\ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ac226105a253c6fda70b44e14a525007a}{buffer\_length}}\ -\/\ di\_len;}
\DoxyCodeLine{02297\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02298\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (EVP\_PKEY\_base\_id(key)\ ==\ EVP\_PKEY\_EC)\ \{}
\DoxyCodeLine{02299\ \ \ \ \ \ \ md\ =\ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ad4fd174ba5f77aad7e1f1c66079529ba}{buffer}};}
\DoxyCodeLine{02300\ \ \ \ \ \ \ md\_len\ =\ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_ac226105a253c6fda70b44e14a525007a}{buffer\_length}};}
\DoxyCodeLine{02301\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (md\_len\ ==\ 20)\ \{}
\DoxyCodeLine{02302\ \ \ \ \ \ \ \ \ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_a769d855aca7e13b69c58abd1de1bb410}{verify}}.\mbox{\hyperlink{structverify__info_a9547582fc2ac4625f9029f6d285bdb68}{md}}\ =\ EVP\_sha1();}
\DoxyCodeLine{02303\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (md\_len\ ==\ 32)\ \{}
\DoxyCodeLine{02304\ \ \ \ \ \ \ \ \ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_a769d855aca7e13b69c58abd1de1bb410}{verify}}.\mbox{\hyperlink{structverify__info_a9547582fc2ac4625f9029f6d285bdb68}{md}}\ =\ EVP\_sha256();}
\DoxyCodeLine{02305\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (md\_len\ ==\ 48)\ \{}
\DoxyCodeLine{02306\ \ \ \ \ \ \ \ \ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_a769d855aca7e13b69c58abd1de1bb410}{verify}}.\mbox{\hyperlink{structverify__info_a9547582fc2ac4625f9029f6d285bdb68}{md}}\ =\ EVP\_sha384();}
\DoxyCodeLine{02307\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (md\_len\ ==\ 64)\ \{}
\DoxyCodeLine{02308\ \ \ \ \ \ \ \ \ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_a769d855aca7e13b69c58abd1de1bb410}{verify}}.\mbox{\hyperlink{structverify__info_a9547582fc2ac4625f9029f6d285bdb68}{md}}\ =\ EVP\_sha512();}
\DoxyCodeLine{02309\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02310\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}}\ =\ \mbox{\hyperlink{pkcs11_8h_a91150ecacbaa624fcc7d861f1b54f57c}{CKR\_FUNCTION\_FAILED}};}
\DoxyCodeLine{02311\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{goto}\ pv\_failure;}
\DoxyCodeLine{02312\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02313\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02314\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}}\ =\ \mbox{\hyperlink{pkcs11_8h_a91150ecacbaa624fcc7d861f1b54f57c}{CKR\_FUNCTION\_FAILED}};}
\DoxyCodeLine{02315\ \ \ \ \ \ \ \textcolor{keywordflow}{goto}\ pv\_failure;}
\DoxyCodeLine{02316\ \ \ \ \ \}}
\DoxyCodeLine{02317\ \ \ \ \ \textcolor{keywordflow}{if}\ (EVP\_PKEY\_CTX\_set\_signature\_md(ctx,\ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_a769d855aca7e13b69c58abd1de1bb410}{verify}}.\mbox{\hyperlink{structverify__info_a9547582fc2ac4625f9029f6d285bdb68}{md}})\ <=\ 0)\ \{}
\DoxyCodeLine{02318\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}}\ =\ \mbox{\hyperlink{pkcs11_8h_a91150ecacbaa624fcc7d861f1b54f57c}{CKR\_FUNCTION\_FAILED}};}
\DoxyCodeLine{02319\ \ \ \ \ \ \ \textcolor{keywordflow}{goto}\ pv\_failure;}
\DoxyCodeLine{02320\ \ \ \ \ \}}
\DoxyCodeLine{02321\ \ \ \ \ \textcolor{keywordflow}{if}\ (op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_a769d855aca7e13b69c58abd1de1bb410}{verify}}.\mbox{\hyperlink{structverify__info_a69841d9be2ea9074f4a8dd3972c532cf}{padding}})\ \{}
\DoxyCodeLine{02322\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (EVP\_PKEY\_CTX\_set\_rsa\_padding(ctx,\ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_a769d855aca7e13b69c58abd1de1bb410}{verify}}.\mbox{\hyperlink{structverify__info_a69841d9be2ea9074f4a8dd3972c532cf}{padding}})\ <=\ 0)\ \{}
\DoxyCodeLine{02323\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}}\ =\ \mbox{\hyperlink{pkcs11_8h_a91150ecacbaa624fcc7d861f1b54f57c}{CKR\_FUNCTION\_FAILED}};}
\DoxyCodeLine{02324\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{goto}\ pv\_failure;}
\DoxyCodeLine{02325\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02326\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_a769d855aca7e13b69c58abd1de1bb410}{verify}}.\mbox{\hyperlink{structverify__info_a69841d9be2ea9074f4a8dd3972c532cf}{padding}}\ ==\ RSA\_PKCS1\_PSS\_PADDING)\ \{}
\DoxyCodeLine{02327\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (EVP\_PKEY\_CTX\_set\_rsa\_pss\_saltlen(ctx,\ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_a769d855aca7e13b69c58abd1de1bb410}{verify}}.\mbox{\hyperlink{structverify__info_a8e050dd7549467897d666046c1754aaf}{saltLen}})\ <=}
\DoxyCodeLine{02328\ \ \ \ \ \ \ \ \ \ \ \ \ 0)\ \{}
\DoxyCodeLine{02329\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}}\ =\ \mbox{\hyperlink{pkcs11_8h_a91150ecacbaa624fcc7d861f1b54f57c}{CKR\_FUNCTION\_FAILED}};}
\DoxyCodeLine{02330\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{goto}\ pv\_failure;}
\DoxyCodeLine{02331\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02332\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (EVP\_PKEY\_CTX\_set\_rsa\_mgf1\_md(ctx,\ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_a769d855aca7e13b69c58abd1de1bb410}{verify}}.\mbox{\hyperlink{structverify__info_ae1b2e1bec7e3c36d68558b61401cf5df}{mgf1md}})\ <=\ 0)\ \{}
\DoxyCodeLine{02333\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}}\ =\ \mbox{\hyperlink{pkcs11_8h_a91150ecacbaa624fcc7d861f1b54f57c}{CKR\_FUNCTION\_FAILED}};}
\DoxyCodeLine{02334\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{goto}\ pv\_failure;}
\DoxyCodeLine{02335\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02336\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02337\ \ \ \ \ \}}
\DoxyCodeLine{02338\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{util__pkcs11_8c_a03746a942ba1eaafbec20b675463ee00}{is\_ECDSA\_sign\_mechanism}}(op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a261664672f3ef63ab3a20b864627c49a}{mechanism}}.\mbox{\hyperlink{structmechanism_afeb8198b0f33f94f4520c0ffbc584a9a}{mechanism}}))\ \{}
\DoxyCodeLine{02339\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(data,\ signature,\ signature\_len);}
\DoxyCodeLine{02340\ \ \ \ \ \ \ \mbox{\hyperlink{namespacefc_1_1ecc_a7c10bdf37d2fad7c122133f284e47f3e}{signature}}\ =\ data;}
\DoxyCodeLine{02341\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (apply\_DER\_encoding\_to\_ECSIG(signature,\ \&signature\_len)\ ==\ \textcolor{keyword}{false})\ \{}
\DoxyCodeLine{02342\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a2e3ed21e5ffba18d940d164aaec64a2a}{DBG\_ERR}}(\textcolor{stringliteral}{"{}Failed\ to\ apply\ DER\ encoding\ to\ ECDSA\ signature"{}});}
\DoxyCodeLine{02343\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}}\ =\ \mbox{\hyperlink{pkcs11_8h_a91150ecacbaa624fcc7d861f1b54f57c}{CKR\_FUNCTION\_FAILED}};}
\DoxyCodeLine{02344\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{goto}\ pv\_failure;}
\DoxyCodeLine{02345\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02346\ \ \ \ \ \}}
\DoxyCodeLine{02347\ \ \ \ \ res\ =\ EVP\_PKEY\_verify(ctx,\ signature,\ signature\_len,\ md,\ md\_len);}
\DoxyCodeLine{02348\ }
\DoxyCodeLine{02349\ \ \ \ \ \textcolor{keywordflow}{if}\ (res\ ==\ 1)\ \{}
\DoxyCodeLine{02350\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}}\ =\ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}};}
\DoxyCodeLine{02351\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (res\ ==\ 0)\ \{}
\DoxyCodeLine{02352\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}}\ =\ \mbox{\hyperlink{pkcs11_8h_a4027a099409c7d9bbc650c766e605903}{CKR\_SIGNATURE\_INVALID}};}
\DoxyCodeLine{02353\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02354\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}}\ =\ \mbox{\hyperlink{pkcs11_8h_a91150ecacbaa624fcc7d861f1b54f57c}{CKR\_FUNCTION\_FAILED}};}
\DoxyCodeLine{02355\ \ \ \ \ \}}
\DoxyCodeLine{02356\ }
\DoxyCodeLine{02357\ \ \ pv\_failure:}
\DoxyCodeLine{02358\ \ \ \ \ \textcolor{keywordflow}{if}\ (ctx\ !=\ NULL)\ \{}
\DoxyCodeLine{02359\ \ \ \ \ \ \ EVP\_PKEY\_CTX\_free(ctx);}
\DoxyCodeLine{02360\ \ \ \ \ \ \ ctx\ =\ NULL;}
\DoxyCodeLine{02361\ \ \ \ \ \}}
\DoxyCodeLine{02362\ }
\DoxyCodeLine{02363\ \ \ \ \ \textcolor{keywordflow}{if}\ (key\ !=\ NULL)\ \{}
\DoxyCodeLine{02364\ \ \ \ \ \ \ EVP\_PKEY\_free(key);}
\DoxyCodeLine{02365\ \ \ \ \ \ \ key\ =\ NULL;}
\DoxyCodeLine{02366\ \ \ \ \ \}}
\DoxyCodeLine{02367\ }
\DoxyCodeLine{02368\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}};}
\DoxyCodeLine{02369\ \ \ \}}
\DoxyCodeLine{02370\ }
\DoxyCodeLine{02371\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a91150ecacbaa624fcc7d861f1b54f57c}{CKR\_FUNCTION\_FAILED}};}
\DoxyCodeLine{02372\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{util__pkcs11_8c_ab17f6ba85432d715def5185e7832c9e8_cgraph}
\end{center}
\end{figure}
\Hypertarget{util__pkcs11_8c_a1a7af578cd3ef13f8ae12652086c7a18}\index{util\_pkcs11.c@{util\_pkcs11.c}!populate\_template@{populate\_template}}
\index{populate\_template@{populate\_template}!util\_pkcs11.c@{util\_pkcs11.c}}
\doxysubsubsection{\texorpdfstring{populate\_template()}{populate\_template()}}
{\footnotesize\ttfamily \label{util__pkcs11_8c_a1a7af578cd3ef13f8ae12652086c7a18} 
CK\+\_\+\+RV populate\+\_\+template (\begin{DoxyParamCaption}\item[{int}]{type}{, }\item[{void \texorpdfstring{$\ast$}{*}}]{object}{, }\item[{\mbox{\hyperlink{pkcs11_8h_a5db3536793782f135785609e4a849fc6}{CK\+\_\+\+ATTRIBUTE\+\_\+\+PTR}}}]{p\+Template}{, }\item[{\mbox{\hyperlink{pkcs11_8h_a35181858a3b7a0a81f49d180d8f446ef}{CK\+\_\+\+ULONG}}}]{ul\+Count}{, }\item[{\mbox{\hyperlink{structyh__session}{yh\+\_\+session}} \texorpdfstring{$\ast$}{*}}]{session}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{util__pkcs11_8c_source_l03872}{3872}} of file \mbox{\hyperlink{util__pkcs11_8c_source}{util\+\_\+pkcs11.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{03873\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03874\ }
\DoxyCodeLine{03875\ \ \ CK\_RV\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}}\ =\ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}};}
\DoxyCodeLine{03876\ }
\DoxyCodeLine{03877\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{pkcs11_8h_a35181858a3b7a0a81f49d180d8f446ef}{CK\_ULONG}}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a490d37150a3d116225298faf1cb780b6}{ulCount}};\ i++)\ \{}
\DoxyCodeLine{03878\ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a8c4742440a149ad8bcb5d58ae76c5ed3}{DBG\_INFO}}(\textcolor{stringliteral}{"{}Getting\ attribute\ 0x\%lx"{}},\ \mbox{\hyperlink{yubihsm__pkcs11_8c_aa4c2296db6853afc30383aec1a404972}{pTemplate}}[i].type);}
\DoxyCodeLine{03879\ }
\DoxyCodeLine{03880\ \ \ \ \ \mbox{\hyperlink{pkcs11_8h_a88e8d2cf99e26f3b3f86a0a698b0ab64}{CK\_VOID\_PTR}}\ object\_ptr;}
\DoxyCodeLine{03881\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_aa4c2296db6853afc30383aec1a404972}{pTemplate}}[i].pValue\ ==\ NULL)\ \{}
\DoxyCodeLine{03882\ \ \ \ \ \ \ \textcolor{comment}{//\ NOTE(adma):\ just\ asking\ for\ the\ length}}
\DoxyCodeLine{03883\ \ \ \ \ \ \ object\_ptr\ =\ NULL;}
\DoxyCodeLine{03884\ \ \ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a8c4742440a149ad8bcb5d58ae76c5ed3}{DBG\_INFO}}(\textcolor{stringliteral}{"{}Retrieving\ length"{}});}
\DoxyCodeLine{03885\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03886\ \ \ \ \ \ \ \textcolor{comment}{//\ NOTE(adma):\ actually\ get\ the\ attribute}}
\DoxyCodeLine{03887\ \ \ \ \ \ \ object\_ptr\ =\ \mbox{\hyperlink{yubihsm__pkcs11_8c_aa4c2296db6853afc30383aec1a404972}{pTemplate}}[i].pValue;}
\DoxyCodeLine{03888\ \ \ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a8c4742440a149ad8bcb5d58ae76c5ed3}{DBG\_INFO}}(\textcolor{stringliteral}{"{}Retrieving\ attribute"{}});}
\DoxyCodeLine{03889\ \ \ \ \ \}}
\DoxyCodeLine{03890\ }
\DoxyCodeLine{03891\ \ \ \ \ CK\_RV\ attribute\_rc;}
\DoxyCodeLine{03892\ \ \ \ \ \textcolor{keywordflow}{if}\ (type\ ==\ \mbox{\hyperlink{yubihsm__pkcs11_8h_ae849403f78233718f9beeea0a8b4dfd9}{ECDH\_KEY\_TYPE}})\ \{}
\DoxyCodeLine{03893\ \ \ \ \ \ \ \mbox{\hyperlink{structecdh__session__key}{ecdh\_session\_key}}\ *key\ =\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a85d991d90970121ba1480cd98d93aab9}{object}};}
\DoxyCodeLine{03894\ \ \ \ \ \ \ attribute\_rc\ =}
\DoxyCodeLine{03895\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{util__pkcs11_8c_a5c8c35826a58c280a290c49a5a1e5b03}{get\_attribute\_ecsession\_key}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_aa4c2296db6853afc30383aec1a404972}{pTemplate}}[i].type,\ key,\ object\_ptr,}
\DoxyCodeLine{03896\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_aa4c2296db6853afc30383aec1a404972}{pTemplate}}[i].ulValueLen);}
\DoxyCodeLine{03897\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03898\ \ \ \ \ \ \ \mbox{\hyperlink{structyubihsm__pkcs11__object__desc}{yubihsm\_pkcs11\_object\_desc}}\ *desc\ =\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a85d991d90970121ba1480cd98d93aab9}{object}};}
\DoxyCodeLine{03899\ \ \ \ \ \ \ attribute\_rc\ =\ \mbox{\hyperlink{util__pkcs11_8c_acc3b093830e7126a8655e9b8ec77ad10}{get\_attribute}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_aa4c2296db6853afc30383aec1a404972}{pTemplate}}[i].type,\ \&desc-\/>\mbox{\hyperlink{structyubihsm__pkcs11__object__desc_a6029acaef1678d77702d2c51fb75540a}{object}},\ object\_ptr,}
\DoxyCodeLine{03900\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\mbox{\hyperlink{yubihsm__pkcs11_8c_aa4c2296db6853afc30383aec1a404972}{pTemplate}}[i].ulValueLen,\ \mbox{\hyperlink{ecdh__derive__test_8c_a0a2c7706d971796d7dc84fee36d6c84f}{session}});}
\DoxyCodeLine{03901\ \ \ \ \ \}}
\DoxyCodeLine{03902\ }
\DoxyCodeLine{03903\ \ \ \ \ \textcolor{keywordflow}{if}\ (attribute\_rc\ !=\ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}})\ \{}
\DoxyCodeLine{03904\ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}}\ =\ attribute\_rc;}
\DoxyCodeLine{03905\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (attribute\_rc\ ==\ \mbox{\hyperlink{pkcs11_8h_a0afbefc1a4ce05ba5faea1778eb602ca}{CKR\_ATTRIBUTE\_TYPE\_INVALID}})\ \{}
\DoxyCodeLine{03906\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a2e3ed21e5ffba18d940d164aaec64a2a}{DBG\_ERR}}(\textcolor{stringliteral}{"{}Unable\ to\ get\ attribute"{}});}
\DoxyCodeLine{03907\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (attribute\_rc\ ==\ \mbox{\hyperlink{pkcs11_8h_a9f2ea08f0e13c3fc129863fdd46352b6}{CKR\_BUFFER\_TOO\_SMALL}})\ \{}
\DoxyCodeLine{03908\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a2e3ed21e5ffba18d940d164aaec64a2a}{DBG\_ERR}}(\textcolor{stringliteral}{"{}Skipping\ attribute\ because\ buffer\ is\ too\ small"{}});}
\DoxyCodeLine{03909\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03910\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a2e3ed21e5ffba18d940d164aaec64a2a}{DBG\_ERR}}(\textcolor{stringliteral}{"{}Get\ attribute\ failed.\ \%s"{}},\ \mbox{\hyperlink{lib_2error_8c_a238eedb1e27dbff2a0ab9a3932eb3f8b}{yh\_strerror}}(attribute\_rc));}
\DoxyCodeLine{03911\ \ \ \ \ \ \ \}}
\DoxyCodeLine{03912\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03913\ \ \ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a8c4742440a149ad8bcb5d58ae76c5ed3}{DBG\_INFO}}(\textcolor{stringliteral}{"{}Attribute/length\ successfully\ returned\ with\ length\ \%lu"{}},}
\DoxyCodeLine{03914\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_aa4c2296db6853afc30383aec1a404972}{pTemplate}}[i].ulValueLen);}
\DoxyCodeLine{03915\ \ \ \ \ \}}
\DoxyCodeLine{03916\ }
\DoxyCodeLine{03917\ \ \ \ \ \textcolor{comment}{//\ NOTE(adma):\ Array\ of\ attributes\ like\ CKA\_WRAP\_TEMPLATE\ are\ special}}
\DoxyCodeLine{03918\ \ \ \ \ \textcolor{comment}{//\ cases.}}
\DoxyCodeLine{03919\ \ \ \ \ \textcolor{comment}{/*\ In\ the\ special\ case\ of\ an\ attribute\ whose\ value\ is\ an\ array\ of}}
\DoxyCodeLine{03920\ \textcolor{comment}{\ \ \ \ \ *\ attributes,\ for\ example\ CKA\_WRAP\_TEMPLATE,\ where\ it\ is\ passed\ in\ with}}
\DoxyCodeLine{03921\ \textcolor{comment}{\ \ \ \ \ *\ pValue\ not\ NULL,\ then\ if\ the\ pValue\ of\ elements\ within\ the\ array\ is}}
\DoxyCodeLine{03922\ \textcolor{comment}{\ \ \ \ \ *\ NULL\_PTR\ then\ the\ ulValueLen\ of\ elements\ within\ the\ array\ will\ be\ set}}
\DoxyCodeLine{03923\ \textcolor{comment}{\ \ \ \ \ *\ to\ the\ required\ length.\ If\ the\ pValue\ of\ elements\ within\ the\ array\ is}}
\DoxyCodeLine{03924\ \textcolor{comment}{\ \ \ \ \ *\ not\ NULL\_PTR,\ then\ the\ ulValueLen\ element\ of\ attributes\ within\ the}}
\DoxyCodeLine{03925\ \textcolor{comment}{\ \ \ \ \ *\ array\ MUST\ reflect\ the\ space\ that\ the\ corresponding\ pValue\ points\ to,}}
\DoxyCodeLine{03926\ \textcolor{comment}{\ \ \ \ \ *\ and\ pValue\ is\ filled\ in\ if\ there\ is\ sufficient\ room.\ Therefore\ it\ is}}
\DoxyCodeLine{03927\ \textcolor{comment}{\ \ \ \ \ *\ important\ to\ initialize\ the\ contents\ of\ a\ buffer\ before\ calling}}
\DoxyCodeLine{03928\ \textcolor{comment}{\ \ \ \ \ *\ C\_GetAttributeValue\ to\ get\ such\ an\ array\ value.\ If\ any\ ulValueLen}}
\DoxyCodeLine{03929\ \textcolor{comment}{\ \ \ \ \ *\ within\ the\ array\ isn't\ large\ enough,\ it\ will\ be\ set\ to}}
\DoxyCodeLine{03930\ \textcolor{comment}{\ \ \ \ \ *\ CK\_UNAVAILABLE\_INFORMATION\ and\ the\ function\ will\ return}}
\DoxyCodeLine{03931\ \textcolor{comment}{\ \ \ \ \ *\ CKR\_BUFFER\_TOO\_SMALL,\ as\ it\ does\ if\ an\ attribute\ in\ the\ pTemplate}}
\DoxyCodeLine{03932\ \textcolor{comment}{\ \ \ \ \ *\ argument\ has\ ulValueLen\ too\ small.\ Note\ that\ any\ attribute\ whose\ value}}
\DoxyCodeLine{03933\ \textcolor{comment}{\ \ \ \ \ *\ is\ an\ array\ of\ attributes\ is\ identifiable\ by\ virtue\ of\ the\ attribute}}
\DoxyCodeLine{03934\ \textcolor{comment}{\ \ \ \ \ *\ type\ having\ the\ CKF\_ARRAY\_ATTRIBUTE\ bit\ set.*/}}
\DoxyCodeLine{03935\ \ \ \}}
\DoxyCodeLine{03936\ }
\DoxyCodeLine{03937\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a9dbb22e3510dddb1ebb576404a972e7d}{rv}};}
\DoxyCodeLine{03938\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{util__pkcs11_8c_a1a7af578cd3ef13f8ae12652086c7a18_cgraph}
\end{center}
\end{figure}
\Hypertarget{util__pkcs11_8c_aa7658e32c6ee781921b7e80a9d1fe2f8}\index{util\_pkcs11.c@{util\_pkcs11.c}!release\_session@{release\_session}}
\index{release\_session@{release\_session}!util\_pkcs11.c@{util\_pkcs11.c}}
\doxysubsubsection{\texorpdfstring{release\_session()}{release\_session()}}
{\footnotesize\ttfamily \label{util__pkcs11_8c_aa7658e32c6ee781921b7e80a9d1fe2f8} 
void release\+\_\+session (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__pkcs11__context}{yubihsm\+\_\+pkcs11\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{structyubihsm__pkcs11__session}{yubihsm\+\_\+pkcs11\+\_\+session}} \texorpdfstring{$\ast$}{*}}]{session}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{util__pkcs11_8c_source_l02850}{2850}} of file \mbox{\hyperlink{util__pkcs11_8c_source}{util\+\_\+pkcs11.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02851\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02852\ }
\DoxyCodeLine{02853\ \ \ \mbox{\hyperlink{util__pkcs11_8c_a3754cf5cb42a5e282658cf94f405574e}{release\_slot}}(ctx,\ \mbox{\hyperlink{ecdh__derive__test_8c_a0a2c7706d971796d7dc84fee36d6c84f}{session}}-\/>slot);}
\DoxyCodeLine{02854\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=271pt]{util__pkcs11_8c_aa7658e32c6ee781921b7e80a9d1fe2f8_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=333pt]{util__pkcs11_8c_aa7658e32c6ee781921b7e80a9d1fe2f8_icgraph}
\end{center}
\end{figure}
\Hypertarget{util__pkcs11_8c_a3754cf5cb42a5e282658cf94f405574e}\index{util\_pkcs11.c@{util\_pkcs11.c}!release\_slot@{release\_slot}}
\index{release\_slot@{release\_slot}!util\_pkcs11.c@{util\_pkcs11.c}}
\doxysubsubsection{\texorpdfstring{release\_slot()}{release\_slot()}}
{\footnotesize\ttfamily \label{util__pkcs11_8c_a3754cf5cb42a5e282658cf94f405574e} 
void release\+\_\+slot (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__pkcs11__context}{yubihsm\+\_\+pkcs11\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\mbox{\hyperlink{structyubihsm__pkcs11__slot}{yubihsm\+\_\+pkcs11\+\_\+slot}} \texorpdfstring{$\ast$}{*}}]{slot}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{util__pkcs11_8c_source_l02782}{2782}} of file \mbox{\hyperlink{util__pkcs11_8c_source}{util\+\_\+pkcs11.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02782\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02783\ }
\DoxyCodeLine{02784\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__slot_a3ecfa0dfb39d722e9a0fad07a8d9334d}{mutex}}\ !=\ NULL)\ \{}
\DoxyCodeLine{02785\ \ \ \ \ ctx-\/>\mbox{\hyperlink{structyubihsm__pkcs11__context_a1c6d1e9158ea469cdef15d6040318cc0}{unlock\_mutex}}(\mbox{\hyperlink{yubihsm__pkcs11_8c_a0209f1d92740f251d8686fd2d2a989e1}{slot}}-\/>\mbox{\hyperlink{structyubihsm__pkcs11__slot_a3ecfa0dfb39d722e9a0fad07a8d9334d}{mutex}});}
\DoxyCodeLine{02786\ \ \ \}}
\DoxyCodeLine{02787\ \}}

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{util__pkcs11_8c_a3754cf5cb42a5e282658cf94f405574e_icgraph}
\end{center}
\end{figure}
\Hypertarget{util__pkcs11_8c_a7f93d30a54aef41540b4c31d8b2be064}\index{util\_pkcs11.c@{util\_pkcs11.c}!set\_native\_locking@{set\_native\_locking}}
\index{set\_native\_locking@{set\_native\_locking}!util\_pkcs11.c@{util\_pkcs11.c}}
\doxysubsubsection{\texorpdfstring{set\_native\_locking()}{set\_native\_locking()}}
{\footnotesize\ttfamily \label{util__pkcs11_8c_a7f93d30a54aef41540b4c31d8b2be064} 
void set\+\_\+native\+\_\+locking (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__pkcs11__context}{yubihsm\+\_\+pkcs11\+\_\+context}} \texorpdfstring{$\ast$}{*}}]{ctx}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{util__pkcs11_8c_source_l02916}{2916}} of file \mbox{\hyperlink{util__pkcs11_8c_source}{util\+\_\+pkcs11.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02916\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02917\ }
\DoxyCodeLine{02918\ \ \ ctx-\/>\mbox{\hyperlink{structyubihsm__pkcs11__context_a8fd07ddac920f2f93a360fb466b15e5f}{create\_mutex}}\ =\ native\_create\_mutex;}
\DoxyCodeLine{02919\ \ \ ctx-\/>\mbox{\hyperlink{structyubihsm__pkcs11__context_a7cf1c255226587a98fd93b5bb31b8fb4}{destroy\_mutex}}\ =\ native\_destroy\_mutex;}
\DoxyCodeLine{02920\ \ \ ctx-\/>\mbox{\hyperlink{structyubihsm__pkcs11__context_a499767227a12b9a3309bfd1220dc8ed9}{lock\_mutex}}\ =\ native\_lock\_mutex;}
\DoxyCodeLine{02921\ \ \ ctx-\/>\mbox{\hyperlink{structyubihsm__pkcs11__context_a1c6d1e9158ea469cdef15d6040318cc0}{unlock\_mutex}}\ =\ native\_unlock\_mutex;}
\DoxyCodeLine{02922\ \}}

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=344pt]{util__pkcs11_8c_a7f93d30a54aef41540b4c31d8b2be064_icgraph}
\end{center}
\end{figure}
\Hypertarget{util__pkcs11_8c_a03b553175220c8747145497de5032100}\index{util\_pkcs11.c@{util\_pkcs11.c}!set\_template\_attribute@{set\_template\_attribute}}
\index{set\_template\_attribute@{set\_template\_attribute}!util\_pkcs11.c@{util\_pkcs11.c}}
\doxysubsubsection{\texorpdfstring{set\_template\_attribute()}{set\_template\_attribute()}}
{\footnotesize\ttfamily \label{util__pkcs11_8c_a03b553175220c8747145497de5032100} 
CK\+\_\+\+RV set\+\_\+template\+\_\+attribute (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{yubihsm__pkcs11_8h_ade78776cf4e2dd3e25c4170aeb4edc63}{yubihsm\+\_\+pkcs11\+\_\+attribute}} \texorpdfstring{$\ast$}{*}}]{attribute}{, }\item[{void \texorpdfstring{$\ast$}{*}}]{value}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{util__pkcs11_8c_source_l02953}{2953}} of file \mbox{\hyperlink{util__pkcs11_8c_source}{util\+\_\+pkcs11.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02953\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02954\ \ \ \textcolor{keywordflow}{if}\ (*attribute\ ==\ \mbox{\hyperlink{yubihsm__pkcs11_8h_ade78776cf4e2dd3e25c4170aeb4edc63a0f62ed9fb666d4152a3aca4662f9c6e7}{ATTRIBUTE\_NOT\_SET}})\ \{}
\DoxyCodeLine{02955\ \ \ \ \ \textcolor{keywordflow}{if}\ ((*(\mbox{\hyperlink{pkcs11_8h_a9dc289e62be691f41a9c6b875789b1f2}{CK\_BBOOL}}\ *)\ \mbox{\hyperlink{pkcs11_8h_a32aff7c6c4cd253fdf6563677afab5ce}{value}})\ ==\ \textcolor{keyword}{true})\ \{}
\DoxyCodeLine{02956\ \ \ \ \ \ \ *attribute\ =\ \mbox{\hyperlink{yubihsm__pkcs11_8h_ade78776cf4e2dd3e25c4170aeb4edc63a4f7bc3f41284650799ceee38c4b55fad}{ATTRIBUTE\_TRUE}};}
\DoxyCodeLine{02957\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02958\ \ \ \ \ \ \ *attribute\ =\ \mbox{\hyperlink{yubihsm__pkcs11_8h_ade78776cf4e2dd3e25c4170aeb4edc63aeb3ec728110a56f2e99435a1119562a8}{ATTRIBUTE\_FALSE}};}
\DoxyCodeLine{02959\ \ \ \ \ \}}
\DoxyCodeLine{02960\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}};}
\DoxyCodeLine{02961\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02962\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a98d78208707bfa2c51d6f051af1794e9}{CKR\_TEMPLATE\_INCONSISTENT}};}
\DoxyCodeLine{02963\ \ \ \}}
\DoxyCodeLine{02964\ \}}

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{util__pkcs11_8c_a03b553175220c8747145497de5032100_icgraph}
\end{center}
\end{figure}
\Hypertarget{util__pkcs11_8c_a6959529c0513c47315e393d4e4827619}\index{util\_pkcs11.c@{util\_pkcs11.c}!sign\_mechanism\_cleanup@{sign\_mechanism\_cleanup}}
\index{sign\_mechanism\_cleanup@{sign\_mechanism\_cleanup}!util\_pkcs11.c@{util\_pkcs11.c}}
\doxysubsubsection{\texorpdfstring{sign\_mechanism\_cleanup()}{sign\_mechanism\_cleanup()}}
{\footnotesize\ttfamily \label{util__pkcs11_8c_a6959529c0513c47315e393d4e4827619} 
bool sign\+\_\+mechanism\+\_\+cleanup (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__pkcs11__op__info}{yubihsm\+\_\+pkcs11\+\_\+op\+\_\+info}} \texorpdfstring{$\ast$}{*}}]{op\+\_\+info}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{util__pkcs11_8c_source_l02546}{2546}} of file \mbox{\hyperlink{util__pkcs11_8c_source}{util\+\_\+pkcs11.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02546\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02547\ }
\DoxyCodeLine{02548\ \ \ \textcolor{keywordflow}{if}\ (op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_af6e088c2d57f2582d353bec69b48c023}{sign}}.\mbox{\hyperlink{structsign__info_a575aca68f9e4dec0e3cc9de8bc560725}{md\_ctx}}\ !=\ NULL)\ \{}
\DoxyCodeLine{02549\ \ \ \ \ EVP\_MD\_CTX\_destroy(op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_af6e088c2d57f2582d353bec69b48c023}{sign}}.\mbox{\hyperlink{structsign__info_a575aca68f9e4dec0e3cc9de8bc560725}{md\_ctx}});}
\DoxyCodeLine{02550\ \ \ \ \ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_af6e088c2d57f2582d353bec69b48c023}{sign}}.\mbox{\hyperlink{structsign__info_a575aca68f9e4dec0e3cc9de8bc560725}{md\_ctx}}\ =\ NULL;}
\DoxyCodeLine{02551\ \ \ \}}
\DoxyCodeLine{02552\ }
\DoxyCodeLine{02553\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{02554\ \}}

\end{DoxyCode}
\Hypertarget{util__pkcs11_8c_a5a10abc0d61cfd172e37c78948354243}\index{util\_pkcs11.c@{util\_pkcs11.c}!validate\_derive\_key\_attribute@{validate\_derive\_key\_attribute}}
\index{validate\_derive\_key\_attribute@{validate\_derive\_key\_attribute}!util\_pkcs11.c@{util\_pkcs11.c}}
\doxysubsubsection{\texorpdfstring{validate\_derive\_key\_attribute()}{validate\_derive\_key\_attribute()}}
{\footnotesize\ttfamily \label{util__pkcs11_8c_a5a10abc0d61cfd172e37c78948354243} 
CK\+\_\+\+RV validate\+\_\+derive\+\_\+key\+\_\+attribute (\begin{DoxyParamCaption}\item[{CK\+\_\+\+ATTRIBUTE\+\_\+\+TYPE}]{type}{, }\item[{void \texorpdfstring{$\ast$}{*}}]{value}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{util__pkcs11_8c_source_l03940}{3940}} of file \mbox{\hyperlink{util__pkcs11_8c_source}{util\+\_\+pkcs11.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{03940\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03941\ \ \ \textcolor{keywordflow}{switch}\ (type)\ \{}
\DoxyCodeLine{03942\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_a05c1c460160443a739c6e0ce47ae3fc8}{CKA\_TOKEN}}:}
\DoxyCodeLine{03943\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (*((\mbox{\hyperlink{pkcs11_8h_a9dc289e62be691f41a9c6b875789b1f2}{CK\_BBOOL}}\ *)\ \mbox{\hyperlink{pkcs11_8h_a32aff7c6c4cd253fdf6563677afab5ce}{value}})\ ==\ \mbox{\hyperlink{pkcs11_8h_a76edf786ed8cccb1b3d2cf9e9f0800cd}{CK\_TRUE}})\ \{}
\DoxyCodeLine{03944\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a2e3ed21e5ffba18d940d164aaec64a2a}{DBG\_ERR}}(\textcolor{stringliteral}{"{}Derived\ key\ can\ only\ be\ a\ session\ object"{}});}
\DoxyCodeLine{03945\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_ab818f05c56d56675438515a7ba5ebb70}{CKR\_ATTRIBUTE\_VALUE\_INVALID}};}
\DoxyCodeLine{03946\ \ \ \ \ \ \ \}}
\DoxyCodeLine{03947\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03948\ }
\DoxyCodeLine{03949\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_af867d3ae9286fe0f8cab4995bb6af337}{CKA\_CLASS}}:}
\DoxyCodeLine{03950\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (*((\mbox{\hyperlink{pkcs11_8h_a2c6426aaa1ca6dd1f48a01b8490482fa}{CK\_ULONG\_PTR}})\ \mbox{\hyperlink{pkcs11_8h_a32aff7c6c4cd253fdf6563677afab5ce}{value}})\ !=\ \mbox{\hyperlink{pkcs11_8h_a35306ac9f52ce0f9f45ac66b8bc4dcc7}{CKO\_SECRET\_KEY}})\ \{}
\DoxyCodeLine{03951\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a2e3ed21e5ffba18d940d164aaec64a2a}{DBG\_ERR}}(\textcolor{stringliteral}{"{}Derived\ key\ class\ is\ unsupported"{}});}
\DoxyCodeLine{03952\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_ab818f05c56d56675438515a7ba5ebb70}{CKR\_ATTRIBUTE\_VALUE\_INVALID}};}
\DoxyCodeLine{03953\ \ \ \ \ \ \ \}}
\DoxyCodeLine{03954\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03955\ }
\DoxyCodeLine{03956\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_aa438b88cbcb8a921288eeefba5613274}{CKA\_KEY\_TYPE}}:}
\DoxyCodeLine{03957\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (*((\mbox{\hyperlink{pkcs11_8h_a2c6426aaa1ca6dd1f48a01b8490482fa}{CK\_ULONG\_PTR}})\ \mbox{\hyperlink{pkcs11_8h_a32aff7c6c4cd253fdf6563677afab5ce}{value}})\ !=\ \mbox{\hyperlink{pkcs11_8h_aaf8c226acc7ea8b6b9e021465b1ae65b}{CKK\_GENERIC\_SECRET}})\ \{}
\DoxyCodeLine{03958\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a2e3ed21e5ffba18d940d164aaec64a2a}{DBG\_ERR}}(\textcolor{stringliteral}{"{}Derived\ key\ type\ is\ unsupported"{}});}
\DoxyCodeLine{03959\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_ab818f05c56d56675438515a7ba5ebb70}{CKR\_ATTRIBUTE\_VALUE\_INVALID}};}
\DoxyCodeLine{03960\ \ \ \ \ \ \ \}}
\DoxyCodeLine{03961\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03962\ }
\DoxyCodeLine{03963\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{pkcs11_8h_acf37955a2a229d208289962c6f1183b8}{CKA\_EXTRACTABLE}}:}
\DoxyCodeLine{03964\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (*((\mbox{\hyperlink{pkcs11_8h_a9dc289e62be691f41a9c6b875789b1f2}{CK\_BBOOL}}\ *)\ \mbox{\hyperlink{pkcs11_8h_a32aff7c6c4cd253fdf6563677afab5ce}{value}})\ ==\ \mbox{\hyperlink{pkcs11_8h_a1df8841072c48f0b511ccad3bbb25812}{CK\_FALSE}})\ \{}
\DoxyCodeLine{03965\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{debug__lib_8h_a2e3ed21e5ffba18d940d164aaec64a2a}{DBG\_ERR}}(\textcolor{stringliteral}{"{}The\ derived\ key\ will\ be\ extractable"{}});}
\DoxyCodeLine{03966\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_ab818f05c56d56675438515a7ba5ebb70}{CKR\_ATTRIBUTE\_VALUE\_INVALID}};}
\DoxyCodeLine{03967\ \ \ \ \ \ \ \}}
\DoxyCodeLine{03968\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03969\ }
\DoxyCodeLine{03970\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{03971\ \ \ \ \ \ \ \mbox{\hyperlink{debug__p11_8h_a83297f68021d78fbf8313d8f3570e5ac}{DBG\_WARN}}(\textcolor{stringliteral}{"{}ECDH\ key\ derive\ template\ contains\ the\ ignored\ attribute:\ \%lx"{}},}
\DoxyCodeLine{03972\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ type);}
\DoxyCodeLine{03973\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03974\ \ \ \}}
\DoxyCodeLine{03975\ }
\DoxyCodeLine{03976\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{pkcs11_8h_a41f4ccf8d6aeae2795be204b4f91c076}{CKR\_OK}};}
\DoxyCodeLine{03977\ \}}

\end{DoxyCode}
\Hypertarget{util__pkcs11_8c_a16a62896091be5cd8b7537d7f01d3f21}\index{util\_pkcs11.c@{util\_pkcs11.c}!verify\_mechanism\_cleanup@{verify\_mechanism\_cleanup}}
\index{verify\_mechanism\_cleanup@{verify\_mechanism\_cleanup}!util\_pkcs11.c@{util\_pkcs11.c}}
\doxysubsubsection{\texorpdfstring{verify\_mechanism\_cleanup()}{verify\_mechanism\_cleanup()}}
{\footnotesize\ttfamily \label{util__pkcs11_8c_a16a62896091be5cd8b7537d7f01d3f21} 
bool verify\+\_\+mechanism\+\_\+cleanup (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structyubihsm__pkcs11__op__info}{yubihsm\+\_\+pkcs11\+\_\+op\+\_\+info}} \texorpdfstring{$\ast$}{*}}]{op\+\_\+info}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{util__pkcs11_8c_source_l02556}{2556}} of file \mbox{\hyperlink{util__pkcs11_8c_source}{util\+\_\+pkcs11.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02556\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02557\ }
\DoxyCodeLine{02558\ \ \ \textcolor{keywordflow}{if}\ (op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_a769d855aca7e13b69c58abd1de1bb410}{verify}}.\mbox{\hyperlink{structverify__info_a920d34cab9f1b9ddcaf849d5b08c921d}{md\_ctx}}\ !=\ NULL)\ \{}
\DoxyCodeLine{02559\ \ \ \ \ EVP\_MD\_CTX\_destroy(op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_a769d855aca7e13b69c58abd1de1bb410}{verify}}.\mbox{\hyperlink{structverify__info_a920d34cab9f1b9ddcaf849d5b08c921d}{md\_ctx}});}
\DoxyCodeLine{02560\ \ \ \ \ op\_info-\/>\mbox{\hyperlink{structyubihsm__pkcs11__op__info_a2a88bfeb3f914ab4bc36697f02838057}{op}}.\mbox{\hyperlink{unionop_a769d855aca7e13b69c58abd1de1bb410}{verify}}.\mbox{\hyperlink{structverify__info_a920d34cab9f1b9ddcaf849d5b08c921d}{md\_ctx}}\ =\ NULL;}
\DoxyCodeLine{02561\ \ \ \}}
\DoxyCodeLine{02562\ }
\DoxyCodeLine{02563\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{02564\ \}}

\end{DoxyCode}
