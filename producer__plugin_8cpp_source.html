<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Wire Sysio: plugins/producer_plugin/producer_plugin.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Wire Sysio<span id="projectnumber">&#160;Wire Sysion 1.0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('producer__plugin_8cpp_source.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">producer_plugin.cpp</div></div>
</div><!--header-->
<div class="contents">
<a href="producer__plugin_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="preprocessor">#include &lt;<a class="code" href="producer__plugin_8hpp.html">sysio/producer_plugin/producer_plugin.hpp</a>&gt;</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="preprocessor">#include &lt;<a class="code" href="subjective__billing_8hpp.html">sysio/producer_plugin/subjective_billing.hpp</a>&gt;</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="preprocessor">#include &lt;<a class="code" href="plugin__interface_8hpp.html">sysio/chain/plugin_interface.hpp</a>&gt;</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="preprocessor">#include &lt;<a class="code" href="global__property__object_8hpp.html">sysio/chain/global_property_object.hpp</a>&gt;</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="preprocessor">#include &lt;<a class="code" href="generated__transaction__object_8hpp.html">sysio/chain/generated_transaction_object.hpp</a>&gt;</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="preprocessor">#include &lt;<a class="code" href="snapshot_8hpp.html">sysio/chain/snapshot.hpp</a>&gt;</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="preprocessor">#include &lt;<a class="code" href="transaction__object_8hpp.html">sysio/chain/transaction_object.hpp</a>&gt;</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="preprocessor">#include &lt;<a class="code" href="thread__utils_8hpp.html">sysio/chain/thread_utils.hpp</a>&gt;</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="preprocessor">#include &lt;<a class="code" href="unapplied__transaction__queue_8hpp.html">sysio/chain/unapplied_transaction_queue.hpp</a>&gt;</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="preprocessor">#include &lt;<a class="code" href="resource__monitor__plugin_8hpp.html">sysio/resource_monitor_plugin/resource_monitor_plugin.hpp</a>&gt;</span></div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="preprocessor">#include &lt;<a class="code" href="sub__chain__plugin_8hpp.html">sysio/sub_chain_plugin/sub_chain_plugin.hpp</a>&gt;</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="preprocessor">#include &lt;<a class="code" href="s__root__extension_8hpp.html">sysio/chain/s_root_extension.hpp</a>&gt;</span></div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span> </div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="preprocessor">#include &lt;<a class="code" href="json_8hpp.html">fc/io/json.hpp</a>&gt;</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span><span class="preprocessor">#include &lt;<a class="code" href="logger__config_8hpp.html">fc/log/logger_config.hpp</a>&gt;</span></div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="preprocessor">#include &lt;<a class="code" href="scoped__exit_8hpp.html">fc/scoped_exit.hpp</a>&gt;</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span> </div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span><span class="preprocessor">#include &lt;boost/asio.hpp&gt;</span></div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span><span class="preprocessor">#include &lt;boost/date_time/posix_time/posix_time.hpp&gt;</span></div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span> </div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span><span class="preprocessor">#include &lt;algorithm&gt;</span></div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span><span class="preprocessor">#include &lt;boost/algorithm/string.hpp&gt;</span></div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span><span class="preprocessor">#include &lt;boost/range/adaptor/map.hpp&gt;</span></div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span><span class="preprocessor">#include &lt;boost/function_output_iterator.hpp&gt;</span></div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span><span class="preprocessor">#include &lt;boost/multi_index_container.hpp&gt;</span></div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span><span class="preprocessor">#include &lt;boost/multi_index/member.hpp&gt;</span></div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span><span class="preprocessor">#include &lt;boost/multi_index/hashed_index.hpp&gt;</span></div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span><span class="preprocessor">#include &lt;boost/multi_index/ordered_index.hpp&gt;</span></div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span><span class="preprocessor">#include &lt;boost/signals2/connection.hpp&gt;</span></div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span> </div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span><span class="keyword">namespace </span>bmi = boost::multi_index;</div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span><span class="keyword">using </span>bmi::indexed_by;</div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span><span class="keyword">using </span>bmi::ordered_non_unique;</div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span><span class="keyword">using </span>bmi::member;</div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span><span class="keyword">using </span>bmi::tag;</div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span><span class="keyword">using </span>bmi::hashed_unique;</div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span> </div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span><span class="keyword">using </span>boost::multi_index_container;</div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span> </div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span><span class="keyword">using </span>std::string;</div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span><span class="keyword">using </span>std::vector;</div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span><span class="keyword">using </span>std::deque;</div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span><span class="keyword">using </span>boost::signals2::scoped_connection;</div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span> </div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span><span class="preprocessor">#undef FC_LOG_AND_DROP</span></div>
<div class="foldopen" id="foldopen00047" data-start="" data-end="">
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno"><a class="line" href="producer__plugin_8cpp.html#a01d09f9c9fe1cbc1b70a0c41f0682e07">   47</a></span><span class="preprocessor">#define LOG_AND_DROP()  \</span></div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span><span class="preprocessor">   catch ( const guard_exception&amp; e ) { \</span></div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span><span class="preprocessor">      chain_plugin::handle_guard_exception(e); \</span></div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span><span class="preprocessor">   } catch ( const std::bad_alloc&amp; ) { \</span></div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span><span class="preprocessor">      chain_plugin::handle_bad_alloc(); \</span></div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span><span class="preprocessor">   } catch ( boost::interprocess::bad_alloc&amp; ) { \</span></div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span><span class="preprocessor">      chain_plugin::handle_db_exhaustion(); \</span></div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span><span class="preprocessor">   } catch( fc::exception&amp; er ) { \</span></div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span><span class="preprocessor">      wlog( &quot;${details}&quot;, (&quot;details&quot;,er.to_detail_string()) ); \</span></div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span><span class="preprocessor">   } catch( const std::exception&amp; e ) {  \</span></div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span><span class="preprocessor">      fc::exception fce( \</span></div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span><span class="preprocessor">                FC_LOG_MESSAGE( warn, &quot;std::exception: ${what}: &quot;,(&quot;what&quot;,e.what()) ), \</span></div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span><span class="preprocessor">                fc::std_exception_code,\</span></div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span><span class="preprocessor">                BOOST_CORE_TYPEID(e).name(), \</span></div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span><span class="preprocessor">                e.what() ) ; \</span></div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span><span class="preprocessor">      wlog( &quot;${details}&quot;, (&quot;details&quot;,fce.to_detail_string()) ); \</span></div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span><span class="preprocessor">   } catch( ... ) {  \</span></div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span><span class="preprocessor">      fc::unhandled_exception e( \</span></div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span><span class="preprocessor">                FC_LOG_MESSAGE( warn, &quot;unknown: &quot;,  ), \</span></div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span><span class="preprocessor">                std::current_exception() ); \</span></div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span><span class="preprocessor">      wlog( &quot;${details}&quot;, (&quot;details&quot;,e.to_detail_string()) ); \</span></div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span><span class="preprocessor">   }</span></div>
</div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span> </div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno"><a class="line" href="producer__plugin_8cpp.html#ae8244453c4634dc005f0e0c4cb58dd09">   70</a></span><span class="keyword">const</span> std::string <a class="code hl_function" href="producer__plugin_8cpp.html#ae8244453c4634dc005f0e0c4cb58dd09">logger_name</a>(<span class="stringliteral">&quot;producer_plugin&quot;</span>);</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno"><a class="line" href="producer__plugin_8cpp.html#adff615e9fbe43b3e6443687be568cffd">   71</a></span><a class="code hl_class" href="classfc_1_1logger.html">fc::logger</a> <a class="code hl_variable" href="producer__plugin_8cpp.html#adff615e9fbe43b3e6443687be568cffd">_log</a>;</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span> </div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno"><a class="line" href="producer__plugin_8cpp.html#ada404895f53490702144cecc3a82b6d4">   73</a></span><span class="keyword">const</span> std::string <a class="code hl_function" href="producer__plugin_8cpp.html#ada404895f53490702144cecc3a82b6d4">trx_successful_trace_logger_name</a>(<span class="stringliteral">&quot;transaction_success_tracing&quot;</span>);</div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno"><a class="line" href="producer__plugin_8cpp.html#aea18f7b7425ddc0191447aca7c3e27f6">   74</a></span><a class="code hl_class" href="classfc_1_1logger.html">fc::logger</a>       <a class="code hl_variable" href="producer__plugin_8cpp.html#aea18f7b7425ddc0191447aca7c3e27f6">_trx_successful_trace_log</a>;</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span> </div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno"><a class="line" href="producer__plugin_8cpp.html#a621f886a258aed68a24a53ffb3b0c36d">   76</a></span><span class="keyword">const</span> std::string <a class="code hl_function" href="producer__plugin_8cpp.html#a621f886a258aed68a24a53ffb3b0c36d">trx_failed_trace_logger_name</a>(<span class="stringliteral">&quot;transaction_failure_tracing&quot;</span>);</div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno"><a class="line" href="producer__plugin_8cpp.html#ae93a86d470c7e16b50ab7102170c5d4e">   77</a></span><a class="code hl_class" href="classfc_1_1logger.html">fc::logger</a>       <a class="code hl_variable" href="producer__plugin_8cpp.html#ae93a86d470c7e16b50ab7102170c5d4e">_trx_failed_trace_log</a>;</div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span> </div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno"><a class="line" href="producer__plugin_8cpp.html#ae546cf0f5f4ee210f917a432e3c1bc42">   79</a></span><span class="keyword">const</span> std::string <a class="code hl_function" href="producer__plugin_8cpp.html#ae546cf0f5f4ee210f917a432e3c1bc42">trx_trace_success_logger_name</a>(<span class="stringliteral">&quot;transaction_trace_success&quot;</span>);</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno"><a class="line" href="producer__plugin_8cpp.html#a79c03faf256096a8e1ad0d59c8760d2e">   80</a></span><a class="code hl_class" href="classfc_1_1logger.html">fc::logger</a>       <a class="code hl_variable" href="producer__plugin_8cpp.html#a79c03faf256096a8e1ad0d59c8760d2e">_trx_trace_success_log</a>;</div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span> </div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno"><a class="line" href="producer__plugin_8cpp.html#a54d7146c8088d64735b0cfbbea3ecae8">   82</a></span><span class="keyword">const</span> std::string <a class="code hl_function" href="producer__plugin_8cpp.html#a54d7146c8088d64735b0cfbbea3ecae8">trx_trace_failure_logger_name</a>(<span class="stringliteral">&quot;transaction_trace_failure&quot;</span>);</div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno"><a class="line" href="producer__plugin_8cpp.html#a979f47bc56a17944271d72bccb834c33">   83</a></span><a class="code hl_class" href="classfc_1_1logger.html">fc::logger</a>       <a class="code hl_variable" href="producer__plugin_8cpp.html#a979f47bc56a17944271d72bccb834c33">_trx_trace_failure_log</a>;</div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span> </div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno"><a class="line" href="producer__plugin_8cpp.html#af25e4084ac685ca1a7777524a948d81f">   85</a></span><span class="keyword">const</span> std::string <a class="code hl_function" href="producer__plugin_8cpp.html#af25e4084ac685ca1a7777524a948d81f">trx_logger_name</a>(<span class="stringliteral">&quot;transaction&quot;</span>);</div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno"><a class="line" href="producer__plugin_8cpp.html#a78396757cc70405744561b647c892edf">   86</a></span><a class="code hl_class" href="classfc_1_1logger.html">fc::logger</a>       <a class="code hl_variable" href="producer__plugin_8cpp.html#a78396757cc70405744561b647c892edf">_trx_log</a>;</div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span> </div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span><span class="keyword">namespace </span><a class="code hl_namespace" href="namespacesysio.html">sysio</a> {</div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span> </div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span><span class="keyword">static</span> <a class="code hl_class" href="classappbase_1_1abstract__plugin.html">appbase::abstract_plugin</a>&amp; _producer_plugin = <a class="code hl_function" href="namespaceappbase.html#a99374dc23934f008a09f2f79be9eae40">app</a>().<a class="code hl_function" href="classappbase_1_1application.html#a87e84549150056c56c0327cc4976cc2a">register_plugin</a>&lt;producer_plugin&gt;();</div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span> </div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespacesysio_1_1chain.html">sysio::chain</a>;</div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespacesysio_1_1chain_1_1plugin__interface.html">sysio::chain::plugin_interface</a>;</div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span> </div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span><span class="keyword">namespace </span>{</div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span>   <span class="keywordtype">bool</span> exception_is_exhausted(<span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1exception.html">fc::exception</a>&amp; e) {</div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>      <span class="keyword">auto</span> code = e.<a class="code hl_function" href="classfc_1_1exception.html#a79a36225cde10dcd23057bbe19d3390f">code</a>();</div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span>      <span class="keywordflow">return</span> (code == block_cpu_usage_exceeded::code_value) ||</div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span>             (code == block_net_usage_exceeded::code_value) ||</div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span>             (code == deadline_exception::code_value);</div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span>   }</div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span>}</div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span> </div>
<div class="foldopen" id="foldopen00104" data-start="{" data-end="};">
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno"><a class="line" href="structsysio_1_1transaction__id__with__expiry.html">  104</a></span><span class="keyword">struct </span><a class="code hl_struct" href="structsysio_1_1transaction__id__with__expiry.html">transaction_id_with_expiry</a> {</div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno"><a class="line" href="structsysio_1_1transaction__id__with__expiry.html#a8adfcfd1ba13cf76ae84af5deb02b853">  105</a></span>   <a class="code hl_class" href="classfc_1_1sha256.html">transaction_id_type</a>     <a class="code hl_variable" href="structsysio_1_1transaction__id__with__expiry.html#a8adfcfd1ba13cf76ae84af5deb02b853">trx_id</a>;</div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno"><a class="line" href="structsysio_1_1transaction__id__with__expiry.html#a3b765964a54ae9c299ad7a724d03ea12">  106</a></span>   <a class="code hl_class" href="classfc_1_1time__point.html">fc::time_point</a>          <a class="code hl_variable" href="structsysio_1_1transaction__id__with__expiry.html#a3b765964a54ae9c299ad7a724d03ea12">expiry</a>;</div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span>};</div>
</div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span> </div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span><span class="keyword">struct </span>by_id;</div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span><span class="keyword">struct </span>by_expiry;</div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span> </div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno"><a class="line" href="namespacesysio.html#a3da8a6a29b9db34a4eb5170317d0b5a5">  112</a></span><span class="keyword">using </span><a class="code hl_typedef" href="namespacesysio.html#a3da8a6a29b9db34a4eb5170317d0b5a5">transaction_id_with_expiry_index</a> = multi_index_container&lt;</div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>   <a class="code hl_struct" href="structsysio_1_1transaction__id__with__expiry.html">transaction_id_with_expiry</a>,</div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>   indexed_by&lt;</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>      hashed_unique&lt;tag&lt;by_id&gt;, BOOST_MULTI_INDEX_MEMBER(<a class="code hl_struct" href="structsysio_1_1transaction__id__with__expiry.html">transaction_id_with_expiry</a>, <a class="code hl_class" href="classfc_1_1sha256.html">transaction_id_type</a>, trx_id)&gt;,</div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>      ordered_non_unique&lt;tag&lt;by_expiry&gt;, BOOST_MULTI_INDEX_MEMBER(<a class="code hl_struct" href="structsysio_1_1transaction__id__with__expiry.html">transaction_id_with_expiry</a>, <a class="code hl_class" href="classfc_1_1time__point.html">fc::time_point</a>, expiry)&gt;</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span>   &gt;</div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>&gt;;</div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span> </div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span><span class="keyword">struct </span>by_height;</div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span> </div>
<div class="foldopen" id="foldopen00122" data-start="{" data-end="};">
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno"><a class="line" href="classsysio_1_1pending__snapshot.html">  122</a></span><span class="keyword">class </span><a class="code hl_class" href="classsysio_1_1pending__snapshot.html">pending_snapshot</a> {</div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span><span class="keyword">public</span>:</div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno"><a class="line" href="classsysio_1_1pending__snapshot.html#a1915f67e4cb854b7614890e223c6d8de">  124</a></span>   <span class="keyword">using </span><a class="code hl_typedef" href="classsysio_1_1pending__snapshot.html#a1915f67e4cb854b7614890e223c6d8de">next_t</a> = <a class="code hl_typedef" href="classsysio_1_1producer__plugin.html#aa0f4bf0b390688408224d4bc36b74e27">producer_plugin::next_function&lt;producer_plugin::snapshot_information&gt;</a>;</div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span> </div>
<div class="foldopen" id="foldopen00126" data-start="{" data-end="}">
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno"><a class="line" href="classsysio_1_1pending__snapshot.html#a701da57e23f9da21fb2128ef097d41e0">  126</a></span>   <a class="code hl_function" href="classsysio_1_1pending__snapshot.html#a701da57e23f9da21fb2128ef097d41e0">pending_snapshot</a>(<span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1sha256.html">block_id_type</a>&amp; <a class="code hl_variable" href="classsysio_1_1pending__snapshot.html#a79a20762863821f28c0a9c58fe28a498">block_id</a>, <a class="code hl_typedef" href="classsysio_1_1pending__snapshot.html#a1915f67e4cb854b7614890e223c6d8de">next_t</a>&amp; <a class="code hl_variable" href="classsysio_1_1pending__snapshot.html#a0a38893f527797a40a857997faa24965">next</a>, std::string <a class="code hl_variable" href="classsysio_1_1pending__snapshot.html#aa485b681ff792ae2faf5f4ab70165599">pending_path</a>, std::string <a class="code hl_variable" href="classsysio_1_1pending__snapshot.html#adcaa3a5c35a2dfbc55136ff2ffa8df52">final_path</a>)</div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span>   : <a class="code hl_variable" href="classsysio_1_1pending__snapshot.html#a79a20762863821f28c0a9c58fe28a498">block_id</a>(<a class="code hl_variable" href="classsysio_1_1pending__snapshot.html#a79a20762863821f28c0a9c58fe28a498">block_id</a>)</div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span>   , <a class="code hl_variable" href="classsysio_1_1pending__snapshot.html#a0a38893f527797a40a857997faa24965">next</a>(<a class="code hl_variable" href="classsysio_1_1pending__snapshot.html#a0a38893f527797a40a857997faa24965">next</a>)</div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span>   , <a class="code hl_variable" href="classsysio_1_1pending__snapshot.html#aa485b681ff792ae2faf5f4ab70165599">pending_path</a>(<a class="code hl_variable" href="classsysio_1_1pending__snapshot.html#aa485b681ff792ae2faf5f4ab70165599">pending_path</a>)</div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span>   , <a class="code hl_variable" href="classsysio_1_1pending__snapshot.html#adcaa3a5c35a2dfbc55136ff2ffa8df52">final_path</a>(<a class="code hl_variable" href="classsysio_1_1pending__snapshot.html#adcaa3a5c35a2dfbc55136ff2ffa8df52">final_path</a>)</div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span>   {}</div>
</div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span> </div>
<div class="foldopen" id="foldopen00133" data-start="{" data-end="}">
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno"><a class="line" href="classsysio_1_1pending__snapshot.html#a480efe5391047b60fd1b192b80784537">  133</a></span>   <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="code hl_function" href="classsysio_1_1pending__snapshot.html#a480efe5391047b60fd1b192b80784537">get_height</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span>      <span class="keywordflow">return</span> <a class="code hl_function" href="structsysio_1_1chain_1_1block__header.html#a39d57e33ef8d3f6ba59b4c458f0ae375">block_header::num_from_id</a>(<a class="code hl_variable" href="classsysio_1_1pending__snapshot.html#a79a20762863821f28c0a9c58fe28a498">block_id</a>);</div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>   }</div>
</div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span> </div>
<div class="foldopen" id="foldopen00137" data-start="{" data-end="}">
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno"><a class="line" href="classsysio_1_1pending__snapshot.html#a79fc9801d0442d3b7f58833f23d6c9f9">  137</a></span>   <span class="keyword">static</span> bfs::path <a class="code hl_function" href="classsysio_1_1pending__snapshot.html#a79fc9801d0442d3b7f58833f23d6c9f9">get_final_path</a>(<span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1sha256.html">block_id_type</a>&amp; <a class="code hl_variable" href="classsysio_1_1pending__snapshot.html#a79a20762863821f28c0a9c58fe28a498">block_id</a>, <span class="keyword">const</span> bfs::path&amp; snapshots_dir) {</div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>      <span class="keywordflow">return</span> snapshots_dir / <a class="code hl_function" href="namespacefc.html#acd5129981ae93fce3154d3fed6f6acbc">fc::format_string</a>(<span class="stringliteral">&quot;snapshot-${id}.bin&quot;</span>, <a class="code hl_class" href="classfc_1_1mutable__variant__object.html">fc::mutable_variant_object</a>()(<span class="stringliteral">&quot;id&quot;</span>, <a class="code hl_variable" href="classsysio_1_1pending__snapshot.html#a79a20762863821f28c0a9c58fe28a498">block_id</a>));</div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>   }</div>
</div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span> </div>
<div class="foldopen" id="foldopen00141" data-start="{" data-end="}">
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno"><a class="line" href="classsysio_1_1pending__snapshot.html#a44c77e2240938dc9116890df2818bf4b">  141</a></span>   <span class="keyword">static</span> bfs::path <a class="code hl_function" href="classsysio_1_1pending__snapshot.html#a44c77e2240938dc9116890df2818bf4b">get_pending_path</a>(<span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1sha256.html">block_id_type</a>&amp; <a class="code hl_variable" href="classsysio_1_1pending__snapshot.html#a79a20762863821f28c0a9c58fe28a498">block_id</a>, <span class="keyword">const</span> bfs::path&amp; snapshots_dir) {</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>      <span class="keywordflow">return</span> snapshots_dir / <a class="code hl_function" href="namespacefc.html#acd5129981ae93fce3154d3fed6f6acbc">fc::format_string</a>(<span class="stringliteral">&quot;.pending-snapshot-${id}.bin&quot;</span>, <a class="code hl_class" href="classfc_1_1mutable__variant__object.html">fc::mutable_variant_object</a>()(<span class="stringliteral">&quot;id&quot;</span>, <a class="code hl_variable" href="classsysio_1_1pending__snapshot.html#a79a20762863821f28c0a9c58fe28a498">block_id</a>));</div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span>   }</div>
</div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span> </div>
<div class="foldopen" id="foldopen00145" data-start="{" data-end="}">
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno"><a class="line" href="classsysio_1_1pending__snapshot.html#a5c1d883bec4e7ed86c903ad81d4301cd">  145</a></span>   <span class="keyword">static</span> bfs::path <a class="code hl_function" href="classsysio_1_1pending__snapshot.html#a5c1d883bec4e7ed86c903ad81d4301cd">get_temp_path</a>(<span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1sha256.html">block_id_type</a>&amp; <a class="code hl_variable" href="classsysio_1_1pending__snapshot.html#a79a20762863821f28c0a9c58fe28a498">block_id</a>, <span class="keyword">const</span> bfs::path&amp; snapshots_dir) {</div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span>      <span class="keywordflow">return</span> snapshots_dir / <a class="code hl_function" href="namespacefc.html#acd5129981ae93fce3154d3fed6f6acbc">fc::format_string</a>(<span class="stringliteral">&quot;.incomplete-snapshot-${id}.bin&quot;</span>, <a class="code hl_class" href="classfc_1_1mutable__variant__object.html">fc::mutable_variant_object</a>()(<span class="stringliteral">&quot;id&quot;</span>, <a class="code hl_variable" href="classsysio_1_1pending__snapshot.html#a79a20762863821f28c0a9c58fe28a498">block_id</a>));</div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>   }</div>
</div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span> </div>
<div class="foldopen" id="foldopen00149" data-start="{" data-end="}">
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno"><a class="line" href="classsysio_1_1pending__snapshot.html#a746d5d6ce681a9cda250a36e25f8781a">  149</a></span>   <a class="code hl_struct" href="structsysio_1_1producer__plugin_1_1snapshot__information.html">producer_plugin::snapshot_information</a> <a class="code hl_function" href="classsysio_1_1pending__snapshot.html#a746d5d6ce681a9cda250a36e25f8781a">finalize</a>( <span class="keyword">const</span> <a class="code hl_class" href="classsysio_1_1chain_1_1controller.html">chain::controller</a>&amp; chain )<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>      <span class="keyword">auto</span> block_ptr = chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a7d6e058e892e067510650db853794338">fetch_block_by_id</a>( <a class="code hl_variable" href="classsysio_1_1pending__snapshot.html#a79a20762863821f28c0a9c58fe28a498">block_id</a> );</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>      <span class="keyword">auto</span> in_chain = (bool)block_ptr;</div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>      boost::system::error_code ec;</div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span> </div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>      <span class="keywordflow">if</span> (!in_chain) {</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>         bfs::remove(bfs::path(<a class="code hl_variable" href="classsysio_1_1pending__snapshot.html#aa485b681ff792ae2faf5f4ab70165599">pending_path</a>), ec);</div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span>         <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a1bfa656552ea0534b2c91ee0fe33f850">SYS_THROW</a>(snapshot_finalization_exception,</div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>                   <span class="stringliteral">&quot;Snapshotted block was forked out of the chain.  ID: ${block_id}&quot;</span>,</div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>                   (<span class="stringliteral">&quot;block_id&quot;</span>, <a class="code hl_variable" href="classsysio_1_1pending__snapshot.html#a79a20762863821f28c0a9c58fe28a498">block_id</a>));</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>      }</div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span> </div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>      bfs::rename(bfs::path(<a class="code hl_variable" href="classsysio_1_1pending__snapshot.html#aa485b681ff792ae2faf5f4ab70165599">pending_path</a>), bfs::path(<a class="code hl_variable" href="classsysio_1_1pending__snapshot.html#adcaa3a5c35a2dfbc55136ff2ffa8df52">final_path</a>), ec);</div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>      <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>(!ec, snapshot_finalization_exception,</div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>                 <span class="stringliteral">&quot;Unable to finalize valid snapshot of block number ${bn}: [code: ${ec}] ${message}&quot;</span>,</div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>                 (<span class="stringliteral">&quot;bn&quot;</span>, <a class="code hl_function" href="classsysio_1_1pending__snapshot.html#a480efe5391047b60fd1b192b80784537">get_height</a>())</div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>                 (<span class="stringliteral">&quot;ec&quot;</span>, ec.value())</div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>                 (<span class="stringliteral">&quot;message&quot;</span>, ec.message()));</div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span> </div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span>      <span class="keywordflow">return</span> {<a class="code hl_variable" href="classsysio_1_1pending__snapshot.html#a79a20762863821f28c0a9c58fe28a498">block_id</a>, block_ptr-&gt;block_num(), block_ptr-&gt;timestamp, <a class="code hl_variable" href="structsysio_1_1chain_1_1chain__snapshot__header.html#ad7357c9cee48e084e060efb76dce03e4">chain_snapshot_header::current_version</a>, <a class="code hl_variable" href="classsysio_1_1pending__snapshot.html#adcaa3a5c35a2dfbc55136ff2ffa8df52">final_path</a>};</div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span>   }</div>
</div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span> </div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno"><a class="line" href="classsysio_1_1pending__snapshot.html#a79a20762863821f28c0a9c58fe28a498">  171</a></span>   <a class="code hl_class" href="classfc_1_1sha256.html">block_id_type</a>     <a class="code hl_variable" href="classsysio_1_1pending__snapshot.html#a79a20762863821f28c0a9c58fe28a498">block_id</a>;</div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno"><a class="line" href="classsysio_1_1pending__snapshot.html#a0a38893f527797a40a857997faa24965">  172</a></span>   <a class="code hl_typedef" href="classsysio_1_1pending__snapshot.html#a1915f67e4cb854b7614890e223c6d8de">next_t</a>            <a class="code hl_variable" href="classsysio_1_1pending__snapshot.html#a0a38893f527797a40a857997faa24965">next</a>;</div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno"><a class="line" href="classsysio_1_1pending__snapshot.html#aa485b681ff792ae2faf5f4ab70165599">  173</a></span>   std::string       <a class="code hl_variable" href="classsysio_1_1pending__snapshot.html#aa485b681ff792ae2faf5f4ab70165599">pending_path</a>;</div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno"><a class="line" href="classsysio_1_1pending__snapshot.html#adcaa3a5c35a2dfbc55136ff2ffa8df52">  174</a></span>   std::string       <a class="code hl_variable" href="classsysio_1_1pending__snapshot.html#adcaa3a5c35a2dfbc55136ff2ffa8df52">final_path</a>;</div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>};</div>
</div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span> </div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno"><a class="line" href="namespacesysio.html#a141379c7defda83a80367f716ab4f78b">  177</a></span><span class="keyword">using </span><a class="code hl_typedef" href="namespacesysio.html#a141379c7defda83a80367f716ab4f78b">pending_snapshot_index</a> = multi_index_container&lt;</div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span>   <a class="code hl_class" href="classsysio_1_1pending__snapshot.html">pending_snapshot</a>,</div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span>   indexed_by&lt;</div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>      hashed_unique&lt;tag&lt;by_id&gt;, BOOST_MULTI_INDEX_MEMBER(<a class="code hl_class" href="classsysio_1_1pending__snapshot.html">pending_snapshot</a>, <a class="code hl_class" href="classfc_1_1sha256.html">block_id_type</a>, block_id)&gt;,</div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>      ordered_non_unique&lt;tag&lt;by_height&gt;, BOOST_MULTI_INDEX_CONST_MEM_FUN( <a class="code hl_class" href="classsysio_1_1pending__snapshot.html">pending_snapshot</a>, <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>, get_height)&gt;</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>   &gt;</div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>&gt;;</div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span> </div>
<div class="foldopen" id="foldopen00185" data-start="{" data-end="};">
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno"><a class="line" href="namespacesysio.html#acd1c637e1a22040dbf666b0301cbc475">  185</a></span><span class="keyword">enum class</span> <a class="code hl_enumeration" href="namespacesysio.html#acd1c637e1a22040dbf666b0301cbc475">pending_block_mode</a> {</div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>   <a class="code hl_enumvalue" href="namespacesysio.html#acd1c637e1a22040dbf666b0301cbc475afd75fc8d5de6f56947b1afc9e44ddb5f">producing</a>,</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>   <a class="code hl_enumvalue" href="namespacesysio.html#acd1c637e1a22040dbf666b0301cbc475aa25b9b4361a3bd215c739cf4f9cf2e4a">speculating</a></div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span>};</div>
</div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span> </div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span><span class="keyword">namespace </span>{</div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span> </div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span><span class="comment">// track multiple failures on unapplied transactions</span></div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span><span class="keyword">class </span>account_failures {</div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span><span class="keyword">public</span>:</div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span> </div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span>   <span class="comment">//lifetime of sb must outlive account_failures</span></div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span>   <span class="keyword">explicit</span> account_failures( <span class="keyword">const</span> <a class="code hl_class" href="classsysio_1_1subjective__billing.html">sysio::subjective_billing</a>&amp; sb )</div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>   : <a class="code hl_class" href="classsysio_1_1subjective__billing.html">subjective_billing</a>(sb)</div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span>   {</div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>   }</div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span> </div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span>   <span class="keywordtype">void</span> set_max_failures_per_account( <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> max_failures ) {</div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>       max_failures_per_account = max_failures;</div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span>   }</div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span> </div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span>   <span class="keywordtype">void</span> <a class="code hl_function" href="static__buf_8cpp.html#aa99823a0fc8313c9c32541ce768fb801">add</a>( <span class="keyword">const</span> <a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">account_name</a>&amp; n, <a class="code hl_typedef" href="stdint_8h.html#a414156feea104f8f75b4ed9e3121b2f6">int64_t</a> <a class="code hl_enumeration" href="namespacefc.html#ab52b42f18c442a260897c74c66c3d35c">exception_code</a> ) {</div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>      <span class="keyword">auto</span>&amp; fa = failed_accounts[n];</div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>      ++fa.num_failures;</div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>      fa.add( n, <a class="code hl_enumeration" href="namespacefc.html#ab52b42f18c442a260897c74c66c3d35c">exception_code</a> );</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span>   }</div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span> </div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>   <span class="comment">// return true if exceeds max_failures_per_account and should be dropped</span></div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>   <span class="keywordtype">bool</span> failure_limit( <span class="keyword">const</span> <a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">account_name</a>&amp; n ) {</div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>      <span class="keyword">auto</span> fitr = failed_accounts.find( n );</div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span>      <span class="keywordtype">bool</span> is_whitelisted = <a class="code hl_class" href="classsysio_1_1subjective__billing.html">subjective_billing</a>.<a class="code hl_function" href="classsysio_1_1subjective__billing.html#a7da6a0636378886a46193d41089149bc">is_account_disabled</a>( n );</div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span>      <span class="keywordflow">if</span>( !is_whitelisted &amp;&amp; fitr != failed_accounts.end() &amp;&amp; fitr-&gt;second.num_failures &gt;= max_failures_per_account ) {</div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span>         ++fitr-&gt;second.num_failures;</div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span>         <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>      }</div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span>      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span>   }</div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span> </div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>   <span class="keywordtype">void</span> report()<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span>      <span class="keywordflow">if</span>( <a class="code hl_variable" href="producer__plugin_8cpp.html#adff615e9fbe43b3e6443687be568cffd">_log</a>.<a class="code hl_function" href="classfc_1_1logger.html#afbae9b6cd7f4f604f654a4c1914677ac">is_enabled</a>( <a class="code hl_enumvalue" href="classfc_1_1log__level.html#a5a5e31c4c1f38d9115ecbe44927fb2e4a30d2de77e71beb8d09d530cac04efa25">fc::log_level::debug</a> ) ) {</div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>         <span class="keyword">auto</span> now = <a class="code hl_function" href="classfc_1_1time__point.html#aa164ff1268a16d4b32afcff181f6100e">fc::time_point::now</a>();</div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>         <span class="keywordflow">for</span>( <span class="keyword">const</span> <span class="keyword">auto</span>&amp; e : failed_accounts ) {</div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span>            std::string reason;</div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>            <span class="keywordflow">if</span>( e.second.is_deadline() ) reason += <span class="stringliteral">&quot;deadline&quot;</span>;</div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span>            <span class="keywordflow">if</span>( e.second.is_tx_cpu_usage() ) {</div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span>               <span class="keywordflow">if</span>( !reason.empty() ) reason += <span class="stringliteral">&quot;, &quot;</span>;</div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span>               reason += <span class="stringliteral">&quot;tx_cpu_usage&quot;</span>;</div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>            }</div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>            <span class="keywordflow">if</span>( e.second.is_sysio_assert() ) {</div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span>               <span class="keywordflow">if</span>( !reason.empty() ) reason += <span class="stringliteral">&quot;, &quot;</span>;</div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>               reason += <span class="stringliteral">&quot;assert&quot;</span>;</div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>            }</div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>            <span class="keywordflow">if</span>( e.second.is_other() ) {</div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>               <span class="keywordflow">if</span>( !reason.empty() ) reason += <span class="stringliteral">&quot;, &quot;</span>;</div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>               reason += <span class="stringliteral">&quot;other&quot;</span>;</div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>            }</div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>            <a class="code hl_define" href="logger_8hpp.html#af5adfcda7e0a01306256754a6511915d">fc_dlog</a>( <a class="code hl_variable" href="producer__plugin_8cpp.html#adff615e9fbe43b3e6443687be568cffd">_log</a>, <span class="stringliteral">&quot;Failed ${n} trxs, account: ${a}, sub bill: ${b}us, reason: ${r}&quot;</span>,</div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span>                     (<span class="stringliteral">&quot;n&quot;</span>, e.second.num_failures)(<span class="stringliteral">&quot;b&quot;</span>, <a class="code hl_class" href="classsysio_1_1subjective__billing.html">subjective_billing</a>.<a class="code hl_function" href="classsysio_1_1subjective__billing.html#a24c7829695461e95f71a1e209b3bda1f">get_subjective_bill</a>(e.first, now))</div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span>                     (<span class="stringliteral">&quot;a&quot;</span>, e.first)(<span class="stringliteral">&quot;r&quot;</span>, reason) );</div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span>         }</div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>      }</div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span>   }</div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span> </div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>   <span class="keywordtype">void</span> <a class="code hl_variable" href="wrap__data_8c.html#ac08cbd67ab213a122acbaf421f839005">clear</a>() {</div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span>      failed_accounts.clear();</div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span>   }</div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span> </div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span><span class="keyword">private</span>:</div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span>   <span class="keyword">struct </span>account_failure {</div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span>      <span class="keyword">enum class</span> ex_fields : <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> {</div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span>         ex_deadline_exception = 1,</div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span>         ex_tx_cpu_usage_exceeded = 2,</div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span>         ex_sysio_assert_exception = 4,</div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span>         ex_other_exception = 8</div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span>      };</div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span> </div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span>      <span class="keywordtype">void</span> <a class="code hl_function" href="static__buf_8cpp.html#aa99823a0fc8313c9c32541ce768fb801">add</a>( <span class="keyword">const</span> <a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">account_name</a>&amp; n, <a class="code hl_typedef" href="stdint_8h.html#a414156feea104f8f75b4ed9e3121b2f6">int64_t</a> <a class="code hl_enumeration" href="namespacefc.html#ab52b42f18c442a260897c74c66c3d35c">exception_code</a> ) {</div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span>         <span class="keywordflow">if</span>( <a class="code hl_enumeration" href="namespacefc.html#ab52b42f18c442a260897c74c66c3d35c">exception_code</a> == tx_cpu_usage_exceeded::code_value ) {</div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span>            <a class="code hl_variable" href="producer__plugin_8cpp.html#afaa31b8b3376c7a4a9bde7ff4222a1af">ex_flags</a> = set_field( ex_flags, ex_fields::ex_tx_cpu_usage_exceeded );</div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span>         } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code hl_enumeration" href="namespacefc.html#ab52b42f18c442a260897c74c66c3d35c">exception_code</a> == deadline_exception::code_value ) {</div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span>            <a class="code hl_variable" href="producer__plugin_8cpp.html#afaa31b8b3376c7a4a9bde7ff4222a1af">ex_flags</a> = set_field( ex_flags, ex_fields::ex_deadline_exception );</div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span>         } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code hl_enumeration" href="namespacefc.html#ab52b42f18c442a260897c74c66c3d35c">exception_code</a> == sysio_assert_message_exception::code_value ||</div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span>                    <a class="code hl_enumeration" href="namespacefc.html#ab52b42f18c442a260897c74c66c3d35c">exception_code</a> == sysio_assert_code_exception::code_value ) {</div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span>            <a class="code hl_variable" href="producer__plugin_8cpp.html#afaa31b8b3376c7a4a9bde7ff4222a1af">ex_flags</a> = set_field( ex_flags, ex_fields::ex_sysio_assert_exception );</div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>         } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span>            <a class="code hl_variable" href="producer__plugin_8cpp.html#afaa31b8b3376c7a4a9bde7ff4222a1af">ex_flags</a> = set_field( ex_flags, ex_fields::ex_other_exception );</div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span>            <a class="code hl_define" href="logger_8hpp.html#af5adfcda7e0a01306256754a6511915d">fc_dlog</a>( <a class="code hl_variable" href="producer__plugin_8cpp.html#adff615e9fbe43b3e6443687be568cffd">_log</a>, <span class="stringliteral">&quot;Failed trx, account: ${a}, reason: ${r}&quot;</span>,</div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span>                     (<span class="stringliteral">&quot;a&quot;</span>, n)(<span class="stringliteral">&quot;r&quot;</span>, <a class="code hl_enumeration" href="namespacefc.html#ab52b42f18c442a260897c74c66c3d35c">exception_code</a>) );</div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span>         }</div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>      }</div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span> </div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span>      <span class="keywordtype">bool</span> is_deadline()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> has_field( ex_flags, ex_fields::ex_deadline_exception ); }</div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span>      <span class="keywordtype">bool</span> is_tx_cpu_usage()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> has_field( ex_flags, ex_fields::ex_tx_cpu_usage_exceeded ); }</div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span>      <span class="keywordtype">bool</span> is_sysio_assert()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> has_field( ex_flags, ex_fields::ex_sysio_assert_exception ); }</div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span>      <span class="keywordtype">bool</span> is_other()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> has_field( ex_flags, ex_fields::ex_other_exception ); }</div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span> </div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno"><a class="line" href="producer__plugin_8cpp.html#abcd3f04fd24761496de6ea2aa0e3934d">  281</a></span>      <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="code hl_variable" href="producer__plugin_8cpp.html#abcd3f04fd24761496de6ea2aa0e3934d">num_failures</a> = 0;</div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno"><a class="line" href="producer__plugin_8cpp.html#afaa31b8b3376c7a4a9bde7ff4222a1af">  282</a></span>      <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code hl_variable" href="producer__plugin_8cpp.html#afaa31b8b3376c7a4a9bde7ff4222a1af">ex_flags</a> = 0;</div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span>   };</div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span> </div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>   std::map&lt;account_name, account_failure&gt; failed_accounts;</div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span>   <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> max_failures_per_account = 3;</div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span>   <span class="keyword">const</span> <a class="code hl_class" href="classsysio_1_1subjective__billing.html">sysio::subjective_billing</a>&amp; <a class="code hl_class" href="classsysio_1_1subjective__billing.html">subjective_billing</a>;</div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span>};</div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span> </div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span>} <span class="comment">// anonymous namespace</span></div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span> </div>
<div class="foldopen" id="foldopen00292" data-start="{" data-end="};">
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html">  292</a></span><span class="keyword">class </span><a class="code hl_class" href="classsysio_1_1producer__plugin__impl.html">producer_plugin_impl</a> : <span class="keyword">public</span> std::enable_shared_from_this&lt;producer_plugin_impl&gt; {</div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span>   <span class="keyword">public</span>:</div>
<div class="foldopen" id="foldopen00294" data-start="{" data-end="}">
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#a7b337b36d36c99e1978b0ff7086ee303">  294</a></span>      <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#a7b337b36d36c99e1978b0ff7086ee303">producer_plugin_impl</a>(boost::asio::io_service&amp; io)</div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span>      :<a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ab031fc8338d68f086c7d183e7512c9ea">_timer</a>(io)</div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span>      ,<a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#a6d12d42f012fe9fd7d0e533952498cab">_transaction_ack_channel</a>(<a class="code hl_function" href="namespaceappbase.html#a99374dc23934f008a09f2f79be9eae40">app</a>().get_channel&lt;compat::channels::transaction_ack&gt;())</div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span>      {</div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span>      }</div>
</div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span> </div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span>      std::optional&lt;fc::time_point&gt; <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#a9368777de44180b2070838ff18f2fb36">calculate_next_block_time</a>(<span class="keyword">const</span> <a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">account_name</a>&amp; <a class="code hl_function" href="programs_2sysio-launcher_2main_8cpp.html#af3e300c02a95a1230283a8ea2bb1ad70">producer_name</a>, <span class="keyword">const</span> <a class="code hl_class" href="classsysio_1_1chain_1_1block__timestamp.html">block_timestamp_type</a>&amp; current_block_time) <span class="keyword">const</span>;</div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span>      <span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#ad8895b72aaf8928b54665684ffdb9405">schedule_production_loop</a>();</div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span>      <span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#a46f5da3c1146a1e5f0850e541dac2d90">schedule_maybe_produce_block</a>( <span class="keywordtype">bool</span> <a class="code hl_enumvalue" href="classsysio_1_1producer__plugin__impl.html#a1cd329e031b1d57746ec38a44a2181bbae349d735a5fa5b10d9770031e669c477">exhausted</a> );</div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span>      <span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#a336a35581aedb4308f8fc7f4eb44f152">produce_block</a>();</div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span>      <span class="keywordtype">bool</span> <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#a230c88a6ed7efbc3588a043fe4915bd9">maybe_produce_block</a>();</div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span>      <span class="keywordtype">bool</span> <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#ab05cac0064c3afeb991b8e91cb76631e">block_is_exhausted</a>() <span class="keyword">const</span>;</div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span>      <span class="keywordtype">bool</span> <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#a07a7c896dddfa2b6c36cf67248d3599d">remove_expired_trxs</a>( <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1time__point.html">fc::time_point</a>&amp; deadline );</div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span>      <span class="keywordtype">bool</span> <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#a5b19b3db1d6db7aa9a66a6a253417d7e">remove_expired_blacklisted_trxs</a>( <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1time__point.html">fc::time_point</a>&amp; deadline );</div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span>      <span class="keywordtype">bool</span> <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#a7de28b674848c3de56118793193d3b49">process_unapplied_trxs</a>( <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1time__point.html">fc::time_point</a>&amp; deadline );</div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span>      <span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#af3690d3cd99a828ada60fcf3decad39b">process_scheduled_and_incoming_trxs</a>( <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1time__point.html">fc::time_point</a>&amp; deadline, <span class="keywordtype">size_t</span>&amp; pending_incoming_process_limit );</div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span>      <span class="keywordtype">bool</span> <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#a708986322e03db824e4bad41ca213260">process_incoming_trxs</a>( <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1time__point.html">fc::time_point</a>&amp; deadline, <span class="keywordtype">size_t</span>&amp; pending_incoming_process_limit );</div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span> </div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#ab33cc5646289fa807b2344628d1f156e">  312</a></span>      boost::program_options::variables_map <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ab33cc5646289fa807b2344628d1f156e">_options</a>;</div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#a26f51591effdca88f46913aa23308695">  313</a></span>      <span class="keywordtype">bool</span>     <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#a26f51591effdca88f46913aa23308695">_production_enabled</a>                 = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#a9992f102be5757c43dcdaedf97fb7c37">  314</a></span>      <span class="keywordtype">bool</span>     <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#a9992f102be5757c43dcdaedf97fb7c37">_pause_production</a>                   = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span> </div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#ad426992f015c5b8232753868f5edb366">  316</a></span>      <span class="keyword">using </span><a class="code hl_typedef" href="classsysio_1_1producer__plugin__impl.html#ad426992f015c5b8232753868f5edb366">signature_provider_type</a> = std::function&lt;<a class="code hl_typedef" href="namespacesysio_1_1chain.html#af141a69eb789b86fa0eb93c2d263f0df">chain::signature_type</a>(<a class="code hl_class" href="classfc_1_1sha256.html">chain::digest_type</a>)&gt;;</div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#ad9173229bf0922a5bd51150e1a95c58f">  317</a></span>      std::map&lt;chain::public_key_type, signature_provider_type&gt; <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ad9173229bf0922a5bd51150e1a95c58f">_signature_providers</a>;</div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#af2f69a8ae164570dd17a1f970ae611eb">  318</a></span>      std::set&lt;chain::account_name&gt;                             <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#af2f69a8ae164570dd17a1f970ae611eb">_producers</a>;</div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#ab031fc8338d68f086c7d183e7512c9ea">  319</a></span>      boost::asio::deadline_timer                               <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ab031fc8338d68f086c7d183e7512c9ea">_timer</a>;</div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#aef5ba3d2caaa3a9800a0cc0df02d03f7">  320</a></span>      <span class="keyword">using </span><a class="code hl_typedef" href="classsysio_1_1producer__plugin__impl.html#aef5ba3d2caaa3a9800a0cc0df02d03f7">producer_watermark</a> = std::pair&lt;uint32_t, block_timestamp_type&gt;;</div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#a56a2e3bfd17e3a5e6637d2c4d39d98e9">  321</a></span>      std::map&lt;chain::account_name, producer_watermark&gt;         <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#a56a2e3bfd17e3a5e6637d2c4d39d98e9">_producer_watermarks</a>;</div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#ae9554f576751ba3ac762b0f0c85fa5f2">  322</a></span>      <a class="code hl_enumeration" href="namespacesysio.html#acd1c637e1a22040dbf666b0301cbc475">pending_block_mode</a>                                        <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ae9554f576751ba3ac762b0f0c85fa5f2">_pending_block_mode</a> = <a class="code hl_enumvalue" href="namespacesysio.html#acd1c637e1a22040dbf666b0301cbc475aa25b9b4361a3bd215c739cf4f9cf2e4a">pending_block_mode::speculating</a>;</div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#ab9ac82b1ebcd89332e08e4246fd0a973">  323</a></span>      <a class="code hl_class" href="classsysio_1_1chain_1_1unapplied__transaction__queue.html">unapplied_transaction_queue</a>                               <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ab9ac82b1ebcd89332e08e4246fd0a973">_unapplied_transactions</a>;</div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#ac255e968852c91eee1583e4989df4173">  324</a></span>      std::optional&lt;named_thread_pool&gt;                          <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ac255e968852c91eee1583e4989df4173">_thread_pool</a>;</div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span> </div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#abfe8262ebb5c1493c44e198ad3cd79ca">  326</a></span>      std::atomic&lt;int32_t&gt;                                      <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#abfe8262ebb5c1493c44e198ad3cd79ca">_max_transaction_time_ms</a>; <span class="comment">// modified by app thread, read by net_plugin thread pool</span></div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#aad323427fd3fbc7d0decad90b324f44f">  327</a></span>      std::atomic&lt;bool&gt;                                         <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#aad323427fd3fbc7d0decad90b324f44f">_received_block</a>{<span class="keyword">false</span>}; <span class="comment">// modified by net_plugin thread pool and app thread</span></div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#adc02b8bbfdf1e85f4bf2132db2c7510f">  328</a></span>      <a class="code hl_class" href="classfc_1_1microseconds.html">fc::microseconds</a>                                          <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#adc02b8bbfdf1e85f4bf2132db2c7510f">_max_irreversible_block_age_us</a>;</div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#a8e8b31bfedc54a91987109a93d906117">  329</a></span>      <a class="code hl_typedef" href="stdint_8h.html#ab1967d8591af1a4e48c37fd2b0f184d0">int32_t</a>                                                   <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#a8e8b31bfedc54a91987109a93d906117">_produce_time_offset_us</a> = 0;</div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#aa84d793aebf28b348def7afd484a4f1a">  330</a></span>      <a class="code hl_typedef" href="stdint_8h.html#ab1967d8591af1a4e48c37fd2b0f184d0">int32_t</a>                                                   <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#aa84d793aebf28b348def7afd484a4f1a">_last_block_time_offset_us</a> = 0;</div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#ad027592bd832fc428fc2056775487276">  331</a></span>      <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>                                                  <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ad027592bd832fc428fc2056775487276">_max_block_cpu_usage_threshold_us</a> = 0;</div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#ad2cccb2f7374b5446a61dc8b7610d4d6">  332</a></span>      <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>                                                  <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ad2cccb2f7374b5446a61dc8b7610d4d6">_max_block_net_usage_threshold_bytes</a> = 0;</div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#ab2a5cd86b46f7cac1891871a40cec1c1">  333</a></span>      <a class="code hl_typedef" href="stdint_8h.html#ab1967d8591af1a4e48c37fd2b0f184d0">int32_t</a>                                                   <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ab2a5cd86b46f7cac1891871a40cec1c1">_max_scheduled_transaction_time_per_block_ms</a> = 0;</div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#a12f98c27eeff1e09ab398e9f0f158583">  334</a></span>      <span class="keywordtype">bool</span>                                                      <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#a12f98c27eeff1e09ab398e9f0f158583">_disable_persist_until_expired</a> = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#a2cc24baff7f0994410c60383929d25e8">  335</a></span>      <span class="keywordtype">bool</span>                                                      <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#a2cc24baff7f0994410c60383929d25e8">_disable_subjective_p2p_billing</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#ae781cd364031e6a3b5f890921f592eb6">  336</a></span>      <span class="keywordtype">bool</span>                                                      <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ae781cd364031e6a3b5f890921f592eb6">_disable_subjective_api_billing</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#a69e4926fe7ce9b13512a6292fe20e4d4">  337</a></span>      <a class="code hl_class" href="classfc_1_1time__point.html">fc::time_point</a>                                            <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#a69e4926fe7ce9b13512a6292fe20e4d4">_irreversible_block_time</a>;</div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#a26b02d1ebd098ea1ba2399c3c4a47046">  338</a></span>      <a class="code hl_class" href="classfc_1_1microseconds.html">fc::microseconds</a>                                          <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#a26b02d1ebd098ea1ba2399c3c4a47046">_kiod_provider_timeout_us</a>;</div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span> </div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#ab8c4a74665eea98fed5866ee31b25d5a">  340</a></span>      std::vector&lt;chain::digest_type&gt;                           <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ab8c4a74665eea98fed5866ee31b25d5a">_protocol_features_to_activate</a>;</div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#a369d1c5202c442237cb333c850f1634e">  341</a></span>      <span class="keywordtype">bool</span>                                                      <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#a369d1c5202c442237cb333c850f1634e">_protocol_features_signaled</a> = <span class="keyword">false</span>; <span class="comment">// to mark whether it has been signaled in start_block</span></div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span> </div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#ad6dd1910645f0e41a009f59fdfc09cb4">  343</a></span>      <a class="code hl_class" href="classsysio_1_1chain__plugin.html">chain_plugin</a>* <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ad6dd1910645f0e41a009f59fdfc09cb4">chain_plug</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span> </div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#a6d12d42f012fe9fd7d0e533952498cab">  345</a></span>      <a class="code hl_class" href="classappbase_1_1channel.html">compat::channels::transaction_ack::channel_type</a>&amp;        <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#a6d12d42f012fe9fd7d0e533952498cab">_transaction_ack_channel</a>;</div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span> </div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#a5d959db90832bddf418fff0e29171637">  347</a></span>      incoming::methods::block_sync::method_type::handle        <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#a5d959db90832bddf418fff0e29171637">_incoming_block_sync_provider</a>;</div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#a3c8802a7ba5739234e2d4050a1a1c2e8">  348</a></span>      incoming::methods::transaction_async::method_type::handle <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#a3c8802a7ba5739234e2d4050a1a1c2e8">_incoming_transaction_async_provider</a>;</div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span> </div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#a2146e64be3edae1b16c270ee9e0a54e5">  350</a></span>      <a class="code hl_typedef" href="namespacesysio.html#a3da8a6a29b9db34a4eb5170317d0b5a5">transaction_id_with_expiry_index</a>                         <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#a2146e64be3edae1b16c270ee9e0a54e5">_blacklisted_transactions</a>;</div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#ac8be366b39b451f59a5b2f2e4162f6cd">  351</a></span>      <a class="code hl_typedef" href="namespacesysio.html#a141379c7defda83a80367f716ab4f78b">pending_snapshot_index</a>                                   <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ac8be366b39b451f59a5b2f2e4162f6cd">_pending_snapshot_index</a>;</div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#ad44e89d30a1ce2b3abb85711d5342490">  352</a></span>      <a class="code hl_class" href="classsysio_1_1subjective__billing.html">subjective_billing</a>                                       <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ad44e89d30a1ce2b3abb85711d5342490">_subjective_billing</a>;</div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#afc937f75228984d541545dc4b59613a5">  353</a></span>      account_failures                                         <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#afc937f75228984d541545dc4b59613a5">_account_fails</a>{<a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ad44e89d30a1ce2b3abb85711d5342490">_subjective_billing</a>};</div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span> </div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#a2c7bfb29624a2f689de1ee762eba165a">  355</a></span>      std::optional&lt;scoped_connection&gt;                          <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#a2c7bfb29624a2f689de1ee762eba165a">_accepted_block_connection</a>;</div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#a7148be5020530e05d145c8ffef8569f4">  356</a></span>      std::optional&lt;scoped_connection&gt;                          <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#a7148be5020530e05d145c8ffef8569f4">_accepted_block_header_connection</a>;</div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#a2be6b35c5dbf8e84124b605f40551557">  357</a></span>      std::optional&lt;scoped_connection&gt;                          <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#a2be6b35c5dbf8e84124b605f40551557">_irreversible_block_connection</a>;</div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span> </div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span>      <span class="comment">/*</span></div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span><span class="comment">       * HACK ALERT</span></div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span><span class="comment">       * Boost timers can be in a state where a handler has not yet executed but is not abortable.</span></div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span><span class="comment">       * As this method needs to mutate state handlers depend on for proper functioning to maintain</span></div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span><span class="comment">       * invariants for other code (namely accepting incoming transactions in a nearly full block)</span></div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span><span class="comment">       * the handlers capture a corelation ID at the time they are set.  When they are executed</span></div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span><span class="comment">       * they must check that correlation_id against the global ordinal.  If it does not match that</span></div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span><span class="comment">       * implies that this method has been called with the handler in the state where it should be</span></div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span><span class="comment">       * cancelled but wasn&#39;t able to be.</span></div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span><span class="comment">       */</span></div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#a21693978cec3fac7ce203531e88c7d5a">  369</a></span>      <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#a21693978cec3fac7ce203531e88c7d5a">_timer_corelation_id</a> = 0;</div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span> </div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span>      <span class="comment">// keep a expected ratio between defer txn and incoming txn</span></div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#a67c0fb2d1c7d16bd65cd86788d74eb0a">  372</a></span>      <span class="keywordtype">double</span> <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#a67c0fb2d1c7d16bd65cd86788d74eb0a">_incoming_defer_ratio</a> = 1.0; <span class="comment">// 1:1</span></div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span> </div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span>      <span class="comment">// path to write the snapshots to</span></div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#aa3d9b96f6a6642c56f48dcd7919f1bee">  375</a></span>      bfs::path <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#aa3d9b96f6a6642c56f48dcd7919f1bee">_snapshots_dir</a>;</div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span> </div>
<div class="foldopen" id="foldopen00377" data-start="{" data-end="}">
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#ada1bb26ba6b42b4307c20c6bdb2c49b6">  377</a></span>      <span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#ada1bb26ba6b42b4307c20c6bdb2c49b6">consider_new_watermark</a>( <a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">account_name</a> producer, <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> block_num, <a class="code hl_class" href="classsysio_1_1chain_1_1block__timestamp.html">block_timestamp_type</a> timestamp) {</div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span>         <span class="keyword">auto</span> itr = <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#a56a2e3bfd17e3a5e6637d2c4d39d98e9">_producer_watermarks</a>.find( producer );</div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span>         <span class="keywordflow">if</span>( itr != <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#a56a2e3bfd17e3a5e6637d2c4d39d98e9">_producer_watermarks</a>.end() ) {</div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span>            itr-&gt;second.first = std::max( itr-&gt;second.first, block_num );</div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span>            itr-&gt;second.second = std::max( itr-&gt;second.second, timestamp );</div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span>         } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#af2f69a8ae164570dd17a1f970ae611eb">_producers</a>.count( producer ) &gt; 0 ) {</div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span>            <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#a56a2e3bfd17e3a5e6637d2c4d39d98e9">_producer_watermarks</a>.emplace( producer, std::make_pair(block_num, timestamp) );</div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span>         }</div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span>      }</div>
</div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span> </div>
<div class="foldopen" id="foldopen00387" data-start="{" data-end="}">
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#a9077b433ee5250472b5670b5b9802362">  387</a></span>      std::optional&lt;producer_watermark&gt; <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#a9077b433ee5250472b5670b5b9802362">get_watermark</a>( <a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">account_name</a> producer )<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span>         <span class="keyword">auto</span> itr = <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#a56a2e3bfd17e3a5e6637d2c4d39d98e9">_producer_watermarks</a>.find( producer );</div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span> </div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span>         <span class="keywordflow">if</span>( itr == <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#a56a2e3bfd17e3a5e6637d2c4d39d98e9">_producer_watermarks</a>.end() ) <span class="keywordflow">return</span> {};</div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span> </div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span>         <span class="keywordflow">return</span> itr-&gt;second;</div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span>      }</div>
</div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span> </div>
<div class="foldopen" id="foldopen00395" data-start="{" data-end="}">
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#a12b22968d557ea73915472d3f1d642fe">  395</a></span>      <span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#a12b22968d557ea73915472d3f1d642fe">on_block</a>( <span class="keyword">const</span> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#ab9b14f4554cc4a0da2c361e9757b1662">block_state_ptr</a>&amp; bsp ) {</div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span>         <span class="keyword">auto</span> before = <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ab9ac82b1ebcd89332e08e4246fd0a973">_unapplied_transactions</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1unapplied__transaction__queue.html#a7fb8cf5dfb622f9e619be9a4bb5eeba8">size</a>();</div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span>         <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ab9ac82b1ebcd89332e08e4246fd0a973">_unapplied_transactions</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1unapplied__transaction__queue.html#ae094df3999abc100626a5fe9f5937561">clear_applied</a>( bsp );</div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span>         <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ad44e89d30a1ce2b3abb85711d5342490">_subjective_billing</a>.<a class="code hl_function" href="classsysio_1_1subjective__billing.html#aec76b593918a0e487d607afd7a7fbe4a">on_block</a>( <a class="code hl_variable" href="producer__plugin_8cpp.html#adff615e9fbe43b3e6443687be568cffd">_log</a>, bsp, <a class="code hl_function" href="classfc_1_1time__point.html#aa164ff1268a16d4b32afcff181f6100e">fc::time_point::now</a>() );</div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span>         <a class="code hl_define" href="logger_8hpp.html#af5adfcda7e0a01306256754a6511915d">fc_dlog</a>( <a class="code hl_variable" href="producer__plugin_8cpp.html#adff615e9fbe43b3e6443687be568cffd">_log</a>, <span class="stringliteral">&quot;Removed applied transactions before: ${before}, after: ${after}&quot;</span>,</div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span>                  (<span class="stringliteral">&quot;before&quot;</span>, before)(<span class="stringliteral">&quot;after&quot;</span>, <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ab9ac82b1ebcd89332e08e4246fd0a973">_unapplied_transactions</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1unapplied__transaction__queue.html#a7fb8cf5dfb622f9e619be9a4bb5eeba8">size</a>()) );</div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span>      }</div>
</div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span> </div>
<div class="foldopen" id="foldopen00403" data-start="{" data-end="}">
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#a0a246b1d6815b521e66aa47f3ddfde22">  403</a></span>      <span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#a0a246b1d6815b521e66aa47f3ddfde22">on_block_header</a>( <span class="keyword">const</span> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#ab9b14f4554cc4a0da2c361e9757b1662">block_state_ptr</a>&amp; bsp ) {</div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span>         <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#ada1bb26ba6b42b4307c20c6bdb2c49b6">consider_new_watermark</a>( bsp-&gt;header.producer, bsp-&gt;block_num, bsp-&gt;block-&gt;timestamp );</div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span>      }</div>
</div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span> </div>
<div class="foldopen" id="foldopen00407" data-start="{" data-end="}">
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#a6362a5144896a319e360fcbab4cbe92d">  407</a></span>      <span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#a6362a5144896a319e360fcbab4cbe92d">on_irreversible_block</a>( <span class="keyword">const</span> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#aa10ee348c57604b615bc8570f6685102">signed_block_ptr</a>&amp; lib ) {</div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span>         <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#a69e4926fe7ce9b13512a6292fe20e4d4">_irreversible_block_time</a> = lib-&gt;timestamp.to_time_point();</div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span>         <span class="keyword">const</span> <a class="code hl_class" href="classsysio_1_1chain_1_1controller.html">chain::controller</a>&amp; chain = <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ad6dd1910645f0e41a009f59fdfc09cb4">chain_plug</a>-&gt;<a class="code hl_function" href="classsysio_1_1chain__plugin.html#a14a5e77b31ecf267c8062267d03440ae">chain</a>();</div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span> </div>
<div class="line"><a id="l00411" name="l00411"></a><span class="lineno">  411</span>         <span class="comment">// promote any pending snapshots</span></div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno">  412</span>         <span class="keyword">auto</span>&amp; snapshots_by_height = <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ac8be366b39b451f59a5b2f2e4162f6cd">_pending_snapshot_index</a>.get&lt;by_height&gt;();</div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span>         <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> lib_height = lib-&gt;block_num();</div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span> </div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span>         <span class="keywordflow">while</span> (!snapshots_by_height.empty() &amp;&amp; snapshots_by_height.begin()-&gt;get_height() &lt;= lib_height) {</div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span>            <span class="keyword">const</span> <span class="keyword">auto</span>&amp; pending = snapshots_by_height.begin();</div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span>            <span class="keyword">auto</span> next = pending-&gt;next;</div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span> </div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span>            <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span>               next(pending-&gt;finalize(chain));</div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span>            } <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#ab200d016fe1306acaed181b722a3cac6">CATCH_AND_CALL</a>(next);</div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span> </div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span>            snapshots_by_height.erase(snapshots_by_height.begin());</div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno">  424</span>         }</div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span>      }</div>
</div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span> </div>
<div class="foldopen" id="foldopen00427" data-start="{" data-end="}">
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#ac33726be93d621d708c02acfe7fcfd56">  427</a></span>      <span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#ac33726be93d621d708c02acfe7fcfd56">abort_block</a>() {</div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span>         <span class="keyword">auto</span>&amp; chain = <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ad6dd1910645f0e41a009f59fdfc09cb4">chain_plug</a>-&gt;<a class="code hl_function" href="classsysio_1_1chain__plugin.html#a14a5e77b31ecf267c8062267d03440ae">chain</a>();</div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span> </div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span>         <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ab9ac82b1ebcd89332e08e4246fd0a973">_unapplied_transactions</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1unapplied__transaction__queue.html#a64a6bf20ec0b7476d2fe310840dc818d">add_aborted</a>( chain.abort_block() );</div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span>         <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ad44e89d30a1ce2b3abb85711d5342490">_subjective_billing</a>.<a class="code hl_function" href="classsysio_1_1subjective__billing.html#a23d4fafb3e774be584b5e23b3510bb0d">abort_block</a>();</div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span>      }</div>
</div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span> </div>
<div class="foldopen" id="foldopen00434" data-start="{" data-end="}">
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#a9ce89d0c80f40aeb7df69c5a49beff5a">  434</a></span>      <span class="keywordtype">bool</span> <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#a9ce89d0c80f40aeb7df69c5a49beff5a">on_incoming_block</a>(<span class="keyword">const</span> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#aa10ee348c57604b615bc8570f6685102">signed_block_ptr</a>&amp; block, <span class="keyword">const</span> std::optional&lt;block_id_type&gt;&amp; block_id, <span class="keyword">const</span> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#ab9b14f4554cc4a0da2c361e9757b1662">block_state_ptr</a>&amp; bsp) {</div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span>         <span class="keyword">auto</span>&amp; chain = <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ad6dd1910645f0e41a009f59fdfc09cb4">chain_plug</a>-&gt;<a class="code hl_function" href="classsysio_1_1chain__plugin.html#a14a5e77b31ecf267c8062267d03440ae">chain</a>();</div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span>         <span class="keywordflow">if</span> ( <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ae9554f576751ba3ac762b0f0c85fa5f2">_pending_block_mode</a> == <a class="code hl_enumvalue" href="namespacesysio.html#acd1c637e1a22040dbf666b0301cbc475afd75fc8d5de6f56947b1afc9e44ddb5f">pending_block_mode::producing</a> ) {</div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span>            <a class="code hl_define" href="logger_8hpp.html#af3086372b1da6bfce45ff871734f2e8d">fc_wlog</a>( <a class="code hl_variable" href="producer__plugin_8cpp.html#adff615e9fbe43b3e6443687be568cffd">_log</a>, <span class="stringliteral">&quot;dropped incoming block #${num} id: ${id}&quot;</span>,</div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span>                     (<span class="stringliteral">&quot;num&quot;</span>, block-&gt;block_num())(<span class="stringliteral">&quot;id&quot;</span>, block_id ? (*block_id).str() : <span class="stringliteral">&quot;UNKNOWN&quot;</span>) );</div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span>         }</div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span> </div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span>         <span class="comment">// start a new speculative block, speculative start_block may have been interrupted</span></div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span>         <span class="keyword">auto</span> ensure = <a class="code hl_function" href="namespacefc.html#a23d89b54a8ffd84f7e7efeb21747d846">fc::make_scoped_exit</a>([<span class="keyword">this</span>](){</div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span>            <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#ad8895b72aaf8928b54665684ffdb9405">schedule_production_loop</a>();</div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno">  445</span>         });</div>
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno">  446</span> </div>
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno">  447</span>         <span class="keyword">const</span> <span class="keyword">auto</span>&amp; <span class="keywordtype">id</span> = block_id ? *block_id : block-&gt;calculate_id();</div>
<div class="line"><a id="l00448" name="l00448"></a><span class="lineno">  448</span>         <span class="keyword">auto</span> blk_num = block-&gt;block_num();</div>
<div class="line"><a id="l00449" name="l00449"></a><span class="lineno">  449</span> </div>
<div class="line"><a id="l00450" name="l00450"></a><span class="lineno">  450</span>         <a class="code hl_define" href="logger_8hpp.html#af5adfcda7e0a01306256754a6511915d">fc_dlog</a>(<a class="code hl_variable" href="producer__plugin_8cpp.html#adff615e9fbe43b3e6443687be568cffd">_log</a>, <span class="stringliteral">&quot;received incoming block ${n} ${id}&quot;</span>, (<span class="stringliteral">&quot;n&quot;</span>, blk_num)(<span class="stringliteral">&quot;id&quot;</span>, <span class="keywordtype">id</span>));</div>
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno">  451</span> </div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno">  452</span>         <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( block-&gt;timestamp &lt; (<a class="code hl_function" href="classfc_1_1time__point.html#aa164ff1268a16d4b32afcff181f6100e">fc::time_point::now</a>() + <a class="code hl_function" href="namespacefc.html#a9623b8cae3f48bbed6aa1fc2afe9b174">fc::seconds</a>( 7 )), block_from_the_future,</div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span>                     <span class="stringliteral">&quot;received a block from the future, ignoring it: ${id}&quot;</span>, (<span class="stringliteral">&quot;id&quot;</span>, <span class="keywordtype">id</span>) );</div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span> </div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno">  455</span>         <span class="comment">/* de-dupe here... no point in aborting block if we already know the block */</span></div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span>         <span class="keyword">auto</span> existing = chain.fetch_block_by_id( <span class="keywordtype">id</span> );</div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span>         <span class="keywordflow">if</span>( existing ) { <span class="keywordflow">return</span> <span class="keyword">false</span>; }</div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span> </div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span>         <span class="comment">// start processing of block</span></div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span>         std::future&lt;block_state_ptr&gt; <a class="code hl_function" href="xbyak__mnemonic_8h.html#a4d3d44497d76862407098986abf97b80">bsf</a>;</div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span>         <span class="keywordflow">if</span>( !bsp ) {</div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span>            <a class="code hl_function" href="xbyak__mnemonic_8h.html#a4d3d44497d76862407098986abf97b80">bsf</a> = chain.create_block_state_future( <span class="keywordtype">id</span>, block );</div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span>         }</div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno">  464</span> </div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span>         <span class="comment">// abort the pending block</span></div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno">  466</span>         <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#ac33726be93d621d708c02acfe7fcfd56">abort_block</a>();</div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno">  467</span> </div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno">  468</span>         <span class="comment">// push the new block</span></div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno">  469</span>         <span class="keyword">auto</span> handle_error = [&amp;](<span class="keyword">const</span> <span class="keyword">auto</span>&amp; e)</div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span>         {</div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno">  471</span>            <a class="code hl_define" href="logger_8hpp.html#a9e3cdbaecd5a34b42956e888f7326fad">elog</a>((e.to_detail_string()));</div>
<div class="line"><a id="l00472" name="l00472"></a><span class="lineno">  472</span>            <a class="code hl_function" href="namespaceappbase.html#a99374dc23934f008a09f2f79be9eae40">app</a>().<a class="code hl_function" href="classappbase_1_1application.html#ac9e3f923a46466ea3ffbf4fea3187682">get_channel</a>&lt;<a class="code hl_struct" href="structappbase_1_1channel__decl.html">channels::rejected_block</a>&gt;().publish( <a class="code hl_variable" href="structappbase_1_1priority.html#a89fc0f21b0f87574f0299932fc1724b4">priority::medium</a>, block );</div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno">  473</span>            <span class="keywordflow">throw</span>;</div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno">  474</span>         };</div>
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno">  475</span> </div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span>         <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno">  477</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#ab9b14f4554cc4a0da2c361e9757b1662">block_state_ptr</a>&amp; bspr = bsp ? bsp : <a class="code hl_function" href="xbyak__mnemonic_8h.html#a4d3d44497d76862407098986abf97b80">bsf</a>.get();</div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno">  478</span>            chain.push_block( bspr, [<span class="keyword">this</span>]( <span class="keyword">const</span> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#a3b287e6c2d3717609273c999ef660dea">branch_type</a>&amp; forked_branch ) {</div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno">  479</span>               <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ab9ac82b1ebcd89332e08e4246fd0a973">_unapplied_transactions</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1unapplied__transaction__queue.html#a602a769b172f4d7c3737719936f9bc78">add_forked</a>( forked_branch );</div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno">  480</span>            }, [<span class="keyword">this</span>]( <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1sha256.html">transaction_id_type</a>&amp; <a class="code hl_variable" href="code__cache_8cpp.html#aa0efefe21f4700d78692edc823e763be">id</a> ) {</div>
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno">  481</span>               <span class="keywordflow">return</span> <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ab9ac82b1ebcd89332e08e4246fd0a973">_unapplied_transactions</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1unapplied__transaction__queue.html#aeecdfc8cf255ba408c1c1a42bc83a2d8">get_trx</a>( <span class="keywordtype">id</span> );</div>
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno">  482</span>            } );</div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span>         } <span class="keywordflow">catch</span> ( <span class="keyword">const</span> <a class="code hl_variable" href="namespacesysio_1_1chain.html#a646553a6af0a730cdb19b9c6023d5132">guard_exception</a>&amp; e ) {</div>
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno">  484</span>            <a class="code hl_function" href="classsysio_1_1chain__plugin.html#a6042f76be687a9b82332f28e1dc9a3a4">chain_plugin::handle_guard_exception</a>(e);</div>
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno">  485</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00486" name="l00486"></a><span class="lineno">  486</span>         } <span class="keywordflow">catch</span> ( <span class="keyword">const</span> std::bad_alloc&amp; ) {</div>
<div class="line"><a id="l00487" name="l00487"></a><span class="lineno">  487</span>            <a class="code hl_function" href="classsysio_1_1chain__plugin.html#a9fb4d31b915fb0d2ef5392a4284b67e6">chain_plugin::handle_bad_alloc</a>();</div>
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno">  488</span>         } <span class="keywordflow">catch</span> ( boost::interprocess::bad_alloc&amp; ) {</div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno">  489</span>            <a class="code hl_function" href="classsysio_1_1chain__plugin.html#a047022d2589d7624114c1e458b111ea7">chain_plugin::handle_db_exhaustion</a>();</div>
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno">  490</span>         } <span class="keywordflow">catch</span> ( <span class="keyword">const</span> <a class="code hl_variable" href="namespacesysio_1_1chain.html#acad19c1ca23d796138841046c67b3ea9">fork_database_exception</a>&amp; e ) {</div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno">  491</span>            <a class="code hl_define" href="logger_8hpp.html#a9e3cdbaecd5a34b42956e888f7326fad">elog</a>(<span class="stringliteral">&quot;Cannot recover from ${e}. Shutting down.&quot;</span>, (<span class="stringliteral">&quot;e&quot;</span>, e.to_detail_string()));</div>
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno">  492</span>            <a class="code hl_function" href="namespaceappbase.html#a99374dc23934f008a09f2f79be9eae40">appbase::app</a>().<a class="code hl_function" href="classappbase_1_1application.html#a81aa58d3f94570b7976145039155fc46">quit</a>();</div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno">  493</span>         } <span class="keywordflow">catch</span>( <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1exception.html">fc::exception</a>&amp; e ) {</div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span>            handle_error(e);</div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno">  495</span>         } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; e) {</div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno">  496</span>            handle_error(<a class="code hl_function" href="classfc_1_1std__exception__wrapper.html#ae5ad64f84b1d373f5b92031566284c7c">fc::std_exception_wrapper::from_current_exception</a>(e));</div>
<div class="line"><a id="l00497" name="l00497"></a><span class="lineno">  497</span>         }</div>
<div class="line"><a id="l00498" name="l00498"></a><span class="lineno">  498</span> </div>
<div class="line"><a id="l00499" name="l00499"></a><span class="lineno">  499</span>         <span class="keyword">const</span> <span class="keyword">auto</span>&amp; hbs = chain.head_block_state();</div>
<div class="line"><a id="l00500" name="l00500"></a><span class="lineno">  500</span>         <span class="keywordflow">if</span>( hbs-&gt;header.timestamp.next().to_time_point() &gt;= <a class="code hl_function" href="classfc_1_1time__point.html#aa164ff1268a16d4b32afcff181f6100e">fc::time_point::now</a>() ) {</div>
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno">  501</span>            <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#a26f51591effdca88f46913aa23308695">_production_enabled</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno">  502</span>         }</div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span> </div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span>         <span class="keywordflow">if</span>( <a class="code hl_function" href="classfc_1_1time__point.html#aa164ff1268a16d4b32afcff181f6100e">fc::time_point::now</a>() - block-&gt;timestamp &lt; <a class="code hl_function" href="namespacefc.html#a9c3f2826ca2b6652fcef4da96f33503a">fc::minutes</a>(5) || (blk_num % 1000 == 0) ) {</div>
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno">  505</span>            <a class="code hl_define" href="logger_8hpp.html#a831cf08dc63704c11fd154132c6e8bdb">ilog</a>(<span class="stringliteral">&quot;Received block ${id}... #${n} @ ${t} signed by ${p} [trxs: ${count}, lib: ${lib}, conf: ${confs}, latency: ${latency} ms]&quot;</span>,</div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno">  506</span>                 (<span class="stringliteral">&quot;p&quot;</span>,block-&gt;producer)(<span class="stringliteral">&quot;id&quot;</span>,<span class="keywordtype">id</span>.str().substr(8,16))(<span class="stringliteral">&quot;n&quot;</span>,blk_num)(<span class="stringliteral">&quot;t&quot;</span>,block-&gt;timestamp)</div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span>                 (<span class="stringliteral">&quot;count&quot;</span>,block-&gt;transactions.size())(<span class="stringliteral">&quot;lib&quot;</span>,chain.last_irreversible_block_num())</div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span>                 (<span class="stringliteral">&quot;confs&quot;</span>, block-&gt;confirmed)(<span class="stringliteral">&quot;latency&quot;</span>, (<a class="code hl_function" href="classfc_1_1time__point.html#aa164ff1268a16d4b32afcff181f6100e">fc::time_point::now</a>() - block-&gt;timestamp).count()/1000 ) );</div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno">  509</span>            <span class="keywordflow">if</span>( chain.get_read_mode() != db_read_mode::IRREVERSIBLE &amp;&amp; hbs-&gt;id != <span class="keywordtype">id</span> &amp;&amp; hbs-&gt;block != <span class="keyword">nullptr</span> ) { <span class="comment">// not applied to head</span></div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span>               <a class="code hl_define" href="logger_8hpp.html#a831cf08dc63704c11fd154132c6e8bdb">ilog</a>(<span class="stringliteral">&quot;Block not applied to head ${id}... #${n} @ ${t} signed by ${p} [trxs: ${count}, dpos: ${dpos}, conf: ${confs}, latency: ${latency} ms]&quot;</span>,</div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span>                    (<span class="stringliteral">&quot;p&quot;</span>,hbs-&gt;block-&gt;producer)(<span class="stringliteral">&quot;id&quot;</span>,hbs-&gt;id.str().substr(8,16))(<span class="stringliteral">&quot;n&quot;</span>,hbs-&gt;block_num)(<span class="stringliteral">&quot;t&quot;</span>,hbs-&gt;block-&gt;timestamp)</div>
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno">  512</span>                    (<span class="stringliteral">&quot;count&quot;</span>,hbs-&gt;block-&gt;transactions.size())(<span class="stringliteral">&quot;dpos&quot;</span>, hbs-&gt;dpos_irreversible_blocknum)</div>
<div class="line"><a id="l00513" name="l00513"></a><span class="lineno">  513</span>                    (<span class="stringliteral">&quot;confs&quot;</span>, hbs-&gt;block-&gt;confirmed)(<span class="stringliteral">&quot;latency&quot;</span>, (<a class="code hl_function" href="classfc_1_1time__point.html#aa164ff1268a16d4b32afcff181f6100e">fc::time_point::now</a>() - hbs-&gt;block-&gt;timestamp).count()/1000 ) );</div>
<div class="line"><a id="l00514" name="l00514"></a><span class="lineno">  514</span>            }</div>
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno">  515</span>         }</div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span> </div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span>         <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00518" name="l00518"></a><span class="lineno">  518</span>      }</div>
</div>
<div class="line"><a id="l00519" name="l00519"></a><span class="lineno">  519</span> </div>
<div class="foldopen" id="foldopen00520" data-start="{" data-end="}">
<div class="line"><a id="l00520" name="l00520"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#ab57089953b20f4eac5adc247b73040ec">  520</a></span>      <span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#ab57089953b20f4eac5adc247b73040ec">restart_speculative_block</a>() {</div>
<div class="line"><a id="l00521" name="l00521"></a><span class="lineno">  521</span>         <a class="code hl_class" href="classsysio_1_1chain_1_1controller.html">chain::controller</a>&amp; chain = <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ad6dd1910645f0e41a009f59fdfc09cb4">chain_plug</a>-&gt;<a class="code hl_function" href="classsysio_1_1chain__plugin.html#a14a5e77b31ecf267c8062267d03440ae">chain</a>();</div>
<div class="line"><a id="l00522" name="l00522"></a><span class="lineno">  522</span>         <span class="comment">// abort the pending block</span></div>
<div class="line"><a id="l00523" name="l00523"></a><span class="lineno">  523</span>         <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ab9ac82b1ebcd89332e08e4246fd0a973">_unapplied_transactions</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1unapplied__transaction__queue.html#a64a6bf20ec0b7476d2fe310840dc818d">add_aborted</a>( chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a3079bf203cd6e26ed902a84ff3ec7856">abort_block</a>() );</div>
<div class="line"><a id="l00524" name="l00524"></a><span class="lineno">  524</span> </div>
<div class="line"><a id="l00525" name="l00525"></a><span class="lineno">  525</span>         <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#ad8895b72aaf8928b54665684ffdb9405">schedule_production_loop</a>();</div>
<div class="line"><a id="l00526" name="l00526"></a><span class="lineno">  526</span>      }</div>
</div>
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno">  527</span> </div>
<div class="foldopen" id="foldopen00528" data-start="{" data-end="}">
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#a21f33bc77d2b8ba31fd7bd4e8788d8f7">  528</a></span>      <span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#a21f33bc77d2b8ba31fd7bd4e8788d8f7">on_incoming_transaction_async</a>(<span class="keyword">const</span> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#a7041c0316bd294d0866609ab3e0cc7a7">packed_transaction_ptr</a>&amp; trx,</div>
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno">  529</span>                                         <span class="keywordtype">bool</span> persist_until_expired,</div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span>                                         <span class="keywordtype">bool</span> <a class="code hl_enumvalue" href="namespacefc.html#a3d8a2be677709cc41f09aa7925f2d55fad6bcd1364809e1b881bb22334d14cd56">read_only</a>,</div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span>                                         <span class="keywordtype">bool</span> return_failure_traces,</div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno">  532</span>                                         <a class="code hl_typedef" href="namespacesysio_1_1chain_1_1plugin__interface.html#a6ed984ecf76e4d360d5b142d27004c80">next_function&lt;transaction_trace_ptr&gt;</a> next) {</div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span>         <a class="code hl_class" href="classsysio_1_1chain_1_1controller.html">chain::controller</a>&amp; chain = <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ad6dd1910645f0e41a009f59fdfc09cb4">chain_plug</a>-&gt;<a class="code hl_function" href="classsysio_1_1chain__plugin.html#a14a5e77b31ecf267c8062267d03440ae">chain</a>();</div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span>         <span class="keyword">const</span> <span class="keyword">auto</span> max_trx_time_ms = <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#abfe8262ebb5c1493c44e198ad3cd79ca">_max_transaction_time_ms</a>.load();</div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno">  535</span>         <a class="code hl_class" href="classfc_1_1microseconds.html">fc::microseconds</a> max_trx_cpu_usage = max_trx_time_ms &lt; 0 ? <a class="code hl_function" href="classfc_1_1microseconds.html#afc3eb0bfd792c7b1cda062e559e30c2e">fc::microseconds::maximum</a>() : <a class="code hl_function" href="namespacefc.html#a76ae235ec7e9b8862e70740058d7eb1b">fc::milliseconds</a>( max_trx_time_ms );</div>
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno">  536</span> </div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span>         <span class="keyword">auto</span> future = <a class="code hl_function" href="classsysio_1_1chain_1_1transaction__metadata.html#a122861328470aa67ebf9ac5cb798755d">transaction_metadata::start_recover_keys</a>( trx, <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ac255e968852c91eee1583e4989df4173">_thread_pool</a>-&gt;get_executor(),</div>
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno">  538</span>                                                                 chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#aa62c0e462ac0a8c8b3345e59623ffad0">get_chain_id</a>(), <a class="code hl_class" href="classfc_1_1microseconds.html">fc::microseconds</a>( max_trx_cpu_usage ),</div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span>                                                                 <a class="code hl_enumvalue" href="namespacefc.html#a3d8a2be677709cc41f09aa7925f2d55fad6bcd1364809e1b881bb22334d14cd56">read_only</a> ? transaction_metadata::trx_type::read_only : transaction_metadata::trx_type::input,</div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span>                                                                 chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a701a2bfcee8df0244e1a8ac8900bc657">configured_subjective_signature_length_limit</a>() );</div>
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno">  541</span> </div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno">  542</span>         boost::asio::post(<a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ac255e968852c91eee1583e4989df4173">_thread_pool</a>-&gt;get_executor(), [<a class="code hl_enumvalue" href="namespacesysio.html#a5c18cd9d34b8c5d3af8e2de75577673fa1f42b089b0bc1105b38f19140a65cc2a">self</a> = <span class="keyword">this</span>, future{std::move(future)}, persist_until_expired, return_failure_traces,</div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span>                                                          next{std::move(next)}, trx]() <span class="keyword">mutable</span> {</div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno">  544</span>            if( future.valid() ) {</div>
<div class="line"><a id="l00545" name="l00545"></a><span class="lineno">  545</span>               future.wait();</div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno">  546</span>               app().post( priority::low, [self, future{std::move(future)}, persist_until_expired, next{std::move( next )}, trx{std::move(trx)}, return_failure_traces]() mutable {</div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno">  547</span>                  auto exception_handler = [self, &amp;next, trx{std::move(trx)}](fc::exception_ptr ex) {</div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno">  548</span>                     fc_dlog(_trx_failed_trace_log, <span class="stringliteral">&quot;[TRX_TRACE] Speculative execution is REJECTING tx: ${txid}, auth: ${a} : ${why} &quot;</span>,</div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno">  549</span>                             (<span class="stringliteral">&quot;txid&quot;</span>, trx-&gt;id())(<span class="stringliteral">&quot;a&quot;</span>,trx-&gt;get_transaction().first_authorizer())(<span class="stringliteral">&quot;why&quot;</span>,ex-&gt;what()));</div>
<div class="line"><a id="l00550" name="l00550"></a><span class="lineno">  550</span>                     next(ex);</div>
<div class="line"><a id="l00551" name="l00551"></a><span class="lineno">  551</span> </div>
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno">  552</span>                     fc_dlog(_trx_trace_failure_log, <span class="stringliteral">&quot;[TRX_TRACE] Speculative execution is REJECTING tx: ${entire_trx}&quot;</span>,</div>
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno">  553</span>                             (<span class="stringliteral">&quot;entire_trx&quot;</span>, self-&gt;chain_plug-&gt;get_log_trx(trx-&gt;get_transaction())));</div>
<div class="line"><a id="l00554" name="l00554"></a><span class="lineno">  554</span>                     fc_dlog(_trx_log, <span class="stringliteral">&quot;[TRX_TRACE] Speculative execution is REJECTING tx: ${trx}&quot;</span>,</div>
<div class="line"><a id="l00555" name="l00555"></a><span class="lineno">  555</span>                             (<span class="stringliteral">&quot;trx&quot;</span>, self-&gt;chain_plug-&gt;get_log_trx(trx-&gt;get_transaction())));</div>
<div class="line"><a id="l00556" name="l00556"></a><span class="lineno">  556</span>                  };</div>
<div class="line"><a id="l00557" name="l00557"></a><span class="lineno">  557</span>                  try {</div>
<div class="line"><a id="l00558" name="l00558"></a><span class="lineno">  558</span>                     auto result = future.get();</div>
<div class="line"><a id="l00559" name="l00559"></a><span class="lineno">  559</span>                     if( !self-&gt;process_incoming_transaction_async( result, persist_until_expired, return_failure_traces, next) ) {</div>
<div class="line"><a id="l00560" name="l00560"></a><span class="lineno">  560</span>                        if( self-&gt;_pending_block_mode == pending_block_mode::producing ) {</div>
<div class="line"><a id="l00561" name="l00561"></a><span class="lineno">  561</span>                           self-&gt;schedule_maybe_produce_block( true );</div>
<div class="line"><a id="l00562" name="l00562"></a><span class="lineno">  562</span>                        } else {</div>
<div class="line"><a id="l00563" name="l00563"></a><span class="lineno">  563</span>                           self-&gt;restart_speculative_block();</div>
<div class="line"><a id="l00564" name="l00564"></a><span class="lineno">  564</span>                        }</div>
<div class="line"><a id="l00565" name="l00565"></a><span class="lineno">  565</span>                     }</div>
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno">  566</span>                  } CATCH_AND_CALL(exception_handler);</div>
<div class="line"><a id="l00567" name="l00567"></a><span class="lineno">  567</span>               } );</div>
<div class="line"><a id="l00568" name="l00568"></a><span class="lineno">  568</span>            }</div>
<div class="line"><a id="l00569" name="l00569"></a><span class="lineno">  569</span>         });</div>
<div class="line"><a id="l00570" name="l00570"></a><span class="lineno">  570</span>      }</div>
</div>
<div class="line"><a id="l00571" name="l00571"></a><span class="lineno">  571</span> </div>
<div class="foldopen" id="foldopen00572" data-start="{" data-end="}">
<div class="line"><a id="l00572" name="l00572"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#a2347f0637a0b2f1b2a16851aa4c3ef12">  572</a></span>      <span class="keywordtype">bool</span> <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#a2347f0637a0b2f1b2a16851aa4c3ef12">process_incoming_transaction_async</a>(<span class="keyword">const</span> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#ad795329e0af850251f4f47cc32e8d770">transaction_metadata_ptr</a>&amp; trx,</div>
<div class="line"><a id="l00573" name="l00573"></a><span class="lineno">  573</span>                                              <span class="keywordtype">bool</span> persist_until_expired,</div>
<div class="line"><a id="l00574" name="l00574"></a><span class="lineno">  574</span>                                              <span class="keywordtype">bool</span> return_failure_traces,</div>
<div class="line"><a id="l00575" name="l00575"></a><span class="lineno">  575</span>                                              <a class="code hl_typedef" href="namespacesysio_1_1chain_1_1plugin__interface.html#a6ed984ecf76e4d360d5b142d27004c80">next_function&lt;transaction_trace_ptr&gt;</a> next) {</div>
<div class="line"><a id="l00576" name="l00576"></a><span class="lineno">  576</span>         <span class="keywordtype">bool</span> exhausted = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00577" name="l00577"></a><span class="lineno">  577</span>         <a class="code hl_class" href="classsysio_1_1chain_1_1controller.html">chain::controller</a>&amp; chain = chain_plug-&gt;chain();</div>
<div class="line"><a id="l00578" name="l00578"></a><span class="lineno">  578</span> </div>
<div class="line"><a id="l00579" name="l00579"></a><span class="lineno">  579</span>         <span class="keyword">auto</span> send_response = [<span class="keyword">this</span>, &amp;trx, &amp;chain, &amp;next](<span class="keyword">const</span> std::variant&lt;fc::exception_ptr, transaction_trace_ptr&gt;&amp; response) {</div>
<div class="line"><a id="l00580" name="l00580"></a><span class="lineno">  580</span>            next(response);</div>
<div class="line"><a id="l00581" name="l00581"></a><span class="lineno">  581</span> </div>
<div class="line"><a id="l00582" name="l00582"></a><span class="lineno">  582</span>            <span class="keyword">auto</span> get_trace = [&amp;](<span class="keyword">const</span> std::variant&lt;fc::exception_ptr, transaction_trace_ptr&gt;&amp; response) -&gt; <a class="code hl_class" href="classfc_1_1variant.html">fc::variant</a> {</div>
<div class="line"><a id="l00583" name="l00583"></a><span class="lineno">  583</span>               <span class="keywordflow">if</span> (std::holds_alternative&lt;fc::exception_ptr&gt;(response)) {</div>
<div class="line"><a id="l00584" name="l00584"></a><span class="lineno">  584</span>                  <span class="keywordflow">return</span> <a class="code hl_class" href="classfc_1_1variant.html">fc::variant</a>{std::get&lt;fc::exception_ptr&gt;(response)};</div>
<div class="line"><a id="l00585" name="l00585"></a><span class="lineno">  585</span>               } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00586" name="l00586"></a><span class="lineno">  586</span>                  <span class="keywordflow">return</span> chain_plug-&gt;get_log_trx_trace( std::get&lt;transaction_trace_ptr&gt;(response) );</div>
<div class="line"><a id="l00587" name="l00587"></a><span class="lineno">  587</span>               }</div>
<div class="line"><a id="l00588" name="l00588"></a><span class="lineno">  588</span> </div>
<div class="line"><a id="l00589" name="l00589"></a><span class="lineno">  589</span>            };</div>
<div class="line"><a id="l00590" name="l00590"></a><span class="lineno">  590</span> </div>
<div class="line"><a id="l00591" name="l00591"></a><span class="lineno">  591</span>            <a class="code hl_typedef" href="namespacefc.html#a15170d1be1e682691dfe6ae09790edce">fc::exception_ptr</a> except_ptr; <span class="comment">// rejected</span></div>
<div class="line"><a id="l00592" name="l00592"></a><span class="lineno">  592</span>            <span class="keywordflow">if</span> (std::holds_alternative&lt;fc::exception_ptr&gt;(response)) {</div>
<div class="line"><a id="l00593" name="l00593"></a><span class="lineno">  593</span>               except_ptr = std::get&lt;fc::exception_ptr&gt;(response);</div>
<div class="line"><a id="l00594" name="l00594"></a><span class="lineno">  594</span>            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (std::get&lt;transaction_trace_ptr&gt;(response)-&gt;except) {</div>
<div class="line"><a id="l00595" name="l00595"></a><span class="lineno">  595</span>               except_ptr = std::get&lt;transaction_trace_ptr&gt;(response)-&gt;except-&gt;dynamic_copy_exception();</div>
<div class="line"><a id="l00596" name="l00596"></a><span class="lineno">  596</span>            }</div>
<div class="line"><a id="l00597" name="l00597"></a><span class="lineno">  597</span> </div>
<div class="line"><a id="l00598" name="l00598"></a><span class="lineno">  598</span>            <span class="keywordflow">if</span> (!trx-&gt;read_only) {</div>
<div class="line"><a id="l00599" name="l00599"></a><span class="lineno">  599</span>               _transaction_ack_channel.publish(<a class="code hl_variable" href="structappbase_1_1priority.html#ae0c72abae2c2ba770667fcf90e40d654">priority::low</a>, std::pair&lt;fc::exception_ptr, packed_transaction_ptr&gt;(except_ptr, trx-&gt;packed_trx()));</div>
<div class="line"><a id="l00600" name="l00600"></a><span class="lineno">  600</span>            }</div>
<div class="line"><a id="l00601" name="l00601"></a><span class="lineno">  601</span> </div>
<div class="line"><a id="l00602" name="l00602"></a><span class="lineno">  602</span>            <span class="keywordflow">if</span> (except_ptr) {</div>
<div class="line"><a id="l00603" name="l00603"></a><span class="lineno">  603</span>               <span class="keywordflow">if</span> (_pending_block_mode == <a class="code hl_enumvalue" href="namespacesysio.html#acd1c637e1a22040dbf666b0301cbc475afd75fc8d5de6f56947b1afc9e44ddb5f">pending_block_mode::producing</a>) {</div>
<div class="line"><a id="l00604" name="l00604"></a><span class="lineno">  604</span>                  <a class="code hl_define" href="logger_8hpp.html#af5adfcda7e0a01306256754a6511915d">fc_dlog</a>(<a class="code hl_variable" href="producer__plugin_8cpp.html#ae93a86d470c7e16b50ab7102170c5d4e">_trx_failed_trace_log</a>, <span class="stringliteral">&quot;[TRX_TRACE] Block ${block_num} for producer ${prod} is REJECTING tx: ${txid}, auth: ${a} : ${why} &quot;</span>,</div>
<div class="line"><a id="l00605" name="l00605"></a><span class="lineno">  605</span>                        (<span class="stringliteral">&quot;block_num&quot;</span>, chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a33704b4936bb9bbd2ea6b0874ca521b4">head_block_num</a>() + 1)</div>
<div class="line"><a id="l00606" name="l00606"></a><span class="lineno">  606</span>                        (<span class="stringliteral">&quot;prod&quot;</span>, get_pending_block_producer())</div>
<div class="line"><a id="l00607" name="l00607"></a><span class="lineno">  607</span>                        (<span class="stringliteral">&quot;txid&quot;</span>, trx-&gt;id())</div>
<div class="line"><a id="l00608" name="l00608"></a><span class="lineno">  608</span>                        (<span class="stringliteral">&quot;a&quot;</span>, trx-&gt;packed_trx()-&gt;get_transaction().first_authorizer())</div>
<div class="line"><a id="l00609" name="l00609"></a><span class="lineno">  609</span>                        (<span class="stringliteral">&quot;why&quot;</span>, except_ptr-&gt;what()));</div>
<div class="line"><a id="l00610" name="l00610"></a><span class="lineno">  610</span>                  <a class="code hl_define" href="logger_8hpp.html#af5adfcda7e0a01306256754a6511915d">fc_dlog</a>(<a class="code hl_variable" href="producer__plugin_8cpp.html#a78396757cc70405744561b647c892edf">_trx_log</a>, <span class="stringliteral">&quot;[TRX_TRACE] Block ${block_num} for producer ${prod} is REJECTING tx: ${trx}&quot;</span>,</div>
<div class="line"><a id="l00611" name="l00611"></a><span class="lineno">  611</span>                          (<span class="stringliteral">&quot;block_num&quot;</span>, chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a33704b4936bb9bbd2ea6b0874ca521b4">head_block_num</a>() + 1)(<span class="stringliteral">&quot;prod&quot;</span>, get_pending_block_producer())</div>
<div class="line"><a id="l00612" name="l00612"></a><span class="lineno">  612</span>                                (<span class="stringliteral">&quot;trx&quot;</span>, chain_plug-&gt;get_log_trx(trx-&gt;packed_trx()-&gt;get_transaction())));</div>
<div class="line"><a id="l00613" name="l00613"></a><span class="lineno">  613</span>                  <a class="code hl_define" href="logger_8hpp.html#af5adfcda7e0a01306256754a6511915d">fc_dlog</a>(<a class="code hl_variable" href="producer__plugin_8cpp.html#a979f47bc56a17944271d72bccb834c33">_trx_trace_failure_log</a>, <span class="stringliteral">&quot;[TRX_TRACE] Block ${block_num} for producer ${prod} is REJECTING tx: ${entire_trace}&quot;</span>,</div>
<div class="line"><a id="l00614" name="l00614"></a><span class="lineno">  614</span>                          (<span class="stringliteral">&quot;block_num&quot;</span>, chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a33704b4936bb9bbd2ea6b0874ca521b4">head_block_num</a>() + 1)(<span class="stringliteral">&quot;prod&quot;</span>, get_pending_block_producer())</div>
<div class="line"><a id="l00615" name="l00615"></a><span class="lineno">  615</span>                                (<span class="stringliteral">&quot;entire_trace&quot;</span>, get_trace(response)));</div>
<div class="line"><a id="l00616" name="l00616"></a><span class="lineno">  616</span>               } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00617" name="l00617"></a><span class="lineno">  617</span>                  <a class="code hl_define" href="logger_8hpp.html#af5adfcda7e0a01306256754a6511915d">fc_dlog</a>(<a class="code hl_variable" href="producer__plugin_8cpp.html#ae93a86d470c7e16b50ab7102170c5d4e">_trx_failed_trace_log</a>, <span class="stringliteral">&quot;[TRX_TRACE] Speculative execution is REJECTING tx: ${txid}, auth: ${a} : ${why} &quot;</span>,</div>
<div class="line"><a id="l00618" name="l00618"></a><span class="lineno">  618</span>                          (<span class="stringliteral">&quot;txid&quot;</span>, trx-&gt;id())</div>
<div class="line"><a id="l00619" name="l00619"></a><span class="lineno">  619</span>                          (<span class="stringliteral">&quot;a&quot;</span>, trx-&gt;packed_trx()-&gt;get_transaction().first_authorizer())</div>
<div class="line"><a id="l00620" name="l00620"></a><span class="lineno">  620</span>                          (<span class="stringliteral">&quot;why&quot;</span>, except_ptr-&gt;what()));</div>
<div class="line"><a id="l00621" name="l00621"></a><span class="lineno">  621</span>                  <a class="code hl_define" href="logger_8hpp.html#af5adfcda7e0a01306256754a6511915d">fc_dlog</a>(<a class="code hl_variable" href="producer__plugin_8cpp.html#a78396757cc70405744561b647c892edf">_trx_log</a>, <span class="stringliteral">&quot;[TRX_TRACE] Speculative execution is REJECTING tx: ${trx} &quot;</span>,</div>
<div class="line"><a id="l00622" name="l00622"></a><span class="lineno">  622</span>                          (<span class="stringliteral">&quot;trx&quot;</span>, chain_plug-&gt;get_log_trx(trx-&gt;packed_trx()-&gt;get_transaction())));</div>
<div class="line"><a id="l00623" name="l00623"></a><span class="lineno">  623</span>                  <a class="code hl_define" href="logger_8hpp.html#af5adfcda7e0a01306256754a6511915d">fc_dlog</a>(<a class="code hl_variable" href="producer__plugin_8cpp.html#a979f47bc56a17944271d72bccb834c33">_trx_trace_failure_log</a>, <span class="stringliteral">&quot;[TRX_TRACE] Speculative execution is REJECTING tx: ${entire_trace} &quot;</span>,</div>
<div class="line"><a id="l00624" name="l00624"></a><span class="lineno">  624</span>                          (<span class="stringliteral">&quot;entire_trace&quot;</span>, get_trace(response)));</div>
<div class="line"><a id="l00625" name="l00625"></a><span class="lineno">  625</span>               }</div>
<div class="line"><a id="l00626" name="l00626"></a><span class="lineno">  626</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00627" name="l00627"></a><span class="lineno">  627</span>               <span class="keywordflow">if</span> (_pending_block_mode == <a class="code hl_enumvalue" href="namespacesysio.html#acd1c637e1a22040dbf666b0301cbc475afd75fc8d5de6f56947b1afc9e44ddb5f">pending_block_mode::producing</a>) {</div>
<div class="line"><a id="l00628" name="l00628"></a><span class="lineno">  628</span>                  <a class="code hl_define" href="logger_8hpp.html#af5adfcda7e0a01306256754a6511915d">fc_dlog</a>(<a class="code hl_variable" href="producer__plugin_8cpp.html#aea18f7b7425ddc0191447aca7c3e27f6">_trx_successful_trace_log</a>, <span class="stringliteral">&quot;[TRX_TRACE] Block ${block_num} for producer ${prod} is ACCEPTING tx: ${txid}, auth: ${a}, cpu: ${cpu}&quot;</span>,</div>
<div class="line"><a id="l00629" name="l00629"></a><span class="lineno">  629</span>                          (<span class="stringliteral">&quot;block_num&quot;</span>, chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a33704b4936bb9bbd2ea6b0874ca521b4">head_block_num</a>() + 1)</div>
<div class="line"><a id="l00630" name="l00630"></a><span class="lineno">  630</span>                          (<span class="stringliteral">&quot;prod&quot;</span>, get_pending_block_producer())</div>
<div class="line"><a id="l00631" name="l00631"></a><span class="lineno">  631</span>                          (<span class="stringliteral">&quot;txid&quot;</span>, trx-&gt;id())</div>
<div class="line"><a id="l00632" name="l00632"></a><span class="lineno">  632</span>                          (<span class="stringliteral">&quot;a&quot;</span>, trx-&gt;packed_trx()-&gt;get_transaction().first_authorizer())</div>
<div class="line"><a id="l00633" name="l00633"></a><span class="lineno">  633</span>                          (<span class="stringliteral">&quot;cpu&quot;</span>, trx-&gt;billed_cpu_time_us));</div>
<div class="line"><a id="l00634" name="l00634"></a><span class="lineno">  634</span>                  <a class="code hl_define" href="logger_8hpp.html#af5adfcda7e0a01306256754a6511915d">fc_dlog</a>(<a class="code hl_variable" href="producer__plugin_8cpp.html#a78396757cc70405744561b647c892edf">_trx_log</a>, <span class="stringliteral">&quot;[TRX_TRACE] Block ${block_num} for producer ${prod} is ACCEPTING tx: ${trx}&quot;</span>,</div>
<div class="line"><a id="l00635" name="l00635"></a><span class="lineno">  635</span>                          (<span class="stringliteral">&quot;block_num&quot;</span>, chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a33704b4936bb9bbd2ea6b0874ca521b4">head_block_num</a>() + 1)(<span class="stringliteral">&quot;prod&quot;</span>, get_pending_block_producer())</div>
<div class="line"><a id="l00636" name="l00636"></a><span class="lineno">  636</span>                                (<span class="stringliteral">&quot;trx&quot;</span>, chain_plug-&gt;get_log_trx(trx-&gt;packed_trx()-&gt;get_transaction())));</div>
<div class="line"><a id="l00637" name="l00637"></a><span class="lineno">  637</span>                   <a class="code hl_define" href="logger_8hpp.html#af5adfcda7e0a01306256754a6511915d">fc_dlog</a>(<a class="code hl_variable" href="producer__plugin_8cpp.html#a79c03faf256096a8e1ad0d59c8760d2e">_trx_trace_success_log</a>, <span class="stringliteral">&quot;[TRX_TRACE] Block ${block_num} for producer ${prod} is ACCEPTING tx: ${entire_trace}&quot;</span>,</div>
<div class="line"><a id="l00638" name="l00638"></a><span class="lineno">  638</span>                           (<span class="stringliteral">&quot;block_num&quot;</span>, chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a33704b4936bb9bbd2ea6b0874ca521b4">head_block_num</a>() + 1)(<span class="stringliteral">&quot;prod&quot;</span>, get_pending_block_producer())</div>
<div class="line"><a id="l00639" name="l00639"></a><span class="lineno">  639</span>                                   (<span class="stringliteral">&quot;entire_trace&quot;</span>, get_trace(response)));</div>
<div class="line"><a id="l00640" name="l00640"></a><span class="lineno">  640</span>               } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00641" name="l00641"></a><span class="lineno">  641</span>                  <a class="code hl_define" href="logger_8hpp.html#af5adfcda7e0a01306256754a6511915d">fc_dlog</a>(<a class="code hl_variable" href="producer__plugin_8cpp.html#aea18f7b7425ddc0191447aca7c3e27f6">_trx_successful_trace_log</a>, <span class="stringliteral">&quot;[TRX_TRACE] Speculative execution is ACCEPTING tx: ${txid}, auth: ${a}, cpu: ${cpu}&quot;</span>,</div>
<div class="line"><a id="l00642" name="l00642"></a><span class="lineno">  642</span>                          (<span class="stringliteral">&quot;txid&quot;</span>, trx-&gt;id())</div>
<div class="line"><a id="l00643" name="l00643"></a><span class="lineno">  643</span>                          (<span class="stringliteral">&quot;a&quot;</span>, trx-&gt;packed_trx()-&gt;get_transaction().first_authorizer())</div>
<div class="line"><a id="l00644" name="l00644"></a><span class="lineno">  644</span>                          (<span class="stringliteral">&quot;cpu&quot;</span>, trx-&gt;billed_cpu_time_us));</div>
<div class="line"><a id="l00645" name="l00645"></a><span class="lineno">  645</span>                   <a class="code hl_define" href="logger_8hpp.html#af5adfcda7e0a01306256754a6511915d">fc_dlog</a>(<a class="code hl_variable" href="producer__plugin_8cpp.html#a79c03faf256096a8e1ad0d59c8760d2e">_trx_trace_success_log</a>, <span class="stringliteral">&quot;[TRX_TRACE] Speculative execution is ACCEPTING tx: ${entire_trace}&quot;</span>,</div>
<div class="line"><a id="l00646" name="l00646"></a><span class="lineno">  646</span>                           (<span class="stringliteral">&quot;entire_trace&quot;</span>, get_trace(response)));</div>
<div class="line"><a id="l00647" name="l00647"></a><span class="lineno">  647</span>                  <a class="code hl_define" href="logger_8hpp.html#af5adfcda7e0a01306256754a6511915d">fc_dlog</a>(<a class="code hl_variable" href="producer__plugin_8cpp.html#a78396757cc70405744561b647c892edf">_trx_log</a>, <span class="stringliteral">&quot;[TRX_TRACE] Speculative execution is ACCEPTING tx: ${trx}&quot;</span>,</div>
<div class="line"><a id="l00648" name="l00648"></a><span class="lineno">  648</span>                          (<span class="stringliteral">&quot;trx&quot;</span>, chain_plug-&gt;get_log_trx(trx-&gt;packed_trx()-&gt;get_transaction())));</div>
<div class="line"><a id="l00649" name="l00649"></a><span class="lineno">  649</span>               }</div>
<div class="line"><a id="l00650" name="l00650"></a><span class="lineno">  650</span>            }</div>
<div class="line"><a id="l00651" name="l00651"></a><span class="lineno">  651</span>         };</div>
<div class="line"><a id="l00652" name="l00652"></a><span class="lineno">  652</span> </div>
<div class="line"><a id="l00653" name="l00653"></a><span class="lineno">  653</span>         <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l00654" name="l00654"></a><span class="lineno">  654</span>            <span class="keyword">const</span> <span class="keyword">auto</span>&amp; <span class="keywordtype">id</span> = trx-&gt;id();</div>
<div class="line"><a id="l00655" name="l00655"></a><span class="lineno">  655</span> </div>
<div class="line"><a id="l00656" name="l00656"></a><span class="lineno">  656</span>            <a class="code hl_class" href="classfc_1_1time__point.html">fc::time_point</a> <a class="code hl_function" href="xbyak__mnemonic_8h.html#a9be923ac9afe48bc98bd22e398415272">bt</a> = chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a286751cd6498b500b70a0d3678672263">is_building_block</a>() ? chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#abb1d81f96986df3bce46bd37caaf6a69">pending_block_time</a>() : chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#aea3612e7cb52dfcaa2e6afdc1b3e2f51">head_block_time</a>();</div>
<div class="line"><a id="l00657" name="l00657"></a><span class="lineno">  657</span>            <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1time__point.html">fc::time_point</a> expire = trx-&gt;packed_trx()-&gt;expiration();</div>
<div class="line"><a id="l00658" name="l00658"></a><span class="lineno">  658</span>            <span class="keywordflow">if</span>( expire &lt; <a class="code hl_function" href="xbyak__mnemonic_8h.html#a9be923ac9afe48bc98bd22e398415272">bt</a> ) {</div>
<div class="line"><a id="l00659" name="l00659"></a><span class="lineno">  659</span>               send_response( std::static_pointer_cast&lt;fc::exception&gt;(</div>
<div class="line"><a id="l00660" name="l00660"></a><span class="lineno">  660</span>                     std::make_shared&lt;expired_tx_exception&gt;(</div>
<div class="line"><a id="l00661" name="l00661"></a><span class="lineno">  661</span>                           <a class="code hl_define" href="log__message_8hpp.html#a4a4df4bb5cffbe07aadf7d29fd44c75e">FC_LOG_MESSAGE</a>( error, <span class="stringliteral">&quot;expired transaction ${id}, expiration ${e}, block time ${bt}&quot;</span>,</div>
<div class="line"><a id="l00662" name="l00662"></a><span class="lineno">  662</span>                                           (<span class="stringliteral">&quot;id&quot;</span>, <span class="keywordtype">id</span>)(<span class="stringliteral">&quot;e&quot;</span>, expire)( <span class="stringliteral">&quot;bt&quot;</span>, <a class="code hl_function" href="xbyak__mnemonic_8h.html#a9be923ac9afe48bc98bd22e398415272">bt</a> )))));</div>
<div class="line"><a id="l00663" name="l00663"></a><span class="lineno">  663</span>               <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00664" name="l00664"></a><span class="lineno">  664</span>            }</div>
<div class="line"><a id="l00665" name="l00665"></a><span class="lineno">  665</span> </div>
<div class="line"><a id="l00666" name="l00666"></a><span class="lineno">  666</span>            <span class="keywordflow">if</span>( chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#ad5e154b110a034f3a6430f7827e9c4b3">is_known_unexpired_transaction</a>( <span class="keywordtype">id</span> )) {</div>
<div class="line"><a id="l00667" name="l00667"></a><span class="lineno">  667</span>               send_response( std::static_pointer_cast&lt;fc::exception&gt;( std::make_shared&lt;tx_duplicate&gt;(</div>
<div class="line"><a id="l00668" name="l00668"></a><span class="lineno">  668</span>                     <a class="code hl_define" href="log__message_8hpp.html#a4a4df4bb5cffbe07aadf7d29fd44c75e">FC_LOG_MESSAGE</a>( error, <span class="stringliteral">&quot;duplicate transaction ${id}&quot;</span>, (<span class="stringliteral">&quot;id&quot;</span>, <span class="keywordtype">id</span>)))) );</div>
<div class="line"><a id="l00669" name="l00669"></a><span class="lineno">  669</span>               <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00670" name="l00670"></a><span class="lineno">  670</span>            }</div>
<div class="line"><a id="l00671" name="l00671"></a><span class="lineno">  671</span> </div>
<div class="line"><a id="l00672" name="l00672"></a><span class="lineno">  672</span>            <span class="keywordflow">if</span>( !chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a286751cd6498b500b70a0d3678672263">is_building_block</a>()) {</div>
<div class="line"><a id="l00673" name="l00673"></a><span class="lineno">  673</span>               _unapplied_transactions.add_incoming( trx, persist_until_expired, return_failure_traces, next );</div>
<div class="line"><a id="l00674" name="l00674"></a><span class="lineno">  674</span>               <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00675" name="l00675"></a><span class="lineno">  675</span>            }</div>
<div class="line"><a id="l00676" name="l00676"></a><span class="lineno">  676</span> </div>
<div class="line"><a id="l00677" name="l00677"></a><span class="lineno">  677</span>            <span class="keyword">auto</span> first_auth = trx-&gt;packed_trx()-&gt;get_transaction().first_authorizer();</div>
<div class="line"><a id="l00678" name="l00678"></a><span class="lineno">  678</span>            <span class="keywordflow">if</span>( _account_fails.failure_limit( first_auth ) ) {</div>
<div class="line"><a id="l00679" name="l00679"></a><span class="lineno">  679</span>               send_response( std::static_pointer_cast&lt;fc::exception&gt;( std::make_shared&lt;tx_cpu_usage_exceeded&gt;(</div>
<div class="line"><a id="l00680" name="l00680"></a><span class="lineno">  680</span>                     <a class="code hl_define" href="log__message_8hpp.html#a4a4df4bb5cffbe07aadf7d29fd44c75e">FC_LOG_MESSAGE</a>( error, <span class="stringliteral">&quot;transaction ${id} exceeded failure limit for account ${a}&quot;</span>,</div>
<div class="line"><a id="l00681" name="l00681"></a><span class="lineno">  681</span>                                     (<span class="stringliteral">&quot;id&quot;</span>, trx-&gt;id())(<span class="stringliteral">&quot;a&quot;</span>, first_auth) ) ) ) );</div>
<div class="line"><a id="l00682" name="l00682"></a><span class="lineno">  682</span>               <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00683" name="l00683"></a><span class="lineno">  683</span>            }</div>
<div class="line"><a id="l00684" name="l00684"></a><span class="lineno">  684</span> </div>
<div class="line"><a id="l00685" name="l00685"></a><span class="lineno">  685</span>            <span class="keyword">auto</span> start = <a class="code hl_function" href="classfc_1_1time__point.html#aa164ff1268a16d4b32afcff181f6100e">fc::time_point::now</a>();</div>
<div class="line"><a id="l00686" name="l00686"></a><span class="lineno">  686</span>            <a class="code hl_class" href="classfc_1_1microseconds.html">fc::microseconds</a> max_trx_time = <a class="code hl_function" href="namespacefc.html#a76ae235ec7e9b8862e70740058d7eb1b">fc::milliseconds</a>( _max_transaction_time_ms.load() );</div>
<div class="line"><a id="l00687" name="l00687"></a><span class="lineno">  687</span>            <span class="keywordflow">if</span>( max_trx_time.<a class="code hl_function" href="classfc_1_1microseconds.html#a20fba59ec7e1f50c6b8f2c9443cc9b92">count</a>() &lt; 0 ) max_trx_time = <a class="code hl_function" href="classfc_1_1microseconds.html#afc3eb0bfd792c7b1cda062e559e30c2e">fc::microseconds::maximum</a>();</div>
<div class="line"><a id="l00688" name="l00688"></a><span class="lineno">  688</span>            <span class="keyword">const</span> <span class="keyword">auto</span> block_deadline = calculate_block_deadline( chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#abb1d81f96986df3bce46bd37caaf6a69">pending_block_time</a>() );</div>
<div class="line"><a id="l00689" name="l00689"></a><span class="lineno">  689</span> </div>
<div class="line"><a id="l00690" name="l00690"></a><span class="lineno">  690</span>            <span class="keywordtype">bool</span> disable_subjective_billing = ( _pending_block_mode == <a class="code hl_enumvalue" href="namespacesysio.html#acd1c637e1a22040dbf666b0301cbc475afd75fc8d5de6f56947b1afc9e44ddb5f">pending_block_mode::producing</a> )</div>
<div class="line"><a id="l00691" name="l00691"></a><span class="lineno">  691</span>                                              || ( persist_until_expired &amp;&amp; _disable_subjective_api_billing )</div>
<div class="line"><a id="l00692" name="l00692"></a><span class="lineno">  692</span>                                              || ( !persist_until_expired &amp;&amp; _disable_subjective_p2p_billing )</div>
<div class="line"><a id="l00693" name="l00693"></a><span class="lineno">  693</span>                                              || trx-&gt;read_only;</div>
<div class="line"><a id="l00694" name="l00694"></a><span class="lineno">  694</span> </div>
<div class="line"><a id="l00695" name="l00695"></a><span class="lineno">  695</span>            <a class="code hl_typedef" href="stdint_8h.html#a414156feea104f8f75b4ed9e3121b2f6">int64_t</a> sub_bill = 0;</div>
<div class="line"><a id="l00696" name="l00696"></a><span class="lineno">  696</span>            <span class="keywordflow">if</span>( !disable_subjective_billing )</div>
<div class="line"><a id="l00697" name="l00697"></a><span class="lineno">  697</span>               sub_bill = _subjective_billing.get_subjective_bill( first_auth, <a class="code hl_function" href="classfc_1_1time__point.html#aa164ff1268a16d4b32afcff181f6100e">fc::time_point::now</a>() );</div>
<div class="line"><a id="l00698" name="l00698"></a><span class="lineno">  698</span> </div>
<div class="line"><a id="l00699" name="l00699"></a><span class="lineno">  699</span>            <span class="keyword">auto</span> prev_billed_cpu_time_us = trx-&gt;billed_cpu_time_us;</div>
<div class="line"><a id="l00700" name="l00700"></a><span class="lineno">  700</span>            <span class="keyword">auto</span> trace = chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a31c23187243554bdb6b54bb31bdb4bcd">push_transaction</a>( trx, block_deadline, max_trx_time, prev_billed_cpu_time_us, <span class="keyword">false</span>, sub_bill );</div>
<div class="line"><a id="l00701" name="l00701"></a><span class="lineno">  701</span>            <a class="code hl_define" href="logger_8hpp.html#af5adfcda7e0a01306256754a6511915d">fc_dlog</a>( <a class="code hl_variable" href="producer__plugin_8cpp.html#ae93a86d470c7e16b50ab7102170c5d4e">_trx_failed_trace_log</a>, <span class="stringliteral">&quot;Subjective bill for ${a}: ${b} elapsed ${t}us&quot;</span>, (<span class="stringliteral">&quot;a&quot;</span>,first_auth)(<span class="stringliteral">&quot;b&quot;</span>,sub_bill)(<span class="stringliteral">&quot;t&quot;</span>,trace-&gt;elapsed));</div>
<div class="line"><a id="l00702" name="l00702"></a><span class="lineno">  702</span>            <span class="keywordflow">if</span>( trace-&gt;except ) {</div>
<div class="line"><a id="l00703" name="l00703"></a><span class="lineno">  703</span>               <span class="keywordflow">if</span>( exception_is_exhausted( *trace-&gt;except ) ) {</div>
<div class="line"><a id="l00704" name="l00704"></a><span class="lineno">  704</span>                  _unapplied_transactions.add_incoming( trx, persist_until_expired, return_failure_traces, next );</div>
<div class="line"><a id="l00705" name="l00705"></a><span class="lineno">  705</span>                  <span class="keywordflow">if</span>( _pending_block_mode == <a class="code hl_enumvalue" href="namespacesysio.html#acd1c637e1a22040dbf666b0301cbc475afd75fc8d5de6f56947b1afc9e44ddb5f">pending_block_mode::producing</a> ) {</div>
<div class="line"><a id="l00706" name="l00706"></a><span class="lineno">  706</span>                     <a class="code hl_define" href="logger_8hpp.html#af5adfcda7e0a01306256754a6511915d">fc_dlog</a>(<a class="code hl_variable" href="producer__plugin_8cpp.html#ae93a86d470c7e16b50ab7102170c5d4e">_trx_failed_trace_log</a>, <span class="stringliteral">&quot;[TRX_TRACE] Block ${block_num} for producer ${prod} COULD NOT FIT, tx: ${txid} RETRYING &quot;</span>,</div>
<div class="line"><a id="l00707" name="l00707"></a><span class="lineno">  707</span>                              (<span class="stringliteral">&quot;block_num&quot;</span>, chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a33704b4936bb9bbd2ea6b0874ca521b4">head_block_num</a>() + 1)</div>
<div class="line"><a id="l00708" name="l00708"></a><span class="lineno">  708</span>                              (<span class="stringliteral">&quot;prod&quot;</span>, get_pending_block_producer())</div>
<div class="line"><a id="l00709" name="l00709"></a><span class="lineno">  709</span>                              (<span class="stringliteral">&quot;txid&quot;</span>, trx-&gt;id()));</div>
<div class="line"><a id="l00710" name="l00710"></a><span class="lineno">  710</span>                  } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00711" name="l00711"></a><span class="lineno">  711</span>                     <a class="code hl_define" href="logger_8hpp.html#af5adfcda7e0a01306256754a6511915d">fc_dlog</a>(<a class="code hl_variable" href="producer__plugin_8cpp.html#ae93a86d470c7e16b50ab7102170c5d4e">_trx_failed_trace_log</a>, <span class="stringliteral">&quot;[TRX_TRACE] Speculative execution COULD NOT FIT tx: ${txid} RETRYING&quot;</span>,</div>
<div class="line"><a id="l00712" name="l00712"></a><span class="lineno">  712</span>                              (<span class="stringliteral">&quot;txid&quot;</span>, trx-&gt;id()));</div>
<div class="line"><a id="l00713" name="l00713"></a><span class="lineno">  713</span>                  }</div>
<div class="line"><a id="l00714" name="l00714"></a><span class="lineno">  714</span>                  exhausted = block_is_exhausted();</div>
<div class="line"><a id="l00715" name="l00715"></a><span class="lineno">  715</span>               } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00716" name="l00716"></a><span class="lineno">  716</span>                   <span class="keywordflow">if</span> (!disable_subjective_billing)</div>
<div class="line"><a id="l00717" name="l00717"></a><span class="lineno">  717</span>                      _subjective_billing.subjective_bill_failure( first_auth, trace-&gt;elapsed, <a class="code hl_function" href="classfc_1_1time__point.html#aa164ff1268a16d4b32afcff181f6100e">fc::time_point::now</a>() );</div>
<div class="line"><a id="l00718" name="l00718"></a><span class="lineno">  718</span> </div>
<div class="line"><a id="l00719" name="l00719"></a><span class="lineno">  719</span>                  <span class="keywordflow">if</span>( _pending_block_mode == <a class="code hl_enumvalue" href="namespacesysio.html#acd1c637e1a22040dbf666b0301cbc475afd75fc8d5de6f56947b1afc9e44ddb5f">pending_block_mode::producing</a> ) {</div>
<div class="line"><a id="l00720" name="l00720"></a><span class="lineno">  720</span>                     <span class="keyword">auto</span> failure_code = trace-&gt;except-&gt;code();</div>
<div class="line"><a id="l00721" name="l00721"></a><span class="lineno">  721</span>                     <span class="keywordflow">if</span>( failure_code != tx_duplicate::code_value ) {</div>
<div class="line"><a id="l00722" name="l00722"></a><span class="lineno">  722</span>                        <span class="comment">// this failed our configured maximum transaction time, we don&#39;t want to replay it</span></div>
<div class="line"><a id="l00723" name="l00723"></a><span class="lineno">  723</span>                        <a class="code hl_define" href="logger_8hpp.html#af5adfcda7e0a01306256754a6511915d">fc_dlog</a>( <a class="code hl_variable" href="producer__plugin_8cpp.html#adff615e9fbe43b3e6443687be568cffd">_log</a>, <span class="stringliteral">&quot;Failed ${c} trx, prev billed: ${p}us, ran: ${r}us, id: ${id}&quot;</span>,</div>
<div class="line"><a id="l00724" name="l00724"></a><span class="lineno">  724</span>                                 (<span class="stringliteral">&quot;c&quot;</span>, trace-&gt;except-&gt;code())( <span class="stringliteral">&quot;p&quot;</span>, prev_billed_cpu_time_us )</div>
<div class="line"><a id="l00725" name="l00725"></a><span class="lineno">  725</span>                                 ( <span class="stringliteral">&quot;r&quot;</span>, <a class="code hl_function" href="classfc_1_1time__point.html#aa164ff1268a16d4b32afcff181f6100e">fc::time_point::now</a>() - start )( <span class="stringliteral">&quot;id&quot;</span>, trx-&gt;id() ) );</div>
<div class="line"><a id="l00726" name="l00726"></a><span class="lineno">  726</span>                        _account_fails.add( first_auth, failure_code );</div>
<div class="line"><a id="l00727" name="l00727"></a><span class="lineno">  727</span>                     }</div>
<div class="line"><a id="l00728" name="l00728"></a><span class="lineno">  728</span>                  }</div>
<div class="line"><a id="l00729" name="l00729"></a><span class="lineno">  729</span>                  <span class="keywordflow">if</span>( return_failure_traces ) {</div>
<div class="line"><a id="l00730" name="l00730"></a><span class="lineno">  730</span>                     send_response( trace );</div>
<div class="line"><a id="l00731" name="l00731"></a><span class="lineno">  731</span>                  } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00732" name="l00732"></a><span class="lineno">  732</span>                     <span class="keyword">auto</span> e_ptr = trace-&gt;except-&gt;dynamic_copy_exception();</div>
<div class="line"><a id="l00733" name="l00733"></a><span class="lineno">  733</span>                     send_response( e_ptr );</div>
<div class="line"><a id="l00734" name="l00734"></a><span class="lineno">  734</span>                  }</div>
<div class="line"><a id="l00735" name="l00735"></a><span class="lineno">  735</span>               }</div>
<div class="line"><a id="l00736" name="l00736"></a><span class="lineno">  736</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00737" name="l00737"></a><span class="lineno">  737</span>               <span class="keywordflow">if</span>( persist_until_expired &amp;&amp; !_disable_persist_until_expired ) {</div>
<div class="line"><a id="l00738" name="l00738"></a><span class="lineno">  738</span>                  <span class="comment">// if this trx didnt fail/soft-fail and the persist flag is set, store its ID so that we can</span></div>
<div class="line"><a id="l00739" name="l00739"></a><span class="lineno">  739</span>                  <span class="comment">// ensure its applied to all future speculative blocks as well.</span></div>
<div class="line"><a id="l00740" name="l00740"></a><span class="lineno">  740</span>                  <span class="comment">// No need to subjective bill since it will be re-applied</span></div>
<div class="line"><a id="l00741" name="l00741"></a><span class="lineno">  741</span>                  _unapplied_transactions.add_persisted( trx );</div>
<div class="line"><a id="l00742" name="l00742"></a><span class="lineno">  742</span>               } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00743" name="l00743"></a><span class="lineno">  743</span>                  <span class="comment">// if db_read_mode SPECULATIVE then trx is in the pending block and not immediately reverted</span></div>
<div class="line"><a id="l00744" name="l00744"></a><span class="lineno">  744</span>                  <span class="keywordflow">if</span> (!disable_subjective_billing)</div>
<div class="line"><a id="l00745" name="l00745"></a><span class="lineno">  745</span>                     _subjective_billing.subjective_bill( trx-&gt;id(), expire, first_auth, trace-&gt;elapsed,</div>
<div class="line"><a id="l00746" name="l00746"></a><span class="lineno">  746</span>                                                       chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a28d33629f3badcb8155c08be3e05b99e">get_read_mode</a>() == <a class="code hl_enumvalue" href="namespacesysio_1_1chain.html#af3e35f3e1b78dd00fa247009a2d9ba5ea26ca3b6826ca765f741f39ec4754d581">chain::db_read_mode::SPECULATIVE</a> );</div>
<div class="line"><a id="l00747" name="l00747"></a><span class="lineno">  747</span>               }</div>
<div class="line"><a id="l00748" name="l00748"></a><span class="lineno">  748</span>               send_response( trace );</div>
<div class="line"><a id="l00749" name="l00749"></a><span class="lineno">  749</span>            }</div>
<div class="line"><a id="l00750" name="l00750"></a><span class="lineno">  750</span> </div>
<div class="line"><a id="l00751" name="l00751"></a><span class="lineno">  751</span>         } <span class="keywordflow">catch</span> ( <span class="keyword">const</span> <a class="code hl_variable" href="namespacesysio_1_1chain.html#a646553a6af0a730cdb19b9c6023d5132">guard_exception</a>&amp; e ) {</div>
<div class="line"><a id="l00752" name="l00752"></a><span class="lineno">  752</span>            <a class="code hl_function" href="classsysio_1_1chain__plugin.html#a6042f76be687a9b82332f28e1dc9a3a4">chain_plugin::handle_guard_exception</a>(e);</div>
<div class="line"><a id="l00753" name="l00753"></a><span class="lineno">  753</span>         } <span class="keywordflow">catch</span> ( boost::interprocess::bad_alloc&amp; ) {</div>
<div class="line"><a id="l00754" name="l00754"></a><span class="lineno">  754</span>            <a class="code hl_function" href="classsysio_1_1chain__plugin.html#a047022d2589d7624114c1e458b111ea7">chain_plugin::handle_db_exhaustion</a>();</div>
<div class="line"><a id="l00755" name="l00755"></a><span class="lineno">  755</span>         } <span class="keywordflow">catch</span> ( std::bad_alloc&amp; ) {</div>
<div class="line"><a id="l00756" name="l00756"></a><span class="lineno">  756</span>            <a class="code hl_function" href="classsysio_1_1chain__plugin.html#a9fb4d31b915fb0d2ef5392a4284b67e6">chain_plugin::handle_bad_alloc</a>();</div>
<div class="line"><a id="l00757" name="l00757"></a><span class="lineno">  757</span>         } <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#ab200d016fe1306acaed181b722a3cac6">CATCH_AND_CALL</a>(send_response);</div>
<div class="line"><a id="l00758" name="l00758"></a><span class="lineno">  758</span> </div>
<div class="line"><a id="l00759" name="l00759"></a><span class="lineno">  759</span>         <span class="keywordflow">return</span> !exhausted;</div>
<div class="line"><a id="l00760" name="l00760"></a><span class="lineno">  760</span>      }</div>
</div>
<div class="line"><a id="l00761" name="l00761"></a><span class="lineno">  761</span> </div>
<div class="line"><a id="l00762" name="l00762"></a><span class="lineno">  762</span> </div>
<div class="foldopen" id="foldopen00763" data-start="{" data-end="}">
<div class="line"><a id="l00763" name="l00763"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#a03ffa5daf4ee4f47e84f8bae98bc1a00">  763</a></span>      <a class="code hl_class" href="classfc_1_1microseconds.html">fc::microseconds</a> <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#a03ffa5daf4ee4f47e84f8bae98bc1a00">get_irreversible_block_age</a>() {</div>
<div class="line"><a id="l00764" name="l00764"></a><span class="lineno">  764</span>         <span class="keyword">auto</span> now = <a class="code hl_function" href="classfc_1_1time__point.html#aa164ff1268a16d4b32afcff181f6100e">fc::time_point::now</a>();</div>
<div class="line"><a id="l00765" name="l00765"></a><span class="lineno">  765</span>         <span class="keywordflow">if</span> (now &lt; _irreversible_block_time) {</div>
<div class="line"><a id="l00766" name="l00766"></a><span class="lineno">  766</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classfc_1_1microseconds.html">fc::microseconds</a>(0);</div>
<div class="line"><a id="l00767" name="l00767"></a><span class="lineno">  767</span>         } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00768" name="l00768"></a><span class="lineno">  768</span>            <span class="keywordflow">return</span> now - _irreversible_block_time;</div>
<div class="line"><a id="l00769" name="l00769"></a><span class="lineno">  769</span>         }</div>
<div class="line"><a id="l00770" name="l00770"></a><span class="lineno">  770</span>      }</div>
</div>
<div class="line"><a id="l00771" name="l00771"></a><span class="lineno">  771</span> </div>
<div class="foldopen" id="foldopen00772" data-start="{" data-end="}">
<div class="line"><a id="l00772" name="l00772"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#afdc86b3838b1e0bc2d6667f9123d633e">  772</a></span>      <a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">account_name</a> <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#afdc86b3838b1e0bc2d6667f9123d633e">get_pending_block_producer</a>() {</div>
<div class="line"><a id="l00773" name="l00773"></a><span class="lineno">  773</span>         <span class="keyword">auto</span>&amp; chain = chain_plug-&gt;chain();</div>
<div class="line"><a id="l00774" name="l00774"></a><span class="lineno">  774</span>         <span class="keywordflow">if</span> (chain.is_building_block()) {</div>
<div class="line"><a id="l00775" name="l00775"></a><span class="lineno">  775</span>            <span class="keywordflow">return</span> chain.pending_block_producer();</div>
<div class="line"><a id="l00776" name="l00776"></a><span class="lineno">  776</span>         } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00777" name="l00777"></a><span class="lineno">  777</span>            <span class="keywordflow">return</span> {};</div>
<div class="line"><a id="l00778" name="l00778"></a><span class="lineno">  778</span>         }</div>
<div class="line"><a id="l00779" name="l00779"></a><span class="lineno">  779</span>      }</div>
</div>
<div class="line"><a id="l00780" name="l00780"></a><span class="lineno">  780</span> </div>
<div class="foldopen" id="foldopen00781" data-start="{" data-end="}">
<div class="line"><a id="l00781" name="l00781"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#a7964ed6135deaf78fe51442d0fde20f5">  781</a></span>      <span class="keywordtype">bool</span> <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#a7964ed6135deaf78fe51442d0fde20f5">production_disabled_by_policy</a>() {</div>
<div class="line"><a id="l00782" name="l00782"></a><span class="lineno">  782</span>         <span class="keywordflow">return</span> !_production_enabled || _pause_production || (_max_irreversible_block_age_us.count() &gt;= 0 &amp;&amp; get_irreversible_block_age() &gt;= _max_irreversible_block_age_us);</div>
<div class="line"><a id="l00783" name="l00783"></a><span class="lineno">  783</span>      }</div>
</div>
<div class="line"><a id="l00784" name="l00784"></a><span class="lineno">  784</span> </div>
<div class="foldopen" id="foldopen00785" data-start="{" data-end="};">
<div class="line"><a id="l00785" name="l00785"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#a1cd329e031b1d57746ec38a44a2181bb">  785</a></span>      <span class="keyword">enum class</span> <a class="code hl_enumeration" href="classsysio_1_1producer__plugin__impl.html#a1cd329e031b1d57746ec38a44a2181bb">start_block_result</a> {</div>
<div class="line"><a id="l00786" name="l00786"></a><span class="lineno">  786</span>         succeeded,</div>
<div class="line"><a id="l00787" name="l00787"></a><span class="lineno">  787</span>         failed,</div>
<div class="line"><a id="l00788" name="l00788"></a><span class="lineno">  788</span>         waiting_for_block,</div>
<div class="line"><a id="l00789" name="l00789"></a><span class="lineno">  789</span>         waiting_for_production,</div>
<div class="line"><a id="l00790" name="l00790"></a><span class="lineno">  790</span>         exhausted</div>
<div class="line"><a id="l00791" name="l00791"></a><span class="lineno">  791</span>      };</div>
</div>
<div class="line"><a id="l00792" name="l00792"></a><span class="lineno">  792</span> </div>
<div class="line"><a id="l00793" name="l00793"></a><span class="lineno">  793</span>      <span class="keyword">inline</span> <span class="keywordtype">bool</span> should_interrupt_start_block( <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1time__point.html">fc::time_point</a>&amp; deadline ) <span class="keyword">const</span>;</div>
<div class="line"><a id="l00794" name="l00794"></a><span class="lineno">  794</span>      start_block_result start_block();</div>
<div class="line"><a id="l00795" name="l00795"></a><span class="lineno">  795</span> </div>
<div class="line"><a id="l00796" name="l00796"></a><span class="lineno">  796</span>      <a class="code hl_class" href="classfc_1_1time__point.html">fc::time_point</a> calculate_pending_block_time() <span class="keyword">const</span>;</div>
<div class="line"><a id="l00797" name="l00797"></a><span class="lineno">  797</span>      <a class="code hl_class" href="classfc_1_1time__point.html">fc::time_point</a> calculate_block_deadline( <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1time__point.html">fc::time_point</a>&amp; ) <span class="keyword">const</span>;</div>
<div class="line"><a id="l00798" name="l00798"></a><span class="lineno">  798</span>      <span class="keywordtype">void</span> schedule_delayed_production_loop(<span class="keyword">const</span> std::weak_ptr&lt;producer_plugin_impl&gt;&amp; weak_this, std::optional&lt;fc::time_point&gt; wake_up_time);</div>
<div class="line"><a id="l00799" name="l00799"></a><span class="lineno">  799</span>      std::optional&lt;fc::time_point&gt; calculate_producer_wake_up_time( <span class="keyword">const</span> <a class="code hl_class" href="classsysio_1_1chain_1_1block__timestamp.html">block_timestamp_type</a>&amp; ref_block_time ) <span class="keyword">const</span>;</div>
<div class="line"><a id="l00800" name="l00800"></a><span class="lineno">  800</span> </div>
<div class="line"><a id="l00801" name="l00801"></a><span class="lineno">  801</span>};</div>
</div>
<div class="line"><a id="l00802" name="l00802"></a><span class="lineno">  802</span> </div>
<div class="foldopen" id="foldopen00803" data-start="{" data-end="}">
<div class="line"><a id="l00803" name="l00803"></a><span class="lineno"><a class="line" href="namespacesysio.html#ae6b502dce0e50dbe3d9ee47f1ba720d1">  803</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="namespacesysio.html#ae6b502dce0e50dbe3d9ee47f1ba720d1">new_chain_banner</a>(<span class="keyword">const</span> <a class="code hl_class" href="classsysio_1_1chain_1_1controller.html">sysio::chain::controller</a>&amp; db)</div>
<div class="line"><a id="l00804" name="l00804"></a><span class="lineno">  804</span>{</div>
<div class="line"><a id="l00805" name="l00805"></a><span class="lineno">  805</span>   std::cerr &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a id="l00806" name="l00806"></a><span class="lineno">  806</span>      <span class="stringliteral">&quot;*******************************\n&quot;</span></div>
<div class="line"><a id="l00807" name="l00807"></a><span class="lineno">  807</span>      <span class="stringliteral">&quot;*                             *\n&quot;</span></div>
<div class="line"><a id="l00808" name="l00808"></a><span class="lineno">  808</span>      <span class="stringliteral">&quot;*   ------ NEW CHAIN ------   *\n&quot;</span></div>
<div class="line"><a id="l00809" name="l00809"></a><span class="lineno">  809</span>      <span class="stringliteral">&quot;*   -  Welcome to SYSIO!  -   *\n&quot;</span></div>
<div class="line"><a id="l00810" name="l00810"></a><span class="lineno">  810</span>      <span class="stringliteral">&quot;*   -----------------------   *\n&quot;</span></div>
<div class="line"><a id="l00811" name="l00811"></a><span class="lineno">  811</span>      <span class="stringliteral">&quot;*                             *\n&quot;</span></div>
<div class="line"><a id="l00812" name="l00812"></a><span class="lineno">  812</span>      <span class="stringliteral">&quot;*******************************\n&quot;</span></div>
<div class="line"><a id="l00813" name="l00813"></a><span class="lineno">  813</span>      <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00814" name="l00814"></a><span class="lineno">  814</span> </div>
<div class="line"><a id="l00815" name="l00815"></a><span class="lineno">  815</span>   <span class="keywordflow">if</span>( db.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a3e445e8e2da032a322a1348091a1a702">head_block_state</a>()-&gt;header.timestamp.to_time_point() &lt; (<a class="code hl_function" href="classfc_1_1time__point.html#aa164ff1268a16d4b32afcff181f6100e">fc::time_point::now</a>() - <a class="code hl_function" href="namespacefc.html#a76ae235ec7e9b8862e70740058d7eb1b">fc::milliseconds</a>(200 * config::block_interval_ms)))</div>
<div class="line"><a id="l00816" name="l00816"></a><span class="lineno">  816</span>   {</div>
<div class="line"><a id="l00817" name="l00817"></a><span class="lineno">  817</span>      std::cerr &lt;&lt; <span class="stringliteral">&quot;Your genesis seems to have an old timestamp\n&quot;</span></div>
<div class="line"><a id="l00818" name="l00818"></a><span class="lineno">  818</span>         <span class="stringliteral">&quot;Please consider using the --genesis-timestamp option to give your genesis a recent timestamp\n&quot;</span></div>
<div class="line"><a id="l00819" name="l00819"></a><span class="lineno">  819</span>         <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a id="l00820" name="l00820"></a><span class="lineno">  820</span>         ;</div>
<div class="line"><a id="l00821" name="l00821"></a><span class="lineno">  821</span>   }</div>
<div class="line"><a id="l00822" name="l00822"></a><span class="lineno">  822</span>   <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00823" name="l00823"></a><span class="lineno">  823</span>}</div>
</div>
<div class="line"><a id="l00824" name="l00824"></a><span class="lineno">  824</span> </div>
<div class="foldopen" id="foldopen00825" data-start="{" data-end="}">
<div class="line"><a id="l00825" name="l00825"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin.html#a306331a85410d5dd4c22f9910b1e8d01">  825</a></span>producer_plugin::producer_plugin()</div>
<div class="line"><a id="l00826" name="l00826"></a><span class="lineno">  826</span>   : my(new <a class="code hl_class" href="classsysio_1_1producer__plugin__impl.html">producer_plugin_impl</a>(<a class="code hl_function" href="namespaceappbase.html#a99374dc23934f008a09f2f79be9eae40">app</a>().get_io_service())){</div>
<div class="line"><a id="l00827" name="l00827"></a><span class="lineno">  827</span>   }</div>
</div>
<div class="line"><a id="l00828" name="l00828"></a><span class="lineno">  828</span> </div>
<div class="line"><a id="l00829" name="l00829"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin.html#aa5393e35f92140aed36471f88a9ed524">  829</a></span><a class="code hl_function" href="classsysio_1_1producer__plugin.html#aa5393e35f92140aed36471f88a9ed524">producer_plugin::~producer_plugin</a>() {}</div>
<div class="line"><a id="l00830" name="l00830"></a><span class="lineno">  830</span> </div>
<div class="foldopen" id="foldopen00831" data-start="{" data-end="}">
<div class="line"><a id="l00831" name="l00831"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin.html#a41c230f97593dcff3934fb6b6b254536">  831</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1producer__plugin.html#a41c230f97593dcff3934fb6b6b254536">producer_plugin::set_program_options</a>(</div>
<div class="line"><a id="l00832" name="l00832"></a><span class="lineno">  832</span>   boost::program_options::options_description&amp; command_line_options,</div>
<div class="line"><a id="l00833" name="l00833"></a><span class="lineno">  833</span>   boost::program_options::options_description&amp; config_file_options)</div>
<div class="line"><a id="l00834" name="l00834"></a><span class="lineno">  834</span>{</div>
<div class="line"><a id="l00835" name="l00835"></a><span class="lineno">  835</span>   <span class="keyword">auto</span> default_priv_key = <a class="code hl_function" href="classfc_1_1crypto_1_1private__key.html#a89f09f5b110de0d285808f12fa8d0af2">private_key_type::regenerate&lt;fc::ecc::private_key_shim&gt;</a>(<a class="code hl_function" href="classfc_1_1sha256.html#a474784de7d6213b855abd7e952df5e36">fc::sha256::hash</a>(std::string(<span class="stringliteral">&quot;nathan&quot;</span>)));</div>
<div class="line"><a id="l00836" name="l00836"></a><span class="lineno">  836</span>   <span class="keyword">auto</span> private_key_default = std::make_pair(default_priv_key.get_public_key(), default_priv_key );</div>
<div class="line"><a id="l00837" name="l00837"></a><span class="lineno">  837</span> </div>
<div class="line"><a id="l00838" name="l00838"></a><span class="lineno">  838</span>   boost::program_options::options_description producer_options;</div>
<div class="line"><a id="l00839" name="l00839"></a><span class="lineno">  839</span> </div>
<div class="line"><a id="l00840" name="l00840"></a><span class="lineno">  840</span>   producer_options.add_options()</div>
<div class="line"><a id="l00841" name="l00841"></a><span class="lineno">  841</span>         (<span class="stringliteral">&quot;enable-stale-production,e&quot;</span>, boost::program_options::bool_switch()-&gt;notifier([<span class="keyword">this</span>](<span class="keywordtype">bool</span> e){my-&gt;_production_enabled = e;}), <span class="stringliteral">&quot;Enable block production, even if the chain is stale.&quot;</span>)</div>
<div class="line"><a id="l00842" name="l00842"></a><span class="lineno">  842</span>         (<span class="stringliteral">&quot;pause-on-startup,x&quot;</span>, boost::program_options::bool_switch()-&gt;notifier([<span class="keyword">this</span>](<span class="keywordtype">bool</span> <a class="code hl_variable" href="bn_8cpp.html#a8b0eadcc506862e9d751ab45185053aa">p</a>){my-&gt;_pause_production = <a class="code hl_variable" href="bn_8cpp.html#a8b0eadcc506862e9d751ab45185053aa">p</a>;}), <span class="stringliteral">&quot;Start this node in a state where production is paused&quot;</span>)</div>
<div class="line"><a id="l00843" name="l00843"></a><span class="lineno">  843</span>         (<span class="stringliteral">&quot;max-transaction-time&quot;</span>, bpo::value&lt;int32_t&gt;()-&gt;default_value(30),</div>
<div class="line"><a id="l00844" name="l00844"></a><span class="lineno">  844</span>          <span class="stringliteral">&quot;Limits the maximum time (in milliseconds) that is allowed a pushed transaction&#39;s code to execute before being considered invalid&quot;</span>)</div>
<div class="line"><a id="l00845" name="l00845"></a><span class="lineno">  845</span>         (<span class="stringliteral">&quot;max-irreversible-block-age&quot;</span>, bpo::value&lt;int32_t&gt;()-&gt;default_value( -1 ),</div>
<div class="line"><a id="l00846" name="l00846"></a><span class="lineno">  846</span>          <span class="stringliteral">&quot;Limits the maximum age (in seconds) of the DPOS Irreversible Block for a chain this node will produce blocks on (use negative value to indicate unlimited)&quot;</span>)</div>
<div class="line"><a id="l00847" name="l00847"></a><span class="lineno">  847</span>         (<span class="stringliteral">&quot;producer-name,p&quot;</span>, boost::program_options::value&lt;vector&lt;string&gt;&gt;()-&gt;composing()-&gt;multitoken(),</div>
<div class="line"><a id="l00848" name="l00848"></a><span class="lineno">  848</span>          <span class="stringliteral">&quot;ID of producer controlled by this node (e.g. inita; may specify multiple times)&quot;</span>)</div>
<div class="line"><a id="l00849" name="l00849"></a><span class="lineno">  849</span>         (<span class="stringliteral">&quot;private-key&quot;</span>, boost::program_options::value&lt;vector&lt;string&gt;&gt;()-&gt;composing()-&gt;multitoken(),</div>
<div class="line"><a id="l00850" name="l00850"></a><span class="lineno">  850</span>          <span class="stringliteral">&quot;(DEPRECATED - Use signature-provider instead) Tuple of [public key, WIF private key] (may specify multiple times)&quot;</span>)</div>
<div class="line"><a id="l00851" name="l00851"></a><span class="lineno">  851</span>         (<span class="stringliteral">&quot;signature-provider&quot;</span>, boost::program_options::value&lt;vector&lt;string&gt;&gt;()-&gt;composing()-&gt;multitoken()-&gt;default_value(</div>
<div class="line"><a id="l00852" name="l00852"></a><span class="lineno">  852</span>               {default_priv_key.get_public_key().to_string() + <span class="stringliteral">&quot;=KEY:&quot;</span> + default_priv_key.to_string()},</div>
<div class="line"><a id="l00853" name="l00853"></a><span class="lineno">  853</span>                default_priv_key.get_public_key().<a class="code hl_function" href="namespacefc.html#a4e07b3870aa72f8c38bdd5f78044dad1">to_string</a>() + <span class="stringliteral">&quot;=KEY:&quot;</span> + default_priv_key.to_string()),</div>
<div class="line"><a id="l00854" name="l00854"></a><span class="lineno">  854</span>          <span class="stringliteral">&quot;Key=Value pairs in the form &lt;public-key&gt;=&lt;provider-spec&gt;\n&quot;</span></div>
<div class="line"><a id="l00855" name="l00855"></a><span class="lineno">  855</span>          <span class="stringliteral">&quot;Where:\n&quot;</span></div>
<div class="line"><a id="l00856" name="l00856"></a><span class="lineno">  856</span>          <span class="stringliteral">&quot;   &lt;public-key&gt;    \tis a string form of a vaild SYSIO public key\n\n&quot;</span></div>
<div class="line"><a id="l00857" name="l00857"></a><span class="lineno">  857</span>          <span class="stringliteral">&quot;   &lt;provider-spec&gt; \tis a string in the form &lt;provider-type&gt;:&lt;data&gt;\n\n&quot;</span></div>
<div class="line"><a id="l00858" name="l00858"></a><span class="lineno">  858</span>          <span class="stringliteral">&quot;   &lt;provider-type&gt; \tis KEY, or KSYSD\n\n&quot;</span></div>
<div class="line"><a id="l00859" name="l00859"></a><span class="lineno">  859</span>          <span class="stringliteral">&quot;   KEY:&lt;data&gt;      \tis a string form of a valid SYSIO private key which maps to the provided public key\n\n&quot;</span></div>
<div class="line"><a id="l00860" name="l00860"></a><span class="lineno">  860</span>          <span class="stringliteral">&quot;   KSYSD:&lt;data&gt;    \tis the URL where kiod is available and the approptiate wallet(s) are unlocked&quot;</span>)</div>
<div class="line"><a id="l00861" name="l00861"></a><span class="lineno">  861</span>         (<span class="stringliteral">&quot;kiod-provider-timeout&quot;</span>, boost::program_options::value&lt;int32_t&gt;()-&gt;default_value(5),</div>
<div class="line"><a id="l00862" name="l00862"></a><span class="lineno">  862</span>          <span class="stringliteral">&quot;Limits the maximum time (in milliseconds) that is allowed for sending blocks to a kiod provider for signing&quot;</span>)</div>
<div class="line"><a id="l00863" name="l00863"></a><span class="lineno">  863</span>         (<span class="stringliteral">&quot;greylist-account&quot;</span>, boost::program_options::value&lt;<a class="code hl_class" href="classfc_1_1vector.html">vector&lt;string&gt;</a>&gt;()-&gt;composing()-&gt;multitoken(),</div>
<div class="line"><a id="l00864" name="l00864"></a><span class="lineno">  864</span>          <span class="stringliteral">&quot;account that can not access to extended CPU/NET virtual resources&quot;</span>)</div>
<div class="line"><a id="l00865" name="l00865"></a><span class="lineno">  865</span>         (<span class="stringliteral">&quot;greylist-limit&quot;</span>, boost::program_options::value&lt;uint32_t&gt;()-&gt;default_value(1000),</div>
<div class="line"><a id="l00866" name="l00866"></a><span class="lineno">  866</span>          <span class="stringliteral">&quot;Limit (between 1 and 1000) on the multiple that CPU/NET virtual resources can extend during low usage (only enforced subjectively; use 1000 to not enforce any limit)&quot;</span>)</div>
<div class="line"><a id="l00867" name="l00867"></a><span class="lineno">  867</span>         (<span class="stringliteral">&quot;produce-time-offset-us&quot;</span>, boost::program_options::value&lt;int32_t&gt;()-&gt;default_value(0),</div>
<div class="line"><a id="l00868" name="l00868"></a><span class="lineno">  868</span>          <span class="stringliteral">&quot;Offset of non last block producing time in microseconds. Valid range 0 .. -block_time_interval.&quot;</span>)</div>
<div class="line"><a id="l00869" name="l00869"></a><span class="lineno">  869</span>         (<span class="stringliteral">&quot;last-block-time-offset-us&quot;</span>, boost::program_options::value&lt;int32_t&gt;()-&gt;default_value(-200000),</div>
<div class="line"><a id="l00870" name="l00870"></a><span class="lineno">  870</span>          <span class="stringliteral">&quot;Offset of last block producing time in microseconds. Valid range 0 .. -block_time_interval.&quot;</span>)</div>
<div class="line"><a id="l00871" name="l00871"></a><span class="lineno">  871</span>         (<span class="stringliteral">&quot;cpu-effort-percent&quot;</span>, bpo::value&lt;uint32_t&gt;()-&gt;default_value(config::default_block_cpu_effort_pct / config::percent_1),</div>
<div class="line"><a id="l00872" name="l00872"></a><span class="lineno">  872</span>          <span class="stringliteral">&quot;Percentage of cpu block production time used to produce block. Whole number percentages, e.g. 80 for 80%&quot;</span>)</div>
<div class="line"><a id="l00873" name="l00873"></a><span class="lineno">  873</span>         (<span class="stringliteral">&quot;last-block-cpu-effort-percent&quot;</span>, bpo::value&lt;uint32_t&gt;()-&gt;default_value(config::default_block_cpu_effort_pct / config::percent_1),</div>
<div class="line"><a id="l00874" name="l00874"></a><span class="lineno">  874</span>          <span class="stringliteral">&quot;Percentage of cpu block production time used to produce last block. Whole number percentages, e.g. 80 for 80%&quot;</span>)</div>
<div class="line"><a id="l00875" name="l00875"></a><span class="lineno">  875</span>         (<span class="stringliteral">&quot;max-block-cpu-usage-threshold-us&quot;</span>, bpo::value&lt;uint32_t&gt;()-&gt;default_value( 5000 ),</div>
<div class="line"><a id="l00876" name="l00876"></a><span class="lineno">  876</span>          <span class="stringliteral">&quot;Threshold of CPU block production to consider block full; when within threshold of max-block-cpu-usage block can be produced immediately&quot;</span>)</div>
<div class="line"><a id="l00877" name="l00877"></a><span class="lineno">  877</span>         (<span class="stringliteral">&quot;max-block-net-usage-threshold-bytes&quot;</span>, bpo::value&lt;uint32_t&gt;()-&gt;default_value( 1024 ),</div>
<div class="line"><a id="l00878" name="l00878"></a><span class="lineno">  878</span>          <span class="stringliteral">&quot;Threshold of NET block production to consider block full; when within threshold of max-block-net-usage block can be produced immediately&quot;</span>)</div>
<div class="line"><a id="l00879" name="l00879"></a><span class="lineno">  879</span>         (<span class="stringliteral">&quot;max-scheduled-transaction-time-per-block-ms&quot;</span>, boost::program_options::value&lt;int32_t&gt;()-&gt;default_value(100),</div>
<div class="line"><a id="l00880" name="l00880"></a><span class="lineno">  880</span>          <span class="stringliteral">&quot;Maximum wall-clock time, in milliseconds, spent retiring scheduled transactions in any block before returning to normal transaction processing.&quot;</span>)</div>
<div class="line"><a id="l00881" name="l00881"></a><span class="lineno">  881</span>         (<span class="stringliteral">&quot;subjective-cpu-leeway-us&quot;</span>, boost::program_options::value&lt;int32_t&gt;()-&gt;default_value( config::default_subjective_cpu_leeway_us ),</div>
<div class="line"><a id="l00882" name="l00882"></a><span class="lineno">  882</span>          <span class="stringliteral">&quot;Time in microseconds allowed for a transaction that starts with insufficient CPU quota to complete and cover its CPU usage.&quot;</span>)</div>
<div class="line"><a id="l00883" name="l00883"></a><span class="lineno">  883</span>         (<span class="stringliteral">&quot;subjective-account-max-failures&quot;</span>, boost::program_options::value&lt;uint32_t&gt;()-&gt;default_value(3),</div>
<div class="line"><a id="l00884" name="l00884"></a><span class="lineno">  884</span>          <span class="stringliteral">&quot;Sets the maximum amount of failures that are allowed for a given account per block.&quot;</span>)</div>
<div class="line"><a id="l00885" name="l00885"></a><span class="lineno">  885</span>         (<span class="stringliteral">&quot;subjective-account-decay-time-minutes&quot;</span>, bpo::value&lt;uint32_t&gt;()-&gt;default_value( config::account_cpu_usage_average_window_ms / 1000 / 60 ),</div>
<div class="line"><a id="l00886" name="l00886"></a><span class="lineno">  886</span>          <span class="stringliteral">&quot;Sets the time to return full subjective cpu for accounts&quot;</span>)</div>
<div class="line"><a id="l00887" name="l00887"></a><span class="lineno">  887</span>         (<span class="stringliteral">&quot;incoming-defer-ratio&quot;</span>, bpo::value&lt;double&gt;()-&gt;default_value(1.0),</div>
<div class="line"><a id="l00888" name="l00888"></a><span class="lineno">  888</span>          <span class="stringliteral">&quot;ratio between incoming transactions and deferred transactions when both are queued for execution&quot;</span>)</div>
<div class="line"><a id="l00889" name="l00889"></a><span class="lineno">  889</span>         (<span class="stringliteral">&quot;incoming-transaction-queue-size-mb&quot;</span>, bpo::value&lt;uint16_t&gt;()-&gt;default_value( 1024 ),</div>
<div class="line"><a id="l00890" name="l00890"></a><span class="lineno">  890</span>          <span class="stringliteral">&quot;Maximum size (in MiB) of the incoming transaction queue. Exceeding this value will subjectively drop transaction with resource exhaustion.&quot;</span>)</div>
<div class="line"><a id="l00891" name="l00891"></a><span class="lineno">  891</span>         (<span class="stringliteral">&quot;disable-api-persisted-trx&quot;</span>, bpo::bool_switch()-&gt;default_value(<span class="keyword">false</span>),</div>
<div class="line"><a id="l00892" name="l00892"></a><span class="lineno">  892</span>          <span class="stringliteral">&quot;Disable the re-apply of API transactions.&quot;</span>)</div>
<div class="line"><a id="l00893" name="l00893"></a><span class="lineno">  893</span>         (<span class="stringliteral">&quot;disable-subjective-billing&quot;</span>, bpo::value&lt;bool&gt;()-&gt;default_value(<span class="keyword">true</span>),</div>
<div class="line"><a id="l00894" name="l00894"></a><span class="lineno">  894</span>          <span class="stringliteral">&quot;Disable subjective CPU billing for API/P2P transactions&quot;</span>)</div>
<div class="line"><a id="l00895" name="l00895"></a><span class="lineno">  895</span>         (<span class="stringliteral">&quot;disable-subjective-account-billing&quot;</span>, boost::program_options::value&lt;<a class="code hl_class" href="classfc_1_1vector.html">vector&lt;string&gt;</a>&gt;()-&gt;composing()-&gt;multitoken(),</div>
<div class="line"><a id="l00896" name="l00896"></a><span class="lineno">  896</span>          <span class="stringliteral">&quot;Account which is excluded from subjective CPU billing&quot;</span>)</div>
<div class="line"><a id="l00897" name="l00897"></a><span class="lineno">  897</span>         (<span class="stringliteral">&quot;disable-subjective-p2p-billing&quot;</span>, bpo::value&lt;bool&gt;()-&gt;default_value(<span class="keyword">true</span>),</div>
<div class="line"><a id="l00898" name="l00898"></a><span class="lineno">  898</span>          <span class="stringliteral">&quot;Disable subjective CPU billing for P2P transactions&quot;</span>)</div>
<div class="line"><a id="l00899" name="l00899"></a><span class="lineno">  899</span>         (<span class="stringliteral">&quot;disable-subjective-api-billing&quot;</span>, bpo::value&lt;bool&gt;()-&gt;default_value(<span class="keyword">true</span>),</div>
<div class="line"><a id="l00900" name="l00900"></a><span class="lineno">  900</span>          <span class="stringliteral">&quot;Disable subjective CPU billing for API transactions&quot;</span>)</div>
<div class="line"><a id="l00901" name="l00901"></a><span class="lineno">  901</span>         (<span class="stringliteral">&quot;producer-threads&quot;</span>, bpo::value&lt;uint16_t&gt;()-&gt;default_value(config::default_controller_thread_pool_size),</div>
<div class="line"><a id="l00902" name="l00902"></a><span class="lineno">  902</span>          <span class="stringliteral">&quot;Number of worker threads in producer thread pool&quot;</span>)</div>
<div class="line"><a id="l00903" name="l00903"></a><span class="lineno">  903</span>         (<span class="stringliteral">&quot;snapshots-dir&quot;</span>, bpo::value&lt;bfs::path&gt;()-&gt;default_value(<span class="stringliteral">&quot;snapshots&quot;</span>),</div>
<div class="line"><a id="l00904" name="l00904"></a><span class="lineno">  904</span>          <span class="stringliteral">&quot;the location of the snapshots directory (absolute path or relative to application data dir)&quot;</span>)</div>
<div class="line"><a id="l00905" name="l00905"></a><span class="lineno">  905</span>         ;</div>
<div class="line"><a id="l00906" name="l00906"></a><span class="lineno">  906</span>   config_file_options.add(producer_options);</div>
<div class="line"><a id="l00907" name="l00907"></a><span class="lineno">  907</span>}</div>
</div>
<div class="line"><a id="l00908" name="l00908"></a><span class="lineno">  908</span> </div>
<div class="foldopen" id="foldopen00909" data-start="{" data-end="}">
<div class="line"><a id="l00909" name="l00909"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin.html#a92b46a0e84fb207a04f56d4a75538381">  909</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="classsysio_1_1producer__plugin.html#a92b46a0e84fb207a04f56d4a75538381">producer_plugin::is_producer_key</a>(<span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1crypto_1_1public__key.html">chain::public_key_type</a>&amp; key)<span class="keyword"> const</span></div>
<div class="line"><a id="l00910" name="l00910"></a><span class="lineno">  910</span><span class="keyword"></span>{</div>
<div class="line"><a id="l00911" name="l00911"></a><span class="lineno">  911</span>  <span class="keyword">auto</span> private_key_itr = my-&gt;_signature_providers.find(key);</div>
<div class="line"><a id="l00912" name="l00912"></a><span class="lineno">  912</span>  <span class="keywordflow">if</span>(private_key_itr != my-&gt;_signature_providers.end())</div>
<div class="line"><a id="l00913" name="l00913"></a><span class="lineno">  913</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00914" name="l00914"></a><span class="lineno">  914</span>  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00915" name="l00915"></a><span class="lineno">  915</span>}</div>
</div>
<div class="line"><a id="l00916" name="l00916"></a><span class="lineno">  916</span> </div>
<div class="foldopen" id="foldopen00917" data-start="{" data-end="}">
<div class="line"><a id="l00917" name="l00917"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin.html#ac07c0380efa6d1d4c60fb1c686888f67">  917</a></span><a class="code hl_typedef" href="stdint_8h.html#a414156feea104f8f75b4ed9e3121b2f6">int64_t</a> <a class="code hl_function" href="classsysio_1_1producer__plugin.html#ac07c0380efa6d1d4c60fb1c686888f67">producer_plugin::get_subjective_bill</a>( <span class="keyword">const</span> <a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">account_name</a>&amp; first_auth, <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1time__point.html">fc::time_point</a>&amp; now )<span class="keyword"> const</span></div>
<div class="line"><a id="l00918" name="l00918"></a><span class="lineno">  918</span><span class="keyword"></span>{</div>
<div class="line"><a id="l00919" name="l00919"></a><span class="lineno">  919</span>   <span class="keywordflow">return</span> my-&gt;_subjective_billing.get_subjective_bill( first_auth, now );</div>
<div class="line"><a id="l00920" name="l00920"></a><span class="lineno">  920</span>}</div>
</div>
<div class="line"><a id="l00921" name="l00921"></a><span class="lineno">  921</span> </div>
<div class="foldopen" id="foldopen00922" data-start="{" data-end="}">
<div class="line"><a id="l00922" name="l00922"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin.html#a58db07a465c2622e2135b2f2c69d678e">  922</a></span><a class="code hl_class" href="classfc_1_1crypto_1_1signature.html">chain::signature_type</a> <a class="code hl_function" href="classsysio_1_1producer__plugin.html#a58db07a465c2622e2135b2f2c69d678e">producer_plugin::sign_compact</a>(<span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1crypto_1_1public__key.html">chain::public_key_type</a>&amp; key, <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1sha256.html">fc::sha256</a>&amp; <a class="code hl_function" href="namespacefc.html#a150ca4cd9c0318ca45dc0dc7df5d58b9">digest</a>)<span class="keyword"> const</span></div>
<div class="line"><a id="l00923" name="l00923"></a><span class="lineno">  923</span><span class="keyword"></span>{</div>
<div class="line"><a id="l00924" name="l00924"></a><span class="lineno">  924</span>  <span class="keywordflow">if</span>(key != <a class="code hl_class" href="classfc_1_1crypto_1_1public__key.html">chain::public_key_type</a>()) {</div>
<div class="line"><a id="l00925" name="l00925"></a><span class="lineno">  925</span>    <span class="keyword">auto</span> private_key_itr = my-&gt;_signature_providers.find(key);</div>
<div class="line"><a id="l00926" name="l00926"></a><span class="lineno">  926</span>    <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>(private_key_itr != my-&gt;_signature_providers.end(), producer_priv_key_not_found, <span class="stringliteral">&quot;Local producer has no private key in config.ini corresponding to public key ${key}&quot;</span>, (<span class="stringliteral">&quot;key&quot;</span>, key));</div>
<div class="line"><a id="l00927" name="l00927"></a><span class="lineno">  927</span> </div>
<div class="line"><a id="l00928" name="l00928"></a><span class="lineno">  928</span>    <span class="keywordflow">return</span> private_key_itr-&gt;second(<a class="code hl_function" href="namespacefc.html#a150ca4cd9c0318ca45dc0dc7df5d58b9">digest</a>);</div>
<div class="line"><a id="l00929" name="l00929"></a><span class="lineno">  929</span>  }</div>
<div class="line"><a id="l00930" name="l00930"></a><span class="lineno">  930</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00931" name="l00931"></a><span class="lineno">  931</span>    <span class="keywordflow">return</span> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#af141a69eb789b86fa0eb93c2d263f0df">chain::signature_type</a>();</div>
<div class="line"><a id="l00932" name="l00932"></a><span class="lineno">  932</span>  }</div>
<div class="line"><a id="l00933" name="l00933"></a><span class="lineno">  933</span>}</div>
</div>
<div class="line"><a id="l00934" name="l00934"></a><span class="lineno">  934</span> </div>
<div class="line"><a id="l00935" name="l00935"></a><span class="lineno">  935</span><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><a id="l00936" name="l00936"></a><span class="lineno">  936</span><a class="code hl_define" href="prettywritertest_8cpp.html#a6283df8c4e365cc8a01727e2d7ad44bf">T</a> <a class="code hl_function" href="namespacesysio.html#a57a25df07ccdce01a63d0b026d80ea5f">dejsonify</a>(<span class="keyword">const</span> <span class="keywordtype">string</span>&amp; <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a>) {</div>
<div class="line"><a id="l00937" name="l00937"></a><span class="lineno">  937</span>   <span class="keywordflow">return</span> <a class="code hl_function" href="classfc_1_1json.html#afad69f9f9c2a9f0105aae99f532f90cb">fc::json::from_string</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a>).<a class="code hl_function" href="classfc_1_1variant.html#a82edd1f33199355d3a1f19bbb92909cc">as</a>&lt;<a class="code hl_define" href="prettywritertest_8cpp.html#a6283df8c4e365cc8a01727e2d7ad44bf">T</a>&gt;();</div>
<div class="line"><a id="l00938" name="l00938"></a><span class="lineno">  938</span>}</div>
<div class="line"><a id="l00939" name="l00939"></a><span class="lineno">  939</span> </div>
<div class="foldopen" id="foldopen00940" data-start="" data-end="">
<div class="line"><a id="l00940" name="l00940"></a><span class="lineno"><a class="line" href="producer__plugin_8cpp.html#ac96900c0c3efb424647faf59995487d6">  940</a></span><span class="preprocessor">#define LOAD_VALUE_SET(options, op_name, container) \</span></div>
<div class="line"><a id="l00941" name="l00941"></a><span class="lineno">  941</span><span class="preprocessor">if( options.count(op_name) ) { \</span></div>
<div class="line"><a id="l00942" name="l00942"></a><span class="lineno">  942</span><span class="preprocessor">   const std::vector&lt;std::string&gt;&amp; ops = options[op_name].as&lt;std::vector&lt;std::string&gt;&gt;(); \</span></div>
<div class="line"><a id="l00943" name="l00943"></a><span class="lineno">  943</span><span class="preprocessor">   for( const auto&amp; v : ops ) { \</span></div>
<div class="line"><a id="l00944" name="l00944"></a><span class="lineno">  944</span><span class="preprocessor">      container.emplace( sysio::chain::name( v ) ); \</span></div>
<div class="line"><a id="l00945" name="l00945"></a><span class="lineno">  945</span><span class="preprocessor">   } \</span></div>
<div class="line"><a id="l00946" name="l00946"></a><span class="lineno">  946</span><span class="preprocessor">}</span></div>
</div>
<div class="line"><a id="l00947" name="l00947"></a><span class="lineno">  947</span> </div>
<div class="line"><a id="l00948" name="l00948"></a><span class="lineno">  948</span><span class="keyword">static</span> <a class="code hl_typedef" href="classsysio_1_1producer__plugin__impl.html#ad426992f015c5b8232753868f5edb366">producer_plugin_impl::signature_provider_type</a></div>
<div class="line"><a id="l00949" name="l00949"></a><span class="lineno">  949</span>make_key_signature_provider(<span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1crypto_1_1private__key.html">private_key_type</a>&amp; key) {</div>
<div class="line"><a id="l00950" name="l00950"></a><span class="lineno">  950</span>   <span class="keywordflow">return</span> [<a class="code hl_variable" href="yubico__otp_8c.html#a9246c20bb98ad2b4c60313c053c70f08">key</a>]( <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1sha256.html">chain::digest_type</a>&amp; <a class="code hl_function" href="namespacefc.html#a150ca4cd9c0318ca45dc0dc7df5d58b9">digest</a> ) {</div>
<div class="line"><a id="l00951" name="l00951"></a><span class="lineno">  951</span>      <span class="keywordflow">return</span> key.sign(<a class="code hl_function" href="namespacefc.html#a150ca4cd9c0318ca45dc0dc7df5d58b9">digest</a>);</div>
<div class="line"><a id="l00952" name="l00952"></a><span class="lineno">  952</span>   };</div>
<div class="line"><a id="l00953" name="l00953"></a><span class="lineno">  953</span>}</div>
<div class="line"><a id="l00954" name="l00954"></a><span class="lineno">  954</span> </div>
<div class="line"><a id="l00955" name="l00955"></a><span class="lineno">  955</span><span class="keyword">static</span> <a class="code hl_typedef" href="classsysio_1_1producer__plugin__impl.html#ad426992f015c5b8232753868f5edb366">producer_plugin_impl::signature_provider_type</a></div>
<div class="line"><a id="l00956" name="l00956"></a><span class="lineno">  956</span>make_kiod_signature_provider(<span class="keyword">const</span> std::shared_ptr&lt;producer_plugin_impl&gt;&amp; impl, <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; url_str, <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1crypto_1_1public__key.html">public_key_type</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a931987c85fd408a620505ee9a1aa6f58">pubkey</a>) {</div>
<div class="line"><a id="l00957" name="l00957"></a><span class="lineno">  957</span>   <a class="code hl_class" href="classfc_1_1url.html">fc::url</a> kiod_url;</div>
<div class="line"><a id="l00958" name="l00958"></a><span class="lineno">  958</span>   <span class="keywordflow">if</span>(boost::algorithm::starts_with(url_str, <span class="stringliteral">&quot;unix://&quot;</span>))</div>
<div class="line"><a id="l00959" name="l00959"></a><span class="lineno">  959</span>      <span class="comment">//send the entire string after unix:// to http_plugin. It&#39;ll auto-detect which part</span></div>
<div class="line"><a id="l00960" name="l00960"></a><span class="lineno">  960</span>      <span class="comment">// is the unix socket path, and which part is the url to hit on the server</span></div>
<div class="line"><a id="l00961" name="l00961"></a><span class="lineno">  961</span>      kiod_url = <a class="code hl_class" href="classfc_1_1url.html">fc::url</a>(<span class="stringliteral">&quot;unix&quot;</span>, url_str.substr(7), <a class="code hl_typedef" href="namespacefc.html#a219cf01fcfa97b5eac3acb755e8177e0">ostring</a>(), <a class="code hl_typedef" href="namespacefc.html#a219cf01fcfa97b5eac3acb755e8177e0">ostring</a>(), <a class="code hl_typedef" href="namespacefc.html#a219cf01fcfa97b5eac3acb755e8177e0">ostring</a>(), <a class="code hl_typedef" href="namespacefc.html#a219cf01fcfa97b5eac3acb755e8177e0">ostring</a>(), <a class="code hl_typedef" href="namespacefc.html#a97da71aef0dc7bf1196351036e688886">ovariant_object</a>(), std::optional&lt;uint16_t&gt;());</div>
<div class="line"><a id="l00962" name="l00962"></a><span class="lineno">  962</span>   <span class="keywordflow">else</span></div>
<div class="line"><a id="l00963" name="l00963"></a><span class="lineno">  963</span>      kiod_url = <a class="code hl_class" href="classfc_1_1url.html">fc::url</a>(url_str);</div>
<div class="line"><a id="l00964" name="l00964"></a><span class="lineno">  964</span>   std::weak_ptr&lt;producer_plugin_impl&gt; weak_impl = impl;</div>
<div class="line"><a id="l00965" name="l00965"></a><span class="lineno">  965</span> </div>
<div class="line"><a id="l00966" name="l00966"></a><span class="lineno">  966</span>   <span class="keywordflow">return</span> [weak_impl, kiod_url, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a931987c85fd408a620505ee9a1aa6f58">pubkey</a>]( <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1sha256.html">chain::digest_type</a>&amp; <a class="code hl_function" href="namespacefc.html#a150ca4cd9c0318ca45dc0dc7df5d58b9">digest</a> ) {</div>
<div class="line"><a id="l00967" name="l00967"></a><span class="lineno">  967</span>      <span class="keyword">auto</span> impl = weak_impl.lock();</div>
<div class="line"><a id="l00968" name="l00968"></a><span class="lineno">  968</span>      <span class="keywordflow">if</span> (impl) {</div>
<div class="line"><a id="l00969" name="l00969"></a><span class="lineno">  969</span>         <a class="code hl_class" href="classfc_1_1variant.html">fc::variant</a> <a class="code hl_typedef" href="namespacefc.html#a3a1a89eb370c7c0b0c7cf9bfa0bb0c71">params</a>;</div>
<div class="line"><a id="l00970" name="l00970"></a><span class="lineno">  970</span>         <a class="code hl_function" href="namespacefc.html#adea61f2343de94d0fbcb920a32332ad9">fc::to_variant</a>(std::make_pair(<a class="code hl_function" href="namespacefc.html#a150ca4cd9c0318ca45dc0dc7df5d58b9">digest</a>, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a931987c85fd408a620505ee9a1aa6f58">pubkey</a>), <a class="code hl_typedef" href="test__account__query__db_8cpp.html#aedc91aab307c8fb7ad822c3e16a6dd73">params</a>);</div>
<div class="line"><a id="l00971" name="l00971"></a><span class="lineno">  971</span>         <span class="keyword">auto</span> deadline = impl-&gt;_kiod_provider_timeout_us.count() &gt;= 0 ? <a class="code hl_function" href="classfc_1_1time__point.html#aa164ff1268a16d4b32afcff181f6100e">fc::time_point::now</a>() + impl-&gt;_kiod_provider_timeout_us : <a class="code hl_function" href="classfc_1_1time__point.html#aeccf1b70aa34b132c5269313b8a50573">fc::time_point::maximum</a>();</div>
<div class="line"><a id="l00972" name="l00972"></a><span class="lineno">  972</span>         <span class="keywordflow">return</span> <a class="code hl_function" href="namespaceappbase.html#a99374dc23934f008a09f2f79be9eae40">app</a>().<a class="code hl_function" href="classappbase_1_1application.html#a3c4b68a0667942b58f1369f454ce0ce3">get_plugin</a>&lt;<a class="code hl_class" href="classsysio_1_1http__client__plugin.html">http_client_plugin</a>&gt;().get_client().post_sync(kiod_url, <a class="code hl_typedef" href="test__account__query__db_8cpp.html#aedc91aab307c8fb7ad822c3e16a6dd73">params</a>, deadline).as&lt;<a class="code hl_class" href="classfc_1_1crypto_1_1signature.html">chain::signature_type</a>&gt;();</div>
<div class="line"><a id="l00973" name="l00973"></a><span class="lineno">  973</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00974" name="l00974"></a><span class="lineno">  974</span>         <span class="keywordflow">return</span> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#af141a69eb789b86fa0eb93c2d263f0df">signature_type</a>();</div>
<div class="line"><a id="l00975" name="l00975"></a><span class="lineno">  975</span>      }</div>
<div class="line"><a id="l00976" name="l00976"></a><span class="lineno">  976</span>   };</div>
<div class="line"><a id="l00977" name="l00977"></a><span class="lineno">  977</span>}</div>
<div class="line"><a id="l00978" name="l00978"></a><span class="lineno">  978</span> </div>
<div class="foldopen" id="foldopen00979" data-start="{" data-end="}">
<div class="line"><a id="l00979" name="l00979"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin.html#a091e6c32d2a7834be0d0a9b9b7fa061d">  979</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1producer__plugin.html#a091e6c32d2a7834be0d0a9b9b7fa061d">producer_plugin::plugin_initialize</a>(<span class="keyword">const</span> boost::program_options::variables_map&amp; options)</div>
<div class="line"><a id="l00980" name="l00980"></a><span class="lineno">  980</span>{ <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l00981" name="l00981"></a><span class="lineno">  981</span>   my-&gt;chain_plug = <a class="code hl_function" href="namespaceappbase.html#a99374dc23934f008a09f2f79be9eae40">app</a>().<a class="code hl_function" href="classappbase_1_1application.html#a1d2c585f90007be342c9c64ee9cc0f7c">find_plugin</a>&lt;<a class="code hl_class" href="classsysio_1_1chain__plugin.html">chain_plugin</a>&gt;();</div>
<div class="line"><a id="l00982" name="l00982"></a><span class="lineno">  982</span>   <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( my-&gt;chain_plug, plugin_config_exception, <span class="stringliteral">&quot;chain_plugin not found&quot;</span> );</div>
<div class="line"><a id="l00983" name="l00983"></a><span class="lineno">  983</span>   my-&gt;_options = &amp;options;</div>
<div class="line"><a id="l00984" name="l00984"></a><span class="lineno">  984</span>   <a class="code hl_define" href="chain__plugin_8cpp.html#ac96900c0c3efb424647faf59995487d6">LOAD_VALUE_SET</a>(options, <span class="stringliteral">&quot;producer-name&quot;</span>, my-&gt;_producers)</div>
<div class="line"><a id="l00985" name="l00985"></a><span class="lineno">  985</span> </div>
<div class="line"><a id="l00986" name="l00986"></a><span class="lineno">  986</span>   <a class="code hl_class" href="classsysio_1_1chain_1_1controller.html">chain::controller</a>&amp; chain = my-&gt;chain_plug-&gt;chain();</div>
<div class="line"><a id="l00987" name="l00987"></a><span class="lineno">  987</span> </div>
<div class="line"><a id="l00988" name="l00988"></a><span class="lineno">  988</span>   <span class="keywordflow">if</span>( options.count(<span class="stringliteral">&quot;private-key&quot;</span>) )</div>
<div class="line"><a id="l00989" name="l00989"></a><span class="lineno">  989</span>   {</div>
<div class="line"><a id="l00990" name="l00990"></a><span class="lineno">  990</span>      <span class="keyword">const</span> std::vector&lt;std::string&gt; key_id_to_wif_pair_strings = options[<span class="stringliteral">&quot;private-key&quot;</span>].as&lt;std::vector&lt;std::string&gt;&gt;();</div>
<div class="line"><a id="l00991" name="l00991"></a><span class="lineno">  991</span>      <span class="keywordflow">for</span> (<span class="keyword">const</span> std::string&amp; key_id_to_wif_pair_string : key_id_to_wif_pair_strings)</div>
<div class="line"><a id="l00992" name="l00992"></a><span class="lineno">  992</span>      {</div>
<div class="line"><a id="l00993" name="l00993"></a><span class="lineno">  993</span>         <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l00994" name="l00994"></a><span class="lineno">  994</span>            <span class="keyword">auto</span> key_id_to_wif_pair = <a class="code hl_function" href="namespacesysio.html#a57a25df07ccdce01a63d0b026d80ea5f">dejsonify&lt;std::pair&lt;public_key_type, private_key_type&gt;</a>&gt;(key_id_to_wif_pair_string);</div>
<div class="line"><a id="l00995" name="l00995"></a><span class="lineno">  995</span>            my-&gt;_signature_providers[key_id_to_wif_pair.first] = make_key_signature_provider(key_id_to_wif_pair.second);</div>
<div class="line"><a id="l00996" name="l00996"></a><span class="lineno">  996</span>            <span class="keyword">auto</span> blanked_privkey = std::string(key_id_to_wif_pair.second.to_string().size(), <span class="charliteral">&#39;*&#39;</span> );</div>
<div class="line"><a id="l00997" name="l00997"></a><span class="lineno">  997</span>            <a class="code hl_define" href="logger_8hpp.html#a1759e5c9691d8ad754bdf5eff8bb23ac">wlog</a>(<span class="stringliteral">&quot;\&quot;private-key\&quot; is DEPRECATED, use \&quot;signature-provider=${pub}=KEY:${priv}\&quot;&quot;</span>, (<span class="stringliteral">&quot;pub&quot;</span>,key_id_to_wif_pair.first)(<span class="stringliteral">&quot;priv&quot;</span>, blanked_privkey));</div>
<div class="line"><a id="l00998" name="l00998"></a><span class="lineno">  998</span>         } <span class="keywordflow">catch</span> ( <span class="keyword">const</span> std::exception&amp; e ) {</div>
<div class="line"><a id="l00999" name="l00999"></a><span class="lineno">  999</span>            <a class="code hl_define" href="logger_8hpp.html#a9e3cdbaecd5a34b42956e888f7326fad">elog</a>(<span class="stringliteral">&quot;Malformed private key pair&quot;</span>);</div>
<div class="line"><a id="l01000" name="l01000"></a><span class="lineno"> 1000</span>         }</div>
<div class="line"><a id="l01001" name="l01001"></a><span class="lineno"> 1001</span>      }</div>
<div class="line"><a id="l01002" name="l01002"></a><span class="lineno"> 1002</span>   }</div>
<div class="line"><a id="l01003" name="l01003"></a><span class="lineno"> 1003</span> </div>
<div class="line"><a id="l01004" name="l01004"></a><span class="lineno"> 1004</span>   <span class="keywordflow">if</span>( options.count(<span class="stringliteral">&quot;signature-provider&quot;</span>) ) {</div>
<div class="line"><a id="l01005" name="l01005"></a><span class="lineno"> 1005</span>      <span class="keyword">const</span> std::vector&lt;std::string&gt; key_spec_pairs = options[<span class="stringliteral">&quot;signature-provider&quot;</span>].as&lt;std::vector&lt;std::string&gt;&gt;();</div>
<div class="line"><a id="l01006" name="l01006"></a><span class="lineno"> 1006</span>      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; key_spec_pair : key_spec_pairs) {</div>
<div class="line"><a id="l01007" name="l01007"></a><span class="lineno"> 1007</span>         <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l01008" name="l01008"></a><span class="lineno"> 1008</span>            <span class="keyword">auto</span> delim = key_spec_pair.find(<span class="stringliteral">&quot;=&quot;</span>);</div>
<div class="line"><a id="l01009" name="l01009"></a><span class="lineno"> 1009</span>            <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>(delim != std::string::npos, plugin_config_exception, <span class="stringliteral">&quot;Missing \&quot;=\&quot; in the key spec pair&quot;</span>);</div>
<div class="line"><a id="l01010" name="l01010"></a><span class="lineno"> 1010</span>            <span class="keyword">auto</span> pub_key_str = key_spec_pair.substr(0, delim);</div>
<div class="line"><a id="l01011" name="l01011"></a><span class="lineno"> 1011</span>            <span class="keyword">auto</span> spec_str = key_spec_pair.substr(delim + 1);</div>
<div class="line"><a id="l01012" name="l01012"></a><span class="lineno"> 1012</span> </div>
<div class="line"><a id="l01013" name="l01013"></a><span class="lineno"> 1013</span>            <span class="keyword">auto</span> spec_delim = spec_str.find(<span class="stringliteral">&quot;:&quot;</span>);</div>
<div class="line"><a id="l01014" name="l01014"></a><span class="lineno"> 1014</span>            <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>(spec_delim != std::string::npos, plugin_config_exception, <span class="stringliteral">&quot;Missing \&quot;:\&quot; in the key spec pair&quot;</span>);</div>
<div class="line"><a id="l01015" name="l01015"></a><span class="lineno"> 1015</span>            <span class="keyword">auto</span> spec_type_str = spec_str.substr(0, spec_delim);</div>
<div class="line"><a id="l01016" name="l01016"></a><span class="lineno"> 1016</span>            <span class="keyword">auto</span> spec_data = spec_str.substr(spec_delim + 1);</div>
<div class="line"><a id="l01017" name="l01017"></a><span class="lineno"> 1017</span> </div>
<div class="line"><a id="l01018" name="l01018"></a><span class="lineno"> 1018</span>            <span class="keyword">auto</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a931987c85fd408a620505ee9a1aa6f58">pubkey</a> = <a class="code hl_typedef" href="namespacesysio_1_1chain.html#a0628a11f388cd2e43b1ccc1260a1042f">public_key_type</a>(pub_key_str);</div>
<div class="line"><a id="l01019" name="l01019"></a><span class="lineno"> 1019</span> </div>
<div class="line"><a id="l01020" name="l01020"></a><span class="lineno"> 1020</span>            <span class="keywordflow">if</span> (spec_type_str == <span class="stringliteral">&quot;KEY&quot;</span>) {</div>
<div class="line"><a id="l01021" name="l01021"></a><span class="lineno"> 1021</span>               my-&gt;_signature_providers[<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a931987c85fd408a620505ee9a1aa6f58">pubkey</a>] = make_key_signature_provider(<a class="code hl_typedef" href="namespacesysio_1_1chain.html#ac31c0e1bc25b7e5fcf2b3c7f41a23fd6">private_key_type</a>(spec_data));</div>
<div class="line"><a id="l01022" name="l01022"></a><span class="lineno"> 1022</span>            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (spec_type_str == <span class="stringliteral">&quot;KSYSD&quot;</span>) {</div>
<div class="line"><a id="l01023" name="l01023"></a><span class="lineno"> 1023</span>               my-&gt;_signature_providers[<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a931987c85fd408a620505ee9a1aa6f58">pubkey</a>] = make_kiod_signature_provider(my, spec_data, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a931987c85fd408a620505ee9a1aa6f58">pubkey</a>);</div>
<div class="line"><a id="l01024" name="l01024"></a><span class="lineno"> 1024</span>            }</div>
<div class="line"><a id="l01025" name="l01025"></a><span class="lineno"> 1025</span> </div>
<div class="line"><a id="l01026" name="l01026"></a><span class="lineno"> 1026</span>         } <span class="keywordflow">catch</span> (...) {</div>
<div class="line"><a id="l01027" name="l01027"></a><span class="lineno"> 1027</span>            <a class="code hl_define" href="logger_8hpp.html#a9e3cdbaecd5a34b42956e888f7326fad">elog</a>(<span class="stringliteral">&quot;Malformed signature provider: \&quot;${val}\&quot;, ignoring!&quot;</span>, (<span class="stringliteral">&quot;val&quot;</span>, key_spec_pair));</div>
<div class="line"><a id="l01028" name="l01028"></a><span class="lineno"> 1028</span>         }</div>
<div class="line"><a id="l01029" name="l01029"></a><span class="lineno"> 1029</span>      }</div>
<div class="line"><a id="l01030" name="l01030"></a><span class="lineno"> 1030</span>   }</div>
<div class="line"><a id="l01031" name="l01031"></a><span class="lineno"> 1031</span> </div>
<div class="line"><a id="l01032" name="l01032"></a><span class="lineno"> 1032</span>   my-&gt;_kiod_provider_timeout_us = <a class="code hl_function" href="namespacefc.html#a76ae235ec7e9b8862e70740058d7eb1b">fc::milliseconds</a>(options.at(<span class="stringliteral">&quot;kiod-provider-timeout&quot;</span>).as&lt;<a class="code hl_typedef" href="stdint_8h.html#ab1967d8591af1a4e48c37fd2b0f184d0">int32_t</a>&gt;());</div>
<div class="line"><a id="l01033" name="l01033"></a><span class="lineno"> 1033</span> </div>
<div class="line"><a id="l01034" name="l01034"></a><span class="lineno"> 1034</span>   my-&gt;_account_fails.set_max_failures_per_account( options.at(<span class="stringliteral">&quot;subjective-account-max-failures&quot;</span>).as&lt;<a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&gt;() );</div>
<div class="line"><a id="l01035" name="l01035"></a><span class="lineno"> 1035</span> </div>
<div class="line"><a id="l01036" name="l01036"></a><span class="lineno"> 1036</span>   my-&gt;_produce_time_offset_us = options.at(<span class="stringliteral">&quot;produce-time-offset-us&quot;</span>).as&lt;<a class="code hl_typedef" href="stdint_8h.html#ab1967d8591af1a4e48c37fd2b0f184d0">int32_t</a>&gt;();</div>
<div class="line"><a id="l01037" name="l01037"></a><span class="lineno"> 1037</span>   <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( my-&gt;_produce_time_offset_us &lt;= 0 &amp;&amp; my-&gt;_produce_time_offset_us &gt;= -config::block_interval_us, plugin_config_exception,</div>
<div class="line"><a id="l01038" name="l01038"></a><span class="lineno"> 1038</span>               <span class="stringliteral">&quot;produce-time-offset-us ${o} must be 0 .. -${bi}&quot;</span>, (<span class="stringliteral">&quot;bi&quot;</span>, config::block_interval_us)(<span class="stringliteral">&quot;o&quot;</span>, my-&gt;_produce_time_offset_us) );</div>
<div class="line"><a id="l01039" name="l01039"></a><span class="lineno"> 1039</span> </div>
<div class="line"><a id="l01040" name="l01040"></a><span class="lineno"> 1040</span>   my-&gt;_last_block_time_offset_us = options.at(<span class="stringliteral">&quot;last-block-time-offset-us&quot;</span>).as&lt;<a class="code hl_typedef" href="stdint_8h.html#ab1967d8591af1a4e48c37fd2b0f184d0">int32_t</a>&gt;();</div>
<div class="line"><a id="l01041" name="l01041"></a><span class="lineno"> 1041</span>   <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( my-&gt;_last_block_time_offset_us &lt;= 0 &amp;&amp; my-&gt;_last_block_time_offset_us &gt;= -config::block_interval_us, plugin_config_exception,</div>
<div class="line"><a id="l01042" name="l01042"></a><span class="lineno"> 1042</span>               <span class="stringliteral">&quot;last-block-time-offset-us ${o} must be 0 .. -${bi}&quot;</span>, (<span class="stringliteral">&quot;bi&quot;</span>, config::block_interval_us)(<span class="stringliteral">&quot;o&quot;</span>, my-&gt;_last_block_time_offset_us) );</div>
<div class="line"><a id="l01043" name="l01043"></a><span class="lineno"> 1043</span> </div>
<div class="line"><a id="l01044" name="l01044"></a><span class="lineno"> 1044</span>   <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> cpu_effort_pct = options.at(<span class="stringliteral">&quot;cpu-effort-percent&quot;</span>).as&lt;<a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&gt;();</div>
<div class="line"><a id="l01045" name="l01045"></a><span class="lineno"> 1045</span>   <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( cpu_effort_pct &gt;= 0 &amp;&amp; cpu_effort_pct &lt;= 100, plugin_config_exception,</div>
<div class="line"><a id="l01046" name="l01046"></a><span class="lineno"> 1046</span>               <span class="stringliteral">&quot;cpu-effort-percent ${pct} must be 0 - 100&quot;</span>, (<span class="stringliteral">&quot;pct&quot;</span>, cpu_effort_pct) );</div>
<div class="line"><a id="l01047" name="l01047"></a><span class="lineno"> 1047</span>      cpu_effort_pct *= config::percent_1;</div>
<div class="line"><a id="l01048" name="l01048"></a><span class="lineno"> 1048</span>   <a class="code hl_typedef" href="stdint_8h.html#ab1967d8591af1a4e48c37fd2b0f184d0">int32_t</a> cpu_effort_offset_us =</div>
<div class="line"><a id="l01049" name="l01049"></a><span class="lineno"> 1049</span>         -<a class="code hl_function" href="chain_2include_2sysio_2chain_2config_8hpp.html#a0b4bacb63f31764f50a185f320551fbc">SYS_PERCENT</a>( config::block_interval_us, chain::config::percent_100 - cpu_effort_pct );</div>
<div class="line"><a id="l01050" name="l01050"></a><span class="lineno"> 1050</span> </div>
<div class="line"><a id="l01051" name="l01051"></a><span class="lineno"> 1051</span>   <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> last_block_cpu_effort_pct = options.at(<span class="stringliteral">&quot;last-block-cpu-effort-percent&quot;</span>).as&lt;<a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&gt;();</div>
<div class="line"><a id="l01052" name="l01052"></a><span class="lineno"> 1052</span>   <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( last_block_cpu_effort_pct &gt;= 0 &amp;&amp; last_block_cpu_effort_pct &lt;= 100, plugin_config_exception,</div>
<div class="line"><a id="l01053" name="l01053"></a><span class="lineno"> 1053</span>               <span class="stringliteral">&quot;last-block-cpu-effort-percent ${pct} must be 0 - 100&quot;</span>, (<span class="stringliteral">&quot;pct&quot;</span>, last_block_cpu_effort_pct) );</div>
<div class="line"><a id="l01054" name="l01054"></a><span class="lineno"> 1054</span>      last_block_cpu_effort_pct *= config::percent_1;</div>
<div class="line"><a id="l01055" name="l01055"></a><span class="lineno"> 1055</span>   <a class="code hl_typedef" href="stdint_8h.html#ab1967d8591af1a4e48c37fd2b0f184d0">int32_t</a> last_block_cpu_effort_offset_us =</div>
<div class="line"><a id="l01056" name="l01056"></a><span class="lineno"> 1056</span>         -<a class="code hl_function" href="chain_2include_2sysio_2chain_2config_8hpp.html#a0b4bacb63f31764f50a185f320551fbc">SYS_PERCENT</a>( config::block_interval_us, chain::config::percent_100 - last_block_cpu_effort_pct );</div>
<div class="line"><a id="l01057" name="l01057"></a><span class="lineno"> 1057</span> </div>
<div class="line"><a id="l01058" name="l01058"></a><span class="lineno"> 1058</span>   my-&gt;_produce_time_offset_us = std::min( my-&gt;_produce_time_offset_us, cpu_effort_offset_us );</div>
<div class="line"><a id="l01059" name="l01059"></a><span class="lineno"> 1059</span>   my-&gt;_last_block_time_offset_us = std::min( my-&gt;_last_block_time_offset_us, last_block_cpu_effort_offset_us );</div>
<div class="line"><a id="l01060" name="l01060"></a><span class="lineno"> 1060</span> </div>
<div class="line"><a id="l01061" name="l01061"></a><span class="lineno"> 1061</span>   my-&gt;_max_block_cpu_usage_threshold_us = options.at( <span class="stringliteral">&quot;max-block-cpu-usage-threshold-us&quot;</span> ).as&lt;<a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&gt;();</div>
<div class="line"><a id="l01062" name="l01062"></a><span class="lineno"> 1062</span>   <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( my-&gt;_max_block_cpu_usage_threshold_us &lt; config::block_interval_us, plugin_config_exception,</div>
<div class="line"><a id="l01063" name="l01063"></a><span class="lineno"> 1063</span>               <span class="stringliteral">&quot;max-block-cpu-usage-threshold-us ${t} must be 0 .. ${bi}&quot;</span>, (<span class="stringliteral">&quot;bi&quot;</span>, config::block_interval_us)(<span class="stringliteral">&quot;t&quot;</span>, my-&gt;_max_block_cpu_usage_threshold_us) );</div>
<div class="line"><a id="l01064" name="l01064"></a><span class="lineno"> 1064</span> </div>
<div class="line"><a id="l01065" name="l01065"></a><span class="lineno"> 1065</span>   my-&gt;_max_block_net_usage_threshold_bytes = options.at( <span class="stringliteral">&quot;max-block-net-usage-threshold-bytes&quot;</span> ).as&lt;<a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&gt;();</div>
<div class="line"><a id="l01066" name="l01066"></a><span class="lineno"> 1066</span> </div>
<div class="line"><a id="l01067" name="l01067"></a><span class="lineno"> 1067</span>   my-&gt;_max_scheduled_transaction_time_per_block_ms = options.at(<span class="stringliteral">&quot;max-scheduled-transaction-time-per-block-ms&quot;</span>).as&lt;<a class="code hl_typedef" href="stdint_8h.html#ab1967d8591af1a4e48c37fd2b0f184d0">int32_t</a>&gt;();</div>
<div class="line"><a id="l01068" name="l01068"></a><span class="lineno"> 1068</span> </div>
<div class="line"><a id="l01069" name="l01069"></a><span class="lineno"> 1069</span>   <span class="keywordflow">if</span>( options.at( <span class="stringliteral">&quot;subjective-cpu-leeway-us&quot;</span> ).as&lt;<a class="code hl_typedef" href="stdint_8h.html#ab1967d8591af1a4e48c37fd2b0f184d0">int32_t</a>&gt;() != config::default_subjective_cpu_leeway_us ) {</div>
<div class="line"><a id="l01070" name="l01070"></a><span class="lineno"> 1070</span>      chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#ac8d3310c59100f18efeb9a7007a21103">set_subjective_cpu_leeway</a>( <a class="code hl_class" href="classfc_1_1microseconds.html">fc::microseconds</a>( options.at( <span class="stringliteral">&quot;subjective-cpu-leeway-us&quot;</span> ).as&lt;<a class="code hl_typedef" href="stdint_8h.html#ab1967d8591af1a4e48c37fd2b0f184d0">int32_t</a>&gt;() ) );</div>
<div class="line"><a id="l01071" name="l01071"></a><span class="lineno"> 1071</span>   }</div>
<div class="line"><a id="l01072" name="l01072"></a><span class="lineno"> 1072</span> </div>
<div class="line"><a id="l01073" name="l01073"></a><span class="lineno"> 1073</span>   <a class="code hl_class" href="classfc_1_1microseconds.html">fc::microseconds</a> subjective_account_decay_time = <a class="code hl_function" href="namespacefc.html#a9c3f2826ca2b6652fcef4da96f33503a">fc::minutes</a>(options.at( <span class="stringliteral">&quot;subjective-account-decay-time-minutes&quot;</span> ).as&lt;<a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&gt;());</div>
<div class="line"><a id="l01074" name="l01074"></a><span class="lineno"> 1074</span>   <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( subjective_account_decay_time.<a class="code hl_function" href="classfc_1_1microseconds.html#a20fba59ec7e1f50c6b8f2c9443cc9b92">count</a>() &gt; 0, plugin_config_exception,</div>
<div class="line"><a id="l01075" name="l01075"></a><span class="lineno"> 1075</span>               <span class="stringliteral">&quot;subjective-account-decay-time-minutes ${dt} must be greater than 0&quot;</span>, (<span class="stringliteral">&quot;dt&quot;</span>, subjective_account_decay_time.<a class="code hl_function" href="classfc_1_1microseconds.html#a12ee4fe7bac52aeb600d8ea39291e765">to_seconds</a>() / 60));</div>
<div class="line"><a id="l01076" name="l01076"></a><span class="lineno"> 1076</span>   my-&gt;_subjective_billing.set_expired_accumulator_average_window( subjective_account_decay_time );</div>
<div class="line"><a id="l01077" name="l01077"></a><span class="lineno"> 1077</span> </div>
<div class="line"><a id="l01078" name="l01078"></a><span class="lineno"> 1078</span>   my-&gt;_max_transaction_time_ms = options.at(<span class="stringliteral">&quot;max-transaction-time&quot;</span>).as&lt;<a class="code hl_typedef" href="stdint_8h.html#ab1967d8591af1a4e48c37fd2b0f184d0">int32_t</a>&gt;();</div>
<div class="line"><a id="l01079" name="l01079"></a><span class="lineno"> 1079</span> </div>
<div class="line"><a id="l01080" name="l01080"></a><span class="lineno"> 1080</span>   my-&gt;_max_irreversible_block_age_us = <a class="code hl_function" href="namespacefc.html#a9623b8cae3f48bbed6aa1fc2afe9b174">fc::seconds</a>(options.at(<span class="stringliteral">&quot;max-irreversible-block-age&quot;</span>).as&lt;<a class="code hl_typedef" href="stdint_8h.html#ab1967d8591af1a4e48c37fd2b0f184d0">int32_t</a>&gt;());</div>
<div class="line"><a id="l01081" name="l01081"></a><span class="lineno"> 1081</span> </div>
<div class="line"><a id="l01082" name="l01082"></a><span class="lineno"> 1082</span>   <span class="keyword">auto</span> max_incoming_transaction_queue_size = options.at(<span class="stringliteral">&quot;incoming-transaction-queue-size-mb&quot;</span>).as&lt;<a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a>&gt;() * 1024*1024;</div>
<div class="line"><a id="l01083" name="l01083"></a><span class="lineno"> 1083</span> </div>
<div class="line"><a id="l01084" name="l01084"></a><span class="lineno"> 1084</span>   <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( max_incoming_transaction_queue_size &gt; 0, plugin_config_exception,</div>
<div class="line"><a id="l01085" name="l01085"></a><span class="lineno"> 1085</span>               <span class="stringliteral">&quot;incoming-transaction-queue-size-mb ${mb} must be greater than 0&quot;</span>, (<span class="stringliteral">&quot;mb&quot;</span>, max_incoming_transaction_queue_size) );</div>
<div class="line"><a id="l01086" name="l01086"></a><span class="lineno"> 1086</span> </div>
<div class="line"><a id="l01087" name="l01087"></a><span class="lineno"> 1087</span>   my-&gt;_unapplied_transactions.set_max_transaction_queue_size( max_incoming_transaction_queue_size );</div>
<div class="line"><a id="l01088" name="l01088"></a><span class="lineno"> 1088</span> </div>
<div class="line"><a id="l01089" name="l01089"></a><span class="lineno"> 1089</span>   my-&gt;_incoming_defer_ratio = options.at(<span class="stringliteral">&quot;incoming-defer-ratio&quot;</span>).as&lt;<span class="keywordtype">double</span>&gt;();</div>
<div class="line"><a id="l01090" name="l01090"></a><span class="lineno"> 1090</span> </div>
<div class="line"><a id="l01091" name="l01091"></a><span class="lineno"> 1091</span>   my-&gt;_disable_persist_until_expired = options.at(<span class="stringliteral">&quot;disable-api-persisted-trx&quot;</span>).as&lt;<span class="keywordtype">bool</span>&gt;();</div>
<div class="line"><a id="l01092" name="l01092"></a><span class="lineno"> 1092</span>   <span class="keywordtype">bool</span> disable_subjective_billing = options.at(<span class="stringliteral">&quot;disable-subjective-billing&quot;</span>).as&lt;<span class="keywordtype">bool</span>&gt;();</div>
<div class="line"><a id="l01093" name="l01093"></a><span class="lineno"> 1093</span>   my-&gt;_disable_subjective_p2p_billing = options.at(<span class="stringliteral">&quot;disable-subjective-p2p-billing&quot;</span>).as&lt;<span class="keywordtype">bool</span>&gt;();</div>
<div class="line"><a id="l01094" name="l01094"></a><span class="lineno"> 1094</span>   my-&gt;_disable_subjective_api_billing = options.at(<span class="stringliteral">&quot;disable-subjective-api-billing&quot;</span>).as&lt;<span class="keywordtype">bool</span>&gt;();</div>
<div class="line"><a id="l01095" name="l01095"></a><span class="lineno"> 1095</span>   <a class="code hl_define" href="logger_8hpp.html#a3da1571bad6ca6c94df9a3660b2115ee">dlog</a>( <span class="stringliteral">&quot;disable-subjective-billing: ${s}, disable-subjective-p2p-billing: ${p2p}, disable-subjective-api-billing: ${api}&quot;</span>,</div>
<div class="line"><a id="l01096" name="l01096"></a><span class="lineno"> 1096</span>         (<span class="stringliteral">&quot;s&quot;</span>, disable_subjective_billing)(<span class="stringliteral">&quot;p2p&quot;</span>, my-&gt;_disable_subjective_p2p_billing)(<span class="stringliteral">&quot;api&quot;</span>, my-&gt;_disable_subjective_api_billing) );</div>
<div class="line"><a id="l01097" name="l01097"></a><span class="lineno"> 1097</span>   <span class="keywordflow">if</span>( !disable_subjective_billing ) {</div>
<div class="line"><a id="l01098" name="l01098"></a><span class="lineno"> 1098</span>       my-&gt;_disable_subjective_p2p_billing = my-&gt;_disable_subjective_api_billing = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01099" name="l01099"></a><span class="lineno"> 1099</span>   } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( !my-&gt;_disable_subjective_p2p_billing || !my-&gt;_disable_subjective_api_billing ) {</div>
<div class="line"><a id="l01100" name="l01100"></a><span class="lineno"> 1100</span>       disable_subjective_billing = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01101" name="l01101"></a><span class="lineno"> 1101</span>   }</div>
<div class="line"><a id="l01102" name="l01102"></a><span class="lineno"> 1102</span>   <span class="keywordflow">if</span>( disable_subjective_billing ) {</div>
<div class="line"><a id="l01103" name="l01103"></a><span class="lineno"> 1103</span>       my-&gt;_subjective_billing.disable();</div>
<div class="line"><a id="l01104" name="l01104"></a><span class="lineno"> 1104</span>       <a class="code hl_define" href="logger_8hpp.html#a831cf08dc63704c11fd154132c6e8bdb">ilog</a>( <span class="stringliteral">&quot;Subjective CPU billing disabled&quot;</span> );</div>
<div class="line"><a id="l01105" name="l01105"></a><span class="lineno"> 1105</span>   } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( !my-&gt;_disable_subjective_p2p_billing &amp;&amp; !my-&gt;_disable_subjective_api_billing ) {</div>
<div class="line"><a id="l01106" name="l01106"></a><span class="lineno"> 1106</span>       <a class="code hl_define" href="logger_8hpp.html#a831cf08dc63704c11fd154132c6e8bdb">ilog</a>( <span class="stringliteral">&quot;Subjective CPU billing enabled&quot;</span> );</div>
<div class="line"><a id="l01107" name="l01107"></a><span class="lineno"> 1107</span>   } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01108" name="l01108"></a><span class="lineno"> 1108</span>       <span class="keywordflow">if</span>( my-&gt;_disable_subjective_p2p_billing ) <a class="code hl_define" href="logger_8hpp.html#a831cf08dc63704c11fd154132c6e8bdb">ilog</a>( <span class="stringliteral">&quot;Subjective CPU billing of P2P trxs disabled &quot;</span> );</div>
<div class="line"><a id="l01109" name="l01109"></a><span class="lineno"> 1109</span>       <span class="keywordflow">if</span>( my-&gt;_disable_subjective_api_billing ) <a class="code hl_define" href="logger_8hpp.html#a831cf08dc63704c11fd154132c6e8bdb">ilog</a>( <span class="stringliteral">&quot;Subjective CPU billing of API trxs disabled &quot;</span> );</div>
<div class="line"><a id="l01110" name="l01110"></a><span class="lineno"> 1110</span>   }</div>
<div class="line"><a id="l01111" name="l01111"></a><span class="lineno"> 1111</span> </div>
<div class="line"><a id="l01112" name="l01112"></a><span class="lineno"> 1112</span>   <span class="keyword">auto</span> thread_pool_size = options.at( <span class="stringliteral">&quot;producer-threads&quot;</span> ).as&lt;<a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a>&gt;();</div>
<div class="line"><a id="l01113" name="l01113"></a><span class="lineno"> 1113</span>   <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( thread_pool_size &gt; 0, plugin_config_exception,</div>
<div class="line"><a id="l01114" name="l01114"></a><span class="lineno"> 1114</span>               <span class="stringliteral">&quot;producer-threads ${num} must be greater than 0&quot;</span>, (<span class="stringliteral">&quot;num&quot;</span>, thread_pool_size));</div>
<div class="line"><a id="l01115" name="l01115"></a><span class="lineno"> 1115</span>   my-&gt;_thread_pool.emplace( <span class="stringliteral">&quot;prod&quot;</span>, thread_pool_size );</div>
<div class="line"><a id="l01116" name="l01116"></a><span class="lineno"> 1116</span> </div>
<div class="line"><a id="l01117" name="l01117"></a><span class="lineno"> 1117</span>   <span class="keywordflow">if</span>( options.count( <span class="stringliteral">&quot;snapshots-dir&quot;</span> )) {</div>
<div class="line"><a id="l01118" name="l01118"></a><span class="lineno"> 1118</span>      <span class="keyword">auto</span> sd = options.at( <span class="stringliteral">&quot;snapshots-dir&quot;</span> ).as&lt;bfs::path&gt;();</div>
<div class="line"><a id="l01119" name="l01119"></a><span class="lineno"> 1119</span>      <span class="keywordflow">if</span>( sd.is_relative()) {</div>
<div class="line"><a id="l01120" name="l01120"></a><span class="lineno"> 1120</span>         my-&gt;_snapshots_dir = <a class="code hl_function" href="namespaceappbase.html#a99374dc23934f008a09f2f79be9eae40">app</a>().<a class="code hl_function" href="classappbase_1_1application.html#a5dfd3cfb1124c57963fa17b3f4aabbe1">data_dir</a>() / sd;</div>
<div class="line"><a id="l01121" name="l01121"></a><span class="lineno"> 1121</span>         <span class="keywordflow">if</span> (!<a class="code hl_function" href="namespacefc.html#a3fcf0d920aea28014aacae50a51d8485">fc::exists</a>(my-&gt;_snapshots_dir)) {</div>
<div class="line"><a id="l01122" name="l01122"></a><span class="lineno"> 1122</span>            <a class="code hl_function" href="namespacefc.html#a76b0787468a9f403087b71a894c07ce2">fc::create_directories</a>(my-&gt;_snapshots_dir);</div>
<div class="line"><a id="l01123" name="l01123"></a><span class="lineno"> 1123</span>         }</div>
<div class="line"><a id="l01124" name="l01124"></a><span class="lineno"> 1124</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01125" name="l01125"></a><span class="lineno"> 1125</span>         my-&gt;_snapshots_dir = sd;</div>
<div class="line"><a id="l01126" name="l01126"></a><span class="lineno"> 1126</span>      }</div>
<div class="line"><a id="l01127" name="l01127"></a><span class="lineno"> 1127</span> </div>
<div class="line"><a id="l01128" name="l01128"></a><span class="lineno"> 1128</span>      <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( <a class="code hl_function" href="namespacefc.html#ab123bfeadf918cc293ecad88bca7c499">fc::is_directory</a>(my-&gt;_snapshots_dir), snapshot_directory_not_found_exception,</div>
<div class="line"><a id="l01129" name="l01129"></a><span class="lineno"> 1129</span>                  <span class="stringliteral">&quot;No such directory &#39;${dir}&#39;&quot;</span>, (<span class="stringliteral">&quot;dir&quot;</span>, my-&gt;_snapshots_dir.generic_string()) );</div>
<div class="line"><a id="l01130" name="l01130"></a><span class="lineno"> 1130</span> </div>
<div class="line"><a id="l01131" name="l01131"></a><span class="lineno"> 1131</span>      <span class="keywordflow">if</span> (<span class="keyword">auto</span> resmon_plugin = <a class="code hl_function" href="namespaceappbase.html#a99374dc23934f008a09f2f79be9eae40">app</a>().find_plugin&lt;resource_monitor_plugin&gt;()) {</div>
<div class="line"><a id="l01132" name="l01132"></a><span class="lineno"> 1132</span>         resmon_plugin-&gt;monitor_directory(my-&gt;_snapshots_dir);</div>
<div class="line"><a id="l01133" name="l01133"></a><span class="lineno"> 1133</span>      }</div>
<div class="line"><a id="l01134" name="l01134"></a><span class="lineno"> 1134</span>   }</div>
<div class="line"><a id="l01135" name="l01135"></a><span class="lineno"> 1135</span> </div>
<div class="line"><a id="l01136" name="l01136"></a><span class="lineno"> 1136</span>   my-&gt;_incoming_block_sync_provider = <a class="code hl_function" href="namespaceappbase.html#a99374dc23934f008a09f2f79be9eae40">app</a>().<a class="code hl_function" href="classappbase_1_1application.html#a87887b19b1f639ca551645813bb380de">get_method</a>&lt;<a class="code hl_struct" href="structappbase_1_1method__decl.html">incoming::methods::block_sync</a>&gt;().register_provider(</div>
<div class="line"><a id="l01137" name="l01137"></a><span class="lineno"> 1137</span>         [<span class="keyword">this</span>](<span class="keyword">const</span> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#aa10ee348c57604b615bc8570f6685102">signed_block_ptr</a>&amp; block, <span class="keyword">const</span> std::optional&lt;block_id_type&gt;&amp; block_id, <span class="keyword">const</span> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#ab9b14f4554cc4a0da2c361e9757b1662">block_state_ptr</a>&amp; bsp) {</div>
<div class="line"><a id="l01138" name="l01138"></a><span class="lineno"> 1138</span>      <span class="keywordflow">return</span> my-&gt;on_incoming_block(block, block_id, bsp);</div>
<div class="line"><a id="l01139" name="l01139"></a><span class="lineno"> 1139</span>   });</div>
<div class="line"><a id="l01140" name="l01140"></a><span class="lineno"> 1140</span> </div>
<div class="line"><a id="l01141" name="l01141"></a><span class="lineno"> 1141</span>   my-&gt;_incoming_transaction_async_provider = <a class="code hl_function" href="namespaceappbase.html#a99374dc23934f008a09f2f79be9eae40">app</a>().<a class="code hl_function" href="classappbase_1_1application.html#a87887b19b1f639ca551645813bb380de">get_method</a>&lt;<a class="code hl_struct" href="structappbase_1_1method__decl.html">incoming::methods::transaction_async</a>&gt;().register_provider(</div>
<div class="line"><a id="l01142" name="l01142"></a><span class="lineno"> 1142</span>         [<span class="keyword">this</span>](<span class="keyword">const</span> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#a7041c0316bd294d0866609ab3e0cc7a7">packed_transaction_ptr</a>&amp; trx, <span class="keywordtype">bool</span> persist_until_expired, <span class="keywordtype">bool</span> <a class="code hl_enumvalue" href="namespacefc.html#a3d8a2be677709cc41f09aa7925f2d55fad6bcd1364809e1b881bb22334d14cd56">read_only</a>, <span class="keywordtype">bool</span> return_failure_traces, <a class="code hl_typedef" href="classsysio_1_1producer__plugin.html#aa0f4bf0b390688408224d4bc36b74e27">next_function&lt;transaction_trace_ptr&gt;</a> next) -&gt; <span class="keywordtype">void</span> {</div>
<div class="line"><a id="l01143" name="l01143"></a><span class="lineno"> 1143</span>      <span class="keywordflow">return</span> my-&gt;on_incoming_transaction_async(trx, persist_until_expired, <a class="code hl_enumvalue" href="namespacefc.html#a3d8a2be677709cc41f09aa7925f2d55fad6bcd1364809e1b881bb22334d14cd56">read_only</a>, return_failure_traces, next );</div>
<div class="line"><a id="l01144" name="l01144"></a><span class="lineno"> 1144</span>   });</div>
<div class="line"><a id="l01145" name="l01145"></a><span class="lineno"> 1145</span> </div>
<div class="line"><a id="l01146" name="l01146"></a><span class="lineno"> 1146</span>   <span class="keywordflow">if</span> (options.count(<span class="stringliteral">&quot;greylist-account&quot;</span>)) {</div>
<div class="line"><a id="l01147" name="l01147"></a><span class="lineno"> 1147</span>      std::vector&lt;std::string&gt; greylist = options[<span class="stringliteral">&quot;greylist-account&quot;</span>].as&lt;std::vector&lt;std::string&gt;&gt;();</div>
<div class="line"><a id="l01148" name="l01148"></a><span class="lineno"> 1148</span>      <a class="code hl_struct" href="structsysio_1_1producer__plugin_1_1greylist__params.html">greylist_params</a> param;</div>
<div class="line"><a id="l01149" name="l01149"></a><span class="lineno"> 1149</span>      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_variable" href="pointer_8h.html#aeeddce917cf130d62c370b8f216026dd">a</a> : greylist) {</div>
<div class="line"><a id="l01150" name="l01150"></a><span class="lineno"> 1150</span>         param.accounts.push_back(<a class="code hl_typedef" href="namespacesysio_1_1chain.html#ac32ce8e75243f2b3f76aff0c1984f11b">account_name</a>(<a class="code hl_variable" href="pointer_8h.html#aeeddce917cf130d62c370b8f216026dd">a</a>));</div>
<div class="line"><a id="l01151" name="l01151"></a><span class="lineno"> 1151</span>      }</div>
<div class="line"><a id="l01152" name="l01152"></a><span class="lineno"> 1152</span>      <a class="code hl_function" href="classsysio_1_1producer__plugin.html#a967d53a8cf3bd8aa79fdf07bf2603db6">add_greylist_accounts</a>(param);</div>
<div class="line"><a id="l01153" name="l01153"></a><span class="lineno"> 1153</span>   }</div>
<div class="line"><a id="l01154" name="l01154"></a><span class="lineno"> 1154</span> </div>
<div class="line"><a id="l01155" name="l01155"></a><span class="lineno"> 1155</span>   {</div>
<div class="line"><a id="l01156" name="l01156"></a><span class="lineno"> 1156</span>      <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> greylist_limit = options.at(<span class="stringliteral">&quot;greylist-limit&quot;</span>).as&lt;<a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&gt;();</div>
<div class="line"><a id="l01157" name="l01157"></a><span class="lineno"> 1157</span>      chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a03d5ea18c641a8899af9bdbdf9da9f81">set_greylist_limit</a>( greylist_limit );</div>
<div class="line"><a id="l01158" name="l01158"></a><span class="lineno"> 1158</span>   }</div>
<div class="line"><a id="l01159" name="l01159"></a><span class="lineno"> 1159</span> </div>
<div class="line"><a id="l01160" name="l01160"></a><span class="lineno"> 1160</span>   <span class="keywordflow">if</span>( options.count(<span class="stringliteral">&quot;disable-subjective-account-billing&quot;</span>) ) {</div>
<div class="line"><a id="l01161" name="l01161"></a><span class="lineno"> 1161</span>      std::vector&lt;std::string&gt; accounts = options[<span class="stringliteral">&quot;disable-subjective-account-billing&quot;</span>].as&lt;std::vector&lt;std::string&gt;&gt;();</div>
<div class="line"><a id="l01162" name="l01162"></a><span class="lineno"> 1162</span>      <span class="keywordflow">for</span>( <span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code hl_variable" href="pointer_8h.html#aeeddce917cf130d62c370b8f216026dd">a</a> : accounts ) {</div>
<div class="line"><a id="l01163" name="l01163"></a><span class="lineno"> 1163</span>         my-&gt;_subjective_billing.disable_account( <a class="code hl_typedef" href="namespacesysio_1_1chain.html#ac32ce8e75243f2b3f76aff0c1984f11b">account_name</a>(<a class="code hl_variable" href="pointer_8h.html#aeeddce917cf130d62c370b8f216026dd">a</a>) );</div>
<div class="line"><a id="l01164" name="l01164"></a><span class="lineno"> 1164</span>      }</div>
<div class="line"><a id="l01165" name="l01165"></a><span class="lineno"> 1165</span>   }</div>
<div class="line"><a id="l01166" name="l01166"></a><span class="lineno"> 1166</span> </div>
<div class="line"><a id="l01167" name="l01167"></a><span class="lineno"> 1167</span>} <a class="code hl_define" href="exception_8hpp.html#ae70bfa24f5a3bc0917382b3c17fc033c">FC_LOG_AND_RETHROW</a>() }</div>
</div>
<div class="line"><a id="l01168" name="l01168"></a><span class="lineno"> 1168</span> </div>
<div class="foldopen" id="foldopen01169" data-start="{" data-end="}">
<div class="line"><a id="l01169" name="l01169"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin.html#abf34033a4e4a5564fd2098ee7a1b733b"> 1169</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1producer__plugin.html#abf34033a4e4a5564fd2098ee7a1b733b">producer_plugin::plugin_startup</a>()</div>
<div class="line"><a id="l01170" name="l01170"></a><span class="lineno"> 1170</span>{ <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l01171" name="l01171"></a><span class="lineno"> 1171</span>   <a class="code hl_function" href="classsysio_1_1producer__plugin.html#a9c78e75e5222bbb493a5c1fb0919a9e2">handle_sighup</a>(); <span class="comment">// Sets loggers</span></div>
<div class="line"><a id="l01172" name="l01172"></a><span class="lineno"> 1172</span> </div>
<div class="line"><a id="l01173" name="l01173"></a><span class="lineno"> 1173</span>   <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l01174" name="l01174"></a><span class="lineno"> 1174</span>   <a class="code hl_define" href="logger_8hpp.html#a831cf08dc63704c11fd154132c6e8bdb">ilog</a>(<span class="stringliteral">&quot;producer plugin:  plugin_startup() begin&quot;</span>);</div>
<div class="line"><a id="l01175" name="l01175"></a><span class="lineno"> 1175</span> </div>
<div class="line"><a id="l01176" name="l01176"></a><span class="lineno"> 1176</span>   <a class="code hl_class" href="classsysio_1_1chain_1_1controller.html">chain::controller</a>&amp; chain = my-&gt;chain_plug-&gt;chain();</div>
<div class="line"><a id="l01177" name="l01177"></a><span class="lineno"> 1177</span>   <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( my-&gt;_producers.empty() || chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a28d33629f3badcb8155c08be3e05b99e">get_read_mode</a>() == <a class="code hl_enumvalue" href="namespacesysio_1_1chain.html#af3e35f3e1b78dd00fa247009a2d9ba5ea26ca3b6826ca765f741f39ec4754d581">chain::db_read_mode::SPECULATIVE</a>, plugin_config_exception,</div>
<div class="line"><a id="l01178" name="l01178"></a><span class="lineno"> 1178</span>              <span class="stringliteral">&quot;node cannot have any producer-name configured because block production is impossible when read_mode is not \&quot;speculative\&quot;&quot;</span> );</div>
<div class="line"><a id="l01179" name="l01179"></a><span class="lineno"> 1179</span> </div>
<div class="line"><a id="l01180" name="l01180"></a><span class="lineno"> 1180</span>   <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( my-&gt;_producers.empty() || chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a125b3c8fdc58904ce8179b68d1ea4172">get_validation_mode</a>() == <a class="code hl_enumvalue" href="namespacesysio_1_1chain.html#a7d207c8c6bf978826102eca76da530e0aba7de5bc6888294e5884b024a4c894f1">chain::validation_mode::FULL</a>, plugin_config_exception,</div>
<div class="line"><a id="l01181" name="l01181"></a><span class="lineno"> 1181</span>              <span class="stringliteral">&quot;node cannot have any producer-name configured because block production is not safe when validation_mode is not \&quot;full\&quot;&quot;</span> );</div>
<div class="line"><a id="l01182" name="l01182"></a><span class="lineno"> 1182</span> </div>
<div class="line"><a id="l01183" name="l01183"></a><span class="lineno"> 1183</span>   <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( my-&gt;_producers.empty() || my-&gt;chain_plug-&gt;accept_transactions(), plugin_config_exception,</div>
<div class="line"><a id="l01184" name="l01184"></a><span class="lineno"> 1184</span>              <span class="stringliteral">&quot;node cannot have any producer-name configured because no block production is possible with no [api|p2p]-accepted-transactions&quot;</span> );</div>
<div class="line"><a id="l01185" name="l01185"></a><span class="lineno"> 1185</span> </div>
<div class="line"><a id="l01186" name="l01186"></a><span class="lineno"> 1186</span>   my-&gt;_accepted_block_connection.emplace(chain.<a class="code hl_variable" href="classsysio_1_1chain_1_1controller.html#a1ff3607461fff45552db45cec5aca012">accepted_block</a>.connect( [<span class="keyword">this</span>]( <span class="keyword">const</span> <span class="keyword">auto</span>&amp; bsp ){ my-&gt;on_block( bsp ); } ));</div>
<div class="line"><a id="l01187" name="l01187"></a><span class="lineno"> 1187</span>   my-&gt;_accepted_block_header_connection.emplace(chain.<a class="code hl_variable" href="classsysio_1_1chain_1_1controller.html#a0a0659166483870bf065f4d5e671484e">accepted_block_header</a>.connect( [<span class="keyword">this</span>]( <span class="keyword">const</span> <span class="keyword">auto</span>&amp; bsp ){ my-&gt;on_block_header( bsp ); } ));</div>
<div class="line"><a id="l01188" name="l01188"></a><span class="lineno"> 1188</span>   my-&gt;_irreversible_block_connection.emplace(chain.<a class="code hl_variable" href="classsysio_1_1chain_1_1controller.html#a27266ebf16b6dd19a860635f7d1f9930">irreversible_block</a>.connect( [<span class="keyword">this</span>]( <span class="keyword">const</span> <span class="keyword">auto</span>&amp; bsp ){ my-&gt;on_irreversible_block( bsp-&gt;block ); } ));</div>
<div class="line"><a id="l01189" name="l01189"></a><span class="lineno"> 1189</span> </div>
<div class="line"><a id="l01190" name="l01190"></a><span class="lineno"> 1190</span>   <span class="keyword">const</span> <span class="keyword">auto</span> lib_num = chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a53495de416021a4e56e889e771b25a52">last_irreversible_block_num</a>();</div>
<div class="line"><a id="l01191" name="l01191"></a><span class="lineno"> 1191</span>   <span class="keyword">const</span> <span class="keyword">auto</span> lib = chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a1379e43325b7e517a058bddce15571eb">fetch_block_by_number</a>(lib_num);</div>
<div class="line"><a id="l01192" name="l01192"></a><span class="lineno"> 1192</span>   <span class="keywordflow">if</span> (lib) {</div>
<div class="line"><a id="l01193" name="l01193"></a><span class="lineno"> 1193</span>      my-&gt;on_irreversible_block(lib);</div>
<div class="line"><a id="l01194" name="l01194"></a><span class="lineno"> 1194</span>   } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01195" name="l01195"></a><span class="lineno"> 1195</span>      my-&gt;_irreversible_block_time = <a class="code hl_function" href="classfc_1_1time__point.html#aeccf1b70aa34b132c5269313b8a50573">fc::time_point::maximum</a>();</div>
<div class="line"><a id="l01196" name="l01196"></a><span class="lineno"> 1196</span>   }</div>
<div class="line"><a id="l01197" name="l01197"></a><span class="lineno"> 1197</span> </div>
<div class="line"><a id="l01198" name="l01198"></a><span class="lineno"> 1198</span>   <span class="keywordflow">if</span> (!my-&gt;_producers.empty()) {</div>
<div class="line"><a id="l01199" name="l01199"></a><span class="lineno"> 1199</span>      <a class="code hl_define" href="logger_8hpp.html#a831cf08dc63704c11fd154132c6e8bdb">ilog</a>(<span class="stringliteral">&quot;Launching block production for ${n} producers at ${time}.&quot;</span>, (<span class="stringliteral">&quot;n&quot;</span>, my-&gt;_producers.size())(<span class="stringliteral">&quot;time&quot;</span>,<a class="code hl_function" href="classfc_1_1time__point.html#aa164ff1268a16d4b32afcff181f6100e">fc::time_point::now</a>()));</div>
<div class="line"><a id="l01200" name="l01200"></a><span class="lineno"> 1200</span> </div>
<div class="line"><a id="l01201" name="l01201"></a><span class="lineno"> 1201</span>      <span class="keywordflow">if</span> (my-&gt;_production_enabled) {</div>
<div class="line"><a id="l01202" name="l01202"></a><span class="lineno"> 1202</span>         <span class="keywordflow">if</span> (chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a33704b4936bb9bbd2ea6b0874ca521b4">head_block_num</a>() == 0) {</div>
<div class="line"><a id="l01203" name="l01203"></a><span class="lineno"> 1203</span>            <a class="code hl_function" href="namespacesysio.html#ae6b502dce0e50dbe3d9ee47f1ba720d1">new_chain_banner</a>(chain);</div>
<div class="line"><a id="l01204" name="l01204"></a><span class="lineno"> 1204</span>         }</div>
<div class="line"><a id="l01205" name="l01205"></a><span class="lineno"> 1205</span>      }</div>
<div class="line"><a id="l01206" name="l01206"></a><span class="lineno"> 1206</span>   }</div>
<div class="line"><a id="l01207" name="l01207"></a><span class="lineno"> 1207</span> </div>
<div class="line"><a id="l01208" name="l01208"></a><span class="lineno"> 1208</span>   my-&gt;schedule_production_loop();</div>
<div class="line"><a id="l01209" name="l01209"></a><span class="lineno"> 1209</span> </div>
<div class="line"><a id="l01210" name="l01210"></a><span class="lineno"> 1210</span>   <a class="code hl_define" href="logger_8hpp.html#a831cf08dc63704c11fd154132c6e8bdb">ilog</a>(<span class="stringliteral">&quot;producer plugin:  plugin_startup() end&quot;</span>);</div>
<div class="line"><a id="l01211" name="l01211"></a><span class="lineno"> 1211</span>   } <span class="keywordflow">catch</span>( ... ) {</div>
<div class="line"><a id="l01212" name="l01212"></a><span class="lineno"> 1212</span>      <span class="comment">// always call plugin_shutdown, even on exception</span></div>
<div class="line"><a id="l01213" name="l01213"></a><span class="lineno"> 1213</span>      <a class="code hl_function" href="classsysio_1_1producer__plugin.html#a593d5f1c1ffa7d1c66d6d5aec2b171d2">plugin_shutdown</a>();</div>
<div class="line"><a id="l01214" name="l01214"></a><span class="lineno"> 1214</span>      <span class="keywordflow">throw</span>;</div>
<div class="line"><a id="l01215" name="l01215"></a><span class="lineno"> 1215</span>   }</div>
<div class="line"><a id="l01216" name="l01216"></a><span class="lineno"> 1216</span>} <a class="code hl_define" href="exception_8hpp.html#a094902280cad82ad6529ebbd12a697eb">FC_CAPTURE_AND_RETHROW</a>() }</div>
</div>
<div class="line"><a id="l01217" name="l01217"></a><span class="lineno"> 1217</span> </div>
<div class="foldopen" id="foldopen01218" data-start="{" data-end="}">
<div class="line"><a id="l01218" name="l01218"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin.html#a593d5f1c1ffa7d1c66d6d5aec2b171d2"> 1218</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1producer__plugin.html#a593d5f1c1ffa7d1c66d6d5aec2b171d2">producer_plugin::plugin_shutdown</a>() {</div>
<div class="line"><a id="l01219" name="l01219"></a><span class="lineno"> 1219</span>   <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l01220" name="l01220"></a><span class="lineno"> 1220</span>      my-&gt;_timer.cancel();</div>
<div class="line"><a id="l01221" name="l01221"></a><span class="lineno"> 1221</span>   } <span class="keywordflow">catch</span> ( <span class="keyword">const</span> std::bad_alloc&amp; ) {</div>
<div class="line"><a id="l01222" name="l01222"></a><span class="lineno"> 1222</span>     <a class="code hl_function" href="classsysio_1_1chain__plugin.html#a9fb4d31b915fb0d2ef5392a4284b67e6">chain_plugin::handle_bad_alloc</a>();</div>
<div class="line"><a id="l01223" name="l01223"></a><span class="lineno"> 1223</span>   } <span class="keywordflow">catch</span> ( <span class="keyword">const</span> boost::interprocess::bad_alloc&amp; ) {</div>
<div class="line"><a id="l01224" name="l01224"></a><span class="lineno"> 1224</span>     <a class="code hl_function" href="classsysio_1_1chain__plugin.html#a9fb4d31b915fb0d2ef5392a4284b67e6">chain_plugin::handle_bad_alloc</a>();</div>
<div class="line"><a id="l01225" name="l01225"></a><span class="lineno"> 1225</span>   } <span class="keywordflow">catch</span>(<span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1exception.html">fc::exception</a>&amp; e) {</div>
<div class="line"><a id="l01226" name="l01226"></a><span class="lineno"> 1226</span>      <a class="code hl_define" href="logger_8hpp.html#a26aaf645dd9dc96836635d6b18bd1090">edump</a>((e.<a class="code hl_function" href="classfc_1_1exception.html#a7611ea8fbe25dde56649b685c2298a37">to_detail_string</a>()));</div>
<div class="line"><a id="l01227" name="l01227"></a><span class="lineno"> 1227</span>   } <span class="keywordflow">catch</span>(<span class="keyword">const</span> std::exception&amp; e) {</div>
<div class="line"><a id="l01228" name="l01228"></a><span class="lineno"> 1228</span>      <a class="code hl_define" href="logger_8hpp.html#a26aaf645dd9dc96836635d6b18bd1090">edump</a>((<a class="code hl_function" href="classfc_1_1std__exception__wrapper.html#ae5ad64f84b1d373f5b92031566284c7c">fc::std_exception_wrapper::from_current_exception</a>(e).to_detail_string()));</div>
<div class="line"><a id="l01229" name="l01229"></a><span class="lineno"> 1229</span>   }</div>
<div class="line"><a id="l01230" name="l01230"></a><span class="lineno"> 1230</span> </div>
<div class="line"><a id="l01231" name="l01231"></a><span class="lineno"> 1231</span>   <span class="keywordflow">if</span>( my-&gt;_thread_pool ) {</div>
<div class="line"><a id="l01232" name="l01232"></a><span class="lineno"> 1232</span>      my-&gt;_thread_pool-&gt;stop();</div>
<div class="line"><a id="l01233" name="l01233"></a><span class="lineno"> 1233</span>   }</div>
<div class="line"><a id="l01234" name="l01234"></a><span class="lineno"> 1234</span> </div>
<div class="line"><a id="l01235" name="l01235"></a><span class="lineno"> 1235</span>   <a class="code hl_function" href="namespaceappbase.html#a99374dc23934f008a09f2f79be9eae40">app</a>().<a class="code hl_function" href="classappbase_1_1application.html#a77aff91b861010fd61a616c59b310dcc">post</a>( 0, [me = my](){} ); <span class="comment">// keep my pointer alive until queue is drained</span></div>
<div class="line"><a id="l01236" name="l01236"></a><span class="lineno"> 1236</span>   <a class="code hl_define" href="logger_8hpp.html#a067e87b091ade3787bcdda5775354654">fc_ilog</a>(<a class="code hl_variable" href="producer__plugin_8cpp.html#adff615e9fbe43b3e6443687be568cffd">_log</a>, <span class="stringliteral">&quot;exit shutdown&quot;</span>);</div>
<div class="line"><a id="l01237" name="l01237"></a><span class="lineno"> 1237</span>}</div>
</div>
<div class="line"><a id="l01238" name="l01238"></a><span class="lineno"> 1238</span> </div>
<div class="foldopen" id="foldopen01239" data-start="{" data-end="}">
<div class="line"><a id="l01239" name="l01239"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin.html#a9c78e75e5222bbb493a5c1fb0919a9e2"> 1239</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1producer__plugin.html#a9c78e75e5222bbb493a5c1fb0919a9e2">producer_plugin::handle_sighup</a>() {</div>
<div class="line"><a id="l01240" name="l01240"></a><span class="lineno"> 1240</span>   <a class="code hl_function" href="classfc_1_1logger.html#a2214632598874a4e52a5500a6346515e">fc::logger::update</a>( <a class="code hl_function" href="namespacesysio.html#ad66b67a8dd0a897a0a5b89f954fd3ade">logger_name</a>, <a class="code hl_variable" href="producer__plugin_8cpp.html#adff615e9fbe43b3e6443687be568cffd">_log</a> );</div>
<div class="line"><a id="l01241" name="l01241"></a><span class="lineno"> 1241</span>   <a class="code hl_function" href="classfc_1_1logger.html#a2214632598874a4e52a5500a6346515e">fc::logger::update</a>(<a class="code hl_function" href="producer__plugin_8cpp.html#ada404895f53490702144cecc3a82b6d4">trx_successful_trace_logger_name</a>, <a class="code hl_variable" href="producer__plugin_8cpp.html#aea18f7b7425ddc0191447aca7c3e27f6">_trx_successful_trace_log</a>);</div>
<div class="line"><a id="l01242" name="l01242"></a><span class="lineno"> 1242</span>   <a class="code hl_function" href="classfc_1_1logger.html#a2214632598874a4e52a5500a6346515e">fc::logger::update</a>(<a class="code hl_function" href="producer__plugin_8cpp.html#a621f886a258aed68a24a53ffb3b0c36d">trx_failed_trace_logger_name</a>, <a class="code hl_variable" href="producer__plugin_8cpp.html#ae93a86d470c7e16b50ab7102170c5d4e">_trx_failed_trace_log</a>);</div>
<div class="line"><a id="l01243" name="l01243"></a><span class="lineno"> 1243</span>   <a class="code hl_function" href="classfc_1_1logger.html#a2214632598874a4e52a5500a6346515e">fc::logger::update</a>(<a class="code hl_function" href="producer__plugin_8cpp.html#ae546cf0f5f4ee210f917a432e3c1bc42">trx_trace_success_logger_name</a>, <a class="code hl_variable" href="producer__plugin_8cpp.html#a79c03faf256096a8e1ad0d59c8760d2e">_trx_trace_success_log</a>);</div>
<div class="line"><a id="l01244" name="l01244"></a><span class="lineno"> 1244</span>   <a class="code hl_function" href="classfc_1_1logger.html#a2214632598874a4e52a5500a6346515e">fc::logger::update</a>(<a class="code hl_function" href="producer__plugin_8cpp.html#a54d7146c8088d64735b0cfbbea3ecae8">trx_trace_failure_logger_name</a>, <a class="code hl_variable" href="producer__plugin_8cpp.html#a979f47bc56a17944271d72bccb834c33">_trx_trace_failure_log</a>);</div>
<div class="line"><a id="l01245" name="l01245"></a><span class="lineno"> 1245</span>   <a class="code hl_function" href="classfc_1_1logger.html#a2214632598874a4e52a5500a6346515e">fc::logger::update</a>(<a class="code hl_function" href="producer__plugin_8cpp.html#af25e4084ac685ca1a7777524a948d81f">trx_logger_name</a>, <a class="code hl_variable" href="producer__plugin_8cpp.html#a78396757cc70405744561b647c892edf">_trx_log</a>);</div>
<div class="line"><a id="l01246" name="l01246"></a><span class="lineno"> 1246</span>}</div>
</div>
<div class="line"><a id="l01247" name="l01247"></a><span class="lineno"> 1247</span> </div>
<div class="foldopen" id="foldopen01248" data-start="{" data-end="}">
<div class="line"><a id="l01248" name="l01248"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin.html#a4417c46bdc9109ea4b89cd1cc1a7754f"> 1248</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1producer__plugin.html#a4417c46bdc9109ea4b89cd1cc1a7754f">producer_plugin::pause</a>() {</div>
<div class="line"><a id="l01249" name="l01249"></a><span class="lineno"> 1249</span>   <a class="code hl_define" href="logger_8hpp.html#a067e87b091ade3787bcdda5775354654">fc_ilog</a>(<a class="code hl_variable" href="producer__plugin_8cpp.html#adff615e9fbe43b3e6443687be568cffd">_log</a>, <span class="stringliteral">&quot;Producer paused.&quot;</span>);</div>
<div class="line"><a id="l01250" name="l01250"></a><span class="lineno"> 1250</span>   my-&gt;_pause_production = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01251" name="l01251"></a><span class="lineno"> 1251</span>}</div>
</div>
<div class="line"><a id="l01252" name="l01252"></a><span class="lineno"> 1252</span> </div>
<div class="foldopen" id="foldopen01253" data-start="{" data-end="}">
<div class="line"><a id="l01253" name="l01253"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin.html#a218365f30a785fa430e8f91b9de78189"> 1253</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1producer__plugin.html#a218365f30a785fa430e8f91b9de78189">producer_plugin::resume</a>() {</div>
<div class="line"><a id="l01254" name="l01254"></a><span class="lineno"> 1254</span>   my-&gt;_pause_production = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01255" name="l01255"></a><span class="lineno"> 1255</span>   <span class="comment">// it is possible that we are only speculating because of this policy which we have now changed</span></div>
<div class="line"><a id="l01256" name="l01256"></a><span class="lineno"> 1256</span>   <span class="comment">// re-evaluate that now</span></div>
<div class="line"><a id="l01257" name="l01257"></a><span class="lineno"> 1257</span>   <span class="comment">//</span></div>
<div class="line"><a id="l01258" name="l01258"></a><span class="lineno"> 1258</span>   <span class="keywordflow">if</span> (my-&gt;_pending_block_mode == <a class="code hl_enumvalue" href="namespacesysio.html#acd1c637e1a22040dbf666b0301cbc475aa25b9b4361a3bd215c739cf4f9cf2e4a">pending_block_mode::speculating</a>) {</div>
<div class="line"><a id="l01259" name="l01259"></a><span class="lineno"> 1259</span>      my-&gt;abort_block();</div>
<div class="line"><a id="l01260" name="l01260"></a><span class="lineno"> 1260</span>      <a class="code hl_define" href="logger_8hpp.html#a067e87b091ade3787bcdda5775354654">fc_ilog</a>(<a class="code hl_variable" href="producer__plugin_8cpp.html#adff615e9fbe43b3e6443687be568cffd">_log</a>, <span class="stringliteral">&quot;Producer resumed. Scheduling production.&quot;</span>);</div>
<div class="line"><a id="l01261" name="l01261"></a><span class="lineno"> 1261</span>      my-&gt;schedule_production_loop();</div>
<div class="line"><a id="l01262" name="l01262"></a><span class="lineno"> 1262</span>   } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01263" name="l01263"></a><span class="lineno"> 1263</span>      <a class="code hl_define" href="logger_8hpp.html#a067e87b091ade3787bcdda5775354654">fc_ilog</a>(<a class="code hl_variable" href="producer__plugin_8cpp.html#adff615e9fbe43b3e6443687be568cffd">_log</a>, <span class="stringliteral">&quot;Producer resumed.&quot;</span>);</div>
<div class="line"><a id="l01264" name="l01264"></a><span class="lineno"> 1264</span>   }</div>
<div class="line"><a id="l01265" name="l01265"></a><span class="lineno"> 1265</span>}</div>
</div>
<div class="line"><a id="l01266" name="l01266"></a><span class="lineno"> 1266</span> </div>
<div class="foldopen" id="foldopen01267" data-start="{" data-end="}">
<div class="line"><a id="l01267" name="l01267"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin.html#a8f313f90e7d45e3a49735ad2f903d473"> 1267</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="classsysio_1_1producer__plugin.html#a8f313f90e7d45e3a49735ad2f903d473">producer_plugin::paused</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a id="l01268" name="l01268"></a><span class="lineno"> 1268</span>   <span class="keywordflow">return</span> my-&gt;_pause_production;</div>
<div class="line"><a id="l01269" name="l01269"></a><span class="lineno"> 1269</span>}</div>
</div>
<div class="line"><a id="l01270" name="l01270"></a><span class="lineno"> 1270</span> </div>
<div class="foldopen" id="foldopen01271" data-start="{" data-end="}">
<div class="line"><a id="l01271" name="l01271"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin.html#af16be413ed6c398d92d38a52cab83525"> 1271</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1producer__plugin.html#af16be413ed6c398d92d38a52cab83525">producer_plugin::update_runtime_options</a>(<span class="keyword">const</span> runtime_options&amp; options) {</div>
<div class="line"><a id="l01272" name="l01272"></a><span class="lineno"> 1272</span>   <a class="code hl_class" href="classsysio_1_1chain_1_1controller.html">chain::controller</a>&amp; chain = my-&gt;chain_plug-&gt;chain();</div>
<div class="line"><a id="l01273" name="l01273"></a><span class="lineno"> 1273</span>   <span class="keywordtype">bool</span> check_speculating = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01274" name="l01274"></a><span class="lineno"> 1274</span> </div>
<div class="line"><a id="l01275" name="l01275"></a><span class="lineno"> 1275</span>   <span class="keywordflow">if</span> (options.max_transaction_time) {</div>
<div class="line"><a id="l01276" name="l01276"></a><span class="lineno"> 1276</span>      my-&gt;_max_transaction_time_ms = *options.max_transaction_time;</div>
<div class="line"><a id="l01277" name="l01277"></a><span class="lineno"> 1277</span>   }</div>
<div class="line"><a id="l01278" name="l01278"></a><span class="lineno"> 1278</span> </div>
<div class="line"><a id="l01279" name="l01279"></a><span class="lineno"> 1279</span>   <span class="keywordflow">if</span> (options.max_irreversible_block_age) {</div>
<div class="line"><a id="l01280" name="l01280"></a><span class="lineno"> 1280</span>      my-&gt;_max_irreversible_block_age_us =  <a class="code hl_function" href="namespacefc.html#a9623b8cae3f48bbed6aa1fc2afe9b174">fc::seconds</a>(*options.max_irreversible_block_age);</div>
<div class="line"><a id="l01281" name="l01281"></a><span class="lineno"> 1281</span>      check_speculating = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01282" name="l01282"></a><span class="lineno"> 1282</span>   }</div>
<div class="line"><a id="l01283" name="l01283"></a><span class="lineno"> 1283</span> </div>
<div class="line"><a id="l01284" name="l01284"></a><span class="lineno"> 1284</span>   <span class="keywordflow">if</span> (options.produce_time_offset_us) {</div>
<div class="line"><a id="l01285" name="l01285"></a><span class="lineno"> 1285</span>      my-&gt;_produce_time_offset_us = *options.produce_time_offset_us;</div>
<div class="line"><a id="l01286" name="l01286"></a><span class="lineno"> 1286</span>   }</div>
<div class="line"><a id="l01287" name="l01287"></a><span class="lineno"> 1287</span> </div>
<div class="line"><a id="l01288" name="l01288"></a><span class="lineno"> 1288</span>   <span class="keywordflow">if</span> (options.last_block_time_offset_us) {</div>
<div class="line"><a id="l01289" name="l01289"></a><span class="lineno"> 1289</span>      my-&gt;_last_block_time_offset_us = *options.last_block_time_offset_us;</div>
<div class="line"><a id="l01290" name="l01290"></a><span class="lineno"> 1290</span>   }</div>
<div class="line"><a id="l01291" name="l01291"></a><span class="lineno"> 1291</span> </div>
<div class="line"><a id="l01292" name="l01292"></a><span class="lineno"> 1292</span>   <span class="keywordflow">if</span> (options.max_scheduled_transaction_time_per_block_ms) {</div>
<div class="line"><a id="l01293" name="l01293"></a><span class="lineno"> 1293</span>      my-&gt;_max_scheduled_transaction_time_per_block_ms = *options.max_scheduled_transaction_time_per_block_ms;</div>
<div class="line"><a id="l01294" name="l01294"></a><span class="lineno"> 1294</span>   }</div>
<div class="line"><a id="l01295" name="l01295"></a><span class="lineno"> 1295</span> </div>
<div class="line"><a id="l01296" name="l01296"></a><span class="lineno"> 1296</span>   <span class="keywordflow">if</span> (options.incoming_defer_ratio) {</div>
<div class="line"><a id="l01297" name="l01297"></a><span class="lineno"> 1297</span>      my-&gt;_incoming_defer_ratio = *options.incoming_defer_ratio;</div>
<div class="line"><a id="l01298" name="l01298"></a><span class="lineno"> 1298</span>   }</div>
<div class="line"><a id="l01299" name="l01299"></a><span class="lineno"> 1299</span> </div>
<div class="line"><a id="l01300" name="l01300"></a><span class="lineno"> 1300</span>   <span class="keywordflow">if</span> (check_speculating &amp;&amp; my-&gt;_pending_block_mode == <a class="code hl_enumvalue" href="namespacesysio.html#acd1c637e1a22040dbf666b0301cbc475aa25b9b4361a3bd215c739cf4f9cf2e4a">pending_block_mode::speculating</a>) {</div>
<div class="line"><a id="l01301" name="l01301"></a><span class="lineno"> 1301</span>      my-&gt;abort_block();</div>
<div class="line"><a id="l01302" name="l01302"></a><span class="lineno"> 1302</span>      my-&gt;schedule_production_loop();</div>
<div class="line"><a id="l01303" name="l01303"></a><span class="lineno"> 1303</span>   }</div>
<div class="line"><a id="l01304" name="l01304"></a><span class="lineno"> 1304</span> </div>
<div class="line"><a id="l01305" name="l01305"></a><span class="lineno"> 1305</span>   <span class="keywordflow">if</span> (options.subjective_cpu_leeway_us) {</div>
<div class="line"><a id="l01306" name="l01306"></a><span class="lineno"> 1306</span>      chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#ac8d3310c59100f18efeb9a7007a21103">set_subjective_cpu_leeway</a>(<a class="code hl_class" href="classfc_1_1microseconds.html">fc::microseconds</a>(*options.subjective_cpu_leeway_us));</div>
<div class="line"><a id="l01307" name="l01307"></a><span class="lineno"> 1307</span>   }</div>
<div class="line"><a id="l01308" name="l01308"></a><span class="lineno"> 1308</span> </div>
<div class="line"><a id="l01309" name="l01309"></a><span class="lineno"> 1309</span>   <span class="keywordflow">if</span> (options.greylist_limit) {</div>
<div class="line"><a id="l01310" name="l01310"></a><span class="lineno"> 1310</span>      chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a03d5ea18c641a8899af9bdbdf9da9f81">set_greylist_limit</a>(*options.greylist_limit);</div>
<div class="line"><a id="l01311" name="l01311"></a><span class="lineno"> 1311</span>   }</div>
<div class="line"><a id="l01312" name="l01312"></a><span class="lineno"> 1312</span>}</div>
</div>
<div class="line"><a id="l01313" name="l01313"></a><span class="lineno"> 1313</span> </div>
<div class="foldopen" id="foldopen01314" data-start="{" data-end="}">
<div class="line"><a id="l01314" name="l01314"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin.html#a7778d729b4a628fa3fdd5b07f1545c22"> 1314</a></span>producer_plugin::runtime_options <a class="code hl_function" href="classsysio_1_1producer__plugin.html#a7778d729b4a628fa3fdd5b07f1545c22">producer_plugin::get_runtime_options</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a id="l01315" name="l01315"></a><span class="lineno"> 1315</span>   <span class="keywordflow">return</span> {</div>
<div class="line"><a id="l01316" name="l01316"></a><span class="lineno"> 1316</span>      my-&gt;_max_transaction_time_ms,</div>
<div class="line"><a id="l01317" name="l01317"></a><span class="lineno"> 1317</span>      my-&gt;_max_irreversible_block_age_us.count() &lt; 0 ? -1 : my-&gt;_max_irreversible_block_age_us.count() / 1&#39;000&#39;000,</div>
<div class="line"><a id="l01318" name="l01318"></a><span class="lineno"> 1318</span>      my-&gt;_produce_time_offset_us,</div>
<div class="line"><a id="l01319" name="l01319"></a><span class="lineno"> 1319</span>      my-&gt;_last_block_time_offset_us,</div>
<div class="line"><a id="l01320" name="l01320"></a><span class="lineno"> 1320</span>      my-&gt;_max_scheduled_transaction_time_per_block_ms,</div>
<div class="line"><a id="l01321" name="l01321"></a><span class="lineno"> 1321</span>      my-&gt;chain_plug-&gt;chain().get_subjective_cpu_leeway() ?</div>
<div class="line"><a id="l01322" name="l01322"></a><span class="lineno"> 1322</span>            my-&gt;chain_plug-&gt;chain().get_subjective_cpu_leeway()-&gt;count() :</div>
<div class="line"><a id="l01323" name="l01323"></a><span class="lineno"> 1323</span>            std::optional&lt;int32_t&gt;(),</div>
<div class="line"><a id="l01324" name="l01324"></a><span class="lineno"> 1324</span>      my-&gt;_incoming_defer_ratio,</div>
<div class="line"><a id="l01325" name="l01325"></a><span class="lineno"> 1325</span>      my-&gt;chain_plug-&gt;chain().get_greylist_limit()</div>
<div class="line"><a id="l01326" name="l01326"></a><span class="lineno"> 1326</span>   };</div>
<div class="line"><a id="l01327" name="l01327"></a><span class="lineno"> 1327</span>}</div>
</div>
<div class="line"><a id="l01328" name="l01328"></a><span class="lineno"> 1328</span> </div>
<div class="foldopen" id="foldopen01329" data-start="{" data-end="}">
<div class="line"><a id="l01329" name="l01329"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin.html#a967d53a8cf3bd8aa79fdf07bf2603db6"> 1329</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1producer__plugin.html#a967d53a8cf3bd8aa79fdf07bf2603db6">producer_plugin::add_greylist_accounts</a>(<span class="keyword">const</span> <a class="code hl_struct" href="structsysio_1_1producer__plugin_1_1greylist__params.html">greylist_params</a>&amp; <a class="code hl_struct" href="structsysio_1_1chain__apis_1_1account__query__db_1_1get__accounts__by__authorizers__params.html">params</a>) {</div>
<div class="line"><a id="l01330" name="l01330"></a><span class="lineno"> 1330</span>   <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>(<a class="code hl_struct" href="structsysio_1_1chain__apis_1_1account__query__db_1_1get__accounts__by__authorizers__params.html">params</a>.<a class="code hl_variable" href="structsysio_1_1chain__apis_1_1account__query__db_1_1get__accounts__by__authorizers__params.html#a3a982b7949e6e5b9ea508448c1f8d8af">accounts</a>.size() &gt; 0, chain::invalid_http_request, <span class="stringliteral">&quot;At least one account is required&quot;</span>);</div>
<div class="line"><a id="l01331" name="l01331"></a><span class="lineno"> 1331</span> </div>
<div class="line"><a id="l01332" name="l01332"></a><span class="lineno"> 1332</span>   <a class="code hl_class" href="classsysio_1_1chain_1_1controller.html">chain::controller</a>&amp; chain = my-&gt;chain_plug-&gt;chain();</div>
<div class="line"><a id="l01333" name="l01333"></a><span class="lineno"> 1333</span>   <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;acc : <a class="code hl_struct" href="structsysio_1_1chain__apis_1_1account__query__db_1_1get__accounts__by__authorizers__params.html">params</a>.<a class="code hl_variable" href="structsysio_1_1chain__apis_1_1account__query__db_1_1get__accounts__by__authorizers__params.html#a3a982b7949e6e5b9ea508448c1f8d8af">accounts</a>) {</div>
<div class="line"><a id="l01334" name="l01334"></a><span class="lineno"> 1334</span>      chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#ad0b710fd894bc8c7265b7e8c958df7bc">add_resource_greylist</a>(acc);</div>
<div class="line"><a id="l01335" name="l01335"></a><span class="lineno"> 1335</span>   }</div>
<div class="line"><a id="l01336" name="l01336"></a><span class="lineno"> 1336</span>}</div>
</div>
<div class="line"><a id="l01337" name="l01337"></a><span class="lineno"> 1337</span> </div>
<div class="foldopen" id="foldopen01338" data-start="{" data-end="}">
<div class="line"><a id="l01338" name="l01338"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin.html#a6fc28177d3a114216ced04514066f7c5"> 1338</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1producer__plugin.html#a6fc28177d3a114216ced04514066f7c5">producer_plugin::remove_greylist_accounts</a>(<span class="keyword">const</span> <a class="code hl_struct" href="structsysio_1_1producer__plugin_1_1greylist__params.html">greylist_params</a>&amp; <a class="code hl_struct" href="structsysio_1_1chain__apis_1_1account__query__db_1_1get__accounts__by__authorizers__params.html">params</a>) {</div>
<div class="line"><a id="l01339" name="l01339"></a><span class="lineno"> 1339</span>   <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>(<a class="code hl_struct" href="structsysio_1_1chain__apis_1_1account__query__db_1_1get__accounts__by__authorizers__params.html">params</a>.<a class="code hl_variable" href="structsysio_1_1chain__apis_1_1account__query__db_1_1get__accounts__by__authorizers__params.html#a3a982b7949e6e5b9ea508448c1f8d8af">accounts</a>.size() &gt; 0, chain::invalid_http_request, <span class="stringliteral">&quot;At least one account is required&quot;</span>);</div>
<div class="line"><a id="l01340" name="l01340"></a><span class="lineno"> 1340</span> </div>
<div class="line"><a id="l01341" name="l01341"></a><span class="lineno"> 1341</span>   <a class="code hl_class" href="classsysio_1_1chain_1_1controller.html">chain::controller</a>&amp; chain = my-&gt;chain_plug-&gt;chain();</div>
<div class="line"><a id="l01342" name="l01342"></a><span class="lineno"> 1342</span>   <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;acc : <a class="code hl_struct" href="structsysio_1_1chain__apis_1_1account__query__db_1_1get__accounts__by__authorizers__params.html">params</a>.<a class="code hl_variable" href="structsysio_1_1chain__apis_1_1account__query__db_1_1get__accounts__by__authorizers__params.html#a3a982b7949e6e5b9ea508448c1f8d8af">accounts</a>) {</div>
<div class="line"><a id="l01343" name="l01343"></a><span class="lineno"> 1343</span>      chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a9ebce710613bffd9b019b8d9fc15d20e">remove_resource_greylist</a>(acc);</div>
<div class="line"><a id="l01344" name="l01344"></a><span class="lineno"> 1344</span>   }</div>
<div class="line"><a id="l01345" name="l01345"></a><span class="lineno"> 1345</span>}</div>
</div>
<div class="line"><a id="l01346" name="l01346"></a><span class="lineno"> 1346</span> </div>
<div class="foldopen" id="foldopen01347" data-start="{" data-end="}">
<div class="line"><a id="l01347" name="l01347"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin.html#a2226fa914717572a10b768f4e124043d"> 1347</a></span><a class="code hl_struct" href="structsysio_1_1producer__plugin_1_1greylist__params.html">producer_plugin::greylist_params</a> <a class="code hl_function" href="classsysio_1_1producer__plugin.html#a2226fa914717572a10b768f4e124043d">producer_plugin::get_greylist</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a id="l01348" name="l01348"></a><span class="lineno"> 1348</span>   <a class="code hl_class" href="classsysio_1_1chain_1_1controller.html">chain::controller</a>&amp; chain = my-&gt;chain_plug-&gt;chain();</div>
<div class="line"><a id="l01349" name="l01349"></a><span class="lineno"> 1349</span>   <a class="code hl_struct" href="structsysio_1_1producer__plugin_1_1greylist__params.html">greylist_params</a> result;</div>
<div class="line"><a id="l01350" name="l01350"></a><span class="lineno"> 1350</span>   <span class="keyword">const</span> <span class="keyword">auto</span>&amp; list = chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#aac87d5e13183ec45393587036b89a14a">get_resource_greylist</a>();</div>
<div class="line"><a id="l01351" name="l01351"></a><span class="lineno"> 1351</span>   result.accounts.reserve(list.size());</div>
<div class="line"><a id="l01352" name="l01352"></a><span class="lineno"> 1352</span>   <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;acc: list) {</div>
<div class="line"><a id="l01353" name="l01353"></a><span class="lineno"> 1353</span>      result.accounts.push_back(acc);</div>
<div class="line"><a id="l01354" name="l01354"></a><span class="lineno"> 1354</span>   }</div>
<div class="line"><a id="l01355" name="l01355"></a><span class="lineno"> 1355</span>   <span class="keywordflow">return</span> result;</div>
<div class="line"><a id="l01356" name="l01356"></a><span class="lineno"> 1356</span>}</div>
</div>
<div class="line"><a id="l01357" name="l01357"></a><span class="lineno"> 1357</span> </div>
<div class="foldopen" id="foldopen01358" data-start="{" data-end="}">
<div class="line"><a id="l01358" name="l01358"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin.html#aa6791946464ae235bbef7112d6e86f5c"> 1358</a></span><a class="code hl_struct" href="structsysio_1_1producer__plugin_1_1whitelist__blacklist.html">producer_plugin::whitelist_blacklist</a> <a class="code hl_function" href="classsysio_1_1producer__plugin.html#aa6791946464ae235bbef7112d6e86f5c">producer_plugin::get_whitelist_blacklist</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a id="l01359" name="l01359"></a><span class="lineno"> 1359</span>   <a class="code hl_class" href="classsysio_1_1chain_1_1controller.html">chain::controller</a>&amp; chain = my-&gt;chain_plug-&gt;chain();</div>
<div class="line"><a id="l01360" name="l01360"></a><span class="lineno"> 1360</span>   <span class="keywordflow">return</span> {</div>
<div class="line"><a id="l01361" name="l01361"></a><span class="lineno"> 1361</span>      chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#ae2572c1888aa71c5386d8d3fc7df75c5">get_actor_whitelist</a>(),</div>
<div class="line"><a id="l01362" name="l01362"></a><span class="lineno"> 1362</span>      chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a087c940aa88be2ccc1fbb7dd1bc28da6">get_actor_blacklist</a>(),</div>
<div class="line"><a id="l01363" name="l01363"></a><span class="lineno"> 1363</span>      chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a7408289ee5f740f797b9b9d9b192704a">get_contract_whitelist</a>(),</div>
<div class="line"><a id="l01364" name="l01364"></a><span class="lineno"> 1364</span>      chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a99c90ed934995116348fe891223e1037">get_contract_blacklist</a>(),</div>
<div class="line"><a id="l01365" name="l01365"></a><span class="lineno"> 1365</span>      chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a8a195d27a416c714bdc058b7f1919267">get_action_blacklist</a>(),</div>
<div class="line"><a id="l01366" name="l01366"></a><span class="lineno"> 1366</span>      chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#aabfe5c42521aa0550a5f5e60ec89fd19">get_key_blacklist</a>()</div>
<div class="line"><a id="l01367" name="l01367"></a><span class="lineno"> 1367</span>   };</div>
<div class="line"><a id="l01368" name="l01368"></a><span class="lineno"> 1368</span>}</div>
</div>
<div class="line"><a id="l01369" name="l01369"></a><span class="lineno"> 1369</span> </div>
<div class="foldopen" id="foldopen01370" data-start="{" data-end="}">
<div class="line"><a id="l01370" name="l01370"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin.html#abd1ea873bb29c35ed22fbc7dcea2e9d6"> 1370</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1producer__plugin.html#abd1ea873bb29c35ed22fbc7dcea2e9d6">producer_plugin::set_whitelist_blacklist</a>(<span class="keyword">const</span> <a class="code hl_struct" href="structsysio_1_1producer__plugin_1_1whitelist__blacklist.html">producer_plugin::whitelist_blacklist</a>&amp; <a class="code hl_struct" href="structsysio_1_1chain__apis_1_1account__query__db_1_1get__accounts__by__authorizers__params.html">params</a>) {</div>
<div class="line"><a id="l01371" name="l01371"></a><span class="lineno"> 1371</span>   <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>(<a class="code hl_struct" href="structsysio_1_1chain__apis_1_1account__query__db_1_1get__accounts__by__authorizers__params.html">params</a>.actor_whitelist || <a class="code hl_struct" href="structsysio_1_1chain__apis_1_1account__query__db_1_1get__accounts__by__authorizers__params.html">params</a>.actor_blacklist || <a class="code hl_struct" href="structsysio_1_1chain__apis_1_1account__query__db_1_1get__accounts__by__authorizers__params.html">params</a>.contract_whitelist || <a class="code hl_struct" href="structsysio_1_1chain__apis_1_1account__query__db_1_1get__accounts__by__authorizers__params.html">params</a>.contract_blacklist || <a class="code hl_struct" href="structsysio_1_1chain__apis_1_1account__query__db_1_1get__accounts__by__authorizers__params.html">params</a>.action_blacklist || <a class="code hl_struct" href="structsysio_1_1chain__apis_1_1account__query__db_1_1get__accounts__by__authorizers__params.html">params</a>.key_blacklist,</div>
<div class="line"><a id="l01372" name="l01372"></a><span class="lineno"> 1372</span>              chain::invalid_http_request,</div>
<div class="line"><a id="l01373" name="l01373"></a><span class="lineno"> 1373</span>              <span class="stringliteral">&quot;At least one of actor_whitelist, actor_blacklist, contract_whitelist, contract_blacklist, action_blacklist, and key_blacklist is required&quot;</span></div>
<div class="line"><a id="l01374" name="l01374"></a><span class="lineno"> 1374</span>             );</div>
<div class="line"><a id="l01375" name="l01375"></a><span class="lineno"> 1375</span> </div>
<div class="line"><a id="l01376" name="l01376"></a><span class="lineno"> 1376</span>   <a class="code hl_class" href="classsysio_1_1chain_1_1controller.html">chain::controller</a>&amp; chain = my-&gt;chain_plug-&gt;chain();</div>
<div class="line"><a id="l01377" name="l01377"></a><span class="lineno"> 1377</span>   <span class="keywordflow">if</span>(<a class="code hl_struct" href="structsysio_1_1chain__apis_1_1account__query__db_1_1get__accounts__by__authorizers__params.html">params</a>.actor_whitelist) chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a06ea0e9e805452cdd189f13df09916e8">set_actor_whitelist</a>(*<a class="code hl_struct" href="structsysio_1_1chain__apis_1_1account__query__db_1_1get__accounts__by__authorizers__params.html">params</a>.actor_whitelist);</div>
<div class="line"><a id="l01378" name="l01378"></a><span class="lineno"> 1378</span>   <span class="keywordflow">if</span>(<a class="code hl_struct" href="structsysio_1_1chain__apis_1_1account__query__db_1_1get__accounts__by__authorizers__params.html">params</a>.actor_blacklist) chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a1a695a1daba0cf887e71851a61911a37">set_actor_blacklist</a>(*<a class="code hl_struct" href="structsysio_1_1chain__apis_1_1account__query__db_1_1get__accounts__by__authorizers__params.html">params</a>.actor_blacklist);</div>
<div class="line"><a id="l01379" name="l01379"></a><span class="lineno"> 1379</span>   <span class="keywordflow">if</span>(<a class="code hl_struct" href="structsysio_1_1chain__apis_1_1account__query__db_1_1get__accounts__by__authorizers__params.html">params</a>.contract_whitelist) chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#ab156fd6d4e3f28e14373c8dbbeb5a0ed">set_contract_whitelist</a>(*<a class="code hl_struct" href="structsysio_1_1chain__apis_1_1account__query__db_1_1get__accounts__by__authorizers__params.html">params</a>.contract_whitelist);</div>
<div class="line"><a id="l01380" name="l01380"></a><span class="lineno"> 1380</span>   <span class="keywordflow">if</span>(<a class="code hl_struct" href="structsysio_1_1chain__apis_1_1account__query__db_1_1get__accounts__by__authorizers__params.html">params</a>.contract_blacklist) chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a904bf66cadfa73c918e9d835c819a524">set_contract_blacklist</a>(*<a class="code hl_struct" href="structsysio_1_1chain__apis_1_1account__query__db_1_1get__accounts__by__authorizers__params.html">params</a>.contract_blacklist);</div>
<div class="line"><a id="l01381" name="l01381"></a><span class="lineno"> 1381</span>   <span class="keywordflow">if</span>(<a class="code hl_struct" href="structsysio_1_1chain__apis_1_1account__query__db_1_1get__accounts__by__authorizers__params.html">params</a>.action_blacklist) chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#af1e44676760107bf3ed8979feb1d4f00">set_action_blacklist</a>(*<a class="code hl_struct" href="structsysio_1_1chain__apis_1_1account__query__db_1_1get__accounts__by__authorizers__params.html">params</a>.action_blacklist);</div>
<div class="line"><a id="l01382" name="l01382"></a><span class="lineno"> 1382</span>   <span class="keywordflow">if</span>(<a class="code hl_struct" href="structsysio_1_1chain__apis_1_1account__query__db_1_1get__accounts__by__authorizers__params.html">params</a>.key_blacklist) chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a5711e4cc0cff77f67d04b64373252412">set_key_blacklist</a>(*<a class="code hl_struct" href="structsysio_1_1chain__apis_1_1account__query__db_1_1get__accounts__by__authorizers__params.html">params</a>.key_blacklist);</div>
<div class="line"><a id="l01383" name="l01383"></a><span class="lineno"> 1383</span>}</div>
</div>
<div class="line"><a id="l01384" name="l01384"></a><span class="lineno"> 1384</span> </div>
<div class="foldopen" id="foldopen01385" data-start="{" data-end="}">
<div class="line"><a id="l01385" name="l01385"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin.html#afd2baf0dede255eaaf9b95ed0aa7f3e4"> 1385</a></span><a class="code hl_struct" href="structsysio_1_1producer__plugin_1_1integrity__hash__information.html">producer_plugin::integrity_hash_information</a> <a class="code hl_function" href="classsysio_1_1producer__plugin.html#afd2baf0dede255eaaf9b95ed0aa7f3e4">producer_plugin::get_integrity_hash</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a id="l01386" name="l01386"></a><span class="lineno"> 1386</span>   <a class="code hl_class" href="classsysio_1_1chain_1_1controller.html">chain::controller</a>&amp; chain = my-&gt;chain_plug-&gt;chain();</div>
<div class="line"><a id="l01387" name="l01387"></a><span class="lineno"> 1387</span> </div>
<div class="line"><a id="l01388" name="l01388"></a><span class="lineno"> 1388</span>   <span class="keyword">auto</span> reschedule = <a class="code hl_function" href="namespacefc.html#a23d89b54a8ffd84f7e7efeb21747d846">fc::make_scoped_exit</a>([<span class="keyword">this</span>](){</div>
<div class="line"><a id="l01389" name="l01389"></a><span class="lineno"> 1389</span>      my-&gt;schedule_production_loop();</div>
<div class="line"><a id="l01390" name="l01390"></a><span class="lineno"> 1390</span>   });</div>
<div class="line"><a id="l01391" name="l01391"></a><span class="lineno"> 1391</span> </div>
<div class="line"><a id="l01392" name="l01392"></a><span class="lineno"> 1392</span>   <span class="keywordflow">if</span> (chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a286751cd6498b500b70a0d3678672263">is_building_block</a>()) {</div>
<div class="line"><a id="l01393" name="l01393"></a><span class="lineno"> 1393</span>      <span class="comment">// abort the pending block</span></div>
<div class="line"><a id="l01394" name="l01394"></a><span class="lineno"> 1394</span>      my-&gt;abort_block();</div>
<div class="line"><a id="l01395" name="l01395"></a><span class="lineno"> 1395</span>   } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01396" name="l01396"></a><span class="lineno"> 1396</span>      reschedule.cancel();</div>
<div class="line"><a id="l01397" name="l01397"></a><span class="lineno"> 1397</span>   }</div>
<div class="line"><a id="l01398" name="l01398"></a><span class="lineno"> 1398</span> </div>
<div class="line"><a id="l01399" name="l01399"></a><span class="lineno"> 1399</span>   <span class="keywordflow">return</span> {chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a37d0a44faef74cf0f96127982c1ce124">head_block_id</a>(), chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#ae0a4a81d5d603085be18b54fb5a709b9">calculate_integrity_hash</a>()};</div>
<div class="line"><a id="l01400" name="l01400"></a><span class="lineno"> 1400</span>}</div>
</div>
<div class="line"><a id="l01401" name="l01401"></a><span class="lineno"> 1401</span> </div>
<div class="foldopen" id="foldopen01402" data-start="{" data-end="}">
<div class="line"><a id="l01402" name="l01402"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin.html#a62c42eef3c18cf6d357411865399fe50"> 1402</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1producer__plugin.html#a62c42eef3c18cf6d357411865399fe50">producer_plugin::create_snapshot</a>(<a class="code hl_typedef" href="classsysio_1_1producer__plugin.html#aa0f4bf0b390688408224d4bc36b74e27">producer_plugin::next_function&lt;producer_plugin::snapshot_information&gt;</a> next) {</div>
<div class="line"><a id="l01403" name="l01403"></a><span class="lineno"> 1403</span>   <a class="code hl_class" href="classsysio_1_1chain_1_1controller.html">chain::controller</a>&amp; chain = my-&gt;chain_plug-&gt;chain();</div>
<div class="line"><a id="l01404" name="l01404"></a><span class="lineno"> 1404</span> </div>
<div class="line"><a id="l01405" name="l01405"></a><span class="lineno"> 1405</span>   <span class="keyword">auto</span> head_id = chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a37d0a44faef74cf0f96127982c1ce124">head_block_id</a>();</div>
<div class="line"><a id="l01406" name="l01406"></a><span class="lineno"> 1406</span>   <span class="keyword">const</span> <span class="keyword">auto</span> head_block_num = chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a33704b4936bb9bbd2ea6b0874ca521b4">head_block_num</a>();</div>
<div class="line"><a id="l01407" name="l01407"></a><span class="lineno"> 1407</span>   <span class="keyword">const</span> <span class="keyword">auto</span> head_block_time = chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#aea3612e7cb52dfcaa2e6afdc1b3e2f51">head_block_time</a>();</div>
<div class="line"><a id="l01408" name="l01408"></a><span class="lineno"> 1408</span>   <span class="keyword">const</span> <span class="keyword">auto</span>&amp; snapshot_path = <a class="code hl_function" href="classsysio_1_1pending__snapshot.html#a79fc9801d0442d3b7f58833f23d6c9f9">pending_snapshot::get_final_path</a>(head_id, my-&gt;_snapshots_dir);</div>
<div class="line"><a id="l01409" name="l01409"></a><span class="lineno"> 1409</span>   <span class="keyword">const</span> <span class="keyword">auto</span>&amp; temp_path     = <a class="code hl_function" href="classsysio_1_1pending__snapshot.html#a5c1d883bec4e7ed86c903ad81d4301cd">pending_snapshot::get_temp_path</a>(head_id, my-&gt;_snapshots_dir);</div>
<div class="line"><a id="l01410" name="l01410"></a><span class="lineno"> 1410</span> </div>
<div class="line"><a id="l01411" name="l01411"></a><span class="lineno"> 1411</span>   <span class="comment">// maintain legacy exception if the snapshot exists</span></div>
<div class="line"><a id="l01412" name="l01412"></a><span class="lineno"> 1412</span>   <span class="keywordflow">if</span>( <a class="code hl_function" href="namespacefc.html#a6855142912d4cfb89281ba0c7f4938a2">fc::is_regular_file</a>(snapshot_path) ) {</div>
<div class="line"><a id="l01413" name="l01413"></a><span class="lineno"> 1413</span>      <span class="keyword">auto</span> ex = snapshot_exists_exception( <a class="code hl_define" href="log__message_8hpp.html#a4a4df4bb5cffbe07aadf7d29fd44c75e">FC_LOG_MESSAGE</a>( error, <span class="stringliteral">&quot;snapshot named ${name} already exists&quot;</span>, (<span class="stringliteral">&quot;name&quot;</span>, snapshot_path.generic_string()) ) );</div>
<div class="line"><a id="l01414" name="l01414"></a><span class="lineno"> 1414</span>      next(ex.dynamic_copy_exception());</div>
<div class="line"><a id="l01415" name="l01415"></a><span class="lineno"> 1415</span>      <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01416" name="l01416"></a><span class="lineno"> 1416</span>   }</div>
<div class="line"><a id="l01417" name="l01417"></a><span class="lineno"> 1417</span> </div>
<div class="line"><a id="l01418" name="l01418"></a><span class="lineno"> 1418</span>   <span class="keyword">auto</span> write_snapshot = [&amp;]( <span class="keyword">const</span> bfs::path&amp; <a class="code hl_variable" href="bn_8cpp.html#a8b0eadcc506862e9d751ab45185053aa">p</a> ) -&gt; <span class="keywordtype">void</span> {</div>
<div class="line"><a id="l01419" name="l01419"></a><span class="lineno"> 1419</span>      <span class="keyword">auto</span> reschedule = <a class="code hl_function" href="namespacefc.html#a23d89b54a8ffd84f7e7efeb21747d846">fc::make_scoped_exit</a>([<span class="keyword">this</span>](){</div>
<div class="line"><a id="l01420" name="l01420"></a><span class="lineno"> 1420</span>         my-&gt;schedule_production_loop();</div>
<div class="line"><a id="l01421" name="l01421"></a><span class="lineno"> 1421</span>      });</div>
<div class="line"><a id="l01422" name="l01422"></a><span class="lineno"> 1422</span> </div>
<div class="line"><a id="l01423" name="l01423"></a><span class="lineno"> 1423</span>      <span class="keywordflow">if</span> (chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a286751cd6498b500b70a0d3678672263">is_building_block</a>()) {</div>
<div class="line"><a id="l01424" name="l01424"></a><span class="lineno"> 1424</span>         <span class="comment">// abort the pending block</span></div>
<div class="line"><a id="l01425" name="l01425"></a><span class="lineno"> 1425</span>         my-&gt;abort_block();</div>
<div class="line"><a id="l01426" name="l01426"></a><span class="lineno"> 1426</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01427" name="l01427"></a><span class="lineno"> 1427</span>         reschedule.cancel();</div>
<div class="line"><a id="l01428" name="l01428"></a><span class="lineno"> 1428</span>      }</div>
<div class="line"><a id="l01429" name="l01429"></a><span class="lineno"> 1429</span> </div>
<div class="line"><a id="l01430" name="l01430"></a><span class="lineno"> 1430</span>      bfs::create_directory( <a class="code hl_variable" href="bn_8cpp.html#a8b0eadcc506862e9d751ab45185053aa">p</a>.parent_path() );</div>
<div class="line"><a id="l01431" name="l01431"></a><span class="lineno"> 1431</span> </div>
<div class="line"><a id="l01432" name="l01432"></a><span class="lineno"> 1432</span>      <span class="comment">// create the snapshot</span></div>
<div class="line"><a id="l01433" name="l01433"></a><span class="lineno"> 1433</span>      <span class="keyword">auto</span> snap_out = std::ofstream(<a class="code hl_variable" href="bn_8cpp.html#a8b0eadcc506862e9d751ab45185053aa">p</a>.generic_string(), (std::ios::out | std::ios::binary));</div>
<div class="line"><a id="l01434" name="l01434"></a><span class="lineno"> 1434</span>      <span class="keyword">auto</span> writer = std::make_shared&lt;ostream_snapshot_writer&gt;(snap_out);</div>
<div class="line"><a id="l01435" name="l01435"></a><span class="lineno"> 1435</span>      chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a407d1c6dfd6e7b3e1d4e1567d15e344c">write_snapshot</a>(writer);</div>
<div class="line"><a id="l01436" name="l01436"></a><span class="lineno"> 1436</span>      writer-&gt;finalize();</div>
<div class="line"><a id="l01437" name="l01437"></a><span class="lineno"> 1437</span>      snap_out.flush();</div>
<div class="line"><a id="l01438" name="l01438"></a><span class="lineno"> 1438</span>      snap_out.close();</div>
<div class="line"><a id="l01439" name="l01439"></a><span class="lineno"> 1439</span>   };</div>
<div class="line"><a id="l01440" name="l01440"></a><span class="lineno"> 1440</span> </div>
<div class="line"><a id="l01441" name="l01441"></a><span class="lineno"> 1441</span>   <span class="comment">// If in irreversible mode, create snapshot and return path to snapshot immediately.</span></div>
<div class="line"><a id="l01442" name="l01442"></a><span class="lineno"> 1442</span>   <span class="keywordflow">if</span>( chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a28d33629f3badcb8155c08be3e05b99e">get_read_mode</a>() == db_read_mode::IRREVERSIBLE ) {</div>
<div class="line"><a id="l01443" name="l01443"></a><span class="lineno"> 1443</span>      <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l01444" name="l01444"></a><span class="lineno"> 1444</span>         write_snapshot( temp_path );</div>
<div class="line"><a id="l01445" name="l01445"></a><span class="lineno"> 1445</span> </div>
<div class="line"><a id="l01446" name="l01446"></a><span class="lineno"> 1446</span>         boost::system::error_code ec;</div>
<div class="line"><a id="l01447" name="l01447"></a><span class="lineno"> 1447</span>         bfs::rename(temp_path, snapshot_path, ec);</div>
<div class="line"><a id="l01448" name="l01448"></a><span class="lineno"> 1448</span>         <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>(!ec, snapshot_finalization_exception,</div>
<div class="line"><a id="l01449" name="l01449"></a><span class="lineno"> 1449</span>               <span class="stringliteral">&quot;Unable to finalize valid snapshot of block number ${bn}: [code: ${ec}] ${message}&quot;</span>,</div>
<div class="line"><a id="l01450" name="l01450"></a><span class="lineno"> 1450</span>               (<span class="stringliteral">&quot;bn&quot;</span>, head_block_num)</div>
<div class="line"><a id="l01451" name="l01451"></a><span class="lineno"> 1451</span>               (<span class="stringliteral">&quot;ec&quot;</span>, ec.value())</div>
<div class="line"><a id="l01452" name="l01452"></a><span class="lineno"> 1452</span>               (<span class="stringliteral">&quot;message&quot;</span>, ec.message()));</div>
<div class="line"><a id="l01453" name="l01453"></a><span class="lineno"> 1453</span> </div>
<div class="line"><a id="l01454" name="l01454"></a><span class="lineno"> 1454</span>         next( <a class="code hl_struct" href="structsysio_1_1producer__plugin_1_1snapshot__information.html">producer_plugin::snapshot_information</a>{head_id, head_block_num, head_block_time, <a class="code hl_variable" href="structsysio_1_1chain_1_1chain__snapshot__header.html#ad7357c9cee48e084e060efb76dce03e4">chain_snapshot_header::current_version</a>, snapshot_path.generic_string()} );</div>
<div class="line"><a id="l01455" name="l01455"></a><span class="lineno"> 1455</span>      } <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#ab200d016fe1306acaed181b722a3cac6">CATCH_AND_CALL</a> (next);</div>
<div class="line"><a id="l01456" name="l01456"></a><span class="lineno"> 1456</span>      <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01457" name="l01457"></a><span class="lineno"> 1457</span>   }</div>
<div class="line"><a id="l01458" name="l01458"></a><span class="lineno"> 1458</span> </div>
<div class="line"><a id="l01459" name="l01459"></a><span class="lineno"> 1459</span>   <span class="comment">// Otherwise, the result will be returned when the snapshot becomes irreversible.</span></div>
<div class="line"><a id="l01460" name="l01460"></a><span class="lineno"> 1460</span> </div>
<div class="line"><a id="l01461" name="l01461"></a><span class="lineno"> 1461</span>   <span class="comment">// determine if this snapshot is already in-flight</span></div>
<div class="line"><a id="l01462" name="l01462"></a><span class="lineno"> 1462</span>   <span class="keyword">auto</span>&amp; pending_by_id = my-&gt;_pending_snapshot_index.get&lt;by_id&gt;();</div>
<div class="line"><a id="l01463" name="l01463"></a><span class="lineno"> 1463</span>   <span class="keyword">auto</span> existing = pending_by_id.find(head_id);</div>
<div class="line"><a id="l01464" name="l01464"></a><span class="lineno"> 1464</span>   <span class="keywordflow">if</span>( existing != pending_by_id.end() ) {</div>
<div class="line"><a id="l01465" name="l01465"></a><span class="lineno"> 1465</span>      <span class="comment">// if a snapshot at this block is already pending, attach this requests handler to it</span></div>
<div class="line"><a id="l01466" name="l01466"></a><span class="lineno"> 1466</span>      pending_by_id.modify(existing, [&amp;next]( <span class="keyword">auto</span>&amp; entry ){</div>
<div class="line"><a id="l01467" name="l01467"></a><span class="lineno"> 1467</span>         entry.next = [prev = entry.next, next](<span class="keyword">const</span> std::variant&lt;fc::exception_ptr, producer_plugin::snapshot_information&gt;&amp; res){</div>
<div class="line"><a id="l01468" name="l01468"></a><span class="lineno"> 1468</span>            prev(res);</div>
<div class="line"><a id="l01469" name="l01469"></a><span class="lineno"> 1469</span>            next(res);</div>
<div class="line"><a id="l01470" name="l01470"></a><span class="lineno"> 1470</span>         };</div>
<div class="line"><a id="l01471" name="l01471"></a><span class="lineno"> 1471</span>      });</div>
<div class="line"><a id="l01472" name="l01472"></a><span class="lineno"> 1472</span>   } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01473" name="l01473"></a><span class="lineno"> 1473</span>      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; pending_path = <a class="code hl_function" href="classsysio_1_1pending__snapshot.html#a44c77e2240938dc9116890df2818bf4b">pending_snapshot::get_pending_path</a>(head_id, my-&gt;_snapshots_dir);</div>
<div class="line"><a id="l01474" name="l01474"></a><span class="lineno"> 1474</span> </div>
<div class="line"><a id="l01475" name="l01475"></a><span class="lineno"> 1475</span>      <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l01476" name="l01476"></a><span class="lineno"> 1476</span>         write_snapshot( temp_path ); <span class="comment">// create a new pending snapshot</span></div>
<div class="line"><a id="l01477" name="l01477"></a><span class="lineno"> 1477</span> </div>
<div class="line"><a id="l01478" name="l01478"></a><span class="lineno"> 1478</span>         boost::system::error_code ec;</div>
<div class="line"><a id="l01479" name="l01479"></a><span class="lineno"> 1479</span>         bfs::rename(temp_path, pending_path, ec);</div>
<div class="line"><a id="l01480" name="l01480"></a><span class="lineno"> 1480</span>         <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>(!ec, snapshot_finalization_exception,</div>
<div class="line"><a id="l01481" name="l01481"></a><span class="lineno"> 1481</span>               <span class="stringliteral">&quot;Unable to promote temp snapshot to pending for block number ${bn}: [code: ${ec}] ${message}&quot;</span>,</div>
<div class="line"><a id="l01482" name="l01482"></a><span class="lineno"> 1482</span>               (<span class="stringliteral">&quot;bn&quot;</span>, head_block_num)</div>
<div class="line"><a id="l01483" name="l01483"></a><span class="lineno"> 1483</span>               (<span class="stringliteral">&quot;ec&quot;</span>, ec.value())</div>
<div class="line"><a id="l01484" name="l01484"></a><span class="lineno"> 1484</span>               (<span class="stringliteral">&quot;message&quot;</span>, ec.message()));</div>
<div class="line"><a id="l01485" name="l01485"></a><span class="lineno"> 1485</span> </div>
<div class="line"><a id="l01486" name="l01486"></a><span class="lineno"> 1486</span>         my-&gt;_pending_snapshot_index.emplace(head_id, next, pending_path.generic_string(), snapshot_path.generic_string());</div>
<div class="line"><a id="l01487" name="l01487"></a><span class="lineno"> 1487</span>      } <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#ab200d016fe1306acaed181b722a3cac6">CATCH_AND_CALL</a> (next);</div>
<div class="line"><a id="l01488" name="l01488"></a><span class="lineno"> 1488</span>   }</div>
<div class="line"><a id="l01489" name="l01489"></a><span class="lineno"> 1489</span>}</div>
</div>
<div class="line"><a id="l01490" name="l01490"></a><span class="lineno"> 1490</span> </div>
<div class="line"><a id="l01491" name="l01491"></a><span class="lineno"> 1491</span><a class="code hl_struct" href="structsysio_1_1producer__plugin_1_1scheduled__protocol__feature__activations.html">producer_plugin::scheduled_protocol_feature_activations</a></div>
<div class="foldopen" id="foldopen01492" data-start="{" data-end="}">
<div class="line"><a id="l01492" name="l01492"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin.html#afc97bb12a5dee32e1937588ba1262b13"> 1492</a></span><a class="code hl_function" href="classsysio_1_1producer__plugin.html#afc97bb12a5dee32e1937588ba1262b13">producer_plugin::get_scheduled_protocol_feature_activations</a>()<span class="keyword">const </span>{</div>
<div class="line"><a id="l01493" name="l01493"></a><span class="lineno"> 1493</span>   <span class="keywordflow">return</span> {my-&gt;_protocol_features_to_activate};</div>
<div class="line"><a id="l01494" name="l01494"></a><span class="lineno"> 1494</span>}</div>
</div>
<div class="line"><a id="l01495" name="l01495"></a><span class="lineno"> 1495</span> </div>
<div class="foldopen" id="foldopen01496" data-start="{" data-end="}">
<div class="line"><a id="l01496" name="l01496"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin.html#abbf1adfe24d0f42fc9dbd3fe510897f7"> 1496</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1producer__plugin.html#abbf1adfe24d0f42fc9dbd3fe510897f7">producer_plugin::schedule_protocol_feature_activations</a>( <span class="keyword">const</span> <a class="code hl_struct" href="structsysio_1_1producer__plugin_1_1scheduled__protocol__feature__activations.html">scheduled_protocol_feature_activations</a>&amp; schedule ) {</div>
<div class="line"><a id="l01497" name="l01497"></a><span class="lineno"> 1497</span>   <span class="keyword">const</span> <a class="code hl_class" href="classsysio_1_1chain_1_1controller.html">chain::controller</a>&amp; chain = my-&gt;chain_plug-&gt;chain();</div>
<div class="line"><a id="l01498" name="l01498"></a><span class="lineno"> 1498</span>   std::set&lt;digest_type&gt; set_of_features_to_activate( schedule.protocol_features_to_activate.begin(),</div>
<div class="line"><a id="l01499" name="l01499"></a><span class="lineno"> 1499</span>                                                      schedule.protocol_features_to_activate.end() );</div>
<div class="line"><a id="l01500" name="l01500"></a><span class="lineno"> 1500</span>   <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( set_of_features_to_activate.size() == schedule.protocol_features_to_activate.size(),</div>
<div class="line"><a id="l01501" name="l01501"></a><span class="lineno"> 1501</span>               invalid_protocol_features_to_activate, <span class="stringliteral">&quot;duplicate digests&quot;</span> );</div>
<div class="line"><a id="l01502" name="l01502"></a><span class="lineno"> 1502</span>   chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#abf042d0e964b46d1a401119d3575ff82">validate_protocol_features</a>( schedule.protocol_features_to_activate );</div>
<div class="line"><a id="l01503" name="l01503"></a><span class="lineno"> 1503</span>   <span class="keyword">const</span> <span class="keyword">auto</span>&amp; pfs = chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a67876c4bcb4b26fa679d347472ff14ee">get_protocol_feature_manager</a>().<a class="code hl_function" href="classsysio_1_1chain_1_1protocol__feature__manager.html#a9e6c1310749c4fd04035aa2c01310ce4">get_protocol_feature_set</a>();</div>
<div class="line"><a id="l01504" name="l01504"></a><span class="lineno"> 1504</span>   <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;feature_digest : set_of_features_to_activate) {</div>
<div class="line"><a id="l01505" name="l01505"></a><span class="lineno"> 1505</span>      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; pf = pfs.get_protocol_feature(feature_digest);</div>
<div class="line"><a id="l01506" name="l01506"></a><span class="lineno"> 1506</span>      <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( !pf.preactivation_required, protocol_feature_exception,</div>
<div class="line"><a id="l01507" name="l01507"></a><span class="lineno"> 1507</span>                  <span class="stringliteral">&quot;protocol feature requires preactivation: ${digest}&quot;</span>,</div>
<div class="line"><a id="l01508" name="l01508"></a><span class="lineno"> 1508</span>                  (<span class="stringliteral">&quot;digest&quot;</span>, feature_digest));</div>
<div class="line"><a id="l01509" name="l01509"></a><span class="lineno"> 1509</span>   }</div>
<div class="line"><a id="l01510" name="l01510"></a><span class="lineno"> 1510</span>   my-&gt;_protocol_features_to_activate = schedule.protocol_features_to_activate;</div>
<div class="line"><a id="l01511" name="l01511"></a><span class="lineno"> 1511</span>   my-&gt;_protocol_features_signaled = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01512" name="l01512"></a><span class="lineno"> 1512</span>}</div>
</div>
<div class="line"><a id="l01513" name="l01513"></a><span class="lineno"> 1513</span> </div>
<div class="foldopen" id="foldopen01514" data-start="{" data-end="}">
<div class="line"><a id="l01514" name="l01514"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin.html#a9f76a5e68b573f82d45bc7ac602849b2"> 1514</a></span><a class="code hl_typedef" href="namespacefc.html#a9148361f6aaa3d739990a75ac557fe59">fc::variants</a> <a class="code hl_function" href="classsysio_1_1producer__plugin.html#a9f76a5e68b573f82d45bc7ac602849b2">producer_plugin::get_supported_protocol_features</a>( <span class="keyword">const</span> <a class="code hl_struct" href="structsysio_1_1producer__plugin_1_1get__supported__protocol__features__params.html">get_supported_protocol_features_params</a>&amp; <a class="code hl_struct" href="structsysio_1_1chain__apis_1_1account__query__db_1_1get__accounts__by__authorizers__params.html">params</a> )<span class="keyword"> const </span>{</div>
<div class="line"><a id="l01515" name="l01515"></a><span class="lineno"> 1515</span>   <a class="code hl_typedef" href="namespacefc.html#a9148361f6aaa3d739990a75ac557fe59">fc::variants</a> <a class="code hl_typedef" href="test__account__query__db_8cpp.html#a33f2983ff61d9343e424c440190d8610">results</a>;</div>
<div class="line"><a id="l01516" name="l01516"></a><span class="lineno"> 1516</span>   <span class="keyword">const</span> <a class="code hl_class" href="classsysio_1_1chain_1_1controller.html">chain::controller</a>&amp; chain = my-&gt;chain_plug-&gt;chain();</div>
<div class="line"><a id="l01517" name="l01517"></a><span class="lineno"> 1517</span>   <span class="keyword">const</span> <span class="keyword">auto</span>&amp; pfs = chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a67876c4bcb4b26fa679d347472ff14ee">get_protocol_feature_manager</a>().<a class="code hl_function" href="classsysio_1_1chain_1_1protocol__feature__manager.html#a9e6c1310749c4fd04035aa2c01310ce4">get_protocol_feature_set</a>();</div>
<div class="line"><a id="l01518" name="l01518"></a><span class="lineno"> 1518</span>   <span class="keyword">const</span> <span class="keyword">auto</span> next_block_time = chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#aea3612e7cb52dfcaa2e6afdc1b3e2f51">head_block_time</a>() + <a class="code hl_function" href="namespacefc.html#a76ae235ec7e9b8862e70740058d7eb1b">fc::milliseconds</a>(config::block_interval_ms);</div>
<div class="line"><a id="l01519" name="l01519"></a><span class="lineno"> 1519</span> </div>
<div class="line"><a id="l01520" name="l01520"></a><span class="lineno"> 1520</span>   flat_map&lt;digest_type, bool&gt;  visited_protocol_features;</div>
<div class="line"><a id="l01521" name="l01521"></a><span class="lineno"> 1521</span>   visited_protocol_features.reserve( pfs.size() );</div>
<div class="line"><a id="l01522" name="l01522"></a><span class="lineno"> 1522</span> </div>
<div class="line"><a id="l01523" name="l01523"></a><span class="lineno"> 1523</span>   std::function&lt;bool(<span class="keyword">const</span> <a class="code hl_struct" href="structsysio_1_1chain_1_1protocol__feature.html">protocol_feature</a>&amp;)&gt; add_feature =</div>
<div class="line"><a id="l01524" name="l01524"></a><span class="lineno"> 1524</span>   [&amp;<a class="code hl_typedef" href="test__account__query__db_8cpp.html#a33f2983ff61d9343e424c440190d8610">results</a>, &amp;pfs, &amp;<a class="code hl_typedef" href="namespacefc.html#a3a1a89eb370c7c0b0c7cf9bfa0bb0c71">params</a>, next_block_time, &amp;visited_protocol_features, &amp;add_feature]</div>
<div class="line"><a id="l01525" name="l01525"></a><span class="lineno"> 1525</span>   ( <span class="keyword">const</span> <a class="code hl_struct" href="structsysio_1_1chain_1_1protocol__feature.html">protocol_feature</a>&amp; pf ) -&gt; <span class="keywordtype">bool</span> {</div>
<div class="line"><a id="l01526" name="l01526"></a><span class="lineno"> 1526</span>      <span class="keywordflow">if</span>( ( <a class="code hl_struct" href="structsysio_1_1chain__apis_1_1account__query__db_1_1get__accounts__by__authorizers__params.html">params</a>.exclude_disabled || <a class="code hl_struct" href="structsysio_1_1chain__apis_1_1account__query__db_1_1get__accounts__by__authorizers__params.html">params</a>.exclude_unactivatable ) &amp;&amp; !pf.enabled ) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l01527" name="l01527"></a><span class="lineno"> 1527</span>      <span class="keywordflow">if</span>( <a class="code hl_struct" href="structsysio_1_1chain__apis_1_1account__query__db_1_1get__accounts__by__authorizers__params.html">params</a>.exclude_unactivatable &amp;&amp; ( next_block_time &lt; pf.earliest_allowed_activation_time  ) ) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l01528" name="l01528"></a><span class="lineno"> 1528</span> </div>
<div class="line"><a id="l01529" name="l01529"></a><span class="lineno"> 1529</span>      <span class="keyword">auto</span> res = visited_protocol_features.emplace( pf.feature_digest, <span class="keyword">false</span> );</div>
<div class="line"><a id="l01530" name="l01530"></a><span class="lineno"> 1530</span>      <span class="keywordflow">if</span>( !res.second ) <span class="keywordflow">return</span> res.first-&gt;second;</div>
<div class="line"><a id="l01531" name="l01531"></a><span class="lineno"> 1531</span> </div>
<div class="line"><a id="l01532" name="l01532"></a><span class="lineno"> 1532</span>      <span class="keyword">const</span> <span class="keyword">auto</span> original_size = <a class="code hl_struct" href="structsysio_1_1chain__apis_1_1account__query__db_1_1get__accounts__by__authorizers__result.html">results</a>.size();</div>
<div class="line"><a id="l01533" name="l01533"></a><span class="lineno"> 1533</span>      <span class="keywordflow">for</span>( <span class="keyword">const</span> <span class="keyword">auto</span>&amp; dependency : pf.dependencies ) {</div>
<div class="line"><a id="l01534" name="l01534"></a><span class="lineno"> 1534</span>         <span class="keywordflow">if</span>( !add_feature( pfs.get_protocol_feature( dependency ) ) ) {</div>
<div class="line"><a id="l01535" name="l01535"></a><span class="lineno"> 1535</span>            <a class="code hl_struct" href="structsysio_1_1chain__apis_1_1account__query__db_1_1get__accounts__by__authorizers__result.html">results</a>.resize( original_size );</div>
<div class="line"><a id="l01536" name="l01536"></a><span class="lineno"> 1536</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l01537" name="l01537"></a><span class="lineno"> 1537</span>         }</div>
<div class="line"><a id="l01538" name="l01538"></a><span class="lineno"> 1538</span>      }</div>
<div class="line"><a id="l01539" name="l01539"></a><span class="lineno"> 1539</span> </div>
<div class="line"><a id="l01540" name="l01540"></a><span class="lineno"> 1540</span>      res.first-&gt;second = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01541" name="l01541"></a><span class="lineno"> 1541</span>      <a class="code hl_struct" href="structsysio_1_1chain__apis_1_1account__query__db_1_1get__accounts__by__authorizers__result.html">results</a>.emplace_back( pf.to_variant(<span class="keyword">true</span>) );</div>
<div class="line"><a id="l01542" name="l01542"></a><span class="lineno"> 1542</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01543" name="l01543"></a><span class="lineno"> 1543</span>   };</div>
<div class="line"><a id="l01544" name="l01544"></a><span class="lineno"> 1544</span> </div>
<div class="line"><a id="l01545" name="l01545"></a><span class="lineno"> 1545</span>   <span class="keywordflow">for</span>( <span class="keyword">const</span> <span class="keyword">auto</span>&amp; pf : pfs ) {</div>
<div class="line"><a id="l01546" name="l01546"></a><span class="lineno"> 1546</span>      add_feature( pf );</div>
<div class="line"><a id="l01547" name="l01547"></a><span class="lineno"> 1547</span>   }</div>
<div class="line"><a id="l01548" name="l01548"></a><span class="lineno"> 1548</span> </div>
<div class="line"><a id="l01549" name="l01549"></a><span class="lineno"> 1549</span>   <span class="keywordflow">return</span> <a class="code hl_typedef" href="test__account__query__db_8cpp.html#a33f2983ff61d9343e424c440190d8610">results</a>;</div>
<div class="line"><a id="l01550" name="l01550"></a><span class="lineno"> 1550</span>}</div>
</div>
<div class="line"><a id="l01551" name="l01551"></a><span class="lineno"> 1551</span> </div>
<div class="line"><a id="l01552" name="l01552"></a><span class="lineno"> 1552</span><a class="code hl_struct" href="structsysio_1_1producer__plugin_1_1get__account__ram__corrections__result.html">producer_plugin::get_account_ram_corrections_result</a></div>
<div class="foldopen" id="foldopen01553" data-start="{" data-end="}">
<div class="line"><a id="l01553" name="l01553"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin.html#ace9a7e1a84839fe239eca95a230a92e3"> 1553</a></span><a class="code hl_function" href="classsysio_1_1producer__plugin.html#ace9a7e1a84839fe239eca95a230a92e3">producer_plugin::get_account_ram_corrections</a>( <span class="keyword">const</span> <a class="code hl_struct" href="structsysio_1_1producer__plugin_1_1get__account__ram__corrections__params.html">get_account_ram_corrections_params</a>&amp; <a class="code hl_struct" href="structsysio_1_1chain__apis_1_1account__query__db_1_1get__accounts__by__authorizers__params.html">params</a> )<span class="keyword"> const </span>{</div>
<div class="line"><a id="l01554" name="l01554"></a><span class="lineno"> 1554</span>   <a class="code hl_struct" href="structsysio_1_1producer__plugin_1_1get__account__ram__corrections__result.html">get_account_ram_corrections_result</a> result;</div>
<div class="line"><a id="l01555" name="l01555"></a><span class="lineno"> 1555</span>   <span class="keyword">const</span> <span class="keyword">auto</span>&amp; db = my-&gt;chain_plug-&gt;chain().db();</div>
<div class="line"><a id="l01556" name="l01556"></a><span class="lineno"> 1556</span> </div>
<div class="line"><a id="l01557" name="l01557"></a><span class="lineno"> 1557</span>   <span class="keyword">const</span> <span class="keyword">auto</span>&amp; idx = db.get_index&lt;<a class="code hl_typedef" href="namespacesysio_1_1chain.html#a4c900d23edfaeb9e6e25aa3a21e0ab4b">chain::account_ram_correction_index</a>, chain::by_name&gt;();</div>
<div class="line"><a id="l01558" name="l01558"></a><span class="lineno"> 1558</span>   <a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">account_name</a> lower_bound_value{ std::numeric_limits&lt;uint64_t&gt;::lowest() };</div>
<div class="line"><a id="l01559" name="l01559"></a><span class="lineno"> 1559</span>   <a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">account_name</a> upper_bound_value{ std::numeric_limits&lt;uint64_t&gt;::max() };</div>
<div class="line"><a id="l01560" name="l01560"></a><span class="lineno"> 1560</span> </div>
<div class="line"><a id="l01561" name="l01561"></a><span class="lineno"> 1561</span>   <span class="keywordflow">if</span>( <a class="code hl_struct" href="structsysio_1_1chain__apis_1_1account__query__db_1_1get__accounts__by__authorizers__params.html">params</a>.lower_bound ) {</div>
<div class="line"><a id="l01562" name="l01562"></a><span class="lineno"> 1562</span>      lower_bound_value = *<a class="code hl_struct" href="structsysio_1_1chain__apis_1_1account__query__db_1_1get__accounts__by__authorizers__params.html">params</a>.lower_bound;</div>
<div class="line"><a id="l01563" name="l01563"></a><span class="lineno"> 1563</span>   }</div>
<div class="line"><a id="l01564" name="l01564"></a><span class="lineno"> 1564</span> </div>
<div class="line"><a id="l01565" name="l01565"></a><span class="lineno"> 1565</span>   <span class="keywordflow">if</span>( <a class="code hl_struct" href="structsysio_1_1chain__apis_1_1account__query__db_1_1get__accounts__by__authorizers__params.html">params</a>.upper_bound ) {</div>
<div class="line"><a id="l01566" name="l01566"></a><span class="lineno"> 1566</span>      upper_bound_value = *<a class="code hl_struct" href="structsysio_1_1chain__apis_1_1account__query__db_1_1get__accounts__by__authorizers__params.html">params</a>.upper_bound;</div>
<div class="line"><a id="l01567" name="l01567"></a><span class="lineno"> 1567</span>   }</div>
<div class="line"><a id="l01568" name="l01568"></a><span class="lineno"> 1568</span> </div>
<div class="line"><a id="l01569" name="l01569"></a><span class="lineno"> 1569</span>   <span class="keywordflow">if</span>( upper_bound_value &lt; lower_bound_value )</div>
<div class="line"><a id="l01570" name="l01570"></a><span class="lineno"> 1570</span>      <span class="keywordflow">return</span> result;</div>
<div class="line"><a id="l01571" name="l01571"></a><span class="lineno"> 1571</span> </div>
<div class="line"><a id="l01572" name="l01572"></a><span class="lineno"> 1572</span>   <span class="keyword">auto</span> walk_range = [&amp;]( <span class="keyword">auto</span> itr, <span class="keyword">auto</span> end_itr ) {</div>
<div class="line"><a id="l01573" name="l01573"></a><span class="lineno"> 1573</span>      <span class="keywordflow">for</span>( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="gmock__stress__test_8cc.html#afd9db40e3361ae09188795e8cbe19752">count</a> = 0;</div>
<div class="line"><a id="l01574" name="l01574"></a><span class="lineno"> 1574</span>           <a class="code hl_variable" href="gmock__stress__test_8cc.html#afd9db40e3361ae09188795e8cbe19752">count</a> &lt; <a class="code hl_struct" href="structsysio_1_1chain__apis_1_1account__query__db_1_1get__accounts__by__authorizers__params.html">params</a>.limit &amp;&amp; itr != end_itr;</div>
<div class="line"><a id="l01575" name="l01575"></a><span class="lineno"> 1575</span>           ++itr )</div>
<div class="line"><a id="l01576" name="l01576"></a><span class="lineno"> 1576</span>      {</div>
<div class="line"><a id="l01577" name="l01577"></a><span class="lineno"> 1577</span>         result.rows.push_back( <a class="code hl_class" href="classfc_1_1variant.html">fc::variant</a>( *itr ) );</div>
<div class="line"><a id="l01578" name="l01578"></a><span class="lineno"> 1578</span>         ++<a class="code hl_variable" href="gmock__stress__test_8cc.html#afd9db40e3361ae09188795e8cbe19752">count</a>;</div>
<div class="line"><a id="l01579" name="l01579"></a><span class="lineno"> 1579</span>      }</div>
<div class="line"><a id="l01580" name="l01580"></a><span class="lineno"> 1580</span>      <span class="keywordflow">if</span>( itr != end_itr ) {</div>
<div class="line"><a id="l01581" name="l01581"></a><span class="lineno"> 1581</span>         result.more = itr-&gt;name;</div>
<div class="line"><a id="l01582" name="l01582"></a><span class="lineno"> 1582</span>      }</div>
<div class="line"><a id="l01583" name="l01583"></a><span class="lineno"> 1583</span>   };</div>
<div class="line"><a id="l01584" name="l01584"></a><span class="lineno"> 1584</span> </div>
<div class="line"><a id="l01585" name="l01585"></a><span class="lineno"> 1585</span>   <span class="keyword">auto</span> lower = idx.lower_bound( lower_bound_value );</div>
<div class="line"><a id="l01586" name="l01586"></a><span class="lineno"> 1586</span>   <span class="keyword">auto</span> upper = idx.upper_bound( upper_bound_value );</div>
<div class="line"><a id="l01587" name="l01587"></a><span class="lineno"> 1587</span>   <span class="keywordflow">if</span>( <a class="code hl_struct" href="structsysio_1_1chain__apis_1_1account__query__db_1_1get__accounts__by__authorizers__params.html">params</a>.reverse ) {</div>
<div class="line"><a id="l01588" name="l01588"></a><span class="lineno"> 1588</span>      walk_range( boost::make_reverse_iterator(upper), boost::make_reverse_iterator(lower) );</div>
<div class="line"><a id="l01589" name="l01589"></a><span class="lineno"> 1589</span>   } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01590" name="l01590"></a><span class="lineno"> 1590</span>      walk_range( lower, upper );</div>
<div class="line"><a id="l01591" name="l01591"></a><span class="lineno"> 1591</span>   }</div>
<div class="line"><a id="l01592" name="l01592"></a><span class="lineno"> 1592</span> </div>
<div class="line"><a id="l01593" name="l01593"></a><span class="lineno"> 1593</span>   <span class="keywordflow">return</span> result;</div>
<div class="line"><a id="l01594" name="l01594"></a><span class="lineno"> 1594</span>}</div>
</div>
<div class="line"><a id="l01595" name="l01595"></a><span class="lineno"> 1595</span> </div>
<div class="foldopen" id="foldopen01596" data-start="{" data-end="}">
<div class="line"><a id="l01596" name="l01596"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#a9368777de44180b2070838ff18f2fb36"> 1596</a></span>std::optional&lt;fc::time_point&gt; <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#a9368777de44180b2070838ff18f2fb36">producer_plugin_impl::calculate_next_block_time</a>(<span class="keyword">const</span> <a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">account_name</a>&amp; <a class="code hl_function" href="programs_2sysio-launcher_2main_8cpp.html#af3e300c02a95a1230283a8ea2bb1ad70">producer_name</a>, <span class="keyword">const</span> <a class="code hl_class" href="classsysio_1_1chain_1_1block__timestamp.html">block_timestamp_type</a>&amp; current_block_time)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l01597" name="l01597"></a><span class="lineno"> 1597</span>   <a class="code hl_class" href="classsysio_1_1chain_1_1controller.html">chain::controller</a>&amp; chain = <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ad6dd1910645f0e41a009f59fdfc09cb4">chain_plug</a>-&gt;<a class="code hl_function" href="classsysio_1_1chain__plugin.html#a14a5e77b31ecf267c8062267d03440ae">chain</a>();</div>
<div class="line"><a id="l01598" name="l01598"></a><span class="lineno"> 1598</span>   <span class="keyword">const</span> <span class="keyword">auto</span>&amp; hbs = chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a3e445e8e2da032a322a1348091a1a702">head_block_state</a>();</div>
<div class="line"><a id="l01599" name="l01599"></a><span class="lineno"> 1599</span>   <span class="keyword">const</span> <span class="keyword">auto</span>&amp; active_schedule = hbs-&gt;active_schedule.producers;</div>
<div class="line"><a id="l01600" name="l01600"></a><span class="lineno"> 1600</span> </div>
<div class="line"><a id="l01601" name="l01601"></a><span class="lineno"> 1601</span>   <span class="comment">// determine if this producer is in the active schedule and if so, where</span></div>
<div class="line"><a id="l01602" name="l01602"></a><span class="lineno"> 1602</span>   <span class="keyword">auto</span> itr = std::find_if(active_schedule.begin(), active_schedule.end(), [&amp;](<span class="keyword">const</span> <span class="keyword">auto</span>&amp; asp){ return asp.producer_name == producer_name; });</div>
<div class="line"><a id="l01603" name="l01603"></a><span class="lineno"> 1603</span>   <span class="keywordflow">if</span> (itr == active_schedule.end()) {</div>
<div class="line"><a id="l01604" name="l01604"></a><span class="lineno"> 1604</span>      <span class="comment">// this producer is not in the active producer set</span></div>
<div class="line"><a id="l01605" name="l01605"></a><span class="lineno"> 1605</span>      <span class="keywordflow">return</span> std::optional&lt;fc::time_point&gt;();</div>
<div class="line"><a id="l01606" name="l01606"></a><span class="lineno"> 1606</span>   }</div>
<div class="line"><a id="l01607" name="l01607"></a><span class="lineno"> 1607</span> </div>
<div class="line"><a id="l01608" name="l01608"></a><span class="lineno"> 1608</span>   <span class="keywordtype">size_t</span> producer_index = itr - active_schedule.begin();</div>
<div class="line"><a id="l01609" name="l01609"></a><span class="lineno"> 1609</span>   <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> minimum_offset = 1; <span class="comment">// must at least be the &quot;next&quot; block</span></div>
<div class="line"><a id="l01610" name="l01610"></a><span class="lineno"> 1610</span> </div>
<div class="line"><a id="l01611" name="l01611"></a><span class="lineno"> 1611</span>   <span class="comment">// account for a watermark in the future which is disqualifying this producer for now</span></div>
<div class="line"><a id="l01612" name="l01612"></a><span class="lineno"> 1612</span>   <span class="comment">// this is conservative assuming no blocks are dropped.  If blocks are dropped the watermark will</span></div>
<div class="line"><a id="l01613" name="l01613"></a><span class="lineno"> 1613</span>   <span class="comment">// disqualify this producer for longer but it is assumed they will wake up, determine that they</span></div>
<div class="line"><a id="l01614" name="l01614"></a><span class="lineno"> 1614</span>   <span class="comment">// are disqualified for longer due to skipped blocks and re-caculate their next block with better</span></div>
<div class="line"><a id="l01615" name="l01615"></a><span class="lineno"> 1615</span>   <span class="comment">// information then</span></div>
<div class="line"><a id="l01616" name="l01616"></a><span class="lineno"> 1616</span>   <span class="keyword">auto</span> current_watermark = <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#a9077b433ee5250472b5670b5b9802362">get_watermark</a>(<a class="code hl_function" href="programs_2sysio-launcher_2main_8cpp.html#af3e300c02a95a1230283a8ea2bb1ad70">producer_name</a>);</div>
<div class="line"><a id="l01617" name="l01617"></a><span class="lineno"> 1617</span>   <span class="keywordflow">if</span> (current_watermark) {</div>
<div class="line"><a id="l01618" name="l01618"></a><span class="lineno"> 1618</span>      <span class="keyword">const</span> <span class="keyword">auto</span> watermark = *current_watermark;</div>
<div class="line"><a id="l01619" name="l01619"></a><span class="lineno"> 1619</span>      <span class="keyword">auto</span> block_num = chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a3e445e8e2da032a322a1348091a1a702">head_block_state</a>()-&gt;block_num;</div>
<div class="line"><a id="l01620" name="l01620"></a><span class="lineno"> 1620</span>      <span class="keywordflow">if</span> (chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a286751cd6498b500b70a0d3678672263">is_building_block</a>()) {</div>
<div class="line"><a id="l01621" name="l01621"></a><span class="lineno"> 1621</span>         ++block_num;</div>
<div class="line"><a id="l01622" name="l01622"></a><span class="lineno"> 1622</span>      }</div>
<div class="line"><a id="l01623" name="l01623"></a><span class="lineno"> 1623</span>      <span class="keywordflow">if</span> (watermark.first &gt; block_num) {</div>
<div class="line"><a id="l01624" name="l01624"></a><span class="lineno"> 1624</span>         <span class="comment">// if I have a watermark block number then I need to wait until after that watermark</span></div>
<div class="line"><a id="l01625" name="l01625"></a><span class="lineno"> 1625</span>         minimum_offset = watermark.first - block_num + 1;</div>
<div class="line"><a id="l01626" name="l01626"></a><span class="lineno"> 1626</span>      }</div>
<div class="line"><a id="l01627" name="l01627"></a><span class="lineno"> 1627</span>      <span class="keywordflow">if</span> (watermark.second &gt; current_block_time) {</div>
<div class="line"><a id="l01628" name="l01628"></a><span class="lineno"> 1628</span>          <span class="comment">// if I have a watermark block timestamp then I need to wait until after that watermark timestamp</span></div>
<div class="line"><a id="l01629" name="l01629"></a><span class="lineno"> 1629</span>          minimum_offset = std::max(minimum_offset, watermark.second.slot - current_block_time.<a class="code hl_variable" href="classsysio_1_1chain_1_1block__timestamp.html#a1bdb67323980085a2d4002d877b6c232">slot</a> + 1);</div>
<div class="line"><a id="l01630" name="l01630"></a><span class="lineno"> 1630</span>      }</div>
<div class="line"><a id="l01631" name="l01631"></a><span class="lineno"> 1631</span>   }</div>
<div class="line"><a id="l01632" name="l01632"></a><span class="lineno"> 1632</span> </div>
<div class="line"><a id="l01633" name="l01633"></a><span class="lineno"> 1633</span>   <span class="comment">// this producers next opportuity to produce is the next time its slot arrives after or at the calculated minimum</span></div>
<div class="line"><a id="l01634" name="l01634"></a><span class="lineno"> 1634</span>   <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> minimum_slot = current_block_time.<a class="code hl_variable" href="classsysio_1_1chain_1_1block__timestamp.html#a1bdb67323980085a2d4002d877b6c232">slot</a> + minimum_offset;</div>
<div class="line"><a id="l01635" name="l01635"></a><span class="lineno"> 1635</span>   <span class="keywordtype">size_t</span> minimum_slot_producer_index = (minimum_slot % (active_schedule.size() * config::producer_repetitions)) / config::producer_repetitions;</div>
<div class="line"><a id="l01636" name="l01636"></a><span class="lineno"> 1636</span>   <span class="keywordflow">if</span> ( producer_index == minimum_slot_producer_index ) {</div>
<div class="line"><a id="l01637" name="l01637"></a><span class="lineno"> 1637</span>      <span class="comment">// this is the producer for the minimum slot, go with that</span></div>
<div class="line"><a id="l01638" name="l01638"></a><span class="lineno"> 1638</span>      <span class="keywordflow">return</span> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#a11965fc424809ea1802175f8b36ae4e5">block_timestamp_type</a>(minimum_slot).<a class="code hl_function" href="classsysio_1_1chain_1_1block__timestamp.html#aa1d88152d9cc082b5ad651c3aeadfb8f">to_time_point</a>();</div>
<div class="line"><a id="l01639" name="l01639"></a><span class="lineno"> 1639</span>   } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01640" name="l01640"></a><span class="lineno"> 1640</span>      <span class="comment">// calculate how many rounds are between the minimum producer and the producer in question</span></div>
<div class="line"><a id="l01641" name="l01641"></a><span class="lineno"> 1641</span>      <span class="keywordtype">size_t</span> producer_distance = producer_index - minimum_slot_producer_index;</div>
<div class="line"><a id="l01642" name="l01642"></a><span class="lineno"> 1642</span>      <span class="comment">// check for unsigned underflow</span></div>
<div class="line"><a id="l01643" name="l01643"></a><span class="lineno"> 1643</span>      <span class="keywordflow">if</span> (producer_distance &gt; producer_index) {</div>
<div class="line"><a id="l01644" name="l01644"></a><span class="lineno"> 1644</span>         producer_distance += active_schedule.size();</div>
<div class="line"><a id="l01645" name="l01645"></a><span class="lineno"> 1645</span>      }</div>
<div class="line"><a id="l01646" name="l01646"></a><span class="lineno"> 1646</span> </div>
<div class="line"><a id="l01647" name="l01647"></a><span class="lineno"> 1647</span>      <span class="comment">// align the minimum slot to the first of its set of reps</span></div>
<div class="line"><a id="l01648" name="l01648"></a><span class="lineno"> 1648</span>      <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> first_minimum_producer_slot = minimum_slot - (minimum_slot % config::producer_repetitions);</div>
<div class="line"><a id="l01649" name="l01649"></a><span class="lineno"> 1649</span> </div>
<div class="line"><a id="l01650" name="l01650"></a><span class="lineno"> 1650</span>      <span class="comment">// offset the aligned minimum to the *earliest* next set of slots for this producer</span></div>
<div class="line"><a id="l01651" name="l01651"></a><span class="lineno"> 1651</span>      <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> next_block_slot = first_minimum_producer_slot  + (producer_distance * config::producer_repetitions);</div>
<div class="line"><a id="l01652" name="l01652"></a><span class="lineno"> 1652</span>      <span class="keywordflow">return</span> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#a11965fc424809ea1802175f8b36ae4e5">block_timestamp_type</a>(next_block_slot).<a class="code hl_function" href="classsysio_1_1chain_1_1block__timestamp.html#aa1d88152d9cc082b5ad651c3aeadfb8f">to_time_point</a>();</div>
<div class="line"><a id="l01653" name="l01653"></a><span class="lineno"> 1653</span>   }</div>
<div class="line"><a id="l01654" name="l01654"></a><span class="lineno"> 1654</span>}</div>
</div>
<div class="line"><a id="l01655" name="l01655"></a><span class="lineno"> 1655</span> </div>
<div class="foldopen" id="foldopen01656" data-start="{" data-end="}">
<div class="line"><a id="l01656" name="l01656"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#afc6b3109ff8bdf1d18200e54f5fcbf0f"> 1656</a></span><a class="code hl_class" href="classfc_1_1time__point.html">fc::time_point</a> <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#afc6b3109ff8bdf1d18200e54f5fcbf0f">producer_plugin_impl::calculate_pending_block_time</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a id="l01657" name="l01657"></a><span class="lineno"> 1657</span>   <span class="keyword">const</span> <a class="code hl_class" href="classsysio_1_1chain_1_1controller.html">chain::controller</a>&amp; chain = <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ad6dd1910645f0e41a009f59fdfc09cb4">chain_plug</a>-&gt;<a class="code hl_function" href="classsysio_1_1chain__plugin.html#a14a5e77b31ecf267c8062267d03440ae">chain</a>();</div>
<div class="line"><a id="l01658" name="l01658"></a><span class="lineno"> 1658</span>   <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1time__point.html">fc::time_point</a> now = <a class="code hl_function" href="classfc_1_1time__point.html#aa164ff1268a16d4b32afcff181f6100e">fc::time_point::now</a>();</div>
<div class="line"><a id="l01659" name="l01659"></a><span class="lineno"> 1659</span>   <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1time__point.html">fc::time_point</a> base = std::max&lt;fc::time_point&gt;(now, chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#aea3612e7cb52dfcaa2e6afdc1b3e2f51">head_block_time</a>());</div>
<div class="line"><a id="l01660" name="l01660"></a><span class="lineno"> 1660</span>   <span class="keyword">const</span> <a class="code hl_typedef" href="stdint_8h.html#a414156feea104f8f75b4ed9e3121b2f6">int64_t</a> min_time_to_next_block = (config::block_interval_us) - (base.time_since_epoch().count() % (config::block_interval_us) );</div>
<div class="line"><a id="l01661" name="l01661"></a><span class="lineno"> 1661</span>   <a class="code hl_class" href="classfc_1_1time__point.html">fc::time_point</a> block_time = base + <a class="code hl_class" href="classfc_1_1microseconds.html">fc::microseconds</a>(min_time_to_next_block);</div>
<div class="line"><a id="l01662" name="l01662"></a><span class="lineno"> 1662</span>   <span class="keywordflow">return</span> block_time;</div>
<div class="line"><a id="l01663" name="l01663"></a><span class="lineno"> 1663</span>}</div>
</div>
<div class="line"><a id="l01664" name="l01664"></a><span class="lineno"> 1664</span> </div>
<div class="foldopen" id="foldopen01665" data-start="{" data-end="}">
<div class="line"><a id="l01665" name="l01665"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#a90e415597bff893b9e18e7e3ca2ab275"> 1665</a></span><a class="code hl_class" href="classfc_1_1time__point.html">fc::time_point</a> <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#a90e415597bff893b9e18e7e3ca2ab275">producer_plugin_impl::calculate_block_deadline</a>( <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1time__point.html">fc::time_point</a>&amp; block_time )<span class="keyword"> const </span>{</div>
<div class="line"><a id="l01666" name="l01666"></a><span class="lineno"> 1666</span>   <span class="keywordflow">if</span>( <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ae9554f576751ba3ac762b0f0c85fa5f2">_pending_block_mode</a> == <a class="code hl_enumvalue" href="namespacesysio.html#acd1c637e1a22040dbf666b0301cbc475afd75fc8d5de6f56947b1afc9e44ddb5f">pending_block_mode::producing</a> ) {</div>
<div class="line"><a id="l01667" name="l01667"></a><span class="lineno"> 1667</span>      <span class="keywordtype">bool</span> last_block = ((<a class="code hl_typedef" href="namespacesysio_1_1chain.html#a11965fc424809ea1802175f8b36ae4e5">block_timestamp_type</a>( block_time ).<a class="code hl_variable" href="classsysio_1_1chain_1_1block__timestamp.html#a1bdb67323980085a2d4002d877b6c232">slot</a> % config::producer_repetitions) == config::producer_repetitions - 1);</div>
<div class="line"><a id="l01668" name="l01668"></a><span class="lineno"> 1668</span>      <span class="keywordflow">return</span> block_time + <a class="code hl_class" href="classfc_1_1microseconds.html">fc::microseconds</a>(last_block ? <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#aa84d793aebf28b348def7afd484a4f1a">_last_block_time_offset_us</a> : <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#a8e8b31bfedc54a91987109a93d906117">_produce_time_offset_us</a>);</div>
<div class="line"><a id="l01669" name="l01669"></a><span class="lineno"> 1669</span>   } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01670" name="l01670"></a><span class="lineno"> 1670</span>      <span class="keywordflow">return</span> block_time + <a class="code hl_class" href="classfc_1_1microseconds.html">fc::microseconds</a>(<a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#a8e8b31bfedc54a91987109a93d906117">_produce_time_offset_us</a>);</div>
<div class="line"><a id="l01671" name="l01671"></a><span class="lineno"> 1671</span>   }</div>
<div class="line"><a id="l01672" name="l01672"></a><span class="lineno"> 1672</span>}</div>
</div>
<div class="line"><a id="l01673" name="l01673"></a><span class="lineno"> 1673</span> </div>
<div class="foldopen" id="foldopen01674" data-start="{" data-end="}">
<div class="line"><a id="l01674" name="l01674"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#a104ad57b8b9c3c8e53a680e09318ea5d"> 1674</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#a104ad57b8b9c3c8e53a680e09318ea5d">producer_plugin_impl::should_interrupt_start_block</a>( <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1time__point.html">fc::time_point</a>&amp; deadline )<span class="keyword"> const </span>{</div>
<div class="line"><a id="l01675" name="l01675"></a><span class="lineno"> 1675</span>   <span class="keywordflow">if</span>( <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ae9554f576751ba3ac762b0f0c85fa5f2">_pending_block_mode</a> == <a class="code hl_enumvalue" href="namespacesysio.html#acd1c637e1a22040dbf666b0301cbc475afd75fc8d5de6f56947b1afc9e44ddb5f">pending_block_mode::producing</a> ) {</div>
<div class="line"><a id="l01676" name="l01676"></a><span class="lineno"> 1676</span>      <span class="keywordflow">return</span> deadline &lt;= <a class="code hl_function" href="classfc_1_1time__point.html#aa164ff1268a16d4b32afcff181f6100e">fc::time_point::now</a>();</div>
<div class="line"><a id="l01677" name="l01677"></a><span class="lineno"> 1677</span>   }</div>
<div class="line"><a id="l01678" name="l01678"></a><span class="lineno"> 1678</span>   <span class="comment">// if we can produce then honor deadline so production starts on time</span></div>
<div class="line"><a id="l01679" name="l01679"></a><span class="lineno"> 1679</span>   <span class="keywordflow">return</span> (!<a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#af2f69a8ae164570dd17a1f970ae611eb">_producers</a>.empty() &amp;&amp; deadline &lt;= <a class="code hl_function" href="classfc_1_1time__point.html#aa164ff1268a16d4b32afcff181f6100e">fc::time_point::now</a>()) || <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#aad323427fd3fbc7d0decad90b324f44f">_received_block</a>;</div>
<div class="line"><a id="l01680" name="l01680"></a><span class="lineno"> 1680</span>}</div>
</div>
<div class="line"><a id="l01681" name="l01681"></a><span class="lineno"> 1681</span> </div>
<div class="foldopen" id="foldopen01682" data-start="{" data-end="}">
<div class="line"><a id="l01682" name="l01682"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#a7db63178eda240d671fc6ae4e46bf01e"> 1682</a></span><a class="code hl_enumeration" href="classsysio_1_1producer__plugin__impl.html#a1cd329e031b1d57746ec38a44a2181bb">producer_plugin_impl::start_block_result</a> <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#a7db63178eda240d671fc6ae4e46bf01e">producer_plugin_impl::start_block</a>() {</div>
<div class="line"><a id="l01683" name="l01683"></a><span class="lineno"> 1683</span>   <a class="code hl_class" href="classsysio_1_1chain_1_1controller.html">chain::controller</a>&amp; chain = <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ad6dd1910645f0e41a009f59fdfc09cb4">chain_plug</a>-&gt;<a class="code hl_function" href="classsysio_1_1chain__plugin.html#a14a5e77b31ecf267c8062267d03440ae">chain</a>();</div>
<div class="line"><a id="l01684" name="l01684"></a><span class="lineno"> 1684</span> </div>
<div class="line"><a id="l01685" name="l01685"></a><span class="lineno"> 1685</span>   <span class="keywordflow">if</span>( !<a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ad6dd1910645f0e41a009f59fdfc09cb4">chain_plug</a>-&gt;<a class="code hl_function" href="classsysio_1_1chain__plugin.html#ad911df70e3131f7a2ed91d1eca08793a">accept_transactions</a>() )</div>
<div class="line"><a id="l01686" name="l01686"></a><span class="lineno"> 1686</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="classsysio_1_1producer__plugin__impl.html#a1cd329e031b1d57746ec38a44a2181bba431da7f12530d5bf74adec7e85562038">start_block_result::waiting_for_block</a>;</div>
<div class="line"><a id="l01687" name="l01687"></a><span class="lineno"> 1687</span> </div>
<div class="line"><a id="l01688" name="l01688"></a><span class="lineno"> 1688</span>   <span class="keyword">const</span> <span class="keyword">auto</span>&amp; hbs = chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a3e445e8e2da032a322a1348091a1a702">head_block_state</a>();</div>
<div class="line"><a id="l01689" name="l01689"></a><span class="lineno"> 1689</span> </div>
<div class="line"><a id="l01690" name="l01690"></a><span class="lineno"> 1690</span>   <span class="keywordflow">if</span>( chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a8b86f2ee0fa63f9d01ee437f83b0e1d1">get_terminate_at_block</a>() &gt; 0 &amp;&amp; chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a8b86f2ee0fa63f9d01ee437f83b0e1d1">get_terminate_at_block</a>() &lt; chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a33704b4936bb9bbd2ea6b0874ca521b4">head_block_num</a>() ) {</div>
<div class="line"><a id="l01691" name="l01691"></a><span class="lineno"> 1691</span>      <a class="code hl_define" href="logger_8hpp.html#a831cf08dc63704c11fd154132c6e8bdb">ilog</a>(<span class="stringliteral">&quot;Reached configured maximum block ${num}; terminating&quot;</span>, (<span class="stringliteral">&quot;num&quot;</span>, chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a8b86f2ee0fa63f9d01ee437f83b0e1d1">get_terminate_at_block</a>()));</div>
<div class="line"><a id="l01692" name="l01692"></a><span class="lineno"> 1692</span>      <a class="code hl_function" href="namespaceappbase.html#a99374dc23934f008a09f2f79be9eae40">app</a>().<a class="code hl_function" href="classappbase_1_1application.html#a81aa58d3f94570b7976145039155fc46">quit</a>();</div>
<div class="line"><a id="l01693" name="l01693"></a><span class="lineno"> 1693</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="classsysio_1_1producer__plugin__impl.html#a1cd329e031b1d57746ec38a44a2181bba26934eb377001f66e37289a5c93fe284">start_block_result::failed</a>;</div>
<div class="line"><a id="l01694" name="l01694"></a><span class="lineno"> 1694</span>   }</div>
<div class="line"><a id="l01695" name="l01695"></a><span class="lineno"> 1695</span> </div>
<div class="line"><a id="l01696" name="l01696"></a><span class="lineno"> 1696</span>   <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1time__point.html">fc::time_point</a> now = <a class="code hl_function" href="classfc_1_1time__point.html#aa164ff1268a16d4b32afcff181f6100e">fc::time_point::now</a>();</div>
<div class="line"><a id="l01697" name="l01697"></a><span class="lineno"> 1697</span>   <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1time__point.html">fc::time_point</a> block_time = <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#afc6b3109ff8bdf1d18200e54f5fcbf0f">calculate_pending_block_time</a>();</div>
<div class="line"><a id="l01698" name="l01698"></a><span class="lineno"> 1698</span>   <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1time__point.html">fc::time_point</a> preprocess_deadline = <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#a90e415597bff893b9e18e7e3ca2ab275">calculate_block_deadline</a>(block_time);</div>
<div class="line"><a id="l01699" name="l01699"></a><span class="lineno"> 1699</span> </div>
<div class="line"><a id="l01700" name="l01700"></a><span class="lineno"> 1700</span>   <span class="keyword">const</span> <a class="code hl_enumeration" href="namespacesysio.html#acd1c637e1a22040dbf666b0301cbc475">pending_block_mode</a> previous_pending_mode = <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ae9554f576751ba3ac762b0f0c85fa5f2">_pending_block_mode</a>;</div>
<div class="line"><a id="l01701" name="l01701"></a><span class="lineno"> 1701</span>   <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ae9554f576751ba3ac762b0f0c85fa5f2">_pending_block_mode</a> = <a class="code hl_enumvalue" href="namespacesysio.html#acd1c637e1a22040dbf666b0301cbc475afd75fc8d5de6f56947b1afc9e44ddb5f">pending_block_mode::producing</a>;</div>
<div class="line"><a id="l01702" name="l01702"></a><span class="lineno"> 1702</span> </div>
<div class="line"><a id="l01703" name="l01703"></a><span class="lineno"> 1703</span>   <span class="comment">// Not our turn</span></div>
<div class="line"><a id="l01704" name="l01704"></a><span class="lineno"> 1704</span>   <span class="keyword">const</span> <span class="keyword">auto</span>&amp; scheduled_producer = hbs-&gt;get_scheduled_producer(block_time);</div>
<div class="line"><a id="l01705" name="l01705"></a><span class="lineno"> 1705</span> </div>
<div class="line"><a id="l01706" name="l01706"></a><span class="lineno"> 1706</span>   <span class="keyword">const</span> <span class="keyword">auto</span> current_watermark = <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#a9077b433ee5250472b5670b5b9802362">get_watermark</a>(scheduled_producer.producer_name);</div>
<div class="line"><a id="l01707" name="l01707"></a><span class="lineno"> 1707</span> </div>
<div class="line"><a id="l01708" name="l01708"></a><span class="lineno"> 1708</span>   <span class="keywordtype">size_t</span> num_relevant_signatures = 0;</div>
<div class="line"><a id="l01709" name="l01709"></a><span class="lineno"> 1709</span>   scheduled_producer.for_each_key([&amp;](<span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1crypto_1_1public__key.html">public_key_type</a>&amp; key){</div>
<div class="line"><a id="l01710" name="l01710"></a><span class="lineno"> 1710</span>      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; iter = <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ad9173229bf0922a5bd51150e1a95c58f">_signature_providers</a>.find(key);</div>
<div class="line"><a id="l01711" name="l01711"></a><span class="lineno"> 1711</span>      <span class="keywordflow">if</span>(iter != <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ad9173229bf0922a5bd51150e1a95c58f">_signature_providers</a>.end()) {</div>
<div class="line"><a id="l01712" name="l01712"></a><span class="lineno"> 1712</span>         num_relevant_signatures++;</div>
<div class="line"><a id="l01713" name="l01713"></a><span class="lineno"> 1713</span>      }</div>
<div class="line"><a id="l01714" name="l01714"></a><span class="lineno"> 1714</span>   });</div>
<div class="line"><a id="l01715" name="l01715"></a><span class="lineno"> 1715</span> </div>
<div class="line"><a id="l01716" name="l01716"></a><span class="lineno"> 1716</span>   <span class="keyword">auto</span> irreversible_block_age = <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#a03ffa5daf4ee4f47e84f8bae98bc1a00">get_irreversible_block_age</a>();</div>
<div class="line"><a id="l01717" name="l01717"></a><span class="lineno"> 1717</span> </div>
<div class="line"><a id="l01718" name="l01718"></a><span class="lineno"> 1718</span>   <span class="comment">// If the next block production opportunity is in the present or future, we&#39;re synced.</span></div>
<div class="line"><a id="l01719" name="l01719"></a><span class="lineno"> 1719</span>   <span class="keywordflow">if</span>( !<a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#a26f51591effdca88f46913aa23308695">_production_enabled</a> ) {</div>
<div class="line"><a id="l01720" name="l01720"></a><span class="lineno"> 1720</span>      <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ae9554f576751ba3ac762b0f0c85fa5f2">_pending_block_mode</a> = <a class="code hl_enumvalue" href="namespacesysio.html#acd1c637e1a22040dbf666b0301cbc475aa25b9b4361a3bd215c739cf4f9cf2e4a">pending_block_mode::speculating</a>;</div>
<div class="line"><a id="l01721" name="l01721"></a><span class="lineno"> 1721</span>   } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#af2f69a8ae164570dd17a1f970ae611eb">_producers</a>.find(scheduled_producer.producer_name) == <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#af2f69a8ae164570dd17a1f970ae611eb">_producers</a>.end()) {</div>
<div class="line"><a id="l01722" name="l01722"></a><span class="lineno"> 1722</span>      <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ae9554f576751ba3ac762b0f0c85fa5f2">_pending_block_mode</a> = <a class="code hl_enumvalue" href="namespacesysio.html#acd1c637e1a22040dbf666b0301cbc475aa25b9b4361a3bd215c739cf4f9cf2e4a">pending_block_mode::speculating</a>;</div>
<div class="line"><a id="l01723" name="l01723"></a><span class="lineno"> 1723</span>   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (num_relevant_signatures == 0) {</div>
<div class="line"><a id="l01724" name="l01724"></a><span class="lineno"> 1724</span>      <a class="code hl_define" href="logger_8hpp.html#a9e3cdbaecd5a34b42956e888f7326fad">elog</a>(<span class="stringliteral">&quot;Not producing block because I don&#39;t have any private keys relevant to authority: ${authority}&quot;</span>, (<span class="stringliteral">&quot;authority&quot;</span>, scheduled_producer.authority));</div>
<div class="line"><a id="l01725" name="l01725"></a><span class="lineno"> 1725</span>      <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ae9554f576751ba3ac762b0f0c85fa5f2">_pending_block_mode</a> = <a class="code hl_enumvalue" href="namespacesysio.html#acd1c637e1a22040dbf666b0301cbc475aa25b9b4361a3bd215c739cf4f9cf2e4a">pending_block_mode::speculating</a>;</div>
<div class="line"><a id="l01726" name="l01726"></a><span class="lineno"> 1726</span>   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#a9992f102be5757c43dcdaedf97fb7c37">_pause_production</a> ) {</div>
<div class="line"><a id="l01727" name="l01727"></a><span class="lineno"> 1727</span>      <a class="code hl_define" href="logger_8hpp.html#a9e3cdbaecd5a34b42956e888f7326fad">elog</a>(<span class="stringliteral">&quot;Not producing block because production is explicitly paused&quot;</span>);</div>
<div class="line"><a id="l01728" name="l01728"></a><span class="lineno"> 1728</span>      <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ae9554f576751ba3ac762b0f0c85fa5f2">_pending_block_mode</a> = <a class="code hl_enumvalue" href="namespacesysio.html#acd1c637e1a22040dbf666b0301cbc475aa25b9b4361a3bd215c739cf4f9cf2e4a">pending_block_mode::speculating</a>;</div>
<div class="line"><a id="l01729" name="l01729"></a><span class="lineno"> 1729</span>   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#adc02b8bbfdf1e85f4bf2132db2c7510f">_max_irreversible_block_age_us</a>.<a class="code hl_function" href="classfc_1_1microseconds.html#a20fba59ec7e1f50c6b8f2c9443cc9b92">count</a>() &gt;= 0 &amp;&amp; irreversible_block_age &gt;= <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#adc02b8bbfdf1e85f4bf2132db2c7510f">_max_irreversible_block_age_us</a> ) {</div>
<div class="line"><a id="l01730" name="l01730"></a><span class="lineno"> 1730</span>      <a class="code hl_define" href="logger_8hpp.html#a9e3cdbaecd5a34b42956e888f7326fad">elog</a>(<span class="stringliteral">&quot;Not producing block because the irreversible block is too old [age:${age}s, max:${max}s]&quot;</span>, (<span class="stringliteral">&quot;age&quot;</span>, irreversible_block_age.count() / 1&#39;000&#39;000)( <span class="stringliteral">&quot;max&quot;</span>, <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#adc02b8bbfdf1e85f4bf2132db2c7510f">_max_irreversible_block_age_us</a>.<a class="code hl_function" href="classfc_1_1microseconds.html#a20fba59ec7e1f50c6b8f2c9443cc9b92">count</a>() / 1&#39;000&#39;000 ));</div>
<div class="line"><a id="l01731" name="l01731"></a><span class="lineno"> 1731</span>      <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ae9554f576751ba3ac762b0f0c85fa5f2">_pending_block_mode</a> = <a class="code hl_enumvalue" href="namespacesysio.html#acd1c637e1a22040dbf666b0301cbc475aa25b9b4361a3bd215c739cf4f9cf2e4a">pending_block_mode::speculating</a>;</div>
<div class="line"><a id="l01732" name="l01732"></a><span class="lineno"> 1732</span>   }</div>
<div class="line"><a id="l01733" name="l01733"></a><span class="lineno"> 1733</span> </div>
<div class="line"><a id="l01734" name="l01734"></a><span class="lineno"> 1734</span>   <span class="keywordflow">if</span> (<a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ae9554f576751ba3ac762b0f0c85fa5f2">_pending_block_mode</a> == <a class="code hl_enumvalue" href="namespacesysio.html#acd1c637e1a22040dbf666b0301cbc475afd75fc8d5de6f56947b1afc9e44ddb5f">pending_block_mode::producing</a>) {</div>
<div class="line"><a id="l01735" name="l01735"></a><span class="lineno"> 1735</span>      <span class="comment">// determine if our watermark excludes us from producing at this point</span></div>
<div class="line"><a id="l01736" name="l01736"></a><span class="lineno"> 1736</span>      <span class="keywordflow">if</span> (current_watermark) {</div>
<div class="line"><a id="l01737" name="l01737"></a><span class="lineno"> 1737</span>         <span class="keyword">const</span> <a class="code hl_class" href="classsysio_1_1chain_1_1block__timestamp.html">block_timestamp_type</a> <a class="code hl_class" href="classsysio_1_1chain_1_1block__timestamp.html">block_timestamp</a>{block_time};</div>
<div class="line"><a id="l01738" name="l01738"></a><span class="lineno"> 1738</span>         <span class="keywordflow">if</span> (current_watermark-&gt;first &gt; hbs-&gt;block_num) {</div>
<div class="line"><a id="l01739" name="l01739"></a><span class="lineno"> 1739</span>            <a class="code hl_define" href="logger_8hpp.html#a9e3cdbaecd5a34b42956e888f7326fad">elog</a>(<span class="stringliteral">&quot;Not producing block because \&quot;${producer}\&quot; signed a block at a higher block number (${watermark}) than the current fork&#39;s head (${head_block_num})&quot;</span>,</div>
<div class="line"><a id="l01740" name="l01740"></a><span class="lineno"> 1740</span>                 (<span class="stringliteral">&quot;producer&quot;</span>, scheduled_producer.producer_name)</div>
<div class="line"><a id="l01741" name="l01741"></a><span class="lineno"> 1741</span>                 (<span class="stringliteral">&quot;watermark&quot;</span>, current_watermark-&gt;first)</div>
<div class="line"><a id="l01742" name="l01742"></a><span class="lineno"> 1742</span>                 (<span class="stringliteral">&quot;head_block_num&quot;</span>, hbs-&gt;block_num));</div>
<div class="line"><a id="l01743" name="l01743"></a><span class="lineno"> 1743</span>            <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ae9554f576751ba3ac762b0f0c85fa5f2">_pending_block_mode</a> = <a class="code hl_enumvalue" href="namespacesysio.html#acd1c637e1a22040dbf666b0301cbc475aa25b9b4361a3bd215c739cf4f9cf2e4a">pending_block_mode::speculating</a>;</div>
<div class="line"><a id="l01744" name="l01744"></a><span class="lineno"> 1744</span>         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (current_watermark-&gt;second &gt;= <a class="code hl_class" href="classsysio_1_1chain_1_1block__timestamp.html">block_timestamp</a>) {</div>
<div class="line"><a id="l01745" name="l01745"></a><span class="lineno"> 1745</span>            <a class="code hl_define" href="logger_8hpp.html#a9e3cdbaecd5a34b42956e888f7326fad">elog</a>(<span class="stringliteral">&quot;Not producing block because \&quot;${producer}\&quot; signed a block at the next block time or later (${watermark}) than the pending block time (${block_timestamp})&quot;</span>,</div>
<div class="line"><a id="l01746" name="l01746"></a><span class="lineno"> 1746</span>                 (<span class="stringliteral">&quot;producer&quot;</span>, scheduled_producer.producer_name)</div>
<div class="line"><a id="l01747" name="l01747"></a><span class="lineno"> 1747</span>                 (<span class="stringliteral">&quot;watermark&quot;</span>, current_watermark-&gt;second)</div>
<div class="line"><a id="l01748" name="l01748"></a><span class="lineno"> 1748</span>                 (<span class="stringliteral">&quot;block_timestamp&quot;</span>, <a class="code hl_class" href="classsysio_1_1chain_1_1block__timestamp.html">block_timestamp</a>));</div>
<div class="line"><a id="l01749" name="l01749"></a><span class="lineno"> 1749</span>            <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ae9554f576751ba3ac762b0f0c85fa5f2">_pending_block_mode</a> = <a class="code hl_enumvalue" href="namespacesysio.html#acd1c637e1a22040dbf666b0301cbc475aa25b9b4361a3bd215c739cf4f9cf2e4a">pending_block_mode::speculating</a>;</div>
<div class="line"><a id="l01750" name="l01750"></a><span class="lineno"> 1750</span>         }</div>
<div class="line"><a id="l01751" name="l01751"></a><span class="lineno"> 1751</span>      }</div>
<div class="line"><a id="l01752" name="l01752"></a><span class="lineno"> 1752</span>   }</div>
<div class="line"><a id="l01753" name="l01753"></a><span class="lineno"> 1753</span> </div>
<div class="line"><a id="l01754" name="l01754"></a><span class="lineno"> 1754</span>   <span class="keywordflow">if</span> (<a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ae9554f576751ba3ac762b0f0c85fa5f2">_pending_block_mode</a> == <a class="code hl_enumvalue" href="namespacesysio.html#acd1c637e1a22040dbf666b0301cbc475aa25b9b4361a3bd215c739cf4f9cf2e4a">pending_block_mode::speculating</a>) {</div>
<div class="line"><a id="l01755" name="l01755"></a><span class="lineno"> 1755</span>      <span class="keyword">auto</span> head_block_age = now - chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#aea3612e7cb52dfcaa2e6afdc1b3e2f51">head_block_time</a>();</div>
<div class="line"><a id="l01756" name="l01756"></a><span class="lineno"> 1756</span>      <span class="keywordflow">if</span> (head_block_age &gt; <a class="code hl_function" href="namespacefc.html#a9623b8cae3f48bbed6aa1fc2afe9b174">fc::seconds</a>(5))</div>
<div class="line"><a id="l01757" name="l01757"></a><span class="lineno"> 1757</span>         <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="classsysio_1_1producer__plugin__impl.html#a1cd329e031b1d57746ec38a44a2181bba431da7f12530d5bf74adec7e85562038">start_block_result::waiting_for_block</a>;</div>
<div class="line"><a id="l01758" name="l01758"></a><span class="lineno"> 1758</span>   }</div>
<div class="line"><a id="l01759" name="l01759"></a><span class="lineno"> 1759</span> </div>
<div class="line"><a id="l01760" name="l01760"></a><span class="lineno"> 1760</span>   <span class="keywordflow">if</span> (<a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ae9554f576751ba3ac762b0f0c85fa5f2">_pending_block_mode</a> == <a class="code hl_enumvalue" href="namespacesysio.html#acd1c637e1a22040dbf666b0301cbc475afd75fc8d5de6f56947b1afc9e44ddb5f">pending_block_mode::producing</a>) {</div>
<div class="line"><a id="l01761" name="l01761"></a><span class="lineno"> 1761</span>      <span class="keyword">const</span> <span class="keyword">auto</span> start_block_time = block_time - <a class="code hl_class" href="classfc_1_1microseconds.html">fc::microseconds</a>( config::block_interval_us );</div>
<div class="line"><a id="l01762" name="l01762"></a><span class="lineno"> 1762</span>      <span class="keywordflow">if</span>( now &lt; start_block_time ) {</div>
<div class="line"><a id="l01763" name="l01763"></a><span class="lineno"> 1763</span>         <a class="code hl_define" href="logger_8hpp.html#af5adfcda7e0a01306256754a6511915d">fc_dlog</a>(<a class="code hl_variable" href="producer__plugin_8cpp.html#adff615e9fbe43b3e6443687be568cffd">_log</a>, <span class="stringliteral">&quot;Not producing block waiting for production window ${n} ${bt}&quot;</span>, (<span class="stringliteral">&quot;n&quot;</span>, hbs-&gt;block_num + 1)(<span class="stringliteral">&quot;bt&quot;</span>, block_time) );</div>
<div class="line"><a id="l01764" name="l01764"></a><span class="lineno"> 1764</span>         <span class="comment">// start_block_time instead of block_time because schedule_delayed_production_loop calculates next block time from given time</span></div>
<div class="line"><a id="l01765" name="l01765"></a><span class="lineno"> 1765</span>         <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#a15812dcb0edaaa48ab154d3bb2ca6a5c">schedule_delayed_production_loop</a>(weak_from_this(), <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#a652ecc759215ca6fa58b36370cc72e43">calculate_producer_wake_up_time</a>(start_block_time));</div>
<div class="line"><a id="l01766" name="l01766"></a><span class="lineno"> 1766</span>         <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="classsysio_1_1producer__plugin__impl.html#a1cd329e031b1d57746ec38a44a2181bba0f967fbaf130c7283779d1cf6058d1fa">start_block_result::waiting_for_production</a>;</div>
<div class="line"><a id="l01767" name="l01767"></a><span class="lineno"> 1767</span>      }</div>
<div class="line"><a id="l01768" name="l01768"></a><span class="lineno"> 1768</span>   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (previous_pending_mode == <a class="code hl_enumvalue" href="namespacesysio.html#acd1c637e1a22040dbf666b0301cbc475afd75fc8d5de6f56947b1afc9e44ddb5f">pending_block_mode::producing</a>) {</div>
<div class="line"><a id="l01769" name="l01769"></a><span class="lineno"> 1769</span>      <span class="comment">// just produced our last block of our round</span></div>
<div class="line"><a id="l01770" name="l01770"></a><span class="lineno"> 1770</span>      <span class="keyword">const</span> <span class="keyword">auto</span> start_block_time = block_time - <a class="code hl_class" href="classfc_1_1microseconds.html">fc::microseconds</a>( config::block_interval_us );</div>
<div class="line"><a id="l01771" name="l01771"></a><span class="lineno"> 1771</span>      <a class="code hl_define" href="logger_8hpp.html#af5adfcda7e0a01306256754a6511915d">fc_dlog</a>(<a class="code hl_variable" href="producer__plugin_8cpp.html#adff615e9fbe43b3e6443687be568cffd">_log</a>, <span class="stringliteral">&quot;Not starting speculative block until ${bt}&quot;</span>, (<span class="stringliteral">&quot;bt&quot;</span>, start_block_time) );</div>
<div class="line"><a id="l01772" name="l01772"></a><span class="lineno"> 1772</span>      <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#a15812dcb0edaaa48ab154d3bb2ca6a5c">schedule_delayed_production_loop</a>( weak_from_this(), start_block_time);</div>
<div class="line"><a id="l01773" name="l01773"></a><span class="lineno"> 1773</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="classsysio_1_1producer__plugin__impl.html#a1cd329e031b1d57746ec38a44a2181bba0f967fbaf130c7283779d1cf6058d1fa">start_block_result::waiting_for_production</a>;</div>
<div class="line"><a id="l01774" name="l01774"></a><span class="lineno"> 1774</span>   }</div>
<div class="line"><a id="l01775" name="l01775"></a><span class="lineno"> 1775</span> </div>
<div class="line"><a id="l01776" name="l01776"></a><span class="lineno"> 1776</span>   <a class="code hl_define" href="logger_8hpp.html#af5adfcda7e0a01306256754a6511915d">fc_dlog</a>(<a class="code hl_variable" href="producer__plugin_8cpp.html#adff615e9fbe43b3e6443687be568cffd">_log</a>, <span class="stringliteral">&quot;Starting block #${n} at ${time} producer ${p}&quot;</span>,</div>
<div class="line"><a id="l01777" name="l01777"></a><span class="lineno"> 1777</span>           (<span class="stringliteral">&quot;n&quot;</span>, hbs-&gt;block_num + 1)(<span class="stringliteral">&quot;time&quot;</span>, now)(<span class="stringliteral">&quot;p&quot;</span>, scheduled_producer.producer_name));</div>
<div class="line"><a id="l01778" name="l01778"></a><span class="lineno"> 1778</span> </div>
<div class="line"><a id="l01779" name="l01779"></a><span class="lineno"> 1779</span>   <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l01780" name="l01780"></a><span class="lineno"> 1780</span>      <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> blocks_to_confirm = 0;</div>
<div class="line"><a id="l01781" name="l01781"></a><span class="lineno"> 1781</span> </div>
<div class="line"><a id="l01782" name="l01782"></a><span class="lineno"> 1782</span>      <span class="keywordflow">if</span> (<a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ae9554f576751ba3ac762b0f0c85fa5f2">_pending_block_mode</a> == <a class="code hl_enumvalue" href="namespacesysio.html#acd1c637e1a22040dbf666b0301cbc475afd75fc8d5de6f56947b1afc9e44ddb5f">pending_block_mode::producing</a>) {</div>
<div class="line"><a id="l01783" name="l01783"></a><span class="lineno"> 1783</span>         <span class="comment">// determine how many blocks this producer can confirm</span></div>
<div class="line"><a id="l01784" name="l01784"></a><span class="lineno"> 1784</span>         <span class="comment">// 1) if it is not a producer from this node, assume no confirmations (we will discard this block anyway)</span></div>
<div class="line"><a id="l01785" name="l01785"></a><span class="lineno"> 1785</span>         <span class="comment">// 2) if it is a producer on this node that has never produced, the conservative approach is to assume no</span></div>
<div class="line"><a id="l01786" name="l01786"></a><span class="lineno"> 1786</span>         <span class="comment">//    confirmations to make sure we don&#39;t double sign after a crash TODO: make these watermarks durable?</span></div>
<div class="line"><a id="l01787" name="l01787"></a><span class="lineno"> 1787</span>         <span class="comment">// 3) if it is a producer on this node where this node knows the last block it produced, safely set it -UNLESS-</span></div>
<div class="line"><a id="l01788" name="l01788"></a><span class="lineno"> 1788</span>         <span class="comment">// 4) the producer on this node&#39;s last watermark is higher (meaning on a different fork)</span></div>
<div class="line"><a id="l01789" name="l01789"></a><span class="lineno"> 1789</span>         <span class="keywordflow">if</span> (current_watermark) {</div>
<div class="line"><a id="l01790" name="l01790"></a><span class="lineno"> 1790</span>            <span class="keyword">auto</span> watermark_bn = current_watermark-&gt;first;</div>
<div class="line"><a id="l01791" name="l01791"></a><span class="lineno"> 1791</span>            <span class="keywordflow">if</span> (watermark_bn &lt; hbs-&gt;block_num) {</div>
<div class="line"><a id="l01792" name="l01792"></a><span class="lineno"> 1792</span>               blocks_to_confirm = (<a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a>)(std::min&lt;uint32_t&gt;(std::numeric_limits&lt;uint16_t&gt;::max(), (<a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>)(hbs-&gt;block_num - watermark_bn)));</div>
<div class="line"><a id="l01793" name="l01793"></a><span class="lineno"> 1793</span>            }</div>
<div class="line"><a id="l01794" name="l01794"></a><span class="lineno"> 1794</span>         }</div>
<div class="line"><a id="l01795" name="l01795"></a><span class="lineno"> 1795</span> </div>
<div class="line"><a id="l01796" name="l01796"></a><span class="lineno"> 1796</span>         <span class="comment">// can not confirm irreversible blocks</span></div>
<div class="line"><a id="l01797" name="l01797"></a><span class="lineno"> 1797</span>         blocks_to_confirm = (<a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a>)(std::min&lt;uint32_t&gt;(blocks_to_confirm, (<a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>)(hbs-&gt;block_num - hbs-&gt;dpos_irreversible_blocknum)));</div>
<div class="line"><a id="l01798" name="l01798"></a><span class="lineno"> 1798</span>      }</div>
<div class="line"><a id="l01799" name="l01799"></a><span class="lineno"> 1799</span> </div>
<div class="line"><a id="l01800" name="l01800"></a><span class="lineno"> 1800</span>      <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#ac33726be93d621d708c02acfe7fcfd56">abort_block</a>();</div>
<div class="line"><a id="l01801" name="l01801"></a><span class="lineno"> 1801</span> </div>
<div class="line"><a id="l01802" name="l01802"></a><span class="lineno"> 1802</span>      <span class="keyword">auto</span> features_to_activate = chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#ac81c5e33faa52c5a78a67fc2032ce1aa">get_preactivated_protocol_features</a>();</div>
<div class="line"><a id="l01803" name="l01803"></a><span class="lineno"> 1803</span>      <span class="keywordflow">if</span>( <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ae9554f576751ba3ac762b0f0c85fa5f2">_pending_block_mode</a> == <a class="code hl_enumvalue" href="namespacesysio.html#acd1c637e1a22040dbf666b0301cbc475afd75fc8d5de6f56947b1afc9e44ddb5f">pending_block_mode::producing</a> &amp;&amp; <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ab8c4a74665eea98fed5866ee31b25d5a">_protocol_features_to_activate</a>.size() &gt; 0 ) {</div>
<div class="line"><a id="l01804" name="l01804"></a><span class="lineno"> 1804</span>         <span class="keywordtype">bool</span> drop_features_to_activate = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01805" name="l01805"></a><span class="lineno"> 1805</span>         <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l01806" name="l01806"></a><span class="lineno"> 1806</span>            chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#abf042d0e964b46d1a401119d3575ff82">validate_protocol_features</a>( <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ab8c4a74665eea98fed5866ee31b25d5a">_protocol_features_to_activate</a> );</div>
<div class="line"><a id="l01807" name="l01807"></a><span class="lineno"> 1807</span>         } <span class="keywordflow">catch</span> ( <span class="keyword">const</span> std::bad_alloc&amp; ) {</div>
<div class="line"><a id="l01808" name="l01808"></a><span class="lineno"> 1808</span>           <a class="code hl_function" href="classsysio_1_1chain__plugin.html#a9fb4d31b915fb0d2ef5392a4284b67e6">chain_plugin::handle_bad_alloc</a>();</div>
<div class="line"><a id="l01809" name="l01809"></a><span class="lineno"> 1809</span>         } <span class="keywordflow">catch</span> ( <span class="keyword">const</span> boost::interprocess::bad_alloc&amp; ) {</div>
<div class="line"><a id="l01810" name="l01810"></a><span class="lineno"> 1810</span>           <a class="code hl_function" href="classsysio_1_1chain__plugin.html#a9fb4d31b915fb0d2ef5392a4284b67e6">chain_plugin::handle_bad_alloc</a>();</div>
<div class="line"><a id="l01811" name="l01811"></a><span class="lineno"> 1811</span>         } <span class="keywordflow">catch</span>( <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1exception.html">fc::exception</a>&amp; e ) {</div>
<div class="line"><a id="l01812" name="l01812"></a><span class="lineno"> 1812</span>            <a class="code hl_define" href="logger_8hpp.html#a1759e5c9691d8ad754bdf5eff8bb23ac">wlog</a>( <span class="stringliteral">&quot;protocol features to activate are no longer all valid: ${details}&quot;</span>,</div>
<div class="line"><a id="l01813" name="l01813"></a><span class="lineno"> 1813</span>                  (<span class="stringliteral">&quot;details&quot;</span>,e.<a class="code hl_function" href="classfc_1_1exception.html#a7611ea8fbe25dde56649b685c2298a37">to_detail_string</a>()) );</div>
<div class="line"><a id="l01814" name="l01814"></a><span class="lineno"> 1814</span>            drop_features_to_activate = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01815" name="l01815"></a><span class="lineno"> 1815</span>         } <span class="keywordflow">catch</span>( <span class="keyword">const</span> std::exception&amp; e ) {</div>
<div class="line"><a id="l01816" name="l01816"></a><span class="lineno"> 1816</span>            <a class="code hl_define" href="logger_8hpp.html#a1759e5c9691d8ad754bdf5eff8bb23ac">wlog</a>( <span class="stringliteral">&quot;protocol features to activate are no longer all valid: ${details}&quot;</span>,</div>
<div class="line"><a id="l01817" name="l01817"></a><span class="lineno"> 1817</span>                  (<span class="stringliteral">&quot;details&quot;</span>,<a class="code hl_function" href="classfc_1_1std__exception__wrapper.html#ae5ad64f84b1d373f5b92031566284c7c">fc::std_exception_wrapper::from_current_exception</a>(e).to_detail_string()) );</div>
<div class="line"><a id="l01818" name="l01818"></a><span class="lineno"> 1818</span>            drop_features_to_activate = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01819" name="l01819"></a><span class="lineno"> 1819</span>         }</div>
<div class="line"><a id="l01820" name="l01820"></a><span class="lineno"> 1820</span> </div>
<div class="line"><a id="l01821" name="l01821"></a><span class="lineno"> 1821</span>         <span class="keywordflow">if</span>( drop_features_to_activate ) {</div>
<div class="line"><a id="l01822" name="l01822"></a><span class="lineno"> 1822</span>            <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ab8c4a74665eea98fed5866ee31b25d5a">_protocol_features_to_activate</a>.clear();</div>
<div class="line"><a id="l01823" name="l01823"></a><span class="lineno"> 1823</span>         } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01824" name="l01824"></a><span class="lineno"> 1824</span>            <span class="keyword">auto</span> protocol_features_to_activate = <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ab8c4a74665eea98fed5866ee31b25d5a">_protocol_features_to_activate</a>; <span class="comment">// do a copy as pending_block might be aborted</span></div>
<div class="line"><a id="l01825" name="l01825"></a><span class="lineno"> 1825</span>            <span class="keywordflow">if</span>( features_to_activate.size() &gt; 0 ) {</div>
<div class="line"><a id="l01826" name="l01826"></a><span class="lineno"> 1826</span>               protocol_features_to_activate.reserve( protocol_features_to_activate.size()</div>
<div class="line"><a id="l01827" name="l01827"></a><span class="lineno"> 1827</span>                                                         + features_to_activate.size() );</div>
<div class="line"><a id="l01828" name="l01828"></a><span class="lineno"> 1828</span>               std::set&lt;digest_type&gt; set_of_features_to_activate( protocol_features_to_activate.begin(),</div>
<div class="line"><a id="l01829" name="l01829"></a><span class="lineno"> 1829</span>                                                                  protocol_features_to_activate.end() );</div>
<div class="line"><a id="l01830" name="l01830"></a><span class="lineno"> 1830</span>               <span class="keywordflow">for</span>( <span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code hl_variable" href="_x02-_disabled_macros_8cpp.html#ae28240b98d91d6eb7da702b770490f39">f</a> : features_to_activate ) {</div>
<div class="line"><a id="l01831" name="l01831"></a><span class="lineno"> 1831</span>                  <span class="keyword">auto</span> res = set_of_features_to_activate.insert( <a class="code hl_variable" href="_x02-_disabled_macros_8cpp.html#ae28240b98d91d6eb7da702b770490f39">f</a> );</div>
<div class="line"><a id="l01832" name="l01832"></a><span class="lineno"> 1832</span>                  <span class="keywordflow">if</span>( res.second ) {</div>
<div class="line"><a id="l01833" name="l01833"></a><span class="lineno"> 1833</span>                     protocol_features_to_activate.push_back( <a class="code hl_variable" href="_x02-_disabled_macros_8cpp.html#ae28240b98d91d6eb7da702b770490f39">f</a> );</div>
<div class="line"><a id="l01834" name="l01834"></a><span class="lineno"> 1834</span>                  }</div>
<div class="line"><a id="l01835" name="l01835"></a><span class="lineno"> 1835</span>               }</div>
<div class="line"><a id="l01836" name="l01836"></a><span class="lineno"> 1836</span>               features_to_activate.clear();</div>
<div class="line"><a id="l01837" name="l01837"></a><span class="lineno"> 1837</span>            }</div>
<div class="line"><a id="l01838" name="l01838"></a><span class="lineno"> 1838</span>            <a class="code hl_function" href="namespacestd.html#abb7e41c7063536ff6eeee4bb5f66de6c">std::swap</a>( features_to_activate, protocol_features_to_activate );</div>
<div class="line"><a id="l01839" name="l01839"></a><span class="lineno"> 1839</span>            <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#a369d1c5202c442237cb333c850f1634e">_protocol_features_signaled</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01840" name="l01840"></a><span class="lineno"> 1840</span>            <a class="code hl_define" href="logger_8hpp.html#a831cf08dc63704c11fd154132c6e8bdb">ilog</a>( <span class="stringliteral">&quot;signaling activation of the following protocol features in block ${num}: ${features_to_activate}&quot;</span>,</div>
<div class="line"><a id="l01841" name="l01841"></a><span class="lineno"> 1841</span>                  (<span class="stringliteral">&quot;num&quot;</span>, hbs-&gt;block_num + 1)(<span class="stringliteral">&quot;features_to_activate&quot;</span>, features_to_activate) );</div>
<div class="line"><a id="l01842" name="l01842"></a><span class="lineno"> 1842</span>         }</div>
<div class="line"><a id="l01843" name="l01843"></a><span class="lineno"> 1843</span>      }</div>
<div class="line"><a id="l01844" name="l01844"></a><span class="lineno"> 1844</span> </div>
<div class="line"><a id="l01845" name="l01845"></a><span class="lineno"> 1845</span>      chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#afe40d1beedb5ec60de7e8d6575ba68ee">start_block</a>( block_time, blocks_to_confirm, features_to_activate, preprocess_deadline );</div>
<div class="line"><a id="l01846" name="l01846"></a><span class="lineno"> 1846</span>   } <a class="code hl_define" href="producer__plugin_8cpp.html#a01d09f9c9fe1cbc1b70a0c41f0682e07">LOG_AND_DROP</a>();</div>
<div class="line"><a id="l01847" name="l01847"></a><span class="lineno"> 1847</span> </div>
<div class="line"><a id="l01848" name="l01848"></a><span class="lineno"> 1848</span>   <span class="keywordflow">if</span>( chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a286751cd6498b500b70a0d3678672263">is_building_block</a>() ) {</div>
<div class="line"><a id="l01849" name="l01849"></a><span class="lineno"> 1849</span>      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; pending_block_signing_authority = chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a7ac238f10e3a4ccf5c746a4e6a43b184">pending_block_signing_authority</a>();</div>
<div class="line"><a id="l01850" name="l01850"></a><span class="lineno"> 1850</span> </div>
<div class="line"><a id="l01851" name="l01851"></a><span class="lineno"> 1851</span>      <span class="keywordflow">if</span> (<a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ae9554f576751ba3ac762b0f0c85fa5f2">_pending_block_mode</a> == <a class="code hl_enumvalue" href="namespacesysio.html#acd1c637e1a22040dbf666b0301cbc475afd75fc8d5de6f56947b1afc9e44ddb5f">pending_block_mode::producing</a> &amp;&amp; pending_block_signing_authority != scheduled_producer.authority) {</div>
<div class="line"><a id="l01852" name="l01852"></a><span class="lineno"> 1852</span>         <a class="code hl_define" href="logger_8hpp.html#a9e3cdbaecd5a34b42956e888f7326fad">elog</a>(<span class="stringliteral">&quot;Unexpected block signing authority, reverting to speculative mode! [expected: \&quot;${expected}\&quot;, actual: \&quot;${actual\&quot;&quot;</span>, (<span class="stringliteral">&quot;expected&quot;</span>, scheduled_producer.authority)(<span class="stringliteral">&quot;actual&quot;</span>, pending_block_signing_authority));</div>
<div class="line"><a id="l01853" name="l01853"></a><span class="lineno"> 1853</span>         <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ae9554f576751ba3ac762b0f0c85fa5f2">_pending_block_mode</a> = <a class="code hl_enumvalue" href="namespacesysio.html#acd1c637e1a22040dbf666b0301cbc475aa25b9b4361a3bd215c739cf4f9cf2e4a">pending_block_mode::speculating</a>;</div>
<div class="line"><a id="l01854" name="l01854"></a><span class="lineno"> 1854</span>      }</div>
<div class="line"><a id="l01855" name="l01855"></a><span class="lineno"> 1855</span> </div>
<div class="line"><a id="l01856" name="l01856"></a><span class="lineno"> 1856</span>      <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l01857" name="l01857"></a><span class="lineno"> 1857</span>         <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#afc937f75228984d541545dc4b59613a5">_account_fails</a>.clear();</div>
<div class="line"><a id="l01858" name="l01858"></a><span class="lineno"> 1858</span> </div>
<div class="line"><a id="l01859" name="l01859"></a><span class="lineno"> 1859</span>         <span class="keywordflow">if</span>( !<a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#a07a7c896dddfa2b6c36cf67248d3599d">remove_expired_trxs</a>( preprocess_deadline ) )</div>
<div class="line"><a id="l01860" name="l01860"></a><span class="lineno"> 1860</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="classsysio_1_1producer__plugin__impl.html#a1cd329e031b1d57746ec38a44a2181bbae349d735a5fa5b10d9770031e669c477">start_block_result::exhausted</a>;</div>
<div class="line"><a id="l01861" name="l01861"></a><span class="lineno"> 1861</span>         <span class="keywordflow">if</span>( !<a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#a5b19b3db1d6db7aa9a66a6a253417d7e">remove_expired_blacklisted_trxs</a>( preprocess_deadline ) )</div>
<div class="line"><a id="l01862" name="l01862"></a><span class="lineno"> 1862</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="classsysio_1_1producer__plugin__impl.html#a1cd329e031b1d57746ec38a44a2181bbae349d735a5fa5b10d9770031e669c477">start_block_result::exhausted</a>;</div>
<div class="line"><a id="l01863" name="l01863"></a><span class="lineno"> 1863</span>         <span class="keywordflow">if</span>( !<a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ad44e89d30a1ce2b3abb85711d5342490">_subjective_billing</a>.<a class="code hl_function" href="classsysio_1_1subjective__billing.html#a793fb0f1fa545a9de1d117cc95f6fbdc">remove_expired</a>( <a class="code hl_variable" href="producer__plugin_8cpp.html#adff615e9fbe43b3e6443687be568cffd">_log</a>, chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#abb1d81f96986df3bce46bd37caaf6a69">pending_block_time</a>(), <a class="code hl_function" href="classfc_1_1time__point.html#aa164ff1268a16d4b32afcff181f6100e">fc::time_point::now</a>(),</div>
<div class="line"><a id="l01864" name="l01864"></a><span class="lineno"> 1864</span>                                                  [&amp;](){ return should_interrupt_start_block( preprocess_deadline ); } ) ) {</div>
<div class="line"><a id="l01865" name="l01865"></a><span class="lineno"> 1865</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="classsysio_1_1producer__plugin__impl.html#a1cd329e031b1d57746ec38a44a2181bbae349d735a5fa5b10d9770031e669c477">start_block_result::exhausted</a>;</div>
<div class="line"><a id="l01866" name="l01866"></a><span class="lineno"> 1866</span>         }</div>
<div class="line"><a id="l01867" name="l01867"></a><span class="lineno"> 1867</span> </div>
<div class="line"><a id="l01868" name="l01868"></a><span class="lineno"> 1868</span>         <span class="comment">// limit execution of pending incoming to once per block</span></div>
<div class="line"><a id="l01869" name="l01869"></a><span class="lineno"> 1869</span>         <span class="keywordtype">size_t</span> pending_incoming_process_limit = <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ab9ac82b1ebcd89332e08e4246fd0a973">_unapplied_transactions</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1unapplied__transaction__queue.html#a2eda9b632f768fb2c1b76133b8d792f0">incoming_size</a>();</div>
<div class="line"><a id="l01870" name="l01870"></a><span class="lineno"> 1870</span> </div>
<div class="line"><a id="l01871" name="l01871"></a><span class="lineno"> 1871</span>         <span class="keywordflow">if</span>( !<a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#a7de28b674848c3de56118793193d3b49">process_unapplied_trxs</a>( preprocess_deadline ) )</div>
<div class="line"><a id="l01872" name="l01872"></a><span class="lineno"> 1872</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="classsysio_1_1producer__plugin__impl.html#a1cd329e031b1d57746ec38a44a2181bbae349d735a5fa5b10d9770031e669c477">start_block_result::exhausted</a>;</div>
<div class="line"><a id="l01873" name="l01873"></a><span class="lineno"> 1873</span> </div>
<div class="line"><a id="l01874" name="l01874"></a><span class="lineno"> 1874</span>         <span class="keywordflow">if</span> (<a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ae9554f576751ba3ac762b0f0c85fa5f2">_pending_block_mode</a> == <a class="code hl_enumvalue" href="namespacesysio.html#acd1c637e1a22040dbf666b0301cbc475afd75fc8d5de6f56947b1afc9e44ddb5f">pending_block_mode::producing</a>) {</div>
<div class="line"><a id="l01875" name="l01875"></a><span class="lineno"> 1875</span>            <span class="keyword">auto</span> scheduled_trx_deadline = preprocess_deadline;</div>
<div class="line"><a id="l01876" name="l01876"></a><span class="lineno"> 1876</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ab2a5cd86b46f7cac1891871a40cec1c1">_max_scheduled_transaction_time_per_block_ms</a> &gt;= 0) {</div>
<div class="line"><a id="l01877" name="l01877"></a><span class="lineno"> 1877</span>               scheduled_trx_deadline = std::min&lt;fc::time_point&gt;(</div>
<div class="line"><a id="l01878" name="l01878"></a><span class="lineno"> 1878</span>                     scheduled_trx_deadline,</div>
<div class="line"><a id="l01879" name="l01879"></a><span class="lineno"> 1879</span>                     <a class="code hl_function" href="classfc_1_1time__point.html#aa164ff1268a16d4b32afcff181f6100e">fc::time_point::now</a>() + <a class="code hl_function" href="namespacefc.html#a76ae235ec7e9b8862e70740058d7eb1b">fc::milliseconds</a>(<a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ab2a5cd86b46f7cac1891871a40cec1c1">_max_scheduled_transaction_time_per_block_ms</a>)</div>
<div class="line"><a id="l01880" name="l01880"></a><span class="lineno"> 1880</span>               );</div>
<div class="line"><a id="l01881" name="l01881"></a><span class="lineno"> 1881</span>            }</div>
<div class="line"><a id="l01882" name="l01882"></a><span class="lineno"> 1882</span>            <span class="comment">// may exhaust scheduled_trx_deadline but not preprocess_deadline, exhausted preprocess_deadline checked below</span></div>
<div class="line"><a id="l01883" name="l01883"></a><span class="lineno"> 1883</span>            <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#af3690d3cd99a828ada60fcf3decad39b">process_scheduled_and_incoming_trxs</a>( scheduled_trx_deadline, pending_incoming_process_limit );</div>
<div class="line"><a id="l01884" name="l01884"></a><span class="lineno"> 1884</span>         }</div>
<div class="line"><a id="l01885" name="l01885"></a><span class="lineno"> 1885</span> </div>
<div class="line"><a id="l01886" name="l01886"></a><span class="lineno"> 1886</span>         <span class="keywordflow">if</span>( <a class="code hl_function" href="namespaceappbase.html#a99374dc23934f008a09f2f79be9eae40">app</a>().is_quiting() ) <span class="comment">// db guard exception above in LOG_AND_DROP could have called app().quit()</span></div>
<div class="line"><a id="l01887" name="l01887"></a><span class="lineno"> 1887</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="classsysio_1_1producer__plugin__impl.html#a1cd329e031b1d57746ec38a44a2181bba26934eb377001f66e37289a5c93fe284">start_block_result::failed</a>;</div>
<div class="line"><a id="l01888" name="l01888"></a><span class="lineno"> 1888</span>         <span class="keywordflow">if</span> ( <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#a104ad57b8b9c3c8e53a680e09318ea5d">should_interrupt_start_block</a>( preprocess_deadline ) || <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#ab05cac0064c3afeb991b8e91cb76631e">block_is_exhausted</a>() ) {</div>
<div class="line"><a id="l01889" name="l01889"></a><span class="lineno"> 1889</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="classsysio_1_1producer__plugin__impl.html#a1cd329e031b1d57746ec38a44a2181bbae349d735a5fa5b10d9770031e669c477">start_block_result::exhausted</a>;</div>
<div class="line"><a id="l01890" name="l01890"></a><span class="lineno"> 1890</span>         } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01891" name="l01891"></a><span class="lineno"> 1891</span>            <span class="keywordflow">if</span>( !<a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#a708986322e03db824e4bad41ca213260">process_incoming_trxs</a>( preprocess_deadline, pending_incoming_process_limit ) )</div>
<div class="line"><a id="l01892" name="l01892"></a><span class="lineno"> 1892</span>               <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="classsysio_1_1producer__plugin__impl.html#a1cd329e031b1d57746ec38a44a2181bbae349d735a5fa5b10d9770031e669c477">start_block_result::exhausted</a>;</div>
<div class="line"><a id="l01893" name="l01893"></a><span class="lineno"> 1893</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="classsysio_1_1producer__plugin__impl.html#a1cd329e031b1d57746ec38a44a2181bba9b1751bd331d17d4f91c2c61c1d43560">start_block_result::succeeded</a>;</div>
<div class="line"><a id="l01894" name="l01894"></a><span class="lineno"> 1894</span>         }</div>
<div class="line"><a id="l01895" name="l01895"></a><span class="lineno"> 1895</span> </div>
<div class="line"><a id="l01896" name="l01896"></a><span class="lineno"> 1896</span>      } <span class="keywordflow">catch</span> ( <span class="keyword">const</span> <a class="code hl_variable" href="namespacesysio_1_1chain.html#a646553a6af0a730cdb19b9c6023d5132">guard_exception</a>&amp; e ) {</div>
<div class="line"><a id="l01897" name="l01897"></a><span class="lineno"> 1897</span>         <a class="code hl_function" href="classsysio_1_1chain__plugin.html#a6042f76be687a9b82332f28e1dc9a3a4">chain_plugin::handle_guard_exception</a>(e);</div>
<div class="line"><a id="l01898" name="l01898"></a><span class="lineno"> 1898</span>         <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="classsysio_1_1producer__plugin__impl.html#a1cd329e031b1d57746ec38a44a2181bba26934eb377001f66e37289a5c93fe284">start_block_result::failed</a>;</div>
<div class="line"><a id="l01899" name="l01899"></a><span class="lineno"> 1899</span>      } <span class="keywordflow">catch</span> ( std::bad_alloc&amp; ) {</div>
<div class="line"><a id="l01900" name="l01900"></a><span class="lineno"> 1900</span>         <a class="code hl_function" href="classsysio_1_1chain__plugin.html#a9fb4d31b915fb0d2ef5392a4284b67e6">chain_plugin::handle_bad_alloc</a>();</div>
<div class="line"><a id="l01901" name="l01901"></a><span class="lineno"> 1901</span>      } <span class="keywordflow">catch</span> ( boost::interprocess::bad_alloc&amp; ) {</div>
<div class="line"><a id="l01902" name="l01902"></a><span class="lineno"> 1902</span>         <a class="code hl_function" href="classsysio_1_1chain__plugin.html#a047022d2589d7624114c1e458b111ea7">chain_plugin::handle_db_exhaustion</a>();</div>
<div class="line"><a id="l01903" name="l01903"></a><span class="lineno"> 1903</span>      }</div>
<div class="line"><a id="l01904" name="l01904"></a><span class="lineno"> 1904</span> </div>
<div class="line"><a id="l01905" name="l01905"></a><span class="lineno"> 1905</span>   }</div>
<div class="line"><a id="l01906" name="l01906"></a><span class="lineno"> 1906</span> </div>
<div class="line"><a id="l01907" name="l01907"></a><span class="lineno"> 1907</span>   <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="classsysio_1_1producer__plugin__impl.html#a1cd329e031b1d57746ec38a44a2181bba26934eb377001f66e37289a5c93fe284">start_block_result::failed</a>;</div>
<div class="line"><a id="l01908" name="l01908"></a><span class="lineno"> 1908</span>}</div>
</div>
<div class="line"><a id="l01909" name="l01909"></a><span class="lineno"> 1909</span> </div>
<div class="foldopen" id="foldopen01910" data-start="{" data-end="}">
<div class="line"><a id="l01910" name="l01910"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#a07a7c896dddfa2b6c36cf67248d3599d"> 1910</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#a07a7c896dddfa2b6c36cf67248d3599d">producer_plugin_impl::remove_expired_trxs</a>( <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1time__point.html">fc::time_point</a>&amp; deadline )</div>
<div class="line"><a id="l01911" name="l01911"></a><span class="lineno"> 1911</span>{</div>
<div class="line"><a id="l01912" name="l01912"></a><span class="lineno"> 1912</span>   <a class="code hl_class" href="classsysio_1_1chain_1_1controller.html">chain::controller</a>&amp; chain = <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ad6dd1910645f0e41a009f59fdfc09cb4">chain_plug</a>-&gt;<a class="code hl_function" href="classsysio_1_1chain__plugin.html#a14a5e77b31ecf267c8062267d03440ae">chain</a>();</div>
<div class="line"><a id="l01913" name="l01913"></a><span class="lineno"> 1913</span>   <span class="keyword">auto</span> pending_block_time = chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#abb1d81f96986df3bce46bd37caaf6a69">pending_block_time</a>();</div>
<div class="line"><a id="l01914" name="l01914"></a><span class="lineno"> 1914</span> </div>
<div class="line"><a id="l01915" name="l01915"></a><span class="lineno"> 1915</span>   <span class="comment">// remove all expired transactions</span></div>
<div class="line"><a id="l01916" name="l01916"></a><span class="lineno"> 1916</span>   <span class="keywordtype">size_t</span> num_expired_persistent = 0;</div>
<div class="line"><a id="l01917" name="l01917"></a><span class="lineno"> 1917</span>   <span class="keywordtype">size_t</span> num_expired_other = 0;</div>
<div class="line"><a id="l01918" name="l01918"></a><span class="lineno"> 1918</span>   <span class="keywordtype">size_t</span> orig_count = <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ab9ac82b1ebcd89332e08e4246fd0a973">_unapplied_transactions</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1unapplied__transaction__queue.html#a7fb8cf5dfb622f9e619be9a4bb5eeba8">size</a>();</div>
<div class="line"><a id="l01919" name="l01919"></a><span class="lineno"> 1919</span>   <span class="keywordtype">bool</span> <a class="code hl_enumvalue" href="classsysio_1_1producer__plugin__impl.html#a1cd329e031b1d57746ec38a44a2181bbae349d735a5fa5b10d9770031e669c477">exhausted</a> = !<a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ab9ac82b1ebcd89332e08e4246fd0a973">_unapplied_transactions</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1unapplied__transaction__queue.html#a0ee4b3f8ad23d7b553e5a0f3224b32d4">clear_expired</a>( pending_block_time, [&amp;](){ <span class="keywordflow">return</span> <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#a104ad57b8b9c3c8e53a680e09318ea5d">should_interrupt_start_block</a>( deadline ); },</div>
<div class="line"><a id="l01920" name="l01920"></a><span class="lineno"> 1920</span>                  [<a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ad6dd1910645f0e41a009f59fdfc09cb4">chain_plug</a> = <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ad6dd1910645f0e41a009f59fdfc09cb4">chain_plug</a>, &amp;num_expired_persistent, &amp;num_expired_other, pbm = <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ae9554f576751ba3ac762b0f0c85fa5f2">_pending_block_mode</a>,</div>
<div class="line"><a id="l01921" name="l01921"></a><span class="lineno"> 1921</span>                   &amp;chain, has_producers = !<a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#af2f69a8ae164570dd17a1f970ae611eb">_producers</a>.empty()]( <span class="keyword">const</span> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#a7041c0316bd294d0866609ab3e0cc7a7">packed_transaction_ptr</a>&amp; packed_trx_ptr, <a class="code hl_enumeration" href="namespacesysio_1_1chain.html#affd9603ab5a713a9762157b12c8f6b9b">trx_enum_type</a> trx_type ) {</div>
<div class="line"><a id="l01922" name="l01922"></a><span class="lineno"> 1922</span>            <span class="keywordflow">if</span>( trx_type == trx_enum_type::persisted ) {</div>
<div class="line"><a id="l01923" name="l01923"></a><span class="lineno"> 1923</span>               <span class="keywordflow">if</span>( pbm == <a class="code hl_enumvalue" href="namespacesysio.html#acd1c637e1a22040dbf666b0301cbc475afd75fc8d5de6f56947b1afc9e44ddb5f">pending_block_mode::producing</a> ) {</div>
<div class="line"><a id="l01924" name="l01924"></a><span class="lineno"> 1924</span>                  <a class="code hl_define" href="logger_8hpp.html#af5adfcda7e0a01306256754a6511915d">fc_dlog</a>(<a class="code hl_variable" href="producer__plugin_8cpp.html#ae93a86d470c7e16b50ab7102170c5d4e">_trx_failed_trace_log</a>,</div>
<div class="line"><a id="l01925" name="l01925"></a><span class="lineno"> 1925</span>                           <span class="stringliteral">&quot;[TRX_TRACE] Block ${block_num} for producer ${prod} is EXPIRING PERSISTED tx: ${txid}&quot;</span>,</div>
<div class="line"><a id="l01926" name="l01926"></a><span class="lineno"> 1926</span>                           (<span class="stringliteral">&quot;block_num&quot;</span>, chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a33704b4936bb9bbd2ea6b0874ca521b4">head_block_num</a>() + 1)(<span class="stringliteral">&quot;txid&quot;</span>, packed_trx_ptr-&gt;id())</div>
<div class="line"><a id="l01927" name="l01927"></a><span class="lineno"> 1927</span>                           (<span class="stringliteral">&quot;prod&quot;</span>, chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a286751cd6498b500b70a0d3678672263">is_building_block</a>() ? chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a7a7a09290738585cd0e05580eeba0a95">pending_block_producer</a>() : <a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">name</a>()) );</div>
<div class="line"><a id="l01928" name="l01928"></a><span class="lineno"> 1928</span>                  <a class="code hl_define" href="logger_8hpp.html#af5adfcda7e0a01306256754a6511915d">fc_dlog</a>(<a class="code hl_variable" href="producer__plugin_8cpp.html#a78396757cc70405744561b647c892edf">_trx_log</a>, <span class="stringliteral">&quot;[TRX_TRACE] Block ${block_num} for producer ${prod} is EXPIRING PERSISTED tx: ${trx}&quot;</span>,</div>
<div class="line"><a id="l01929" name="l01929"></a><span class="lineno"> 1929</span>                          (<span class="stringliteral">&quot;block_num&quot;</span>, chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a33704b4936bb9bbd2ea6b0874ca521b4">head_block_num</a>() + 1)</div>
<div class="line"><a id="l01930" name="l01930"></a><span class="lineno"> 1930</span>                                (<span class="stringliteral">&quot;prod&quot;</span>, chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a286751cd6498b500b70a0d3678672263">is_building_block</a>() ? chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a7a7a09290738585cd0e05580eeba0a95">pending_block_producer</a>() : <a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">name</a>())</div>
<div class="line"><a id="l01931" name="l01931"></a><span class="lineno"> 1931</span>                                (<span class="stringliteral">&quot;trx&quot;</span>, <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ad6dd1910645f0e41a009f59fdfc09cb4">chain_plug</a>-&gt;<a class="code hl_function" href="classsysio_1_1chain__plugin.html#ae56bb5451f52c447629b2cecbd8d4b58">get_log_trx</a>(packed_trx_ptr-&gt;get_transaction())));</div>
<div class="line"><a id="l01932" name="l01932"></a><span class="lineno"> 1932</span>                  <a class="code hl_define" href="logger_8hpp.html#af5adfcda7e0a01306256754a6511915d">fc_dlog</a>(<a class="code hl_variable" href="producer__plugin_8cpp.html#a979f47bc56a17944271d72bccb834c33">_trx_trace_failure_log</a>, <span class="stringliteral">&quot;[TRX_TRACE] Block ${block_num} for producer ${prod} is EXPIRING PERSISTED tx: ${entire_trx}&quot;</span>,</div>
<div class="line"><a id="l01933" name="l01933"></a><span class="lineno"> 1933</span>                          (<span class="stringliteral">&quot;block_num&quot;</span>, chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a33704b4936bb9bbd2ea6b0874ca521b4">head_block_num</a>() + 1)</div>
<div class="line"><a id="l01934" name="l01934"></a><span class="lineno"> 1934</span>                                (<span class="stringliteral">&quot;prod&quot;</span>, chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a286751cd6498b500b70a0d3678672263">is_building_block</a>() ? chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a7a7a09290738585cd0e05580eeba0a95">pending_block_producer</a>() : <a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">name</a>())</div>
<div class="line"><a id="l01935" name="l01935"></a><span class="lineno"> 1935</span>                                (<span class="stringliteral">&quot;entire_trx&quot;</span>, <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ad6dd1910645f0e41a009f59fdfc09cb4">chain_plug</a>-&gt;<a class="code hl_function" href="classsysio_1_1chain__plugin.html#ae56bb5451f52c447629b2cecbd8d4b58">get_log_trx</a>(packed_trx_ptr-&gt;get_transaction())));</div>
<div class="line"><a id="l01936" name="l01936"></a><span class="lineno"> 1936</span> </div>
<div class="line"><a id="l01937" name="l01937"></a><span class="lineno"> 1937</span>               } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01938" name="l01938"></a><span class="lineno"> 1938</span>                  <a class="code hl_define" href="logger_8hpp.html#af5adfcda7e0a01306256754a6511915d">fc_dlog</a>(<a class="code hl_variable" href="producer__plugin_8cpp.html#ae93a86d470c7e16b50ab7102170c5d4e">_trx_failed_trace_log</a>, <span class="stringliteral">&quot;[TRX_TRACE] Speculative execution is EXPIRING PERSISTED tx: ${txid}&quot;</span>, (<span class="stringliteral">&quot;txid&quot;</span>, packed_trx_ptr-&gt;id()));</div>
<div class="line"><a id="l01939" name="l01939"></a><span class="lineno"> 1939</span> </div>
<div class="line"><a id="l01940" name="l01940"></a><span class="lineno"> 1940</span>                  <a class="code hl_define" href="logger_8hpp.html#af5adfcda7e0a01306256754a6511915d">fc_dlog</a>(<a class="code hl_variable" href="producer__plugin_8cpp.html#a78396757cc70405744561b647c892edf">_trx_log</a>, <span class="stringliteral">&quot;[TRX_TRACE] Speculative execution is EXPIRING PERSISTED tx: ${trx}&quot;</span>,</div>
<div class="line"><a id="l01941" name="l01941"></a><span class="lineno"> 1941</span>                          (<span class="stringliteral">&quot;trx&quot;</span>, <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ad6dd1910645f0e41a009f59fdfc09cb4">chain_plug</a>-&gt;<a class="code hl_function" href="classsysio_1_1chain__plugin.html#ae56bb5451f52c447629b2cecbd8d4b58">get_log_trx</a>(packed_trx_ptr-&gt;get_transaction())));</div>
<div class="line"><a id="l01942" name="l01942"></a><span class="lineno"> 1942</span>                  <a class="code hl_define" href="logger_8hpp.html#af5adfcda7e0a01306256754a6511915d">fc_dlog</a>(<a class="code hl_variable" href="producer__plugin_8cpp.html#a979f47bc56a17944271d72bccb834c33">_trx_trace_failure_log</a>, <span class="stringliteral">&quot;[TRX_TRACE] Speculative execution is EXPIRING PERSISTED tx: ${entire_trx}&quot;</span>,</div>
<div class="line"><a id="l01943" name="l01943"></a><span class="lineno"> 1943</span>                          (<span class="stringliteral">&quot;entire_trx&quot;</span>, <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ad6dd1910645f0e41a009f59fdfc09cb4">chain_plug</a>-&gt;<a class="code hl_function" href="classsysio_1_1chain__plugin.html#ae56bb5451f52c447629b2cecbd8d4b58">get_log_trx</a>(packed_trx_ptr-&gt;get_transaction())));</div>
<div class="line"><a id="l01944" name="l01944"></a><span class="lineno"> 1944</span>               }</div>
<div class="line"><a id="l01945" name="l01945"></a><span class="lineno"> 1945</span>               ++num_expired_persistent;</div>
<div class="line"><a id="l01946" name="l01946"></a><span class="lineno"> 1946</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01947" name="l01947"></a><span class="lineno"> 1947</span>               <span class="keywordflow">if</span> (has_producers) {</div>
<div class="line"><a id="l01948" name="l01948"></a><span class="lineno"> 1948</span>                  <a class="code hl_define" href="logger_8hpp.html#af5adfcda7e0a01306256754a6511915d">fc_dlog</a>(<a class="code hl_variable" href="producer__plugin_8cpp.html#ae93a86d470c7e16b50ab7102170c5d4e">_trx_failed_trace_log</a>,</div>
<div class="line"><a id="l01949" name="l01949"></a><span class="lineno"> 1949</span>                        <span class="stringliteral">&quot;[TRX_TRACE] Node with producers configured is dropping an EXPIRED transaction that was PREVIOUSLY ACCEPTED : ${txid}&quot;</span>,</div>
<div class="line"><a id="l01950" name="l01950"></a><span class="lineno"> 1950</span>                        (<span class="stringliteral">&quot;txid&quot;</span>, packed_trx_ptr-&gt;id()));</div>
<div class="line"><a id="l01951" name="l01951"></a><span class="lineno"> 1951</span> </div>
<div class="line"><a id="l01952" name="l01952"></a><span class="lineno"> 1952</span>                  <a class="code hl_define" href="logger_8hpp.html#af5adfcda7e0a01306256754a6511915d">fc_dlog</a>(<a class="code hl_variable" href="producer__plugin_8cpp.html#a78396757cc70405744561b647c892edf">_trx_log</a>, <span class="stringliteral">&quot;[TRX_TRACE] Node with producers configured is dropping an EXPIRED transaction that was PREVIOUSLY ACCEPTED: ${trx}&quot;</span>,</div>
<div class="line"><a id="l01953" name="l01953"></a><span class="lineno"> 1953</span>                          (<span class="stringliteral">&quot;trx&quot;</span>, <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ad6dd1910645f0e41a009f59fdfc09cb4">chain_plug</a>-&gt;<a class="code hl_function" href="classsysio_1_1chain__plugin.html#ae56bb5451f52c447629b2cecbd8d4b58">get_log_trx</a>(packed_trx_ptr-&gt;get_transaction())));</div>
<div class="line"><a id="l01954" name="l01954"></a><span class="lineno"> 1954</span>                  <a class="code hl_define" href="logger_8hpp.html#af5adfcda7e0a01306256754a6511915d">fc_dlog</a>(<a class="code hl_variable" href="producer__plugin_8cpp.html#a979f47bc56a17944271d72bccb834c33">_trx_trace_failure_log</a>, <span class="stringliteral">&quot;[TRX_TRACE] Node with producers configured is dropping an EXPIRED transaction that was PREVIOUSLY ACCEPTED: ${entire_trx}&quot;</span>,</div>
<div class="line"><a id="l01955" name="l01955"></a><span class="lineno"> 1955</span>                          (<span class="stringliteral">&quot;entire_trx&quot;</span>, <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ad6dd1910645f0e41a009f59fdfc09cb4">chain_plug</a>-&gt;<a class="code hl_function" href="classsysio_1_1chain__plugin.html#ae56bb5451f52c447629b2cecbd8d4b58">get_log_trx</a>(packed_trx_ptr-&gt;get_transaction())));</div>
<div class="line"><a id="l01956" name="l01956"></a><span class="lineno"> 1956</span>               }</div>
<div class="line"><a id="l01957" name="l01957"></a><span class="lineno"> 1957</span>               ++num_expired_other;</div>
<div class="line"><a id="l01958" name="l01958"></a><span class="lineno"> 1958</span>            }</div>
<div class="line"><a id="l01959" name="l01959"></a><span class="lineno"> 1959</span>   });</div>
<div class="line"><a id="l01960" name="l01960"></a><span class="lineno"> 1960</span> </div>
<div class="line"><a id="l01961" name="l01961"></a><span class="lineno"> 1961</span>   <span class="keywordflow">if</span>( <a class="code hl_enumvalue" href="classsysio_1_1producer__plugin__impl.html#a1cd329e031b1d57746ec38a44a2181bbae349d735a5fa5b10d9770031e669c477">exhausted</a> &amp;&amp; <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ae9554f576751ba3ac762b0f0c85fa5f2">_pending_block_mode</a> == <a class="code hl_enumvalue" href="namespacesysio.html#acd1c637e1a22040dbf666b0301cbc475afd75fc8d5de6f56947b1afc9e44ddb5f">pending_block_mode::producing</a> ) {</div>
<div class="line"><a id="l01962" name="l01962"></a><span class="lineno"> 1962</span>      <a class="code hl_define" href="logger_8hpp.html#af3086372b1da6bfce45ff871734f2e8d">fc_wlog</a>( <a class="code hl_variable" href="producer__plugin_8cpp.html#adff615e9fbe43b3e6443687be568cffd">_log</a>, <span class="stringliteral">&quot;Unable to process all expired transactions in unapplied queue before deadline, &quot;</span></div>
<div class="line"><a id="l01963" name="l01963"></a><span class="lineno"> 1963</span>                     <span class="stringliteral">&quot;Persistent expired ${persistent_expired}, Other expired ${other_expired}&quot;</span>,</div>
<div class="line"><a id="l01964" name="l01964"></a><span class="lineno"> 1964</span>               (<span class="stringliteral">&quot;persistent_expired&quot;</span>, num_expired_persistent)(<span class="stringliteral">&quot;other_expired&quot;</span>, num_expired_other) );</div>
<div class="line"><a id="l01965" name="l01965"></a><span class="lineno"> 1965</span>   } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01966" name="l01966"></a><span class="lineno"> 1966</span>      <a class="code hl_define" href="logger_8hpp.html#af5adfcda7e0a01306256754a6511915d">fc_dlog</a>( <a class="code hl_variable" href="producer__plugin_8cpp.html#adff615e9fbe43b3e6443687be568cffd">_log</a>, <span class="stringliteral">&quot;Processed ${m} expired transactions of the ${n} transactions in the unapplied queue, &quot;</span></div>
<div class="line"><a id="l01967" name="l01967"></a><span class="lineno"> 1967</span>                     <span class="stringliteral">&quot;Persistent expired ${persistent_expired}, Other expired ${other_expired}&quot;</span>,</div>
<div class="line"><a id="l01968" name="l01968"></a><span class="lineno"> 1968</span>               (<span class="stringliteral">&quot;m&quot;</span>, num_expired_persistent+num_expired_other)(<span class="stringliteral">&quot;n&quot;</span>, orig_count)</div>
<div class="line"><a id="l01969" name="l01969"></a><span class="lineno"> 1969</span>               (<span class="stringliteral">&quot;persistent_expired&quot;</span>, num_expired_persistent)(<span class="stringliteral">&quot;other_expired&quot;</span>, num_expired_other) );</div>
<div class="line"><a id="l01970" name="l01970"></a><span class="lineno"> 1970</span>   }</div>
<div class="line"><a id="l01971" name="l01971"></a><span class="lineno"> 1971</span> </div>
<div class="line"><a id="l01972" name="l01972"></a><span class="lineno"> 1972</span>   <span class="keywordflow">return</span> !<a class="code hl_enumvalue" href="classsysio_1_1producer__plugin__impl.html#a1cd329e031b1d57746ec38a44a2181bbae349d735a5fa5b10d9770031e669c477">exhausted</a>;</div>
<div class="line"><a id="l01973" name="l01973"></a><span class="lineno"> 1973</span>}</div>
</div>
<div class="line"><a id="l01974" name="l01974"></a><span class="lineno"> 1974</span> </div>
<div class="foldopen" id="foldopen01975" data-start="{" data-end="}">
<div class="line"><a id="l01975" name="l01975"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#a5b19b3db1d6db7aa9a66a6a253417d7e"> 1975</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#a5b19b3db1d6db7aa9a66a6a253417d7e">producer_plugin_impl::remove_expired_blacklisted_trxs</a>( <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1time__point.html">fc::time_point</a>&amp; deadline )</div>
<div class="line"><a id="l01976" name="l01976"></a><span class="lineno"> 1976</span>{</div>
<div class="line"><a id="l01977" name="l01977"></a><span class="lineno"> 1977</span>   <span class="keywordtype">bool</span> <a class="code hl_enumvalue" href="classsysio_1_1producer__plugin__impl.html#a1cd329e031b1d57746ec38a44a2181bbae349d735a5fa5b10d9770031e669c477">exhausted</a> = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01978" name="l01978"></a><span class="lineno"> 1978</span>   <span class="keyword">auto</span>&amp; blacklist_by_expiry = <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#a2146e64be3edae1b16c270ee9e0a54e5">_blacklisted_transactions</a>.get&lt;by_expiry&gt;();</div>
<div class="line"><a id="l01979" name="l01979"></a><span class="lineno"> 1979</span>   <span class="keywordflow">if</span>(!blacklist_by_expiry.empty()) {</div>
<div class="line"><a id="l01980" name="l01980"></a><span class="lineno"> 1980</span>      <span class="keyword">const</span> <a class="code hl_class" href="classsysio_1_1chain_1_1controller.html">chain::controller</a>&amp; chain = <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ad6dd1910645f0e41a009f59fdfc09cb4">chain_plug</a>-&gt;<a class="code hl_function" href="classsysio_1_1chain__plugin.html#a14a5e77b31ecf267c8062267d03440ae">chain</a>();</div>
<div class="line"><a id="l01981" name="l01981"></a><span class="lineno"> 1981</span>      <span class="keyword">const</span> <span class="keyword">auto</span> lib_time = chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a878ff6368c473051417382a9d485030d">last_irreversible_block_time</a>();</div>
<div class="line"><a id="l01982" name="l01982"></a><span class="lineno"> 1982</span> </div>
<div class="line"><a id="l01983" name="l01983"></a><span class="lineno"> 1983</span>      <span class="keywordtype">int</span> num_expired = 0;</div>
<div class="line"><a id="l01984" name="l01984"></a><span class="lineno"> 1984</span>      <span class="keywordtype">int</span> orig_count = <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#a2146e64be3edae1b16c270ee9e0a54e5">_blacklisted_transactions</a>.size();</div>
<div class="line"><a id="l01985" name="l01985"></a><span class="lineno"> 1985</span> </div>
<div class="line"><a id="l01986" name="l01986"></a><span class="lineno"> 1986</span>      <span class="keywordflow">while</span> (!blacklist_by_expiry.empty() &amp;&amp; blacklist_by_expiry.begin()-&gt;expiry &lt;= lib_time) {</div>
<div class="line"><a id="l01987" name="l01987"></a><span class="lineno"> 1987</span>         <span class="keywordflow">if</span> ( <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#a104ad57b8b9c3c8e53a680e09318ea5d">should_interrupt_start_block</a>( deadline ) ) {</div>
<div class="line"><a id="l01988" name="l01988"></a><span class="lineno"> 1988</span>            <a class="code hl_enumvalue" href="classsysio_1_1producer__plugin__impl.html#a1cd329e031b1d57746ec38a44a2181bbae349d735a5fa5b10d9770031e669c477">exhausted</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01989" name="l01989"></a><span class="lineno"> 1989</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01990" name="l01990"></a><span class="lineno"> 1990</span>         }</div>
<div class="line"><a id="l01991" name="l01991"></a><span class="lineno"> 1991</span>         blacklist_by_expiry.erase(blacklist_by_expiry.begin());</div>
<div class="line"><a id="l01992" name="l01992"></a><span class="lineno"> 1992</span>         num_expired++;</div>
<div class="line"><a id="l01993" name="l01993"></a><span class="lineno"> 1993</span>      }</div>
<div class="line"><a id="l01994" name="l01994"></a><span class="lineno"> 1994</span> </div>
<div class="line"><a id="l01995" name="l01995"></a><span class="lineno"> 1995</span>      <a class="code hl_define" href="logger_8hpp.html#af5adfcda7e0a01306256754a6511915d">fc_dlog</a>(<a class="code hl_variable" href="producer__plugin_8cpp.html#adff615e9fbe43b3e6443687be568cffd">_log</a>, <span class="stringliteral">&quot;Processed ${n} blacklisted transactions, Expired ${expired}&quot;</span>,</div>
<div class="line"><a id="l01996" name="l01996"></a><span class="lineno"> 1996</span>              (<span class="stringliteral">&quot;n&quot;</span>, orig_count)(<span class="stringliteral">&quot;expired&quot;</span>, num_expired));</div>
<div class="line"><a id="l01997" name="l01997"></a><span class="lineno"> 1997</span>   }</div>
<div class="line"><a id="l01998" name="l01998"></a><span class="lineno"> 1998</span>   <span class="keywordflow">return</span> !<a class="code hl_enumvalue" href="classsysio_1_1producer__plugin__impl.html#a1cd329e031b1d57746ec38a44a2181bbae349d735a5fa5b10d9770031e669c477">exhausted</a>;</div>
<div class="line"><a id="l01999" name="l01999"></a><span class="lineno"> 1999</span>}</div>
</div>
<div class="line"><a id="l02000" name="l02000"></a><span class="lineno"> 2000</span> </div>
<div class="foldopen" id="foldopen02001" data-start="{" data-end="}">
<div class="line"><a id="l02001" name="l02001"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#a7de28b674848c3de56118793193d3b49"> 2001</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#a7de28b674848c3de56118793193d3b49">producer_plugin_impl::process_unapplied_trxs</a>( <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1time__point.html">fc::time_point</a>&amp; deadline )</div>
<div class="line"><a id="l02002" name="l02002"></a><span class="lineno"> 2002</span>{</div>
<div class="line"><a id="l02003" name="l02003"></a><span class="lineno"> 2003</span>   <span class="keywordtype">bool</span> <a class="code hl_enumvalue" href="classsysio_1_1producer__plugin__impl.html#a1cd329e031b1d57746ec38a44a2181bbae349d735a5fa5b10d9770031e669c477">exhausted</a> = <span class="keyword">false</span>;</div>
<div class="line"><a id="l02004" name="l02004"></a><span class="lineno"> 2004</span>   <span class="keywordflow">if</span>( !<a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ab9ac82b1ebcd89332e08e4246fd0a973">_unapplied_transactions</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1unapplied__transaction__queue.html#a5a244791044e2d59736ff24339aed822">empty</a>() ) {</div>
<div class="line"><a id="l02005" name="l02005"></a><span class="lineno"> 2005</span>      <a class="code hl_class" href="classsysio_1_1chain_1_1controller.html">chain::controller</a>&amp; chain = <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ad6dd1910645f0e41a009f59fdfc09cb4">chain_plug</a>-&gt;<a class="code hl_function" href="classsysio_1_1chain__plugin.html#a14a5e77b31ecf267c8062267d03440ae">chain</a>();</div>
<div class="line"><a id="l02006" name="l02006"></a><span class="lineno"> 2006</span>      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; rl = chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#af096f331aa6ac6b3fe3aa71b3768daa8">get_resource_limits_manager</a>();</div>
<div class="line"><a id="l02007" name="l02007"></a><span class="lineno"> 2007</span>      <span class="keywordtype">int</span> num_applied = 0, num_failed = 0, num_processed = 0;</div>
<div class="line"><a id="l02008" name="l02008"></a><span class="lineno"> 2008</span>      <span class="keyword">auto</span> unapplied_trxs_size = <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ab9ac82b1ebcd89332e08e4246fd0a973">_unapplied_transactions</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1unapplied__transaction__queue.html#a7fb8cf5dfb622f9e619be9a4bb5eeba8">size</a>();</div>
<div class="line"><a id="l02009" name="l02009"></a><span class="lineno"> 2009</span>      <span class="comment">// unapplied and persisted do not have a next method to call</span></div>
<div class="line"><a id="l02010" name="l02010"></a><span class="lineno"> 2010</span>      <span class="keyword">auto</span> itr     = (<a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ae9554f576751ba3ac762b0f0c85fa5f2">_pending_block_mode</a> == <a class="code hl_enumvalue" href="namespacesysio.html#acd1c637e1a22040dbf666b0301cbc475afd75fc8d5de6f56947b1afc9e44ddb5f">pending_block_mode::producing</a>) ?</div>
<div class="line"><a id="l02011" name="l02011"></a><span class="lineno"> 2011</span>                     <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ab9ac82b1ebcd89332e08e4246fd0a973">_unapplied_transactions</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1unapplied__transaction__queue.html#a5906b1ee94fa2e09ae0eaa8d5cbd3711">unapplied_begin</a>() : <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ab9ac82b1ebcd89332e08e4246fd0a973">_unapplied_transactions</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1unapplied__transaction__queue.html#ac9f23f3629b373f5dd2f62a960472562">persisted_begin</a>();</div>
<div class="line"><a id="l02012" name="l02012"></a><span class="lineno"> 2012</span>      <span class="keyword">auto</span> end_itr = (<a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ae9554f576751ba3ac762b0f0c85fa5f2">_pending_block_mode</a> == <a class="code hl_enumvalue" href="namespacesysio.html#acd1c637e1a22040dbf666b0301cbc475afd75fc8d5de6f56947b1afc9e44ddb5f">pending_block_mode::producing</a>) ?</div>
<div class="line"><a id="l02013" name="l02013"></a><span class="lineno"> 2013</span>                     <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ab9ac82b1ebcd89332e08e4246fd0a973">_unapplied_transactions</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1unapplied__transaction__queue.html#a428508ff4641d3bf3503fa304696133d">unapplied_end</a>()   : <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ab9ac82b1ebcd89332e08e4246fd0a973">_unapplied_transactions</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1unapplied__transaction__queue.html#a49e515ce9a15ee839fbd8990c8bcb388">persisted_end</a>();</div>
<div class="line"><a id="l02014" name="l02014"></a><span class="lineno"> 2014</span>      <span class="keywordflow">while</span>( itr != end_itr ) {</div>
<div class="line"><a id="l02015" name="l02015"></a><span class="lineno"> 2015</span>         <span class="keywordflow">if</span>( <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#a104ad57b8b9c3c8e53a680e09318ea5d">should_interrupt_start_block</a>( deadline ) ) {</div>
<div class="line"><a id="l02016" name="l02016"></a><span class="lineno"> 2016</span>            <a class="code hl_enumvalue" href="classsysio_1_1producer__plugin__impl.html#a1cd329e031b1d57746ec38a44a2181bbae349d735a5fa5b10d9770031e669c477">exhausted</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l02017" name="l02017"></a><span class="lineno"> 2017</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l02018" name="l02018"></a><span class="lineno"> 2018</span>         }</div>
<div class="line"><a id="l02019" name="l02019"></a><span class="lineno"> 2019</span> </div>
<div class="line"><a id="l02020" name="l02020"></a><span class="lineno"> 2020</span>         <span class="keyword">const</span> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#ad795329e0af850251f4f47cc32e8d770">transaction_metadata_ptr</a> trx = itr-&gt;trx_meta;</div>
<div class="line"><a id="l02021" name="l02021"></a><span class="lineno"> 2021</span>         ++num_processed;</div>
<div class="line"><a id="l02022" name="l02022"></a><span class="lineno"> 2022</span>         <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l02023" name="l02023"></a><span class="lineno"> 2023</span>            <span class="keyword">auto</span> start = <a class="code hl_function" href="classfc_1_1time__point.html#aa164ff1268a16d4b32afcff181f6100e">fc::time_point::now</a>();</div>
<div class="line"><a id="l02024" name="l02024"></a><span class="lineno"> 2024</span> </div>
<div class="line"><a id="l02025" name="l02025"></a><span class="lineno"> 2025</span>            <span class="keyword">auto</span> first_auth = trx-&gt;packed_trx()-&gt;get_transaction().first_authorizer();</div>
<div class="line"><a id="l02026" name="l02026"></a><span class="lineno"> 2026</span>            <span class="keywordflow">if</span>( <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#afc937f75228984d541545dc4b59613a5">_account_fails</a>.failure_limit( first_auth ) ) {</div>
<div class="line"><a id="l02027" name="l02027"></a><span class="lineno"> 2027</span>               ++num_failed;</div>
<div class="line"><a id="l02028" name="l02028"></a><span class="lineno"> 2028</span>               <span class="keywordflow">if</span>( itr-&gt;next ) {</div>
<div class="line"><a id="l02029" name="l02029"></a><span class="lineno"> 2029</span>                  itr-&gt;next( std::make_shared&lt;tx_cpu_usage_exceeded&gt;(</div>
<div class="line"><a id="l02030" name="l02030"></a><span class="lineno"> 2030</span>                        <a class="code hl_define" href="log__message_8hpp.html#a4a4df4bb5cffbe07aadf7d29fd44c75e">FC_LOG_MESSAGE</a>( error, <span class="stringliteral">&quot;transaction ${id} exceeded failure limit for account ${a}&quot;</span>,</div>
<div class="line"><a id="l02031" name="l02031"></a><span class="lineno"> 2031</span>                                        (<span class="stringliteral">&quot;id&quot;</span>, trx-&gt;id())(<span class="stringliteral">&quot;a&quot;</span>, first_auth) ) ) );</div>
<div class="line"><a id="l02032" name="l02032"></a><span class="lineno"> 2032</span>               }</div>
<div class="line"><a id="l02033" name="l02033"></a><span class="lineno"> 2033</span>               itr = <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ab9ac82b1ebcd89332e08e4246fd0a973">_unapplied_transactions</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1unapplied__transaction__queue.html#a60c602838e90f62ba458d569cf52dfe5">erase</a>( itr );</div>
<div class="line"><a id="l02034" name="l02034"></a><span class="lineno"> 2034</span>               <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l02035" name="l02035"></a><span class="lineno"> 2035</span>            }</div>
<div class="line"><a id="l02036" name="l02036"></a><span class="lineno"> 2036</span> </div>
<div class="line"><a id="l02037" name="l02037"></a><span class="lineno"> 2037</span>            <a class="code hl_class" href="classfc_1_1microseconds.html">fc::microseconds</a> max_trx_time = <a class="code hl_function" href="namespacefc.html#a76ae235ec7e9b8862e70740058d7eb1b">fc::milliseconds</a>( <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#abfe8262ebb5c1493c44e198ad3cd79ca">_max_transaction_time_ms</a>.load() );</div>
<div class="line"><a id="l02038" name="l02038"></a><span class="lineno"> 2038</span>            <span class="keywordflow">if</span>( max_trx_time.<a class="code hl_function" href="classfc_1_1microseconds.html#a20fba59ec7e1f50c6b8f2c9443cc9b92">count</a>() &lt; 0 ) max_trx_time = <a class="code hl_function" href="classfc_1_1microseconds.html#afc3eb0bfd792c7b1cda062e559e30c2e">fc::microseconds::maximum</a>();</div>
<div class="line"><a id="l02039" name="l02039"></a><span class="lineno"> 2039</span> </div>
<div class="line"><a id="l02040" name="l02040"></a><span class="lineno"> 2040</span>            <span class="keyword">auto</span> prev_billed_cpu_time_us = trx-&gt;billed_cpu_time_us;</div>
<div class="line"><a id="l02041" name="l02041"></a><span class="lineno"> 2041</span>            <span class="keywordflow">if</span>( prev_billed_cpu_time_us &gt; 0 &amp;&amp; !<a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ad44e89d30a1ce2b3abb85711d5342490">_subjective_billing</a>.<a class="code hl_function" href="classsysio_1_1subjective__billing.html#a7da6a0636378886a46193d41089149bc">is_account_disabled</a>( first_auth ) &amp;&amp; !rl.is_unlimited_cpu( first_auth )) {</div>
<div class="line"><a id="l02042" name="l02042"></a><span class="lineno"> 2042</span>               <a class="code hl_typedef" href="stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a> prev_billed_plus100_us = prev_billed_cpu_time_us + <a class="code hl_function" href="chain_2include_2sysio_2chain_2config_8hpp.html#a0b4bacb63f31764f50a185f320551fbc">SYS_PERCENT</a>( prev_billed_cpu_time_us, 100 * config::percent_1 );</div>
<div class="line"><a id="l02043" name="l02043"></a><span class="lineno"> 2043</span>               <span class="keywordflow">if</span>( prev_billed_plus100_us &lt; max_trx_time.<a class="code hl_function" href="classfc_1_1microseconds.html#a20fba59ec7e1f50c6b8f2c9443cc9b92">count</a>() ) max_trx_time = <a class="code hl_class" href="classfc_1_1microseconds.html">fc::microseconds</a>( prev_billed_plus100_us );</div>
<div class="line"><a id="l02044" name="l02044"></a><span class="lineno"> 2044</span>            }</div>
<div class="line"><a id="l02045" name="l02045"></a><span class="lineno"> 2045</span> </div>
<div class="line"><a id="l02046" name="l02046"></a><span class="lineno"> 2046</span>            <span class="comment">// no subjective billing since we are producing or processing persisted trxs</span></div>
<div class="line"><a id="l02047" name="l02047"></a><span class="lineno"> 2047</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="stdint_8h.html#a414156feea104f8f75b4ed9e3121b2f6">int64_t</a> sub_bill = 0;</div>
<div class="line"><a id="l02048" name="l02048"></a><span class="lineno"> 2048</span>            <span class="keywordtype">bool</span> disable_subjective_billing = ( <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ae9554f576751ba3ac762b0f0c85fa5f2">_pending_block_mode</a> == <a class="code hl_enumvalue" href="namespacesysio.html#acd1c637e1a22040dbf666b0301cbc475afd75fc8d5de6f56947b1afc9e44ddb5f">pending_block_mode::producing</a> )</div>
<div class="line"><a id="l02049" name="l02049"></a><span class="lineno"> 2049</span>               || ( (itr-&gt;trx_type == trx_enum_type::persisted) &amp;&amp; <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ae781cd364031e6a3b5f890921f592eb6">_disable_subjective_api_billing</a> )</div>
<div class="line"><a id="l02050" name="l02050"></a><span class="lineno"> 2050</span>               || ( !(itr-&gt;trx_type == trx_enum_type::persisted) &amp;&amp; <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#a2cc24baff7f0994410c60383929d25e8">_disable_subjective_p2p_billing</a> )</div>
<div class="line"><a id="l02051" name="l02051"></a><span class="lineno"> 2051</span>               || trx-&gt;read_only;</div>
<div class="line"><a id="l02052" name="l02052"></a><span class="lineno"> 2052</span> </div>
<div class="line"><a id="l02053" name="l02053"></a><span class="lineno"> 2053</span>            <span class="keyword">auto</span> trace = chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a31c23187243554bdb6b54bb31bdb4bcd">push_transaction</a>( trx, deadline, max_trx_time, prev_billed_cpu_time_us, <span class="keyword">false</span>, sub_bill );</div>
<div class="line"><a id="l02054" name="l02054"></a><span class="lineno"> 2054</span>            <a class="code hl_define" href="logger_8hpp.html#af5adfcda7e0a01306256754a6511915d">fc_dlog</a>( <a class="code hl_variable" href="producer__plugin_8cpp.html#ae93a86d470c7e16b50ab7102170c5d4e">_trx_failed_trace_log</a>, <span class="stringliteral">&quot;Subjective unapplied bill for ${a}: ${b} prev ${t}us&quot;</span>, (<span class="stringliteral">&quot;a&quot;</span>,first_auth)(<span class="stringliteral">&quot;b&quot;</span>,prev_billed_cpu_time_us)(<span class="stringliteral">&quot;t&quot;</span>,trace-&gt;elapsed));</div>
<div class="line"><a id="l02055" name="l02055"></a><span class="lineno"> 2055</span>            <span class="keywordflow">if</span>( trace-&gt;except ) {</div>
<div class="line"><a id="l02056" name="l02056"></a><span class="lineno"> 2056</span>               <span class="keywordflow">if</span>( exception_is_exhausted( *trace-&gt;except ) ) {</div>
<div class="line"><a id="l02057" name="l02057"></a><span class="lineno"> 2057</span>                  <span class="keywordflow">if</span>( <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#ab05cac0064c3afeb991b8e91cb76631e">block_is_exhausted</a>() ) {</div>
<div class="line"><a id="l02058" name="l02058"></a><span class="lineno"> 2058</span>                     <a class="code hl_enumvalue" href="classsysio_1_1producer__plugin__impl.html#a1cd329e031b1d57746ec38a44a2181bbae349d735a5fa5b10d9770031e669c477">exhausted</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l02059" name="l02059"></a><span class="lineno"> 2059</span>                     <span class="comment">// don&#39;t erase, subjective failure so try again next time</span></div>
<div class="line"><a id="l02060" name="l02060"></a><span class="lineno"> 2060</span>                     <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l02061" name="l02061"></a><span class="lineno"> 2061</span>                  }</div>
<div class="line"><a id="l02062" name="l02062"></a><span class="lineno"> 2062</span>               } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l02063" name="l02063"></a><span class="lineno"> 2063</span>                  <a class="code hl_define" href="logger_8hpp.html#af5adfcda7e0a01306256754a6511915d">fc_dlog</a>( <a class="code hl_variable" href="producer__plugin_8cpp.html#ae93a86d470c7e16b50ab7102170c5d4e">_trx_failed_trace_log</a>, <span class="stringliteral">&quot;Subjective unapplied bill for failed ${a}: ${b} prev ${t}us&quot;</span>, (<span class="stringliteral">&quot;a&quot;</span>,first_auth)(<span class="stringliteral">&quot;b&quot;</span>,prev_billed_cpu_time_us)(<span class="stringliteral">&quot;t&quot;</span>,trace-&gt;elapsed));</div>
<div class="line"><a id="l02064" name="l02064"></a><span class="lineno"> 2064</span>                  <span class="keyword">auto</span> failure_code = trace-&gt;except-&gt;code();</div>
<div class="line"><a id="l02065" name="l02065"></a><span class="lineno"> 2065</span>                  <span class="keywordflow">if</span>( failure_code != tx_duplicate::code_value ) {</div>
<div class="line"><a id="l02066" name="l02066"></a><span class="lineno"> 2066</span>                     <span class="comment">// this failed our configured maximum transaction time, we don&#39;t want to replay it</span></div>
<div class="line"><a id="l02067" name="l02067"></a><span class="lineno"> 2067</span>                     <a class="code hl_define" href="logger_8hpp.html#af5adfcda7e0a01306256754a6511915d">fc_dlog</a>( <a class="code hl_variable" href="producer__plugin_8cpp.html#adff615e9fbe43b3e6443687be568cffd">_log</a>, <span class="stringliteral">&quot;Failed ${c} trx, prev billed: ${p}us, ran: ${r}us, id: ${id}&quot;</span>,</div>
<div class="line"><a id="l02068" name="l02068"></a><span class="lineno"> 2068</span>                              (<span class="stringliteral">&quot;c&quot;</span>, trace-&gt;except-&gt;code())(<span class="stringliteral">&quot;p&quot;</span>, prev_billed_cpu_time_us)</div>
<div class="line"><a id="l02069" name="l02069"></a><span class="lineno"> 2069</span>                              (<span class="stringliteral">&quot;r&quot;</span>, <a class="code hl_function" href="classfc_1_1time__point.html#aa164ff1268a16d4b32afcff181f6100e">fc::time_point::now</a>() - start)(<span class="stringliteral">&quot;id&quot;</span>, trx-&gt;id()) );</div>
<div class="line"><a id="l02070" name="l02070"></a><span class="lineno"> 2070</span>                     <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#afc937f75228984d541545dc4b59613a5">_account_fails</a>.add( first_auth, failure_code );</div>
<div class="line"><a id="l02071" name="l02071"></a><span class="lineno"> 2071</span>                     <span class="keywordflow">if</span> (!disable_subjective_billing)</div>
<div class="line"><a id="l02072" name="l02072"></a><span class="lineno"> 2072</span>                        <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ad44e89d30a1ce2b3abb85711d5342490">_subjective_billing</a>.<a class="code hl_function" href="classsysio_1_1subjective__billing.html#a50d2b20b8dc816f33f480062a24e074a">subjective_bill_failure</a>( first_auth, trace-&gt;elapsed, <a class="code hl_function" href="classfc_1_1time__point.html#aa164ff1268a16d4b32afcff181f6100e">fc::time_point::now</a>() );</div>
<div class="line"><a id="l02073" name="l02073"></a><span class="lineno"> 2073</span>                  }</div>
<div class="line"><a id="l02074" name="l02074"></a><span class="lineno"> 2074</span>                  ++num_failed;</div>
<div class="line"><a id="l02075" name="l02075"></a><span class="lineno"> 2075</span>                  <span class="keywordflow">if</span>( itr-&gt;next ) {</div>
<div class="line"><a id="l02076" name="l02076"></a><span class="lineno"> 2076</span>                     itr-&gt;next( trace-&gt;except-&gt;dynamic_copy_exception() );</div>
<div class="line"><a id="l02077" name="l02077"></a><span class="lineno"> 2077</span>                  }</div>
<div class="line"><a id="l02078" name="l02078"></a><span class="lineno"> 2078</span>                  itr = <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ab9ac82b1ebcd89332e08e4246fd0a973">_unapplied_transactions</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1unapplied__transaction__queue.html#a60c602838e90f62ba458d569cf52dfe5">erase</a>( itr );</div>
<div class="line"><a id="l02079" name="l02079"></a><span class="lineno"> 2079</span>                  <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l02080" name="l02080"></a><span class="lineno"> 2080</span>               }</div>
<div class="line"><a id="l02081" name="l02081"></a><span class="lineno"> 2081</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l02082" name="l02082"></a><span class="lineno"> 2082</span>               <a class="code hl_define" href="logger_8hpp.html#af5adfcda7e0a01306256754a6511915d">fc_dlog</a>( <a class="code hl_variable" href="producer__plugin_8cpp.html#aea18f7b7425ddc0191447aca7c3e27f6">_trx_successful_trace_log</a>, <span class="stringliteral">&quot;Subjective unapplied bill for success ${a}: ${b} prev ${t}us&quot;</span>, (<span class="stringliteral">&quot;a&quot;</span>,first_auth)(<span class="stringliteral">&quot;b&quot;</span>,prev_billed_cpu_time_us)(<span class="stringliteral">&quot;t&quot;</span>,trace-&gt;elapsed));</div>
<div class="line"><a id="l02083" name="l02083"></a><span class="lineno"> 2083</span>               <span class="comment">// if db_read_mode SPECULATIVE then trx is in the pending block and not immediately reverted</span></div>
<div class="line"><a id="l02084" name="l02084"></a><span class="lineno"> 2084</span>               <span class="keywordflow">if</span> (!disable_subjective_billing)</div>
<div class="line"><a id="l02085" name="l02085"></a><span class="lineno"> 2085</span>                  <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ad44e89d30a1ce2b3abb85711d5342490">_subjective_billing</a>.<a class="code hl_function" href="classsysio_1_1subjective__billing.html#a443a458832b5c475272149ccb31db567">subjective_bill</a>( trx-&gt;id(), trx-&gt;packed_trx()-&gt;expiration(), first_auth, trace-&gt;elapsed,</div>
<div class="line"><a id="l02086" name="l02086"></a><span class="lineno"> 2086</span>                                                    chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a28d33629f3badcb8155c08be3e05b99e">get_read_mode</a>() == <a class="code hl_enumvalue" href="namespacesysio_1_1chain.html#af3e35f3e1b78dd00fa247009a2d9ba5ea26ca3b6826ca765f741f39ec4754d581">chain::db_read_mode::SPECULATIVE</a> );</div>
<div class="line"><a id="l02087" name="l02087"></a><span class="lineno"> 2087</span>               ++num_applied;</div>
<div class="line"><a id="l02088" name="l02088"></a><span class="lineno"> 2088</span>               <span class="keywordflow">if</span>( itr-&gt;trx_type != trx_enum_type::persisted ) {</div>
<div class="line"><a id="l02089" name="l02089"></a><span class="lineno"> 2089</span>                  <span class="keywordflow">if</span>( itr-&gt;next ) itr-&gt;next( trace );</div>
<div class="line"><a id="l02090" name="l02090"></a><span class="lineno"> 2090</span>                  itr = <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ab9ac82b1ebcd89332e08e4246fd0a973">_unapplied_transactions</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1unapplied__transaction__queue.html#a60c602838e90f62ba458d569cf52dfe5">erase</a>( itr );</div>
<div class="line"><a id="l02091" name="l02091"></a><span class="lineno"> 2091</span>                  <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l02092" name="l02092"></a><span class="lineno"> 2092</span>               }</div>
<div class="line"><a id="l02093" name="l02093"></a><span class="lineno"> 2093</span>            }</div>
<div class="line"><a id="l02094" name="l02094"></a><span class="lineno"> 2094</span>         } <a class="code hl_define" href="producer__plugin_8cpp.html#a01d09f9c9fe1cbc1b70a0c41f0682e07">LOG_AND_DROP</a>();</div>
<div class="line"><a id="l02095" name="l02095"></a><span class="lineno"> 2095</span>         ++itr;</div>
<div class="line"><a id="l02096" name="l02096"></a><span class="lineno"> 2096</span>      }</div>
<div class="line"><a id="l02097" name="l02097"></a><span class="lineno"> 2097</span> </div>
<div class="line"><a id="l02098" name="l02098"></a><span class="lineno"> 2098</span>      <a class="code hl_define" href="logger_8hpp.html#af5adfcda7e0a01306256754a6511915d">fc_dlog</a>( <a class="code hl_variable" href="producer__plugin_8cpp.html#adff615e9fbe43b3e6443687be568cffd">_log</a>, <span class="stringliteral">&quot;Processed ${m} of ${n} previously applied transactions, Applied ${applied}, Failed/Dropped ${failed}&quot;</span>,</div>
<div class="line"><a id="l02099" name="l02099"></a><span class="lineno"> 2099</span>               (<span class="stringliteral">&quot;m&quot;</span>, num_processed)( <span class="stringliteral">&quot;n&quot;</span>, unapplied_trxs_size )(<span class="stringliteral">&quot;applied&quot;</span>, num_applied)(<span class="stringliteral">&quot;failed&quot;</span>, num_failed) );</div>
<div class="line"><a id="l02100" name="l02100"></a><span class="lineno"> 2100</span>   }</div>
<div class="line"><a id="l02101" name="l02101"></a><span class="lineno"> 2101</span>   <span class="keywordflow">return</span> !<a class="code hl_enumvalue" href="classsysio_1_1producer__plugin__impl.html#a1cd329e031b1d57746ec38a44a2181bbae349d735a5fa5b10d9770031e669c477">exhausted</a>;</div>
<div class="line"><a id="l02102" name="l02102"></a><span class="lineno"> 2102</span>}</div>
</div>
<div class="line"><a id="l02103" name="l02103"></a><span class="lineno"> 2103</span> </div>
<div class="foldopen" id="foldopen02104" data-start="{" data-end="}">
<div class="line"><a id="l02104" name="l02104"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#af3690d3cd99a828ada60fcf3decad39b"> 2104</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#af3690d3cd99a828ada60fcf3decad39b">producer_plugin_impl::process_scheduled_and_incoming_trxs</a>( <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1time__point.html">fc::time_point</a>&amp; deadline, <span class="keywordtype">size_t</span>&amp; pending_incoming_process_limit )</div>
<div class="line"><a id="l02105" name="l02105"></a><span class="lineno"> 2105</span>{</div>
<div class="line"><a id="l02106" name="l02106"></a><span class="lineno"> 2106</span>   <span class="comment">// scheduled transactions</span></div>
<div class="line"><a id="l02107" name="l02107"></a><span class="lineno"> 2107</span>   <span class="keywordtype">int</span> num_applied = 0;</div>
<div class="line"><a id="l02108" name="l02108"></a><span class="lineno"> 2108</span>   <span class="keywordtype">int</span> num_failed = 0;</div>
<div class="line"><a id="l02109" name="l02109"></a><span class="lineno"> 2109</span>   <span class="keywordtype">int</span> num_processed = 0;</div>
<div class="line"><a id="l02110" name="l02110"></a><span class="lineno"> 2110</span>   <span class="keywordtype">bool</span> <a class="code hl_enumvalue" href="classsysio_1_1producer__plugin__impl.html#a1cd329e031b1d57746ec38a44a2181bbae349d735a5fa5b10d9770031e669c477">exhausted</a> = <span class="keyword">false</span>;</div>
<div class="line"><a id="l02111" name="l02111"></a><span class="lineno"> 2111</span>   <span class="keywordtype">double</span> incoming_trx_weight = 0.0;</div>
<div class="line"><a id="l02112" name="l02112"></a><span class="lineno"> 2112</span> </div>
<div class="line"><a id="l02113" name="l02113"></a><span class="lineno"> 2113</span>   <span class="keyword">auto</span>&amp; blacklist_by_id = <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#a2146e64be3edae1b16c270ee9e0a54e5">_blacklisted_transactions</a>.get&lt;by_id&gt;();</div>
<div class="line"><a id="l02114" name="l02114"></a><span class="lineno"> 2114</span>   <a class="code hl_class" href="classsysio_1_1chain_1_1controller.html">chain::controller</a>&amp; chain = <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ad6dd1910645f0e41a009f59fdfc09cb4">chain_plug</a>-&gt;<a class="code hl_function" href="classsysio_1_1chain__plugin.html#a14a5e77b31ecf267c8062267d03440ae">chain</a>();</div>
<div class="line"><a id="l02115" name="l02115"></a><span class="lineno"> 2115</span>   <a class="code hl_class" href="classfc_1_1time__point.html">time_point</a> pending_block_time = chain.pending_block_time();</div>
<div class="line"><a id="l02116" name="l02116"></a><span class="lineno"> 2116</span>   <span class="keyword">auto</span> itr = <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ab9ac82b1ebcd89332e08e4246fd0a973">_unapplied_transactions</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1unapplied__transaction__queue.html#a581b5bfdb66db1dba220db3103d78631">incoming_begin</a>();</div>
<div class="line"><a id="l02117" name="l02117"></a><span class="lineno"> 2117</span>   <span class="keyword">auto</span> end = <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ab9ac82b1ebcd89332e08e4246fd0a973">_unapplied_transactions</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1unapplied__transaction__queue.html#ac15fce39af8a270bc242c4c09006daec">incoming_end</a>();</div>
<div class="line"><a id="l02118" name="l02118"></a><span class="lineno"> 2118</span>   <span class="keyword">const</span> <span class="keyword">auto</span>&amp; sch_idx = chain.db().get_index&lt;<a class="code hl_typedef" href="namespacesysio_1_1chain.html#a9e9842ee49526c2423e014a696edc602">generated_transaction_multi_index</a>,by_delay&gt;();</div>
<div class="line"><a id="l02119" name="l02119"></a><span class="lineno"> 2119</span>   <span class="keyword">const</span> <span class="keyword">auto</span> scheduled_trxs_size = sch_idx.size();</div>
<div class="line"><a id="l02120" name="l02120"></a><span class="lineno"> 2120</span>   <span class="keyword">auto</span> sch_itr = sch_idx.begin();</div>
<div class="line"><a id="l02121" name="l02121"></a><span class="lineno"> 2121</span>   <span class="keywordflow">while</span>( sch_itr != sch_idx.end() ) {</div>
<div class="line"><a id="l02122" name="l02122"></a><span class="lineno"> 2122</span>      <span class="keywordflow">if</span>( sch_itr-&gt;delay_until &gt; pending_block_time) <span class="keywordflow">break</span>;    <span class="comment">// not scheduled yet</span></div>
<div class="line"><a id="l02123" name="l02123"></a><span class="lineno"> 2123</span>      <span class="keywordflow">if</span>( <a class="code hl_enumvalue" href="classsysio_1_1producer__plugin__impl.html#a1cd329e031b1d57746ec38a44a2181bbae349d735a5fa5b10d9770031e669c477">exhausted</a> || deadline &lt;= <a class="code hl_function" href="classfc_1_1time__point.html#aa164ff1268a16d4b32afcff181f6100e">fc::time_point::now</a>() ) {</div>
<div class="line"><a id="l02124" name="l02124"></a><span class="lineno"> 2124</span>         <a class="code hl_enumvalue" href="classsysio_1_1producer__plugin__impl.html#a1cd329e031b1d57746ec38a44a2181bbae349d735a5fa5b10d9770031e669c477">exhausted</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l02125" name="l02125"></a><span class="lineno"> 2125</span>         <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l02126" name="l02126"></a><span class="lineno"> 2126</span>      }</div>
<div class="line"><a id="l02127" name="l02127"></a><span class="lineno"> 2127</span>      <span class="keywordflow">if</span>( sch_itr-&gt;published &gt;= pending_block_time ) {</div>
<div class="line"><a id="l02128" name="l02128"></a><span class="lineno"> 2128</span>         ++sch_itr;</div>
<div class="line"><a id="l02129" name="l02129"></a><span class="lineno"> 2129</span>         <span class="keywordflow">continue</span>; <span class="comment">// do not allow schedule and execute in same block</span></div>
<div class="line"><a id="l02130" name="l02130"></a><span class="lineno"> 2130</span>      }</div>
<div class="line"><a id="l02131" name="l02131"></a><span class="lineno"> 2131</span> </div>
<div class="line"><a id="l02132" name="l02132"></a><span class="lineno"> 2132</span>      <span class="keywordflow">if</span> (blacklist_by_id.find(sch_itr-&gt;trx_id) != blacklist_by_id.end()) {</div>
<div class="line"><a id="l02133" name="l02133"></a><span class="lineno"> 2133</span>         ++sch_itr;</div>
<div class="line"><a id="l02134" name="l02134"></a><span class="lineno"> 2134</span>         <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l02135" name="l02135"></a><span class="lineno"> 2135</span>      }</div>
<div class="line"><a id="l02136" name="l02136"></a><span class="lineno"> 2136</span> </div>
<div class="line"><a id="l02137" name="l02137"></a><span class="lineno"> 2137</span>      <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1sha256.html">transaction_id_type</a> trx_id = sch_itr-&gt;trx_id; <span class="comment">// make copy since reference could be invalidated</span></div>
<div class="line"><a id="l02138" name="l02138"></a><span class="lineno"> 2138</span>      <span class="keyword">const</span> <span class="keyword">auto</span> sch_expiration = sch_itr-&gt;expiration;</div>
<div class="line"><a id="l02139" name="l02139"></a><span class="lineno"> 2139</span>      <span class="keyword">auto</span> sch_itr_next = sch_itr; <span class="comment">// save off next since sch_itr may be invalidated by loop</span></div>
<div class="line"><a id="l02140" name="l02140"></a><span class="lineno"> 2140</span>      ++sch_itr_next;</div>
<div class="line"><a id="l02141" name="l02141"></a><span class="lineno"> 2141</span>      <span class="keyword">const</span> <span class="keyword">auto</span> next_delay_until = sch_itr_next != sch_idx.end() ? sch_itr_next-&gt;delay_until : sch_itr-&gt;delay_until;</div>
<div class="line"><a id="l02142" name="l02142"></a><span class="lineno"> 2142</span>      <span class="keyword">const</span> <span class="keyword">auto</span> next_id = sch_itr_next != sch_idx.end() ? sch_itr_next-&gt;id : sch_itr-&gt;id;</div>
<div class="line"><a id="l02143" name="l02143"></a><span class="lineno"> 2143</span> </div>
<div class="line"><a id="l02144" name="l02144"></a><span class="lineno"> 2144</span>      num_processed++;</div>
<div class="line"><a id="l02145" name="l02145"></a><span class="lineno"> 2145</span> </div>
<div class="line"><a id="l02146" name="l02146"></a><span class="lineno"> 2146</span>      <span class="comment">// configurable ratio of incoming txns vs deferred txns</span></div>
<div class="line"><a id="l02147" name="l02147"></a><span class="lineno"> 2147</span>      <span class="keywordflow">while</span> (incoming_trx_weight &gt;= 1.0 &amp;&amp; pending_incoming_process_limit &amp;&amp; itr != end ) {</div>
<div class="line"><a id="l02148" name="l02148"></a><span class="lineno"> 2148</span>         <span class="keywordflow">if</span> (deadline &lt;= <a class="code hl_function" href="classfc_1_1time__point.html#aa164ff1268a16d4b32afcff181f6100e">fc::time_point::now</a>()) {</div>
<div class="line"><a id="l02149" name="l02149"></a><span class="lineno"> 2149</span>            <a class="code hl_enumvalue" href="classsysio_1_1producer__plugin__impl.html#a1cd329e031b1d57746ec38a44a2181bbae349d735a5fa5b10d9770031e669c477">exhausted</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l02150" name="l02150"></a><span class="lineno"> 2150</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l02151" name="l02151"></a><span class="lineno"> 2151</span>         }</div>
<div class="line"><a id="l02152" name="l02152"></a><span class="lineno"> 2152</span> </div>
<div class="line"><a id="l02153" name="l02153"></a><span class="lineno"> 2153</span>         --pending_incoming_process_limit;</div>
<div class="line"><a id="l02154" name="l02154"></a><span class="lineno"> 2154</span>         incoming_trx_weight -= 1.0;</div>
<div class="line"><a id="l02155" name="l02155"></a><span class="lineno"> 2155</span> </div>
<div class="line"><a id="l02156" name="l02156"></a><span class="lineno"> 2156</span>         <span class="keyword">auto</span> trx_meta = itr-&gt;trx_meta;</div>
<div class="line"><a id="l02157" name="l02157"></a><span class="lineno"> 2157</span>         <span class="keyword">auto</span> next = itr-&gt;next;</div>
<div class="line"><a id="l02158" name="l02158"></a><span class="lineno"> 2158</span>         <span class="keywordtype">bool</span> persist_until_expired = itr-&gt;trx_type == trx_enum_type::incoming_persisted;</div>
<div class="line"><a id="l02159" name="l02159"></a><span class="lineno"> 2159</span>         <span class="keywordtype">bool</span> return_failure_trace = itr-&gt;return_failure_trace;</div>
<div class="line"><a id="l02160" name="l02160"></a><span class="lineno"> 2160</span>         itr = <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ab9ac82b1ebcd89332e08e4246fd0a973">_unapplied_transactions</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1unapplied__transaction__queue.html#a60c602838e90f62ba458d569cf52dfe5">erase</a>( itr );</div>
<div class="line"><a id="l02161" name="l02161"></a><span class="lineno"> 2161</span>         <span class="keywordflow">if</span>( !<a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#a2347f0637a0b2f1b2a16851aa4c3ef12">process_incoming_transaction_async</a>( trx_meta, persist_until_expired, return_failure_trace, next ) ) {</div>
<div class="line"><a id="l02162" name="l02162"></a><span class="lineno"> 2162</span>            <a class="code hl_enumvalue" href="classsysio_1_1producer__plugin__impl.html#a1cd329e031b1d57746ec38a44a2181bbae349d735a5fa5b10d9770031e669c477">exhausted</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l02163" name="l02163"></a><span class="lineno"> 2163</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l02164" name="l02164"></a><span class="lineno"> 2164</span>         }</div>
<div class="line"><a id="l02165" name="l02165"></a><span class="lineno"> 2165</span>      }</div>
<div class="line"><a id="l02166" name="l02166"></a><span class="lineno"> 2166</span> </div>
<div class="line"><a id="l02167" name="l02167"></a><span class="lineno"> 2167</span>      <span class="keywordflow">if</span> (<a class="code hl_enumvalue" href="classsysio_1_1producer__plugin__impl.html#a1cd329e031b1d57746ec38a44a2181bbae349d735a5fa5b10d9770031e669c477">exhausted</a> || deadline &lt;= <a class="code hl_function" href="classfc_1_1time__point.html#aa164ff1268a16d4b32afcff181f6100e">fc::time_point::now</a>()) {</div>
<div class="line"><a id="l02168" name="l02168"></a><span class="lineno"> 2168</span>         <a class="code hl_enumvalue" href="classsysio_1_1producer__plugin__impl.html#a1cd329e031b1d57746ec38a44a2181bbae349d735a5fa5b10d9770031e669c477">exhausted</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l02169" name="l02169"></a><span class="lineno"> 2169</span>         <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l02170" name="l02170"></a><span class="lineno"> 2170</span>      }</div>
<div class="line"><a id="l02171" name="l02171"></a><span class="lineno"> 2171</span> </div>
<div class="line"><a id="l02172" name="l02172"></a><span class="lineno"> 2172</span>      <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l02173" name="l02173"></a><span class="lineno"> 2173</span>         <a class="code hl_class" href="classfc_1_1microseconds.html">fc::microseconds</a> max_trx_time = <a class="code hl_function" href="namespacefc.html#a76ae235ec7e9b8862e70740058d7eb1b">fc::milliseconds</a>( <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#abfe8262ebb5c1493c44e198ad3cd79ca">_max_transaction_time_ms</a>.load() );</div>
<div class="line"><a id="l02174" name="l02174"></a><span class="lineno"> 2174</span>         <span class="keywordflow">if</span>( max_trx_time.<a class="code hl_function" href="classfc_1_1microseconds.html#a20fba59ec7e1f50c6b8f2c9443cc9b92">count</a>() &lt; 0 ) max_trx_time = <a class="code hl_function" href="classfc_1_1microseconds.html#afc3eb0bfd792c7b1cda062e559e30c2e">fc::microseconds::maximum</a>();</div>
<div class="line"><a id="l02175" name="l02175"></a><span class="lineno"> 2175</span> </div>
<div class="line"><a id="l02176" name="l02176"></a><span class="lineno"> 2176</span>         <span class="keyword">auto</span> trace = chain.push_scheduled_transaction(trx_id, deadline, max_trx_time, 0, <span class="keyword">false</span>);</div>
<div class="line"><a id="l02177" name="l02177"></a><span class="lineno"> 2177</span>         <span class="keywordflow">if</span> (trace-&gt;except) {</div>
<div class="line"><a id="l02178" name="l02178"></a><span class="lineno"> 2178</span>            <span class="keywordflow">if</span> (exception_is_exhausted(*trace-&gt;except)) {</div>
<div class="line"><a id="l02179" name="l02179"></a><span class="lineno"> 2179</span>               <span class="keywordflow">if</span>( <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#ab05cac0064c3afeb991b8e91cb76631e">block_is_exhausted</a>() ) {</div>
<div class="line"><a id="l02180" name="l02180"></a><span class="lineno"> 2180</span>                  <a class="code hl_enumvalue" href="classsysio_1_1producer__plugin__impl.html#a1cd329e031b1d57746ec38a44a2181bbae349d735a5fa5b10d9770031e669c477">exhausted</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l02181" name="l02181"></a><span class="lineno"> 2181</span>                  <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l02182" name="l02182"></a><span class="lineno"> 2182</span>               }</div>
<div class="line"><a id="l02183" name="l02183"></a><span class="lineno"> 2183</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l02184" name="l02184"></a><span class="lineno"> 2184</span>               <span class="comment">// this failed our configured maximum transaction time, we don&#39;t want to replay it add it to a blacklist</span></div>
<div class="line"><a id="l02185" name="l02185"></a><span class="lineno"> 2185</span>               <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#a2146e64be3edae1b16c270ee9e0a54e5">_blacklisted_transactions</a>.insert(<a class="code hl_struct" href="structsysio_1_1transaction__id__with__expiry.html">transaction_id_with_expiry</a>{trx_id, sch_expiration});</div>
<div class="line"><a id="l02186" name="l02186"></a><span class="lineno"> 2186</span>               num_failed++;</div>
<div class="line"><a id="l02187" name="l02187"></a><span class="lineno"> 2187</span>            }</div>
<div class="line"><a id="l02188" name="l02188"></a><span class="lineno"> 2188</span>         } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l02189" name="l02189"></a><span class="lineno"> 2189</span>            num_applied++;</div>
<div class="line"><a id="l02190" name="l02190"></a><span class="lineno"> 2190</span>         }</div>
<div class="line"><a id="l02191" name="l02191"></a><span class="lineno"> 2191</span>      } <a class="code hl_define" href="producer__plugin_8cpp.html#a01d09f9c9fe1cbc1b70a0c41f0682e07">LOG_AND_DROP</a>();</div>
<div class="line"><a id="l02192" name="l02192"></a><span class="lineno"> 2192</span> </div>
<div class="line"><a id="l02193" name="l02193"></a><span class="lineno"> 2193</span>      incoming_trx_weight += <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#a67c0fb2d1c7d16bd65cd86788d74eb0a">_incoming_defer_ratio</a>;</div>
<div class="line"><a id="l02194" name="l02194"></a><span class="lineno"> 2194</span>      <span class="keywordflow">if</span> (!pending_incoming_process_limit) incoming_trx_weight = 0.0;</div>
<div class="line"><a id="l02195" name="l02195"></a><span class="lineno"> 2195</span> </div>
<div class="line"><a id="l02196" name="l02196"></a><span class="lineno"> 2196</span>      <span class="keywordflow">if</span>( sch_itr_next == sch_idx.end() ) <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l02197" name="l02197"></a><span class="lineno"> 2197</span>      sch_itr = sch_idx.lower_bound( boost::make_tuple( next_delay_until, next_id ) );</div>
<div class="line"><a id="l02198" name="l02198"></a><span class="lineno"> 2198</span>   }</div>
<div class="line"><a id="l02199" name="l02199"></a><span class="lineno"> 2199</span> </div>
<div class="line"><a id="l02200" name="l02200"></a><span class="lineno"> 2200</span>   <span class="keywordflow">if</span>( scheduled_trxs_size &gt; 0 ) {</div>
<div class="line"><a id="l02201" name="l02201"></a><span class="lineno"> 2201</span>      <a class="code hl_define" href="logger_8hpp.html#af5adfcda7e0a01306256754a6511915d">fc_dlog</a>( <a class="code hl_variable" href="producer__plugin_8cpp.html#adff615e9fbe43b3e6443687be568cffd">_log</a>,</div>
<div class="line"><a id="l02202" name="l02202"></a><span class="lineno"> 2202</span>               <span class="stringliteral">&quot;Processed ${m} of ${n} scheduled transactions, Applied ${applied}, Failed/Dropped ${failed}&quot;</span>,</div>
<div class="line"><a id="l02203" name="l02203"></a><span class="lineno"> 2203</span>               ( <span class="stringliteral">&quot;m&quot;</span>, num_processed )( <span class="stringliteral">&quot;n&quot;</span>, scheduled_trxs_size )( <span class="stringliteral">&quot;applied&quot;</span>, num_applied )( <span class="stringliteral">&quot;failed&quot;</span>, num_failed ) );</div>
<div class="line"><a id="l02204" name="l02204"></a><span class="lineno"> 2204</span>   }</div>
<div class="line"><a id="l02205" name="l02205"></a><span class="lineno"> 2205</span>}</div>
</div>
<div class="line"><a id="l02206" name="l02206"></a><span class="lineno"> 2206</span> </div>
<div class="foldopen" id="foldopen02207" data-start="{" data-end="}">
<div class="line"><a id="l02207" name="l02207"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#a708986322e03db824e4bad41ca213260"> 2207</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#a708986322e03db824e4bad41ca213260">producer_plugin_impl::process_incoming_trxs</a>( <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1time__point.html">fc::time_point</a>&amp; deadline, <span class="keywordtype">size_t</span>&amp; pending_incoming_process_limit )</div>
<div class="line"><a id="l02208" name="l02208"></a><span class="lineno"> 2208</span>{</div>
<div class="line"><a id="l02209" name="l02209"></a><span class="lineno"> 2209</span>   <span class="keywordtype">bool</span> <a class="code hl_enumvalue" href="classsysio_1_1producer__plugin__impl.html#a1cd329e031b1d57746ec38a44a2181bbae349d735a5fa5b10d9770031e669c477">exhausted</a> = <span class="keyword">false</span>;</div>
<div class="line"><a id="l02210" name="l02210"></a><span class="lineno"> 2210</span>   <span class="keywordflow">if</span>( pending_incoming_process_limit ) {</div>
<div class="line"><a id="l02211" name="l02211"></a><span class="lineno"> 2211</span>      <span class="keywordtype">size_t</span> processed = 0;</div>
<div class="line"><a id="l02212" name="l02212"></a><span class="lineno"> 2212</span>      <a class="code hl_define" href="logger_8hpp.html#af5adfcda7e0a01306256754a6511915d">fc_dlog</a>( <a class="code hl_variable" href="producer__plugin_8cpp.html#adff615e9fbe43b3e6443687be568cffd">_log</a>, <span class="stringliteral">&quot;Processing ${n} pending transactions&quot;</span>, (<span class="stringliteral">&quot;n&quot;</span>, pending_incoming_process_limit) );</div>
<div class="line"><a id="l02213" name="l02213"></a><span class="lineno"> 2213</span>      <span class="keyword">auto</span> itr = <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ab9ac82b1ebcd89332e08e4246fd0a973">_unapplied_transactions</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1unapplied__transaction__queue.html#a581b5bfdb66db1dba220db3103d78631">incoming_begin</a>();</div>
<div class="line"><a id="l02214" name="l02214"></a><span class="lineno"> 2214</span>      <span class="keyword">auto</span> end = <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ab9ac82b1ebcd89332e08e4246fd0a973">_unapplied_transactions</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1unapplied__transaction__queue.html#ac15fce39af8a270bc242c4c09006daec">incoming_end</a>();</div>
<div class="line"><a id="l02215" name="l02215"></a><span class="lineno"> 2215</span>      <span class="keywordflow">while</span>( pending_incoming_process_limit &amp;&amp; itr != end ) {</div>
<div class="line"><a id="l02216" name="l02216"></a><span class="lineno"> 2216</span>         <span class="keywordflow">if</span> ( <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#a104ad57b8b9c3c8e53a680e09318ea5d">should_interrupt_start_block</a>( deadline ) ) {</div>
<div class="line"><a id="l02217" name="l02217"></a><span class="lineno"> 2217</span>            <a class="code hl_enumvalue" href="classsysio_1_1producer__plugin__impl.html#a1cd329e031b1d57746ec38a44a2181bbae349d735a5fa5b10d9770031e669c477">exhausted</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l02218" name="l02218"></a><span class="lineno"> 2218</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l02219" name="l02219"></a><span class="lineno"> 2219</span>         }</div>
<div class="line"><a id="l02220" name="l02220"></a><span class="lineno"> 2220</span>         --pending_incoming_process_limit;</div>
<div class="line"><a id="l02221" name="l02221"></a><span class="lineno"> 2221</span> </div>
<div class="line"><a id="l02222" name="l02222"></a><span class="lineno"> 2222</span>         <span class="keyword">auto</span> trx_meta = itr-&gt;trx_meta;</div>
<div class="line"><a id="l02223" name="l02223"></a><span class="lineno"> 2223</span>         <span class="keyword">auto</span> next = itr-&gt;next;</div>
<div class="line"><a id="l02224" name="l02224"></a><span class="lineno"> 2224</span>         <span class="keywordtype">bool</span> persist_until_expired = itr-&gt;trx_type == trx_enum_type::incoming_persisted;</div>
<div class="line"><a id="l02225" name="l02225"></a><span class="lineno"> 2225</span>         <span class="keywordtype">bool</span> return_failure_trace = itr-&gt;return_failure_trace;</div>
<div class="line"><a id="l02226" name="l02226"></a><span class="lineno"> 2226</span>         itr = <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ab9ac82b1ebcd89332e08e4246fd0a973">_unapplied_transactions</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1unapplied__transaction__queue.html#a60c602838e90f62ba458d569cf52dfe5">erase</a>( itr );</div>
<div class="line"><a id="l02227" name="l02227"></a><span class="lineno"> 2227</span>         <span class="keywordflow">if</span>( !<a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#a2347f0637a0b2f1b2a16851aa4c3ef12">process_incoming_transaction_async</a>( trx_meta, persist_until_expired, return_failure_trace, next ) ) {</div>
<div class="line"><a id="l02228" name="l02228"></a><span class="lineno"> 2228</span>            <a class="code hl_enumvalue" href="classsysio_1_1producer__plugin__impl.html#a1cd329e031b1d57746ec38a44a2181bbae349d735a5fa5b10d9770031e669c477">exhausted</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l02229" name="l02229"></a><span class="lineno"> 2229</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l02230" name="l02230"></a><span class="lineno"> 2230</span>         }</div>
<div class="line"><a id="l02231" name="l02231"></a><span class="lineno"> 2231</span>         ++processed;</div>
<div class="line"><a id="l02232" name="l02232"></a><span class="lineno"> 2232</span>      }</div>
<div class="line"><a id="l02233" name="l02233"></a><span class="lineno"> 2233</span>      <a class="code hl_define" href="logger_8hpp.html#af5adfcda7e0a01306256754a6511915d">fc_dlog</a>( <a class="code hl_variable" href="producer__plugin_8cpp.html#adff615e9fbe43b3e6443687be568cffd">_log</a>, <span class="stringliteral">&quot;Processed ${n} pending transactions, ${p} left&quot;</span>, (<span class="stringliteral">&quot;n&quot;</span>, processed)(<span class="stringliteral">&quot;p&quot;</span>, <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ab9ac82b1ebcd89332e08e4246fd0a973">_unapplied_transactions</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1unapplied__transaction__queue.html#a2eda9b632f768fb2c1b76133b8d792f0">incoming_size</a>()) );</div>
<div class="line"><a id="l02234" name="l02234"></a><span class="lineno"> 2234</span>   }</div>
<div class="line"><a id="l02235" name="l02235"></a><span class="lineno"> 2235</span>   <span class="keywordflow">return</span> !<a class="code hl_enumvalue" href="classsysio_1_1producer__plugin__impl.html#a1cd329e031b1d57746ec38a44a2181bbae349d735a5fa5b10d9770031e669c477">exhausted</a>;</div>
<div class="line"><a id="l02236" name="l02236"></a><span class="lineno"> 2236</span>}</div>
</div>
<div class="line"><a id="l02237" name="l02237"></a><span class="lineno"> 2237</span> </div>
<div class="foldopen" id="foldopen02238" data-start="{" data-end="}">
<div class="line"><a id="l02238" name="l02238"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#ab05cac0064c3afeb991b8e91cb76631e"> 2238</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#ab05cac0064c3afeb991b8e91cb76631e">producer_plugin_impl::block_is_exhausted</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a id="l02239" name="l02239"></a><span class="lineno"> 2239</span>   <span class="keyword">const</span> <a class="code hl_class" href="classsysio_1_1chain_1_1controller.html">chain::controller</a>&amp; chain = <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ad6dd1910645f0e41a009f59fdfc09cb4">chain_plug</a>-&gt;<a class="code hl_function" href="classsysio_1_1chain__plugin.html#a14a5e77b31ecf267c8062267d03440ae">chain</a>();</div>
<div class="line"><a id="l02240" name="l02240"></a><span class="lineno"> 2240</span>   <span class="keyword">const</span> <span class="keyword">auto</span>&amp; rl = chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#af096f331aa6ac6b3fe3aa71b3768daa8">get_resource_limits_manager</a>();</div>
<div class="line"><a id="l02241" name="l02241"></a><span class="lineno"> 2241</span> </div>
<div class="line"><a id="l02242" name="l02242"></a><span class="lineno"> 2242</span>   <span class="keyword">const</span> <a class="code hl_typedef" href="stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a> cpu_limit = rl.<a class="code hl_function" href="classsysio_1_1chain_1_1resource__limits_1_1resource__limits__manager.html#a59c1ce742daefcf8e370e844ed49f955">get_block_cpu_limit</a>();</div>
<div class="line"><a id="l02243" name="l02243"></a><span class="lineno"> 2243</span>   <span class="keywordflow">if</span>( cpu_limit &lt; <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ad027592bd832fc428fc2056775487276">_max_block_cpu_usage_threshold_us</a> ) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l02244" name="l02244"></a><span class="lineno"> 2244</span>   <span class="keyword">const</span> <a class="code hl_typedef" href="stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a> net_limit = rl.get_block_net_limit();</div>
<div class="line"><a id="l02245" name="l02245"></a><span class="lineno"> 2245</span>   <span class="keywordflow">if</span>( net_limit &lt; <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ad2cccb2f7374b5446a61dc8b7610d4d6">_max_block_net_usage_threshold_bytes</a> ) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l02246" name="l02246"></a><span class="lineno"> 2246</span>   <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l02247" name="l02247"></a><span class="lineno"> 2247</span>}</div>
</div>
<div class="line"><a id="l02248" name="l02248"></a><span class="lineno"> 2248</span> </div>
<div class="line"><a id="l02249" name="l02249"></a><span class="lineno"> 2249</span><span class="comment">// Example:</span></div>
<div class="line"><a id="l02250" name="l02250"></a><span class="lineno"> 2250</span><span class="comment">// --&gt; Start block A (block time x.500) at time x.000</span></div>
<div class="line"><a id="l02251" name="l02251"></a><span class="lineno"> 2251</span><span class="comment">// -&gt; start_block()</span></div>
<div class="line"><a id="l02252" name="l02252"></a><span class="lineno"> 2252</span><span class="comment">// --&gt; deadline, produce block x.500 at time x.400 (assuming 80% cpu block effort)</span></div>
<div class="line"><a id="l02253" name="l02253"></a><span class="lineno"> 2253</span><span class="comment">// -&gt; Idle</span></div>
<div class="line"><a id="l02254" name="l02254"></a><span class="lineno"> 2254</span><span class="comment">// --&gt; Start block B (block time y.000) at time x.500</span></div>
<div class="foldopen" id="foldopen02255" data-start="{" data-end="}">
<div class="line"><a id="l02255" name="l02255"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#ad8895b72aaf8928b54665684ffdb9405"> 2255</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#ad8895b72aaf8928b54665684ffdb9405">producer_plugin_impl::schedule_production_loop</a>() {</div>
<div class="line"><a id="l02256" name="l02256"></a><span class="lineno"> 2256</span>   <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#aad323427fd3fbc7d0decad90b324f44f">_received_block</a> = <span class="keyword">false</span>;</div>
<div class="line"><a id="l02257" name="l02257"></a><span class="lineno"> 2257</span>   <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ab031fc8338d68f086c7d183e7512c9ea">_timer</a>.cancel();</div>
<div class="line"><a id="l02258" name="l02258"></a><span class="lineno"> 2258</span> </div>
<div class="line"><a id="l02259" name="l02259"></a><span class="lineno"> 2259</span>   <span class="keyword">auto</span> result = <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#a7db63178eda240d671fc6ae4e46bf01e">start_block</a>();</div>
<div class="line"><a id="l02260" name="l02260"></a><span class="lineno"> 2260</span> </div>
<div class="line"><a id="l02261" name="l02261"></a><span class="lineno"> 2261</span>   <span class="keywordflow">if</span> (result == <a class="code hl_enumvalue" href="classsysio_1_1producer__plugin__impl.html#a1cd329e031b1d57746ec38a44a2181bba26934eb377001f66e37289a5c93fe284">start_block_result::failed</a>) {</div>
<div class="line"><a id="l02262" name="l02262"></a><span class="lineno"> 2262</span>      <a class="code hl_define" href="logger_8hpp.html#a9e3cdbaecd5a34b42956e888f7326fad">elog</a>(<span class="stringliteral">&quot;Failed to start a pending block, will try again later&quot;</span>);</div>
<div class="line"><a id="l02263" name="l02263"></a><span class="lineno"> 2263</span>      <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ab031fc8338d68f086c7d183e7512c9ea">_timer</a>.expires_from_now( boost::posix_time::microseconds( config::block_interval_us  / 10 ));</div>
<div class="line"><a id="l02264" name="l02264"></a><span class="lineno"> 2264</span> </div>
<div class="line"><a id="l02265" name="l02265"></a><span class="lineno"> 2265</span>      <span class="comment">// we failed to start a block, so try again later?</span></div>
<div class="line"><a id="l02266" name="l02266"></a><span class="lineno"> 2266</span>      <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ab031fc8338d68f086c7d183e7512c9ea">_timer</a>.async_wait( <a class="code hl_function" href="namespaceappbase.html#a99374dc23934f008a09f2f79be9eae40">app</a>().get_priority_queue().<a class="code hl_class" href="classsysio_1_1wrap.html">wrap</a>( <a class="code hl_variable" href="structappbase_1_1priority.html#adab9a6659f361fc6ca6c855788b05df0">priority::high</a>,</div>
<div class="line"><a id="l02267" name="l02267"></a><span class="lineno"> 2267</span>          [weak_this = weak_from_this(), cid = ++<a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#a21693978cec3fac7ce203531e88c7d5a">_timer_corelation_id</a>]( <span class="keyword">const</span> boost::system::error_code&amp; ec ) {</div>
<div class="line"><a id="l02268" name="l02268"></a><span class="lineno"> 2268</span>             <span class="keyword">auto</span> <a class="code hl_enumvalue" href="namespacesysio.html#a5c18cd9d34b8c5d3af8e2de75577673fa1f42b089b0bc1105b38f19140a65cc2a">self</a> = weak_this.lock();</div>
<div class="line"><a id="l02269" name="l02269"></a><span class="lineno"> 2269</span>             <span class="keywordflow">if</span>( <a class="code hl_enumvalue" href="namespacesysio.html#a5c18cd9d34b8c5d3af8e2de75577673fa1f42b089b0bc1105b38f19140a65cc2a">self</a> &amp;&amp; ec != boost::asio::error::operation_aborted &amp;&amp; cid == <a class="code hl_enumvalue" href="namespacesysio.html#a5c18cd9d34b8c5d3af8e2de75577673fa1f42b089b0bc1105b38f19140a65cc2a">self</a>-&gt;_timer_corelation_id ) {</div>
<div class="line"><a id="l02270" name="l02270"></a><span class="lineno"> 2270</span>                <a class="code hl_enumvalue" href="namespacesysio.html#a5c18cd9d34b8c5d3af8e2de75577673fa1f42b089b0bc1105b38f19140a65cc2a">self</a>-&gt;schedule_production_loop();</div>
<div class="line"><a id="l02271" name="l02271"></a><span class="lineno"> 2271</span>             }</div>
<div class="line"><a id="l02272" name="l02272"></a><span class="lineno"> 2272</span>          } ) );</div>
<div class="line"><a id="l02273" name="l02273"></a><span class="lineno"> 2273</span>   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (result == <a class="code hl_enumvalue" href="classsysio_1_1producer__plugin__impl.html#a1cd329e031b1d57746ec38a44a2181bba431da7f12530d5bf74adec7e85562038">start_block_result::waiting_for_block</a>){</div>
<div class="line"><a id="l02274" name="l02274"></a><span class="lineno"> 2274</span>      <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#af2f69a8ae164570dd17a1f970ae611eb">_producers</a>.empty() &amp;&amp; !<a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#a7964ed6135deaf78fe51442d0fde20f5">production_disabled_by_policy</a>()) {</div>
<div class="line"><a id="l02275" name="l02275"></a><span class="lineno"> 2275</span>         <a class="code hl_define" href="logger_8hpp.html#af5adfcda7e0a01306256754a6511915d">fc_dlog</a>(<a class="code hl_variable" href="producer__plugin_8cpp.html#adff615e9fbe43b3e6443687be568cffd">_log</a>, <span class="stringliteral">&quot;Waiting till another block is received and scheduling Speculative/Production Change&quot;</span>);</div>
<div class="line"><a id="l02276" name="l02276"></a><span class="lineno"> 2276</span>         <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#a15812dcb0edaaa48ab154d3bb2ca6a5c">schedule_delayed_production_loop</a>(weak_from_this(), <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#a652ecc759215ca6fa58b36370cc72e43">calculate_producer_wake_up_time</a>(<a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#afc6b3109ff8bdf1d18200e54f5fcbf0f">calculate_pending_block_time</a>()));</div>
<div class="line"><a id="l02277" name="l02277"></a><span class="lineno"> 2277</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l02278" name="l02278"></a><span class="lineno"> 2278</span>         <a class="code hl_define" href="logger_8hpp.html#af5adfcda7e0a01306256754a6511915d">fc_dlog</a>(<a class="code hl_variable" href="producer__plugin_8cpp.html#adff615e9fbe43b3e6443687be568cffd">_log</a>, <span class="stringliteral">&quot;Waiting till another block is received&quot;</span>);</div>
<div class="line"><a id="l02279" name="l02279"></a><span class="lineno"> 2279</span>         <span class="comment">// nothing to do until more blocks arrive</span></div>
<div class="line"><a id="l02280" name="l02280"></a><span class="lineno"> 2280</span>      }</div>
<div class="line"><a id="l02281" name="l02281"></a><span class="lineno"> 2281</span> </div>
<div class="line"><a id="l02282" name="l02282"></a><span class="lineno"> 2282</span>   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (result == <a class="code hl_enumvalue" href="classsysio_1_1producer__plugin__impl.html#a1cd329e031b1d57746ec38a44a2181bba0f967fbaf130c7283779d1cf6058d1fa">start_block_result::waiting_for_production</a>) {</div>
<div class="line"><a id="l02283" name="l02283"></a><span class="lineno"> 2283</span>      <span class="comment">// scheduled in start_block()</span></div>
<div class="line"><a id="l02284" name="l02284"></a><span class="lineno"> 2284</span> </div>
<div class="line"><a id="l02285" name="l02285"></a><span class="lineno"> 2285</span>   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ae9554f576751ba3ac762b0f0c85fa5f2">_pending_block_mode</a> == <a class="code hl_enumvalue" href="namespacesysio.html#acd1c637e1a22040dbf666b0301cbc475afd75fc8d5de6f56947b1afc9e44ddb5f">pending_block_mode::producing</a>) {</div>
<div class="line"><a id="l02286" name="l02286"></a><span class="lineno"> 2286</span>      <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#a46f5da3c1146a1e5f0850e541dac2d90">schedule_maybe_produce_block</a>( result == <a class="code hl_enumvalue" href="classsysio_1_1producer__plugin__impl.html#a1cd329e031b1d57746ec38a44a2181bbae349d735a5fa5b10d9770031e669c477">start_block_result::exhausted</a> );</div>
<div class="line"><a id="l02287" name="l02287"></a><span class="lineno"> 2287</span> </div>
<div class="line"><a id="l02288" name="l02288"></a><span class="lineno"> 2288</span>   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ae9554f576751ba3ac762b0f0c85fa5f2">_pending_block_mode</a> == <a class="code hl_enumvalue" href="namespacesysio.html#acd1c637e1a22040dbf666b0301cbc475aa25b9b4361a3bd215c739cf4f9cf2e4a">pending_block_mode::speculating</a> &amp;&amp; !<a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#af2f69a8ae164570dd17a1f970ae611eb">_producers</a>.empty() &amp;&amp; !<a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#a7964ed6135deaf78fe51442d0fde20f5">production_disabled_by_policy</a>()){</div>
<div class="line"><a id="l02289" name="l02289"></a><span class="lineno"> 2289</span>      <a class="code hl_class" href="classsysio_1_1chain_1_1controller.html">chain::controller</a>&amp; chain = <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ad6dd1910645f0e41a009f59fdfc09cb4">chain_plug</a>-&gt;<a class="code hl_function" href="classsysio_1_1chain__plugin.html#a14a5e77b31ecf267c8062267d03440ae">chain</a>();</div>
<div class="line"><a id="l02290" name="l02290"></a><span class="lineno"> 2290</span>      <a class="code hl_define" href="logger_8hpp.html#af5adfcda7e0a01306256754a6511915d">fc_dlog</a>(<a class="code hl_variable" href="producer__plugin_8cpp.html#adff615e9fbe43b3e6443687be568cffd">_log</a>, <span class="stringliteral">&quot;Speculative Block Created; Scheduling Speculative/Production Change&quot;</span>);</div>
<div class="line"><a id="l02291" name="l02291"></a><span class="lineno"> 2291</span>      <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a286751cd6498b500b70a0d3678672263">is_building_block</a>(), missing_pending_block_state, <span class="stringliteral">&quot;speculating without pending_block_state&quot;</span> );</div>
<div class="line"><a id="l02292" name="l02292"></a><span class="lineno"> 2292</span>      <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#a15812dcb0edaaa48ab154d3bb2ca6a5c">schedule_delayed_production_loop</a>(weak_from_this(), <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#a652ecc759215ca6fa58b36370cc72e43">calculate_producer_wake_up_time</a>(chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#abb1d81f96986df3bce46bd37caaf6a69">pending_block_time</a>()));</div>
<div class="line"><a id="l02293" name="l02293"></a><span class="lineno"> 2293</span>   } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l02294" name="l02294"></a><span class="lineno"> 2294</span>      <a class="code hl_define" href="logger_8hpp.html#af5adfcda7e0a01306256754a6511915d">fc_dlog</a>(<a class="code hl_variable" href="producer__plugin_8cpp.html#adff615e9fbe43b3e6443687be568cffd">_log</a>, <span class="stringliteral">&quot;Speculative Block Created&quot;</span>);</div>
<div class="line"><a id="l02295" name="l02295"></a><span class="lineno"> 2295</span>   }</div>
<div class="line"><a id="l02296" name="l02296"></a><span class="lineno"> 2296</span>}</div>
</div>
<div class="line"><a id="l02297" name="l02297"></a><span class="lineno"> 2297</span> </div>
<div class="foldopen" id="foldopen02298" data-start="{" data-end="}">
<div class="line"><a id="l02298" name="l02298"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#a46f5da3c1146a1e5f0850e541dac2d90"> 2298</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#a46f5da3c1146a1e5f0850e541dac2d90">producer_plugin_impl::schedule_maybe_produce_block</a>( <span class="keywordtype">bool</span> exhausted ) {</div>
<div class="line"><a id="l02299" name="l02299"></a><span class="lineno"> 2299</span>   <a class="code hl_class" href="classsysio_1_1chain_1_1controller.html">chain::controller</a>&amp; chain = <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ad6dd1910645f0e41a009f59fdfc09cb4">chain_plug</a>-&gt;<a class="code hl_function" href="classsysio_1_1chain__plugin.html#a14a5e77b31ecf267c8062267d03440ae">chain</a>();</div>
<div class="line"><a id="l02300" name="l02300"></a><span class="lineno"> 2300</span> </div>
<div class="line"><a id="l02301" name="l02301"></a><span class="lineno"> 2301</span>   <span class="comment">// we succeeded but block may be exhausted</span></div>
<div class="line"><a id="l02302" name="l02302"></a><span class="lineno"> 2302</span>   <span class="keyword">static</span> <span class="keyword">const</span> boost::posix_time::ptime epoch( boost::gregorian::date( 1970, 1, 1 ) );</div>
<div class="line"><a id="l02303" name="l02303"></a><span class="lineno"> 2303</span>   <span class="keyword">auto</span> deadline = <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#a90e415597bff893b9e18e7e3ca2ab275">calculate_block_deadline</a>( chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#abb1d81f96986df3bce46bd37caaf6a69">pending_block_time</a>() );</div>
<div class="line"><a id="l02304" name="l02304"></a><span class="lineno"> 2304</span> </div>
<div class="line"><a id="l02305" name="l02305"></a><span class="lineno"> 2305</span>   <span class="keywordflow">if</span>( !<a class="code hl_enumvalue" href="classsysio_1_1producer__plugin__impl.html#a1cd329e031b1d57746ec38a44a2181bbae349d735a5fa5b10d9770031e669c477">exhausted</a> &amp;&amp; deadline &gt; <a class="code hl_function" href="classfc_1_1time__point.html#aa164ff1268a16d4b32afcff181f6100e">fc::time_point::now</a>() ) {</div>
<div class="line"><a id="l02306" name="l02306"></a><span class="lineno"> 2306</span>      <span class="comment">// ship this block off no later than its deadline</span></div>
<div class="line"><a id="l02307" name="l02307"></a><span class="lineno"> 2307</span>      <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a286751cd6498b500b70a0d3678672263">is_building_block</a>(), missing_pending_block_state,</div>
<div class="line"><a id="l02308" name="l02308"></a><span class="lineno"> 2308</span>                  <span class="stringliteral">&quot;producing without pending_block_state, start_block succeeded&quot;</span> );</div>
<div class="line"><a id="l02309" name="l02309"></a><span class="lineno"> 2309</span>      <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ab031fc8338d68f086c7d183e7512c9ea">_timer</a>.expires_at( epoch + boost::posix_time::microseconds( deadline.time_since_epoch().count() ) );</div>
<div class="line"><a id="l02310" name="l02310"></a><span class="lineno"> 2310</span>      <a class="code hl_define" href="logger_8hpp.html#af5adfcda7e0a01306256754a6511915d">fc_dlog</a>( <a class="code hl_variable" href="producer__plugin_8cpp.html#adff615e9fbe43b3e6443687be568cffd">_log</a>, <span class="stringliteral">&quot;Scheduling Block Production on Normal Block #${num} for ${time}&quot;</span>,</div>
<div class="line"><a id="l02311" name="l02311"></a><span class="lineno"> 2311</span>               (<span class="stringliteral">&quot;num&quot;</span>, chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a33704b4936bb9bbd2ea6b0874ca521b4">head_block_num</a>() + 1)( <span class="stringliteral">&quot;time&quot;</span>, deadline ) );</div>
<div class="line"><a id="l02312" name="l02312"></a><span class="lineno"> 2312</span>   } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l02313" name="l02313"></a><span class="lineno"> 2313</span>      <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a286751cd6498b500b70a0d3678672263">is_building_block</a>(), missing_pending_block_state, <span class="stringliteral">&quot;producing without pending_block_state&quot;</span> );</div>
<div class="line"><a id="l02314" name="l02314"></a><span class="lineno"> 2314</span>      <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ab031fc8338d68f086c7d183e7512c9ea">_timer</a>.expires_from_now( boost::posix_time::microseconds( 0 ) );</div>
<div class="line"><a id="l02315" name="l02315"></a><span class="lineno"> 2315</span>      <a class="code hl_define" href="logger_8hpp.html#af5adfcda7e0a01306256754a6511915d">fc_dlog</a>( <a class="code hl_variable" href="producer__plugin_8cpp.html#adff615e9fbe43b3e6443687be568cffd">_log</a>, <span class="stringliteral">&quot;Scheduling Block Production on ${desc} Block #${num} immediately&quot;</span>,</div>
<div class="line"><a id="l02316" name="l02316"></a><span class="lineno"> 2316</span>               (<span class="stringliteral">&quot;num&quot;</span>, chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a33704b4936bb9bbd2ea6b0874ca521b4">head_block_num</a>() + 1)(<span class="stringliteral">&quot;desc&quot;</span>, <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#ab05cac0064c3afeb991b8e91cb76631e">block_is_exhausted</a>() ? <span class="stringliteral">&quot;Exhausted&quot;</span> : <span class="stringliteral">&quot;Deadline exceeded&quot;</span>) );</div>
<div class="line"><a id="l02317" name="l02317"></a><span class="lineno"> 2317</span>   }</div>
<div class="line"><a id="l02318" name="l02318"></a><span class="lineno"> 2318</span> </div>
<div class="line"><a id="l02319" name="l02319"></a><span class="lineno"> 2319</span>   <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ab031fc8338d68f086c7d183e7512c9ea">_timer</a>.async_wait( <a class="code hl_function" href="namespaceappbase.html#a99374dc23934f008a09f2f79be9eae40">app</a>().get_priority_queue().<a class="code hl_class" href="classsysio_1_1wrap.html">wrap</a>( <a class="code hl_variable" href="structappbase_1_1priority.html#adab9a6659f361fc6ca6c855788b05df0">priority::high</a>,</div>
<div class="line"><a id="l02320" name="l02320"></a><span class="lineno"> 2320</span>         [&amp;chain, weak_this = weak_from_this(), cid=++<a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#a21693978cec3fac7ce203531e88c7d5a">_timer_corelation_id</a>](<span class="keyword">const</span> boost::system::error_code&amp; ec) {</div>
<div class="line"><a id="l02321" name="l02321"></a><span class="lineno"> 2321</span>            <span class="keyword">auto</span> <a class="code hl_enumvalue" href="namespacesysio.html#a5c18cd9d34b8c5d3af8e2de75577673fa1f42b089b0bc1105b38f19140a65cc2a">self</a> = weak_this.lock();</div>
<div class="line"><a id="l02322" name="l02322"></a><span class="lineno"> 2322</span>            <span class="keywordflow">if</span>( <a class="code hl_enumvalue" href="namespacesysio.html#a5c18cd9d34b8c5d3af8e2de75577673fa1f42b089b0bc1105b38f19140a65cc2a">self</a> &amp;&amp; ec != boost::asio::error::operation_aborted &amp;&amp; cid == <a class="code hl_enumvalue" href="namespacesysio.html#a5c18cd9d34b8c5d3af8e2de75577673fa1f42b089b0bc1105b38f19140a65cc2a">self</a>-&gt;_timer_corelation_id ) {</div>
<div class="line"><a id="l02323" name="l02323"></a><span class="lineno"> 2323</span>               <span class="comment">// pending_block_state expected, but can&#39;t assert inside async_wait</span></div>
<div class="line"><a id="l02324" name="l02324"></a><span class="lineno"> 2324</span>               <span class="keyword">auto</span> block_num = chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a286751cd6498b500b70a0d3678672263">is_building_block</a>() ? chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a33704b4936bb9bbd2ea6b0874ca521b4">head_block_num</a>() + 1 : 0;</div>
<div class="line"><a id="l02325" name="l02325"></a><span class="lineno"> 2325</span>               <a class="code hl_define" href="logger_8hpp.html#af5adfcda7e0a01306256754a6511915d">fc_dlog</a>( <a class="code hl_variable" href="producer__plugin_8cpp.html#adff615e9fbe43b3e6443687be568cffd">_log</a>, <span class="stringliteral">&quot;Produce block timer for ${num} running at ${time}&quot;</span>, (<span class="stringliteral">&quot;num&quot;</span>, block_num)(<span class="stringliteral">&quot;time&quot;</span>, <a class="code hl_function" href="classfc_1_1time__point.html#aa164ff1268a16d4b32afcff181f6100e">fc::time_point::now</a>()) );</div>
<div class="line"><a id="l02326" name="l02326"></a><span class="lineno"> 2326</span>               <span class="keyword">auto</span> res = <a class="code hl_enumvalue" href="namespacesysio.html#a5c18cd9d34b8c5d3af8e2de75577673fa1f42b089b0bc1105b38f19140a65cc2a">self</a>-&gt;maybe_produce_block();</div>
<div class="line"><a id="l02327" name="l02327"></a><span class="lineno"> 2327</span>               <a class="code hl_define" href="logger_8hpp.html#af5adfcda7e0a01306256754a6511915d">fc_dlog</a>( <a class="code hl_variable" href="producer__plugin_8cpp.html#adff615e9fbe43b3e6443687be568cffd">_log</a>, <span class="stringliteral">&quot;Producing Block #${num} returned: ${res}&quot;</span>, (<span class="stringliteral">&quot;num&quot;</span>, block_num)( <span class="stringliteral">&quot;res&quot;</span>, res ) );</div>
<div class="line"><a id="l02328" name="l02328"></a><span class="lineno"> 2328</span>            }</div>
<div class="line"><a id="l02329" name="l02329"></a><span class="lineno"> 2329</span>         } ) );</div>
<div class="line"><a id="l02330" name="l02330"></a><span class="lineno"> 2330</span>}</div>
</div>
<div class="line"><a id="l02331" name="l02331"></a><span class="lineno"> 2331</span> </div>
<div class="foldopen" id="foldopen02332" data-start="{" data-end="}">
<div class="line"><a id="l02332" name="l02332"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#a652ecc759215ca6fa58b36370cc72e43"> 2332</a></span>std::optional&lt;fc::time_point&gt; <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#a652ecc759215ca6fa58b36370cc72e43">producer_plugin_impl::calculate_producer_wake_up_time</a>( <span class="keyword">const</span> <a class="code hl_class" href="classsysio_1_1chain_1_1block__timestamp.html">block_timestamp_type</a>&amp; ref_block_time )<span class="keyword"> const </span>{</div>
<div class="line"><a id="l02333" name="l02333"></a><span class="lineno"> 2333</span>   <span class="comment">// if we have any producers then we should at least set a timer for our next available slot</span></div>
<div class="line"><a id="l02334" name="l02334"></a><span class="lineno"> 2334</span>   std::optional&lt;fc::time_point&gt; wake_up_time;</div>
<div class="line"><a id="l02335" name="l02335"></a><span class="lineno"> 2335</span>   <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code hl_variable" href="bn_8cpp.html#a8b0eadcc506862e9d751ab45185053aa">p</a> : <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#af2f69a8ae164570dd17a1f970ae611eb">_producers</a>) {</div>
<div class="line"><a id="l02336" name="l02336"></a><span class="lineno"> 2336</span>      <span class="keyword">auto</span> next_producer_block_time = <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#a9368777de44180b2070838ff18f2fb36">calculate_next_block_time</a>(<a class="code hl_variable" href="bn_8cpp.html#a8b0eadcc506862e9d751ab45185053aa">p</a>, ref_block_time);</div>
<div class="line"><a id="l02337" name="l02337"></a><span class="lineno"> 2337</span>      <span class="keywordflow">if</span> (next_producer_block_time) {</div>
<div class="line"><a id="l02338" name="l02338"></a><span class="lineno"> 2338</span>         <span class="keyword">auto</span> producer_wake_up_time = *next_producer_block_time - <a class="code hl_class" href="classfc_1_1microseconds.html">fc::microseconds</a>(config::block_interval_us);</div>
<div class="line"><a id="l02339" name="l02339"></a><span class="lineno"> 2339</span>         <span class="keywordflow">if</span> (wake_up_time) {</div>
<div class="line"><a id="l02340" name="l02340"></a><span class="lineno"> 2340</span>            <span class="comment">// wake up with a full block interval to the deadline</span></div>
<div class="line"><a id="l02341" name="l02341"></a><span class="lineno"> 2341</span>            <span class="keywordflow">if</span>( producer_wake_up_time &lt; *wake_up_time ) {</div>
<div class="line"><a id="l02342" name="l02342"></a><span class="lineno"> 2342</span>               wake_up_time = producer_wake_up_time;</div>
<div class="line"><a id="l02343" name="l02343"></a><span class="lineno"> 2343</span>            }</div>
<div class="line"><a id="l02344" name="l02344"></a><span class="lineno"> 2344</span>         } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l02345" name="l02345"></a><span class="lineno"> 2345</span>            wake_up_time = producer_wake_up_time;</div>
<div class="line"><a id="l02346" name="l02346"></a><span class="lineno"> 2346</span>         }</div>
<div class="line"><a id="l02347" name="l02347"></a><span class="lineno"> 2347</span>      }</div>
<div class="line"><a id="l02348" name="l02348"></a><span class="lineno"> 2348</span>   }</div>
<div class="line"><a id="l02349" name="l02349"></a><span class="lineno"> 2349</span>   <span class="keywordflow">if</span>( !wake_up_time ) {</div>
<div class="line"><a id="l02350" name="l02350"></a><span class="lineno"> 2350</span>      <a class="code hl_define" href="logger_8hpp.html#af5adfcda7e0a01306256754a6511915d">fc_dlog</a>(<a class="code hl_variable" href="producer__plugin_8cpp.html#adff615e9fbe43b3e6443687be568cffd">_log</a>, <span class="stringliteral">&quot;Not Scheduling Speculative/Production, no local producers had valid wake up times&quot;</span>);</div>
<div class="line"><a id="l02351" name="l02351"></a><span class="lineno"> 2351</span>   }</div>
<div class="line"><a id="l02352" name="l02352"></a><span class="lineno"> 2352</span> </div>
<div class="line"><a id="l02353" name="l02353"></a><span class="lineno"> 2353</span>   <span class="keywordflow">return</span> wake_up_time;</div>
<div class="line"><a id="l02354" name="l02354"></a><span class="lineno"> 2354</span>}</div>
</div>
<div class="line"><a id="l02355" name="l02355"></a><span class="lineno"> 2355</span> </div>
<div class="foldopen" id="foldopen02356" data-start="{" data-end="}">
<div class="line"><a id="l02356" name="l02356"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#a15812dcb0edaaa48ab154d3bb2ca6a5c"> 2356</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#a15812dcb0edaaa48ab154d3bb2ca6a5c">producer_plugin_impl::schedule_delayed_production_loop</a>(<span class="keyword">const</span> std::weak_ptr&lt;producer_plugin_impl&gt;&amp; weak_this, std::optional&lt;fc::time_point&gt; wake_up_time) {</div>
<div class="line"><a id="l02357" name="l02357"></a><span class="lineno"> 2357</span>   <span class="keywordflow">if</span> (wake_up_time) {</div>
<div class="line"><a id="l02358" name="l02358"></a><span class="lineno"> 2358</span>      <a class="code hl_define" href="logger_8hpp.html#af5adfcda7e0a01306256754a6511915d">fc_dlog</a>(<a class="code hl_variable" href="producer__plugin_8cpp.html#adff615e9fbe43b3e6443687be568cffd">_log</a>, <span class="stringliteral">&quot;Scheduling Speculative/Production Change at ${time}&quot;</span>, (<span class="stringliteral">&quot;time&quot;</span>, wake_up_time));</div>
<div class="line"><a id="l02359" name="l02359"></a><span class="lineno"> 2359</span>      <span class="keyword">static</span> <span class="keyword">const</span> boost::posix_time::ptime epoch(boost::gregorian::date(1970, 1, 1));</div>
<div class="line"><a id="l02360" name="l02360"></a><span class="lineno"> 2360</span>      <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ab031fc8338d68f086c7d183e7512c9ea">_timer</a>.expires_at(epoch + boost::posix_time::microseconds(wake_up_time-&gt;time_since_epoch().count()));</div>
<div class="line"><a id="l02361" name="l02361"></a><span class="lineno"> 2361</span>      <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ab031fc8338d68f086c7d183e7512c9ea">_timer</a>.async_wait( <a class="code hl_function" href="namespaceappbase.html#a99374dc23934f008a09f2f79be9eae40">app</a>().get_priority_queue().<a class="code hl_class" href="classsysio_1_1wrap.html">wrap</a>( <a class="code hl_variable" href="structappbase_1_1priority.html#adab9a6659f361fc6ca6c855788b05df0">priority::high</a>,</div>
<div class="line"><a id="l02362" name="l02362"></a><span class="lineno"> 2362</span>         [weak_this,cid=++<a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#a21693978cec3fac7ce203531e88c7d5a">_timer_corelation_id</a>](<span class="keyword">const</span> boost::system::error_code&amp; ec) {</div>
<div class="line"><a id="l02363" name="l02363"></a><span class="lineno"> 2363</span>            <span class="keyword">auto</span> <a class="code hl_enumvalue" href="namespacesysio.html#a5c18cd9d34b8c5d3af8e2de75577673fa1f42b089b0bc1105b38f19140a65cc2a">self</a> = weak_this.lock();</div>
<div class="line"><a id="l02364" name="l02364"></a><span class="lineno"> 2364</span>            <span class="keywordflow">if</span>( <a class="code hl_enumvalue" href="namespacesysio.html#a5c18cd9d34b8c5d3af8e2de75577673fa1f42b089b0bc1105b38f19140a65cc2a">self</a> &amp;&amp; ec != boost::asio::error::operation_aborted &amp;&amp; cid == <a class="code hl_enumvalue" href="namespacesysio.html#a5c18cd9d34b8c5d3af8e2de75577673fa1f42b089b0bc1105b38f19140a65cc2a">self</a>-&gt;_timer_corelation_id ) {</div>
<div class="line"><a id="l02365" name="l02365"></a><span class="lineno"> 2365</span>               <a class="code hl_enumvalue" href="namespacesysio.html#a5c18cd9d34b8c5d3af8e2de75577673fa1f42b089b0bc1105b38f19140a65cc2a">self</a>-&gt;schedule_production_loop();</div>
<div class="line"><a id="l02366" name="l02366"></a><span class="lineno"> 2366</span>            }</div>
<div class="line"><a id="l02367" name="l02367"></a><span class="lineno"> 2367</span>         } ) );</div>
<div class="line"><a id="l02368" name="l02368"></a><span class="lineno"> 2368</span>   }</div>
<div class="line"><a id="l02369" name="l02369"></a><span class="lineno"> 2369</span>}</div>
</div>
<div class="line"><a id="l02370" name="l02370"></a><span class="lineno"> 2370</span> </div>
<div class="line"><a id="l02371" name="l02371"></a><span class="lineno"> 2371</span> </div>
<div class="foldopen" id="foldopen02372" data-start="{" data-end="}">
<div class="line"><a id="l02372" name="l02372"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#a230c88a6ed7efbc3588a043fe4915bd9"> 2372</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#a230c88a6ed7efbc3588a043fe4915bd9">producer_plugin_impl::maybe_produce_block</a>() {</div>
<div class="line"><a id="l02373" name="l02373"></a><span class="lineno"> 2373</span>   <span class="keyword">auto</span> reschedule = <a class="code hl_function" href="namespacefc.html#a23d89b54a8ffd84f7e7efeb21747d846">fc::make_scoped_exit</a>([<span class="keyword">this</span>]{</div>
<div class="line"><a id="l02374" name="l02374"></a><span class="lineno"> 2374</span>      <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#ad8895b72aaf8928b54665684ffdb9405">schedule_production_loop</a>();</div>
<div class="line"><a id="l02375" name="l02375"></a><span class="lineno"> 2375</span>   });</div>
<div class="line"><a id="l02376" name="l02376"></a><span class="lineno"> 2376</span> </div>
<div class="line"><a id="l02377" name="l02377"></a><span class="lineno"> 2377</span>   <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l02378" name="l02378"></a><span class="lineno"> 2378</span>      <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#a336a35581aedb4308f8fc7f4eb44f152">produce_block</a>();</div>
<div class="line"><a id="l02379" name="l02379"></a><span class="lineno"> 2379</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l02380" name="l02380"></a><span class="lineno"> 2380</span>   } <a class="code hl_define" href="producer__plugin_8cpp.html#a01d09f9c9fe1cbc1b70a0c41f0682e07">LOG_AND_DROP</a>();</div>
<div class="line"><a id="l02381" name="l02381"></a><span class="lineno"> 2381</span> </div>
<div class="line"><a id="l02382" name="l02382"></a><span class="lineno"> 2382</span>   <a class="code hl_define" href="logger_8hpp.html#af5adfcda7e0a01306256754a6511915d">fc_dlog</a>(<a class="code hl_variable" href="producer__plugin_8cpp.html#adff615e9fbe43b3e6443687be568cffd">_log</a>, <span class="stringliteral">&quot;Aborting block due to produce_block error&quot;</span>);</div>
<div class="line"><a id="l02383" name="l02383"></a><span class="lineno"> 2383</span>   <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#ac33726be93d621d708c02acfe7fcfd56">abort_block</a>();</div>
<div class="line"><a id="l02384" name="l02384"></a><span class="lineno"> 2384</span>   <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l02385" name="l02385"></a><span class="lineno"> 2385</span>}</div>
</div>
<div class="line"><a id="l02386" name="l02386"></a><span class="lineno"> 2386</span> </div>
<div class="line"><a id="l02387" name="l02387"></a><span class="lineno"> 2387</span><span class="keyword">static</span> <span class="keyword">auto</span> make_debug_time_logger() {</div>
<div class="line"><a id="l02388" name="l02388"></a><span class="lineno"> 2388</span>   <span class="keyword">auto</span> start = <a class="code hl_function" href="classfc_1_1time__point.html#aa164ff1268a16d4b32afcff181f6100e">fc::time_point::now</a>();</div>
<div class="line"><a id="l02389" name="l02389"></a><span class="lineno"> 2389</span>   <span class="keywordflow">return</span> <a class="code hl_function" href="namespacefc.html#a23d89b54a8ffd84f7e7efeb21747d846">fc::make_scoped_exit</a>([=](){</div>
<div class="line"><a id="l02390" name="l02390"></a><span class="lineno"> 2390</span>      <a class="code hl_define" href="logger_8hpp.html#af5adfcda7e0a01306256754a6511915d">fc_dlog</a>(<a class="code hl_variable" href="producer__plugin_8cpp.html#adff615e9fbe43b3e6443687be568cffd">_log</a>, <span class="stringliteral">&quot;Signing took ${ms}us&quot;</span>, (<span class="stringliteral">&quot;ms&quot;</span>, <a class="code hl_function" href="classfc_1_1time__point.html#aa164ff1268a16d4b32afcff181f6100e">fc::time_point::now</a>() - start) );</div>
<div class="line"><a id="l02391" name="l02391"></a><span class="lineno"> 2391</span>   });</div>
<div class="line"><a id="l02392" name="l02392"></a><span class="lineno"> 2392</span>}</div>
<div class="line"><a id="l02393" name="l02393"></a><span class="lineno"> 2393</span> </div>
<div class="line"><a id="l02394" name="l02394"></a><span class="lineno"> 2394</span><span class="keyword">static</span> <span class="keyword">auto</span> maybe_make_debug_time_logger() -&gt; std::optional&lt;<span class="keyword">decltype</span>(make_debug_time_logger())&gt; {</div>
<div class="line"><a id="l02395" name="l02395"></a><span class="lineno"> 2395</span>   <span class="keywordflow">if</span> (<a class="code hl_variable" href="producer__plugin_8cpp.html#adff615e9fbe43b3e6443687be568cffd">_log</a>.<a class="code hl_function" href="classfc_1_1logger.html#afbae9b6cd7f4f604f654a4c1914677ac">is_enabled</a>( <a class="code hl_enumvalue" href="classfc_1_1log__level.html#a5a5e31c4c1f38d9115ecbe44927fb2e4a30d2de77e71beb8d09d530cac04efa25">fc::log_level::debug</a> ) ){</div>
<div class="line"><a id="l02396" name="l02396"></a><span class="lineno"> 2396</span>      <span class="keywordflow">return</span> make_debug_time_logger();</div>
<div class="line"><a id="l02397" name="l02397"></a><span class="lineno"> 2397</span>   } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l02398" name="l02398"></a><span class="lineno"> 2398</span>      <span class="keywordflow">return</span> {};</div>
<div class="line"><a id="l02399" name="l02399"></a><span class="lineno"> 2399</span>   }</div>
<div class="line"><a id="l02400" name="l02400"></a><span class="lineno"> 2400</span>}</div>
<div class="line"><a id="l02401" name="l02401"></a><span class="lineno"> 2401</span> </div>
<div class="foldopen" id="foldopen02402" data-start="{" data-end="}">
<div class="line"><a id="l02402" name="l02402"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin__impl.html#a336a35581aedb4308f8fc7f4eb44f152"> 2402</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1producer__plugin__impl.html#a336a35581aedb4308f8fc7f4eb44f152">producer_plugin_impl::produce_block</a>() {</div>
<div class="line"><a id="l02403" name="l02403"></a><span class="lineno"> 2403</span>   <span class="comment">//ilog(&quot;produce_block ${t}&quot;, (&quot;t&quot;, fc::time_point::now())); // for testing _produce_time_offset_us</span></div>
<div class="line"><a id="l02404" name="l02404"></a><span class="lineno"> 2404</span>   <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>(<a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ae9554f576751ba3ac762b0f0c85fa5f2">_pending_block_mode</a> == <a class="code hl_enumvalue" href="namespacesysio.html#acd1c637e1a22040dbf666b0301cbc475afd75fc8d5de6f56947b1afc9e44ddb5f">pending_block_mode::producing</a>, producer_exception, <span class="stringliteral">&quot;called produce_block while not actually producing&quot;</span>);</div>
<div class="line"><a id="l02405" name="l02405"></a><span class="lineno"> 2405</span>   <a class="code hl_class" href="classsysio_1_1chain_1_1controller.html">chain::controller</a>&amp; chain = <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ad6dd1910645f0e41a009f59fdfc09cb4">chain_plug</a>-&gt;<a class="code hl_function" href="classsysio_1_1chain__plugin.html#a14a5e77b31ecf267c8062267d03440ae">chain</a>();</div>
<div class="line"><a id="l02406" name="l02406"></a><span class="lineno"> 2406</span>   <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>(chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a286751cd6498b500b70a0d3678672263">is_building_block</a>(), missing_pending_block_state, <span class="stringliteral">&quot;pending_block_state does not exist but it should, another plugin may have corrupted it&quot;</span>);</div>
<div class="line"><a id="l02407" name="l02407"></a><span class="lineno"> 2407</span> </div>
<div class="line"><a id="l02408" name="l02408"></a><span class="lineno"> 2408</span>   <span class="keyword">const</span> <span class="keyword">auto</span>&amp; auth = chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a7ac238f10e3a4ccf5c746a4e6a43b184">pending_block_signing_authority</a>();</div>
<div class="line"><a id="l02409" name="l02409"></a><span class="lineno"> 2409</span>   std::vector&lt;std::reference_wrapper&lt;const signature_provider_type&gt;&gt; relevant_providers;</div>
<div class="line"><a id="l02410" name="l02410"></a><span class="lineno"> 2410</span> </div>
<div class="line"><a id="l02411" name="l02411"></a><span class="lineno"> 2411</span>   relevant_providers.reserve(<a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ad9173229bf0922a5bd51150e1a95c58f">_signature_providers</a>.size());</div>
<div class="line"><a id="l02412" name="l02412"></a><span class="lineno"> 2412</span> </div>
<div class="line"><a id="l02413" name="l02413"></a><span class="lineno"> 2413</span>   <a class="code hl_function" href="structsysio_1_1chain_1_1producer__authority.html#ae72370fc6180ebd6b5a04d61cd436f6a">producer_authority::for_each_key</a>(auth, [&amp;](<span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1crypto_1_1public__key.html">public_key_type</a>&amp; key){</div>
<div class="line"><a id="l02414" name="l02414"></a><span class="lineno"> 2414</span>      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; iter = <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ad9173229bf0922a5bd51150e1a95c58f">_signature_providers</a>.find(key);</div>
<div class="line"><a id="l02415" name="l02415"></a><span class="lineno"> 2415</span>      <span class="keywordflow">if</span> (iter != <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ad9173229bf0922a5bd51150e1a95c58f">_signature_providers</a>.end()) {</div>
<div class="line"><a id="l02416" name="l02416"></a><span class="lineno"> 2416</span>         relevant_providers.emplace_back(iter-&gt;second);</div>
<div class="line"><a id="l02417" name="l02417"></a><span class="lineno"> 2417</span>      }</div>
<div class="line"><a id="l02418" name="l02418"></a><span class="lineno"> 2418</span>   });</div>
<div class="line"><a id="l02419" name="l02419"></a><span class="lineno"> 2419</span> </div>
<div class="line"><a id="l02420" name="l02420"></a><span class="lineno"> 2420</span>   <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>(relevant_providers.size() &gt; 0, producer_priv_key_not_found, <span class="stringliteral">&quot;Attempting to produce a block for which we don&#39;t have any relevant private keys&quot;</span>);</div>
<div class="line"><a id="l02421" name="l02421"></a><span class="lineno"> 2421</span> </div>
<div class="line"><a id="l02422" name="l02422"></a><span class="lineno"> 2422</span>   <span class="keywordflow">if</span> (<a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#a369d1c5202c442237cb333c850f1634e">_protocol_features_signaled</a>) {</div>
<div class="line"><a id="l02423" name="l02423"></a><span class="lineno"> 2423</span>      <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#ab8c4a74665eea98fed5866ee31b25d5a">_protocol_features_to_activate</a>.clear(); <span class="comment">// clear _protocol_features_to_activate as it is already set in pending_block</span></div>
<div class="line"><a id="l02424" name="l02424"></a><span class="lineno"> 2424</span>      <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#a369d1c5202c442237cb333c850f1634e">_protocol_features_signaled</a> = <span class="keyword">false</span>;</div>
<div class="line"><a id="l02425" name="l02425"></a><span class="lineno"> 2425</span>   }</div>
<div class="line"><a id="l02426" name="l02426"></a><span class="lineno"> 2426</span> </div>
<div class="line"><a id="l02430" name="l02430"></a><span class="lineno"> 2430</span>   <span class="keyword">auto</span>&amp; sub_chain_plug = <a class="code hl_function" href="namespaceappbase.html#a99374dc23934f008a09f2f79be9eae40">app</a>().<a class="code hl_function" href="classappbase_1_1application.html#a3c4b68a0667942b58f1369f454ce0ce3">get_plugin</a>&lt;<a class="code hl_class" href="classsysio_1_1sub__chain__plugin.html">sub_chain_plugin</a>&gt;();</div>
<div class="line"><a id="l02431" name="l02431"></a><span class="lineno"> 2431</span>   <span class="comment">// TODO: verify sub chain is enabled, otherwise skip? or require?</span></div>
<div class="line"><a id="l02432" name="l02432"></a><span class="lineno"> 2432</span>   <span class="comment">// Step 1: Scans transactions to find relevant transactions by comparing to a list of known contracts.</span></div>
<div class="line"><a id="l02433" name="l02433"></a><span class="lineno"> 2433</span>   <span class="keyword">auto</span> relevant_s_transactions = sub_chain_plug.<a class="code hl_function" href="classsysio_1_1sub__chain__plugin.html#aaac3c80301ede51c90d925992bc14c7c">find_relevant_transactions</a>(chain);</div>
<div class="line"><a id="l02434" name="l02434"></a><span class="lineno"> 2434</span>   <span class="comment">// Only calculate if there are relevant s-transactions   </span></div>
<div class="line"><a id="l02435" name="l02435"></a><span class="lineno"> 2435</span>   <span class="keywordflow">if</span> (!relevant_s_transactions.empty()) {</div>
<div class="line"><a id="l02436" name="l02436"></a><span class="lineno"> 2436</span>      <a class="code hl_define" href="logger_8hpp.html#a831cf08dc63704c11fd154132c6e8bdb">ilog</a>(<span class="stringliteral">&quot;Relevant S-Transactions found: ${count}&quot;</span>, (<span class="stringliteral">&quot;count&quot;</span>, relevant_s_transactions.size()));</div>
<div class="line"><a id="l02437" name="l02437"></a><span class="lineno"> 2437</span>      <span class="comment">// Step 2: Builds array of leaves in the same order as they appear in the transaction list.</span></div>
<div class="line"><a id="l02438" name="l02438"></a><span class="lineno"> 2438</span>      <span class="comment">// Step 3: Computes a Merkle root hash: the S-Root.</span></div>
<div class="line"><a id="l02439" name="l02439"></a><span class="lineno"> 2439</span>      <a class="code hl_class" href="classfc_1_1sha256.html">checksum256_type</a> s_root = sub_chain_plug.calculate_s_root(relevant_s_transactions);</div>
<div class="line"><a id="l02440" name="l02440"></a><span class="lineno"> 2440</span>      <a class="code hl_define" href="logger_8hpp.html#a831cf08dc63704c11fd154132c6e8bdb">ilog</a>(<span class="stringliteral">&quot;s_root calculated: ${root}&quot;</span>, (<span class="stringliteral">&quot;root&quot;</span>, s_root.<a class="code hl_function" href="classfc_1_1sha256.html#a71ac4efc1d964d24fdf00aeffcf0a9c9">str</a>()));</div>
<div class="line"><a id="l02441" name="l02441"></a><span class="lineno"> 2441</span>      <span class="comment">// Step 4: S-Root is hashed with the previous S-ID using SHA-256</span></div>
<div class="line"><a id="l02442" name="l02442"></a><span class="lineno"> 2442</span>      <span class="comment">// Step 5: Takes the 32 least-significant bits from the previous S-ID to get the previous S-Block number, and increment to get the new S-Block number</span></div>
<div class="line"><a id="l02443" name="l02443"></a><span class="lineno"> 2443</span>      <span class="comment">// Step 6: Hashes the S-Root with the previous S-ID with SHA-256, then replace the 32 least significant bits with the new S-Block number to produce the new S-ID</span></div>
<div class="line"><a id="l02444" name="l02444"></a><span class="lineno"> 2444</span>      <a class="code hl_class" href="classfc_1_1sha256.html">checksum256_type</a> curr_s_id = sub_chain_plug.compute_curr_s_id(s_root);</div>
<div class="line"><a id="l02445" name="l02445"></a><span class="lineno"> 2445</span>      <a class="code hl_define" href="logger_8hpp.html#a831cf08dc63704c11fd154132c6e8bdb">ilog</a>(<span class="stringliteral">&quot;curr_s_id calculated: ${curr_s_id}&quot;</span>, (<span class="stringliteral">&quot;curr_s_id&quot;</span>, curr_s_id.<a class="code hl_function" href="classfc_1_1sha256.html#a71ac4efc1d964d24fdf00aeffcf0a9c9">str</a>()));</div>
<div class="line"><a id="l02446" name="l02446"></a><span class="lineno"> 2446</span>      <span class="comment">// Prepare the s_header for the current block to be added to the header extension</span></div>
<div class="line"><a id="l02447" name="l02447"></a><span class="lineno"> 2447</span>      <a class="code hl_struct" href="structsysio_1_1chain_1_1s__header.html">s_header</a> <a class="code hl_struct" href="structsysio_1_1chain_1_1s__header.html">s_header</a> {</div>
<div class="line"><a id="l02448" name="l02448"></a><span class="lineno"> 2448</span>         sub_chain_plug.get_contract_name(),</div>
<div class="line"><a id="l02449" name="l02449"></a><span class="lineno"> 2449</span>         sub_chain_plug.get_prev_s_id(),</div>
<div class="line"><a id="l02450" name="l02450"></a><span class="lineno"> 2450</span>         curr_s_id,</div>
<div class="line"><a id="l02451" name="l02451"></a><span class="lineno"> 2451</span>         s_root</div>
<div class="line"><a id="l02452" name="l02452"></a><span class="lineno"> 2452</span>      };</div>
<div class="line"><a id="l02453" name="l02453"></a><span class="lineno"> 2453</span>      <a class="code hl_define" href="logger_8hpp.html#a831cf08dc63704c11fd154132c6e8bdb">ilog</a>(<span class="stringliteral">&quot;S-Header prepared: ${s_header}&quot;</span>, (<span class="stringliteral">&quot;s_header&quot;</span>, <a class="code hl_struct" href="structsysio_1_1chain_1_1s__header.html">s_header</a>.<a class="code hl_function" href="structsysio_1_1chain_1_1s__header.html#a2075610dd92e3718f545b14adcd3ebf7">to_string</a>()));</div>
<div class="line"><a id="l02454" name="l02454"></a><span class="lineno"> 2454</span> </div>
<div class="line"><a id="l02455" name="l02455"></a><span class="lineno"> 2455</span>      <span class="comment">// Set the s_root in the chain controller for the building block state</span></div>
<div class="line"><a id="l02456" name="l02456"></a><span class="lineno"> 2456</span>      <span class="comment">// to be referenced and passed to make_block_header on finalize_block below</span></div>
<div class="line"><a id="l02457" name="l02457"></a><span class="lineno"> 2457</span>      chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a59e341a41ba27734555c54c37bacf358">set_s_header</a>( <a class="code hl_struct" href="structsysio_1_1chain_1_1s__header.html">s_header</a> );</div>
<div class="line"><a id="l02458" name="l02458"></a><span class="lineno"> 2458</span> </div>
<div class="line"><a id="l02459" name="l02459"></a><span class="lineno"> 2459</span>      <span class="comment">// Update the plugin&#39;s stored prev_s_id with the newly calculated S-ID</span></div>
<div class="line"><a id="l02460" name="l02460"></a><span class="lineno"> 2460</span>      sub_chain_plug.update_prev_s_id(curr_s_id);</div>
<div class="line"><a id="l02461" name="l02461"></a><span class="lineno"> 2461</span>   }</div>
<div class="line"><a id="l02462" name="l02462"></a><span class="lineno"> 2462</span> </div>
<div class="line"><a id="l02463" name="l02463"></a><span class="lineno"> 2463</span>   <span class="comment">//idump( (fc::time_point::now() - chain.pending_block_time()) );</span></div>
<div class="line"><a id="l02464" name="l02464"></a><span class="lineno"> 2464</span>   chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a90ac1d5081d727041b7bef384771fda9">finalize_block</a>( [&amp;]( <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1sha256.html">digest_type</a>&amp; <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a107648633008a7f2d872b4b3d98c2f96">d</a> ) {</div>
<div class="line"><a id="l02465" name="l02465"></a><span class="lineno"> 2465</span>      <span class="keyword">auto</span> debug_logger = maybe_make_debug_time_logger();</div>
<div class="line"><a id="l02466" name="l02466"></a><span class="lineno"> 2466</span>      <a class="code hl_class" href="classfc_1_1vector.html">vector&lt;signature_type&gt;</a> sigs;</div>
<div class="line"><a id="l02467" name="l02467"></a><span class="lineno"> 2467</span>      sigs.reserve(relevant_providers.size());</div>
<div class="line"><a id="l02468" name="l02468"></a><span class="lineno"> 2468</span> </div>
<div class="line"><a id="l02469" name="l02469"></a><span class="lineno"> 2469</span>      <span class="comment">// sign with all relevant public keys</span></div>
<div class="line"><a id="l02470" name="l02470"></a><span class="lineno"> 2470</span>      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code hl_variable" href="bn_8cpp.html#a8b0eadcc506862e9d751ab45185053aa">p</a> : relevant_providers) {</div>
<div class="line"><a id="l02471" name="l02471"></a><span class="lineno"> 2471</span>         sigs.emplace_back(<a class="code hl_variable" href="bn_8cpp.html#a8b0eadcc506862e9d751ab45185053aa">p</a>.get()(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a107648633008a7f2d872b4b3d98c2f96">d</a>));</div>
<div class="line"><a id="l02472" name="l02472"></a><span class="lineno"> 2472</span>      }</div>
<div class="line"><a id="l02473" name="l02473"></a><span class="lineno"> 2473</span>      <span class="keywordflow">return</span> sigs;</div>
<div class="line"><a id="l02474" name="l02474"></a><span class="lineno"> 2474</span>   } );</div>
<div class="line"><a id="l02475" name="l02475"></a><span class="lineno"> 2475</span> </div>
<div class="line"><a id="l02476" name="l02476"></a><span class="lineno"> 2476</span>   chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a16975bb6b23c3e9ffaf7590006e81439">commit_block</a>();</div>
<div class="line"><a id="l02477" name="l02477"></a><span class="lineno"> 2477</span> </div>
<div class="line"><a id="l02478" name="l02478"></a><span class="lineno"> 2478</span>   <a class="code hl_typedef" href="namespacesysio_1_1chain.html#ab9b14f4554cc4a0da2c361e9757b1662">block_state_ptr</a> new_bs = chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a3e445e8e2da032a322a1348091a1a702">head_block_state</a>();</div>
<div class="line"><a id="l02479" name="l02479"></a><span class="lineno"> 2479</span> </div>
<div class="line"><a id="l02480" name="l02480"></a><span class="lineno"> 2480</span>   <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#afc937f75228984d541545dc4b59613a5">_account_fails</a>.report();</div>
<div class="line"><a id="l02481" name="l02481"></a><span class="lineno"> 2481</span>   <a class="code hl_variable" href="classsysio_1_1producer__plugin__impl.html#afc937f75228984d541545dc4b59613a5">_account_fails</a>.clear();</div>
<div class="line"><a id="l02482" name="l02482"></a><span class="lineno"> 2482</span> </div>
<div class="line"><a id="l02483" name="l02483"></a><span class="lineno"> 2483</span>   <a class="code hl_define" href="logger_8hpp.html#a831cf08dc63704c11fd154132c6e8bdb">ilog</a>(<span class="stringliteral">&quot;Produced block ${id}... #${n} @ ${t} signed by ${p} [trxs: ${count}, lib: ${lib}, confirmed: ${confs}]&quot;</span>,</div>
<div class="line"><a id="l02484" name="l02484"></a><span class="lineno"> 2484</span>        (<span class="stringliteral">&quot;p&quot;</span>,new_bs-&gt;header.producer)(<span class="stringliteral">&quot;id&quot;</span>,new_bs-&gt;id.str().substr(8,16))</div>
<div class="line"><a id="l02485" name="l02485"></a><span class="lineno"> 2485</span>        (<span class="stringliteral">&quot;n&quot;</span>,new_bs-&gt;block_num)(<span class="stringliteral">&quot;t&quot;</span>,new_bs-&gt;header.timestamp)</div>
<div class="line"><a id="l02486" name="l02486"></a><span class="lineno"> 2486</span>        (<span class="stringliteral">&quot;count&quot;</span>,new_bs-&gt;block-&gt;transactions.size())(<span class="stringliteral">&quot;lib&quot;</span>,chain.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a53495de416021a4e56e889e771b25a52">last_irreversible_block_num</a>())(<span class="stringliteral">&quot;confs&quot;</span>, new_bs-&gt;header.confirmed));</div>
<div class="line"><a id="l02487" name="l02487"></a><span class="lineno"> 2487</span> </div>
<div class="line"><a id="l02488" name="l02488"></a><span class="lineno"> 2488</span>}</div>
</div>
<div class="line"><a id="l02489" name="l02489"></a><span class="lineno"> 2489</span> </div>
<div class="foldopen" id="foldopen02490" data-start="{" data-end="}">
<div class="line"><a id="l02490" name="l02490"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin.html#ae697c5d94a3c6d02dab4a159ec9a30cb"> 2490</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1producer__plugin.html#ae697c5d94a3c6d02dab4a159ec9a30cb">producer_plugin::received_block</a>() {</div>
<div class="line"><a id="l02491" name="l02491"></a><span class="lineno"> 2491</span>   my-&gt;_received_block = <span class="keyword">true</span>;</div>
<div class="line"><a id="l02492" name="l02492"></a><span class="lineno"> 2492</span>}</div>
</div>
<div class="line"><a id="l02493" name="l02493"></a><span class="lineno"> 2493</span> </div>
<div class="foldopen" id="foldopen02494" data-start="{" data-end="}">
<div class="line"><a id="l02494" name="l02494"></a><span class="lineno"><a class="line" href="classsysio_1_1producer__plugin.html#abd977a7c1a617285862313c25716569e"> 2494</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1producer__plugin.html#abd977a7c1a617285862313c25716569e">producer_plugin::log_failed_transaction</a>(<span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1sha256.html">transaction_id_type</a>&amp; trx_id, <span class="keyword">const</span> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#a7041c0316bd294d0866609ab3e0cc7a7">packed_transaction_ptr</a>&amp; packed_trx_ptr, <span class="keyword">const</span> <span class="keywordtype">char</span>* reason)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l02495" name="l02495"></a><span class="lineno"> 2495</span>   <a class="code hl_define" href="logger_8hpp.html#af5adfcda7e0a01306256754a6511915d">fc_dlog</a>(<a class="code hl_variable" href="producer__plugin_8cpp.html#ae93a86d470c7e16b50ab7102170c5d4e">_trx_failed_trace_log</a>, <span class="stringliteral">&quot;[TRX_TRACE] Speculative execution is REJECTING tx: ${txid} : ${why}&quot;</span>,</div>
<div class="line"><a id="l02496" name="l02496"></a><span class="lineno"> 2496</span>            (<span class="stringliteral">&quot;txid&quot;</span>, trx_id)(<span class="stringliteral">&quot;why&quot;</span>, reason));</div>
<div class="line"><a id="l02497" name="l02497"></a><span class="lineno"> 2497</span>   <a class="code hl_define" href="logger_8hpp.html#af5adfcda7e0a01306256754a6511915d">fc_dlog</a>(<a class="code hl_variable" href="producer__plugin_8cpp.html#a78396757cc70405744561b647c892edf">_trx_log</a>, <span class="stringliteral">&quot;[TRX_TRACE] Speculative execution is REJECTING tx: ${trx}&quot;</span>,</div>
<div class="line"><a id="l02498" name="l02498"></a><span class="lineno"> 2498</span>            (<span class="stringliteral">&quot;entire_trx&quot;</span>, packed_trx_ptr ? my-&gt;chain_plug-&gt;get_log_trx(packed_trx_ptr-&gt;get_transaction()) : <a class="code hl_class" href="classfc_1_1variant.html">fc::variant</a>{trx_id}));</div>
<div class="line"><a id="l02499" name="l02499"></a><span class="lineno"> 2499</span>   <a class="code hl_define" href="logger_8hpp.html#af5adfcda7e0a01306256754a6511915d">fc_dlog</a>(<a class="code hl_variable" href="producer__plugin_8cpp.html#a979f47bc56a17944271d72bccb834c33">_trx_trace_failure_log</a>, <span class="stringliteral">&quot;[TRX_TRACE] Speculative execution is REJECTING tx: ${entire_trx}&quot;</span>,</div>
<div class="line"><a id="l02500" name="l02500"></a><span class="lineno"> 2500</span>            (<span class="stringliteral">&quot;entire_trx&quot;</span>, packed_trx_ptr ? my-&gt;chain_plug-&gt;get_log_trx(packed_trx_ptr-&gt;get_transaction()) : <a class="code hl_class" href="classfc_1_1variant.html">fc::variant</a>{trx_id}));</div>
<div class="line"><a id="l02501" name="l02501"></a><span class="lineno"> 2501</span>}</div>
</div>
<div class="line"><a id="l02502" name="l02502"></a><span class="lineno"> 2502</span> </div>
<div class="line"><a id="l02503" name="l02503"></a><span class="lineno"> 2503</span>} <span class="comment">// namespace sysio</span></div>
<div class="ttc" id="a_x02-_disabled_macros_8cpp_html_ae28240b98d91d6eb7da702b770490f39"><div class="ttname"><a href="_x02-_disabled_macros_8cpp.html#ae28240b98d91d6eb7da702b770490f39">f</a></div><div class="ttdeci">foo f</div><div class="ttdef"><b>Definition</b> <a href="_x02-_disabled_macros_8cpp_source.html#l00025">X02-DisabledMacros.cpp:25</a></div></div>
<div class="ttc" id="abn_8cpp_html_a8b0eadcc506862e9d751ab45185053aa"><div class="ttname"><a href="bn_8cpp.html#a8b0eadcc506862e9d751ab45185053aa">p</a></div><div class="ttdeci">const mie::Vuint &amp; p</div><div class="ttdef"><b>Definition</b> <a href="bn_8cpp_source.html#l00027">bn.cpp:27</a></div></div>
<div class="ttc" id="achain_2include_2sysio_2chain_2config_8hpp_html_a0b4bacb63f31764f50a185f320551fbc"><div class="ttname"><a href="chain_2include_2sysio_2chain_2config_8hpp.html#a0b4bacb63f31764f50a185f320551fbc">SYS_PERCENT</a></div><div class="ttdeci">constexpr uint64_t SYS_PERCENT(uint64_t value, uint32_t percentage)</div><div class="ttdef"><b>Definition</b> <a href="chain_2include_2sysio_2chain_2config_8hpp_source.html#l00152">config.hpp:152</a></div></div>
<div class="ttc" id="achain_2include_2sysio_2chain_2exceptions_8hpp_html_a1bfa656552ea0534b2c91ee0fe33f850"><div class="ttname"><a href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a1bfa656552ea0534b2c91ee0fe33f850">SYS_THROW</a></div><div class="ttdeci">#define SYS_THROW(exc_type, FORMAT,...)</div><div class="ttdef"><b>Definition</b> <a href="chain_2include_2sysio_2chain_2exceptions_8hpp_source.html#l00013">exceptions.hpp:13</a></div></div>
<div class="ttc" id="achain_2include_2sysio_2chain_2exceptions_8hpp_html_a40c2826a6fba35c1ffbf912bdf559792"><div class="ttname"><a href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a></div><div class="ttdeci">#define SYS_ASSERT(expr, exc_type, FORMAT,...)</div><div class="ttdef"><b>Definition</b> <a href="chain_2include_2sysio_2chain_2exceptions_8hpp_source.html#l00007">exceptions.hpp:7</a></div></div>
<div class="ttc" id="achain_2include_2sysio_2chain_2exceptions_8hpp_html_ab200d016fe1306acaed181b722a3cac6"><div class="ttname"><a href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#ab200d016fe1306acaed181b722a3cac6">CATCH_AND_CALL</a></div><div class="ttdeci">#define CATCH_AND_CALL(NEXT)</div><div class="ttdef"><b>Definition</b> <a href="chain_2include_2sysio_2chain_2exceptions_8hpp_source.html#l00073">exceptions.hpp:73</a></div></div>
<div class="ttc" id="achain__plugin_8cpp_html_ac96900c0c3efb424647faf59995487d6"><div class="ttname"><a href="chain__plugin_8cpp.html#ac96900c0c3efb424647faf59995487d6">LOAD_VALUE_SET</a></div><div class="ttdeci">#define LOAD_VALUE_SET(options, op_name, container)</div><div class="ttdef"><b>Definition</b> <a href="chain__plugin_8cpp_source.html#l00378">chain_plugin.cpp:378</a></div></div>
<div class="ttc" id="aclassappbase_1_1abstract__plugin_html"><div class="ttname"><a href="classappbase_1_1abstract__plugin.html">appbase::abstract_plugin</a></div><div class="ttdef"><b>Definition</b> <a href="plugin_8hpp_source.html#l00028">plugin.hpp:28</a></div></div>
<div class="ttc" id="aclassappbase_1_1application_html_a1d2c585f90007be342c9c64ee9cc0f7c"><div class="ttname"><a href="classappbase_1_1application.html#a1d2c585f90007be342c9c64ee9cc0f7c">appbase::application::find_plugin</a></div><div class="ttdeci">abstract_plugin * find_plugin(const string &amp;name) const</div><div class="ttdef"><b>Definition</b> <a href="application_8cpp_source.html#l00511">application.cpp:511</a></div></div>
<div class="ttc" id="aclassappbase_1_1application_html_a3c4b68a0667942b58f1369f454ce0ce3"><div class="ttname"><a href="classappbase_1_1application.html#a3c4b68a0667942b58f1369f454ce0ce3">appbase::application::get_plugin</a></div><div class="ttdeci">abstract_plugin &amp; get_plugin(const string &amp;name) const</div><div class="ttdef"><b>Definition</b> <a href="application_8cpp_source.html#l00520">application.cpp:520</a></div></div>
<div class="ttc" id="aclassappbase_1_1application_html_a5dfd3cfb1124c57963fa17b3f4aabbe1"><div class="ttname"><a href="classappbase_1_1application.html#a5dfd3cfb1124c57963fa17b3f4aabbe1">appbase::application::data_dir</a></div><div class="ttdeci">bfs::path data_dir() const</div><div class="ttdoc">Get data directory.</div><div class="ttdef"><b>Definition</b> <a href="application_8cpp_source.html#l00527">application.cpp:527</a></div></div>
<div class="ttc" id="aclassappbase_1_1application_html_a77aff91b861010fd61a616c59b310dcc"><div class="ttname"><a href="classappbase_1_1application.html#a77aff91b861010fd61a616c59b310dcc">appbase::application::post</a></div><div class="ttdeci">auto post(int priority, Func &amp;&amp;func)</div><div class="ttdef"><b>Definition</b> <a href="application_8hpp_source.html#l00215">application.hpp:215</a></div></div>
<div class="ttc" id="aclassappbase_1_1application_html_a81aa58d3f94570b7976145039155fc46"><div class="ttname"><a href="classappbase_1_1application.html#a81aa58d3f94570b7976145039155fc46">appbase::application::quit</a></div><div class="ttdeci">void quit()</div><div class="ttdef"><b>Definition</b> <a href="application_8cpp_source.html#l00415">application.cpp:415</a></div></div>
<div class="ttc" id="aclassappbase_1_1application_html_a87887b19b1f639ca551645813bb380de"><div class="ttname"><a href="classappbase_1_1application.html#a87887b19b1f639ca551645813bb380de">appbase::application::get_method</a></div><div class="ttdeci">auto get_method() -&gt; std::enable_if_t&lt; is_method_decl&lt; MethodDecl &gt;::value, typename MethodDecl::method_type &amp; &gt;</div><div class="ttdef"><b>Definition</b> <a href="application_8hpp_source.html#l00167">application.hpp:167</a></div></div>
<div class="ttc" id="aclassappbase_1_1application_html_a87e84549150056c56c0327cc4976cc2a"><div class="ttname"><a href="classappbase_1_1application.html#a87e84549150056c56c0327cc4976cc2a">appbase::application::register_plugin</a></div><div class="ttdeci">auto &amp; register_plugin()</div><div class="ttdef"><b>Definition</b> <a href="application_8hpp_source.html#l00136">application.hpp:136</a></div></div>
<div class="ttc" id="aclassappbase_1_1application_html_ac9e3f923a46466ea3ffbf4fea3187682"><div class="ttname"><a href="classappbase_1_1application.html#ac9e3f923a46466ea3ffbf4fea3187682">appbase::application::get_channel</a></div><div class="ttdeci">auto get_channel() -&gt; std::enable_if_t&lt; is_channel_decl&lt; ChannelDecl &gt;::value, typename ChannelDecl::channel_type &amp; &gt;</div><div class="ttdef"><b>Definition</b> <a href="application_8hpp_source.html#l00188">application.hpp:188</a></div></div>
<div class="ttc" id="aclassappbase_1_1channel_html"><div class="ttname"><a href="classappbase_1_1channel.html">appbase::channel</a></div><div class="ttdef"><b>Definition</b> <a href="channel_8hpp_source.html#l00047">channel.hpp:47</a></div></div>
<div class="ttc" id="aclassfc_1_1crypto_1_1private__key_html"><div class="ttname"><a href="classfc_1_1crypto_1_1private__key.html">fc::crypto::private_key</a></div><div class="ttdef"><b>Definition</b> <a href="private__key_8hpp_source.html#l00021">private_key.hpp:22</a></div></div>
<div class="ttc" id="aclassfc_1_1crypto_1_1private__key_html_a89f09f5b110de0d285808f12fa8d0af2"><div class="ttname"><a href="classfc_1_1crypto_1_1private__key.html#a89f09f5b110de0d285808f12fa8d0af2">fc::crypto::private_key::regenerate</a></div><div class="ttdeci">static private_key regenerate(const typename KeyType::data_type &amp;data)</div><div class="ttdef"><b>Definition</b> <a href="private__key_8hpp_source.html#l00046">private_key.hpp:46</a></div></div>
<div class="ttc" id="aclassfc_1_1crypto_1_1public__key_html"><div class="ttname"><a href="classfc_1_1crypto_1_1public__key.html">fc::crypto::public_key</a></div><div class="ttdef"><b>Definition</b> <a href="public__key_8hpp_source.html#l00023">public_key.hpp:24</a></div></div>
<div class="ttc" id="aclassfc_1_1crypto_1_1signature_html"><div class="ttname"><a href="classfc_1_1crypto_1_1signature.html">fc::crypto::signature</a></div><div class="ttdef"><b>Definition</b> <a href="signature_8hpp_source.html#l00021">signature.hpp:22</a></div></div>
<div class="ttc" id="aclassfc_1_1exception_html"><div class="ttname"><a href="classfc_1_1exception.html">fc::exception</a></div><div class="ttdoc">Used to generate a useful error report when an exception is thrown.</div><div class="ttdef"><b>Definition</b> <a href="exception_8hpp_source.html#l00057">exception.hpp:58</a></div></div>
<div class="ttc" id="aclassfc_1_1exception_html_a7611ea8fbe25dde56649b685c2298a37"><div class="ttname"><a href="classfc_1_1exception.html#a7611ea8fbe25dde56649b685c2298a37">fc::exception::to_detail_string</a></div><div class="ttdeci">std::string to_detail_string(log_level ll=log_level::all) const</div><div class="ttdef"><b>Definition</b> <a href="exception_8cpp_source.html#l00158">exception.cpp:158</a></div></div>
<div class="ttc" id="aclassfc_1_1exception_html_a79a36225cde10dcd23057bbe19d3390f"><div class="ttname"><a href="classfc_1_1exception.html#a79a36225cde10dcd23057bbe19d3390f">fc::exception::code</a></div><div class="ttdeci">int64_t code() const</div><div class="ttdef"><b>Definition</b> <a href="exception_8cpp_source.html#l00122">exception.cpp:122</a></div></div>
<div class="ttc" id="aclassfc_1_1json_html_afad69f9f9c2a9f0105aae99f532f90cb"><div class="ttname"><a href="classfc_1_1json.html#afad69f9f9c2a9f0105aae99f532f90cb">fc::json::from_string</a></div><div class="ttdeci">static variant from_string(const string &amp;utf8_str, const parse_type ptype=parse_type::legacy_parser, uint32_t max_depth=DEFAULT_MAX_RECURSION_DEPTH)</div><div class="ttdef"><b>Definition</b> <a href="json_8cpp_source.html#l00442">json.cpp:442</a></div></div>
<div class="ttc" id="aclassfc_1_1log__level_html_a5a5e31c4c1f38d9115ecbe44927fb2e4a30d2de77e71beb8d09d530cac04efa25"><div class="ttname"><a href="classfc_1_1log__level.html#a5a5e31c4c1f38d9115ecbe44927fb2e4a30d2de77e71beb8d09d530cac04efa25">fc::log_level::debug</a></div><div class="ttdeci">@ debug</div><div class="ttdef"><b>Definition</b> <a href="log__message_8hpp_source.html#l00033">log_message.hpp:33</a></div></div>
<div class="ttc" id="aclassfc_1_1logger_html"><div class="ttname"><a href="classfc_1_1logger.html">fc::logger</a></div><div class="ttdef"><b>Definition</b> <a href="logger_8hpp_source.html#l00025">logger.hpp:26</a></div></div>
<div class="ttc" id="aclassfc_1_1logger_html_a2214632598874a4e52a5500a6346515e"><div class="ttname"><a href="classfc_1_1logger.html#a2214632598874a4e52a5500a6346515e">fc::logger::update</a></div><div class="ttdeci">static void update(const fc::string &amp;name, logger &amp;log)</div><div class="ttdef"><b>Definition</b> <a href="logger_8cpp_source.html#l00092">logger.cpp:92</a></div></div>
<div class="ttc" id="aclassfc_1_1logger_html_afbae9b6cd7f4f604f654a4c1914677ac"><div class="ttname"><a href="classfc_1_1logger.html#afbae9b6cd7f4f604f654a4c1914677ac">fc::logger::is_enabled</a></div><div class="ttdeci">bool is_enabled(log_level e) const</div><div class="ttdef"><b>Definition</b> <a href="logger_8cpp_source.html#l00058">logger.cpp:58</a></div></div>
<div class="ttc" id="aclassfc_1_1microseconds_html"><div class="ttname"><a href="classfc_1_1microseconds.html">fc::microseconds</a></div><div class="ttdef"><b>Definition</b> <a href="include_2fc_2time_8hpp_source.html#l00011">time.hpp:11</a></div></div>
<div class="ttc" id="aclassfc_1_1microseconds_html_a12ee4fe7bac52aeb600d8ea39291e765"><div class="ttname"><a href="classfc_1_1microseconds.html#a12ee4fe7bac52aeb600d8ea39291e765">fc::microseconds::to_seconds</a></div><div class="ttdeci">constexpr int64_t to_seconds() const</div><div class="ttdef"><b>Definition</b> <a href="include_2fc_2time_8hpp_source.html#l00027">time.hpp:27</a></div></div>
<div class="ttc" id="aclassfc_1_1microseconds_html_a20fba59ec7e1f50c6b8f2c9443cc9b92"><div class="ttname"><a href="classfc_1_1microseconds.html#a20fba59ec7e1f50c6b8f2c9443cc9b92">fc::microseconds::count</a></div><div class="ttdeci">constexpr int64_t count() const</div><div class="ttdef"><b>Definition</b> <a href="include_2fc_2time_8hpp_source.html#l00026">time.hpp:26</a></div></div>
<div class="ttc" id="aclassfc_1_1microseconds_html_afc3eb0bfd792c7b1cda062e559e30c2e"><div class="ttname"><a href="classfc_1_1microseconds.html#afc3eb0bfd792c7b1cda062e559e30c2e">fc::microseconds::maximum</a></div><div class="ttdeci">static constexpr microseconds maximum()</div><div class="ttdef"><b>Definition</b> <a href="include_2fc_2time_8hpp_source.html#l00014">time.hpp:14</a></div></div>
<div class="ttc" id="aclassfc_1_1mutable__variant__object_html"><div class="ttname"><a href="classfc_1_1mutable__variant__object.html">fc::mutable_variant_object</a></div><div class="ttdoc">An order-preserving dictionary of variants.</div><div class="ttdef"><b>Definition</b> <a href="variant__object_8hpp_source.html#l00117">variant_object.hpp:118</a></div></div>
<div class="ttc" id="aclassfc_1_1sha256_html"><div class="ttname"><a href="classfc_1_1sha256.html">fc::sha256</a></div><div class="ttdef"><b>Definition</b> <a href="sha256_8hpp_source.html#l00011">sha256.hpp:12</a></div></div>
<div class="ttc" id="aclassfc_1_1sha256_html_a474784de7d6213b855abd7e952df5e36"><div class="ttname"><a href="classfc_1_1sha256.html#a474784de7d6213b855abd7e952df5e36">fc::sha256::hash</a></div><div class="ttdeci">static sha256 hash(const char *d, uint32_t dlen)</div><div class="ttdef"><b>Definition</b> <a href="sha256_8cpp_source.html#l00044">sha256.cpp:44</a></div></div>
<div class="ttc" id="aclassfc_1_1sha256_html_a71ac4efc1d964d24fdf00aeffcf0a9c9"><div class="ttname"><a href="classfc_1_1sha256.html#a71ac4efc1d964d24fdf00aeffcf0a9c9">fc::sha256::str</a></div><div class="ttdeci">string str() const</div><div class="ttdef"><b>Definition</b> <a href="sha256_8cpp_source.html#l00026">sha256.cpp:26</a></div></div>
<div class="ttc" id="aclassfc_1_1std__exception__wrapper_html_ae5ad64f84b1d373f5b92031566284c7c"><div class="ttname"><a href="classfc_1_1std__exception__wrapper.html#ae5ad64f84b1d373f5b92031566284c7c">fc::std_exception_wrapper::from_current_exception</a></div><div class="ttdeci">static std_exception_wrapper from_current_exception(const std::exception &amp;e)</div><div class="ttdef"><b>Definition</b> <a href="exception_8cpp_source.html#l00335">exception.cpp:335</a></div></div>
<div class="ttc" id="aclassfc_1_1time__point_html"><div class="ttname"><a href="classfc_1_1time__point.html">fc::time_point</a></div><div class="ttdef"><b>Definition</b> <a href="include_2fc_2time_8hpp_source.html#l00042">time.hpp:42</a></div></div>
<div class="ttc" id="aclassfc_1_1time__point_html_aa164ff1268a16d4b32afcff181f6100e"><div class="ttname"><a href="classfc_1_1time__point.html#aa164ff1268a16d4b32afcff181f6100e">fc::time_point::now</a></div><div class="ttdeci">static time_point now()</div><div class="ttdef"><b>Definition</b> <a href="time_8cpp_source.html#l00014">time.cpp:14</a></div></div>
<div class="ttc" id="aclassfc_1_1time__point_html_aeccf1b70aa34b132c5269313b8a50573"><div class="ttname"><a href="classfc_1_1time__point.html#aeccf1b70aa34b132c5269313b8a50573">fc::time_point::maximum</a></div><div class="ttdeci">static constexpr time_point maximum()</div><div class="ttdef"><b>Definition</b> <a href="include_2fc_2time_8hpp_source.html#l00046">time.hpp:46</a></div></div>
<div class="ttc" id="aclassfc_1_1url_html"><div class="ttname"><a href="classfc_1_1url.html">fc::url</a></div><div class="ttdef"><b>Definition</b> <a href="url_8hpp_source.html#l00022">url.hpp:23</a></div></div>
<div class="ttc" id="aclassfc_1_1variant_html"><div class="ttname"><a href="classfc_1_1variant.html">fc::variant</a></div><div class="ttdoc">stores null, int64, uint64, double, bool, string, std::vector&lt;variant&gt;, and variant_object's.</div><div class="ttdef"><b>Definition</b> <a href="fc_2include_2fc_2variant_8hpp_source.html#l00190">variant.hpp:191</a></div></div>
<div class="ttc" id="aclassfc_1_1variant_html_a82edd1f33199355d3a1f19bbb92909cc"><div class="ttname"><a href="classfc_1_1variant.html#a82edd1f33199355d3a1f19bbb92909cc">fc::variant::as</a></div><div class="ttdeci">T as() const</div><div class="ttdef"><b>Definition</b> <a href="fc_2include_2fc_2variant_8hpp_source.html#l00327">variant.hpp:327</a></div></div>
<div class="ttc" id="aclassfc_1_1vector_html"><div class="ttname"><a href="classfc_1_1vector.html">fc::vector</a></div><div class="ttdef"><b>Definition</b> <a href="vector__fwd_8hpp_source.html#l00007">vector_fwd.hpp:7</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1block__timestamp_html"><div class="ttname"><a href="classsysio_1_1chain_1_1block__timestamp.html">sysio::chain::block_timestamp&lt; config::block_interval_ms, config::block_timestamp_epoch &gt;</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1block__timestamp_html_a1bdb67323980085a2d4002d877b6c232"><div class="ttname"><a href="classsysio_1_1chain_1_1block__timestamp.html#a1bdb67323980085a2d4002d877b6c232">sysio::chain::block_timestamp::slot</a></div><div class="ttdeci">uint32_t slot</div><div class="ttdef"><b>Definition</b> <a href="block__timestamp_8hpp_source.html#l00060">block_timestamp.hpp:60</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1block__timestamp_html_aa1d88152d9cc082b5ad651c3aeadfb8f"><div class="ttname"><a href="classsysio_1_1chain_1_1block__timestamp.html#aa1d88152d9cc082b5ad651c3aeadfb8f">sysio::chain::block_timestamp::to_time_point</a></div><div class="ttdeci">fc::time_point to_time_point() const</div><div class="ttdef"><b>Definition</b> <a href="block__timestamp_8hpp_source.html#l00040">block_timestamp.hpp:40</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html">sysio::chain::controller</a></div><div class="ttdef"><b>Definition</b> <a href="controller_8hpp_source.html#l00063">controller.hpp:63</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a03d5ea18c641a8899af9bdbdf9da9f81"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a03d5ea18c641a8899af9bdbdf9da9f81">sysio::chain::controller::set_greylist_limit</a></div><div class="ttdeci">void set_greylist_limit(uint32_t limit)</div><div class="ttdef"><b>Definition</b> <a href="controller_8cpp_source.html#l03407">controller.cpp:3407</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a06ea0e9e805452cdd189f13df09916e8"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a06ea0e9e805452cdd189f13df09916e8">sysio::chain::controller::set_actor_whitelist</a></div><div class="ttdeci">void set_actor_whitelist(const flat_set&lt; account_name &gt; &amp;)</div><div class="ttdef"><b>Definition</b> <a href="controller_8cpp_source.html#l02909">controller.cpp:2909</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a087c940aa88be2ccc1fbb7dd1bc28da6"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a087c940aa88be2ccc1fbb7dd1bc28da6">sysio::chain::controller::get_actor_blacklist</a></div><div class="ttdeci">const flat_set&lt; account_name &gt; &amp; get_actor_blacklist() const</div><div class="ttdef"><b>Definition</b> <a href="controller_8cpp_source.html#l02893">controller.cpp:2893</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a0a0659166483870bf065f4d5e671484e"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a0a0659166483870bf065f4d5e671484e">sysio::chain::controller::accepted_block_header</a></div><div class="ttdeci">signal&lt; void(const block_state_ptr &amp;)&gt; accepted_block_header</div><div class="ttdef"><b>Definition</b> <a href="controller_8hpp_source.html#l00328">controller.hpp:328</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a125b3c8fdc58904ce8179b68d1ea4172"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a125b3c8fdc58904ce8179b68d1ea4172">sysio::chain::controller::get_validation_mode</a></div><div class="ttdeci">validation_mode get_validation_mode() const</div><div class="ttdef"><b>Definition</b> <a href="controller_8cpp_source.html#l03281">controller.cpp:3281</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a1379e43325b7e517a058bddce15571eb"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a1379e43325b7e517a058bddce15571eb">sysio::chain::controller::fetch_block_by_number</a></div><div class="ttdeci">signed_block_ptr fetch_block_by_number(uint32_t block_num) const</div><div class="ttdef"><b>Definition</b> <a href="controller_8cpp_source.html#l03074">controller.cpp:3074</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a16975bb6b23c3e9ffaf7590006e81439"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a16975bb6b23c3e9ffaf7590006e81439">sysio::chain::controller::commit_block</a></div><div class="ttdeci">void commit_block()</div><div class="ttdef"><b>Definition</b> <a href="controller_8cpp_source.html#l02842">controller.cpp:2842</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a1a695a1daba0cf887e71851a61911a37"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a1a695a1daba0cf887e71851a61911a37">sysio::chain::controller::set_actor_blacklist</a></div><div class="ttdeci">void set_actor_blacklist(const flat_set&lt; account_name &gt; &amp;)</div><div class="ttdef"><b>Definition</b> <a href="controller_8cpp_source.html#l02912">controller.cpp:2912</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a1ff3607461fff45552db45cec5aca012"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a1ff3607461fff45552db45cec5aca012">sysio::chain::controller::accepted_block</a></div><div class="ttdeci">signal&lt; void(const block_state_ptr &amp;)&gt; accepted_block</div><div class="ttdef"><b>Definition</b> <a href="controller_8hpp_source.html#l00329">controller.hpp:329</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a27266ebf16b6dd19a860635f7d1f9930"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a27266ebf16b6dd19a860635f7d1f9930">sysio::chain::controller::irreversible_block</a></div><div class="ttdeci">signal&lt; void(const block_state_ptr &amp;)&gt; irreversible_block</div><div class="ttdef"><b>Definition</b> <a href="controller_8hpp_source.html#l00330">controller.hpp:330</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a286751cd6498b500b70a0d3678672263"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a286751cd6498b500b70a0d3678672263">sysio::chain::controller::is_building_block</a></div><div class="ttdeci">bool is_building_block() const</div><div class="ttdef"><b>Definition</b> <a href="controller_8cpp_source.html#l03328">controller.cpp:3328</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a28d33629f3badcb8155c08be3e05b99e"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a28d33629f3badcb8155c08be3e05b99e">sysio::chain::controller::get_read_mode</a></div><div class="ttdeci">db_read_mode get_read_mode() const</div><div class="ttdef"><b>Definition</b> <a href="controller_8cpp_source.html#l03277">controller.cpp:3277</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a3079bf203cd6e26ed902a84ff3ec7856"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a3079bf203cd6e26ed902a84ff3ec7856">sysio::chain::controller::abort_block</a></div><div class="ttdeci">vector&lt; transaction_metadata_ptr &gt; abort_block()</div><div class="ttdef"><b>Definition</b> <a href="controller_8cpp_source.html#l02847">controller.cpp:2847</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a31c23187243554bdb6b54bb31bdb4bcd"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a31c23187243554bdb6b54bb31bdb4bcd">sysio::chain::controller::push_transaction</a></div><div class="ttdeci">transaction_trace_ptr push_transaction(const transaction_metadata_ptr &amp;trx, fc::time_point deadline, fc::microseconds max_transaction_time, uint32_t billed_cpu_time_us, bool explicit_billed_cpu_time, int64_t subjective_cpu_bill_us)</div><div class="ttdef"><b>Definition</b> <a href="controller_8cpp_source.html#l02871">controller.cpp:2871</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a33704b4936bb9bbd2ea6b0874ca521b4"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a33704b4936bb9bbd2ea6b0874ca521b4">sysio::chain::controller::head_block_num</a></div><div class="ttdeci">uint32_t head_block_num() const</div><div class="ttdef"><b>Definition</b> <a href="controller_8cpp_source.html#l02949">controller.cpp:2949</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a37d0a44faef74cf0f96127982c1ce124"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a37d0a44faef74cf0f96127982c1ce124">sysio::chain::controller::head_block_id</a></div><div class="ttdeci">block_id_type head_block_id() const</div><div class="ttdef"><b>Definition</b> <a href="controller_8cpp_source.html#l02955">controller.cpp:2955</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a3e445e8e2da032a322a1348091a1a702"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a3e445e8e2da032a322a1348091a1a702">sysio::chain::controller::head_block_state</a></div><div class="ttdeci">block_state_ptr head_block_state() const</div><div class="ttdef"><b>Definition</b> <a href="controller_8cpp_source.html#l02964">controller.cpp:2964</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a407d1c6dfd6e7b3e1d4e1567d15e344c"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a407d1c6dfd6e7b3e1d4e1567d15e344c">sysio::chain::controller::write_snapshot</a></div><div class="ttdeci">void write_snapshot(const snapshot_writer_ptr &amp;snapshot)</div><div class="ttdef"><b>Definition</b> <a href="controller_8cpp_source.html#l03123">controller.cpp:3123</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a53495de416021a4e56e889e771b25a52"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a53495de416021a4e56e889e771b25a52">sysio::chain::controller::last_irreversible_block_num</a></div><div class="ttdeci">uint32_t last_irreversible_block_num() const</div><div class="ttdef"><b>Definition</b> <a href="controller_8cpp_source.html#l03046">controller.cpp:3046</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a5711e4cc0cff77f67d04b64373252412"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a5711e4cc0cff77f67d04b64373252412">sysio::chain::controller::set_key_blacklist</a></div><div class="ttdeci">void set_key_blacklist(const flat_set&lt; public_key_type &gt; &amp;)</div><div class="ttdef"><b>Definition</b> <a href="controller_8cpp_source.html#l02928">controller.cpp:2928</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a59e341a41ba27734555c54c37bacf358"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a59e341a41ba27734555c54c37bacf358">sysio::chain::controller::set_s_header</a></div><div class="ttdeci">void set_s_header(const s_header &amp;)</div><div class="ttdef"><b>Definition</b> <a href="controller_8cpp_source.html#l02931">controller.cpp:2931</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a67876c4bcb4b26fa679d347472ff14ee"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a67876c4bcb4b26fa679d347472ff14ee">sysio::chain::controller::get_protocol_feature_manager</a></div><div class="ttdeci">const protocol_feature_manager &amp; get_protocol_feature_manager() const</div><div class="ttdef"><b>Definition</b> <a href="controller_8cpp_source.html#l02600">controller.cpp:2600</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a701a2bfcee8df0244e1a8ac8900bc657"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a701a2bfcee8df0244e1a8ac8900bc657">sysio::chain::controller::configured_subjective_signature_length_limit</a></div><div class="ttdeci">uint32_t configured_subjective_signature_length_limit() const</div><div class="ttdef"><b>Definition</b> <a href="controller_8cpp_source.html#l03342">controller.cpp:3342</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a7408289ee5f740f797b9b9d9b192704a"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a7408289ee5f740f797b9b9d9b192704a">sysio::chain::controller::get_contract_whitelist</a></div><div class="ttdeci">const flat_set&lt; account_name &gt; &amp; get_contract_whitelist() const</div><div class="ttdef"><b>Definition</b> <a href="controller_8cpp_source.html#l02896">controller.cpp:2896</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a7a7a09290738585cd0e05580eeba0a95"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a7a7a09290738585cd0e05580eeba0a95">sysio::chain::controller::pending_block_producer</a></div><div class="ttdeci">account_name pending_block_producer() const</div><div class="ttdef"><b>Definition</b> <a href="controller_8cpp_source.html#l03018">controller.cpp:3018</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a7ac238f10e3a4ccf5c746a4e6a43b184"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a7ac238f10e3a4ccf5c746a4e6a43b184">sysio::chain::controller::pending_block_signing_authority</a></div><div class="ttdeci">const block_signing_authority &amp; pending_block_signing_authority() const</div><div class="ttdef"><b>Definition</b> <a href="controller_8cpp_source.html#l03027">controller.cpp:3027</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a7d6e058e892e067510650db853794338"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a7d6e058e892e067510650db853794338">sysio::chain::controller::fetch_block_by_id</a></div><div class="ttdeci">signed_block_ptr fetch_block_by_id(block_id_type id) const</div><div class="ttdef"><b>Definition</b> <a href="controller_8cpp_source.html#l03066">controller.cpp:3066</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a878ff6368c473051417382a9d485030d"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a878ff6368c473051417382a9d485030d">sysio::chain::controller::last_irreversible_block_time</a></div><div class="ttdeci">time_point last_irreversible_block_time() const</div><div class="ttdef"><b>Definition</b> <a href="controller_8cpp_source.html#l03054">controller.cpp:3054</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a8a195d27a416c714bdc058b7f1919267"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a8a195d27a416c714bdc058b7f1919267">sysio::chain::controller::get_action_blacklist</a></div><div class="ttdeci">const flat_set&lt; pair&lt; account_name, action_name &gt; &gt; &amp; get_action_blacklist() const</div><div class="ttdef"><b>Definition</b> <a href="controller_8cpp_source.html#l02902">controller.cpp:2902</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a8b86f2ee0fa63f9d01ee437f83b0e1d1"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a8b86f2ee0fa63f9d01ee437f83b0e1d1">sysio::chain::controller::get_terminate_at_block</a></div><div class="ttdeci">uint32_t get_terminate_at_block() const</div><div class="ttdef"><b>Definition</b> <a href="controller_8cpp_source.html#l03285">controller.cpp:3285</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a904bf66cadfa73c918e9d835c819a524"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a904bf66cadfa73c918e9d835c819a524">sysio::chain::controller::set_contract_blacklist</a></div><div class="ttdeci">void set_contract_blacklist(const flat_set&lt; account_name &gt; &amp;)</div><div class="ttdef"><b>Definition</b> <a href="controller_8cpp_source.html#l02918">controller.cpp:2918</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a90ac1d5081d727041b7bef384771fda9"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a90ac1d5081d727041b7bef384771fda9">sysio::chain::controller::finalize_block</a></div><div class="ttdeci">block_state_ptr finalize_block(const signer_callback_type &amp;signer_callback)</div><div class="ttdef"><b>Definition</b> <a href="controller_8cpp_source.html#l02818">controller.cpp:2818</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a99c90ed934995116348fe891223e1037"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a99c90ed934995116348fe891223e1037">sysio::chain::controller::get_contract_blacklist</a></div><div class="ttdeci">const flat_set&lt; account_name &gt; &amp; get_contract_blacklist() const</div><div class="ttdef"><b>Definition</b> <a href="controller_8cpp_source.html#l02899">controller.cpp:2899</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a9ebce710613bffd9b019b8d9fc15d20e"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a9ebce710613bffd9b019b8d9fc15d20e">sysio::chain::controller::remove_resource_greylist</a></div><div class="ttdeci">void remove_resource_greylist(const account_name &amp;name)</div><div class="ttdef"><b>Definition</b> <a href="controller_8cpp_source.html#l03425">controller.cpp:3425</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_aa62c0e462ac0a8c8b3345e59623ffad0"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#aa62c0e462ac0a8c8b3345e59623ffad0">sysio::chain::controller::get_chain_id</a></div><div class="ttdeci">chain_id_type get_chain_id() const</div><div class="ttdef"><b>Definition</b> <a href="controller_8cpp_source.html#l03273">controller.cpp:3273</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_aabfe5c42521aa0550a5f5e60ec89fd19"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#aabfe5c42521aa0550a5f5e60ec89fd19">sysio::chain::controller::get_key_blacklist</a></div><div class="ttdeci">const flat_set&lt; public_key_type &gt; &amp; get_key_blacklist() const</div><div class="ttdef"><b>Definition</b> <a href="controller_8cpp_source.html#l02905">controller.cpp:2905</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_aac87d5e13183ec45393587036b89a14a"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#aac87d5e13183ec45393587036b89a14a">sysio::chain::controller::get_resource_greylist</a></div><div class="ttdeci">const flat_set&lt; account_name &gt; &amp; get_resource_greylist() const</div><div class="ttdef"><b>Definition</b> <a href="controller_8cpp_source.html#l03433">controller.cpp:3433</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_ab156fd6d4e3f28e14373c8dbbeb5a0ed"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#ab156fd6d4e3f28e14373c8dbbeb5a0ed">sysio::chain::controller::set_contract_whitelist</a></div><div class="ttdeci">void set_contract_whitelist(const flat_set&lt; account_name &gt; &amp;)</div><div class="ttdef"><b>Definition</b> <a href="controller_8cpp_source.html#l02915">controller.cpp:2915</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_abb1d81f96986df3bce46bd37caaf6a69"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#abb1d81f96986df3bce46bd37caaf6a69">sysio::chain::controller::pending_block_time</a></div><div class="ttdeci">time_point pending_block_time() const</div><div class="ttdef"><b>Definition</b> <a href="controller_8cpp_source.html#l03000">controller.cpp:3000</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_abf042d0e964b46d1a401119d3575ff82"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#abf042d0e964b46d1a401119d3575ff82">sysio::chain::controller::validate_protocol_features</a></div><div class="ttdeci">void validate_protocol_features(const vector&lt; digest_type &gt; &amp;features_to_activate) const</div><div class="ttdef"><b>Definition</b> <a href="controller_8cpp_source.html#l02774">controller.cpp:2774</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_ac81c5e33faa52c5a78a67fc2032ce1aa"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#ac81c5e33faa52c5a78a67fc2032ce1aa">sysio::chain::controller::get_preactivated_protocol_features</a></div><div class="ttdeci">vector&lt; digest_type &gt; get_preactivated_protocol_features() const</div><div class="ttdef"><b>Definition</b> <a href="controller_8cpp_source.html#l02760">controller.cpp:2760</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_ac8d3310c59100f18efeb9a7007a21103"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#ac8d3310c59100f18efeb9a7007a21103">sysio::chain::controller::set_subjective_cpu_leeway</a></div><div class="ttdeci">void set_subjective_cpu_leeway(fc::microseconds leeway)</div><div class="ttdef"><b>Definition</b> <a href="controller_8cpp_source.html#l03399">controller.cpp:3399</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_ad0b710fd894bc8c7265b7e8c958df7bc"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#ad0b710fd894bc8c7265b7e8c958df7bc">sysio::chain::controller::add_resource_greylist</a></div><div class="ttdeci">void add_resource_greylist(const account_name &amp;name)</div><div class="ttdef"><b>Definition</b> <a href="controller_8cpp_source.html#l03421">controller.cpp:3421</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_ad5e154b110a034f3a6430f7827e9c4b3"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#ad5e154b110a034f3a6430f7827e9c4b3">sysio::chain::controller::is_known_unexpired_transaction</a></div><div class="ttdeci">bool is_known_unexpired_transaction(const transaction_id_type &amp;id) const</div><div class="ttdef"><b>Definition</b> <a href="controller_8cpp_source.html#l03395">controller.cpp:3395</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_ae0a4a81d5d603085be18b54fb5a709b9"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#ae0a4a81d5d603085be18b54fb5a709b9">sysio::chain::controller::calculate_integrity_hash</a></div><div class="ttdeci">sha256 calculate_integrity_hash()</div><div class="ttdef"><b>Definition</b> <a href="controller_8cpp_source.html#l03119">controller.cpp:3119</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_ae2572c1888aa71c5386d8d3fc7df75c5"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#ae2572c1888aa71c5386d8d3fc7df75c5">sysio::chain::controller::get_actor_whitelist</a></div><div class="ttdeci">const flat_set&lt; account_name &gt; &amp; get_actor_whitelist() const</div><div class="ttdef"><b>Definition</b> <a href="controller_8cpp_source.html#l02890">controller.cpp:2890</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_aea3612e7cb52dfcaa2e6afdc1b3e2f51"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#aea3612e7cb52dfcaa2e6afdc1b3e2f51">sysio::chain::controller::head_block_time</a></div><div class="ttdeci">time_point head_block_time() const</div><div class="ttdef"><b>Definition</b> <a href="controller_8cpp_source.html#l02952">controller.cpp:2952</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_af096f331aa6ac6b3fe3aa71b3768daa8"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#af096f331aa6ac6b3fe3aa71b3768daa8">sysio::chain::controller::get_resource_limits_manager</a></div><div class="ttdeci">const resource_limits_manager &amp; get_resource_limits_manager() const</div><div class="ttdoc">controller_impl</div><div class="ttdef"><b>Definition</b> <a href="controller_8cpp_source.html#l02582">controller.cpp:2582</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_af1e44676760107bf3ed8979feb1d4f00"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#af1e44676760107bf3ed8979feb1d4f00">sysio::chain::controller::set_action_blacklist</a></div><div class="ttdeci">void set_action_blacklist(const flat_set&lt; pair&lt; account_name, action_name &gt; &gt; &amp;)</div><div class="ttdef"><b>Definition</b> <a href="controller_8cpp_source.html#l02921">controller.cpp:2921</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_afe40d1beedb5ec60de7e8d6575ba68ee"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#afe40d1beedb5ec60de7e8d6575ba68ee">sysio::chain::controller::start_block</a></div><div class="ttdeci">void start_block(block_timestamp_type time=block_timestamp_type(), uint16_t confirm_block_count=0)</div><div class="ttdef"><b>Definition</b> <a href="controller_8cpp_source.html#l02780">controller.cpp:2780</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1protocol__feature__manager_html_a9e6c1310749c4fd04035aa2c01310ce4"><div class="ttname"><a href="classsysio_1_1chain_1_1protocol__feature__manager.html#a9e6c1310749c4fd04035aa2c01310ce4">sysio::chain::protocol_feature_manager::get_protocol_feature_set</a></div><div class="ttdeci">const protocol_feature_set &amp; get_protocol_feature_set() const</div><div class="ttdef"><b>Definition</b> <a href="protocol__feature__manager_8hpp_source.html#l00342">protocol_feature_manager.hpp:342</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1resource__limits_1_1resource__limits__manager_html_a59c1ce742daefcf8e370e844ed49f955"><div class="ttname"><a href="classsysio_1_1chain_1_1resource__limits_1_1resource__limits__manager.html#a59c1ce742daefcf8e370e844ed49f955">sysio::chain::resource_limits::resource_limits_manager::get_block_cpu_limit</a></div><div class="ttdeci">uint64_t get_block_cpu_limit() const</div><div class="ttdef"><b>Definition</b> <a href="resource__limits_8cpp_source.html#l00404">resource_limits.cpp:404</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1transaction__metadata_html_a122861328470aa67ebf9ac5cb798755d"><div class="ttname"><a href="classsysio_1_1chain_1_1transaction__metadata.html#a122861328470aa67ebf9ac5cb798755d">sysio::chain::transaction_metadata::start_recover_keys</a></div><div class="ttdeci">static recover_keys_future start_recover_keys(packed_transaction_ptr trx, boost::asio::io_context &amp;thread_pool, const chain_id_type &amp;chain_id, fc::microseconds time_limit, trx_type t, uint32_t max_variable_sig_size=UINT32_MAX)</div><div class="ttdef"><b>Definition</b> <a href="transaction__metadata_8cpp_source.html#l00007">transaction_metadata.cpp:7</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1unapplied__transaction__queue_html"><div class="ttname"><a href="classsysio_1_1chain_1_1unapplied__transaction__queue.html">sysio::chain::unapplied_transaction_queue</a></div><div class="ttdef"><b>Definition</b> <a href="unapplied__transaction__queue_8hpp_source.html#l00052">unapplied_transaction_queue.hpp:52</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1unapplied__transaction__queue_html_a0ee4b3f8ad23d7b553e5a0f3224b32d4"><div class="ttname"><a href="classsysio_1_1chain_1_1unapplied__transaction__queue.html#a0ee4b3f8ad23d7b553e5a0f3224b32d4">sysio::chain::unapplied_transaction_queue::clear_expired</a></div><div class="ttdeci">bool clear_expired(const time_point &amp;pending_block_time, Yield &amp;&amp;yield, Callback &amp;&amp;callback)</div><div class="ttdef"><b>Definition</b> <a href="unapplied__transaction__queue_8hpp_source.html#l00100">unapplied_transaction_queue.hpp:100</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1unapplied__transaction__queue_html_a2eda9b632f768fb2c1b76133b8d792f0"><div class="ttname"><a href="classsysio_1_1chain_1_1unapplied__transaction__queue.html#a2eda9b632f768fb2c1b76133b8d792f0">sysio::chain::unapplied_transaction_queue::incoming_size</a></div><div class="ttdeci">size_t incoming_size() const</div><div class="ttdef"><b>Definition</b> <a href="unapplied__transaction__queue_8hpp_source.html#l00089">unapplied_transaction_queue.hpp:89</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1unapplied__transaction__queue_html_a428508ff4641d3bf3503fa304696133d"><div class="ttname"><a href="classsysio_1_1chain_1_1unapplied__transaction__queue.html#a428508ff4641d3bf3503fa304696133d">sysio::chain::unapplied_transaction_queue::unapplied_end</a></div><div class="ttdeci">iterator unapplied_end()</div><div class="ttdef"><b>Definition</b> <a href="unapplied__transaction__queue_8hpp_source.html#l00202">unapplied_transaction_queue.hpp:202</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1unapplied__transaction__queue_html_a49e515ce9a15ee839fbd8990c8bcb388"><div class="ttname"><a href="classsysio_1_1chain_1_1unapplied__transaction__queue.html#a49e515ce9a15ee839fbd8990c8bcb388">sysio::chain::unapplied_transaction_queue::persisted_end</a></div><div class="ttdeci">iterator persisted_end()</div><div class="ttdef"><b>Definition</b> <a href="unapplied__transaction__queue_8hpp_source.html#l00205">unapplied_transaction_queue.hpp:205</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1unapplied__transaction__queue_html_a581b5bfdb66db1dba220db3103d78631"><div class="ttname"><a href="classsysio_1_1chain_1_1unapplied__transaction__queue.html#a581b5bfdb66db1dba220db3103d78631">sysio::chain::unapplied_transaction_queue::incoming_begin</a></div><div class="ttdeci">iterator incoming_begin()</div><div class="ttdef"><b>Definition</b> <a href="unapplied__transaction__queue_8hpp_source.html#l00207">unapplied_transaction_queue.hpp:207</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1unapplied__transaction__queue_html_a5906b1ee94fa2e09ae0eaa8d5cbd3711"><div class="ttname"><a href="classsysio_1_1chain_1_1unapplied__transaction__queue.html#a5906b1ee94fa2e09ae0eaa8d5cbd3711">sysio::chain::unapplied_transaction_queue::unapplied_begin</a></div><div class="ttdeci">iterator unapplied_begin()</div><div class="ttdef"><b>Definition</b> <a href="unapplied__transaction__queue_8hpp_source.html#l00201">unapplied_transaction_queue.hpp:201</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1unapplied__transaction__queue_html_a5a244791044e2d59736ff24339aed822"><div class="ttname"><a href="classsysio_1_1chain_1_1unapplied__transaction__queue.html#a5a244791044e2d59736ff24339aed822">sysio::chain::unapplied_transaction_queue::empty</a></div><div class="ttdeci">bool empty() const</div><div class="ttdef"><b>Definition</b> <a href="unapplied__transaction__queue_8hpp_source.html#l00077">unapplied_transaction_queue.hpp:77</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1unapplied__transaction__queue_html_a602a769b172f4d7c3737719936f9bc78"><div class="ttname"><a href="classsysio_1_1chain_1_1unapplied__transaction__queue.html#a602a769b172f4d7c3737719936f9bc78">sysio::chain::unapplied_transaction_queue::add_forked</a></div><div class="ttdeci">void add_forked(const branch_type &amp;forked_branch)</div><div class="ttdef"><b>Definition</b> <a href="unapplied__transaction__queue_8hpp_source.html#l00143">unapplied_transaction_queue.hpp:143</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1unapplied__transaction__queue_html_a60c602838e90f62ba458d569cf52dfe5"><div class="ttname"><a href="classsysio_1_1chain_1_1unapplied__transaction__queue.html#a60c602838e90f62ba458d569cf52dfe5">sysio::chain::unapplied_transaction_queue::erase</a></div><div class="ttdeci">iterator erase(iterator itr)</div><div class="ttdoc">caller's responsibility to call next() if applicable</div><div class="ttdef"><b>Definition</b> <a href="unapplied__transaction__queue_8hpp_source.html#l00211">unapplied_transaction_queue.hpp:211</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1unapplied__transaction__queue_html_a64a6bf20ec0b7476d2fe310840dc818d"><div class="ttname"><a href="classsysio_1_1chain_1_1unapplied__transaction__queue.html#a64a6bf20ec0b7476d2fe310840dc818d">sysio::chain::unapplied_transaction_queue::add_aborted</a></div><div class="ttdeci">void add_aborted(std::vector&lt; transaction_metadata_ptr &gt; aborted_trxs)</div><div class="ttdef"><b>Definition</b> <a href="unapplied__transaction__queue_8hpp_source.html#l00156">unapplied_transaction_queue.hpp:156</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1unapplied__transaction__queue_html_a7fb8cf5dfb622f9e619be9a4bb5eeba8"><div class="ttname"><a href="classsysio_1_1chain_1_1unapplied__transaction__queue.html#a7fb8cf5dfb622f9e619be9a4bb5eeba8">sysio::chain::unapplied_transaction_queue::size</a></div><div class="ttdeci">size_t size() const</div><div class="ttdef"><b>Definition</b> <a href="unapplied__transaction__queue_8hpp_source.html#l00081">unapplied_transaction_queue.hpp:81</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1unapplied__transaction__queue_html_ac15fce39af8a270bc242c4c09006daec"><div class="ttname"><a href="classsysio_1_1chain_1_1unapplied__transaction__queue.html#ac15fce39af8a270bc242c4c09006daec">sysio::chain::unapplied_transaction_queue::incoming_end</a></div><div class="ttdeci">iterator incoming_end()</div><div class="ttdef"><b>Definition</b> <a href="unapplied__transaction__queue_8hpp_source.html#l00208">unapplied_transaction_queue.hpp:208</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1unapplied__transaction__queue_html_ac9f23f3629b373f5dd2f62a960472562"><div class="ttname"><a href="classsysio_1_1chain_1_1unapplied__transaction__queue.html#ac9f23f3629b373f5dd2f62a960472562">sysio::chain::unapplied_transaction_queue::persisted_begin</a></div><div class="ttdeci">iterator persisted_begin()</div><div class="ttdef"><b>Definition</b> <a href="unapplied__transaction__queue_8hpp_source.html#l00204">unapplied_transaction_queue.hpp:204</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1unapplied__transaction__queue_html_ae094df3999abc100626a5fe9f5937561"><div class="ttname"><a href="classsysio_1_1chain_1_1unapplied__transaction__queue.html#ae094df3999abc100626a5fe9f5937561">sysio::chain::unapplied_transaction_queue::clear_applied</a></div><div class="ttdeci">void clear_applied(const block_state_ptr &amp;bs)</div><div class="ttdef"><b>Definition</b> <a href="unapplied__transaction__queue_8hpp_source.html#l00124">unapplied_transaction_queue.hpp:124</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1unapplied__transaction__queue_html_aeecdfc8cf255ba408c1c1a42bc83a2d8"><div class="ttname"><a href="classsysio_1_1chain_1_1unapplied__transaction__queue.html#aeecdfc8cf255ba408c1c1a42bc83a2d8">sysio::chain::unapplied_transaction_queue::get_trx</a></div><div class="ttdeci">transaction_metadata_ptr get_trx(const transaction_id_type &amp;id) const</div><div class="ttdef"><b>Definition</b> <a href="unapplied__transaction__queue_8hpp_source.html#l00093">unapplied_transaction_queue.hpp:93</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain__plugin_html"><div class="ttname"><a href="classsysio_1_1chain__plugin.html">sysio::chain_plugin</a></div><div class="ttdef"><b>Definition</b> <a href="chain__plugin_8hpp_source.html#l00763">chain_plugin.hpp:763</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain__plugin_html_a047022d2589d7624114c1e458b111ea7"><div class="ttname"><a href="classsysio_1_1chain__plugin.html#a047022d2589d7624114c1e458b111ea7">sysio::chain_plugin::handle_db_exhaustion</a></div><div class="ttdeci">static void handle_db_exhaustion()</div><div class="ttdef"><b>Definition</b> <a href="chain__plugin_8cpp_source.html#l01383">chain_plugin.cpp:1383</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain__plugin_html_a14a5e77b31ecf267c8062267d03440ae"><div class="ttname"><a href="classsysio_1_1chain__plugin.html#a14a5e77b31ecf267c8062267d03440ae">sysio::chain_plugin::chain</a></div><div class="ttdeci">controller &amp; chain()</div><div class="ttdef"><b>Definition</b> <a href="chain__plugin_8cpp_source.html#l01342">chain_plugin.cpp:1342</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain__plugin_html_a6042f76be687a9b82332f28e1dc9a3a4"><div class="ttname"><a href="classsysio_1_1chain__plugin.html#a6042f76be687a9b82332f28e1dc9a3a4">sysio::chain_plugin::handle_guard_exception</a></div><div class="ttdeci">static void handle_guard_exception(const chain::guard_exception &amp;e)</div><div class="ttdef"><b>Definition</b> <a href="chain__plugin_8cpp_source.html#l01375">chain_plugin.cpp:1375</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain__plugin_html_a9fb4d31b915fb0d2ef5392a4284b67e6"><div class="ttname"><a href="classsysio_1_1chain__plugin.html#a9fb4d31b915fb0d2ef5392a4284b67e6">sysio::chain_plugin::handle_bad_alloc</a></div><div class="ttdeci">static void handle_bad_alloc()</div><div class="ttdef"><b>Definition</b> <a href="chain__plugin_8cpp_source.html#l01389">chain_plugin.cpp:1389</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain__plugin_html_ad911df70e3131f7a2ed91d1eca08793a"><div class="ttname"><a href="classsysio_1_1chain__plugin.html#ad911df70e3131f7a2ed91d1eca08793a">sysio::chain_plugin::accept_transactions</a></div><div class="ttdeci">bool accept_transactions() const</div><div class="ttdef"><b>Definition</b> <a href="chain__plugin_8cpp_source.html#l01357">chain_plugin.cpp:1357</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain__plugin_html_ae56bb5451f52c447629b2cecbd8d4b58"><div class="ttname"><a href="classsysio_1_1chain__plugin.html#ae56bb5451f52c447629b2cecbd8d4b58">sysio::chain_plugin::get_log_trx</a></div><div class="ttdeci">fc::variant get_log_trx(const transaction &amp;trx) const</div><div class="ttdef"><b>Definition</b> <a href="chain__plugin_8cpp_source.html#l02747">chain_plugin.cpp:2747</a></div></div>
<div class="ttc" id="aclasssysio_1_1http__client__plugin_html"><div class="ttname"><a href="classsysio_1_1http__client__plugin.html">sysio::http_client_plugin</a></div><div class="ttdef"><b>Definition</b> <a href="http__client__plugin_8hpp_source.html#l00009">http_client_plugin.hpp:10</a></div></div>
<div class="ttc" id="aclasssysio_1_1pending__snapshot_html"><div class="ttname"><a href="classsysio_1_1pending__snapshot.html">sysio::pending_snapshot</a></div><div class="ttdef"><b>Definition</b> <a href="#l00122">producer_plugin.cpp:122</a></div></div>
<div class="ttc" id="aclasssysio_1_1pending__snapshot_html_a0a38893f527797a40a857997faa24965"><div class="ttname"><a href="classsysio_1_1pending__snapshot.html#a0a38893f527797a40a857997faa24965">sysio::pending_snapshot::next</a></div><div class="ttdeci">next_t next</div><div class="ttdef"><b>Definition</b> <a href="#l00172">producer_plugin.cpp:172</a></div></div>
<div class="ttc" id="aclasssysio_1_1pending__snapshot_html_a1915f67e4cb854b7614890e223c6d8de"><div class="ttname"><a href="classsysio_1_1pending__snapshot.html#a1915f67e4cb854b7614890e223c6d8de">sysio::pending_snapshot::next_t</a></div><div class="ttdeci">producer_plugin::next_function&lt; producer_plugin::snapshot_information &gt; next_t</div><div class="ttdef"><b>Definition</b> <a href="#l00124">producer_plugin.cpp:124</a></div></div>
<div class="ttc" id="aclasssysio_1_1pending__snapshot_html_a44c77e2240938dc9116890df2818bf4b"><div class="ttname"><a href="classsysio_1_1pending__snapshot.html#a44c77e2240938dc9116890df2818bf4b">sysio::pending_snapshot::get_pending_path</a></div><div class="ttdeci">static bfs::path get_pending_path(const block_id_type &amp;block_id, const bfs::path &amp;snapshots_dir)</div><div class="ttdef"><b>Definition</b> <a href="#l00141">producer_plugin.cpp:141</a></div></div>
<div class="ttc" id="aclasssysio_1_1pending__snapshot_html_a480efe5391047b60fd1b192b80784537"><div class="ttname"><a href="classsysio_1_1pending__snapshot.html#a480efe5391047b60fd1b192b80784537">sysio::pending_snapshot::get_height</a></div><div class="ttdeci">uint32_t get_height() const</div><div class="ttdef"><b>Definition</b> <a href="#l00133">producer_plugin.cpp:133</a></div></div>
<div class="ttc" id="aclasssysio_1_1pending__snapshot_html_a5c1d883bec4e7ed86c903ad81d4301cd"><div class="ttname"><a href="classsysio_1_1pending__snapshot.html#a5c1d883bec4e7ed86c903ad81d4301cd">sysio::pending_snapshot::get_temp_path</a></div><div class="ttdeci">static bfs::path get_temp_path(const block_id_type &amp;block_id, const bfs::path &amp;snapshots_dir)</div><div class="ttdef"><b>Definition</b> <a href="#l00145">producer_plugin.cpp:145</a></div></div>
<div class="ttc" id="aclasssysio_1_1pending__snapshot_html_a701da57e23f9da21fb2128ef097d41e0"><div class="ttname"><a href="classsysio_1_1pending__snapshot.html#a701da57e23f9da21fb2128ef097d41e0">sysio::pending_snapshot::pending_snapshot</a></div><div class="ttdeci">pending_snapshot(const block_id_type &amp;block_id, next_t &amp;next, std::string pending_path, std::string final_path)</div><div class="ttdef"><b>Definition</b> <a href="#l00126">producer_plugin.cpp:126</a></div></div>
<div class="ttc" id="aclasssysio_1_1pending__snapshot_html_a746d5d6ce681a9cda250a36e25f8781a"><div class="ttname"><a href="classsysio_1_1pending__snapshot.html#a746d5d6ce681a9cda250a36e25f8781a">sysio::pending_snapshot::finalize</a></div><div class="ttdeci">producer_plugin::snapshot_information finalize(const chain::controller &amp;chain) const</div><div class="ttdef"><b>Definition</b> <a href="#l00149">producer_plugin.cpp:149</a></div></div>
<div class="ttc" id="aclasssysio_1_1pending__snapshot_html_a79a20762863821f28c0a9c58fe28a498"><div class="ttname"><a href="classsysio_1_1pending__snapshot.html#a79a20762863821f28c0a9c58fe28a498">sysio::pending_snapshot::block_id</a></div><div class="ttdeci">block_id_type block_id</div><div class="ttdef"><b>Definition</b> <a href="#l00171">producer_plugin.cpp:171</a></div></div>
<div class="ttc" id="aclasssysio_1_1pending__snapshot_html_a79fc9801d0442d3b7f58833f23d6c9f9"><div class="ttname"><a href="classsysio_1_1pending__snapshot.html#a79fc9801d0442d3b7f58833f23d6c9f9">sysio::pending_snapshot::get_final_path</a></div><div class="ttdeci">static bfs::path get_final_path(const block_id_type &amp;block_id, const bfs::path &amp;snapshots_dir)</div><div class="ttdef"><b>Definition</b> <a href="#l00137">producer_plugin.cpp:137</a></div></div>
<div class="ttc" id="aclasssysio_1_1pending__snapshot_html_aa485b681ff792ae2faf5f4ab70165599"><div class="ttname"><a href="classsysio_1_1pending__snapshot.html#aa485b681ff792ae2faf5f4ab70165599">sysio::pending_snapshot::pending_path</a></div><div class="ttdeci">std::string pending_path</div><div class="ttdef"><b>Definition</b> <a href="#l00173">producer_plugin.cpp:173</a></div></div>
<div class="ttc" id="aclasssysio_1_1pending__snapshot_html_adcaa3a5c35a2dfbc55136ff2ffa8df52"><div class="ttname"><a href="classsysio_1_1pending__snapshot.html#adcaa3a5c35a2dfbc55136ff2ffa8df52">sysio::pending_snapshot::final_path</a></div><div class="ttdeci">std::string final_path</div><div class="ttdef"><b>Definition</b> <a href="#l00174">producer_plugin.cpp:174</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html">sysio::producer_plugin_impl</a></div><div class="ttdef"><b>Definition</b> <a href="#l00292">producer_plugin.cpp:292</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_a03ffa5daf4ee4f47e84f8bae98bc1a00"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#a03ffa5daf4ee4f47e84f8bae98bc1a00">sysio::producer_plugin_impl::get_irreversible_block_age</a></div><div class="ttdeci">fc::microseconds get_irreversible_block_age()</div><div class="ttdef"><b>Definition</b> <a href="#l00763">producer_plugin.cpp:763</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_a07a7c896dddfa2b6c36cf67248d3599d"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#a07a7c896dddfa2b6c36cf67248d3599d">sysio::producer_plugin_impl::remove_expired_trxs</a></div><div class="ttdeci">bool remove_expired_trxs(const fc::time_point &amp;deadline)</div><div class="ttdef"><b>Definition</b> <a href="#l01910">producer_plugin.cpp:1910</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_a0a246b1d6815b521e66aa47f3ddfde22"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#a0a246b1d6815b521e66aa47f3ddfde22">sysio::producer_plugin_impl::on_block_header</a></div><div class="ttdeci">void on_block_header(const block_state_ptr &amp;bsp)</div><div class="ttdef"><b>Definition</b> <a href="#l00403">producer_plugin.cpp:403</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_a104ad57b8b9c3c8e53a680e09318ea5d"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#a104ad57b8b9c3c8e53a680e09318ea5d">sysio::producer_plugin_impl::should_interrupt_start_block</a></div><div class="ttdeci">bool should_interrupt_start_block(const fc::time_point &amp;deadline) const</div><div class="ttdef"><b>Definition</b> <a href="#l01674">producer_plugin.cpp:1674</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_a12b22968d557ea73915472d3f1d642fe"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#a12b22968d557ea73915472d3f1d642fe">sysio::producer_plugin_impl::on_block</a></div><div class="ttdeci">void on_block(const block_state_ptr &amp;bsp)</div><div class="ttdef"><b>Definition</b> <a href="#l00395">producer_plugin.cpp:395</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_a12f98c27eeff1e09ab398e9f0f158583"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#a12f98c27eeff1e09ab398e9f0f158583">sysio::producer_plugin_impl::_disable_persist_until_expired</a></div><div class="ttdeci">bool _disable_persist_until_expired</div><div class="ttdef"><b>Definition</b> <a href="#l00334">producer_plugin.cpp:334</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_a15812dcb0edaaa48ab154d3bb2ca6a5c"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#a15812dcb0edaaa48ab154d3bb2ca6a5c">sysio::producer_plugin_impl::schedule_delayed_production_loop</a></div><div class="ttdeci">void schedule_delayed_production_loop(const std::weak_ptr&lt; producer_plugin_impl &gt; &amp;weak_this, std::optional&lt; fc::time_point &gt; wake_up_time)</div><div class="ttdef"><b>Definition</b> <a href="#l02356">producer_plugin.cpp:2356</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_a1cd329e031b1d57746ec38a44a2181bb"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#a1cd329e031b1d57746ec38a44a2181bb">sysio::producer_plugin_impl::start_block_result</a></div><div class="ttdeci">start_block_result</div><div class="ttdef"><b>Definition</b> <a href="#l00785">producer_plugin.cpp:785</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_a1cd329e031b1d57746ec38a44a2181bba0f967fbaf130c7283779d1cf6058d1fa"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#a1cd329e031b1d57746ec38a44a2181bba0f967fbaf130c7283779d1cf6058d1fa">sysio::producer_plugin_impl::start_block_result::waiting_for_production</a></div><div class="ttdeci">@ waiting_for_production</div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_a1cd329e031b1d57746ec38a44a2181bba26934eb377001f66e37289a5c93fe284"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#a1cd329e031b1d57746ec38a44a2181bba26934eb377001f66e37289a5c93fe284">sysio::producer_plugin_impl::start_block_result::failed</a></div><div class="ttdeci">@ failed</div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_a1cd329e031b1d57746ec38a44a2181bba431da7f12530d5bf74adec7e85562038"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#a1cd329e031b1d57746ec38a44a2181bba431da7f12530d5bf74adec7e85562038">sysio::producer_plugin_impl::start_block_result::waiting_for_block</a></div><div class="ttdeci">@ waiting_for_block</div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_a1cd329e031b1d57746ec38a44a2181bba9b1751bd331d17d4f91c2c61c1d43560"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#a1cd329e031b1d57746ec38a44a2181bba9b1751bd331d17d4f91c2c61c1d43560">sysio::producer_plugin_impl::start_block_result::succeeded</a></div><div class="ttdeci">@ succeeded</div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_a1cd329e031b1d57746ec38a44a2181bbae349d735a5fa5b10d9770031e669c477"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#a1cd329e031b1d57746ec38a44a2181bbae349d735a5fa5b10d9770031e669c477">sysio::producer_plugin_impl::start_block_result::exhausted</a></div><div class="ttdeci">@ exhausted</div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_a2146e64be3edae1b16c270ee9e0a54e5"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#a2146e64be3edae1b16c270ee9e0a54e5">sysio::producer_plugin_impl::_blacklisted_transactions</a></div><div class="ttdeci">transaction_id_with_expiry_index _blacklisted_transactions</div><div class="ttdef"><b>Definition</b> <a href="#l00350">producer_plugin.cpp:350</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_a21693978cec3fac7ce203531e88c7d5a"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#a21693978cec3fac7ce203531e88c7d5a">sysio::producer_plugin_impl::_timer_corelation_id</a></div><div class="ttdeci">uint32_t _timer_corelation_id</div><div class="ttdef"><b>Definition</b> <a href="#l00369">producer_plugin.cpp:369</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_a21f33bc77d2b8ba31fd7bd4e8788d8f7"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#a21f33bc77d2b8ba31fd7bd4e8788d8f7">sysio::producer_plugin_impl::on_incoming_transaction_async</a></div><div class="ttdeci">void on_incoming_transaction_async(const packed_transaction_ptr &amp;trx, bool persist_until_expired, bool read_only, bool return_failure_traces, next_function&lt; transaction_trace_ptr &gt; next)</div><div class="ttdef"><b>Definition</b> <a href="#l00528">producer_plugin.cpp:528</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_a230c88a6ed7efbc3588a043fe4915bd9"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#a230c88a6ed7efbc3588a043fe4915bd9">sysio::producer_plugin_impl::maybe_produce_block</a></div><div class="ttdeci">bool maybe_produce_block()</div><div class="ttdef"><b>Definition</b> <a href="#l02372">producer_plugin.cpp:2372</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_a2347f0637a0b2f1b2a16851aa4c3ef12"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#a2347f0637a0b2f1b2a16851aa4c3ef12">sysio::producer_plugin_impl::process_incoming_transaction_async</a></div><div class="ttdeci">bool process_incoming_transaction_async(const transaction_metadata_ptr &amp;trx, bool persist_until_expired, bool return_failure_traces, next_function&lt; transaction_trace_ptr &gt; next)</div><div class="ttdef"><b>Definition</b> <a href="#l00572">producer_plugin.cpp:572</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_a26b02d1ebd098ea1ba2399c3c4a47046"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#a26b02d1ebd098ea1ba2399c3c4a47046">sysio::producer_plugin_impl::_kiod_provider_timeout_us</a></div><div class="ttdeci">fc::microseconds _kiod_provider_timeout_us</div><div class="ttdef"><b>Definition</b> <a href="#l00338">producer_plugin.cpp:338</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_a26f51591effdca88f46913aa23308695"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#a26f51591effdca88f46913aa23308695">sysio::producer_plugin_impl::_production_enabled</a></div><div class="ttdeci">bool _production_enabled</div><div class="ttdef"><b>Definition</b> <a href="#l00313">producer_plugin.cpp:313</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_a2be6b35c5dbf8e84124b605f40551557"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#a2be6b35c5dbf8e84124b605f40551557">sysio::producer_plugin_impl::_irreversible_block_connection</a></div><div class="ttdeci">std::optional&lt; scoped_connection &gt; _irreversible_block_connection</div><div class="ttdef"><b>Definition</b> <a href="#l00357">producer_plugin.cpp:357</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_a2c7bfb29624a2f689de1ee762eba165a"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#a2c7bfb29624a2f689de1ee762eba165a">sysio::producer_plugin_impl::_accepted_block_connection</a></div><div class="ttdeci">std::optional&lt; scoped_connection &gt; _accepted_block_connection</div><div class="ttdef"><b>Definition</b> <a href="#l00355">producer_plugin.cpp:355</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_a2cc24baff7f0994410c60383929d25e8"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#a2cc24baff7f0994410c60383929d25e8">sysio::producer_plugin_impl::_disable_subjective_p2p_billing</a></div><div class="ttdeci">bool _disable_subjective_p2p_billing</div><div class="ttdef"><b>Definition</b> <a href="#l00335">producer_plugin.cpp:335</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_a336a35581aedb4308f8fc7f4eb44f152"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#a336a35581aedb4308f8fc7f4eb44f152">sysio::producer_plugin_impl::produce_block</a></div><div class="ttdeci">void produce_block()</div><div class="ttdef"><b>Definition</b> <a href="#l02402">producer_plugin.cpp:2402</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_a369d1c5202c442237cb333c850f1634e"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#a369d1c5202c442237cb333c850f1634e">sysio::producer_plugin_impl::_protocol_features_signaled</a></div><div class="ttdeci">bool _protocol_features_signaled</div><div class="ttdef"><b>Definition</b> <a href="#l00341">producer_plugin.cpp:341</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_a3c8802a7ba5739234e2d4050a1a1c2e8"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#a3c8802a7ba5739234e2d4050a1a1c2e8">sysio::producer_plugin_impl::_incoming_transaction_async_provider</a></div><div class="ttdeci">incoming::methods::transaction_async::method_type::handle _incoming_transaction_async_provider</div><div class="ttdef"><b>Definition</b> <a href="#l00348">producer_plugin.cpp:348</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_a46f5da3c1146a1e5f0850e541dac2d90"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#a46f5da3c1146a1e5f0850e541dac2d90">sysio::producer_plugin_impl::schedule_maybe_produce_block</a></div><div class="ttdeci">void schedule_maybe_produce_block(bool exhausted)</div><div class="ttdef"><b>Definition</b> <a href="#l02298">producer_plugin.cpp:2298</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_a56a2e3bfd17e3a5e6637d2c4d39d98e9"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#a56a2e3bfd17e3a5e6637d2c4d39d98e9">sysio::producer_plugin_impl::_producer_watermarks</a></div><div class="ttdeci">std::map&lt; chain::account_name, producer_watermark &gt; _producer_watermarks</div><div class="ttdef"><b>Definition</b> <a href="#l00321">producer_plugin.cpp:321</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_a5b19b3db1d6db7aa9a66a6a253417d7e"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#a5b19b3db1d6db7aa9a66a6a253417d7e">sysio::producer_plugin_impl::remove_expired_blacklisted_trxs</a></div><div class="ttdeci">bool remove_expired_blacklisted_trxs(const fc::time_point &amp;deadline)</div><div class="ttdef"><b>Definition</b> <a href="#l01975">producer_plugin.cpp:1975</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_a5d959db90832bddf418fff0e29171637"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#a5d959db90832bddf418fff0e29171637">sysio::producer_plugin_impl::_incoming_block_sync_provider</a></div><div class="ttdeci">incoming::methods::block_sync::method_type::handle _incoming_block_sync_provider</div><div class="ttdef"><b>Definition</b> <a href="#l00347">producer_plugin.cpp:347</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_a6362a5144896a319e360fcbab4cbe92d"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#a6362a5144896a319e360fcbab4cbe92d">sysio::producer_plugin_impl::on_irreversible_block</a></div><div class="ttdeci">void on_irreversible_block(const signed_block_ptr &amp;lib)</div><div class="ttdef"><b>Definition</b> <a href="#l00407">producer_plugin.cpp:407</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_a652ecc759215ca6fa58b36370cc72e43"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#a652ecc759215ca6fa58b36370cc72e43">sysio::producer_plugin_impl::calculate_producer_wake_up_time</a></div><div class="ttdeci">std::optional&lt; fc::time_point &gt; calculate_producer_wake_up_time(const block_timestamp_type &amp;ref_block_time) const</div><div class="ttdef"><b>Definition</b> <a href="#l02332">producer_plugin.cpp:2332</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_a67c0fb2d1c7d16bd65cd86788d74eb0a"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#a67c0fb2d1c7d16bd65cd86788d74eb0a">sysio::producer_plugin_impl::_incoming_defer_ratio</a></div><div class="ttdeci">double _incoming_defer_ratio</div><div class="ttdef"><b>Definition</b> <a href="#l00372">producer_plugin.cpp:372</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_a69e4926fe7ce9b13512a6292fe20e4d4"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#a69e4926fe7ce9b13512a6292fe20e4d4">sysio::producer_plugin_impl::_irreversible_block_time</a></div><div class="ttdeci">fc::time_point _irreversible_block_time</div><div class="ttdef"><b>Definition</b> <a href="#l00337">producer_plugin.cpp:337</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_a6d12d42f012fe9fd7d0e533952498cab"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#a6d12d42f012fe9fd7d0e533952498cab">sysio::producer_plugin_impl::_transaction_ack_channel</a></div><div class="ttdeci">compat::channels::transaction_ack::channel_type &amp; _transaction_ack_channel</div><div class="ttdef"><b>Definition</b> <a href="#l00345">producer_plugin.cpp:345</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_a708986322e03db824e4bad41ca213260"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#a708986322e03db824e4bad41ca213260">sysio::producer_plugin_impl::process_incoming_trxs</a></div><div class="ttdeci">bool process_incoming_trxs(const fc::time_point &amp;deadline, size_t &amp;pending_incoming_process_limit)</div><div class="ttdef"><b>Definition</b> <a href="#l02207">producer_plugin.cpp:2207</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_a7148be5020530e05d145c8ffef8569f4"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#a7148be5020530e05d145c8ffef8569f4">sysio::producer_plugin_impl::_accepted_block_header_connection</a></div><div class="ttdeci">std::optional&lt; scoped_connection &gt; _accepted_block_header_connection</div><div class="ttdef"><b>Definition</b> <a href="#l00356">producer_plugin.cpp:356</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_a7964ed6135deaf78fe51442d0fde20f5"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#a7964ed6135deaf78fe51442d0fde20f5">sysio::producer_plugin_impl::production_disabled_by_policy</a></div><div class="ttdeci">bool production_disabled_by_policy()</div><div class="ttdef"><b>Definition</b> <a href="#l00781">producer_plugin.cpp:781</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_a7b337b36d36c99e1978b0ff7086ee303"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#a7b337b36d36c99e1978b0ff7086ee303">sysio::producer_plugin_impl::producer_plugin_impl</a></div><div class="ttdeci">producer_plugin_impl(boost::asio::io_service &amp;io)</div><div class="ttdef"><b>Definition</b> <a href="#l00294">producer_plugin.cpp:294</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_a7db63178eda240d671fc6ae4e46bf01e"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#a7db63178eda240d671fc6ae4e46bf01e">sysio::producer_plugin_impl::start_block</a></div><div class="ttdeci">start_block_result start_block()</div><div class="ttdef"><b>Definition</b> <a href="#l01682">producer_plugin.cpp:1682</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_a7de28b674848c3de56118793193d3b49"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#a7de28b674848c3de56118793193d3b49">sysio::producer_plugin_impl::process_unapplied_trxs</a></div><div class="ttdeci">bool process_unapplied_trxs(const fc::time_point &amp;deadline)</div><div class="ttdef"><b>Definition</b> <a href="#l02001">producer_plugin.cpp:2001</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_a8e8b31bfedc54a91987109a93d906117"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#a8e8b31bfedc54a91987109a93d906117">sysio::producer_plugin_impl::_produce_time_offset_us</a></div><div class="ttdeci">int32_t _produce_time_offset_us</div><div class="ttdef"><b>Definition</b> <a href="#l00329">producer_plugin.cpp:329</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_a9077b433ee5250472b5670b5b9802362"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#a9077b433ee5250472b5670b5b9802362">sysio::producer_plugin_impl::get_watermark</a></div><div class="ttdeci">std::optional&lt; producer_watermark &gt; get_watermark(account_name producer) const</div><div class="ttdef"><b>Definition</b> <a href="#l00387">producer_plugin.cpp:387</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_a90e415597bff893b9e18e7e3ca2ab275"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#a90e415597bff893b9e18e7e3ca2ab275">sysio::producer_plugin_impl::calculate_block_deadline</a></div><div class="ttdeci">fc::time_point calculate_block_deadline(const fc::time_point &amp;) const</div><div class="ttdef"><b>Definition</b> <a href="#l01665">producer_plugin.cpp:1665</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_a9368777de44180b2070838ff18f2fb36"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#a9368777de44180b2070838ff18f2fb36">sysio::producer_plugin_impl::calculate_next_block_time</a></div><div class="ttdeci">std::optional&lt; fc::time_point &gt; calculate_next_block_time(const account_name &amp;producer_name, const block_timestamp_type &amp;current_block_time) const</div><div class="ttdef"><b>Definition</b> <a href="#l01596">producer_plugin.cpp:1596</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_a9992f102be5757c43dcdaedf97fb7c37"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#a9992f102be5757c43dcdaedf97fb7c37">sysio::producer_plugin_impl::_pause_production</a></div><div class="ttdeci">bool _pause_production</div><div class="ttdef"><b>Definition</b> <a href="#l00314">producer_plugin.cpp:314</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_a9ce89d0c80f40aeb7df69c5a49beff5a"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#a9ce89d0c80f40aeb7df69c5a49beff5a">sysio::producer_plugin_impl::on_incoming_block</a></div><div class="ttdeci">bool on_incoming_block(const signed_block_ptr &amp;block, const std::optional&lt; block_id_type &gt; &amp;block_id, const block_state_ptr &amp;bsp)</div><div class="ttdef"><b>Definition</b> <a href="#l00434">producer_plugin.cpp:434</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_aa3d9b96f6a6642c56f48dcd7919f1bee"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#aa3d9b96f6a6642c56f48dcd7919f1bee">sysio::producer_plugin_impl::_snapshots_dir</a></div><div class="ttdeci">bfs::path _snapshots_dir</div><div class="ttdef"><b>Definition</b> <a href="#l00375">producer_plugin.cpp:375</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_aa84d793aebf28b348def7afd484a4f1a"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#aa84d793aebf28b348def7afd484a4f1a">sysio::producer_plugin_impl::_last_block_time_offset_us</a></div><div class="ttdeci">int32_t _last_block_time_offset_us</div><div class="ttdef"><b>Definition</b> <a href="#l00330">producer_plugin.cpp:330</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_aad323427fd3fbc7d0decad90b324f44f"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#aad323427fd3fbc7d0decad90b324f44f">sysio::producer_plugin_impl::_received_block</a></div><div class="ttdeci">std::atomic&lt; bool &gt; _received_block</div><div class="ttdef"><b>Definition</b> <a href="#l00327">producer_plugin.cpp:327</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_ab031fc8338d68f086c7d183e7512c9ea"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#ab031fc8338d68f086c7d183e7512c9ea">sysio::producer_plugin_impl::_timer</a></div><div class="ttdeci">boost::asio::deadline_timer _timer</div><div class="ttdef"><b>Definition</b> <a href="#l00319">producer_plugin.cpp:319</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_ab05cac0064c3afeb991b8e91cb76631e"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#ab05cac0064c3afeb991b8e91cb76631e">sysio::producer_plugin_impl::block_is_exhausted</a></div><div class="ttdeci">bool block_is_exhausted() const</div><div class="ttdef"><b>Definition</b> <a href="#l02238">producer_plugin.cpp:2238</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_ab2a5cd86b46f7cac1891871a40cec1c1"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#ab2a5cd86b46f7cac1891871a40cec1c1">sysio::producer_plugin_impl::_max_scheduled_transaction_time_per_block_ms</a></div><div class="ttdeci">int32_t _max_scheduled_transaction_time_per_block_ms</div><div class="ttdef"><b>Definition</b> <a href="#l00333">producer_plugin.cpp:333</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_ab33cc5646289fa807b2344628d1f156e"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#ab33cc5646289fa807b2344628d1f156e">sysio::producer_plugin_impl::_options</a></div><div class="ttdeci">boost::program_options::variables_map _options</div><div class="ttdef"><b>Definition</b> <a href="#l00312">producer_plugin.cpp:312</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_ab57089953b20f4eac5adc247b73040ec"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#ab57089953b20f4eac5adc247b73040ec">sysio::producer_plugin_impl::restart_speculative_block</a></div><div class="ttdeci">void restart_speculative_block()</div><div class="ttdef"><b>Definition</b> <a href="#l00520">producer_plugin.cpp:520</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_ab8c4a74665eea98fed5866ee31b25d5a"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#ab8c4a74665eea98fed5866ee31b25d5a">sysio::producer_plugin_impl::_protocol_features_to_activate</a></div><div class="ttdeci">std::vector&lt; chain::digest_type &gt; _protocol_features_to_activate</div><div class="ttdef"><b>Definition</b> <a href="#l00340">producer_plugin.cpp:340</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_ab9ac82b1ebcd89332e08e4246fd0a973"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#ab9ac82b1ebcd89332e08e4246fd0a973">sysio::producer_plugin_impl::_unapplied_transactions</a></div><div class="ttdeci">unapplied_transaction_queue _unapplied_transactions</div><div class="ttdef"><b>Definition</b> <a href="#l00323">producer_plugin.cpp:323</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_abfe8262ebb5c1493c44e198ad3cd79ca"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#abfe8262ebb5c1493c44e198ad3cd79ca">sysio::producer_plugin_impl::_max_transaction_time_ms</a></div><div class="ttdeci">std::atomic&lt; int32_t &gt; _max_transaction_time_ms</div><div class="ttdef"><b>Definition</b> <a href="#l00326">producer_plugin.cpp:326</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_ac255e968852c91eee1583e4989df4173"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#ac255e968852c91eee1583e4989df4173">sysio::producer_plugin_impl::_thread_pool</a></div><div class="ttdeci">std::optional&lt; named_thread_pool &gt; _thread_pool</div><div class="ttdef"><b>Definition</b> <a href="#l00324">producer_plugin.cpp:324</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_ac33726be93d621d708c02acfe7fcfd56"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#ac33726be93d621d708c02acfe7fcfd56">sysio::producer_plugin_impl::abort_block</a></div><div class="ttdeci">void abort_block()</div><div class="ttdef"><b>Definition</b> <a href="#l00427">producer_plugin.cpp:427</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_ac8be366b39b451f59a5b2f2e4162f6cd"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#ac8be366b39b451f59a5b2f2e4162f6cd">sysio::producer_plugin_impl::_pending_snapshot_index</a></div><div class="ttdeci">pending_snapshot_index _pending_snapshot_index</div><div class="ttdef"><b>Definition</b> <a href="#l00351">producer_plugin.cpp:351</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_ad027592bd832fc428fc2056775487276"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#ad027592bd832fc428fc2056775487276">sysio::producer_plugin_impl::_max_block_cpu_usage_threshold_us</a></div><div class="ttdeci">uint32_t _max_block_cpu_usage_threshold_us</div><div class="ttdef"><b>Definition</b> <a href="#l00331">producer_plugin.cpp:331</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_ad2cccb2f7374b5446a61dc8b7610d4d6"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#ad2cccb2f7374b5446a61dc8b7610d4d6">sysio::producer_plugin_impl::_max_block_net_usage_threshold_bytes</a></div><div class="ttdeci">uint32_t _max_block_net_usage_threshold_bytes</div><div class="ttdef"><b>Definition</b> <a href="#l00332">producer_plugin.cpp:332</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_ad426992f015c5b8232753868f5edb366"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#ad426992f015c5b8232753868f5edb366">sysio::producer_plugin_impl::signature_provider_type</a></div><div class="ttdeci">std::function&lt; chain::signature_type(chain::digest_type)&gt; signature_provider_type</div><div class="ttdef"><b>Definition</b> <a href="#l00316">producer_plugin.cpp:316</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_ad44e89d30a1ce2b3abb85711d5342490"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#ad44e89d30a1ce2b3abb85711d5342490">sysio::producer_plugin_impl::_subjective_billing</a></div><div class="ttdeci">subjective_billing _subjective_billing</div><div class="ttdef"><b>Definition</b> <a href="#l00352">producer_plugin.cpp:352</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_ad6dd1910645f0e41a009f59fdfc09cb4"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#ad6dd1910645f0e41a009f59fdfc09cb4">sysio::producer_plugin_impl::chain_plug</a></div><div class="ttdeci">chain_plugin * chain_plug</div><div class="ttdef"><b>Definition</b> <a href="#l00343">producer_plugin.cpp:343</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_ad8895b72aaf8928b54665684ffdb9405"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#ad8895b72aaf8928b54665684ffdb9405">sysio::producer_plugin_impl::schedule_production_loop</a></div><div class="ttdeci">void schedule_production_loop()</div><div class="ttdef"><b>Definition</b> <a href="#l02255">producer_plugin.cpp:2255</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_ad9173229bf0922a5bd51150e1a95c58f"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#ad9173229bf0922a5bd51150e1a95c58f">sysio::producer_plugin_impl::_signature_providers</a></div><div class="ttdeci">std::map&lt; chain::public_key_type, signature_provider_type &gt; _signature_providers</div><div class="ttdef"><b>Definition</b> <a href="#l00317">producer_plugin.cpp:317</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_ada1bb26ba6b42b4307c20c6bdb2c49b6"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#ada1bb26ba6b42b4307c20c6bdb2c49b6">sysio::producer_plugin_impl::consider_new_watermark</a></div><div class="ttdeci">void consider_new_watermark(account_name producer, uint32_t block_num, block_timestamp_type timestamp)</div><div class="ttdef"><b>Definition</b> <a href="#l00377">producer_plugin.cpp:377</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_adc02b8bbfdf1e85f4bf2132db2c7510f"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#adc02b8bbfdf1e85f4bf2132db2c7510f">sysio::producer_plugin_impl::_max_irreversible_block_age_us</a></div><div class="ttdeci">fc::microseconds _max_irreversible_block_age_us</div><div class="ttdef"><b>Definition</b> <a href="#l00328">producer_plugin.cpp:328</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_ae781cd364031e6a3b5f890921f592eb6"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#ae781cd364031e6a3b5f890921f592eb6">sysio::producer_plugin_impl::_disable_subjective_api_billing</a></div><div class="ttdeci">bool _disable_subjective_api_billing</div><div class="ttdef"><b>Definition</b> <a href="#l00336">producer_plugin.cpp:336</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_ae9554f576751ba3ac762b0f0c85fa5f2"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#ae9554f576751ba3ac762b0f0c85fa5f2">sysio::producer_plugin_impl::_pending_block_mode</a></div><div class="ttdeci">pending_block_mode _pending_block_mode</div><div class="ttdef"><b>Definition</b> <a href="#l00322">producer_plugin.cpp:322</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_aef5ba3d2caaa3a9800a0cc0df02d03f7"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#aef5ba3d2caaa3a9800a0cc0df02d03f7">sysio::producer_plugin_impl::producer_watermark</a></div><div class="ttdeci">std::pair&lt; uint32_t, block_timestamp_type &gt; producer_watermark</div><div class="ttdef"><b>Definition</b> <a href="#l00320">producer_plugin.cpp:320</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_af2f69a8ae164570dd17a1f970ae611eb"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#af2f69a8ae164570dd17a1f970ae611eb">sysio::producer_plugin_impl::_producers</a></div><div class="ttdeci">std::set&lt; chain::account_name &gt; _producers</div><div class="ttdef"><b>Definition</b> <a href="#l00318">producer_plugin.cpp:318</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_af3690d3cd99a828ada60fcf3decad39b"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#af3690d3cd99a828ada60fcf3decad39b">sysio::producer_plugin_impl::process_scheduled_and_incoming_trxs</a></div><div class="ttdeci">void process_scheduled_and_incoming_trxs(const fc::time_point &amp;deadline, size_t &amp;pending_incoming_process_limit)</div><div class="ttdef"><b>Definition</b> <a href="#l02104">producer_plugin.cpp:2104</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_afc6b3109ff8bdf1d18200e54f5fcbf0f"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#afc6b3109ff8bdf1d18200e54f5fcbf0f">sysio::producer_plugin_impl::calculate_pending_block_time</a></div><div class="ttdeci">fc::time_point calculate_pending_block_time() const</div><div class="ttdef"><b>Definition</b> <a href="#l01656">producer_plugin.cpp:1656</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_afc937f75228984d541545dc4b59613a5"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#afc937f75228984d541545dc4b59613a5">sysio::producer_plugin_impl::_account_fails</a></div><div class="ttdeci">account_failures _account_fails</div><div class="ttdef"><b>Definition</b> <a href="#l00353">producer_plugin.cpp:353</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin__impl_html_afdc86b3838b1e0bc2d6667f9123d633e"><div class="ttname"><a href="classsysio_1_1producer__plugin__impl.html#afdc86b3838b1e0bc2d6667f9123d633e">sysio::producer_plugin_impl::get_pending_block_producer</a></div><div class="ttdeci">account_name get_pending_block_producer()</div><div class="ttdef"><b>Definition</b> <a href="#l00772">producer_plugin.cpp:772</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin_html_a091e6c32d2a7834be0d0a9b9b7fa061d"><div class="ttname"><a href="classsysio_1_1producer__plugin.html#a091e6c32d2a7834be0d0a9b9b7fa061d">sysio::producer_plugin::plugin_initialize</a></div><div class="ttdeci">virtual void plugin_initialize(const boost::program_options::variables_map &amp;options)</div><div class="ttdef"><b>Definition</b> <a href="#l00979">producer_plugin.cpp:979</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin_html_a218365f30a785fa430e8f91b9de78189"><div class="ttname"><a href="classsysio_1_1producer__plugin.html#a218365f30a785fa430e8f91b9de78189">sysio::producer_plugin::resume</a></div><div class="ttdeci">void resume()</div><div class="ttdef"><b>Definition</b> <a href="#l01253">producer_plugin.cpp:1253</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin_html_a2226fa914717572a10b768f4e124043d"><div class="ttname"><a href="classsysio_1_1producer__plugin.html#a2226fa914717572a10b768f4e124043d">sysio::producer_plugin::get_greylist</a></div><div class="ttdeci">greylist_params get_greylist() const</div><div class="ttdef"><b>Definition</b> <a href="#l01347">producer_plugin.cpp:1347</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin_html_a41c230f97593dcff3934fb6b6b254536"><div class="ttname"><a href="classsysio_1_1producer__plugin.html#a41c230f97593dcff3934fb6b6b254536">sysio::producer_plugin::set_program_options</a></div><div class="ttdeci">virtual void set_program_options(boost::program_options::options_description &amp;command_line_options, boost::program_options::options_description &amp;config_file_options) override</div><div class="ttdef"><b>Definition</b> <a href="#l00831">producer_plugin.cpp:831</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin_html_a4417c46bdc9109ea4b89cd1cc1a7754f"><div class="ttname"><a href="classsysio_1_1producer__plugin.html#a4417c46bdc9109ea4b89cd1cc1a7754f">sysio::producer_plugin::pause</a></div><div class="ttdeci">void pause()</div><div class="ttdef"><b>Definition</b> <a href="#l01248">producer_plugin.cpp:1248</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin_html_a58db07a465c2622e2135b2f2c69d678e"><div class="ttname"><a href="classsysio_1_1producer__plugin.html#a58db07a465c2622e2135b2f2c69d678e">sysio::producer_plugin::sign_compact</a></div><div class="ttdeci">chain::signature_type sign_compact(const chain::public_key_type &amp;key, const fc::sha256 &amp;digest) const</div><div class="ttdef"><b>Definition</b> <a href="#l00922">producer_plugin.cpp:922</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin_html_a593d5f1c1ffa7d1c66d6d5aec2b171d2"><div class="ttname"><a href="classsysio_1_1producer__plugin.html#a593d5f1c1ffa7d1c66d6d5aec2b171d2">sysio::producer_plugin::plugin_shutdown</a></div><div class="ttdeci">virtual void plugin_shutdown()</div><div class="ttdef"><b>Definition</b> <a href="#l01218">producer_plugin.cpp:1218</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin_html_a62c42eef3c18cf6d357411865399fe50"><div class="ttname"><a href="classsysio_1_1producer__plugin.html#a62c42eef3c18cf6d357411865399fe50">sysio::producer_plugin::create_snapshot</a></div><div class="ttdeci">void create_snapshot(next_function&lt; snapshot_information &gt; next)</div><div class="ttdef"><b>Definition</b> <a href="#l01402">producer_plugin.cpp:1402</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin_html_a6fc28177d3a114216ced04514066f7c5"><div class="ttname"><a href="classsysio_1_1producer__plugin.html#a6fc28177d3a114216ced04514066f7c5">sysio::producer_plugin::remove_greylist_accounts</a></div><div class="ttdeci">void remove_greylist_accounts(const greylist_params &amp;params)</div><div class="ttdef"><b>Definition</b> <a href="#l01338">producer_plugin.cpp:1338</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin_html_a7778d729b4a628fa3fdd5b07f1545c22"><div class="ttname"><a href="classsysio_1_1producer__plugin.html#a7778d729b4a628fa3fdd5b07f1545c22">sysio::producer_plugin::get_runtime_options</a></div><div class="ttdeci">runtime_options get_runtime_options() const</div><div class="ttdef"><b>Definition</b> <a href="#l01314">producer_plugin.cpp:1314</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin_html_a8f313f90e7d45e3a49735ad2f903d473"><div class="ttname"><a href="classsysio_1_1producer__plugin.html#a8f313f90e7d45e3a49735ad2f903d473">sysio::producer_plugin::paused</a></div><div class="ttdeci">bool paused() const</div><div class="ttdef"><b>Definition</b> <a href="#l01267">producer_plugin.cpp:1267</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin_html_a92b46a0e84fb207a04f56d4a75538381"><div class="ttname"><a href="classsysio_1_1producer__plugin.html#a92b46a0e84fb207a04f56d4a75538381">sysio::producer_plugin::is_producer_key</a></div><div class="ttdeci">bool is_producer_key(const chain::public_key_type &amp;key) const</div><div class="ttdef"><b>Definition</b> <a href="#l00909">producer_plugin.cpp:909</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin_html_a967d53a8cf3bd8aa79fdf07bf2603db6"><div class="ttname"><a href="classsysio_1_1producer__plugin.html#a967d53a8cf3bd8aa79fdf07bf2603db6">sysio::producer_plugin::add_greylist_accounts</a></div><div class="ttdeci">void add_greylist_accounts(const greylist_params &amp;params)</div><div class="ttdef"><b>Definition</b> <a href="#l01329">producer_plugin.cpp:1329</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin_html_a9c78e75e5222bbb493a5c1fb0919a9e2"><div class="ttname"><a href="classsysio_1_1producer__plugin.html#a9c78e75e5222bbb493a5c1fb0919a9e2">sysio::producer_plugin::handle_sighup</a></div><div class="ttdeci">void handle_sighup() override</div><div class="ttdef"><b>Definition</b> <a href="#l01239">producer_plugin.cpp:1239</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin_html_a9f76a5e68b573f82d45bc7ac602849b2"><div class="ttname"><a href="classsysio_1_1producer__plugin.html#a9f76a5e68b573f82d45bc7ac602849b2">sysio::producer_plugin::get_supported_protocol_features</a></div><div class="ttdeci">fc::variants get_supported_protocol_features(const get_supported_protocol_features_params &amp;params) const</div><div class="ttdef"><b>Definition</b> <a href="#l01514">producer_plugin.cpp:1514</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin_html_aa0f4bf0b390688408224d4bc36b74e27"><div class="ttname"><a href="classsysio_1_1producer__plugin.html#aa0f4bf0b390688408224d4bc36b74e27">sysio::producer_plugin::next_function</a></div><div class="ttdeci">std::function&lt; void(const std::variant&lt; fc::exception_ptr, T &gt; &amp;)&gt; next_function</div><div class="ttdef"><b>Definition</b> <a href="producer__plugin_8hpp_source.html#l00075">producer_plugin.hpp:75</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin_html_aa5393e35f92140aed36471f88a9ed524"><div class="ttname"><a href="classsysio_1_1producer__plugin.html#aa5393e35f92140aed36471f88a9ed524">sysio::producer_plugin::~producer_plugin</a></div><div class="ttdeci">virtual ~producer_plugin()</div><div class="ttdef"><b>Definition</b> <a href="#l00829">producer_plugin.cpp:829</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin_html_aa6791946464ae235bbef7112d6e86f5c"><div class="ttname"><a href="classsysio_1_1producer__plugin.html#aa6791946464ae235bbef7112d6e86f5c">sysio::producer_plugin::get_whitelist_blacklist</a></div><div class="ttdeci">whitelist_blacklist get_whitelist_blacklist() const</div><div class="ttdef"><b>Definition</b> <a href="#l01358">producer_plugin.cpp:1358</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin_html_abbf1adfe24d0f42fc9dbd3fe510897f7"><div class="ttname"><a href="classsysio_1_1producer__plugin.html#abbf1adfe24d0f42fc9dbd3fe510897f7">sysio::producer_plugin::schedule_protocol_feature_activations</a></div><div class="ttdeci">void schedule_protocol_feature_activations(const scheduled_protocol_feature_activations &amp;schedule)</div><div class="ttdef"><b>Definition</b> <a href="#l01496">producer_plugin.cpp:1496</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin_html_abd1ea873bb29c35ed22fbc7dcea2e9d6"><div class="ttname"><a href="classsysio_1_1producer__plugin.html#abd1ea873bb29c35ed22fbc7dcea2e9d6">sysio::producer_plugin::set_whitelist_blacklist</a></div><div class="ttdeci">void set_whitelist_blacklist(const whitelist_blacklist &amp;params)</div><div class="ttdef"><b>Definition</b> <a href="#l01370">producer_plugin.cpp:1370</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin_html_abd977a7c1a617285862313c25716569e"><div class="ttname"><a href="classsysio_1_1producer__plugin.html#abd977a7c1a617285862313c25716569e">sysio::producer_plugin::log_failed_transaction</a></div><div class="ttdeci">void log_failed_transaction(const transaction_id_type &amp;trx_id, const chain::packed_transaction_ptr &amp;packed_trx_ptr, const char *reason) const</div><div class="ttdef"><b>Definition</b> <a href="#l02494">producer_plugin.cpp:2494</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin_html_abf34033a4e4a5564fd2098ee7a1b733b"><div class="ttname"><a href="classsysio_1_1producer__plugin.html#abf34033a4e4a5564fd2098ee7a1b733b">sysio::producer_plugin::plugin_startup</a></div><div class="ttdeci">virtual void plugin_startup()</div><div class="ttdef"><b>Definition</b> <a href="#l01169">producer_plugin.cpp:1169</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin_html_ac07c0380efa6d1d4c60fb1c686888f67"><div class="ttname"><a href="classsysio_1_1producer__plugin.html#ac07c0380efa6d1d4c60fb1c686888f67">sysio::producer_plugin::get_subjective_bill</a></div><div class="ttdeci">int64_t get_subjective_bill(const account_name &amp;first_auth, const fc::time_point &amp;now) const</div><div class="ttdef"><b>Definition</b> <a href="#l00917">producer_plugin.cpp:917</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin_html_ace9a7e1a84839fe239eca95a230a92e3"><div class="ttname"><a href="classsysio_1_1producer__plugin.html#ace9a7e1a84839fe239eca95a230a92e3">sysio::producer_plugin::get_account_ram_corrections</a></div><div class="ttdeci">get_account_ram_corrections_result get_account_ram_corrections(const get_account_ram_corrections_params &amp;params) const</div><div class="ttdef"><b>Definition</b> <a href="#l01553">producer_plugin.cpp:1553</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin_html_ae697c5d94a3c6d02dab4a159ec9a30cb"><div class="ttname"><a href="classsysio_1_1producer__plugin.html#ae697c5d94a3c6d02dab4a159ec9a30cb">sysio::producer_plugin::received_block</a></div><div class="ttdeci">void received_block()</div><div class="ttdef"><b>Definition</b> <a href="#l02490">producer_plugin.cpp:2490</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin_html_af16be413ed6c398d92d38a52cab83525"><div class="ttname"><a href="classsysio_1_1producer__plugin.html#af16be413ed6c398d92d38a52cab83525">sysio::producer_plugin::update_runtime_options</a></div><div class="ttdeci">void update_runtime_options(const runtime_options &amp;options)</div><div class="ttdef"><b>Definition</b> <a href="#l01271">producer_plugin.cpp:1271</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin_html_afc97bb12a5dee32e1937588ba1262b13"><div class="ttname"><a href="classsysio_1_1producer__plugin.html#afc97bb12a5dee32e1937588ba1262b13">sysio::producer_plugin::get_scheduled_protocol_feature_activations</a></div><div class="ttdeci">scheduled_protocol_feature_activations get_scheduled_protocol_feature_activations() const</div><div class="ttdef"><b>Definition</b> <a href="#l01492">producer_plugin.cpp:1492</a></div></div>
<div class="ttc" id="aclasssysio_1_1producer__plugin_html_afd2baf0dede255eaaf9b95ed0aa7f3e4"><div class="ttname"><a href="classsysio_1_1producer__plugin.html#afd2baf0dede255eaaf9b95ed0aa7f3e4">sysio::producer_plugin::get_integrity_hash</a></div><div class="ttdeci">integrity_hash_information get_integrity_hash() const</div><div class="ttdef"><b>Definition</b> <a href="#l01385">producer_plugin.cpp:1385</a></div></div>
<div class="ttc" id="aclasssysio_1_1sub__chain__plugin_html"><div class="ttname"><a href="classsysio_1_1sub__chain__plugin.html">sysio::sub_chain_plugin</a></div><div class="ttdef"><b>Definition</b> <a href="sub__chain__plugin_8hpp_source.html#l00022">sub_chain_plugin.hpp:22</a></div></div>
<div class="ttc" id="aclasssysio_1_1sub__chain__plugin_html_aaac3c80301ede51c90d925992bc14c7c"><div class="ttname"><a href="classsysio_1_1sub__chain__plugin.html#aaac3c80301ede51c90d925992bc14c7c">sysio::sub_chain_plugin::find_relevant_transactions</a></div><div class="ttdeci">std::vector&lt; sysio::chain::transaction &gt; find_relevant_transactions(sysio::chain::controller &amp;curr_chain)</div><div class="ttdef"><b>Definition</b> <a href="sub__chain__plugin_8cpp_source.html#l00156">sub_chain_plugin.cpp:156</a></div></div>
<div class="ttc" id="aclasssysio_1_1subjective__billing_html"><div class="ttname"><a href="classsysio_1_1subjective__billing.html">sysio::subjective_billing</a></div><div class="ttdef"><b>Definition</b> <a href="subjective__billing_8hpp_source.html#l00025">subjective_billing.hpp:25</a></div></div>
<div class="ttc" id="aclasssysio_1_1subjective__billing_html_a23d4fafb3e774be584b5e23b3510bb0d"><div class="ttname"><a href="classsysio_1_1subjective__billing.html#a23d4fafb3e774be584b5e23b3510bb0d">sysio::subjective_billing::abort_block</a></div><div class="ttdeci">void abort_block()</div><div class="ttdef"><b>Definition</b> <a href="subjective__billing_8hpp_source.html#l00171">subjective_billing.hpp:171</a></div></div>
<div class="ttc" id="aclasssysio_1_1subjective__billing_html_a24c7829695461e95f71a1e209b3bda1f"><div class="ttname"><a href="classsysio_1_1subjective__billing.html#a24c7829695461e95f71a1e209b3bda1f">sysio::subjective_billing::get_subjective_bill</a></div><div class="ttdeci">int64_t get_subjective_bill(const account_name &amp;first_auth, const fc::time_point &amp;now) const</div><div class="ttdef"><b>Definition</b> <a href="subjective__billing_8hpp_source.html#l00148">subjective_billing.hpp:148</a></div></div>
<div class="ttc" id="aclasssysio_1_1subjective__billing_html_a443a458832b5c475272149ccb31db567"><div class="ttname"><a href="classsysio_1_1subjective__billing.html#a443a458832b5c475272149ccb31db567">sysio::subjective_billing::subjective_bill</a></div><div class="ttdeci">void subjective_bill(const transaction_id_type &amp;id, const fc::time_point &amp;expire, const account_name &amp;first_auth, const fc::microseconds &amp;elapsed, bool in_pending_block)</div><div class="ttdef"><b>Definition</b> <a href="subjective__billing_8hpp_source.html#l00120">subjective_billing.hpp:120</a></div></div>
<div class="ttc" id="aclasssysio_1_1subjective__billing_html_a50d2b20b8dc816f33f480062a24e074a"><div class="ttname"><a href="classsysio_1_1subjective__billing.html#a50d2b20b8dc816f33f480062a24e074a">sysio::subjective_billing::subjective_bill_failure</a></div><div class="ttdeci">void subjective_bill_failure(const account_name &amp;first_auth, const fc::microseconds &amp;elapsed, const fc::time_point &amp;now)</div><div class="ttdef"><b>Definition</b> <a href="subjective__billing_8hpp_source.html#l00139">subjective_billing.hpp:139</a></div></div>
<div class="ttc" id="aclasssysio_1_1subjective__billing_html_a793fb0f1fa545a9de1d117cc95f6fbdc"><div class="ttname"><a href="classsysio_1_1subjective__billing.html#a793fb0f1fa545a9de1d117cc95f6fbdc">sysio::subjective_billing::remove_expired</a></div><div class="ttdeci">bool remove_expired(fc::logger &amp;log, const fc::time_point &amp;pending_block_time, const fc::time_point &amp;now, Yield &amp;&amp;yield)</div><div class="ttdef"><b>Definition</b> <a href="subjective__billing_8hpp_source.html#l00184">subjective_billing.hpp:184</a></div></div>
<div class="ttc" id="aclasssysio_1_1subjective__billing_html_a7da6a0636378886a46193d41089149bc"><div class="ttname"><a href="classsysio_1_1subjective__billing.html#a7da6a0636378886a46193d41089149bc">sysio::subjective_billing::is_account_disabled</a></div><div class="ttdeci">bool is_account_disabled(const account_name &amp;a) const</div><div class="ttdef"><b>Definition</b> <a href="subjective__billing_8hpp_source.html#l00117">subjective_billing.hpp:117</a></div></div>
<div class="ttc" id="aclasssysio_1_1subjective__billing_html_aec76b593918a0e487d607afd7a7fbe4a"><div class="ttname"><a href="classsysio_1_1subjective__billing.html#aec76b593918a0e487d607afd7a7fbe4a">sysio::subjective_billing::on_block</a></div><div class="ttdeci">void on_block(fc::logger &amp;log, const block_state_ptr &amp;bsp, const fc::time_point &amp;now)</div><div class="ttdef"><b>Definition</b> <a href="subjective__billing_8hpp_source.html#l00175">subjective_billing.hpp:175</a></div></div>
<div class="ttc" id="aclasssysio_1_1wrap_html"><div class="ttname"><a href="classsysio_1_1wrap.html">sysio::wrap</a></div><div class="ttdef"><b>Definition</b> <a href="sysio_8wrap_8hpp_source.html#l00015">sysio.wrap.hpp:15</a></div></div>
<div class="ttc" id="acode__cache_8cpp_html_aa0efefe21f4700d78692edc823e763be"><div class="ttname"><a href="code__cache_8cpp.html#aa0efefe21f4700d78692edc823e763be">id</a></div><div class="ttdeci">uint64_t id</div><div class="ttdef"><b>Definition</b> <a href="code__cache_8cpp_source.html#l00000">code_cache.cpp:0</a></div></div>
<div class="ttc" id="aexception_8hpp_html_a094902280cad82ad6529ebbd12a697eb"><div class="ttname"><a href="exception_8hpp.html#a094902280cad82ad6529ebbd12a697eb">FC_CAPTURE_AND_RETHROW</a></div><div class="ttdeci">#define FC_CAPTURE_AND_RETHROW(...)</div><div class="ttdef"><b>Definition</b> <a href="exception_8hpp_source.html#l00523">exception.hpp:523</a></div></div>
<div class="ttc" id="aexception_8hpp_html_ae70bfa24f5a3bc0917382b3c17fc033c"><div class="ttname"><a href="exception_8hpp.html#ae70bfa24f5a3bc0917382b3c17fc033c">FC_LOG_AND_RETHROW</a></div><div class="ttdeci">#define FC_LOG_AND_RETHROW()</div><div class="ttdef"><b>Definition</b> <a href="exception_8hpp_source.html#l00411">exception.hpp:411</a></div></div>
<div class="ttc" id="agenerated__transaction__object_8hpp_html"><div class="ttname"><a href="generated__transaction__object_8hpp.html">generated_transaction_object.hpp</a></div></div>
<div class="ttc" id="aglobal__property__object_8hpp_html"><div class="ttname"><a href="global__property__object_8hpp.html">global_property_object.hpp</a></div></div>
<div class="ttc" id="agmock__stress__test_8cc_html_afd9db40e3361ae09188795e8cbe19752"><div class="ttname"><a href="gmock__stress__test_8cc.html#afd9db40e3361ae09188795e8cbe19752">count</a></div><div class="ttdeci">int * count</div><div class="ttdef"><b>Definition</b> <a href="gmock__stress__test_8cc_source.html#l00177">gmock_stress_test.cc:177</a></div></div>
<div class="ttc" id="ajson_8hpp_html"><div class="ttname"><a href="json_8hpp.html">json.hpp</a></div></div>
<div class="ttc" id="alog__message_8hpp_html_a4a4df4bb5cffbe07aadf7d29fd44c75e"><div class="ttname"><a href="log__message_8hpp.html#a4a4df4bb5cffbe07aadf7d29fd44c75e">FC_LOG_MESSAGE</a></div><div class="ttdeci">#define FC_LOG_MESSAGE(LOG_LEVEL, FORMAT,...)</div><div class="ttdoc">A helper method for generating log messages.</div><div class="ttdef"><b>Definition</b> <a href="log__message_8hpp_source.html#l00165">log_message.hpp:165</a></div></div>
<div class="ttc" id="alogger_8hpp_html_a067e87b091ade3787bcdda5775354654"><div class="ttname"><a href="logger_8hpp.html#a067e87b091ade3787bcdda5775354654">fc_ilog</a></div><div class="ttdeci">#define fc_ilog(LOGGER, FORMAT,...)</div><div class="ttdef"><b>Definition</b> <a href="logger_8hpp_source.html#l00083">logger.hpp:83</a></div></div>
<div class="ttc" id="alogger_8hpp_html_a1759e5c9691d8ad754bdf5eff8bb23ac"><div class="ttname"><a href="logger_8hpp.html#a1759e5c9691d8ad754bdf5eff8bb23ac">wlog</a></div><div class="ttdeci">#define wlog(FORMAT,...)</div><div class="ttdef"><b>Definition</b> <a href="logger_8hpp_source.html#l00124">logger.hpp:124</a></div></div>
<div class="ttc" id="alogger_8hpp_html_a26aaf645dd9dc96836635d6b18bd1090"><div class="ttname"><a href="logger_8hpp.html#a26aaf645dd9dc96836635d6b18bd1090">edump</a></div><div class="ttdeci">#define edump(SEQ)</div><div class="ttdef"><b>Definition</b> <a href="logger_8hpp_source.html#l00162">logger.hpp:162</a></div></div>
<div class="ttc" id="alogger_8hpp_html_a3da1571bad6ca6c94df9a3660b2115ee"><div class="ttname"><a href="logger_8hpp.html#a3da1571bad6ca6c94df9a3660b2115ee">dlog</a></div><div class="ttdeci">#define dlog(FORMAT,...)</div><div class="ttdef"><b>Definition</b> <a href="logger_8hpp_source.html#l00101">logger.hpp:101</a></div></div>
<div class="ttc" id="alogger_8hpp_html_a831cf08dc63704c11fd154132c6e8bdb"><div class="ttname"><a href="logger_8hpp.html#a831cf08dc63704c11fd154132c6e8bdb">ilog</a></div><div class="ttdeci">#define ilog(FORMAT,...)</div><div class="ttdef"><b>Definition</b> <a href="logger_8hpp_source.html#l00118">logger.hpp:118</a></div></div>
<div class="ttc" id="alogger_8hpp_html_a9e3cdbaecd5a34b42956e888f7326fad"><div class="ttname"><a href="logger_8hpp.html#a9e3cdbaecd5a34b42956e888f7326fad">elog</a></div><div class="ttdeci">#define elog(FORMAT,...)</div><div class="ttdef"><b>Definition</b> <a href="logger_8hpp_source.html#l00130">logger.hpp:130</a></div></div>
<div class="ttc" id="alogger_8hpp_html_af3086372b1da6bfce45ff871734f2e8d"><div class="ttname"><a href="logger_8hpp.html#af3086372b1da6bfce45ff871734f2e8d">fc_wlog</a></div><div class="ttdeci">#define fc_wlog(LOGGER, FORMAT,...)</div><div class="ttdef"><b>Definition</b> <a href="logger_8hpp_source.html#l00089">logger.hpp:89</a></div></div>
<div class="ttc" id="alogger_8hpp_html_af5adfcda7e0a01306256754a6511915d"><div class="ttname"><a href="logger_8hpp.html#af5adfcda7e0a01306256754a6511915d">fc_dlog</a></div><div class="ttdeci">#define fc_dlog(LOGGER, FORMAT,...)</div><div class="ttdef"><b>Definition</b> <a href="logger_8hpp_source.html#l00077">logger.hpp:77</a></div></div>
<div class="ttc" id="alogger__config_8hpp_html"><div class="ttname"><a href="logger__config_8hpp.html">logger_config.hpp</a></div></div>
<div class="ttc" id="anamespaceappbase_html_a99374dc23934f008a09f2f79be9eae40"><div class="ttname"><a href="namespaceappbase.html#a99374dc23934f008a09f2f79be9eae40">appbase::app</a></div><div class="ttdeci">application &amp; app()</div><div class="ttdef"><b>Definition</b> <a href="application_8cpp_source.html#l00210">application.cpp:210</a></div></div>
<div class="ttc" id="anamespacefc_html_a150ca4cd9c0318ca45dc0dc7df5d58b9"><div class="ttname"><a href="namespacefc.html#a150ca4cd9c0318ca45dc0dc7df5d58b9">fc::digest</a></div><div class="ttdeci">fc::sha256 digest(const T &amp;value)</div><div class="ttdef"><b>Definition</b> <a href="digest_8hpp_source.html#l00009">digest.hpp:9</a></div></div>
<div class="ttc" id="anamespacefc_html_a15170d1be1e682691dfe6ae09790edce"><div class="ttname"><a href="namespacefc.html#a15170d1be1e682691dfe6ae09790edce">fc::exception_ptr</a></div><div class="ttdeci">std::shared_ptr&lt; exception &gt; exception_ptr</div><div class="ttdef"><b>Definition</b> <a href="exception_8hpp_source.html#l00139">exception.hpp:139</a></div></div>
<div class="ttc" id="anamespacefc_html_a219cf01fcfa97b5eac3acb755e8177e0"><div class="ttname"><a href="namespacefc.html#a219cf01fcfa97b5eac3acb755e8177e0">fc::ostring</a></div><div class="ttdeci">std::optional&lt; fc::string &gt; ostring</div><div class="ttdef"><b>Definition</b> <a href="url_8hpp_source.html#l00010">url.hpp:10</a></div></div>
<div class="ttc" id="anamespacefc_html_a23d89b54a8ffd84f7e7efeb21747d846"><div class="ttname"><a href="namespacefc.html#a23d89b54a8ffd84f7e7efeb21747d846">fc::make_scoped_exit</a></div><div class="ttdeci">scoped_exit&lt; Callback &gt; make_scoped_exit(Callback &amp;&amp;c)</div><div class="ttdef"><b>Definition</b> <a href="scoped__exit_8hpp_source.html#l00035">scoped_exit.hpp:35</a></div></div>
<div class="ttc" id="anamespacefc_html_a3a1a89eb370c7c0b0c7cf9bfa0bb0c71"><div class="ttname"><a href="namespacefc.html#a3a1a89eb370c7c0b0c7cf9bfa0bb0c71">fc::params</a></div><div class="ttdeci">sysio::chain_apis::account_query_db::get_accounts_by_authorizers_params params</div><div class="ttdef"><b>Definition</b> <a href="account__query__db_8hpp_source.html#l00091">account_query_db.hpp:91</a></div></div>
<div class="ttc" id="anamespacefc_html_a3d8a2be677709cc41f09aa7925f2d55fad6bcd1364809e1b881bb22334d14cd56"><div class="ttname"><a href="namespacefc.html#a3d8a2be677709cc41f09aa7925f2d55fad6bcd1364809e1b881bb22334d14cd56">fc::read_only</a></div><div class="ttdeci">@ read_only</div><div class="ttdef"><b>Definition</b> <a href="file__mapping_8hpp_source.html#l00013">file_mapping.hpp:13</a></div></div>
<div class="ttc" id="anamespacefc_html_a3fcf0d920aea28014aacae50a51d8485"><div class="ttname"><a href="namespacefc.html#a3fcf0d920aea28014aacae50a51d8485">fc::exists</a></div><div class="ttdeci">bool exists(const path &amp;p)</div><div class="ttdef"><b>Definition</b> <a href="filesystem_8cpp_source.html#l00217">filesystem.cpp:217</a></div></div>
<div class="ttc" id="anamespacefc_html_a4e07b3870aa72f8c38bdd5f78044dad1"><div class="ttname"><a href="namespacefc.html#a4e07b3870aa72f8c38bdd5f78044dad1">fc::to_string</a></div><div class="ttdeci">fc::string to_string(double)</div><div class="ttdef"><b>Definition</b> <a href="string_8cpp_source.html#l00131">string.cpp:131</a></div></div>
<div class="ttc" id="anamespacefc_html_a6855142912d4cfb89281ba0c7f4938a2"><div class="ttname"><a href="namespacefc.html#a6855142912d4cfb89281ba0c7f4938a2">fc::is_regular_file</a></div><div class="ttdeci">bool is_regular_file(const path &amp;p)</div><div class="ttdef"><b>Definition</b> <a href="filesystem_8cpp_source.html#l00226">filesystem.cpp:226</a></div></div>
<div class="ttc" id="anamespacefc_html_a76ae235ec7e9b8862e70740058d7eb1b"><div class="ttname"><a href="namespacefc.html#a76ae235ec7e9b8862e70740058d7eb1b">fc::milliseconds</a></div><div class="ttdeci">constexpr microseconds milliseconds(int64_t s)</div><div class="ttdef"><b>Definition</b> <a href="include_2fc_2time_8hpp_source.html#l00033">time.hpp:33</a></div></div>
<div class="ttc" id="anamespacefc_html_a76b0787468a9f403087b71a894c07ce2"><div class="ttname"><a href="namespacefc.html#a76b0787468a9f403087b71a894c07ce2">fc::create_directories</a></div><div class="ttdeci">void create_directories(const path &amp;p)</div><div class="ttdef"><b>Definition</b> <a href="filesystem_8cpp_source.html#l00218">filesystem.cpp:218</a></div></div>
<div class="ttc" id="anamespacefc_html_a9148361f6aaa3d739990a75ac557fe59"><div class="ttname"><a href="namespacefc.html#a9148361f6aaa3d739990a75ac557fe59">fc::variants</a></div><div class="ttdeci">std::vector&lt; fc::variant &gt; variants</div><div class="ttdef"><b>Definition</b> <a href="fc_2include_2fc_2variant_8hpp_source.html#l00173">variant.hpp:173</a></div></div>
<div class="ttc" id="anamespacefc_html_a9623b8cae3f48bbed6aa1fc2afe9b174"><div class="ttname"><a href="namespacefc.html#a9623b8cae3f48bbed6aa1fc2afe9b174">fc::seconds</a></div><div class="ttdeci">constexpr microseconds seconds(int64_t s)</div><div class="ttdef"><b>Definition</b> <a href="include_2fc_2time_8hpp_source.html#l00032">time.hpp:32</a></div></div>
<div class="ttc" id="anamespacefc_html_a97da71aef0dc7bf1196351036e688886"><div class="ttname"><a href="namespacefc.html#a97da71aef0dc7bf1196351036e688886">fc::ovariant_object</a></div><div class="ttdeci">std::optional&lt; fc::variant_object &gt; ovariant_object</div><div class="ttdef"><b>Definition</b> <a href="url_8hpp_source.html#l00012">url.hpp:12</a></div></div>
<div class="ttc" id="anamespacefc_html_a9c3f2826ca2b6652fcef4da96f33503a"><div class="ttname"><a href="namespacefc.html#a9c3f2826ca2b6652fcef4da96f33503a">fc::minutes</a></div><div class="ttdeci">constexpr microseconds minutes(int64_t m)</div><div class="ttdef"><b>Definition</b> <a href="include_2fc_2time_8hpp_source.html#l00034">time.hpp:34</a></div></div>
<div class="ttc" id="anamespacefc_html_ab123bfeadf918cc293ecad88bca7c499"><div class="ttname"><a href="namespacefc.html#ab123bfeadf918cc293ecad88bca7c499">fc::is_directory</a></div><div class="ttdeci">bool is_directory(const path &amp;p)</div><div class="ttdef"><b>Definition</b> <a href="filesystem_8cpp_source.html#l00225">filesystem.cpp:225</a></div></div>
<div class="ttc" id="anamespacefc_html_ab52b42f18c442a260897c74c66c3d35c"><div class="ttname"><a href="namespacefc.html#ab52b42f18c442a260897c74c66c3d35c">fc::exception_code</a></div><div class="ttdeci">exception_code</div><div class="ttdef"><b>Definition</b> <a href="exception_8hpp_source.html#l00017">exception.hpp:18</a></div></div>
<div class="ttc" id="anamespacefc_html_acd5129981ae93fce3154d3fed6f6acbc"><div class="ttname"><a href="namespacefc.html#acd5129981ae93fce3154d3fed6f6acbc">fc::format_string</a></div><div class="ttdeci">fc::string format_string(const fc::string &amp;, const variant_object &amp;, bool minimize=false)</div><div class="ttdef"><b>Definition</b> <a href="variant_8cpp_source.html#l00773">variant.cpp:773</a></div></div>
<div class="ttc" id="anamespacefc_html_adea61f2343de94d0fbcb920a32332ad9"><div class="ttname"><a href="namespacefc.html#adea61f2343de94d0fbcb920a32332ad9">fc::to_variant</a></div><div class="ttdeci">void to_variant(const sysio::chain::shared_public_key &amp;var, fc::variant &amp;vo)</div><div class="ttdef"><b>Definition</b> <a href="authority_8cpp_source.html#l00004">authority.cpp:4</a></div></div>
<div class="ttc" id="anamespacestd_html_abb7e41c7063536ff6eeee4bb5f66de6c"><div class="ttname"><a href="namespacestd.html#abb7e41c7063536ff6eeee4bb5f66de6c">std::swap</a></div><div class="ttdeci">void swap(picojson::value &amp;x, picojson::value &amp;y)</div><div class="ttdef"><b>Definition</b> <a href="spec__test__generator_8cpp_source.html#l01094">spec_test_generator.cpp:1094</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_1_1plugin__interface_html"><div class="ttname"><a href="namespacesysio_1_1chain_1_1plugin__interface.html">sysio::chain::plugin_interface</a></div><div class="ttdef"><b>Definition</b> <a href="plugin__interface_8hpp_source.html#l00011">plugin_interface.hpp:11</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_1_1plugin__interface_html_a6ed984ecf76e4d360d5b142d27004c80"><div class="ttname"><a href="namespacesysio_1_1chain_1_1plugin__interface.html#a6ed984ecf76e4d360d5b142d27004c80">sysio::chain::plugin_interface::next_function</a></div><div class="ttdeci">std::function&lt; void(const std::variant&lt; fc::exception_ptr, T &gt; &amp;)&gt; next_function</div><div class="ttdef"><b>Definition</b> <a href="plugin__interface_8hpp_source.html#l00016">plugin_interface.hpp:16</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html"><div class="ttname"><a href="namespacesysio_1_1chain.html">sysio::chain</a></div><div class="ttdef"><b>Definition</b> <a href="abi__serializer_8cpp_source.html#l00008">abi_serializer.cpp:8</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_a0628a11f388cd2e43b1ccc1260a1042f"><div class="ttname"><a href="namespacesysio_1_1chain.html#a0628a11f388cd2e43b1ccc1260a1042f">sysio::chain::public_key_type</a></div><div class="ttdeci">fc::crypto::public_key public_key_type</div><div class="ttdef"><b>Definition</b> <a href="chain_2include_2sysio_2chain_2types_8hpp_source.html#l00076">types.hpp:76</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_a11965fc424809ea1802175f8b36ae4e5"><div class="ttname"><a href="namespacesysio_1_1chain.html#a11965fc424809ea1802175f8b36ae4e5">sysio::chain::block_timestamp_type</a></div><div class="ttdeci">block_timestamp&lt; config::block_interval_ms, config::block_timestamp_epoch &gt; block_timestamp_type</div><div class="ttdef"><b>Definition</b> <a href="block__timestamp_8hpp_source.html#l00075">block_timestamp.hpp:75</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_a3b287e6c2d3717609273c999ef660dea"><div class="ttname"><a href="namespacesysio_1_1chain.html#a3b287e6c2d3717609273c999ef660dea">sysio::chain::branch_type</a></div><div class="ttdeci">deque&lt; block_state_ptr &gt; branch_type</div><div class="ttdef"><b>Definition</b> <a href="block__state_8hpp_source.html#l00068">block_state.hpp:68</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_a4c900d23edfaeb9e6e25aa3a21e0ab4b"><div class="ttname"><a href="namespacesysio_1_1chain.html#a4c900d23edfaeb9e6e25aa3a21e0ab4b">sysio::chain::account_ram_correction_index</a></div><div class="ttdeci">chainbase::shared_multi_index_container&lt; account_ram_correction_object, indexed_by&lt; ordered_unique&lt; tag&lt; by_id &gt;, member&lt; account_ram_correction_object, account_ram_correction_object::id_type, &amp;account_ram_correction_object::id &gt; &gt;, ordered_unique&lt; tag&lt; by_name &gt;, member&lt; account_ram_correction_object, account_name, &amp;account_ram_correction_object::name &gt; &gt; &gt; &gt; account_ram_correction_index</div><div class="ttdef"><b>Definition</b> <a href="account__object_8hpp_source.html#l00093">account_object.hpp:93</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_a646553a6af0a730cdb19b9c6023d5132"><div class="ttname"><a href="namespacesysio_1_1chain.html#a646553a6af0a730cdb19b9c6023d5132">sysio::chain::guard_exception</a></div><div class="ttdeci">key Invalid authority Invalid transaction Invalid block ID Invalid packed transaction Invalid chain ID Invalid symbol Signature type is not a currently activated type Block can not be found Unlinkable block Block does not guarantee concurrent execution without conflicts Block exhausted allowed resources Block is from the future Block is not signed by expected producer Block includes an ill formed protocol feature activation extension Block includes an ill formed additional block signature extension Error decompressing transaction Transaction should have at least one required authority Expired Transaction Invalid Reference Block Duplicate deferred transaction The transaction can not be found Transaction is too big Invalid transaction extension Transaction includes disallowed Transaction exceeded transient resource limit Account name already exists sysio_assert_message assertion failure Action can not be found Attempt to use unaccessible API Inline Action exceeds maximum size limit sysio_assert_code assertion failure uses restricted error code value action return value size too big Permission Query Exception Contract Table Query Exception Database is an unknown or unsupported version guard_exception</div><div class="ttdef"><b>Definition</b> <a href="chain_2include_2sysio_2chain_2exceptions_8hpp_source.html#l00328">exceptions.hpp:328</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_a7041c0316bd294d0866609ab3e0cc7a7"><div class="ttname"><a href="namespacesysio_1_1chain.html#a7041c0316bd294d0866609ab3e0cc7a7">sysio::chain::packed_transaction_ptr</a></div><div class="ttdeci">std::shared_ptr&lt; const packed_transaction &gt; packed_transaction_ptr</div><div class="ttdef"><b>Definition</b> <a href="transaction_8hpp_source.html#l00214">transaction.hpp:214</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_a7d207c8c6bf978826102eca76da530e0aba7de5bc6888294e5884b024a4c894f1"><div class="ttname"><a href="namespacesysio_1_1chain.html#a7d207c8c6bf978826102eca76da530e0aba7de5bc6888294e5884b024a4c894f1">sysio::chain::validation_mode::FULL</a></div><div class="ttdeci">@ FULL</div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_a9e9842ee49526c2423e014a696edc602"><div class="ttname"><a href="namespacesysio_1_1chain.html#a9e9842ee49526c2423e014a696edc602">sysio::chain::generated_transaction_multi_index</a></div><div class="ttdeci">chainbase::shared_multi_index_container&lt; generated_transaction_object, indexed_by&lt; ordered_unique&lt; tag&lt; by_id &gt;, BOOST_MULTI_INDEX_MEMBER(generated_transaction_object, generated_transaction_object::id_type, id)&gt;, ordered_unique&lt; tag&lt; by_trx_id &gt;, BOOST_MULTI_INDEX_MEMBER(generated_transaction_object, transaction_id_type, trx_id)&gt;, ordered_unique&lt; tag&lt; by_expiration &gt;, composite_key&lt; generated_transaction_object, BOOST_MULTI_INDEX_MEMBER(generated_transaction_object, time_point, expiration), &gt; &gt;, ordered_unique&lt; tag&lt; by_delay &gt;, composite_key&lt; generated_transaction_object, BOOST_MULTI_INDEX_MEMBER(generated_transaction_object, time_point, delay_until), &gt; &gt;, ordered_unique&lt; tag&lt; by_sender_id &gt;, composite_key&lt; generated_transaction_object, BOOST_MULTI_INDEX_MEMBER(generated_transaction_object, account_name, sender), &gt; &gt; &gt; &gt; generated_transaction_multi_index</div><div class="ttdef"><b>Definition</b> <a href="generated__transaction__object_8hpp_source.html#l00052">generated_transaction_object.hpp:52</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_aa10ee348c57604b615bc8570f6685102"><div class="ttname"><a href="namespacesysio_1_1chain.html#aa10ee348c57604b615bc8570f6685102">sysio::chain::signed_block_ptr</a></div><div class="ttdeci">std::shared_ptr&lt; signed_block &gt; signed_block_ptr</div><div class="ttdef"><b>Definition</b> <a href="block_8hpp_source.html#l00105">block.hpp:105</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_ab9b14f4554cc4a0da2c361e9757b1662"><div class="ttname"><a href="namespacesysio_1_1chain.html#ab9b14f4554cc4a0da2c361e9757b1662">sysio::chain::block_state_ptr</a></div><div class="ttdeci">std::shared_ptr&lt; block_state &gt; block_state_ptr</div><div class="ttdef"><b>Definition</b> <a href="block__state_8hpp_source.html#l00067">block_state.hpp:67</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_ac31c0e1bc25b7e5fcf2b3c7f41a23fd6"><div class="ttname"><a href="namespacesysio_1_1chain.html#ac31c0e1bc25b7e5fcf2b3c7f41a23fd6">sysio::chain::private_key_type</a></div><div class="ttdeci">fc::crypto::private_key private_key_type</div><div class="ttdef"><b>Definition</b> <a href="chain_2include_2sysio_2chain_2types_8hpp_source.html#l00077">types.hpp:77</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_ac32ce8e75243f2b3f76aff0c1984f11b"><div class="ttname"><a href="namespacesysio_1_1chain.html#ac32ce8e75243f2b3f76aff0c1984f11b">sysio::chain::account_name</a></div><div class="ttdeci">name account_name</div><div class="ttdef"><b>Definition</b> <a href="chain_2include_2sysio_2chain_2types_8hpp_source.html#l00120">types.hpp:120</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_acad19c1ca23d796138841046c67b3ea9"><div class="ttname"><a href="namespacesysio_1_1chain.html#acad19c1ca23d796138841046c67b3ea9">sysio::chain::fork_database_exception</a></div><div class="ttdeci">key Invalid authority Invalid transaction Invalid block ID Invalid packed transaction Invalid chain ID Invalid symbol Signature type is not a currently activated type fork_database_exception</div><div class="ttdef"><b>Definition</b> <a href="chain_2include_2sysio_2chain_2exceptions_8hpp_source.html#l00205">exceptions.hpp:205</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_ad795329e0af850251f4f47cc32e8d770"><div class="ttname"><a href="namespacesysio_1_1chain.html#ad795329e0af850251f4f47cc32e8d770">sysio::chain::transaction_metadata_ptr</a></div><div class="ttdeci">std::shared_ptr&lt; transaction_metadata &gt; transaction_metadata_ptr</div><div class="ttdef"><b>Definition</b> <a href="transaction__metadata_8hpp_source.html#l00014">transaction_metadata.hpp:14</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_af141a69eb789b86fa0eb93c2d263f0df"><div class="ttname"><a href="namespacesysio_1_1chain.html#af141a69eb789b86fa0eb93c2d263f0df">sysio::chain::signature_type</a></div><div class="ttdeci">fc::crypto::signature signature_type</div><div class="ttdef"><b>Definition</b> <a href="chain_2include_2sysio_2chain_2types_8hpp_source.html#l00078">types.hpp:78</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_af3e35f3e1b78dd00fa247009a2d9ba5ea26ca3b6826ca765f741f39ec4754d581"><div class="ttname"><a href="namespacesysio_1_1chain.html#af3e35f3e1b78dd00fa247009a2d9ba5ea26ca3b6826ca765f741f39ec4754d581">sysio::chain::db_read_mode::SPECULATIVE</a></div><div class="ttdeci">@ SPECULATIVE</div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_affd9603ab5a713a9762157b12c8f6b9b"><div class="ttname"><a href="namespacesysio_1_1chain.html#affd9603ab5a713a9762157b12c8f6b9b">sysio::chain::trx_enum_type</a></div><div class="ttdeci">trx_enum_type</div><div class="ttdef"><b>Definition</b> <a href="unapplied__transaction__queue_8hpp_source.html#l00022">unapplied_transaction_queue.hpp:22</a></div></div>
<div class="ttc" id="anamespacesysio_html"><div class="ttname"><a href="namespacesysio.html">sysio</a></div><div class="ttdef"><b>Definition</b> <a href="abi__serializer_8cpp_source.html#l00008">abi_serializer.cpp:8</a></div></div>
<div class="ttc" id="anamespacesysio_html_a141379c7defda83a80367f716ab4f78b"><div class="ttname"><a href="namespacesysio.html#a141379c7defda83a80367f716ab4f78b">sysio::pending_snapshot_index</a></div><div class="ttdeci">multi_index_container&lt; pending_snapshot, indexed_by&lt; hashed_unique&lt; tag&lt; by_id &gt;, BOOST_MULTI_INDEX_MEMBER(pending_snapshot, block_id_type, block_id)&gt;, ordered_non_unique&lt; tag&lt; by_height &gt;, BOOST_MULTI_INDEX_CONST_MEM_FUN(pending_snapshot, uint32_t, get_height)&gt; &gt; &gt; pending_snapshot_index</div><div class="ttdef"><b>Definition</b> <a href="#l00177">producer_plugin.cpp:177</a></div></div>
<div class="ttc" id="anamespacesysio_html_a3da8a6a29b9db34a4eb5170317d0b5a5"><div class="ttname"><a href="namespacesysio.html#a3da8a6a29b9db34a4eb5170317d0b5a5">sysio::transaction_id_with_expiry_index</a></div><div class="ttdeci">multi_index_container&lt; transaction_id_with_expiry, indexed_by&lt; hashed_unique&lt; tag&lt; by_id &gt;, BOOST_MULTI_INDEX_MEMBER(transaction_id_with_expiry, transaction_id_type, trx_id)&gt;, ordered_non_unique&lt; tag&lt; by_expiry &gt;, BOOST_MULTI_INDEX_MEMBER(transaction_id_with_expiry, fc::time_point, expiry)&gt; &gt; &gt; transaction_id_with_expiry_index</div><div class="ttdef"><b>Definition</b> <a href="#l00112">producer_plugin.cpp:112</a></div></div>
<div class="ttc" id="anamespacesysio_html_a57a25df07ccdce01a63d0b026d80ea5f"><div class="ttname"><a href="namespacesysio.html#a57a25df07ccdce01a63d0b026d80ea5f">sysio::dejsonify</a></div><div class="ttdeci">T dejsonify(const string &amp;s)</div><div class="ttdef"><b>Definition</b> <a href="net__plugin_8cpp_source.html#l03592">net_plugin.cpp:3592</a></div></div>
<div class="ttc" id="anamespacesysio_html_a5c18cd9d34b8c5d3af8e2de75577673fa1f42b089b0bc1105b38f19140a65cc2a"><div class="ttname"><a href="namespacesysio.html#a5c18cd9d34b8c5d3af8e2de75577673fa1f42b089b0bc1105b38f19140a65cc2a">sysio::self</a></div><div class="ttdeci">@ self</div><div class="ttdoc">the connection is to itself</div><div class="ttdef"><b>Definition</b> <a href="plugins_2net__plugin_2include_2sysio_2net__plugin_2protocol_8hpp_source.html#l00048">protocol.hpp:48</a></div></div>
<div class="ttc" id="anamespacesysio_html_acd1c637e1a22040dbf666b0301cbc475"><div class="ttname"><a href="namespacesysio.html#acd1c637e1a22040dbf666b0301cbc475">sysio::pending_block_mode</a></div><div class="ttdeci">pending_block_mode</div><div class="ttdef"><b>Definition</b> <a href="#l00185">producer_plugin.cpp:185</a></div></div>
<div class="ttc" id="anamespacesysio_html_acd1c637e1a22040dbf666b0301cbc475aa25b9b4361a3bd215c739cf4f9cf2e4a"><div class="ttname"><a href="namespacesysio.html#acd1c637e1a22040dbf666b0301cbc475aa25b9b4361a3bd215c739cf4f9cf2e4a">sysio::pending_block_mode::speculating</a></div><div class="ttdeci">@ speculating</div></div>
<div class="ttc" id="anamespacesysio_html_acd1c637e1a22040dbf666b0301cbc475afd75fc8d5de6f56947b1afc9e44ddb5f"><div class="ttname"><a href="namespacesysio.html#acd1c637e1a22040dbf666b0301cbc475afd75fc8d5de6f56947b1afc9e44ddb5f">sysio::pending_block_mode::producing</a></div><div class="ttdeci">@ producing</div></div>
<div class="ttc" id="anamespacesysio_html_ad66b67a8dd0a897a0a5b89f954fd3ade"><div class="ttname"><a href="namespacesysio.html#ad66b67a8dd0a897a0a5b89f954fd3ade">sysio::logger_name</a></div><div class="ttdeci">const fc::string logger_name(&quot;net_plugin_impl&quot;)</div></div>
<div class="ttc" id="anamespacesysio_html_ae6b502dce0e50dbe3d9ee47f1ba720d1"><div class="ttname"><a href="namespacesysio.html#ae6b502dce0e50dbe3d9ee47f1ba720d1">sysio::new_chain_banner</a></div><div class="ttdeci">void new_chain_banner(const sysio::chain::controller &amp;db)</div><div class="ttdef"><b>Definition</b> <a href="#l00803">producer_plugin.cpp:803</a></div></div>
<div class="ttc" id="aplugin__interface_8hpp_html"><div class="ttname"><a href="plugin__interface_8hpp.html">plugin_interface.hpp</a></div></div>
<div class="ttc" id="apointer_8h_html_aeeddce917cf130d62c370b8f216026dd"><div class="ttname"><a href="pointer_8h.html#aeeddce917cf130d62c370b8f216026dd">a</a></div><div class="ttdeci">const GenericPointer&lt; typename T::ValueType &gt; T2 T::AllocatorType &amp; a</div><div class="ttdef"><b>Definition</b> <a href="pointer_8h_source.html#l01181">pointer.h:1181</a></div></div>
<div class="ttc" id="aprettywritertest_8cpp_html_a6283df8c4e365cc8a01727e2d7ad44bf"><div class="ttname"><a href="prettywritertest_8cpp.html#a6283df8c4e365cc8a01727e2d7ad44bf">T</a></div><div class="ttdeci">#define T(meth, val, expected)</div></div>
<div class="ttc" id="aproducer__plugin_8cpp_html_a01d09f9c9fe1cbc1b70a0c41f0682e07"><div class="ttname"><a href="producer__plugin_8cpp.html#a01d09f9c9fe1cbc1b70a0c41f0682e07">LOG_AND_DROP</a></div><div class="ttdeci">#define LOG_AND_DROP()</div><div class="ttdef"><b>Definition</b> <a href="#l00047">producer_plugin.cpp:47</a></div></div>
<div class="ttc" id="aproducer__plugin_8cpp_html_a54d7146c8088d64735b0cfbbea3ecae8"><div class="ttname"><a href="producer__plugin_8cpp.html#a54d7146c8088d64735b0cfbbea3ecae8">trx_trace_failure_logger_name</a></div><div class="ttdeci">const std::string trx_trace_failure_logger_name(&quot;transaction_trace_failure&quot;)</div></div>
<div class="ttc" id="aproducer__plugin_8cpp_html_a621f886a258aed68a24a53ffb3b0c36d"><div class="ttname"><a href="producer__plugin_8cpp.html#a621f886a258aed68a24a53ffb3b0c36d">trx_failed_trace_logger_name</a></div><div class="ttdeci">const std::string trx_failed_trace_logger_name(&quot;transaction_failure_tracing&quot;)</div></div>
<div class="ttc" id="aproducer__plugin_8cpp_html_a78396757cc70405744561b647c892edf"><div class="ttname"><a href="producer__plugin_8cpp.html#a78396757cc70405744561b647c892edf">_trx_log</a></div><div class="ttdeci">fc::logger _trx_log</div><div class="ttdef"><b>Definition</b> <a href="#l00086">producer_plugin.cpp:86</a></div></div>
<div class="ttc" id="aproducer__plugin_8cpp_html_a79c03faf256096a8e1ad0d59c8760d2e"><div class="ttname"><a href="producer__plugin_8cpp.html#a79c03faf256096a8e1ad0d59c8760d2e">_trx_trace_success_log</a></div><div class="ttdeci">fc::logger _trx_trace_success_log</div><div class="ttdef"><b>Definition</b> <a href="#l00080">producer_plugin.cpp:80</a></div></div>
<div class="ttc" id="aproducer__plugin_8cpp_html_a979f47bc56a17944271d72bccb834c33"><div class="ttname"><a href="producer__plugin_8cpp.html#a979f47bc56a17944271d72bccb834c33">_trx_trace_failure_log</a></div><div class="ttdeci">fc::logger _trx_trace_failure_log</div><div class="ttdef"><b>Definition</b> <a href="#l00083">producer_plugin.cpp:83</a></div></div>
<div class="ttc" id="aproducer__plugin_8cpp_html_abcd3f04fd24761496de6ea2aa0e3934d"><div class="ttname"><a href="producer__plugin_8cpp.html#abcd3f04fd24761496de6ea2aa0e3934d">num_failures</a></div><div class="ttdeci">uint32_t num_failures</div><div class="ttdef"><b>Definition</b> <a href="#l00281">producer_plugin.cpp:281</a></div></div>
<div class="ttc" id="aproducer__plugin_8cpp_html_ada404895f53490702144cecc3a82b6d4"><div class="ttname"><a href="producer__plugin_8cpp.html#ada404895f53490702144cecc3a82b6d4">trx_successful_trace_logger_name</a></div><div class="ttdeci">const std::string trx_successful_trace_logger_name(&quot;transaction_success_tracing&quot;)</div></div>
<div class="ttc" id="aproducer__plugin_8cpp_html_adff615e9fbe43b3e6443687be568cffd"><div class="ttname"><a href="producer__plugin_8cpp.html#adff615e9fbe43b3e6443687be568cffd">_log</a></div><div class="ttdeci">fc::logger _log</div><div class="ttdef"><b>Definition</b> <a href="#l00071">producer_plugin.cpp:71</a></div></div>
<div class="ttc" id="aproducer__plugin_8cpp_html_ae546cf0f5f4ee210f917a432e3c1bc42"><div class="ttname"><a href="producer__plugin_8cpp.html#ae546cf0f5f4ee210f917a432e3c1bc42">trx_trace_success_logger_name</a></div><div class="ttdeci">const std::string trx_trace_success_logger_name(&quot;transaction_trace_success&quot;)</div></div>
<div class="ttc" id="aproducer__plugin_8cpp_html_ae8244453c4634dc005f0e0c4cb58dd09"><div class="ttname"><a href="producer__plugin_8cpp.html#ae8244453c4634dc005f0e0c4cb58dd09">logger_name</a></div><div class="ttdeci">const std::string logger_name(&quot;producer_plugin&quot;)</div></div>
<div class="ttc" id="aproducer__plugin_8cpp_html_ae93a86d470c7e16b50ab7102170c5d4e"><div class="ttname"><a href="producer__plugin_8cpp.html#ae93a86d470c7e16b50ab7102170c5d4e">_trx_failed_trace_log</a></div><div class="ttdeci">fc::logger _trx_failed_trace_log</div><div class="ttdef"><b>Definition</b> <a href="#l00077">producer_plugin.cpp:77</a></div></div>
<div class="ttc" id="aproducer__plugin_8cpp_html_aea18f7b7425ddc0191447aca7c3e27f6"><div class="ttname"><a href="producer__plugin_8cpp.html#aea18f7b7425ddc0191447aca7c3e27f6">_trx_successful_trace_log</a></div><div class="ttdeci">fc::logger _trx_successful_trace_log</div><div class="ttdef"><b>Definition</b> <a href="#l00074">producer_plugin.cpp:74</a></div></div>
<div class="ttc" id="aproducer__plugin_8cpp_html_af25e4084ac685ca1a7777524a948d81f"><div class="ttname"><a href="producer__plugin_8cpp.html#af25e4084ac685ca1a7777524a948d81f">trx_logger_name</a></div><div class="ttdeci">const std::string trx_logger_name(&quot;transaction&quot;)</div></div>
<div class="ttc" id="aproducer__plugin_8cpp_html_afaa31b8b3376c7a4a9bde7ff4222a1af"><div class="ttname"><a href="producer__plugin_8cpp.html#afaa31b8b3376c7a4a9bde7ff4222a1af">ex_flags</a></div><div class="ttdeci">uint8_t ex_flags</div><div class="ttdef"><b>Definition</b> <a href="#l00282">producer_plugin.cpp:282</a></div></div>
<div class="ttc" id="aproducer__plugin_8hpp_html"><div class="ttname"><a href="producer__plugin_8hpp.html">producer_plugin.hpp</a></div></div>
<div class="ttc" id="aprograms_2sysio-launcher_2main_8cpp_html_af3e300c02a95a1230283a8ea2bb1ad70"><div class="ttname"><a href="programs_2sysio-launcher_2main_8cpp.html#af3e300c02a95a1230283a8ea2bb1ad70">producer_name</a></div><div class="ttdeci">producer_name(block_signing_key)) FC_REFLECT(producer_set_def</div></div>
<div class="ttc" id="aresource__monitor__plugin_8hpp_html"><div class="ttname"><a href="resource__monitor__plugin_8hpp.html">resource_monitor_plugin.hpp</a></div></div>
<div class="ttc" id="as__root__extension_8hpp_html"><div class="ttname"><a href="s__root__extension_8hpp.html">s_root_extension.hpp</a></div></div>
<div class="ttc" id="ascoped__exit_8hpp_html"><div class="ttname"><a href="scoped__exit_8hpp.html">scoped_exit.hpp</a></div></div>
<div class="ttc" id="asnapshot_8hpp_html"><div class="ttname"><a href="snapshot_8hpp.html">snapshot.hpp</a></div></div>
<div class="ttc" id="astatic__buf_8cpp_html_aa99823a0fc8313c9c32541ce768fb801"><div class="ttname"><a href="static__buf_8cpp.html#aa99823a0fc8313c9c32541ce768fb801">add</a></div><div class="ttdeci">int add(int a, int b)</div><div class="ttdef"><b>Definition</b> <a href="static__buf_8cpp_source.html#l00029">static_buf.cpp:29</a></div></div>
<div class="ttc" id="astdint_8h_html_a273cf69d639a59973b6019625df33e30"><div class="ttname"><a href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a></div><div class="ttdeci">unsigned short uint16_t</div><div class="ttdef"><b>Definition</b> <a href="stdint_8h_source.html#l00125">stdint.h:125</a></div></div>
<div class="ttc" id="astdint_8h_html_a414156feea104f8f75b4ed9e3121b2f6"><div class="ttname"><a href="stdint_8h.html#a414156feea104f8f75b4ed9e3121b2f6">int64_t</a></div><div class="ttdeci">signed __int64 int64_t</div><div class="ttdef"><b>Definition</b> <a href="stdint_8h_source.html#l00135">stdint.h:135</a></div></div>
<div class="ttc" id="astdint_8h_html_a435d1572bf3f880d55459d9805097f62"><div class="ttname"><a href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a></div><div class="ttdeci">unsigned int uint32_t</div><div class="ttdef"><b>Definition</b> <a href="stdint_8h_source.html#l00126">stdint.h:126</a></div></div>
<div class="ttc" id="astdint_8h_html_ab1967d8591af1a4e48c37fd2b0f184d0"><div class="ttname"><a href="stdint_8h.html#ab1967d8591af1a4e48c37fd2b0f184d0">int32_t</a></div><div class="ttdeci">signed int int32_t</div><div class="ttdef"><b>Definition</b> <a href="stdint_8h_source.html#l00123">stdint.h:123</a></div></div>
<div class="ttc" id="astdint_8h_html_aba7bc1797add20fe3efdf37ced1182c5"><div class="ttname"><a href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a></div><div class="ttdeci">unsigned char uint8_t</div><div class="ttdef"><b>Definition</b> <a href="stdint_8h_source.html#l00124">stdint.h:124</a></div></div>
<div class="ttc" id="astdint_8h_html_aec6fcb673ff035718c238c8c9d544c47"><div class="ttname"><a href="stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a></div><div class="ttdeci">unsigned __int64 uint64_t</div><div class="ttdef"><b>Definition</b> <a href="stdint_8h_source.html#l00136">stdint.h:136</a></div></div>
<div class="ttc" id="astructappbase_1_1channel__decl_html"><div class="ttname"><a href="structappbase_1_1channel__decl.html">appbase::channel_decl</a></div><div class="ttdef"><b>Definition</b> <a href="channel_8hpp_source.html#l00183">channel.hpp:183</a></div></div>
<div class="ttc" id="astructappbase_1_1method__decl_html"><div class="ttname"><a href="structappbase_1_1method__decl.html">appbase::method_decl</a></div><div class="ttdef"><b>Definition</b> <a href="method_8hpp_source.html#l00301">method.hpp:301</a></div></div>
<div class="ttc" id="astructappbase_1_1priority_html_a89fc0f21b0f87574f0299932fc1724b4"><div class="ttname"><a href="structappbase_1_1priority.html#a89fc0f21b0f87574f0299932fc1724b4">appbase::priority::medium</a></div><div class="ttdeci">static constexpr int medium</div><div class="ttdef"><b>Definition</b> <a href="execution__priority__queue_8hpp_source.html#l00013">execution_priority_queue.hpp:13</a></div></div>
<div class="ttc" id="astructappbase_1_1priority_html_adab9a6659f361fc6ca6c855788b05df0"><div class="ttname"><a href="structappbase_1_1priority.html#adab9a6659f361fc6ca6c855788b05df0">appbase::priority::high</a></div><div class="ttdeci">static constexpr int high</div><div class="ttdef"><b>Definition</b> <a href="execution__priority__queue_8hpp_source.html#l00015">execution_priority_queue.hpp:15</a></div></div>
<div class="ttc" id="astructappbase_1_1priority_html_ae0c72abae2c2ba770667fcf90e40d654"><div class="ttname"><a href="structappbase_1_1priority.html#ae0c72abae2c2ba770667fcf90e40d654">appbase::priority::low</a></div><div class="ttdeci">static constexpr int low</div><div class="ttdef"><b>Definition</b> <a href="execution__priority__queue_8hpp_source.html#l00011">execution_priority_queue.hpp:11</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1block__header_html_a39d57e33ef8d3f6ba59b4c458f0ae375"><div class="ttname"><a href="structsysio_1_1chain_1_1block__header.html#a39d57e33ef8d3f6ba59b4c458f0ae375">sysio::chain::block_header::num_from_id</a></div><div class="ttdeci">static uint32_t num_from_id(const block_id_type &amp;id)</div><div class="ttdef"><b>Definition</b> <a href="block__header_8cpp_source.html#l00013">block_header.cpp:13</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1chain__snapshot__header_html_ad7357c9cee48e084e060efb76dce03e4"><div class="ttname"><a href="structsysio_1_1chain_1_1chain__snapshot__header.html#ad7357c9cee48e084e060efb76dce03e4">sysio::chain::chain_snapshot_header::current_version</a></div><div class="ttdeci">static constexpr uint32_t current_version</div><div class="ttdef"><b>Definition</b> <a href="chain__snapshot_8hpp_source.html#l00029">chain_snapshot.hpp:29</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1name_html"><div class="ttname"><a href="structsysio_1_1chain_1_1name.html">sysio::chain::name</a></div><div class="ttdoc">Immutable except for fc::from_variant.</div><div class="ttdef"><b>Definition</b> <a href="name_8hpp_source.html#l00043">name.hpp:43</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1producer__authority_html_ae72370fc6180ebd6b5a04d61cd436f6a"><div class="ttname"><a href="structsysio_1_1chain_1_1producer__authority.html#ae72370fc6180ebd6b5a04d61cd436f6a">sysio::chain::producer_authority::for_each_key</a></div><div class="ttdeci">static void for_each_key(const block_signing_authority &amp;authority, Op &amp;&amp;op)</div><div class="ttdef"><b>Definition</b> <a href="producer__schedule_8hpp_source.html#l00168">producer_schedule.hpp:168</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1protocol__feature_html"><div class="ttname"><a href="structsysio_1_1chain_1_1protocol__feature.html">sysio::chain::protocol_feature</a></div><div class="ttdef"><b>Definition</b> <a href="protocol__feature__manager_8hpp_source.html#l00106">protocol_feature_manager.hpp:106</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1s__header_html"><div class="ttname"><a href="structsysio_1_1chain_1_1s__header.html">sysio::chain::s_header</a></div><div class="ttdef"><b>Definition</b> <a href="s__root__extension_8hpp_source.html#l00007">s_root_extension.hpp:7</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1s__header_html_a2075610dd92e3718f545b14adcd3ebf7"><div class="ttname"><a href="structsysio_1_1chain_1_1s__header.html#a2075610dd92e3718f545b14adcd3ebf7">sysio::chain::s_header::to_string</a></div><div class="ttdeci">std::string to_string() const</div><div class="ttdef"><b>Definition</b> <a href="s__root__extension_8hpp_source.html#l00036">s_root_extension.hpp:36</a></div></div>
<div class="ttc" id="astructsysio_1_1chain__apis_1_1account__query__db_1_1get__accounts__by__authorizers__params_html"><div class="ttname"><a href="structsysio_1_1chain__apis_1_1account__query__db_1_1get__accounts__by__authorizers__params.html">sysio::chain_apis::account_query_db::get_accounts_by_authorizers_params</a></div><div class="ttdef"><b>Definition</b> <a href="account__query__db_8hpp_source.html#l00048">account_query_db.hpp:48</a></div></div>
<div class="ttc" id="astructsysio_1_1chain__apis_1_1account__query__db_1_1get__accounts__by__authorizers__params_html_a3a982b7949e6e5b9ea508448c1f8d8af"><div class="ttname"><a href="structsysio_1_1chain__apis_1_1account__query__db_1_1get__accounts__by__authorizers__params.html#a3a982b7949e6e5b9ea508448c1f8d8af">sysio::chain_apis::account_query_db::get_accounts_by_authorizers_params::accounts</a></div><div class="ttdeci">std::vector&lt; permission_level &gt; accounts</div><div class="ttdef"><b>Definition</b> <a href="account__query__db_8hpp_source.html#l00056">account_query_db.hpp:56</a></div></div>
<div class="ttc" id="astructsysio_1_1chain__apis_1_1account__query__db_1_1get__accounts__by__authorizers__result_html"><div class="ttname"><a href="structsysio_1_1chain__apis_1_1account__query__db_1_1get__accounts__by__authorizers__result.html">sysio::chain_apis::account_query_db::get_accounts_by_authorizers_result</a></div><div class="ttdef"><b>Definition</b> <a href="account__query__db_8hpp_source.html#l00063">account_query_db.hpp:63</a></div></div>
<div class="ttc" id="astructsysio_1_1producer__plugin_1_1get__account__ram__corrections__params_html"><div class="ttname"><a href="structsysio_1_1producer__plugin_1_1get__account__ram__corrections__params.html">sysio::producer_plugin::get_account_ram_corrections_params</a></div><div class="ttdef"><b>Definition</b> <a href="producer__plugin_8hpp_source.html#l00062">producer_plugin.hpp:62</a></div></div>
<div class="ttc" id="astructsysio_1_1producer__plugin_1_1get__account__ram__corrections__result_html"><div class="ttname"><a href="structsysio_1_1producer__plugin_1_1get__account__ram__corrections__result.html">sysio::producer_plugin::get_account_ram_corrections_result</a></div><div class="ttdef"><b>Definition</b> <a href="producer__plugin_8hpp_source.html#l00069">producer_plugin.hpp:69</a></div></div>
<div class="ttc" id="astructsysio_1_1producer__plugin_1_1get__supported__protocol__features__params_html"><div class="ttname"><a href="structsysio_1_1producer__plugin_1_1get__supported__protocol__features__params.html">sysio::producer_plugin::get_supported_protocol_features_params</a></div><div class="ttdef"><b>Definition</b> <a href="producer__plugin_8hpp_source.html#l00057">producer_plugin.hpp:57</a></div></div>
<div class="ttc" id="astructsysio_1_1producer__plugin_1_1greylist__params_html"><div class="ttname"><a href="structsysio_1_1producer__plugin_1_1greylist__params.html">sysio::producer_plugin::greylist_params</a></div><div class="ttdef"><b>Definition</b> <a href="producer__plugin_8hpp_source.html#l00036">producer_plugin.hpp:36</a></div></div>
<div class="ttc" id="astructsysio_1_1producer__plugin_1_1integrity__hash__information_html"><div class="ttname"><a href="structsysio_1_1producer__plugin_1_1integrity__hash__information.html">sysio::producer_plugin::integrity_hash_information</a></div><div class="ttdef"><b>Definition</b> <a href="producer__plugin_8hpp_source.html#l00040">producer_plugin.hpp:40</a></div></div>
<div class="ttc" id="astructsysio_1_1producer__plugin_1_1scheduled__protocol__feature__activations_html"><div class="ttname"><a href="structsysio_1_1producer__plugin_1_1scheduled__protocol__feature__activations.html">sysio::producer_plugin::scheduled_protocol_feature_activations</a></div><div class="ttdef"><b>Definition</b> <a href="producer__plugin_8hpp_source.html#l00053">producer_plugin.hpp:53</a></div></div>
<div class="ttc" id="astructsysio_1_1producer__plugin_1_1snapshot__information_html"><div class="ttname"><a href="structsysio_1_1producer__plugin_1_1snapshot__information.html">sysio::producer_plugin::snapshot_information</a></div><div class="ttdef"><b>Definition</b> <a href="producer__plugin_8hpp_source.html#l00045">producer_plugin.hpp:45</a></div></div>
<div class="ttc" id="astructsysio_1_1producer__plugin_1_1whitelist__blacklist_html"><div class="ttname"><a href="structsysio_1_1producer__plugin_1_1whitelist__blacklist.html">sysio::producer_plugin::whitelist_blacklist</a></div><div class="ttdef"><b>Definition</b> <a href="producer__plugin_8hpp_source.html#l00027">producer_plugin.hpp:27</a></div></div>
<div class="ttc" id="astructsysio_1_1transaction__id__with__expiry_html"><div class="ttname"><a href="structsysio_1_1transaction__id__with__expiry.html">sysio::transaction_id_with_expiry</a></div><div class="ttdef"><b>Definition</b> <a href="#l00104">producer_plugin.cpp:104</a></div></div>
<div class="ttc" id="astructsysio_1_1transaction__id__with__expiry_html_a3b765964a54ae9c299ad7a724d03ea12"><div class="ttname"><a href="structsysio_1_1transaction__id__with__expiry.html#a3b765964a54ae9c299ad7a724d03ea12">sysio::transaction_id_with_expiry::expiry</a></div><div class="ttdeci">fc::time_point expiry</div><div class="ttdef"><b>Definition</b> <a href="#l00106">producer_plugin.cpp:106</a></div></div>
<div class="ttc" id="astructsysio_1_1transaction__id__with__expiry_html_a8adfcfd1ba13cf76ae84af5deb02b853"><div class="ttname"><a href="structsysio_1_1transaction__id__with__expiry.html#a8adfcfd1ba13cf76ae84af5deb02b853">sysio::transaction_id_with_expiry::trx_id</a></div><div class="ttdeci">transaction_id_type trx_id</div><div class="ttdef"><b>Definition</b> <a href="#l00105">producer_plugin.cpp:105</a></div></div>
<div class="ttc" id="asub__chain__plugin_8hpp_html"><div class="ttname"><a href="sub__chain__plugin_8hpp.html">sub_chain_plugin.hpp</a></div></div>
<div class="ttc" id="asubjective__billing_8hpp_html"><div class="ttname"><a href="subjective__billing_8hpp.html">subjective_billing.hpp</a></div></div>
<div class="ttc" id="atest__account__query__db_8cpp_html_a33f2983ff61d9343e424c440190d8610"><div class="ttname"><a href="test__account__query__db_8cpp.html#a33f2983ff61d9343e424c440190d8610">results</a></div><div class="ttdeci">account_query_db::get_accounts_by_authorizers_result results</div><div class="ttdef"><b>Definition</b> <a href="test__account__query__db_8cpp_source.html#l00021">test_account_query_db.cpp:21</a></div></div>
<div class="ttc" id="atest__account__query__db_8cpp_html_aedc91aab307c8fb7ad822c3e16a6dd73"><div class="ttname"><a href="test__account__query__db_8cpp.html#aedc91aab307c8fb7ad822c3e16a6dd73">params</a></div><div class="ttdeci">account_query_db::get_accounts_by_authorizers_params params</div><div class="ttdef"><b>Definition</b> <a href="test__account__query__db_8cpp_source.html#l00020">test_account_query_db.cpp:20</a></div></div>
<div class="ttc" id="athread__utils_8hpp_html"><div class="ttname"><a href="thread__utils_8hpp.html">thread_utils.hpp</a></div></div>
<div class="ttc" id="atransaction__object_8hpp_html"><div class="ttname"><a href="transaction__object_8hpp.html">transaction_object.hpp</a></div></div>
<div class="ttc" id="aunapplied__transaction__queue_8hpp_html"><div class="ttname"><a href="unapplied__transaction__queue_8hpp.html">unapplied_transaction_queue.hpp</a></div></div>
<div class="ttc" id="awrap__data_8c_html_ac08cbd67ab213a122acbaf421f839005"><div class="ttname"><a href="wrap__data_8c.html#ac08cbd67ab213a122acbaf421f839005">clear</a></div><div class="ttdeci">const uint8_t clear[]</div><div class="ttdef"><b>Definition</b> <a href="wrap__data_8c_source.html#l00035">wrap_data.c:35</a></div></div>
<div class="ttc" id="axbyak__mnemonic_8h_html_a4d3d44497d76862407098986abf97b80"><div class="ttname"><a href="xbyak__mnemonic_8h.html#a4d3d44497d76862407098986abf97b80">bsf</a></div><div class="ttdeci">void bsf(const Reg &amp;reg, const Operand &amp;op)</div><div class="ttdef"><b>Definition</b> <a href="xbyak__mnemonic_8h_source.html#l00044">xbyak_mnemonic.h:44</a></div></div>
<div class="ttc" id="axbyak__mnemonic_8h_html_a9be923ac9afe48bc98bd22e398415272"><div class="ttname"><a href="xbyak__mnemonic_8h.html#a9be923ac9afe48bc98bd22e398415272">bt</a></div><div class="ttdeci">void bt(const Operand &amp;op, const Reg &amp;reg)</div><div class="ttdef"><b>Definition</b> <a href="xbyak__mnemonic_8h_source.html#l00047">xbyak_mnemonic.h:47</a></div></div>
<div class="ttc" id="ayubico__otp_8c_html_a9246c20bb98ad2b4c60313c053c70f08"><div class="ttname"><a href="yubico__otp_8c.html#a9246c20bb98ad2b4c60313c053c70f08">key</a></div><div class="ttdeci">uint8_t key[16]</div><div class="ttdef"><b>Definition</b> <a href="yubico__otp_8c_source.html#l00041">yubico_otp.c:41</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a107648633008a7f2d872b4b3d98c2f96"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a107648633008a7f2d872b4b3d98c2f96">d</a></div><div class="ttdeci">CK_ULONG d</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l01238">yubihsm_pkcs11.c:1238</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a506da415c9307c897ca9be93acfe1d0f"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a></div><div class="ttdeci">char * s</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l00524">yubihsm_pkcs11.c:524</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a931987c85fd408a620505ee9a1aa6f58"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a931987c85fd408a620505ee9a1aa6f58">pubkey</a></div><div class="ttdeci">CK_BYTE_PTR pubkey</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l04984">yubihsm_pkcs11.c:4984</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_4500636a3a05d93d2a8a287b45607964.html">plugins</a></li><li class="navelem"><a class="el" href="dir_e0f9c5a5c548fd887123d7bad6b21094.html">producer_plugin</a></li><li class="navelem"><a class="el" href="producer__plugin_8cpp.html">producer_plugin.cpp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0 </li>
  </ul>
</div>
</body>
</html>
