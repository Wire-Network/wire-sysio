<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Wire Sysio: libraries/fc/test/crypto/test_webauthn.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Wire Sysio<span id="projectnumber">&#160;Wire Sysion 1.0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('test__webauthn_8cpp.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">test_webauthn.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;boost/test/included/unit_test.hpp&gt;</code><br />
<code>#include &lt;boost/algorithm/string.hpp&gt;</code><br />
<code>#include &lt;<a class="el" href="public__key_8hpp_source.html">fc/crypto/public_key.hpp</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="private__key_8hpp_source.html">fc/crypto/private_key.hpp</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="signature_8hpp_source.html">fc/crypto/signature.hpp</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="utility_8hpp_source.html">fc/utility.hpp</a>&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for test_webauthn.cpp:</div>
<div class="dyncontent">
<div class="center"><img src="test__webauthn_8cpp__incl.png" border="0" usemap="#alibraries_2fc_2test_2crypto_2test__webauthn_8cpp" alt=""/></div>
<map name="alibraries_2fc_2test_2crypto_2test__webauthn_8cpp" id="alibraries_2fc_2test_2crypto_2test__webauthn_8cpp">
<area shape="rect" title=" " alt="" coords="517,5,665,46"/>
<area shape="rect" title=" " alt="" coords="5,94,137,135"/>
<area shape="poly" title=" " alt="" coords="517,39,354,62,152,96,151,91,353,57,516,34"/>
<area shape="rect" title=" " alt="" coords="161,102,333,127"/>
<area shape="poly" title=" " alt="" coords="517,48,311,100,310,95,516,43"/>
<area shape="rect" href="public__key_8hpp.html" title=" " alt="" coords="1258,183,1420,208"/>
<area shape="poly" title=" " alt="" coords="666,41,1271,176,1270,181,665,46"/>
<area shape="rect" href="utility_8hpp.html" title=" " alt="" coords="1059,1038,1150,1064"/>
<area shape="poly" title=" " alt="" coords="524,49,473,71,424,102,403,121,387,143,376,167,372,194,372,897,378,921,393,941,418,960,451,977,537,1003,641,1022,754,1035,865,1042,1044,1047,1044,1052,864,1048,753,1040,641,1027,536,1008,449,981,415,965,390,945,373,923,367,898,367,194,371,166,382,140,399,118,420,98,471,66,522,44"/>
<area shape="rect" href="signature_8hpp.html" title=" " alt="" coords="1422,256,1576,282"/>
<area shape="poly" title=" " alt="" coords="665,24,826,27,1026,36,1126,44,1217,56,1295,72,1352,92,1399,123,1437,164,1468,206,1489,241,1484,244,1463,209,1433,167,1395,127,1350,96,1293,77,1217,61,1125,50,1026,41,826,32,665,29"/>
<area shape="rect" href="private__key_8hpp.html" title=" " alt="" coords="1173,102,1340,127"/>
<area shape="poly" title=" " alt="" coords="665,34,1158,98,1157,103,664,39"/>
<area shape="rect" href="elliptic_8hpp.html" title=" " alt="" coords="2430,426,2568,452"/>
<area shape="poly" title=" " alt="" coords="1421,201,1571,215,1771,240,1995,277,2109,301,2220,327,2287,348,2353,372,2461,417,2459,422,2351,377,2286,353,2218,333,2108,306,1994,283,1770,246,1570,221,1420,206"/>
<area shape="rect" href="reflect_8hpp.html" title=" " alt="" coords="1057,802,1194,828"/>
<area shape="poly" title=" " alt="" coords="1273,212,1208,228,1133,253,1055,287,1019,308,985,332,910,390,880,416,855,443,835,472,820,505,811,545,808,593,808,669,814,703,831,732,857,755,889,773,926,787,965,797,1042,808,1041,813,964,802,925,792,887,778,854,759,827,735,809,705,803,669,803,592,806,544,815,504,830,469,851,439,876,412,907,386,981,328,1016,304,1053,282,1131,248,1206,223,1272,206"/>
<area shape="rect" href="static__variant_8hpp.html" title=" " alt="" coords="2780,581,2919,607"/>
<area shape="poly" title=" " alt="" coords="1420,198,1768,218,2232,252,2453,273,2638,296,2765,320,2800,334,2810,341,2814,348,2814,440,2816,475,2823,509,2841,566,2836,567,2818,510,2811,475,2808,440,2808,350,2806,344,2798,338,2763,326,2637,301,2452,278,2231,257,1768,224,1420,204"/>
<area shape="rect" href="elliptic__r1_8hpp.html" title=" " alt="" coords="1442,419,1556,459"/>
<area shape="poly" title=" " alt="" coords="1346,208,1360,241,1380,281,1427,349,1473,405,1469,408,1423,352,1375,283,1355,244,1341,210"/>
<area shape="rect" href="elliptic__webauthn_8hpp.html" title=" " alt="" coords="1546,330,1660,371"/>
<area shape="poly" title=" " alt="" coords="1348,207,1373,243,1391,263,1411,280,1440,297,1471,311,1532,332,1530,337,1469,316,1437,302,1408,284,1387,266,1369,246,1344,210"/>
<area shape="rect" href="elliptic__em_8hpp.html" title=" " alt="" coords="2045,330,2158,371"/>
<area shape="poly" title=" " alt="" coords="1400,206,2031,332,2030,337,1399,212"/>
<area shape="poly" title=" " alt="" coords="1367,206,1459,247,1457,252,1365,211"/>
<area shape="rect" href="fc_2include_2fc_2reflect_2variant_8hpp.html" title=" " alt="" coords="996,338,1136,363"/>
<area shape="poly" title=" " alt="" coords="1330,211,1294,246,1244,284,1185,314,1127,335,1125,330,1183,309,1242,280,1291,242,1326,207"/>
<area shape="rect" href="include_2fc_2crypto_2bigint_8hpp.html" title=" " alt="" coords="1180,507,1312,533"/>
<area shape="poly" title=" " alt="" coords="2454,455,2418,462,2191,483,1880,499,1327,519,1327,514,1879,494,2190,477,2417,457,2453,450"/>
<area shape="rect" href="fwd_8hpp.html" title=" " alt="" coords="2087,1038,2170,1064"/>
<area shape="poly" title=" " alt="" coords="2506,452,2523,507,2547,595,2568,702,2574,758,2576,813,2576,898,2573,913,2564,928,2531,954,2483,977,2425,997,2297,1027,2185,1045,2184,1040,2295,1021,2423,991,2481,972,2528,950,2560,924,2568,911,2571,897,2571,814,2569,759,2562,703,2542,597,2518,509,2501,453"/>
<area shape="rect" href="libraries_2fc_2include_2fc_2crypto_2common_8hpp.html" title=" " alt="" coords="1742,507,1893,533"/>
<area shape="poly" title=" " alt="" coords="2452,455,2418,462,2181,489,1909,514,1909,509,2181,484,2417,457,2451,450"/>
<area shape="rect" href="raw__fwd_8hpp.html" title=" " alt="" coords="2242,655,2366,680"/>
<area shape="poly" title=" " alt="" coords="2491,454,2326,645,2322,642,2487,451"/>
<area shape="rect" href="array_8hpp.html" title=" " alt="" coords="2362,728,2450,754"/>
<area shape="poly" title=" " alt="" coords="2498,453,2427,681,2416,714,2411,713,2422,680,2493,452"/>
<area shape="poly" title=" " alt="" coords="2447,455,2222,510,2128,536,2035,550,1962,556,1889,564,1798,584,1732,604,1678,624,1588,667,1498,711,1444,733,1378,757,1289,782,1205,801,1204,796,1288,777,1377,751,1442,729,1496,706,1586,662,1676,619,1731,599,1797,578,1889,559,1961,551,2034,545,2126,530,2221,505,2446,450"/>
<area shape="rect" href="openssl_8hpp.html" title=" " alt="" coords="1968,507,2115,533"/>
<area shape="poly" title=" " alt="" coords="2450,455,2418,462,2266,489,2131,509,2130,504,2265,483,2417,457,2449,450"/>
<area shape="rect" href="sha256_8hpp.html" title=" " alt="" coords="1835,581,1979,607"/>
<area shape="poly" title=" " alt="" coords="2489,454,2442,495,2410,518,2375,536,2318,548,2219,561,1995,586,1994,581,2218,556,2317,542,2373,530,2407,513,2439,491,2485,450"/>
<area shape="rect" href="sha512_8hpp.html" title=" " alt="" coords="1673,728,1816,754"/>
<area shape="poly" title=" " alt="" coords="2471,455,2362,495,2293,517,2222,536,2183,541,2133,544,2017,548,1904,557,1858,567,1825,583,1807,605,1788,640,1756,715,1751,713,1783,637,1802,602,1821,579,1857,562,1903,552,2017,542,2133,539,2182,536,2221,530,2292,512,2361,490,2469,450"/>
<area shape="rect" href="stdint_8h.html" title=" " alt="" coords="439,1112,503,1137"/>
<area shape="poly" title=" " alt="" coords="1180,536,956,583,814,619,670,662,536,712,477,739,425,768,382,798,349,829,329,861,322,895,322,978,324,1000,332,1019,358,1054,393,1081,429,1102,426,1107,390,1086,355,1057,327,1022,319,1001,316,979,316,894,324,859,345,826,378,794,422,763,474,734,534,707,668,657,813,614,954,578,1178,531"/>
<area shape="rect" href="string_8hpp.html" title=" " alt="" coords="1812,964,1906,990"/>
<area shape="poly" title=" " alt="" coords="1269,531,1569,704,1735,806,1794,846,1826,874,1847,911,1858,949,1852,950,1842,914,1822,877,1791,851,1732,811,1566,709,1266,536"/>
<area shape="rect" href="fc_2include_2fc_2vector_8hpp.html" title=" " alt="" coords="1578,964,1674,990"/>
<area shape="poly" title=" " alt="" coords="1251,533,1263,567,1284,605,1324,653,1363,688,1402,714,1441,737,1479,761,1518,788,1556,825,1595,874,1613,912,1623,948,1618,950,1608,914,1590,877,1552,828,1514,792,1476,765,1438,742,1399,719,1360,692,1320,656,1279,608,1258,569,1246,534"/>
<area shape="rect" title=" " alt="" coords="395,1185,459,1211"/>
<area shape="poly" title=" " alt="" coords="466,1139,445,1173,440,1170,461,1136"/>
<area shape="rect" title=" " alt="" coords="483,1185,550,1211"/>
<area shape="poly" title=" " alt="" coords="481,1136,503,1171,498,1174,476,1139"/>
<area shape="poly" title=" " alt="" coords="1812,986,1165,1046,1165,1041,1812,980"/>
<area shape="poly" title=" " alt="" coords="1905,988,2073,1032,2072,1037,1904,993"/>
<area shape="poly" title=" " alt="" coords="1059,1060,519,1120,518,1115,1058,1055"/>
<area shape="rect" title=" " alt="" coords="1115,1112,1190,1137"/>
<area shape="poly" title=" " alt="" coords="1114,1062,1138,1097,1133,1100,1110,1065"/>
<area shape="rect" title=" " alt="" coords="2376,1112,2454,1137"/>
<area shape="poly" title=" " alt="" coords="1150,1052,2361,1118,2361,1123,1150,1057"/>
<area shape="rect" title=" " alt="" coords="1214,1112,1259,1137"/>
<area shape="poly" title=" " alt="" coords="1128,1062,1202,1102,1200,1106,1125,1067"/>
<area shape="rect" title=" " alt="" coords="1660,1112,1717,1137"/>
<area shape="poly" title=" " alt="" coords="1150,1055,1645,1115,1644,1120,1150,1060"/>
<area shape="rect" title=" " alt="" coords="2784,1112,2867,1137"/>
<area shape="poly" title=" " alt="" coords="1150,1051,2769,1118,2769,1123,1150,1057"/>
<area shape="rect" title=" " alt="" coords="949,1112,998,1137"/>
<area shape="poly" title=" " alt="" coords="1083,1067,1010,1106,1008,1102,1081,1062"/>
<area shape="rect" title=" " alt="" coords="1022,1112,1090,1137"/>
<area shape="poly" title=" " alt="" coords="1099,1065,1075,1100,1071,1097,1094,1062"/>
<area shape="poly" title=" " alt="" coords="1633,989,1679,1096,1675,1098,1628,991"/>
<area shape="poly" title=" " alt="" coords="1757,536,1471,596,1075,687,880,738,710,788,584,836,543,858,520,877,516,887,515,902,519,938,527,972,534,988,560,999,609,1010,750,1026,910,1038,1044,1045,1043,1050,910,1043,749,1032,608,1015,558,1005,530,992,522,973,514,939,509,902,511,886,516,874,540,853,582,831,709,783,878,733,1073,682,1469,591,1756,531"/>
<area shape="rect" href="ripemd160_8hpp.html" title=" " alt="" coords="2054,581,2216,607"/>
<area shape="poly" title=" " alt="" coords="1872,531,2067,575,2066,580,1871,536"/>
<area shape="poly" title=" " alt="" coords="1765,536,1695,556,1620,583,1538,627,1478,670,1418,713,1381,734,1335,756,1265,782,1198,800,1197,795,1264,777,1333,752,1378,730,1415,708,1475,666,1535,623,1618,579,1693,551,1763,531"/>
<area shape="poly" title=" " alt="" coords="1894,525,1957,530,2765,585,2764,590,1956,536,1894,531"/>
<area shape="poly" title=" " alt="" coords="2147,605,2165,629,2184,661,2200,699,2207,740,2207,898,2201,935,2187,971,2169,1002,2151,1027,2147,1024,2165,999,2183,968,2196,934,2202,897,2202,740,2195,700,2180,663,2160,632,2143,609"/>
<area shape="poly" title=" " alt="" coords="2165,605,2262,646,2260,651,2163,610"/>
<area shape="rect" href="typename_8hpp.html" title=" " alt="" coords="1654,883,1813,909"/>
<area shape="poly" title=" " alt="" coords="2120,609,1763,876,1760,872,2117,605"/>
<area shape="poly" title=" " alt="" coords="2304,681,2291,738,2283,814,2283,979,2281,998,2275,1014,2265,1027,2252,1036,2220,1051,2183,1066,2144,1079,2093,1089,1967,1106,1733,1124,1732,1118,1966,1101,2092,1084,2143,1074,2181,1061,2218,1046,2249,1032,2261,1023,2270,1012,2276,997,2278,978,2278,813,2286,737,2298,680"/>
<area shape="poly" title=" " alt="" coords="2323,679,2377,717,2374,721,2320,683"/>
<area shape="rect" title=" " alt="" coords="2612,728,2672,754"/>
<area shape="poly" title=" " alt="" coords="2362,678,2597,728,2596,733,2361,684"/>
<area shape="poly" title=" " alt="" coords="2361,748,1210,811,1210,806,2361,742"/>
<area shape="rect" href="exception_8hpp.html" title="Defines exception&#39;s used by fc." alt="" coords="2916,802,3093,828"/>
<area shape="poly" title=" " alt="" coords="2450,745,2901,799,2900,804,2450,750"/>
<area shape="poly" title=" " alt="" coords="1057,821,915,827,746,838,598,855,547,866,519,878,500,901,485,928,475,958,469,988,466,1048,469,1096,464,1096,461,1048,464,988,470,956,480,926,495,898,516,874,545,861,597,850,745,833,914,822,1057,816"/>
<area shape="poly" title=" " alt="" coords="1057,821,920,827,760,837,621,854,573,865,549,878,530,905,523,929,528,949,542,968,566,984,597,998,678,1019,774,1034,873,1042,1044,1047,1043,1053,873,1047,773,1039,677,1025,595,1003,563,988,538,972,523,952,518,928,525,903,545,874,572,860,620,849,760,832,920,821,1057,816"/>
<area shape="rect" title=" " alt="" coords="1273,883,1424,909"/>
<area shape="poly" title=" " alt="" coords="1161,826,1301,875,1299,880,1159,831"/>
<area shape="rect" title=" " alt="" coords="1448,876,1580,916"/>
<area shape="poly" title=" " alt="" coords="1195,826,1433,872,1432,877,1194,831"/>
<area shape="rect" title=" " alt="" coords="560,876,692,916"/>
<area shape="poly" title=" " alt="" coords="1057,826,901,846,708,878,707,872,900,841,1056,821"/>
<area shape="rect" title=" " alt="" coords="716,876,848,916"/>
<area shape="poly" title=" " alt="" coords="1071,831,864,877,862,872,1069,826"/>
<area shape="rect" title=" " alt="" coords="872,876,1004,916"/>
<area shape="poly" title=" " alt="" coords="1098,831,1000,872,998,867,1096,826"/>
<area shape="rect" title=" " alt="" coords="1028,876,1160,916"/>
<area shape="poly" title=" " alt="" coords="1123,829,1110,862,1105,860,1118,827"/>
<area shape="rect" title=" " alt="" coords="1184,883,1248,909"/>
<area shape="poly" title=" " alt="" coords="1141,826,1193,871,1189,875,1138,830"/>
<area shape="poly" title=" " alt="" coords="1195,822,1593,873,1640,879,1639,885,1592,878,1195,827"/>
<area shape="poly" title=" " alt="" coords="1754,907,1828,954,1826,958,1751,912"/>
<area shape="poly" title=" " alt="" coords="1734,910,1696,1097,1691,1096,1729,909"/>
<area shape="poly" title=" " alt="" coords="3006,828,2998,871,2988,896,2973,918,2915,968,2850,1010,2781,1043,2710,1069,2640,1090,2575,1104,2470,1121,2469,1116,2574,1099,2639,1084,2708,1064,2779,1038,2848,1005,2912,964,2969,915,2984,894,2993,870,3001,827"/>
<area shape="rect" title=" " alt="" coords="2802,883,2959,909"/>
<area shape="poly" title=" " alt="" coords="2987,830,2913,877,2911,872,2984,826"/>
<area shape="poly" title=" " alt="" coords="2920,598,2989,612,3024,622,3058,637,3088,655,3112,678,3128,706,3134,740,3134,979,3126,1017,3107,1047,3077,1072,3041,1090,3001,1104,2959,1114,2883,1124,2882,1118,2958,1109,2999,1099,3039,1086,3074,1067,3103,1044,3121,1015,3128,978,3128,740,3123,708,3108,681,3085,659,3055,642,3022,627,2987,617,2919,604"/>
<area shape="poly" title=" " alt="" coords="2899,605,2939,623,2958,636,2974,653,2993,686,3003,722,3008,757,3008,787,3003,787,3002,757,2998,723,2988,688,2970,656,2955,641,2937,628,2897,610"/>
<area shape="poly" title=" " alt="" coords="2878,605,2907,625,2920,638,2931,654,2933,667,2931,681,2913,770,2890,869,2884,868,2908,769,2926,680,2928,667,2926,656,2916,641,2904,629,2875,610"/>
<area shape="poly" title=" " alt="" coords="2823,610,2781,630,2737,657,2698,688,2665,719,2662,715,2694,684,2733,652,2778,625,2820,605"/>
<area shape="rect" title=" " alt="" coords="2746,655,2825,680"/>
<area shape="poly" title=" " alt="" coords="2841,609,2808,645,2804,641,2837,605"/>
<area shape="rect" title=" " alt="" coords="2849,655,2917,680"/>
<area shape="poly" title=" " alt="" coords="2858,606,2873,639,2868,642,2853,608"/>
<area shape="poly" title=" " alt="" coords="1911,607,1914,657,1915,734,1910,825,1892,917,1877,952,1872,950,1887,916,1904,825,1910,734,1909,657,1906,607"/>
<area shape="poly" title=" " alt="" coords="1954,605,2002,623,2051,650,2073,668,2090,689,2101,713,2106,740,2106,897,2112,965,2124,1022,2119,1023,2107,966,2100,897,2100,740,2096,714,2086,692,2069,672,2048,655,2000,628,1953,610"/>
<area shape="poly" title=" " alt="" coords="1975,605,2227,650,2226,655,1974,610"/>
<area shape="poly" title=" " alt="" coords="1908,607,1901,638,1887,680,1864,722,1848,741,1830,756,1795,769,1736,779,1566,796,1374,807,1210,814,1210,808,1373,802,1566,790,1735,774,1794,763,1827,752,1845,737,1859,719,1882,677,1896,637,1903,606"/>
<area shape="poly" title=" " alt="" coords="1764,753,1820,801,1849,835,1871,875,1876,894,1876,914,1870,950,1865,949,1871,914,1870,895,1866,877,1845,838,1816,804,1761,757"/>
<area shape="poly" title=" " alt="" coords="1774,752,1812,772,1850,800,1875,826,1892,850,1916,897,1941,942,1959,965,1985,988,2028,1014,2073,1032,2071,1037,2026,1019,1981,992,1955,968,1936,945,1912,899,1888,853,1871,829,1847,804,1809,777,1771,757"/>
<area shape="poly" title=" " alt="" coords="1672,753,1210,807,1209,801,1672,748"/>
<area shape="poly" title=" " alt="" coords="1443,460,1300,505,1299,500,1441,455"/>
<area shape="poly" title=" " alt="" coords="1502,459,1506,495,1512,514,1521,532,1556,574,1591,603,1626,624,1663,639,1741,670,1784,693,1830,726,1918,806,1999,891,2112,1024,2108,1027,1995,895,1914,810,1827,730,1781,698,1739,675,1661,644,1624,628,1587,607,1552,577,1517,534,1507,516,1501,496,1496,460"/>
<area shape="poly" title=" " alt="" coords="1557,452,1754,500,1753,506,1555,457"/>
<area shape="poly" title=" " alt="" coords="1539,458,1625,496,1677,515,1730,530,1805,543,1871,546,1985,536,2040,533,2097,536,2160,550,2230,579,2249,591,2266,607,2292,640,2288,643,2262,611,2246,595,2227,583,2158,555,2097,541,2040,538,1986,542,1871,551,1805,549,1729,536,1676,520,1623,501,1537,462"/>
<area shape="poly" title=" " alt="" coords="1506,459,1521,496,1532,515,1547,531,1575,549,1610,567,1700,601,1809,632,1928,660,2166,703,2346,730,2346,735,2165,708,1927,665,1808,637,1698,606,1608,572,1572,554,1544,535,1528,518,1516,498,1501,461"/>
<area shape="poly" title=" " alt="" coords="1478,462,1425,509,1265,670,1149,792,1145,789,1261,666,1421,505,1474,458"/>
<area shape="poly" title=" " alt="" coords="1556,446,1954,503,1953,509,1556,451"/>
<area shape="poly" title=" " alt="" coords="1513,458,1543,496,1563,515,1586,531,1643,556,1704,573,1765,583,1820,589,1819,594,1764,589,1703,578,1641,561,1583,535,1560,519,1539,500,1509,461"/>
<area shape="poly" title=" " alt="" coords="1471,462,1453,477,1439,495,1431,513,1435,532,1458,568,1487,600,1521,629,1556,654,1629,694,1692,720,1690,725,1626,698,1553,658,1517,633,1484,604,1454,571,1430,534,1426,513,1434,492,1449,473,1467,458"/>
<area shape="poly" title=" " alt="" coords="1547,366,1467,387,1382,421,1320,460,1271,499,1268,495,1317,455,1379,416,1465,382,1545,360"/>
<area shape="poly" title=" " alt="" coords="1613,370,1629,405,1655,449,1689,494,1731,531,1766,549,1798,558,1828,561,1857,560,1919,559,1954,565,1992,579,2037,605,2091,647,2137,695,2151,718,2156,740,2156,897,2150,966,2138,1023,2133,1022,2145,965,2151,897,2151,740,2146,720,2133,698,2088,651,2034,610,1990,583,1952,570,1918,565,1857,565,1827,566,1797,563,1764,554,1728,535,1685,498,1650,452,1624,408,1608,372"/>
<area shape="poly" title=" " alt="" coords="1630,369,1792,496,1789,500,1626,373"/>
<area shape="poly" title=" " alt="" coords="1660,354,1802,374,1886,392,1968,416,2059,447,2130,476,2163,493,2195,515,2265,579,2286,609,2299,639,2294,641,2281,611,2261,583,2191,519,2160,497,2128,480,2057,452,1966,421,1884,397,1801,379,1660,359"/>
<area shape="poly" title=" " alt="" coords="1642,369,1957,531,2002,543,2042,549,2111,552,2179,556,2219,564,2264,578,2330,605,2355,624,2381,653,2397,683,2405,713,2400,714,2392,685,2377,656,2351,628,2327,610,2262,584,2217,569,2179,562,2110,557,2041,554,2001,548,1955,535,1640,374"/>
<area shape="poly" title=" " alt="" coords="1546,358,1412,377,1333,396,1258,421,1125,509,1110,544,1102,583,1098,622,1098,661,1107,732,1120,786,1115,788,1102,733,1093,661,1093,622,1096,582,1105,543,1121,506,1255,416,1332,390,1411,372,1545,353"/>
<area shape="poly" title=" " alt="" coords="1660,353,1716,360,1782,372,1852,390,1919,416,1949,433,1977,454,2022,494,2018,498,1974,458,1946,438,1917,421,1850,395,1781,377,1716,365,1660,358"/>
<area shape="poly" title=" " alt="" coords="1603,371,1600,406,1603,449,1613,493,1623,513,1637,531,1666,548,1711,562,1820,581,1819,587,1710,568,1664,553,1633,535,1619,516,1608,495,1597,450,1595,406,1597,371"/>
<area shape="poly" title=" " alt="" coords="1581,373,1536,411,1532,407,1578,369"/>
<area shape="poly" title=" " alt="" coords="2159,364,2178,368,2418,416,2434,420,2433,425,2417,421,2177,373,2158,369"/>
<area shape="poly" title=" " alt="" coords="2044,357,1905,364,1727,376,1555,395,1485,407,1432,421,1413,430,1400,439,1370,462,1288,503,1285,498,1367,457,1397,435,1411,425,1430,416,1483,402,1554,390,1727,371,1905,358,2044,351"/>
<area shape="poly" title=" " alt="" coords="2159,350,2274,356,2414,367,2547,386,2600,400,2639,416,2670,436,2693,457,2708,483,2712,519,2712,898,2708,918,2695,936,2675,953,2649,967,2583,992,2503,1012,2416,1027,2329,1037,2185,1049,2185,1044,2329,1032,2415,1021,2502,1007,2582,987,2647,962,2672,948,2691,933,2703,916,2707,897,2707,519,2703,485,2689,460,2667,441,2636,421,2598,405,2546,392,2413,372,2273,361,2159,356"/>
<area shape="poly" title=" " alt="" coords="2070,373,1853,501,1850,497,2067,369"/>
<area shape="poly" title=" " alt="" coords="2159,348,2266,350,2393,359,2454,367,2509,379,2553,396,2582,417,2595,436,2601,454,2602,473,2596,491,2573,526,2537,558,2492,587,2443,613,2353,651,2351,647,2440,608,2489,583,2533,554,2569,522,2592,489,2596,472,2596,455,2590,438,2578,421,2550,400,2507,384,2453,372,2392,364,2266,355,2159,353"/>
<area shape="poly" title=" " alt="" coords="2159,352,2278,361,2420,375,2544,393,2587,404,2610,417,2624,437,2632,458,2635,480,2632,502,2616,546,2587,589,2550,630,2510,666,2438,721,2435,717,2506,662,2546,626,2582,586,2611,543,2627,501,2630,480,2627,459,2620,440,2607,421,2585,409,2543,398,2419,380,2278,366,2158,358"/>
<area shape="poly" title=" " alt="" coords="2045,357,1696,379,1503,398,1424,409,1364,421,1259,456,1204,481,1183,495,1169,509,1158,530,1150,561,1137,639,1129,787,1123,786,1132,638,1144,560,1153,528,1165,506,1180,491,1202,477,1257,451,1362,416,1423,404,1502,393,1695,374,2044,352"/>
<area shape="poly" title=" " alt="" coords="2097,372,2054,493,2049,492,2092,370"/>
<area shape="poly" title=" " alt="" coords="2133,369,2156,390,2173,417,2186,450,2193,478,2190,506,2173,535,2145,554,2101,568,1995,587,1994,582,2099,563,2143,549,2169,531,2185,504,2188,479,2181,451,2169,420,2152,394,2129,373"/>
<area shape="poly" title=" " alt="" coords="2115,370,2131,404,2145,448,2148,471,2147,494,2141,515,2129,535,2110,553,2091,566,2072,574,2051,578,2011,576,1970,568,1928,558,1885,554,1842,560,1821,569,1799,583,1775,611,1759,646,1751,682,1747,713,1742,712,1746,681,1754,644,1770,608,1796,579,1818,565,1841,555,1885,549,1928,553,1971,563,2012,571,2051,572,2070,569,2089,561,2107,549,2125,531,2136,513,2142,493,2143,471,2140,449,2126,406,2110,372"/>
<area shape="rect" href="keccak256_8hpp.html" title=" " alt="" coords="2241,426,2405,452"/>
<area shape="poly" title=" " alt="" coords="2153,369,2279,418,2277,423,2151,374"/>
<area shape="poly" title=" " alt="" coords="1577,270,1719,275,1891,285,2055,302,2121,314,2172,328,2190,337,2202,348,2213,358,2229,368,2434,419,2433,425,2227,373,2210,362,2198,351,2187,341,2170,332,2120,319,2054,308,1891,291,1719,280,1576,275"/>
<area shape="poly" title=" " alt="" coords="1467,285,1343,338,1267,376,1194,421,1172,441,1150,462,1103,484,1053,496,958,505,918,511,887,525,875,536,866,550,861,569,859,593,859,669,860,695,864,716,873,733,890,752,924,776,963,792,1003,803,1042,809,1041,814,1002,808,961,797,921,780,887,756,868,737,858,717,854,696,854,669,854,592,856,568,862,548,871,532,884,520,917,506,957,499,1052,491,1101,479,1147,457,1169,437,1191,417,1265,372,1341,333,1465,280"/>
<area shape="poly" title=" " alt="" coords="1576,268,1831,273,1997,280,2173,293,2345,311,2504,337,2574,353,2636,372,2688,393,2730,417,2756,443,2768,470,2777,499,2795,531,2827,568,2823,572,2790,535,2772,501,2763,472,2751,446,2727,421,2686,398,2634,377,2573,359,2503,343,2345,317,2172,298,1997,286,1831,278,1576,273"/>
<area shape="poly" title=" " alt="" coords="1502,283,1502,403,1496,403,1496,283"/>
<area shape="poly" title=" " alt="" coords="1516,280,1567,318,1564,323,1513,285"/>
<area shape="poly" title=" " alt="" coords="1577,278,2030,337,2029,342,1576,283"/>
<area shape="poly" title=" " alt="" coords="1433,285,1148,337,1147,332,1432,280"/>
<area shape="poly" title=" " alt="" coords="1046,366,1014,389,985,420,971,445,964,467,960,519,960,595,966,644,982,681,1007,713,1042,752,1065,774,1091,791,1088,796,1062,778,1038,756,1003,717,977,683,961,646,955,595,955,519,958,466,966,443,981,417,1010,385,1042,362"/>
<area shape="rect" href="variant__object_8hpp.html" title=" " alt="" coords="994,426,1137,452"/>
<area shape="poly" title=" " alt="" coords="1068,364,1068,410,1063,410,1063,364"/>
<area shape="poly" title=" " alt="" coords="1271,126,1317,170,1313,174,1267,130"/>
<area shape="poly" title=" " alt="" coords="1340,122,1518,145,1759,186,1893,213,2030,246,2167,284,2300,328,2348,348,2394,371,2470,415,2467,420,2392,376,2346,352,2298,332,2166,289,2029,251,1891,218,1758,191,1517,150,1340,127"/>
<area shape="poly" title=" " alt="" coords="1185,130,1085,152,978,182,931,201,893,222,868,244,861,256,859,268,859,352,861,389,867,419,884,471,902,523,907,555,910,592,910,669,913,693,923,715,938,734,957,751,1004,777,1054,795,1052,800,1002,782,954,755,934,738,919,718,908,695,904,669,904,593,902,556,897,525,879,473,862,421,856,389,854,352,854,268,856,254,864,241,890,218,929,196,976,177,1084,146,1184,125"/>
<area shape="poly" title=" " alt="" coords="1340,116,1728,134,2253,166,2504,187,2714,210,2797,223,2859,237,2900,251,2911,259,2915,267,2915,440,2910,477,2899,512,2869,569,2864,567,2894,510,2905,476,2910,440,2910,268,2907,262,2897,256,2858,242,2796,228,2714,215,2503,192,2252,171,1728,139,1340,122"/>
<area shape="poly" title=" " alt="" coords="1254,128,1245,165,1245,187,1250,207,1266,241,1288,273,1341,329,1398,375,1450,409,1447,413,1395,379,1337,333,1284,276,1262,244,1244,209,1240,187,1240,164,1249,127"/>
<area shape="poly" title=" " alt="" coords="1301,125,2031,327,2029,332,1299,130"/>
<area shape="poly" title=" " alt="" coords="1233,130,1195,153,1157,185,1130,219,1108,257,1077,324,1073,322,1103,254,1126,216,1153,181,1191,148,1230,125"/>
</map>
</div>
</div>
<p><a href="test__webauthn_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a6b2a3852db8bb19ab6909bac01859985" id="r_a6b2a3852db8bb19ab6909bac01859985"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6b2a3852db8bb19ab6909bac01859985">BOOST_TEST_MODULE</a>&#160;&#160;&#160;webauthn_test_mod</td></tr>
<tr class="separator:a6b2a3852db8bb19ab6909bac01859985"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a75805940106aba536c48e0c047fc814e" id="r_a75805940106aba536c48e0c047fc814e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a75805940106aba536c48e0c047fc814e">BOOST_AUTO_TEST_CASE</a> (good)</td></tr>
<tr class="separator:a75805940106aba536c48e0c047fc814e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae70bfa24f5a3bc0917382b3c17fc033c" id="r_ae70bfa24f5a3bc0917382b3c17fc033c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae70bfa24f5a3bc0917382b3c17fc033c">FC_LOG_AND_RETHROW</a> ()</td></tr>
<tr class="separator:ae70bfa24f5a3bc0917382b3c17fc033c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f1802f977a71adb7942a40d8e9f6c47" id="r_a8f1802f977a71adb7942a40d8e9f6c47"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8f1802f977a71adb7942a40d8e9f6c47">BOOST_AUTO_TEST_CASE</a> (mismatch_presence)</td></tr>
<tr class="separator:a8f1802f977a71adb7942a40d8e9f6c47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a1d2f05f67659071e22f320ef91c0ef" id="r_a2a1d2f05f67659071e22f320ef91c0ef"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2a1d2f05f67659071e22f320ef91c0ef">BOOST_AUTO_TEST_CASE</a> (mismatch_origin)</td></tr>
<tr class="separator:a2a1d2f05f67659071e22f320ef91c0ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b9953c77aafa04553785736c43e07a5" id="r_a4b9953c77aafa04553785736c43e07a5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4b9953c77aafa04553785736c43e07a5">BOOST_AUTO_TEST_CASE</a> (non_https)</td></tr>
<tr class="separator:a4b9953c77aafa04553785736c43e07a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a4dc27ff697dc8d69cbd8bfd3e41853" id="r_a1a4dc27ff697dc8d69cbd8bfd3e41853"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1a4dc27ff697dc8d69cbd8bfd3e41853">BOOST_AUTO_TEST_CASE</a> (lacking_scheme)</td></tr>
<tr class="separator:a1a4dc27ff697dc8d69cbd8bfd3e41853"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a010d0b81ec2257a446d8f9e1a43a4d4f" id="r_a010d0b81ec2257a446d8f9e1a43a4d4f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a010d0b81ec2257a446d8f9e1a43a4d4f">BOOST_AUTO_TEST_CASE</a> (empty_origin)</td></tr>
<tr class="separator:a010d0b81ec2257a446d8f9e1a43a4d4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae90fa97d890394d420629752fef64df" id="r_aae90fa97d890394d420629752fef64df"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aae90fa97d890394d420629752fef64df">BOOST_AUTO_TEST_CASE</a> (good_port)</td></tr>
<tr class="separator:aae90fa97d890394d420629752fef64df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f19eaa04d61bbaa9324ee8d5ada9a90" id="r_a4f19eaa04d61bbaa9324ee8d5ada9a90"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4f19eaa04d61bbaa9324ee8d5ada9a90">BOOST_AUTO_TEST_CASE</a> (empty_port)</td></tr>
<tr class="separator:a4f19eaa04d61bbaa9324ee8d5ada9a90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ed9c663c1c7990474cb70a258ec9377" id="r_a0ed9c663c1c7990474cb70a258ec9377"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0ed9c663c1c7990474cb70a258ec9377">BOOST_AUTO_TEST_CASE</a> (challenge_junk)</td></tr>
<tr class="separator:a0ed9c663c1c7990474cb70a258ec9377"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af58f9647f13c05324de3b3fa2d6aa328" id="r_af58f9647f13c05324de3b3fa2d6aa328"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af58f9647f13c05324de3b3fa2d6aa328">BOOST_AUTO_TEST_CASE</a> (challenge_non_base64)</td></tr>
<tr class="separator:af58f9647f13c05324de3b3fa2d6aa328"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd36e135c2332d8f04b795dddc13a2f3" id="r_abd36e135c2332d8f04b795dddc13a2f3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abd36e135c2332d8f04b795dddc13a2f3">BOOST_AUTO_TEST_CASE</a> (challenge_wrong)</td></tr>
<tr class="separator:abd36e135c2332d8f04b795dddc13a2f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d810d26f3a9ea62940516bbcbcf6b90" id="r_a6d810d26f3a9ea62940516bbcbcf6b90"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6d810d26f3a9ea62940516bbcbcf6b90">BOOST_AUTO_TEST_CASE</a> (wrong_type)</td></tr>
<tr class="separator:a6d810d26f3a9ea62940516bbcbcf6b90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6a3dcec639ba94708fa05a8d82c891c" id="r_ad6a3dcec639ba94708fa05a8d82c891c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad6a3dcec639ba94708fa05a8d82c891c">BOOST_AUTO_TEST_CASE</a> (auth_data_rpid_hash_bad)</td></tr>
<tr class="separator:ad6a3dcec639ba94708fa05a8d82c891c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04cd22b50edfdbf19e9c068f6a7228e3" id="r_a04cd22b50edfdbf19e9c068f6a7228e3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a04cd22b50edfdbf19e9c068f6a7228e3">BOOST_AUTO_TEST_CASE</a> (auth_data_too_short)</td></tr>
<tr class="separator:a04cd22b50edfdbf19e9c068f6a7228e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af95c77a48776d8dc9544884aaeaf5946" id="r_af95c77a48776d8dc9544884aaeaf5946"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af95c77a48776d8dc9544884aaeaf5946">BOOST_AUTO_TEST_CASE</a> (missing_origin)</td></tr>
<tr class="separator:af95c77a48776d8dc9544884aaeaf5946"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91ac61998bf2fbd672164518842c3dbc" id="r_a91ac61998bf2fbd672164518842c3dbc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a91ac61998bf2fbd672164518842c3dbc">BOOST_AUTO_TEST_CASE</a> (missing_type)</td></tr>
<tr class="separator:a91ac61998bf2fbd672164518842c3dbc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c364fa12210f90fb306e3948cd3e5b0" id="r_a0c364fa12210f90fb306e3948cd3e5b0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0c364fa12210f90fb306e3948cd3e5b0">BOOST_AUTO_TEST_CASE</a> (missing_challenge)</td></tr>
<tr class="separator:a0c364fa12210f90fb306e3948cd3e5b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4fa4b484f47ac1bf70c7b2c99a91c9fb" id="r_a4fa4b484f47ac1bf70c7b2c99a91c9fb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4fa4b484f47ac1bf70c7b2c99a91c9fb">BOOST_AUTO_TEST_CASE</a> (good_extrajunk)</td></tr>
<tr class="separator:a4fa4b484f47ac1bf70c7b2c99a91c9fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72e0ee1c4a2abdcc362828f8ca7f119d" id="r_a72e0ee1c4a2abdcc362828f8ca7f119d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a72e0ee1c4a2abdcc362828f8ca7f119d">BOOST_AUTO_TEST_CASE</a> (not_json_object)</td></tr>
<tr class="separator:a72e0ee1c4a2abdcc362828f8ca7f119d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad28a941550711577d070b4c59039fb47" id="r_ad28a941550711577d070b4c59039fb47"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad28a941550711577d070b4c59039fb47">BOOST_AUTO_TEST_CASE</a> (damage_sig)</td></tr>
<tr class="separator:ad28a941550711577d070b4c59039fb47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f379acf17a88ae382a683f053192846" id="r_a3f379acf17a88ae382a683f053192846"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3f379acf17a88ae382a683f053192846">BOOST_AUTO_TEST_CASE</a> (damage_sig_idx)</td></tr>
<tr class="separator:a3f379acf17a88ae382a683f053192846"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a297871fcd73110d766a978fe337ef1e5" id="r_a297871fcd73110d766a978fe337ef1e5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a297871fcd73110d766a978fe337ef1e5">BOOST_AUTO_TEST_CASE</a> (different_priv_key)</td></tr>
<tr class="separator:a297871fcd73110d766a978fe337ef1e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9a2e889a79cc815fd3d36b6f8f77724" id="r_ac9a2e889a79cc815fd3d36b6f8f77724"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac9a2e889a79cc815fd3d36b6f8f77724">BOOST_AUTO_TEST_CASE</a> (empty_json)</td></tr>
<tr class="separator:ac9a2e889a79cc815fd3d36b6f8f77724"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc615b5851afd2b6e5668f9311758a45" id="r_adc615b5851afd2b6e5668f9311758a45"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adc615b5851afd2b6e5668f9311758a45">BOOST_AUTO_TEST_CASE</a> (empty_rpid)</td></tr>
<tr class="separator:adc615b5851afd2b6e5668f9311758a45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15cf1d57bbd4118800b640e96c012cd2" id="r_a15cf1d57bbd4118800b640e96c012cd2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a15cf1d57bbd4118800b640e96c012cd2">BOOST_AUTO_TEST_CASE</a> (good_no_trailing_equal)</td></tr>
<tr class="separator:a15cf1d57bbd4118800b640e96c012cd2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4567990f83744a1b06c7894321f28f7b" id="r_a4567990f83744a1b06c7894321f28f7b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4567990f83744a1b06c7894321f28f7b">BOOST_AUTO_TEST_CASE</a> (base64_wonky)</td></tr>
<tr class="separator:a4567990f83744a1b06c7894321f28f7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a6b2a3852db8bb19ab6909bac01859985" name="a6b2a3852db8bb19ab6909bac01859985"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b2a3852db8bb19ab6909bac01859985">&#9670;&#160;</a></span>BOOST_TEST_MODULE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BOOST_TEST_MODULE&#160;&#160;&#160;webauthn_test_mod</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test__webauthn_8cpp_source.html#l00001">1</a> of file <a class="el" href="test__webauthn_8cpp_source.html">test_webauthn.cpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ad6a3dcec639ba94708fa05a8d82c891c" name="ad6a3dcec639ba94708fa05a8d82c891c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad6a3dcec639ba94708fa05a8d82c891c">&#9670;&#160;</a></span>BOOST_AUTO_TEST_CASE() <span class="overload">[1/26]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOST_AUTO_TEST_CASE </td>
          <td>(</td>
          <td class="paramtype">auth_data_rpid_hash_bad</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test__webauthn_8cpp_source.html#l00199">199</a> of file <a class="el" href="test__webauthn_8cpp_source.html">test_webauthn.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  199</span>                                                  {</div>
<div class="line"><span class="lineno">  200</span>   <a class="code hl_class" href="classfc_1_1crypto_1_1webauthn_1_1public__key.html">webauthn::public_key</a> wa_pub(pub.serialize(), webauthn::public_key::user_presence_t::USER_PRESENCE_NONE, <span class="stringliteral">&quot;fctesting.invalid&quot;</span>);</div>
<div class="line"><span class="lineno">  201</span>   std::string <a class="code hl_class" href="classfc_1_1json.html">json</a> = <span class="stringliteral">&quot;{\&quot;origin\&quot;:\&quot;https://fctesting.invalid\&quot;,\&quot;type\&quot;:\&quot;webauthn.get\&quot;,\&quot;challenge\&quot;:\&quot;&quot;</span> + <a class="code hl_function" href="namespacefc.html#a4d30681e99b9cacc0c9b3b8985a5daa4">fc::base64url_encode</a>(d.<a class="code hl_function" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d">data</a>(), d.<a class="code hl_function" href="classfc_1_1sha256.html#ac7722b7428b1db345f1b7fab7f4d5774">data_size</a>()) + <span class="stringliteral">&quot;\&quot;}&quot;</span>;</div>
<div class="line"><span class="lineno">  202</span> </div>
<div class="line"><span class="lineno">  203</span>   std::vector&lt;uint8_t&gt; auth_data(37);</div>
<div class="line"><span class="lineno">  204</span>   <a class="code hl_class" href="classfc_1_1sha256.html">fc::sha256</a> origin_hash_corrupt = <a class="code hl_function" href="classfc_1_1sha256.html#a474784de7d6213b855abd7e952df5e36">fc::sha256::hash</a>(<span class="stringliteral">&quot;fctesting.invalid&quot;</span><a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a>);</div>
<div class="line"><span class="lineno">  205</span>   <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(auth_data.data(), origin_hash_corrupt.<a class="code hl_function" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d">data</a>(), <span class="keyword">sizeof</span>(origin_hash_corrupt));</div>
<div class="line"><span class="lineno">  206</span>   auth_data[4]++;</div>
<div class="line"><span class="lineno">  207</span> </div>
<div class="line"><span class="lineno">  208</span>   BOOST_CHECK_EXCEPTION(make_webauthn_sig(priv, auth_data, <a class="code hl_class" href="classfc_1_1json.html">json</a>).recover(d, <span class="keyword">true</span>), fc::assert_exception, [](<span class="keyword">const</span> fc::assert_exception&amp; e) {</div>
<div class="line"><span class="lineno">  209</span>      <span class="keywordflow">return</span> e.to_detail_string().find(<span class="stringliteral">&quot;webauthn rpid hash doesn&#39;t match origin&quot;</span>) != std::string::npos;</div>
<div class="line"><span class="lineno">  210</span>   });</div>
<div class="line"><span class="lineno">  211</span>} <a class="code hl_function" href="#ae70bfa24f5a3bc0917382b3c17fc033c">FC_LOG_AND_RETHROW</a>();</div>
<div class="ttc" id="aclassfc_1_1crypto_1_1webauthn_1_1public__key_html"><div class="ttname"><a href="classfc_1_1crypto_1_1webauthn_1_1public__key.html">fc::crypto::webauthn::public_key</a></div><div class="ttdef"><b>Definition</b> <a href="elliptic__webauthn_8hpp_source.html#l00015">elliptic_webauthn.hpp:15</a></div></div>
<div class="ttc" id="aclassfc_1_1json_html"><div class="ttname"><a href="classfc_1_1json.html">fc::json</a></div><div class="ttdef"><b>Definition</b> <a href="json_8hpp_source.html#l00019">json.hpp:20</a></div></div>
<div class="ttc" id="aclassfc_1_1sha256_html"><div class="ttname"><a href="classfc_1_1sha256.html">fc::sha256</a></div><div class="ttdef"><b>Definition</b> <a href="sha256_8hpp_source.html#l00011">sha256.hpp:12</a></div></div>
<div class="ttc" id="aclassfc_1_1sha256_html_a474784de7d6213b855abd7e952df5e36"><div class="ttname"><a href="classfc_1_1sha256.html#a474784de7d6213b855abd7e952df5e36">fc::sha256::hash</a></div><div class="ttdeci">static sha256 hash(const char *d, uint32_t dlen)</div><div class="ttdef"><b>Definition</b> <a href="sha256_8cpp_source.html#l00044">sha256.cpp:44</a></div></div>
<div class="ttc" id="aclassfc_1_1sha256_html_ab897537f6c524085b28049be51ed370d"><div class="ttname"><a href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d">fc::sha256::data</a></div><div class="ttdeci">const char * data() const</div><div class="ttdef"><b>Definition</b> <a href="sha256_8cpp_source.html#l00031">sha256.cpp:31</a></div></div>
<div class="ttc" id="aclassfc_1_1sha256_html_ac7722b7428b1db345f1b7fab7f4d5774"><div class="ttname"><a href="classfc_1_1sha256.html#ac7722b7428b1db345f1b7fab7f4d5774">fc::sha256::data_size</a></div><div class="ttdeci">size_t data_size() const</div><div class="ttdef"><b>Definition</b> <a href="sha256_8hpp_source.html#l00023">sha256.hpp:23</a></div></div>
<div class="ttc" id="anamespacefc_html_a4d30681e99b9cacc0c9b3b8985a5daa4"><div class="ttname"><a href="namespacefc.html#a4d30681e99b9cacc0c9b3b8985a5daa4">fc::base64url_encode</a></div><div class="ttdeci">std::string base64url_encode(unsigned char const *bytes_to_encode, unsigned int in_len)</div><div class="ttdef"><b>Definition</b> <a href="base64_8cpp_source.html#l00101">base64.cpp:101</a></div></div>
<div class="ttc" id="atest__webauthn_8cpp_html_ae70bfa24f5a3bc0917382b3c17fc033c"><div class="ttname"><a href="#ae70bfa24f5a3bc0917382b3c17fc033c">FC_LOG_AND_RETHROW</a></div><div class="ttdeci">FC_LOG_AND_RETHROW()</div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a506da415c9307c897ca9be93acfe1d0f"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a></div><div class="ttdeci">char * s</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l00524">yubihsm_pkcs11.c:524</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_ae785d5badbf1f08b491af31f32a135a1"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a></div><div class="ttdeci">memcpy((char *) pInfo-&gt;slotDescription, s, l)</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="test__webauthn_8cpp_ad6a3dcec639ba94708fa05a8d82c891c_cgraph.png" border="0" usemap="#atest__webauthn_8cpp_ad6a3dcec639ba94708fa05a8d82c891c_cgraph" alt=""/></div>
<map name="atest__webauthn_8cpp_ad6a3dcec639ba94708fa05a8d82c891c_cgraph" id="atest__webauthn_8cpp_ad6a3dcec639ba94708fa05a8d82c891c_cgraph">
<area shape="rect" title=" " alt="" coords="5,107,202,132"/>
<area shape="rect" href="namespacefc.html#a4d30681e99b9cacc0c9b3b8985a5daa4" title=" " alt="" coords="250,5,396,31"/>
<area shape="poly" title=" " alt="" coords="131,104,249,48,276,35,278,40,251,53,133,109"/>
<area shape="rect" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d" title=" " alt="" coords="654,85,770,111"/>
<area shape="poly" title=" " alt="" coords="168,103,249,92,355,86,462,85,639,91,639,96,462,90,356,91,250,97,168,109"/>
<area shape="rect" href="classfc_1_1sha256.html#ac7722b7428b1db345f1b7fab7f4d5774" title=" " alt="" coords="250,107,396,132"/>
<area shape="poly" title=" " alt="" coords="202,117,234,117,234,122,202,122"/>
<area shape="rect" href="classfc_1_1sha256.html#a474784de7d6213b855abd7e952df5e36" title=" " alt="" coords="264,156,382,182"/>
<area shape="poly" title=" " alt="" coords="165,130,249,150,248,155,163,136"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="287,205,358,231"/>
<area shape="poly" title=" " alt="" coords="129,130,184,160,251,192,273,200,271,205,249,197,182,165,127,135"/>
<area shape="rect" href="namespacefc.html#a7c8b089501fd00e09e068aa02eacf3de" title=" " alt="" coords="444,5,606,31"/>
<area shape="poly" title=" " alt="" coords="396,16,429,16,429,21,396,21"/>
<area shape="rect" href="classfc_1_1sha256_1_1encoder.html#a4d8b8181e912194cf98a56164671adf8" title=" " alt="" coords="457,106,593,146"/>
<area shape="poly" title=" " alt="" coords="382,154,441,141,442,146,383,159"/>
<area shape="rect" href="classfc_1_1sha256_1_1encoder.html#a4a246dfb33e3eb78ba167446bee92e30" title=" " alt="" coords="457,171,593,212"/>
<area shape="poly" title=" " alt="" coords="383,173,442,180,441,185,382,178"/>
<area shape="poly" title=" " alt="" coords="593,113,638,106,639,112,594,119"/>
</map>
</div>

</div>
</div>
<a id="a04cd22b50edfdbf19e9c068f6a7228e3" name="a04cd22b50edfdbf19e9c068f6a7228e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a04cd22b50edfdbf19e9c068f6a7228e3">&#9670;&#160;</a></span>BOOST_AUTO_TEST_CASE() <span class="overload">[2/26]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOST_AUTO_TEST_CASE </td>
          <td>(</td>
          <td class="paramtype">auth_data_too_short</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test__webauthn_8cpp_source.html#l00214">214</a> of file <a class="el" href="test__webauthn_8cpp_source.html">test_webauthn.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  214</span>                                              {</div>
<div class="line"><span class="lineno">  215</span>   <a class="code hl_class" href="classfc_1_1crypto_1_1webauthn_1_1public__key.html">webauthn::public_key</a> wa_pub(pub.serialize(), webauthn::public_key::user_presence_t::USER_PRESENCE_NONE, <span class="stringliteral">&quot;fctesting.invalid&quot;</span>);</div>
<div class="line"><span class="lineno">  216</span>   std::string <a class="code hl_class" href="classfc_1_1json.html">json</a> = <span class="stringliteral">&quot;{\&quot;origin\&quot;:\&quot;https://fctesting.invalid\&quot;,\&quot;type\&quot;:\&quot;webauthn.get\&quot;,\&quot;challenge\&quot;:\&quot;&quot;</span> + <a class="code hl_function" href="namespacefc.html#a4d30681e99b9cacc0c9b3b8985a5daa4">fc::base64url_encode</a>(d.<a class="code hl_function" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d">data</a>(), d.<a class="code hl_function" href="classfc_1_1sha256.html#ac7722b7428b1db345f1b7fab7f4d5774">data_size</a>()) + <span class="stringliteral">&quot;\&quot;}&quot;</span>;</div>
<div class="line"><span class="lineno">  217</span> </div>
<div class="line"><span class="lineno">  218</span>   std::vector&lt;uint8_t&gt; auth_data(1);</div>
<div class="line"><span class="lineno">  219</span> </div>
<div class="line"><span class="lineno">  220</span>   BOOST_CHECK_EXCEPTION(make_webauthn_sig(priv, auth_data, <a class="code hl_class" href="classfc_1_1json.html">json</a>).recover(d, <span class="keyword">true</span>), fc::assert_exception, [](<span class="keyword">const</span> fc::assert_exception&amp; e) {</div>
<div class="line"><span class="lineno">  221</span>      <span class="keywordflow">return</span> e.to_detail_string().find(<span class="stringliteral">&quot;auth_data not as large as required&quot;</span>) != std::string::npos;</div>
<div class="line"><span class="lineno">  222</span>   });</div>
<div class="line"><span class="lineno">  223</span>} <a class="code hl_function" href="#ae70bfa24f5a3bc0917382b3c17fc033c">FC_LOG_AND_RETHROW</a>();</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="test__webauthn_8cpp_a04cd22b50edfdbf19e9c068f6a7228e3_cgraph.png" border="0" usemap="#atest__webauthn_8cpp_a04cd22b50edfdbf19e9c068f6a7228e3_cgraph" alt=""/></div>
<map name="atest__webauthn_8cpp_a04cd22b50edfdbf19e9c068f6a7228e3_cgraph" id="atest__webauthn_8cpp_a04cd22b50edfdbf19e9c068f6a7228e3_cgraph">
<area shape="rect" title=" " alt="" coords="5,55,202,80"/>
<area shape="rect" href="namespacefc.html#a4d30681e99b9cacc0c9b3b8985a5daa4" title=" " alt="" coords="250,5,396,31"/>
<area shape="poly" title=" " alt="" coords="163,51,247,32,248,38,165,57"/>
<area shape="rect" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d" title=" " alt="" coords="265,55,380,80"/>
<area shape="poly" title=" " alt="" coords="202,65,250,65,250,70,202,70"/>
<area shape="rect" href="classfc_1_1sha256.html#ac7722b7428b1db345f1b7fab7f4d5774" title=" " alt="" coords="250,104,396,130"/>
<area shape="poly" title=" " alt="" coords="165,78,248,97,247,103,163,84"/>
<area shape="rect" href="namespacefc.html#a7c8b089501fd00e09e068aa02eacf3de" title=" " alt="" coords="444,5,606,31"/>
<area shape="poly" title=" " alt="" coords="396,16,429,16,429,21,396,21"/>
</map>
</div>

</div>
</div>
<a id="a4567990f83744a1b06c7894321f28f7b" name="a4567990f83744a1b06c7894321f28f7b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4567990f83744a1b06c7894321f28f7b">&#9670;&#160;</a></span>BOOST_AUTO_TEST_CASE() <span class="overload">[3/26]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOST_AUTO_TEST_CASE </td>
          <td>(</td>
          <td class="paramtype">base64_wonky</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test__webauthn_8cpp_source.html#l00406">406</a> of file <a class="el" href="test__webauthn_8cpp_source.html">test_webauthn.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  406</span>                                       {</div>
<div class="line"><span class="lineno">  407</span>   <a class="code hl_class" href="classfc_1_1crypto_1_1webauthn_1_1public__key.html">webauthn::public_key</a> wa_pub(pub.serialize(), webauthn::public_key::user_presence_t::USER_PRESENCE_NONE, <span class="stringliteral">&quot;fctesting.invalid&quot;</span>);</div>
<div class="line"><span class="lineno">  408</span> </div>
<div class="line"><span class="lineno">  409</span>   std::string <a class="code hl_class" href="classfc_1_1json.html">json</a> = <span class="stringliteral">&quot;{\&quot;origin\&quot;:\&quot;https://fctesting.invalid\&quot;,\&quot;type\&quot;:\&quot;webauthn.get\&quot;,\&quot;challenge\&quot;:\&quot;&quot;</span> + <a class="code hl_function" href="namespacefc.html#a4d30681e99b9cacc0c9b3b8985a5daa4">fc::base64url_encode</a>(d.<a class="code hl_function" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d">data</a>(), d.<a class="code hl_function" href="classfc_1_1sha256.html#ac7722b7428b1db345f1b7fab7f4d5774">data_size</a>()) + <span class="stringliteral">&quot;!@#$\&quot;}&quot;</span>;</div>
<div class="line"><span class="lineno">  410</span>   boost::erase_all(<a class="code hl_class" href="classfc_1_1json.html">json</a>, <span class="stringliteral">&quot;=&quot;</span>);</div>
<div class="line"><span class="lineno">  411</span> </div>
<div class="line"><span class="lineno">  412</span>   std::vector&lt;uint8_t&gt; auth_data(37);</div>
<div class="line"><span class="lineno">  413</span>   <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(auth_data.data(), origin_hash.<a class="code hl_function" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d">data</a>(), <span class="keyword">sizeof</span>(origin_hash));</div>
<div class="line"><span class="lineno">  414</span> </div>
<div class="line"><span class="lineno">  415</span>   BOOST_CHECK_EXCEPTION(make_webauthn_sig(priv, auth_data, <a class="code hl_class" href="classfc_1_1json.html">json</a>).recover(d, <span class="keyword">true</span>), <a class="code hl_class" href="classfc_1_1exception.html">fc::exception</a>, [](<span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1exception.html">fc::exception</a>&amp; e) {</div>
<div class="line"><span class="lineno">  416</span>      <span class="keywordflow">return</span> e.<a class="code hl_function" href="classfc_1_1exception.html#a7611ea8fbe25dde56649b685c2298a37">to_detail_string</a>().find(<span class="stringliteral">&quot;encountered non-base64 character&quot;</span>) != std::string::npos;</div>
<div class="line"><span class="lineno">  417</span>   });</div>
<div class="line"><span class="lineno">  418</span>} <a class="code hl_function" href="#ae70bfa24f5a3bc0917382b3c17fc033c">FC_LOG_AND_RETHROW</a>();</div>
<div class="ttc" id="aclassfc_1_1exception_html"><div class="ttname"><a href="classfc_1_1exception.html">fc::exception</a></div><div class="ttdoc">Used to generate a useful error report when an exception is thrown.</div><div class="ttdef"><b>Definition</b> <a href="exception_8hpp_source.html#l00057">exception.hpp:58</a></div></div>
<div class="ttc" id="aclassfc_1_1exception_html_a7611ea8fbe25dde56649b685c2298a37"><div class="ttname"><a href="classfc_1_1exception.html#a7611ea8fbe25dde56649b685c2298a37">fc::exception::to_detail_string</a></div><div class="ttdeci">std::string to_detail_string(log_level ll=log_level::all) const</div><div class="ttdef"><b>Definition</b> <a href="exception_8cpp_source.html#l00158">exception.cpp:158</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="test__webauthn_8cpp_a4567990f83744a1b06c7894321f28f7b_cgraph.png" border="0" usemap="#atest__webauthn_8cpp_a4567990f83744a1b06c7894321f28f7b_cgraph" alt=""/></div>
<map name="atest__webauthn_8cpp_a4567990f83744a1b06c7894321f28f7b_cgraph" id="atest__webauthn_8cpp_a4567990f83744a1b06c7894321f28f7b_cgraph">
<area shape="rect" title=" " alt="" coords="5,161,202,187"/>
<area shape="rect" href="namespacefc.html#a4d30681e99b9cacc0c9b3b8985a5daa4" title=" " alt="" coords="451,31,596,56"/>
<area shape="poly" title=" " alt="" coords="125,159,180,128,249,97,345,70,435,52,436,58,346,75,251,102,182,132,127,163"/>
<area shape="rect" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d" title=" " alt="" coords="269,112,384,138"/>
<area shape="poly" title=" " alt="" coords="164,158,253,138,254,143,166,163"/>
<area shape="rect" href="classfc_1_1sha256.html#ac7722b7428b1db345f1b7fab7f4d5774" title=" " alt="" coords="253,161,400,187"/>
<area shape="poly" title=" " alt="" coords="202,172,238,172,238,177,202,177"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="291,211,362,236"/>
<area shape="poly" title=" " alt="" coords="166,185,276,210,275,215,164,190"/>
<area shape="rect" href="classfc_1_1exception.html#a7611ea8fbe25dde56649b685c2298a37" title=" " alt="" coords="250,268,403,309"/>
<area shape="poly" title=" " alt="" coords="132,185,273,259,270,263,129,190"/>
<area shape="rect" href="namespacefc.html#a7c8b089501fd00e09e068aa02eacf3de" title=" " alt="" coords="838,5,1000,31"/>
<area shape="poly" title=" " alt="" coords="576,27,644,16,735,10,822,11,822,16,736,16,645,21,577,33"/>
<area shape="rect" href="classfc_1_1variant.html#acbd70a93184e4277631f2a261acb707c" title=" " alt="" coords="454,131,594,156"/>
<area shape="poly" title=" " alt="" coords="370,266,401,247,454,205,497,166,500,170,457,209,405,251,373,270"/>
<area shape="rect" href="classfc_1_1time__point.html#aa164ff1268a16d4b32afcff181f6100e" title=" " alt="" coords="458,304,590,330"/>
<area shape="poly" title=" " alt="" coords="404,297,443,303,442,308,403,302"/>
<area shape="rect" href="classfc_1_1json.html#aa6541960d7f05567559b866cfaf88dfa" title=" " alt="" coords="462,435,585,460"/>
<area shape="poly" title=" " alt="" coords="355,308,496,423,493,427,351,312"/>
<area shape="rect" href="namespacefc.html#a3668095306e6c6c4c53de5d7701e4dde" title=" " alt="" coords="649,31,780,56"/>
<area shape="poly" title=" " alt="" coords="541,128,586,97,643,65,654,60,657,65,646,70,589,102,544,132"/>
<area shape="rect" href="classfc_1_1variant.html#aa475101b0f2181350d76a2fdc6cf7c76" title=" " alt="" coords="646,80,783,106"/>
<area shape="poly" title=" " alt="" coords="574,127,648,108,650,113,576,133"/>
<area shape="rect" href="classfc_1_1variant.html#afaae1df286ff97c83301eda21dbd51ea" title=" " alt="" coords="850,105,988,131"/>
<area shape="poly" title=" " alt="" coords="594,136,834,121,835,126,594,142"/>
<area shape="rect" href="namespacefc.html#a4e07b3870aa72f8c38bdd5f78044dad1" title=" " alt="" coords="669,181,760,207"/>
<area shape="poly" title=" " alt="" coords="576,154,655,176,654,181,574,160"/>
<area shape="poly" title=" " alt="" coords="780,33,822,28,822,33,781,38"/>
<area shape="poly" title=" " alt="" coords="783,99,835,105,834,110,783,104"/>
<area shape="rect" href="classfc_1_1mock__time__traits.html#a0bed781012a73b8c15882648397b56be" title=" " alt="" coords="644,231,785,272"/>
<area shape="poly" title=" " alt="" coords="563,301,638,275,639,280,564,306"/>
<area shape="rect" href="classfc_1_1mock__time__traits.html#adddeebdf472c33f927827c111ddbf0b1" title=" " alt="" coords="644,296,785,337"/>
<area shape="poly" title=" " alt="" coords="590,314,629,314,629,320,590,320"/>
<area shape="rect" href="classfc_1_1time__point.html#ab46781dcaab4880902bc136f36e39e5e" title=" " alt="" coords="648,362,781,402"/>
<area shape="poly" title=" " alt="" coords="564,328,639,354,638,359,563,333"/>
<area shape="rect" href="classfc_1_1time__point.html#abfea5efbe9ef58024cda814395ee9945" title=" " alt="" coords="648,427,781,468"/>
<area shape="poly" title=" " alt="" coords="541,328,586,368,646,412,654,417,652,422,643,416,583,372,537,332"/>
<area shape="rect" href="classfc_1_1mock__time__traits.html#a0d7245b32fd62b3bc712f658250cc4db" title=" " alt="" coords="833,239,1005,264"/>
<area shape="poly" title=" " alt="" coords="785,249,817,249,817,254,785,254"/>
<area shape="rect" href="namespacefc.html#af9bea69c5790941ddc601fcd96cce071" title=" " alt="" coords="665,516,764,542"/>
<area shape="poly" title=" " alt="" coords="557,458,669,507,667,512,555,463"/>
<area shape="poly" title=" " alt="" coords="682,517,676,507,680,498,693,492,715,489,738,492,750,498,747,503,736,497,714,495,694,497,684,501,681,507,687,514"/>
</map>
</div>

</div>
</div>
<a id="a0ed9c663c1c7990474cb70a258ec9377" name="a0ed9c663c1c7990474cb70a258ec9377"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ed9c663c1c7990474cb70a258ec9377">&#9670;&#160;</a></span>BOOST_AUTO_TEST_CASE() <span class="overload">[4/26]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOST_AUTO_TEST_CASE </td>
          <td>(</td>
          <td class="paramtype">challenge_junk</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test__webauthn_8cpp_source.html#l00145">145</a> of file <a class="el" href="test__webauthn_8cpp_source.html">test_webauthn.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  145</span>                                         {</div>
<div class="line"><span class="lineno">  146</span>   <a class="code hl_class" href="classfc_1_1crypto_1_1webauthn_1_1public__key.html">webauthn::public_key</a> wa_pub(pub.serialize(), webauthn::public_key::user_presence_t::USER_PRESENCE_NONE, <span class="stringliteral">&quot;fctesting.invalid&quot;</span>);</div>
<div class="line"><span class="lineno">  147</span>   std::string <a class="code hl_class" href="classfc_1_1json.html">json</a> = <span class="stringliteral">&quot;{\&quot;origin\&quot;:\&quot;https://fctesting.invalid\&quot;,\&quot;type\&quot;:\&quot;webauthn.get\&quot;,\&quot;challenge\&quot;:\&quot;&quot;</span> + <span class="stringliteral">&quot;blahBLAH&quot;</span><a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a> + <span class="stringliteral">&quot;\&quot;}&quot;</span>;</div>
<div class="line"><span class="lineno">  148</span> </div>
<div class="line"><span class="lineno">  149</span>   std::vector&lt;uint8_t&gt; auth_data(37);</div>
<div class="line"><span class="lineno">  150</span>   <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(auth_data.data(), origin_hash.<a class="code hl_function" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d">data</a>(), <span class="keyword">sizeof</span>(origin_hash));</div>
<div class="line"><span class="lineno">  151</span> </div>
<div class="line"><span class="lineno">  152</span>   BOOST_CHECK_EXCEPTION(make_webauthn_sig(priv, auth_data, <a class="code hl_class" href="classfc_1_1json.html">json</a>).recover(d, <span class="keyword">true</span>), <a class="code hl_class" href="classfc_1_1exception.html">fc::exception</a>, [](<span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1exception.html">fc::exception</a>&amp; e) {</div>
<div class="line"><span class="lineno">  153</span>      <span class="keywordflow">return</span> e.<a class="code hl_function" href="classfc_1_1exception.html#a7611ea8fbe25dde56649b685c2298a37">to_detail_string</a>().find(<span class="stringliteral">&quot;sha256: size mismatch&quot;</span>) != std::string::npos;</div>
<div class="line"><span class="lineno">  154</span>   });</div>
<div class="line"><span class="lineno">  155</span>} <a class="code hl_function" href="#ae70bfa24f5a3bc0917382b3c17fc033c">FC_LOG_AND_RETHROW</a>();</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="test__webauthn_8cpp_a0ed9c663c1c7990474cb70a258ec9377_cgraph.png" border="0" usemap="#atest__webauthn_8cpp_a0ed9c663c1c7990474cb70a258ec9377_cgraph" alt=""/></div>
<map name="atest__webauthn_8cpp_a0ed9c663c1c7990474cb70a258ec9377_cgraph" id="atest__webauthn_8cpp_a0ed9c663c1c7990474cb70a258ec9377_cgraph">
<area shape="rect" title=" " alt="" coords="5,255,202,280"/>
<area shape="rect" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d" title=" " alt="" coords="269,205,384,231"/>
<area shape="poly" title=" " alt="" coords="164,251,253,232,254,237,166,257"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="291,255,362,280"/>
<area shape="poly" title=" " alt="" coords="202,265,276,265,276,270,202,270"/>
<area shape="rect" href="classfc_1_1exception.html#a7611ea8fbe25dde56649b685c2298a37" title=" " alt="" coords="250,304,403,345"/>
<area shape="poly" title=" " alt="" coords="157,278,235,299,234,304,156,284"/>
<area shape="rect" href="classfc_1_1variant.html#acbd70a93184e4277631f2a261acb707c" title=" " alt="" coords="451,105,591,131"/>
<area shape="poly" title=" " alt="" coords="385,302,401,291,436,256,465,216,506,144,510,146,470,219,440,259,405,295,388,306"/>
<area shape="rect" href="classfc_1_1time__point.html#aa164ff1268a16d4b32afcff181f6100e" title=" " alt="" coords="455,312,587,338"/>
<area shape="poly" title=" " alt="" coords="404,322,439,322,439,328,404,328"/>
<area shape="rect" href="classfc_1_1json.html#aa6541960d7f05567559b866cfaf88dfa" title=" " alt="" coords="460,409,582,435"/>
<area shape="poly" title=" " alt="" coords="370,343,481,400,479,404,368,348"/>
<area shape="rect" href="namespacefc.html#a3668095306e6c6c4c53de5d7701e4dde" title=" " alt="" coords="644,5,775,31"/>
<area shape="poly" title=" " alt="" coords="538,103,582,72,638,40,649,35,652,40,641,45,585,77,541,107"/>
<area shape="rect" href="classfc_1_1variant.html#aa475101b0f2181350d76a2fdc6cf7c76" title=" " alt="" coords="641,55,778,80"/>
<area shape="poly" title=" " alt="" coords="571,102,644,82,645,87,572,107"/>
<area shape="rect" href="classfc_1_1variant.html#afaae1df286ff97c83301eda21dbd51ea" title=" " alt="" coords="845,80,982,106"/>
<area shape="poly" title=" " alt="" coords="592,111,829,96,830,101,592,116"/>
<area shape="rect" href="namespacefc.html#a4e07b3870aa72f8c38bdd5f78044dad1" title=" " alt="" coords="664,156,755,182"/>
<area shape="poly" title=" " alt="" coords="572,129,650,150,648,155,571,134"/>
<area shape="rect" href="namespacefc.html#a7c8b089501fd00e09e068aa02eacf3de" title=" " alt="" coords="833,5,995,31"/>
<area shape="poly" title=" " alt="" coords="776,16,817,16,817,21,776,21"/>
<area shape="poly" title=" " alt="" coords="778,73,830,80,829,85,778,79"/>
<area shape="rect" href="classfc_1_1mock__time__traits.html#a0bed781012a73b8c15882648397b56be" title=" " alt="" coords="639,206,780,246"/>
<area shape="poly" title=" " alt="" coords="544,309,638,257,649,251,652,256,641,262,547,314"/>
<area shape="rect" href="classfc_1_1mock__time__traits.html#adddeebdf472c33f927827c111ddbf0b1" title=" " alt="" coords="639,271,780,312"/>
<area shape="poly" title=" " alt="" coords="587,310,623,304,624,309,588,316"/>
<area shape="rect" href="classfc_1_1time__point.html#ab46781dcaab4880902bc136f36e39e5e" title=" " alt="" coords="643,336,776,377"/>
<area shape="poly" title=" " alt="" coords="588,333,628,340,627,346,588,339"/>
<area shape="rect" href="classfc_1_1time__point.html#abfea5efbe9ef58024cda814395ee9945" title=" " alt="" coords="643,402,776,442"/>
<area shape="poly" title=" " alt="" coords="547,336,641,386,652,392,650,397,638,391,545,341"/>
<area shape="rect" href="classfc_1_1mock__time__traits.html#a0d7245b32fd62b3bc712f658250cc4db" title=" " alt="" coords="828,213,1000,239"/>
<area shape="poly" title=" " alt="" coords="780,224,812,224,812,229,780,229"/>
<area shape="rect" href="namespacefc.html#af9bea69c5790941ddc601fcd96cce071" title=" " alt="" coords="660,491,759,516"/>
<area shape="poly" title=" " alt="" coords="554,433,665,482,663,486,552,438"/>
<area shape="poly" title=" " alt="" coords="678,492,672,482,675,472,688,466,710,464,732,467,744,473,742,478,731,472,709,469,690,471,679,476,677,481,682,489"/>
</map>
</div>

</div>
</div>
<a id="af58f9647f13c05324de3b3fa2d6aa328" name="af58f9647f13c05324de3b3fa2d6aa328"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af58f9647f13c05324de3b3fa2d6aa328">&#9670;&#160;</a></span>BOOST_AUTO_TEST_CASE() <span class="overload">[5/26]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOST_AUTO_TEST_CASE </td>
          <td>(</td>
          <td class="paramtype">challenge_non_base64</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test__webauthn_8cpp_source.html#l00158">158</a> of file <a class="el" href="test__webauthn_8cpp_source.html">test_webauthn.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  158</span>                                               {</div>
<div class="line"><span class="lineno">  159</span>   <a class="code hl_class" href="classfc_1_1crypto_1_1webauthn_1_1public__key.html">webauthn::public_key</a> wa_pub(pub.serialize(), webauthn::public_key::user_presence_t::USER_PRESENCE_NONE, <span class="stringliteral">&quot;fctesting.invalid&quot;</span>);</div>
<div class="line"><span class="lineno">  160</span>   std::string <a class="code hl_class" href="classfc_1_1json.html">json</a> = <span class="stringliteral">&quot;{\&quot;origin\&quot;:\&quot;https://fctesting.invalid\&quot;,\&quot;type\&quot;:\&quot;webauthn.get\&quot;,\&quot;challenge\&quot;:\&quot;&quot;</span> + <span class="stringliteral">&quot;hello@world$&quot;</span><a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a> + <span class="stringliteral">&quot;\&quot;}&quot;</span>;</div>
<div class="line"><span class="lineno">  161</span> </div>
<div class="line"><span class="lineno">  162</span>   std::vector&lt;uint8_t&gt; auth_data(37);</div>
<div class="line"><span class="lineno">  163</span>   <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(auth_data.data(), origin_hash.<a class="code hl_function" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d">data</a>(), <span class="keyword">sizeof</span>(origin_hash));</div>
<div class="line"><span class="lineno">  164</span> </div>
<div class="line"><span class="lineno">  165</span>   BOOST_CHECK_EXCEPTION(make_webauthn_sig(priv, auth_data, <a class="code hl_class" href="classfc_1_1json.html">json</a>).recover(d, <span class="keyword">true</span>), <a class="code hl_class" href="classfc_1_1exception.html">fc::exception</a>, [](<span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1exception.html">fc::exception</a>&amp; e) {</div>
<div class="line"><span class="lineno">  166</span>      <span class="keywordflow">return</span> e.<a class="code hl_function" href="classfc_1_1exception.html#a7611ea8fbe25dde56649b685c2298a37">to_detail_string</a>().find(<span class="stringliteral">&quot;encountered non-base64 character&quot;</span>) != std::string::npos;</div>
<div class="line"><span class="lineno">  167</span>   });</div>
<div class="line"><span class="lineno">  168</span>} <a class="code hl_function" href="#ae70bfa24f5a3bc0917382b3c17fc033c">FC_LOG_AND_RETHROW</a>();</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="test__webauthn_8cpp_af58f9647f13c05324de3b3fa2d6aa328_cgraph.png" border="0" usemap="#atest__webauthn_8cpp_af58f9647f13c05324de3b3fa2d6aa328_cgraph" alt=""/></div>
<map name="atest__webauthn_8cpp_af58f9647f13c05324de3b3fa2d6aa328_cgraph" id="atest__webauthn_8cpp_af58f9647f13c05324de3b3fa2d6aa328_cgraph">
<area shape="rect" title=" " alt="" coords="5,255,202,280"/>
<area shape="rect" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d" title=" " alt="" coords="269,205,384,231"/>
<area shape="poly" title=" " alt="" coords="164,251,253,232,254,237,166,257"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="291,255,362,280"/>
<area shape="poly" title=" " alt="" coords="202,265,276,265,276,270,202,270"/>
<area shape="rect" href="classfc_1_1exception.html#a7611ea8fbe25dde56649b685c2298a37" title=" " alt="" coords="250,304,403,345"/>
<area shape="poly" title=" " alt="" coords="157,278,235,299,234,304,156,284"/>
<area shape="rect" href="classfc_1_1variant.html#acbd70a93184e4277631f2a261acb707c" title=" " alt="" coords="451,105,591,131"/>
<area shape="poly" title=" " alt="" coords="385,302,401,291,436,256,465,216,506,144,510,146,470,219,440,259,405,295,388,306"/>
<area shape="rect" href="classfc_1_1time__point.html#aa164ff1268a16d4b32afcff181f6100e" title=" " alt="" coords="455,312,587,338"/>
<area shape="poly" title=" " alt="" coords="404,322,439,322,439,328,404,328"/>
<area shape="rect" href="classfc_1_1json.html#aa6541960d7f05567559b866cfaf88dfa" title=" " alt="" coords="460,409,582,435"/>
<area shape="poly" title=" " alt="" coords="370,343,481,400,479,404,368,348"/>
<area shape="rect" href="namespacefc.html#a3668095306e6c6c4c53de5d7701e4dde" title=" " alt="" coords="644,5,775,31"/>
<area shape="poly" title=" " alt="" coords="538,103,582,72,638,40,649,35,652,40,641,45,585,77,541,107"/>
<area shape="rect" href="classfc_1_1variant.html#aa475101b0f2181350d76a2fdc6cf7c76" title=" " alt="" coords="641,55,778,80"/>
<area shape="poly" title=" " alt="" coords="571,102,644,82,645,87,572,107"/>
<area shape="rect" href="classfc_1_1variant.html#afaae1df286ff97c83301eda21dbd51ea" title=" " alt="" coords="845,80,982,106"/>
<area shape="poly" title=" " alt="" coords="592,111,829,96,830,101,592,116"/>
<area shape="rect" href="namespacefc.html#a4e07b3870aa72f8c38bdd5f78044dad1" title=" " alt="" coords="664,156,755,182"/>
<area shape="poly" title=" " alt="" coords="572,129,650,150,648,155,571,134"/>
<area shape="rect" href="namespacefc.html#a7c8b089501fd00e09e068aa02eacf3de" title=" " alt="" coords="833,5,995,31"/>
<area shape="poly" title=" " alt="" coords="776,16,817,16,817,21,776,21"/>
<area shape="poly" title=" " alt="" coords="778,73,830,80,829,85,778,79"/>
<area shape="rect" href="classfc_1_1mock__time__traits.html#a0bed781012a73b8c15882648397b56be" title=" " alt="" coords="639,206,780,246"/>
<area shape="poly" title=" " alt="" coords="544,309,638,257,649,251,652,256,641,262,547,314"/>
<area shape="rect" href="classfc_1_1mock__time__traits.html#adddeebdf472c33f927827c111ddbf0b1" title=" " alt="" coords="639,271,780,312"/>
<area shape="poly" title=" " alt="" coords="587,310,623,304,624,309,588,316"/>
<area shape="rect" href="classfc_1_1time__point.html#ab46781dcaab4880902bc136f36e39e5e" title=" " alt="" coords="643,336,776,377"/>
<area shape="poly" title=" " alt="" coords="588,333,628,340,627,346,588,339"/>
<area shape="rect" href="classfc_1_1time__point.html#abfea5efbe9ef58024cda814395ee9945" title=" " alt="" coords="643,402,776,442"/>
<area shape="poly" title=" " alt="" coords="547,336,641,386,652,392,650,397,638,391,545,341"/>
<area shape="rect" href="classfc_1_1mock__time__traits.html#a0d7245b32fd62b3bc712f658250cc4db" title=" " alt="" coords="828,213,1000,239"/>
<area shape="poly" title=" " alt="" coords="780,224,812,224,812,229,780,229"/>
<area shape="rect" href="namespacefc.html#af9bea69c5790941ddc601fcd96cce071" title=" " alt="" coords="660,491,759,516"/>
<area shape="poly" title=" " alt="" coords="554,433,665,482,663,486,552,438"/>
<area shape="poly" title=" " alt="" coords="678,492,672,482,675,472,688,466,710,464,732,467,744,473,742,478,731,472,709,469,690,471,679,476,677,481,682,489"/>
</map>
</div>

</div>
</div>
<a id="abd36e135c2332d8f04b795dddc13a2f3" name="abd36e135c2332d8f04b795dddc13a2f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd36e135c2332d8f04b795dddc13a2f3">&#9670;&#160;</a></span>BOOST_AUTO_TEST_CASE() <span class="overload">[6/26]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOST_AUTO_TEST_CASE </td>
          <td>(</td>
          <td class="paramtype">challenge_wrong</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test__webauthn_8cpp_source.html#l00171">171</a> of file <a class="el" href="test__webauthn_8cpp_source.html">test_webauthn.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  171</span>                                          {</div>
<div class="line"><span class="lineno">  172</span>   <a class="code hl_class" href="classfc_1_1crypto_1_1webauthn_1_1public__key.html">webauthn::public_key</a> wa_pub(pub.serialize(), webauthn::public_key::user_presence_t::USER_PRESENCE_NONE, <span class="stringliteral">&quot;fctesting.invalid&quot;</span>);</div>
<div class="line"><span class="lineno">  173</span>   <a class="code hl_class" href="classfc_1_1sha256.html">fc::sha256</a> other_digest = <a class="code hl_function" href="classfc_1_1sha256.html#a474784de7d6213b855abd7e952df5e36">fc::sha256::hash</a>(<span class="stringliteral">&quot;yo&quot;</span><a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a>);</div>
<div class="line"><span class="lineno">  174</span>   std::string <a class="code hl_class" href="classfc_1_1json.html">json</a> = <span class="stringliteral">&quot;{\&quot;origin\&quot;:\&quot;https://fctesting.invalid\&quot;,\&quot;type\&quot;:\&quot;webauthn.get\&quot;,\&quot;challenge\&quot;:\&quot;&quot;</span> + <a class="code hl_function" href="namespacefc.html#a4d30681e99b9cacc0c9b3b8985a5daa4">fc::base64url_encode</a>(other_digest.<a class="code hl_function" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d">data</a>(), other_digest.<a class="code hl_function" href="classfc_1_1sha256.html#ac7722b7428b1db345f1b7fab7f4d5774">data_size</a>()) + <span class="stringliteral">&quot;\&quot;}&quot;</span>;</div>
<div class="line"><span class="lineno">  175</span> </div>
<div class="line"><span class="lineno">  176</span>   std::vector&lt;uint8_t&gt; auth_data(37);</div>
<div class="line"><span class="lineno">  177</span>   <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(auth_data.data(), origin_hash.<a class="code hl_function" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d">data</a>(), <span class="keyword">sizeof</span>(origin_hash));</div>
<div class="line"><span class="lineno">  178</span> </div>
<div class="line"><span class="lineno">  179</span>   BOOST_CHECK_EXCEPTION(make_webauthn_sig(priv, auth_data, <a class="code hl_class" href="classfc_1_1json.html">json</a>).recover(d, <span class="keyword">true</span>), fc::assert_exception, [](<span class="keyword">const</span> fc::assert_exception&amp; e) {</div>
<div class="line"><span class="lineno">  180</span>      <span class="keywordflow">return</span> e.to_detail_string().find(<span class="stringliteral">&quot;Wrong webauthn challenge&quot;</span>) != std::string::npos;</div>
<div class="line"><span class="lineno">  181</span>   });</div>
<div class="line"><span class="lineno">  182</span>} <a class="code hl_function" href="#ae70bfa24f5a3bc0917382b3c17fc033c">FC_LOG_AND_RETHROW</a>();</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="test__webauthn_8cpp_abd36e135c2332d8f04b795dddc13a2f3_cgraph.png" border="0" usemap="#atest__webauthn_8cpp_abd36e135c2332d8f04b795dddc13a2f3_cgraph" alt=""/></div>
<map name="atest__webauthn_8cpp_abd36e135c2332d8f04b795dddc13a2f3_cgraph" id="atest__webauthn_8cpp_abd36e135c2332d8f04b795dddc13a2f3_cgraph">
<area shape="rect" title=" " alt="" coords="5,107,202,132"/>
<area shape="rect" href="namespacefc.html#a4d30681e99b9cacc0c9b3b8985a5daa4" title=" " alt="" coords="250,5,396,31"/>
<area shape="poly" title=" " alt="" coords="131,104,249,48,276,35,278,40,251,53,133,109"/>
<area shape="rect" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d" title=" " alt="" coords="654,85,770,111"/>
<area shape="poly" title=" " alt="" coords="168,103,249,92,355,86,462,85,639,91,639,96,462,90,356,91,250,97,168,109"/>
<area shape="rect" href="classfc_1_1sha256.html#ac7722b7428b1db345f1b7fab7f4d5774" title=" " alt="" coords="250,107,396,132"/>
<area shape="poly" title=" " alt="" coords="202,117,234,117,234,122,202,122"/>
<area shape="rect" href="classfc_1_1sha256.html#a474784de7d6213b855abd7e952df5e36" title=" " alt="" coords="264,156,382,182"/>
<area shape="poly" title=" " alt="" coords="165,130,249,150,248,155,163,136"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="287,205,358,231"/>
<area shape="poly" title=" " alt="" coords="129,130,184,160,251,192,273,200,271,205,249,197,182,165,127,135"/>
<area shape="rect" href="namespacefc.html#a7c8b089501fd00e09e068aa02eacf3de" title=" " alt="" coords="444,5,606,31"/>
<area shape="poly" title=" " alt="" coords="396,16,429,16,429,21,396,21"/>
<area shape="rect" href="classfc_1_1sha256_1_1encoder.html#a4d8b8181e912194cf98a56164671adf8" title=" " alt="" coords="457,106,593,146"/>
<area shape="poly" title=" " alt="" coords="382,154,441,141,442,146,383,159"/>
<area shape="rect" href="classfc_1_1sha256_1_1encoder.html#a4a246dfb33e3eb78ba167446bee92e30" title=" " alt="" coords="457,171,593,212"/>
<area shape="poly" title=" " alt="" coords="383,173,442,180,441,185,382,178"/>
<area shape="poly" title=" " alt="" coords="593,113,638,106,639,112,594,119"/>
</map>
</div>

</div>
</div>
<a id="ad28a941550711577d070b4c59039fb47" name="ad28a941550711577d070b4c59039fb47"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad28a941550711577d070b4c59039fb47">&#9670;&#160;</a></span>BOOST_AUTO_TEST_CASE() <span class="overload">[7/26]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOST_AUTO_TEST_CASE </td>
          <td>(</td>
          <td class="paramtype">damage_sig</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test__webauthn_8cpp_source.html#l00290">290</a> of file <a class="el" href="test__webauthn_8cpp_source.html">test_webauthn.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  290</span>                                     {</div>
<div class="line"><span class="lineno">  291</span>   <a class="code hl_class" href="classfc_1_1crypto_1_1webauthn_1_1public__key.html">webauthn::public_key</a> wa_pub(pub.serialize(), webauthn::public_key::user_presence_t::USER_PRESENCE_NONE, <span class="stringliteral">&quot;fctesting.invalid&quot;</span>);</div>
<div class="line"><span class="lineno">  292</span>   std::string <a class="code hl_class" href="classfc_1_1json.html">json</a> = <span class="stringliteral">&quot;{\&quot;origin\&quot;:\&quot;https://fctesting.invalid\&quot;,\&quot;type\&quot;:\&quot;webauthn.get\&quot;,\&quot;challenge\&quot;:\&quot;&quot;</span> + <a class="code hl_function" href="namespacefc.html#a4d30681e99b9cacc0c9b3b8985a5daa4">fc::base64url_encode</a>(d.<a class="code hl_function" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d">data</a>(), d.<a class="code hl_function" href="classfc_1_1sha256.html#ac7722b7428b1db345f1b7fab7f4d5774">data_size</a>()) + <span class="stringliteral">&quot;\&quot;}&quot;</span>;</div>
<div class="line"><span class="lineno">  293</span> </div>
<div class="line"><span class="lineno">  294</span>   std::vector&lt;uint8_t&gt; auth_data(37);</div>
<div class="line"><span class="lineno">  295</span>   <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(auth_data.data(), origin_hash.<a class="code hl_function" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d">data</a>(), <span class="keyword">sizeof</span>(origin_hash));</div>
<div class="line"><span class="lineno">  296</span> </div>
<div class="line"><span class="lineno">  297</span>   <a class="code hl_class" href="classfc_1_1crypto_1_1webauthn_1_1signature.html">webauthn::signature</a> sig = make_webauthn_sig(priv, auth_data, <a class="code hl_class" href="classfc_1_1json.html">json</a>);</div>
<div class="line"><span class="lineno">  298</span>   <span class="keywordtype">char</span> buff[8192];</div>
<div class="line"><span class="lineno">  299</span>   <a class="code hl_class" href="classfc_1_1datastream.html">datastream&lt;char*&gt;</a> <a class="code hl_function" href="namespace_xbyak_1_1util.html#a4b2aef26182d21706896022467868f7c">ds</a>(buff, <span class="keyword">sizeof</span>(buff));</div>
<div class="line"><span class="lineno">  300</span>   <a class="code hl_function" href="namespacefc_1_1raw.html#a3a18d8161aa5b4f4f02b6fcfdff5e5d1">fc::raw::pack</a>(ds, sig);</div>
<div class="line"><span class="lineno">  301</span>   buff[4]++;</div>
<div class="line"><span class="lineno">  302</span>   <a class="code hl_function" href="namespace_xbyak_1_1util.html#a4b2aef26182d21706896022467868f7c">ds</a>.seekp(0);</div>
<div class="line"><span class="lineno">  303</span>   <a class="code hl_function" href="namespacefc_1_1raw.html#a0b442d98ceb22dd5a6ae84745e43ffab">fc::raw::unpack</a>(ds, sig);</div>
<div class="line"><span class="lineno">  304</span> </div>
<div class="line"><span class="lineno">  305</span>   <span class="keywordtype">bool</span> failed_recovery = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  306</span>   <span class="keywordtype">bool</span> failed_compare = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  307</span>   <a class="code hl_class" href="classfc_1_1crypto_1_1webauthn_1_1public__key.html">webauthn::public_key</a> recovered_pub;</div>
<div class="line"><span class="lineno">  308</span> </div>
<div class="line"><span class="lineno">  309</span>   <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno">  310</span>      recovered_pub = sig.<a class="code hl_function" href="classfc_1_1crypto_1_1webauthn_1_1signature.html#a28633b0f40d89bedb305e2343d9ac4ca">recover</a>(d, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  311</span>      failed_compare = !(wa_pub == recovered_pub);</div>
<div class="line"><span class="lineno">  312</span>   }</div>
<div class="line"><span class="lineno">  313</span>   <span class="keywordflow">catch</span>(<a class="code hl_class" href="classfc_1_1exception.html">fc::exception</a>&amp; e) {</div>
<div class="line"><span class="lineno">  314</span>      failed_recovery = e.<a class="code hl_function" href="classfc_1_1exception.html#a7611ea8fbe25dde56649b685c2298a37">to_detail_string</a>().find(<span class="stringliteral">&quot;unable to reconstruct public key from signature&quot;</span>) != std::string::npos;</div>
<div class="line"><span class="lineno">  315</span>   }</div>
<div class="line"><span class="lineno">  316</span> </div>
<div class="line"><span class="lineno">  317</span>   <span class="comment">//We can fail either by failing to recover any key, or recovering the wrong key. Check that at least one of these failed</span></div>
<div class="line"><span class="lineno">  318</span>   BOOST_CHECK_EQUAL(failed_recovery || failed_compare, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  319</span>} <a class="code hl_function" href="#ae70bfa24f5a3bc0917382b3c17fc033c">FC_LOG_AND_RETHROW</a>();</div>
<div class="ttc" id="aclassfc_1_1crypto_1_1webauthn_1_1signature_html"><div class="ttname"><a href="classfc_1_1crypto_1_1webauthn_1_1signature.html">fc::crypto::webauthn::signature</a></div><div class="ttdef"><b>Definition</b> <a href="elliptic__webauthn_8hpp_source.html#l00074">elliptic_webauthn.hpp:74</a></div></div>
<div class="ttc" id="aclassfc_1_1crypto_1_1webauthn_1_1signature_html_a28633b0f40d89bedb305e2343d9ac4ca"><div class="ttname"><a href="classfc_1_1crypto_1_1webauthn_1_1signature.html#a28633b0f40d89bedb305e2343d9ac4ca">fc::crypto::webauthn::signature::recover</a></div><div class="ttdeci">public_key recover(const sha256 &amp;digest, bool check_canonical) const</div><div class="ttdef"><b>Definition</b> <a href="elliptic__webauthn_8hpp_source.html#l00084">elliptic_webauthn.hpp:84</a></div></div>
<div class="ttc" id="aclassfc_1_1datastream_html"><div class="ttname"><a href="classfc_1_1datastream.html">fc::datastream</a></div><div class="ttdef"><b>Definition</b> <a href="datastream_8hpp_source.html#l00018">datastream.hpp:18</a></div></div>
<div class="ttc" id="anamespace_xbyak_1_1util_html_a4b2aef26182d21706896022467868f7c"><div class="ttname"><a href="namespace_xbyak_1_1util.html#a4b2aef26182d21706896022467868f7c">Xbyak::util::ds</a></div><div class="ttdeci">static const Segment ds(Segment::ds)</div></div>
<div class="ttc" id="anamespacefc_1_1raw_html_a0b442d98ceb22dd5a6ae84745e43ffab"><div class="ttname"><a href="namespacefc_1_1raw.html#a0b442d98ceb22dd5a6ae84745e43ffab">fc::raw::unpack</a></div><div class="ttdeci">void unpack(Stream &amp;s, std::deque&lt; T &gt; &amp;value)</div><div class="ttdef"><b>Definition</b> <a href="raw_8hpp_source.html#l00540">raw.hpp:540</a></div></div>
<div class="ttc" id="anamespacefc_1_1raw_html_a3a18d8161aa5b4f4f02b6fcfdff5e5d1"><div class="ttname"><a href="namespacefc_1_1raw.html#a3a18d8161aa5b4f4f02b6fcfdff5e5d1">fc::raw::pack</a></div><div class="ttdeci">void pack(Stream &amp;s, const std::deque&lt; T &gt; &amp;value)</div><div class="ttdef"><b>Definition</b> <a href="raw_8hpp_source.html#l00531">raw.hpp:531</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="test__webauthn_8cpp_ad28a941550711577d070b4c59039fb47_cgraph.png" border="0" usemap="#atest__webauthn_8cpp_ad28a941550711577d070b4c59039fb47_cgraph" alt=""/></div>
<map name="atest__webauthn_8cpp_ad28a941550711577d070b4c59039fb47_cgraph" id="atest__webauthn_8cpp_ad28a941550711577d070b4c59039fb47_cgraph">
<area shape="rect" title=" " alt="" coords="5,208,202,233"/>
<area shape="rect" href="namespacefc.html#a4d30681e99b9cacc0c9b3b8985a5daa4" title=" " alt="" coords="451,284,596,309"/>
<area shape="poly" title=" " alt="" coords="143,231,194,247,250,262,346,278,436,287,435,293,345,283,249,267,192,252,142,236"/>
<area shape="rect" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d" title=" " alt="" coords="861,117,976,142"/>
<area shape="poly" title=" " alt="" coords="202,222,299,223,403,218,525,203,647,184,846,144,847,149,648,189,526,209,403,223,299,228,202,227"/>
<area shape="rect" href="classfc_1_1sha256.html#ac7722b7428b1db345f1b7fab7f4d5774" title=" " alt="" coords="253,133,400,158"/>
<area shape="poly" title=" " alt="" coords="141,204,249,167,267,161,269,166,251,172,143,209"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="291,182,362,208"/>
<area shape="poly" title=" " alt="" coords="202,206,275,198,276,203,202,212"/>
<area shape="rect" href="namespacefc_1_1raw.html#a3a18d8161aa5b4f4f02b6fcfdff5e5d1" title=" " alt="" coords="666,94,763,120"/>
<area shape="poly" title=" " alt="" coords="116,205,171,160,208,136,249,118,302,103,357,94,467,85,569,88,651,95,650,100,568,93,467,91,358,99,303,109,251,123,211,141,174,164,120,209"/>
<area shape="rect" href="classfc_1_1crypto_1_1webauthn_1_1signature.html#a28633b0f40d89bedb305e2343d9ac4ca" title=" " alt="" coords="256,17,396,58"/>
<area shape="poly" title=" " alt="" coords="114,205,168,145,206,108,248,74,264,64,267,68,251,78,210,112,172,149,118,209"/>
<area shape="rect" href="classfc_1_1exception.html#a7611ea8fbe25dde56649b685c2298a37" title=" " alt="" coords="250,351,403,391"/>
<area shape="poly" title=" " alt="" coords="126,232,284,340,281,344,123,236"/>
<area shape="rect" href="namespacefc_1_1raw.html#a0b442d98ceb22dd5a6ae84745e43ffab" title=" " alt="" coords="271,440,382,465"/>
<area shape="poly" title=" " alt="" coords="115,232,168,308,208,356,251,401,289,429,286,433,248,405,204,359,164,311,111,235"/>
<area shape="rect" href="namespacefc.html#a7c8b089501fd00e09e068aa02eacf3de" title=" " alt="" coords="838,346,1000,372"/>
<area shape="poly" title=" " alt="" coords="597,297,687,305,785,319,863,339,862,344,784,324,686,310,596,303"/>
<area shape="poly" title=" " alt="" coords="682,95,676,86,680,76,693,70,715,68,738,70,750,77,747,81,736,75,714,73,694,75,684,80,681,85,687,92"/>
<area shape="rect" href="namespacefc.html#a150ca4cd9c0318ca45dc0dc7df5d58b9" title=" " alt="" coords="486,25,561,50"/>
<area shape="poly" title=" " alt="" coords="397,35,471,35,471,40,397,40"/>
<area shape="poly" title=" " alt="" coords="562,49,664,86,662,91,560,54"/>
<area shape="rect" href="classfc_1_1sha256_1_1encoder.html#a4d8b8181e912194cf98a56164671adf8" title=" " alt="" coords="646,5,783,46"/>
<area shape="poly" title=" " alt="" coords="562,33,630,28,631,34,562,38"/>
<area shape="poly" title=" " alt="" coords="763,44,786,55,882,106,879,111,783,60,761,49"/>
<area shape="rect" href="classfc_1_1variant.html#acbd70a93184e4277631f2a261acb707c" title=" " alt="" coords="454,458,594,484"/>
<area shape="poly" title=" " alt="" coords="380,389,404,401,489,448,487,452,402,405,378,394"/>
<area shape="rect" href="classfc_1_1time__point.html#aa164ff1268a16d4b32afcff181f6100e" title=" " alt="" coords="458,681,590,706"/>
<area shape="poly" title=" " alt="" coords="390,390,405,401,427,442,458,515,515,665,510,667,453,517,422,444,401,405,387,394"/>
<area shape="rect" href="classfc_1_1json.html#aa6541960d7f05567559b866cfaf88dfa" title=" " alt="" coords="462,358,585,384"/>
<area shape="poly" title=" " alt="" coords="403,368,447,368,447,374,403,374"/>
<area shape="rect" href="namespacefc.html#a3668095306e6c6c4c53de5d7701e4dde" title=" " alt="" coords="649,408,780,433"/>
<area shape="poly" title=" " alt="" coords="574,455,648,435,650,440,576,460"/>
<area shape="rect" href="classfc_1_1variant.html#aa475101b0f2181350d76a2fdc6cf7c76" title=" " alt="" coords="646,509,783,534"/>
<area shape="poly" title=" " alt="" coords="576,482,650,502,648,507,574,487"/>
<area shape="rect" href="classfc_1_1variant.html#afaae1df286ff97c83301eda21dbd51ea" title=" " alt="" coords="850,484,988,509"/>
<area shape="poly" title=" " alt="" coords="594,473,835,488,834,494,594,478"/>
<area shape="rect" href="namespacefc.html#a4e07b3870aa72f8c38bdd5f78044dad1" title=" " alt="" coords="669,558,760,584"/>
<area shape="poly" title=" " alt="" coords="544,482,589,513,646,545,657,550,654,554,643,549,586,517,541,486"/>
<area shape="poly" title=" " alt="" coords="759,404,858,374,860,379,761,409"/>
<area shape="poly" title=" " alt="" coords="783,511,834,504,835,509,783,516"/>
<area shape="rect" href="classfc_1_1mock__time__traits.html#a0bed781012a73b8c15882648397b56be" title=" " alt="" coords="644,608,785,649"/>
<area shape="poly" title=" " alt="" coords="563,678,638,652,639,657,564,683"/>
<area shape="rect" href="classfc_1_1mock__time__traits.html#adddeebdf472c33f927827c111ddbf0b1" title=" " alt="" coords="644,673,785,714"/>
<area shape="poly" title=" " alt="" coords="590,691,629,691,629,696,590,696"/>
<area shape="rect" href="classfc_1_1time__point.html#ab46781dcaab4880902bc136f36e39e5e" title=" " alt="" coords="648,739,781,779"/>
<area shape="poly" title=" " alt="" coords="564,705,639,731,638,736,563,710"/>
<area shape="rect" href="classfc_1_1time__point.html#abfea5efbe9ef58024cda814395ee9945" title=" " alt="" coords="648,804,781,845"/>
<area shape="poly" title=" " alt="" coords="541,705,586,745,646,789,654,794,652,798,643,793,583,749,537,709"/>
<area shape="rect" href="classfc_1_1mock__time__traits.html#a0d7245b32fd62b3bc712f658250cc4db" title=" " alt="" coords="833,616,1005,641"/>
<area shape="poly" title=" " alt="" coords="785,626,817,626,817,631,785,631"/>
<area shape="rect" href="namespacefc.html#af9bea69c5790941ddc601fcd96cce071" title=" " alt="" coords="665,358,764,384"/>
<area shape="poly" title=" " alt="" coords="585,368,650,368,650,374,585,374"/>
<area shape="poly" title=" " alt="" coords="682,359,676,350,680,340,693,334,715,332,738,334,750,341,747,345,736,339,714,337,694,339,684,344,681,349,687,356"/>
<area shape="poly" title=" " alt="" coords="293,441,287,431,291,421,304,415,326,413,351,416,363,422,360,427,349,421,326,418,306,420,295,425,292,430,298,438"/>
</map>
</div>

</div>
</div>
<a id="a3f379acf17a88ae382a683f053192846" name="a3f379acf17a88ae382a683f053192846"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f379acf17a88ae382a683f053192846">&#9670;&#160;</a></span>BOOST_AUTO_TEST_CASE() <span class="overload">[8/26]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOST_AUTO_TEST_CASE </td>
          <td>(</td>
          <td class="paramtype">damage_sig_idx</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test__webauthn_8cpp_source.html#l00322">322</a> of file <a class="el" href="test__webauthn_8cpp_source.html">test_webauthn.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  322</span>                                         {</div>
<div class="line"><span class="lineno">  323</span>   <a class="code hl_class" href="classfc_1_1crypto_1_1webauthn_1_1public__key.html">webauthn::public_key</a> wa_pub(pub.serialize(), webauthn::public_key::user_presence_t::USER_PRESENCE_NONE, <span class="stringliteral">&quot;fctesting.invalid&quot;</span>);</div>
<div class="line"><span class="lineno">  324</span>   std::string <a class="code hl_class" href="classfc_1_1json.html">json</a> = <span class="stringliteral">&quot;{\&quot;origin\&quot;:\&quot;https://fctesting.invalid\&quot;,\&quot;type\&quot;:\&quot;webauthn.get\&quot;,\&quot;challenge\&quot;:\&quot;&quot;</span> + <a class="code hl_function" href="namespacefc.html#a4d30681e99b9cacc0c9b3b8985a5daa4">fc::base64url_encode</a>(d.<a class="code hl_function" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d">data</a>(), d.<a class="code hl_function" href="classfc_1_1sha256.html#ac7722b7428b1db345f1b7fab7f4d5774">data_size</a>()) + <span class="stringliteral">&quot;\&quot;}&quot;</span>;</div>
<div class="line"><span class="lineno">  325</span> </div>
<div class="line"><span class="lineno">  326</span>   std::vector&lt;uint8_t&gt; auth_data(37);</div>
<div class="line"><span class="lineno">  327</span>   <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(auth_data.data(), origin_hash.<a class="code hl_function" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d">data</a>(), <span class="keyword">sizeof</span>(origin_hash));</div>
<div class="line"><span class="lineno">  328</span> </div>
<div class="line"><span class="lineno">  329</span>   <a class="code hl_class" href="classfc_1_1crypto_1_1webauthn_1_1signature.html">webauthn::signature</a> sig = make_webauthn_sig(priv, auth_data, <a class="code hl_class" href="classfc_1_1json.html">json</a>);</div>
<div class="line"><span class="lineno">  330</span>   <span class="keywordtype">char</span> buff[8192];</div>
<div class="line"><span class="lineno">  331</span>   <a class="code hl_class" href="classfc_1_1datastream.html">datastream&lt;char*&gt;</a> <a class="code hl_function" href="namespace_xbyak_1_1util.html#a4b2aef26182d21706896022467868f7c">ds</a>(buff, <span class="keyword">sizeof</span>(buff));</div>
<div class="line"><span class="lineno">  332</span>   <a class="code hl_function" href="namespacefc_1_1raw.html#a3a18d8161aa5b4f4f02b6fcfdff5e5d1">fc::raw::pack</a>(ds, sig);</div>
<div class="line"><span class="lineno">  333</span>   buff[0]++;</div>
<div class="line"><span class="lineno">  334</span>   <a class="code hl_function" href="namespace_xbyak_1_1util.html#a4b2aef26182d21706896022467868f7c">ds</a>.seekp(0);</div>
<div class="line"><span class="lineno">  335</span>   <a class="code hl_function" href="namespacefc_1_1raw.html#a0b442d98ceb22dd5a6ae84745e43ffab">fc::raw::unpack</a>(ds, sig);</div>
<div class="line"><span class="lineno">  336</span> </div>
<div class="line"><span class="lineno">  337</span>   <span class="keywordtype">bool</span> failed_recovery = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  338</span>   <span class="keywordtype">bool</span> failed_compare = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  339</span>   <a class="code hl_class" href="classfc_1_1crypto_1_1webauthn_1_1public__key.html">webauthn::public_key</a> recovered_pub;</div>
<div class="line"><span class="lineno">  340</span> </div>
<div class="line"><span class="lineno">  341</span>   <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno">  342</span>      recovered_pub = sig.<a class="code hl_function" href="classfc_1_1crypto_1_1webauthn_1_1signature.html#a28633b0f40d89bedb305e2343d9ac4ca">recover</a>(d, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  343</span>      failed_compare = !(wa_pub == recovered_pub);</div>
<div class="line"><span class="lineno">  344</span>   }</div>
<div class="line"><span class="lineno">  345</span>   <span class="keywordflow">catch</span>(<a class="code hl_class" href="classfc_1_1exception.html">fc::exception</a>&amp; e) {</div>
<div class="line"><span class="lineno">  346</span>      failed_recovery = e.<a class="code hl_function" href="classfc_1_1exception.html#a7611ea8fbe25dde56649b685c2298a37">to_detail_string</a>().find(<span class="stringliteral">&quot;unable to reconstruct public key from signature&quot;</span>) != std::string::npos;</div>
<div class="line"><span class="lineno">  347</span>   }</div>
<div class="line"><span class="lineno">  348</span> </div>
<div class="line"><span class="lineno">  349</span>   <span class="comment">//We can fail either by failing to recover any key, or recovering the wrong key. Check that at least one of these failed</span></div>
<div class="line"><span class="lineno">  350</span>   BOOST_CHECK_EQUAL(failed_recovery || failed_compare, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  351</span>} <a class="code hl_function" href="#ae70bfa24f5a3bc0917382b3c17fc033c">FC_LOG_AND_RETHROW</a>();</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="test__webauthn_8cpp_a3f379acf17a88ae382a683f053192846_cgraph.png" border="0" usemap="#atest__webauthn_8cpp_a3f379acf17a88ae382a683f053192846_cgraph" alt=""/></div>
<map name="atest__webauthn_8cpp_a3f379acf17a88ae382a683f053192846_cgraph" id="atest__webauthn_8cpp_a3f379acf17a88ae382a683f053192846_cgraph">
<area shape="rect" title=" " alt="" coords="5,208,202,233"/>
<area shape="rect" href="namespacefc.html#a4d30681e99b9cacc0c9b3b8985a5daa4" title=" " alt="" coords="451,284,596,309"/>
<area shape="poly" title=" " alt="" coords="143,231,194,247,250,262,346,278,436,287,435,293,345,283,249,267,192,252,142,236"/>
<area shape="rect" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d" title=" " alt="" coords="861,117,976,142"/>
<area shape="poly" title=" " alt="" coords="202,222,299,223,403,218,525,203,647,184,846,144,847,149,648,189,526,209,403,223,299,228,202,227"/>
<area shape="rect" href="classfc_1_1sha256.html#ac7722b7428b1db345f1b7fab7f4d5774" title=" " alt="" coords="253,133,400,158"/>
<area shape="poly" title=" " alt="" coords="141,204,249,167,267,161,269,166,251,172,143,209"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="291,182,362,208"/>
<area shape="poly" title=" " alt="" coords="202,206,275,198,276,203,202,212"/>
<area shape="rect" href="namespacefc_1_1raw.html#a3a18d8161aa5b4f4f02b6fcfdff5e5d1" title=" " alt="" coords="666,94,763,120"/>
<area shape="poly" title=" " alt="" coords="116,205,171,160,208,136,249,118,302,103,357,94,467,85,569,88,651,95,650,100,568,93,467,91,358,99,303,109,251,123,211,141,174,164,120,209"/>
<area shape="rect" href="classfc_1_1crypto_1_1webauthn_1_1signature.html#a28633b0f40d89bedb305e2343d9ac4ca" title=" " alt="" coords="256,17,396,58"/>
<area shape="poly" title=" " alt="" coords="114,205,168,145,206,108,248,74,264,64,267,68,251,78,210,112,172,149,118,209"/>
<area shape="rect" href="classfc_1_1exception.html#a7611ea8fbe25dde56649b685c2298a37" title=" " alt="" coords="250,351,403,391"/>
<area shape="poly" title=" " alt="" coords="126,232,284,340,281,344,123,236"/>
<area shape="rect" href="namespacefc_1_1raw.html#a0b442d98ceb22dd5a6ae84745e43ffab" title=" " alt="" coords="271,440,382,465"/>
<area shape="poly" title=" " alt="" coords="115,232,168,308,208,356,251,401,289,429,286,433,248,405,204,359,164,311,111,235"/>
<area shape="rect" href="namespacefc.html#a7c8b089501fd00e09e068aa02eacf3de" title=" " alt="" coords="838,346,1000,372"/>
<area shape="poly" title=" " alt="" coords="597,297,687,305,785,319,863,339,862,344,784,324,686,310,596,303"/>
<area shape="poly" title=" " alt="" coords="682,95,676,86,680,76,693,70,715,68,738,70,750,77,747,81,736,75,714,73,694,75,684,80,681,85,687,92"/>
<area shape="rect" href="namespacefc.html#a150ca4cd9c0318ca45dc0dc7df5d58b9" title=" " alt="" coords="486,25,561,50"/>
<area shape="poly" title=" " alt="" coords="397,35,471,35,471,40,397,40"/>
<area shape="poly" title=" " alt="" coords="562,49,664,86,662,91,560,54"/>
<area shape="rect" href="classfc_1_1sha256_1_1encoder.html#a4d8b8181e912194cf98a56164671adf8" title=" " alt="" coords="646,5,783,46"/>
<area shape="poly" title=" " alt="" coords="562,33,630,28,631,34,562,38"/>
<area shape="poly" title=" " alt="" coords="763,44,786,55,882,106,879,111,783,60,761,49"/>
<area shape="rect" href="classfc_1_1variant.html#acbd70a93184e4277631f2a261acb707c" title=" " alt="" coords="454,458,594,484"/>
<area shape="poly" title=" " alt="" coords="380,389,404,401,489,448,487,452,402,405,378,394"/>
<area shape="rect" href="classfc_1_1time__point.html#aa164ff1268a16d4b32afcff181f6100e" title=" " alt="" coords="458,681,590,706"/>
<area shape="poly" title=" " alt="" coords="390,390,405,401,427,442,458,515,515,665,510,667,453,517,422,444,401,405,387,394"/>
<area shape="rect" href="classfc_1_1json.html#aa6541960d7f05567559b866cfaf88dfa" title=" " alt="" coords="462,358,585,384"/>
<area shape="poly" title=" " alt="" coords="403,368,447,368,447,374,403,374"/>
<area shape="rect" href="namespacefc.html#a3668095306e6c6c4c53de5d7701e4dde" title=" " alt="" coords="649,408,780,433"/>
<area shape="poly" title=" " alt="" coords="574,455,648,435,650,440,576,460"/>
<area shape="rect" href="classfc_1_1variant.html#aa475101b0f2181350d76a2fdc6cf7c76" title=" " alt="" coords="646,509,783,534"/>
<area shape="poly" title=" " alt="" coords="576,482,650,502,648,507,574,487"/>
<area shape="rect" href="classfc_1_1variant.html#afaae1df286ff97c83301eda21dbd51ea" title=" " alt="" coords="850,484,988,509"/>
<area shape="poly" title=" " alt="" coords="594,473,835,488,834,494,594,478"/>
<area shape="rect" href="namespacefc.html#a4e07b3870aa72f8c38bdd5f78044dad1" title=" " alt="" coords="669,558,760,584"/>
<area shape="poly" title=" " alt="" coords="544,482,589,513,646,545,657,550,654,554,643,549,586,517,541,486"/>
<area shape="poly" title=" " alt="" coords="759,404,858,374,860,379,761,409"/>
<area shape="poly" title=" " alt="" coords="783,511,834,504,835,509,783,516"/>
<area shape="rect" href="classfc_1_1mock__time__traits.html#a0bed781012a73b8c15882648397b56be" title=" " alt="" coords="644,608,785,649"/>
<area shape="poly" title=" " alt="" coords="563,678,638,652,639,657,564,683"/>
<area shape="rect" href="classfc_1_1mock__time__traits.html#adddeebdf472c33f927827c111ddbf0b1" title=" " alt="" coords="644,673,785,714"/>
<area shape="poly" title=" " alt="" coords="590,691,629,691,629,696,590,696"/>
<area shape="rect" href="classfc_1_1time__point.html#ab46781dcaab4880902bc136f36e39e5e" title=" " alt="" coords="648,739,781,779"/>
<area shape="poly" title=" " alt="" coords="564,705,639,731,638,736,563,710"/>
<area shape="rect" href="classfc_1_1time__point.html#abfea5efbe9ef58024cda814395ee9945" title=" " alt="" coords="648,804,781,845"/>
<area shape="poly" title=" " alt="" coords="541,705,586,745,646,789,654,794,652,798,643,793,583,749,537,709"/>
<area shape="rect" href="classfc_1_1mock__time__traits.html#a0d7245b32fd62b3bc712f658250cc4db" title=" " alt="" coords="833,616,1005,641"/>
<area shape="poly" title=" " alt="" coords="785,626,817,626,817,631,785,631"/>
<area shape="rect" href="namespacefc.html#af9bea69c5790941ddc601fcd96cce071" title=" " alt="" coords="665,358,764,384"/>
<area shape="poly" title=" " alt="" coords="585,368,650,368,650,374,585,374"/>
<area shape="poly" title=" " alt="" coords="682,359,676,350,680,340,693,334,715,332,738,334,750,341,747,345,736,339,714,337,694,339,684,344,681,349,687,356"/>
<area shape="poly" title=" " alt="" coords="293,441,287,431,291,421,304,415,326,413,351,416,363,422,360,427,349,421,326,418,306,420,295,425,292,430,298,438"/>
</map>
</div>

</div>
</div>
<a id="a297871fcd73110d766a978fe337ef1e5" name="a297871fcd73110d766a978fe337ef1e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a297871fcd73110d766a978fe337ef1e5">&#9670;&#160;</a></span>BOOST_AUTO_TEST_CASE() <span class="overload">[9/26]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOST_AUTO_TEST_CASE </td>
          <td>(</td>
          <td class="paramtype">different_priv_key</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test__webauthn_8cpp_source.html#l00354">354</a> of file <a class="el" href="test__webauthn_8cpp_source.html">test_webauthn.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  354</span>                                             {</div>
<div class="line"><span class="lineno">  355</span>   r1::private_key other_priv = <a class="code hl_function" href="classfc_1_1crypto_1_1r1_1_1private__key.html#ad71aa7d73e57ef9fd7648fb7461177fb">fc::crypto::r1::private_key::generate</a>();</div>
<div class="line"><span class="lineno">  356</span> </div>
<div class="line"><span class="lineno">  357</span>   <a class="code hl_class" href="classfc_1_1crypto_1_1webauthn_1_1public__key.html">webauthn::public_key</a> wa_pub(pub.serialize(), webauthn::public_key::user_presence_t::USER_PRESENCE_NONE, <span class="stringliteral">&quot;fctesting.invalid&quot;</span>);</div>
<div class="line"><span class="lineno">  358</span>   std::string <a class="code hl_class" href="classfc_1_1json.html">json</a> = <span class="stringliteral">&quot;{\&quot;origin\&quot;:\&quot;https://fctesting.invalid\&quot;,\&quot;type\&quot;:\&quot;webauthn.get\&quot;,\&quot;challenge\&quot;:\&quot;&quot;</span> + <a class="code hl_function" href="namespacefc.html#a4d30681e99b9cacc0c9b3b8985a5daa4">fc::base64url_encode</a>(d.<a class="code hl_function" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d">data</a>(), d.<a class="code hl_function" href="classfc_1_1sha256.html#ac7722b7428b1db345f1b7fab7f4d5774">data_size</a>()) + <span class="stringliteral">&quot;\&quot;}&quot;</span>;</div>
<div class="line"><span class="lineno">  359</span> </div>
<div class="line"><span class="lineno">  360</span>   std::vector&lt;uint8_t&gt; auth_data(37);</div>
<div class="line"><span class="lineno">  361</span>   <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(auth_data.data(), origin_hash.<a class="code hl_function" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d">data</a>(), <span class="keyword">sizeof</span>(origin_hash));</div>
<div class="line"><span class="lineno">  362</span> </div>
<div class="line"><span class="lineno">  363</span>   BOOST_CHECK_NE(wa_pub, make_webauthn_sig(other_priv, auth_data, <a class="code hl_class" href="classfc_1_1json.html">json</a>).recover(d, <span class="keyword">true</span>));</div>
<div class="line"><span class="lineno">  364</span>} <a class="code hl_function" href="#ae70bfa24f5a3bc0917382b3c17fc033c">FC_LOG_AND_RETHROW</a>();</div>
<div class="ttc" id="aclassfc_1_1crypto_1_1r1_1_1private__key_html_ad71aa7d73e57ef9fd7648fb7461177fb"><div class="ttname"><a href="classfc_1_1crypto_1_1r1_1_1private__key.html#ad71aa7d73e57ef9fd7648fb7461177fb">fc::crypto::r1::private_key::generate</a></div><div class="ttdeci">static private_key generate()</div><div class="ttdef"><b>Definition</b> <a href="elliptic__r1_8cpp_source.html#l00391">elliptic_r1.cpp:391</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="test__webauthn_8cpp_a297871fcd73110d766a978fe337ef1e5_cgraph.png" border="0" usemap="#atest__webauthn_8cpp_a297871fcd73110d766a978fe337ef1e5_cgraph" alt=""/></div>
<map name="atest__webauthn_8cpp_a297871fcd73110d766a978fe337ef1e5_cgraph" id="atest__webauthn_8cpp_a297871fcd73110d766a978fe337ef1e5_cgraph">
<area shape="rect" title=" " alt="" coords="5,104,202,130"/>
<area shape="rect" href="namespacefc.html#a4d30681e99b9cacc0c9b3b8985a5daa4" title=" " alt="" coords="250,5,396,31"/>
<area shape="poly" title=" " alt="" coords="127,101,182,72,249,40,263,34,265,39,251,45,184,76,129,106"/>
<area shape="rect" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d" title=" " alt="" coords="265,55,380,80"/>
<area shape="poly" title=" " alt="" coords="163,101,249,81,251,86,165,106"/>
<area shape="rect" href="classfc_1_1sha256.html#ac7722b7428b1db345f1b7fab7f4d5774" title=" " alt="" coords="250,104,396,130"/>
<area shape="poly" title=" " alt="" coords="202,114,234,114,234,120,202,120"/>
<area shape="rect" href="classfc_1_1crypto_1_1r1_1_1private__key.html#ad71aa7d73e57ef9fd7648fb7461177fb" title=" " alt="" coords="252,154,394,194"/>
<area shape="poly" title=" " alt="" coords="156,128,237,149,236,154,155,133"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="287,219,358,244"/>
<area shape="poly" title=" " alt="" coords="125,128,180,164,251,204,273,213,271,218,248,209,177,169,122,132"/>
<area shape="rect" href="namespacefc.html#a7c8b089501fd00e09e068aa02eacf3de" title=" " alt="" coords="444,5,606,31"/>
<area shape="poly" title=" " alt="" coords="396,16,429,16,429,21,396,21"/>
</map>
</div>

</div>
</div>
<a id="ac9a2e889a79cc815fd3d36b6f8f77724" name="ac9a2e889a79cc815fd3d36b6f8f77724"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9a2e889a79cc815fd3d36b6f8f77724">&#9670;&#160;</a></span>BOOST_AUTO_TEST_CASE() <span class="overload">[10/26]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOST_AUTO_TEST_CASE </td>
          <td>(</td>
          <td class="paramtype">empty_json</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test__webauthn_8cpp_source.html#l00367">367</a> of file <a class="el" href="test__webauthn_8cpp_source.html">test_webauthn.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  367</span>                                     {</div>
<div class="line"><span class="lineno">  368</span>   <a class="code hl_class" href="classfc_1_1crypto_1_1webauthn_1_1public__key.html">webauthn::public_key</a> wa_pub(pub.serialize(), webauthn::public_key::user_presence_t::USER_PRESENCE_NONE, <span class="stringliteral">&quot;fctesting.invalid&quot;</span>);</div>
<div class="line"><span class="lineno">  369</span>   std::string <a class="code hl_class" href="classfc_1_1json.html">json</a>;</div>
<div class="line"><span class="lineno">  370</span> </div>
<div class="line"><span class="lineno">  371</span>   std::vector&lt;uint8_t&gt; auth_data(37);</div>
<div class="line"><span class="lineno">  372</span>   <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(auth_data.data(), origin_hash.<a class="code hl_function" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d">data</a>(), <span class="keyword">sizeof</span>(origin_hash));</div>
<div class="line"><span class="lineno">  373</span> </div>
<div class="line"><span class="lineno">  374</span>   BOOST_CHECK_EXCEPTION(make_webauthn_sig(priv, auth_data, <a class="code hl_class" href="classfc_1_1json.html">json</a>).recover(d, <span class="keyword">true</span>), fc::assert_exception, [](<span class="keyword">const</span> fc::assert_exception&amp; e) {</div>
<div class="line"><span class="lineno">  375</span>      <span class="keywordflow">return</span> e.to_detail_string().find(<span class="stringliteral">&quot;Failed to parse client data JSON&quot;</span>) != std::string::npos;</div>
<div class="line"><span class="lineno">  376</span>   });</div>
<div class="line"><span class="lineno">  377</span>} <a class="code hl_function" href="#ae70bfa24f5a3bc0917382b3c17fc033c">FC_LOG_AND_RETHROW</a>();</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="test__webauthn_8cpp_ac9a2e889a79cc815fd3d36b6f8f77724_cgraph.png" border="0" usemap="#atest__webauthn_8cpp_ac9a2e889a79cc815fd3d36b6f8f77724_cgraph" alt=""/></div>
<map name="atest__webauthn_8cpp_ac9a2e889a79cc815fd3d36b6f8f77724_cgraph" id="atest__webauthn_8cpp_ac9a2e889a79cc815fd3d36b6f8f77724_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,202,56"/>
<area shape="rect" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d" title=" " alt="" coords="250,5,365,31"/>
<area shape="poly" title=" " alt="" coords="202,29,234,25,235,30,202,34"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="272,55,343,80"/>
<area shape="poly" title=" " alt="" coords="202,52,257,59,256,64,202,58"/>
</map>
</div>

</div>
</div>
<a id="a010d0b81ec2257a446d8f9e1a43a4d4f" name="a010d0b81ec2257a446d8f9e1a43a4d4f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a010d0b81ec2257a446d8f9e1a43a4d4f">&#9670;&#160;</a></span>BOOST_AUTO_TEST_CASE() <span class="overload">[11/26]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOST_AUTO_TEST_CASE </td>
          <td>(</td>
          <td class="paramtype">empty_origin</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test__webauthn_8cpp_source.html#l00110">110</a> of file <a class="el" href="test__webauthn_8cpp_source.html">test_webauthn.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  110</span>                                       {</div>
<div class="line"><span class="lineno">  111</span>   <a class="code hl_class" href="classfc_1_1crypto_1_1webauthn_1_1public__key.html">webauthn::public_key</a> wa_pub(pub.serialize(), webauthn::public_key::user_presence_t::USER_PRESENCE_NONE, <span class="stringliteral">&quot;fctesting.invalid&quot;</span>);</div>
<div class="line"><span class="lineno">  112</span>   std::string <a class="code hl_class" href="classfc_1_1json.html">json</a> = <span class="stringliteral">&quot;{\&quot;origin\&quot;:\&quot;\&quot;,\&quot;type\&quot;:\&quot;webauthn.get\&quot;,\&quot;challenge\&quot;:\&quot;&quot;</span> + <a class="code hl_function" href="namespacefc.html#a4d30681e99b9cacc0c9b3b8985a5daa4">fc::base64url_encode</a>(d.<a class="code hl_function" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d">data</a>(), d.<a class="code hl_function" href="classfc_1_1sha256.html#ac7722b7428b1db345f1b7fab7f4d5774">data_size</a>()) + <span class="stringliteral">&quot;\&quot;}&quot;</span>;</div>
<div class="line"><span class="lineno">  113</span> </div>
<div class="line"><span class="lineno">  114</span>   std::vector&lt;uint8_t&gt; auth_data(37);</div>
<div class="line"><span class="lineno">  115</span>   <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(auth_data.data(), origin_hash.<a class="code hl_function" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d">data</a>(), <span class="keyword">sizeof</span>(origin_hash));</div>
<div class="line"><span class="lineno">  116</span> </div>
<div class="line"><span class="lineno">  117</span>   BOOST_CHECK_EXCEPTION(make_webauthn_sig(priv, auth_data, <a class="code hl_class" href="classfc_1_1json.html">json</a>).recover(d, <span class="keyword">true</span>), fc::assert_exception, [](<span class="keyword">const</span> fc::assert_exception&amp; e) {</div>
<div class="line"><span class="lineno">  118</span>      <span class="keywordflow">return</span> e.to_detail_string().find(<span class="stringliteral">&quot;webauthn origin must begin with https://&quot;</span>) != std::string::npos;</div>
<div class="line"><span class="lineno">  119</span>   });</div>
<div class="line"><span class="lineno">  120</span>} <a class="code hl_function" href="#ae70bfa24f5a3bc0917382b3c17fc033c">FC_LOG_AND_RETHROW</a>();</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="test__webauthn_8cpp_a010d0b81ec2257a446d8f9e1a43a4d4f_cgraph.png" border="0" usemap="#atest__webauthn_8cpp_a010d0b81ec2257a446d8f9e1a43a4d4f_cgraph" alt=""/></div>
<map name="atest__webauthn_8cpp_a010d0b81ec2257a446d8f9e1a43a4d4f_cgraph" id="atest__webauthn_8cpp_a010d0b81ec2257a446d8f9e1a43a4d4f_cgraph">
<area shape="rect" title=" " alt="" coords="5,80,202,106"/>
<area shape="rect" href="namespacefc.html#a4d30681e99b9cacc0c9b3b8985a5daa4" title=" " alt="" coords="250,5,396,31"/>
<area shape="poly" title=" " alt="" coords="142,77,249,40,266,34,268,39,251,45,144,82"/>
<area shape="rect" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d" title=" " alt="" coords="265,55,380,80"/>
<area shape="poly" title=" " alt="" coords="201,79,250,73,250,79,202,84"/>
<area shape="rect" href="classfc_1_1sha256.html#ac7722b7428b1db345f1b7fab7f4d5774" title=" " alt="" coords="250,104,396,130"/>
<area shape="poly" title=" " alt="" coords="202,101,235,105,234,110,201,106"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="287,153,358,179"/>
<area shape="poly" title=" " alt="" coords="145,104,251,140,273,147,272,152,249,145,143,109"/>
<area shape="rect" href="namespacefc.html#a7c8b089501fd00e09e068aa02eacf3de" title=" " alt="" coords="444,5,606,31"/>
<area shape="poly" title=" " alt="" coords="396,16,429,16,429,21,396,21"/>
</map>
</div>

</div>
</div>
<a id="a4f19eaa04d61bbaa9324ee8d5ada9a90" name="a4f19eaa04d61bbaa9324ee8d5ada9a90"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f19eaa04d61bbaa9324ee8d5ada9a90">&#9670;&#160;</a></span>BOOST_AUTO_TEST_CASE() <span class="overload">[12/26]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOST_AUTO_TEST_CASE </td>
          <td>(</td>
          <td class="paramtype">empty_port</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test__webauthn_8cpp_source.html#l00134">134</a> of file <a class="el" href="test__webauthn_8cpp_source.html">test_webauthn.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  134</span>                                     {</div>
<div class="line"><span class="lineno">  135</span>   <a class="code hl_class" href="classfc_1_1crypto_1_1webauthn_1_1public__key.html">webauthn::public_key</a> wa_pub(pub.serialize(), webauthn::public_key::user_presence_t::USER_PRESENCE_NONE, <span class="stringliteral">&quot;fctesting.invalid&quot;</span>);</div>
<div class="line"><span class="lineno">  136</span>   std::string <a class="code hl_class" href="classfc_1_1json.html">json</a> = <span class="stringliteral">&quot;{\&quot;origin\&quot;:\&quot;https://fctesting.invalid:\&quot;,\&quot;type\&quot;:\&quot;webauthn.get\&quot;,\&quot;challenge\&quot;:\&quot;&quot;</span> + <a class="code hl_function" href="namespacefc.html#a4d30681e99b9cacc0c9b3b8985a5daa4">fc::base64url_encode</a>(d.<a class="code hl_function" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d">data</a>(), d.<a class="code hl_function" href="classfc_1_1sha256.html#ac7722b7428b1db345f1b7fab7f4d5774">data_size</a>()) + <span class="stringliteral">&quot;\&quot;}&quot;</span>;</div>
<div class="line"><span class="lineno">  137</span> </div>
<div class="line"><span class="lineno">  138</span>   std::vector&lt;uint8_t&gt; auth_data(37);</div>
<div class="line"><span class="lineno">  139</span>   <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(auth_data.data(), origin_hash.<a class="code hl_function" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d">data</a>(), <span class="keyword">sizeof</span>(origin_hash));</div>
<div class="line"><span class="lineno">  140</span> </div>
<div class="line"><span class="lineno">  141</span>   BOOST_CHECK_EQUAL(wa_pub, make_webauthn_sig(priv, auth_data, <a class="code hl_class" href="classfc_1_1json.html">json</a>).recover(d, <span class="keyword">true</span>));</div>
<div class="line"><span class="lineno">  142</span>} <a class="code hl_function" href="#ae70bfa24f5a3bc0917382b3c17fc033c">FC_LOG_AND_RETHROW</a>();</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="test__webauthn_8cpp_a4f19eaa04d61bbaa9324ee8d5ada9a90_cgraph.png" border="0" usemap="#atest__webauthn_8cpp_a4f19eaa04d61bbaa9324ee8d5ada9a90_cgraph" alt=""/></div>
<map name="atest__webauthn_8cpp_a4f19eaa04d61bbaa9324ee8d5ada9a90_cgraph" id="atest__webauthn_8cpp_a4f19eaa04d61bbaa9324ee8d5ada9a90_cgraph">
<area shape="rect" title=" " alt="" coords="5,80,202,106"/>
<area shape="rect" href="namespacefc.html#a4d30681e99b9cacc0c9b3b8985a5daa4" title=" " alt="" coords="250,5,396,31"/>
<area shape="poly" title=" " alt="" coords="142,77,249,40,266,34,268,39,251,45,144,82"/>
<area shape="rect" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d" title=" " alt="" coords="265,55,380,80"/>
<area shape="poly" title=" " alt="" coords="201,79,250,73,250,79,202,84"/>
<area shape="rect" href="classfc_1_1sha256.html#ac7722b7428b1db345f1b7fab7f4d5774" title=" " alt="" coords="250,104,396,130"/>
<area shape="poly" title=" " alt="" coords="202,101,235,105,234,110,201,106"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="287,153,358,179"/>
<area shape="poly" title=" " alt="" coords="145,104,251,140,273,147,272,152,249,145,143,109"/>
<area shape="rect" href="namespacefc.html#a7c8b089501fd00e09e068aa02eacf3de" title=" " alt="" coords="444,5,606,31"/>
<area shape="poly" title=" " alt="" coords="396,16,429,16,429,21,396,21"/>
</map>
</div>

</div>
</div>
<a id="adc615b5851afd2b6e5668f9311758a45" name="adc615b5851afd2b6e5668f9311758a45"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc615b5851afd2b6e5668f9311758a45">&#9670;&#160;</a></span>BOOST_AUTO_TEST_CASE() <span class="overload">[13/26]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOST_AUTO_TEST_CASE </td>
          <td>(</td>
          <td class="paramtype">empty_rpid</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test__webauthn_8cpp_source.html#l00380">380</a> of file <a class="el" href="test__webauthn_8cpp_source.html">test_webauthn.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  380</span>                                     {</div>
<div class="line"><span class="lineno">  381</span>   <span class="keywordtype">char</span> data[67] = {};</div>
<div class="line"><span class="lineno">  382</span>   <a class="code hl_class" href="classfc_1_1datastream.html">datastream&lt;char*&gt;</a> <a class="code hl_function" href="namespace_xbyak_1_1util.html#a4b2aef26182d21706896022467868f7c">ds</a>(data, <span class="keyword">sizeof</span>(data));</div>
<div class="line"><span class="lineno">  383</span>   <a class="code hl_class" href="classfc_1_1crypto_1_1webauthn_1_1public__key.html">webauthn::public_key</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a931987c85fd408a620505ee9a1aa6f58">pubkey</a>;</div>
<div class="line"><span class="lineno">  384</span> </div>
<div class="line"><span class="lineno">  385</span>   BOOST_CHECK_EXCEPTION(<a class="code hl_function" href="namespacefc_1_1raw.html#a0b442d98ceb22dd5a6ae84745e43ffab">fc::raw::unpack</a>(ds, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a931987c85fd408a620505ee9a1aa6f58">pubkey</a>), fc::assert_exception, [](<span class="keyword">const</span> fc::assert_exception&amp; e) {</div>
<div class="line"><span class="lineno">  386</span>      <span class="keywordflow">return</span> e.to_detail_string().find(<span class="stringliteral">&quot;webauthn pubkey must have non empty rpid&quot;</span>) != std::string::npos;</div>
<div class="line"><span class="lineno">  387</span>   });</div>
<div class="line"><span class="lineno">  388</span>} <a class="code hl_function" href="#ae70bfa24f5a3bc0917382b3c17fc033c">FC_LOG_AND_RETHROW</a>();</div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a931987c85fd408a620505ee9a1aa6f58"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a931987c85fd408a620505ee9a1aa6f58">pubkey</a></div><div class="ttdeci">CK_BYTE_PTR pubkey</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l04984">yubihsm_pkcs11.c:4984</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="test__webauthn_8cpp_adc615b5851afd2b6e5668f9311758a45_cgraph.png" border="0" usemap="#atest__webauthn_8cpp_adc615b5851afd2b6e5668f9311758a45_cgraph" alt=""/></div>
<map name="atest__webauthn_8cpp_adc615b5851afd2b6e5668f9311758a45_cgraph" id="atest__webauthn_8cpp_adc615b5851afd2b6e5668f9311758a45_cgraph">
<area shape="rect" title=" " alt="" coords="5,29,202,55"/>
<area shape="rect" href="namespacefc_1_1raw.html#a0b442d98ceb22dd5a6ae84745e43ffab" title=" " alt="" coords="250,29,361,55"/>
<area shape="poly" title=" " alt="" coords="202,40,234,40,234,45,202,45"/>
<area shape="poly" title=" " alt="" coords="272,31,265,21,269,11,283,5,305,3,330,5,343,12,340,17,329,10,305,8,284,10,273,15,270,20,276,27"/>
</map>
</div>

</div>
</div>
<a id="a75805940106aba536c48e0c047fc814e" name="a75805940106aba536c48e0c047fc814e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a75805940106aba536c48e0c047fc814e">&#9670;&#160;</a></span>BOOST_AUTO_TEST_CASE() <span class="overload">[14/26]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOST_AUTO_TEST_CASE </td>
          <td>(</td>
          <td class="paramtype">good</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test__webauthn_8cpp_source.html#l00048">48</a> of file <a class="el" href="test__webauthn_8cpp_source.html">test_webauthn.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   48</span>                               {</div>
<div class="line"><span class="lineno">   49</span>   <a class="code hl_class" href="classfc_1_1crypto_1_1webauthn_1_1public__key.html">webauthn::public_key</a> wa_pub(pub.serialize(), webauthn::public_key::user_presence_t::USER_PRESENCE_NONE, <span class="stringliteral">&quot;fctesting.invalid&quot;</span>);</div>
<div class="line"><span class="lineno">   50</span>   std::string <a class="code hl_class" href="classfc_1_1json.html">json</a> = <span class="stringliteral">&quot;{\&quot;origin\&quot;:\&quot;https://fctesting.invalid\&quot;,\&quot;type\&quot;:\&quot;webauthn.get\&quot;,\&quot;challenge\&quot;:\&quot;&quot;</span> + <a class="code hl_function" href="namespacefc.html#a4d30681e99b9cacc0c9b3b8985a5daa4">fc::base64url_encode</a>(d.<a class="code hl_function" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d">data</a>(), d.<a class="code hl_function" href="classfc_1_1sha256.html#ac7722b7428b1db345f1b7fab7f4d5774">data_size</a>()) + <span class="stringliteral">&quot;\&quot;}&quot;</span>;</div>
<div class="line"><span class="lineno">   51</span> </div>
<div class="line"><span class="lineno">   52</span>   std::vector&lt;uint8_t&gt; auth_data(37);</div>
<div class="line"><span class="lineno">   53</span> </div>
<div class="line"><span class="lineno">   54</span>   <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(auth_data.data(), origin_hash.<a class="code hl_function" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d">data</a>(), <span class="keyword">sizeof</span>(origin_hash));</div>
<div class="line"><span class="lineno">   55</span> </div>
<div class="line"><span class="lineno">   56</span>   BOOST_CHECK_EQUAL(wa_pub, make_webauthn_sig(priv, auth_data, <a class="code hl_class" href="classfc_1_1json.html">json</a>).recover(d, <span class="keyword">true</span>));</div>
<div class="line"><span class="lineno">   57</span>} <a class="code hl_function" href="#ae70bfa24f5a3bc0917382b3c17fc033c">FC_LOG_AND_RETHROW</a>();</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="test__webauthn_8cpp_a75805940106aba536c48e0c047fc814e_cgraph.png" border="0" usemap="#atest__webauthn_8cpp_a75805940106aba536c48e0c047fc814e_cgraph" alt=""/></div>
<map name="atest__webauthn_8cpp_a75805940106aba536c48e0c047fc814e_cgraph" id="atest__webauthn_8cpp_a75805940106aba536c48e0c047fc814e_cgraph">
<area shape="rect" title=" " alt="" coords="5,80,202,106"/>
<area shape="rect" href="namespacefc.html#a4d30681e99b9cacc0c9b3b8985a5daa4" title=" " alt="" coords="250,5,396,31"/>
<area shape="poly" title=" " alt="" coords="142,77,249,40,266,34,268,39,251,45,144,82"/>
<area shape="rect" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d" title=" " alt="" coords="265,55,380,80"/>
<area shape="poly" title=" " alt="" coords="201,79,250,73,250,79,202,84"/>
<area shape="rect" href="classfc_1_1sha256.html#ac7722b7428b1db345f1b7fab7f4d5774" title=" " alt="" coords="250,104,396,130"/>
<area shape="poly" title=" " alt="" coords="202,101,235,105,234,110,201,106"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="287,153,358,179"/>
<area shape="poly" title=" " alt="" coords="145,104,251,140,273,147,272,152,249,145,143,109"/>
<area shape="rect" href="namespacefc.html#a7c8b089501fd00e09e068aa02eacf3de" title=" " alt="" coords="444,5,606,31"/>
<area shape="poly" title=" " alt="" coords="396,16,429,16,429,21,396,21"/>
</map>
</div>

</div>
</div>
<a id="a4fa4b484f47ac1bf70c7b2c99a91c9fb" name="a4fa4b484f47ac1bf70c7b2c99a91c9fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4fa4b484f47ac1bf70c7b2c99a91c9fb">&#9670;&#160;</a></span>BOOST_AUTO_TEST_CASE() <span class="overload">[15/26]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOST_AUTO_TEST_CASE </td>
          <td>(</td>
          <td class="paramtype">good_extrajunk</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test__webauthn_8cpp_source.html#l00265">265</a> of file <a class="el" href="test__webauthn_8cpp_source.html">test_webauthn.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  265</span>                                         {</div>
<div class="line"><span class="lineno">  266</span>   <a class="code hl_class" href="classfc_1_1crypto_1_1webauthn_1_1public__key.html">webauthn::public_key</a> wa_pub(pub.serialize(), webauthn::public_key::user_presence_t::USER_PRESENCE_NONE, <span class="stringliteral">&quot;fctesting.invalid&quot;</span>);</div>
<div class="line"><span class="lineno">  267</span>   std::string <a class="code hl_class" href="classfc_1_1json.html">json</a> = <span class="stringliteral">&quot;{\&quot;origin\&quot;:\&quot;https://fctesting.invalid\&quot;,\&quot;cool\&quot;:\&quot;beans\&quot;,\&quot;obj\&quot;:{\&quot;array\&quot;:[4, 5, 6]},&quot;</span></div>
<div class="line"><span class="lineno">  268</span>                      <span class="stringliteral">&quot;\&quot;type\&quot;:\&quot;webauthn.get\&quot;,\&quot;answer\&quot;: 42 ,\&quot;challenge\&quot;:\&quot;&quot;</span> + <a class="code hl_function" href="namespacefc.html#a4d30681e99b9cacc0c9b3b8985a5daa4">fc::base64url_encode</a>(d.<a class="code hl_function" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d">data</a>(), d.<a class="code hl_function" href="classfc_1_1sha256.html#ac7722b7428b1db345f1b7fab7f4d5774">data_size</a>()) + <span class="stringliteral">&quot;\&quot;}&quot;</span>;</div>
<div class="line"><span class="lineno">  269</span> </div>
<div class="line"><span class="lineno">  270</span>   std::vector&lt;uint8_t&gt; auth_data(37);</div>
<div class="line"><span class="lineno">  271</span>   <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(auth_data.data(), origin_hash.<a class="code hl_function" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d">data</a>(), <span class="keyword">sizeof</span>(origin_hash));</div>
<div class="line"><span class="lineno">  272</span> </div>
<div class="line"><span class="lineno">  273</span>   BOOST_CHECK_EQUAL(wa_pub, make_webauthn_sig(priv, auth_data, <a class="code hl_class" href="classfc_1_1json.html">json</a>).recover(d, <span class="keyword">true</span>));</div>
<div class="line"><span class="lineno">  274</span>} <a class="code hl_function" href="#ae70bfa24f5a3bc0917382b3c17fc033c">FC_LOG_AND_RETHROW</a>();</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="test__webauthn_8cpp_a4fa4b484f47ac1bf70c7b2c99a91c9fb_cgraph.png" border="0" usemap="#atest__webauthn_8cpp_a4fa4b484f47ac1bf70c7b2c99a91c9fb_cgraph" alt=""/></div>
<map name="atest__webauthn_8cpp_a4fa4b484f47ac1bf70c7b2c99a91c9fb_cgraph" id="atest__webauthn_8cpp_a4fa4b484f47ac1bf70c7b2c99a91c9fb_cgraph">
<area shape="rect" title=" " alt="" coords="5,80,202,106"/>
<area shape="rect" href="namespacefc.html#a4d30681e99b9cacc0c9b3b8985a5daa4" title=" " alt="" coords="250,5,396,31"/>
<area shape="poly" title=" " alt="" coords="142,77,249,40,266,34,268,39,251,45,144,82"/>
<area shape="rect" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d" title=" " alt="" coords="265,55,380,80"/>
<area shape="poly" title=" " alt="" coords="201,79,250,73,250,79,202,84"/>
<area shape="rect" href="classfc_1_1sha256.html#ac7722b7428b1db345f1b7fab7f4d5774" title=" " alt="" coords="250,104,396,130"/>
<area shape="poly" title=" " alt="" coords="202,101,235,105,234,110,201,106"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="287,153,358,179"/>
<area shape="poly" title=" " alt="" coords="145,104,251,140,273,147,272,152,249,145,143,109"/>
<area shape="rect" href="namespacefc.html#a7c8b089501fd00e09e068aa02eacf3de" title=" " alt="" coords="444,5,606,31"/>
<area shape="poly" title=" " alt="" coords="396,16,429,16,429,21,396,21"/>
</map>
</div>

</div>
</div>
<a id="a15cf1d57bbd4118800b640e96c012cd2" name="a15cf1d57bbd4118800b640e96c012cd2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a15cf1d57bbd4118800b640e96c012cd2">&#9670;&#160;</a></span>BOOST_AUTO_TEST_CASE() <span class="overload">[16/26]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOST_AUTO_TEST_CASE </td>
          <td>(</td>
          <td class="paramtype">good_no_trailing_equal</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test__webauthn_8cpp_source.html#l00391">391</a> of file <a class="el" href="test__webauthn_8cpp_source.html">test_webauthn.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  391</span>                                                 {</div>
<div class="line"><span class="lineno">  392</span>   <a class="code hl_class" href="classfc_1_1crypto_1_1webauthn_1_1public__key.html">webauthn::public_key</a> wa_pub(pub.serialize(), webauthn::public_key::user_presence_t::USER_PRESENCE_NONE, <span class="stringliteral">&quot;fctesting.invalid&quot;</span>);</div>
<div class="line"><span class="lineno">  393</span> </div>
<div class="line"><span class="lineno">  394</span>   std::string <a class="code hl_class" href="classfc_1_1json.html">json</a> = <span class="stringliteral">&quot;{\&quot;origin\&quot;:\&quot;https://fctesting.invalid\&quot;,\&quot;type\&quot;:\&quot;webauthn.get\&quot;,\&quot;challenge\&quot;:\&quot;&quot;</span> + <a class="code hl_function" href="namespacefc.html#a4d30681e99b9cacc0c9b3b8985a5daa4">fc::base64url_encode</a>(d.<a class="code hl_function" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d">data</a>(), d.<a class="code hl_function" href="classfc_1_1sha256.html#ac7722b7428b1db345f1b7fab7f4d5774">data_size</a>()) + <span class="stringliteral">&quot;\&quot;}&quot;</span>;</div>
<div class="line"><span class="lineno">  395</span>   boost::erase_all(<a class="code hl_class" href="classfc_1_1json.html">json</a>, <span class="stringliteral">&quot;=&quot;</span>);</div>
<div class="line"><span class="lineno">  396</span> </div>
<div class="line"><span class="lineno">  397</span>   std::vector&lt;uint8_t&gt; auth_data(37);</div>
<div class="line"><span class="lineno">  398</span>   <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(auth_data.data(), origin_hash.<a class="code hl_function" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d">data</a>(), <span class="keyword">sizeof</span>(origin_hash));</div>
<div class="line"><span class="lineno">  399</span> </div>
<div class="line"><span class="lineno">  400</span>   BOOST_CHECK_EQUAL(wa_pub, make_webauthn_sig(priv, auth_data, <a class="code hl_class" href="classfc_1_1json.html">json</a>).recover(d, <span class="keyword">true</span>));</div>
<div class="line"><span class="lineno">  401</span>} <a class="code hl_function" href="#ae70bfa24f5a3bc0917382b3c17fc033c">FC_LOG_AND_RETHROW</a>();</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="test__webauthn_8cpp_a15cf1d57bbd4118800b640e96c012cd2_cgraph.png" border="0" usemap="#atest__webauthn_8cpp_a15cf1d57bbd4118800b640e96c012cd2_cgraph" alt=""/></div>
<map name="atest__webauthn_8cpp_a15cf1d57bbd4118800b640e96c012cd2_cgraph" id="atest__webauthn_8cpp_a15cf1d57bbd4118800b640e96c012cd2_cgraph">
<area shape="rect" title=" " alt="" coords="5,80,202,106"/>
<area shape="rect" href="namespacefc.html#a4d30681e99b9cacc0c9b3b8985a5daa4" title=" " alt="" coords="250,5,396,31"/>
<area shape="poly" title=" " alt="" coords="142,77,249,40,266,34,268,39,251,45,144,82"/>
<area shape="rect" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d" title=" " alt="" coords="265,55,380,80"/>
<area shape="poly" title=" " alt="" coords="201,79,250,73,250,79,202,84"/>
<area shape="rect" href="classfc_1_1sha256.html#ac7722b7428b1db345f1b7fab7f4d5774" title=" " alt="" coords="250,104,396,130"/>
<area shape="poly" title=" " alt="" coords="202,101,235,105,234,110,201,106"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="287,153,358,179"/>
<area shape="poly" title=" " alt="" coords="145,104,251,140,273,147,272,152,249,145,143,109"/>
<area shape="rect" href="namespacefc.html#a7c8b089501fd00e09e068aa02eacf3de" title=" " alt="" coords="444,5,606,31"/>
<area shape="poly" title=" " alt="" coords="396,16,429,16,429,21,396,21"/>
</map>
</div>

</div>
</div>
<a id="aae90fa97d890394d420629752fef64df" name="aae90fa97d890394d420629752fef64df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae90fa97d890394d420629752fef64df">&#9670;&#160;</a></span>BOOST_AUTO_TEST_CASE() <span class="overload">[17/26]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOST_AUTO_TEST_CASE </td>
          <td>(</td>
          <td class="paramtype">good_port</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test__webauthn_8cpp_source.html#l00123">123</a> of file <a class="el" href="test__webauthn_8cpp_source.html">test_webauthn.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  123</span>                                    {</div>
<div class="line"><span class="lineno">  124</span>   <a class="code hl_class" href="classfc_1_1crypto_1_1webauthn_1_1public__key.html">webauthn::public_key</a> wa_pub(pub.serialize(), webauthn::public_key::user_presence_t::USER_PRESENCE_NONE, <span class="stringliteral">&quot;fctesting.invalid&quot;</span>);</div>
<div class="line"><span class="lineno">  125</span>   std::string <a class="code hl_class" href="classfc_1_1json.html">json</a> = <span class="stringliteral">&quot;{\&quot;origin\&quot;:\&quot;https://fctesting.invalid:123456\&quot;,\&quot;type\&quot;:\&quot;webauthn.get\&quot;,\&quot;challenge\&quot;:\&quot;&quot;</span> + <a class="code hl_function" href="namespacefc.html#a4d30681e99b9cacc0c9b3b8985a5daa4">fc::base64url_encode</a>(d.<a class="code hl_function" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d">data</a>(), d.<a class="code hl_function" href="classfc_1_1sha256.html#ac7722b7428b1db345f1b7fab7f4d5774">data_size</a>()) + <span class="stringliteral">&quot;\&quot;}&quot;</span>;</div>
<div class="line"><span class="lineno">  126</span> </div>
<div class="line"><span class="lineno">  127</span>   std::vector&lt;uint8_t&gt; auth_data(37);</div>
<div class="line"><span class="lineno">  128</span>   <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(auth_data.data(), origin_hash.<a class="code hl_function" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d">data</a>(), <span class="keyword">sizeof</span>(origin_hash));</div>
<div class="line"><span class="lineno">  129</span> </div>
<div class="line"><span class="lineno">  130</span>   BOOST_CHECK_EQUAL(wa_pub, make_webauthn_sig(priv, auth_data, <a class="code hl_class" href="classfc_1_1json.html">json</a>).recover(d, <span class="keyword">true</span>));</div>
<div class="line"><span class="lineno">  131</span>} <a class="code hl_function" href="#ae70bfa24f5a3bc0917382b3c17fc033c">FC_LOG_AND_RETHROW</a>();</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="test__webauthn_8cpp_aae90fa97d890394d420629752fef64df_cgraph.png" border="0" usemap="#atest__webauthn_8cpp_aae90fa97d890394d420629752fef64df_cgraph" alt=""/></div>
<map name="atest__webauthn_8cpp_aae90fa97d890394d420629752fef64df_cgraph" id="atest__webauthn_8cpp_aae90fa97d890394d420629752fef64df_cgraph">
<area shape="rect" title=" " alt="" coords="5,80,202,106"/>
<area shape="rect" href="namespacefc.html#a4d30681e99b9cacc0c9b3b8985a5daa4" title=" " alt="" coords="250,5,396,31"/>
<area shape="poly" title=" " alt="" coords="142,77,249,40,266,34,268,39,251,45,144,82"/>
<area shape="rect" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d" title=" " alt="" coords="265,55,380,80"/>
<area shape="poly" title=" " alt="" coords="201,79,250,73,250,79,202,84"/>
<area shape="rect" href="classfc_1_1sha256.html#ac7722b7428b1db345f1b7fab7f4d5774" title=" " alt="" coords="250,104,396,130"/>
<area shape="poly" title=" " alt="" coords="202,101,235,105,234,110,201,106"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="287,153,358,179"/>
<area shape="poly" title=" " alt="" coords="145,104,251,140,273,147,272,152,249,145,143,109"/>
<area shape="rect" href="namespacefc.html#a7c8b089501fd00e09e068aa02eacf3de" title=" " alt="" coords="444,5,606,31"/>
<area shape="poly" title=" " alt="" coords="396,16,429,16,429,21,396,21"/>
</map>
</div>

</div>
</div>
<a id="a1a4dc27ff697dc8d69cbd8bfd3e41853" name="a1a4dc27ff697dc8d69cbd8bfd3e41853"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a4dc27ff697dc8d69cbd8bfd3e41853">&#9670;&#160;</a></span>BOOST_AUTO_TEST_CASE() <span class="overload">[18/26]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOST_AUTO_TEST_CASE </td>
          <td>(</td>
          <td class="paramtype">lacking_scheme</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test__webauthn_8cpp_source.html#l00097">97</a> of file <a class="el" href="test__webauthn_8cpp_source.html">test_webauthn.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   97</span>                                         {</div>
<div class="line"><span class="lineno">   98</span>   <a class="code hl_class" href="classfc_1_1crypto_1_1webauthn_1_1public__key.html">webauthn::public_key</a> wa_pub(pub.serialize(), webauthn::public_key::user_presence_t::USER_PRESENCE_NONE, <span class="stringliteral">&quot;fctesting.invalid&quot;</span>);</div>
<div class="line"><span class="lineno">   99</span>   std::string <a class="code hl_class" href="classfc_1_1json.html">json</a> = <span class="stringliteral">&quot;{\&quot;origin\&quot;:\&quot;fctesting.invalid\&quot;,\&quot;type\&quot;:\&quot;webauthn.get\&quot;,\&quot;challenge\&quot;:\&quot;&quot;</span> + <a class="code hl_function" href="namespacefc.html#a4d30681e99b9cacc0c9b3b8985a5daa4">fc::base64url_encode</a>(d.<a class="code hl_function" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d">data</a>(), d.<a class="code hl_function" href="classfc_1_1sha256.html#ac7722b7428b1db345f1b7fab7f4d5774">data_size</a>()) + <span class="stringliteral">&quot;\&quot;}&quot;</span>;</div>
<div class="line"><span class="lineno">  100</span> </div>
<div class="line"><span class="lineno">  101</span>   std::vector&lt;uint8_t&gt; auth_data(37);</div>
<div class="line"><span class="lineno">  102</span>   <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(auth_data.data(), origin_hash.<a class="code hl_function" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d">data</a>(), <span class="keyword">sizeof</span>(origin_hash));</div>
<div class="line"><span class="lineno">  103</span> </div>
<div class="line"><span class="lineno">  104</span>   BOOST_CHECK_EXCEPTION(make_webauthn_sig(priv, auth_data, <a class="code hl_class" href="classfc_1_1json.html">json</a>).recover(d, <span class="keyword">true</span>), fc::assert_exception, [](<span class="keyword">const</span> fc::assert_exception&amp; e) {</div>
<div class="line"><span class="lineno">  105</span>      <span class="keywordflow">return</span> e.to_detail_string().find(<span class="stringliteral">&quot;webauthn origin must begin with https://&quot;</span>) != std::string::npos;</div>
<div class="line"><span class="lineno">  106</span>   });</div>
<div class="line"><span class="lineno">  107</span>} <a class="code hl_function" href="#ae70bfa24f5a3bc0917382b3c17fc033c">FC_LOG_AND_RETHROW</a>();</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="test__webauthn_8cpp_a1a4dc27ff697dc8d69cbd8bfd3e41853_cgraph.png" border="0" usemap="#atest__webauthn_8cpp_a1a4dc27ff697dc8d69cbd8bfd3e41853_cgraph" alt=""/></div>
<map name="atest__webauthn_8cpp_a1a4dc27ff697dc8d69cbd8bfd3e41853_cgraph" id="atest__webauthn_8cpp_a1a4dc27ff697dc8d69cbd8bfd3e41853_cgraph">
<area shape="rect" title=" " alt="" coords="5,80,202,106"/>
<area shape="rect" href="namespacefc.html#a4d30681e99b9cacc0c9b3b8985a5daa4" title=" " alt="" coords="250,5,396,31"/>
<area shape="poly" title=" " alt="" coords="142,77,249,40,266,34,268,39,251,45,144,82"/>
<area shape="rect" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d" title=" " alt="" coords="265,55,380,80"/>
<area shape="poly" title=" " alt="" coords="201,79,250,73,250,79,202,84"/>
<area shape="rect" href="classfc_1_1sha256.html#ac7722b7428b1db345f1b7fab7f4d5774" title=" " alt="" coords="250,104,396,130"/>
<area shape="poly" title=" " alt="" coords="202,101,235,105,234,110,201,106"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="287,153,358,179"/>
<area shape="poly" title=" " alt="" coords="145,104,251,140,273,147,272,152,249,145,143,109"/>
<area shape="rect" href="namespacefc.html#a7c8b089501fd00e09e068aa02eacf3de" title=" " alt="" coords="444,5,606,31"/>
<area shape="poly" title=" " alt="" coords="396,16,429,16,429,21,396,21"/>
</map>
</div>

</div>
</div>
<a id="a2a1d2f05f67659071e22f320ef91c0ef" name="a2a1d2f05f67659071e22f320ef91c0ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a1d2f05f67659071e22f320ef91c0ef">&#9670;&#160;</a></span>BOOST_AUTO_TEST_CASE() <span class="overload">[19/26]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOST_AUTO_TEST_CASE </td>
          <td>(</td>
          <td class="paramtype">mismatch_origin</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test__webauthn_8cpp_source.html#l00072">72</a> of file <a class="el" href="test__webauthn_8cpp_source.html">test_webauthn.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   72</span>                                          {</div>
<div class="line"><span class="lineno">   73</span>   <a class="code hl_class" href="classfc_1_1crypto_1_1webauthn_1_1public__key.html">webauthn::public_key</a> wa_pub(pub.serialize(), webauthn::public_key::user_presence_t::USER_PRESENCE_PRESENT, <span class="stringliteral">&quot;fctesting.invalid&quot;</span>);</div>
<div class="line"><span class="lineno">   74</span>   std::string <a class="code hl_class" href="classfc_1_1json.html">json</a> = <span class="stringliteral">&quot;{\&quot;origin\&quot;:\&quot;https://mallory.invalid\&quot;,\&quot;type\&quot;:\&quot;webauthn.get\&quot;,\&quot;challenge\&quot;:\&quot;&quot;</span> + <a class="code hl_function" href="namespacefc.html#a4d30681e99b9cacc0c9b3b8985a5daa4">fc::base64url_encode</a>(d.<a class="code hl_function" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d">data</a>(), d.<a class="code hl_function" href="classfc_1_1sha256.html#ac7722b7428b1db345f1b7fab7f4d5774">data_size</a>()) + <span class="stringliteral">&quot;\&quot;}&quot;</span>;</div>
<div class="line"><span class="lineno">   75</span> </div>
<div class="line"><span class="lineno">   76</span>   std::vector&lt;uint8_t&gt; auth_data(37);</div>
<div class="line"><span class="lineno">   77</span>   <a class="code hl_class" href="classfc_1_1sha256.html">fc::sha256</a> mallory_origin_hash = <a class="code hl_function" href="classfc_1_1sha256.html#a474784de7d6213b855abd7e952df5e36">fc::sha256::hash</a>(<span class="stringliteral">&quot;mallory.invalid&quot;</span><a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a>);</div>
<div class="line"><span class="lineno">   78</span>   <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(auth_data.data(), mallory_origin_hash.<a class="code hl_function" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d">data</a>(), <span class="keyword">sizeof</span>(mallory_origin_hash));</div>
<div class="line"><span class="lineno">   79</span> </div>
<div class="line"><span class="lineno">   80</span>   BOOST_CHECK_NE(wa_pub, make_webauthn_sig(priv, auth_data, <a class="code hl_class" href="classfc_1_1json.html">json</a>).recover(d, <span class="keyword">true</span>));</div>
<div class="line"><span class="lineno">   81</span>} <a class="code hl_function" href="#ae70bfa24f5a3bc0917382b3c17fc033c">FC_LOG_AND_RETHROW</a>();</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="test__webauthn_8cpp_a2a1d2f05f67659071e22f320ef91c0ef_cgraph.png" border="0" usemap="#atest__webauthn_8cpp_a2a1d2f05f67659071e22f320ef91c0ef_cgraph" alt=""/></div>
<map name="atest__webauthn_8cpp_a2a1d2f05f67659071e22f320ef91c0ef_cgraph" id="atest__webauthn_8cpp_a2a1d2f05f67659071e22f320ef91c0ef_cgraph">
<area shape="rect" title=" " alt="" coords="5,107,202,132"/>
<area shape="rect" href="namespacefc.html#a4d30681e99b9cacc0c9b3b8985a5daa4" title=" " alt="" coords="250,5,396,31"/>
<area shape="poly" title=" " alt="" coords="131,104,249,48,276,35,278,40,251,53,133,109"/>
<area shape="rect" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d" title=" " alt="" coords="654,85,770,111"/>
<area shape="poly" title=" " alt="" coords="168,103,249,92,355,86,462,85,639,91,639,96,462,90,356,91,250,97,168,109"/>
<area shape="rect" href="classfc_1_1sha256.html#ac7722b7428b1db345f1b7fab7f4d5774" title=" " alt="" coords="250,107,396,132"/>
<area shape="poly" title=" " alt="" coords="202,117,234,117,234,122,202,122"/>
<area shape="rect" href="classfc_1_1sha256.html#a474784de7d6213b855abd7e952df5e36" title=" " alt="" coords="264,156,382,182"/>
<area shape="poly" title=" " alt="" coords="165,130,249,150,248,155,163,136"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="287,205,358,231"/>
<area shape="poly" title=" " alt="" coords="129,130,184,160,251,192,273,200,271,205,249,197,182,165,127,135"/>
<area shape="rect" href="namespacefc.html#a7c8b089501fd00e09e068aa02eacf3de" title=" " alt="" coords="444,5,606,31"/>
<area shape="poly" title=" " alt="" coords="396,16,429,16,429,21,396,21"/>
<area shape="rect" href="classfc_1_1sha256_1_1encoder.html#a4d8b8181e912194cf98a56164671adf8" title=" " alt="" coords="457,106,593,146"/>
<area shape="poly" title=" " alt="" coords="382,154,441,141,442,146,383,159"/>
<area shape="rect" href="classfc_1_1sha256_1_1encoder.html#a4a246dfb33e3eb78ba167446bee92e30" title=" " alt="" coords="457,171,593,212"/>
<area shape="poly" title=" " alt="" coords="383,173,442,180,441,185,382,178"/>
<area shape="poly" title=" " alt="" coords="593,113,638,106,639,112,594,119"/>
</map>
</div>

</div>
</div>
<a id="a8f1802f977a71adb7942a40d8e9f6c47" name="a8f1802f977a71adb7942a40d8e9f6c47"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f1802f977a71adb7942a40d8e9f6c47">&#9670;&#160;</a></span>BOOST_AUTO_TEST_CASE() <span class="overload">[20/26]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOST_AUTO_TEST_CASE </td>
          <td>(</td>
          <td class="paramtype">mismatch_presence</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test__webauthn_8cpp_source.html#l00060">60</a> of file <a class="el" href="test__webauthn_8cpp_source.html">test_webauthn.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   60</span>                                            {</div>
<div class="line"><span class="lineno">   61</span>   <a class="code hl_class" href="classfc_1_1crypto_1_1webauthn_1_1public__key.html">webauthn::public_key</a> wa_pub(pub.serialize(), webauthn::public_key::user_presence_t::USER_PRESENCE_PRESENT, <span class="stringliteral">&quot;fctesting.invalid&quot;</span>);</div>
<div class="line"><span class="lineno">   62</span>   std::string <a class="code hl_class" href="classfc_1_1json.html">json</a> = <span class="stringliteral">&quot;{\&quot;origin\&quot;:\&quot;https://fctesting.invalid\&quot;,\&quot;type\&quot;:\&quot;webauthn.get\&quot;,\&quot;challenge\&quot;:\&quot;&quot;</span> + <a class="code hl_function" href="namespacefc.html#a4d30681e99b9cacc0c9b3b8985a5daa4">fc::base64url_encode</a>(d.<a class="code hl_function" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d">data</a>(), d.<a class="code hl_function" href="classfc_1_1sha256.html#ac7722b7428b1db345f1b7fab7f4d5774">data_size</a>()) + <span class="stringliteral">&quot;\&quot;}&quot;</span>;</div>
<div class="line"><span class="lineno">   63</span> </div>
<div class="line"><span class="lineno">   64</span>   std::vector&lt;uint8_t&gt; auth_data(37);</div>
<div class="line"><span class="lineno">   65</span>   <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(auth_data.data(), origin_hash.<a class="code hl_function" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d">data</a>(), <span class="keyword">sizeof</span>(origin_hash));</div>
<div class="line"><span class="lineno">   66</span>   auth_data[32] |= 0x04; <span class="comment">//User presence verified</span></div>
<div class="line"><span class="lineno">   67</span> </div>
<div class="line"><span class="lineno">   68</span>   BOOST_CHECK_NE(wa_pub, make_webauthn_sig(priv, auth_data, <a class="code hl_class" href="classfc_1_1json.html">json</a>).recover(d, <span class="keyword">true</span>));</div>
<div class="line"><span class="lineno">   69</span>} <a class="code hl_function" href="#ae70bfa24f5a3bc0917382b3c17fc033c">FC_LOG_AND_RETHROW</a>();</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="test__webauthn_8cpp_a8f1802f977a71adb7942a40d8e9f6c47_cgraph.png" border="0" usemap="#atest__webauthn_8cpp_a8f1802f977a71adb7942a40d8e9f6c47_cgraph" alt=""/></div>
<map name="atest__webauthn_8cpp_a8f1802f977a71adb7942a40d8e9f6c47_cgraph" id="atest__webauthn_8cpp_a8f1802f977a71adb7942a40d8e9f6c47_cgraph">
<area shape="rect" title=" " alt="" coords="5,80,202,106"/>
<area shape="rect" href="namespacefc.html#a4d30681e99b9cacc0c9b3b8985a5daa4" title=" " alt="" coords="250,5,396,31"/>
<area shape="poly" title=" " alt="" coords="142,77,249,40,266,34,268,39,251,45,144,82"/>
<area shape="rect" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d" title=" " alt="" coords="265,55,380,80"/>
<area shape="poly" title=" " alt="" coords="201,79,250,73,250,79,202,84"/>
<area shape="rect" href="classfc_1_1sha256.html#ac7722b7428b1db345f1b7fab7f4d5774" title=" " alt="" coords="250,104,396,130"/>
<area shape="poly" title=" " alt="" coords="202,101,235,105,234,110,201,106"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="287,153,358,179"/>
<area shape="poly" title=" " alt="" coords="145,104,251,140,273,147,272,152,249,145,143,109"/>
<area shape="rect" href="namespacefc.html#a7c8b089501fd00e09e068aa02eacf3de" title=" " alt="" coords="444,5,606,31"/>
<area shape="poly" title=" " alt="" coords="396,16,429,16,429,21,396,21"/>
</map>
</div>

</div>
</div>
<a id="a0c364fa12210f90fb306e3948cd3e5b0" name="a0c364fa12210f90fb306e3948cd3e5b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c364fa12210f90fb306e3948cd3e5b0">&#9670;&#160;</a></span>BOOST_AUTO_TEST_CASE() <span class="overload">[21/26]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOST_AUTO_TEST_CASE </td>
          <td>(</td>
          <td class="paramtype">missing_challenge</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test__webauthn_8cpp_source.html#l00252">252</a> of file <a class="el" href="test__webauthn_8cpp_source.html">test_webauthn.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  252</span>                                            {</div>
<div class="line"><span class="lineno">  253</span>   <a class="code hl_class" href="classfc_1_1crypto_1_1webauthn_1_1public__key.html">webauthn::public_key</a> wa_pub(pub.serialize(), webauthn::public_key::user_presence_t::USER_PRESENCE_NONE, <span class="stringliteral">&quot;fctesting.invalid&quot;</span>);</div>
<div class="line"><span class="lineno">  254</span>   std::string <a class="code hl_class" href="classfc_1_1json.html">json</a> = <span class="stringliteral">&quot;{\&quot;origin\&quot;:\&quot;https://fctesting.invalid\&quot;,\&quot;type\&quot;:\&quot;webauthn.get\&quot;}&quot;</span>;</div>
<div class="line"><span class="lineno">  255</span> </div>
<div class="line"><span class="lineno">  256</span>   std::vector&lt;uint8_t&gt; auth_data(37);</div>
<div class="line"><span class="lineno">  257</span>   <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(auth_data.data(), origin_hash.<a class="code hl_function" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d">data</a>(), <span class="keyword">sizeof</span>(origin_hash));</div>
<div class="line"><span class="lineno">  258</span> </div>
<div class="line"><span class="lineno">  259</span>   BOOST_CHECK_EXCEPTION(make_webauthn_sig(priv, auth_data, <a class="code hl_class" href="classfc_1_1json.html">json</a>).recover(d, <span class="keyword">true</span>), <a class="code hl_class" href="classfc_1_1exception.html">fc::exception</a>, [](<span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1exception.html">fc::exception</a>&amp; e) {</div>
<div class="line"><span class="lineno">  260</span>      <span class="keywordflow">return</span> e.<a class="code hl_function" href="classfc_1_1exception.html#a7611ea8fbe25dde56649b685c2298a37">to_detail_string</a>().find(<span class="stringliteral">&quot;sha256: size mismatch&quot;</span>) != std::string::npos;</div>
<div class="line"><span class="lineno">  261</span>   });</div>
<div class="line"><span class="lineno">  262</span>} <a class="code hl_function" href="#ae70bfa24f5a3bc0917382b3c17fc033c">FC_LOG_AND_RETHROW</a>();</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="test__webauthn_8cpp_a0c364fa12210f90fb306e3948cd3e5b0_cgraph.png" border="0" usemap="#atest__webauthn_8cpp_a0c364fa12210f90fb306e3948cd3e5b0_cgraph" alt=""/></div>
<map name="atest__webauthn_8cpp_a0c364fa12210f90fb306e3948cd3e5b0_cgraph" id="atest__webauthn_8cpp_a0c364fa12210f90fb306e3948cd3e5b0_cgraph">
<area shape="rect" title=" " alt="" coords="5,255,202,280"/>
<area shape="rect" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d" title=" " alt="" coords="269,205,384,231"/>
<area shape="poly" title=" " alt="" coords="164,251,253,232,254,237,166,257"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="291,255,362,280"/>
<area shape="poly" title=" " alt="" coords="202,265,276,265,276,270,202,270"/>
<area shape="rect" href="classfc_1_1exception.html#a7611ea8fbe25dde56649b685c2298a37" title=" " alt="" coords="250,304,403,345"/>
<area shape="poly" title=" " alt="" coords="157,278,235,299,234,304,156,284"/>
<area shape="rect" href="classfc_1_1variant.html#acbd70a93184e4277631f2a261acb707c" title=" " alt="" coords="451,105,591,131"/>
<area shape="poly" title=" " alt="" coords="385,302,401,291,436,256,465,216,506,144,510,146,470,219,440,259,405,295,388,306"/>
<area shape="rect" href="classfc_1_1time__point.html#aa164ff1268a16d4b32afcff181f6100e" title=" " alt="" coords="455,312,587,338"/>
<area shape="poly" title=" " alt="" coords="404,322,439,322,439,328,404,328"/>
<area shape="rect" href="classfc_1_1json.html#aa6541960d7f05567559b866cfaf88dfa" title=" " alt="" coords="460,409,582,435"/>
<area shape="poly" title=" " alt="" coords="370,343,481,400,479,404,368,348"/>
<area shape="rect" href="namespacefc.html#a3668095306e6c6c4c53de5d7701e4dde" title=" " alt="" coords="644,5,775,31"/>
<area shape="poly" title=" " alt="" coords="538,103,582,72,638,40,649,35,652,40,641,45,585,77,541,107"/>
<area shape="rect" href="classfc_1_1variant.html#aa475101b0f2181350d76a2fdc6cf7c76" title=" " alt="" coords="641,55,778,80"/>
<area shape="poly" title=" " alt="" coords="571,102,644,82,645,87,572,107"/>
<area shape="rect" href="classfc_1_1variant.html#afaae1df286ff97c83301eda21dbd51ea" title=" " alt="" coords="845,80,982,106"/>
<area shape="poly" title=" " alt="" coords="592,111,829,96,830,101,592,116"/>
<area shape="rect" href="namespacefc.html#a4e07b3870aa72f8c38bdd5f78044dad1" title=" " alt="" coords="664,156,755,182"/>
<area shape="poly" title=" " alt="" coords="572,129,650,150,648,155,571,134"/>
<area shape="rect" href="namespacefc.html#a7c8b089501fd00e09e068aa02eacf3de" title=" " alt="" coords="833,5,995,31"/>
<area shape="poly" title=" " alt="" coords="776,16,817,16,817,21,776,21"/>
<area shape="poly" title=" " alt="" coords="778,73,830,80,829,85,778,79"/>
<area shape="rect" href="classfc_1_1mock__time__traits.html#a0bed781012a73b8c15882648397b56be" title=" " alt="" coords="639,206,780,246"/>
<area shape="poly" title=" " alt="" coords="544,309,638,257,649,251,652,256,641,262,547,314"/>
<area shape="rect" href="classfc_1_1mock__time__traits.html#adddeebdf472c33f927827c111ddbf0b1" title=" " alt="" coords="639,271,780,312"/>
<area shape="poly" title=" " alt="" coords="587,310,623,304,624,309,588,316"/>
<area shape="rect" href="classfc_1_1time__point.html#ab46781dcaab4880902bc136f36e39e5e" title=" " alt="" coords="643,336,776,377"/>
<area shape="poly" title=" " alt="" coords="588,333,628,340,627,346,588,339"/>
<area shape="rect" href="classfc_1_1time__point.html#abfea5efbe9ef58024cda814395ee9945" title=" " alt="" coords="643,402,776,442"/>
<area shape="poly" title=" " alt="" coords="547,336,641,386,652,392,650,397,638,391,545,341"/>
<area shape="rect" href="classfc_1_1mock__time__traits.html#a0d7245b32fd62b3bc712f658250cc4db" title=" " alt="" coords="828,213,1000,239"/>
<area shape="poly" title=" " alt="" coords="780,224,812,224,812,229,780,229"/>
<area shape="rect" href="namespacefc.html#af9bea69c5790941ddc601fcd96cce071" title=" " alt="" coords="660,491,759,516"/>
<area shape="poly" title=" " alt="" coords="554,433,665,482,663,486,552,438"/>
<area shape="poly" title=" " alt="" coords="678,492,672,482,675,472,688,466,710,464,732,467,744,473,742,478,731,472,709,469,690,471,679,476,677,481,682,489"/>
</map>
</div>

</div>
</div>
<a id="af95c77a48776d8dc9544884aaeaf5946" name="af95c77a48776d8dc9544884aaeaf5946"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af95c77a48776d8dc9544884aaeaf5946">&#9670;&#160;</a></span>BOOST_AUTO_TEST_CASE() <span class="overload">[22/26]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOST_AUTO_TEST_CASE </td>
          <td>(</td>
          <td class="paramtype">missing_origin</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test__webauthn_8cpp_source.html#l00226">226</a> of file <a class="el" href="test__webauthn_8cpp_source.html">test_webauthn.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  226</span>                                         {</div>
<div class="line"><span class="lineno">  227</span>   <a class="code hl_class" href="classfc_1_1crypto_1_1webauthn_1_1public__key.html">webauthn::public_key</a> wa_pub(pub.serialize(), webauthn::public_key::user_presence_t::USER_PRESENCE_NONE, <span class="stringliteral">&quot;fctesting.invalid&quot;</span>);</div>
<div class="line"><span class="lineno">  228</span>   std::string <a class="code hl_class" href="classfc_1_1json.html">json</a> = <span class="stringliteral">&quot;{\&quot;type\&quot;:\&quot;webauthn.get\&quot;,\&quot;challenge\&quot;:\&quot;&quot;</span> + <a class="code hl_function" href="namespacefc.html#a4d30681e99b9cacc0c9b3b8985a5daa4">fc::base64url_encode</a>(d.<a class="code hl_function" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d">data</a>(), d.<a class="code hl_function" href="classfc_1_1sha256.html#ac7722b7428b1db345f1b7fab7f4d5774">data_size</a>()) + <span class="stringliteral">&quot;\&quot;}&quot;</span>;</div>
<div class="line"><span class="lineno">  229</span> </div>
<div class="line"><span class="lineno">  230</span>   std::vector&lt;uint8_t&gt; auth_data(37);</div>
<div class="line"><span class="lineno">  231</span>   <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(auth_data.data(), origin_hash.<a class="code hl_function" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d">data</a>(), <span class="keyword">sizeof</span>(origin_hash));</div>
<div class="line"><span class="lineno">  232</span> </div>
<div class="line"><span class="lineno">  233</span>   BOOST_CHECK_EXCEPTION(make_webauthn_sig(priv, auth_data, <a class="code hl_class" href="classfc_1_1json.html">json</a>).recover(d, <span class="keyword">true</span>), fc::assert_exception, [](<span class="keyword">const</span> fc::assert_exception&amp; e) {</div>
<div class="line"><span class="lineno">  234</span>      <span class="keywordflow">return</span> e.to_detail_string().find(<span class="stringliteral">&quot;webauthn origin must begin with https://&quot;</span>) != std::string::npos;</div>
<div class="line"><span class="lineno">  235</span>   });</div>
<div class="line"><span class="lineno">  236</span>} <a class="code hl_function" href="#ae70bfa24f5a3bc0917382b3c17fc033c">FC_LOG_AND_RETHROW</a>();</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="test__webauthn_8cpp_af95c77a48776d8dc9544884aaeaf5946_cgraph.png" border="0" usemap="#atest__webauthn_8cpp_af95c77a48776d8dc9544884aaeaf5946_cgraph" alt=""/></div>
<map name="atest__webauthn_8cpp_af95c77a48776d8dc9544884aaeaf5946_cgraph" id="atest__webauthn_8cpp_af95c77a48776d8dc9544884aaeaf5946_cgraph">
<area shape="rect" title=" " alt="" coords="5,80,202,106"/>
<area shape="rect" href="namespacefc.html#a4d30681e99b9cacc0c9b3b8985a5daa4" title=" " alt="" coords="250,5,396,31"/>
<area shape="poly" title=" " alt="" coords="142,77,249,40,266,34,268,39,251,45,144,82"/>
<area shape="rect" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d" title=" " alt="" coords="265,55,380,80"/>
<area shape="poly" title=" " alt="" coords="201,79,250,73,250,79,202,84"/>
<area shape="rect" href="classfc_1_1sha256.html#ac7722b7428b1db345f1b7fab7f4d5774" title=" " alt="" coords="250,104,396,130"/>
<area shape="poly" title=" " alt="" coords="202,101,235,105,234,110,201,106"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="287,153,358,179"/>
<area shape="poly" title=" " alt="" coords="145,104,251,140,273,147,272,152,249,145,143,109"/>
<area shape="rect" href="namespacefc.html#a7c8b089501fd00e09e068aa02eacf3de" title=" " alt="" coords="444,5,606,31"/>
<area shape="poly" title=" " alt="" coords="396,16,429,16,429,21,396,21"/>
</map>
</div>

</div>
</div>
<a id="a91ac61998bf2fbd672164518842c3dbc" name="a91ac61998bf2fbd672164518842c3dbc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a91ac61998bf2fbd672164518842c3dbc">&#9670;&#160;</a></span>BOOST_AUTO_TEST_CASE() <span class="overload">[23/26]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOST_AUTO_TEST_CASE </td>
          <td>(</td>
          <td class="paramtype">missing_type</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test__webauthn_8cpp_source.html#l00239">239</a> of file <a class="el" href="test__webauthn_8cpp_source.html">test_webauthn.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  239</span>                                       {</div>
<div class="line"><span class="lineno">  240</span>   <a class="code hl_class" href="classfc_1_1crypto_1_1webauthn_1_1public__key.html">webauthn::public_key</a> wa_pub(pub.serialize(), webauthn::public_key::user_presence_t::USER_PRESENCE_NONE, <span class="stringliteral">&quot;fctesting.invalid&quot;</span>);</div>
<div class="line"><span class="lineno">  241</span>   std::string <a class="code hl_class" href="classfc_1_1json.html">json</a> = <span class="stringliteral">&quot;{\&quot;origin\&quot;:\&quot;https://fctesting.invalid\&quot;,\&quot;challenge\&quot;:\&quot;&quot;</span> + <a class="code hl_function" href="namespacefc.html#a4d30681e99b9cacc0c9b3b8985a5daa4">fc::base64url_encode</a>(d.<a class="code hl_function" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d">data</a>(), d.<a class="code hl_function" href="classfc_1_1sha256.html#ac7722b7428b1db345f1b7fab7f4d5774">data_size</a>()) + <span class="stringliteral">&quot;\&quot;}&quot;</span>;</div>
<div class="line"><span class="lineno">  242</span> </div>
<div class="line"><span class="lineno">  243</span>   std::vector&lt;uint8_t&gt; auth_data(37);</div>
<div class="line"><span class="lineno">  244</span>   <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(auth_data.data(), origin_hash.<a class="code hl_function" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d">data</a>(), <span class="keyword">sizeof</span>(origin_hash));</div>
<div class="line"><span class="lineno">  245</span> </div>
<div class="line"><span class="lineno">  246</span>   BOOST_CHECK_EXCEPTION(make_webauthn_sig(priv, auth_data, <a class="code hl_class" href="classfc_1_1json.html">json</a>).recover(d, <span class="keyword">true</span>), fc::assert_exception, [](<span class="keyword">const</span> fc::assert_exception&amp; e) {</div>
<div class="line"><span class="lineno">  247</span>      <span class="keywordflow">return</span> e.to_detail_string().find(<span class="stringliteral">&quot;webauthn signature type not an assertion&quot;</span>) != std::string::npos;</div>
<div class="line"><span class="lineno">  248</span>   });</div>
<div class="line"><span class="lineno">  249</span>} <a class="code hl_function" href="#ae70bfa24f5a3bc0917382b3c17fc033c">FC_LOG_AND_RETHROW</a>();</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="test__webauthn_8cpp_a91ac61998bf2fbd672164518842c3dbc_cgraph.png" border="0" usemap="#atest__webauthn_8cpp_a91ac61998bf2fbd672164518842c3dbc_cgraph" alt=""/></div>
<map name="atest__webauthn_8cpp_a91ac61998bf2fbd672164518842c3dbc_cgraph" id="atest__webauthn_8cpp_a91ac61998bf2fbd672164518842c3dbc_cgraph">
<area shape="rect" title=" " alt="" coords="5,80,202,106"/>
<area shape="rect" href="namespacefc.html#a4d30681e99b9cacc0c9b3b8985a5daa4" title=" " alt="" coords="250,5,396,31"/>
<area shape="poly" title=" " alt="" coords="142,77,249,40,266,34,268,39,251,45,144,82"/>
<area shape="rect" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d" title=" " alt="" coords="265,55,380,80"/>
<area shape="poly" title=" " alt="" coords="201,79,250,73,250,79,202,84"/>
<area shape="rect" href="classfc_1_1sha256.html#ac7722b7428b1db345f1b7fab7f4d5774" title=" " alt="" coords="250,104,396,130"/>
<area shape="poly" title=" " alt="" coords="202,101,235,105,234,110,201,106"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="287,153,358,179"/>
<area shape="poly" title=" " alt="" coords="145,104,251,140,273,147,272,152,249,145,143,109"/>
<area shape="rect" href="namespacefc.html#a7c8b089501fd00e09e068aa02eacf3de" title=" " alt="" coords="444,5,606,31"/>
<area shape="poly" title=" " alt="" coords="396,16,429,16,429,21,396,21"/>
</map>
</div>

</div>
</div>
<a id="a4b9953c77aafa04553785736c43e07a5" name="a4b9953c77aafa04553785736c43e07a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b9953c77aafa04553785736c43e07a5">&#9670;&#160;</a></span>BOOST_AUTO_TEST_CASE() <span class="overload">[24/26]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOST_AUTO_TEST_CASE </td>
          <td>(</td>
          <td class="paramtype">non_https</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test__webauthn_8cpp_source.html#l00084">84</a> of file <a class="el" href="test__webauthn_8cpp_source.html">test_webauthn.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   84</span>                                    {</div>
<div class="line"><span class="lineno">   85</span>   <a class="code hl_class" href="classfc_1_1crypto_1_1webauthn_1_1public__key.html">webauthn::public_key</a> wa_pub(pub.serialize(), webauthn::public_key::user_presence_t::USER_PRESENCE_NONE, <span class="stringliteral">&quot;fctesting.invalid&quot;</span>);</div>
<div class="line"><span class="lineno">   86</span>   std::string <a class="code hl_class" href="classfc_1_1json.html">json</a> = <span class="stringliteral">&quot;{\&quot;origin\&quot;:\&quot;http://fctesting.invalid\&quot;,\&quot;type\&quot;:\&quot;webauthn.get\&quot;,\&quot;challenge\&quot;:\&quot;&quot;</span> + <a class="code hl_function" href="namespacefc.html#a4d30681e99b9cacc0c9b3b8985a5daa4">fc::base64url_encode</a>(d.<a class="code hl_function" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d">data</a>(), d.<a class="code hl_function" href="classfc_1_1sha256.html#ac7722b7428b1db345f1b7fab7f4d5774">data_size</a>()) + <span class="stringliteral">&quot;\&quot;}&quot;</span>;</div>
<div class="line"><span class="lineno">   87</span> </div>
<div class="line"><span class="lineno">   88</span>   std::vector&lt;uint8_t&gt; auth_data(37);</div>
<div class="line"><span class="lineno">   89</span>   <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(auth_data.data(), origin_hash.<a class="code hl_function" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d">data</a>(), <span class="keyword">sizeof</span>(origin_hash));</div>
<div class="line"><span class="lineno">   90</span> </div>
<div class="line"><span class="lineno">   91</span>   BOOST_CHECK_EXCEPTION(make_webauthn_sig(priv, auth_data, <a class="code hl_class" href="classfc_1_1json.html">json</a>).recover(d, <span class="keyword">true</span>), fc::assert_exception, [](<span class="keyword">const</span> fc::assert_exception&amp; e) {</div>
<div class="line"><span class="lineno">   92</span>      <span class="keywordflow">return</span> e.to_detail_string().find(<span class="stringliteral">&quot;webauthn origin must begin with https://&quot;</span>) != std::string::npos;</div>
<div class="line"><span class="lineno">   93</span>   });</div>
<div class="line"><span class="lineno">   94</span>} <a class="code hl_function" href="#ae70bfa24f5a3bc0917382b3c17fc033c">FC_LOG_AND_RETHROW</a>();</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="test__webauthn_8cpp_a4b9953c77aafa04553785736c43e07a5_cgraph.png" border="0" usemap="#atest__webauthn_8cpp_a4b9953c77aafa04553785736c43e07a5_cgraph" alt=""/></div>
<map name="atest__webauthn_8cpp_a4b9953c77aafa04553785736c43e07a5_cgraph" id="atest__webauthn_8cpp_a4b9953c77aafa04553785736c43e07a5_cgraph">
<area shape="rect" title=" " alt="" coords="5,80,202,106"/>
<area shape="rect" href="namespacefc.html#a4d30681e99b9cacc0c9b3b8985a5daa4" title=" " alt="" coords="250,5,396,31"/>
<area shape="poly" title=" " alt="" coords="142,77,249,40,266,34,268,39,251,45,144,82"/>
<area shape="rect" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d" title=" " alt="" coords="265,55,380,80"/>
<area shape="poly" title=" " alt="" coords="201,79,250,73,250,79,202,84"/>
<area shape="rect" href="classfc_1_1sha256.html#ac7722b7428b1db345f1b7fab7f4d5774" title=" " alt="" coords="250,104,396,130"/>
<area shape="poly" title=" " alt="" coords="202,101,235,105,234,110,201,106"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="287,153,358,179"/>
<area shape="poly" title=" " alt="" coords="145,104,251,140,273,147,272,152,249,145,143,109"/>
<area shape="rect" href="namespacefc.html#a7c8b089501fd00e09e068aa02eacf3de" title=" " alt="" coords="444,5,606,31"/>
<area shape="poly" title=" " alt="" coords="396,16,429,16,429,21,396,21"/>
</map>
</div>

</div>
</div>
<a id="a72e0ee1c4a2abdcc362828f8ca7f119d" name="a72e0ee1c4a2abdcc362828f8ca7f119d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72e0ee1c4a2abdcc362828f8ca7f119d">&#9670;&#160;</a></span>BOOST_AUTO_TEST_CASE() <span class="overload">[25/26]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOST_AUTO_TEST_CASE </td>
          <td>(</td>
          <td class="paramtype">not_json_object</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test__webauthn_8cpp_source.html#l00277">277</a> of file <a class="el" href="test__webauthn_8cpp_source.html">test_webauthn.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  277</span>                                          {</div>
<div class="line"><span class="lineno">  278</span>   <a class="code hl_class" href="classfc_1_1crypto_1_1webauthn_1_1public__key.html">webauthn::public_key</a> wa_pub(pub.serialize(), webauthn::public_key::user_presence_t::USER_PRESENCE_NONE, <span class="stringliteral">&quot;fctesting.invalid&quot;</span>);</div>
<div class="line"><span class="lineno">  279</span>   std::string <a class="code hl_class" href="classfc_1_1json.html">json</a> = <span class="stringliteral">&quot;hey man&quot;</span><a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a>;</div>
<div class="line"><span class="lineno">  280</span> </div>
<div class="line"><span class="lineno">  281</span>   std::vector&lt;uint8_t&gt; auth_data(37);</div>
<div class="line"><span class="lineno">  282</span>   <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(auth_data.data(), origin_hash.<a class="code hl_function" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d">data</a>(), <span class="keyword">sizeof</span>(origin_hash));</div>
<div class="line"><span class="lineno">  283</span> </div>
<div class="line"><span class="lineno">  284</span>   BOOST_CHECK_EXCEPTION(make_webauthn_sig(priv, auth_data, <a class="code hl_class" href="classfc_1_1json.html">json</a>).recover(d, <span class="keyword">true</span>), fc::assert_exception, [](<span class="keyword">const</span> fc::assert_exception&amp; e) {</div>
<div class="line"><span class="lineno">  285</span>      <span class="keywordflow">return</span> e.to_detail_string().find(<span class="stringliteral">&quot;Failed to parse client data JSON&quot;</span>) != std::string::npos;</div>
<div class="line"><span class="lineno">  286</span>   });</div>
<div class="line"><span class="lineno">  287</span>} <a class="code hl_function" href="#ae70bfa24f5a3bc0917382b3c17fc033c">FC_LOG_AND_RETHROW</a>();</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="test__webauthn_8cpp_a72e0ee1c4a2abdcc362828f8ca7f119d_cgraph.png" border="0" usemap="#atest__webauthn_8cpp_a72e0ee1c4a2abdcc362828f8ca7f119d_cgraph" alt=""/></div>
<map name="atest__webauthn_8cpp_a72e0ee1c4a2abdcc362828f8ca7f119d_cgraph" id="atest__webauthn_8cpp_a72e0ee1c4a2abdcc362828f8ca7f119d_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,202,56"/>
<area shape="rect" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d" title=" " alt="" coords="250,5,365,31"/>
<area shape="poly" title=" " alt="" coords="202,29,234,25,235,30,202,34"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="272,55,343,80"/>
<area shape="poly" title=" " alt="" coords="202,52,257,59,256,64,202,58"/>
</map>
</div>

</div>
</div>
<a id="a6d810d26f3a9ea62940516bbcbcf6b90" name="a6d810d26f3a9ea62940516bbcbcf6b90"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d810d26f3a9ea62940516bbcbcf6b90">&#9670;&#160;</a></span>BOOST_AUTO_TEST_CASE() <span class="overload">[26/26]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOST_AUTO_TEST_CASE </td>
          <td>(</td>
          <td class="paramtype">wrong_type</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test__webauthn_8cpp_source.html#l00185">185</a> of file <a class="el" href="test__webauthn_8cpp_source.html">test_webauthn.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  185</span>                                     {</div>
<div class="line"><span class="lineno">  186</span> </div>
<div class="line"><span class="lineno">  187</span>   <a class="code hl_class" href="classfc_1_1crypto_1_1webauthn_1_1public__key.html">webauthn::public_key</a> wa_pub(pub.serialize(), webauthn::public_key::user_presence_t::USER_PRESENCE_NONE, <span class="stringliteral">&quot;fctesting.invalid&quot;</span>);</div>
<div class="line"><span class="lineno">  188</span>   std::string <a class="code hl_class" href="classfc_1_1json.html">json</a> = <span class="stringliteral">&quot;{\&quot;origin\&quot;:\&quot;https://fctesting.invalid\&quot;,\&quot;type\&quot;:\&quot;webauthn.meh\&quot;,\&quot;challenge\&quot;:\&quot;&quot;</span> + <a class="code hl_function" href="namespacefc.html#a4d30681e99b9cacc0c9b3b8985a5daa4">fc::base64url_encode</a>(d.<a class="code hl_function" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d">data</a>(), d.<a class="code hl_function" href="classfc_1_1sha256.html#ac7722b7428b1db345f1b7fab7f4d5774">data_size</a>()) + <span class="stringliteral">&quot;\&quot;}&quot;</span>;</div>
<div class="line"><span class="lineno">  189</span> </div>
<div class="line"><span class="lineno">  190</span>   std::vector&lt;uint8_t&gt; auth_data(37);</div>
<div class="line"><span class="lineno">  191</span>   <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(auth_data.data(), origin_hash.<a class="code hl_function" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d">data</a>(), <span class="keyword">sizeof</span>(origin_hash));</div>
<div class="line"><span class="lineno">  192</span> </div>
<div class="line"><span class="lineno">  193</span>   BOOST_CHECK_EXCEPTION(make_webauthn_sig(priv, auth_data, <a class="code hl_class" href="classfc_1_1json.html">json</a>).recover(d, <span class="keyword">true</span>), fc::assert_exception, [](<span class="keyword">const</span> fc::assert_exception&amp; e) {</div>
<div class="line"><span class="lineno">  194</span>      <span class="keywordflow">return</span> e.to_detail_string().find(<span class="stringliteral">&quot;webauthn signature type not an assertion&quot;</span>) != std::string::npos;</div>
<div class="line"><span class="lineno">  195</span>   });</div>
<div class="line"><span class="lineno">  196</span>} <a class="code hl_function" href="#ae70bfa24f5a3bc0917382b3c17fc033c">FC_LOG_AND_RETHROW</a>();</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="test__webauthn_8cpp_a6d810d26f3a9ea62940516bbcbcf6b90_cgraph.png" border="0" usemap="#atest__webauthn_8cpp_a6d810d26f3a9ea62940516bbcbcf6b90_cgraph" alt=""/></div>
<map name="atest__webauthn_8cpp_a6d810d26f3a9ea62940516bbcbcf6b90_cgraph" id="atest__webauthn_8cpp_a6d810d26f3a9ea62940516bbcbcf6b90_cgraph">
<area shape="rect" title=" " alt="" coords="5,80,202,106"/>
<area shape="rect" href="namespacefc.html#a4d30681e99b9cacc0c9b3b8985a5daa4" title=" " alt="" coords="250,5,396,31"/>
<area shape="poly" title=" " alt="" coords="142,77,249,40,266,34,268,39,251,45,144,82"/>
<area shape="rect" href="classfc_1_1sha256.html#ab897537f6c524085b28049be51ed370d" title=" " alt="" coords="265,55,380,80"/>
<area shape="poly" title=" " alt="" coords="201,79,250,73,250,79,202,84"/>
<area shape="rect" href="classfc_1_1sha256.html#ac7722b7428b1db345f1b7fab7f4d5774" title=" " alt="" coords="250,104,396,130"/>
<area shape="poly" title=" " alt="" coords="202,101,235,105,234,110,201,106"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="287,153,358,179"/>
<area shape="poly" title=" " alt="" coords="145,104,251,140,273,147,272,152,249,145,143,109"/>
<area shape="rect" href="namespacefc.html#a7c8b089501fd00e09e068aa02eacf3de" title=" " alt="" coords="444,5,606,31"/>
<area shape="poly" title=" " alt="" coords="396,16,429,16,429,21,396,21"/>
</map>
</div>

</div>
</div>
<a id="ae70bfa24f5a3bc0917382b3c17fc033c" name="ae70bfa24f5a3bc0917382b3c17fc033c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae70bfa24f5a3bc0917382b3c17fc033c">&#9670;&#160;</a></span>FC_LOG_AND_RETHROW()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">FC_LOG_AND_RETHROW </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_428556e0652617aa37d2f7d8bcaf7fdf.html">libraries</a></li><li class="navelem"><a class="el" href="dir_71436f1774b2d89f0b80ac9efd482f1f.html">fc</a></li><li class="navelem"><a class="el" href="dir_0c422dd11f286140e190d5709e4be443.html">test</a></li><li class="navelem"><a class="el" href="dir_9eab9960fc115f183698a0e60806b32a.html">crypto</a></li><li class="navelem"><a class="el" href="test__webauthn_8cpp.html">test_webauthn.cpp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0 </li>
  </ul>
</div>
</body>
</html>
