\doxysection{libraries/fc/src/crypto/keccak256.cpp File Reference}
\hypertarget{keccak256_8cpp}{}\label{keccak256_8cpp}\index{libraries/fc/src/crypto/keccak256.cpp@{libraries/fc/src/crypto/keccak256.cpp}}
{\ttfamily \#include $<$fc/crypto/keccak256.\+hpp$>$}\newline
{\ttfamily \#include $<$cstring$>$}\newline
Include dependency graph for keccak256.\+cpp\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=266pt]{keccak256_8cpp__incl}
\end{center}
\end{figure}
\doxysubsubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{keccak256_8cpp_ad51ded0bbd705f02f73fc60c0b721ced}{BLOCK\+\_\+\+SIZE}}~((1600 -\/ 256 \texorpdfstring{$\ast$}{*} 2) / 8)
\item 
\#define \mbox{\hyperlink{keccak256_8cpp_a4a234a46224f2c5591a49ebdfa83c70e}{I64}}(x)
\item 
\#define \mbox{\hyperlink{keccak256_8cpp_ae00c5ae6aafcda79ec237f2731ba3fd6}{ROTL64}}(qword,  n)
\item 
\#define \mbox{\hyperlink{keccak256_8cpp_a6650c9ab9b3325086fc7a91c3675cf03}{le2me\+\_\+64}}(x)
\item 
\#define \mbox{\hyperlink{keccak256_8cpp_a2f82bf392f983fcf9a7c3d8b86d52aeb}{IS\+\_\+\+ALIGNED\+\_\+64}}(\mbox{\hyperlink{bn_8cpp_a8b0eadcc506862e9d751ab45185053aa}{p}})
\item 
\#define \mbox{\hyperlink{keccak256_8cpp_a3890097089ffb7fd62e6b218500fb27d}{me64\+\_\+to\+\_\+le\+\_\+str}}(to,  from,  length)
\item 
\#define \mbox{\hyperlink{keccak256_8cpp_a552a8a4eee596cc63b55da207f1f99f4}{TYPE\+\_\+\+ROUND\+\_\+\+INFO}}~0
\item 
\#define \mbox{\hyperlink{keccak256_8cpp_abfec8a80dd4c99ca8e368072360457af}{TYPE\+\_\+\+PI\+\_\+\+TRANSFORM}}~24
\item 
\#define \mbox{\hyperlink{keccak256_8cpp_ac63c941b8650dc5db94f31ffff9ef370}{TYPE\+\_\+\+RHO\+\_\+\+TRANSFORM}}~48
\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t}} \mbox{\hyperlink{keccak256_8cpp_ab42d9d958e143399ad7d3fce6139c8f1}{get\+Constant}} (\mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t}} type, \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t}} index)
\item 
void \mbox{\hyperlink{keccak256_8cpp_a11facd9a5ba2fa670b8adac99c9b885c}{keccak\+\_\+init}} (\mbox{\hyperlink{struct_s_h_a3___c_t_x}{SHA3\+\_\+\+CTX}} \texorpdfstring{$\ast$}{*}ctx)
\item 
void \mbox{\hyperlink{keccak256_8cpp_a3a3c3f80dd9847bffcaa8e638aefef12}{keccak\+\_\+update}} (\mbox{\hyperlink{struct_s_h_a3___c_t_x}{SHA3\+\_\+\+CTX}} \texorpdfstring{$\ast$}{*}ctx, const unsigned char \texorpdfstring{$\ast$}{*}msg, \mbox{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t}} size)
\item 
void \mbox{\hyperlink{keccak256_8cpp_ab3d065f3af63d47a27d94d60a38422b5}{keccak\+\_\+final}} (\mbox{\hyperlink{struct_s_h_a3___c_t_x}{SHA3\+\_\+\+CTX}} \texorpdfstring{$\ast$}{*}ctx, unsigned char \texorpdfstring{$\ast$}{*}result)
\end{DoxyCompactItemize}
\doxysubsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
const \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t}} \mbox{\hyperlink{keccak256_8cpp_a59d5e3b2dd5df825d618e6994924cd00}{constants}} \mbox{[}$\,$\mbox{]}
\end{DoxyCompactItemize}


\doxysubsection{Macro Definition Documentation}
\Hypertarget{keccak256_8cpp_ad51ded0bbd705f02f73fc60c0b721ced}\index{keccak256.cpp@{keccak256.cpp}!BLOCK\_SIZE@{BLOCK\_SIZE}}
\index{BLOCK\_SIZE@{BLOCK\_SIZE}!keccak256.cpp@{keccak256.cpp}}
\doxysubsubsection{\texorpdfstring{BLOCK\_SIZE}{BLOCK\_SIZE}}
{\footnotesize\ttfamily \label{keccak256_8cpp_ad51ded0bbd705f02f73fc60c0b721ced} 
\#define BLOCK\+\_\+\+SIZE~((1600 -\/ 256 \texorpdfstring{$\ast$}{*} 2) / 8)}



Definition at line \mbox{\hyperlink{keccak256_8cpp_source_l00023}{23}} of file \mbox{\hyperlink{keccak256_8cpp_source}{keccak256.\+cpp}}.

\Hypertarget{keccak256_8cpp_a4a234a46224f2c5591a49ebdfa83c70e}\index{keccak256.cpp@{keccak256.cpp}!I64@{I64}}
\index{I64@{I64}!keccak256.cpp@{keccak256.cpp}}
\doxysubsubsection{\texorpdfstring{I64}{I64}}
{\footnotesize\ttfamily \label{keccak256_8cpp_a4a234a46224f2c5591a49ebdfa83c70e} 
\#define \mbox{\hyperlink{_basic_types_8h_a416b74ff5b1dc365af5713a3f48fb8b9}{I64}}(\begin{DoxyParamCaption}\item[{}]{x}{}\end{DoxyParamCaption})}

{\bfseries Value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{x\#\#LL}

\end{DoxyCode}


Definition at line \mbox{\hyperlink{keccak256_8cpp_source_l00025}{25}} of file \mbox{\hyperlink{keccak256_8cpp_source}{keccak256.\+cpp}}.

\Hypertarget{keccak256_8cpp_a2f82bf392f983fcf9a7c3d8b86d52aeb}\index{keccak256.cpp@{keccak256.cpp}!IS\_ALIGNED\_64@{IS\_ALIGNED\_64}}
\index{IS\_ALIGNED\_64@{IS\_ALIGNED\_64}!keccak256.cpp@{keccak256.cpp}}
\doxysubsubsection{\texorpdfstring{IS\_ALIGNED\_64}{IS\_ALIGNED\_64}}
{\footnotesize\ttfamily \label{keccak256_8cpp_a2f82bf392f983fcf9a7c3d8b86d52aeb} 
\#define IS\+\_\+\+ALIGNED\+\_\+64(\begin{DoxyParamCaption}\item[{}]{\mbox{\hyperlink{bn_8cpp_a8b0eadcc506862e9d751ab45185053aa}{p}}}{}\end{DoxyParamCaption})}

{\bfseries Value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{(0\ ==\ (7\ \&\ ((\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*)(\mbox{\hyperlink{bn_8cpp_a8b0eadcc506862e9d751ab45185053aa}{p}})\ -\/\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*)0)))}

\end{DoxyCode}


Definition at line \mbox{\hyperlink{keccak256_8cpp_source_l00028}{28}} of file \mbox{\hyperlink{keccak256_8cpp_source}{keccak256.\+cpp}}.

\Hypertarget{keccak256_8cpp_a6650c9ab9b3325086fc7a91c3675cf03}\index{keccak256.cpp@{keccak256.cpp}!le2me\_64@{le2me\_64}}
\index{le2me\_64@{le2me\_64}!keccak256.cpp@{keccak256.cpp}}
\doxysubsubsection{\texorpdfstring{le2me\_64}{le2me\_64}}
{\footnotesize\ttfamily \label{keccak256_8cpp_a6650c9ab9b3325086fc7a91c3675cf03} 
\#define le2me\+\_\+64(\begin{DoxyParamCaption}\item[{}]{x}{}\end{DoxyParamCaption})}

{\bfseries Value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{(x)}

\end{DoxyCode}


Definition at line \mbox{\hyperlink{keccak256_8cpp_source_l00027}{27}} of file \mbox{\hyperlink{keccak256_8cpp_source}{keccak256.\+cpp}}.

\Hypertarget{keccak256_8cpp_a3890097089ffb7fd62e6b218500fb27d}\index{keccak256.cpp@{keccak256.cpp}!me64\_to\_le\_str@{me64\_to\_le\_str}}
\index{me64\_to\_le\_str@{me64\_to\_le\_str}!keccak256.cpp@{keccak256.cpp}}
\doxysubsubsection{\texorpdfstring{me64\_to\_le\_str}{me64\_to\_le\_str}}
{\footnotesize\ttfamily \label{keccak256_8cpp_a3890097089ffb7fd62e6b218500fb27d} 
\#define me64\+\_\+to\+\_\+le\+\_\+str(\begin{DoxyParamCaption}\item[{}]{to}{, }\item[{}]{from}{, }\item[{}]{length}{}\end{DoxyParamCaption})}

{\bfseries Value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{\mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}((to),\ (from),\ (length))}

\end{DoxyCode}


Definition at line \mbox{\hyperlink{keccak256_8cpp_source_l00029}{29}} of file \mbox{\hyperlink{keccak256_8cpp_source}{keccak256.\+cpp}}.

\Hypertarget{keccak256_8cpp_ae00c5ae6aafcda79ec237f2731ba3fd6}\index{keccak256.cpp@{keccak256.cpp}!ROTL64@{ROTL64}}
\index{ROTL64@{ROTL64}!keccak256.cpp@{keccak256.cpp}}
\doxysubsubsection{\texorpdfstring{ROTL64}{ROTL64}}
{\footnotesize\ttfamily \label{keccak256_8cpp_ae00c5ae6aafcda79ec237f2731ba3fd6} 
\#define ROTL64(\begin{DoxyParamCaption}\item[{}]{qword}{, }\item[{}]{n}{}\end{DoxyParamCaption})}

{\bfseries Value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{((qword)\ <<\ (n)\ \string^\ ((qword)\ >>\ (64\ -\/\ (n))))}

\end{DoxyCode}


Definition at line \mbox{\hyperlink{keccak256_8cpp_source_l00026}{26}} of file \mbox{\hyperlink{keccak256_8cpp_source}{keccak256.\+cpp}}.

\Hypertarget{keccak256_8cpp_abfec8a80dd4c99ca8e368072360457af}\index{keccak256.cpp@{keccak256.cpp}!TYPE\_PI\_TRANSFORM@{TYPE\_PI\_TRANSFORM}}
\index{TYPE\_PI\_TRANSFORM@{TYPE\_PI\_TRANSFORM}!keccak256.cpp@{keccak256.cpp}}
\doxysubsubsection{\texorpdfstring{TYPE\_PI\_TRANSFORM}{TYPE\_PI\_TRANSFORM}}
{\footnotesize\ttfamily \label{keccak256_8cpp_abfec8a80dd4c99ca8e368072360457af} 
\#define TYPE\+\_\+\+PI\+\_\+\+TRANSFORM~24}



Definition at line \mbox{\hyperlink{keccak256_8cpp_source_l00049}{49}} of file \mbox{\hyperlink{keccak256_8cpp_source}{keccak256.\+cpp}}.

\Hypertarget{keccak256_8cpp_ac63c941b8650dc5db94f31ffff9ef370}\index{keccak256.cpp@{keccak256.cpp}!TYPE\_RHO\_TRANSFORM@{TYPE\_RHO\_TRANSFORM}}
\index{TYPE\_RHO\_TRANSFORM@{TYPE\_RHO\_TRANSFORM}!keccak256.cpp@{keccak256.cpp}}
\doxysubsubsection{\texorpdfstring{TYPE\_RHO\_TRANSFORM}{TYPE\_RHO\_TRANSFORM}}
{\footnotesize\ttfamily \label{keccak256_8cpp_ac63c941b8650dc5db94f31ffff9ef370} 
\#define TYPE\+\_\+\+RHO\+\_\+\+TRANSFORM~48}



Definition at line \mbox{\hyperlink{keccak256_8cpp_source_l00050}{50}} of file \mbox{\hyperlink{keccak256_8cpp_source}{keccak256.\+cpp}}.

\Hypertarget{keccak256_8cpp_a552a8a4eee596cc63b55da207f1f99f4}\index{keccak256.cpp@{keccak256.cpp}!TYPE\_ROUND\_INFO@{TYPE\_ROUND\_INFO}}
\index{TYPE\_ROUND\_INFO@{TYPE\_ROUND\_INFO}!keccak256.cpp@{keccak256.cpp}}
\doxysubsubsection{\texorpdfstring{TYPE\_ROUND\_INFO}{TYPE\_ROUND\_INFO}}
{\footnotesize\ttfamily \label{keccak256_8cpp_a552a8a4eee596cc63b55da207f1f99f4} 
\#define TYPE\+\_\+\+ROUND\+\_\+\+INFO~0}



Definition at line \mbox{\hyperlink{keccak256_8cpp_source_l00048}{48}} of file \mbox{\hyperlink{keccak256_8cpp_source}{keccak256.\+cpp}}.



\doxysubsection{Function Documentation}
\Hypertarget{keccak256_8cpp_ab42d9d958e143399ad7d3fce6139c8f1}\index{keccak256.cpp@{keccak256.cpp}!getConstant@{getConstant}}
\index{getConstant@{getConstant}!keccak256.cpp@{keccak256.cpp}}
\doxysubsubsection{\texorpdfstring{getConstant()}{getConstant()}}
{\footnotesize\ttfamily \label{keccak256_8cpp_ab42d9d958e143399ad7d3fce6139c8f1} 
\mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t}} get\+Constant (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t}}}]{type}{, }\item[{\mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t}}}]{index}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Definition at line \mbox{\hyperlink{keccak256_8cpp_source_l00052}{52}} of file \mbox{\hyperlink{keccak256_8cpp_source}{keccak256.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00052\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00053\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{keccak256_8cpp_a59d5e3b2dd5df825d618e6994924cd00}{constants}}[type\ +\ index];}
\DoxyCodeLine{00054\ \ \ \ \ \textcolor{comment}{//return\ pgm\_read\_byte(\&constants[type\ +\ index]);}}
\DoxyCodeLine{00055\ \}}

\end{DoxyCode}
\Hypertarget{keccak256_8cpp_ab3d065f3af63d47a27d94d60a38422b5}\index{keccak256.cpp@{keccak256.cpp}!keccak\_final@{keccak\_final}}
\index{keccak\_final@{keccak\_final}!keccak256.cpp@{keccak256.cpp}}
\doxysubsubsection{\texorpdfstring{keccak\_final()}{keccak\_final()}}
{\footnotesize\ttfamily \label{keccak256_8cpp_ab3d065f3af63d47a27d94d60a38422b5} 
void keccak\+\_\+final (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{struct_s_h_a3___c_t_x}{SHA3\+\_\+\+CTX}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{unsigned char \texorpdfstring{$\ast$}{*}}]{result}{}\end{DoxyParamCaption})}

Store calculated hash into the given array.


\begin{DoxyParams}{Parameters}
{\em ctx} & the algorithm context containing current hashing state \\
\hline
{\em result} & calculated hash in binary form \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{keccak256_8cpp_source_l00220}{220}} of file \mbox{\hyperlink{keccak256_8cpp_source}{keccak256.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00221\ \{}
\DoxyCodeLine{00222\ \ \ \ \ \mbox{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t}}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a66a5beeab221445b2b3142a490574638}{digest\_length}}\ =\ 100\ -\/\ \mbox{\hyperlink{keccak256_8cpp_ad51ded0bbd705f02f73fc60c0b721ced}{BLOCK\_SIZE}}\ /\ 2;}
\DoxyCodeLine{00223\ }
\DoxyCodeLine{00224\ \textcolor{comment}{//\ \ \ \ if\ (!(ctx-\/>rest\ \&\ SHA3\_FINALIZED))\ \{}}
\DoxyCodeLine{00225\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ clear\ the\ rest\ of\ the\ data\ queue\ */}}
\DoxyCodeLine{00226\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_adc4bd59a60361844aa0e852efa210105}{memset}}((\textcolor{keywordtype}{char}*)ctx-\/>\mbox{\hyperlink{struct_s_h_a3___c_t_x_a37957cb14d1f29d6e3c8b86c13baf86c}{message}}\ +\ ctx-\/>\mbox{\hyperlink{struct_s_h_a3___c_t_x_a206aeef34e8cabe7390884ef5c131999}{rest}},\ 0,\ \mbox{\hyperlink{keccak256_8cpp_ad51ded0bbd705f02f73fc60c0b721ced}{BLOCK\_SIZE}}\ -\/\ ctx-\/>\mbox{\hyperlink{struct_s_h_a3___c_t_x_a206aeef34e8cabe7390884ef5c131999}{rest}});}
\DoxyCodeLine{00227\ \ \ \ \ \ \ \ \ ((\textcolor{keywordtype}{char}*)ctx-\/>\mbox{\hyperlink{struct_s_h_a3___c_t_x_a37957cb14d1f29d6e3c8b86c13baf86c}{message}})[ctx-\/>\mbox{\hyperlink{struct_s_h_a3___c_t_x_a206aeef34e8cabe7390884ef5c131999}{rest}}]\ |=\ 0x01;}
\DoxyCodeLine{00228\ \ \ \ \ \ \ \ \ ((\textcolor{keywordtype}{char}*)ctx-\/>\mbox{\hyperlink{struct_s_h_a3___c_t_x_a37957cb14d1f29d6e3c8b86c13baf86c}{message}})[\mbox{\hyperlink{keccak256_8cpp_ad51ded0bbd705f02f73fc60c0b721ced}{BLOCK\_SIZE}}\ -\/\ 1]\ |=\ 0x80;}
\DoxyCodeLine{00229\ }
\DoxyCodeLine{00230\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ process\ final\ block\ */}}
\DoxyCodeLine{00231\ \ \ \ \ \ \ \ \ sha3\_process\_block(ctx-\/>\mbox{\hyperlink{struct_s_h_a3___c_t_x_a7fcec2ce062e8a73ec6db44d20e86b1f}{hash}},\ ctx-\/>\mbox{\hyperlink{struct_s_h_a3___c_t_x_a37957cb14d1f29d6e3c8b86c13baf86c}{message}});}
\DoxyCodeLine{00232\ \textcolor{comment}{//\ \ \ \ \ \ \ \ ctx-\/>rest\ =\ SHA3\_FINALIZED;\ /*\ mark\ context\ as\ finalized\ */}}
\DoxyCodeLine{00233\ \textcolor{comment}{//\ \ \ \ \}}}
\DoxyCodeLine{00234\ }
\DoxyCodeLine{00235\ \ \ \ \ \textcolor{keywordflow}{if}\ (result)\ \{}
\DoxyCodeLine{00236\ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{keccak256_8cpp_a3890097089ffb7fd62e6b218500fb27d}{me64\_to\_le\_str}}(result,\ ctx-\/>\mbox{\hyperlink{struct_s_h_a3___c_t_x_a7fcec2ce062e8a73ec6db44d20e86b1f}{hash}},\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a66a5beeab221445b2b3142a490574638}{digest\_length}});}
\DoxyCodeLine{00237\ \ \ \ \ \}}
\DoxyCodeLine{00238\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=238pt]{keccak256_8cpp_ab3d065f3af63d47a27d94d60a38422b5_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=303pt]{keccak256_8cpp_ab3d065f3af63d47a27d94d60a38422b5_icgraph}
\end{center}
\end{figure}
\Hypertarget{keccak256_8cpp_a11facd9a5ba2fa670b8adac99c9b885c}\index{keccak256.cpp@{keccak256.cpp}!keccak\_init@{keccak\_init}}
\index{keccak\_init@{keccak\_init}!keccak256.cpp@{keccak256.cpp}}
\doxysubsubsection{\texorpdfstring{keccak\_init()}{keccak\_init()}}
{\footnotesize\ttfamily \label{keccak256_8cpp_a11facd9a5ba2fa670b8adac99c9b885c} 
void keccak\+\_\+init (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{struct_s_h_a3___c_t_x}{SHA3\+\_\+\+CTX}} \texorpdfstring{$\ast$}{*}}]{ctx}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{keccak256_8cpp_source_l00075}{75}} of file \mbox{\hyperlink{keccak256_8cpp_source}{keccak256.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00075\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00076\ \ \ \ \ \textcolor{comment}{/*\ NB:\ The\ Keccak\ capacity\ parameter\ =\ bits\ *\ 2\ */}}
\DoxyCodeLine{00077\ }
\DoxyCodeLine{00078\ \ \ \ \ std::memset(ctx,\ 0,\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{struct_s_h_a3___c_t_x}{SHA3\_CTX}}));}
\DoxyCodeLine{00079\ \}}

\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=297pt]{keccak256_8cpp_a11facd9a5ba2fa670b8adac99c9b885c_icgraph}
\end{center}
\end{figure}
\Hypertarget{keccak256_8cpp_a3a3c3f80dd9847bffcaa8e638aefef12}\index{keccak256.cpp@{keccak256.cpp}!keccak\_update@{keccak\_update}}
\index{keccak\_update@{keccak\_update}!keccak256.cpp@{keccak256.cpp}}
\doxysubsubsection{\texorpdfstring{keccak\_update()}{keccak\_update()}}
{\footnotesize\ttfamily \label{keccak256_8cpp_a3a3c3f80dd9847bffcaa8e638aefef12} 
void keccak\+\_\+update (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{struct_s_h_a3___c_t_x}{SHA3\+\_\+\+CTX}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{const unsigned char \texorpdfstring{$\ast$}{*}}]{msg}{, }\item[{\mbox{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t}}}]{size}{}\end{DoxyParamCaption})}

Calculate message hash. Can be called repeatedly with chunks of the message to be hashed.


\begin{DoxyParams}{Parameters}
{\em ctx} & the algorithm context containing current hashing state \\
\hline
{\em msg} & message chunk \\
\hline
{\em size} & length of the message chunk \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{keccak256_8cpp_source_l00175}{175}} of file \mbox{\hyperlink{keccak256_8cpp_source}{keccak256.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00176\ \{}
\DoxyCodeLine{00177\ \ \ \ \ \mbox{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t}}\ \mbox{\hyperlink{namespacehost__functions__tests__1_a8496a24b5236a2dc07bb4f2930d88342}{idx}}\ =\ (\mbox{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t}})ctx-\/>\mbox{\hyperlink{struct_s_h_a3___c_t_x_a206aeef34e8cabe7390884ef5c131999}{rest}};}
\DoxyCodeLine{00178\ }
\DoxyCodeLine{00179\ \ \ \ \ \textcolor{comment}{//if\ (ctx-\/>rest\ \&\ SHA3\_FINALIZED)\ return;\ /*\ too\ late\ for\ additional\ input\ */}}
\DoxyCodeLine{00180\ \ \ \ \ ctx-\/>\mbox{\hyperlink{struct_s_h_a3___c_t_x_a206aeef34e8cabe7390884ef5c131999}{rest}}\ =\ (unsigned)((ctx-\/>\mbox{\hyperlink{struct_s_h_a3___c_t_x_a206aeef34e8cabe7390884ef5c131999}{rest}}\ +\ size)\ \%\ \mbox{\hyperlink{keccak256_8cpp_ad51ded0bbd705f02f73fc60c0b721ced}{BLOCK\_SIZE}});}
\DoxyCodeLine{00181\ }
\DoxyCodeLine{00182\ \ \ \ \ \textcolor{comment}{/*\ fill\ partial\ block\ */}}
\DoxyCodeLine{00183\ \ \ \ \ \textcolor{keywordflow}{if}\ (idx)\ \{}
\DoxyCodeLine{00184\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t}}\ left\ =\ \mbox{\hyperlink{keccak256_8cpp_ad51ded0bbd705f02f73fc60c0b721ced}{BLOCK\_SIZE}}\ -\/\ \mbox{\hyperlink{namespacehost__functions__tests__1_a8496a24b5236a2dc07bb4f2930d88342}{idx}};}
\DoxyCodeLine{00185\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}((\textcolor{keywordtype}{char}*)ctx-\/>\mbox{\hyperlink{struct_s_h_a3___c_t_x_a37957cb14d1f29d6e3c8b86c13baf86c}{message}}\ +\ idx,\ msg,\ (size\ <\ left\ ?\ size\ :\ left));}
\DoxyCodeLine{00186\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (size\ <\ left)\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00187\ }
\DoxyCodeLine{00188\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ process\ partial\ block\ */}}
\DoxyCodeLine{00189\ \ \ \ \ \ \ \ \ sha3\_process\_block(ctx-\/>\mbox{\hyperlink{struct_s_h_a3___c_t_x_a7fcec2ce062e8a73ec6db44d20e86b1f}{hash}},\ ctx-\/>\mbox{\hyperlink{struct_s_h_a3___c_t_x_a37957cb14d1f29d6e3c8b86c13baf86c}{message}});}
\DoxyCodeLine{00190\ \ \ \ \ \ \ \ \ msg\ \ +=\ left;}
\DoxyCodeLine{00191\ \ \ \ \ \ \ \ \ size\ -\/=\ left;}
\DoxyCodeLine{00192\ \ \ \ \ \}}
\DoxyCodeLine{00193\ }
\DoxyCodeLine{00194\ \ \ \ \ \textcolor{keywordflow}{while}\ (size\ >=\ \mbox{\hyperlink{keccak256_8cpp_ad51ded0bbd705f02f73fc60c0b721ced}{BLOCK\_SIZE}})\ \{}
\DoxyCodeLine{00195\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{stdint_8h_aec6fcb673ff035718c238c8c9d544c47}{uint64\_t}}*\ aligned\_message\_block;}
\DoxyCodeLine{00196\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{keccak256_8cpp_a2f82bf392f983fcf9a7c3d8b86d52aeb}{IS\_ALIGNED\_64}}(msg))\ \{}
\DoxyCodeLine{00197\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ the\ most\ common\ case\ is\ processing\ of\ an\ already\ aligned\ message\ without\ copying\ it}}
\DoxyCodeLine{00198\ \ \ \ \ \ \ \ \ \ \ \ \ aligned\_message\_block\ =\ (\mbox{\hyperlink{stdint_8h_aec6fcb673ff035718c238c8c9d544c47}{uint64\_t}}*)(\textcolor{keywordtype}{void}*)msg;}
\DoxyCodeLine{00199\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00200\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(ctx-\/>\mbox{\hyperlink{struct_s_h_a3___c_t_x_a37957cb14d1f29d6e3c8b86c13baf86c}{message}},\ msg,\ \mbox{\hyperlink{keccak256_8cpp_ad51ded0bbd705f02f73fc60c0b721ced}{BLOCK\_SIZE}});}
\DoxyCodeLine{00201\ \ \ \ \ \ \ \ \ \ \ \ \ aligned\_message\_block\ =\ ctx-\/>\mbox{\hyperlink{struct_s_h_a3___c_t_x_a37957cb14d1f29d6e3c8b86c13baf86c}{message}};}
\DoxyCodeLine{00202\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00203\ }
\DoxyCodeLine{00204\ \ \ \ \ \ \ \ \ sha3\_process\_block(ctx-\/>\mbox{\hyperlink{struct_s_h_a3___c_t_x_a7fcec2ce062e8a73ec6db44d20e86b1f}{hash}},\ aligned\_message\_block);}
\DoxyCodeLine{00205\ \ \ \ \ \ \ \ \ msg\ \ +=\ \mbox{\hyperlink{keccak256_8cpp_ad51ded0bbd705f02f73fc60c0b721ced}{BLOCK\_SIZE}};}
\DoxyCodeLine{00206\ \ \ \ \ \ \ \ \ size\ -\/=\ \mbox{\hyperlink{keccak256_8cpp_ad51ded0bbd705f02f73fc60c0b721ced}{BLOCK\_SIZE}};}
\DoxyCodeLine{00207\ \ \ \ \ \}}
\DoxyCodeLine{00208\ }
\DoxyCodeLine{00209\ \ \ \ \ \textcolor{keywordflow}{if}\ (size)\ \{}
\DoxyCodeLine{00210\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{yubihsm__pkcs11_8c_ae785d5badbf1f08b491af31f32a135a1}{memcpy}}(ctx-\/>\mbox{\hyperlink{struct_s_h_a3___c_t_x_a37957cb14d1f29d6e3c8b86c13baf86c}{message}},\ msg,\ size);\ \textcolor{comment}{/*\ save\ leftovers\ */}}
\DoxyCodeLine{00211\ \ \ \ \ \}}
\DoxyCodeLine{00212\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=252pt]{keccak256_8cpp_a3a3c3f80dd9847bffcaa8e638aefef12_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=314pt]{keccak256_8cpp_a3a3c3f80dd9847bffcaa8e638aefef12_icgraph}
\end{center}
\end{figure}


\doxysubsection{Variable Documentation}
\Hypertarget{keccak256_8cpp_a59d5e3b2dd5df825d618e6994924cd00}\index{keccak256.cpp@{keccak256.cpp}!constants@{constants}}
\index{constants@{constants}!keccak256.cpp@{keccak256.cpp}}
\doxysubsubsection{\texorpdfstring{constants}{constants}}
{\footnotesize\ttfamily \label{keccak256_8cpp_a59d5e3b2dd5df825d618e6994924cd00} 
const \mbox{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t}} constants\mbox{[}$\,$\mbox{]}}

{\bfseries Initial value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{=\ \{}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ 1,\ 26,\ 94,\ 112,\ 31,\ 33,\ 121,\ 85,\ 14,\ 12,\ 53,\ 38,\ 63,\ 79,\ 93,\ 83,\ 82,\ 72,\ 22,\ 102,\ 121,\ 88,\ 33,\ 116,}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ 1,\ 6,\ 9,\ 22,\ 14,\ 20,\ 2,\ 12,\ 13,\ 19,\ 23,\ 15,\ 4,\ 24,\ 21,\ 8,\ 16,\ 5,\ 3,\ 18,\ 17,\ 11,\ 7,\ 10,}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ 1,\ 62,\ 28,\ 27,\ 36,\ 44,\ 6,\ 55,\ 20,\ 3,\ 10,\ 43,\ 25,\ 39,\ 41,\ 45,\ 15,\ 21,\ 8,\ 18,\ 2,\ 61,\ 56,\ 14,}
\DoxyCodeLine{\}}

\end{DoxyCode}


Definition at line \mbox{\hyperlink{keccak256_8cpp_source_l00035}{35}} of file \mbox{\hyperlink{keccak256_8cpp_source}{keccak256.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00035\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00036\ }
\DoxyCodeLine{00037\ \ \ \ \ 1,\ 26,\ 94,\ 112,\ 31,\ 33,\ 121,\ 85,\ 14,\ 12,\ 53,\ 38,\ 63,\ 79,\ 93,\ 83,\ 82,\ 72,\ 22,\ 102,\ 121,\ 88,\ 33,\ 116,}
\DoxyCodeLine{00038\ \textcolor{comment}{//\};}}
\DoxyCodeLine{00039\ }
\DoxyCodeLine{00040\ \textcolor{comment}{//const\ uint8\_t\ pi\_transform[]\ PROGMEM\ =\ \{}}
\DoxyCodeLine{00041\ \ \ \ \ 1,\ 6,\ 9,\ 22,\ 14,\ 20,\ 2,\ 12,\ 13,\ 19,\ 23,\ 15,\ 4,\ 24,\ 21,\ 8,\ 16,\ 5,\ 3,\ 18,\ 17,\ 11,\ 7,\ 10,}
\DoxyCodeLine{00042\ \textcolor{comment}{//\};}}
\DoxyCodeLine{00043\ }
\DoxyCodeLine{00044\ \textcolor{comment}{//const\ uint8\_t\ rhoTransforms[]\ PROGMEM\ =\ \{}}
\DoxyCodeLine{00045\ \ \ \ \ 1,\ 62,\ 28,\ 27,\ 36,\ 44,\ 6,\ 55,\ 20,\ 3,\ 10,\ 43,\ 25,\ 39,\ 41,\ 45,\ 15,\ 21,\ 8,\ 18,\ 2,\ 61,\ 56,\ 14,}
\DoxyCodeLine{00046\ \};}

\end{DoxyCode}
