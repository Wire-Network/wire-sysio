\doxysection{benchmark\+Compile.\+py}
\hypertarget{benchmark_compile_8py_source}{}\label{benchmark_compile_8py_source}\index{libraries/sys-\/vm/external/Catch2/scripts/benchmarkCompile.py@{libraries/sys-\/vm/external/Catch2/scripts/benchmarkCompile.py}}
\mbox{\hyperlink{benchmark_compile_8py}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00001}\mbox{\hyperlink{namespacebenchmark_compile}{00001}}\ \textcolor{comment}{\#!/usr/bin/env\ python}}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00002}00002\ }
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00003}00003\ \textcolor{keyword}{from}\ \_\_future\_\_\ \textcolor{keyword}{import}\ print\_function}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00004}00004\ }
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00005}00005\ \textcolor{keyword}{import}\ time,\ subprocess,\ sys,\ os,\ shutil,\ glob,\ random}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00006}00006\ \textcolor{keyword}{import}\ argparse}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00007}00007\ }
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00008}\mbox{\hyperlink{namespacebenchmark_compile_a1ff7f0c25220f2e580b61c143f719f99}{00008}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacebenchmark_compile_a1ff7f0c25220f2e580b61c143f719f99}{median}}(lst):}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00009}00009\ \ \ \ \ lst\ =\ sorted(lst)}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00010}00010\ \ \ \ \ mid,\ odd\ =\ divmod(\mbox{\hyperlink{yubihsm__pkcs11_8c_a7360b55975153b822efc5217b7734e6a}{len}}(lst),\ 2)}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00011}00011\ \ \ \ \ \textcolor{keywordflow}{if}\ odd:}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00012}00012\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ lst[mid]}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00013}00013\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00014}00014\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (lst[mid\ -\/\ 1]\ +\ lst[mid])\ /\ 2.0}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00015}00015\ }
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00016}\mbox{\hyperlink{namespacebenchmark_compile_ab15f277aa6070b1860659aa082138cfb}{00016}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacebenchmark_compile_ab15f277aa6070b1860659aa082138cfb}{mean}}(lst):}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00017}00017\ \ \ \ \ \textcolor{keywordflow}{return}\ float(sum(lst))\ /\ max(\mbox{\hyperlink{yubihsm__pkcs11_8c_a7360b55975153b822efc5217b7734e6a}{len}}(lst),\ 1)}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00018}00018\ }
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00019}\mbox{\hyperlink{namespacebenchmark_compile_a6124fda4225440fd77dac7ce42922114}{00019}}\ compiler\_path\ =\ \textcolor{stringliteral}{''}}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00020}\mbox{\hyperlink{namespacebenchmark_compile_a17bc33abcf4acfd6804ec9ac8db45347}{00020}}\ flags\ =\ []}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00021}00021\ }
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00022}\mbox{\hyperlink{namespacebenchmark_compile_aa01b0fdadeb5d4c53905402fdf7f5aa8}{00022}}\ main\_file\ =\ \textcolor{stringliteral}{r'''}}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00023}00023\ \textcolor{stringliteral}{\#define\ CATCH\_CONFIG\_MAIN}}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00024}00024\ \textcolor{stringliteral}{\#include\ "{}catch.hpp"{}}}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00025}00025\ \textcolor{stringliteral}{'''}}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00026}\mbox{\hyperlink{namespacebenchmark_compile_adea45a2edcfb31d52a9854e5765928a7}{00026}}\ main\_name\ =\ \textcolor{stringliteral}{'catch-\/main.cpp'}}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00027}00027\ }
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00028}\mbox{\hyperlink{namespacebenchmark_compile_a85b2b717eddc0b818e0e6e236bab71a8}{00028}}\ dir\_name\ =\ \textcolor{stringliteral}{'benchmark-\/dir'}}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00029}00029\ }
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00030}\mbox{\hyperlink{namespacebenchmark_compile_a751894b8c4c425e44626dd4a47793199}{00030}}\ files\ =\ 20}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00031}\mbox{\hyperlink{namespacebenchmark_compile_aeb505c7e8966c7f51fcf461a3e421ad3}{00031}}\ test\_cases\_in\_file\ =\ 20}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00032}\mbox{\hyperlink{namespacebenchmark_compile_ad6746cb7609952bda545aef04ba163a5}{00032}}\ sections\_in\_file\ =\ 4}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00033}\mbox{\hyperlink{namespacebenchmark_compile_a2ff0b9d67dfc32f7d7ee49a68fca0b5f}{00033}}\ assertions\_per\_section\ =\ 5}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00034}00034\ }
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00035}\mbox{\hyperlink{namespacebenchmark_compile_ad7bec22efb3770af79e0b6df76b0cc0e}{00035}}\ checks\ =\ [}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00036}00036\ \ \ \ \ \textcolor{stringliteral}{'a\ !=\ b'},\ \textcolor{stringliteral}{'a\ !=\ c'},\ \textcolor{stringliteral}{'a\ !=\ d'},\ \textcolor{stringliteral}{'a\ !=\ e'},\ \textcolor{stringliteral}{'b\ !=\ c'},\ \textcolor{stringliteral}{'b\ !=\ d'},\ \textcolor{stringliteral}{'b\ !=\ e'},\ \textcolor{stringliteral}{'c\ !=\ d'},\ \textcolor{stringliteral}{'c\ !=\ e'},\ \textcolor{stringliteral}{'d\ !=\ e'},\ \textcolor{stringliteral}{'a\ +\ a\ ==\ a'},}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00037}00037\ \ \ \ \ \textcolor{stringliteral}{'a\ +\ b\ ==\ b'},\ \textcolor{stringliteral}{'a\ +\ c\ ==\ c'},\ \textcolor{stringliteral}{'a\ +\ d\ ==\ d'},\ \textcolor{stringliteral}{'a\ +\ e\ ==\ e'},\ \textcolor{stringliteral}{'b\ +\ a\ ==\ b'},\ \textcolor{stringliteral}{'b\ +\ b\ ==\ c'},\ \textcolor{stringliteral}{'b\ +\ c\ ==\ d'},}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00038}00038\ \ \ \ \ \textcolor{stringliteral}{'b\ +\ d\ ==\ e'},\ \textcolor{stringliteral}{'c\ +\ a\ ==\ c'},\ \textcolor{stringliteral}{'c\ +\ b\ ==\ d'},\ \textcolor{stringliteral}{'c\ +\ c\ ==\ e'},\ \textcolor{stringliteral}{'d\ +\ a\ ==\ d'},\ \textcolor{stringliteral}{'d\ +\ b\ ==\ e'},\ \textcolor{stringliteral}{'e\ +\ a\ ==\ e'},}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00039}00039\ \ \ \ \ \textcolor{stringliteral}{'a\ +\ a\ +\ a\ ==\ a'},\ \textcolor{stringliteral}{'b\ +\ c\ ==\ a\ +\ d'},\ \textcolor{stringliteral}{'c\ +\ a\ +\ a\ ==\ a\ +\ b\ +\ b\ +\ a'},}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00040}00040\ \ \ \ \ \textcolor{stringliteral}{'a\ <\ b'},\ \textcolor{stringliteral}{'b\ <\ c'},\ \textcolor{stringliteral}{'c\ <\ d'},\ \textcolor{stringliteral}{'d\ <\ e'},\ \textcolor{stringliteral}{'a\ >=\ a'},\ \textcolor{stringliteral}{'d\ >=\ b'},}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00041}00041\ ]}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00042}00042\ }
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00043}\mbox{\hyperlink{namespacebenchmark_compile_a14eea68e472265a6a24c319f0c1cf173}{00043}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacebenchmark_compile_a14eea68e472265a6a24c319f0c1cf173}{create\_temp\_dir}}():}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00044}00044\ \ \ \ \ \textcolor{keywordflow}{if}\ os.path.exists(dir\_name):}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00045}00045\ \ \ \ \ \ \ \ \ shutil.rmtree(dir\_name)}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00046}00046\ \ \ \ \ os.mkdir(dir\_name)}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00047}00047\ }
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00048}\mbox{\hyperlink{namespacebenchmark_compile_a46f8a1c8e58e2991f631bd8375807805}{00048}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacebenchmark_compile_a46f8a1c8e58e2991f631bd8375807805}{copy\_catch}}(path\_to\_catch):}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00049}00049\ \ \ \ \ shutil.copy(path\_to\_catch,\ dir\_name)}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00050}00050\ }
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00051}\mbox{\hyperlink{namespacebenchmark_compile_a065c5fbd86df2eb4f344bb886a318194}{00051}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacebenchmark_compile_a065c5fbd86df2eb4f344bb886a318194}{create\_catch\_main}}():}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00052}00052\ \ \ \ \ \textcolor{keyword}{with}\ open(main\_name,\ \textcolor{stringliteral}{'w'})\ \textcolor{keyword}{as}\ f:}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00053}00053\ \ \ \ \ \ \ \ \ f.write(main\_file)}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00054}00054\ }
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00055}\mbox{\hyperlink{namespacebenchmark_compile_a3ca97500ee7e81094ad905c89723d666}{00055}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacebenchmark_compile_a3ca97500ee7e81094ad905c89723d666}{compile\_main}}():}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00056}00056\ \ \ \ \ start\_t\ =\ time.time()}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00057}00057\ \ \ \ \ subprocess.check\_call([compiler\_path,\ main\_name,\ \textcolor{stringliteral}{'-\/c'}]\ +\ flags)}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00058}00058\ \ \ \ \ end\_t\ =\ time.time()}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00059}00059\ \ \ \ \ \textcolor{keywordflow}{return}\ end\_t\ -\/\ start\_t}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00060}00060\ }
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00061}\mbox{\hyperlink{namespacebenchmark_compile_a623cd853b00bb3493538da2e9ac540e4}{00061}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacebenchmark_compile_a623cd853b00bb3493538da2e9ac540e4}{compile\_files}}():}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00062}00062\ \ \ \ \ cpp\_files\ =\ glob.glob(\textcolor{stringliteral}{'tests*.cpp'})}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00063}00063\ \ \ \ \ start\_t\ =\ time.time()}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00064}00064\ \ \ \ \ subprocess.check\_call([compiler\_path,\ \textcolor{stringliteral}{'-\/c'}]\ +\ flags\ +\ cpp\_files)}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00065}00065\ \ \ \ \ end\_t\ =\ time.time()}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00066}00066\ \ \ \ \ \textcolor{keywordflow}{return}\ end\_t\ -\/\ start\_t}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00067}00067\ }
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00068}\mbox{\hyperlink{namespacebenchmark_compile_a0adabc1142e02b4ba7c66ef253ee6e1a}{00068}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacebenchmark_compile_a0adabc1142e02b4ba7c66ef253ee6e1a}{link\_files}}():}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00069}00069\ \ \ \ \ obj\_files\ =\ glob.glob(\textcolor{stringliteral}{'*.o'})}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00070}00070\ \ \ \ \ start\_t\ =\ time.time()}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00071}00071\ \ \ \ \ subprocess.check\_call([compiler\_path]\ +\ flags\ +\ obj\_files)}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00072}00072\ \ \ \ \ end\_t\ =\ time.time()}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00073}00073\ \ \ \ \ \textcolor{keywordflow}{return}\ end\_t\ -\/\ start\_t}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00074}00074\ }
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00075}\mbox{\hyperlink{namespacebenchmark_compile_ad29a9c658be0bfc9585b6e6eedd783c4}{00075}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacebenchmark_compile_ad29a9c658be0bfc9585b6e6eedd783c4}{benchmark}}(func):}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00076}00076\ \ \ \ \ results\ =\ [func()\ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ range(10)]}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00077}00077\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacebenchmark_compile_ab15f277aa6070b1860659aa082138cfb}{mean}}(results),\ median(results)}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00078}00078\ }
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00079}\mbox{\hyperlink{namespacebenchmark_compile_a9f5fd778e5f63640036c6cf96b5d1773}{00079}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacebenchmark_compile_a9f5fd778e5f63640036c6cf96b5d1773}{char\_range}}(start,\ end):}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00080}00080\ \ \ \ \ \textcolor{keywordflow}{for}\ c\ \textcolor{keywordflow}{in}\ range(ord(start),\ ord(end)):}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00081}00081\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{yield}\ chr(c)}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00082}00082\ }
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00083}\mbox{\hyperlink{namespacebenchmark_compile_aac0d03b9105d4e0d49b31c2ad50d700d}{00083}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacebenchmark_compile_aac0d03b9105d4e0d49b31c2ad50d700d}{generate\_sections}}(fd):}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00084}00084\ \ \ \ \ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ range(sections\_in\_file):}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00085}00085\ \ \ \ \ \ \ \ \ fd.write(\textcolor{stringliteral}{'\ \ \ \ SECTION("{}Section\ \{\}"{})\ \{\{\(\backslash\)n'}.\mbox{\hyperlink{yubihsm-shell_8h_ae425c09a4c40409de33790765339cb97}{format}}(i))}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00086}00086\ \ \ \ \ \ \ \ \ fd.write(\textcolor{stringliteral}{'\(\backslash\)n'}.join(\textcolor{stringliteral}{'\ \ \ \ \ \ \ \ CHECK(\{\});'}.\mbox{\hyperlink{yubihsm-shell_8h_ae425c09a4c40409de33790765339cb97}{format}}(check)\ \textcolor{keywordflow}{for}\ check\ \textcolor{keywordflow}{in}\ random.sample(checks,\ assertions\_per\_section)))}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00087}00087\ \ \ \ \ \ \ \ \ fd.write(\textcolor{stringliteral}{'\ \ \ \ \}\(\backslash\)n'})}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00088}00088\ }
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00089}00089\ }
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00090}\mbox{\hyperlink{namespacebenchmark_compile_aae6da4ee8f40da1a91c03fb86ecd0c56}{00090}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacebenchmark_compile_aae6da4ee8f40da1a91c03fb86ecd0c56}{generate\_file}}(file\_no):}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00091}00091\ \ \ \ \ \textcolor{keyword}{with}\ open(\textcolor{stringliteral}{'tests\{\}.cpp'}.\mbox{\hyperlink{yubihsm-shell_8h_ae425c09a4c40409de33790765339cb97}{format}}(file\_no),\ \textcolor{stringliteral}{'w'})\ \textcolor{keyword}{as}\ f:}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00092}00092\ \ \ \ \ \ \ \ \ f.write(\textcolor{stringliteral}{'\#include\ "{}catch.hpp"{}\(\backslash\)n\(\backslash\)n'})}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00093}00093\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ range(test\_cases\_in\_file):}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00094}00094\ \ \ \ \ \ \ \ \ \ \ \ \ f.write(\textcolor{stringliteral}{'TEST\_CASE("{}File\ \{\}\ test\ \{\}"{},\ "{}[.compile]"{})\{\{\(\backslash\)n'}.\mbox{\hyperlink{yubihsm-shell_8h_ae425c09a4c40409de33790765339cb97}{format}}(file\_no,\ i))}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00095}00095\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ i,\ c\ \textcolor{keywordflow}{in}\ enumerate(\mbox{\hyperlink{namespacebenchmark_compile_a9f5fd778e5f63640036c6cf96b5d1773}{char\_range}}(\textcolor{stringliteral}{'a'},\ \textcolor{stringliteral}{'f'})):}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00096}00096\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f.write(\textcolor{stringliteral}{'\ \ \ \ int\ \{\}\ =\ \{\};\(\backslash\)n'}.\mbox{\hyperlink{yubihsm-shell_8h_ae425c09a4c40409de33790765339cb97}{format}}(c,\ i))}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00097}00097\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacebenchmark_compile_aac0d03b9105d4e0d49b31c2ad50d700d}{generate\_sections}}(f)}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00098}00098\ \ \ \ \ \ \ \ \ \ \ \ \ f.write(\textcolor{stringliteral}{'\}\(\backslash\)n\(\backslash\)n'})}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00099}00099\ }
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00100}00100\ }
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00101}\mbox{\hyperlink{namespacebenchmark_compile_a612beda8f4e9a12e058b3cfe0334e158}{00101}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacebenchmark_compile_a612beda8f4e9a12e058b3cfe0334e158}{generate\_files}}():}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00102}00102\ \ \ \ \ \mbox{\hyperlink{namespacebenchmark_compile_a065c5fbd86df2eb4f344bb886a318194}{create\_catch\_main}}()}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00103}00103\ \ \ \ \ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ range(files):}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00104}00104\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacebenchmark_compile_aae6da4ee8f40da1a91c03fb86ecd0c56}{generate\_file}}(i)}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00105}00105\ }
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00106}00106\ }
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00107}\mbox{\hyperlink{namespacebenchmark_compile_acf738bbf3b8391aa78929ceeceb8a03b}{00107}}\ options\ =\ [\textcolor{stringliteral}{'all'},\ \textcolor{stringliteral}{'main'},\ \textcolor{stringliteral}{'files'},\ \textcolor{stringliteral}{'link'}]}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00108}00108\ }
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00109}\mbox{\hyperlink{namespacebenchmark_compile_ac6c43ca250988bb9de13da461f8b77d5}{00109}}\ parser\ =\ argparse.ArgumentParser(description=\textcolor{stringliteral}{'Benchmarks\ Catch\(\backslash\)'s\ compile\ times\ against\ some\ synthetic\ tests'})}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00110}00110\ \textcolor{comment}{\#\ Add\ first\ arg\ -\/-\/\ benchmark\ type}}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00111}\mbox{\hyperlink{namespacebenchmark_compile_a0c0f4b30eab8f18704aa068eeae594b4}{00111}}\ parser.add\_argument(\textcolor{stringliteral}{'benchmark\_kind'},\ nargs=\textcolor{stringliteral}{'?'},\ default=\textcolor{stringliteral}{'all'},\ choices=options,\ help=\textcolor{stringliteral}{'What\ kind\ of\ benchmark\ to\ run,\ default:\ all'})}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00112}00112\ }
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00113}00113\ \textcolor{comment}{\#\ Args\ to\ allow\ changing\ header/compiler}}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00114}00114\ parser.add\_argument(\textcolor{stringliteral}{'-\/I'},\ \textcolor{stringliteral}{'-\/-\/catch-\/header'},\ default=\textcolor{stringliteral}{'catch.hpp'},\ help\ =\ \textcolor{stringliteral}{'Path\ to\ catch.hpp,\ default:\ catch.hpp'})}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00115}00115\ parser.add\_argument(\textcolor{stringliteral}{'-\/c'},\ \textcolor{stringliteral}{'-\/-\/compiler'},\ default=\textcolor{stringliteral}{'g++'},\ help\ =\ \textcolor{stringliteral}{'Compiler\ to\ use,\ default:\ g++'})}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00116}00116\ }
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00117}00117\ parser.add\_argument(\textcolor{stringliteral}{'-\/f'},\ \textcolor{stringliteral}{'-\/-\/flags'},\ help\ =\ \textcolor{stringliteral}{'Flags\ to\ be\ passed\ to\ the\ compiler.\ Pass\ as\ "{},"{}\ separated\ list'})}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00118}00118\ }
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00119}00119\ \textcolor{comment}{\#\ Allow\ creating\ files\ only,\ without\ running\ the\ whole\ thing}}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00120}\mbox{\hyperlink{namespacebenchmark_compile_a9b31b07ddf144e1a59020aeb458745bf}{00120}}\ parser.add\_argument(\textcolor{stringliteral}{'-\/g'},\ \textcolor{stringliteral}{'-\/-\/generate-\/files'},\ action=\textcolor{stringliteral}{'store\_true'},\ help=\textcolor{stringliteral}{'Generate\ test\ files\ and\ quit'})}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00121}00121\ }
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00122}\mbox{\hyperlink{namespacebenchmark_compile_ad0ed96ae1454e4347ca61ac3887c379e}{00122}}\ args\ =\ parser.parse\_args()}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00123}00123\ }
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00124}00124\ compiler\_path\ =\ args.compiler}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00125}\mbox{\hyperlink{namespacebenchmark_compile_a5cdbdac4dcea15991fea8f027d8f85e5}{00125}}\ catch\_path\ =\ args.catch\_header}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00126}00126\ }
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00127}00127\ \textcolor{keywordflow}{if}\ args.generate\_files:}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00128}00128\ \ \ \ \ \mbox{\hyperlink{namespacebenchmark_compile_a14eea68e472265a6a24c319f0c1cf173}{create\_temp\_dir}}()}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00129}00129\ \ \ \ \ \mbox{\hyperlink{namespacebenchmark_compile_a46f8a1c8e58e2991f631bd8375807805}{copy\_catch}}(catch\_path)}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00130}00130\ \ \ \ \ os.chdir(dir\_name)}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00131}00131\ \ \ \ \ \textcolor{comment}{\#\ now\ create\ the\ fake\ test\ files}}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00132}00132\ \ \ \ \ \mbox{\hyperlink{namespacebenchmark_compile_a612beda8f4e9a12e058b3cfe0334e158}{generate\_files}}()}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00133}00133\ \ \ \ \ \textcolor{comment}{\#\ Early\ exit}}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00134}00134\ \ \ \ \ \mbox{\hyperlink{210-_evt-_event_listeners_8cpp_a91b9457094088a57b7ba14d485a8771e}{print}}(\textcolor{stringliteral}{'Finished\ generating\ files'})}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00135}00135\ \ \ \ \ exit(1)}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00136}00136\ }
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00137}00137\ os.chdir(dir\_name)}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00138}00138\ }
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00139}00139\ \textcolor{keywordflow}{if}\ args.flags:}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00140}00140\ \ \ \ \ flags\ =\ args.flags.split(\textcolor{stringliteral}{','})}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00141}00141\ }
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00142}00142\ \mbox{\hyperlink{210-_evt-_event_listeners_8cpp_a91b9457094088a57b7ba14d485a8771e}{print}}(\textcolor{stringliteral}{'Time\ needed\ for\ ...'})}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00143}00143\ \textcolor{keywordflow}{if}\ args.benchmark\_kind\ \textcolor{keywordflow}{in}\ (\textcolor{stringliteral}{'all'},\ \textcolor{stringliteral}{'main'}):}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00144}00144\ \ \ \ \ \mbox{\hyperlink{210-_evt-_event_listeners_8cpp_a91b9457094088a57b7ba14d485a8771e}{print}}(\textcolor{stringliteral}{'\ \ \ \ \ \ \ \ ...\ compiling\ main,\ mean:\ \{:.2f\},\ median:\ \{:.2f\}\ s'}.\mbox{\hyperlink{yubihsm-shell_8h_ae425c09a4c40409de33790765339cb97}{format}}(*\mbox{\hyperlink{namespacebenchmark_compile_ad29a9c658be0bfc9585b6e6eedd783c4}{benchmark}}(compile\_main)))}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00145}00145\ \textcolor{keywordflow}{if}\ args.benchmark\_kind\ \textcolor{keywordflow}{in}\ (\textcolor{stringliteral}{'all'},\ \textcolor{stringliteral}{'files'}):}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00146}00146\ \ \ \ \ \mbox{\hyperlink{210-_evt-_event_listeners_8cpp_a91b9457094088a57b7ba14d485a8771e}{print}}(\textcolor{stringliteral}{'\ \ \ \ \ \ \ \ ...\ compiling\ test\ files,\ mean:\ \{:.2f\},\ median:\ \{:.2f\}\ s'}.\mbox{\hyperlink{yubihsm-shell_8h_ae425c09a4c40409de33790765339cb97}{format}}(*\mbox{\hyperlink{namespacebenchmark_compile_ad29a9c658be0bfc9585b6e6eedd783c4}{benchmark}}(compile\_files)))}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00147}00147\ \textcolor{keywordflow}{if}\ args.benchmark\_kind\ \textcolor{keywordflow}{in}\ (\textcolor{stringliteral}{'all'},\ \textcolor{stringliteral}{'link'}):}
\DoxyCodeLine{\Hypertarget{benchmark_compile_8py_source_l00148}00148\ \ \ \ \ \mbox{\hyperlink{210-_evt-_event_listeners_8cpp_a91b9457094088a57b7ba14d485a8771e}{print}}(\textcolor{stringliteral}{'\ \ \ \ \ \ \ \ ...\ linking\ everything,\ mean:\ \{:.2f\},\ median:\ \{:.2f\}\ s'}.\mbox{\hyperlink{yubihsm-shell_8h_ae425c09a4c40409de33790765339cb97}{format}}(*\mbox{\hyperlink{namespacebenchmark_compile_ad29a9c658be0bfc9585b6e6eedd783c4}{benchmark}}(link\_files)))}

\end{DoxyCode}
