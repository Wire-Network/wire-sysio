<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Wire Sysio: libraries/fc/secp256k1/secp256k1/contrib/lax_der_privatekey_parsing.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Wire Sysio<span id="projectnumber">&#160;Wire Sysion 1.0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('lax__der__privatekey__parsing_8c.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">lax_der_privatekey_parsing.c File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;string.h&gt;</code><br />
<code>#include &quot;<a class="el" href="lax__der__privatekey__parsing_8h_source.html">lax_der_privatekey_parsing.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for lax_der_privatekey_parsing.c:</div>
<div class="dyncontent">
<div class="center"><img src="lax__der__privatekey__parsing_8c__incl.png" border="0" usemap="#alibraries_2fc_2secp256k1_2secp256k1_2contrib_2lax__der__privatekey__parsing_8c" alt=""/></div>
<map name="alibraries_2fc_2secp256k1_2secp256k1_2contrib_2lax__der__privatekey__parsing_8c" id="alibraries_2fc_2secp256k1_2secp256k1_2contrib_2lax__der__privatekey__parsing_8c">
<area shape="rect" title=" " alt="" coords="11,5,184,61"/>
<area shape="rect" title=" " alt="" coords="5,116,70,142"/>
<area shape="poly" title=" " alt="" coords="82,63,55,105,51,102,78,60"/>
<area shape="rect" href="lax__der__privatekey__parsing_8h.html" title=" " alt="" coords="94,109,224,150"/>
<area shape="poly" title=" " alt="" coords="117,60,140,94,136,97,113,63"/>
<area shape="rect" href="secp256k1_8h.html" title=" " alt="" coords="111,198,206,223"/>
<area shape="poly" title=" " alt="" coords="162,150,162,182,156,182,156,150"/>
<area shape="rect" title=" " alt="" coords="125,271,193,297"/>
<area shape="poly" title=" " alt="" coords="162,224,162,256,156,256,156,224"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="lax__der__privatekey__parsing_8c__dep__incl.png" border="0" usemap="#alibraries_2fc_2secp256k1_2secp256k1_2contrib_2lax__der__privatekey__parsing_8cdep" alt=""/></div>
<map name="alibraries_2fc_2secp256k1_2secp256k1_2contrib_2lax__der__privatekey__parsing_8cdep" id="alibraries_2fc_2secp256k1_2secp256k1_2contrib_2lax__der__privatekey__parsing_8cdep">
<area shape="rect" title=" " alt="" coords="5,5,179,61"/>
<area shape="rect" href="tests_8c.html" title=" " alt="" coords="15,109,169,150"/>
<area shape="poly" title=" " alt="" coords="95,77,95,109,89,109,89,77"/>
</map>
</div>
</div>
<p><a href="lax__der__privatekey__parsing_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ab807c294559193bc65b53f14ca677db6" id="r_ab807c294559193bc65b53f14ca677db6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab807c294559193bc65b53f14ca677db6">ec_privkey_import_der</a> (const <a class="el" href="secp256k1_8h.html#a282ec9e6dfec8c35955c3eb2f7476e5e">secp256k1_context</a> *ctx, unsigned char *out32, const unsigned char *privkey, size_t privkeylen)</td></tr>
<tr class="separator:ab807c294559193bc65b53f14ca677db6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ff2773bdc052e3af4def4afb183c95c" id="r_a9ff2773bdc052e3af4def4afb183c95c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9ff2773bdc052e3af4def4afb183c95c">ec_privkey_export_der</a> (const <a class="el" href="secp256k1_8h.html#a282ec9e6dfec8c35955c3eb2f7476e5e">secp256k1_context</a> *ctx, unsigned char *privkey, size_t *privkeylen, const unsigned char *key32, int compressed)</td></tr>
<tr class="separator:a9ff2773bdc052e3af4def4afb183c95c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a9ff2773bdc052e3af4def4afb183c95c" name="a9ff2773bdc052e3af4def4afb183c95c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ff2773bdc052e3af4def4afb183c95c">&#9670;&#160;</a></span>ec_privkey_export_der()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ec_privkey_export_der </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="secp256k1_8h.html#a282ec9e6dfec8c35955c3eb2f7476e5e">secp256k1_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *</td>          <td class="paramname"><span class="paramname"><em>privkey</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *</td>          <td class="paramname"><span class="paramname"><em>privkeylen</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *</td>          <td class="paramname"><span class="paramname"><em>seckey</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>compressed</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Export a private key in DER format.</p>
<p>Returns: 1 if the private key was valid. Args: ctx: pointer to a context object, initialized for signing (cannot be NULL) Out: privkey: pointer to an array for storing the private key in BER. Should have space for 279 bytes, and cannot be NULL. privkeylen: Pointer to an int where the length of the private key in privkey will be stored. In: seckey: pointer to a 32-byte secret key to export. compressed: 1 if the key should be exported in compressed format, 0 otherwise</p>
<p>This function is purely meant for compatibility with applications that require BER encoded keys. When working with secp256k1-specific code, the simple 32-byte private keys are sufficient.</p>
<p>Note that this function does not guarantee correct DER output. It is guaranteed to be parsable by secp256k1_ec_privkey_import_der </p>

<p class="definition">Definition at line <a class="el" href="lax__der__privatekey__parsing_8c_source.html#l00055">55</a> of file <a class="el" href="lax__der__privatekey__parsing_8c_source.html">lax_der_privatekey_parsing.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   55</span>                                                                                                                                                {</div>
<div class="line"><span class="lineno">   56</span>    <a class="code hl_struct" href="structsecp256k1__pubkey.html">secp256k1_pubkey</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a931987c85fd408a620505ee9a1aa6f58">pubkey</a>;</div>
<div class="line"><span class="lineno">   57</span>    <span class="keywordtype">size_t</span> pubkeylen = 0;</div>
<div class="line"><span class="lineno">   58</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="secp256k1_8h.html#a7438071aa8a6dc4697abe4f4659f2161">secp256k1_ec_pubkey_create</a>(ctx, &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a931987c85fd408a620505ee9a1aa6f58">pubkey</a>, key32)) {</div>
<div class="line"><span class="lineno">   59</span>        *privkeylen = 0;</div>
<div class="line"><span class="lineno">   60</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">   61</span>    }</div>
<div class="line"><span class="lineno">   62</span>    <span class="keywordflow">if</span> (compressed) {</div>
<div class="line"><span class="lineno">   63</span>        <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> begin[] = {</div>
<div class="line"><span class="lineno">   64</span>            0x30,0x81,0xD3,0x02,0x01,0x01,0x04,0x20</div>
<div class="line"><span class="lineno">   65</span>        };</div>
<div class="line"><span class="lineno">   66</span>        <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> middle[] = {</div>
<div class="line"><span class="lineno">   67</span>            0xA0,0x81,0x85,0x30,0x81,0x82,0x02,0x01,0x01,0x30,0x2C,0x06,0x07,0x2A,0x86,0x48,</div>
<div class="line"><span class="lineno">   68</span>            0xCE,0x3D,0x01,0x01,0x02,0x21,0x00,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,</div>
<div class="line"><span class="lineno">   69</span>            0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,</div>
<div class="line"><span class="lineno">   70</span>            0xFF,0xFF,0xFE,0xFF,0xFF,0xFC,0x2F,0x30,0x06,0x04,0x01,0x00,0x04,0x01,0x07,0x04,</div>
<div class="line"><span class="lineno">   71</span>            0x21,0x02,0x79,0xBE,0x66,0x7E,0xF9,0xDC,0xBB,0xAC,0x55,0xA0,0x62,0x95,0xCE,0x87,</div>
<div class="line"><span class="lineno">   72</span>            0x0B,0x07,0x02,0x9B,0xFC,0xDB,0x2D,0xCE,0x28,0xD9,0x59,0xF2,0x81,0x5B,0x16,0xF8,</div>
<div class="line"><span class="lineno">   73</span>            0x17,0x98,0x02,0x21,0x00,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,</div>
<div class="line"><span class="lineno">   74</span>            0xFF,0xFF,0xFF,0xFF,0xFE,0xBA,0xAE,0xDC,0xE6,0xAF,0x48,0xA0,0x3B,0xBF,0xD2,0x5E,</div>
<div class="line"><span class="lineno">   75</span>            0x8C,0xD0,0x36,0x41,0x41,0x02,0x01,0x01,0xA1,0x24,0x03,0x22,0x00</div>
<div class="line"><span class="lineno">   76</span>        };</div>
<div class="line"><span class="lineno">   77</span>        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *ptr = privkey;</div>
<div class="line"><span class="lineno">   78</span>        <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(ptr, begin, <span class="keyword">sizeof</span>(begin)); ptr += <span class="keyword">sizeof</span>(begin);</div>
<div class="line"><span class="lineno">   79</span>        <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(ptr, key32, 32); ptr += 32;</div>
<div class="line"><span class="lineno">   80</span>        <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(ptr, middle, <span class="keyword">sizeof</span>(middle)); ptr += <span class="keyword">sizeof</span>(middle);</div>
<div class="line"><span class="lineno">   81</span>        pubkeylen = 33;</div>
<div class="line"><span class="lineno">   82</span>        <a class="code hl_function" href="secp256k1_8h.html#a34977bf00322e510e881160c421836d7">secp256k1_ec_pubkey_serialize</a>(ctx, ptr, &amp;pubkeylen, &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a931987c85fd408a620505ee9a1aa6f58">pubkey</a>, <a class="code hl_define" href="secp256k1_8h.html#a7b8f642c65e8b5c81fa4421b7c42ab57">SECP256K1_EC_COMPRESSED</a>);</div>
<div class="line"><span class="lineno">   83</span>        ptr += pubkeylen;</div>
<div class="line"><span class="lineno">   84</span>        *privkeylen = ptr - privkey;</div>
<div class="line"><span class="lineno">   85</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">   86</span>        <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> begin[] = {</div>
<div class="line"><span class="lineno">   87</span>            0x30,0x82,0x01,0x13,0x02,0x01,0x01,0x04,0x20</div>
<div class="line"><span class="lineno">   88</span>        };</div>
<div class="line"><span class="lineno">   89</span>        <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> middle[] = {</div>
<div class="line"><span class="lineno">   90</span>            0xA0,0x81,0xA5,0x30,0x81,0xA2,0x02,0x01,0x01,0x30,0x2C,0x06,0x07,0x2A,0x86,0x48,</div>
<div class="line"><span class="lineno">   91</span>            0xCE,0x3D,0x01,0x01,0x02,0x21,0x00,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,</div>
<div class="line"><span class="lineno">   92</span>            0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,</div>
<div class="line"><span class="lineno">   93</span>            0xFF,0xFF,0xFE,0xFF,0xFF,0xFC,0x2F,0x30,0x06,0x04,0x01,0x00,0x04,0x01,0x07,0x04,</div>
<div class="line"><span class="lineno">   94</span>            0x41,0x04,0x79,0xBE,0x66,0x7E,0xF9,0xDC,0xBB,0xAC,0x55,0xA0,0x62,0x95,0xCE,0x87,</div>
<div class="line"><span class="lineno">   95</span>            0x0B,0x07,0x02,0x9B,0xFC,0xDB,0x2D,0xCE,0x28,0xD9,0x59,0xF2,0x81,0x5B,0x16,0xF8,</div>
<div class="line"><span class="lineno">   96</span>            0x17,0x98,0x48,0x3A,0xDA,0x77,0x26,0xA3,0xC4,0x65,0x5D,0xA4,0xFB,0xFC,0x0E,0x11,</div>
<div class="line"><span class="lineno">   97</span>            0x08,0xA8,0xFD,0x17,0xB4,0x48,0xA6,0x85,0x54,0x19,0x9C,0x47,0xD0,0x8F,0xFB,0x10,</div>
<div class="line"><span class="lineno">   98</span>            0xD4,0xB8,0x02,0x21,0x00,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,</div>
<div class="line"><span class="lineno">   99</span>            0xFF,0xFF,0xFF,0xFF,0xFE,0xBA,0xAE,0xDC,0xE6,0xAF,0x48,0xA0,0x3B,0xBF,0xD2,0x5E,</div>
<div class="line"><span class="lineno">  100</span>            0x8C,0xD0,0x36,0x41,0x41,0x02,0x01,0x01,0xA1,0x44,0x03,0x42,0x00</div>
<div class="line"><span class="lineno">  101</span>        };</div>
<div class="line"><span class="lineno">  102</span>        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *ptr = privkey;</div>
<div class="line"><span class="lineno">  103</span>        <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(ptr, begin, <span class="keyword">sizeof</span>(begin)); ptr += <span class="keyword">sizeof</span>(begin);</div>
<div class="line"><span class="lineno">  104</span>        <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(ptr, key32, 32); ptr += 32;</div>
<div class="line"><span class="lineno">  105</span>        <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(ptr, middle, <span class="keyword">sizeof</span>(middle)); ptr += <span class="keyword">sizeof</span>(middle);</div>
<div class="line"><span class="lineno">  106</span>        pubkeylen = 65;</div>
<div class="line"><span class="lineno">  107</span>        <a class="code hl_function" href="secp256k1_8h.html#a34977bf00322e510e881160c421836d7">secp256k1_ec_pubkey_serialize</a>(ctx, ptr, &amp;pubkeylen, &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a931987c85fd408a620505ee9a1aa6f58">pubkey</a>, <a class="code hl_define" href="secp256k1_8h.html#ab8e25dc58843e83926f95795f9e8a6e2">SECP256K1_EC_UNCOMPRESSED</a>);</div>
<div class="line"><span class="lineno">  108</span>        ptr += pubkeylen;</div>
<div class="line"><span class="lineno">  109</span>        *privkeylen = ptr - privkey;</div>
<div class="line"><span class="lineno">  110</span>    }</div>
<div class="line"><span class="lineno">  111</span>    <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">  112</span>}</div>
<div class="ttc" id="asecp256k1_8h_html_a34977bf00322e510e881160c421836d7"><div class="ttname"><a href="secp256k1_8h.html#a34977bf00322e510e881160c421836d7">secp256k1_ec_pubkey_serialize</a></div><div class="ttdeci">SECP256K1_API int secp256k1_ec_pubkey_serialize(const secp256k1_context *ctx, unsigned char *output, size_t *outputlen, const secp256k1_pubkey *pubkey, unsigned int flags) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3) SECP256K1_ARG_NONNULL(4)</div><div class="ttdef"><b>Definition</b> <a href="secp256k1_8c_source.html#l00246">secp256k1.c:246</a></div></div>
<div class="ttc" id="asecp256k1_8h_html_a7438071aa8a6dc4697abe4f4659f2161"><div class="ttname"><a href="secp256k1_8h.html#a7438071aa8a6dc4697abe4f4659f2161">secp256k1_ec_pubkey_create</a></div><div class="ttdeci">SECP256K1_API SECP256K1_WARN_UNUSED_RESULT int secp256k1_ec_pubkey_create(const secp256k1_context *ctx, secp256k1_pubkey *pubkey, const unsigned char *seckey) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3)</div><div class="ttdef"><b>Definition</b> <a href="secp256k1_8c_source.html#l00551">secp256k1.c:551</a></div></div>
<div class="ttc" id="asecp256k1_8h_html_a7b8f642c65e8b5c81fa4421b7c42ab57"><div class="ttname"><a href="secp256k1_8h.html#a7b8f642c65e8b5c81fa4421b7c42ab57">SECP256K1_EC_COMPRESSED</a></div><div class="ttdeci">#define SECP256K1_EC_COMPRESSED</div><div class="ttdef"><b>Definition</b> <a href="secp256k1_8h_source.html#l00201">secp256k1.h:201</a></div></div>
<div class="ttc" id="asecp256k1_8h_html_ab8e25dc58843e83926f95795f9e8a6e2"><div class="ttname"><a href="secp256k1_8h.html#ab8e25dc58843e83926f95795f9e8a6e2">SECP256K1_EC_UNCOMPRESSED</a></div><div class="ttdeci">#define SECP256K1_EC_UNCOMPRESSED</div><div class="ttdef"><b>Definition</b> <a href="secp256k1_8h_source.html#l00202">secp256k1.h:202</a></div></div>
<div class="ttc" id="astructsecp256k1__pubkey_html"><div class="ttname"><a href="structsecp256k1__pubkey.html">secp256k1_pubkey</a></div><div class="ttdef"><b>Definition</b> <a href="secp256k1_8h_source.html#l00070">secp256k1.h:70</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a931987c85fd408a620505ee9a1aa6f58"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a931987c85fd408a620505ee9a1aa6f58">pubkey</a></div><div class="ttdeci">CK_BYTE_PTR pubkey</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l04984">yubihsm_pkcs11.c:4984</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_ae785d5badbf1f08b491af31f32a135a1"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a></div><div class="ttdeci">memcpy((char *) pInfo-&gt;slotDescription, s, l)</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="lax__der__privatekey__parsing_8c_a9ff2773bdc052e3af4def4afb183c95c_cgraph.png" border="0" usemap="#alax__der__privatekey__parsing_8c_a9ff2773bdc052e3af4def4afb183c95c_cgraph" alt=""/></div>
<map name="alax__der__privatekey__parsing_8c_a9ff2773bdc052e3af4def4afb183c95c_cgraph" id="alax__der__privatekey__parsing_8c_a9ff2773bdc052e3af4def4afb183c95c_cgraph">
<area shape="rect" title=" " alt="" coords="5,63,158,88"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="247,5,318,31"/>
<area shape="poly" title=" " alt="" coords="129,59,232,30,233,35,130,65"/>
<area shape="rect" href="secp256k1_8c.html#ac5806cffd3278e64f863027eaa8e1284" title=" " alt="" coords="206,55,360,96"/>
<area shape="poly" title=" " alt="" coords="158,73,190,73,190,78,158,78"/>
<area shape="rect" href="secp256k1_8c.html#a3b0440ba2ccd06e9262b94b41b680df1" title=" " alt="" coords="206,120,360,161"/>
<area shape="poly" title=" " alt="" coords="124,86,204,113,203,118,123,91"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="408,96,476,122"/>
<area shape="poly" title=" " alt="" coords="361,89,393,96,392,101,360,94"/>
<area shape="poly" title=" " alt="" coords="360,123,392,116,393,121,361,128"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="lax__der__privatekey__parsing_8c_a9ff2773bdc052e3af4def4afb183c95c_icgraph.png" border="0" usemap="#alax__der__privatekey__parsing_8c_a9ff2773bdc052e3af4def4afb183c95c_icgraph" alt=""/></div>
<map name="alax__der__privatekey__parsing_8c_a9ff2773bdc052e3af4def4afb183c95c_icgraph" id="alax__der__privatekey__parsing_8c_a9ff2773bdc052e3af4def4afb183c95c_icgraph">
<area shape="rect" title=" " alt="" coords="519,31,672,56"/>
<area shape="rect" href="tests_8c.html#abbcb27d1eb13654db9b2e281ffce021e" title=" " alt="" coords="309,5,471,31"/>
<area shape="poly" title=" " alt="" coords="503,35,471,31,472,26,504,30"/>
<area shape="rect" href="tests_8c.html#a3fc9dc1908215215a68690ea1bfa8bcd" title=" " alt="" coords="310,55,470,80"/>
<area shape="poly" title=" " alt="" coords="504,57,471,61,470,56,503,52"/>
<area shape="rect" href="tests_8c.html#ad6c8109b62ea1d0ed1b382678a2a08b1" title=" " alt="" coords="103,5,261,31"/>
<area shape="poly" title=" " alt="" coords="294,21,261,21,261,16,294,16"/>
<area shape="rect" href="tests_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title=" " alt="" coords="5,31,55,56"/>
<area shape="poly" title=" " alt="" coords="88,37,56,42,55,37,87,31"/>
<area shape="rect" href="tests_8c.html#ab05096657be701bf9ca8616475bb9491" title=" " alt="" coords="104,55,260,80"/>
<area shape="poly" title=" " alt="" coords="295,70,260,70,260,65,295,65"/>
<area shape="poly" title=" " alt="" coords="88,55,55,50,56,45,89,50"/>
</map>
</div>

</div>
</div>
<a id="ab807c294559193bc65b53f14ca677db6" name="ab807c294559193bc65b53f14ca677db6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab807c294559193bc65b53f14ca677db6">&#9670;&#160;</a></span>ec_privkey_import_der()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ec_privkey_import_der </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="secp256k1_8h.html#a282ec9e6dfec8c35955c3eb2f7476e5e">secp256k1_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *</td>          <td class="paramname"><span class="paramname"><em>seckey</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *</td>          <td class="paramname"><span class="paramname"><em>privkey</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>privkeylen</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Import a private key in DER format. Returns: 1 if a private key was extracted. Args: ctx: pointer to a context object (cannot be NULL). Out: seckey: pointer to a 32-byte array for storing the private key. (cannot be NULL). In: privkey: pointer to a private key in DER format (cannot be NULL). privkeylen: length of the DER private key pointed to be privkey.</p>
<p>This function will accept more than just strict DER, and even allow some BER violations. The public key stored inside the DER-encoded private key is not verified for correctness, nor are the curve parameters. Use this function only if you know in advance it is supposed to contain a secp256k1 private key. </p>

<p class="definition">Definition at line <a class="el" href="lax__der__privatekey__parsing_8c_source.html#l00011">11</a> of file <a class="el" href="lax__der__privatekey__parsing_8c_source.html">lax_der_privatekey_parsing.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   11</span>                                                                                                                               {</div>
<div class="line"><span class="lineno">   12</span>    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *end = privkey + privkeylen;</div>
<div class="line"><span class="lineno">   13</span>    <span class="keywordtype">int</span> lenb = 0;</div>
<div class="line"><span class="lineno">   14</span>    <span class="keywordtype">int</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> = 0;</div>
<div class="line"><span class="lineno">   15</span>    <a class="code hl_function" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105">memset</a>(out32, 0, 32);</div>
<div class="line"><span class="lineno">   16</span>    <span class="comment">/* sequence header */</span></div>
<div class="line"><span class="lineno">   17</span>    <span class="keywordflow">if</span> (end &lt; privkey+1 || *privkey != 0x30) {</div>
<div class="line"><span class="lineno">   18</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">   19</span>    }</div>
<div class="line"><span class="lineno">   20</span>    privkey++;</div>
<div class="line"><span class="lineno">   21</span>    <span class="comment">/* sequence length constructor */</span></div>
<div class="line"><span class="lineno">   22</span>    <span class="keywordflow">if</span> (end &lt; privkey+1 || !(*privkey &amp; 0x80)) {</div>
<div class="line"><span class="lineno">   23</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">   24</span>    }</div>
<div class="line"><span class="lineno">   25</span>    lenb = *privkey &amp; ~0x80; privkey++;</div>
<div class="line"><span class="lineno">   26</span>    <span class="keywordflow">if</span> (lenb &lt; 1 || lenb &gt; 2) {</div>
<div class="line"><span class="lineno">   27</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">   28</span>    }</div>
<div class="line"><span class="lineno">   29</span>    <span class="keywordflow">if</span> (end &lt; privkey+lenb) {</div>
<div class="line"><span class="lineno">   30</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">   31</span>    }</div>
<div class="line"><span class="lineno">   32</span>    <span class="comment">/* sequence length */</span></div>
<div class="line"><span class="lineno">   33</span>    <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> = privkey[lenb-1] | (lenb &gt; 1 ? privkey[lenb-2] &lt;&lt; 8 : 0);</div>
<div class="line"><span class="lineno">   34</span>    privkey += lenb;</div>
<div class="line"><span class="lineno">   35</span>    <span class="keywordflow">if</span> (end &lt; privkey+<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>) {</div>
<div class="line"><span class="lineno">   36</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">   37</span>    }</div>
<div class="line"><span class="lineno">   38</span>    <span class="comment">/* sequence element 0: version number (=1) */</span></div>
<div class="line"><span class="lineno">   39</span>    <span class="keywordflow">if</span> (end &lt; privkey+3 || privkey[0] != 0x02 || privkey[1] != 0x01 || privkey[2] != 0x01) {</div>
<div class="line"><span class="lineno">   40</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">   41</span>    }</div>
<div class="line"><span class="lineno">   42</span>    privkey += 3;</div>
<div class="line"><span class="lineno">   43</span>    <span class="comment">/* sequence element 1: octet string, up to 32 bytes */</span></div>
<div class="line"><span class="lineno">   44</span>    <span class="keywordflow">if</span> (end &lt; privkey+2 || privkey[0] != 0x04 || privkey[1] &gt; 0x20 || end &lt; privkey+2+privkey[1]) {</div>
<div class="line"><span class="lineno">   45</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">   46</span>    }</div>
<div class="line"><span class="lineno">   47</span>    <span class="keywordflow">if</span> (privkey[1]) <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(out32 + 32 - privkey[1], privkey + 2, privkey[1]);</div>
<div class="line"><span class="lineno">   48</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="secp256k1_8h.html#a366f922fc0c787351e82ff8e3a95f652">secp256k1_ec_seckey_verify</a>(ctx, out32)) {</div>
<div class="line"><span class="lineno">   49</span>        <a class="code hl_function" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105">memset</a>(out32, 0, 32);</div>
<div class="line"><span class="lineno">   50</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">   51</span>    }</div>
<div class="line"><span class="lineno">   52</span>    <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">   53</span>}</div>
<div class="ttc" id="asecp256k1_8h_html_a366f922fc0c787351e82ff8e3a95f652"><div class="ttname"><a href="secp256k1_8h.html#a366f922fc0c787351e82ff8e3a95f652">secp256k1_ec_seckey_verify</a></div><div class="ttdeci">SECP256K1_API SECP256K1_WARN_UNUSED_RESULT int secp256k1_ec_seckey_verify(const secp256k1_context *ctx, const unsigned char *seckey) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2)</div><div class="ttdef"><b>Definition</b> <a href="secp256k1_8c_source.html#l00528">secp256k1.c:528</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a7360b55975153b822efc5217b7734e6a"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a></div><div class="ttdeci">size_t len</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l04771">yubihsm_pkcs11.c:4771</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_adc4bd59a60361844aa0e852efa210105"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105">memset</a></div><div class="ttdeci">memset(pInfo-&gt;slotDescription, ' ', 64)</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="lax__der__privatekey__parsing_8c_ab807c294559193bc65b53f14ca677db6_cgraph.png" border="0" usemap="#alax__der__privatekey__parsing_8c_ab807c294559193bc65b53f14ca677db6_cgraph" alt=""/></div>
<map name="alax__der__privatekey__parsing_8c_ab807c294559193bc65b53f14ca677db6_cgraph" id="alax__der__privatekey__parsing_8c_ab807c294559193bc65b53f14ca677db6_cgraph">
<area shape="rect" title=" " alt="" coords="5,55,158,80"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="247,5,318,31"/>
<area shape="poly" title=" " alt="" coords="136,51,231,28,233,33,138,57"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="249,55,317,80"/>
<area shape="poly" title=" " alt="" coords="158,65,234,65,234,70,158,70"/>
<area shape="rect" href="secp256k1_8c.html#a6015346bdaee22c65e5ebca71693d9b1" title=" " alt="" coords="206,104,360,145"/>
<area shape="poly" title=" " alt="" coords="130,78,195,97,194,102,129,84"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="lax__der__privatekey__parsing_8c_ab807c294559193bc65b53f14ca677db6_icgraph.png" border="0" usemap="#alax__der__privatekey__parsing_8c_ab807c294559193bc65b53f14ca677db6_icgraph" alt=""/></div>
<map name="alax__der__privatekey__parsing_8c_ab807c294559193bc65b53f14ca677db6_icgraph" id="alax__der__privatekey__parsing_8c_ab807c294559193bc65b53f14ca677db6_icgraph">
<area shape="rect" title=" " alt="" coords="513,5,666,31"/>
<area shape="rect" href="tests_8c.html#a3fc9dc1908215215a68690ea1bfa8bcd" title=" " alt="" coords="306,5,465,31"/>
<area shape="poly" title=" " alt="" coords="497,21,466,21,466,16,497,16"/>
<area shape="rect" href="tests_8c.html#ab05096657be701bf9ca8616475bb9491" title=" " alt="" coords="103,5,258,31"/>
<area shape="poly" title=" " alt="" coords="290,21,258,21,258,16,290,16"/>
<area shape="rect" href="tests_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title=" " alt="" coords="5,5,55,31"/>
<area shape="poly" title=" " alt="" coords="87,21,55,21,55,16,87,16"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_428556e0652617aa37d2f7d8bcaf7fdf.html">libraries</a></li><li class="navelem"><a class="el" href="dir_71436f1774b2d89f0b80ac9efd482f1f.html">fc</a></li><li class="navelem"><a class="el" href="dir_a52e6239a5b2b3d02315cec608665301.html">secp256k1</a></li><li class="navelem"><a class="el" href="dir_d7bc7c582256a3e7079a332367360a08.html">secp256k1</a></li><li class="navelem"><a class="el" href="dir_11ca7e72e2f20d069730486fa371ed0c.html">contrib</a></li><li class="navelem"><a class="el" href="lax__der__privatekey__parsing_8c.html">lax_der_privatekey_parsing.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0 </li>
  </ul>
</div>
</body>
</html>
