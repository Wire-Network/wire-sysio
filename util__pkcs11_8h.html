<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Wire Sysio: libraries/yubihsm/pkcs11/util_pkcs11.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Wire Sysio<span id="projectnumber">&#160;Wire Sysion 1.0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('util__pkcs11_8h.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">util_pkcs11.h File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;<a class="el" href="yubihsm_8h_source.html">yubihsm.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="pkcs11y_8h_source.html">pkcs11y.h</a>&gt;</code><br />
<code>#include &quot;<a class="el" href="yubihsm__pkcs11_8h_source.html">yubihsm_pkcs11.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for util_pkcs11.h:</div>
<div class="dyncontent">
<div class="center"><img src="util__pkcs11_8h__incl.png" border="0" usemap="#alibraries_2yubihsm_2pkcs11_2util__pkcs11_8h" alt=""/></div>
<map name="alibraries_2yubihsm_2pkcs11_2util__pkcs11_8h" id="alibraries_2yubihsm_2pkcs11_2util__pkcs11_8h">
<area shape="rect" title=" " alt="" coords="169,5,334,46"/>
<area shape="rect" href="yubihsm_8h.html" title=" " alt="" coords="126,241,207,267"/>
<area shape="poly" title=" " alt="" coords="247,48,179,228,174,226,242,46"/>
<area shape="rect" href="pkcs11y_8h.html" title=" " alt="" coords="221,168,301,193"/>
<area shape="poly" title=" " alt="" coords="256,46,262,152,257,152,250,46"/>
<area shape="rect" href="yubihsm__pkcs11_8h.html" title=" " alt="" coords="289,94,420,120"/>
<area shape="poly" title=" " alt="" coords="279,44,328,82,325,86,275,49"/>
<area shape="rect" href="stdint_8h.html" title=" " alt="" coords="49,315,113,341"/>
<area shape="poly" title=" " alt="" coords="154,270,108,307,105,303,150,265"/>
<area shape="rect" title=" " alt="" coords="316,315,390,341"/>
<area shape="poly" title=" " alt="" coords="199,265,308,306,306,311,197,270"/>
<area shape="rect" title=" " alt="" coords="223,315,291,341"/>
<area shape="poly" title=" " alt="" coords="183,265,232,303,228,308,180,270"/>
<area shape="rect" title=" " alt="" coords="138,315,198,341"/>
<area shape="poly" title=" " alt="" coords="169,267,170,299,164,299,164,267"/>
<area shape="rect" title=" " alt="" coords="5,389,69,414"/>
<area shape="poly" title=" " alt="" coords="76,342,55,377,50,374,71,339"/>
<area shape="rect" title=" " alt="" coords="93,389,160,414"/>
<area shape="poly" title=" " alt="" coords="91,339,113,374,108,377,86,342"/>
<area shape="poly" title=" " alt="" coords="247,196,196,234,193,230,243,192"/>
<area shape="rect" href="pkcs11_8h.html" title=" " alt="" coords="230,241,305,267"/>
<area shape="poly" title=" " alt="" coords="265,193,268,226,262,226,259,194"/>
<area shape="poly" title=" " alt="" coords="269,268,264,300,258,299,263,267"/>
<area shape="poly" title=" " alt="" coords="340,122,290,160,287,156,337,118"/>
<area shape="rect" href="list_8h.html" title=" " alt="" coords="328,241,378,267"/>
<area shape="poly" title=" " alt="" coords="357,120,356,226,351,226,352,120"/>
<area shape="rect" title=" " alt="" coords="382,168,484,193"/>
<area shape="poly" title=" " alt="" coords="369,118,410,155,407,159,366,122"/>
<area shape="rect" title=" " alt="" coords="508,168,590,193"/>
<area shape="poly" title=" " alt="" coords="388,118,502,159,501,164,386,123"/>
<area shape="poly" title=" " alt="" coords="356,267,356,299,350,299,350,267"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="util__pkcs11_8h__dep__incl.png" border="0" usemap="#alibraries_2yubihsm_2pkcs11_2util__pkcs11_8hdep" alt=""/></div>
<map name="alibraries_2yubihsm_2pkcs11_2util__pkcs11_8hdep" id="alibraries_2yubihsm_2pkcs11_2util__pkcs11_8hdep">
<area shape="rect" title=" " alt="" coords="100,5,265,46"/>
<area shape="rect" href="util__pkcs11_8c.html" title=" " alt="" coords="5,94,171,135"/>
<area shape="poly" title=" " alt="" coords="152,59,111,96,108,92,148,55"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html" title=" " alt="" coords="195,94,360,135"/>
<area shape="poly" title=" " alt="" coords="217,55,258,92,254,96,214,59"/>
</map>
</div>
</div>
<p><a href="util__pkcs11_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a064731f36eb972f687b4059dc5f340db" id="r_a064731f36eb972f687b4059dc5f340db"><td class="memItemLeft" align="right" valign="top">CK_RV&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a064731f36eb972f687b4059dc5f340db">get_mechanism_list</a> (<a class="el" href="structyubihsm__pkcs11__slot.html">yubihsm_pkcs11_slot</a> *<a class="el" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>, <a class="el" href="pkcs11_8h.html#a29744979fe73c2061a1d39987f063679">CK_MECHANISM_TYPE_PTR</a> <a class="el" href="yubihsm__pkcs11_8c.html#a837cbbce04f92271824debc2c15b6ab6">pMechanismList</a>, <a class="el" href="pkcs11_8h.html#a2c6426aaa1ca6dd1f48a01b8490482fa">CK_ULONG_PTR</a> <a class="el" href="gmock__stress__test_8cc.html#afd9db40e3361ae09188795e8cbe19752">count</a>)</td></tr>
<tr class="separator:a064731f36eb972f687b4059dc5f340db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95f1c61424aa67f782a360e59c6cee84" id="r_a95f1c61424aa67f782a360e59c6cee84"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a95f1c61424aa67f782a360e59c6cee84">get_mechanism_info</a> (<a class="el" href="structyubihsm__pkcs11__slot.html">yubihsm_pkcs11_slot</a> *<a class="el" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>, CK_MECHANISM_TYPE type, <a class="el" href="pkcs11_8h.html#a19a155cbd39a0b5099741d385f1db7b9">CK_MECHANISM_INFO_PTR</a> <a class="el" href="yubihsm__pkcs11_8c.html#a05dd610acfc36d8ca4581d4d22ae1521">pInfo</a>)</td></tr>
<tr class="separator:a95f1c61424aa67f782a360e59c6cee84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4680d9c4ecced6ef98ac202480bd53fd" id="r_a4680d9c4ecced6ef98ac202480bd53fd"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4680d9c4ecced6ef98ac202480bd53fd">parse_hex</a> (<a class="el" href="pkcs11_8h.html#aee7068a12537d85d824edb4249e7ca4e">CK_UTF8CHAR_PTR</a> hex, <a class="el" href="pkcs11_8h.html#a35181858a3b7a0a81f49d180d8f446ef">CK_ULONG</a> hex_len, <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *parsed)</td></tr>
<tr class="separator:a4680d9c4ecced6ef98ac202480bd53fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac838a6fe508a988db853effa16513d28" id="r_ac838a6fe508a988db853effa16513d28"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac838a6fe508a988db853effa16513d28">destroy_session</a> (<a class="el" href="structyubihsm__pkcs11__context.html">yubihsm_pkcs11_context</a> *ctx, CK_SESSION_HANDLE <a class="el" href="yubihsm__pkcs11_8c.html#a1907ffdf44b24385d6e575396ea79806">hSession</a>)</td></tr>
<tr class="separator:ac838a6fe508a988db853effa16513d28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc3b093830e7126a8655e9b8ec77ad10" id="r_acc3b093830e7126a8655e9b8ec77ad10"><td class="memItemLeft" align="right" valign="top">CK_RV&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acc3b093830e7126a8655e9b8ec77ad10">get_attribute</a> (CK_ATTRIBUTE_TYPE type, <a class="el" href="structyh__object__descriptor.html">yh_object_descriptor</a> *<a class="el" href="yubihsm__pkcs11_8c.html#a85d991d90970121ba1480cd98d93aab9">object</a>, <a class="el" href="pkcs11_8h.html#a88e8d2cf99e26f3b3f86a0a698b0ab64">CK_VOID_PTR</a> <a class="el" href="pkcs11_8h.html#a32aff7c6c4cd253fdf6563677afab5ce">value</a>, <a class="el" href="pkcs11_8h.html#a2c6426aaa1ca6dd1f48a01b8490482fa">CK_ULONG_PTR</a> length, <a class="el" href="structyh__session.html">yh_session</a> *<a class="el" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>)</td></tr>
<tr class="separator:acc3b093830e7126a8655e9b8ec77ad10"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c8c35826a58c280a290c49a5a1e5b03" id="r_a5c8c35826a58c280a290c49a5a1e5b03"><td class="memItemLeft" align="right" valign="top">CK_RV&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5c8c35826a58c280a290c49a5a1e5b03">get_attribute_ecsession_key</a> (CK_ATTRIBUTE_TYPE type, <a class="el" href="structecdh__session__key.html">ecdh_session_key</a> *key, <a class="el" href="pkcs11_8h.html#a88e8d2cf99e26f3b3f86a0a698b0ab64">CK_VOID_PTR</a> <a class="el" href="pkcs11_8h.html#a32aff7c6c4cd253fdf6563677afab5ce">value</a>, <a class="el" href="pkcs11_8h.html#a2c6426aaa1ca6dd1f48a01b8490482fa">CK_ULONG_PTR</a> length)</td></tr>
<tr class="separator:a5c8c35826a58c280a290c49a5a1e5b03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8da590df25987cc479405a69d10b134c" id="r_a8da590df25987cc479405a69d10b134c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structyubihsm__pkcs11__object__desc.html">yubihsm_pkcs11_object_desc</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8da590df25987cc479405a69d10b134c">get_object_desc</a> (<a class="el" href="structyh__session.html">yh_session</a> *<a class="el" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, <a class="el" href="structyubihsm__pkcs11__object__desc.html">yubihsm_pkcs11_object_desc</a> *objects, CK_OBJECT_HANDLE objectHandle)</td></tr>
<tr class="separator:a8da590df25987cc479405a69d10b134c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abbef2f6ae8466dee723f94497bdea3bf" id="r_abbef2f6ae8466dee723f94497bdea3bf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abbef2f6ae8466dee723f94497bdea3bf">delete_object_from_cache</a> (<a class="el" href="structyubihsm__pkcs11__object__desc.html">yubihsm_pkcs11_object_desc</a> *objects, CK_OBJECT_HANDLE objHandle)</td></tr>
<tr class="separator:abbef2f6ae8466dee723f94497bdea3bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8ed437178cb69b0fed6916747368344" id="r_ae8ed437178cb69b0fed6916747368344"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae8ed437178cb69b0fed6916747368344">check_sign_mechanism</a> (<a class="el" href="structyubihsm__pkcs11__slot.html">yubihsm_pkcs11_slot</a> *<a class="el" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>, <a class="el" href="pkcs11_8h.html#ab943ac89d1b0f6f3631d3361da0d52a1">CK_MECHANISM_PTR</a> <a class="el" href="yubihsm__pkcs11_8c.html#ab0dca4e7a2bfa74ab9cae5b8c1995647">pMechanism</a>)</td></tr>
<tr class="separator:ae8ed437178cb69b0fed6916747368344"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace7396cb0c7b79d711f41031943387aa" id="r_ace7396cb0c7b79d711f41031943387aa"><td class="memItemLeft" align="right" valign="top">CK_RV&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ace7396cb0c7b79d711f41031943387aa">apply_sign_mechanism_init</a> (<a class="el" href="structyubihsm__pkcs11__op__info.html">yubihsm_pkcs11_op_info</a> *op_info)</td></tr>
<tr class="separator:ace7396cb0c7b79d711f41031943387aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f8862404103da790412c45be35b0087" id="r_a7f8862404103da790412c45be35b0087"><td class="memItemLeft" align="right" valign="top">CK_RV&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7f8862404103da790412c45be35b0087">apply_sign_mechanism_update</a> (<a class="el" href="structyubihsm__pkcs11__op__info.html">yubihsm_pkcs11_op_info</a> *op_info, <a class="el" href="pkcs11_8h.html#a7bc6919a7c3c372056fa7e18343a0b37">CK_BYTE_PTR</a> in, <a class="el" href="pkcs11_8h.html#a35181858a3b7a0a81f49d180d8f446ef">CK_ULONG</a> <a class="el" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a>)</td></tr>
<tr class="separator:a7f8862404103da790412c45be35b0087"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a785bd4bd444e619e6e5e12b2e392f086" id="r_a785bd4bd444e619e6e5e12b2e392f086"><td class="memItemLeft" align="right" valign="top">CK_RV&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a785bd4bd444e619e6e5e12b2e392f086">apply_sign_mechanism_finalize</a> (<a class="el" href="structyubihsm__pkcs11__op__info.html">yubihsm_pkcs11_op_info</a> *op_info)</td></tr>
<tr class="separator:a785bd4bd444e619e6e5e12b2e392f086"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a547f9032e3bcd7d6a5a810e94822e337" id="r_a547f9032e3bcd7d6a5a810e94822e337"><td class="memItemLeft" align="right" valign="top">CK_RV&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a547f9032e3bcd7d6a5a810e94822e337">perform_signature</a> (<a class="el" href="structyh__session.html">yh_session</a> *<a class="el" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, <a class="el" href="structyubihsm__pkcs11__op__info.html">yubihsm_pkcs11_op_info</a> *op_info, <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *signature, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *signature_len)</td></tr>
<tr class="separator:a547f9032e3bcd7d6a5a810e94822e337"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6959529c0513c47315e393d4e4827619" id="r_a6959529c0513c47315e393d4e4827619"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6959529c0513c47315e393d4e4827619">sign_mechanism_cleanup</a> (<a class="el" href="structyubihsm__pkcs11__op__info.html">yubihsm_pkcs11_op_info</a> *op_info)</td></tr>
<tr class="separator:a6959529c0513c47315e393d4e4827619"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87b96fbdfd225d8124f0a6f6d6538292" id="r_a87b96fbdfd225d8124f0a6f6d6538292"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a87b96fbdfd225d8124f0a6f6d6538292">check_verify_mechanism</a> (<a class="el" href="structyubihsm__pkcs11__slot.html">yubihsm_pkcs11_slot</a> *<a class="el" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>, <a class="el" href="pkcs11_8h.html#ab943ac89d1b0f6f3631d3361da0d52a1">CK_MECHANISM_PTR</a> <a class="el" href="yubihsm__pkcs11_8c.html#ab0dca4e7a2bfa74ab9cae5b8c1995647">pMechanism</a>)</td></tr>
<tr class="separator:a87b96fbdfd225d8124f0a6f6d6538292"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e8c2b6402f7944b9684ad16a8ab7f66" id="r_a2e8c2b6402f7944b9684ad16a8ab7f66"><td class="memItemLeft" align="right" valign="top">CK_RV&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2e8c2b6402f7944b9684ad16a8ab7f66">apply_verify_mechanism_init</a> (<a class="el" href="structyubihsm__pkcs11__op__info.html">yubihsm_pkcs11_op_info</a> *op_info)</td></tr>
<tr class="separator:a2e8c2b6402f7944b9684ad16a8ab7f66"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4fbb6f5ecdd69ce7a332f613a89a9a7" id="r_ad4fbb6f5ecdd69ce7a332f613a89a9a7"><td class="memItemLeft" align="right" valign="top">CK_RV&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad4fbb6f5ecdd69ce7a332f613a89a9a7">apply_verify_mechanism_update</a> (<a class="el" href="structyubihsm__pkcs11__op__info.html">yubihsm_pkcs11_op_info</a> *op_info, <a class="el" href="pkcs11_8h.html#a7bc6919a7c3c372056fa7e18343a0b37">CK_BYTE_PTR</a> in, <a class="el" href="pkcs11_8h.html#a35181858a3b7a0a81f49d180d8f446ef">CK_ULONG</a> <a class="el" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a>)</td></tr>
<tr class="separator:ad4fbb6f5ecdd69ce7a332f613a89a9a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a551420defe2efb18caf9ce9239e630" id="r_a8a551420defe2efb18caf9ce9239e630"><td class="memItemLeft" align="right" valign="top">CK_RV&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8a551420defe2efb18caf9ce9239e630">apply_verify_mechanism_finalize</a> (<a class="el" href="structyubihsm__pkcs11__op__info.html">yubihsm_pkcs11_op_info</a> *op_info)</td></tr>
<tr class="separator:a8a551420defe2efb18caf9ce9239e630"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab17f6ba85432d715def5185e7832c9e8" id="r_ab17f6ba85432d715def5185e7832c9e8"><td class="memItemLeft" align="right" valign="top">CK_RV&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab17f6ba85432d715def5185e7832c9e8">perform_verify</a> (<a class="el" href="structyh__session.html">yh_session</a> *<a class="el" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, <a class="el" href="structyubihsm__pkcs11__op__info.html">yubihsm_pkcs11_op_info</a> *op_info, <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *signature, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> signature_len)</td></tr>
<tr class="separator:ab17f6ba85432d715def5185e7832c9e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16a62896091be5cd8b7537d7f01d3f21" id="r_a16a62896091be5cd8b7537d7f01d3f21"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a16a62896091be5cd8b7537d7f01d3f21">verify_mechanism_cleanup</a> (<a class="el" href="structyubihsm__pkcs11__op__info.html">yubihsm_pkcs11_op_info</a> *op_info)</td></tr>
<tr class="separator:a16a62896091be5cd8b7537d7f01d3f21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ce40fa3ee245e65d99ee4cec7a1dd0c" id="r_a5ce40fa3ee245e65d99ee4cec7a1dd0c"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5ce40fa3ee245e65d99ee4cec7a1dd0c">check_decrypt_mechanism</a> (<a class="el" href="structyubihsm__pkcs11__slot.html">yubihsm_pkcs11_slot</a> *<a class="el" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>, <a class="el" href="pkcs11_8h.html#ab943ac89d1b0f6f3631d3361da0d52a1">CK_MECHANISM_PTR</a> <a class="el" href="yubihsm__pkcs11_8c.html#ab0dca4e7a2bfa74ab9cae5b8c1995647">pMechanism</a>)</td></tr>
<tr class="separator:a5ce40fa3ee245e65d99ee4cec7a1dd0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a915e620459f4f98eca94bff5913cfac5" id="r_a915e620459f4f98eca94bff5913cfac5"><td class="memItemLeft" align="right" valign="top">CK_RV&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a915e620459f4f98eca94bff5913cfac5">apply_decrypt_mechanism_init</a> (<a class="el" href="structyubihsm__pkcs11__op__info.html">yubihsm_pkcs11_op_info</a> *op_info)</td></tr>
<tr class="separator:a915e620459f4f98eca94bff5913cfac5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7fe9865366124c43dfbc7db9e710384d" id="r_a7fe9865366124c43dfbc7db9e710384d"><td class="memItemLeft" align="right" valign="top">CK_RV&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7fe9865366124c43dfbc7db9e710384d">apply_decrypt_mechanism_update</a> (<a class="el" href="structyubihsm__pkcs11__op__info.html">yubihsm_pkcs11_op_info</a> *op_info, <a class="el" href="pkcs11_8h.html#a7bc6919a7c3c372056fa7e18343a0b37">CK_BYTE_PTR</a> in, <a class="el" href="pkcs11_8h.html#a35181858a3b7a0a81f49d180d8f446ef">CK_ULONG</a> <a class="el" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a>)</td></tr>
<tr class="separator:a7fe9865366124c43dfbc7db9e710384d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ed97e6943e5263fd3695145cc59b3ad" id="r_a9ed97e6943e5263fd3695145cc59b3ad"><td class="memItemLeft" align="right" valign="top">CK_RV&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9ed97e6943e5263fd3695145cc59b3ad">apply_decrypt_mechanism_finalize</a> (<a class="el" href="structyubihsm__pkcs11__op__info.html">yubihsm_pkcs11_op_info</a> *op_info)</td></tr>
<tr class="separator:a9ed97e6943e5263fd3695145cc59b3ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1cc0fad44d221fb1f13c2bb30935ff49" id="r_a1cc0fad44d221fb1f13c2bb30935ff49"><td class="memItemLeft" align="right" valign="top">CK_RV&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1cc0fad44d221fb1f13c2bb30935ff49">perform_encrypt</a> (<a class="el" href="structyh__session.html">yh_session</a> *<a class="el" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, <a class="el" href="structyubihsm__pkcs11__op__info.html">yubihsm_pkcs11_op_info</a> *op_info, <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *plaintext, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *plaintext_len)</td></tr>
<tr class="separator:a1cc0fad44d221fb1f13c2bb30935ff49"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16357f17413edbce1da86168fb464074" id="r_a16357f17413edbce1da86168fb464074"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a16357f17413edbce1da86168fb464074">decrypt_mechanism_cleanup</a> (<a class="el" href="structyubihsm__pkcs11__op__info.html">yubihsm_pkcs11_op_info</a> *op_info)</td></tr>
<tr class="separator:a16357f17413edbce1da86168fb464074"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a99061c5c316d6427b27f8d506338bf" id="r_a1a99061c5c316d6427b27f8d506338bf"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1a99061c5c316d6427b27f8d506338bf">check_encrypt_mechanism</a> (<a class="el" href="structyubihsm__pkcs11__slot.html">yubihsm_pkcs11_slot</a> *<a class="el" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>, <a class="el" href="pkcs11_8h.html#ab943ac89d1b0f6f3631d3361da0d52a1">CK_MECHANISM_PTR</a> <a class="el" href="yubihsm__pkcs11_8c.html#ab0dca4e7a2bfa74ab9cae5b8c1995647">pMechanism</a>)</td></tr>
<tr class="separator:a1a99061c5c316d6427b27f8d506338bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5aa664d8466537659db8d185d8e5683c" id="r_a5aa664d8466537659db8d185d8e5683c"><td class="memItemLeft" align="right" valign="top">CK_RV&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5aa664d8466537659db8d185d8e5683c">apply_encrypt_mechanism_update</a> (<a class="el" href="structyubihsm__pkcs11__op__info.html">yubihsm_pkcs11_op_info</a> *op_info, <a class="el" href="pkcs11_8h.html#a7bc6919a7c3c372056fa7e18343a0b37">CK_BYTE_PTR</a> in, <a class="el" href="pkcs11_8h.html#a35181858a3b7a0a81f49d180d8f446ef">CK_ULONG</a> <a class="el" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a>)</td></tr>
<tr class="separator:a5aa664d8466537659db8d185d8e5683c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a4b5890a6a8d01800fdb68e1935ae05" id="r_a9a4b5890a6a8d01800fdb68e1935ae05"><td class="memItemLeft" align="right" valign="top">CK_RV&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9a4b5890a6a8d01800fdb68e1935ae05">perform_decrypt</a> (<a class="el" href="structyh__session.html">yh_session</a> *<a class="el" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, <a class="el" href="structyubihsm__pkcs11__op__info.html">yubihsm_pkcs11_op_info</a> *op_info, <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *ciphertext, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *ciphertext_len)</td></tr>
<tr class="separator:a9a4b5890a6a8d01800fdb68e1935ae05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61664b3bfbd62e9ac2da4ed66be23dbc" id="r_a61664b3bfbd62e9ac2da4ed66be23dbc"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a61664b3bfbd62e9ac2da4ed66be23dbc">check_digest_mechanism</a> (<a class="el" href="pkcs11_8h.html#ab943ac89d1b0f6f3631d3361da0d52a1">CK_MECHANISM_PTR</a> <a class="el" href="yubihsm__pkcs11_8c.html#ab0dca4e7a2bfa74ab9cae5b8c1995647">pMechanism</a>)</td></tr>
<tr class="separator:a61664b3bfbd62e9ac2da4ed66be23dbc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50a795ac4e657d1813394e49cd4650d0" id="r_a50a795ac4e657d1813394e49cd4650d0"><td class="memItemLeft" align="right" valign="top">CK_RV&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a50a795ac4e657d1813394e49cd4650d0">apply_digest_mechanism_init</a> (<a class="el" href="structyubihsm__pkcs11__op__info.html">yubihsm_pkcs11_op_info</a> *op_info)</td></tr>
<tr class="separator:a50a795ac4e657d1813394e49cd4650d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86347633f97ab81b8e9b49e4bd754d3f" id="r_a86347633f97ab81b8e9b49e4bd754d3f"><td class="memItemLeft" align="right" valign="top">CK_RV&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a86347633f97ab81b8e9b49e4bd754d3f">apply_digest_mechanism_update</a> (<a class="el" href="structyubihsm__pkcs11__op__info.html">yubihsm_pkcs11_op_info</a> *op_info, <a class="el" href="pkcs11_8h.html#a7bc6919a7c3c372056fa7e18343a0b37">CK_BYTE_PTR</a> in, <a class="el" href="pkcs11_8h.html#a35181858a3b7a0a81f49d180d8f446ef">CK_ULONG</a> <a class="el" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a>)</td></tr>
<tr class="separator:a86347633f97ab81b8e9b49e4bd754d3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a926a181770971fd05600d16f93acd39e" id="r_a926a181770971fd05600d16f93acd39e"><td class="memItemLeft" align="right" valign="top">CK_RV&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a926a181770971fd05600d16f93acd39e">apply_digest_mechanism_finalize</a> (<a class="el" href="structyubihsm__pkcs11__op__info.html">yubihsm_pkcs11_op_info</a> *op_info)</td></tr>
<tr class="separator:a926a181770971fd05600d16f93acd39e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a302f2929b31dff615158d284b2f56e79" id="r_a302f2929b31dff615158d284b2f56e79"><td class="memItemLeft" align="right" valign="top">CK_RV&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a302f2929b31dff615158d284b2f56e79">perform_digest</a> (<a class="el" href="structyubihsm__pkcs11__op__info.html">yubihsm_pkcs11_op_info</a> *op_info, <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *digest, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *<a class="el" href="yubihsm__pkcs11_8c.html#aa7984cb33ffce49c6276aa9cd928a5a6">digest_len</a>)</td></tr>
<tr class="separator:a302f2929b31dff615158d284b2f56e79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf9d727a7620788445bc9ce264046b05" id="r_acf9d727a7620788445bc9ce264046b05"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acf9d727a7620788445bc9ce264046b05">digest_mechanism_cleanup</a> (<a class="el" href="structyubihsm__pkcs11__op__info.html">yubihsm_pkcs11_op_info</a> *op_info)</td></tr>
<tr class="separator:acf9d727a7620788445bc9ce264046b05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9a2fa09ddebb577ec5a919ad3a26d5d" id="r_ac9a2fa09ddebb577ec5a919ad3a26d5d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pkcs11_8h.html#a35181858a3b7a0a81f49d180d8f446ef">CK_ULONG</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac9a2fa09ddebb577ec5a919ad3a26d5d">get_digest_bytelength</a> (CK_MECHANISM_TYPE m)</td></tr>
<tr class="separator:ac9a2fa09ddebb577ec5a919ad3a26d5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83e06a2ae90589d9fad186cad9ed5ede" id="r_a83e06a2ae90589d9fad186cad9ed5ede"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a83e06a2ae90589d9fad186cad9ed5ede">check_wrap_mechanism</a> (<a class="el" href="structyubihsm__pkcs11__slot.html">yubihsm_pkcs11_slot</a> *<a class="el" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>, <a class="el" href="pkcs11_8h.html#ab943ac89d1b0f6f3631d3361da0d52a1">CK_MECHANISM_PTR</a> <a class="el" href="yubihsm__pkcs11_8c.html#ab0dca4e7a2bfa74ab9cae5b8c1995647">pMechanism</a>)</td></tr>
<tr class="separator:a83e06a2ae90589d9fad186cad9ed5ede"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c0da3eb6986b1e9466392de8eb4b9f5" id="r_a7c0da3eb6986b1e9466392de8eb4b9f5"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7c0da3eb6986b1e9466392de8eb4b9f5">is_RSA_sign_mechanism</a> (CK_MECHANISM_TYPE m)</td></tr>
<tr class="separator:a7c0da3eb6986b1e9466392de8eb4b9f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a3a4cd4d71d1a0489be171682cb9ece" id="r_a8a3a4cd4d71d1a0489be171682cb9ece"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8a3a4cd4d71d1a0489be171682cb9ece">is_RSA_decrypt_mechanism</a> (CK_MECHANISM_TYPE m)</td></tr>
<tr class="separator:a8a3a4cd4d71d1a0489be171682cb9ece"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f1010425d5308dfa15d696b4853c68c" id="r_a3f1010425d5308dfa15d696b4853c68c"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3f1010425d5308dfa15d696b4853c68c">is_hashed_mechanism</a> (CK_MECHANISM_TYPE m)</td></tr>
<tr class="separator:a3f1010425d5308dfa15d696b4853c68c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0040a19f3ec5afc2b8717e10860d55bc" id="r_a0040a19f3ec5afc2b8717e10860d55bc"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0040a19f3ec5afc2b8717e10860d55bc">is_PKCS1v1_5_sign_mechanism</a> (CK_MECHANISM_TYPE m)</td></tr>
<tr class="separator:a0040a19f3ec5afc2b8717e10860d55bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03746a942ba1eaafbec20b675463ee00" id="r_a03746a942ba1eaafbec20b675463ee00"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a03746a942ba1eaafbec20b675463ee00">is_ECDSA_sign_mechanism</a> (CK_MECHANISM_TYPE m)</td></tr>
<tr class="separator:a03746a942ba1eaafbec20b675463ee00"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34722aea70286e920362e216c048f629" id="r_a34722aea70286e920362e216c048f629"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a34722aea70286e920362e216c048f629">is_PSS_sign_mechanism</a> (CK_MECHANISM_TYPE m)</td></tr>
<tr class="separator:a34722aea70286e920362e216c048f629"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3da5875af7a71b11ee5ead6b160d1ff4" id="r_a3da5875af7a71b11ee5ead6b160d1ff4"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3da5875af7a71b11ee5ead6b160d1ff4">is_HMAC_sign_mechanism</a> (CK_MECHANISM_TYPE m)</td></tr>
<tr class="separator:a3da5875af7a71b11ee5ead6b160d1ff4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f93d30a54aef41540b4c31d8b2be064" id="r_a7f93d30a54aef41540b4c31d8b2be064"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7f93d30a54aef41540b4c31d8b2be064">set_native_locking</a> (<a class="el" href="structyubihsm__pkcs11__context.html">yubihsm_pkcs11_context</a> *ctx)</td></tr>
<tr class="separator:a7f93d30a54aef41540b4c31d8b2be064"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a101ef72541fc11b032da224f8735117a" id="r_a101ef72541fc11b032da224f8735117a"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a101ef72541fc11b032da224f8735117a">add_connectors</a> (<a class="el" href="structyubihsm__pkcs11__context.html">yubihsm_pkcs11_context</a> *ctx, int n_connectors, char **connector_names, <a class="el" href="structyh__connector.html">yh_connector</a> **connectors)</td></tr>
<tr class="separator:a101ef72541fc11b032da224f8735117a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85ea84ffb047281f34a733572f67b254" id="r_a85ea84ffb047281f34a733572f67b254"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a85ea84ffb047281f34a733572f67b254">delete_session</a> (<a class="el" href="structyubihsm__pkcs11__context.html">yubihsm_pkcs11_context</a> *ctx, <a class="el" href="pkcs11_8h.html#a28172afc989b647ca7909d036198afa6">CK_SESSION_HANDLE_PTR</a> <a class="el" href="yubihsm__pkcs11_8c.html#a4af2a29df94c09021ad1646463da9201">phSession</a>)</td></tr>
<tr class="separator:a85ea84ffb047281f34a733572f67b254"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45da02427ecf4427e4c4c181bdd9891b" id="r_a45da02427ecf4427e4c4c181bdd9891b"><td class="memItemLeft" align="right" valign="top">CK_RV&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a45da02427ecf4427e4c4c181bdd9891b">get_session</a> (<a class="el" href="structyubihsm__pkcs11__context.html">yubihsm_pkcs11_context</a> *ctx, CK_SESSION_HANDLE <a class="el" href="yubihsm__pkcs11_8c.html#a1907ffdf44b24385d6e575396ea79806">hSession</a>, <a class="el" href="structyubihsm__pkcs11__session.html">yubihsm_pkcs11_session</a> **<a class="el" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, int session_state)</td></tr>
<tr class="separator:a45da02427ecf4427e4c4c181bdd9891b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79a44d844efebfc64db6cf5836754539" id="r_a79a44d844efebfc64db6cf5836754539"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structyubihsm__pkcs11__slot.html">yubihsm_pkcs11_slot</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a79a44d844efebfc64db6cf5836754539">get_slot</a> (<a class="el" href="structyubihsm__pkcs11__context.html">yubihsm_pkcs11_context</a> *ctx, <a class="el" href="pkcs11_8h.html#a35181858a3b7a0a81f49d180d8f446ef">CK_ULONG</a> <a class="el" href="code__cache_8cpp.html#aa0efefe21f4700d78692edc823e763be">id</a>)</td></tr>
<tr class="separator:a79a44d844efebfc64db6cf5836754539"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3754cf5cb42a5e282658cf94f405574e" id="r_a3754cf5cb42a5e282658cf94f405574e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3754cf5cb42a5e282658cf94f405574e">release_slot</a> (<a class="el" href="structyubihsm__pkcs11__context.html">yubihsm_pkcs11_context</a> *ctx, <a class="el" href="structyubihsm__pkcs11__slot.html">yubihsm_pkcs11_slot</a> *<a class="el" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>)</td></tr>
<tr class="separator:a3754cf5cb42a5e282658cf94f405574e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a700b4fbb8f17dde6dc3a96957951674f" id="r_a700b4fbb8f17dde6dc3a96957951674f"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a700b4fbb8f17dde6dc3a96957951674f">create_session</a> (<a class="el" href="structyubihsm__pkcs11__slot.html">yubihsm_pkcs11_slot</a> *<a class="el" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>, CK_FLAGS <a class="el" href="yubihsm__pkcs11_8c.html#ae0ed371842ace71a7886a6134ecbcb62">flags</a>, <a class="el" href="pkcs11_8h.html#a28172afc989b647ca7909d036198afa6">CK_SESSION_HANDLE_PTR</a> <a class="el" href="yubihsm__pkcs11_8c.html#a4af2a29df94c09021ad1646463da9201">phSession</a>)</td></tr>
<tr class="separator:a700b4fbb8f17dde6dc3a96957951674f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7658e32c6ee781921b7e80a9d1fe2f8" id="r_aa7658e32c6ee781921b7e80a9d1fe2f8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa7658e32c6ee781921b7e80a9d1fe2f8">release_session</a> (<a class="el" href="structyubihsm__pkcs11__context.html">yubihsm_pkcs11_context</a> *ctx, <a class="el" href="structyubihsm__pkcs11__session.html">yubihsm_pkcs11_session</a> *<a class="el" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>)</td></tr>
<tr class="separator:aa7658e32c6ee781921b7e80a9d1fe2f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03b553175220c8747145497de5032100" id="r_a03b553175220c8747145497de5032100"><td class="memItemLeft" align="right" valign="top">CK_RV&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a03b553175220c8747145497de5032100">set_template_attribute</a> (<a class="el" href="yubihsm__pkcs11_8h.html#ade78776cf4e2dd3e25c4170aeb4edc63">yubihsm_pkcs11_attribute</a> *attribute, void *<a class="el" href="pkcs11_8h.html#a32aff7c6c4cd253fdf6563677afab5ce">value</a>)</td></tr>
<tr class="separator:a03b553175220c8747145497de5032100"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6a02fb5fc61b638c0f202f561d42445" id="r_ab6a02fb5fc61b638c0f202f561d42445"><td class="memItemLeft" align="right" valign="top">CK_RV&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab6a02fb5fc61b638c0f202f561d42445">parse_rsa_template</a> (<a class="el" href="pkcs11_8h.html#a5db3536793782f135785609e4a849fc6">CK_ATTRIBUTE_PTR</a> <a class="el" href="yubihsm__pkcs11_8c.html#aa4c2296db6853afc30383aec1a404972">pTemplate</a>, <a class="el" href="pkcs11_8h.html#a35181858a3b7a0a81f49d180d8f446ef">CK_ULONG</a> <a class="el" href="yubihsm__pkcs11_8c.html#a490d37150a3d116225298faf1cb780b6">ulCount</a>, <a class="el" href="structyubihsm__pkcs11__object__template.html">yubihsm_pkcs11_object_template</a> *<a class="el" href="yubihsm__pkcs11_8c.html#a53ef06e29c840024a683512c1acd791a">template</a>)</td></tr>
<tr class="separator:ab6a02fb5fc61b638c0f202f561d42445"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67949ebcead5efdd41af1683033d525e" id="r_a67949ebcead5efdd41af1683033d525e"><td class="memItemLeft" align="right" valign="top">CK_RV&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a67949ebcead5efdd41af1683033d525e">parse_ec_template</a> (<a class="el" href="pkcs11_8h.html#a5db3536793782f135785609e4a849fc6">CK_ATTRIBUTE_PTR</a> <a class="el" href="yubihsm__pkcs11_8c.html#aa4c2296db6853afc30383aec1a404972">pTemplate</a>, <a class="el" href="pkcs11_8h.html#a35181858a3b7a0a81f49d180d8f446ef">CK_ULONG</a> <a class="el" href="yubihsm__pkcs11_8c.html#a490d37150a3d116225298faf1cb780b6">ulCount</a>, <a class="el" href="structyubihsm__pkcs11__object__template.html">yubihsm_pkcs11_object_template</a> *<a class="el" href="yubihsm__pkcs11_8c.html#a53ef06e29c840024a683512c1acd791a">template</a>)</td></tr>
<tr class="separator:a67949ebcead5efdd41af1683033d525e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7bf21a80e49d821dfcc0b5e97c056a69" id="r_a7bf21a80e49d821dfcc0b5e97c056a69"><td class="memItemLeft" align="right" valign="top">CK_RV&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7bf21a80e49d821dfcc0b5e97c056a69">parse_hmac_template</a> (<a class="el" href="pkcs11_8h.html#a5db3536793782f135785609e4a849fc6">CK_ATTRIBUTE_PTR</a> <a class="el" href="yubihsm__pkcs11_8c.html#aa4c2296db6853afc30383aec1a404972">pTemplate</a>, <a class="el" href="pkcs11_8h.html#a35181858a3b7a0a81f49d180d8f446ef">CK_ULONG</a> <a class="el" href="yubihsm__pkcs11_8c.html#a490d37150a3d116225298faf1cb780b6">ulCount</a>, <a class="el" href="structyubihsm__pkcs11__object__template.html">yubihsm_pkcs11_object_template</a> *<a class="el" href="yubihsm__pkcs11_8c.html#a53ef06e29c840024a683512c1acd791a">template</a>, bool generate)</td></tr>
<tr class="separator:a7bf21a80e49d821dfcc0b5e97c056a69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63b36e79f7eb240fe1de611008509389" id="r_a63b36e79f7eb240fe1de611008509389"><td class="memItemLeft" align="right" valign="top">CK_RV&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a63b36e79f7eb240fe1de611008509389">parse_wrap_template</a> (<a class="el" href="pkcs11_8h.html#a5db3536793782f135785609e4a849fc6">CK_ATTRIBUTE_PTR</a> <a class="el" href="yubihsm__pkcs11_8c.html#aa4c2296db6853afc30383aec1a404972">pTemplate</a>, <a class="el" href="pkcs11_8h.html#a35181858a3b7a0a81f49d180d8f446ef">CK_ULONG</a> <a class="el" href="yubihsm__pkcs11_8c.html#a490d37150a3d116225298faf1cb780b6">ulCount</a>, <a class="el" href="structyubihsm__pkcs11__object__template.html">yubihsm_pkcs11_object_template</a> *<a class="el" href="yubihsm__pkcs11_8c.html#a53ef06e29c840024a683512c1acd791a">template</a>, bool generate)</td></tr>
<tr class="separator:a63b36e79f7eb240fe1de611008509389"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ae0dc7de593ff0d92ff81baaae9d5cb" id="r_a3ae0dc7de593ff0d92ff81baaae9d5cb"><td class="memItemLeft" align="right" valign="top">CK_RV&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3ae0dc7de593ff0d92ff81baaae9d5cb">parse_rsa_generate_template</a> (<a class="el" href="pkcs11_8h.html#a5db3536793782f135785609e4a849fc6">CK_ATTRIBUTE_PTR</a> <a class="el" href="yubihsm__pkcs11_8c.html#ade5d8be372cb742833a442592301a68b">pPublicKeyTemplate</a>, <a class="el" href="pkcs11_8h.html#a35181858a3b7a0a81f49d180d8f446ef">CK_ULONG</a> <a class="el" href="yubihsm__pkcs11_8c.html#aa7504c440c5b75cdd4386b6d56c6116c">ulPublicKeyAttributeCount</a>, <a class="el" href="pkcs11_8h.html#a5db3536793782f135785609e4a849fc6">CK_ATTRIBUTE_PTR</a> <a class="el" href="yubihsm__pkcs11_8c.html#aa0bd9585bb6c1f50e5c0c72da9d48cb9">pPrivateKeyTemplate</a>, <a class="el" href="pkcs11_8h.html#a35181858a3b7a0a81f49d180d8f446ef">CK_ULONG</a> <a class="el" href="yubihsm__pkcs11_8c.html#a062bc7ed451133876d988fb653844af4">ulPrivateKeyAttributeCount</a>, <a class="el" href="structyubihsm__pkcs11__object__template.html">yubihsm_pkcs11_object_template</a> *<a class="el" href="yubihsm__pkcs11_8c.html#a53ef06e29c840024a683512c1acd791a">template</a>)</td></tr>
<tr class="separator:a3ae0dc7de593ff0d92ff81baaae9d5cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2413ad4604ce34308256962fb1098ec7" id="r_a2413ad4604ce34308256962fb1098ec7"><td class="memItemLeft" align="right" valign="top">CK_RV&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2413ad4604ce34308256962fb1098ec7">parse_ec_generate_template</a> (<a class="el" href="pkcs11_8h.html#a5db3536793782f135785609e4a849fc6">CK_ATTRIBUTE_PTR</a> <a class="el" href="yubihsm__pkcs11_8c.html#ade5d8be372cb742833a442592301a68b">pPublicKeyTemplate</a>, <a class="el" href="pkcs11_8h.html#a35181858a3b7a0a81f49d180d8f446ef">CK_ULONG</a> <a class="el" href="yubihsm__pkcs11_8c.html#aa7504c440c5b75cdd4386b6d56c6116c">ulPublicKeyAttributeCount</a>, <a class="el" href="pkcs11_8h.html#a5db3536793782f135785609e4a849fc6">CK_ATTRIBUTE_PTR</a> <a class="el" href="yubihsm__pkcs11_8c.html#aa0bd9585bb6c1f50e5c0c72da9d48cb9">pPrivateKeyTemplate</a>, <a class="el" href="pkcs11_8h.html#a35181858a3b7a0a81f49d180d8f446ef">CK_ULONG</a> <a class="el" href="yubihsm__pkcs11_8c.html#a062bc7ed451133876d988fb653844af4">ulPrivateKeyAttributeCount</a>, <a class="el" href="structyubihsm__pkcs11__object__template.html">yubihsm_pkcs11_object_template</a> *<a class="el" href="yubihsm__pkcs11_8c.html#a53ef06e29c840024a683512c1acd791a">template</a>)</td></tr>
<tr class="separator:a2413ad4604ce34308256962fb1098ec7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66eb3d4688d7e1358a14b6c86b2158f9" id="r_a66eb3d4688d7e1358a14b6c86b2158f9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a66eb3d4688d7e1358a14b6c86b2158f9">parse_id_value</a> (void *<a class="el" href="pkcs11_8h.html#a32aff7c6c4cd253fdf6563677afab5ce">value</a>, <a class="el" href="pkcs11_8h.html#a35181858a3b7a0a81f49d180d8f446ef">CK_ULONG</a> <a class="el" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>)</td></tr>
<tr class="separator:a66eb3d4688d7e1358a14b6c86b2158f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a7af578cd3ef13f8ae12652086c7a18" id="r_a1a7af578cd3ef13f8ae12652086c7a18"><td class="memItemLeft" align="right" valign="top">CK_RV&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1a7af578cd3ef13f8ae12652086c7a18">populate_template</a> (int type, void *<a class="el" href="yubihsm__pkcs11_8c.html#a85d991d90970121ba1480cd98d93aab9">object</a>, <a class="el" href="pkcs11_8h.html#a5db3536793782f135785609e4a849fc6">CK_ATTRIBUTE_PTR</a> <a class="el" href="yubihsm__pkcs11_8c.html#aa4c2296db6853afc30383aec1a404972">pTemplate</a>, <a class="el" href="pkcs11_8h.html#a35181858a3b7a0a81f49d180d8f446ef">CK_ULONG</a> <a class="el" href="yubihsm__pkcs11_8c.html#a490d37150a3d116225298faf1cb780b6">ulCount</a>, <a class="el" href="structyh__session.html">yh_session</a> *<a class="el" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>)</td></tr>
<tr class="separator:a1a7af578cd3ef13f8ae12652086c7a18"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a10abc0d61cfd172e37c78948354243" id="r_a5a10abc0d61cfd172e37c78948354243"><td class="memItemLeft" align="right" valign="top">CK_RV&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5a10abc0d61cfd172e37c78948354243">validate_derive_key_attribute</a> (CK_ATTRIBUTE_TYPE type, void *<a class="el" href="pkcs11_8h.html#a32aff7c6c4cd253fdf6563677afab5ce">value</a>)</td></tr>
<tr class="separator:a5a10abc0d61cfd172e37c78948354243"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a101ef72541fc11b032da224f8735117a" name="a101ef72541fc11b032da224f8735117a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a101ef72541fc11b032da224f8735117a">&#9670;&#160;</a></span>add_connectors()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool add_connectors </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__pkcs11__context.html">yubihsm_pkcs11_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>n_connectors</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **</td>          <td class="paramname"><span class="paramname"><em>connector_names</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structyh__connector.html">yh_connector</a> **</td>          <td class="paramname"><span class="paramname"><em>connectors</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="util__pkcs11_8c_source.html#l02924">2924</a> of file <a class="el" href="util__pkcs11_8c_source.html">util_pkcs11.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2925</span>                                                                       {</div>
<div class="line"><span class="lineno"> 2926</span>  <span class="keywordflow">if</span> (ctx-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__context.html#ab22edea4554a2ea96e4e63954f6769a7">slots</a>.<a class="code hl_variable" href="struct_list.html#ab1a74efd973a8efd990b05788152fd95">head</a> == NULL) {</div>
<div class="line"><span class="lineno"> 2927</span>    <a class="code hl_function" href="list_8c.html#ac6c8b33b4100dfc73c933f3e936f86a1">list_create</a>(&amp;ctx-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__context.html#ab22edea4554a2ea96e4e63954f6769a7">slots</a>, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structyubihsm__pkcs11__slot.html">yubihsm_pkcs11_slot</a>), free_pkcs11_slot);</div>
<div class="line"><span class="lineno"> 2928</span>  }</div>
<div class="line"><span class="lineno"> 2929</span> </div>
<div class="line"><span class="lineno"> 2930</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n_connectors; i++) {</div>
<div class="line"><span class="lineno"> 2931</span>    <a class="code hl_struct" href="structyubihsm__pkcs11__slot.html">yubihsm_pkcs11_slot</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>;</div>
<div class="line"><span class="lineno"> 2932</span>    <a class="code hl_function" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105">memset</a>(&amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>, 0, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structyubihsm__pkcs11__slot.html">yubihsm_pkcs11_slot</a>));</div>
<div class="line"><span class="lineno"> 2933</span>    <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>.<a class="code hl_variable" href="structyubihsm__pkcs11__slot.html#a7a8ed452594de0255b468210b42f2383">id</a> = i;</div>
<div class="line"><span class="lineno"> 2934</span>    <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>.<a class="code hl_variable" href="structyubihsm__pkcs11__slot.html#aafd95d05495095288b23294aaae56caf">connector_name</a> = strdup(connector_names[i]);</div>
<div class="line"><span class="lineno"> 2935</span>    <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>.<a class="code hl_variable" href="structyubihsm__pkcs11__slot.html#acb2adb2735c7e7fed62553254305888a">max_session_id</a> = 1;</div>
<div class="line"><span class="lineno"> 2936</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>.<a class="code hl_variable" href="structyubihsm__pkcs11__slot.html#aafd95d05495095288b23294aaae56caf">connector_name</a>) {</div>
<div class="line"><span class="lineno"> 2937</span>      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2938</span>    }</div>
<div class="line"><span class="lineno"> 2939</span>    <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>.<a class="code hl_variable" href="structyubihsm__pkcs11__slot.html#a8022d3426b090c01b082636562f7c013">connector</a> = connectors[i];</div>
<div class="line"><span class="lineno"> 2940</span>    <span class="keywordflow">if</span> (ctx-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__context.html#a8fd07ddac920f2f93a360fb466b15e5f">create_mutex</a> != NULL) {</div>
<div class="line"><span class="lineno"> 2941</span>      <span class="keywordflow">if</span> (ctx-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__context.html#a8fd07ddac920f2f93a360fb466b15e5f">create_mutex</a>(&amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>.<a class="code hl_variable" href="structyubihsm__pkcs11__slot.html#a3ecfa0dfb39d722e9a0fad07a8d9334d">mutex</a>) != <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>) {</div>
<div class="line"><span class="lineno"> 2942</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2943</span>      }</div>
<div class="line"><span class="lineno"> 2944</span>    }</div>
<div class="line"><span class="lineno"> 2945</span>    <a class="code hl_function" href="list_8c.html#ac6c8b33b4100dfc73c933f3e936f86a1">list_create</a>(&amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>.<a class="code hl_variable" href="structyubihsm__pkcs11__slot.html#ab8e6a1f9aba139c1561f21304649b43a">pkcs11_sessions</a>, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structyubihsm__pkcs11__session.html">yubihsm_pkcs11_session</a>), NULL);</div>
<div class="line"><span class="lineno"> 2946</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="list_8c.html#a06a2b45f704182a7d152c88d0507700c">list_append</a>(&amp;ctx-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__context.html#ab22edea4554a2ea96e4e63954f6769a7">slots</a>, (<span class="keywordtype">void</span> *) &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>) != <span class="keyword">true</span>) {</div>
<div class="line"><span class="lineno"> 2947</span>      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2948</span>    }</div>
<div class="line"><span class="lineno"> 2949</span>  }</div>
<div class="line"><span class="lineno"> 2950</span>  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2951</span>}</div>
<div class="ttc" id="alist_8c_html_a06a2b45f704182a7d152c88d0507700c"><div class="ttname"><a href="list_8c.html#a06a2b45f704182a7d152c88d0507700c">list_append</a></div><div class="ttdeci">bool list_append(List *list, void *item)</div><div class="ttdef"><b>Definition</b> <a href="list_8c_source.html#l00078">list.c:78</a></div></div>
<div class="ttc" id="alist_8c_html_ac6c8b33b4100dfc73c933f3e936f86a1"><div class="ttname"><a href="list_8c.html#ac6c8b33b4100dfc73c933f3e936f86a1">list_create</a></div><div class="ttdeci">void list_create(List *list, int item_size, FreeItemFn free_item_fn)</div><div class="ttdef"><b>Definition</b> <a href="list_8c_source.html#l00024">list.c:24</a></div></div>
<div class="ttc" id="apkcs11_8h_html_a41f4ccf8d6aeae2795be204b4f91c076"><div class="ttname"><a href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a></div><div class="ttdeci">#define CKR_OK</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l01092">pkcs11.h:1092</a></div></div>
<div class="ttc" id="astruct_list_html_ab1a74efd973a8efd990b05788152fd95"><div class="ttname"><a href="struct_list.html#ab1a74efd973a8efd990b05788152fd95">List::head</a></div><div class="ttdeci">ListItem * head</div><div class="ttdef"><b>Definition</b> <a href="list_8h_source.html#l00038">list.h:38</a></div></div>
<div class="ttc" id="astructyubihsm__pkcs11__context_html_a8fd07ddac920f2f93a360fb466b15e5f"><div class="ttname"><a href="structyubihsm__pkcs11__context.html#a8fd07ddac920f2f93a360fb466b15e5f">yubihsm_pkcs11_context::create_mutex</a></div><div class="ttdeci">CK_CREATEMUTEX create_mutex</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8h_source.html#l00143">yubihsm_pkcs11.h:143</a></div></div>
<div class="ttc" id="astructyubihsm__pkcs11__context_html_ab22edea4554a2ea96e4e63954f6769a7"><div class="ttname"><a href="structyubihsm__pkcs11__context.html#ab22edea4554a2ea96e4e63954f6769a7">yubihsm_pkcs11_context::slots</a></div><div class="ttdeci">List slots</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8h_source.html#l00142">yubihsm_pkcs11.h:142</a></div></div>
<div class="ttc" id="astructyubihsm__pkcs11__session_html"><div class="ttname"><a href="structyubihsm__pkcs11__session.html">yubihsm_pkcs11_session</a></div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8h_source.html#l00163">yubihsm_pkcs11.h:163</a></div></div>
<div class="ttc" id="astructyubihsm__pkcs11__slot_html"><div class="ttname"><a href="structyubihsm__pkcs11__slot.html">yubihsm_pkcs11_slot</a></div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8h_source.html#l00150">yubihsm_pkcs11.h:150</a></div></div>
<div class="ttc" id="astructyubihsm__pkcs11__slot_html_a3ecfa0dfb39d722e9a0fad07a8d9334d"><div class="ttname"><a href="structyubihsm__pkcs11__slot.html#a3ecfa0dfb39d722e9a0fad07a8d9334d">yubihsm_pkcs11_slot::mutex</a></div><div class="ttdeci">void * mutex</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8h_source.html#l00160">yubihsm_pkcs11.h:160</a></div></div>
<div class="ttc" id="astructyubihsm__pkcs11__slot_html_a7a8ed452594de0255b468210b42f2383"><div class="ttname"><a href="structyubihsm__pkcs11__slot.html#a7a8ed452594de0255b468210b42f2383">yubihsm_pkcs11_slot::id</a></div><div class="ttdeci">uint16_t id</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8h_source.html#l00151">yubihsm_pkcs11.h:151</a></div></div>
<div class="ttc" id="astructyubihsm__pkcs11__slot_html_a8022d3426b090c01b082636562f7c013"><div class="ttname"><a href="structyubihsm__pkcs11__slot.html#a8022d3426b090c01b082636562f7c013">yubihsm_pkcs11_slot::connector</a></div><div class="ttdeci">yh_connector * connector</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8h_source.html#l00154">yubihsm_pkcs11.h:154</a></div></div>
<div class="ttc" id="astructyubihsm__pkcs11__slot_html_aafd95d05495095288b23294aaae56caf"><div class="ttname"><a href="structyubihsm__pkcs11__slot.html#aafd95d05495095288b23294aaae56caf">yubihsm_pkcs11_slot::connector_name</a></div><div class="ttdeci">char * connector_name</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8h_source.html#l00153">yubihsm_pkcs11.h:153</a></div></div>
<div class="ttc" id="astructyubihsm__pkcs11__slot_html_ab8e6a1f9aba139c1561f21304649b43a"><div class="ttname"><a href="structyubihsm__pkcs11__slot.html#ab8e6a1f9aba139c1561f21304649b43a">yubihsm_pkcs11_slot::pkcs11_sessions</a></div><div class="ttdeci">List pkcs11_sessions</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8h_source.html#l00156">yubihsm_pkcs11.h:156</a></div></div>
<div class="ttc" id="astructyubihsm__pkcs11__slot_html_acb2adb2735c7e7fed62553254305888a"><div class="ttname"><a href="structyubihsm__pkcs11__slot.html#acb2adb2735c7e7fed62553254305888a">yubihsm_pkcs11_slot::max_session_id</a></div><div class="ttdeci">uint16_t max_session_id</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8h_source.html#l00152">yubihsm_pkcs11.h:152</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a0209f1d92740f251d8686fd2d2a989e1"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a></div><div class="ttdeci">yubihsm_pkcs11_slot * slot</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l00518">yubihsm_pkcs11.c:518</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_adc4bd59a60361844aa0e852efa210105"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105">memset</a></div><div class="ttdeci">memset(pInfo-&gt;slotDescription, ' ', 64)</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util__pkcs11_8h_a101ef72541fc11b032da224f8735117a_cgraph.png" border="0" usemap="#autil__pkcs11_8h_a101ef72541fc11b032da224f8735117a_cgraph" alt=""/></div>
<map name="autil__pkcs11_8h_a101ef72541fc11b032da224f8735117a_cgraph" id="autil__pkcs11_8h_a101ef72541fc11b032da224f8735117a_cgraph">
<area shape="rect" title=" " alt="" coords="5,55,119,80"/>
<area shape="rect" href="list_8c.html#a06a2b45f704182a7d152c88d0507700c" title=" " alt="" coords="167,5,254,31"/>
<area shape="poly" title=" " alt="" coords="102,51,154,34,156,39,104,57"/>
<area shape="rect" href="list_8c.html#ac6c8b33b4100dfc73c933f3e936f86a1" title=" " alt="" coords="170,55,251,80"/>
<area shape="poly" title=" " alt="" coords="119,65,154,65,154,70,119,70"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="176,104,244,130"/>
<area shape="poly" title=" " alt="" coords="104,78,162,98,160,103,102,84"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="302,5,373,31"/>
<area shape="poly" title=" " alt="" coords="255,16,287,16,287,21,255,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util__pkcs11_8h_a101ef72541fc11b032da224f8735117a_icgraph.png" border="0" usemap="#autil__pkcs11_8h_a101ef72541fc11b032da224f8735117a_icgraph" alt=""/></div>
<map name="autil__pkcs11_8h_a101ef72541fc11b032da224f8735117a_icgraph" id="autil__pkcs11_8h_a101ef72541fc11b032da224f8735117a_icgraph">
<area shape="rect" title=" " alt="" coords="228,5,341,31"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#a553b528011491713b85dc590221ea616" title=" " alt="" coords="5,5,180,31"/>
<area shape="poly" title=" " alt="" coords="212,21,180,21,180,16,212,16"/>
</map>
</div>

</div>
</div>
<a id="a9ed97e6943e5263fd3695145cc59b3ad" name="a9ed97e6943e5263fd3695145cc59b3ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ed97e6943e5263fd3695145cc59b3ad">&#9670;&#160;</a></span>apply_decrypt_mechanism_finalize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CK_RV apply_decrypt_mechanism_finalize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__pkcs11__op__info.html">yubihsm_pkcs11_op_info</a> *</td>          <td class="paramname"><span class="paramname"><em>op_info</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a915e620459f4f98eca94bff5913cfac5" name="a915e620459f4f98eca94bff5913cfac5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a915e620459f4f98eca94bff5913cfac5">&#9670;&#160;</a></span>apply_decrypt_mechanism_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CK_RV apply_decrypt_mechanism_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__pkcs11__op__info.html">yubihsm_pkcs11_op_info</a> *</td>          <td class="paramname"><span class="paramname"><em>op_info</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="util__pkcs11_8c_source.html#l01884">1884</a> of file <a class="el" href="util__pkcs11_8c_source.html">util_pkcs11.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1884</span>                                                                    {</div>
<div class="line"><span class="lineno"> 1885</span> </div>
<div class="line"><span class="lineno"> 1886</span>  op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ac226105a253c6fda70b44e14a525007a">buffer_length</a> = 0;</div>
<div class="line"><span class="lineno"> 1887</span>  op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#a511016f53f468cbe53728403a03df05a">decrypt</a>.<a class="code hl_variable" href="structdecrypt__info.html#a7c05d8f6e2fa380b34b2f5331259b13d">finalized</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1888</span> </div>
<div class="line"><span class="lineno"> 1889</span>  <span class="keywordflow">switch</span> (op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a261664672f3ef63ab3a20b864627c49a">mechanism</a>.<a class="code hl_variable" href="structmechanism.html#afeb8198b0f33f94f4520c0ffbc584a9a">mechanism</a>) {</div>
<div class="line"><span class="lineno"> 1890</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a08a8e0f2109de3ff3bfe26f220447a2e">CKM_RSA_PKCS</a>:</div>
<div class="line"><span class="lineno"> 1891</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a69da8859ad1e6b4f424d071b42ea4a0c">CKM_RSA_PKCS_OAEP</a>:</div>
<div class="line"><span class="lineno"> 1892</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11y_8h.html#a631efbda997696a7f7ce71df0e3e779a">CKM_YUBICO_AES_CCM_WRAP</a>:</div>
<div class="line"><span class="lineno"> 1893</span>      <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>;</div>
<div class="line"><span class="lineno"> 1894</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 1895</span>      <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Mechanism %lu not supported&quot;</span>, op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a261664672f3ef63ab3a20b864627c49a">mechanism</a>.<a class="code hl_variable" href="structmechanism.html#afeb8198b0f33f94f4520c0ffbc584a9a">mechanism</a>);</div>
<div class="line"><span class="lineno"> 1896</span>      <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a0664e99597a479c7fce5b19411cfc1b1">CKR_MECHANISM_INVALID</a>;</div>
<div class="line"><span class="lineno"> 1897</span>  }</div>
<div class="line"><span class="lineno"> 1898</span> </div>
<div class="line"><span class="lineno"> 1899</span>  <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>;</div>
<div class="line"><span class="lineno"> 1900</span>}</div>
<div class="ttc" id="adebug__lib_8h_html_a2e3ed21e5ffba18d940d164aaec64a2a"><div class="ttname"><a href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a></div><div class="ttdeci">#define DBG_ERR(...)</div><div class="ttdef"><b>Definition</b> <a href="debug__lib_8h_source.html#l00076">debug_lib.h:76</a></div></div>
<div class="ttc" id="apkcs11_8h_html_a0664e99597a479c7fce5b19411cfc1b1"><div class="ttname"><a href="pkcs11_8h.html#a0664e99597a479c7fce5b19411cfc1b1">CKR_MECHANISM_INVALID</a></div><div class="ttdeci">#define CKR_MECHANISM_INVALID</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l01126">pkcs11.h:1126</a></div></div>
<div class="ttc" id="apkcs11_8h_html_a08a8e0f2109de3ff3bfe26f220447a2e"><div class="ttname"><a href="pkcs11_8h.html#a08a8e0f2109de3ff3bfe26f220447a2e">CKM_RSA_PKCS</a></div><div class="ttdeci">#define CKM_RSA_PKCS</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00470">pkcs11.h:470</a></div></div>
<div class="ttc" id="apkcs11_8h_html_a69da8859ad1e6b4f424d071b42ea4a0c"><div class="ttname"><a href="pkcs11_8h.html#a69da8859ad1e6b4f424d071b42ea4a0c">CKM_RSA_PKCS_OAEP</a></div><div class="ttdeci">#define CKM_RSA_PKCS_OAEP</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00478">pkcs11.h:478</a></div></div>
<div class="ttc" id="apkcs11y_8h_html_a631efbda997696a7f7ce71df0e3e779a"><div class="ttname"><a href="pkcs11y_8h.html#a631efbda997696a7f7ce71df0e3e779a">CKM_YUBICO_AES_CCM_WRAP</a></div><div class="ttdeci">#define CKM_YUBICO_AES_CCM_WRAP</div><div class="ttdef"><b>Definition</b> <a href="pkcs11y_8h_source.html#l00033">pkcs11y.h:33</a></div></div>
<div class="ttc" id="astructdecrypt__info_html_a7c05d8f6e2fa380b34b2f5331259b13d"><div class="ttname"><a href="structdecrypt__info.html#a7c05d8f6e2fa380b34b2f5331259b13d">decrypt_info::finalized</a></div><div class="ttdeci">bool finalized</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8h_source.html#l00081">yubihsm_pkcs11.h:81</a></div></div>
<div class="ttc" id="astructmechanism_html_afeb8198b0f33f94f4520c0ffbc584a9a"><div class="ttname"><a href="structmechanism.html#afeb8198b0f33f94f4520c0ffbc584a9a">mechanism::mechanism</a></div><div class="ttdeci">CK_MECHANISM_TYPE mechanism</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8h_source.html#l00108">yubihsm_pkcs11.h:108</a></div></div>
<div class="ttc" id="astructyubihsm__pkcs11__op__info_html_a261664672f3ef63ab3a20b864627c49a"><div class="ttname"><a href="structyubihsm__pkcs11__op__info.html#a261664672f3ef63ab3a20b864627c49a">yubihsm_pkcs11_op_info::mechanism</a></div><div class="ttdeci">mechanism mechanism</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8h_source.html#l00135">yubihsm_pkcs11.h:135</a></div></div>
<div class="ttc" id="astructyubihsm__pkcs11__op__info_html_a2a88bfeb3f914ab4bc36697f02838057"><div class="ttname"><a href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">yubihsm_pkcs11_op_info::op</a></div><div class="ttdeci">op op</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8h_source.html#l00136">yubihsm_pkcs11.h:136</a></div></div>
<div class="ttc" id="astructyubihsm__pkcs11__op__info_html_ac226105a253c6fda70b44e14a525007a"><div class="ttname"><a href="structyubihsm__pkcs11__op__info.html#ac226105a253c6fda70b44e14a525007a">yubihsm_pkcs11_op_info::buffer_length</a></div><div class="ttdeci">unsigned int buffer_length</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8h_source.html#l00138">yubihsm_pkcs11.h:138</a></div></div>
<div class="ttc" id="aunionop_html_a511016f53f468cbe53728403a03df05a"><div class="ttname"><a href="unionop.html#a511016f53f468cbe53728403a03df05a">op::decrypt</a></div><div class="ttdeci">decrypt_info decrypt</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8h_source.html#l00103">yubihsm_pkcs11.h:103</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util__pkcs11_8h_a915e620459f4f98eca94bff5913cfac5_cgraph.png" border="0" usemap="#autil__pkcs11_8h_a915e620459f4f98eca94bff5913cfac5_cgraph" alt=""/></div>
<map name="autil__pkcs11_8h_a915e620459f4f98eca94bff5913cfac5_cgraph" id="autil__pkcs11_8h_a915e620459f4f98eca94bff5913cfac5_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,206,31"/>
<area shape="rect" href="structmechanism.html#afeb8198b0f33f94f4520c0ffbc584a9a" title=" " alt="" coords="254,5,417,31"/>
<area shape="poly" title=" " alt="" coords="206,16,238,16,238,21,206,21"/>
</map>
</div>

</div>
</div>
<a id="a7fe9865366124c43dfbc7db9e710384d" name="a7fe9865366124c43dfbc7db9e710384d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7fe9865366124c43dfbc7db9e710384d">&#9670;&#160;</a></span>apply_decrypt_mechanism_update()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CK_RV apply_decrypt_mechanism_update </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__pkcs11__op__info.html">yubihsm_pkcs11_op_info</a> *</td>          <td class="paramname"><span class="paramname"><em>op_info</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pkcs11_8h.html#a7bc6919a7c3c372056fa7e18343a0b37">CK_BYTE_PTR</a></td>          <td class="paramname"><span class="paramname"><em>in</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pkcs11_8h.html#a35181858a3b7a0a81f49d180d8f446ef">CK_ULONG</a></td>          <td class="paramname"><span class="paramname"><em>in_len</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="util__pkcs11_8c_source.html#l02053">2053</a> of file <a class="el" href="util__pkcs11_8c_source.html">util_pkcs11.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2054</span>                                                                      {</div>
<div class="line"><span class="lineno"> 2055</span> </div>
<div class="line"><span class="lineno"> 2056</span>  <span class="keywordflow">switch</span> (op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a261664672f3ef63ab3a20b864627c49a">mechanism</a>.<a class="code hl_variable" href="structmechanism.html#afeb8198b0f33f94f4520c0ffbc584a9a">mechanism</a>) {</div>
<div class="line"><span class="lineno"> 2057</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a08a8e0f2109de3ff3bfe26f220447a2e">CKM_RSA_PKCS</a>:</div>
<div class="line"><span class="lineno"> 2058</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a69da8859ad1e6b4f424d071b42ea4a0c">CKM_RSA_PKCS_OAEP</a>:</div>
<div class="line"><span class="lineno"> 2059</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11y_8h.html#a631efbda997696a7f7ce71df0e3e779a">CKM_YUBICO_AES_CCM_WRAP</a>:</div>
<div class="line"><span class="lineno"> 2060</span>      <span class="keywordflow">if</span> (op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ac226105a253c6fda70b44e14a525007a">buffer_length</a> + <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a> &gt; <span class="keyword">sizeof</span>(op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ad4fd174ba5f77aad7e1f1c66079529ba">buffer</a>)) {</div>
<div class="line"><span class="lineno"> 2061</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a9a521148fda788ca98f4fdbb6d3b9438">CKR_DATA_LEN_RANGE</a>;</div>
<div class="line"><span class="lineno"> 2062</span>      }</div>
<div class="line"><span class="lineno"> 2063</span> </div>
<div class="line"><span class="lineno"> 2064</span>      <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ad4fd174ba5f77aad7e1f1c66079529ba">buffer</a> + op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ac226105a253c6fda70b44e14a525007a">buffer_length</a>, in, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a>);</div>
<div class="line"><span class="lineno"> 2065</span>      op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ac226105a253c6fda70b44e14a525007a">buffer_length</a> += <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a>;</div>
<div class="line"><span class="lineno"> 2066</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2067</span> </div>
<div class="line"><span class="lineno"> 2068</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 2069</span>      <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a91150ecacbaa624fcc7d861f1b54f57c">CKR_FUNCTION_FAILED</a>;</div>
<div class="line"><span class="lineno"> 2070</span>  }</div>
<div class="line"><span class="lineno"> 2071</span> </div>
<div class="line"><span class="lineno"> 2072</span>  <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>;</div>
<div class="line"><span class="lineno"> 2073</span>}</div>
<div class="ttc" id="apkcs11_8h_html_a91150ecacbaa624fcc7d861f1b54f57c"><div class="ttname"><a href="pkcs11_8h.html#a91150ecacbaa624fcc7d861f1b54f57c">CKR_FUNCTION_FAILED</a></div><div class="ttdeci">#define CKR_FUNCTION_FAILED</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l01097">pkcs11.h:1097</a></div></div>
<div class="ttc" id="apkcs11_8h_html_a9a521148fda788ca98f4fdbb6d3b9438"><div class="ttname"><a href="pkcs11_8h.html#a9a521148fda788ca98f4fdbb6d3b9438">CKR_DATA_LEN_RANGE</a></div><div class="ttdeci">#define CKR_DATA_LEN_RANGE</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l01107">pkcs11.h:1107</a></div></div>
<div class="ttc" id="astructyubihsm__pkcs11__op__info_html_ad4fd174ba5f77aad7e1f1c66079529ba"><div class="ttname"><a href="structyubihsm__pkcs11__op__info.html#ad4fd174ba5f77aad7e1f1c66079529ba">yubihsm_pkcs11_op_info::buffer</a></div><div class="ttdeci">uint8_t buffer[YUBIHSM_PKCS11_OP_BUFSIZE]</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8h_source.html#l00137">yubihsm_pkcs11.h:137</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_ae785d5badbf1f08b491af31f32a135a1"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a></div><div class="ttdeci">memcpy((char *) pInfo-&gt;slotDescription, s, l)</div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_af352138fec1245efdaee143f770c01ef"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a></div><div class="ttdeci">size_t in_len</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l04978">yubihsm_pkcs11.c:4978</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util__pkcs11_8h_a7fe9865366124c43dfbc7db9e710384d_cgraph.png" border="0" usemap="#autil__pkcs11_8h_a7fe9865366124c43dfbc7db9e710384d_cgraph" alt=""/></div>
<map name="autil__pkcs11_8h_a7fe9865366124c43dfbc7db9e710384d_cgraph" id="autil__pkcs11_8h_a7fe9865366124c43dfbc7db9e710384d_cgraph">
<area shape="rect" title=" " alt="" coords="5,23,182,64"/>
<area shape="rect" href="structmechanism.html#afeb8198b0f33f94f4520c0ffbc584a9a" title=" " alt="" coords="230,5,393,31"/>
<area shape="poly" title=" " alt="" coords="181,31,214,27,214,32,182,36"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="276,55,347,80"/>
<area shape="poly" title=" " alt="" coords="182,51,261,59,260,65,181,56"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util__pkcs11_8h_a7fe9865366124c43dfbc7db9e710384d_icgraph.png" border="0" usemap="#autil__pkcs11_8h_a7fe9865366124c43dfbc7db9e710384d_icgraph" alt=""/></div>
<map name="autil__pkcs11_8h_a7fe9865366124c43dfbc7db9e710384d_icgraph" id="autil__pkcs11_8h_a7fe9865366124c43dfbc7db9e710384d_icgraph">
<area shape="rect" title=" " alt="" coords="92,5,268,46"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#a1449c3848d34847be3b910f7c42f5f93" title=" " alt="" coords="5,13,44,38"/>
<area shape="poly" title=" " alt="" coords="76,28,44,28,44,23,76,23"/>
</map>
</div>

</div>
</div>
<a id="a926a181770971fd05600d16f93acd39e" name="a926a181770971fd05600d16f93acd39e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a926a181770971fd05600d16f93acd39e">&#9670;&#160;</a></span>apply_digest_mechanism_finalize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CK_RV apply_digest_mechanism_finalize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__pkcs11__op__info.html">yubihsm_pkcs11_op_info</a> *</td>          <td class="paramname"><span class="paramname"><em>op_info</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="util__pkcs11_8c_source.html#l02163">2163</a> of file <a class="el" href="util__pkcs11_8c_source.html">util_pkcs11.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2163</span>                                                                       {</div>
<div class="line"><span class="lineno"> 2164</span> </div>
<div class="line"><span class="lineno"> 2165</span>  <span class="keywordtype">int</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a3d854b6efad16a16e4d7b4539d4fc71f">ret</a>;</div>
<div class="line"><span class="lineno"> 2166</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a3d854b6efad16a16e4d7b4539d4fc71f">ret</a> = EVP_DigestFinal_ex(op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#a06ea7ebdd4f4e99dec979ed3576e5722">digest</a>.<a class="code hl_variable" href="structdigest__info.html#acf5534c1229554d54bf0e71dd544db81">md_ctx</a>, op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ad4fd174ba5f77aad7e1f1c66079529ba">buffer</a>,</div>
<div class="line"><span class="lineno"> 2167</span>                           &amp;op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ac226105a253c6fda70b44e14a525007a">buffer_length</a>);</div>
<div class="line"><span class="lineno"> 2168</span> </div>
<div class="line"><span class="lineno"> 2169</span>  EVP_MD_CTX_destroy(op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#a06ea7ebdd4f4e99dec979ed3576e5722">digest</a>.<a class="code hl_variable" href="structdigest__info.html#acf5534c1229554d54bf0e71dd544db81">md_ctx</a>);</div>
<div class="line"><span class="lineno"> 2170</span>  op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#a06ea7ebdd4f4e99dec979ed3576e5722">digest</a>.<a class="code hl_variable" href="structdigest__info.html#acf5534c1229554d54bf0e71dd544db81">md_ctx</a> = NULL;</div>
<div class="line"><span class="lineno"> 2171</span> </div>
<div class="line"><span class="lineno"> 2172</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a3d854b6efad16a16e4d7b4539d4fc71f">ret</a> != 1) {</div>
<div class="line"><span class="lineno"> 2173</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a91150ecacbaa624fcc7d861f1b54f57c">CKR_FUNCTION_FAILED</a>;</div>
<div class="line"><span class="lineno"> 2174</span>  }</div>
<div class="line"><span class="lineno"> 2175</span> </div>
<div class="line"><span class="lineno"> 2176</span>  <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>;</div>
<div class="line"><span class="lineno"> 2177</span>}</div>
<div class="ttc" id="astructdigest__info_html_acf5534c1229554d54bf0e71dd544db81"><div class="ttname"><a href="structdigest__info.html#acf5534c1229554d54bf0e71dd544db81">digest_info::md_ctx</a></div><div class="ttdeci">EVP_MD_CTX * md_ctx</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8h_source.html#l00073">yubihsm_pkcs11.h:73</a></div></div>
<div class="ttc" id="aunionop_html_a06ea7ebdd4f4e99dec979ed3576e5722"><div class="ttname"><a href="unionop.html#a06ea7ebdd4f4e99dec979ed3576e5722">op::digest</a></div><div class="ttdeci">digest_info digest</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8h_source.html#l00101">yubihsm_pkcs11.h:101</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a3d854b6efad16a16e4d7b4539d4fc71f"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a3d854b6efad16a16e4d7b4539d4fc71f">ret</a></div><div class="ttdeci">CK_RV ret</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l00973">yubihsm_pkcs11.c:973</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a50a795ac4e657d1813394e49cd4650d0" name="a50a795ac4e657d1813394e49cd4650d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50a795ac4e657d1813394e49cd4650d0">&#9670;&#160;</a></span>apply_digest_mechanism_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CK_RV apply_digest_mechanism_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__pkcs11__op__info.html">yubihsm_pkcs11_op_info</a> *</td>          <td class="paramname"><span class="paramname"><em>op_info</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="util__pkcs11_8c_source.html#l01902">1902</a> of file <a class="el" href="util__pkcs11_8c_source.html">util_pkcs11.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1902</span>                                                                   {</div>
<div class="line"><span class="lineno"> 1903</span> </div>
<div class="line"><span class="lineno"> 1904</span>  <span class="keyword">const</span> EVP_MD *md = NULL;</div>
<div class="line"><span class="lineno"> 1905</span> </div>
<div class="line"><span class="lineno"> 1906</span>  op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ac226105a253c6fda70b44e14a525007a">buffer_length</a> = 0;</div>
<div class="line"><span class="lineno"> 1907</span> </div>
<div class="line"><span class="lineno"> 1908</span>  <span class="keywordflow">switch</span> (op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a261664672f3ef63ab3a20b864627c49a">mechanism</a>.<a class="code hl_variable" href="structmechanism.html#afeb8198b0f33f94f4520c0ffbc584a9a">mechanism</a>) {</div>
<div class="line"><span class="lineno"> 1909</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#af1818a1c453a84f01f2e868307ca8fed">CKM_SHA_1</a>:</div>
<div class="line"><span class="lineno"> 1910</span>      md = EVP_sha1();</div>
<div class="line"><span class="lineno"> 1911</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1912</span> </div>
<div class="line"><span class="lineno"> 1913</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a4d11f88ae3bea2f748f275c03b54a648">CKM_SHA256</a>:</div>
<div class="line"><span class="lineno"> 1914</span>      md = EVP_sha256();</div>
<div class="line"><span class="lineno"> 1915</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1916</span> </div>
<div class="line"><span class="lineno"> 1917</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a9278e01971ca83cdd07e4b8e07a00bc8">CKM_SHA384</a>:</div>
<div class="line"><span class="lineno"> 1918</span>      md = EVP_sha384();</div>
<div class="line"><span class="lineno"> 1919</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1920</span> </div>
<div class="line"><span class="lineno"> 1921</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a9bf4bf7375a24e1010cc8e0139608fd5">CKM_SHA512</a>:</div>
<div class="line"><span class="lineno"> 1922</span>      md = EVP_sha512();</div>
<div class="line"><span class="lineno"> 1923</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1924</span> </div>
<div class="line"><span class="lineno"> 1925</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 1926</span>      <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Mechanism %lu not supported&quot;</span>, op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a261664672f3ef63ab3a20b864627c49a">mechanism</a>.<a class="code hl_variable" href="structmechanism.html#afeb8198b0f33f94f4520c0ffbc584a9a">mechanism</a>);</div>
<div class="line"><span class="lineno"> 1927</span>      <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a0664e99597a479c7fce5b19411cfc1b1">CKR_MECHANISM_INVALID</a>;</div>
<div class="line"><span class="lineno"> 1928</span>  }</div>
<div class="line"><span class="lineno"> 1929</span> </div>
<div class="line"><span class="lineno"> 1930</span>  op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#a06ea7ebdd4f4e99dec979ed3576e5722">digest</a>.<a class="code hl_variable" href="structdigest__info.html#acf5534c1229554d54bf0e71dd544db81">md_ctx</a> = EVP_MD_CTX_create();</div>
<div class="line"><span class="lineno"> 1931</span> </div>
<div class="line"><span class="lineno"> 1932</span>  op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#a06ea7ebdd4f4e99dec979ed3576e5722">digest</a>.<a class="code hl_variable" href="structdigest__info.html#aedb88e03528275703ea081d85882efc0">is_multipart</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1933</span> </div>
<div class="line"><span class="lineno"> 1934</span>  <span class="keywordflow">if</span> (EVP_DigestInit_ex(op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#a06ea7ebdd4f4e99dec979ed3576e5722">digest</a>.<a class="code hl_variable" href="structdigest__info.html#acf5534c1229554d54bf0e71dd544db81">md_ctx</a>, md, NULL) == 0) {</div>
<div class="line"><span class="lineno"> 1935</span>    EVP_MD_CTX_destroy(op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#a06ea7ebdd4f4e99dec979ed3576e5722">digest</a>.<a class="code hl_variable" href="structdigest__info.html#acf5534c1229554d54bf0e71dd544db81">md_ctx</a>);</div>
<div class="line"><span class="lineno"> 1936</span>    op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#a06ea7ebdd4f4e99dec979ed3576e5722">digest</a>.<a class="code hl_variable" href="structdigest__info.html#acf5534c1229554d54bf0e71dd544db81">md_ctx</a> = NULL;</div>
<div class="line"><span class="lineno"> 1937</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a91150ecacbaa624fcc7d861f1b54f57c">CKR_FUNCTION_FAILED</a>;</div>
<div class="line"><span class="lineno"> 1938</span>  }</div>
<div class="line"><span class="lineno"> 1939</span> </div>
<div class="line"><span class="lineno"> 1940</span>  <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>;</div>
<div class="line"><span class="lineno"> 1941</span>}</div>
<div class="ttc" id="apkcs11_8h_html_a4d11f88ae3bea2f748f275c03b54a648"><div class="ttname"><a href="pkcs11_8h.html#a4d11f88ae3bea2f748f275c03b54a648">CKM_SHA256</a></div><div class="ttdeci">#define CKM_SHA256</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00541">pkcs11.h:541</a></div></div>
<div class="ttc" id="apkcs11_8h_html_a9278e01971ca83cdd07e4b8e07a00bc8"><div class="ttname"><a href="pkcs11_8h.html#a9278e01971ca83cdd07e4b8e07a00bc8">CKM_SHA384</a></div><div class="ttdeci">#define CKM_SHA384</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00544">pkcs11.h:544</a></div></div>
<div class="ttc" id="apkcs11_8h_html_a9bf4bf7375a24e1010cc8e0139608fd5"><div class="ttname"><a href="pkcs11_8h.html#a9bf4bf7375a24e1010cc8e0139608fd5">CKM_SHA512</a></div><div class="ttdeci">#define CKM_SHA512</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00547">pkcs11.h:547</a></div></div>
<div class="ttc" id="apkcs11_8h_html_af1818a1c453a84f01f2e868307ca8fed"><div class="ttname"><a href="pkcs11_8h.html#af1818a1c453a84f01f2e868307ca8fed">CKM_SHA_1</a></div><div class="ttdeci">#define CKM_SHA_1</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00532">pkcs11.h:532</a></div></div>
<div class="ttc" id="astructdigest__info_html_aedb88e03528275703ea081d85882efc0"><div class="ttname"><a href="structdigest__info.html#aedb88e03528275703ea081d85882efc0">digest_info::is_multipart</a></div><div class="ttdeci">bool is_multipart</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8h_source.html#l00075">yubihsm_pkcs11.h:75</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util__pkcs11_8h_a50a795ac4e657d1813394e49cd4650d0_cgraph.png" border="0" usemap="#autil__pkcs11_8h_a50a795ac4e657d1813394e49cd4650d0_cgraph" alt=""/></div>
<map name="autil__pkcs11_8h_a50a795ac4e657d1813394e49cd4650d0_cgraph" id="autil__pkcs11_8h_a50a795ac4e657d1813394e49cd4650d0_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,198,31"/>
<area shape="rect" href="structmechanism.html#afeb8198b0f33f94f4520c0ffbc584a9a" title=" " alt="" coords="246,5,409,31"/>
<area shape="poly" title=" " alt="" coords="198,16,230,16,230,21,198,21"/>
</map>
</div>

</div>
</div>
<a id="a86347633f97ab81b8e9b49e4bd754d3f" name="a86347633f97ab81b8e9b49e4bd754d3f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a86347633f97ab81b8e9b49e4bd754d3f">&#9670;&#160;</a></span>apply_digest_mechanism_update()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CK_RV apply_digest_mechanism_update </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__pkcs11__op__info.html">yubihsm_pkcs11_op_info</a> *</td>          <td class="paramname"><span class="paramname"><em>op_info</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pkcs11_8h.html#a7bc6919a7c3c372056fa7e18343a0b37">CK_BYTE_PTR</a></td>          <td class="paramname"><span class="paramname"><em>in</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pkcs11_8h.html#a35181858a3b7a0a81f49d180d8f446ef">CK_ULONG</a></td>          <td class="paramname"><span class="paramname"><em>in_len</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="util__pkcs11_8c_source.html#l02095">2095</a> of file <a class="el" href="util__pkcs11_8c_source.html">util_pkcs11.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2096</span>                                                                     {</div>
<div class="line"><span class="lineno"> 2097</span> </div>
<div class="line"><span class="lineno"> 2098</span>  <span class="keywordflow">switch</span> (op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a261664672f3ef63ab3a20b864627c49a">mechanism</a>.<a class="code hl_variable" href="structmechanism.html#afeb8198b0f33f94f4520c0ffbc584a9a">mechanism</a>) {</div>
<div class="line"><span class="lineno"> 2099</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#af1818a1c453a84f01f2e868307ca8fed">CKM_SHA_1</a>:</div>
<div class="line"><span class="lineno"> 2100</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a4d11f88ae3bea2f748f275c03b54a648">CKM_SHA256</a>:</div>
<div class="line"><span class="lineno"> 2101</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a9278e01971ca83cdd07e4b8e07a00bc8">CKM_SHA384</a>:</div>
<div class="line"><span class="lineno"> 2102</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a9bf4bf7375a24e1010cc8e0139608fd5">CKM_SHA512</a>:</div>
<div class="line"><span class="lineno"> 2103</span>      <span class="keywordflow">if</span> (EVP_DigestUpdate(op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#a06ea7ebdd4f4e99dec979ed3576e5722">digest</a>.<a class="code hl_variable" href="structdigest__info.html#acf5534c1229554d54bf0e71dd544db81">md_ctx</a>, in, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a>) != 1) {</div>
<div class="line"><span class="lineno"> 2104</span>        EVP_MD_CTX_destroy(op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#a06ea7ebdd4f4e99dec979ed3576e5722">digest</a>.<a class="code hl_variable" href="structdigest__info.html#acf5534c1229554d54bf0e71dd544db81">md_ctx</a>);</div>
<div class="line"><span class="lineno"> 2105</span>        op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#a06ea7ebdd4f4e99dec979ed3576e5722">digest</a>.<a class="code hl_variable" href="structdigest__info.html#acf5534c1229554d54bf0e71dd544db81">md_ctx</a> = NULL;</div>
<div class="line"><span class="lineno"> 2106</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a91150ecacbaa624fcc7d861f1b54f57c">CKR_FUNCTION_FAILED</a>;</div>
<div class="line"><span class="lineno"> 2107</span>      }</div>
<div class="line"><span class="lineno"> 2108</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2109</span> </div>
<div class="line"><span class="lineno"> 2110</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 2111</span>      <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a91150ecacbaa624fcc7d861f1b54f57c">CKR_FUNCTION_FAILED</a>;</div>
<div class="line"><span class="lineno"> 2112</span>  }</div>
<div class="line"><span class="lineno"> 2113</span> </div>
<div class="line"><span class="lineno"> 2114</span>  <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>;</div>
<div class="line"><span class="lineno"> 2115</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util__pkcs11_8h_a86347633f97ab81b8e9b49e4bd754d3f_cgraph.png" border="0" usemap="#autil__pkcs11_8h_a86347633f97ab81b8e9b49e4bd754d3f_cgraph" alt=""/></div>
<map name="autil__pkcs11_8h_a86347633f97ab81b8e9b49e4bd754d3f_cgraph" id="autil__pkcs11_8h_a86347633f97ab81b8e9b49e4bd754d3f_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,174,46"/>
<area shape="rect" href="structmechanism.html#afeb8198b0f33f94f4520c0ffbc584a9a" title=" " alt="" coords="222,13,385,38"/>
<area shape="poly" title=" " alt="" coords="174,23,206,23,206,28,174,28"/>
</map>
</div>

</div>
</div>
<a id="a5aa664d8466537659db8d185d8e5683c" name="a5aa664d8466537659db8d185d8e5683c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5aa664d8466537659db8d185d8e5683c">&#9670;&#160;</a></span>apply_encrypt_mechanism_update()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CK_RV apply_encrypt_mechanism_update </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__pkcs11__op__info.html">yubihsm_pkcs11_op_info</a> *</td>          <td class="paramname"><span class="paramname"><em>op_info</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pkcs11_8h.html#a7bc6919a7c3c372056fa7e18343a0b37">CK_BYTE_PTR</a></td>          <td class="paramname"><span class="paramname"><em>in</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pkcs11_8h.html#a35181858a3b7a0a81f49d180d8f446ef">CK_ULONG</a></td>          <td class="paramname"><span class="paramname"><em>in_len</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="util__pkcs11_8c_source.html#l02075">2075</a> of file <a class="el" href="util__pkcs11_8c_source.html">util_pkcs11.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2076</span>                                                                      {</div>
<div class="line"><span class="lineno"> 2077</span> </div>
<div class="line"><span class="lineno"> 2078</span>  <span class="keywordflow">switch</span> (op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a261664672f3ef63ab3a20b864627c49a">mechanism</a>.<a class="code hl_variable" href="structmechanism.html#afeb8198b0f33f94f4520c0ffbc584a9a">mechanism</a>) {</div>
<div class="line"><span class="lineno"> 2079</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11y_8h.html#a631efbda997696a7f7ce71df0e3e779a">CKM_YUBICO_AES_CCM_WRAP</a>:</div>
<div class="line"><span class="lineno"> 2080</span>      <span class="keywordflow">if</span> (op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ac226105a253c6fda70b44e14a525007a">buffer_length</a> + <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a> &gt; <span class="keyword">sizeof</span>(op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ad4fd174ba5f77aad7e1f1c66079529ba">buffer</a>)) {</div>
<div class="line"><span class="lineno"> 2081</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a9a521148fda788ca98f4fdbb6d3b9438">CKR_DATA_LEN_RANGE</a>;</div>
<div class="line"><span class="lineno"> 2082</span>      }</div>
<div class="line"><span class="lineno"> 2083</span> </div>
<div class="line"><span class="lineno"> 2084</span>      <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ad4fd174ba5f77aad7e1f1c66079529ba">buffer</a> + op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ac226105a253c6fda70b44e14a525007a">buffer_length</a>, in, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a>);</div>
<div class="line"><span class="lineno"> 2085</span>      op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ac226105a253c6fda70b44e14a525007a">buffer_length</a> += <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a>;</div>
<div class="line"><span class="lineno"> 2086</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2087</span> </div>
<div class="line"><span class="lineno"> 2088</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 2089</span>      <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a91150ecacbaa624fcc7d861f1b54f57c">CKR_FUNCTION_FAILED</a>;</div>
<div class="line"><span class="lineno"> 2090</span>  }</div>
<div class="line"><span class="lineno"> 2091</span> </div>
<div class="line"><span class="lineno"> 2092</span>  <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>;</div>
<div class="line"><span class="lineno"> 2093</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util__pkcs11_8h_a5aa664d8466537659db8d185d8e5683c_cgraph.png" border="0" usemap="#autil__pkcs11_8h_a5aa664d8466537659db8d185d8e5683c_cgraph" alt=""/></div>
<map name="autil__pkcs11_8h_a5aa664d8466537659db8d185d8e5683c_cgraph" id="autil__pkcs11_8h_a5aa664d8466537659db8d185d8e5683c_cgraph">
<area shape="rect" title=" " alt="" coords="5,23,182,64"/>
<area shape="rect" href="structmechanism.html#afeb8198b0f33f94f4520c0ffbc584a9a" title=" " alt="" coords="230,5,393,31"/>
<area shape="poly" title=" " alt="" coords="181,31,214,27,214,32,182,36"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="276,55,347,80"/>
<area shape="poly" title=" " alt="" coords="182,51,261,59,260,65,181,56"/>
</map>
</div>

</div>
</div>
<a id="a785bd4bd444e619e6e5e12b2e392f086" name="a785bd4bd444e619e6e5e12b2e392f086"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a785bd4bd444e619e6e5e12b2e392f086">&#9670;&#160;</a></span>apply_sign_mechanism_finalize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CK_RV apply_sign_mechanism_finalize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__pkcs11__op__info.html">yubihsm_pkcs11_op_info</a> *</td>          <td class="paramname"><span class="paramname"><em>op_info</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="util__pkcs11_8c_source.html#l02117">2117</a> of file <a class="el" href="util__pkcs11_8c_source.html">util_pkcs11.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2117</span>                                                                     {</div>
<div class="line"><span class="lineno"> 2118</span> </div>
<div class="line"><span class="lineno"> 2119</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="util__pkcs11_8c.html#a3f1010425d5308dfa15d696b4853c68c">is_hashed_mechanism</a>(op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a261664672f3ef63ab3a20b864627c49a">mechanism</a>.<a class="code hl_variable" href="structmechanism.html#afeb8198b0f33f94f4520c0ffbc584a9a">mechanism</a>)) {</div>
<div class="line"><span class="lineno"> 2120</span>    <span class="keywordtype">int</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a3d854b6efad16a16e4d7b4539d4fc71f">ret</a>;</div>
<div class="line"><span class="lineno"> 2121</span>    <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a3d854b6efad16a16e4d7b4539d4fc71f">ret</a> = EVP_DigestFinal_ex(op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#af6e088c2d57f2582d353bec69b48c023">sign</a>.<a class="code hl_variable" href="structsign__info.html#a575aca68f9e4dec0e3cc9de8bc560725">md_ctx</a>, op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ad4fd174ba5f77aad7e1f1c66079529ba">buffer</a>,</div>
<div class="line"><span class="lineno"> 2122</span>                             &amp;op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ac226105a253c6fda70b44e14a525007a">buffer_length</a>);</div>
<div class="line"><span class="lineno"> 2123</span> </div>
<div class="line"><span class="lineno"> 2124</span>    EVP_MD_CTX_destroy(op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#af6e088c2d57f2582d353bec69b48c023">sign</a>.<a class="code hl_variable" href="structsign__info.html#a575aca68f9e4dec0e3cc9de8bc560725">md_ctx</a>);</div>
<div class="line"><span class="lineno"> 2125</span>    op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#af6e088c2d57f2582d353bec69b48c023">sign</a>.<a class="code hl_variable" href="structsign__info.html#a575aca68f9e4dec0e3cc9de8bc560725">md_ctx</a> = NULL;</div>
<div class="line"><span class="lineno"> 2126</span> </div>
<div class="line"><span class="lineno"> 2127</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a3d854b6efad16a16e4d7b4539d4fc71f">ret</a> != 1) {</div>
<div class="line"><span class="lineno"> 2128</span>      <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a91150ecacbaa624fcc7d861f1b54f57c">CKR_FUNCTION_FAILED</a>;</div>
<div class="line"><span class="lineno"> 2129</span>    }</div>
<div class="line"><span class="lineno"> 2130</span>  }</div>
<div class="line"><span class="lineno"> 2131</span> </div>
<div class="line"><span class="lineno"> 2132</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="util__pkcs11_8c.html#a03746a942ba1eaafbec20b675463ee00">is_ECDSA_sign_mechanism</a>(op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a261664672f3ef63ab3a20b864627c49a">mechanism</a>.<a class="code hl_variable" href="structmechanism.html#afeb8198b0f33f94f4520c0ffbc584a9a">mechanism</a>)) {</div>
<div class="line"><span class="lineno"> 2133</span>    <span class="keywordflow">if</span> (op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ac226105a253c6fda70b44e14a525007a">buffer_length</a> &lt; op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#af6e088c2d57f2582d353bec69b48c023">sign</a>.<a class="code hl_variable" href="structsign__info.html#ae691c5b3f66d72902403622f40a5a94f">sig_len</a> / 2) {</div>
<div class="line"><span class="lineno"> 2134</span>      <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> padding =</div>
<div class="line"><span class="lineno"> 2135</span>        (op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#af6e088c2d57f2582d353bec69b48c023">sign</a>.<a class="code hl_variable" href="structsign__info.html#ae691c5b3f66d72902403622f40a5a94f">sig_len</a> / 2) - op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ac226105a253c6fda70b44e14a525007a">buffer_length</a>;</div>
<div class="line"><span class="lineno"> 2136</span>      memmove(op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ad4fd174ba5f77aad7e1f1c66079529ba">buffer</a> + padding, op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ad4fd174ba5f77aad7e1f1c66079529ba">buffer</a>,</div>
<div class="line"><span class="lineno"> 2137</span>              op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ac226105a253c6fda70b44e14a525007a">buffer_length</a>);</div>
<div class="line"><span class="lineno"> 2138</span>      <a class="code hl_function" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105">memset</a>(op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ad4fd174ba5f77aad7e1f1c66079529ba">buffer</a>, 0, padding);</div>
<div class="line"><span class="lineno"> 2139</span>      op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ac226105a253c6fda70b44e14a525007a">buffer_length</a> += padding;</div>
<div class="line"><span class="lineno"> 2140</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ac226105a253c6fda70b44e14a525007a">buffer_length</a> &gt; op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#af6e088c2d57f2582d353bec69b48c023">sign</a>.<a class="code hl_variable" href="structsign__info.html#ae691c5b3f66d72902403622f40a5a94f">sig_len</a> / 2) {</div>
<div class="line"><span class="lineno"> 2141</span>      op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ac226105a253c6fda70b44e14a525007a">buffer_length</a> = op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#af6e088c2d57f2582d353bec69b48c023">sign</a>.<a class="code hl_variable" href="structsign__info.html#ae691c5b3f66d72902403622f40a5a94f">sig_len</a> / 2;</div>
<div class="line"><span class="lineno"> 2142</span>    }</div>
<div class="line"><span class="lineno"> 2143</span>  }</div>
<div class="line"><span class="lineno"> 2144</span> </div>
<div class="line"><span class="lineno"> 2145</span>  <span class="comment">// TODO(adma): check if more steps are need for PSS or ECDSA</span></div>
<div class="line"><span class="lineno"> 2146</span> </div>
<div class="line"><span class="lineno"> 2147</span>  <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>;</div>
<div class="line"><span class="lineno"> 2148</span>}</div>
<div class="ttc" id="astdint_8h_html_a273cf69d639a59973b6019625df33e30"><div class="ttname"><a href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a></div><div class="ttdeci">unsigned short uint16_t</div><div class="ttdef"><b>Definition</b> <a href="stdint_8h_source.html#l00125">stdint.h:125</a></div></div>
<div class="ttc" id="astructsign__info_html_a575aca68f9e4dec0e3cc9de8bc560725"><div class="ttname"><a href="structsign__info.html#a575aca68f9e4dec0e3cc9de8bc560725">sign_info::md_ctx</a></div><div class="ttdeci">EVP_MD_CTX * md_ctx</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8h_source.html#l00066">yubihsm_pkcs11.h:66</a></div></div>
<div class="ttc" id="astructsign__info_html_ae691c5b3f66d72902403622f40a5a94f"><div class="ttname"><a href="structsign__info.html#ae691c5b3f66d72902403622f40a5a94f">sign_info::sig_len</a></div><div class="ttdeci">uint16_t sig_len</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8h_source.html#l00069">yubihsm_pkcs11.h:69</a></div></div>
<div class="ttc" id="aunionop_html_af6e088c2d57f2582d353bec69b48c023"><div class="ttname"><a href="unionop.html#af6e088c2d57f2582d353bec69b48c023">op::sign</a></div><div class="ttdeci">sign_info sign</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8h_source.html#l00100">yubihsm_pkcs11.h:100</a></div></div>
<div class="ttc" id="autil__pkcs11_8c_html_a03746a942ba1eaafbec20b675463ee00"><div class="ttname"><a href="util__pkcs11_8c.html#a03746a942ba1eaafbec20b675463ee00">is_ECDSA_sign_mechanism</a></div><div class="ttdeci">bool is_ECDSA_sign_mechanism(CK_MECHANISM_TYPE m)</div><div class="ttdef"><b>Definition</b> <a href="util__pkcs11_8c_source.html#l02690">util_pkcs11.c:2690</a></div></div>
<div class="ttc" id="autil__pkcs11_8c_html_a3f1010425d5308dfa15d696b4853c68c"><div class="ttname"><a href="util__pkcs11_8c.html#a3f1010425d5308dfa15d696b4853c68c">is_hashed_mechanism</a></div><div class="ttdeci">bool is_hashed_mechanism(CK_MECHANISM_TYPE m)</div><div class="ttdef"><b>Definition</b> <a href="util__pkcs11_8c_source.html#l02645">util_pkcs11.c:2645</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util__pkcs11_8h_a785bd4bd444e619e6e5e12b2e392f086_cgraph.png" border="0" usemap="#autil__pkcs11_8h_a785bd4bd444e619e6e5e12b2e392f086_cgraph" alt=""/></div>
<map name="autil__pkcs11_8h_a785bd4bd444e619e6e5e12b2e392f086_cgraph" id="autil__pkcs11_8h_a785bd4bd444e619e6e5e12b2e392f086_cgraph">
<area shape="rect" title=" " alt="" coords="5,72,163,113"/>
<area shape="rect" href="util__pkcs11_8c.html#a03746a942ba1eaafbec20b675463ee00" title=" " alt="" coords="211,5,401,31"/>
<area shape="poly" title=" " alt="" coords="131,70,210,40,232,33,234,38,212,45,133,75"/>
<area shape="rect" href="util__pkcs11_8c.html#a3f1010425d5308dfa15d696b4853c68c" title=" " alt="" coords="229,55,383,80"/>
<area shape="poly" title=" " alt="" coords="163,81,213,75,214,81,164,86"/>
<area shape="rect" href="structmechanism.html#afeb8198b0f33f94f4520c0ffbc584a9a" title=" " alt="" coords="224,104,388,130"/>
<area shape="poly" title=" " alt="" coords="164,99,209,104,208,109,163,104"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="272,153,340,179"/>
<area shape="poly" title=" " alt="" coords="135,111,211,140,257,153,256,158,210,145,133,116"/>
</map>
</div>

</div>
</div>
<a id="ace7396cb0c7b79d711f41031943387aa" name="ace7396cb0c7b79d711f41031943387aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace7396cb0c7b79d711f41031943387aa">&#9670;&#160;</a></span>apply_sign_mechanism_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CK_RV apply_sign_mechanism_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__pkcs11__op__info.html">yubihsm_pkcs11_op_info</a> *</td>          <td class="paramname"><span class="paramname"><em>op_info</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="util__pkcs11_8c_source.html#l01763">1763</a> of file <a class="el" href="util__pkcs11_8c_source.html">util_pkcs11.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1763</span>                                                                 {</div>
<div class="line"><span class="lineno"> 1764</span> </div>
<div class="line"><span class="lineno"> 1765</span>  <span class="keyword">const</span> EVP_MD *md = NULL;</div>
<div class="line"><span class="lineno"> 1766</span> </div>
<div class="line"><span class="lineno"> 1767</span>  op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ac226105a253c6fda70b44e14a525007a">buffer_length</a> = 0;</div>
<div class="line"><span class="lineno"> 1768</span> </div>
<div class="line"><span class="lineno"> 1769</span>  <span class="keywordflow">switch</span> (op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a261664672f3ef63ab3a20b864627c49a">mechanism</a>.<a class="code hl_variable" href="structmechanism.html#afeb8198b0f33f94f4520c0ffbc584a9a">mechanism</a>) {</div>
<div class="line"><span class="lineno"> 1770</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a08a8e0f2109de3ff3bfe26f220447a2e">CKM_RSA_PKCS</a>:</div>
<div class="line"><span class="lineno"> 1771</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ad4f5697408b23623c904df2b1ca8a9f1">CKM_RSA_PKCS_PSS</a>:</div>
<div class="line"><span class="lineno"> 1772</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ab4a7299a144f0ef52cee06893cc60483">CKM_ECDSA</a>:</div>
<div class="line"><span class="lineno"> 1773</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a1eb3f4cee46e624bfbbc6889e1e5bc06">CKM_SHA_1_HMAC</a>:</div>
<div class="line"><span class="lineno"> 1774</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a839f51ab9e78e866f1d3773b8466b011">CKM_SHA256_HMAC</a>:</div>
<div class="line"><span class="lineno"> 1775</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a97ee18b73f21e8047fadc8a0aa12f23a">CKM_SHA384_HMAC</a>:</div>
<div class="line"><span class="lineno"> 1776</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ae1b850f9141aa407e45b02fa3ade3759">CKM_SHA512_HMAC</a>:</div>
<div class="line"><span class="lineno"> 1777</span>      <span class="comment">// NOTE(adma): no hash required for these mechanisms</span></div>
<div class="line"><span class="lineno"> 1778</span>      op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#af6e088c2d57f2582d353bec69b48c023">sign</a>.<a class="code hl_variable" href="structsign__info.html#a575aca68f9e4dec0e3cc9de8bc560725">md_ctx</a> = NULL;</div>
<div class="line"><span class="lineno"> 1779</span>      <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>;</div>
<div class="line"><span class="lineno"> 1780</span> </div>
<div class="line"><span class="lineno"> 1781</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a9b5d495ac404ebbce07d1f58436ee31d">CKM_SHA1_RSA_PKCS</a>:</div>
<div class="line"><span class="lineno"> 1782</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ad5943f11b67c32a40d4d6687e9cbb64b">CKM_SHA1_RSA_PKCS_PSS</a>:</div>
<div class="line"><span class="lineno"> 1783</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a0911727b2cd926b9209f24bf50bc555a">CKM_ECDSA_SHA1</a>:</div>
<div class="line"><span class="lineno"> 1784</span>      md = EVP_sha1();</div>
<div class="line"><span class="lineno"> 1785</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1786</span> </div>
<div class="line"><span class="lineno"> 1787</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ae24525658e8df0829c24236ee7614d1f">CKM_SHA256_RSA_PKCS</a>:</div>
<div class="line"><span class="lineno"> 1788</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ad336fbe2d222fc913c70dd56fabf7f7e">CKM_SHA256_RSA_PKCS_PSS</a>:</div>
<div class="line"><span class="lineno"> 1789</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ac7f12f2ee83f0ca3b309b22e5b48e486">CKM_ECDSA_SHA256</a>:</div>
<div class="line"><span class="lineno"> 1790</span>      md = EVP_sha256();</div>
<div class="line"><span class="lineno"> 1791</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1792</span> </div>
<div class="line"><span class="lineno"> 1793</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ad8d3d34082b7e18f4f173804cf5b959b">CKM_SHA384_RSA_PKCS</a>:</div>
<div class="line"><span class="lineno"> 1794</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ae5a8bfa905dc8dab5b2130a8bb6b23fb">CKM_SHA384_RSA_PKCS_PSS</a>:</div>
<div class="line"><span class="lineno"> 1795</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ab4aaed0f4b4146b812c6cff25828fcfd">CKM_ECDSA_SHA384</a>:</div>
<div class="line"><span class="lineno"> 1796</span>      md = EVP_sha384();</div>
<div class="line"><span class="lineno"> 1797</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1798</span> </div>
<div class="line"><span class="lineno"> 1799</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a6c0c89dfd22474095772f87d25c6a17d">CKM_SHA512_RSA_PKCS</a>:</div>
<div class="line"><span class="lineno"> 1800</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a67393bc84515cf68048ca3b3bb8b39a0">CKM_SHA512_RSA_PKCS_PSS</a>:</div>
<div class="line"><span class="lineno"> 1801</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a69a7674eee1a8069128923037b504e59">CKM_ECDSA_SHA512</a>:</div>
<div class="line"><span class="lineno"> 1802</span>      md = EVP_sha512();</div>
<div class="line"><span class="lineno"> 1803</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1804</span> </div>
<div class="line"><span class="lineno"> 1805</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 1806</span>      <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Mechanism %lu not supported&quot;</span>, op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a261664672f3ef63ab3a20b864627c49a">mechanism</a>.<a class="code hl_variable" href="structmechanism.html#afeb8198b0f33f94f4520c0ffbc584a9a">mechanism</a>);</div>
<div class="line"><span class="lineno"> 1807</span>      <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a0664e99597a479c7fce5b19411cfc1b1">CKR_MECHANISM_INVALID</a>;</div>
<div class="line"><span class="lineno"> 1808</span>  }</div>
<div class="line"><span class="lineno"> 1809</span> </div>
<div class="line"><span class="lineno"> 1810</span>  op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#af6e088c2d57f2582d353bec69b48c023">sign</a>.<a class="code hl_variable" href="structsign__info.html#a575aca68f9e4dec0e3cc9de8bc560725">md_ctx</a> = EVP_MD_CTX_create();</div>
<div class="line"><span class="lineno"> 1811</span> </div>
<div class="line"><span class="lineno"> 1812</span>  <span class="keywordflow">if</span> (EVP_DigestInit_ex(op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#af6e088c2d57f2582d353bec69b48c023">sign</a>.<a class="code hl_variable" href="structsign__info.html#a575aca68f9e4dec0e3cc9de8bc560725">md_ctx</a>, md, NULL) == 0) {</div>
<div class="line"><span class="lineno"> 1813</span>    EVP_MD_CTX_destroy(op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#af6e088c2d57f2582d353bec69b48c023">sign</a>.<a class="code hl_variable" href="structsign__info.html#a575aca68f9e4dec0e3cc9de8bc560725">md_ctx</a>);</div>
<div class="line"><span class="lineno"> 1814</span>    op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#af6e088c2d57f2582d353bec69b48c023">sign</a>.<a class="code hl_variable" href="structsign__info.html#a575aca68f9e4dec0e3cc9de8bc560725">md_ctx</a> = NULL;</div>
<div class="line"><span class="lineno"> 1815</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a91150ecacbaa624fcc7d861f1b54f57c">CKR_FUNCTION_FAILED</a>;</div>
<div class="line"><span class="lineno"> 1816</span>  }</div>
<div class="line"><span class="lineno"> 1817</span> </div>
<div class="line"><span class="lineno"> 1818</span>  <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>;</div>
<div class="line"><span class="lineno"> 1819</span>}</div>
<div class="ttc" id="apkcs11_8h_html_a0911727b2cd926b9209f24bf50bc555a"><div class="ttname"><a href="pkcs11_8h.html#a0911727b2cd926b9209f24bf50bc555a">CKM_ECDSA_SHA1</a></div><div class="ttdeci">#define CKM_ECDSA_SHA1</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00647">pkcs11.h:647</a></div></div>
<div class="ttc" id="apkcs11_8h_html_a1eb3f4cee46e624bfbbc6889e1e5bc06"><div class="ttname"><a href="pkcs11_8h.html#a1eb3f4cee46e624bfbbc6889e1e5bc06">CKM_SHA_1_HMAC</a></div><div class="ttdeci">#define CKM_SHA_1_HMAC</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00533">pkcs11.h:533</a></div></div>
<div class="ttc" id="apkcs11_8h_html_a67393bc84515cf68048ca3b3bb8b39a0"><div class="ttname"><a href="pkcs11_8h.html#a67393bc84515cf68048ca3b3bb8b39a0">CKM_SHA512_RSA_PKCS_PSS</a></div><div class="ttdeci">#define CKM_SHA512_RSA_PKCS_PSS</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00498">pkcs11.h:498</a></div></div>
<div class="ttc" id="apkcs11_8h_html_a69a7674eee1a8069128923037b504e59"><div class="ttname"><a href="pkcs11_8h.html#a69a7674eee1a8069128923037b504e59">CKM_ECDSA_SHA512</a></div><div class="ttdeci">#define CKM_ECDSA_SHA512</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00651">pkcs11.h:651</a></div></div>
<div class="ttc" id="apkcs11_8h_html_a6c0c89dfd22474095772f87d25c6a17d"><div class="ttname"><a href="pkcs11_8h.html#a6c0c89dfd22474095772f87d25c6a17d">CKM_SHA512_RSA_PKCS</a></div><div class="ttdeci">#define CKM_SHA512_RSA_PKCS</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00495">pkcs11.h:495</a></div></div>
<div class="ttc" id="apkcs11_8h_html_a839f51ab9e78e866f1d3773b8466b011"><div class="ttname"><a href="pkcs11_8h.html#a839f51ab9e78e866f1d3773b8466b011">CKM_SHA256_HMAC</a></div><div class="ttdeci">#define CKM_SHA256_HMAC</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00542">pkcs11.h:542</a></div></div>
<div class="ttc" id="apkcs11_8h_html_a97ee18b73f21e8047fadc8a0aa12f23a"><div class="ttname"><a href="pkcs11_8h.html#a97ee18b73f21e8047fadc8a0aa12f23a">CKM_SHA384_HMAC</a></div><div class="ttdeci">#define CKM_SHA384_HMAC</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00545">pkcs11.h:545</a></div></div>
<div class="ttc" id="apkcs11_8h_html_a9b5d495ac404ebbce07d1f58436ee31d"><div class="ttname"><a href="pkcs11_8h.html#a9b5d495ac404ebbce07d1f58436ee31d">CKM_SHA1_RSA_PKCS</a></div><div class="ttdeci">#define CKM_SHA1_RSA_PKCS</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00475">pkcs11.h:475</a></div></div>
<div class="ttc" id="apkcs11_8h_html_ab4a7299a144f0ef52cee06893cc60483"><div class="ttname"><a href="pkcs11_8h.html#ab4a7299a144f0ef52cee06893cc60483">CKM_ECDSA</a></div><div class="ttdeci">#define CKM_ECDSA</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00646">pkcs11.h:646</a></div></div>
<div class="ttc" id="apkcs11_8h_html_ab4aaed0f4b4146b812c6cff25828fcfd"><div class="ttname"><a href="pkcs11_8h.html#ab4aaed0f4b4146b812c6cff25828fcfd">CKM_ECDSA_SHA384</a></div><div class="ttdeci">#define CKM_ECDSA_SHA384</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00650">pkcs11.h:650</a></div></div>
<div class="ttc" id="apkcs11_8h_html_ac7f12f2ee83f0ca3b309b22e5b48e486"><div class="ttname"><a href="pkcs11_8h.html#ac7f12f2ee83f0ca3b309b22e5b48e486">CKM_ECDSA_SHA256</a></div><div class="ttdeci">#define CKM_ECDSA_SHA256</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00649">pkcs11.h:649</a></div></div>
<div class="ttc" id="apkcs11_8h_html_ad336fbe2d222fc913c70dd56fabf7f7e"><div class="ttname"><a href="pkcs11_8h.html#ad336fbe2d222fc913c70dd56fabf7f7e">CKM_SHA256_RSA_PKCS_PSS</a></div><div class="ttdeci">#define CKM_SHA256_RSA_PKCS_PSS</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00496">pkcs11.h:496</a></div></div>
<div class="ttc" id="apkcs11_8h_html_ad4f5697408b23623c904df2b1ca8a9f1"><div class="ttname"><a href="pkcs11_8h.html#ad4f5697408b23623c904df2b1ca8a9f1">CKM_RSA_PKCS_PSS</a></div><div class="ttdeci">#define CKM_RSA_PKCS_PSS</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00482">pkcs11.h:482</a></div></div>
<div class="ttc" id="apkcs11_8h_html_ad5943f11b67c32a40d4d6687e9cbb64b"><div class="ttname"><a href="pkcs11_8h.html#ad5943f11b67c32a40d4d6687e9cbb64b">CKM_SHA1_RSA_PKCS_PSS</a></div><div class="ttdeci">#define CKM_SHA1_RSA_PKCS_PSS</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00483">pkcs11.h:483</a></div></div>
<div class="ttc" id="apkcs11_8h_html_ad8d3d34082b7e18f4f173804cf5b959b"><div class="ttname"><a href="pkcs11_8h.html#ad8d3d34082b7e18f4f173804cf5b959b">CKM_SHA384_RSA_PKCS</a></div><div class="ttdeci">#define CKM_SHA384_RSA_PKCS</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00494">pkcs11.h:494</a></div></div>
<div class="ttc" id="apkcs11_8h_html_ae1b850f9141aa407e45b02fa3ade3759"><div class="ttname"><a href="pkcs11_8h.html#ae1b850f9141aa407e45b02fa3ade3759">CKM_SHA512_HMAC</a></div><div class="ttdeci">#define CKM_SHA512_HMAC</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00548">pkcs11.h:548</a></div></div>
<div class="ttc" id="apkcs11_8h_html_ae24525658e8df0829c24236ee7614d1f"><div class="ttname"><a href="pkcs11_8h.html#ae24525658e8df0829c24236ee7614d1f">CKM_SHA256_RSA_PKCS</a></div><div class="ttdeci">#define CKM_SHA256_RSA_PKCS</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00493">pkcs11.h:493</a></div></div>
<div class="ttc" id="apkcs11_8h_html_ae5a8bfa905dc8dab5b2130a8bb6b23fb"><div class="ttname"><a href="pkcs11_8h.html#ae5a8bfa905dc8dab5b2130a8bb6b23fb">CKM_SHA384_RSA_PKCS_PSS</a></div><div class="ttdeci">#define CKM_SHA384_RSA_PKCS_PSS</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00497">pkcs11.h:497</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util__pkcs11_8h_ace7396cb0c7b79d711f41031943387aa_cgraph.png" border="0" usemap="#autil__pkcs11_8h_ace7396cb0c7b79d711f41031943387aa_cgraph" alt=""/></div>
<map name="autil__pkcs11_8h_ace7396cb0c7b79d711f41031943387aa_cgraph" id="autil__pkcs11_8h_ace7396cb0c7b79d711f41031943387aa_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,187,31"/>
<area shape="rect" href="structmechanism.html#afeb8198b0f33f94f4520c0ffbc584a9a" title=" " alt="" coords="235,5,398,31"/>
<area shape="poly" title=" " alt="" coords="187,16,219,16,219,21,187,21"/>
</map>
</div>

</div>
</div>
<a id="a7f8862404103da790412c45be35b0087" name="a7f8862404103da790412c45be35b0087"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f8862404103da790412c45be35b0087">&#9670;&#160;</a></span>apply_sign_mechanism_update()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CK_RV apply_sign_mechanism_update </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__pkcs11__op__info.html">yubihsm_pkcs11_op_info</a> *</td>          <td class="paramname"><span class="paramname"><em>op_info</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pkcs11_8h.html#a7bc6919a7c3c372056fa7e18343a0b37">CK_BYTE_PTR</a></td>          <td class="paramname"><span class="paramname"><em>in</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pkcs11_8h.html#a35181858a3b7a0a81f49d180d8f446ef">CK_ULONG</a></td>          <td class="paramname"><span class="paramname"><em>in_len</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="util__pkcs11_8c_source.html#l01943">1943</a> of file <a class="el" href="util__pkcs11_8c_source.html">util_pkcs11.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1944</span>                                                                   {</div>
<div class="line"><span class="lineno"> 1945</span> </div>
<div class="line"><span class="lineno"> 1946</span>  <span class="keywordflow">switch</span> (op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a261664672f3ef63ab3a20b864627c49a">mechanism</a>.<a class="code hl_variable" href="structmechanism.html#afeb8198b0f33f94f4520c0ffbc584a9a">mechanism</a>) {</div>
<div class="line"><span class="lineno"> 1947</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a08a8e0f2109de3ff3bfe26f220447a2e">CKM_RSA_PKCS</a>:</div>
<div class="line"><span class="lineno"> 1948</span>      <span class="comment">// NOTE(adma): Specs say there should be enough space for PKCS#1 padding</span></div>
<div class="line"><span class="lineno"> 1949</span>      <span class="keywordflow">if</span> (op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ac226105a253c6fda70b44e14a525007a">buffer_length</a> + <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a> &gt;</div>
<div class="line"><span class="lineno"> 1950</span>          (op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#af6e088c2d57f2582d353bec69b48c023">sign</a>.<a class="code hl_variable" href="structsign__info.html#afd7db6cf92f86b7cf17daf9eb3bcb8fc">key_len</a> + 7) / 8 - 11) {</div>
<div class="line"><span class="lineno"> 1951</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a9a521148fda788ca98f4fdbb6d3b9438">CKR_DATA_LEN_RANGE</a>;</div>
<div class="line"><span class="lineno"> 1952</span>      }</div>
<div class="line"><span class="lineno"> 1953</span> </div>
<div class="line"><span class="lineno"> 1954</span>      <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ad4fd174ba5f77aad7e1f1c66079529ba">buffer</a> + op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ac226105a253c6fda70b44e14a525007a">buffer_length</a>, in, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a>);</div>
<div class="line"><span class="lineno"> 1955</span>      op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ac226105a253c6fda70b44e14a525007a">buffer_length</a> += <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a>;</div>
<div class="line"><span class="lineno"> 1956</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1957</span> </div>
<div class="line"><span class="lineno"> 1958</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ab4a7299a144f0ef52cee06893cc60483">CKM_ECDSA</a>:</div>
<div class="line"><span class="lineno"> 1959</span>      <span class="keywordflow">if</span> (op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ac226105a253c6fda70b44e14a525007a">buffer_length</a> + <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a> &gt; 128) {</div>
<div class="line"><span class="lineno"> 1960</span>        <span class="comment">// NOTE(adma): Specs say ECDSA only supports data up to 1024 bit</span></div>
<div class="line"><span class="lineno"> 1961</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a9a521148fda788ca98f4fdbb6d3b9438">CKR_DATA_LEN_RANGE</a>;</div>
<div class="line"><span class="lineno"> 1962</span>      }</div>
<div class="line"><span class="lineno"> 1963</span> </div>
<div class="line"><span class="lineno"> 1964</span>      <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ad4fd174ba5f77aad7e1f1c66079529ba">buffer</a> + op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ac226105a253c6fda70b44e14a525007a">buffer_length</a>, in, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a>);</div>
<div class="line"><span class="lineno"> 1965</span>      op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ac226105a253c6fda70b44e14a525007a">buffer_length</a> += <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a>;</div>
<div class="line"><span class="lineno"> 1966</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1967</span> </div>
<div class="line"><span class="lineno"> 1968</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ad4f5697408b23623c904df2b1ca8a9f1">CKM_RSA_PKCS_PSS</a>:</div>
<div class="line"><span class="lineno"> 1969</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a1eb3f4cee46e624bfbbc6889e1e5bc06">CKM_SHA_1_HMAC</a>:</div>
<div class="line"><span class="lineno"> 1970</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a839f51ab9e78e866f1d3773b8466b011">CKM_SHA256_HMAC</a>:</div>
<div class="line"><span class="lineno"> 1971</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a97ee18b73f21e8047fadc8a0aa12f23a">CKM_SHA384_HMAC</a>:</div>
<div class="line"><span class="lineno"> 1972</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ae1b850f9141aa407e45b02fa3ade3759">CKM_SHA512_HMAC</a>:</div>
<div class="line"><span class="lineno"> 1973</span>      <span class="keywordflow">if</span> (op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ac226105a253c6fda70b44e14a525007a">buffer_length</a> + <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a> &gt; <span class="keyword">sizeof</span>(op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ad4fd174ba5f77aad7e1f1c66079529ba">buffer</a>)) {</div>
<div class="line"><span class="lineno"> 1974</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a9a521148fda788ca98f4fdbb6d3b9438">CKR_DATA_LEN_RANGE</a>;</div>
<div class="line"><span class="lineno"> 1975</span>      }</div>
<div class="line"><span class="lineno"> 1976</span> </div>
<div class="line"><span class="lineno"> 1977</span>      <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ad4fd174ba5f77aad7e1f1c66079529ba">buffer</a> + op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ac226105a253c6fda70b44e14a525007a">buffer_length</a>, in, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a>);</div>
<div class="line"><span class="lineno"> 1978</span>      op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ac226105a253c6fda70b44e14a525007a">buffer_length</a> += <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a>;</div>
<div class="line"><span class="lineno"> 1979</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1980</span> </div>
<div class="line"><span class="lineno"> 1981</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a9b5d495ac404ebbce07d1f58436ee31d">CKM_SHA1_RSA_PKCS</a>:</div>
<div class="line"><span class="lineno"> 1982</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ae24525658e8df0829c24236ee7614d1f">CKM_SHA256_RSA_PKCS</a>:</div>
<div class="line"><span class="lineno"> 1983</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ad8d3d34082b7e18f4f173804cf5b959b">CKM_SHA384_RSA_PKCS</a>:</div>
<div class="line"><span class="lineno"> 1984</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a6c0c89dfd22474095772f87d25c6a17d">CKM_SHA512_RSA_PKCS</a>:</div>
<div class="line"><span class="lineno"> 1985</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ad5943f11b67c32a40d4d6687e9cbb64b">CKM_SHA1_RSA_PKCS_PSS</a>:</div>
<div class="line"><span class="lineno"> 1986</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ad336fbe2d222fc913c70dd56fabf7f7e">CKM_SHA256_RSA_PKCS_PSS</a>:</div>
<div class="line"><span class="lineno"> 1987</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ae5a8bfa905dc8dab5b2130a8bb6b23fb">CKM_SHA384_RSA_PKCS_PSS</a>:</div>
<div class="line"><span class="lineno"> 1988</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a67393bc84515cf68048ca3b3bb8b39a0">CKM_SHA512_RSA_PKCS_PSS</a>:</div>
<div class="line"><span class="lineno"> 1989</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a0911727b2cd926b9209f24bf50bc555a">CKM_ECDSA_SHA1</a>:</div>
<div class="line"><span class="lineno"> 1990</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ac7f12f2ee83f0ca3b309b22e5b48e486">CKM_ECDSA_SHA256</a>:</div>
<div class="line"><span class="lineno"> 1991</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ab4aaed0f4b4146b812c6cff25828fcfd">CKM_ECDSA_SHA384</a>:</div>
<div class="line"><span class="lineno"> 1992</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a69a7674eee1a8069128923037b504e59">CKM_ECDSA_SHA512</a>:</div>
<div class="line"><span class="lineno"> 1993</span>      <span class="keywordflow">if</span> (EVP_DigestUpdate(op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#af6e088c2d57f2582d353bec69b48c023">sign</a>.<a class="code hl_variable" href="structsign__info.html#a575aca68f9e4dec0e3cc9de8bc560725">md_ctx</a>, in, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a>) != 1) {</div>
<div class="line"><span class="lineno"> 1994</span>        EVP_MD_CTX_destroy(op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#af6e088c2d57f2582d353bec69b48c023">sign</a>.<a class="code hl_variable" href="structsign__info.html#a575aca68f9e4dec0e3cc9de8bc560725">md_ctx</a>);</div>
<div class="line"><span class="lineno"> 1995</span>        op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#af6e088c2d57f2582d353bec69b48c023">sign</a>.<a class="code hl_variable" href="structsign__info.html#a575aca68f9e4dec0e3cc9de8bc560725">md_ctx</a> = NULL;</div>
<div class="line"><span class="lineno"> 1996</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a91150ecacbaa624fcc7d861f1b54f57c">CKR_FUNCTION_FAILED</a>;</div>
<div class="line"><span class="lineno"> 1997</span>      }</div>
<div class="line"><span class="lineno"> 1998</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1999</span> </div>
<div class="line"><span class="lineno"> 2000</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 2001</span>      <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a91150ecacbaa624fcc7d861f1b54f57c">CKR_FUNCTION_FAILED</a>;</div>
<div class="line"><span class="lineno"> 2002</span>  }</div>
<div class="line"><span class="lineno"> 2003</span> </div>
<div class="line"><span class="lineno"> 2004</span>  <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>;</div>
<div class="line"><span class="lineno"> 2005</span>}</div>
<div class="ttc" id="astructsign__info_html_afd7db6cf92f86b7cf17daf9eb3bcb8fc"><div class="ttname"><a href="structsign__info.html#afd7db6cf92f86b7cf17daf9eb3bcb8fc">sign_info::key_len</a></div><div class="ttdeci">CK_ULONG key_len</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8h_source.html#l00068">yubihsm_pkcs11.h:68</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util__pkcs11_8h_a7f8862404103da790412c45be35b0087_cgraph.png" border="0" usemap="#autil__pkcs11_8h_a7f8862404103da790412c45be35b0087_cgraph" alt=""/></div>
<map name="autil__pkcs11_8h_a7f8862404103da790412c45be35b0087_cgraph" id="autil__pkcs11_8h_a7f8862404103da790412c45be35b0087_cgraph">
<area shape="rect" title=" " alt="" coords="5,23,163,64"/>
<area shape="rect" href="structmechanism.html#afeb8198b0f33f94f4520c0ffbc584a9a" title=" " alt="" coords="211,5,374,31"/>
<area shape="poly" title=" " alt="" coords="163,31,195,27,195,33,163,37"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="257,55,328,80"/>
<area shape="poly" title=" " alt="" coords="163,50,242,59,241,64,163,55"/>
</map>
</div>

</div>
</div>
<a id="a8a551420defe2efb18caf9ce9239e630" name="a8a551420defe2efb18caf9ce9239e630"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a551420defe2efb18caf9ce9239e630">&#9670;&#160;</a></span>apply_verify_mechanism_finalize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CK_RV apply_verify_mechanism_finalize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__pkcs11__op__info.html">yubihsm_pkcs11_op_info</a> *</td>          <td class="paramname"><span class="paramname"><em>op_info</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a2e8c2b6402f7944b9684ad16a8ab7f66" name="a2e8c2b6402f7944b9684ad16a8ab7f66"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e8c2b6402f7944b9684ad16a8ab7f66">&#9670;&#160;</a></span>apply_verify_mechanism_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CK_RV apply_verify_mechanism_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__pkcs11__op__info.html">yubihsm_pkcs11_op_info</a> *</td>          <td class="paramname"><span class="paramname"><em>op_info</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="util__pkcs11_8c_source.html#l01821">1821</a> of file <a class="el" href="util__pkcs11_8c_source.html">util_pkcs11.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1821</span>                                                                   {</div>
<div class="line"><span class="lineno"> 1822</span> </div>
<div class="line"><span class="lineno"> 1823</span>  <span class="keyword">const</span> EVP_MD *md = NULL;</div>
<div class="line"><span class="lineno"> 1824</span> </div>
<div class="line"><span class="lineno"> 1825</span>  op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ac226105a253c6fda70b44e14a525007a">buffer_length</a> = 0;</div>
<div class="line"><span class="lineno"> 1826</span>  op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#a769d855aca7e13b69c58abd1de1bb410">verify</a>.<a class="code hl_variable" href="structverify__info.html#a69841d9be2ea9074f4a8dd3972c532cf">padding</a> = 0;</div>
<div class="line"><span class="lineno"> 1827</span>  op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#a769d855aca7e13b69c58abd1de1bb410">verify</a>.<a class="code hl_variable" href="structverify__info.html#a8e050dd7549467897d666046c1754aaf">saltLen</a> = 0;</div>
<div class="line"><span class="lineno"> 1828</span>  op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#a769d855aca7e13b69c58abd1de1bb410">verify</a>.<a class="code hl_variable" href="structverify__info.html#ae1b2e1bec7e3c36d68558b61401cf5df">mgf1md</a> = NULL;</div>
<div class="line"><span class="lineno"> 1829</span>  op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#a769d855aca7e13b69c58abd1de1bb410">verify</a>.<a class="code hl_variable" href="structverify__info.html#a9547582fc2ac4625f9029f6d285bdb68">md</a> = NULL;</div>
<div class="line"><span class="lineno"> 1830</span>  op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#a769d855aca7e13b69c58abd1de1bb410">verify</a>.<a class="code hl_variable" href="structverify__info.html#a920d34cab9f1b9ddcaf849d5b08c921d">md_ctx</a> = NULL;</div>
<div class="line"><span class="lineno"> 1831</span> </div>
<div class="line"><span class="lineno"> 1832</span>  <span class="keywordflow">switch</span> (op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a261664672f3ef63ab3a20b864627c49a">mechanism</a>.<a class="code hl_variable" href="structmechanism.html#afeb8198b0f33f94f4520c0ffbc584a9a">mechanism</a>) {</div>
<div class="line"><span class="lineno"> 1833</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a08a8e0f2109de3ff3bfe26f220447a2e">CKM_RSA_PKCS</a>:</div>
<div class="line"><span class="lineno"> 1834</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ad4f5697408b23623c904df2b1ca8a9f1">CKM_RSA_PKCS_PSS</a>:</div>
<div class="line"><span class="lineno"> 1835</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ab4a7299a144f0ef52cee06893cc60483">CKM_ECDSA</a>:</div>
<div class="line"><span class="lineno"> 1836</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a1eb3f4cee46e624bfbbc6889e1e5bc06">CKM_SHA_1_HMAC</a>:</div>
<div class="line"><span class="lineno"> 1837</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a839f51ab9e78e866f1d3773b8466b011">CKM_SHA256_HMAC</a>:</div>
<div class="line"><span class="lineno"> 1838</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a97ee18b73f21e8047fadc8a0aa12f23a">CKM_SHA384_HMAC</a>:</div>
<div class="line"><span class="lineno"> 1839</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ae1b850f9141aa407e45b02fa3ade3759">CKM_SHA512_HMAC</a>:</div>
<div class="line"><span class="lineno"> 1840</span>      <span class="comment">// NOTE(adma): no hash required for these mechanisms</span></div>
<div class="line"><span class="lineno"> 1841</span>      <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>;</div>
<div class="line"><span class="lineno"> 1842</span> </div>
<div class="line"><span class="lineno"> 1843</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a9b5d495ac404ebbce07d1f58436ee31d">CKM_SHA1_RSA_PKCS</a>:</div>
<div class="line"><span class="lineno"> 1844</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ad5943f11b67c32a40d4d6687e9cbb64b">CKM_SHA1_RSA_PKCS_PSS</a>:</div>
<div class="line"><span class="lineno"> 1845</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a0911727b2cd926b9209f24bf50bc555a">CKM_ECDSA_SHA1</a>:</div>
<div class="line"><span class="lineno"> 1846</span>      md = EVP_sha1();</div>
<div class="line"><span class="lineno"> 1847</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1848</span> </div>
<div class="line"><span class="lineno"> 1849</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ae24525658e8df0829c24236ee7614d1f">CKM_SHA256_RSA_PKCS</a>:</div>
<div class="line"><span class="lineno"> 1850</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ad336fbe2d222fc913c70dd56fabf7f7e">CKM_SHA256_RSA_PKCS_PSS</a>:</div>
<div class="line"><span class="lineno"> 1851</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ac7f12f2ee83f0ca3b309b22e5b48e486">CKM_ECDSA_SHA256</a>:</div>
<div class="line"><span class="lineno"> 1852</span>      md = EVP_sha256();</div>
<div class="line"><span class="lineno"> 1853</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1854</span> </div>
<div class="line"><span class="lineno"> 1855</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ad8d3d34082b7e18f4f173804cf5b959b">CKM_SHA384_RSA_PKCS</a>:</div>
<div class="line"><span class="lineno"> 1856</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ae5a8bfa905dc8dab5b2130a8bb6b23fb">CKM_SHA384_RSA_PKCS_PSS</a>:</div>
<div class="line"><span class="lineno"> 1857</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ab4aaed0f4b4146b812c6cff25828fcfd">CKM_ECDSA_SHA384</a>:</div>
<div class="line"><span class="lineno"> 1858</span>      md = EVP_sha384();</div>
<div class="line"><span class="lineno"> 1859</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1860</span> </div>
<div class="line"><span class="lineno"> 1861</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a6c0c89dfd22474095772f87d25c6a17d">CKM_SHA512_RSA_PKCS</a>:</div>
<div class="line"><span class="lineno"> 1862</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a67393bc84515cf68048ca3b3bb8b39a0">CKM_SHA512_RSA_PKCS_PSS</a>:</div>
<div class="line"><span class="lineno"> 1863</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a69a7674eee1a8069128923037b504e59">CKM_ECDSA_SHA512</a>:</div>
<div class="line"><span class="lineno"> 1864</span>      md = EVP_sha512();</div>
<div class="line"><span class="lineno"> 1865</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1866</span> </div>
<div class="line"><span class="lineno"> 1867</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 1868</span>      <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Mechanism %lu not supported&quot;</span>, op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a261664672f3ef63ab3a20b864627c49a">mechanism</a>.<a class="code hl_variable" href="structmechanism.html#afeb8198b0f33f94f4520c0ffbc584a9a">mechanism</a>);</div>
<div class="line"><span class="lineno"> 1869</span>      <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a0664e99597a479c7fce5b19411cfc1b1">CKR_MECHANISM_INVALID</a>;</div>
<div class="line"><span class="lineno"> 1870</span>  }</div>
<div class="line"><span class="lineno"> 1871</span> </div>
<div class="line"><span class="lineno"> 1872</span>  op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#a769d855aca7e13b69c58abd1de1bb410">verify</a>.<a class="code hl_variable" href="structverify__info.html#a9547582fc2ac4625f9029f6d285bdb68">md</a> = md;</div>
<div class="line"><span class="lineno"> 1873</span>  op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#a769d855aca7e13b69c58abd1de1bb410">verify</a>.<a class="code hl_variable" href="structverify__info.html#a920d34cab9f1b9ddcaf849d5b08c921d">md_ctx</a> = EVP_MD_CTX_create();</div>
<div class="line"><span class="lineno"> 1874</span>  <span class="keywordflow">if</span> (op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#a769d855aca7e13b69c58abd1de1bb410">verify</a>.<a class="code hl_variable" href="structverify__info.html#a920d34cab9f1b9ddcaf849d5b08c921d">md_ctx</a> == NULL) {</div>
<div class="line"><span class="lineno"> 1875</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a91150ecacbaa624fcc7d861f1b54f57c">CKR_FUNCTION_FAILED</a>;</div>
<div class="line"><span class="lineno"> 1876</span>  }</div>
<div class="line"><span class="lineno"> 1877</span>  <span class="keywordflow">if</span> (EVP_DigestInit(op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#a769d855aca7e13b69c58abd1de1bb410">verify</a>.<a class="code hl_variable" href="structverify__info.html#a920d34cab9f1b9ddcaf849d5b08c921d">md_ctx</a>, md) == 0) {</div>
<div class="line"><span class="lineno"> 1878</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a91150ecacbaa624fcc7d861f1b54f57c">CKR_FUNCTION_FAILED</a>;</div>
<div class="line"><span class="lineno"> 1879</span>  }</div>
<div class="line"><span class="lineno"> 1880</span> </div>
<div class="line"><span class="lineno"> 1881</span>  <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>;</div>
<div class="line"><span class="lineno"> 1882</span>}</div>
<div class="ttc" id="astructverify__info_html_a69841d9be2ea9074f4a8dd3972c532cf"><div class="ttname"><a href="structverify__info.html#a69841d9be2ea9074f4a8dd3972c532cf">verify_info::padding</a></div><div class="ttdeci">int padding</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8h_source.html#l00091">yubihsm_pkcs11.h:91</a></div></div>
<div class="ttc" id="astructverify__info_html_a8e050dd7549467897d666046c1754aaf"><div class="ttname"><a href="structverify__info.html#a8e050dd7549467897d666046c1754aaf">verify_info::saltLen</a></div><div class="ttdeci">unsigned long saltLen</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8h_source.html#l00092">yubihsm_pkcs11.h:92</a></div></div>
<div class="ttc" id="astructverify__info_html_a920d34cab9f1b9ddcaf849d5b08c921d"><div class="ttname"><a href="structverify__info.html#a920d34cab9f1b9ddcaf849d5b08c921d">verify_info::md_ctx</a></div><div class="ttdeci">EVP_MD_CTX * md_ctx</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8h_source.html#l00089">yubihsm_pkcs11.h:89</a></div></div>
<div class="ttc" id="astructverify__info_html_a9547582fc2ac4625f9029f6d285bdb68"><div class="ttname"><a href="structverify__info.html#a9547582fc2ac4625f9029f6d285bdb68">verify_info::md</a></div><div class="ttdeci">const EVP_MD * md</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8h_source.html#l00090">yubihsm_pkcs11.h:90</a></div></div>
<div class="ttc" id="astructverify__info_html_ae1b2e1bec7e3c36d68558b61401cf5df"><div class="ttname"><a href="structverify__info.html#ae1b2e1bec7e3c36d68558b61401cf5df">verify_info::mgf1md</a></div><div class="ttdeci">const EVP_MD * mgf1md</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8h_source.html#l00093">yubihsm_pkcs11.h:93</a></div></div>
<div class="ttc" id="aunionop_html_a769d855aca7e13b69c58abd1de1bb410"><div class="ttname"><a href="unionop.html#a769d855aca7e13b69c58abd1de1bb410">op::verify</a></div><div class="ttdeci">verify_info verify</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8h_source.html#l00102">yubihsm_pkcs11.h:102</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util__pkcs11_8h_a2e8c2b6402f7944b9684ad16a8ab7f66_cgraph.png" border="0" usemap="#autil__pkcs11_8h_a2e8c2b6402f7944b9684ad16a8ab7f66_cgraph" alt=""/></div>
<map name="autil__pkcs11_8h_a2e8c2b6402f7944b9684ad16a8ab7f66_cgraph" id="autil__pkcs11_8h_a2e8c2b6402f7944b9684ad16a8ab7f66_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,195,31"/>
<area shape="rect" href="structmechanism.html#afeb8198b0f33f94f4520c0ffbc584a9a" title=" " alt="" coords="243,5,406,31"/>
<area shape="poly" title=" " alt="" coords="195,16,227,16,227,21,195,21"/>
</map>
</div>

</div>
</div>
<a id="ad4fbb6f5ecdd69ce7a332f613a89a9a7" name="ad4fbb6f5ecdd69ce7a332f613a89a9a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4fbb6f5ecdd69ce7a332f613a89a9a7">&#9670;&#160;</a></span>apply_verify_mechanism_update()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CK_RV apply_verify_mechanism_update </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__pkcs11__op__info.html">yubihsm_pkcs11_op_info</a> *</td>          <td class="paramname"><span class="paramname"><em>op_info</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pkcs11_8h.html#a7bc6919a7c3c372056fa7e18343a0b37">CK_BYTE_PTR</a></td>          <td class="paramname"><span class="paramname"><em>in</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pkcs11_8h.html#a35181858a3b7a0a81f49d180d8f446ef">CK_ULONG</a></td>          <td class="paramname"><span class="paramname"><em>in_len</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="util__pkcs11_8c_source.html#l02007">2007</a> of file <a class="el" href="util__pkcs11_8c_source.html">util_pkcs11.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2008</span>                                                                     {</div>
<div class="line"><span class="lineno"> 2009</span> </div>
<div class="line"><span class="lineno"> 2010</span>  <span class="keywordflow">switch</span> (op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a261664672f3ef63ab3a20b864627c49a">mechanism</a>.<a class="code hl_variable" href="structmechanism.html#afeb8198b0f33f94f4520c0ffbc584a9a">mechanism</a>) {</div>
<div class="line"><span class="lineno"> 2011</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a1eb3f4cee46e624bfbbc6889e1e5bc06">CKM_SHA_1_HMAC</a>:</div>
<div class="line"><span class="lineno"> 2012</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a839f51ab9e78e866f1d3773b8466b011">CKM_SHA256_HMAC</a>:</div>
<div class="line"><span class="lineno"> 2013</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a97ee18b73f21e8047fadc8a0aa12f23a">CKM_SHA384_HMAC</a>:</div>
<div class="line"><span class="lineno"> 2014</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ae1b850f9141aa407e45b02fa3ade3759">CKM_SHA512_HMAC</a>:</div>
<div class="line"><span class="lineno"> 2015</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a08a8e0f2109de3ff3bfe26f220447a2e">CKM_RSA_PKCS</a>:</div>
<div class="line"><span class="lineno"> 2016</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ad4f5697408b23623c904df2b1ca8a9f1">CKM_RSA_PKCS_PSS</a>:</div>
<div class="line"><span class="lineno"> 2017</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ab4a7299a144f0ef52cee06893cc60483">CKM_ECDSA</a>:</div>
<div class="line"><span class="lineno"> 2018</span>      <span class="comment">// NOTE(adma): no hash required for these mechanisms</span></div>
<div class="line"><span class="lineno"> 2019</span>      <span class="keywordflow">if</span> (op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ac226105a253c6fda70b44e14a525007a">buffer_length</a> + <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a> &gt; <span class="keyword">sizeof</span>(op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ad4fd174ba5f77aad7e1f1c66079529ba">buffer</a>)) {</div>
<div class="line"><span class="lineno"> 2020</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a9a521148fda788ca98f4fdbb6d3b9438">CKR_DATA_LEN_RANGE</a>;</div>
<div class="line"><span class="lineno"> 2021</span>      }</div>
<div class="line"><span class="lineno"> 2022</span> </div>
<div class="line"><span class="lineno"> 2023</span>      <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ad4fd174ba5f77aad7e1f1c66079529ba">buffer</a> + op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ac226105a253c6fda70b44e14a525007a">buffer_length</a>, in, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a>);</div>
<div class="line"><span class="lineno"> 2024</span>      op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ac226105a253c6fda70b44e14a525007a">buffer_length</a> += <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a>;</div>
<div class="line"><span class="lineno"> 2025</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2026</span> </div>
<div class="line"><span class="lineno"> 2027</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a9b5d495ac404ebbce07d1f58436ee31d">CKM_SHA1_RSA_PKCS</a>:</div>
<div class="line"><span class="lineno"> 2028</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ad5943f11b67c32a40d4d6687e9cbb64b">CKM_SHA1_RSA_PKCS_PSS</a>:</div>
<div class="line"><span class="lineno"> 2029</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a0911727b2cd926b9209f24bf50bc555a">CKM_ECDSA_SHA1</a>:</div>
<div class="line"><span class="lineno"> 2030</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ae24525658e8df0829c24236ee7614d1f">CKM_SHA256_RSA_PKCS</a>:</div>
<div class="line"><span class="lineno"> 2031</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ad336fbe2d222fc913c70dd56fabf7f7e">CKM_SHA256_RSA_PKCS_PSS</a>:</div>
<div class="line"><span class="lineno"> 2032</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ac7f12f2ee83f0ca3b309b22e5b48e486">CKM_ECDSA_SHA256</a>:</div>
<div class="line"><span class="lineno"> 2033</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ad8d3d34082b7e18f4f173804cf5b959b">CKM_SHA384_RSA_PKCS</a>:</div>
<div class="line"><span class="lineno"> 2034</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ae5a8bfa905dc8dab5b2130a8bb6b23fb">CKM_SHA384_RSA_PKCS_PSS</a>:</div>
<div class="line"><span class="lineno"> 2035</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ab4aaed0f4b4146b812c6cff25828fcfd">CKM_ECDSA_SHA384</a>:</div>
<div class="line"><span class="lineno"> 2036</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a6c0c89dfd22474095772f87d25c6a17d">CKM_SHA512_RSA_PKCS</a>:</div>
<div class="line"><span class="lineno"> 2037</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a67393bc84515cf68048ca3b3bb8b39a0">CKM_SHA512_RSA_PKCS_PSS</a>:</div>
<div class="line"><span class="lineno"> 2038</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a69a7674eee1a8069128923037b504e59">CKM_ECDSA_SHA512</a>:</div>
<div class="line"><span class="lineno"> 2039</span>      <span class="keywordflow">if</span> (EVP_DigestUpdate(op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#a769d855aca7e13b69c58abd1de1bb410">verify</a>.<a class="code hl_variable" href="structverify__info.html#a920d34cab9f1b9ddcaf849d5b08c921d">md_ctx</a>, in, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#af352138fec1245efdaee143f770c01ef">in_len</a>) != 1) {</div>
<div class="line"><span class="lineno"> 2040</span>        EVP_MD_CTX_destroy(op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#a769d855aca7e13b69c58abd1de1bb410">verify</a>.<a class="code hl_variable" href="structverify__info.html#a920d34cab9f1b9ddcaf849d5b08c921d">md_ctx</a>);</div>
<div class="line"><span class="lineno"> 2041</span>        op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#af6e088c2d57f2582d353bec69b48c023">sign</a>.<a class="code hl_variable" href="structsign__info.html#a575aca68f9e4dec0e3cc9de8bc560725">md_ctx</a> = NULL;</div>
<div class="line"><span class="lineno"> 2042</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a91150ecacbaa624fcc7d861f1b54f57c">CKR_FUNCTION_FAILED</a>;</div>
<div class="line"><span class="lineno"> 2043</span>      }</div>
<div class="line"><span class="lineno"> 2044</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2045</span> </div>
<div class="line"><span class="lineno"> 2046</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 2047</span>      <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a91150ecacbaa624fcc7d861f1b54f57c">CKR_FUNCTION_FAILED</a>;</div>
<div class="line"><span class="lineno"> 2048</span>  }</div>
<div class="line"><span class="lineno"> 2049</span> </div>
<div class="line"><span class="lineno"> 2050</span>  <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>;</div>
<div class="line"><span class="lineno"> 2051</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util__pkcs11_8h_ad4fbb6f5ecdd69ce7a332f613a89a9a7_cgraph.png" border="0" usemap="#autil__pkcs11_8h_ad4fbb6f5ecdd69ce7a332f613a89a9a7_cgraph" alt=""/></div>
<map name="autil__pkcs11_8h_ad4fbb6f5ecdd69ce7a332f613a89a9a7_cgraph" id="autil__pkcs11_8h_ad4fbb6f5ecdd69ce7a332f613a89a9a7_cgraph">
<area shape="rect" title=" " alt="" coords="5,23,171,64"/>
<area shape="rect" href="structmechanism.html#afeb8198b0f33f94f4520c0ffbc584a9a" title=" " alt="" coords="219,5,382,31"/>
<area shape="poly" title=" " alt="" coords="171,31,203,27,203,32,171,36"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="265,55,336,80"/>
<area shape="poly" title=" " alt="" coords="171,50,250,59,249,64,171,55"/>
</map>
</div>

</div>
</div>
<a id="a5ce40fa3ee245e65d99ee4cec7a1dd0c" name="a5ce40fa3ee245e65d99ee4cec7a1dd0c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ce40fa3ee245e65d99ee4cec7a1dd0c">&#9670;&#160;</a></span>check_decrypt_mechanism()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool check_decrypt_mechanism </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__pkcs11__slot.html">yubihsm_pkcs11_slot</a> *</td>          <td class="paramname"><span class="paramname"><em>slot</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pkcs11_8h.html#ab943ac89d1b0f6f3631d3361da0d52a1">CK_MECHANISM_PTR</a></td>          <td class="paramname"><span class="paramname"><em>pMechanism</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="util__pkcs11_8c_source.html#l01678">1678</a> of file <a class="el" href="util__pkcs11_8c_source.html">util_pkcs11.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1679</span>                                                          {</div>
<div class="line"><span class="lineno"> 1680</span> </div>
<div class="line"><span class="lineno"> 1681</span>  CK_MECHANISM_TYPE mechanisms[128];</div>
<div class="line"><span class="lineno"> 1682</span>  <a class="code hl_typedef" href="pkcs11_8h.html#a35181858a3b7a0a81f49d180d8f446ef">CK_ULONG</a> <a class="code hl_variable" href="gmock__stress__test_8cc.html#afd9db40e3361ae09188795e8cbe19752">count</a> = 128;</div>
<div class="line"><span class="lineno"> 1683</span> </div>
<div class="line"><span class="lineno"> 1684</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="util__pkcs11_8c.html#a8a3a4cd4d71d1a0489be171682cb9ece">is_RSA_decrypt_mechanism</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ab0dca4e7a2bfa74ab9cae5b8c1995647">pMechanism</a>-&gt;<a class="code hl_variable" href="structck__mechanism.html#a01c48c2e7afe52b7b1acfa9c2e6fe030">mechanism</a>) == <span class="keyword">false</span> &amp;&amp;</div>
<div class="line"><span class="lineno"> 1685</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ab0dca4e7a2bfa74ab9cae5b8c1995647">pMechanism</a>-&gt;<a class="code hl_variable" href="structck__mechanism.html#a01c48c2e7afe52b7b1acfa9c2e6fe030">mechanism</a> != <a class="code hl_define" href="pkcs11y_8h.html#a631efbda997696a7f7ce71df0e3e779a">CKM_YUBICO_AES_CCM_WRAP</a>) {</div>
<div class="line"><span class="lineno"> 1686</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1687</span>  }</div>
<div class="line"><span class="lineno"> 1688</span> </div>
<div class="line"><span class="lineno"> 1689</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="util__pkcs11_8c.html#a064731f36eb972f687b4059dc5f340db">get_mechanism_list</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>, mechanisms, &amp;<a class="code hl_variable" href="gmock__stress__test_8cc.html#afd9db40e3361ae09188795e8cbe19752">count</a>) != <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>) {</div>
<div class="line"><span class="lineno"> 1690</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1691</span>  }</div>
<div class="line"><span class="lineno"> 1692</span> </div>
<div class="line"><span class="lineno"> 1693</span>  <span class="keywordflow">for</span> (<a class="code hl_typedef" href="pkcs11_8h.html#a35181858a3b7a0a81f49d180d8f446ef">CK_ULONG</a> i = 0; i &lt; <a class="code hl_variable" href="gmock__stress__test_8cc.html#afd9db40e3361ae09188795e8cbe19752">count</a>; i++) {</div>
<div class="line"><span class="lineno"> 1694</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ab0dca4e7a2bfa74ab9cae5b8c1995647">pMechanism</a>-&gt;<a class="code hl_variable" href="structck__mechanism.html#a01c48c2e7afe52b7b1acfa9c2e6fe030">mechanism</a> == mechanisms[i]) {</div>
<div class="line"><span class="lineno"> 1695</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1696</span>    }</div>
<div class="line"><span class="lineno"> 1697</span>  }</div>
<div class="line"><span class="lineno"> 1698</span> </div>
<div class="line"><span class="lineno"> 1699</span>  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1700</span>}</div>
<div class="ttc" id="agmock__stress__test_8cc_html_afd9db40e3361ae09188795e8cbe19752"><div class="ttname"><a href="gmock__stress__test_8cc.html#afd9db40e3361ae09188795e8cbe19752">count</a></div><div class="ttdeci">int * count</div><div class="ttdef"><b>Definition</b> <a href="gmock__stress__test_8cc_source.html#l00177">gmock_stress_test.cc:177</a></div></div>
<div class="ttc" id="apkcs11_8h_html_a35181858a3b7a0a81f49d180d8f446ef"><div class="ttname"><a href="pkcs11_8h.html#a35181858a3b7a0a81f49d180d8f446ef">CK_ULONG</a></div><div class="ttdeci">unsigned long int CK_ULONG</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l01194">pkcs11.h:1194</a></div></div>
<div class="ttc" id="astructck__mechanism_html_a01c48c2e7afe52b7b1acfa9c2e6fe030"><div class="ttname"><a href="structck__mechanism.html#a01c48c2e7afe52b7b1acfa9c2e6fe030">ck_mechanism::mechanism</a></div><div class="ttdeci">ck_mechanism_type_t mechanism</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00695">pkcs11.h:695</a></div></div>
<div class="ttc" id="autil__pkcs11_8c_html_a064731f36eb972f687b4059dc5f340db"><div class="ttname"><a href="util__pkcs11_8c.html#a064731f36eb972f687b4059dc5f340db">get_mechanism_list</a></div><div class="ttdeci">CK_RV get_mechanism_list(yubihsm_pkcs11_slot *slot, CK_MECHANISM_TYPE_PTR pMechanismList, CK_ULONG_PTR count)</div><div class="ttdef"><b>Definition</b> <a href="util__pkcs11_8c_source.html#l00073">util_pkcs11.c:73</a></div></div>
<div class="ttc" id="autil__pkcs11_8c_html_a8a3a4cd4d71d1a0489be171682cb9ece"><div class="ttname"><a href="util__pkcs11_8c.html#a8a3a4cd4d71d1a0489be171682cb9ece">is_RSA_decrypt_mechanism</a></div><div class="ttdeci">bool is_RSA_decrypt_mechanism(CK_MECHANISM_TYPE m)</div><div class="ttdef"><b>Definition</b> <a href="util__pkcs11_8c_source.html#l02627">util_pkcs11.c:2627</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_ab0dca4e7a2bfa74ab9cae5b8c1995647"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#ab0dca4e7a2bfa74ab9cae5b8c1995647">pMechanism</a></div><div class="ttdeci">CK_SESSION_HANDLE CK_MECHANISM_PTR pMechanism</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l02319">yubihsm_pkcs11.c:2319</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util__pkcs11_8h_a5ce40fa3ee245e65d99ee4cec7a1dd0c_cgraph.png" border="0" usemap="#autil__pkcs11_8h_a5ce40fa3ee245e65d99ee4cec7a1dd0c_cgraph" alt=""/></div>
<map name="autil__pkcs11_8h_a5ce40fa3ee245e65d99ee4cec7a1dd0c_cgraph" id="autil__pkcs11_8h_a5ce40fa3ee245e65d99ee4cec7a1dd0c_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,186,56"/>
<area shape="rect" href="util__pkcs11_8c.html#a064731f36eb972f687b4059dc5f340db" title=" " alt="" coords="260,5,398,31"/>
<area shape="poly" title=" " alt="" coords="186,31,244,25,245,30,186,36"/>
<area shape="rect" href="util__pkcs11_8c.html#a8a3a4cd4d71d1a0489be171682cb9ece" title=" " alt="" coords="234,55,424,80"/>
<area shape="poly" title=" " alt="" coords="186,50,218,53,218,59,186,55"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="868,7,939,32"/>
<area shape="poly" title=" " alt="" coords="398,15,814,16,852,16,852,21,814,21,398,21"/>
<area shape="rect" href="yubihsm_8c.html#a6ab558e1426359cc78e7a362f8b3acd9" title=" " alt="" coords="472,31,629,56"/>
<area shape="poly" title=" " alt="" coords="398,23,457,30,456,35,397,29"/>
<area shape="rect" href="yubihsm_8c.html#a799e299be8d4c13dfa2112a60d05480d" title=" " alt="" coords="677,31,814,56"/>
<area shape="poly" title=" " alt="" coords="630,41,661,41,661,46,630,46"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="862,56,945,82"/>
<area shape="poly" title=" " alt="" coords="607,54,678,66,766,71,846,69,846,75,766,76,677,71,606,60"/>
<area shape="poly" title=" " alt="" coords="814,30,852,25,853,30,814,36"/>
<area shape="poly" title=" " alt="" coords="814,52,847,57,846,62,814,57"/>
</map>
</div>

</div>
</div>
<a id="a61664b3bfbd62e9ac2da4ed66be23dbc" name="a61664b3bfbd62e9ac2da4ed66be23dbc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a61664b3bfbd62e9ac2da4ed66be23dbc">&#9670;&#160;</a></span>check_digest_mechanism()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool check_digest_mechanism </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="pkcs11_8h.html#ab943ac89d1b0f6f3631d3361da0d52a1">CK_MECHANISM_PTR</a></td>          <td class="paramname"><span class="paramname"><em>pMechanism</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="util__pkcs11_8c_source.html#l01725">1725</a> of file <a class="el" href="util__pkcs11_8c_source.html">util_pkcs11.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1725</span>                                                         {</div>
<div class="line"><span class="lineno"> 1726</span> </div>
<div class="line"><span class="lineno"> 1727</span>  <span class="keywordflow">switch</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ab0dca4e7a2bfa74ab9cae5b8c1995647">pMechanism</a>-&gt;<a class="code hl_variable" href="structck__mechanism.html#a01c48c2e7afe52b7b1acfa9c2e6fe030">mechanism</a>) {</div>
<div class="line"><span class="lineno"> 1728</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#af1818a1c453a84f01f2e868307ca8fed">CKM_SHA_1</a>:</div>
<div class="line"><span class="lineno"> 1729</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a4d11f88ae3bea2f748f275c03b54a648">CKM_SHA256</a>:</div>
<div class="line"><span class="lineno"> 1730</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a9278e01971ca83cdd07e4b8e07a00bc8">CKM_SHA384</a>:</div>
<div class="line"><span class="lineno"> 1731</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a9bf4bf7375a24e1010cc8e0139608fd5">CKM_SHA512</a>:</div>
<div class="line"><span class="lineno"> 1732</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1733</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 1734</span>      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1735</span>  }</div>
<div class="line"><span class="lineno"> 1736</span> </div>
<div class="line"><span class="lineno"> 1737</span>  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1738</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1a99061c5c316d6427b27f8d506338bf" name="a1a99061c5c316d6427b27f8d506338bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a99061c5c316d6427b27f8d506338bf">&#9670;&#160;</a></span>check_encrypt_mechanism()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool check_encrypt_mechanism </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__pkcs11__slot.html">yubihsm_pkcs11_slot</a> *</td>          <td class="paramname"><span class="paramname"><em>slot</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pkcs11_8h.html#ab943ac89d1b0f6f3631d3361da0d52a1">CK_MECHANISM_PTR</a></td>          <td class="paramname"><span class="paramname"><em>pMechanism</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="util__pkcs11_8c_source.html#l01702">1702</a> of file <a class="el" href="util__pkcs11_8c_source.html">util_pkcs11.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1703</span>                                                          {</div>
<div class="line"><span class="lineno"> 1704</span> </div>
<div class="line"><span class="lineno"> 1705</span>  CK_MECHANISM_TYPE mechanisms[128];</div>
<div class="line"><span class="lineno"> 1706</span>  <a class="code hl_typedef" href="pkcs11_8h.html#a35181858a3b7a0a81f49d180d8f446ef">CK_ULONG</a> <a class="code hl_variable" href="gmock__stress__test_8cc.html#afd9db40e3361ae09188795e8cbe19752">count</a> = 128;</div>
<div class="line"><span class="lineno"> 1707</span> </div>
<div class="line"><span class="lineno"> 1708</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ab0dca4e7a2bfa74ab9cae5b8c1995647">pMechanism</a>-&gt;<a class="code hl_variable" href="structck__mechanism.html#a01c48c2e7afe52b7b1acfa9c2e6fe030">mechanism</a> != <a class="code hl_define" href="pkcs11y_8h.html#a631efbda997696a7f7ce71df0e3e779a">CKM_YUBICO_AES_CCM_WRAP</a>) {</div>
<div class="line"><span class="lineno"> 1709</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1710</span>  }</div>
<div class="line"><span class="lineno"> 1711</span> </div>
<div class="line"><span class="lineno"> 1712</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="util__pkcs11_8c.html#a064731f36eb972f687b4059dc5f340db">get_mechanism_list</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>, mechanisms, &amp;<a class="code hl_variable" href="gmock__stress__test_8cc.html#afd9db40e3361ae09188795e8cbe19752">count</a>) != <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>) {</div>
<div class="line"><span class="lineno"> 1713</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1714</span>  }</div>
<div class="line"><span class="lineno"> 1715</span> </div>
<div class="line"><span class="lineno"> 1716</span>  <span class="keywordflow">for</span> (<a class="code hl_typedef" href="pkcs11_8h.html#a35181858a3b7a0a81f49d180d8f446ef">CK_ULONG</a> i = 0; i &lt; <a class="code hl_variable" href="gmock__stress__test_8cc.html#afd9db40e3361ae09188795e8cbe19752">count</a>; i++) {</div>
<div class="line"><span class="lineno"> 1717</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ab0dca4e7a2bfa74ab9cae5b8c1995647">pMechanism</a>-&gt;<a class="code hl_variable" href="structck__mechanism.html#a01c48c2e7afe52b7b1acfa9c2e6fe030">mechanism</a> == mechanisms[i]) {</div>
<div class="line"><span class="lineno"> 1718</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1719</span>    }</div>
<div class="line"><span class="lineno"> 1720</span>  }</div>
<div class="line"><span class="lineno"> 1721</span> </div>
<div class="line"><span class="lineno"> 1722</span>  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1723</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util__pkcs11_8h_a1a99061c5c316d6427b27f8d506338bf_cgraph.png" border="0" usemap="#autil__pkcs11_8h_a1a99061c5c316d6427b27f8d506338bf_cgraph" alt=""/></div>
<map name="autil__pkcs11_8h_a1a99061c5c316d6427b27f8d506338bf_cgraph" id="autil__pkcs11_8h_a1a99061c5c316d6427b27f8d506338bf_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,186,31"/>
<area shape="rect" href="util__pkcs11_8c.html#a064731f36eb972f687b4059dc5f340db" title=" " alt="" coords="234,5,371,31"/>
<area shape="poly" title=" " alt="" coords="186,16,218,16,218,21,186,21"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="815,7,886,32"/>
<area shape="poly" title=" " alt="" coords="371,15,761,16,799,16,799,21,761,21,371,21"/>
<area shape="rect" href="yubihsm_8c.html#a6ab558e1426359cc78e7a362f8b3acd9" title=" " alt="" coords="419,31,576,56"/>
<area shape="poly" title=" " alt="" coords="372,24,404,29,403,34,371,30"/>
<area shape="rect" href="yubihsm_8c.html#a799e299be8d4c13dfa2112a60d05480d" title=" " alt="" coords="624,31,761,56"/>
<area shape="poly" title=" " alt="" coords="577,41,608,41,608,46,577,46"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="809,56,892,82"/>
<area shape="poly" title=" " alt="" coords="554,54,625,66,713,71,793,69,793,75,713,76,624,71,553,60"/>
<area shape="poly" title=" " alt="" coords="761,30,799,25,800,30,761,36"/>
<area shape="poly" title=" " alt="" coords="761,52,794,57,793,62,761,57"/>
</map>
</div>

</div>
</div>
<a id="ae8ed437178cb69b0fed6916747368344" name="ae8ed437178cb69b0fed6916747368344"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8ed437178cb69b0fed6916747368344">&#9670;&#160;</a></span>check_sign_mechanism()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool check_sign_mechanism </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__pkcs11__slot.html">yubihsm_pkcs11_slot</a> *</td>          <td class="paramname"><span class="paramname"><em>slot</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pkcs11_8h.html#ab943ac89d1b0f6f3631d3361da0d52a1">CK_MECHANISM_PTR</a></td>          <td class="paramname"><span class="paramname"><em>pMechanism</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="util__pkcs11_8c_source.html#l01646">1646</a> of file <a class="el" href="util__pkcs11_8c_source.html">util_pkcs11.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1647</span>                                                       {</div>
<div class="line"><span class="lineno"> 1648</span> </div>
<div class="line"><span class="lineno"> 1649</span>  CK_MECHANISM_TYPE mechanisms[128];</div>
<div class="line"><span class="lineno"> 1650</span>  <a class="code hl_typedef" href="pkcs11_8h.html#a35181858a3b7a0a81f49d180d8f446ef">CK_ULONG</a> <a class="code hl_variable" href="gmock__stress__test_8cc.html#afd9db40e3361ae09188795e8cbe19752">count</a> = 128;</div>
<div class="line"><span class="lineno"> 1651</span> </div>
<div class="line"><span class="lineno"> 1652</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="util__pkcs11_8c.html#a7c0da3eb6986b1e9466392de8eb4b9f5">is_RSA_sign_mechanism</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ab0dca4e7a2bfa74ab9cae5b8c1995647">pMechanism</a>-&gt;<a class="code hl_variable" href="structck__mechanism.html#a01c48c2e7afe52b7b1acfa9c2e6fe030">mechanism</a>) == <span class="keyword">false</span> &amp;&amp;</div>
<div class="line"><span class="lineno"> 1653</span>      <a class="code hl_function" href="util__pkcs11_8c.html#a03746a942ba1eaafbec20b675463ee00">is_ECDSA_sign_mechanism</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ab0dca4e7a2bfa74ab9cae5b8c1995647">pMechanism</a>-&gt;<a class="code hl_variable" href="structck__mechanism.html#a01c48c2e7afe52b7b1acfa9c2e6fe030">mechanism</a>) == <span class="keyword">false</span> &amp;&amp;</div>
<div class="line"><span class="lineno"> 1654</span>      <a class="code hl_function" href="util__pkcs11_8c.html#a3da5875af7a71b11ee5ead6b160d1ff4">is_HMAC_sign_mechanism</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ab0dca4e7a2bfa74ab9cae5b8c1995647">pMechanism</a>-&gt;<a class="code hl_variable" href="structck__mechanism.html#a01c48c2e7afe52b7b1acfa9c2e6fe030">mechanism</a>) == <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 1655</span> </div>
<div class="line"><span class="lineno"> 1656</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1657</span>  }</div>
<div class="line"><span class="lineno"> 1658</span> </div>
<div class="line"><span class="lineno"> 1659</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="util__pkcs11_8c.html#a064731f36eb972f687b4059dc5f340db">get_mechanism_list</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>, mechanisms, &amp;<a class="code hl_variable" href="gmock__stress__test_8cc.html#afd9db40e3361ae09188795e8cbe19752">count</a>) != <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>) {</div>
<div class="line"><span class="lineno"> 1660</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1661</span>  }</div>
<div class="line"><span class="lineno"> 1662</span> </div>
<div class="line"><span class="lineno"> 1663</span>  <span class="keywordflow">for</span> (<a class="code hl_typedef" href="pkcs11_8h.html#a35181858a3b7a0a81f49d180d8f446ef">CK_ULONG</a> i = 0; i &lt; <a class="code hl_variable" href="gmock__stress__test_8cc.html#afd9db40e3361ae09188795e8cbe19752">count</a>; i++) {</div>
<div class="line"><span class="lineno"> 1664</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ab0dca4e7a2bfa74ab9cae5b8c1995647">pMechanism</a>-&gt;<a class="code hl_variable" href="structck__mechanism.html#a01c48c2e7afe52b7b1acfa9c2e6fe030">mechanism</a> == mechanisms[i]) {</div>
<div class="line"><span class="lineno"> 1665</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1666</span>    }</div>
<div class="line"><span class="lineno"> 1667</span>  }</div>
<div class="line"><span class="lineno"> 1668</span> </div>
<div class="line"><span class="lineno"> 1669</span>  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1670</span>}</div>
<div class="ttc" id="autil__pkcs11_8c_html_a3da5875af7a71b11ee5ead6b160d1ff4"><div class="ttname"><a href="util__pkcs11_8c.html#a3da5875af7a71b11ee5ead6b160d1ff4">is_HMAC_sign_mechanism</a></div><div class="ttdeci">bool is_HMAC_sign_mechanism(CK_MECHANISM_TYPE m)</div><div class="ttdef"><b>Definition</b> <a href="util__pkcs11_8c_source.html#l02724">util_pkcs11.c:2724</a></div></div>
<div class="ttc" id="autil__pkcs11_8c_html_a7c0da3eb6986b1e9466392de8eb4b9f5"><div class="ttname"><a href="util__pkcs11_8c.html#a7c0da3eb6986b1e9466392de8eb4b9f5">is_RSA_sign_mechanism</a></div><div class="ttdeci">bool is_RSA_sign_mechanism(CK_MECHANISM_TYPE m)</div><div class="ttdef"><b>Definition</b> <a href="util__pkcs11_8c_source.html#l02605">util_pkcs11.c:2605</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util__pkcs11_8h_ae8ed437178cb69b0fed6916747368344_cgraph.png" border="0" usemap="#autil__pkcs11_8h_ae8ed437178cb69b0fed6916747368344_cgraph" alt=""/></div>
<map name="autil__pkcs11_8h_ae8ed437178cb69b0fed6916747368344_cgraph" id="autil__pkcs11_8h_ae8ed437178cb69b0fed6916747368344_cgraph">
<area shape="rect" title=" " alt="" coords="5,80,167,106"/>
<area shape="rect" href="util__pkcs11_8c.html#a064731f36eb972f687b4059dc5f340db" title=" " alt="" coords="241,5,378,31"/>
<area shape="poly" title=" " alt="" coords="117,77,214,40,236,33,238,38,216,45,119,82"/>
<area shape="rect" href="util__pkcs11_8c.html#a03746a942ba1eaafbec20b675463ee00" title=" " alt="" coords="215,55,405,80"/>
<area shape="poly" title=" " alt="" coords="167,81,199,77,199,83,167,86"/>
<area shape="rect" href="util__pkcs11_8c.html#a3da5875af7a71b11ee5ead6b160d1ff4" title=" " alt="" coords="218,104,402,130"/>
<area shape="poly" title=" " alt="" coords="167,99,203,103,202,108,167,104"/>
<area shape="rect" href="util__pkcs11_8c.html#a7c0da3eb6986b1e9466392de8eb4b9f5" title=" " alt="" coords="224,153,396,179"/>
<area shape="poly" title=" " alt="" coords="120,104,216,140,238,146,236,151,214,145,118,109"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="849,7,920,32"/>
<area shape="poly" title=" " alt="" coords="379,15,795,16,833,16,833,21,795,21,379,21"/>
<area shape="rect" href="yubihsm_8c.html#a6ab558e1426359cc78e7a362f8b3acd9" title=" " alt="" coords="453,31,610,56"/>
<area shape="poly" title=" " alt="" coords="379,23,438,30,437,35,378,29"/>
<area shape="rect" href="yubihsm_8c.html#a799e299be8d4c13dfa2112a60d05480d" title=" " alt="" coords="658,31,795,56"/>
<area shape="poly" title=" " alt="" coords="611,41,642,41,642,46,611,46"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="843,56,926,82"/>
<area shape="poly" title=" " alt="" coords="588,54,659,66,747,71,827,69,827,75,747,76,658,71,587,60"/>
<area shape="poly" title=" " alt="" coords="795,30,833,25,834,30,795,36"/>
<area shape="poly" title=" " alt="" coords="795,52,828,57,827,62,795,57"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util__pkcs11_8h_ae8ed437178cb69b0fed6916747368344_icgraph.png" border="0" usemap="#autil__pkcs11_8h_ae8ed437178cb69b0fed6916747368344_icgraph" alt=""/></div>
<map name="autil__pkcs11_8h_ae8ed437178cb69b0fed6916747368344_icgraph" id="autil__pkcs11_8h_ae8ed437178cb69b0fed6916747368344_icgraph">
<area shape="rect" title=" " alt="" coords="223,5,384,31"/>
<area shape="rect" href="util__pkcs11_8c.html#a87b96fbdfd225d8124f0a6f6d6538292" title=" " alt="" coords="5,5,175,31"/>
<area shape="poly" title=" " alt="" coords="207,21,175,21,175,16,207,16"/>
</map>
</div>

</div>
</div>
<a id="a87b96fbdfd225d8124f0a6f6d6538292" name="a87b96fbdfd225d8124f0a6f6d6538292"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87b96fbdfd225d8124f0a6f6d6538292">&#9670;&#160;</a></span>check_verify_mechanism()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool check_verify_mechanism </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__pkcs11__slot.html">yubihsm_pkcs11_slot</a> *</td>          <td class="paramname"><span class="paramname"><em>slot</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pkcs11_8h.html#ab943ac89d1b0f6f3631d3361da0d52a1">CK_MECHANISM_PTR</a></td>          <td class="paramname"><span class="paramname"><em>pMechanism</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="util__pkcs11_8c_source.html#l01672">1672</a> of file <a class="el" href="util__pkcs11_8c_source.html">util_pkcs11.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1673</span>                                                         {</div>
<div class="line"><span class="lineno"> 1674</span> </div>
<div class="line"><span class="lineno"> 1675</span>  <span class="keywordflow">return</span> <a class="code hl_function" href="util__pkcs11_8c.html#ae8ed437178cb69b0fed6916747368344">check_sign_mechanism</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ab0dca4e7a2bfa74ab9cae5b8c1995647">pMechanism</a>);</div>
<div class="line"><span class="lineno"> 1676</span>}</div>
<div class="ttc" id="autil__pkcs11_8c_html_ae8ed437178cb69b0fed6916747368344"><div class="ttname"><a href="util__pkcs11_8c.html#ae8ed437178cb69b0fed6916747368344">check_sign_mechanism</a></div><div class="ttdeci">bool check_sign_mechanism(yubihsm_pkcs11_slot *slot, CK_MECHANISM_PTR pMechanism)</div><div class="ttdef"><b>Definition</b> <a href="util__pkcs11_8c_source.html#l01646">util_pkcs11.c:1646</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util__pkcs11_8h_a87b96fbdfd225d8124f0a6f6d6538292_cgraph.png" border="0" usemap="#autil__pkcs11_8h_a87b96fbdfd225d8124f0a6f6d6538292_cgraph" alt=""/></div>
<map name="autil__pkcs11_8h_a87b96fbdfd225d8124f0a6f6d6538292_cgraph" id="autil__pkcs11_8h_a87b96fbdfd225d8124f0a6f6d6538292_cgraph">
<area shape="rect" title=" " alt="" coords="5,80,175,106"/>
<area shape="rect" href="util__pkcs11_8c.html#ae8ed437178cb69b0fed6916747368344" title=" " alt="" coords="223,80,384,106"/>
<area shape="poly" title=" " alt="" coords="175,90,207,90,207,96,175,96"/>
<area shape="rect" href="util__pkcs11_8c.html#a064731f36eb972f687b4059dc5f340db" title=" " alt="" coords="458,5,596,31"/>
<area shape="poly" title=" " alt="" coords="334,77,431,40,453,33,455,38,433,45,336,82"/>
<area shape="rect" href="util__pkcs11_8c.html#a03746a942ba1eaafbec20b675463ee00" title=" " alt="" coords="432,55,622,80"/>
<area shape="poly" title=" " alt="" coords="384,81,416,77,417,83,385,86"/>
<area shape="rect" href="util__pkcs11_8c.html#a3da5875af7a71b11ee5ead6b160d1ff4" title=" " alt="" coords="436,104,619,130"/>
<area shape="poly" title=" " alt="" coords="385,99,420,103,420,108,384,104"/>
<area shape="rect" href="util__pkcs11_8c.html#a7c0da3eb6986b1e9466392de8eb4b9f5" title=" " alt="" coords="442,153,613,179"/>
<area shape="poly" title=" " alt="" coords="337,104,433,140,455,146,454,151,431,145,335,109"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="1066,7,1137,32"/>
<area shape="poly" title=" " alt="" coords="596,15,1012,16,1050,16,1050,21,1012,21,596,21"/>
<area shape="rect" href="yubihsm_8c.html#a6ab558e1426359cc78e7a362f8b3acd9" title=" " alt="" coords="670,31,828,56"/>
<area shape="poly" title=" " alt="" coords="596,23,655,30,655,35,596,29"/>
<area shape="rect" href="yubihsm_8c.html#a799e299be8d4c13dfa2112a60d05480d" title=" " alt="" coords="876,31,1012,56"/>
<area shape="poly" title=" " alt="" coords="828,41,860,41,860,46,828,46"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="1060,56,1143,82"/>
<area shape="poly" title=" " alt="" coords="805,54,876,66,964,71,1044,69,1044,75,964,76,875,71,804,60"/>
<area shape="poly" title=" " alt="" coords="1012,30,1050,25,1051,30,1013,36"/>
<area shape="poly" title=" " alt="" coords="1013,52,1045,57,1044,62,1012,57"/>
</map>
</div>

</div>
</div>
<a id="a83e06a2ae90589d9fad186cad9ed5ede" name="a83e06a2ae90589d9fad186cad9ed5ede"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83e06a2ae90589d9fad186cad9ed5ede">&#9670;&#160;</a></span>check_wrap_mechanism()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool check_wrap_mechanism </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__pkcs11__slot.html">yubihsm_pkcs11_slot</a> *</td>          <td class="paramname"><span class="paramname"><em>slot</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pkcs11_8h.html#ab943ac89d1b0f6f3631d3361da0d52a1">CK_MECHANISM_PTR</a></td>          <td class="paramname"><span class="paramname"><em>pMechanism</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="util__pkcs11_8c_source.html#l01740">1740</a> of file <a class="el" href="util__pkcs11_8c_source.html">util_pkcs11.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1741</span>                                                       {</div>
<div class="line"><span class="lineno"> 1742</span> </div>
<div class="line"><span class="lineno"> 1743</span>  CK_MECHANISM_TYPE mechanisms[128];</div>
<div class="line"><span class="lineno"> 1744</span>  <a class="code hl_typedef" href="pkcs11_8h.html#a35181858a3b7a0a81f49d180d8f446ef">CK_ULONG</a> <a class="code hl_variable" href="gmock__stress__test_8cc.html#afd9db40e3361ae09188795e8cbe19752">count</a> = 128;</div>
<div class="line"><span class="lineno"> 1745</span> </div>
<div class="line"><span class="lineno"> 1746</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ab0dca4e7a2bfa74ab9cae5b8c1995647">pMechanism</a>-&gt;<a class="code hl_variable" href="structck__mechanism.html#a01c48c2e7afe52b7b1acfa9c2e6fe030">mechanism</a> != <a class="code hl_define" href="pkcs11y_8h.html#a631efbda997696a7f7ce71df0e3e779a">CKM_YUBICO_AES_CCM_WRAP</a>) {</div>
<div class="line"><span class="lineno"> 1747</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1748</span>  }</div>
<div class="line"><span class="lineno"> 1749</span> </div>
<div class="line"><span class="lineno"> 1750</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="util__pkcs11_8c.html#a064731f36eb972f687b4059dc5f340db">get_mechanism_list</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>, mechanisms, &amp;<a class="code hl_variable" href="gmock__stress__test_8cc.html#afd9db40e3361ae09188795e8cbe19752">count</a>) != <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>) {</div>
<div class="line"><span class="lineno"> 1751</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1752</span>  }</div>
<div class="line"><span class="lineno"> 1753</span> </div>
<div class="line"><span class="lineno"> 1754</span>  <span class="keywordflow">for</span> (<a class="code hl_typedef" href="pkcs11_8h.html#a35181858a3b7a0a81f49d180d8f446ef">CK_ULONG</a> i = 0; i &lt; <a class="code hl_variable" href="gmock__stress__test_8cc.html#afd9db40e3361ae09188795e8cbe19752">count</a>; i++) {</div>
<div class="line"><span class="lineno"> 1755</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ab0dca4e7a2bfa74ab9cae5b8c1995647">pMechanism</a>-&gt;<a class="code hl_variable" href="structck__mechanism.html#a01c48c2e7afe52b7b1acfa9c2e6fe030">mechanism</a> == mechanisms[i]) {</div>
<div class="line"><span class="lineno"> 1756</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1757</span>    }</div>
<div class="line"><span class="lineno"> 1758</span>  }</div>
<div class="line"><span class="lineno"> 1759</span> </div>
<div class="line"><span class="lineno"> 1760</span>  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1761</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util__pkcs11_8h_a83e06a2ae90589d9fad186cad9ed5ede_cgraph.png" border="0" usemap="#autil__pkcs11_8h_a83e06a2ae90589d9fad186cad9ed5ede_cgraph" alt=""/></div>
<map name="autil__pkcs11_8h_a83e06a2ae90589d9fad186cad9ed5ede_cgraph" id="autil__pkcs11_8h_a83e06a2ae90589d9fad186cad9ed5ede_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,171,31"/>
<area shape="rect" href="util__pkcs11_8c.html#a064731f36eb972f687b4059dc5f340db" title=" " alt="" coords="219,5,356,31"/>
<area shape="poly" title=" " alt="" coords="171,16,204,16,204,21,171,21"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="800,7,871,32"/>
<area shape="poly" title=" " alt="" coords="356,15,746,16,784,16,784,21,746,21,356,21"/>
<area shape="rect" href="yubihsm_8c.html#a6ab558e1426359cc78e7a362f8b3acd9" title=" " alt="" coords="404,31,561,56"/>
<area shape="poly" title=" " alt="" coords="357,24,389,29,388,34,356,30"/>
<area shape="rect" href="yubihsm_8c.html#a799e299be8d4c13dfa2112a60d05480d" title=" " alt="" coords="609,31,746,56"/>
<area shape="poly" title=" " alt="" coords="562,41,593,41,593,46,562,46"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="794,56,877,82"/>
<area shape="poly" title=" " alt="" coords="539,54,610,66,698,71,778,69,778,75,698,76,609,71,538,60"/>
<area shape="poly" title=" " alt="" coords="746,30,784,25,785,30,746,36"/>
<area shape="poly" title=" " alt="" coords="746,52,779,57,778,62,746,57"/>
</map>
</div>

</div>
</div>
<a id="a700b4fbb8f17dde6dc3a96957951674f" name="a700b4fbb8f17dde6dc3a96957951674f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a700b4fbb8f17dde6dc3a96957951674f">&#9670;&#160;</a></span>create_session()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool create_session </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__pkcs11__slot.html">yubihsm_pkcs11_slot</a> *</td>          <td class="paramname"><span class="paramname"><em>slot</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CK_FLAGS</td>          <td class="paramname"><span class="paramname"><em>flags</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pkcs11_8h.html#a28172afc989b647ca7909d036198afa6">CK_SESSION_HANDLE_PTR</a></td>          <td class="paramname"><span class="paramname"><em>phSession</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="util__pkcs11_8c_source.html#l00491">491</a> of file <a class="el" href="util__pkcs11_8c_source.html">util_pkcs11.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  492</span>                                                     {</div>
<div class="line"><span class="lineno">  493</span> </div>
<div class="line"><span class="lineno">  494</span>  <span class="keywordtype">bool</span> authed = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  495</span>  <a class="code hl_struct" href="structyubihsm__pkcs11__session.html">yubihsm_pkcs11_session</a> <a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>;</div>
<div class="line"><span class="lineno">  496</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105">memset</a>(&amp;<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, 0, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>));</div>
<div class="line"><span class="lineno">  497</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__slot.html#ab8e6a1f9aba139c1561f21304649b43a">pkcs11_sessions</a>.<a class="code hl_variable" href="struct_list.html#ab1a74efd973a8efd990b05788152fd95">head</a>) {</div>
<div class="line"><span class="lineno">  498</span>    <a class="code hl_struct" href="structyubihsm__pkcs11__session.html">yubihsm_pkcs11_session</a> *<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a> =</div>
<div class="line"><span class="lineno">  499</span>      (<a class="code hl_struct" href="structyubihsm__pkcs11__session.html">yubihsm_pkcs11_session</a> *) <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__slot.html#ab8e6a1f9aba139c1561f21304649b43a">pkcs11_sessions</a>.<a class="code hl_variable" href="struct_list.html#ab1a74efd973a8efd990b05788152fd95">head</a>-&gt;<a class="code hl_variable" href="struct_list_item.html#a788104e1ae9d59a384497766e5203f20">data</a>;</div>
<div class="line"><span class="lineno">  500</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a>-&gt;session_state &amp; <a class="code hl_define" href="yubihsm__pkcs11_8h.html#ace6bd3fe1cbfdd8d2f55b2679cf6fce4">SESSION_AUTHENTICATED</a>) {</div>
<div class="line"><span class="lineno">  501</span>      authed = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  502</span>    }</div>
<div class="line"><span class="lineno">  503</span>  }</div>
<div class="line"><span class="lineno">  504</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ae0ed371842ace71a7886a6134ecbcb62">flags</a> &amp; <a class="code hl_define" href="pkcs11_8h.html#a49615820fe3b72c616fb71cfbe6957a4">CKF_RW_SESSION</a>) {</div>
<div class="line"><span class="lineno">  505</span>    <a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>.session_state =</div>
<div class="line"><span class="lineno">  506</span>      authed ? <a class="code hl_enumvalue" href="yubihsm__pkcs11_8h.html#a12ef82fba1bb65ec44ebfd41d42554f1a72bd07cb581cbf8c4f255db11973f575">SESSION_AUTHENTICATED_RW</a> : <a class="code hl_enumvalue" href="yubihsm__pkcs11_8h.html#a12ef82fba1bb65ec44ebfd41d42554f1af048891d1d2cd3ce2368a5c2218a8012">SESSION_RESERVED_RW</a>;</div>
<div class="line"><span class="lineno">  507</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  508</span>    <a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>.session_state =</div>
<div class="line"><span class="lineno">  509</span>      authed ? <a class="code hl_enumvalue" href="yubihsm__pkcs11_8h.html#a12ef82fba1bb65ec44ebfd41d42554f1a7cd356610204420cc1297af1fe200a0c">SESSION_AUTHENTICATED_RO</a> : <a class="code hl_enumvalue" href="yubihsm__pkcs11_8h.html#a12ef82fba1bb65ec44ebfd41d42554f1ae392f5a08a54bc920f84c36836d6daf8">SESSION_RESERVED_RO</a>;</div>
<div class="line"><span class="lineno">  510</span>  }</div>
<div class="line"><span class="lineno">  511</span>  <a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>.id = <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__slot.html#acb2adb2735c7e7fed62553254305888a">max_session_id</a>++;</div>
<div class="line"><span class="lineno">  512</span>  <a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>.slot = <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>;</div>
<div class="line"><span class="lineno">  513</span>  <a class="code hl_function" href="list_8c.html#ac6c8b33b4100dfc73c933f3e936f86a1">list_create</a>(&amp;<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>.ecdh_session_keys, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structecdh__session__key.html">ecdh_session_key</a>), NULL);</div>
<div class="line"><span class="lineno">  514</span>  *<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a4af2a29df94c09021ad1646463da9201">phSession</a> = (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__slot.html#a7a8ed452594de0255b468210b42f2383">id</a> &lt;&lt; 16) + <a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>.id;</div>
<div class="line"><span class="lineno">  515</span>  <span class="keywordflow">return</span> <a class="code hl_function" href="list_8c.html#a06a2b45f704182a7d152c88d0507700c">list_append</a>(&amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__slot.html#ab8e6a1f9aba139c1561f21304649b43a">pkcs11_sessions</a>, (<span class="keywordtype">void</span> *) &amp;<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>);</div>
<div class="line"><span class="lineno">  516</span>}</div>
<div class="ttc" id="aecdh__derive__test_8c_html_a0a2c7706d971796d7dc84fee36d6c84f"><div class="ttname"><a href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a></div><div class="ttdeci">CK_SESSION_HANDLE session</div><div class="ttdef"><b>Definition</b> <a href="ecdh__derive__test_8c_source.html#l00045">ecdh_derive_test.c:45</a></div></div>
<div class="ttc" id="apkcs11_8h_html_a49615820fe3b72c616fb71cfbe6957a4"><div class="ttname"><a href="pkcs11_8h.html#a49615820fe3b72c616fb71cfbe6957a4">CKF_RW_SESSION</a></div><div class="ttdeci">#define CKF_RW_SESSION</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00293">pkcs11.h:293</a></div></div>
<div class="ttc" id="astruct_list_item_html_a788104e1ae9d59a384497766e5203f20"><div class="ttname"><a href="struct_list_item.html#a788104e1ae9d59a384497766e5203f20">ListItem::data</a></div><div class="ttdeci">void * data</div><div class="ttdef"><b>Definition</b> <a href="list_8h_source.html#l00031">list.h:31</a></div></div>
<div class="ttc" id="astructecdh__session__key_html"><div class="ttname"><a href="structecdh__session__key.html">ecdh_session_key</a></div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8h_source.html#l00122">yubihsm_pkcs11.h:122</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a4af2a29df94c09021ad1646463da9201"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a4af2a29df94c09021ad1646463da9201">phSession</a></div><div class="ttdeci">CK_SLOT_ID CK_FLAGS CK_VOID_PTR CK_NOTIFY CK_SESSION_HANDLE_PTR phSession</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l00810">yubihsm_pkcs11.c:810</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a506da415c9307c897ca9be93acfe1d0f"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a></div><div class="ttdeci">char * s</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l00524">yubihsm_pkcs11.c:524</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_ae0ed371842ace71a7886a6134ecbcb62"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#ae0ed371842ace71a7886a6134ecbcb62">flags</a></div><div class="ttdeci">pInfo flags</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l00540">yubihsm_pkcs11.c:540</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8h_html_a12ef82fba1bb65ec44ebfd41d42554f1a72bd07cb581cbf8c4f255db11973f575"><div class="ttname"><a href="yubihsm__pkcs11_8h.html#a12ef82fba1bb65ec44ebfd41d42554f1a72bd07cb581cbf8c4f255db11973f575">SESSION_AUTHENTICATED_RW</a></div><div class="ttdeci">@ SESSION_AUTHENTICATED_RW</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8h_source.html#l00034">yubihsm_pkcs11.h:34</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8h_html_a12ef82fba1bb65ec44ebfd41d42554f1a7cd356610204420cc1297af1fe200a0c"><div class="ttname"><a href="yubihsm__pkcs11_8h.html#a12ef82fba1bb65ec44ebfd41d42554f1a7cd356610204420cc1297af1fe200a0c">SESSION_AUTHENTICATED_RO</a></div><div class="ttdeci">@ SESSION_AUTHENTICATED_RO</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8h_source.html#l00033">yubihsm_pkcs11.h:33</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8h_html_a12ef82fba1bb65ec44ebfd41d42554f1ae392f5a08a54bc920f84c36836d6daf8"><div class="ttname"><a href="yubihsm__pkcs11_8h.html#a12ef82fba1bb65ec44ebfd41d42554f1ae392f5a08a54bc920f84c36836d6daf8">SESSION_RESERVED_RO</a></div><div class="ttdeci">@ SESSION_RESERVED_RO</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8h_source.html#l00031">yubihsm_pkcs11.h:31</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8h_html_a12ef82fba1bb65ec44ebfd41d42554f1af048891d1d2cd3ce2368a5c2218a8012"><div class="ttname"><a href="yubihsm__pkcs11_8h.html#a12ef82fba1bb65ec44ebfd41d42554f1af048891d1d2cd3ce2368a5c2218a8012">SESSION_RESERVED_RW</a></div><div class="ttdeci">@ SESSION_RESERVED_RW</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8h_source.html#l00032">yubihsm_pkcs11.h:32</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8h_html_ace6bd3fe1cbfdd8d2f55b2679cf6fce4"><div class="ttname"><a href="yubihsm__pkcs11_8h.html#ace6bd3fe1cbfdd8d2f55b2679cf6fce4">SESSION_AUTHENTICATED</a></div><div class="ttdeci">#define SESSION_AUTHENTICATED</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8h_source.html#l00037">yubihsm_pkcs11.h:37</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util__pkcs11_8h_a700b4fbb8f17dde6dc3a96957951674f_cgraph.png" border="0" usemap="#autil__pkcs11_8h_a700b4fbb8f17dde6dc3a96957951674f_cgraph" alt=""/></div>
<map name="autil__pkcs11_8h_a700b4fbb8f17dde6dc3a96957951674f_cgraph" id="autil__pkcs11_8h_a700b4fbb8f17dde6dc3a96957951674f_cgraph">
<area shape="rect" title=" " alt="" coords="5,55,115,80"/>
<area shape="rect" href="list_8c.html#a06a2b45f704182a7d152c88d0507700c" title=" " alt="" coords="163,5,250,31"/>
<area shape="poly" title=" " alt="" coords="100,51,151,34,152,39,101,57"/>
<area shape="rect" href="list_8c.html#ac6c8b33b4100dfc73c933f3e936f86a1" title=" " alt="" coords="166,55,247,80"/>
<area shape="poly" title=" " alt="" coords="115,65,150,65,150,70,115,70"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="172,104,240,130"/>
<area shape="poly" title=" " alt="" coords="101,78,158,98,157,103,100,84"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="298,5,369,31"/>
<area shape="poly" title=" " alt="" coords="251,16,283,16,283,21,251,21"/>
</map>
</div>

</div>
</div>
<a id="a16357f17413edbce1da86168fb464074" name="a16357f17413edbce1da86168fb464074"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16357f17413edbce1da86168fb464074">&#9670;&#160;</a></span>decrypt_mechanism_cleanup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool decrypt_mechanism_cleanup </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__pkcs11__op__info.html">yubihsm_pkcs11_op_info</a> *</td>          <td class="paramname"><span class="paramname"><em>op_info</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="util__pkcs11_8c_source.html#l02566">2566</a> of file <a class="el" href="util__pkcs11_8c_source.html">util_pkcs11.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2566</span>                                                                {</div>
<div class="line"><span class="lineno"> 2567</span> </div>
<div class="line"><span class="lineno"> 2568</span>  (void) op_info;</div>
<div class="line"><span class="lineno"> 2569</span> </div>
<div class="line"><span class="lineno"> 2570</span>  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2571</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="abbef2f6ae8466dee723f94497bdea3bf" name="abbef2f6ae8466dee723f94497bdea3bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abbef2f6ae8466dee723f94497bdea3bf">&#9670;&#160;</a></span>delete_object_from_cache()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void delete_object_from_cache </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__pkcs11__object__desc.html">yubihsm_pkcs11_object_desc</a> *</td>          <td class="paramname"><span class="paramname"><em>objects</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CK_OBJECT_HANDLE</td>          <td class="paramname"><span class="paramname"><em>objHandle</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="util__pkcs11_8c_source.html#l01571">1571</a> of file <a class="el" href="util__pkcs11_8c_source.html">util_pkcs11.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1572</span>                                                          {</div>
<div class="line"><span class="lineno"> 1573</span>  <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <span class="keywordtype">id</span> = objHandle &amp; 0xffff;</div>
<div class="line"><span class="lineno"> 1574</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> type = objHandle &gt;&gt; 16;</div>
<div class="line"><span class="lineno"> 1575</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> sequence = objHandle &gt;&gt; 24;</div>
<div class="line"><span class="lineno"> 1576</span> </div>
<div class="line"><span class="lineno"> 1577</span>  <span class="keywordflow">for</span> (<a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> i = 0; i &lt; <a class="code hl_define" href="yubihsm_8h.html#a331b70d37ded99854638ff5ef0ca9735">YH_MAX_ITEMS_COUNT</a>; i++) {</div>
<div class="line"><span class="lineno"> 1578</span>    <span class="keywordflow">if</span> (objects[i].<span class="keywordtype">object</span>.<span class="keywordtype">id</span> == <span class="keywordtype">id</span> &amp;&amp;</div>
<div class="line"><span class="lineno"> 1579</span>        (objects[i].<span class="keywordtype">object</span>.type &amp; 0x7f) == (type &amp; 0x7f) &amp;&amp;</div>
<div class="line"><span class="lineno"> 1580</span>        objects[i].<span class="keywordtype">object</span>.sequence == sequence) {</div>
<div class="line"><span class="lineno"> 1581</span>      <a class="code hl_function" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105">memset</a>(&amp;objects[i], 0, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structyubihsm__pkcs11__object__desc.html">yubihsm_pkcs11_object_desc</a>));</div>
<div class="line"><span class="lineno"> 1582</span>      <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1583</span>    }</div>
<div class="line"><span class="lineno"> 1584</span>  }</div>
<div class="line"><span class="lineno"> 1585</span>}</div>
<div class="ttc" id="astdint_8h_html_aba7bc1797add20fe3efdf37ced1182c5"><div class="ttname"><a href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a></div><div class="ttdeci">unsigned char uint8_t</div><div class="ttdef"><b>Definition</b> <a href="stdint_8h_source.html#l00124">stdint.h:124</a></div></div>
<div class="ttc" id="astructyubihsm__pkcs11__object__desc_html"><div class="ttname"><a href="structyubihsm__pkcs11__object__desc.html">yubihsm_pkcs11_object_desc</a></div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8h_source.html#l00041">yubihsm_pkcs11.h:41</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a331b70d37ded99854638ff5ef0ca9735"><div class="ttname"><a href="yubihsm_8h.html#a331b70d37ded99854638ff5ef0ca9735">YH_MAX_ITEMS_COUNT</a></div><div class="ttdeci">#define YH_MAX_ITEMS_COUNT</div><div class="ttdoc">Max items the device may hold.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00103">yubihsm.h:103</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util__pkcs11_8h_abbef2f6ae8466dee723f94497bdea3bf_cgraph.png" border="0" usemap="#autil__pkcs11_8h_abbef2f6ae8466dee723f94497bdea3bf_cgraph" alt=""/></div>
<map name="autil__pkcs11_8h_abbef2f6ae8466dee723f94497bdea3bf_cgraph" id="autil__pkcs11_8h_abbef2f6ae8466dee723f94497bdea3bf_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,137,46"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="185,13,253,38"/>
<area shape="poly" title=" " alt="" coords="137,23,169,23,169,28,137,28"/>
</map>
</div>

</div>
</div>
<a id="a85ea84ffb047281f34a733572f67b254" name="a85ea84ffb047281f34a733572f67b254"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85ea84ffb047281f34a733572f67b254">&#9670;&#160;</a></span>delete_session()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool delete_session </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__pkcs11__context.html">yubihsm_pkcs11_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pkcs11_8h.html#a28172afc989b647ca7909d036198afa6">CK_SESSION_HANDLE_PTR</a></td>          <td class="paramname"><span class="paramname"><em>phSession</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="util__pkcs11_8c_source.html#l02831">2831</a> of file <a class="el" href="util__pkcs11_8c_source.html">util_pkcs11.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2832</span>                                                     {</div>
<div class="line"><span class="lineno"> 2833</span>  <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="code hl_define" href="pkcs11_8h.html#abed4fb4d15e18c668b783ad68448fed7">slot_id</a> = *<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a4af2a29df94c09021ad1646463da9201">phSession</a> &gt;&gt; 16;</div>
<div class="line"><span class="lineno"> 2834</span>  <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> session_id = *<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a4af2a29df94c09021ad1646463da9201">phSession</a> &amp; 0xffff;</div>
<div class="line"><span class="lineno"> 2835</span>  <a class="code hl_struct" href="structyubihsm__pkcs11__slot.html">yubihsm_pkcs11_slot</a> *<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a> = <a class="code hl_function" href="util__pkcs11_8c.html#a79a44d844efebfc64db6cf5836754539">get_slot</a>(ctx, <a class="code hl_define" href="pkcs11_8h.html#abed4fb4d15e18c668b783ad68448fed7">slot_id</a>);</div>
<div class="line"><span class="lineno"> 2836</span>  <span class="keywordtype">bool</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a3d854b6efad16a16e4d7b4539d4fc71f">ret</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2837</span> </div>
<div class="line"><span class="lineno"> 2838</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>) {</div>
<div class="line"><span class="lineno"> 2839</span>    <a class="code hl_struct" href="struct_list_item.html">ListItem</a> *item =</div>
<div class="line"><span class="lineno"> 2840</span>      <a class="code hl_function" href="list_8c.html#ac048645b0cd40b78c89aad9e770d4aab">list_get</a>(&amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__slot.html#ab8e6a1f9aba139c1561f21304649b43a">pkcs11_sessions</a>, &amp;session_id, compare_session);</div>
<div class="line"><span class="lineno"> 2841</span>    <span class="keywordflow">if</span> (item) {</div>
<div class="line"><span class="lineno"> 2842</span>      <a class="code hl_function" href="list_8c.html#a2c9f1765436e9a3631f048b71f17f33c">list_delete</a>(&amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__slot.html#ab8e6a1f9aba139c1561f21304649b43a">pkcs11_sessions</a>, item);</div>
<div class="line"><span class="lineno"> 2843</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a3d854b6efad16a16e4d7b4539d4fc71f">ret</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2844</span>    }</div>
<div class="line"><span class="lineno"> 2845</span>    <a class="code hl_function" href="util__pkcs11_8c.html#a3754cf5cb42a5e282658cf94f405574e">release_slot</a>(ctx, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>);</div>
<div class="line"><span class="lineno"> 2846</span>  }</div>
<div class="line"><span class="lineno"> 2847</span>  <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a3d854b6efad16a16e4d7b4539d4fc71f">ret</a>;</div>
<div class="line"><span class="lineno"> 2848</span>}</div>
<div class="ttc" id="alist_8c_html_a2c9f1765436e9a3631f048b71f17f33c"><div class="ttname"><a href="list_8c.html#a2c9f1765436e9a3631f048b71f17f33c">list_delete</a></div><div class="ttdeci">void list_delete(List *list, ListItem *item)</div><div class="ttdef"><b>Definition</b> <a href="list_8c_source.html#l00117">list.c:117</a></div></div>
<div class="ttc" id="alist_8c_html_ac048645b0cd40b78c89aad9e770d4aab"><div class="ttname"><a href="list_8c.html#ac048645b0cd40b78c89aad9e770d4aab">list_get</a></div><div class="ttdeci">ListItem * list_get(List *list, void *data, CompareItemFn compare_item_fn)</div><div class="ttdef"><b>Definition</b> <a href="list_8c_source.html#l00105">list.c:105</a></div></div>
<div class="ttc" id="apkcs11_8h_html_abed4fb4d15e18c668b783ad68448fed7"><div class="ttname"><a href="pkcs11_8h.html#abed4fb4d15e18c668b783ad68448fed7">slot_id</a></div><div class="ttdeci">#define slot_id</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00146">pkcs11.h:146</a></div></div>
<div class="ttc" id="astruct_list_item_html"><div class="ttname"><a href="struct_list_item.html">ListItem</a></div><div class="ttdef"><b>Definition</b> <a href="list_8h_source.html#l00030">list.h:30</a></div></div>
<div class="ttc" id="autil__pkcs11_8c_html_a3754cf5cb42a5e282658cf94f405574e"><div class="ttname"><a href="util__pkcs11_8c.html#a3754cf5cb42a5e282658cf94f405574e">release_slot</a></div><div class="ttdeci">void release_slot(yubihsm_pkcs11_context *ctx, yubihsm_pkcs11_slot *slot)</div><div class="ttdef"><b>Definition</b> <a href="util__pkcs11_8c_source.html#l02782">util_pkcs11.c:2782</a></div></div>
<div class="ttc" id="autil__pkcs11_8c_html_a79a44d844efebfc64db6cf5836754539"><div class="ttname"><a href="util__pkcs11_8c.html#a79a44d844efebfc64db6cf5836754539">get_slot</a></div><div class="ttdeci">yubihsm_pkcs11_slot * get_slot(yubihsm_pkcs11_context *ctx, CK_ULONG id)</div><div class="ttdef"><b>Definition</b> <a href="util__pkcs11_8c_source.html#l02766">util_pkcs11.c:2766</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util__pkcs11_8h_a85ea84ffb047281f34a733572f67b254_cgraph.png" border="0" usemap="#autil__pkcs11_8h_a85ea84ffb047281f34a733572f67b254_cgraph" alt=""/></div>
<map name="autil__pkcs11_8h_a85ea84ffb047281f34a733572f67b254_cgraph" id="autil__pkcs11_8h_a85ea84ffb047281f34a733572f67b254_cgraph">
<area shape="rect" title=" " alt="" coords="5,81,114,107"/>
<area shape="rect" href="util__pkcs11_8c.html#a79a44d844efebfc64db6cf5836754539" title=" " alt="" coords="174,5,241,31"/>
<area shape="poly" title=" " alt="" coords="85,78,166,36,169,41,88,83"/>
<area shape="rect" href="list_8c.html#ac048645b0cd40b78c89aad9e770d4aab" title=" " alt="" coords="301,31,364,56"/>
<area shape="poly" title=" " alt="" coords="114,82,285,49,286,55,115,87"/>
<area shape="rect" href="list_8c.html#a2c9f1765436e9a3631f048b71f17f33c" title=" " alt="" coords="167,107,248,132"/>
<area shape="poly" title=" " alt="" coords="115,101,152,107,151,113,114,106"/>
<area shape="rect" href="util__pkcs11_8c.html#a3754cf5cb42a5e282658cf94f405574e" title=" " alt="" coords="162,156,253,182"/>
<area shape="poly" title=" " alt="" coords="88,105,167,146,165,151,86,110"/>
<area shape="poly" title=" " alt="" coords="242,22,286,31,285,37,241,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util__pkcs11_8h_a85ea84ffb047281f34a733572f67b254_icgraph.png" border="0" usemap="#autil__pkcs11_8h_a85ea84ffb047281f34a733572f67b254_icgraph" alt=""/></div>
<map name="autil__pkcs11_8h_a85ea84ffb047281f34a733572f67b254_icgraph" id="autil__pkcs11_8h_a85ea84ffb047281f34a733572f67b254_icgraph">
<area shape="rect" title=" " alt="" coords="228,5,336,31"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae42be1463b17c635f1d1db61afc0db16" title=" " alt="" coords="5,5,180,31"/>
<area shape="poly" title=" " alt="" coords="212,21,180,21,180,16,212,16"/>
</map>
</div>

</div>
</div>
<a id="ac838a6fe508a988db853effa16513d28" name="ac838a6fe508a988db853effa16513d28"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac838a6fe508a988db853effa16513d28">&#9670;&#160;</a></span>destroy_session()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void destroy_session </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__pkcs11__context.html">yubihsm_pkcs11_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CK_SESSION_HANDLE</td>          <td class="paramname"><span class="paramname"><em>hSession</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="acf9d727a7620788445bc9ce264046b05" name="acf9d727a7620788445bc9ce264046b05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf9d727a7620788445bc9ce264046b05">&#9670;&#160;</a></span>digest_mechanism_cleanup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool digest_mechanism_cleanup </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__pkcs11__op__info.html">yubihsm_pkcs11_op_info</a> *</td>          <td class="paramname"><span class="paramname"><em>op_info</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="util__pkcs11_8c_source.html#l02573">2573</a> of file <a class="el" href="util__pkcs11_8c_source.html">util_pkcs11.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2573</span>                                                               {</div>
<div class="line"><span class="lineno"> 2574</span> </div>
<div class="line"><span class="lineno"> 2575</span>  <span class="keywordflow">if</span> (op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#a06ea7ebdd4f4e99dec979ed3576e5722">digest</a>.<a class="code hl_variable" href="structdigest__info.html#acf5534c1229554d54bf0e71dd544db81">md_ctx</a> != NULL) {</div>
<div class="line"><span class="lineno"> 2576</span>    EVP_MD_CTX_destroy(op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#a06ea7ebdd4f4e99dec979ed3576e5722">digest</a>.<a class="code hl_variable" href="structdigest__info.html#acf5534c1229554d54bf0e71dd544db81">md_ctx</a>);</div>
<div class="line"><span class="lineno"> 2577</span>    op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#a06ea7ebdd4f4e99dec979ed3576e5722">digest</a>.<a class="code hl_variable" href="structdigest__info.html#acf5534c1229554d54bf0e71dd544db81">md_ctx</a> = NULL;</div>
<div class="line"><span class="lineno"> 2578</span>  }</div>
<div class="line"><span class="lineno"> 2579</span> </div>
<div class="line"><span class="lineno"> 2580</span>  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2581</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="acc3b093830e7126a8655e9b8ec77ad10" name="acc3b093830e7126a8655e9b8ec77ad10"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc3b093830e7126a8655e9b8ec77ad10">&#9670;&#160;</a></span>get_attribute()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CK_RV get_attribute </td>
          <td>(</td>
          <td class="paramtype">CK_ATTRIBUTE_TYPE</td>          <td class="paramname"><span class="paramname"><em>type</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structyh__object__descriptor.html">yh_object_descriptor</a> *</td>          <td class="paramname"><span class="paramname"><em>object</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pkcs11_8h.html#a88e8d2cf99e26f3b3f86a0a698b0ab64">CK_VOID_PTR</a></td>          <td class="paramname"><span class="paramname"><em>value</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pkcs11_8h.html#a2c6426aaa1ca6dd1f48a01b8490482fa">CK_ULONG_PTR</a></td>          <td class="paramname"><span class="paramname"><em>length</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structyh__session.html">yh_session</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="util__pkcs11_8c_source.html#l01455">1455</a> of file <a class="el" href="util__pkcs11_8c_source.html">util_pkcs11.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1457</span>                                         {</div>
<div class="line"><span class="lineno"> 1458</span> </div>
<div class="line"><span class="lineno"> 1459</span>  <a class="code hl_typedef" href="pkcs11_8h.html#a51e605f881c86838bf12d70707b57b85">CK_BYTE</a> tmp[2048];</div>
<div class="line"><span class="lineno"> 1460</span>  <a class="code hl_typedef" href="pkcs11_8h.html#a88e8d2cf99e26f3b3f86a0a698b0ab64">CK_VOID_PTR</a> ptr;</div>
<div class="line"><span class="lineno"> 1461</span>  <span class="keywordflow">if</span> (<a class="code hl_define" href="pkcs11_8h.html#a32aff7c6c4cd253fdf6563677afab5ce">value</a> == NULL) {</div>
<div class="line"><span class="lineno"> 1462</span>    <span class="comment">// NOTE(adma): we just need the length, use a scratchpad for the data</span></div>
<div class="line"><span class="lineno"> 1463</span>    ptr = tmp;</div>
<div class="line"><span class="lineno"> 1464</span>    *length = <span class="keyword">sizeof</span>(tmp);</div>
<div class="line"><span class="lineno"> 1465</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1466</span>    <span class="comment">// NOTE(adma): otherwise actually save the data</span></div>
<div class="line"><span class="lineno"> 1467</span>    ptr = <a class="code hl_define" href="pkcs11_8h.html#a32aff7c6c4cd253fdf6563677afab5ce">value</a>;</div>
<div class="line"><span class="lineno"> 1468</span>  }</div>
<div class="line"><span class="lineno"> 1469</span> </div>
<div class="line"><span class="lineno"> 1470</span>  <span class="keywordflow">switch</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a85d991d90970121ba1480cd98d93aab9">object</a>-&gt;<a class="code hl_variable" href="structyh__object__descriptor.html#ab8c1b3cc5b859e3c89eb228fa0763165">type</a>) {</div>
<div class="line"><span class="lineno"> 1471</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583a5d37b7418d50b420621e6a6eb2700de4">YH_OPAQUE</a>:</div>
<div class="line"><span class="lineno"> 1472</span>      <span class="keywordflow">return</span> get_attribute_opaque(type, <span class="keywordtype">object</span>, ptr, length, <a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>);</div>
<div class="line"><span class="lineno"> 1473</span> </div>
<div class="line"><span class="lineno"> 1474</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583a16f0118db1dac3d0732e7d66630e1dba">YH_WRAP_KEY</a>:</div>
<div class="line"><span class="lineno"> 1475</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583a708d85f80fc33743ac26a7c3e43464a9">YH_HMAC_KEY</a>:</div>
<div class="line"><span class="lineno"> 1476</span>      <span class="keywordflow">return</span> get_attribute_secret_key(type, <span class="keywordtype">object</span>, ptr, length);</div>
<div class="line"><span class="lineno"> 1477</span> </div>
<div class="line"><span class="lineno"> 1478</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583ab71424e16384319d6e6a12f9a3d8ceae">YH_ASYMMETRIC_KEY</a>:</div>
<div class="line"><span class="lineno"> 1479</span>      <span class="keywordflow">return</span> get_attribute_private_key(type, <span class="keywordtype">object</span>, ptr, length, <a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>);</div>
<div class="line"><span class="lineno"> 1480</span>    <span class="keywordflow">case</span> 0x80 | <a class="code hl_enumvalue" href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583ab71424e16384319d6e6a12f9a3d8ceae">YH_ASYMMETRIC_KEY</a>:</div>
<div class="line"><span class="lineno"> 1481</span>      <span class="keywordflow">return</span> get_attribute_public_key(type, <span class="keywordtype">object</span>, ptr, length, <a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>);</div>
<div class="line"><span class="lineno"> 1482</span> </div>
<div class="line"><span class="lineno"> 1483</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583a96244762de5ce4175e60157239e7a097">YH_TEMPLATE</a>:</div>
<div class="line"><span class="lineno"> 1484</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583acee44b775b3c5b6157f0732699935074">YH_AUTHENTICATION_KEY</a>:</div>
<div class="line"><span class="lineno"> 1485</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583a02c5f683fde147de6a9e1043f971f5f0">YH_OTP_AEAD_KEY</a>:</div>
<div class="line"><span class="lineno"> 1486</span>      <span class="comment">// TODO: do something good here.</span></div>
<div class="line"><span class="lineno"> 1487</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1488</span>  } <span class="comment">// TODO(adma): try to check common attributes in some convenience function</span></div>
<div class="line"><span class="lineno"> 1489</span> </div>
<div class="line"><span class="lineno"> 1490</span>  <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>;</div>
<div class="line"><span class="lineno"> 1491</span>}</div>
<div class="ttc" id="apkcs11_8h_html_a32aff7c6c4cd253fdf6563677afab5ce"><div class="ttname"><a href="pkcs11_8h.html#a32aff7c6c4cd253fdf6563677afab5ce">value</a></div><div class="ttdeci">#define value</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00157">pkcs11.h:157</a></div></div>
<div class="ttc" id="apkcs11_8h_html_a51e605f881c86838bf12d70707b57b85"><div class="ttname"><a href="pkcs11_8h.html#a51e605f881c86838bf12d70707b57b85">CK_BYTE</a></div><div class="ttdeci">unsigned char CK_BYTE</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l01190">pkcs11.h:1190</a></div></div>
<div class="ttc" id="apkcs11_8h_html_a88e8d2cf99e26f3b3f86a0a698b0ab64"><div class="ttname"><a href="pkcs11_8h.html#a88e8d2cf99e26f3b3f86a0a698b0ab64">CK_VOID_PTR</a></div><div class="ttdeci">void * CK_VOID_PTR</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l01200">pkcs11.h:1200</a></div></div>
<div class="ttc" id="astructyh__object__descriptor_html_ab8c1b3cc5b859e3c89eb228fa0763165"><div class="ttname"><a href="structyh__object__descriptor.html#ab8c1b3cc5b859e3c89eb228fa0763165">yh_object_descriptor::type</a></div><div class="ttdeci">yh_object_type type</div><div class="ttdoc">Object type.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00550">yubihsm.h:550</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a2fe39512cb4df34b270a67dbb8e13583a02c5f683fde147de6a9e1043f971f5f0"><div class="ttname"><a href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583a02c5f683fde147de6a9e1043f971f5f0">YH_OTP_AEAD_KEY</a></div><div class="ttdeci">@ YH_OTP_AEAD_KEY</div><div class="ttdoc">OTP AEAD Key is a secret key used to decrypt Yubico OTP values.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00376">yubihsm.h:376</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a2fe39512cb4df34b270a67dbb8e13583a16f0118db1dac3d0732e7d66630e1dba"><div class="ttname"><a href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583a16f0118db1dac3d0732e7d66630e1dba">YH_WRAP_KEY</a></div><div class="ttdeci">@ YH_WRAP_KEY</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00369">yubihsm.h:369</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a2fe39512cb4df34b270a67dbb8e13583a5d37b7418d50b420621e6a6eb2700de4"><div class="ttname"><a href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583a5d37b7418d50b420621e6a6eb2700de4">YH_OPAQUE</a></div><div class="ttdeci">@ YH_OPAQUE</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00362">yubihsm.h:362</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a2fe39512cb4df34b270a67dbb8e13583a708d85f80fc33743ac26a7c3e43464a9"><div class="ttname"><a href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583a708d85f80fc33743ac26a7c3e43464a9">YH_HMAC_KEY</a></div><div class="ttdeci">@ YH_HMAC_KEY</div><div class="ttdoc">HMAC Key is a secret key used when computing and verifying HMAC signatures.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00371">yubihsm.h:371</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a2fe39512cb4df34b270a67dbb8e13583a96244762de5ce4175e60157239e7a097"><div class="ttname"><a href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583a96244762de5ce4175e60157239e7a097">YH_TEMPLATE</a></div><div class="ttdeci">@ YH_TEMPLATE</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00374">yubihsm.h:374</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a2fe39512cb4df34b270a67dbb8e13583ab71424e16384319d6e6a12f9a3d8ceae"><div class="ttname"><a href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583ab71424e16384319d6e6a12f9a3d8ceae">YH_ASYMMETRIC_KEY</a></div><div class="ttdeci">@ YH_ASYMMETRIC_KEY</div><div class="ttdoc">Asymmetric Key is the private key of an asymmetric key-pair.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00366">yubihsm.h:366</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a2fe39512cb4df34b270a67dbb8e13583acee44b775b3c5b6157f0732699935074"><div class="ttname"><a href="yubihsm_8h.html#a2fe39512cb4df34b270a67dbb8e13583acee44b775b3c5b6157f0732699935074">YH_AUTHENTICATION_KEY</a></div><div class="ttdeci">@ YH_AUTHENTICATION_KEY</div><div class="ttdoc">Authentication Key is used to establish Sessions with a device.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00364">yubihsm.h:364</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a85d991d90970121ba1480cd98d93aab9"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a85d991d90970121ba1480cd98d93aab9">object</a></div><div class="ttdeci">yh_object_descriptor object</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l01544">yubihsm_pkcs11.c:1544</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util__pkcs11_8h_acc3b093830e7126a8655e9b8ec77ad10_icgraph.png" border="0" usemap="#autil__pkcs11_8h_acc3b093830e7126a8655e9b8ec77ad10_icgraph" alt=""/></div>
<map name="autil__pkcs11_8h_acc3b093830e7126a8655e9b8ec77ad10_icgraph" id="autil__pkcs11_8h_acc3b093830e7126a8655e9b8ec77ad10_icgraph">
<area shape="rect" title=" " alt="" coords="181,5,274,31"/>
<area shape="rect" href="util__pkcs11_8c.html#a1a7af578cd3ef13f8ae12652086c7a18" title=" " alt="" coords="5,5,133,31"/>
<area shape="poly" title=" " alt="" coords="165,21,133,21,133,16,165,16"/>
</map>
</div>

</div>
</div>
<a id="a5c8c35826a58c280a290c49a5a1e5b03" name="a5c8c35826a58c280a290c49a5a1e5b03"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c8c35826a58c280a290c49a5a1e5b03">&#9670;&#160;</a></span>get_attribute_ecsession_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CK_RV get_attribute_ecsession_key </td>
          <td>(</td>
          <td class="paramtype">CK_ATTRIBUTE_TYPE</td>          <td class="paramname"><span class="paramname"><em>type</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structecdh__session__key.html">ecdh_session_key</a> *</td>          <td class="paramname"><span class="paramname"><em>key</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pkcs11_8h.html#a88e8d2cf99e26f3b3f86a0a698b0ab64">CK_VOID_PTR</a></td>          <td class="paramname"><span class="paramname"><em>value</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pkcs11_8h.html#a2c6426aaa1ca6dd1f48a01b8490482fa">CK_ULONG_PTR</a></td>          <td class="paramname"><span class="paramname"><em>length</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="util__pkcs11_8c_source.html#l01493">1493</a> of file <a class="el" href="util__pkcs11_8c_source.html">util_pkcs11.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1494</span>                                                                          {</div>
<div class="line"><span class="lineno"> 1495</span> </div>
<div class="line"><span class="lineno"> 1496</span>  <a class="code hl_typedef" href="pkcs11_8h.html#a51e605f881c86838bf12d70707b57b85">CK_BYTE</a> tmp[2048];</div>
<div class="line"><span class="lineno"> 1497</span>  <a class="code hl_typedef" href="pkcs11_8h.html#a88e8d2cf99e26f3b3f86a0a698b0ab64">CK_VOID_PTR</a> ptr;</div>
<div class="line"><span class="lineno"> 1498</span>  <span class="keywordflow">if</span> (<a class="code hl_define" href="pkcs11_8h.html#a32aff7c6c4cd253fdf6563677afab5ce">value</a> == NULL) {</div>
<div class="line"><span class="lineno"> 1499</span>    ptr = tmp;</div>
<div class="line"><span class="lineno"> 1500</span>    *length = <span class="keyword">sizeof</span>(tmp);</div>
<div class="line"><span class="lineno"> 1501</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1502</span>    ptr = <a class="code hl_define" href="pkcs11_8h.html#a32aff7c6c4cd253fdf6563677afab5ce">value</a>;</div>
<div class="line"><span class="lineno"> 1503</span>  }</div>
<div class="line"><span class="lineno"> 1504</span> </div>
<div class="line"><span class="lineno"> 1505</span>  <span class="keywordflow">switch</span> (type) {</div>
<div class="line"><span class="lineno"> 1506</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#af867d3ae9286fe0f8cab4995bb6af337">CKA_CLASS</a>:</div>
<div class="line"><span class="lineno"> 1507</span>      *((CK_OBJECT_CLASS *) ptr) = <a class="code hl_define" href="pkcs11_8h.html#a35306ac9f52ce0f9f45ac66b8bc4dcc7">CKO_SECRET_KEY</a>;</div>
<div class="line"><span class="lineno"> 1508</span>      *length = <span class="keyword">sizeof</span>(CK_OBJECT_CLASS);</div>
<div class="line"><span class="lineno"> 1509</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1510</span> </div>
<div class="line"><span class="lineno"> 1511</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#aa438b88cbcb8a921288eeefba5613274">CKA_KEY_TYPE</a>:</div>
<div class="line"><span class="lineno"> 1512</span>      *((CK_KEY_TYPE *) ptr) = <a class="code hl_define" href="pkcs11_8h.html#aaf8c226acc7ea8b6b9e021465b1ae65b">CKK_GENERIC_SECRET</a>;</div>
<div class="line"><span class="lineno"> 1513</span>      *length = <span class="keyword">sizeof</span>(CK_KEY_TYPE);</div>
<div class="line"><span class="lineno"> 1514</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1515</span> </div>
<div class="line"><span class="lineno"> 1516</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a2846a5a41835defa47716ccc3bcc4913">CKA_ID</a>: {</div>
<div class="line"><span class="lineno"> 1517</span>      CK_OBJECT_HANDLE *<span class="keywordtype">id</span> = ptr;</div>
<div class="line"><span class="lineno"> 1518</span>      *<span class="keywordtype">id</span> = key-&gt;id;</div>
<div class="line"><span class="lineno"> 1519</span>      *length = <span class="keyword">sizeof</span>(CK_OBJECT_HANDLE);</div>
<div class="line"><span class="lineno"> 1520</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1521</span>    }</div>
<div class="line"><span class="lineno"> 1522</span> </div>
<div class="line"><span class="lineno"> 1523</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#acf009a991c04b5c4305cc76356225aa7">CKA_LABEL</a>:</div>
<div class="line"><span class="lineno"> 1524</span>      *length = strlen(key-&gt;label);</div>
<div class="line"><span class="lineno"> 1525</span>      <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(ptr, key-&gt;label, *length);</div>
<div class="line"><span class="lineno"> 1526</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1527</span> </div>
<div class="line"><span class="lineno"> 1528</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a7f7089933d976e82f882eda6efcf7e66">CKA_LOCAL</a>:</div>
<div class="line"><span class="lineno"> 1529</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a05c1c460160443a739c6e0ce47ae3fc8">CKA_TOKEN</a>:</div>
<div class="line"><span class="lineno"> 1530</span>      *((<a class="code hl_typedef" href="pkcs11_8h.html#a9dc289e62be691f41a9c6b875789b1f2">CK_BBOOL</a> *) ptr) = <a class="code hl_define" href="pkcs11_8h.html#a1df8841072c48f0b511ccad3bbb25812">CK_FALSE</a>;</div>
<div class="line"><span class="lineno"> 1531</span>      *length = <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="pkcs11_8h.html#a9dc289e62be691f41a9c6b875789b1f2">CK_BBOOL</a>);</div>
<div class="line"><span class="lineno"> 1532</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1533</span> </div>
<div class="line"><span class="lineno"> 1534</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ab495c20657f01d79e1a6ca49d2c8472e">CKA_DESTROYABLE</a>:</div>
<div class="line"><span class="lineno"> 1535</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#acf37955a2a229d208289962c6f1183b8">CKA_EXTRACTABLE</a>:</div>
<div class="line"><span class="lineno"> 1536</span>      *((<a class="code hl_typedef" href="pkcs11_8h.html#a9dc289e62be691f41a9c6b875789b1f2">CK_BBOOL</a> *) ptr) = <a class="code hl_define" href="pkcs11_8h.html#a76edf786ed8cccb1b3d2cf9e9f0800cd">CK_TRUE</a>;</div>
<div class="line"><span class="lineno"> 1537</span>      *length = <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="pkcs11_8h.html#a9dc289e62be691f41a9c6b875789b1f2">CK_BBOOL</a>);</div>
<div class="line"><span class="lineno"> 1538</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1539</span> </div>
<div class="line"><span class="lineno"> 1540</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ab65b14615d388fc862c82a8d1e163f84">CKA_DERIVE</a>:</div>
<div class="line"><span class="lineno"> 1541</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a013b845980a36573e16b427bbf88117c">CKA_NEVER_EXTRACTABLE</a>:</div>
<div class="line"><span class="lineno"> 1542</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a5fe5fb4a38ca6781c50e4cba8a2af0d6">CKA_SENSITIVE</a>:</div>
<div class="line"><span class="lineno"> 1543</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ac103aa0452ee58ef0161eeab8283e419">CKA_ALWAYS_SENSITIVE</a>:</div>
<div class="line"><span class="lineno"> 1544</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a39688e3f665848ca7868f2ca37aa1aed">CKA_MODIFIABLE</a>:</div>
<div class="line"><span class="lineno"> 1545</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a92925cbe2a1b3d50dd56f8af0f770a69">CKA_COPYABLE</a>:</div>
<div class="line"><span class="lineno"> 1546</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a6ffd14ad7386d9aa7178e841a964a87e">CKA_SIGN</a>:</div>
<div class="line"><span class="lineno"> 1547</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a66386b8788c722385f26c73832bdab54">CKA_SIGN_RECOVER</a>:</div>
<div class="line"><span class="lineno"> 1548</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#aa50a7c624907155b7c12bbca983ca5a7">CKA_ALWAYS_AUTHENTICATE</a>:</div>
<div class="line"><span class="lineno"> 1549</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a9a9a988131e4e93d0758e43c555bdc97">CKA_UNWRAP</a>:</div>
<div class="line"><span class="lineno"> 1550</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#af7a34bb656aa7e2b7e813dab0a6ac7b7">CKA_WRAP</a>:</div>
<div class="line"><span class="lineno"> 1551</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a9e4fb07743f4dcca88f094f222725f73">CKA_WRAP_WITH_TRUSTED</a>:</div>
<div class="line"><span class="lineno"> 1552</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a84c89cd9def639cb4a58145063b7bd42">CKA_VERIFY</a>:</div>
<div class="line"><span class="lineno"> 1553</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ad427016a08d7b8f0d8fe910b907e9b44">CKA_ENCRYPT</a>:</div>
<div class="line"><span class="lineno"> 1554</span>      *((<a class="code hl_typedef" href="pkcs11_8h.html#a9dc289e62be691f41a9c6b875789b1f2">CK_BBOOL</a> *) ptr) = <a class="code hl_define" href="pkcs11_8h.html#a1df8841072c48f0b511ccad3bbb25812">CK_FALSE</a>;</div>
<div class="line"><span class="lineno"> 1555</span>      *length = <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="pkcs11_8h.html#a9dc289e62be691f41a9c6b875789b1f2">CK_BBOOL</a>);</div>
<div class="line"><span class="lineno"> 1556</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1557</span> </div>
<div class="line"><span class="lineno"> 1558</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a799f3b28e5c856ef4229d12257818841">CKA_VALUE</a>:</div>
<div class="line"><span class="lineno"> 1559</span>      <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(ptr, key-&gt;ecdh_key, key-&gt;len);</div>
<div class="line"><span class="lineno"> 1560</span>      *length = key-&gt;len;</div>
<div class="line"><span class="lineno"> 1561</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1562</span> </div>
<div class="line"><span class="lineno"> 1563</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 1564</span>      *length = <a class="code hl_define" href="pkcs11_8h.html#a76782288a47c99c6e6ff3dc667f0e3ef">CK_UNAVAILABLE_INFORMATION</a>;</div>
<div class="line"><span class="lineno"> 1565</span>      <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a0afbefc1a4ce05ba5faea1778eb602ca">CKR_ATTRIBUTE_TYPE_INVALID</a>;</div>
<div class="line"><span class="lineno"> 1566</span>  }</div>
<div class="line"><span class="lineno"> 1567</span> </div>
<div class="line"><span class="lineno"> 1568</span>  <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>;</div>
<div class="line"><span class="lineno"> 1569</span>}</div>
<div class="ttc" id="apkcs11_8h_html_a013b845980a36573e16b427bbf88117c"><div class="ttname"><a href="pkcs11_8h.html#a013b845980a36573e16b427bbf88117c">CKA_NEVER_EXTRACTABLE</a></div><div class="ttdeci">#define CKA_NEVER_EXTRACTABLE</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00417">pkcs11.h:417</a></div></div>
<div class="ttc" id="apkcs11_8h_html_a05c1c460160443a739c6e0ce47ae3fc8"><div class="ttname"><a href="pkcs11_8h.html#a05c1c460160443a739c6e0ce47ae3fc8">CKA_TOKEN</a></div><div class="ttdeci">#define CKA_TOKEN</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00364">pkcs11.h:364</a></div></div>
<div class="ttc" id="apkcs11_8h_html_a0afbefc1a4ce05ba5faea1778eb602ca"><div class="ttname"><a href="pkcs11_8h.html#a0afbefc1a4ce05ba5faea1778eb602ca">CKR_ATTRIBUTE_TYPE_INVALID</a></div><div class="ttdeci">#define CKR_ATTRIBUTE_TYPE_INVALID</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l01104">pkcs11.h:1104</a></div></div>
<div class="ttc" id="apkcs11_8h_html_a1df8841072c48f0b511ccad3bbb25812"><div class="ttname"><a href="pkcs11_8h.html#a1df8841072c48f0b511ccad3bbb25812">CK_FALSE</a></div><div class="ttdeci">#define CK_FALSE</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l01202">pkcs11.h:1202</a></div></div>
<div class="ttc" id="apkcs11_8h_html_a2846a5a41835defa47716ccc3bcc4913"><div class="ttname"><a href="pkcs11_8h.html#a2846a5a41835defa47716ccc3bcc4913">CKA_ID</a></div><div class="ttdeci">#define CKA_ID</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00385">pkcs11.h:385</a></div></div>
<div class="ttc" id="apkcs11_8h_html_a35306ac9f52ce0f9f45ac66b8bc4dcc7"><div class="ttname"><a href="pkcs11_8h.html#a35306ac9f52ce0f9f45ac66b8bc4dcc7">CKO_SECRET_KEY</a></div><div class="ttdeci">#define CKO_SECRET_KEY</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00304">pkcs11.h:304</a></div></div>
<div class="ttc" id="apkcs11_8h_html_a39688e3f665848ca7868f2ca37aa1aed"><div class="ttname"><a href="pkcs11_8h.html#a39688e3f665848ca7868f2ca37aa1aed">CKA_MODIFIABLE</a></div><div class="ttdeci">#define CKA_MODIFIABLE</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00420">pkcs11.h:420</a></div></div>
<div class="ttc" id="apkcs11_8h_html_a5fe5fb4a38ca6781c50e4cba8a2af0d6"><div class="ttname"><a href="pkcs11_8h.html#a5fe5fb4a38ca6781c50e4cba8a2af0d6">CKA_SENSITIVE</a></div><div class="ttdeci">#define CKA_SENSITIVE</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00386">pkcs11.h:386</a></div></div>
<div class="ttc" id="apkcs11_8h_html_a66386b8788c722385f26c73832bdab54"><div class="ttname"><a href="pkcs11_8h.html#a66386b8788c722385f26c73832bdab54">CKA_SIGN_RECOVER</a></div><div class="ttdeci">#define CKA_SIGN_RECOVER</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00392">pkcs11.h:392</a></div></div>
<div class="ttc" id="apkcs11_8h_html_a6ffd14ad7386d9aa7178e841a964a87e"><div class="ttname"><a href="pkcs11_8h.html#a6ffd14ad7386d9aa7178e841a964a87e">CKA_SIGN</a></div><div class="ttdeci">#define CKA_SIGN</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00391">pkcs11.h:391</a></div></div>
<div class="ttc" id="apkcs11_8h_html_a76782288a47c99c6e6ff3dc667f0e3ef"><div class="ttname"><a href="pkcs11_8h.html#a76782288a47c99c6e6ff3dc667f0e3ef">CK_UNAVAILABLE_INFORMATION</a></div><div class="ttdeci">#define CK_UNAVAILABLE_INFORMATION</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00265">pkcs11.h:265</a></div></div>
<div class="ttc" id="apkcs11_8h_html_a76edf786ed8cccb1b3d2cf9e9f0800cd"><div class="ttname"><a href="pkcs11_8h.html#a76edf786ed8cccb1b3d2cf9e9f0800cd">CK_TRUE</a></div><div class="ttdeci">#define CK_TRUE</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l01203">pkcs11.h:1203</a></div></div>
<div class="ttc" id="apkcs11_8h_html_a799f3b28e5c856ef4229d12257818841"><div class="ttname"><a href="pkcs11_8h.html#a799f3b28e5c856ef4229d12257818841">CKA_VALUE</a></div><div class="ttdeci">#define CKA_VALUE</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00368">pkcs11.h:368</a></div></div>
<div class="ttc" id="apkcs11_8h_html_a7f7089933d976e82f882eda6efcf7e66"><div class="ttname"><a href="pkcs11_8h.html#a7f7089933d976e82f882eda6efcf7e66">CKA_LOCAL</a></div><div class="ttdeci">#define CKA_LOCAL</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00416">pkcs11.h:416</a></div></div>
<div class="ttc" id="apkcs11_8h_html_a84c89cd9def639cb4a58145063b7bd42"><div class="ttname"><a href="pkcs11_8h.html#a84c89cd9def639cb4a58145063b7bd42">CKA_VERIFY</a></div><div class="ttdeci">#define CKA_VERIFY</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00393">pkcs11.h:393</a></div></div>
<div class="ttc" id="apkcs11_8h_html_a92925cbe2a1b3d50dd56f8af0f770a69"><div class="ttname"><a href="pkcs11_8h.html#a92925cbe2a1b3d50dd56f8af0f770a69">CKA_COPYABLE</a></div><div class="ttdeci">#define CKA_COPYABLE</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00421">pkcs11.h:421</a></div></div>
<div class="ttc" id="apkcs11_8h_html_a9a9a988131e4e93d0758e43c555bdc97"><div class="ttname"><a href="pkcs11_8h.html#a9a9a988131e4e93d0758e43c555bdc97">CKA_UNWRAP</a></div><div class="ttdeci">#define CKA_UNWRAP</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00390">pkcs11.h:390</a></div></div>
<div class="ttc" id="apkcs11_8h_html_a9dc289e62be691f41a9c6b875789b1f2"><div class="ttname"><a href="pkcs11_8h.html#a9dc289e62be691f41a9c6b875789b1f2">CK_BBOOL</a></div><div class="ttdeci">unsigned char CK_BBOOL</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l01193">pkcs11.h:1193</a></div></div>
<div class="ttc" id="apkcs11_8h_html_a9e4fb07743f4dcca88f094f222725f73"><div class="ttname"><a href="pkcs11_8h.html#a9e4fb07743f4dcca88f094f222725f73">CKA_WRAP_WITH_TRUSTED</a></div><div class="ttdeci">#define CKA_WRAP_WITH_TRUSTED</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00429">pkcs11.h:429</a></div></div>
<div class="ttc" id="apkcs11_8h_html_aa438b88cbcb8a921288eeefba5613274"><div class="ttname"><a href="pkcs11_8h.html#aa438b88cbcb8a921288eeefba5613274">CKA_KEY_TYPE</a></div><div class="ttdeci">#define CKA_KEY_TYPE</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00383">pkcs11.h:383</a></div></div>
<div class="ttc" id="apkcs11_8h_html_aa50a7c624907155b7c12bbca983ca5a7"><div class="ttname"><a href="pkcs11_8h.html#aa50a7c624907155b7c12bbca983ca5a7">CKA_ALWAYS_AUTHENTICATE</a></div><div class="ttdeci">#define CKA_ALWAYS_AUTHENTICATE</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00428">pkcs11.h:428</a></div></div>
<div class="ttc" id="apkcs11_8h_html_aaf8c226acc7ea8b6b9e021465b1ae65b"><div class="ttname"><a href="pkcs11_8h.html#aaf8c226acc7ea8b6b9e021465b1ae65b">CKK_GENERIC_SECRET</a></div><div class="ttdeci">#define CKK_GENERIC_SECRET</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00326">pkcs11.h:326</a></div></div>
<div class="ttc" id="apkcs11_8h_html_ab495c20657f01d79e1a6ca49d2c8472e"><div class="ttname"><a href="pkcs11_8h.html#ab495c20657f01d79e1a6ca49d2c8472e">CKA_DESTROYABLE</a></div><div class="ttdeci">#define CKA_DESTROYABLE</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00422">pkcs11.h:422</a></div></div>
<div class="ttc" id="apkcs11_8h_html_ab65b14615d388fc862c82a8d1e163f84"><div class="ttname"><a href="pkcs11_8h.html#ab65b14615d388fc862c82a8d1e163f84">CKA_DERIVE</a></div><div class="ttdeci">#define CKA_DERIVE</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00395">pkcs11.h:395</a></div></div>
<div class="ttc" id="apkcs11_8h_html_ac103aa0452ee58ef0161eeab8283e419"><div class="ttname"><a href="pkcs11_8h.html#ac103aa0452ee58ef0161eeab8283e419">CKA_ALWAYS_SENSITIVE</a></div><div class="ttdeci">#define CKA_ALWAYS_SENSITIVE</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00418">pkcs11.h:418</a></div></div>
<div class="ttc" id="apkcs11_8h_html_acf009a991c04b5c4305cc76356225aa7"><div class="ttname"><a href="pkcs11_8h.html#acf009a991c04b5c4305cc76356225aa7">CKA_LABEL</a></div><div class="ttdeci">#define CKA_LABEL</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00366">pkcs11.h:366</a></div></div>
<div class="ttc" id="apkcs11_8h_html_acf37955a2a229d208289962c6f1183b8"><div class="ttname"><a href="pkcs11_8h.html#acf37955a2a229d208289962c6f1183b8">CKA_EXTRACTABLE</a></div><div class="ttdeci">#define CKA_EXTRACTABLE</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00415">pkcs11.h:415</a></div></div>
<div class="ttc" id="apkcs11_8h_html_ad427016a08d7b8f0d8fe910b907e9b44"><div class="ttname"><a href="pkcs11_8h.html#ad427016a08d7b8f0d8fe910b907e9b44">CKA_ENCRYPT</a></div><div class="ttdeci">#define CKA_ENCRYPT</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00387">pkcs11.h:387</a></div></div>
<div class="ttc" id="apkcs11_8h_html_af7a34bb656aa7e2b7e813dab0a6ac7b7"><div class="ttname"><a href="pkcs11_8h.html#af7a34bb656aa7e2b7e813dab0a6ac7b7">CKA_WRAP</a></div><div class="ttdeci">#define CKA_WRAP</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00389">pkcs11.h:389</a></div></div>
<div class="ttc" id="apkcs11_8h_html_af867d3ae9286fe0f8cab4995bb6af337"><div class="ttname"><a href="pkcs11_8h.html#af867d3ae9286fe0f8cab4995bb6af337">CKA_CLASS</a></div><div class="ttdeci">#define CKA_CLASS</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00363">pkcs11.h:363</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util__pkcs11_8h_a5c8c35826a58c280a290c49a5a1e5b03_cgraph.png" border="0" usemap="#autil__pkcs11_8h_a5c8c35826a58c280a290c49a5a1e5b03_cgraph" alt=""/></div>
<map name="autil__pkcs11_8h_a5c8c35826a58c280a290c49a5a1e5b03_cgraph" id="autil__pkcs11_8h_a5c8c35826a58c280a290c49a5a1e5b03_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,193,31"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="241,5,312,31"/>
<area shape="poly" title=" " alt="" coords="193,16,225,16,225,21,193,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util__pkcs11_8h_a5c8c35826a58c280a290c49a5a1e5b03_icgraph.png" border="0" usemap="#autil__pkcs11_8h_a5c8c35826a58c280a290c49a5a1e5b03_icgraph" alt=""/></div>
<map name="autil__pkcs11_8h_a5c8c35826a58c280a290c49a5a1e5b03_icgraph" id="autil__pkcs11_8h_a5c8c35826a58c280a290c49a5a1e5b03_icgraph">
<area shape="rect" title=" " alt="" coords="181,5,368,31"/>
<area shape="rect" href="util__pkcs11_8c.html#a1a7af578cd3ef13f8ae12652086c7a18" title=" " alt="" coords="5,5,133,31"/>
<area shape="poly" title=" " alt="" coords="165,21,133,21,133,16,165,16"/>
</map>
</div>

</div>
</div>
<a id="ac9a2fa09ddebb577ec5a919ad3a26d5d" name="ac9a2fa09ddebb577ec5a919ad3a26d5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9a2fa09ddebb577ec5a919ad3a26d5d">&#9670;&#160;</a></span>get_digest_bytelength()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pkcs11_8h.html#a35181858a3b7a0a81f49d180d8f446ef">CK_ULONG</a> get_digest_bytelength </td>
          <td>(</td>
          <td class="paramtype">CK_MECHANISM_TYPE</td>          <td class="paramname"><span class="paramname"><em>m</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="util__pkcs11_8c_source.html#l02583">2583</a> of file <a class="el" href="util__pkcs11_8c_source.html">util_pkcs11.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2583</span>                                                    {</div>
<div class="line"><span class="lineno"> 2584</span> </div>
<div class="line"><span class="lineno"> 2585</span>  <span class="keywordflow">switch</span> (m) {</div>
<div class="line"><span class="lineno"> 2586</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#af1818a1c453a84f01f2e868307ca8fed">CKM_SHA_1</a>:</div>
<div class="line"><span class="lineno"> 2587</span>      <span class="keywordflow">return</span> 20;</div>
<div class="line"><span class="lineno"> 2588</span> </div>
<div class="line"><span class="lineno"> 2589</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a4d11f88ae3bea2f748f275c03b54a648">CKM_SHA256</a>:</div>
<div class="line"><span class="lineno"> 2590</span>      <span class="keywordflow">return</span> 32;</div>
<div class="line"><span class="lineno"> 2591</span> </div>
<div class="line"><span class="lineno"> 2592</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a9278e01971ca83cdd07e4b8e07a00bc8">CKM_SHA384</a>:</div>
<div class="line"><span class="lineno"> 2593</span>      <span class="keywordflow">return</span> 48;</div>
<div class="line"><span class="lineno"> 2594</span> </div>
<div class="line"><span class="lineno"> 2595</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a9bf4bf7375a24e1010cc8e0139608fd5">CKM_SHA512</a>:</div>
<div class="line"><span class="lineno"> 2596</span>      <span class="keywordflow">return</span> 64;</div>
<div class="line"><span class="lineno"> 2597</span> </div>
<div class="line"><span class="lineno"> 2598</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 2599</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2600</span>  }</div>
<div class="line"><span class="lineno"> 2601</span> </div>
<div class="line"><span class="lineno"> 2602</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 2603</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a95f1c61424aa67f782a360e59c6cee84" name="a95f1c61424aa67f782a360e59c6cee84"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95f1c61424aa67f782a360e59c6cee84">&#9670;&#160;</a></span>get_mechanism_info()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool get_mechanism_info </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__pkcs11__slot.html">yubihsm_pkcs11_slot</a> *</td>          <td class="paramname"><span class="paramname"><em>slot</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CK_MECHANISM_TYPE</td>          <td class="paramname"><span class="paramname"><em>type</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pkcs11_8h.html#a19a155cbd39a0b5099741d385f1db7b9">CK_MECHANISM_INFO_PTR</a></td>          <td class="paramname"><span class="paramname"><em>pInfo</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="util__pkcs11_8c_source.html#l00313">313</a> of file <a class="el" href="util__pkcs11_8c_source.html">util_pkcs11.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  314</span>                                                     {</div>
<div class="line"><span class="lineno">  315</span> </div>
<div class="line"><span class="lineno">  316</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__slot.html#ac4313bd333015ea2ae50240ed379da60">n_algorithms</a> == 0) {</div>
<div class="line"><span class="lineno">  317</span>    <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__slot.html#ac4313bd333015ea2ae50240ed379da60">n_algorithms</a> = <span class="keyword">sizeof</span>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__slot.html#acc712b62a1eba2487a602bc84f2567cf">algorithms</a>) / <span class="keyword">sizeof</span>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__slot.html#acc712b62a1eba2487a602bc84f2567cf">algorithms</a>[0]);</div>
<div class="line"><span class="lineno">  318</span>    <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> =</div>
<div class="line"><span class="lineno">  319</span>      <a class="code hl_function" href="yubihsm_8c.html#a6ab558e1426359cc78e7a362f8b3acd9">yh_util_get_device_info</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__slot.html#a8022d3426b090c01b082636562f7c013">connector</a>, NULL, NULL, NULL, NULL, NULL,</div>
<div class="line"><span class="lineno">  320</span>                              NULL, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__slot.html#acc712b62a1eba2487a602bc84f2567cf">algorithms</a>, &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__slot.html#ac4313bd333015ea2ae50240ed379da60">n_algorithms</a>);</div>
<div class="line"><span class="lineno">  321</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno">  322</span>      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  323</span>    }</div>
<div class="line"><span class="lineno">  324</span>  }</div>
<div class="line"><span class="lineno">  325</span> </div>
<div class="line"><span class="lineno">  326</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a05dd610acfc36d8ca4581d4d22ae1521">pInfo</a>-&gt;<a class="code hl_variable" href="structck__slot__info.html#ad23902c9bb73c7da64bb65cb4f9bea4f">flags</a> = 0;</div>
<div class="line"><span class="lineno">  327</span>  <span class="keywordflow">switch</span> (type) {</div>
<div class="line"><span class="lineno">  328</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a08a8e0f2109de3ff3bfe26f220447a2e">CKM_RSA_PKCS</a>:</div>
<div class="line"><span class="lineno">  329</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a05dd610acfc36d8ca4581d4d22ae1521">pInfo</a>-&gt;<a class="code hl_variable" href="structck__slot__info.html#ad23902c9bb73c7da64bb65cb4f9bea4f">flags</a> = <a class="code hl_define" href="pkcs11_8h.html#acd1d6f14eb6ae040a3c7e015c7c1932a">CKF_DECRYPT</a>;</div>
<div class="line"><span class="lineno">  330</span> </div>
<div class="line"><span class="lineno">  331</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a9b5d495ac404ebbce07d1f58436ee31d">CKM_SHA1_RSA_PKCS</a>:</div>
<div class="line"><span class="lineno">  332</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ae24525658e8df0829c24236ee7614d1f">CKM_SHA256_RSA_PKCS</a>:</div>
<div class="line"><span class="lineno">  333</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ad8d3d34082b7e18f4f173804cf5b959b">CKM_SHA384_RSA_PKCS</a>:</div>
<div class="line"><span class="lineno">  334</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a6c0c89dfd22474095772f87d25c6a17d">CKM_SHA512_RSA_PKCS</a>:</div>
<div class="line"><span class="lineno">  335</span>      find_minmax_rsa_key_length_in_bits(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__slot.html#acc712b62a1eba2487a602bc84f2567cf">algorithms</a>, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__slot.html#ac4313bd333015ea2ae50240ed379da60">n_algorithms</a>,</div>
<div class="line"><span class="lineno">  336</span>                                         &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a05dd610acfc36d8ca4581d4d22ae1521">pInfo</a>-&gt;ulMinKeySize,</div>
<div class="line"><span class="lineno">  337</span>                                         &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a05dd610acfc36d8ca4581d4d22ae1521">pInfo</a>-&gt;ulMaxKeySize);</div>
<div class="line"><span class="lineno">  338</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a05dd610acfc36d8ca4581d4d22ae1521">pInfo</a>-&gt;<a class="code hl_variable" href="structck__slot__info.html#ad23902c9bb73c7da64bb65cb4f9bea4f">flags</a> |= <a class="code hl_define" href="pkcs11_8h.html#aea7a734e6feea5f300b8c188807b6f76">CKF_HW</a> | <a class="code hl_define" href="pkcs11_8h.html#aabafbd0a0b5159b08d81f4c63f8665e1">CKF_SIGN</a>;</div>
<div class="line"><span class="lineno">  339</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  340</span> </div>
<div class="line"><span class="lineno">  341</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ad4f5697408b23623c904df2b1ca8a9f1">CKM_RSA_PKCS_PSS</a>:</div>
<div class="line"><span class="lineno">  342</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ad5943f11b67c32a40d4d6687e9cbb64b">CKM_SHA1_RSA_PKCS_PSS</a>:</div>
<div class="line"><span class="lineno">  343</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ad336fbe2d222fc913c70dd56fabf7f7e">CKM_SHA256_RSA_PKCS_PSS</a>:</div>
<div class="line"><span class="lineno">  344</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ae5a8bfa905dc8dab5b2130a8bb6b23fb">CKM_SHA384_RSA_PKCS_PSS</a>:</div>
<div class="line"><span class="lineno">  345</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a67393bc84515cf68048ca3b3bb8b39a0">CKM_SHA512_RSA_PKCS_PSS</a>:</div>
<div class="line"><span class="lineno">  346</span>      find_minmax_rsa_key_length_in_bits(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__slot.html#acc712b62a1eba2487a602bc84f2567cf">algorithms</a>, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__slot.html#ac4313bd333015ea2ae50240ed379da60">n_algorithms</a>,</div>
<div class="line"><span class="lineno">  347</span>                                         &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a05dd610acfc36d8ca4581d4d22ae1521">pInfo</a>-&gt;ulMinKeySize,</div>
<div class="line"><span class="lineno">  348</span>                                         &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a05dd610acfc36d8ca4581d4d22ae1521">pInfo</a>-&gt;ulMaxKeySize);</div>
<div class="line"><span class="lineno">  349</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a05dd610acfc36d8ca4581d4d22ae1521">pInfo</a>-&gt;<a class="code hl_variable" href="structck__slot__info.html#ad23902c9bb73c7da64bb65cb4f9bea4f">flags</a> = <a class="code hl_define" href="pkcs11_8h.html#aea7a734e6feea5f300b8c188807b6f76">CKF_HW</a> | <a class="code hl_define" href="pkcs11_8h.html#aabafbd0a0b5159b08d81f4c63f8665e1">CKF_SIGN</a>;</div>
<div class="line"><span class="lineno">  350</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  351</span> </div>
<div class="line"><span class="lineno">  352</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a69da8859ad1e6b4f424d071b42ea4a0c">CKM_RSA_PKCS_OAEP</a>:</div>
<div class="line"><span class="lineno">  353</span>      find_minmax_rsa_key_length_in_bits(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__slot.html#acc712b62a1eba2487a602bc84f2567cf">algorithms</a>, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__slot.html#ac4313bd333015ea2ae50240ed379da60">n_algorithms</a>,</div>
<div class="line"><span class="lineno">  354</span>                                         &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a05dd610acfc36d8ca4581d4d22ae1521">pInfo</a>-&gt;ulMinKeySize,</div>
<div class="line"><span class="lineno">  355</span>                                         &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a05dd610acfc36d8ca4581d4d22ae1521">pInfo</a>-&gt;ulMaxKeySize);</div>
<div class="line"><span class="lineno">  356</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a05dd610acfc36d8ca4581d4d22ae1521">pInfo</a>-&gt;<a class="code hl_variable" href="structck__slot__info.html#ad23902c9bb73c7da64bb65cb4f9bea4f">flags</a> = <a class="code hl_define" href="pkcs11_8h.html#aea7a734e6feea5f300b8c188807b6f76">CKF_HW</a> | <a class="code hl_define" href="pkcs11_8h.html#acd1d6f14eb6ae040a3c7e015c7c1932a">CKF_DECRYPT</a>;</div>
<div class="line"><span class="lineno">  357</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  358</span> </div>
<div class="line"><span class="lineno">  359</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a3afa7970e62cb983de2f2b46af9ac43f">CKM_RSA_PKCS_KEY_PAIR_GEN</a>:</div>
<div class="line"><span class="lineno">  360</span>      find_minmax_rsa_key_length_in_bits(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__slot.html#acc712b62a1eba2487a602bc84f2567cf">algorithms</a>, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__slot.html#ac4313bd333015ea2ae50240ed379da60">n_algorithms</a>,</div>
<div class="line"><span class="lineno">  361</span>                                         &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a05dd610acfc36d8ca4581d4d22ae1521">pInfo</a>-&gt;ulMinKeySize,</div>
<div class="line"><span class="lineno">  362</span>                                         &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a05dd610acfc36d8ca4581d4d22ae1521">pInfo</a>-&gt;ulMaxKeySize);</div>
<div class="line"><span class="lineno">  363</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a05dd610acfc36d8ca4581d4d22ae1521">pInfo</a>-&gt;<a class="code hl_variable" href="structck__slot__info.html#ad23902c9bb73c7da64bb65cb4f9bea4f">flags</a> = <a class="code hl_define" href="pkcs11_8h.html#aea7a734e6feea5f300b8c188807b6f76">CKF_HW</a> | <a class="code hl_define" href="pkcs11_8h.html#a65d664264811a9964c30b46967f471d3">CKF_GENERATE_KEY_PAIR</a>;</div>
<div class="line"><span class="lineno">  364</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  365</span> </div>
<div class="line"><span class="lineno">  366</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a95733c79b5297ea9ac28476e680ad4fa">CKM_EC_KEY_PAIR_GEN</a>:</div>
<div class="line"><span class="lineno">  367</span>      find_minmax_ec_key_length_in_bits(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__slot.html#acc712b62a1eba2487a602bc84f2567cf">algorithms</a>, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__slot.html#ac4313bd333015ea2ae50240ed379da60">n_algorithms</a>,</div>
<div class="line"><span class="lineno">  368</span>                                        &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a05dd610acfc36d8ca4581d4d22ae1521">pInfo</a>-&gt;ulMinKeySize,</div>
<div class="line"><span class="lineno">  369</span>                                        &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a05dd610acfc36d8ca4581d4d22ae1521">pInfo</a>-&gt;ulMaxKeySize);</div>
<div class="line"><span class="lineno">  370</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a05dd610acfc36d8ca4581d4d22ae1521">pInfo</a>-&gt;<a class="code hl_variable" href="structck__slot__info.html#ad23902c9bb73c7da64bb65cb4f9bea4f">flags</a> = <a class="code hl_define" href="pkcs11_8h.html#aea7a734e6feea5f300b8c188807b6f76">CKF_HW</a> | <a class="code hl_define" href="pkcs11_8h.html#a65d664264811a9964c30b46967f471d3">CKF_GENERATE_KEY_PAIR</a> | <a class="code hl_define" href="pkcs11_8h.html#a605a609c288ffcd840a307f4d4458cbb">CKF_EC_F_P</a> |</div>
<div class="line"><span class="lineno">  371</span>                     <a class="code hl_define" href="pkcs11_8h.html#a827fe376bd75e653038cd5af22f8e069">CKF_EC_ECPARAMETERS</a> | <a class="code hl_define" href="pkcs11_8h.html#a1084ffbde21a69579b39084c3ec866de">CKF_EC_UNCOMPRESS</a>;</div>
<div class="line"><span class="lineno">  372</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  373</span> </div>
<div class="line"><span class="lineno">  374</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a1eb3f4cee46e624bfbbc6889e1e5bc06">CKM_SHA_1_HMAC</a>:</div>
<div class="line"><span class="lineno">  375</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a05dd610acfc36d8ca4581d4d22ae1521">pInfo</a>-&gt;ulMaxKeySize = 64 * 8;</div>
<div class="line"><span class="lineno">  376</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a05dd610acfc36d8ca4581d4d22ae1521">pInfo</a>-&gt;ulMinKeySize = 1;</div>
<div class="line"><span class="lineno">  377</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a05dd610acfc36d8ca4581d4d22ae1521">pInfo</a>-&gt;<a class="code hl_variable" href="structck__slot__info.html#ad23902c9bb73c7da64bb65cb4f9bea4f">flags</a> = <a class="code hl_define" href="pkcs11_8h.html#aea7a734e6feea5f300b8c188807b6f76">CKF_HW</a> | <a class="code hl_define" href="pkcs11_8h.html#aabafbd0a0b5159b08d81f4c63f8665e1">CKF_SIGN</a> | <a class="code hl_define" href="pkcs11_8h.html#a2abb8871b559a956beb841e811a0acf3">CKF_VERIFY</a>;</div>
<div class="line"><span class="lineno">  378</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  379</span> </div>
<div class="line"><span class="lineno">  380</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a839f51ab9e78e866f1d3773b8466b011">CKM_SHA256_HMAC</a>:</div>
<div class="line"><span class="lineno">  381</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a05dd610acfc36d8ca4581d4d22ae1521">pInfo</a>-&gt;ulMaxKeySize = 64 * 8;</div>
<div class="line"><span class="lineno">  382</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a05dd610acfc36d8ca4581d4d22ae1521">pInfo</a>-&gt;ulMinKeySize = 1;</div>
<div class="line"><span class="lineno">  383</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a05dd610acfc36d8ca4581d4d22ae1521">pInfo</a>-&gt;<a class="code hl_variable" href="structck__slot__info.html#ad23902c9bb73c7da64bb65cb4f9bea4f">flags</a> = <a class="code hl_define" href="pkcs11_8h.html#aea7a734e6feea5f300b8c188807b6f76">CKF_HW</a> | <a class="code hl_define" href="pkcs11_8h.html#aabafbd0a0b5159b08d81f4c63f8665e1">CKF_SIGN</a> | <a class="code hl_define" href="pkcs11_8h.html#a2abb8871b559a956beb841e811a0acf3">CKF_VERIFY</a>;</div>
<div class="line"><span class="lineno">  384</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  385</span> </div>
<div class="line"><span class="lineno">  386</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a97ee18b73f21e8047fadc8a0aa12f23a">CKM_SHA384_HMAC</a>:</div>
<div class="line"><span class="lineno">  387</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a05dd610acfc36d8ca4581d4d22ae1521">pInfo</a>-&gt;ulMaxKeySize = 128 * 8;</div>
<div class="line"><span class="lineno">  388</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a05dd610acfc36d8ca4581d4d22ae1521">pInfo</a>-&gt;ulMinKeySize = 1;</div>
<div class="line"><span class="lineno">  389</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a05dd610acfc36d8ca4581d4d22ae1521">pInfo</a>-&gt;<a class="code hl_variable" href="structck__slot__info.html#ad23902c9bb73c7da64bb65cb4f9bea4f">flags</a> = <a class="code hl_define" href="pkcs11_8h.html#aea7a734e6feea5f300b8c188807b6f76">CKF_HW</a> | <a class="code hl_define" href="pkcs11_8h.html#aabafbd0a0b5159b08d81f4c63f8665e1">CKF_SIGN</a> | <a class="code hl_define" href="pkcs11_8h.html#a2abb8871b559a956beb841e811a0acf3">CKF_VERIFY</a>;</div>
<div class="line"><span class="lineno">  390</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  391</span> </div>
<div class="line"><span class="lineno">  392</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ae1b850f9141aa407e45b02fa3ade3759">CKM_SHA512_HMAC</a>:</div>
<div class="line"><span class="lineno">  393</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a05dd610acfc36d8ca4581d4d22ae1521">pInfo</a>-&gt;ulMaxKeySize = 128 * 8;</div>
<div class="line"><span class="lineno">  394</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a05dd610acfc36d8ca4581d4d22ae1521">pInfo</a>-&gt;ulMinKeySize = 1;</div>
<div class="line"><span class="lineno">  395</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a05dd610acfc36d8ca4581d4d22ae1521">pInfo</a>-&gt;<a class="code hl_variable" href="structck__slot__info.html#ad23902c9bb73c7da64bb65cb4f9bea4f">flags</a> = <a class="code hl_define" href="pkcs11_8h.html#aea7a734e6feea5f300b8c188807b6f76">CKF_HW</a> | <a class="code hl_define" href="pkcs11_8h.html#aabafbd0a0b5159b08d81f4c63f8665e1">CKF_SIGN</a> | <a class="code hl_define" href="pkcs11_8h.html#a2abb8871b559a956beb841e811a0acf3">CKF_VERIFY</a>;</div>
<div class="line"><span class="lineno">  396</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  397</span> </div>
<div class="line"><span class="lineno">  398</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ab4a7299a144f0ef52cee06893cc60483">CKM_ECDSA</a>:</div>
<div class="line"><span class="lineno">  399</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a0911727b2cd926b9209f24bf50bc555a">CKM_ECDSA_SHA1</a>:</div>
<div class="line"><span class="lineno">  400</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ac7f12f2ee83f0ca3b309b22e5b48e486">CKM_ECDSA_SHA256</a>:</div>
<div class="line"><span class="lineno">  401</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ab4aaed0f4b4146b812c6cff25828fcfd">CKM_ECDSA_SHA384</a>:</div>
<div class="line"><span class="lineno">  402</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a69a7674eee1a8069128923037b504e59">CKM_ECDSA_SHA512</a>:</div>
<div class="line"><span class="lineno">  403</span>      <span class="comment">// should all ecdsa mechanisms have all keylengths? or should they be</span></div>
<div class="line"><span class="lineno">  404</span>      <span class="comment">// bounded to length of hash?</span></div>
<div class="line"><span class="lineno">  405</span>      find_minmax_ec_key_length_in_bits(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__slot.html#acc712b62a1eba2487a602bc84f2567cf">algorithms</a>, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__slot.html#ac4313bd333015ea2ae50240ed379da60">n_algorithms</a>,</div>
<div class="line"><span class="lineno">  406</span>                                        &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a05dd610acfc36d8ca4581d4d22ae1521">pInfo</a>-&gt;ulMinKeySize,</div>
<div class="line"><span class="lineno">  407</span>                                        &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a05dd610acfc36d8ca4581d4d22ae1521">pInfo</a>-&gt;ulMaxKeySize);</div>
<div class="line"><span class="lineno">  408</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a05dd610acfc36d8ca4581d4d22ae1521">pInfo</a>-&gt;<a class="code hl_variable" href="structck__slot__info.html#ad23902c9bb73c7da64bb65cb4f9bea4f">flags</a> = <a class="code hl_define" href="pkcs11_8h.html#aea7a734e6feea5f300b8c188807b6f76">CKF_HW</a> | <a class="code hl_define" href="pkcs11_8h.html#aabafbd0a0b5159b08d81f4c63f8665e1">CKF_SIGN</a> | <a class="code hl_define" href="pkcs11_8h.html#a605a609c288ffcd840a307f4d4458cbb">CKF_EC_F_P</a> | <a class="code hl_define" href="pkcs11_8h.html#a827fe376bd75e653038cd5af22f8e069">CKF_EC_ECPARAMETERS</a> |</div>
<div class="line"><span class="lineno">  409</span>                     <a class="code hl_define" href="pkcs11_8h.html#a1084ffbde21a69579b39084c3ec866de">CKF_EC_UNCOMPRESS</a>;</div>
<div class="line"><span class="lineno">  410</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  411</span> </div>
<div class="line"><span class="lineno">  412</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a2d5867eec8e2621a31f108010f2dce97">CKM_ECDH1_DERIVE</a>:</div>
<div class="line"><span class="lineno">  413</span>      find_minmax_ec_key_length_in_bits(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__slot.html#acc712b62a1eba2487a602bc84f2567cf">algorithms</a>, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__slot.html#ac4313bd333015ea2ae50240ed379da60">n_algorithms</a>,</div>
<div class="line"><span class="lineno">  414</span>                                        &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a05dd610acfc36d8ca4581d4d22ae1521">pInfo</a>-&gt;ulMinKeySize,</div>
<div class="line"><span class="lineno">  415</span>                                        &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a05dd610acfc36d8ca4581d4d22ae1521">pInfo</a>-&gt;ulMaxKeySize);</div>
<div class="line"><span class="lineno">  416</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a05dd610acfc36d8ca4581d4d22ae1521">pInfo</a>-&gt;<a class="code hl_variable" href="structck__slot__info.html#ad23902c9bb73c7da64bb65cb4f9bea4f">flags</a> = <a class="code hl_define" href="pkcs11_8h.html#aea7a734e6feea5f300b8c188807b6f76">CKF_HW</a> | <a class="code hl_define" href="pkcs11_8h.html#a23c6556641b62243c52ddc5f683889e5">CKF_DERIVE</a> | <a class="code hl_define" href="pkcs11_8h.html#a605a609c288ffcd840a307f4d4458cbb">CKF_EC_F_P</a> | <a class="code hl_define" href="pkcs11_8h.html#a827fe376bd75e653038cd5af22f8e069">CKF_EC_ECPARAMETERS</a> |</div>
<div class="line"><span class="lineno">  417</span>                     <a class="code hl_define" href="pkcs11_8h.html#a1084ffbde21a69579b39084c3ec866de">CKF_EC_UNCOMPRESS</a>;</div>
<div class="line"><span class="lineno">  418</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  419</span> </div>
<div class="line"><span class="lineno">  420</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#af1818a1c453a84f01f2e868307ca8fed">CKM_SHA_1</a>:</div>
<div class="line"><span class="lineno">  421</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a05dd610acfc36d8ca4581d4d22ae1521">pInfo</a>-&gt;ulMaxKeySize = 0; <span class="comment">// NOTE(adma): ignored</span></div>
<div class="line"><span class="lineno">  422</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a05dd610acfc36d8ca4581d4d22ae1521">pInfo</a>-&gt;ulMinKeySize = 0; <span class="comment">// NOTE(adma): ignored</span></div>
<div class="line"><span class="lineno">  423</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a05dd610acfc36d8ca4581d4d22ae1521">pInfo</a>-&gt;<a class="code hl_variable" href="structck__slot__info.html#ad23902c9bb73c7da64bb65cb4f9bea4f">flags</a> = <a class="code hl_define" href="pkcs11_8h.html#a229d4341889a170fb829e3a63736c202">CKF_DIGEST</a>;</div>
<div class="line"><span class="lineno">  424</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  425</span> </div>
<div class="line"><span class="lineno">  426</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a4d11f88ae3bea2f748f275c03b54a648">CKM_SHA256</a>:</div>
<div class="line"><span class="lineno">  427</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a05dd610acfc36d8ca4581d4d22ae1521">pInfo</a>-&gt;ulMaxKeySize = 0; <span class="comment">// NOTE(adma): ignored</span></div>
<div class="line"><span class="lineno">  428</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a05dd610acfc36d8ca4581d4d22ae1521">pInfo</a>-&gt;ulMinKeySize = 0; <span class="comment">// NOTE(adma): ignored</span></div>
<div class="line"><span class="lineno">  429</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a05dd610acfc36d8ca4581d4d22ae1521">pInfo</a>-&gt;<a class="code hl_variable" href="structck__slot__info.html#ad23902c9bb73c7da64bb65cb4f9bea4f">flags</a> = <a class="code hl_define" href="pkcs11_8h.html#a229d4341889a170fb829e3a63736c202">CKF_DIGEST</a>;</div>
<div class="line"><span class="lineno">  430</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  431</span> </div>
<div class="line"><span class="lineno">  432</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a9278e01971ca83cdd07e4b8e07a00bc8">CKM_SHA384</a>:</div>
<div class="line"><span class="lineno">  433</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a05dd610acfc36d8ca4581d4d22ae1521">pInfo</a>-&gt;ulMaxKeySize = 0; <span class="comment">// NOTE(adma): ignored</span></div>
<div class="line"><span class="lineno">  434</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a05dd610acfc36d8ca4581d4d22ae1521">pInfo</a>-&gt;ulMinKeySize = 0; <span class="comment">// NOTE(adma): ignored</span></div>
<div class="line"><span class="lineno">  435</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a05dd610acfc36d8ca4581d4d22ae1521">pInfo</a>-&gt;<a class="code hl_variable" href="structck__slot__info.html#ad23902c9bb73c7da64bb65cb4f9bea4f">flags</a> = <a class="code hl_define" href="pkcs11_8h.html#a229d4341889a170fb829e3a63736c202">CKF_DIGEST</a>;</div>
<div class="line"><span class="lineno">  436</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  437</span> </div>
<div class="line"><span class="lineno">  438</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a9bf4bf7375a24e1010cc8e0139608fd5">CKM_SHA512</a>:</div>
<div class="line"><span class="lineno">  439</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a05dd610acfc36d8ca4581d4d22ae1521">pInfo</a>-&gt;ulMaxKeySize = 0; <span class="comment">// NOTE(adma): ignored</span></div>
<div class="line"><span class="lineno">  440</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a05dd610acfc36d8ca4581d4d22ae1521">pInfo</a>-&gt;ulMinKeySize = 0; <span class="comment">// NOTE(adma): ignored</span></div>
<div class="line"><span class="lineno">  441</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a05dd610acfc36d8ca4581d4d22ae1521">pInfo</a>-&gt;<a class="code hl_variable" href="structck__slot__info.html#ad23902c9bb73c7da64bb65cb4f9bea4f">flags</a> = <a class="code hl_define" href="pkcs11_8h.html#a229d4341889a170fb829e3a63736c202">CKF_DIGEST</a>;</div>
<div class="line"><span class="lineno">  442</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  443</span> </div>
<div class="line"><span class="lineno">  444</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11y_8h.html#a631efbda997696a7f7ce71df0e3e779a">CKM_YUBICO_AES_CCM_WRAP</a>:</div>
<div class="line"><span class="lineno">  445</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a05dd610acfc36d8ca4581d4d22ae1521">pInfo</a>-&gt;ulMaxKeySize = 256;</div>
<div class="line"><span class="lineno">  446</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a05dd610acfc36d8ca4581d4d22ae1521">pInfo</a>-&gt;ulMinKeySize = 128;</div>
<div class="line"><span class="lineno">  447</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a05dd610acfc36d8ca4581d4d22ae1521">pInfo</a>-&gt;<a class="code hl_variable" href="structck__slot__info.html#ad23902c9bb73c7da64bb65cb4f9bea4f">flags</a> = <a class="code hl_define" href="pkcs11_8h.html#aea7a734e6feea5f300b8c188807b6f76">CKF_HW</a> | <a class="code hl_define" href="pkcs11_8h.html#a59bfbfe9b1d0e00f597c24ef0298800e">CKF_WRAP</a> | <a class="code hl_define" href="pkcs11_8h.html#ac2643984bf74f2cb5809609bbd65139c">CKF_UNWRAP</a> | <a class="code hl_define" href="pkcs11_8h.html#a7dde8a50600132eb8094044d1f0998d2">CKF_ENCRYPT</a> | <a class="code hl_define" href="pkcs11_8h.html#acd1d6f14eb6ae040a3c7e015c7c1932a">CKF_DECRYPT</a>;</div>
<div class="line"><span class="lineno">  448</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  449</span> </div>
<div class="line"><span class="lineno">  450</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a8eb5ca4355d60dcf974107f95e38784b">CKM_GENERIC_SECRET_KEY_GEN</a>:</div>
<div class="line"><span class="lineno">  451</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a05dd610acfc36d8ca4581d4d22ae1521">pInfo</a>-&gt;ulMaxKeySize =</div>
<div class="line"><span class="lineno">  452</span>        128 * 8; <span class="comment">// NOTE: 128*8 is max key size for sha512-hmac keys</span></div>
<div class="line"><span class="lineno">  453</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a05dd610acfc36d8ca4581d4d22ae1521">pInfo</a>-&gt;ulMinKeySize = 1;</div>
<div class="line"><span class="lineno">  454</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a05dd610acfc36d8ca4581d4d22ae1521">pInfo</a>-&gt;<a class="code hl_variable" href="structck__slot__info.html#ad23902c9bb73c7da64bb65cb4f9bea4f">flags</a> = <a class="code hl_define" href="pkcs11_8h.html#aea7a734e6feea5f300b8c188807b6f76">CKF_HW</a> | <a class="code hl_define" href="pkcs11_8h.html#aad6849aadd67cb59175fc72c854d033a">CKF_GENERATE</a>;</div>
<div class="line"><span class="lineno">  455</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  456</span> </div>
<div class="line"><span class="lineno">  457</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">  458</span>      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  459</span>  }</div>
<div class="line"><span class="lineno">  460</span> </div>
<div class="line"><span class="lineno">  461</span>  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  462</span>}</div>
<div class="ttc" id="apkcs11_8h_html_a1084ffbde21a69579b39084c3ec866de"><div class="ttname"><a href="pkcs11_8h.html#a1084ffbde21a69579b39084c3ec866de">CKF_EC_UNCOMPRESS</a></div><div class="ttdeci">#define CKF_EC_UNCOMPRESS</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00725">pkcs11.h:725</a></div></div>
<div class="ttc" id="apkcs11_8h_html_a229d4341889a170fb829e3a63736c202"><div class="ttname"><a href="pkcs11_8h.html#a229d4341889a170fb829e3a63736c202">CKF_DIGEST</a></div><div class="ttdeci">#define CKF_DIGEST</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00709">pkcs11.h:709</a></div></div>
<div class="ttc" id="apkcs11_8h_html_a23c6556641b62243c52ddc5f683889e5"><div class="ttname"><a href="pkcs11_8h.html#a23c6556641b62243c52ddc5f683889e5">CKF_DERIVE</a></div><div class="ttdeci">#define CKF_DERIVE</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00718">pkcs11.h:718</a></div></div>
<div class="ttc" id="apkcs11_8h_html_a2abb8871b559a956beb841e811a0acf3"><div class="ttname"><a href="pkcs11_8h.html#a2abb8871b559a956beb841e811a0acf3">CKF_VERIFY</a></div><div class="ttdeci">#define CKF_VERIFY</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00712">pkcs11.h:712</a></div></div>
<div class="ttc" id="apkcs11_8h_html_a2d5867eec8e2621a31f108010f2dce97"><div class="ttname"><a href="pkcs11_8h.html#a2d5867eec8e2621a31f108010f2dce97">CKM_ECDH1_DERIVE</a></div><div class="ttdeci">#define CKM_ECDH1_DERIVE</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00652">pkcs11.h:652</a></div></div>
<div class="ttc" id="apkcs11_8h_html_a3afa7970e62cb983de2f2b46af9ac43f"><div class="ttname"><a href="pkcs11_8h.html#a3afa7970e62cb983de2f2b46af9ac43f">CKM_RSA_PKCS_KEY_PAIR_GEN</a></div><div class="ttdeci">#define CKM_RSA_PKCS_KEY_PAIR_GEN</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00469">pkcs11.h:469</a></div></div>
<div class="ttc" id="apkcs11_8h_html_a59bfbfe9b1d0e00f597c24ef0298800e"><div class="ttname"><a href="pkcs11_8h.html#a59bfbfe9b1d0e00f597c24ef0298800e">CKF_WRAP</a></div><div class="ttdeci">#define CKF_WRAP</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00716">pkcs11.h:716</a></div></div>
<div class="ttc" id="apkcs11_8h_html_a605a609c288ffcd840a307f4d4458cbb"><div class="ttname"><a href="pkcs11_8h.html#a605a609c288ffcd840a307f4d4458cbb">CKF_EC_F_P</a></div><div class="ttdeci">#define CKF_EC_F_P</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00721">pkcs11.h:721</a></div></div>
<div class="ttc" id="apkcs11_8h_html_a65d664264811a9964c30b46967f471d3"><div class="ttname"><a href="pkcs11_8h.html#a65d664264811a9964c30b46967f471d3">CKF_GENERATE_KEY_PAIR</a></div><div class="ttdeci">#define CKF_GENERATE_KEY_PAIR</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00715">pkcs11.h:715</a></div></div>
<div class="ttc" id="apkcs11_8h_html_a7dde8a50600132eb8094044d1f0998d2"><div class="ttname"><a href="pkcs11_8h.html#a7dde8a50600132eb8094044d1f0998d2">CKF_ENCRYPT</a></div><div class="ttdeci">#define CKF_ENCRYPT</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00707">pkcs11.h:707</a></div></div>
<div class="ttc" id="apkcs11_8h_html_a827fe376bd75e653038cd5af22f8e069"><div class="ttname"><a href="pkcs11_8h.html#a827fe376bd75e653038cd5af22f8e069">CKF_EC_ECPARAMETERS</a></div><div class="ttdeci">#define CKF_EC_ECPARAMETERS</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00723">pkcs11.h:723</a></div></div>
<div class="ttc" id="apkcs11_8h_html_a8eb5ca4355d60dcf974107f95e38784b"><div class="ttname"><a href="pkcs11_8h.html#a8eb5ca4355d60dcf974107f95e38784b">CKM_GENERIC_SECRET_KEY_GEN</a></div><div class="ttdeci">#define CKM_GENERIC_SECRET_KEY_GEN</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00586">pkcs11.h:586</a></div></div>
<div class="ttc" id="apkcs11_8h_html_a95733c79b5297ea9ac28476e680ad4fa"><div class="ttname"><a href="pkcs11_8h.html#a95733c79b5297ea9ac28476e680ad4fa">CKM_EC_KEY_PAIR_GEN</a></div><div class="ttdeci">#define CKM_EC_KEY_PAIR_GEN</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00645">pkcs11.h:645</a></div></div>
<div class="ttc" id="apkcs11_8h_html_aabafbd0a0b5159b08d81f4c63f8665e1"><div class="ttname"><a href="pkcs11_8h.html#aabafbd0a0b5159b08d81f4c63f8665e1">CKF_SIGN</a></div><div class="ttdeci">#define CKF_SIGN</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00710">pkcs11.h:710</a></div></div>
<div class="ttc" id="apkcs11_8h_html_aad6849aadd67cb59175fc72c854d033a"><div class="ttname"><a href="pkcs11_8h.html#aad6849aadd67cb59175fc72c854d033a">CKF_GENERATE</a></div><div class="ttdeci">#define CKF_GENERATE</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00714">pkcs11.h:714</a></div></div>
<div class="ttc" id="apkcs11_8h_html_ac2643984bf74f2cb5809609bbd65139c"><div class="ttname"><a href="pkcs11_8h.html#ac2643984bf74f2cb5809609bbd65139c">CKF_UNWRAP</a></div><div class="ttdeci">#define CKF_UNWRAP</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00717">pkcs11.h:717</a></div></div>
<div class="ttc" id="apkcs11_8h_html_acd1d6f14eb6ae040a3c7e015c7c1932a"><div class="ttname"><a href="pkcs11_8h.html#acd1d6f14eb6ae040a3c7e015c7c1932a">CKF_DECRYPT</a></div><div class="ttdeci">#define CKF_DECRYPT</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00708">pkcs11.h:708</a></div></div>
<div class="ttc" id="apkcs11_8h_html_aea7a734e6feea5f300b8c188807b6f76"><div class="ttname"><a href="pkcs11_8h.html#aea7a734e6feea5f300b8c188807b6f76">CKF_HW</a></div><div class="ttdeci">#define CKF_HW</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00706">pkcs11.h:706</a></div></div>
<div class="ttc" id="astructck__slot__info_html_ad23902c9bb73c7da64bb65cb4f9bea4f"><div class="ttname"><a href="structck__slot__info.html#ad23902c9bb73c7da64bb65cb4f9bea4f">ck_slot_info::flags</a></div><div class="ttdeci">ck_flags_t flags</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00215">pkcs11.h:215</a></div></div>
<div class="ttc" id="astructyubihsm__pkcs11__slot_html_ac4313bd333015ea2ae50240ed379da60"><div class="ttname"><a href="structyubihsm__pkcs11__slot.html#ac4313bd333015ea2ae50240ed379da60">yubihsm_pkcs11_slot::n_algorithms</a></div><div class="ttdeci">size_t n_algorithms</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8h_source.html#l00159">yubihsm_pkcs11.h:159</a></div></div>
<div class="ttc" id="astructyubihsm__pkcs11__slot_html_acc712b62a1eba2487a602bc84f2567cf"><div class="ttname"><a href="structyubihsm__pkcs11__slot.html#acc712b62a1eba2487a602bc84f2567cf">yubihsm_pkcs11_slot::algorithms</a></div><div class="ttdeci">yh_algorithm algorithms[YH_MAX_ALGORITHM_COUNT]</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8h_source.html#l00158">yubihsm_pkcs11.h:158</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_a6ab558e1426359cc78e7a362f8b3acd9"><div class="ttname"><a href="yubihsm_8c.html#a6ab558e1426359cc78e7a362f8b3acd9">yh_util_get_device_info</a></div><div class="ttdeci">yh_rc yh_util_get_device_info(yh_connector *connector, uint8_t *major, uint8_t *minor, uint8_t *patch, uint32_t *serial, uint8_t *log_total, uint8_t *log_used, yh_algorithm *algorithms, size_t *n_algorithms)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l00938">yubihsm.c:938</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_ae4f602d2343d01b1727dfd633169d366"><div class="ttname"><a href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a></div><div class="ttdeci">yh_rc</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00170">yubihsm.h:170</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815"><div class="ttname"><a href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a></div><div class="ttdeci">@ YHR_SUCCESS</div><div class="ttdoc">Returned value when function was successful.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00172">yubihsm.h:172</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a05dd610acfc36d8ca4581d4d22ae1521"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a05dd610acfc36d8ca4581d4d22ae1521">pInfo</a></div><div class="ttdeci">CK_SLOT_ID CK_SLOT_INFO_PTR pInfo</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l00504">yubihsm_pkcs11.c:504</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a9c8d6a4a7a87f74f070e816dca1a547b"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a></div><div class="ttdeci">yh_rc yrc</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l00606">yubihsm_pkcs11.c:606</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util__pkcs11_8h_a95f1c61424aa67f782a360e59c6cee84_cgraph.png" border="0" usemap="#autil__pkcs11_8h_a95f1c61424aa67f782a360e59c6cee84_cgraph" alt=""/></div>
<map name="autil__pkcs11_8h_a95f1c61424aa67f782a360e59c6cee84_cgraph" id="autil__pkcs11_8h_a95f1c61424aa67f782a360e59c6cee84_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,147,56"/>
<area shape="rect" href="yubihsm_8c.html#a6ab558e1426359cc78e7a362f8b3acd9" title=" " alt="" coords="195,31,352,56"/>
<area shape="poly" title=" " alt="" coords="147,41,179,41,179,46,147,46"/>
<area shape="rect" href="yubihsm_8c.html#a799e299be8d4c13dfa2112a60d05480d" title=" " alt="" coords="400,5,536,31"/>
<area shape="poly" title=" " alt="" coords="352,31,384,26,385,32,353,36"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="584,55,668,80"/>
<area shape="poly" title=" " alt="" coords="353,46,569,61,568,66,352,51"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="590,5,662,31"/>
<area shape="poly" title=" " alt="" coords="537,16,575,16,575,21,537,21"/>
<area shape="poly" title=" " alt="" coords="513,29,571,48,569,53,511,34"/>
</map>
</div>

</div>
</div>
<a id="a064731f36eb972f687b4059dc5f340db" name="a064731f36eb972f687b4059dc5f340db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a064731f36eb972f687b4059dc5f340db">&#9670;&#160;</a></span>get_mechanism_list()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CK_RV get_mechanism_list </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__pkcs11__slot.html">yubihsm_pkcs11_slot</a> *</td>          <td class="paramname"><span class="paramname"><em>slot</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pkcs11_8h.html#a29744979fe73c2061a1d39987f063679">CK_MECHANISM_TYPE_PTR</a></td>          <td class="paramname"><span class="paramname"><em>pMechanismList</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pkcs11_8h.html#a2c6426aaa1ca6dd1f48a01b8490482fa">CK_ULONG_PTR</a></td>          <td class="paramname"><span class="paramname"><em>count</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="util__pkcs11_8c_source.html#l00073">73</a> of file <a class="el" href="util__pkcs11_8c_source.html">util_pkcs11.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   75</span>                                             {</div>
<div class="line"><span class="lineno">   76</span> </div>
<div class="line"><span class="lineno">   77</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__slot.html#ac4313bd333015ea2ae50240ed379da60">n_algorithms</a> == 0) {</div>
<div class="line"><span class="lineno">   78</span>    <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__slot.html#ac4313bd333015ea2ae50240ed379da60">n_algorithms</a> = <span class="keyword">sizeof</span>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__slot.html#acc712b62a1eba2487a602bc84f2567cf">algorithms</a>) / <span class="keyword">sizeof</span>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__slot.html#acc712b62a1eba2487a602bc84f2567cf">algorithms</a>[0]);</div>
<div class="line"><span class="lineno">   79</span>    <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> =</div>
<div class="line"><span class="lineno">   80</span>      <a class="code hl_function" href="yubihsm_8c.html#a6ab558e1426359cc78e7a362f8b3acd9">yh_util_get_device_info</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__slot.html#a8022d3426b090c01b082636562f7c013">connector</a>, NULL, NULL, NULL, NULL, NULL,</div>
<div class="line"><span class="lineno">   81</span>                              NULL, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__slot.html#acc712b62a1eba2487a602bc84f2567cf">algorithms</a>, &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__slot.html#ac4313bd333015ea2ae50240ed379da60">n_algorithms</a>);</div>
<div class="line"><span class="lineno">   82</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno">   83</span>      <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a91150ecacbaa624fcc7d861f1b54f57c">CKR_FUNCTION_FAILED</a>;</div>
<div class="line"><span class="lineno">   84</span>    }</div>
<div class="line"><span class="lineno">   85</span>  }</div>
<div class="line"><span class="lineno">   86</span> </div>
<div class="line"><span class="lineno">   87</span>  CK_MECHANISM_TYPE buffer[128]; <span class="comment">// NOTE: this is a bit hardcoded, but much more</span></div>
<div class="line"><span class="lineno">   88</span>  <span class="comment">// than what we might add below.</span></div>
<div class="line"><span class="lineno">   89</span>  <a class="code hl_typedef" href="pkcs11_8h.html#a35181858a3b7a0a81f49d180d8f446ef">CK_ULONG</a> items = 0;</div>
<div class="line"><span class="lineno">   90</span> </div>
<div class="line"><span class="lineno">   91</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__slot.html#ac4313bd333015ea2ae50240ed379da60">n_algorithms</a>; i++) {</div>
<div class="line"><span class="lineno">   92</span>    <span class="keywordflow">switch</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__slot.html#acc712b62a1eba2487a602bc84f2567cf">algorithms</a>[i]) {</div>
<div class="line"><span class="lineno">   93</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa1982e3db182a679514674f454e2b79ad">YH_ALGO_RSA_PKCS1_SHA1</a>:</div>
<div class="line"><span class="lineno">   94</span>        add_mech(buffer, &amp;items, <a class="code hl_define" href="pkcs11_8h.html#a08a8e0f2109de3ff3bfe26f220447a2e">CKM_RSA_PKCS</a>);</div>
<div class="line"><span class="lineno">   95</span>        add_mech(buffer, &amp;items, <a class="code hl_define" href="pkcs11_8h.html#a9b5d495ac404ebbce07d1f58436ee31d">CKM_SHA1_RSA_PKCS</a>);</div>
<div class="line"><span class="lineno">   96</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">   97</span> </div>
<div class="line"><span class="lineno">   98</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa18e17370fcf9a829572e57608aff743c">YH_ALGO_RSA_PKCS1_SHA256</a>:</div>
<div class="line"><span class="lineno">   99</span>        add_mech(buffer, &amp;items, <a class="code hl_define" href="pkcs11_8h.html#a08a8e0f2109de3ff3bfe26f220447a2e">CKM_RSA_PKCS</a>);</div>
<div class="line"><span class="lineno">  100</span>        add_mech(buffer, &amp;items, <a class="code hl_define" href="pkcs11_8h.html#ae24525658e8df0829c24236ee7614d1f">CKM_SHA256_RSA_PKCS</a>);</div>
<div class="line"><span class="lineno">  101</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  102</span> </div>
<div class="line"><span class="lineno">  103</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caafc78c2f62fe0a185c38d2644755fde2c">YH_ALGO_RSA_PKCS1_SHA384</a>:</div>
<div class="line"><span class="lineno">  104</span>        add_mech(buffer, &amp;items, <a class="code hl_define" href="pkcs11_8h.html#a08a8e0f2109de3ff3bfe26f220447a2e">CKM_RSA_PKCS</a>);</div>
<div class="line"><span class="lineno">  105</span>        add_mech(buffer, &amp;items, <a class="code hl_define" href="pkcs11_8h.html#ad8d3d34082b7e18f4f173804cf5b959b">CKM_SHA384_RSA_PKCS</a>);</div>
<div class="line"><span class="lineno">  106</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  107</span> </div>
<div class="line"><span class="lineno">  108</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa84e18ba6561d5a834dc8d794504708db">YH_ALGO_RSA_PKCS1_SHA512</a>:</div>
<div class="line"><span class="lineno">  109</span>        add_mech(buffer, &amp;items, <a class="code hl_define" href="pkcs11_8h.html#a08a8e0f2109de3ff3bfe26f220447a2e">CKM_RSA_PKCS</a>);</div>
<div class="line"><span class="lineno">  110</span>        add_mech(buffer, &amp;items, <a class="code hl_define" href="pkcs11_8h.html#a6c0c89dfd22474095772f87d25c6a17d">CKM_SHA512_RSA_PKCS</a>);</div>
<div class="line"><span class="lineno">  111</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  112</span> </div>
<div class="line"><span class="lineno">  113</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa24d40fa957c584cf2ef0f5b0053b9f32">YH_ALGO_RSA_PSS_SHA1</a>:</div>
<div class="line"><span class="lineno">  114</span>        add_mech(buffer, &amp;items, <a class="code hl_define" href="pkcs11_8h.html#ad4f5697408b23623c904df2b1ca8a9f1">CKM_RSA_PKCS_PSS</a>);</div>
<div class="line"><span class="lineno">  115</span>        add_mech(buffer, &amp;items, <a class="code hl_define" href="pkcs11_8h.html#ad5943f11b67c32a40d4d6687e9cbb64b">CKM_SHA1_RSA_PKCS_PSS</a>);</div>
<div class="line"><span class="lineno">  116</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  117</span> </div>
<div class="line"><span class="lineno">  118</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caac42381f876f5e7190547cf81021451f5">YH_ALGO_RSA_PSS_SHA256</a>:</div>
<div class="line"><span class="lineno">  119</span>        add_mech(buffer, &amp;items, <a class="code hl_define" href="pkcs11_8h.html#ad4f5697408b23623c904df2b1ca8a9f1">CKM_RSA_PKCS_PSS</a>);</div>
<div class="line"><span class="lineno">  120</span>        add_mech(buffer, &amp;items, <a class="code hl_define" href="pkcs11_8h.html#ad336fbe2d222fc913c70dd56fabf7f7e">CKM_SHA256_RSA_PKCS_PSS</a>);</div>
<div class="line"><span class="lineno">  121</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  122</span> </div>
<div class="line"><span class="lineno">  123</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa144083d6414cb33e8543d51e7d361d05">YH_ALGO_RSA_PSS_SHA384</a>:</div>
<div class="line"><span class="lineno">  124</span>        add_mech(buffer, &amp;items, <a class="code hl_define" href="pkcs11_8h.html#ad4f5697408b23623c904df2b1ca8a9f1">CKM_RSA_PKCS_PSS</a>);</div>
<div class="line"><span class="lineno">  125</span>        add_mech(buffer, &amp;items, <a class="code hl_define" href="pkcs11_8h.html#ae5a8bfa905dc8dab5b2130a8bb6b23fb">CKM_SHA384_RSA_PKCS_PSS</a>);</div>
<div class="line"><span class="lineno">  126</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  127</span> </div>
<div class="line"><span class="lineno">  128</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa1d5a50a1a53000cd2b2989c17703e2d1">YH_ALGO_RSA_PSS_SHA512</a>:</div>
<div class="line"><span class="lineno">  129</span>        add_mech(buffer, &amp;items, <a class="code hl_define" href="pkcs11_8h.html#ad4f5697408b23623c904df2b1ca8a9f1">CKM_RSA_PKCS_PSS</a>);</div>
<div class="line"><span class="lineno">  130</span>        add_mech(buffer, &amp;items, <a class="code hl_define" href="pkcs11_8h.html#a67393bc84515cf68048ca3b3bb8b39a0">CKM_SHA512_RSA_PKCS_PSS</a>);</div>
<div class="line"><span class="lineno">  131</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  132</span> </div>
<div class="line"><span class="lineno">  133</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caaafe94e6a770edb51c6db84f77d98d2c6">YH_ALGO_RSA_2048</a>:</div>
<div class="line"><span class="lineno">  134</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caafd3fbd9ed86caf267ccc77cb24d44426">YH_ALGO_RSA_3072</a>:</div>
<div class="line"><span class="lineno">  135</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caae5963322a0a0f43a1b74faa78e3a7329">YH_ALGO_RSA_4096</a>:</div>
<div class="line"><span class="lineno">  136</span>        add_mech(buffer, &amp;items, <a class="code hl_define" href="pkcs11_8h.html#a3afa7970e62cb983de2f2b46af9ac43f">CKM_RSA_PKCS_KEY_PAIR_GEN</a>);</div>
<div class="line"><span class="lineno">  137</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  138</span> </div>
<div class="line"><span class="lineno">  139</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caaedcbc07d82b18ca5c21eb3379a6cc010">YH_ALGO_EC_P224</a>:</div>
<div class="line"><span class="lineno">  140</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caae4b191baf5c65f9234120080264d129b">YH_ALGO_EC_P256</a>:</div>
<div class="line"><span class="lineno">  141</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa31094c17c66e4c365ca3dad353bc8bda">YH_ALGO_EC_P384</a>:</div>
<div class="line"><span class="lineno">  142</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa05aec903fd67851f968aaa606fe2138a">YH_ALGO_EC_P521</a>:</div>
<div class="line"><span class="lineno">  143</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caad423056b13955068935dc8b3ac0e65d1">YH_ALGO_EC_K256</a>:</div>
<div class="line"><span class="lineno">  144</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caabd995726d45b6dd2388775db4767c80d">YH_ALGO_EC_BP256</a>:</div>
<div class="line"><span class="lineno">  145</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa228fd3332b55c60438dfea6a1b09af36">YH_ALGO_EC_BP384</a>:</div>
<div class="line"><span class="lineno">  146</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caab9c1be17b7b3f755346ff8c3cca3ed25">YH_ALGO_EC_BP512</a>:</div>
<div class="line"><span class="lineno">  147</span>        add_mech(buffer, &amp;items, <a class="code hl_define" href="pkcs11_8h.html#a95733c79b5297ea9ac28476e680ad4fa">CKM_EC_KEY_PAIR_GEN</a>);</div>
<div class="line"><span class="lineno">  148</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  149</span> </div>
<div class="line"><span class="lineno">  150</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa942e65c8cd0034eebe9a20c2297c7b06">YH_ALGO_HMAC_SHA1</a>:</div>
<div class="line"><span class="lineno">  151</span>        add_mech(buffer, &amp;items, <a class="code hl_define" href="pkcs11_8h.html#a1eb3f4cee46e624bfbbc6889e1e5bc06">CKM_SHA_1_HMAC</a>);</div>
<div class="line"><span class="lineno">  152</span>        add_mech(buffer, &amp;items, <a class="code hl_define" href="pkcs11_8h.html#a8eb5ca4355d60dcf974107f95e38784b">CKM_GENERIC_SECRET_KEY_GEN</a>);</div>
<div class="line"><span class="lineno">  153</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  154</span> </div>
<div class="line"><span class="lineno">  155</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caab0a0e1eb424b61057f159f1e53311f5c">YH_ALGO_HMAC_SHA256</a>:</div>
<div class="line"><span class="lineno">  156</span>        add_mech(buffer, &amp;items, <a class="code hl_define" href="pkcs11_8h.html#a839f51ab9e78e866f1d3773b8466b011">CKM_SHA256_HMAC</a>);</div>
<div class="line"><span class="lineno">  157</span>        add_mech(buffer, &amp;items, <a class="code hl_define" href="pkcs11_8h.html#a8eb5ca4355d60dcf974107f95e38784b">CKM_GENERIC_SECRET_KEY_GEN</a>);</div>
<div class="line"><span class="lineno">  158</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  159</span> </div>
<div class="line"><span class="lineno">  160</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa781e7ca62563917d2129bde8ec53401b">YH_ALGO_HMAC_SHA384</a>:</div>
<div class="line"><span class="lineno">  161</span>        add_mech(buffer, &amp;items, <a class="code hl_define" href="pkcs11_8h.html#a97ee18b73f21e8047fadc8a0aa12f23a">CKM_SHA384_HMAC</a>);</div>
<div class="line"><span class="lineno">  162</span>        add_mech(buffer, &amp;items, <a class="code hl_define" href="pkcs11_8h.html#a8eb5ca4355d60dcf974107f95e38784b">CKM_GENERIC_SECRET_KEY_GEN</a>);</div>
<div class="line"><span class="lineno">  163</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  164</span> </div>
<div class="line"><span class="lineno">  165</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa72d6c7ea77f10e39bbadc8b58d55b9ec">YH_ALGO_HMAC_SHA512</a>:</div>
<div class="line"><span class="lineno">  166</span>        add_mech(buffer, &amp;items, <a class="code hl_define" href="pkcs11_8h.html#ae1b850f9141aa407e45b02fa3ade3759">CKM_SHA512_HMAC</a>);</div>
<div class="line"><span class="lineno">  167</span>        add_mech(buffer, &amp;items, <a class="code hl_define" href="pkcs11_8h.html#a8eb5ca4355d60dcf974107f95e38784b">CKM_GENERIC_SECRET_KEY_GEN</a>);</div>
<div class="line"><span class="lineno">  168</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  169</span> </div>
<div class="line"><span class="lineno">  170</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caae9b7b5598c3839a53e4986dc901be244">YH_ALGO_EC_ECDSA_SHA1</a>:</div>
<div class="line"><span class="lineno">  171</span>        add_mech(buffer, &amp;items, <a class="code hl_define" href="pkcs11_8h.html#ab4a7299a144f0ef52cee06893cc60483">CKM_ECDSA</a>);</div>
<div class="line"><span class="lineno">  172</span>        add_mech(buffer, &amp;items, <a class="code hl_define" href="pkcs11_8h.html#a0911727b2cd926b9209f24bf50bc555a">CKM_ECDSA_SHA1</a>);</div>
<div class="line"><span class="lineno">  173</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  174</span> </div>
<div class="line"><span class="lineno">  175</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa2e5dfe9c79cb0d391d7bf952227268ec">YH_ALGO_EC_ECDSA_SHA256</a>:</div>
<div class="line"><span class="lineno">  176</span>        add_mech(buffer, &amp;items, <a class="code hl_define" href="pkcs11_8h.html#ab4a7299a144f0ef52cee06893cc60483">CKM_ECDSA</a>);</div>
<div class="line"><span class="lineno">  177</span>        add_mech(buffer, &amp;items, <a class="code hl_define" href="pkcs11_8h.html#ac7f12f2ee83f0ca3b309b22e5b48e486">CKM_ECDSA_SHA256</a>);</div>
<div class="line"><span class="lineno">  178</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  179</span> </div>
<div class="line"><span class="lineno">  180</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa657d2b30d884aeeff3c024404132ad69">YH_ALGO_EC_ECDSA_SHA384</a>:</div>
<div class="line"><span class="lineno">  181</span>        add_mech(buffer, &amp;items, <a class="code hl_define" href="pkcs11_8h.html#ab4a7299a144f0ef52cee06893cc60483">CKM_ECDSA</a>);</div>
<div class="line"><span class="lineno">  182</span>        add_mech(buffer, &amp;items, <a class="code hl_define" href="pkcs11_8h.html#ab4aaed0f4b4146b812c6cff25828fcfd">CKM_ECDSA_SHA384</a>);</div>
<div class="line"><span class="lineno">  183</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  184</span> </div>
<div class="line"><span class="lineno">  185</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa44153987efd3466070143dbab77f2d70">YH_ALGO_EC_ECDSA_SHA512</a>:</div>
<div class="line"><span class="lineno">  186</span>        add_mech(buffer, &amp;items, <a class="code hl_define" href="pkcs11_8h.html#ab4a7299a144f0ef52cee06893cc60483">CKM_ECDSA</a>);</div>
<div class="line"><span class="lineno">  187</span>        add_mech(buffer, &amp;items, <a class="code hl_define" href="pkcs11_8h.html#a69a7674eee1a8069128923037b504e59">CKM_ECDSA_SHA512</a>);</div>
<div class="line"><span class="lineno">  188</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  189</span> </div>
<div class="line"><span class="lineno">  190</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa14b36e4ff3b90d44ace0aa2b2c65ef48">YH_ALGO_EC_ECDH</a>:</div>
<div class="line"><span class="lineno">  191</span>        add_mech(buffer, &amp;items, <a class="code hl_define" href="pkcs11_8h.html#a2d5867eec8e2621a31f108010f2dce97">CKM_ECDH1_DERIVE</a>);</div>
<div class="line"><span class="lineno">  192</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  193</span> </div>
<div class="line"><span class="lineno">  194</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caae9e58613e12b0f9f445e620f1dd77e1d">YH_ALGO_RSA_OAEP_SHA1</a>:</div>
<div class="line"><span class="lineno">  195</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa590665f5e23f996daeba0a2586b2ff33">YH_ALGO_RSA_OAEP_SHA256</a>:</div>
<div class="line"><span class="lineno">  196</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caab2580ffabb9b08affd0f7803fb1536cd">YH_ALGO_RSA_OAEP_SHA384</a>:</div>
<div class="line"><span class="lineno">  197</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caaa4c2625511af2c17ed83da552d3dc5f6">YH_ALGO_RSA_OAEP_SHA512</a>:</div>
<div class="line"><span class="lineno">  198</span>        add_mech(buffer, &amp;items, <a class="code hl_define" href="pkcs11_8h.html#a69da8859ad1e6b4f424d071b42ea4a0c">CKM_RSA_PKCS_OAEP</a>);</div>
<div class="line"><span class="lineno">  199</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  200</span> </div>
<div class="line"><span class="lineno">  201</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caae22b228e457c9bdccb5a93d81730b1b1">YH_ALGO_AES128_CCM_WRAP</a>:</div>
<div class="line"><span class="lineno">  202</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caab739a1d142dacaf37ba13a73e2d83fab">YH_ALGO_AES192_CCM_WRAP</a>:</div>
<div class="line"><span class="lineno">  203</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa927e2246e5657f946b4da4b71092b022">YH_ALGO_AES256_CCM_WRAP</a>:</div>
<div class="line"><span class="lineno">  204</span>        add_mech(buffer, &amp;items, <a class="code hl_define" href="pkcs11y_8h.html#a631efbda997696a7f7ce71df0e3e779a">CKM_YUBICO_AES_CCM_WRAP</a>);</div>
<div class="line"><span class="lineno">  205</span>        add_mech(buffer, &amp;items, <a class="code hl_define" href="pkcs11_8h.html#a8eb5ca4355d60dcf974107f95e38784b">CKM_GENERIC_SECRET_KEY_GEN</a>);</div>
<div class="line"><span class="lineno">  206</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  207</span> </div>
<div class="line"><span class="lineno">  208</span>        <span class="comment">// NOTE: there are algorithms don&#39;t have corresponding mechanisms</span></div>
<div class="line"><span class="lineno">  209</span>      <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">  210</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  211</span>    }</div>
<div class="line"><span class="lineno">  212</span>  }</div>
<div class="line"><span class="lineno">  213</span> </div>
<div class="line"><span class="lineno">  214</span>  <span class="comment">// NOTE(adma): manually add digest mechanisms</span></div>
<div class="line"><span class="lineno">  215</span>  add_mech(buffer, &amp;items, <a class="code hl_define" href="pkcs11_8h.html#af1818a1c453a84f01f2e868307ca8fed">CKM_SHA_1</a>);</div>
<div class="line"><span class="lineno">  216</span>  add_mech(buffer, &amp;items, <a class="code hl_define" href="pkcs11_8h.html#a4d11f88ae3bea2f748f275c03b54a648">CKM_SHA256</a>);</div>
<div class="line"><span class="lineno">  217</span>  add_mech(buffer, &amp;items, <a class="code hl_define" href="pkcs11_8h.html#a9278e01971ca83cdd07e4b8e07a00bc8">CKM_SHA384</a>);</div>
<div class="line"><span class="lineno">  218</span>  add_mech(buffer, &amp;items, <a class="code hl_define" href="pkcs11_8h.html#a9bf4bf7375a24e1010cc8e0139608fd5">CKM_SHA512</a>);</div>
<div class="line"><span class="lineno">  219</span> </div>
<div class="line"><span class="lineno">  220</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a837cbbce04f92271824debc2c15b6ab6">pMechanismList</a> != NULL) {</div>
<div class="line"><span class="lineno">  221</span>    <span class="keywordflow">if</span> (items &gt; *<a class="code hl_variable" href="gmock__stress__test_8cc.html#afd9db40e3361ae09188795e8cbe19752">count</a>) {</div>
<div class="line"><span class="lineno">  222</span>      *<a class="code hl_variable" href="gmock__stress__test_8cc.html#afd9db40e3361ae09188795e8cbe19752">count</a> = items;</div>
<div class="line"><span class="lineno">  223</span> </div>
<div class="line"><span class="lineno">  224</span>      <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a9f2ea08f0e13c3fc129863fdd46352b6">CKR_BUFFER_TOO_SMALL</a>;</div>
<div class="line"><span class="lineno">  225</span>    }</div>
<div class="line"><span class="lineno">  226</span> </div>
<div class="line"><span class="lineno">  227</span>    <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a837cbbce04f92271824debc2c15b6ab6">pMechanismList</a>, buffer, <span class="keyword">sizeof</span>(CK_MECHANISM_TYPE) * items);</div>
<div class="line"><span class="lineno">  228</span>  }</div>
<div class="line"><span class="lineno">  229</span> </div>
<div class="line"><span class="lineno">  230</span>  *<a class="code hl_variable" href="gmock__stress__test_8cc.html#afd9db40e3361ae09188795e8cbe19752">count</a> = items;</div>
<div class="line"><span class="lineno">  231</span> </div>
<div class="line"><span class="lineno">  232</span>  <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>;</div>
<div class="line"><span class="lineno">  233</span>}</div>
<div class="ttc" id="apkcs11_8h_html_a9f2ea08f0e13c3fc129863fdd46352b6"><div class="ttname"><a href="pkcs11_8h.html#a9f2ea08f0e13c3fc129863fdd46352b6">CKR_BUFFER_TOO_SMALL</a></div><div class="ttdeci">#define CKR_BUFFER_TOO_SMALL</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l01169">pkcs11.h:1169</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caa05aec903fd67851f968aaa606fe2138a"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa05aec903fd67851f968aaa606fe2138a">YH_ALGO_EC_P521</a></div><div class="ttdeci">@ YH_ALGO_EC_P521</div><div class="ttdoc">ecp521</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00418">yubihsm.h:418</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caa144083d6414cb33e8543d51e7d361d05"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa144083d6414cb33e8543d51e7d361d05">YH_ALGO_RSA_PSS_SHA384</a></div><div class="ttdeci">@ YH_ALGO_RSA_PSS_SHA384</div><div class="ttdoc">rsa-pss-sha384</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00404">yubihsm.h:404</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caa14b36e4ff3b90d44ace0aa2b2c65ef48"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa14b36e4ff3b90d44ace0aa2b2c65ef48">YH_ALGO_EC_ECDH</a></div><div class="ttdeci">@ YH_ALGO_EC_ECDH</div><div class="ttdoc">ecdh</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00438">yubihsm.h:438</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caa18e17370fcf9a829572e57608aff743c"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa18e17370fcf9a829572e57608aff743c">YH_ALGO_RSA_PKCS1_SHA256</a></div><div class="ttdeci">@ YH_ALGO_RSA_PKCS1_SHA256</div><div class="ttdoc">rsa-pkcs1-sha256</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00394">yubihsm.h:394</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caa1982e3db182a679514674f454e2b79ad"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa1982e3db182a679514674f454e2b79ad">YH_ALGO_RSA_PKCS1_SHA1</a></div><div class="ttdeci">@ YH_ALGO_RSA_PKCS1_SHA1</div><div class="ttdoc">rsa-pkcs1-sha1</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00392">yubihsm.h:392</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caa1d5a50a1a53000cd2b2989c17703e2d1"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa1d5a50a1a53000cd2b2989c17703e2d1">YH_ALGO_RSA_PSS_SHA512</a></div><div class="ttdeci">@ YH_ALGO_RSA_PSS_SHA512</div><div class="ttdoc">rsa-pss-sha512</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00406">yubihsm.h:406</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caa228fd3332b55c60438dfea6a1b09af36"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa228fd3332b55c60438dfea6a1b09af36">YH_ALGO_EC_BP384</a></div><div class="ttdeci">@ YH_ALGO_EC_BP384</div><div class="ttdoc">ecbp384</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00424">yubihsm.h:424</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caa24d40fa957c584cf2ef0f5b0053b9f32"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa24d40fa957c584cf2ef0f5b0053b9f32">YH_ALGO_RSA_PSS_SHA1</a></div><div class="ttdeci">@ YH_ALGO_RSA_PSS_SHA1</div><div class="ttdoc">rsa-pss-sha1</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00400">yubihsm.h:400</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caa2e5dfe9c79cb0d391d7bf952227268ec"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa2e5dfe9c79cb0d391d7bf952227268ec">YH_ALGO_EC_ECDSA_SHA256</a></div><div class="ttdeci">@ YH_ALGO_EC_ECDSA_SHA256</div><div class="ttdoc">ecdsa-sha256</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00476">yubihsm.h:476</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caa31094c17c66e4c365ca3dad353bc8bda"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa31094c17c66e4c365ca3dad353bc8bda">YH_ALGO_EC_P384</a></div><div class="ttdeci">@ YH_ALGO_EC_P384</div><div class="ttdoc">ecp384</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00416">yubihsm.h:416</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caa44153987efd3466070143dbab77f2d70"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa44153987efd3466070143dbab77f2d70">YH_ALGO_EC_ECDSA_SHA512</a></div><div class="ttdeci">@ YH_ALGO_EC_ECDSA_SHA512</div><div class="ttdoc">ecdsa-sha512</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00480">yubihsm.h:480</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caa590665f5e23f996daeba0a2586b2ff33"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa590665f5e23f996daeba0a2586b2ff33">YH_ALGO_RSA_OAEP_SHA256</a></div><div class="ttdeci">@ YH_ALGO_RSA_OAEP_SHA256</div><div class="ttdoc">rsa-oaep-sha256</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00442">yubihsm.h:442</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caa657d2b30d884aeeff3c024404132ad69"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa657d2b30d884aeeff3c024404132ad69">YH_ALGO_EC_ECDSA_SHA384</a></div><div class="ttdeci">@ YH_ALGO_EC_ECDSA_SHA384</div><div class="ttdoc">ecdsa-sha384</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00478">yubihsm.h:478</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caa72d6c7ea77f10e39bbadc8b58d55b9ec"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa72d6c7ea77f10e39bbadc8b58d55b9ec">YH_ALGO_HMAC_SHA512</a></div><div class="ttdeci">@ YH_ALGO_HMAC_SHA512</div><div class="ttdoc">hmac-sha512</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00434">yubihsm.h:434</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caa781e7ca62563917d2129bde8ec53401b"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa781e7ca62563917d2129bde8ec53401b">YH_ALGO_HMAC_SHA384</a></div><div class="ttdeci">@ YH_ALGO_HMAC_SHA384</div><div class="ttdoc">hmac-sha384</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00432">yubihsm.h:432</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caa84e18ba6561d5a834dc8d794504708db"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa84e18ba6561d5a834dc8d794504708db">YH_ALGO_RSA_PKCS1_SHA512</a></div><div class="ttdeci">@ YH_ALGO_RSA_PKCS1_SHA512</div><div class="ttdoc">rsa-pkcs1-sha512</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00398">yubihsm.h:398</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caa927e2246e5657f946b4da4b71092b022"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa927e2246e5657f946b4da4b71092b022">YH_ALGO_AES256_CCM_WRAP</a></div><div class="ttdeci">@ YH_ALGO_AES256_CCM_WRAP</div><div class="ttdoc">aes256-ccm-wrap</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00474">yubihsm.h:474</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caa942e65c8cd0034eebe9a20c2297c7b06"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa942e65c8cd0034eebe9a20c2297c7b06">YH_ALGO_HMAC_SHA1</a></div><div class="ttdeci">@ YH_ALGO_HMAC_SHA1</div><div class="ttdoc">hmac-sha1</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00428">yubihsm.h:428</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caaa4c2625511af2c17ed83da552d3dc5f6"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caaa4c2625511af2c17ed83da552d3dc5f6">YH_ALGO_RSA_OAEP_SHA512</a></div><div class="ttdeci">@ YH_ALGO_RSA_OAEP_SHA512</div><div class="ttdoc">rsa-oaep-sha512</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00446">yubihsm.h:446</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caaafe94e6a770edb51c6db84f77d98d2c6"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caaafe94e6a770edb51c6db84f77d98d2c6">YH_ALGO_RSA_2048</a></div><div class="ttdeci">@ YH_ALGO_RSA_2048</div><div class="ttdoc">rsa2048</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00408">yubihsm.h:408</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caab0a0e1eb424b61057f159f1e53311f5c"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caab0a0e1eb424b61057f159f1e53311f5c">YH_ALGO_HMAC_SHA256</a></div><div class="ttdeci">@ YH_ALGO_HMAC_SHA256</div><div class="ttdoc">hmac-sha256</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00430">yubihsm.h:430</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caab2580ffabb9b08affd0f7803fb1536cd"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caab2580ffabb9b08affd0f7803fb1536cd">YH_ALGO_RSA_OAEP_SHA384</a></div><div class="ttdeci">@ YH_ALGO_RSA_OAEP_SHA384</div><div class="ttdoc">rsa-oaep-sha384</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00444">yubihsm.h:444</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caab739a1d142dacaf37ba13a73e2d83fab"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caab739a1d142dacaf37ba13a73e2d83fab">YH_ALGO_AES192_CCM_WRAP</a></div><div class="ttdeci">@ YH_ALGO_AES192_CCM_WRAP</div><div class="ttdoc">aes192-ccm-wrap</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00472">yubihsm.h:472</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caab9c1be17b7b3f755346ff8c3cca3ed25"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caab9c1be17b7b3f755346ff8c3cca3ed25">YH_ALGO_EC_BP512</a></div><div class="ttdeci">@ YH_ALGO_EC_BP512</div><div class="ttdoc">ecbp512</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00426">yubihsm.h:426</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caabd995726d45b6dd2388775db4767c80d"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caabd995726d45b6dd2388775db4767c80d">YH_ALGO_EC_BP256</a></div><div class="ttdeci">@ YH_ALGO_EC_BP256</div><div class="ttdoc">ecbp256</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00422">yubihsm.h:422</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caac42381f876f5e7190547cf81021451f5"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caac42381f876f5e7190547cf81021451f5">YH_ALGO_RSA_PSS_SHA256</a></div><div class="ttdeci">@ YH_ALGO_RSA_PSS_SHA256</div><div class="ttdoc">rsa-pss-sha256</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00402">yubihsm.h:402</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caad423056b13955068935dc8b3ac0e65d1"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caad423056b13955068935dc8b3ac0e65d1">YH_ALGO_EC_K256</a></div><div class="ttdeci">@ YH_ALGO_EC_K256</div><div class="ttdoc">eck256</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00420">yubihsm.h:420</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caae22b228e457c9bdccb5a93d81730b1b1"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caae22b228e457c9bdccb5a93d81730b1b1">YH_ALGO_AES128_CCM_WRAP</a></div><div class="ttdeci">@ YH_ALGO_AES128_CCM_WRAP</div><div class="ttdoc">aes128-ccm-wrap</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00448">yubihsm.h:448</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caae4b191baf5c65f9234120080264d129b"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caae4b191baf5c65f9234120080264d129b">YH_ALGO_EC_P256</a></div><div class="ttdeci">@ YH_ALGO_EC_P256</div><div class="ttdoc">ecp256</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00414">yubihsm.h:414</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caae5963322a0a0f43a1b74faa78e3a7329"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caae5963322a0a0f43a1b74faa78e3a7329">YH_ALGO_RSA_4096</a></div><div class="ttdeci">@ YH_ALGO_RSA_4096</div><div class="ttdoc">rsa4096</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00412">yubihsm.h:412</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caae9b7b5598c3839a53e4986dc901be244"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caae9b7b5598c3839a53e4986dc901be244">YH_ALGO_EC_ECDSA_SHA1</a></div><div class="ttdeci">@ YH_ALGO_EC_ECDSA_SHA1</div><div class="ttdoc">ecdsa-sha1</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00436">yubihsm.h:436</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caae9e58613e12b0f9f445e620f1dd77e1d"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caae9e58613e12b0f9f445e620f1dd77e1d">YH_ALGO_RSA_OAEP_SHA1</a></div><div class="ttdeci">@ YH_ALGO_RSA_OAEP_SHA1</div><div class="ttdoc">rsa-oaep-sha1</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00440">yubihsm.h:440</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caaedcbc07d82b18ca5c21eb3379a6cc010"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caaedcbc07d82b18ca5c21eb3379a6cc010">YH_ALGO_EC_P224</a></div><div class="ttdeci">@ YH_ALGO_EC_P224</div><div class="ttdoc">ecp224</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00484">yubihsm.h:484</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caafc78c2f62fe0a185c38d2644755fde2c"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caafc78c2f62fe0a185c38d2644755fde2c">YH_ALGO_RSA_PKCS1_SHA384</a></div><div class="ttdeci">@ YH_ALGO_RSA_PKCS1_SHA384</div><div class="ttdoc">rsa-pkcs1-sha384</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00396">yubihsm.h:396</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a498937b5a72accbb0ef21bb1dcdd55caafd3fbd9ed86caf267ccc77cb24d44426"><div class="ttname"><a href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caafd3fbd9ed86caf267ccc77cb24d44426">YH_ALGO_RSA_3072</a></div><div class="ttdeci">@ YH_ALGO_RSA_3072</div><div class="ttdoc">rsa3072</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00410">yubihsm.h:410</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a837cbbce04f92271824debc2c15b6ab6"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a837cbbce04f92271824debc2c15b6ab6">pMechanismList</a></div><div class="ttdeci">CK_SLOT_ID CK_MECHANISM_TYPE_PTR pMechanismList</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l00686">yubihsm_pkcs11.c:686</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util__pkcs11_8h_a064731f36eb972f687b4059dc5f340db_cgraph.png" border="0" usemap="#autil__pkcs11_8h_a064731f36eb972f687b4059dc5f340db_cgraph" alt=""/></div>
<map name="autil__pkcs11_8h_a064731f36eb972f687b4059dc5f340db_cgraph" id="autil__pkcs11_8h_a064731f36eb972f687b4059dc5f340db_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,143,31"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="586,7,658,32"/>
<area shape="poly" title=" " alt="" coords="143,15,532,16,571,16,571,21,532,21,143,21"/>
<area shape="rect" href="yubihsm_8c.html#a6ab558e1426359cc78e7a362f8b3acd9" title=" " alt="" coords="191,31,348,56"/>
<area shape="poly" title=" " alt="" coords="144,24,175,29,175,34,143,30"/>
<area shape="rect" href="yubihsm_8c.html#a799e299be8d4c13dfa2112a60d05480d" title=" " alt="" coords="396,31,532,56"/>
<area shape="poly" title=" " alt="" coords="348,41,380,41,380,46,348,46"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="580,56,664,82"/>
<area shape="poly" title=" " alt="" coords="326,54,396,66,485,71,565,69,565,75,485,76,396,71,325,60"/>
<area shape="poly" title=" " alt="" coords="532,30,571,25,571,30,533,36"/>
<area shape="poly" title=" " alt="" coords="533,52,565,57,565,62,532,57"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util__pkcs11_8h_a064731f36eb972f687b4059dc5f340db_icgraph.png" border="0" usemap="#autil__pkcs11_8h_a064731f36eb972f687b4059dc5f340db_icgraph" alt=""/></div>
<map name="autil__pkcs11_8h_a064731f36eb972f687b4059dc5f340db_icgraph" id="autil__pkcs11_8h_a064731f36eb972f687b4059dc5f340db_icgraph">
<area shape="rect" title=" " alt="" coords="451,80,588,106"/>
<area shape="rect" href="util__pkcs11_8c.html#a5ce40fa3ee245e65d99ee4cec7a1dd0c" title=" " alt="" coords="223,5,403,31"/>
<area shape="poly" title=" " alt="" coords="476,76,402,45,368,34,370,29,404,40,478,71"/>
<area shape="rect" href="util__pkcs11_8c.html#a1a99061c5c316d6427b27f8d506338bf" title=" " alt="" coords="223,55,403,80"/>
<area shape="poly" title=" " alt="" coords="435,85,403,81,404,76,436,80"/>
<area shape="rect" href="util__pkcs11_8c.html#ae8ed437178cb69b0fed6916747368344" title=" " alt="" coords="232,104,394,130"/>
<area shape="poly" title=" " alt="" coords="436,105,394,110,394,105,435,100"/>
<area shape="rect" href="util__pkcs11_8c.html#a83e06a2ae90589d9fad186cad9ed5ede" title=" " alt="" coords="230,153,396,179"/>
<area shape="poly" title=" " alt="" coords="478,115,404,145,369,155,368,150,402,140,476,110"/>
<area shape="rect" href="util__pkcs11_8c.html#a87b96fbdfd225d8124f0a6f6d6538292" title=" " alt="" coords="5,104,175,130"/>
<area shape="poly" title=" " alt="" coords="217,120,175,120,175,114,217,114"/>
</map>
</div>

</div>
</div>
<a id="a8da590df25987cc479405a69d10b134c" name="a8da590df25987cc479405a69d10b134c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8da590df25987cc479405a69d10b134c">&#9670;&#160;</a></span>get_object_desc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structyubihsm__pkcs11__object__desc.html">yubihsm_pkcs11_object_desc</a> * get_object_desc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__session.html">yh_session</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structyubihsm__pkcs11__object__desc.html">yubihsm_pkcs11_object_desc</a> *</td>          <td class="paramname"><span class="paramname"><em>objects</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CK_OBJECT_HANDLE</td>          <td class="paramname"><span class="paramname"><em>objectHandle</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="util__pkcs11_8c_source.html#l01587">1587</a> of file <a class="el" href="util__pkcs11_8c_source.html">util_pkcs11.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1589</span>                                                                        {</div>
<div class="line"><span class="lineno"> 1590</span> </div>
<div class="line"><span class="lineno"> 1591</span>  <a class="code hl_struct" href="structyubihsm__pkcs11__object__desc.html">yubihsm_pkcs11_object_desc</a> *<span class="keywordtype">object</span> = NULL;</div>
<div class="line"><span class="lineno"> 1592</span>  <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <span class="keywordtype">id</span> = objHandle &amp; 0xffff;</div>
<div class="line"><span class="lineno"> 1593</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> type = objHandle &gt;&gt; 16;</div>
<div class="line"><span class="lineno"> 1594</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> sequence = objHandle &gt;&gt; 24;</div>
<div class="line"><span class="lineno"> 1595</span> </div>
<div class="line"><span class="lineno"> 1596</span>  <span class="keywordflow">for</span> (<a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> i = 0; i &lt; <a class="code hl_define" href="yubihsm_8h.html#a331b70d37ded99854638ff5ef0ca9735">YH_MAX_ITEMS_COUNT</a>; i++) {</div>
<div class="line"><span class="lineno"> 1597</span>    <span class="keywordflow">if</span> (objects[i].<span class="keywordtype">object</span>.<span class="keywordtype">id</span> == <span class="keywordtype">id</span> &amp;&amp;</div>
<div class="line"><span class="lineno"> 1598</span>        (objects[i].<span class="keywordtype">object</span>.type &amp; 0x7f) == (type &amp; 0x7f) &amp;&amp;</div>
<div class="line"><span class="lineno"> 1599</span>        objects[i].<span class="keywordtype">object</span>.sequence == sequence) {</div>
<div class="line"><span class="lineno"> 1600</span>      <span class="keywordtype">object</span> = &amp;objects[i];</div>
<div class="line"><span class="lineno"> 1601</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1602</span>    }</div>
<div class="line"><span class="lineno"> 1603</span>  }</div>
<div class="line"><span class="lineno"> 1604</span> </div>
<div class="line"><span class="lineno"> 1605</span>  <span class="keywordflow">if</span> (!<span class="keywordtype">object</span>) {</div>
<div class="line"><span class="lineno"> 1606</span>    <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> low;</div>
<div class="line"><span class="lineno"> 1607</span>    <span class="keyword">struct </span>timeval *low_time = NULL;</div>
<div class="line"><span class="lineno"> 1608</span> </div>
<div class="line"><span class="lineno"> 1609</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> i = 0; i &lt; <a class="code hl_define" href="yubihsm_8h.html#a331b70d37ded99854638ff5ef0ca9735">YH_MAX_ITEMS_COUNT</a>; i++) {</div>
<div class="line"><span class="lineno"> 1610</span>      <span class="keywordflow">if</span> (objects[i].tv.tv_sec == 0) {</div>
<div class="line"><span class="lineno"> 1611</span>        low = i;</div>
<div class="line"><span class="lineno"> 1612</span>        low_time = &amp;objects[i].<a class="code hl_variable" href="structyubihsm__pkcs11__object__desc.html#a8fbfc27b288552f10bfbfdc03e193b5f">tv</a>;</div>
<div class="line"><span class="lineno"> 1613</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1614</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1615</span>        <span class="keywordflow">if</span> (!low_time || objects[i].tv.tv_sec &lt; low_time-&gt;tv_sec ||</div>
<div class="line"><span class="lineno"> 1616</span>            (objects[i].tv.tv_sec == low_time-&gt;tv_sec &amp;&amp;</div>
<div class="line"><span class="lineno"> 1617</span>             objects[i].tv.tv_usec &lt; low_time-&gt;tv_usec)) {</div>
<div class="line"><span class="lineno"> 1618</span> </div>
<div class="line"><span class="lineno"> 1619</span>          low_time = &amp;objects[i].<a class="code hl_variable" href="structyubihsm__pkcs11__object__desc.html#a8fbfc27b288552f10bfbfdc03e193b5f">tv</a>;</div>
<div class="line"><span class="lineno"> 1620</span>          low = i;</div>
<div class="line"><span class="lineno"> 1621</span>        }</div>
<div class="line"><span class="lineno"> 1622</span>      }</div>
<div class="line"><span class="lineno"> 1623</span>    }</div>
<div class="line"><span class="lineno"> 1624</span>    <span class="keywordtype">object</span> = &amp;objects[low];</div>
<div class="line"><span class="lineno"> 1625</span>    <a class="code hl_function" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105">memset</a>(<span class="keywordtype">object</span>, 0, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structyubihsm__pkcs11__object__desc.html">yubihsm_pkcs11_object_desc</a>));</div>
<div class="line"><span class="lineno"> 1626</span>  }</div>
<div class="line"><span class="lineno"> 1627</span> </div>
<div class="line"><span class="lineno"> 1628</span>  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a85d991d90970121ba1480cd98d93aab9">object</a>-&gt;filled) {</div>
<div class="line"><span class="lineno"> 1629</span>    <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> real_type =</div>
<div class="line"><span class="lineno"> 1630</span>      type &amp; ~0x80; <span class="comment">// NOTE(adma): public key are not real objects</span></div>
<div class="line"><span class="lineno"> 1631</span>    <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a97917e1d5a9fa5e8b7a4495dc9234ac7">rc</a> = <a class="code hl_function" href="yubihsm_8c.html#a7b5f1f0c1cbca11fbe21e7e4e6b29a1b">yh_util_get_object_info</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, <span class="keywordtype">id</span>, real_type, &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a85d991d90970121ba1480cd98d93aab9">object</a>-&gt;object);</div>
<div class="line"><span class="lineno"> 1632</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a97917e1d5a9fa5e8b7a4495dc9234ac7">rc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 1633</span>      <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 1634</span>    }</div>
<div class="line"><span class="lineno"> 1635</span> </div>
<div class="line"><span class="lineno"> 1636</span>    <span class="keywordtype">object</span>-&gt;filled = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1637</span>  }</div>
<div class="line"><span class="lineno"> 1638</span> </div>
<div class="line"><span class="lineno"> 1639</span>  <span class="keywordtype">object</span>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__object__desc.html#a6029acaef1678d77702d2c51fb75540a">object</a>.<a class="code hl_variable" href="structyh__object__descriptor.html#ab8c1b3cc5b859e3c89eb228fa0763165">type</a> = <a class="code hl_variable" href="yubihsm_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a>;</div>
<div class="line"><span class="lineno"> 1640</span> </div>
<div class="line"><span class="lineno"> 1641</span>  gettimeofday(&amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a85d991d90970121ba1480cd98d93aab9">object</a>-&gt;tv, NULL);</div>
<div class="line"><span class="lineno"> 1642</span> </div>
<div class="line"><span class="lineno"> 1643</span>  <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a85d991d90970121ba1480cd98d93aab9">object</a>;</div>
<div class="line"><span class="lineno"> 1644</span>}</div>
<div class="ttc" id="astructyubihsm__pkcs11__object__desc_html_a6029acaef1678d77702d2c51fb75540a"><div class="ttname"><a href="structyubihsm__pkcs11__object__desc.html#a6029acaef1678d77702d2c51fb75540a">yubihsm_pkcs11_object_desc::object</a></div><div class="ttdeci">yh_object_descriptor object</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8h_source.html#l00044">yubihsm_pkcs11.h:44</a></div></div>
<div class="ttc" id="astructyubihsm__pkcs11__object__desc_html_a8fbfc27b288552f10bfbfdc03e193b5f"><div class="ttname"><a href="structyubihsm__pkcs11__object__desc.html#a8fbfc27b288552f10bfbfdc03e193b5f">yubihsm_pkcs11_object_desc::tv</a></div><div class="ttdeci">struct timeval tv</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8h_source.html#l00042">yubihsm_pkcs11.h:42</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_a7b5f1f0c1cbca11fbe21e7e4e6b29a1b"><div class="ttname"><a href="yubihsm_8c.html#a7b5f1f0c1cbca11fbe21e7e4e6b29a1b">yh_util_get_object_info</a></div><div class="ttdeci">yh_rc yh_util_get_object_info(yh_session *session, uint16_t id, yh_object_type type, yh_object_descriptor *object)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l01128">yubihsm.c:1128</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a1d127017fb298b889f4ba24752d08b8e"><div class="ttname"><a href="yubihsm_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a></div><div class="ttdeci">yh_object_type type</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00672">yubihsm.h:672</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a97917e1d5a9fa5e8b7a4495dc9234ac7"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a97917e1d5a9fa5e8b7a4495dc9234ac7">rc</a></div><div class="ttdeci">yh_rc rc</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l01308">yubihsm_pkcs11.c:1308</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util__pkcs11_8h_a8da590df25987cc479405a69d10b134c_cgraph.png" border="0" usemap="#autil__pkcs11_8h_a8da590df25987cc479405a69d10b134c_cgraph" alt=""/></div>
<map name="autil__pkcs11_8h_a8da590df25987cc479405a69d10b134c_cgraph" id="autil__pkcs11_8h_a8da590df25987cc479405a69d10b134c_cgraph">
<area shape="rect" title=" " alt="" coords="5,29,122,55"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="799,5,868,31"/>
<area shape="poly" title=" " alt="" coords="122,38,784,17,784,22,122,43"/>
<area shape="rect" href="yubihsm_8c.html#a7b5f1f0c1cbca11fbe21e7e4e6b29a1b" title=" " alt="" coords="170,55,324,80"/>
<area shape="poly" title=" " alt="" coords="122,48,155,52,154,57,122,53"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="798,129,869,155"/>
<area shape="poly" title=" " alt="" coords="279,79,373,116,472,148,551,167,631,173,733,165,783,155,784,160,734,170,631,178,550,172,470,153,371,121,277,83"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="372,80,520,106"/>
<area shape="poly" title=" " alt="" coords="325,75,357,79,356,84,324,80"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="792,80,875,106"/>
<area shape="poly" title=" " alt="" coords="325,59,511,53,623,55,734,65,777,73,776,79,733,70,623,61,511,58,325,64"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="568,80,734,106"/>
<area shape="poly" title=" " alt="" coords="520,90,553,90,553,96,520,96"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="586,129,716,155"/>
<area shape="poly" title=" " alt="" coords="503,104,580,122,579,128,502,109"/>
<area shape="poly" title=" " alt="" coords="683,77,785,35,787,40,685,82"/>
<area shape="poly" title=" " alt="" coords="702,104,783,126,782,131,701,109"/>
<area shape="poly" title=" " alt="" coords="734,90,776,90,776,96,734,96"/>
<area shape="poly" title=" " alt="" coords="717,140,783,140,783,145,717,145"/>
<area shape="poly" title=" " alt="" coords="701,126,776,105,777,111,702,131"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="782,179,885,204"/>
<area shape="poly" title=" " alt="" coords="702,153,769,171,767,177,701,158"/>
</map>
</div>

</div>
</div>
<a id="a45da02427ecf4427e4c4c181bdd9891b" name="a45da02427ecf4427e4c4c181bdd9891b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a45da02427ecf4427e4c4c181bdd9891b">&#9670;&#160;</a></span>get_session()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CK_RV get_session </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__pkcs11__context.html">yubihsm_pkcs11_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CK_SESSION_HANDLE</td>          <td class="paramname"><span class="paramname"><em>hSession</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structyubihsm__pkcs11__session.html">yubihsm_pkcs11_session</a> **</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>session_state</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="util__pkcs11_8c_source.html#l02789">2789</a> of file <a class="el" href="util__pkcs11_8c_source.html">util_pkcs11.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2790</span>                                                                       {</div>
<div class="line"><span class="lineno"> 2791</span>  <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="code hl_define" href="pkcs11_8h.html#abed4fb4d15e18c668b783ad68448fed7">slot_id</a> = <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a1907ffdf44b24385d6e575396ea79806">hSession</a> &gt;&gt; 16;</div>
<div class="line"><span class="lineno"> 2792</span>  <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> session_id = <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a1907ffdf44b24385d6e575396ea79806">hSession</a> &amp; 0xffff;</div>
<div class="line"><span class="lineno"> 2793</span> </div>
<div class="line"><span class="lineno"> 2794</span>  <a class="code hl_struct" href="structyubihsm__pkcs11__slot.html">yubihsm_pkcs11_slot</a> *<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a> = <a class="code hl_function" href="util__pkcs11_8c.html#a79a44d844efebfc64db6cf5836754539">get_slot</a>(ctx, <a class="code hl_define" href="pkcs11_8h.html#abed4fb4d15e18c668b783ad68448fed7">slot_id</a>);</div>
<div class="line"><span class="lineno"> 2795</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a> == NULL) {</div>
<div class="line"><span class="lineno"> 2796</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Slot %d doesn&#39;t exist&quot;</span>, <a class="code hl_define" href="pkcs11_8h.html#abed4fb4d15e18c668b783ad68448fed7">slot_id</a>);</div>
<div class="line"><span class="lineno"> 2797</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a441e417965e26e5a4b08df9993311689">CKR_SESSION_HANDLE_INVALID</a>;</div>
<div class="line"><span class="lineno"> 2798</span>  }</div>
<div class="line"><span class="lineno"> 2799</span> </div>
<div class="line"><span class="lineno"> 2800</span>  <a class="code hl_struct" href="struct_list_item.html">ListItem</a> *item =</div>
<div class="line"><span class="lineno"> 2801</span>    <a class="code hl_function" href="list_8c.html#ac048645b0cd40b78c89aad9e770d4aab">list_get</a>(&amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__slot.html#ab8e6a1f9aba139c1561f21304649b43a">pkcs11_sessions</a>, &amp;session_id, compare_session);</div>
<div class="line"><span class="lineno"> 2802</span>  <span class="keywordflow">if</span> (item == NULL) {</div>
<div class="line"><span class="lineno"> 2803</span>    <a class="code hl_function" href="util__pkcs11_8c.html#a3754cf5cb42a5e282658cf94f405574e">release_slot</a>(ctx, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>);</div>
<div class="line"><span class="lineno"> 2804</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Session %d doesn&#39;t exist&quot;</span>, session_id);</div>
<div class="line"><span class="lineno"> 2805</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a441e417965e26e5a4b08df9993311689">CKR_SESSION_HANDLE_INVALID</a>;</div>
<div class="line"><span class="lineno"> 2806</span>  }</div>
<div class="line"><span class="lineno"> 2807</span> </div>
<div class="line"><span class="lineno"> 2808</span>  *<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a> = (<a class="code hl_struct" href="structyubihsm__pkcs11__session.html">yubihsm_pkcs11_session</a> *) item-&gt;<a class="code hl_variable" href="struct_list_item.html#a788104e1ae9d59a384497766e5203f20">data</a>;</div>
<div class="line"><span class="lineno"> 2809</span>  <span class="keywordtype">int</span> <a class="code hl_struct" href="structstate.html">state</a> = (int) (*session)-&gt;session_state;</div>
<div class="line"><span class="lineno"> 2810</span>  <span class="keywordflow">if</span> (session_state == 0 || ((session_state &amp; <a class="code hl_struct" href="structstate.html">state</a>) == <a class="code hl_struct" href="structstate.html">state</a>)) {</div>
<div class="line"><span class="lineno"> 2811</span>    <span class="comment">// NOTE(thorduri): slot is locked.</span></div>
<div class="line"><span class="lineno"> 2812</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>;</div>
<div class="line"><span class="lineno"> 2813</span>  }</div>
<div class="line"><span class="lineno"> 2814</span> </div>
<div class="line"><span class="lineno"> 2815</span>  CK_RV <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a> = <a class="code hl_define" href="pkcs11_8h.html#a441e417965e26e5a4b08df9993311689">CKR_SESSION_HANDLE_INVALID</a>;</div>
<div class="line"><span class="lineno"> 2816</span>  <span class="keywordflow">if</span> (session_state == <a class="code hl_define" href="yubihsm__pkcs11_8h.html#ace6bd3fe1cbfdd8d2f55b2679cf6fce4">SESSION_AUTHENTICATED</a>) {</div>
<div class="line"><span class="lineno"> 2817</span>    <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a> = <a class="code hl_define" href="pkcs11_8h.html#ac06517dfda93d4636ff63eb000125ad4">CKR_USER_NOT_LOGGED_IN</a>;</div>
<div class="line"><span class="lineno"> 2818</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Session user not logged in&quot;</span>);</div>
<div class="line"><span class="lineno"> 2819</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (session_state == <a class="code hl_enumvalue" href="yubihsm__pkcs11_8h.html#a12ef82fba1bb65ec44ebfd41d42554f1a72bd07cb581cbf8c4f255db11973f575">SESSION_AUTHENTICATED_RW</a>) {</div>
<div class="line"><span class="lineno"> 2820</span>    <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a> = <a class="code hl_define" href="pkcs11_8h.html#a3baafacbda3a24510a3ab8ed044a7329">CKR_SESSION_READ_ONLY</a>;</div>
<div class="line"><span class="lineno"> 2821</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Session read only&quot;</span>);</div>
<div class="line"><span class="lineno"> 2822</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (session_state == <a class="code hl_define" href="yubihsm__pkcs11_8h.html#a240b748f148bcec16dc38f0e631bc54a">SESSION_NOT_AUTHENTICATED</a>) {</div>
<div class="line"><span class="lineno"> 2823</span>    <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a> = <a class="code hl_define" href="pkcs11_8h.html#aa9cd64ba03077e1ade9f6a27633a038b">CKR_USER_ALREADY_LOGGED_IN</a>;</div>
<div class="line"><span class="lineno"> 2824</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Session user already logged in&quot;</span>);</div>
<div class="line"><span class="lineno"> 2825</span>  }</div>
<div class="line"><span class="lineno"> 2826</span> </div>
<div class="line"><span class="lineno"> 2827</span>  <a class="code hl_function" href="util__pkcs11_8c.html#a3754cf5cb42a5e282658cf94f405574e">release_slot</a>(ctx, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>);</div>
<div class="line"><span class="lineno"> 2828</span>  <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a>;</div>
<div class="line"><span class="lineno"> 2829</span>}</div>
<div class="ttc" id="apkcs11_8h_html_a3baafacbda3a24510a3ab8ed044a7329"><div class="ttname"><a href="pkcs11_8h.html#a3baafacbda3a24510a3ab8ed044a7329">CKR_SESSION_READ_ONLY</a></div><div class="ttdeci">#define CKR_SESSION_READ_ONLY</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l01140">pkcs11.h:1140</a></div></div>
<div class="ttc" id="apkcs11_8h_html_a441e417965e26e5a4b08df9993311689"><div class="ttname"><a href="pkcs11_8h.html#a441e417965e26e5a4b08df9993311689">CKR_SESSION_HANDLE_INVALID</a></div><div class="ttdeci">#define CKR_SESSION_HANDLE_INVALID</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l01138">pkcs11.h:1138</a></div></div>
<div class="ttc" id="apkcs11_8h_html_aa9cd64ba03077e1ade9f6a27633a038b"><div class="ttname"><a href="pkcs11_8h.html#aa9cd64ba03077e1ade9f6a27633a038b">CKR_USER_ALREADY_LOGGED_IN</a></div><div class="ttdeci">#define CKR_USER_ALREADY_LOGGED_IN</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l01154">pkcs11.h:1154</a></div></div>
<div class="ttc" id="apkcs11_8h_html_ac06517dfda93d4636ff63eb000125ad4"><div class="ttname"><a href="pkcs11_8h.html#ac06517dfda93d4636ff63eb000125ad4">CKR_USER_NOT_LOGGED_IN</a></div><div class="ttdeci">#define CKR_USER_NOT_LOGGED_IN</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l01155">pkcs11.h:1155</a></div></div>
<div class="ttc" id="astructstate_html"><div class="ttname"><a href="structstate.html">state</a></div><div class="ttdef"><b>Definition</b> <a href="yubihsm__curl_8c_source.html#l00028">yubihsm_curl.c:28</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a1907ffdf44b24385d6e575396ea79806"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a1907ffdf44b24385d6e575396ea79806">hSession</a></div><div class="ttdeci">CK_SESSION_HANDLE hSession</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l00780">yubihsm_pkcs11.c:780</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a9dbb22e3510dddb1ebb576404a972e7d"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a></div><div class="ttdeci">CK_RV rv</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l00569">yubihsm_pkcs11.c:569</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8h_html_a240b748f148bcec16dc38f0e631bc54a"><div class="ttname"><a href="yubihsm__pkcs11_8h.html#a240b748f148bcec16dc38f0e631bc54a">SESSION_NOT_AUTHENTICATED</a></div><div class="ttdeci">#define SESSION_NOT_AUTHENTICATED</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8h_source.html#l00039">yubihsm_pkcs11.h:39</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util__pkcs11_8h_a45da02427ecf4427e4c4c181bdd9891b_cgraph.png" border="0" usemap="#autil__pkcs11_8h_a45da02427ecf4427e4c4c181bdd9891b_cgraph" alt=""/></div>
<map name="autil__pkcs11_8h_a45da02427ecf4427e4c4c181bdd9891b_cgraph" id="autil__pkcs11_8h_a45da02427ecf4427e4c4c181bdd9891b_cgraph">
<area shape="rect" title=" " alt="" coords="5,56,97,82"/>
<area shape="rect" href="util__pkcs11_8c.html#a79a44d844efebfc64db6cf5836754539" title=" " alt="" coords="157,5,224,31"/>
<area shape="poly" title=" " alt="" coords="88,53,141,33,143,38,90,58"/>
<area shape="rect" href="list_8c.html#ac048645b0cd40b78c89aad9e770d4aab" title=" " alt="" coords="284,31,347,56"/>
<area shape="poly" title=" " alt="" coords="97,62,268,45,269,51,97,67"/>
<area shape="rect" href="util__pkcs11_8c.html#a3754cf5cb42a5e282658cf94f405574e" title=" " alt="" coords="145,107,236,132"/>
<area shape="poly" title=" " alt="" coords="90,80,140,98,138,103,88,85"/>
<area shape="poly" title=" " alt="" coords="225,22,269,31,268,37,224,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util__pkcs11_8h_a45da02427ecf4427e4c4c181bdd9891b_icgraph.png" border="0" usemap="#autil__pkcs11_8h_a45da02427ecf4427e4c4c181bdd9891b_icgraph" alt=""/></div>
<map name="autil__pkcs11_8h_a45da02427ecf4427e4c4c181bdd9891b_icgraph" id="autil__pkcs11_8h_a45da02427ecf4427e4c4c181bdd9891b_icgraph">
<area shape="rect" title=" " alt="" coords="228,55,319,80"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae42be1463b17c635f1d1db61afc0db16" title=" " alt="" coords="5,5,180,31"/>
<area shape="poly" title=" " alt="" coords="212,54,142,34,143,29,213,48"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#a43267eb905aa786de5a5bbf4bd08d775" title=" " alt="" coords="5,55,180,80"/>
<area shape="poly" title=" " alt="" coords="212,70,180,70,180,65,212,65"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#a011b512f4b9e6e43e3ab56b5534f3fde" title=" " alt="" coords="5,104,180,130"/>
<area shape="poly" title=" " alt="" coords="213,87,143,106,142,101,212,81"/>
</map>
</div>

</div>
</div>
<a id="a79a44d844efebfc64db6cf5836754539" name="a79a44d844efebfc64db6cf5836754539"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a79a44d844efebfc64db6cf5836754539">&#9670;&#160;</a></span>get_slot()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structyubihsm__pkcs11__slot.html">yubihsm_pkcs11_slot</a> * get_slot </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__pkcs11__context.html">yubihsm_pkcs11_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pkcs11_8h.html#a35181858a3b7a0a81f49d180d8f446ef">CK_ULONG</a></td>          <td class="paramname"><span class="paramname"><em>id</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="util__pkcs11_8c_source.html#l02766">2766</a> of file <a class="el" href="util__pkcs11_8c_source.html">util_pkcs11.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2766</span>                                                                        {</div>
<div class="line"><span class="lineno"> 2767</span> </div>
<div class="line"><span class="lineno"> 2768</span>  <a class="code hl_struct" href="struct_list_item.html">ListItem</a> *item = <a class="code hl_function" href="list_8c.html#ac048645b0cd40b78c89aad9e770d4aab">list_get</a>(&amp;ctx-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__context.html#ab22edea4554a2ea96e4e63954f6769a7">slots</a>, &amp;<span class="keywordtype">id</span>, compare_slot);</div>
<div class="line"><span class="lineno"> 2769</span>  <span class="keywordflow">if</span> (item) {</div>
<div class="line"><span class="lineno"> 2770</span>    <a class="code hl_struct" href="structyubihsm__pkcs11__slot.html">yubihsm_pkcs11_slot</a> *<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a> = (<a class="code hl_struct" href="structyubihsm__pkcs11__slot.html">yubihsm_pkcs11_slot</a> *) item-&gt;<a class="code hl_variable" href="struct_list_item.html#a788104e1ae9d59a384497766e5203f20">data</a>;</div>
<div class="line"><span class="lineno"> 2771</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__slot.html#a3ecfa0dfb39d722e9a0fad07a8d9334d">mutex</a> != NULL) {</div>
<div class="line"><span class="lineno"> 2772</span>      <span class="keywordflow">if</span> (ctx-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__context.html#a499767227a12b9a3309bfd1220dc8ed9">lock_mutex</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__slot.html#a3ecfa0dfb39d722e9a0fad07a8d9334d">mutex</a>) != <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>) {</div>
<div class="line"><span class="lineno"> 2773</span>        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 2774</span>      }</div>
<div class="line"><span class="lineno"> 2775</span>    }</div>
<div class="line"><span class="lineno"> 2776</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>;</div>
<div class="line"><span class="lineno"> 2777</span>  }</div>
<div class="line"><span class="lineno"> 2778</span> </div>
<div class="line"><span class="lineno"> 2779</span>  <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 2780</span>}</div>
<div class="ttc" id="astructyubihsm__pkcs11__context_html_a499767227a12b9a3309bfd1220dc8ed9"><div class="ttname"><a href="structyubihsm__pkcs11__context.html#a499767227a12b9a3309bfd1220dc8ed9">yubihsm_pkcs11_context::lock_mutex</a></div><div class="ttdeci">CK_LOCKMUTEX lock_mutex</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8h_source.html#l00145">yubihsm_pkcs11.h:145</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util__pkcs11_8h_a79a44d844efebfc64db6cf5836754539_cgraph.png" border="0" usemap="#autil__pkcs11_8h_a79a44d844efebfc64db6cf5836754539_cgraph" alt=""/></div>
<map name="autil__pkcs11_8h_a79a44d844efebfc64db6cf5836754539_cgraph" id="autil__pkcs11_8h_a79a44d844efebfc64db6cf5836754539_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,73,31"/>
<area shape="rect" href="list_8c.html#ac048645b0cd40b78c89aad9e770d4aab" title=" " alt="" coords="121,5,184,31"/>
<area shape="poly" title=" " alt="" coords="73,16,105,16,105,21,73,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util__pkcs11_8h_a79a44d844efebfc64db6cf5836754539_icgraph.png" border="0" usemap="#autil__pkcs11_8h_a79a44d844efebfc64db6cf5836754539_icgraph" alt=""/></div>
<map name="autil__pkcs11_8h_a79a44d844efebfc64db6cf5836754539_icgraph" id="autil__pkcs11_8h_a79a44d844efebfc64db6cf5836754539_icgraph">
<area shape="rect" title=" " alt="" coords="450,55,517,80"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#a48d97eeb2196fb96be0f0ba4c82d5063" title=" " alt="" coords="228,5,402,31"/>
<area shape="poly" title=" " alt="" coords="434,55,401,45,365,34,366,29,403,40,436,50"/>
<area shape="rect" href="util__pkcs11_8c.html#a85ea84ffb047281f34a733572f67b254" title=" " alt="" coords="261,55,369,80"/>
<area shape="poly" title=" " alt="" coords="435,70,369,70,369,65,435,65"/>
<area shape="rect" href="util__pkcs11_8c.html#a45da02427ecf4427e4c4c181bdd9891b" title=" " alt="" coords="269,104,360,130"/>
<area shape="poly" title=" " alt="" coords="436,85,403,95,362,107,360,102,401,90,434,80"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae42be1463b17c635f1d1db61afc0db16" title=" " alt="" coords="5,55,180,80"/>
<area shape="poly" title=" " alt="" coords="245,70,180,70,180,65,245,65"/>
<area shape="poly" title=" " alt="" coords="253,106,153,84,154,78,254,101"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#a43267eb905aa786de5a5bbf4bd08d775" title=" " alt="" coords="5,104,180,130"/>
<area shape="poly" title=" " alt="" coords="253,120,180,120,180,114,253,114"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#a011b512f4b9e6e43e3ab56b5534f3fde" title=" " alt="" coords="5,153,180,179"/>
<area shape="poly" title=" " alt="" coords="254,133,154,155,153,150,253,128"/>
</map>
</div>

</div>
</div>
<a id="a03746a942ba1eaafbec20b675463ee00" name="a03746a942ba1eaafbec20b675463ee00"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03746a942ba1eaafbec20b675463ee00">&#9670;&#160;</a></span>is_ECDSA_sign_mechanism()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool is_ECDSA_sign_mechanism </td>
          <td>(</td>
          <td class="paramtype">CK_MECHANISM_TYPE</td>          <td class="paramname"><span class="paramname"><em>m</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="util__pkcs11_8c_source.html#l02690">2690</a> of file <a class="el" href="util__pkcs11_8c_source.html">util_pkcs11.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2690</span>                                                  {</div>
<div class="line"><span class="lineno"> 2691</span> </div>
<div class="line"><span class="lineno"> 2692</span>  <span class="keywordflow">switch</span> (m) {</div>
<div class="line"><span class="lineno"> 2693</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ab4a7299a144f0ef52cee06893cc60483">CKM_ECDSA</a>:</div>
<div class="line"><span class="lineno"> 2694</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a0911727b2cd926b9209f24bf50bc555a">CKM_ECDSA_SHA1</a>:</div>
<div class="line"><span class="lineno"> 2695</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ac7f12f2ee83f0ca3b309b22e5b48e486">CKM_ECDSA_SHA256</a>:</div>
<div class="line"><span class="lineno"> 2696</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ab4aaed0f4b4146b812c6cff25828fcfd">CKM_ECDSA_SHA384</a>:</div>
<div class="line"><span class="lineno"> 2697</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a69a7674eee1a8069128923037b504e59">CKM_ECDSA_SHA512</a>:</div>
<div class="line"><span class="lineno"> 2698</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2699</span> </div>
<div class="line"><span class="lineno"> 2700</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 2701</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2702</span>  }</div>
<div class="line"><span class="lineno"> 2703</span> </div>
<div class="line"><span class="lineno"> 2704</span>  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2705</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util__pkcs11_8h_a03746a942ba1eaafbec20b675463ee00_icgraph.png" border="0" usemap="#autil__pkcs11_8h_a03746a942ba1eaafbec20b675463ee00_icgraph" alt=""/></div>
<map name="autil__pkcs11_8h_a03746a942ba1eaafbec20b675463ee00_icgraph" id="autil__pkcs11_8h_a03746a942ba1eaafbec20b675463ee00_icgraph">
<area shape="rect" title=" " alt="" coords="432,96,622,121"/>
<area shape="rect" href="util__pkcs11_8c.html#a785bd4bd444e619e6e5e12b2e392f086" title=" " alt="" coords="225,5,382,46"/>
<area shape="poly" title=" " alt="" coords="475,92,360,49,362,44,477,87"/>
<area shape="rect" href="util__pkcs11_8c.html#ae8ed437178cb69b0fed6916747368344" title=" " alt="" coords="223,70,384,96"/>
<area shape="poly" title=" " alt="" coords="416,98,384,95,385,89,417,93"/>
<area shape="rect" href="util__pkcs11_8c.html#a547f9032e3bcd7d6a5a810e94822e337" title=" " alt="" coords="241,120,366,145"/>
<area shape="poly" title=" " alt="" coords="417,123,366,128,366,123,416,118"/>
<area shape="rect" href="util__pkcs11_8c.html#ab17f6ba85432d715def5185e7832c9e8" title=" " alt="" coords="251,169,356,194"/>
<area shape="poly" title=" " alt="" coords="475,129,385,160,351,171,349,166,383,155,474,124"/>
<area shape="rect" href="util__pkcs11_8c.html#a87b96fbdfd225d8124f0a6f6d6538292" title=" " alt="" coords="5,70,175,96"/>
<area shape="poly" title=" " alt="" coords="207,86,175,86,175,80,207,80"/>
</map>
</div>

</div>
</div>
<a id="a3f1010425d5308dfa15d696b4853c68c" name="a3f1010425d5308dfa15d696b4853c68c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f1010425d5308dfa15d696b4853c68c">&#9670;&#160;</a></span>is_hashed_mechanism()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool is_hashed_mechanism </td>
          <td>(</td>
          <td class="paramtype">CK_MECHANISM_TYPE</td>          <td class="paramname"><span class="paramname"><em>m</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="util__pkcs11_8c_source.html#l02645">2645</a> of file <a class="el" href="util__pkcs11_8c_source.html">util_pkcs11.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2645</span>                                              {</div>
<div class="line"><span class="lineno"> 2646</span> </div>
<div class="line"><span class="lineno"> 2647</span>  <span class="keywordflow">switch</span> (m) {</div>
<div class="line"><span class="lineno"> 2648</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a9b5d495ac404ebbce07d1f58436ee31d">CKM_SHA1_RSA_PKCS</a>:</div>
<div class="line"><span class="lineno"> 2649</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ae24525658e8df0829c24236ee7614d1f">CKM_SHA256_RSA_PKCS</a>:</div>
<div class="line"><span class="lineno"> 2650</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ad8d3d34082b7e18f4f173804cf5b959b">CKM_SHA384_RSA_PKCS</a>:</div>
<div class="line"><span class="lineno"> 2651</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a6c0c89dfd22474095772f87d25c6a17d">CKM_SHA512_RSA_PKCS</a>:</div>
<div class="line"><span class="lineno"> 2652</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ad5943f11b67c32a40d4d6687e9cbb64b">CKM_SHA1_RSA_PKCS_PSS</a>:</div>
<div class="line"><span class="lineno"> 2653</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ad336fbe2d222fc913c70dd56fabf7f7e">CKM_SHA256_RSA_PKCS_PSS</a>:</div>
<div class="line"><span class="lineno"> 2654</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ae5a8bfa905dc8dab5b2130a8bb6b23fb">CKM_SHA384_RSA_PKCS_PSS</a>:</div>
<div class="line"><span class="lineno"> 2655</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a67393bc84515cf68048ca3b3bb8b39a0">CKM_SHA512_RSA_PKCS_PSS</a>:</div>
<div class="line"><span class="lineno"> 2656</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a0911727b2cd926b9209f24bf50bc555a">CKM_ECDSA_SHA1</a>:</div>
<div class="line"><span class="lineno"> 2657</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ac7f12f2ee83f0ca3b309b22e5b48e486">CKM_ECDSA_SHA256</a>:</div>
<div class="line"><span class="lineno"> 2658</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ab4aaed0f4b4146b812c6cff25828fcfd">CKM_ECDSA_SHA384</a>:</div>
<div class="line"><span class="lineno"> 2659</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a69a7674eee1a8069128923037b504e59">CKM_ECDSA_SHA512</a>:</div>
<div class="line"><span class="lineno"> 2660</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#af1818a1c453a84f01f2e868307ca8fed">CKM_SHA_1</a>:</div>
<div class="line"><span class="lineno"> 2661</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a4d11f88ae3bea2f748f275c03b54a648">CKM_SHA256</a>:</div>
<div class="line"><span class="lineno"> 2662</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a9278e01971ca83cdd07e4b8e07a00bc8">CKM_SHA384</a>:</div>
<div class="line"><span class="lineno"> 2663</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a9bf4bf7375a24e1010cc8e0139608fd5">CKM_SHA512</a>:</div>
<div class="line"><span class="lineno"> 2664</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2665</span> </div>
<div class="line"><span class="lineno"> 2666</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 2667</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2668</span>  }</div>
<div class="line"><span class="lineno"> 2669</span> </div>
<div class="line"><span class="lineno"> 2670</span>  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2671</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util__pkcs11_8h_a3f1010425d5308dfa15d696b4853c68c_icgraph.png" border="0" usemap="#autil__pkcs11_8h_a3f1010425d5308dfa15d696b4853c68c_icgraph" alt=""/></div>
<map name="autil__pkcs11_8h_a3f1010425d5308dfa15d696b4853c68c_icgraph" id="autil__pkcs11_8h_a3f1010425d5308dfa15d696b4853c68c_icgraph">
<area shape="rect" title=" " alt="" coords="211,70,365,96"/>
<area shape="rect" href="util__pkcs11_8c.html#a785bd4bd444e619e6e5e12b2e392f086" title=" " alt="" coords="5,5,163,46"/>
<area shape="poly" title=" " alt="" coords="224,68,158,49,160,44,225,63"/>
<area shape="rect" href="util__pkcs11_8c.html#a547f9032e3bcd7d6a5a810e94822e337" title=" " alt="" coords="21,70,147,96"/>
<area shape="poly" title=" " alt="" coords="196,86,147,86,147,80,196,80"/>
<area shape="rect" href="util__pkcs11_8c.html#ab17f6ba85432d715def5185e7832c9e8" title=" " alt="" coords="32,120,136,145"/>
<area shape="poly" title=" " alt="" coords="218,103,137,122,136,117,216,97"/>
</map>
</div>

</div>
</div>
<a id="a3da5875af7a71b11ee5ead6b160d1ff4" name="a3da5875af7a71b11ee5ead6b160d1ff4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3da5875af7a71b11ee5ead6b160d1ff4">&#9670;&#160;</a></span>is_HMAC_sign_mechanism()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool is_HMAC_sign_mechanism </td>
          <td>(</td>
          <td class="paramtype">CK_MECHANISM_TYPE</td>          <td class="paramname"><span class="paramname"><em>m</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="util__pkcs11_8c_source.html#l02724">2724</a> of file <a class="el" href="util__pkcs11_8c_source.html">util_pkcs11.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2724</span>                                                 {</div>
<div class="line"><span class="lineno"> 2725</span> </div>
<div class="line"><span class="lineno"> 2726</span>  <span class="keywordflow">switch</span> (m) {</div>
<div class="line"><span class="lineno"> 2727</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a1eb3f4cee46e624bfbbc6889e1e5bc06">CKM_SHA_1_HMAC</a>:</div>
<div class="line"><span class="lineno"> 2728</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a839f51ab9e78e866f1d3773b8466b011">CKM_SHA256_HMAC</a>:</div>
<div class="line"><span class="lineno"> 2729</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a97ee18b73f21e8047fadc8a0aa12f23a">CKM_SHA384_HMAC</a>:</div>
<div class="line"><span class="lineno"> 2730</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ae1b850f9141aa407e45b02fa3ade3759">CKM_SHA512_HMAC</a>:</div>
<div class="line"><span class="lineno"> 2731</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2732</span> </div>
<div class="line"><span class="lineno"> 2733</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 2734</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2735</span>  }</div>
<div class="line"><span class="lineno"> 2736</span> </div>
<div class="line"><span class="lineno"> 2737</span>  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2738</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util__pkcs11_8h_a3da5875af7a71b11ee5ead6b160d1ff4_icgraph.png" border="0" usemap="#autil__pkcs11_8h_a3da5875af7a71b11ee5ead6b160d1ff4_icgraph" alt=""/></div>
<map name="autil__pkcs11_8h_a3da5875af7a71b11ee5ead6b160d1ff4_icgraph" id="autil__pkcs11_8h_a3da5875af7a71b11ee5ead6b160d1ff4_icgraph">
<area shape="rect" title=" " alt="" coords="432,55,615,80"/>
<area shape="rect" href="util__pkcs11_8c.html#ae8ed437178cb69b0fed6916747368344" title=" " alt="" coords="223,5,384,31"/>
<area shape="poly" title=" " alt="" coords="447,53,363,34,365,29,449,48"/>
<area shape="rect" href="util__pkcs11_8c.html#a547f9032e3bcd7d6a5a810e94822e337" title=" " alt="" coords="241,55,366,80"/>
<area shape="poly" title=" " alt="" coords="417,70,367,70,367,65,417,65"/>
<area shape="rect" href="util__pkcs11_8c.html#ab17f6ba85432d715def5185e7832c9e8" title=" " alt="" coords="251,104,356,130"/>
<area shape="poly" title=" " alt="" coords="448,87,357,108,355,103,447,82"/>
<area shape="rect" href="util__pkcs11_8c.html#a87b96fbdfd225d8124f0a6f6d6538292" title=" " alt="" coords="5,5,175,31"/>
<area shape="poly" title=" " alt="" coords="207,21,175,21,175,16,207,16"/>
</map>
</div>

</div>
</div>
<a id="a0040a19f3ec5afc2b8717e10860d55bc" name="a0040a19f3ec5afc2b8717e10860d55bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0040a19f3ec5afc2b8717e10860d55bc">&#9670;&#160;</a></span>is_PKCS1v1_5_sign_mechanism()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool is_PKCS1v1_5_sign_mechanism </td>
          <td>(</td>
          <td class="paramtype">CK_MECHANISM_TYPE</td>          <td class="paramname"><span class="paramname"><em>m</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="util__pkcs11_8c_source.html#l02673">2673</a> of file <a class="el" href="util__pkcs11_8c_source.html">util_pkcs11.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2673</span>                                                      {</div>
<div class="line"><span class="lineno"> 2674</span> </div>
<div class="line"><span class="lineno"> 2675</span>  <span class="keywordflow">switch</span> (m) {</div>
<div class="line"><span class="lineno"> 2676</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a08a8e0f2109de3ff3bfe26f220447a2e">CKM_RSA_PKCS</a>:</div>
<div class="line"><span class="lineno"> 2677</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a9b5d495ac404ebbce07d1f58436ee31d">CKM_SHA1_RSA_PKCS</a>:</div>
<div class="line"><span class="lineno"> 2678</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ae24525658e8df0829c24236ee7614d1f">CKM_SHA256_RSA_PKCS</a>:</div>
<div class="line"><span class="lineno"> 2679</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ad8d3d34082b7e18f4f173804cf5b959b">CKM_SHA384_RSA_PKCS</a>:</div>
<div class="line"><span class="lineno"> 2680</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a6c0c89dfd22474095772f87d25c6a17d">CKM_SHA512_RSA_PKCS</a>:</div>
<div class="line"><span class="lineno"> 2681</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2682</span> </div>
<div class="line"><span class="lineno"> 2683</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 2684</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2685</span>  }</div>
<div class="line"><span class="lineno"> 2686</span> </div>
<div class="line"><span class="lineno"> 2687</span>  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2688</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util__pkcs11_8h_a0040a19f3ec5afc2b8717e10860d55bc_icgraph.png" border="0" usemap="#autil__pkcs11_8h_a0040a19f3ec5afc2b8717e10860d55bc_icgraph" alt=""/></div>
<map name="autil__pkcs11_8h_a0040a19f3ec5afc2b8717e10860d55bc_icgraph" id="autil__pkcs11_8h_a0040a19f3ec5afc2b8717e10860d55bc_icgraph">
<area shape="rect" title=" " alt="" coords="92,5,307,31"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#a47dc8b58f8b5e520f4f6d6e29223ee63" title=" " alt="" coords="5,5,44,31"/>
<area shape="poly" title=" " alt="" coords="76,21,44,21,44,16,76,16"/>
</map>
</div>

</div>
</div>
<a id="a34722aea70286e920362e216c048f629" name="a34722aea70286e920362e216c048f629"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34722aea70286e920362e216c048f629">&#9670;&#160;</a></span>is_PSS_sign_mechanism()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool is_PSS_sign_mechanism </td>
          <td>(</td>
          <td class="paramtype">CK_MECHANISM_TYPE</td>          <td class="paramname"><span class="paramname"><em>m</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="util__pkcs11_8c_source.html#l02707">2707</a> of file <a class="el" href="util__pkcs11_8c_source.html">util_pkcs11.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2707</span>                                                {</div>
<div class="line"><span class="lineno"> 2708</span> </div>
<div class="line"><span class="lineno"> 2709</span>  <span class="keywordflow">switch</span> (m) {</div>
<div class="line"><span class="lineno"> 2710</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ad4f5697408b23623c904df2b1ca8a9f1">CKM_RSA_PKCS_PSS</a>:</div>
<div class="line"><span class="lineno"> 2711</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ad5943f11b67c32a40d4d6687e9cbb64b">CKM_SHA1_RSA_PKCS_PSS</a>:</div>
<div class="line"><span class="lineno"> 2712</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ad336fbe2d222fc913c70dd56fabf7f7e">CKM_SHA256_RSA_PKCS_PSS</a>:</div>
<div class="line"><span class="lineno"> 2713</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ae5a8bfa905dc8dab5b2130a8bb6b23fb">CKM_SHA384_RSA_PKCS_PSS</a>:</div>
<div class="line"><span class="lineno"> 2714</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a67393bc84515cf68048ca3b3bb8b39a0">CKM_SHA512_RSA_PKCS_PSS</a>:</div>
<div class="line"><span class="lineno"> 2715</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2716</span> </div>
<div class="line"><span class="lineno"> 2717</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 2718</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2719</span>  }</div>
<div class="line"><span class="lineno"> 2720</span> </div>
<div class="line"><span class="lineno"> 2721</span>  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2722</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util__pkcs11_8h_a34722aea70286e920362e216c048f629_icgraph.png" border="0" usemap="#autil__pkcs11_8h_a34722aea70286e920362e216c048f629_icgraph" alt=""/></div>
<map name="autil__pkcs11_8h_a34722aea70286e920362e216c048f629_icgraph" id="autil__pkcs11_8h_a34722aea70286e920362e216c048f629_icgraph">
<area shape="rect" title=" " alt="" coords="179,31,349,56"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#a47dc8b58f8b5e520f4f6d6e29223ee63" title=" " alt="" coords="49,5,87,31"/>
<area shape="poly" title=" " alt="" coords="163,33,87,23,88,18,164,28"/>
<area shape="rect" href="util__pkcs11_8c.html#a547f9032e3bcd7d6a5a810e94822e337" title=" " alt="" coords="5,55,131,80"/>
<area shape="poly" title=" " alt="" coords="164,58,131,62,131,57,163,53"/>
</map>
</div>

</div>
</div>
<a id="a8a3a4cd4d71d1a0489be171682cb9ece" name="a8a3a4cd4d71d1a0489be171682cb9ece"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a3a4cd4d71d1a0489be171682cb9ece">&#9670;&#160;</a></span>is_RSA_decrypt_mechanism()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool is_RSA_decrypt_mechanism </td>
          <td>(</td>
          <td class="paramtype">CK_MECHANISM_TYPE</td>          <td class="paramname"><span class="paramname"><em>m</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="util__pkcs11_8c_source.html#l02627">2627</a> of file <a class="el" href="util__pkcs11_8c_source.html">util_pkcs11.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2627</span>                                                   {</div>
<div class="line"><span class="lineno"> 2628</span> </div>
<div class="line"><span class="lineno"> 2629</span>  <span class="keywordflow">switch</span> (m) {</div>
<div class="line"><span class="lineno"> 2630</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a08a8e0f2109de3ff3bfe26f220447a2e">CKM_RSA_PKCS</a>:</div>
<div class="line"><span class="lineno"> 2631</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a9b5d495ac404ebbce07d1f58436ee31d">CKM_SHA1_RSA_PKCS</a>:</div>
<div class="line"><span class="lineno"> 2632</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ae24525658e8df0829c24236ee7614d1f">CKM_SHA256_RSA_PKCS</a>:</div>
<div class="line"><span class="lineno"> 2633</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ad8d3d34082b7e18f4f173804cf5b959b">CKM_SHA384_RSA_PKCS</a>:</div>
<div class="line"><span class="lineno"> 2634</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a6c0c89dfd22474095772f87d25c6a17d">CKM_SHA512_RSA_PKCS</a>:</div>
<div class="line"><span class="lineno"> 2635</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a69da8859ad1e6b4f424d071b42ea4a0c">CKM_RSA_PKCS_OAEP</a>:</div>
<div class="line"><span class="lineno"> 2636</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2637</span> </div>
<div class="line"><span class="lineno"> 2638</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 2639</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2640</span>  }</div>
<div class="line"><span class="lineno"> 2641</span> </div>
<div class="line"><span class="lineno"> 2642</span>  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2643</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util__pkcs11_8h_a8a3a4cd4d71d1a0489be171682cb9ece_icgraph.png" border="0" usemap="#autil__pkcs11_8h_a8a3a4cd4d71d1a0489be171682cb9ece_icgraph" alt=""/></div>
<map name="autil__pkcs11_8h_a8a3a4cd4d71d1a0489be171682cb9ece_icgraph" id="autil__pkcs11_8h_a8a3a4cd4d71d1a0489be171682cb9ece_icgraph">
<area shape="rect" title=" " alt="" coords="234,5,424,31"/>
<area shape="rect" href="util__pkcs11_8c.html#a5ce40fa3ee245e65d99ee4cec7a1dd0c" title=" " alt="" coords="5,5,186,31"/>
<area shape="poly" title=" " alt="" coords="218,21,186,21,186,16,218,16"/>
</map>
</div>

</div>
</div>
<a id="a7c0da3eb6986b1e9466392de8eb4b9f5" name="a7c0da3eb6986b1e9466392de8eb4b9f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c0da3eb6986b1e9466392de8eb4b9f5">&#9670;&#160;</a></span>is_RSA_sign_mechanism()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool is_RSA_sign_mechanism </td>
          <td>(</td>
          <td class="paramtype">CK_MECHANISM_TYPE</td>          <td class="paramname"><span class="paramname"><em>m</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="util__pkcs11_8c_source.html#l02605">2605</a> of file <a class="el" href="util__pkcs11_8c_source.html">util_pkcs11.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2605</span>                                                {</div>
<div class="line"><span class="lineno"> 2606</span> </div>
<div class="line"><span class="lineno"> 2607</span>  <span class="keywordflow">switch</span> (m) {</div>
<div class="line"><span class="lineno"> 2608</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a08a8e0f2109de3ff3bfe26f220447a2e">CKM_RSA_PKCS</a>:</div>
<div class="line"><span class="lineno"> 2609</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a9b5d495ac404ebbce07d1f58436ee31d">CKM_SHA1_RSA_PKCS</a>:</div>
<div class="line"><span class="lineno"> 2610</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ae24525658e8df0829c24236ee7614d1f">CKM_SHA256_RSA_PKCS</a>:</div>
<div class="line"><span class="lineno"> 2611</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ad8d3d34082b7e18f4f173804cf5b959b">CKM_SHA384_RSA_PKCS</a>:</div>
<div class="line"><span class="lineno"> 2612</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a6c0c89dfd22474095772f87d25c6a17d">CKM_SHA512_RSA_PKCS</a>:</div>
<div class="line"><span class="lineno"> 2613</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ad4f5697408b23623c904df2b1ca8a9f1">CKM_RSA_PKCS_PSS</a>:</div>
<div class="line"><span class="lineno"> 2614</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ad5943f11b67c32a40d4d6687e9cbb64b">CKM_SHA1_RSA_PKCS_PSS</a>:</div>
<div class="line"><span class="lineno"> 2615</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ad336fbe2d222fc913c70dd56fabf7f7e">CKM_SHA256_RSA_PKCS_PSS</a>:</div>
<div class="line"><span class="lineno"> 2616</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a67393bc84515cf68048ca3b3bb8b39a0">CKM_SHA512_RSA_PKCS_PSS</a>:</div>
<div class="line"><span class="lineno"> 2617</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ae5a8bfa905dc8dab5b2130a8bb6b23fb">CKM_SHA384_RSA_PKCS_PSS</a>:</div>
<div class="line"><span class="lineno"> 2618</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2619</span> </div>
<div class="line"><span class="lineno"> 2620</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 2621</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2622</span>  }</div>
<div class="line"><span class="lineno"> 2623</span> </div>
<div class="line"><span class="lineno"> 2624</span>  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2625</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util__pkcs11_8h_a7c0da3eb6986b1e9466392de8eb4b9f5_icgraph.png" border="0" usemap="#autil__pkcs11_8h_a7c0da3eb6986b1e9466392de8eb4b9f5_icgraph" alt=""/></div>
<map name="autil__pkcs11_8h_a7c0da3eb6986b1e9466392de8eb4b9f5_icgraph" id="autil__pkcs11_8h_a7c0da3eb6986b1e9466392de8eb4b9f5_icgraph">
<area shape="rect" title=" " alt="" coords="432,31,603,56"/>
<area shape="rect" href="util__pkcs11_8c.html#ae8ed437178cb69b0fed6916747368344" title=" " alt="" coords="223,5,384,31"/>
<area shape="poly" title=" " alt="" coords="416,34,384,30,385,25,417,29"/>
<area shape="rect" href="util__pkcs11_8c.html#a547f9032e3bcd7d6a5a810e94822e337" title=" " alt="" coords="241,55,366,80"/>
<area shape="poly" title=" " alt="" coords="417,57,366,63,366,58,416,52"/>
<area shape="rect" href="util__pkcs11_8c.html#a87b96fbdfd225d8124f0a6f6d6538292" title=" " alt="" coords="5,5,175,31"/>
<area shape="poly" title=" " alt="" coords="207,21,175,21,175,16,207,16"/>
</map>
</div>

</div>
</div>
<a id="a2413ad4604ce34308256962fb1098ec7" name="a2413ad4604ce34308256962fb1098ec7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2413ad4604ce34308256962fb1098ec7">&#9670;&#160;</a></span>parse_ec_generate_template()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CK_RV parse_ec_generate_template </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="pkcs11_8h.html#a5db3536793782f135785609e4a849fc6">CK_ATTRIBUTE_PTR</a></td>          <td class="paramname"><span class="paramname"><em>pPublicKeyTemplate</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pkcs11_8h.html#a35181858a3b7a0a81f49d180d8f446ef">CK_ULONG</a></td>          <td class="paramname"><span class="paramname"><em>ulPublicKeyAttributeCount</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pkcs11_8h.html#a5db3536793782f135785609e4a849fc6">CK_ATTRIBUTE_PTR</a></td>          <td class="paramname"><span class="paramname"><em>pPrivateKeyTemplate</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pkcs11_8h.html#a35181858a3b7a0a81f49d180d8f446ef">CK_ULONG</a></td>          <td class="paramname"><span class="paramname"><em>ulPrivateKeyAttributeCount</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structyubihsm__pkcs11__object__template.html">yubihsm_pkcs11_object_template</a> *</td>          <td class="paramname"><span class="paramname"><em>template</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="util__pkcs11_8c_source.html#l03570">3570</a> of file <a class="el" href="util__pkcs11_8c_source.html">util_pkcs11.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3574</span>                                                                           {</div>
<div class="line"><span class="lineno"> 3575</span> </div>
<div class="line"><span class="lineno"> 3576</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *ecparams = NULL;</div>
<div class="line"><span class="lineno"> 3577</span>  <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> ecparams_len = 0;</div>
<div class="line"><span class="lineno"> 3578</span>  <span class="keywordtype">bool</span> label_set = <a class="code hl_define" href="pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno"> 3579</span>  CK_RV <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a>;</div>
<div class="line"><span class="lineno"> 3580</span> </div>
<div class="line"><span class="lineno"> 3581</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105">memset</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a53ef06e29c840024a683512c1acd791a">template</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__object__template.html#a22edd3acceb711249d7593e73ad0d7f3">label</a>, 0, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a53ef06e29c840024a683512c1acd791a">template</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__object__template.html#a22edd3acceb711249d7593e73ad0d7f3">label</a>));</div>
<div class="line"><span class="lineno"> 3582</span> </div>
<div class="line"><span class="lineno"> 3583</span>  <span class="keywordflow">for</span> (<a class="code hl_typedef" href="pkcs11_8h.html#a35181858a3b7a0a81f49d180d8f446ef">CK_ULONG</a> i = 0; i &lt; <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa7504c440c5b75cdd4386b6d56c6116c">ulPublicKeyAttributeCount</a>; i++) {</div>
<div class="line"><span class="lineno"> 3584</span>    <span class="keywordflow">switch</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ade5d8be372cb742833a442592301a68b">pPublicKeyTemplate</a>[i].type) {</div>
<div class="line"><span class="lineno"> 3585</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#af867d3ae9286fe0f8cab4995bb6af337">CKA_CLASS</a>:</div>
<div class="line"><span class="lineno"> 3586</span>        <span class="keywordflow">if</span> (*((<a class="code hl_typedef" href="pkcs11_8h.html#a2c6426aaa1ca6dd1f48a01b8490482fa">CK_ULONG_PTR</a>) <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ade5d8be372cb742833a442592301a68b">pPublicKeyTemplate</a>[i].pValue) != <a class="code hl_define" href="pkcs11_8h.html#a105a73f3224e9745296afdf322c0d3d1">CKO_PUBLIC_KEY</a>) {</div>
<div class="line"><span class="lineno"> 3587</span>          <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;CKA_CLASS inconsistent in PublicKeyTemplate&quot;</span>);</div>
<div class="line"><span class="lineno"> 3588</span>          <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a98d78208707bfa2c51d6f051af1794e9">CKR_TEMPLATE_INCONSISTENT</a>;</div>
<div class="line"><span class="lineno"> 3589</span>        }</div>
<div class="line"><span class="lineno"> 3590</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3591</span> </div>
<div class="line"><span class="lineno"> 3592</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#aa438b88cbcb8a921288eeefba5613274">CKA_KEY_TYPE</a>:</div>
<div class="line"><span class="lineno"> 3593</span>        <span class="keywordflow">if</span> (*((<a class="code hl_typedef" href="pkcs11_8h.html#a2c6426aaa1ca6dd1f48a01b8490482fa">CK_ULONG_PTR</a>) <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ade5d8be372cb742833a442592301a68b">pPublicKeyTemplate</a>[i].pValue) != <a class="code hl_define" href="pkcs11_8h.html#ae95493c017b9901d9d1c96354119eadb">CKK_EC</a>) {</div>
<div class="line"><span class="lineno"> 3594</span>          <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;CKA_KEY_TYPE inconsistent in PublicKeyTemplate&quot;</span>);</div>
<div class="line"><span class="lineno"> 3595</span>          <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a98d78208707bfa2c51d6f051af1794e9">CKR_TEMPLATE_INCONSISTENT</a>;</div>
<div class="line"><span class="lineno"> 3596</span>        }</div>
<div class="line"><span class="lineno"> 3597</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3598</span> </div>
<div class="line"><span class="lineno"> 3599</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a2846a5a41835defa47716ccc3bcc4913">CKA_ID</a>:</div>
<div class="line"><span class="lineno"> 3600</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a53ef06e29c840024a683512c1acd791a">template</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__object__template.html#ad1b0e5ec887cae21e37a4b852a66727a">id</a> == 0) {</div>
<div class="line"><span class="lineno"> 3601</span>          <span class="keywordtype">int</span> <span class="keywordtype">id</span> = <a class="code hl_function" href="util__pkcs11_8c.html#a66eb3d4688d7e1358a14b6c86b2158f9">parse_id_value</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ade5d8be372cb742833a442592301a68b">pPublicKeyTemplate</a>[i].pValue,</div>
<div class="line"><span class="lineno"> 3602</span>                                  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ade5d8be372cb742833a442592301a68b">pPublicKeyTemplate</a>[i].ulValueLen);</div>
<div class="line"><span class="lineno"> 3603</span>          <span class="keywordflow">if</span> (<span class="keywordtype">id</span> == -1) {</div>
<div class="line"><span class="lineno"> 3604</span>            <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;CKA_ID invalid in PublicKeyTemplate&quot;</span>);</div>
<div class="line"><span class="lineno"> 3605</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#ab818f05c56d56675438515a7ba5ebb70">CKR_ATTRIBUTE_VALUE_INVALID</a>;</div>
<div class="line"><span class="lineno"> 3606</span>          }</div>
<div class="line"><span class="lineno"> 3607</span>          <span class="keyword">template</span>-&gt;id = <a class="code hl_variable" href="code__cache_8cpp.html#aa0efefe21f4700d78692edc823e763be">id</a>;</div>
<div class="line"><span class="lineno"> 3608</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3609</span>          <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;CKA_ID inconsistent in PublicKeyTemplate&quot;</span>);</div>
<div class="line"><span class="lineno"> 3610</span>          <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a98d78208707bfa2c51d6f051af1794e9">CKR_TEMPLATE_INCONSISTENT</a>;</div>
<div class="line"><span class="lineno"> 3611</span>        }</div>
<div class="line"><span class="lineno"> 3612</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3613</span> </div>
<div class="line"><span class="lineno"> 3614</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#af4e399d748bfe19cf956386179e0c3da">CKA_EC_PARAMS</a>:</div>
<div class="line"><span class="lineno"> 3615</span>        <span class="keywordflow">if</span> (ecparams == NULL) {</div>
<div class="line"><span class="lineno"> 3616</span>          ecparams = (<a class="code hl_typedef" href="pkcs11_8h.html#a7bc6919a7c3c372056fa7e18343a0b37">CK_BYTE_PTR</a>) <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ade5d8be372cb742833a442592301a68b">pPublicKeyTemplate</a>[i].pValue;</div>
<div class="line"><span class="lineno"> 3617</span>          ecparams_len = <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ade5d8be372cb742833a442592301a68b">pPublicKeyTemplate</a>[i].ulValueLen;</div>
<div class="line"><span class="lineno"> 3618</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3619</span>          <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;CKA_PUBLIC_EXPONENT inconsistent in PublicKeyTemplate&quot;</span>);</div>
<div class="line"><span class="lineno"> 3620</span>          <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a98d78208707bfa2c51d6f051af1794e9">CKR_TEMPLATE_INCONSISTENT</a>;</div>
<div class="line"><span class="lineno"> 3621</span>        }</div>
<div class="line"><span class="lineno"> 3622</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3623</span> </div>
<div class="line"><span class="lineno"> 3624</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#acf009a991c04b5c4305cc76356225aa7">CKA_LABEL</a>:</div>
<div class="line"><span class="lineno"> 3625</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ade5d8be372cb742833a442592301a68b">pPublicKeyTemplate</a>[i].ulValueLen &gt; <a class="code hl_define" href="yubihsm_8h.html#a431f8b753552a8b2f5f980e871b6d019">YH_OBJ_LABEL_LEN</a>) {</div>
<div class="line"><span class="lineno"> 3626</span>          <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;CKA_LABEL invalid in PublicKeyTemplate&quot;</span>);</div>
<div class="line"><span class="lineno"> 3627</span>          <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#ab818f05c56d56675438515a7ba5ebb70">CKR_ATTRIBUTE_VALUE_INVALID</a>;</div>
<div class="line"><span class="lineno"> 3628</span>        }</div>
<div class="line"><span class="lineno"> 3629</span> </div>
<div class="line"><span class="lineno"> 3630</span>        <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a53ef06e29c840024a683512c1acd791a">template</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__object__template.html#a22edd3acceb711249d7593e73ad0d7f3">label</a>, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ade5d8be372cb742833a442592301a68b">pPublicKeyTemplate</a>[i].pValue,</div>
<div class="line"><span class="lineno"> 3631</span>               <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ade5d8be372cb742833a442592301a68b">pPublicKeyTemplate</a>[i].ulValueLen);</div>
<div class="line"><span class="lineno"> 3632</span> </div>
<div class="line"><span class="lineno"> 3633</span>        label_set = <a class="code hl_define" href="pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno"> 3634</span> </div>
<div class="line"><span class="lineno"> 3635</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3636</span> </div>
<div class="line"><span class="lineno"> 3637</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a05c1c460160443a739c6e0ce47ae3fc8">CKA_TOKEN</a>:</div>
<div class="line"><span class="lineno"> 3638</span>        <span class="keywordflow">if</span> ((<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a> = check_bool_attribute(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ade5d8be372cb742833a442592301a68b">pPublicKeyTemplate</a>[i].pValue, <span class="keyword">true</span>)) !=</div>
<div class="line"><span class="lineno"> 3639</span>            <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>) {</div>
<div class="line"><span class="lineno"> 3640</span>          <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Boolean truth check failed for attribute 0x%lx&quot;</span>,</div>
<div class="line"><span class="lineno"> 3641</span>                  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ade5d8be372cb742833a442592301a68b">pPublicKeyTemplate</a>[i].type);</div>
<div class="line"><span class="lineno"> 3642</span>          <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a>;</div>
<div class="line"><span class="lineno"> 3643</span>        }</div>
<div class="line"><span class="lineno"> 3644</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3645</span> </div>
<div class="line"><span class="lineno"> 3646</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a39688e3f665848ca7868f2ca37aa1aed">CKA_MODIFIABLE</a>:</div>
<div class="line"><span class="lineno"> 3647</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#aa26224c75961163975e3de4347940401">CKA_DECRYPT</a>:</div>
<div class="line"><span class="lineno"> 3648</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a6ffd14ad7386d9aa7178e841a964a87e">CKA_SIGN</a>:</div>
<div class="line"><span class="lineno"> 3649</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#af7a34bb656aa7e2b7e813dab0a6ac7b7">CKA_WRAP</a>:</div>
<div class="line"><span class="lineno"> 3650</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a9a9a988131e4e93d0758e43c555bdc97">CKA_UNWRAP</a>:</div>
<div class="line"><span class="lineno"> 3651</span>        <span class="keywordflow">if</span> ((<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a> = check_bool_attribute(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ade5d8be372cb742833a442592301a68b">pPublicKeyTemplate</a>[i].pValue, <span class="keyword">false</span>)) !=</div>
<div class="line"><span class="lineno"> 3652</span>            <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>) {</div>
<div class="line"><span class="lineno"> 3653</span>          <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Boolean false check failed for attribute 0x%lx&quot;</span>,</div>
<div class="line"><span class="lineno"> 3654</span>                  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ade5d8be372cb742833a442592301a68b">pPublicKeyTemplate</a>[i].type);</div>
<div class="line"><span class="lineno"> 3655</span>          <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a>;</div>
<div class="line"><span class="lineno"> 3656</span>        }</div>
<div class="line"><span class="lineno"> 3657</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3658</span> </div>
<div class="line"><span class="lineno"> 3659</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a84c89cd9def639cb4a58145063b7bd42">CKA_VERIFY</a>:</div>
<div class="line"><span class="lineno"> 3660</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ad427016a08d7b8f0d8fe910b907e9b44">CKA_ENCRYPT</a>:</div>
<div class="line"><span class="lineno"> 3661</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a92925cbe2a1b3d50dd56f8af0f770a69">CKA_COPYABLE</a>:</div>
<div class="line"><span class="lineno"> 3662</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a5244a0b0719c79614044460bdcf34d11">CKA_PRIVATE</a>:</div>
<div class="line"><span class="lineno"> 3663</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#acf37955a2a229d208289962c6f1183b8">CKA_EXTRACTABLE</a>:</div>
<div class="line"><span class="lineno"> 3664</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ab65b14615d388fc862c82a8d1e163f84">CKA_DERIVE</a>:</div>
<div class="line"><span class="lineno"> 3665</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3666</span> </div>
<div class="line"><span class="lineno"> 3667</span>      <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 3668</span>        <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;invalid attribute type in PublicKeyTemplate: 0x%lx\n&quot;</span>,</div>
<div class="line"><span class="lineno"> 3669</span>                <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ade5d8be372cb742833a442592301a68b">pPublicKeyTemplate</a>[i].type);</div>
<div class="line"><span class="lineno"> 3670</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a0afbefc1a4ce05ba5faea1778eb602ca">CKR_ATTRIBUTE_TYPE_INVALID</a>;</div>
<div class="line"><span class="lineno"> 3671</span>    }</div>
<div class="line"><span class="lineno"> 3672</span>  }</div>
<div class="line"><span class="lineno"> 3673</span> </div>
<div class="line"><span class="lineno"> 3674</span>  <span class="keywordflow">for</span> (<a class="code hl_typedef" href="pkcs11_8h.html#a35181858a3b7a0a81f49d180d8f446ef">CK_ULONG</a> i = 0; i &lt; <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a062bc7ed451133876d988fb653844af4">ulPrivateKeyAttributeCount</a>; i++) {</div>
<div class="line"><span class="lineno"> 3675</span>    <span class="keywordflow">switch</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa0bd9585bb6c1f50e5c0c72da9d48cb9">pPrivateKeyTemplate</a>[i].type) {</div>
<div class="line"><span class="lineno"> 3676</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#af867d3ae9286fe0f8cab4995bb6af337">CKA_CLASS</a>:</div>
<div class="line"><span class="lineno"> 3677</span>        <span class="keywordflow">if</span> (*((<a class="code hl_typedef" href="pkcs11_8h.html#a2c6426aaa1ca6dd1f48a01b8490482fa">CK_ULONG_PTR</a>) <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa0bd9585bb6c1f50e5c0c72da9d48cb9">pPrivateKeyTemplate</a>[i].pValue) !=</div>
<div class="line"><span class="lineno"> 3678</span>            <a class="code hl_define" href="pkcs11_8h.html#a8aa610efb7f7dd562bce4576250753a8">CKO_PRIVATE_KEY</a>) {</div>
<div class="line"><span class="lineno"> 3679</span>          <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;CKA_CLASS inconsistent in PrivateKeyTemplate&quot;</span>);</div>
<div class="line"><span class="lineno"> 3680</span>          <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a98d78208707bfa2c51d6f051af1794e9">CKR_TEMPLATE_INCONSISTENT</a>;</div>
<div class="line"><span class="lineno"> 3681</span>        }</div>
<div class="line"><span class="lineno"> 3682</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3683</span> </div>
<div class="line"><span class="lineno"> 3684</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#aa438b88cbcb8a921288eeefba5613274">CKA_KEY_TYPE</a>:</div>
<div class="line"><span class="lineno"> 3685</span>        <span class="keywordflow">if</span> (*((<a class="code hl_typedef" href="pkcs11_8h.html#a2c6426aaa1ca6dd1f48a01b8490482fa">CK_ULONG_PTR</a>) <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa0bd9585bb6c1f50e5c0c72da9d48cb9">pPrivateKeyTemplate</a>[i].pValue) != <a class="code hl_define" href="pkcs11_8h.html#ae95493c017b9901d9d1c96354119eadb">CKK_EC</a>) {</div>
<div class="line"><span class="lineno"> 3686</span>          <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;CKA_KEY_TYPE inconsistent in PrivateKeyTemplate&quot;</span>);</div>
<div class="line"><span class="lineno"> 3687</span>          <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a98d78208707bfa2c51d6f051af1794e9">CKR_TEMPLATE_INCONSISTENT</a>;</div>
<div class="line"><span class="lineno"> 3688</span>        }</div>
<div class="line"><span class="lineno"> 3689</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3690</span> </div>
<div class="line"><span class="lineno"> 3691</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a2846a5a41835defa47716ccc3bcc4913">CKA_ID</a>: {</div>
<div class="line"><span class="lineno"> 3692</span>        <span class="keywordtype">int</span> <span class="keywordtype">id</span> = <a class="code hl_function" href="util__pkcs11_8c.html#a66eb3d4688d7e1358a14b6c86b2158f9">parse_id_value</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa0bd9585bb6c1f50e5c0c72da9d48cb9">pPrivateKeyTemplate</a>[i].pValue,</div>
<div class="line"><span class="lineno"> 3693</span>                                <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa0bd9585bb6c1f50e5c0c72da9d48cb9">pPrivateKeyTemplate</a>[i].ulValueLen);</div>
<div class="line"><span class="lineno"> 3694</span>        <span class="keywordflow">if</span> (<span class="keywordtype">id</span> == -1) {</div>
<div class="line"><span class="lineno"> 3695</span>          <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;CKA_ID invalid in PrivateKeyTemplate&quot;</span>);</div>
<div class="line"><span class="lineno"> 3696</span>          <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#ab818f05c56d56675438515a7ba5ebb70">CKR_ATTRIBUTE_VALUE_INVALID</a>;</div>
<div class="line"><span class="lineno"> 3697</span>        }</div>
<div class="line"><span class="lineno"> 3698</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a53ef06e29c840024a683512c1acd791a">template</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__object__template.html#ad1b0e5ec887cae21e37a4b852a66727a">id</a> != 0 &amp;&amp; <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a53ef06e29c840024a683512c1acd791a">template</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__object__template.html#ad1b0e5ec887cae21e37a4b852a66727a">id</a> != <span class="keywordtype">id</span>) {</div>
<div class="line"><span class="lineno"> 3699</span>          <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;CKA_ID inconsistent in PrivateKeyTemplate&quot;</span>);</div>
<div class="line"><span class="lineno"> 3700</span>          <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a98d78208707bfa2c51d6f051af1794e9">CKR_TEMPLATE_INCONSISTENT</a>;</div>
<div class="line"><span class="lineno"> 3701</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3702</span>          <span class="keyword">template</span>-&gt;id = <a class="code hl_variable" href="code__cache_8cpp.html#aa0efefe21f4700d78692edc823e763be">id</a>;</div>
<div class="line"><span class="lineno"> 3703</span>        }</div>
<div class="line"><span class="lineno"> 3704</span>      } <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3705</span> </div>
<div class="line"><span class="lineno"> 3706</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a6ffd14ad7386d9aa7178e841a964a87e">CKA_SIGN</a>:</div>
<div class="line"><span class="lineno"> 3707</span>        <span class="keywordflow">if</span> ((<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a> = <a class="code hl_function" href="util__pkcs11_8c.html#a03b553175220c8747145497de5032100">set_template_attribute</a>(&amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a53ef06e29c840024a683512c1acd791a">template</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__object__template.html#a10f570d27a0e5b375f3e5e32f09c2c84">sign</a>,</div>
<div class="line"><span class="lineno"> 3708</span>                                         <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa0bd9585bb6c1f50e5c0c72da9d48cb9">pPrivateKeyTemplate</a>[i].pValue)) !=</div>
<div class="line"><span class="lineno"> 3709</span>            <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>) {</div>
<div class="line"><span class="lineno"> 3710</span>          <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;CKA_SIGN inconsistent in PrivateKeyTemplate&quot;</span>);</div>
<div class="line"><span class="lineno"> 3711</span>          <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a>;</div>
<div class="line"><span class="lineno"> 3712</span>        }</div>
<div class="line"><span class="lineno"> 3713</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3714</span> </div>
<div class="line"><span class="lineno"> 3715</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#acf37955a2a229d208289962c6f1183b8">CKA_EXTRACTABLE</a>:</div>
<div class="line"><span class="lineno"> 3716</span>        <span class="keywordflow">if</span> ((<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a> = <a class="code hl_function" href="util__pkcs11_8c.html#a03b553175220c8747145497de5032100">set_template_attribute</a>(&amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a53ef06e29c840024a683512c1acd791a">template</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__object__template.html#a30a6882cb36864acc3e27baaf38ff0f1">exportable</a>,</div>
<div class="line"><span class="lineno"> 3717</span>                                         <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa0bd9585bb6c1f50e5c0c72da9d48cb9">pPrivateKeyTemplate</a>[i].pValue)) !=</div>
<div class="line"><span class="lineno"> 3718</span>            <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>) {</div>
<div class="line"><span class="lineno"> 3719</span>          <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;CKA_EXTRACTABLE inconsistent in PrivateKeyTemplate&quot;</span>);</div>
<div class="line"><span class="lineno"> 3720</span>          <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a>;</div>
<div class="line"><span class="lineno"> 3721</span>        }</div>
<div class="line"><span class="lineno"> 3722</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3723</span> </div>
<div class="line"><span class="lineno"> 3724</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ab65b14615d388fc862c82a8d1e163f84">CKA_DERIVE</a>:</div>
<div class="line"><span class="lineno"> 3725</span>        <span class="keywordflow">if</span> ((<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a> = <a class="code hl_function" href="util__pkcs11_8c.html#a03b553175220c8747145497de5032100">set_template_attribute</a>(&amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a53ef06e29c840024a683512c1acd791a">template</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__object__template.html#a42d6ff195518eae194d4ca0abd64301f">derive</a>,</div>
<div class="line"><span class="lineno"> 3726</span>                                         <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa0bd9585bb6c1f50e5c0c72da9d48cb9">pPrivateKeyTemplate</a>[i].pValue)) !=</div>
<div class="line"><span class="lineno"> 3727</span>            <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>) {</div>
<div class="line"><span class="lineno"> 3728</span>          <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;CKA_DERIVE inconsistent in PrivateKeyTemplate&quot;</span>);</div>
<div class="line"><span class="lineno"> 3729</span>          <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a>;</div>
<div class="line"><span class="lineno"> 3730</span>        }</div>
<div class="line"><span class="lineno"> 3731</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3732</span> </div>
<div class="line"><span class="lineno"> 3733</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#acf009a991c04b5c4305cc76356225aa7">CKA_LABEL</a>:</div>
<div class="line"><span class="lineno"> 3734</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa0bd9585bb6c1f50e5c0c72da9d48cb9">pPrivateKeyTemplate</a>[i].ulValueLen &gt; <a class="code hl_define" href="yubihsm_8h.html#a431f8b753552a8b2f5f980e871b6d019">YH_OBJ_LABEL_LEN</a>) {</div>
<div class="line"><span class="lineno"> 3735</span>          <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;CKA_LABEL invalid in PrivateKeyTemplate&quot;</span>);</div>
<div class="line"><span class="lineno"> 3736</span>          <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#ab818f05c56d56675438515a7ba5ebb70">CKR_ATTRIBUTE_VALUE_INVALID</a>;</div>
<div class="line"><span class="lineno"> 3737</span>        }</div>
<div class="line"><span class="lineno"> 3738</span> </div>
<div class="line"><span class="lineno"> 3739</span>        <span class="keywordflow">if</span> (label_set == <a class="code hl_define" href="pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>) {</div>
<div class="line"><span class="lineno"> 3740</span>          <span class="keywordflow">if</span> (memcmp(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a53ef06e29c840024a683512c1acd791a">template</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__object__template.html#a22edd3acceb711249d7593e73ad0d7f3">label</a>, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa0bd9585bb6c1f50e5c0c72da9d48cb9">pPrivateKeyTemplate</a>[i].pValue,</div>
<div class="line"><span class="lineno"> 3741</span>                     <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa0bd9585bb6c1f50e5c0c72da9d48cb9">pPrivateKeyTemplate</a>[i].ulValueLen) != 0) {</div>
<div class="line"><span class="lineno"> 3742</span>            <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;CKA_LABEL inconsistent in PrivateKeyTemplate&quot;</span>);</div>
<div class="line"><span class="lineno"> 3743</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a98d78208707bfa2c51d6f051af1794e9">CKR_TEMPLATE_INCONSISTENT</a>;</div>
<div class="line"><span class="lineno"> 3744</span>          }</div>
<div class="line"><span class="lineno"> 3745</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3746</span>          <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a53ef06e29c840024a683512c1acd791a">template</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__object__template.html#a22edd3acceb711249d7593e73ad0d7f3">label</a>, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa0bd9585bb6c1f50e5c0c72da9d48cb9">pPrivateKeyTemplate</a>[i].pValue,</div>
<div class="line"><span class="lineno"> 3747</span>                 <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa0bd9585bb6c1f50e5c0c72da9d48cb9">pPrivateKeyTemplate</a>[i].ulValueLen);</div>
<div class="line"><span class="lineno"> 3748</span>        }</div>
<div class="line"><span class="lineno"> 3749</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3750</span> </div>
<div class="line"><span class="lineno"> 3751</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a05c1c460160443a739c6e0ce47ae3fc8">CKA_TOKEN</a>:</div>
<div class="line"><span class="lineno"> 3752</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a5fe5fb4a38ca6781c50e4cba8a2af0d6">CKA_SENSITIVE</a>:</div>
<div class="line"><span class="lineno"> 3753</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a5244a0b0719c79614044460bdcf34d11">CKA_PRIVATE</a>:</div>
<div class="line"><span class="lineno"> 3754</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ab495c20657f01d79e1a6ca49d2c8472e">CKA_DESTROYABLE</a>:</div>
<div class="line"><span class="lineno"> 3755</span>        <span class="keywordflow">if</span> ((<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a> = check_bool_attribute(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa0bd9585bb6c1f50e5c0c72da9d48cb9">pPrivateKeyTemplate</a>[i].pValue, <span class="keyword">true</span>)) !=</div>
<div class="line"><span class="lineno"> 3756</span>            <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>) {</div>
<div class="line"><span class="lineno"> 3757</span>          <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Boolean truth check failed for attribute 0x%lx&quot;</span>,</div>
<div class="line"><span class="lineno"> 3758</span>                  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa0bd9585bb6c1f50e5c0c72da9d48cb9">pPrivateKeyTemplate</a>[i].type);</div>
<div class="line"><span class="lineno"> 3759</span>          <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a>;</div>
<div class="line"><span class="lineno"> 3760</span>        }</div>
<div class="line"><span class="lineno"> 3761</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3762</span> </div>
<div class="line"><span class="lineno"> 3763</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a9a9a988131e4e93d0758e43c555bdc97">CKA_UNWRAP</a>:</div>
<div class="line"><span class="lineno"> 3764</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#af7a34bb656aa7e2b7e813dab0a6ac7b7">CKA_WRAP</a>:</div>
<div class="line"><span class="lineno"> 3765</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a39688e3f665848ca7868f2ca37aa1aed">CKA_MODIFIABLE</a>:</div>
<div class="line"><span class="lineno"> 3766</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a92925cbe2a1b3d50dd56f8af0f770a69">CKA_COPYABLE</a>:</div>
<div class="line"><span class="lineno"> 3767</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ad427016a08d7b8f0d8fe910b907e9b44">CKA_ENCRYPT</a>:</div>
<div class="line"><span class="lineno"> 3768</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a84c89cd9def639cb4a58145063b7bd42">CKA_VERIFY</a>:</div>
<div class="line"><span class="lineno"> 3769</span>        <span class="keywordflow">if</span> ((<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a> = check_bool_attribute(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa0bd9585bb6c1f50e5c0c72da9d48cb9">pPrivateKeyTemplate</a>[i].pValue, <span class="keyword">false</span>)) !=</div>
<div class="line"><span class="lineno"> 3770</span>            <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>) {</div>
<div class="line"><span class="lineno"> 3771</span>          <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Boolean false check failed for attribute 0x%lx&quot;</span>,</div>
<div class="line"><span class="lineno"> 3772</span>                  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa0bd9585bb6c1f50e5c0c72da9d48cb9">pPrivateKeyTemplate</a>[i].type);</div>
<div class="line"><span class="lineno"> 3773</span>          <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a>;</div>
<div class="line"><span class="lineno"> 3774</span>        }</div>
<div class="line"><span class="lineno"> 3775</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3776</span> </div>
<div class="line"><span class="lineno"> 3777</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#afef7cb3cf999a4ea9962e780c3e6e1cf">CKA_SUBJECT</a>:</div>
<div class="line"><span class="lineno"> 3778</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#aa26224c75961163975e3de4347940401">CKA_DECRYPT</a>:</div>
<div class="line"><span class="lineno"> 3779</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3780</span> </div>
<div class="line"><span class="lineno"> 3781</span>      <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 3782</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a0afbefc1a4ce05ba5faea1778eb602ca">CKR_ATTRIBUTE_TYPE_INVALID</a>;</div>
<div class="line"><span class="lineno"> 3783</span>    }</div>
<div class="line"><span class="lineno"> 3784</span>  }</div>
<div class="line"><span class="lineno"> 3785</span> </div>
<div class="line"><span class="lineno"> 3786</span>  <span class="keywordflow">if</span> (ecparams == NULL) {</div>
<div class="line"><span class="lineno"> 3787</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;CKA_ECPARAMS not set&quot;</span>);</div>
<div class="line"><span class="lineno"> 3788</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#acfcd3a766f4ce45e10b89243cfe9f07e">CKR_TEMPLATE_INCOMPLETE</a>;</div>
<div class="line"><span class="lineno"> 3789</span>  }</div>
<div class="line"><span class="lineno"> 3790</span> </div>
<div class="line"><span class="lineno"> 3791</span>  <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a8b142e2a51f6b9b8760f9132119673b6">key_len</a>;</div>
<div class="line"><span class="lineno"> 3792</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a> = parse_ecparams(ecparams, ecparams_len, &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a53ef06e29c840024a683512c1acd791a">template</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__object__template.html#ad180a15b1f1a790679f9e5af6716b191">algorithm</a>, &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a8b142e2a51f6b9b8760f9132119673b6">key_len</a>);</div>
<div class="line"><span class="lineno"> 3793</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a> != <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>) {</div>
<div class="line"><span class="lineno"> 3794</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Failed to parse CKA_ECPARAMS&quot;</span>);</div>
<div class="line"><span class="lineno"> 3795</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a>;</div>
<div class="line"><span class="lineno"> 3796</span>  }</div>
<div class="line"><span class="lineno"> 3797</span> </div>
<div class="line"><span class="lineno"> 3798</span>  <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>;</div>
<div class="line"><span class="lineno"> 3799</span>}</div>
<div class="ttc" id="acode__cache_8cpp_html_aa0efefe21f4700d78692edc823e763be"><div class="ttname"><a href="code__cache_8cpp.html#aa0efefe21f4700d78692edc823e763be">id</a></div><div class="ttdeci">uint64_t id</div><div class="ttdef"><b>Definition</b> <a href="code__cache_8cpp_source.html#l00000">code_cache.cpp:0</a></div></div>
<div class="ttc" id="apkcs11_8h_html_a105a73f3224e9745296afdf322c0d3d1"><div class="ttname"><a href="pkcs11_8h.html#a105a73f3224e9745296afdf322c0d3d1">CKO_PUBLIC_KEY</a></div><div class="ttdeci">#define CKO_PUBLIC_KEY</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00302">pkcs11.h:302</a></div></div>
<div class="ttc" id="apkcs11_8h_html_a2c6426aaa1ca6dd1f48a01b8490482fa"><div class="ttname"><a href="pkcs11_8h.html#a2c6426aaa1ca6dd1f48a01b8490482fa">CK_ULONG_PTR</a></div><div class="ttdeci">CK_ULONG * CK_ULONG_PTR</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l01199">pkcs11.h:1199</a></div></div>
<div class="ttc" id="apkcs11_8h_html_a5244a0b0719c79614044460bdcf34d11"><div class="ttname"><a href="pkcs11_8h.html#a5244a0b0719c79614044460bdcf34d11">CKA_PRIVATE</a></div><div class="ttdeci">#define CKA_PRIVATE</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00365">pkcs11.h:365</a></div></div>
<div class="ttc" id="apkcs11_8h_html_a7bc6919a7c3c372056fa7e18343a0b37"><div class="ttname"><a href="pkcs11_8h.html#a7bc6919a7c3c372056fa7e18343a0b37">CK_BYTE_PTR</a></div><div class="ttdeci">CK_BYTE * CK_BYTE_PTR</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l01196">pkcs11.h:1196</a></div></div>
<div class="ttc" id="apkcs11_8h_html_a8aa610efb7f7dd562bce4576250753a8"><div class="ttname"><a href="pkcs11_8h.html#a8aa610efb7f7dd562bce4576250753a8">CKO_PRIVATE_KEY</a></div><div class="ttdeci">#define CKO_PRIVATE_KEY</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00303">pkcs11.h:303</a></div></div>
<div class="ttc" id="apkcs11_8h_html_a98d78208707bfa2c51d6f051af1794e9"><div class="ttname"><a href="pkcs11_8h.html#a98d78208707bfa2c51d6f051af1794e9">CKR_TEMPLATE_INCONSISTENT</a></div><div class="ttdeci">#define CKR_TEMPLATE_INCONSISTENT</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l01147">pkcs11.h:1147</a></div></div>
<div class="ttc" id="apkcs11_8h_html_aa26224c75961163975e3de4347940401"><div class="ttname"><a href="pkcs11_8h.html#aa26224c75961163975e3de4347940401">CKA_DECRYPT</a></div><div class="ttdeci">#define CKA_DECRYPT</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00388">pkcs11.h:388</a></div></div>
<div class="ttc" id="apkcs11_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l01209">pkcs11.h:1209</a></div></div>
<div class="ttc" id="apkcs11_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l01206">pkcs11.h:1206</a></div></div>
<div class="ttc" id="apkcs11_8h_html_ab818f05c56d56675438515a7ba5ebb70"><div class="ttname"><a href="pkcs11_8h.html#ab818f05c56d56675438515a7ba5ebb70">CKR_ATTRIBUTE_VALUE_INVALID</a></div><div class="ttdeci">#define CKR_ATTRIBUTE_VALUE_INVALID</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l01105">pkcs11.h:1105</a></div></div>
<div class="ttc" id="apkcs11_8h_html_acfcd3a766f4ce45e10b89243cfe9f07e"><div class="ttname"><a href="pkcs11_8h.html#acfcd3a766f4ce45e10b89243cfe9f07e">CKR_TEMPLATE_INCOMPLETE</a></div><div class="ttdeci">#define CKR_TEMPLATE_INCOMPLETE</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l01146">pkcs11.h:1146</a></div></div>
<div class="ttc" id="apkcs11_8h_html_ae95493c017b9901d9d1c96354119eadb"><div class="ttname"><a href="pkcs11_8h.html#ae95493c017b9901d9d1c96354119eadb">CKK_EC</a></div><div class="ttdeci">#define CKK_EC</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00323">pkcs11.h:323</a></div></div>
<div class="ttc" id="apkcs11_8h_html_af4e399d748bfe19cf956386179e0c3da"><div class="ttname"><a href="pkcs11_8h.html#af4e399d748bfe19cf956386179e0c3da">CKA_EC_PARAMS</a></div><div class="ttdeci">#define CKA_EC_PARAMS</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00424">pkcs11.h:424</a></div></div>
<div class="ttc" id="apkcs11_8h_html_afef7cb3cf999a4ea9962e780c3e6e1cf"><div class="ttname"><a href="pkcs11_8h.html#afef7cb3cf999a4ea9962e780c3e6e1cf">CKA_SUBJECT</a></div><div class="ttdeci">#define CKA_SUBJECT</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00384">pkcs11.h:384</a></div></div>
<div class="ttc" id="astructyubihsm__pkcs11__object__template_html_a10f570d27a0e5b375f3e5e32f09c2c84"><div class="ttname"><a href="structyubihsm__pkcs11__object__template.html#a10f570d27a0e5b375f3e5e32f09c2c84">yubihsm_pkcs11_object_template::sign</a></div><div class="ttdeci">yubihsm_pkcs11_attribute sign</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8h_source.html#l00181">yubihsm_pkcs11.h:181</a></div></div>
<div class="ttc" id="astructyubihsm__pkcs11__object__template_html_a22edd3acceb711249d7593e73ad0d7f3"><div class="ttname"><a href="structyubihsm__pkcs11__object__template.html#a22edd3acceb711249d7593e73ad0d7f3">yubihsm_pkcs11_object_template::label</a></div><div class="ttdeci">char label[YH_OBJ_LABEL_LEN+1]</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8h_source.html#l00180">yubihsm_pkcs11.h:180</a></div></div>
<div class="ttc" id="astructyubihsm__pkcs11__object__template_html_a30a6882cb36864acc3e27baaf38ff0f1"><div class="ttname"><a href="structyubihsm__pkcs11__object__template.html#a30a6882cb36864acc3e27baaf38ff0f1">yubihsm_pkcs11_object_template::exportable</a></div><div class="ttdeci">yubihsm_pkcs11_attribute exportable</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8h_source.html#l00185">yubihsm_pkcs11.h:185</a></div></div>
<div class="ttc" id="astructyubihsm__pkcs11__object__template_html_a42d6ff195518eae194d4ca0abd64301f"><div class="ttname"><a href="structyubihsm__pkcs11__object__template.html#a42d6ff195518eae194d4ca0abd64301f">yubihsm_pkcs11_object_template::derive</a></div><div class="ttdeci">yubihsm_pkcs11_attribute derive</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8h_source.html#l00184">yubihsm_pkcs11.h:184</a></div></div>
<div class="ttc" id="astructyubihsm__pkcs11__object__template_html_ad180a15b1f1a790679f9e5af6716b191"><div class="ttname"><a href="structyubihsm__pkcs11__object__template.html#ad180a15b1f1a790679f9e5af6716b191">yubihsm_pkcs11_object_template::algorithm</a></div><div class="ttdeci">yh_algorithm algorithm</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8h_source.html#l00178">yubihsm_pkcs11.h:178</a></div></div>
<div class="ttc" id="astructyubihsm__pkcs11__object__template_html_ad1b0e5ec887cae21e37a4b852a66727a"><div class="ttname"><a href="structyubihsm__pkcs11__object__template.html#ad1b0e5ec887cae21e37a4b852a66727a">yubihsm_pkcs11_object_template::id</a></div><div class="ttdeci">uint16_t id</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8h_source.html#l00179">yubihsm_pkcs11.h:179</a></div></div>
<div class="ttc" id="autil__pkcs11_8c_html_a03b553175220c8747145497de5032100"><div class="ttname"><a href="util__pkcs11_8c.html#a03b553175220c8747145497de5032100">set_template_attribute</a></div><div class="ttdeci">CK_RV set_template_attribute(yubihsm_pkcs11_attribute *attribute, void *value)</div><div class="ttdef"><b>Definition</b> <a href="util__pkcs11_8c_source.html#l02953">util_pkcs11.c:2953</a></div></div>
<div class="ttc" id="autil__pkcs11_8c_html_a66eb3d4688d7e1358a14b6c86b2158f9"><div class="ttname"><a href="util__pkcs11_8c.html#a66eb3d4688d7e1358a14b6c86b2158f9">parse_id_value</a></div><div class="ttdeci">int parse_id_value(void *value, CK_ULONG len)</div><div class="ttdef"><b>Definition</b> <a href="util__pkcs11_8c_source.html#l03556">util_pkcs11.c:3556</a></div></div>
<div class="ttc" id="ayubihsm_8h_html_a431f8b753552a8b2f5f980e871b6d019"><div class="ttname"><a href="yubihsm_8h.html#a431f8b753552a8b2f5f980e871b6d019">YH_OBJ_LABEL_LEN</a></div><div class="ttdeci">#define YH_OBJ_LABEL_LEN</div><div class="ttdoc">Max length of object labels.</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8h_source.html#l00123">yubihsm.h:123</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a062bc7ed451133876d988fb653844af4"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a062bc7ed451133876d988fb653844af4">ulPrivateKeyAttributeCount</a></div><div class="ttdeci">CK_SESSION_HANDLE CK_MECHANISM_PTR CK_ATTRIBUTE_PTR CK_ULONG CK_ATTRIBUTE_PTR CK_ULONG ulPrivateKeyAttributeCount</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l04538">yubihsm_pkcs11.c:4538</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a53ef06e29c840024a683512c1acd791a"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a53ef06e29c840024a683512c1acd791a">template</a></div><div class="ttdeci">yubihsm_pkcs11_object_template template</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l01242">yubihsm_pkcs11.c:1242</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a8b142e2a51f6b9b8760f9132119673b6"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a8b142e2a51f6b9b8760f9132119673b6">key_len</a></div><div class="ttdeci">session operation op sign key_len</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l03475">yubihsm_pkcs11.c:3475</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_aa0bd9585bb6c1f50e5c0c72da9d48cb9"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#aa0bd9585bb6c1f50e5c0c72da9d48cb9">pPrivateKeyTemplate</a></div><div class="ttdeci">CK_SESSION_HANDLE CK_MECHANISM_PTR CK_ATTRIBUTE_PTR CK_ULONG CK_ATTRIBUTE_PTR pPrivateKeyTemplate</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l04538">yubihsm_pkcs11.c:4538</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_aa7504c440c5b75cdd4386b6d56c6116c"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#aa7504c440c5b75cdd4386b6d56c6116c">ulPublicKeyAttributeCount</a></div><div class="ttdeci">CK_SESSION_HANDLE CK_MECHANISM_PTR CK_ATTRIBUTE_PTR CK_ULONG ulPublicKeyAttributeCount</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l04537">yubihsm_pkcs11.c:4537</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_ade5d8be372cb742833a442592301a68b"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#ade5d8be372cb742833a442592301a68b">pPublicKeyTemplate</a></div><div class="ttdeci">CK_SESSION_HANDLE CK_MECHANISM_PTR CK_ATTRIBUTE_PTR pPublicKeyTemplate</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l04537">yubihsm_pkcs11.c:4537</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util__pkcs11_8h_a2413ad4604ce34308256962fb1098ec7_cgraph.png" border="0" usemap="#autil__pkcs11_8h_a2413ad4604ce34308256962fb1098ec7_cgraph" alt=""/></div>
<map name="autil__pkcs11_8h_a2413ad4604ce34308256962fb1098ec7_cgraph" id="autil__pkcs11_8h_a2413ad4604ce34308256962fb1098ec7_cgraph">
<area shape="rect" title=" " alt="" coords="5,80,194,106"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="281,5,352,31"/>
<area shape="poly" title=" " alt="" coords="136,77,241,40,266,31,267,36,243,45,138,82"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="283,55,351,80"/>
<area shape="poly" title=" " alt="" coords="193,79,267,71,268,76,194,85"/>
<area shape="rect" href="util__pkcs11_8c.html#a66eb3d4688d7e1358a14b6c86b2158f9" title=" " alt="" coords="263,104,371,130"/>
<area shape="poly" title=" " alt="" coords="194,101,247,107,247,112,193,106"/>
<area shape="rect" href="util__pkcs11_8c.html#a03b553175220c8747145497de5032100" title=" " alt="" coords="242,153,392,179"/>
<area shape="poly" title=" " alt="" coords="139,104,243,140,260,145,258,151,241,145,138,109"/>
</map>
</div>

</div>
</div>
<a id="a67949ebcead5efdd41af1683033d525e" name="a67949ebcead5efdd41af1683033d525e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67949ebcead5efdd41af1683033d525e">&#9670;&#160;</a></span>parse_ec_template()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CK_RV parse_ec_template </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="pkcs11_8h.html#a5db3536793782f135785609e4a849fc6">CK_ATTRIBUTE_PTR</a></td>          <td class="paramname"><span class="paramname"><em>pTemplate</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pkcs11_8h.html#a35181858a3b7a0a81f49d180d8f446ef">CK_ULONG</a></td>          <td class="paramname"><span class="paramname"><em>ulCount</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structyubihsm__pkcs11__object__template.html">yubihsm_pkcs11_object_template</a> *</td>          <td class="paramname"><span class="paramname"><em>template</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="util__pkcs11_8c_source.html#l03150">3150</a> of file <a class="el" href="util__pkcs11_8c_source.html">util_pkcs11.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3151</span>                                                                  {</div>
<div class="line"><span class="lineno"> 3152</span> </div>
<div class="line"><span class="lineno"> 3153</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *ecparams = NULL;</div>
<div class="line"><span class="lineno"> 3154</span>  <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> ecparams_len;</div>
<div class="line"><span class="lineno"> 3155</span>  CK_RV <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a>;</div>
<div class="line"><span class="lineno"> 3156</span> </div>
<div class="line"><span class="lineno"> 3157</span>  <span class="keywordflow">for</span> (<a class="code hl_typedef" href="pkcs11_8h.html#a35181858a3b7a0a81f49d180d8f446ef">CK_ULONG</a> i = 0; i &lt; <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a490d37150a3d116225298faf1cb780b6">ulCount</a>; i++) {</div>
<div class="line"><span class="lineno"> 3158</span>    <span class="keywordflow">switch</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa4c2296db6853afc30383aec1a404972">pTemplate</a>[i].type) {</div>
<div class="line"><span class="lineno"> 3159</span> </div>
<div class="line"><span class="lineno"> 3160</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a799f3b28e5c856ef4229d12257818841">CKA_VALUE</a>:</div>
<div class="line"><span class="lineno"> 3161</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a53ef06e29c840024a683512c1acd791a">template</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__object__template.html#aa7e23493c41030819bd65ab687c604a7">obj</a>.<a class="code hl_variable" href="structyubihsm__pkcs11__object__template.html#acbc6f8ad9110ca09d862eaf06691897b">buf</a> == NULL) {</div>
<div class="line"><span class="lineno"> 3162</span>          <span class="keyword">template</span>-&gt;obj.buf = (<a class="code hl_typedef" href="pkcs11_8h.html#a7bc6919a7c3c372056fa7e18343a0b37">CK_BYTE_PTR</a>) <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa4c2296db6853afc30383aec1a404972">pTemplate</a>[i].pValue;</div>
<div class="line"><span class="lineno"> 3163</span>          <span class="keyword">template</span>-&gt;objlen = <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa4c2296db6853afc30383aec1a404972">pTemplate</a>[i].ulValueLen;</div>
<div class="line"><span class="lineno"> 3164</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3165</span>          <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a98d78208707bfa2c51d6f051af1794e9">CKR_TEMPLATE_INCONSISTENT</a>;</div>
<div class="line"><span class="lineno"> 3166</span>        }</div>
<div class="line"><span class="lineno"> 3167</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3168</span> </div>
<div class="line"><span class="lineno"> 3169</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#af4e399d748bfe19cf956386179e0c3da">CKA_EC_PARAMS</a>:</div>
<div class="line"><span class="lineno"> 3170</span>        <span class="keywordflow">if</span> (ecparams == NULL) {</div>
<div class="line"><span class="lineno"> 3171</span>          ecparams = (<a class="code hl_typedef" href="pkcs11_8h.html#a7bc6919a7c3c372056fa7e18343a0b37">CK_BYTE_PTR</a>) <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa4c2296db6853afc30383aec1a404972">pTemplate</a>[i].pValue;</div>
<div class="line"><span class="lineno"> 3172</span>          ecparams_len = <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa4c2296db6853afc30383aec1a404972">pTemplate</a>[i].ulValueLen;</div>
<div class="line"><span class="lineno"> 3173</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3174</span>          <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a98d78208707bfa2c51d6f051af1794e9">CKR_TEMPLATE_INCONSISTENT</a>;</div>
<div class="line"><span class="lineno"> 3175</span>        }</div>
<div class="line"><span class="lineno"> 3176</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3177</span> </div>
<div class="line"><span class="lineno"> 3178</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a6ffd14ad7386d9aa7178e841a964a87e">CKA_SIGN</a>:</div>
<div class="line"><span class="lineno"> 3179</span>        <span class="keywordflow">if</span> ((<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a> = <a class="code hl_function" href="util__pkcs11_8c.html#a03b553175220c8747145497de5032100">set_template_attribute</a>(&amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a53ef06e29c840024a683512c1acd791a">template</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__object__template.html#a10f570d27a0e5b375f3e5e32f09c2c84">sign</a>,</div>
<div class="line"><span class="lineno"> 3180</span>                                         <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa4c2296db6853afc30383aec1a404972">pTemplate</a>[i].pValue)) != <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>) {</div>
<div class="line"><span class="lineno"> 3181</span>          <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a>;</div>
<div class="line"><span class="lineno"> 3182</span>        }</div>
<div class="line"><span class="lineno"> 3183</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3184</span> </div>
<div class="line"><span class="lineno"> 3185</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ab65b14615d388fc862c82a8d1e163f84">CKA_DERIVE</a>:</div>
<div class="line"><span class="lineno"> 3186</span>        <span class="keywordflow">if</span> ((<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a> = <a class="code hl_function" href="util__pkcs11_8c.html#a03b553175220c8747145497de5032100">set_template_attribute</a>(&amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a53ef06e29c840024a683512c1acd791a">template</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__object__template.html#a42d6ff195518eae194d4ca0abd64301f">derive</a>,</div>
<div class="line"><span class="lineno"> 3187</span>                                         <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa4c2296db6853afc30383aec1a404972">pTemplate</a>[i].pValue)) != <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>) {</div>
<div class="line"><span class="lineno"> 3188</span>          <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a>;</div>
<div class="line"><span class="lineno"> 3189</span>        }</div>
<div class="line"><span class="lineno"> 3190</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3191</span> </div>
<div class="line"><span class="lineno"> 3192</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a05c1c460160443a739c6e0ce47ae3fc8">CKA_TOKEN</a>:</div>
<div class="line"><span class="lineno"> 3193</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a5244a0b0719c79614044460bdcf34d11">CKA_PRIVATE</a>:</div>
<div class="line"><span class="lineno"> 3194</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a5fe5fb4a38ca6781c50e4cba8a2af0d6">CKA_SENSITIVE</a>:</div>
<div class="line"><span class="lineno"> 3195</span>        <span class="keywordflow">if</span> ((<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a> = check_bool_attribute(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa4c2296db6853afc30383aec1a404972">pTemplate</a>[i].pValue, <span class="keyword">true</span>)) != <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>) {</div>
<div class="line"><span class="lineno"> 3196</span>          <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a>;</div>
<div class="line"><span class="lineno"> 3197</span>        }</div>
<div class="line"><span class="lineno"> 3198</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3199</span> </div>
<div class="line"><span class="lineno"> 3200</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#af867d3ae9286fe0f8cab4995bb6af337">CKA_CLASS</a>:</div>
<div class="line"><span class="lineno"> 3201</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#aa438b88cbcb8a921288eeefba5613274">CKA_KEY_TYPE</a>:</div>
<div class="line"><span class="lineno"> 3202</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#afef7cb3cf999a4ea9962e780c3e6e1cf">CKA_SUBJECT</a>:</div>
<div class="line"><span class="lineno"> 3203</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a2846a5a41835defa47716ccc3bcc4913">CKA_ID</a>:</div>
<div class="line"><span class="lineno"> 3204</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#acf009a991c04b5c4305cc76356225aa7">CKA_LABEL</a>:</div>
<div class="line"><span class="lineno"> 3205</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#acf37955a2a229d208289962c6f1183b8">CKA_EXTRACTABLE</a>:</div>
<div class="line"><span class="lineno"> 3206</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3207</span> </div>
<div class="line"><span class="lineno"> 3208</span>      <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 3209</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a0afbefc1a4ce05ba5faea1778eb602ca">CKR_ATTRIBUTE_TYPE_INVALID</a>;</div>
<div class="line"><span class="lineno"> 3210</span>    }</div>
<div class="line"><span class="lineno"> 3211</span>  }</div>
<div class="line"><span class="lineno"> 3212</span>  <span class="keywordflow">if</span> (ecparams &amp;&amp; <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a53ef06e29c840024a683512c1acd791a">template</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__object__template.html#aa7e23493c41030819bd65ab687c604a7">obj</a>.<a class="code hl_variable" href="structyubihsm__pkcs11__object__template.html#acbc6f8ad9110ca09d862eaf06691897b">buf</a>) {</div>
<div class="line"><span class="lineno"> 3213</span>    <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a8b142e2a51f6b9b8760f9132119673b6">key_len</a>;</div>
<div class="line"><span class="lineno"> 3214</span>    CK_RV <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a> =</div>
<div class="line"><span class="lineno"> 3215</span>      parse_ecparams(ecparams, ecparams_len, &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a53ef06e29c840024a683512c1acd791a">template</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__object__template.html#ad180a15b1f1a790679f9e5af6716b191">algorithm</a>, &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a8b142e2a51f6b9b8760f9132119673b6">key_len</a>);</div>
<div class="line"><span class="lineno"> 3216</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a> != <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>) {</div>
<div class="line"><span class="lineno"> 3217</span>      <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a>;</div>
<div class="line"><span class="lineno"> 3218</span>    }</div>
<div class="line"><span class="lineno"> 3219</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a8b142e2a51f6b9b8760f9132119673b6">key_len</a> != <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a53ef06e29c840024a683512c1acd791a">template</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__object__template.html#aee63938d6c8d1867137146053020d61a">objlen</a>) {</div>
<div class="line"><span class="lineno"> 3220</span>      <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#ab818f05c56d56675438515a7ba5ebb70">CKR_ATTRIBUTE_VALUE_INVALID</a>;</div>
<div class="line"><span class="lineno"> 3221</span>    }</div>
<div class="line"><span class="lineno"> 3222</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3223</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a98d78208707bfa2c51d6f051af1794e9">CKR_TEMPLATE_INCONSISTENT</a>;</div>
<div class="line"><span class="lineno"> 3224</span>  }</div>
<div class="line"><span class="lineno"> 3225</span> </div>
<div class="line"><span class="lineno"> 3226</span>  <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>;</div>
<div class="line"><span class="lineno"> 3227</span>}</div>
<div class="ttc" id="astructyubihsm__pkcs11__object__template_html_aa7e23493c41030819bd65ab687c604a7"><div class="ttname"><a href="structyubihsm__pkcs11__object__template.html#aa7e23493c41030819bd65ab687c604a7">yubihsm_pkcs11_object_template::obj</a></div><div class="ttdeci">union yubihsm_pkcs11_object_template::@114 obj</div></div>
<div class="ttc" id="astructyubihsm__pkcs11__object__template_html_acbc6f8ad9110ca09d862eaf06691897b"><div class="ttname"><a href="structyubihsm__pkcs11__object__template.html#acbc6f8ad9110ca09d862eaf06691897b">yubihsm_pkcs11_object_template::buf</a></div><div class="ttdeci">uint8_t * buf</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8h_source.html#l00195">yubihsm_pkcs11.h:195</a></div></div>
<div class="ttc" id="astructyubihsm__pkcs11__object__template_html_aee63938d6c8d1867137146053020d61a"><div class="ttname"><a href="structyubihsm__pkcs11__object__template.html#aee63938d6c8d1867137146053020d61a">yubihsm_pkcs11_object_template::objlen</a></div><div class="ttdeci">uint16_t objlen</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8h_source.html#l00189">yubihsm_pkcs11.h:189</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a490d37150a3d116225298faf1cb780b6"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a490d37150a3d116225298faf1cb780b6">ulCount</a></div><div class="ttdeci">CK_SESSION_HANDLE CK_ATTRIBUTE_PTR CK_ULONG ulCount</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l01204">yubihsm_pkcs11.c:1204</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_aa4c2296db6853afc30383aec1a404972"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#aa4c2296db6853afc30383aec1a404972">pTemplate</a></div><div class="ttdeci">CK_SESSION_HANDLE CK_ATTRIBUTE_PTR pTemplate</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l01204">yubihsm_pkcs11.c:1204</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util__pkcs11_8h_a67949ebcead5efdd41af1683033d525e_cgraph.png" border="0" usemap="#autil__pkcs11_8h_a67949ebcead5efdd41af1683033d525e_cgraph" alt=""/></div>
<map name="autil__pkcs11_8h_a67949ebcead5efdd41af1683033d525e_cgraph" id="autil__pkcs11_8h_a67949ebcead5efdd41af1683033d525e_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,137,31"/>
<area shape="rect" href="util__pkcs11_8c.html#a03b553175220c8747145497de5032100" title=" " alt="" coords="185,5,335,31"/>
<area shape="poly" title=" " alt="" coords="137,16,169,16,169,21,137,21"/>
</map>
</div>

</div>
</div>
<a id="a4680d9c4ecced6ef98ac202480bd53fd" name="a4680d9c4ecced6ef98ac202480bd53fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4680d9c4ecced6ef98ac202480bd53fd">&#9670;&#160;</a></span>parse_hex()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool parse_hex </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="pkcs11_8h.html#aee7068a12537d85d824edb4249e7ca4e">CK_UTF8CHAR_PTR</a></td>          <td class="paramname"><span class="paramname"><em>hex</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pkcs11_8h.html#a35181858a3b7a0a81f49d180d8f446ef">CK_ULONG</a></td>          <td class="paramname"><span class="paramname"><em>hex_len</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>parsed</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="util__pkcs11_8c_source.html#l00464">464</a> of file <a class="el" href="util__pkcs11_8c_source.html">util_pkcs11.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  464</span>                                                                       {</div>
<div class="line"><span class="lineno">  465</span> </div>
<div class="line"><span class="lineno">  466</span>  <span class="keywordtype">int</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a538d097420e725c4dad63c3caa9e55bd">j</a> = 0;</div>
<div class="line"><span class="lineno">  467</span> </div>
<div class="line"><span class="lineno">  468</span>  <span class="keywordflow">for</span> (<a class="code hl_typedef" href="pkcs11_8h.html#a35181858a3b7a0a81f49d180d8f446ef">CK_ULONG</a> i = 0; i &lt; hex_len; i += 2) {</div>
<div class="line"><span class="lineno">  469</span>    <span class="keywordflow">if</span> (isxdigit(hex[i]) == 0 || isxdigit(hex[i + 1]) == 0) {</div>
<div class="line"><span class="lineno">  470</span>      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  471</span>    }</div>
<div class="line"><span class="lineno">  472</span> </div>
<div class="line"><span class="lineno">  473</span>    <span class="keywordflow">if</span> (isdigit(hex[i])) {</div>
<div class="line"><span class="lineno">  474</span>      parsed[<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a538d097420e725c4dad63c3caa9e55bd">j</a>] = (<a class="code hl_variable" href="namespacesysio_1_1chain__apis.html#a14107dc373dfcfea6980bc2f5fa80a83">hex</a>[i] - <span class="charliteral">&#39;0&#39;</span>) &lt;&lt; 4;</div>
<div class="line"><span class="lineno">  475</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  476</span>      parsed[<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a538d097420e725c4dad63c3caa9e55bd">j</a>] = (tolower(hex[i]) - <span class="charliteral">&#39;a&#39;</span> + 10) &lt;&lt; 4;</div>
<div class="line"><span class="lineno">  477</span>    }</div>
<div class="line"><span class="lineno">  478</span> </div>
<div class="line"><span class="lineno">  479</span>    <span class="keywordflow">if</span> (isdigit(hex[i + 1])) {</div>
<div class="line"><span class="lineno">  480</span>      parsed[<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a538d097420e725c4dad63c3caa9e55bd">j</a>] |= (<a class="code hl_variable" href="namespacesysio_1_1chain__apis.html#a14107dc373dfcfea6980bc2f5fa80a83">hex</a>[i + 1] - <span class="charliteral">&#39;0&#39;</span>);</div>
<div class="line"><span class="lineno">  481</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  482</span>      parsed[<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a538d097420e725c4dad63c3caa9e55bd">j</a>] |= (tolower(hex[i + 1]) - <span class="charliteral">&#39;a&#39;</span> + 10);</div>
<div class="line"><span class="lineno">  483</span>    }</div>
<div class="line"><span class="lineno">  484</span> </div>
<div class="line"><span class="lineno">  485</span>    <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a538d097420e725c4dad63c3caa9e55bd">j</a>++;</div>
<div class="line"><span class="lineno">  486</span>  }</div>
<div class="line"><span class="lineno">  487</span> </div>
<div class="line"><span class="lineno">  488</span>  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  489</span>}</div>
<div class="ttc" id="anamespacesysio_1_1chain__apis_html_a14107dc373dfcfea6980bc2f5fa80a83"><div class="ttname"><a href="namespacesysio_1_1chain__apis.html#a14107dc373dfcfea6980bc2f5fa80a83">sysio::chain_apis::hex</a></div><div class="ttdeci">constexpr const char hex[]</div><div class="ttdef"><b>Definition</b> <a href="chain__plugin_8hpp_source.html#l00701">chain_plugin.hpp:701</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a538d097420e725c4dad63c3caa9e55bd"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a538d097420e725c4dad63c3caa9e55bd">j</a></div><div class="ttdeci">uint16_t j</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l00465">yubihsm_pkcs11.c:465</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7bf21a80e49d821dfcc0b5e97c056a69" name="a7bf21a80e49d821dfcc0b5e97c056a69"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7bf21a80e49d821dfcc0b5e97c056a69">&#9670;&#160;</a></span>parse_hmac_template()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CK_RV parse_hmac_template </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="pkcs11_8h.html#a5db3536793782f135785609e4a849fc6">CK_ATTRIBUTE_PTR</a></td>          <td class="paramname"><span class="paramname"><em>pTemplate</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pkcs11_8h.html#a35181858a3b7a0a81f49d180d8f446ef">CK_ULONG</a></td>          <td class="paramname"><span class="paramname"><em>ulCount</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structyubihsm__pkcs11__object__template.html">yubihsm_pkcs11_object_template</a> *</td>          <td class="paramname"><span class="paramname"><em>template</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>generate</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="util__pkcs11_8c_source.html#l03229">3229</a> of file <a class="el" href="util__pkcs11_8c_source.html">util_pkcs11.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3231</span>                                         {</div>
<div class="line"><span class="lineno"> 3232</span> </div>
<div class="line"><span class="lineno"> 3233</span>  CK_RV <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a>;</div>
<div class="line"><span class="lineno"> 3234</span> </div>
<div class="line"><span class="lineno"> 3235</span>  <span class="keywordflow">for</span> (<a class="code hl_typedef" href="pkcs11_8h.html#a35181858a3b7a0a81f49d180d8f446ef">CK_ULONG</a> i = 0; i &lt; <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a490d37150a3d116225298faf1cb780b6">ulCount</a>; i++) {</div>
<div class="line"><span class="lineno"> 3236</span>    <span class="keywordflow">switch</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa4c2296db6853afc30383aec1a404972">pTemplate</a>[i].type) {</div>
<div class="line"><span class="lineno"> 3237</span> </div>
<div class="line"><span class="lineno"> 3238</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a799f3b28e5c856ef4229d12257818841">CKA_VALUE</a>:</div>
<div class="line"><span class="lineno"> 3239</span>        <span class="keywordflow">if</span> (generate == <span class="keyword">false</span> &amp;&amp; <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a53ef06e29c840024a683512c1acd791a">template</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__object__template.html#aa7e23493c41030819bd65ab687c604a7">obj</a>.<a class="code hl_variable" href="structyubihsm__pkcs11__object__template.html#acbc6f8ad9110ca09d862eaf06691897b">buf</a> == NULL) {</div>
<div class="line"><span class="lineno"> 3240</span>          <span class="comment">// TODO: consider hanshing the key here if it&#39;s longer than blocklen</span></div>
<div class="line"><span class="lineno"> 3241</span>          <span class="keyword">template</span>-&gt;obj.buf = (<a class="code hl_typedef" href="pkcs11_8h.html#a7bc6919a7c3c372056fa7e18343a0b37">CK_BYTE_PTR</a>) <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa4c2296db6853afc30383aec1a404972">pTemplate</a>[i].pValue;</div>
<div class="line"><span class="lineno"> 3242</span>          <span class="keyword">template</span>-&gt;objlen = <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa4c2296db6853afc30383aec1a404972">pTemplate</a>[i].ulValueLen;</div>
<div class="line"><span class="lineno"> 3243</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3244</span>          <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a98d78208707bfa2c51d6f051af1794e9">CKR_TEMPLATE_INCONSISTENT</a>;</div>
<div class="line"><span class="lineno"> 3245</span>        }</div>
<div class="line"><span class="lineno"> 3246</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3247</span> </div>
<div class="line"><span class="lineno"> 3248</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a6ffd14ad7386d9aa7178e841a964a87e">CKA_SIGN</a>:</div>
<div class="line"><span class="lineno"> 3249</span>        <span class="keywordflow">if</span> ((<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a> = <a class="code hl_function" href="util__pkcs11_8c.html#a03b553175220c8747145497de5032100">set_template_attribute</a>(&amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a53ef06e29c840024a683512c1acd791a">template</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__object__template.html#a10f570d27a0e5b375f3e5e32f09c2c84">sign</a>,</div>
<div class="line"><span class="lineno"> 3250</span>                                         <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa4c2296db6853afc30383aec1a404972">pTemplate</a>[i].pValue)) != <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>) {</div>
<div class="line"><span class="lineno"> 3251</span>          <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a>;</div>
<div class="line"><span class="lineno"> 3252</span>        }</div>
<div class="line"><span class="lineno"> 3253</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3254</span> </div>
<div class="line"><span class="lineno"> 3255</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a84c89cd9def639cb4a58145063b7bd42">CKA_VERIFY</a>:</div>
<div class="line"><span class="lineno"> 3256</span>        <span class="keywordflow">if</span> ((<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a> = <a class="code hl_function" href="util__pkcs11_8c.html#a03b553175220c8747145497de5032100">set_template_attribute</a>(&amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a53ef06e29c840024a683512c1acd791a">template</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__object__template.html#a81add48bb33e8bb51a7f1047ec451baa">verify</a>,</div>
<div class="line"><span class="lineno"> 3257</span>                                         <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa4c2296db6853afc30383aec1a404972">pTemplate</a>[i].pValue)) != <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>) {</div>
<div class="line"><span class="lineno"> 3258</span>          <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a>;</div>
<div class="line"><span class="lineno"> 3259</span>        }</div>
<div class="line"><span class="lineno"> 3260</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3261</span> </div>
<div class="line"><span class="lineno"> 3262</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#aa438b88cbcb8a921288eeefba5613274">CKA_KEY_TYPE</a>:</div>
<div class="line"><span class="lineno"> 3263</span>        <span class="keywordflow">switch</span> (*((<a class="code hl_typedef" href="pkcs11_8h.html#a2c6426aaa1ca6dd1f48a01b8490482fa">CK_ULONG_PTR</a>) <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa4c2296db6853afc30383aec1a404972">pTemplate</a>[i].pValue)) {</div>
<div class="line"><span class="lineno"> 3264</span>          <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#aec5006f9a0e144d9b43af3a1f1e4a38f">CKK_SHA_1_HMAC</a>:</div>
<div class="line"><span class="lineno"> 3265</span>            <span class="keyword">template</span>-&gt;algorithm = <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa942e65c8cd0034eebe9a20c2297c7b06">YH_ALGO_HMAC_SHA1</a>;</div>
<div class="line"><span class="lineno"> 3266</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3267</span>          <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a18c67174b20896678c69e34922b3a98e">CKK_SHA256_HMAC</a>:</div>
<div class="line"><span class="lineno"> 3268</span>            <span class="keyword">template</span>-&gt;algorithm = <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caab0a0e1eb424b61057f159f1e53311f5c">YH_ALGO_HMAC_SHA256</a>;</div>
<div class="line"><span class="lineno"> 3269</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3270</span>          <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#aa9eb99690661eacb44520c2b68cc7536">CKK_SHA384_HMAC</a>:</div>
<div class="line"><span class="lineno"> 3271</span>            <span class="keyword">template</span>-&gt;algorithm = <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa781e7ca62563917d2129bde8ec53401b">YH_ALGO_HMAC_SHA384</a>;</div>
<div class="line"><span class="lineno"> 3272</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3273</span>          <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#af8c8d01e700c153527f112335b5d4065">CKK_SHA512_HMAC</a>:</div>
<div class="line"><span class="lineno"> 3274</span>            <span class="keyword">template</span>-&gt;algorithm = <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caa72d6c7ea77f10e39bbadc8b58d55b9ec">YH_ALGO_HMAC_SHA512</a>;</div>
<div class="line"><span class="lineno"> 3275</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3276</span>          <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 3277</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a98d78208707bfa2c51d6f051af1794e9">CKR_TEMPLATE_INCONSISTENT</a>;</div>
<div class="line"><span class="lineno"> 3278</span>        }</div>
<div class="line"><span class="lineno"> 3279</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3280</span> </div>
<div class="line"><span class="lineno"> 3281</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a05c1c460160443a739c6e0ce47ae3fc8">CKA_TOKEN</a>:</div>
<div class="line"><span class="lineno"> 3282</span>        <span class="keywordflow">if</span> ((<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a> = check_bool_attribute(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa4c2296db6853afc30383aec1a404972">pTemplate</a>[i].pValue, <span class="keyword">true</span>)) != <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>) {</div>
<div class="line"><span class="lineno"> 3283</span>          <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a>;</div>
<div class="line"><span class="lineno"> 3284</span>        }</div>
<div class="line"><span class="lineno"> 3285</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3286</span> </div>
<div class="line"><span class="lineno"> 3287</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#af867d3ae9286fe0f8cab4995bb6af337">CKA_CLASS</a>:</div>
<div class="line"><span class="lineno"> 3288</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#afef7cb3cf999a4ea9962e780c3e6e1cf">CKA_SUBJECT</a>:</div>
<div class="line"><span class="lineno"> 3289</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a2846a5a41835defa47716ccc3bcc4913">CKA_ID</a>:</div>
<div class="line"><span class="lineno"> 3290</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#acf009a991c04b5c4305cc76356225aa7">CKA_LABEL</a>:</div>
<div class="line"><span class="lineno"> 3291</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#acf37955a2a229d208289962c6f1183b8">CKA_EXTRACTABLE</a>:</div>
<div class="line"><span class="lineno"> 3292</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3293</span> </div>
<div class="line"><span class="lineno"> 3294</span>      <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 3295</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a0afbefc1a4ce05ba5faea1778eb602ca">CKR_ATTRIBUTE_TYPE_INVALID</a>;</div>
<div class="line"><span class="lineno"> 3296</span>    }</div>
<div class="line"><span class="lineno"> 3297</span>  }</div>
<div class="line"><span class="lineno"> 3298</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a53ef06e29c840024a683512c1acd791a">template</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__object__template.html#ad180a15b1f1a790679f9e5af6716b191">algorithm</a> &amp;&amp; (generate == <span class="keyword">true</span> || <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a53ef06e29c840024a683512c1acd791a">template</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__object__template.html#aa7e23493c41030819bd65ab687c604a7">obj</a>.<a class="code hl_variable" href="structyubihsm__pkcs11__object__template.html#acbc6f8ad9110ca09d862eaf06691897b">buf</a>)) {</div>
<div class="line"><span class="lineno"> 3299</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>;</div>
<div class="line"><span class="lineno"> 3300</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3301</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a98d78208707bfa2c51d6f051af1794e9">CKR_TEMPLATE_INCONSISTENT</a>;</div>
<div class="line"><span class="lineno"> 3302</span>  }</div>
<div class="line"><span class="lineno"> 3303</span>}</div>
<div class="ttc" id="apkcs11_8h_html_a18c67174b20896678c69e34922b3a98e"><div class="ttname"><a href="pkcs11_8h.html#a18c67174b20896678c69e34922b3a98e">CKK_SHA256_HMAC</a></div><div class="ttdeci">#define CKK_SHA256_HMAC</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00345">pkcs11.h:345</a></div></div>
<div class="ttc" id="apkcs11_8h_html_aa9eb99690661eacb44520c2b68cc7536"><div class="ttname"><a href="pkcs11_8h.html#aa9eb99690661eacb44520c2b68cc7536">CKK_SHA384_HMAC</a></div><div class="ttdeci">#define CKK_SHA384_HMAC</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00346">pkcs11.h:346</a></div></div>
<div class="ttc" id="apkcs11_8h_html_aec5006f9a0e144d9b43af3a1f1e4a38f"><div class="ttname"><a href="pkcs11_8h.html#aec5006f9a0e144d9b43af3a1f1e4a38f">CKK_SHA_1_HMAC</a></div><div class="ttdeci">#define CKK_SHA_1_HMAC</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00344">pkcs11.h:344</a></div></div>
<div class="ttc" id="apkcs11_8h_html_af8c8d01e700c153527f112335b5d4065"><div class="ttname"><a href="pkcs11_8h.html#af8c8d01e700c153527f112335b5d4065">CKK_SHA512_HMAC</a></div><div class="ttdeci">#define CKK_SHA512_HMAC</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00347">pkcs11.h:347</a></div></div>
<div class="ttc" id="astructyubihsm__pkcs11__object__template_html_a81add48bb33e8bb51a7f1047ec451baa"><div class="ttname"><a href="structyubihsm__pkcs11__object__template.html#a81add48bb33e8bb51a7f1047ec451baa">yubihsm_pkcs11_object_template::verify</a></div><div class="ttdeci">yubihsm_pkcs11_attribute verify</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8h_source.html#l00186">yubihsm_pkcs11.h:186</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util__pkcs11_8h_a7bf21a80e49d821dfcc0b5e97c056a69_cgraph.png" border="0" usemap="#autil__pkcs11_8h_a7bf21a80e49d821dfcc0b5e97c056a69_cgraph" alt=""/></div>
<map name="autil__pkcs11_8h_a7bf21a80e49d821dfcc0b5e97c056a69_cgraph" id="autil__pkcs11_8h_a7bf21a80e49d821dfcc0b5e97c056a69_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,155,31"/>
<area shape="rect" href="util__pkcs11_8c.html#a03b553175220c8747145497de5032100" title=" " alt="" coords="203,5,353,31"/>
<area shape="poly" title=" " alt="" coords="155,16,187,16,187,21,155,21"/>
</map>
</div>

</div>
</div>
<a id="a66eb3d4688d7e1358a14b6c86b2158f9" name="a66eb3d4688d7e1358a14b6c86b2158f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66eb3d4688d7e1358a14b6c86b2158f9">&#9670;&#160;</a></span>parse_id_value()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int parse_id_value </td>
          <td>(</td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>value</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pkcs11_8h.html#a35181858a3b7a0a81f49d180d8f446ef">CK_ULONG</a></td>          <td class="paramname"><span class="paramname"><em>len</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="util__pkcs11_8c_source.html#l03556">3556</a> of file <a class="el" href="util__pkcs11_8c_source.html">util_pkcs11.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3556</span>                                              {</div>
<div class="line"><span class="lineno"> 3557</span>  <span class="keywordflow">switch</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>) {</div>
<div class="line"><span class="lineno"> 3558</span>    <span class="keywordflow">case</span> 0:</div>
<div class="line"><span class="lineno"> 3559</span>      <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 3560</span>    <span class="keywordflow">case</span> 1:</div>
<div class="line"><span class="lineno"> 3561</span>      <span class="keywordflow">return</span> *(<a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *) <a class="code hl_define" href="pkcs11_8h.html#a32aff7c6c4cd253fdf6563677afab5ce">value</a>;</div>
<div class="line"><span class="lineno"> 3562</span>    <span class="keywordflow">case</span> 2:</div>
<div class="line"><span class="lineno"> 3563</span>      <span class="keywordflow">return</span> ntohs(*(<a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *) <a class="code hl_define" href="pkcs11_8h.html#a32aff7c6c4cd253fdf6563677afab5ce">value</a>);</div>
<div class="line"><span class="lineno"> 3564</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 3565</span>      <a class="code hl_define" href="debug__lib_8h.html#a8c4742440a149ad8bcb5d58ae76c5ed3">DBG_INFO</a>(<span class="stringliteral">&quot;Supplied id is long, truncating it (was %lu bytes)&quot;</span>, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>);</div>
<div class="line"><span class="lineno"> 3566</span>      <span class="keywordflow">return</span> ntohs(*(<a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *) <a class="code hl_define" href="pkcs11_8h.html#a32aff7c6c4cd253fdf6563677afab5ce">value</a>);</div>
<div class="line"><span class="lineno"> 3567</span>  }</div>
<div class="line"><span class="lineno"> 3568</span>}</div>
<div class="ttc" id="adebug__lib_8h_html_a8c4742440a149ad8bcb5d58ae76c5ed3"><div class="ttname"><a href="debug__lib_8h.html#a8c4742440a149ad8bcb5d58ae76c5ed3">DBG_INFO</a></div><div class="ttdeci">#define DBG_INFO(...)</div><div class="ttdef"><b>Definition</b> <a href="debug__lib_8h_source.html#l00063">debug_lib.h:63</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a7360b55975153b822efc5217b7734e6a"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a></div><div class="ttdeci">size_t len</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l04771">yubihsm_pkcs11.c:4771</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util__pkcs11_8h_a66eb3d4688d7e1358a14b6c86b2158f9_icgraph.png" border="0" usemap="#autil__pkcs11_8h_a66eb3d4688d7e1358a14b6c86b2158f9_icgraph" alt=""/></div>
<map name="autil__pkcs11_8h_a66eb3d4688d7e1358a14b6c86b2158f9_icgraph" id="autil__pkcs11_8h_a66eb3d4688d7e1358a14b6c86b2158f9_icgraph">
<area shape="rect" title=" " alt="" coords="328,55,436,80"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#a38dd348b8383c21c34929b6d73124029" title=" " alt="" coords="167,5,205,31"/>
<area shape="poly" title=" " alt="" coords="313,53,205,25,206,20,314,48"/>
<area shape="rect" href="util__pkcs11_8c.html#a2413ad4604ce34308256962fb1098ec7" title=" " alt="" coords="92,55,280,80"/>
<area shape="poly" title=" " alt="" coords="312,70,281,70,281,65,312,65"/>
<area shape="rect" href="util__pkcs11_8c.html#a3ae0dc7de593ff0d92ff81baaae9d5cb" title=" " alt="" coords="118,104,254,145"/>
<area shape="poly" title=" " alt="" coords="322,88,255,108,253,103,321,83"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#a77fecb6dade7b2f34dfa308233446aaf" title=" " alt="" coords="5,112,44,138"/>
<area shape="poly" title=" " alt="" coords="103,128,44,128,44,122,103,122"/>
</map>
</div>

</div>
</div>
<a id="a3ae0dc7de593ff0d92ff81baaae9d5cb" name="a3ae0dc7de593ff0d92ff81baaae9d5cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ae0dc7de593ff0d92ff81baaae9d5cb">&#9670;&#160;</a></span>parse_rsa_generate_template()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CK_RV parse_rsa_generate_template </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="pkcs11_8h.html#a5db3536793782f135785609e4a849fc6">CK_ATTRIBUTE_PTR</a></td>          <td class="paramname"><span class="paramname"><em>pPublicKeyTemplate</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pkcs11_8h.html#a35181858a3b7a0a81f49d180d8f446ef">CK_ULONG</a></td>          <td class="paramname"><span class="paramname"><em>ulPublicKeyAttributeCount</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pkcs11_8h.html#a5db3536793782f135785609e4a849fc6">CK_ATTRIBUTE_PTR</a></td>          <td class="paramname"><span class="paramname"><em>pPrivateKeyTemplate</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pkcs11_8h.html#a35181858a3b7a0a81f49d180d8f446ef">CK_ULONG</a></td>          <td class="paramname"><span class="paramname"><em>ulPrivateKeyAttributeCount</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structyubihsm__pkcs11__object__template.html">yubihsm_pkcs11_object_template</a> *</td>          <td class="paramname"><span class="paramname"><em>template</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="util__pkcs11_8c_source.html#l03305">3305</a> of file <a class="el" href="util__pkcs11_8c_source.html">util_pkcs11.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3309</span>                                                                            {</div>
<div class="line"><span class="lineno"> 3310</span> </div>
<div class="line"><span class="lineno"> 3311</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *e = NULL;</div>
<div class="line"><span class="lineno"> 3312</span>  <span class="keywordtype">bool</span> label_set = <a class="code hl_define" href="pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno"> 3313</span>  CK_RV <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a>;</div>
<div class="line"><span class="lineno"> 3314</span> </div>
<div class="line"><span class="lineno"> 3315</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105">memset</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a53ef06e29c840024a683512c1acd791a">template</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__object__template.html#a22edd3acceb711249d7593e73ad0d7f3">label</a>, 0, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a53ef06e29c840024a683512c1acd791a">template</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__object__template.html#a22edd3acceb711249d7593e73ad0d7f3">label</a>));</div>
<div class="line"><span class="lineno"> 3316</span> </div>
<div class="line"><span class="lineno"> 3317</span>  <span class="keywordflow">for</span> (<a class="code hl_typedef" href="pkcs11_8h.html#a35181858a3b7a0a81f49d180d8f446ef">CK_ULONG</a> i = 0; i &lt; <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa7504c440c5b75cdd4386b6d56c6116c">ulPublicKeyAttributeCount</a>; i++) {</div>
<div class="line"><span class="lineno"> 3318</span>    <span class="keywordflow">switch</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ade5d8be372cb742833a442592301a68b">pPublicKeyTemplate</a>[i].type) {</div>
<div class="line"><span class="lineno"> 3319</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#af867d3ae9286fe0f8cab4995bb6af337">CKA_CLASS</a>:</div>
<div class="line"><span class="lineno"> 3320</span>        <span class="keywordflow">if</span> (*((<a class="code hl_typedef" href="pkcs11_8h.html#a2c6426aaa1ca6dd1f48a01b8490482fa">CK_ULONG_PTR</a>) <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ade5d8be372cb742833a442592301a68b">pPublicKeyTemplate</a>[i].pValue) != <a class="code hl_define" href="pkcs11_8h.html#a105a73f3224e9745296afdf322c0d3d1">CKO_PUBLIC_KEY</a>) {</div>
<div class="line"><span class="lineno"> 3321</span>          <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;CKA_CLASS inconsistent in PublicKeyTemplate&quot;</span>);</div>
<div class="line"><span class="lineno"> 3322</span>          <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a98d78208707bfa2c51d6f051af1794e9">CKR_TEMPLATE_INCONSISTENT</a>;</div>
<div class="line"><span class="lineno"> 3323</span>        }</div>
<div class="line"><span class="lineno"> 3324</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3325</span> </div>
<div class="line"><span class="lineno"> 3326</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#aa438b88cbcb8a921288eeefba5613274">CKA_KEY_TYPE</a>:</div>
<div class="line"><span class="lineno"> 3327</span>        <span class="keywordflow">if</span> (*((<a class="code hl_typedef" href="pkcs11_8h.html#a2c6426aaa1ca6dd1f48a01b8490482fa">CK_ULONG_PTR</a>) <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ade5d8be372cb742833a442592301a68b">pPublicKeyTemplate</a>[i].pValue) != <a class="code hl_define" href="pkcs11_8h.html#a354731675f1ecc116e220b58b32636a1">CKK_RSA</a>) {</div>
<div class="line"><span class="lineno"> 3328</span>          <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;CKA_KEY_TYPE inconsistent in PublicKeyTemplate&quot;</span>);</div>
<div class="line"><span class="lineno"> 3329</span>          <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a98d78208707bfa2c51d6f051af1794e9">CKR_TEMPLATE_INCONSISTENT</a>;</div>
<div class="line"><span class="lineno"> 3330</span>        }</div>
<div class="line"><span class="lineno"> 3331</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3332</span> </div>
<div class="line"><span class="lineno"> 3333</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a2846a5a41835defa47716ccc3bcc4913">CKA_ID</a>:</div>
<div class="line"><span class="lineno"> 3334</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a53ef06e29c840024a683512c1acd791a">template</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__object__template.html#ad1b0e5ec887cae21e37a4b852a66727a">id</a> == 0) {</div>
<div class="line"><span class="lineno"> 3335</span>          <span class="keywordtype">int</span> <span class="keywordtype">id</span> = <a class="code hl_function" href="util__pkcs11_8c.html#a66eb3d4688d7e1358a14b6c86b2158f9">parse_id_value</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ade5d8be372cb742833a442592301a68b">pPublicKeyTemplate</a>[i].pValue,</div>
<div class="line"><span class="lineno"> 3336</span>                                  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ade5d8be372cb742833a442592301a68b">pPublicKeyTemplate</a>[i].ulValueLen);</div>
<div class="line"><span class="lineno"> 3337</span>          <span class="keywordflow">if</span> (<span class="keywordtype">id</span> == -1) {</div>
<div class="line"><span class="lineno"> 3338</span>            <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;CKA_ID invalid in PublicKeyTemplate&quot;</span>);</div>
<div class="line"><span class="lineno"> 3339</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#ab818f05c56d56675438515a7ba5ebb70">CKR_ATTRIBUTE_VALUE_INVALID</a>;</div>
<div class="line"><span class="lineno"> 3340</span>          }</div>
<div class="line"><span class="lineno"> 3341</span>          <span class="keyword">template</span>-&gt;id = <a class="code hl_variable" href="code__cache_8cpp.html#aa0efefe21f4700d78692edc823e763be">id</a>;</div>
<div class="line"><span class="lineno"> 3342</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3343</span>          <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;CKA_ID inconsistent in PublicKeyTemplate&quot;</span>);</div>
<div class="line"><span class="lineno"> 3344</span>          <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a98d78208707bfa2c51d6f051af1794e9">CKR_TEMPLATE_INCONSISTENT</a>;</div>
<div class="line"><span class="lineno"> 3345</span>        }</div>
<div class="line"><span class="lineno"> 3346</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3347</span> </div>
<div class="line"><span class="lineno"> 3348</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a3560a0897e67ea3584c5e5d6b49997a9">CKA_PUBLIC_EXPONENT</a>:</div>
<div class="line"><span class="lineno"> 3349</span>        <span class="keywordflow">if</span> (e == NULL) {</div>
<div class="line"><span class="lineno"> 3350</span>          e = (<a class="code hl_typedef" href="pkcs11_8h.html#a7bc6919a7c3c372056fa7e18343a0b37">CK_BYTE_PTR</a>) <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ade5d8be372cb742833a442592301a68b">pPublicKeyTemplate</a>[i].pValue;</div>
<div class="line"><span class="lineno"> 3351</span>          <span class="keywordflow">if</span> (!((<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ade5d8be372cb742833a442592301a68b">pPublicKeyTemplate</a>[i].ulValueLen == 3 &amp;&amp;</div>
<div class="line"><span class="lineno"> 3352</span>                 memcmp(e, <span class="stringliteral">&quot;\x01\x00\x01&quot;</span>, 3) == 0) ||</div>
<div class="line"><span class="lineno"> 3353</span>                (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ade5d8be372cb742833a442592301a68b">pPublicKeyTemplate</a>[i].ulValueLen == 4 &amp;&amp;</div>
<div class="line"><span class="lineno"> 3354</span>                 memcmp(e, <span class="stringliteral">&quot;\x00\x01\x00\x01&quot;</span>, 4) == 0))) {</div>
<div class="line"><span class="lineno"> 3355</span>            <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;CKA_PUBLIC_EXPONENT invalid in PublicKeyTemplate&quot;</span>);</div>
<div class="line"><span class="lineno"> 3356</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#ab818f05c56d56675438515a7ba5ebb70">CKR_ATTRIBUTE_VALUE_INVALID</a>;</div>
<div class="line"><span class="lineno"> 3357</span>          }</div>
<div class="line"><span class="lineno"> 3358</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3359</span>          <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;CKA_PUBLIC_EXPONENT inconsistent in PublicKeyTemplate&quot;</span>);</div>
<div class="line"><span class="lineno"> 3360</span>          <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a98d78208707bfa2c51d6f051af1794e9">CKR_TEMPLATE_INCONSISTENT</a>;</div>
<div class="line"><span class="lineno"> 3361</span>        }</div>
<div class="line"><span class="lineno"> 3362</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3363</span> </div>
<div class="line"><span class="lineno"> 3364</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ace277af7e7da877d65a25411a22a6b39">CKA_MODULUS_BITS</a>:</div>
<div class="line"><span class="lineno"> 3365</span>        <span class="keywordflow">switch</span> (*((<a class="code hl_typedef" href="pkcs11_8h.html#a2c6426aaa1ca6dd1f48a01b8490482fa">CK_ULONG_PTR</a>) <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ade5d8be372cb742833a442592301a68b">pPublicKeyTemplate</a>[i].pValue)) {</div>
<div class="line"><span class="lineno"> 3366</span>          <span class="keywordflow">case</span> 2048:</div>
<div class="line"><span class="lineno"> 3367</span>            <span class="keyword">template</span>-&gt;algorithm = <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caaafe94e6a770edb51c6db84f77d98d2c6">YH_ALGO_RSA_2048</a>;</div>
<div class="line"><span class="lineno"> 3368</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3369</span> </div>
<div class="line"><span class="lineno"> 3370</span>          <span class="keywordflow">case</span> 3072:</div>
<div class="line"><span class="lineno"> 3371</span>            <span class="keyword">template</span>-&gt;algorithm = <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caafd3fbd9ed86caf267ccc77cb24d44426">YH_ALGO_RSA_3072</a>;</div>
<div class="line"><span class="lineno"> 3372</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3373</span> </div>
<div class="line"><span class="lineno"> 3374</span>          <span class="keywordflow">case</span> 4096:</div>
<div class="line"><span class="lineno"> 3375</span>            <span class="keyword">template</span>-&gt;algorithm = <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caae5963322a0a0f43a1b74faa78e3a7329">YH_ALGO_RSA_4096</a>;</div>
<div class="line"><span class="lineno"> 3376</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3377</span> </div>
<div class="line"><span class="lineno"> 3378</span>          <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 3379</span>            <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;CKA_MODULUS_BITS wrong length in PublicKeyTemplate (%lu)&quot;</span>,</div>
<div class="line"><span class="lineno"> 3380</span>                    *((<a class="code hl_typedef" href="pkcs11_8h.html#a2c6426aaa1ca6dd1f48a01b8490482fa">CK_ULONG_PTR</a>) <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ade5d8be372cb742833a442592301a68b">pPublicKeyTemplate</a>[i].pValue));</div>
<div class="line"><span class="lineno"> 3381</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#ab818f05c56d56675438515a7ba5ebb70">CKR_ATTRIBUTE_VALUE_INVALID</a>;</div>
<div class="line"><span class="lineno"> 3382</span>        }</div>
<div class="line"><span class="lineno"> 3383</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3384</span> </div>
<div class="line"><span class="lineno"> 3385</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#acf009a991c04b5c4305cc76356225aa7">CKA_LABEL</a>:</div>
<div class="line"><span class="lineno"> 3386</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ade5d8be372cb742833a442592301a68b">pPublicKeyTemplate</a>[i].ulValueLen &gt; <a class="code hl_define" href="yubihsm_8h.html#a431f8b753552a8b2f5f980e871b6d019">YH_OBJ_LABEL_LEN</a>) {</div>
<div class="line"><span class="lineno"> 3387</span>          <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;CKA_LABEL invalid in PublicKeyTemplate&quot;</span>);</div>
<div class="line"><span class="lineno"> 3388</span>          <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#ab818f05c56d56675438515a7ba5ebb70">CKR_ATTRIBUTE_VALUE_INVALID</a>;</div>
<div class="line"><span class="lineno"> 3389</span>        }</div>
<div class="line"><span class="lineno"> 3390</span> </div>
<div class="line"><span class="lineno"> 3391</span>        <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a53ef06e29c840024a683512c1acd791a">template</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__object__template.html#a22edd3acceb711249d7593e73ad0d7f3">label</a>, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ade5d8be372cb742833a442592301a68b">pPublicKeyTemplate</a>[i].pValue,</div>
<div class="line"><span class="lineno"> 3392</span>               <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ade5d8be372cb742833a442592301a68b">pPublicKeyTemplate</a>[i].ulValueLen);</div>
<div class="line"><span class="lineno"> 3393</span> </div>
<div class="line"><span class="lineno"> 3394</span>        label_set = <a class="code hl_define" href="pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno"> 3395</span> </div>
<div class="line"><span class="lineno"> 3396</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3397</span> </div>
<div class="line"><span class="lineno"> 3398</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a05c1c460160443a739c6e0ce47ae3fc8">CKA_TOKEN</a>:</div>
<div class="line"><span class="lineno"> 3399</span>        <span class="keywordflow">if</span> ((<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a> = check_bool_attribute(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ade5d8be372cb742833a442592301a68b">pPublicKeyTemplate</a>[i].pValue, <span class="keyword">true</span>)) !=</div>
<div class="line"><span class="lineno"> 3400</span>            <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>) {</div>
<div class="line"><span class="lineno"> 3401</span>          <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Boolean truth check failed for attribute 0x%lx&quot;</span>,</div>
<div class="line"><span class="lineno"> 3402</span>                  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ade5d8be372cb742833a442592301a68b">pPublicKeyTemplate</a>[i].type);</div>
<div class="line"><span class="lineno"> 3403</span>          <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a>;</div>
<div class="line"><span class="lineno"> 3404</span>        }</div>
<div class="line"><span class="lineno"> 3405</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3406</span> </div>
<div class="line"><span class="lineno"> 3407</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a39688e3f665848ca7868f2ca37aa1aed">CKA_MODIFIABLE</a>:</div>
<div class="line"><span class="lineno"> 3408</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#aa26224c75961163975e3de4347940401">CKA_DECRYPT</a>:</div>
<div class="line"><span class="lineno"> 3409</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a6ffd14ad7386d9aa7178e841a964a87e">CKA_SIGN</a>:</div>
<div class="line"><span class="lineno"> 3410</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a9a9a988131e4e93d0758e43c555bdc97">CKA_UNWRAP</a>:</div>
<div class="line"><span class="lineno"> 3411</span>        <span class="keywordflow">if</span> ((<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a> = check_bool_attribute(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ade5d8be372cb742833a442592301a68b">pPublicKeyTemplate</a>[i].pValue, <span class="keyword">false</span>)) !=</div>
<div class="line"><span class="lineno"> 3412</span>            <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>) {</div>
<div class="line"><span class="lineno"> 3413</span>          <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Boolean false check failed for attribute 0x%lx&quot;</span>,</div>
<div class="line"><span class="lineno"> 3414</span>                  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ade5d8be372cb742833a442592301a68b">pPublicKeyTemplate</a>[i].type);</div>
<div class="line"><span class="lineno"> 3415</span>          <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a>;</div>
<div class="line"><span class="lineno"> 3416</span>        }</div>
<div class="line"><span class="lineno"> 3417</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3418</span> </div>
<div class="line"><span class="lineno"> 3419</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#af7a34bb656aa7e2b7e813dab0a6ac7b7">CKA_WRAP</a>:</div>
<div class="line"><span class="lineno"> 3420</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a84c89cd9def639cb4a58145063b7bd42">CKA_VERIFY</a>:</div>
<div class="line"><span class="lineno"> 3421</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ad427016a08d7b8f0d8fe910b907e9b44">CKA_ENCRYPT</a>:</div>
<div class="line"><span class="lineno"> 3422</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#acf37955a2a229d208289962c6f1183b8">CKA_EXTRACTABLE</a>:</div>
<div class="line"><span class="lineno"> 3423</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a5244a0b0719c79614044460bdcf34d11">CKA_PRIVATE</a>:</div>
<div class="line"><span class="lineno"> 3424</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a92925cbe2a1b3d50dd56f8af0f770a69">CKA_COPYABLE</a>:</div>
<div class="line"><span class="lineno"> 3425</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ab495c20657f01d79e1a6ca49d2c8472e">CKA_DESTROYABLE</a>:</div>
<div class="line"><span class="lineno"> 3426</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3427</span> </div>
<div class="line"><span class="lineno"> 3428</span>      <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 3429</span>        <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;invalid attribute type in PublicKeyTemplate: 0x%lx&quot;</span>,</div>
<div class="line"><span class="lineno"> 3430</span>                <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#ade5d8be372cb742833a442592301a68b">pPublicKeyTemplate</a>[i].type);</div>
<div class="line"><span class="lineno"> 3431</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a0afbefc1a4ce05ba5faea1778eb602ca">CKR_ATTRIBUTE_TYPE_INVALID</a>;</div>
<div class="line"><span class="lineno"> 3432</span>    }</div>
<div class="line"><span class="lineno"> 3433</span>  }</div>
<div class="line"><span class="lineno"> 3434</span> </div>
<div class="line"><span class="lineno"> 3435</span>  <span class="keywordflow">for</span> (<a class="code hl_typedef" href="pkcs11_8h.html#a35181858a3b7a0a81f49d180d8f446ef">CK_ULONG</a> i = 0; i &lt; <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a062bc7ed451133876d988fb653844af4">ulPrivateKeyAttributeCount</a>; i++) {</div>
<div class="line"><span class="lineno"> 3436</span>    <span class="keywordflow">switch</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa0bd9585bb6c1f50e5c0c72da9d48cb9">pPrivateKeyTemplate</a>[i].type) {</div>
<div class="line"><span class="lineno"> 3437</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#af867d3ae9286fe0f8cab4995bb6af337">CKA_CLASS</a>:</div>
<div class="line"><span class="lineno"> 3438</span>        <span class="keywordflow">if</span> (*((<a class="code hl_typedef" href="pkcs11_8h.html#a2c6426aaa1ca6dd1f48a01b8490482fa">CK_ULONG_PTR</a>) <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa0bd9585bb6c1f50e5c0c72da9d48cb9">pPrivateKeyTemplate</a>[i].pValue) !=</div>
<div class="line"><span class="lineno"> 3439</span>            <a class="code hl_define" href="pkcs11_8h.html#a8aa610efb7f7dd562bce4576250753a8">CKO_PRIVATE_KEY</a>) {</div>
<div class="line"><span class="lineno"> 3440</span>          <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;CKA_CLASS inconsistent in PrivateKeyTemplate&quot;</span>);</div>
<div class="line"><span class="lineno"> 3441</span>          <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a98d78208707bfa2c51d6f051af1794e9">CKR_TEMPLATE_INCONSISTENT</a>;</div>
<div class="line"><span class="lineno"> 3442</span>        }</div>
<div class="line"><span class="lineno"> 3443</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3444</span> </div>
<div class="line"><span class="lineno"> 3445</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#aa438b88cbcb8a921288eeefba5613274">CKA_KEY_TYPE</a>:</div>
<div class="line"><span class="lineno"> 3446</span>        <span class="keywordflow">if</span> (*((<a class="code hl_typedef" href="pkcs11_8h.html#a2c6426aaa1ca6dd1f48a01b8490482fa">CK_ULONG_PTR</a>) <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa0bd9585bb6c1f50e5c0c72da9d48cb9">pPrivateKeyTemplate</a>[i].pValue) != <a class="code hl_define" href="pkcs11_8h.html#a354731675f1ecc116e220b58b32636a1">CKK_RSA</a>) {</div>
<div class="line"><span class="lineno"> 3447</span>          <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;CKA_KEY_TYPE inconsistent in PrivateKeyTemplate&quot;</span>);</div>
<div class="line"><span class="lineno"> 3448</span>          <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a98d78208707bfa2c51d6f051af1794e9">CKR_TEMPLATE_INCONSISTENT</a>;</div>
<div class="line"><span class="lineno"> 3449</span>        }</div>
<div class="line"><span class="lineno"> 3450</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3451</span> </div>
<div class="line"><span class="lineno"> 3452</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a2846a5a41835defa47716ccc3bcc4913">CKA_ID</a>: {</div>
<div class="line"><span class="lineno"> 3453</span>        <span class="keywordtype">int</span> <span class="keywordtype">id</span> = <a class="code hl_function" href="util__pkcs11_8c.html#a66eb3d4688d7e1358a14b6c86b2158f9">parse_id_value</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa0bd9585bb6c1f50e5c0c72da9d48cb9">pPrivateKeyTemplate</a>[i].pValue,</div>
<div class="line"><span class="lineno"> 3454</span>                                <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa0bd9585bb6c1f50e5c0c72da9d48cb9">pPrivateKeyTemplate</a>[i].ulValueLen);</div>
<div class="line"><span class="lineno"> 3455</span>        <span class="keywordflow">if</span> (<span class="keywordtype">id</span> == -1) {</div>
<div class="line"><span class="lineno"> 3456</span>          <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;CKA_ID invalid in PrivateKeyTemplate&quot;</span>);</div>
<div class="line"><span class="lineno"> 3457</span>          <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#ab818f05c56d56675438515a7ba5ebb70">CKR_ATTRIBUTE_VALUE_INVALID</a>;</div>
<div class="line"><span class="lineno"> 3458</span>        }</div>
<div class="line"><span class="lineno"> 3459</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a53ef06e29c840024a683512c1acd791a">template</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__object__template.html#ad1b0e5ec887cae21e37a4b852a66727a">id</a> != 0 &amp;&amp; <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a53ef06e29c840024a683512c1acd791a">template</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__object__template.html#ad1b0e5ec887cae21e37a4b852a66727a">id</a> != <span class="keywordtype">id</span>) {</div>
<div class="line"><span class="lineno"> 3460</span>          <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;CKA_ID inconsistent in PrivateKeyTemplate&quot;</span>);</div>
<div class="line"><span class="lineno"> 3461</span>          <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a98d78208707bfa2c51d6f051af1794e9">CKR_TEMPLATE_INCONSISTENT</a>;</div>
<div class="line"><span class="lineno"> 3462</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3463</span>          <span class="keyword">template</span>-&gt;id = <a class="code hl_variable" href="code__cache_8cpp.html#aa0efefe21f4700d78692edc823e763be">id</a>;</div>
<div class="line"><span class="lineno"> 3464</span>        }</div>
<div class="line"><span class="lineno"> 3465</span>      } <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3466</span> </div>
<div class="line"><span class="lineno"> 3467</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#aa26224c75961163975e3de4347940401">CKA_DECRYPT</a>:</div>
<div class="line"><span class="lineno"> 3468</span>        <span class="keywordflow">if</span> ((<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a> = <a class="code hl_function" href="util__pkcs11_8c.html#a03b553175220c8747145497de5032100">set_template_attribute</a>(&amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a53ef06e29c840024a683512c1acd791a">template</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__object__template.html#a11816ed4ec4908d99d1fc35935f4bf52">decrypt</a>,</div>
<div class="line"><span class="lineno"> 3469</span>                                         <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa0bd9585bb6c1f50e5c0c72da9d48cb9">pPrivateKeyTemplate</a>[i].pValue)) !=</div>
<div class="line"><span class="lineno"> 3470</span>            <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>) {</div>
<div class="line"><span class="lineno"> 3471</span>          <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;CKA_DECRYPT inconsistent in PrivateKeyTemplate&quot;</span>);</div>
<div class="line"><span class="lineno"> 3472</span>          <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a>;</div>
<div class="line"><span class="lineno"> 3473</span>        }</div>
<div class="line"><span class="lineno"> 3474</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3475</span> </div>
<div class="line"><span class="lineno"> 3476</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a6ffd14ad7386d9aa7178e841a964a87e">CKA_SIGN</a>:</div>
<div class="line"><span class="lineno"> 3477</span>        <span class="keywordflow">if</span> ((<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a> = <a class="code hl_function" href="util__pkcs11_8c.html#a03b553175220c8747145497de5032100">set_template_attribute</a>(&amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a53ef06e29c840024a683512c1acd791a">template</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__object__template.html#a10f570d27a0e5b375f3e5e32f09c2c84">sign</a>,</div>
<div class="line"><span class="lineno"> 3478</span>                                         <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa0bd9585bb6c1f50e5c0c72da9d48cb9">pPrivateKeyTemplate</a>[i].pValue)) !=</div>
<div class="line"><span class="lineno"> 3479</span>            <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>) {</div>
<div class="line"><span class="lineno"> 3480</span>          <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;CKA_SIGN inconsistent in PrivateKeyTemplate&quot;</span>);</div>
<div class="line"><span class="lineno"> 3481</span>          <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a>;</div>
<div class="line"><span class="lineno"> 3482</span>        }</div>
<div class="line"><span class="lineno"> 3483</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3484</span> </div>
<div class="line"><span class="lineno"> 3485</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#acf37955a2a229d208289962c6f1183b8">CKA_EXTRACTABLE</a>:</div>
<div class="line"><span class="lineno"> 3486</span>        <span class="keywordflow">if</span> ((<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a> = <a class="code hl_function" href="util__pkcs11_8c.html#a03b553175220c8747145497de5032100">set_template_attribute</a>(&amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a53ef06e29c840024a683512c1acd791a">template</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__object__template.html#a30a6882cb36864acc3e27baaf38ff0f1">exportable</a>,</div>
<div class="line"><span class="lineno"> 3487</span>                                         <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa0bd9585bb6c1f50e5c0c72da9d48cb9">pPrivateKeyTemplate</a>[i].pValue)) !=</div>
<div class="line"><span class="lineno"> 3488</span>            <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>) {</div>
<div class="line"><span class="lineno"> 3489</span>          <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;CKA_EXTRACTABLE inconsistent in PrivateKeyTemplate&quot;</span>);</div>
<div class="line"><span class="lineno"> 3490</span>          <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a>;</div>
<div class="line"><span class="lineno"> 3491</span>        }</div>
<div class="line"><span class="lineno"> 3492</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3493</span> </div>
<div class="line"><span class="lineno"> 3494</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#acf009a991c04b5c4305cc76356225aa7">CKA_LABEL</a>:</div>
<div class="line"><span class="lineno"> 3495</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa0bd9585bb6c1f50e5c0c72da9d48cb9">pPrivateKeyTemplate</a>[i].ulValueLen &gt; <a class="code hl_define" href="yubihsm_8h.html#a431f8b753552a8b2f5f980e871b6d019">YH_OBJ_LABEL_LEN</a>) {</div>
<div class="line"><span class="lineno"> 3496</span>          <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;CKA_LABEL invalid in PrivateKeyTemplate&quot;</span>);</div>
<div class="line"><span class="lineno"> 3497</span>          <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#ab818f05c56d56675438515a7ba5ebb70">CKR_ATTRIBUTE_VALUE_INVALID</a>;</div>
<div class="line"><span class="lineno"> 3498</span>        }</div>
<div class="line"><span class="lineno"> 3499</span> </div>
<div class="line"><span class="lineno"> 3500</span>        <span class="keywordflow">if</span> (label_set == <a class="code hl_define" href="pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>) {</div>
<div class="line"><span class="lineno"> 3501</span>          <span class="keywordflow">if</span> (memcmp(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a53ef06e29c840024a683512c1acd791a">template</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__object__template.html#a22edd3acceb711249d7593e73ad0d7f3">label</a>, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa0bd9585bb6c1f50e5c0c72da9d48cb9">pPrivateKeyTemplate</a>[i].pValue,</div>
<div class="line"><span class="lineno"> 3502</span>                     <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa0bd9585bb6c1f50e5c0c72da9d48cb9">pPrivateKeyTemplate</a>[i].ulValueLen) != 0) {</div>
<div class="line"><span class="lineno"> 3503</span>            <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;CKA_LABEL inconsistent in PrivateKeyTemplate&quot;</span>);</div>
<div class="line"><span class="lineno"> 3504</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a98d78208707bfa2c51d6f051af1794e9">CKR_TEMPLATE_INCONSISTENT</a>;</div>
<div class="line"><span class="lineno"> 3505</span>          }</div>
<div class="line"><span class="lineno"> 3506</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3507</span>          <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a53ef06e29c840024a683512c1acd791a">template</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__object__template.html#a22edd3acceb711249d7593e73ad0d7f3">label</a>, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa0bd9585bb6c1f50e5c0c72da9d48cb9">pPrivateKeyTemplate</a>[i].pValue,</div>
<div class="line"><span class="lineno"> 3508</span>                 <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa0bd9585bb6c1f50e5c0c72da9d48cb9">pPrivateKeyTemplate</a>[i].ulValueLen);</div>
<div class="line"><span class="lineno"> 3509</span>        }</div>
<div class="line"><span class="lineno"> 3510</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3511</span> </div>
<div class="line"><span class="lineno"> 3512</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a05c1c460160443a739c6e0ce47ae3fc8">CKA_TOKEN</a>:</div>
<div class="line"><span class="lineno"> 3513</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a5fe5fb4a38ca6781c50e4cba8a2af0d6">CKA_SENSITIVE</a>:</div>
<div class="line"><span class="lineno"> 3514</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a5244a0b0719c79614044460bdcf34d11">CKA_PRIVATE</a>:</div>
<div class="line"><span class="lineno"> 3515</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ab495c20657f01d79e1a6ca49d2c8472e">CKA_DESTROYABLE</a>:</div>
<div class="line"><span class="lineno"> 3516</span>        <span class="keywordflow">if</span> ((<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a> = check_bool_attribute(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa0bd9585bb6c1f50e5c0c72da9d48cb9">pPrivateKeyTemplate</a>[i].pValue, <span class="keyword">true</span>)) !=</div>
<div class="line"><span class="lineno"> 3517</span>            <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>) {</div>
<div class="line"><span class="lineno"> 3518</span>          <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Boolean truth check failed for attribute 0x%lx&quot;</span>,</div>
<div class="line"><span class="lineno"> 3519</span>                  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa0bd9585bb6c1f50e5c0c72da9d48cb9">pPrivateKeyTemplate</a>[i].type);</div>
<div class="line"><span class="lineno"> 3520</span>          <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a>;</div>
<div class="line"><span class="lineno"> 3521</span>        }</div>
<div class="line"><span class="lineno"> 3522</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3523</span> </div>
<div class="line"><span class="lineno"> 3524</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#af7a34bb656aa7e2b7e813dab0a6ac7b7">CKA_WRAP</a>:</div>
<div class="line"><span class="lineno"> 3525</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a39688e3f665848ca7868f2ca37aa1aed">CKA_MODIFIABLE</a>:</div>
<div class="line"><span class="lineno"> 3526</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a92925cbe2a1b3d50dd56f8af0f770a69">CKA_COPYABLE</a>:</div>
<div class="line"><span class="lineno"> 3527</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ad427016a08d7b8f0d8fe910b907e9b44">CKA_ENCRYPT</a>:</div>
<div class="line"><span class="lineno"> 3528</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a84c89cd9def639cb4a58145063b7bd42">CKA_VERIFY</a>:</div>
<div class="line"><span class="lineno"> 3529</span>        <span class="keywordflow">if</span> ((<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a> = check_bool_attribute(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa0bd9585bb6c1f50e5c0c72da9d48cb9">pPrivateKeyTemplate</a>[i].pValue, <span class="keyword">false</span>)) !=</div>
<div class="line"><span class="lineno"> 3530</span>            <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>) {</div>
<div class="line"><span class="lineno"> 3531</span>          <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Boolean false check failed for attribute 0x%lx&quot;</span>,</div>
<div class="line"><span class="lineno"> 3532</span>                  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa0bd9585bb6c1f50e5c0c72da9d48cb9">pPrivateKeyTemplate</a>[i].type);</div>
<div class="line"><span class="lineno"> 3533</span>          <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a>;</div>
<div class="line"><span class="lineno"> 3534</span>        }</div>
<div class="line"><span class="lineno"> 3535</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3536</span> </div>
<div class="line"><span class="lineno"> 3537</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a9a9a988131e4e93d0758e43c555bdc97">CKA_UNWRAP</a>:</div>
<div class="line"><span class="lineno"> 3538</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#afef7cb3cf999a4ea9962e780c3e6e1cf">CKA_SUBJECT</a>:</div>
<div class="line"><span class="lineno"> 3539</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3540</span> </div>
<div class="line"><span class="lineno"> 3541</span>      <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 3542</span>        <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;invalid attribute type in PrivateKeyTemplate: 0x%lx&quot;</span>,</div>
<div class="line"><span class="lineno"> 3543</span>                <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa0bd9585bb6c1f50e5c0c72da9d48cb9">pPrivateKeyTemplate</a>[i].type);</div>
<div class="line"><span class="lineno"> 3544</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a0afbefc1a4ce05ba5faea1778eb602ca">CKR_ATTRIBUTE_TYPE_INVALID</a>;</div>
<div class="line"><span class="lineno"> 3545</span>    }</div>
<div class="line"><span class="lineno"> 3546</span>  }</div>
<div class="line"><span class="lineno"> 3547</span> </div>
<div class="line"><span class="lineno"> 3548</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a53ef06e29c840024a683512c1acd791a">template</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__object__template.html#ad180a15b1f1a790679f9e5af6716b191">algorithm</a> == 0) {</div>
<div class="line"><span class="lineno"> 3549</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;No RSA bitlength set&quot;</span>);</div>
<div class="line"><span class="lineno"> 3550</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#acfcd3a766f4ce45e10b89243cfe9f07e">CKR_TEMPLATE_INCOMPLETE</a>;</div>
<div class="line"><span class="lineno"> 3551</span>  }</div>
<div class="line"><span class="lineno"> 3552</span> </div>
<div class="line"><span class="lineno"> 3553</span>  <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>;</div>
<div class="line"><span class="lineno"> 3554</span>}</div>
<div class="ttc" id="apkcs11_8h_html_a354731675f1ecc116e220b58b32636a1"><div class="ttname"><a href="pkcs11_8h.html#a354731675f1ecc116e220b58b32636a1">CKK_RSA</a></div><div class="ttdeci">#define CKK_RSA</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00319">pkcs11.h:319</a></div></div>
<div class="ttc" id="apkcs11_8h_html_a3560a0897e67ea3584c5e5d6b49997a9"><div class="ttname"><a href="pkcs11_8h.html#a3560a0897e67ea3584c5e5d6b49997a9">CKA_PUBLIC_EXPONENT</a></div><div class="ttdeci">#define CKA_PUBLIC_EXPONENT</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00400">pkcs11.h:400</a></div></div>
<div class="ttc" id="apkcs11_8h_html_ace277af7e7da877d65a25411a22a6b39"><div class="ttname"><a href="pkcs11_8h.html#ace277af7e7da877d65a25411a22a6b39">CKA_MODULUS_BITS</a></div><div class="ttdeci">#define CKA_MODULUS_BITS</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00399">pkcs11.h:399</a></div></div>
<div class="ttc" id="astructyubihsm__pkcs11__object__template_html_a11816ed4ec4908d99d1fc35935f4bf52"><div class="ttname"><a href="structyubihsm__pkcs11__object__template.html#a11816ed4ec4908d99d1fc35935f4bf52">yubihsm_pkcs11_object_template::decrypt</a></div><div class="ttdeci">yubihsm_pkcs11_attribute decrypt</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8h_source.html#l00183">yubihsm_pkcs11.h:183</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util__pkcs11_8h_a3ae0dc7de593ff0d92ff81baaae9d5cb_cgraph.png" border="0" usemap="#autil__pkcs11_8h_a3ae0dc7de593ff0d92ff81baaae9d5cb_cgraph" alt=""/></div>
<map name="autil__pkcs11_8h_a3ae0dc7de593ff0d92ff81baaae9d5cb_cgraph" id="autil__pkcs11_8h_a3ae0dc7de593ff0d92ff81baaae9d5cb_cgraph">
<area shape="rect" title=" " alt="" coords="5,72,141,113"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="228,5,300,31"/>
<area shape="poly" title=" " alt="" coords="117,70,188,40,212,31,214,36,190,45,119,74"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="230,55,298,80"/>
<area shape="poly" title=" " alt="" coords="141,81,214,71,215,77,142,86"/>
<area shape="rect" href="util__pkcs11_8c.html#a66eb3d4688d7e1358a14b6c86b2158f9" title=" " alt="" coords="210,104,318,130"/>
<area shape="poly" title=" " alt="" coords="142,99,195,106,194,111,141,104"/>
<area shape="rect" href="util__pkcs11_8c.html#a03b553175220c8747145497de5032100" title=" " alt="" coords="189,153,339,179"/>
<area shape="poly" title=" " alt="" coords="121,111,190,140,206,145,204,150,188,145,119,116"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util__pkcs11_8h_a3ae0dc7de593ff0d92ff81baaae9d5cb_icgraph.png" border="0" usemap="#autil__pkcs11_8h_a3ae0dc7de593ff0d92ff81baaae9d5cb_icgraph" alt=""/></div>
<map name="autil__pkcs11_8h_a3ae0dc7de593ff0d92ff81baaae9d5cb_icgraph" id="autil__pkcs11_8h_a3ae0dc7de593ff0d92ff81baaae9d5cb_icgraph">
<area shape="rect" title=" " alt="" coords="92,5,227,46"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#a77fecb6dade7b2f34dfa308233446aaf" title=" " alt="" coords="5,13,44,38"/>
<area shape="poly" title=" " alt="" coords="76,28,44,28,44,23,76,23"/>
</map>
</div>

</div>
</div>
<a id="ab6a02fb5fc61b638c0f202f561d42445" name="ab6a02fb5fc61b638c0f202f561d42445"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab6a02fb5fc61b638c0f202f561d42445">&#9670;&#160;</a></span>parse_rsa_template()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CK_RV parse_rsa_template </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="pkcs11_8h.html#a5db3536793782f135785609e4a849fc6">CK_ATTRIBUTE_PTR</a></td>          <td class="paramname"><span class="paramname"><em>pTemplate</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pkcs11_8h.html#a35181858a3b7a0a81f49d180d8f446ef">CK_ULONG</a></td>          <td class="paramname"><span class="paramname"><em>ulCount</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structyubihsm__pkcs11__object__template.html">yubihsm_pkcs11_object_template</a> *</td>          <td class="paramname"><span class="paramname"><em>template</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="util__pkcs11_8c_source.html#l02976">2976</a> of file <a class="el" href="util__pkcs11_8c_source.html">util_pkcs11.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2977</span>                                                                   {</div>
<div class="line"><span class="lineno"> 2978</span> </div>
<div class="line"><span class="lineno"> 2979</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *e = NULL;</div>
<div class="line"><span class="lineno"> 2980</span>  <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> primelen = 0;</div>
<div class="line"><span class="lineno"> 2981</span>  CK_RV <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a>;</div>
<div class="line"><span class="lineno"> 2982</span> </div>
<div class="line"><span class="lineno"> 2983</span>  <span class="keywordflow">for</span> (<a class="code hl_typedef" href="pkcs11_8h.html#a35181858a3b7a0a81f49d180d8f446ef">CK_ULONG</a> i = 0; i &lt; <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a490d37150a3d116225298faf1cb780b6">ulCount</a>; i++) {</div>
<div class="line"><span class="lineno"> 2984</span>    <span class="keywordflow">switch</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa4c2296db6853afc30383aec1a404972">pTemplate</a>[i].type) {</div>
<div class="line"><span class="lineno"> 2985</span> </div>
<div class="line"><span class="lineno"> 2986</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a56db29b456158a6805ee49051715ceca">CKA_PRIME_1</a>:</div>
<div class="line"><span class="lineno"> 2987</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a53ef06e29c840024a683512c1acd791a">template</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__object__template.html#aa7e23493c41030819bd65ab687c604a7">obj</a>.<a class="code hl_variable" href="structyubihsm__pkcs11__object__template.html#a63b0dbd1182e372d6a05a5321fe0bd0e">rsa</a>.p == NULL) {</div>
<div class="line"><span class="lineno"> 2988</span>          <span class="keyword">template</span>-&gt;obj.rsa.p = (<a class="code hl_typedef" href="pkcs11_8h.html#a7bc6919a7c3c372056fa7e18343a0b37">CK_BYTE_PTR</a>) <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa4c2296db6853afc30383aec1a404972">pTemplate</a>[i].pValue;</div>
<div class="line"><span class="lineno"> 2989</span>          <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa4c2296db6853afc30383aec1a404972">pTemplate</a>[i].ulValueLen % 2 != 0) {</div>
<div class="line"><span class="lineno"> 2990</span>            <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa4c2296db6853afc30383aec1a404972">pTemplate</a>[i].ulValueLen--;</div>
<div class="line"><span class="lineno"> 2991</span>            <span class="keyword">template</span>-&gt;obj.rsa.p++;</div>
<div class="line"><span class="lineno"> 2992</span>          }</div>
<div class="line"><span class="lineno"> 2993</span>          <span class="keywordflow">if</span> (primelen == 0 || primelen == <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa4c2296db6853afc30383aec1a404972">pTemplate</a>[i].ulValueLen) {</div>
<div class="line"><span class="lineno"> 2994</span>            primelen = <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa4c2296db6853afc30383aec1a404972">pTemplate</a>[i].ulValueLen;</div>
<div class="line"><span class="lineno"> 2995</span>          } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2996</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a98d78208707bfa2c51d6f051af1794e9">CKR_TEMPLATE_INCONSISTENT</a>;</div>
<div class="line"><span class="lineno"> 2997</span>          }</div>
<div class="line"><span class="lineno"> 2998</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2999</span>          <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a98d78208707bfa2c51d6f051af1794e9">CKR_TEMPLATE_INCONSISTENT</a>;</div>
<div class="line"><span class="lineno"> 3000</span>        }</div>
<div class="line"><span class="lineno"> 3001</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3002</span> </div>
<div class="line"><span class="lineno"> 3003</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a93ab45da1c5f54840b624cccb5cde45a">CKA_PRIME_2</a>:</div>
<div class="line"><span class="lineno"> 3004</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a53ef06e29c840024a683512c1acd791a">template</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__object__template.html#aa7e23493c41030819bd65ab687c604a7">obj</a>.<a class="code hl_variable" href="structyubihsm__pkcs11__object__template.html#a63b0dbd1182e372d6a05a5321fe0bd0e">rsa</a>.q == NULL) {</div>
<div class="line"><span class="lineno"> 3005</span>          <span class="keyword">template</span>-&gt;obj.rsa.q = (<a class="code hl_typedef" href="pkcs11_8h.html#a7bc6919a7c3c372056fa7e18343a0b37">CK_BYTE_PTR</a>) <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa4c2296db6853afc30383aec1a404972">pTemplate</a>[i].pValue;</div>
<div class="line"><span class="lineno"> 3006</span>          <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa4c2296db6853afc30383aec1a404972">pTemplate</a>[i].ulValueLen % 2 != 0) {</div>
<div class="line"><span class="lineno"> 3007</span>            <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa4c2296db6853afc30383aec1a404972">pTemplate</a>[i].ulValueLen--;</div>
<div class="line"><span class="lineno"> 3008</span>            <span class="keyword">template</span>-&gt;obj.rsa.q++;</div>
<div class="line"><span class="lineno"> 3009</span>          }</div>
<div class="line"><span class="lineno"> 3010</span>          <span class="keywordflow">if</span> (primelen == 0 || primelen == <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa4c2296db6853afc30383aec1a404972">pTemplate</a>[i].ulValueLen) {</div>
<div class="line"><span class="lineno"> 3011</span>            primelen = <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa4c2296db6853afc30383aec1a404972">pTemplate</a>[i].ulValueLen;</div>
<div class="line"><span class="lineno"> 3012</span>          } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3013</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a98d78208707bfa2c51d6f051af1794e9">CKR_TEMPLATE_INCONSISTENT</a>;</div>
<div class="line"><span class="lineno"> 3014</span>          }</div>
<div class="line"><span class="lineno"> 3015</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3016</span>          <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a98d78208707bfa2c51d6f051af1794e9">CKR_TEMPLATE_INCONSISTENT</a>;</div>
<div class="line"><span class="lineno"> 3017</span>        }</div>
<div class="line"><span class="lineno"> 3018</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3019</span> </div>
<div class="line"><span class="lineno"> 3020</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a3560a0897e67ea3584c5e5d6b49997a9">CKA_PUBLIC_EXPONENT</a>:</div>
<div class="line"><span class="lineno"> 3021</span>        <span class="keywordflow">if</span> (e == NULL) {</div>
<div class="line"><span class="lineno"> 3022</span>          e = (<a class="code hl_typedef" href="pkcs11_8h.html#a7bc6919a7c3c372056fa7e18343a0b37">CK_BYTE_PTR</a>) <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa4c2296db6853afc30383aec1a404972">pTemplate</a>[i].pValue;</div>
<div class="line"><span class="lineno"> 3023</span>          <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa4c2296db6853afc30383aec1a404972">pTemplate</a>[i].ulValueLen != 3 ||</div>
<div class="line"><span class="lineno"> 3024</span>              memcmp(e, <span class="stringliteral">&quot;\x01\x00\x01&quot;</span>, 3) != 0) {</div>
<div class="line"><span class="lineno"> 3025</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#ab818f05c56d56675438515a7ba5ebb70">CKR_ATTRIBUTE_VALUE_INVALID</a>;</div>
<div class="line"><span class="lineno"> 3026</span>          }</div>
<div class="line"><span class="lineno"> 3027</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3028</span>          <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a98d78208707bfa2c51d6f051af1794e9">CKR_TEMPLATE_INCONSISTENT</a>;</div>
<div class="line"><span class="lineno"> 3029</span>        }</div>
<div class="line"><span class="lineno"> 3030</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3031</span> </div>
<div class="line"><span class="lineno"> 3032</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a6ffd14ad7386d9aa7178e841a964a87e">CKA_SIGN</a>:</div>
<div class="line"><span class="lineno"> 3033</span>        <span class="keywordflow">if</span> ((<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a> = <a class="code hl_function" href="util__pkcs11_8c.html#a03b553175220c8747145497de5032100">set_template_attribute</a>(&amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a53ef06e29c840024a683512c1acd791a">template</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__object__template.html#a10f570d27a0e5b375f3e5e32f09c2c84">sign</a>,</div>
<div class="line"><span class="lineno"> 3034</span>                                         <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa4c2296db6853afc30383aec1a404972">pTemplate</a>[i].pValue)) != <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>) {</div>
<div class="line"><span class="lineno"> 3035</span>          <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a>;</div>
<div class="line"><span class="lineno"> 3036</span>        }</div>
<div class="line"><span class="lineno"> 3037</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3038</span> </div>
<div class="line"><span class="lineno"> 3039</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#aa26224c75961163975e3de4347940401">CKA_DECRYPT</a>:</div>
<div class="line"><span class="lineno"> 3040</span>        <span class="keywordflow">if</span> ((<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a> = <a class="code hl_function" href="util__pkcs11_8c.html#a03b553175220c8747145497de5032100">set_template_attribute</a>(&amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a53ef06e29c840024a683512c1acd791a">template</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__object__template.html#a11816ed4ec4908d99d1fc35935f4bf52">decrypt</a>,</div>
<div class="line"><span class="lineno"> 3041</span>                                         <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa4c2296db6853afc30383aec1a404972">pTemplate</a>[i].pValue)) != <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>) {</div>
<div class="line"><span class="lineno"> 3042</span>          <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a>;</div>
<div class="line"><span class="lineno"> 3043</span>        }</div>
<div class="line"><span class="lineno"> 3044</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3045</span> </div>
<div class="line"><span class="lineno"> 3046</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a05c1c460160443a739c6e0ce47ae3fc8">CKA_TOKEN</a>:</div>
<div class="line"><span class="lineno"> 3047</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a5244a0b0719c79614044460bdcf34d11">CKA_PRIVATE</a>:</div>
<div class="line"><span class="lineno"> 3048</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a5fe5fb4a38ca6781c50e4cba8a2af0d6">CKA_SENSITIVE</a>:</div>
<div class="line"><span class="lineno"> 3049</span>        <span class="keywordflow">if</span> ((<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a> = check_bool_attribute(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa4c2296db6853afc30383aec1a404972">pTemplate</a>[i].pValue, <span class="keyword">true</span>)) != <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>) {</div>
<div class="line"><span class="lineno"> 3050</span>          <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a>;</div>
<div class="line"><span class="lineno"> 3051</span>        }</div>
<div class="line"><span class="lineno"> 3052</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3053</span> </div>
<div class="line"><span class="lineno"> 3054</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a505044b8a4656ed27cf95f5f43c2c0c0">CKA_MODULUS</a>:</div>
<div class="line"><span class="lineno"> 3055</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a24dbc6c47c74f94256e9a86b047a44c8">CKA_PRIVATE_EXPONENT</a>:</div>
<div class="line"><span class="lineno"> 3056</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a6c8501b0588f7ce31f993d75928b8f79">CKA_EXPONENT_1</a>:</div>
<div class="line"><span class="lineno"> 3057</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a750faa17ba348fd5f5a8594b849eaaa5">CKA_EXPONENT_2</a>:</div>
<div class="line"><span class="lineno"> 3058</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ab17da8a57cccda55b7f6b8be7b8d5aca">CKA_COEFFICIENT</a>:</div>
<div class="line"><span class="lineno"> 3059</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#af867d3ae9286fe0f8cab4995bb6af337">CKA_CLASS</a>:</div>
<div class="line"><span class="lineno"> 3060</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#aa438b88cbcb8a921288eeefba5613274">CKA_KEY_TYPE</a>:</div>
<div class="line"><span class="lineno"> 3061</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#afef7cb3cf999a4ea9962e780c3e6e1cf">CKA_SUBJECT</a>:</div>
<div class="line"><span class="lineno"> 3062</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a2846a5a41835defa47716ccc3bcc4913">CKA_ID</a>:</div>
<div class="line"><span class="lineno"> 3063</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#acf009a991c04b5c4305cc76356225aa7">CKA_LABEL</a>:</div>
<div class="line"><span class="lineno"> 3064</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#acf37955a2a229d208289962c6f1183b8">CKA_EXTRACTABLE</a>:</div>
<div class="line"><span class="lineno"> 3065</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3066</span> </div>
<div class="line"><span class="lineno"> 3067</span>      <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 3068</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a0afbefc1a4ce05ba5faea1778eb602ca">CKR_ATTRIBUTE_TYPE_INVALID</a>;</div>
<div class="line"><span class="lineno"> 3069</span>    }</div>
<div class="line"><span class="lineno"> 3070</span>  }</div>
<div class="line"><span class="lineno"> 3071</span>  <span class="keywordflow">if</span> (e &amp;&amp; <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a53ef06e29c840024a683512c1acd791a">template</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__object__template.html#aa7e23493c41030819bd65ab687c604a7">obj</a>.<a class="code hl_variable" href="structyubihsm__pkcs11__object__template.html#a63b0dbd1182e372d6a05a5321fe0bd0e">rsa</a>.p &amp;&amp; <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a53ef06e29c840024a683512c1acd791a">template</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__object__template.html#aa7e23493c41030819bd65ab687c604a7">obj</a>.<a class="code hl_variable" href="structyubihsm__pkcs11__object__template.html#a63b0dbd1182e372d6a05a5321fe0bd0e">rsa</a>.q) {</div>
<div class="line"><span class="lineno"> 3072</span>    <span class="keyword">template</span>-&gt;objlen = primelen;</div>
<div class="line"><span class="lineno"> 3073</span>    <span class="keywordflow">switch</span> (primelen) {</div>
<div class="line"><span class="lineno"> 3074</span>      <span class="keywordflow">case</span> 128:</div>
<div class="line"><span class="lineno"> 3075</span>        <span class="keyword">template</span>-&gt;algorithm = <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caaafe94e6a770edb51c6db84f77d98d2c6">YH_ALGO_RSA_2048</a>;</div>
<div class="line"><span class="lineno"> 3076</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3077</span>      <span class="keywordflow">case</span> 192:</div>
<div class="line"><span class="lineno"> 3078</span>        <span class="keyword">template</span>-&gt;algorithm = <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caafd3fbd9ed86caf267ccc77cb24d44426">YH_ALGO_RSA_3072</a>;</div>
<div class="line"><span class="lineno"> 3079</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3080</span>      <span class="keywordflow">case</span> 256:</div>
<div class="line"><span class="lineno"> 3081</span>        <span class="keyword">template</span>-&gt;algorithm = <a class="code hl_enumvalue" href="yubihsm_8h.html#a498937b5a72accbb0ef21bb1dcdd55caae5963322a0a0f43a1b74faa78e3a7329">YH_ALGO_RSA_4096</a>;</div>
<div class="line"><span class="lineno"> 3082</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3083</span>      <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 3084</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#ab818f05c56d56675438515a7ba5ebb70">CKR_ATTRIBUTE_VALUE_INVALID</a>;</div>
<div class="line"><span class="lineno"> 3085</span>    }</div>
<div class="line"><span class="lineno"> 3086</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3087</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a98d78208707bfa2c51d6f051af1794e9">CKR_TEMPLATE_INCONSISTENT</a>;</div>
<div class="line"><span class="lineno"> 3088</span>  }</div>
<div class="line"><span class="lineno"> 3089</span> </div>
<div class="line"><span class="lineno"> 3090</span>  <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>;</div>
<div class="line"><span class="lineno"> 3091</span>}</div>
<div class="ttc" id="apkcs11_8h_html_a24dbc6c47c74f94256e9a86b047a44c8"><div class="ttname"><a href="pkcs11_8h.html#a24dbc6c47c74f94256e9a86b047a44c8">CKA_PRIVATE_EXPONENT</a></div><div class="ttdeci">#define CKA_PRIVATE_EXPONENT</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00401">pkcs11.h:401</a></div></div>
<div class="ttc" id="apkcs11_8h_html_a505044b8a4656ed27cf95f5f43c2c0c0"><div class="ttname"><a href="pkcs11_8h.html#a505044b8a4656ed27cf95f5f43c2c0c0">CKA_MODULUS</a></div><div class="ttdeci">#define CKA_MODULUS</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00398">pkcs11.h:398</a></div></div>
<div class="ttc" id="apkcs11_8h_html_a56db29b456158a6805ee49051715ceca"><div class="ttname"><a href="pkcs11_8h.html#a56db29b456158a6805ee49051715ceca">CKA_PRIME_1</a></div><div class="ttdeci">#define CKA_PRIME_1</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00402">pkcs11.h:402</a></div></div>
<div class="ttc" id="apkcs11_8h_html_a6c8501b0588f7ce31f993d75928b8f79"><div class="ttname"><a href="pkcs11_8h.html#a6c8501b0588f7ce31f993d75928b8f79">CKA_EXPONENT_1</a></div><div class="ttdeci">#define CKA_EXPONENT_1</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00404">pkcs11.h:404</a></div></div>
<div class="ttc" id="apkcs11_8h_html_a750faa17ba348fd5f5a8594b849eaaa5"><div class="ttname"><a href="pkcs11_8h.html#a750faa17ba348fd5f5a8594b849eaaa5">CKA_EXPONENT_2</a></div><div class="ttdeci">#define CKA_EXPONENT_2</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00405">pkcs11.h:405</a></div></div>
<div class="ttc" id="apkcs11_8h_html_a93ab45da1c5f54840b624cccb5cde45a"><div class="ttname"><a href="pkcs11_8h.html#a93ab45da1c5f54840b624cccb5cde45a">CKA_PRIME_2</a></div><div class="ttdeci">#define CKA_PRIME_2</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00403">pkcs11.h:403</a></div></div>
<div class="ttc" id="apkcs11_8h_html_ab17da8a57cccda55b7f6b8be7b8d5aca"><div class="ttname"><a href="pkcs11_8h.html#ab17da8a57cccda55b7f6b8be7b8d5aca">CKA_COEFFICIENT</a></div><div class="ttdeci">#define CKA_COEFFICIENT</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l00406">pkcs11.h:406</a></div></div>
<div class="ttc" id="astructyubihsm__pkcs11__object__template_html_a63b0dbd1182e372d6a05a5321fe0bd0e"><div class="ttname"><a href="structyubihsm__pkcs11__object__template.html#a63b0dbd1182e372d6a05a5321fe0bd0e">yubihsm_pkcs11_object_template::rsa</a></div><div class="ttdeci">struct yubihsm_pkcs11_object_template::@114::@115 rsa</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util__pkcs11_8h_ab6a02fb5fc61b638c0f202f561d42445_cgraph.png" border="0" usemap="#autil__pkcs11_8h_ab6a02fb5fc61b638c0f202f561d42445_cgraph" alt=""/></div>
<map name="autil__pkcs11_8h_ab6a02fb5fc61b638c0f202f561d42445_cgraph" id="autil__pkcs11_8h_ab6a02fb5fc61b638c0f202f561d42445_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,141,31"/>
<area shape="rect" href="util__pkcs11_8c.html#a03b553175220c8747145497de5032100" title=" " alt="" coords="189,5,339,31"/>
<area shape="poly" title=" " alt="" coords="141,16,173,16,173,21,141,21"/>
</map>
</div>

</div>
</div>
<a id="a63b36e79f7eb240fe1de611008509389" name="a63b36e79f7eb240fe1de611008509389"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63b36e79f7eb240fe1de611008509389">&#9670;&#160;</a></span>parse_wrap_template()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CK_RV parse_wrap_template </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="pkcs11_8h.html#a5db3536793782f135785609e4a849fc6">CK_ATTRIBUTE_PTR</a></td>          <td class="paramname"><span class="paramname"><em>pTemplate</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pkcs11_8h.html#a35181858a3b7a0a81f49d180d8f446ef">CK_ULONG</a></td>          <td class="paramname"><span class="paramname"><em>ulCount</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structyubihsm__pkcs11__object__template.html">yubihsm_pkcs11_object_template</a> *</td>          <td class="paramname"><span class="paramname"><em>template</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>generate</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="util__pkcs11_8c_source.html#l03801">3801</a> of file <a class="el" href="util__pkcs11_8c_source.html">util_pkcs11.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3803</span>                                         {</div>
<div class="line"><span class="lineno"> 3804</span> </div>
<div class="line"><span class="lineno"> 3805</span>  CK_RV <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a>;</div>
<div class="line"><span class="lineno"> 3806</span> </div>
<div class="line"><span class="lineno"> 3807</span>  <span class="keywordflow">for</span> (<a class="code hl_typedef" href="pkcs11_8h.html#a35181858a3b7a0a81f49d180d8f446ef">CK_ULONG</a> i = 0; i &lt; <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a490d37150a3d116225298faf1cb780b6">ulCount</a>; i++) {</div>
<div class="line"><span class="lineno"> 3808</span>    <span class="keywordflow">switch</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa4c2296db6853afc30383aec1a404972">pTemplate</a>[i].type) {</div>
<div class="line"><span class="lineno"> 3809</span> </div>
<div class="line"><span class="lineno"> 3810</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a799f3b28e5c856ef4229d12257818841">CKA_VALUE</a>:</div>
<div class="line"><span class="lineno"> 3811</span>        <span class="keywordflow">if</span> (generate == <span class="keyword">false</span> &amp;&amp; <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a53ef06e29c840024a683512c1acd791a">template</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__object__template.html#aa7e23493c41030819bd65ab687c604a7">obj</a>.<a class="code hl_variable" href="structyubihsm__pkcs11__object__template.html#acbc6f8ad9110ca09d862eaf06691897b">buf</a> == NULL) {</div>
<div class="line"><span class="lineno"> 3812</span>          <span class="keyword">template</span>-&gt;obj.buf = (<a class="code hl_typedef" href="pkcs11_8h.html#a7bc6919a7c3c372056fa7e18343a0b37">CK_BYTE_PTR</a>) <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa4c2296db6853afc30383aec1a404972">pTemplate</a>[i].pValue;</div>
<div class="line"><span class="lineno"> 3813</span>          <span class="keyword">template</span>-&gt;objlen = <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa4c2296db6853afc30383aec1a404972">pTemplate</a>[i].ulValueLen;</div>
<div class="line"><span class="lineno"> 3814</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3815</span>          <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a98d78208707bfa2c51d6f051af1794e9">CKR_TEMPLATE_INCONSISTENT</a>;</div>
<div class="line"><span class="lineno"> 3816</span>        }</div>
<div class="line"><span class="lineno"> 3817</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3818</span> </div>
<div class="line"><span class="lineno"> 3819</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#af7a34bb656aa7e2b7e813dab0a6ac7b7">CKA_WRAP</a>:</div>
<div class="line"><span class="lineno"> 3820</span>        <span class="keywordflow">if</span> ((<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a> = <a class="code hl_function" href="util__pkcs11_8c.html#a03b553175220c8747145497de5032100">set_template_attribute</a>(&amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a53ef06e29c840024a683512c1acd791a">template</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__object__template.html#a139e6333451b0bd3b6ab6f347c3ecede">wrap</a>,</div>
<div class="line"><span class="lineno"> 3821</span>                                         <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa4c2296db6853afc30383aec1a404972">pTemplate</a>[i].pValue)) != <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>) {</div>
<div class="line"><span class="lineno"> 3822</span>          <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a>;</div>
<div class="line"><span class="lineno"> 3823</span>        }</div>
<div class="line"><span class="lineno"> 3824</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3825</span> </div>
<div class="line"><span class="lineno"> 3826</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a9a9a988131e4e93d0758e43c555bdc97">CKA_UNWRAP</a>:</div>
<div class="line"><span class="lineno"> 3827</span>        <span class="keywordflow">if</span> ((<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a> = <a class="code hl_function" href="util__pkcs11_8c.html#a03b553175220c8747145497de5032100">set_template_attribute</a>(&amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a53ef06e29c840024a683512c1acd791a">template</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__object__template.html#ab25f77df8d63b4e988b4b3cc6daa973c">unwrap</a>,</div>
<div class="line"><span class="lineno"> 3828</span>                                         <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa4c2296db6853afc30383aec1a404972">pTemplate</a>[i].pValue)) != <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>) {</div>
<div class="line"><span class="lineno"> 3829</span>          <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a>;</div>
<div class="line"><span class="lineno"> 3830</span>        }</div>
<div class="line"><span class="lineno"> 3831</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3832</span> </div>
<div class="line"><span class="lineno"> 3833</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#ad427016a08d7b8f0d8fe910b907e9b44">CKA_ENCRYPT</a>:</div>
<div class="line"><span class="lineno"> 3834</span>        <span class="keywordflow">if</span> ((<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a> = <a class="code hl_function" href="util__pkcs11_8c.html#a03b553175220c8747145497de5032100">set_template_attribute</a>(&amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a53ef06e29c840024a683512c1acd791a">template</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__object__template.html#a9a386dfe41e927efc0796adcfdcda5a7">encrypt</a>,</div>
<div class="line"><span class="lineno"> 3835</span>                                         <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa4c2296db6853afc30383aec1a404972">pTemplate</a>[i].pValue)) != <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>) {</div>
<div class="line"><span class="lineno"> 3836</span>          <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a>;</div>
<div class="line"><span class="lineno"> 3837</span>        }</div>
<div class="line"><span class="lineno"> 3838</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3839</span> </div>
<div class="line"><span class="lineno"> 3840</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#aa26224c75961163975e3de4347940401">CKA_DECRYPT</a>:</div>
<div class="line"><span class="lineno"> 3841</span>        <span class="keywordflow">if</span> ((<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a> = <a class="code hl_function" href="util__pkcs11_8c.html#a03b553175220c8747145497de5032100">set_template_attribute</a>(&amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a53ef06e29c840024a683512c1acd791a">template</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__object__template.html#a11816ed4ec4908d99d1fc35935f4bf52">decrypt</a>,</div>
<div class="line"><span class="lineno"> 3842</span>                                         <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa4c2296db6853afc30383aec1a404972">pTemplate</a>[i].pValue)) != <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>) {</div>
<div class="line"><span class="lineno"> 3843</span>          <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a>;</div>
<div class="line"><span class="lineno"> 3844</span>        }</div>
<div class="line"><span class="lineno"> 3845</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3846</span> </div>
<div class="line"><span class="lineno"> 3847</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a05c1c460160443a739c6e0ce47ae3fc8">CKA_TOKEN</a>:</div>
<div class="line"><span class="lineno"> 3848</span>        <span class="keywordflow">if</span> ((<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a> = check_bool_attribute(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa4c2296db6853afc30383aec1a404972">pTemplate</a>[i].pValue, <span class="keyword">true</span>)) != <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>) {</div>
<div class="line"><span class="lineno"> 3849</span>          <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a>;</div>
<div class="line"><span class="lineno"> 3850</span>        }</div>
<div class="line"><span class="lineno"> 3851</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3852</span> </div>
<div class="line"><span class="lineno"> 3853</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#aa438b88cbcb8a921288eeefba5613274">CKA_KEY_TYPE</a>:</div>
<div class="line"><span class="lineno"> 3854</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#af867d3ae9286fe0f8cab4995bb6af337">CKA_CLASS</a>:</div>
<div class="line"><span class="lineno"> 3855</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#afef7cb3cf999a4ea9962e780c3e6e1cf">CKA_SUBJECT</a>:</div>
<div class="line"><span class="lineno"> 3856</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a2846a5a41835defa47716ccc3bcc4913">CKA_ID</a>:</div>
<div class="line"><span class="lineno"> 3857</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#acf009a991c04b5c4305cc76356225aa7">CKA_LABEL</a>:</div>
<div class="line"><span class="lineno"> 3858</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#acf37955a2a229d208289962c6f1183b8">CKA_EXTRACTABLE</a>:</div>
<div class="line"><span class="lineno"> 3859</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3860</span> </div>
<div class="line"><span class="lineno"> 3861</span>      <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 3862</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a0afbefc1a4ce05ba5faea1778eb602ca">CKR_ATTRIBUTE_TYPE_INVALID</a>;</div>
<div class="line"><span class="lineno"> 3863</span>    }</div>
<div class="line"><span class="lineno"> 3864</span>  }</div>
<div class="line"><span class="lineno"> 3865</span>  <span class="keywordflow">if</span> (generate == <span class="keyword">true</span> || <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a53ef06e29c840024a683512c1acd791a">template</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__object__template.html#aa7e23493c41030819bd65ab687c604a7">obj</a>.<a class="code hl_variable" href="structyubihsm__pkcs11__object__template.html#acbc6f8ad9110ca09d862eaf06691897b">buf</a>) {</div>
<div class="line"><span class="lineno"> 3866</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>;</div>
<div class="line"><span class="lineno"> 3867</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3868</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a98d78208707bfa2c51d6f051af1794e9">CKR_TEMPLATE_INCONSISTENT</a>;</div>
<div class="line"><span class="lineno"> 3869</span>  }</div>
<div class="line"><span class="lineno"> 3870</span>}</div>
<div class="ttc" id="astructyubihsm__pkcs11__object__template_html_a139e6333451b0bd3b6ab6f347c3ecede"><div class="ttname"><a href="structyubihsm__pkcs11__object__template.html#a139e6333451b0bd3b6ab6f347c3ecede">yubihsm_pkcs11_object_template::wrap</a></div><div class="ttdeci">yubihsm_pkcs11_attribute wrap</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8h_source.html#l00187">yubihsm_pkcs11.h:187</a></div></div>
<div class="ttc" id="astructyubihsm__pkcs11__object__template_html_a9a386dfe41e927efc0796adcfdcda5a7"><div class="ttname"><a href="structyubihsm__pkcs11__object__template.html#a9a386dfe41e927efc0796adcfdcda5a7">yubihsm_pkcs11_object_template::encrypt</a></div><div class="ttdeci">yubihsm_pkcs11_attribute encrypt</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8h_source.html#l00182">yubihsm_pkcs11.h:182</a></div></div>
<div class="ttc" id="astructyubihsm__pkcs11__object__template_html_ab25f77df8d63b4e988b4b3cc6daa973c"><div class="ttname"><a href="structyubihsm__pkcs11__object__template.html#ab25f77df8d63b4e988b4b3cc6daa973c">yubihsm_pkcs11_object_template::unwrap</a></div><div class="ttdeci">yubihsm_pkcs11_attribute unwrap</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8h_source.html#l00188">yubihsm_pkcs11.h:188</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util__pkcs11_8h_a63b36e79f7eb240fe1de611008509389_cgraph.png" border="0" usemap="#autil__pkcs11_8h_a63b36e79f7eb240fe1de611008509389_cgraph" alt=""/></div>
<map name="autil__pkcs11_8h_a63b36e79f7eb240fe1de611008509389_cgraph" id="autil__pkcs11_8h_a63b36e79f7eb240fe1de611008509389_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,151,31"/>
<area shape="rect" href="util__pkcs11_8c.html#a03b553175220c8747145497de5032100" title=" " alt="" coords="199,5,349,31"/>
<area shape="poly" title=" " alt="" coords="151,16,183,16,183,21,151,21"/>
</map>
</div>

</div>
</div>
<a id="a9a4b5890a6a8d01800fdb68e1935ae05" name="a9a4b5890a6a8d01800fdb68e1935ae05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a4b5890a6a8d01800fdb68e1935ae05">&#9670;&#160;</a></span>perform_decrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CK_RV perform_decrypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__session.html">yh_session</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structyubihsm__pkcs11__op__info.html">yubihsm_pkcs11_op_info</a> *</td>          <td class="paramname"><span class="paramname"><em>op_info</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>ciphertext</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *</td>          <td class="paramname"><span class="paramname"><em>ciphertext_len</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="util__pkcs11_8c_source.html#l02463">2463</a> of file <a class="el" href="util__pkcs11_8c_source.html">util_pkcs11.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2464</span>                                                         {</div>
<div class="line"><span class="lineno"> 2465</span> </div>
<div class="line"><span class="lineno"> 2466</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 2467</span>  <span class="keywordtype">size_t</span> outlen = <span class="keyword">sizeof</span>(op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ad4fd174ba5f77aad7e1f1c66079529ba">buffer</a>);</div>
<div class="line"><span class="lineno"> 2468</span> </div>
<div class="line"><span class="lineno"> 2469</span>  <span class="keywordflow">if</span> (op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a261664672f3ef63ab3a20b864627c49a">mechanism</a>.<a class="code hl_variable" href="structmechanism.html#afeb8198b0f33f94f4520c0ffbc584a9a">mechanism</a> == <a class="code hl_define" href="pkcs11_8h.html#a08a8e0f2109de3ff3bfe26f220447a2e">CKM_RSA_PKCS</a>) {</div>
<div class="line"><span class="lineno"> 2470</span>    <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#a5ebf6932cd2e68b9a23787c27fde3e26">yh_util_decrypt_pkcs1v1_5</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#a511016f53f468cbe53728403a03df05a">decrypt</a>.<a class="code hl_variable" href="structdecrypt__info.html#aabd5d6d63519e0dbd40321bf2d201afa">key_id</a>,</div>
<div class="line"><span class="lineno"> 2471</span>                                    op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ad4fd174ba5f77aad7e1f1c66079529ba">buffer</a>, op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ac226105a253c6fda70b44e14a525007a">buffer_length</a>,</div>
<div class="line"><span class="lineno"> 2472</span>                                    op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ad4fd174ba5f77aad7e1f1c66079529ba">buffer</a>, &amp;outlen);</div>
<div class="line"><span class="lineno"> 2473</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a261664672f3ef63ab3a20b864627c49a">mechanism</a>.<a class="code hl_variable" href="structmechanism.html#afeb8198b0f33f94f4520c0ffbc584a9a">mechanism</a> == <a class="code hl_define" href="pkcs11_8h.html#a69da8859ad1e6b4f424d071b42ea4a0c">CKM_RSA_PKCS_OAEP</a>) {</div>
<div class="line"><span class="lineno"> 2474</span>    <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> =</div>
<div class="line"><span class="lineno"> 2475</span>      <a class="code hl_function" href="yubihsm_8c.html#aa939f8764ed0cca27884d9c8f640ac14">yh_util_decrypt_oaep</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#a511016f53f468cbe53728403a03df05a">decrypt</a>.<a class="code hl_variable" href="structdecrypt__info.html#aabd5d6d63519e0dbd40321bf2d201afa">key_id</a>, op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ad4fd174ba5f77aad7e1f1c66079529ba">buffer</a>,</div>
<div class="line"><span class="lineno"> 2476</span>                           op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ac226105a253c6fda70b44e14a525007a">buffer_length</a>, op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ad4fd174ba5f77aad7e1f1c66079529ba">buffer</a>, &amp;outlen,</div>
<div class="line"><span class="lineno"> 2477</span>                           op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a261664672f3ef63ab3a20b864627c49a">mechanism</a>.<a class="code hl_variable" href="structmechanism.html#a8b470fe3b4b86e373f85264f1d2df962">oaep</a>.label,</div>
<div class="line"><span class="lineno"> 2478</span>                           op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a261664672f3ef63ab3a20b864627c49a">mechanism</a>.<a class="code hl_variable" href="structmechanism.html#a8b470fe3b4b86e373f85264f1d2df962">oaep</a>.label_len,</div>
<div class="line"><span class="lineno"> 2479</span>                           op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a261664672f3ef63ab3a20b864627c49a">mechanism</a>.<a class="code hl_variable" href="structmechanism.html#a8b470fe3b4b86e373f85264f1d2df962">oaep</a>.mgf1Algo);</div>
<div class="line"><span class="lineno"> 2480</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a261664672f3ef63ab3a20b864627c49a">mechanism</a>.<a class="code hl_variable" href="structmechanism.html#afeb8198b0f33f94f4520c0ffbc584a9a">mechanism</a> == <a class="code hl_define" href="pkcs11y_8h.html#a631efbda997696a7f7ce71df0e3e779a">CKM_YUBICO_AES_CCM_WRAP</a>) {</div>
<div class="line"><span class="lineno"> 2481</span>    <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> =</div>
<div class="line"><span class="lineno"> 2482</span>      <a class="code hl_function" href="yubihsm_8c.html#a550567a0f56d8536b9b5f34e905da7ec">yh_util_unwrap_data</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#a511016f53f468cbe53728403a03df05a">decrypt</a>.<a class="code hl_variable" href="structdecrypt__info.html#aabd5d6d63519e0dbd40321bf2d201afa">key_id</a>, op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ad4fd174ba5f77aad7e1f1c66079529ba">buffer</a>,</div>
<div class="line"><span class="lineno"> 2483</span>                          op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ac226105a253c6fda70b44e14a525007a">buffer_length</a>, op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ad4fd174ba5f77aad7e1f1c66079529ba">buffer</a>, &amp;outlen);</div>
<div class="line"><span class="lineno"> 2484</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2485</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Mechanism %lu not supported&quot;</span>, op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a261664672f3ef63ab3a20b864627c49a">mechanism</a>.<a class="code hl_variable" href="structmechanism.html#afeb8198b0f33f94f4520c0ffbc584a9a">mechanism</a>);</div>
<div class="line"><span class="lineno"> 2486</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a0664e99597a479c7fce5b19411cfc1b1">CKR_MECHANISM_INVALID</a>;</div>
<div class="line"><span class="lineno"> 2487</span>  }</div>
<div class="line"><span class="lineno"> 2488</span> </div>
<div class="line"><span class="lineno"> 2489</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 2490</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Decryption failed: %s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>));</div>
<div class="line"><span class="lineno"> 2491</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a91150ecacbaa624fcc7d861f1b54f57c">CKR_FUNCTION_FAILED</a>;</div>
<div class="line"><span class="lineno"> 2492</span>  }</div>
<div class="line"><span class="lineno"> 2493</span> </div>
<div class="line"><span class="lineno"> 2494</span>  <span class="keywordflow">if</span> (outlen &gt; *data_len) {</div>
<div class="line"><span class="lineno"> 2495</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Data won&#39;t fit in buffer %zu &gt; %d&quot;</span>, outlen, *data_len);</div>
<div class="line"><span class="lineno"> 2496</span>    *data_len = outlen;</div>
<div class="line"><span class="lineno"> 2497</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a9f2ea08f0e13c3fc129863fdd46352b6">CKR_BUFFER_TOO_SMALL</a>;</div>
<div class="line"><span class="lineno"> 2498</span>  }</div>
<div class="line"><span class="lineno"> 2499</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(data, op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ad4fd174ba5f77aad7e1f1c66079529ba">buffer</a>, outlen);</div>
<div class="line"><span class="lineno"> 2500</span>  *data_len = outlen;</div>
<div class="line"><span class="lineno"> 2501</span> </div>
<div class="line"><span class="lineno"> 2502</span>  <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>;</div>
<div class="line"><span class="lineno"> 2503</span>}</div>
<div class="ttc" id="alib_2error_8c_html_a238eedb1e27dbff2a0ab9a3932eb3f8b"><div class="ttname"><a href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a></div><div class="ttdeci">const char * yh_strerror(yh_rc err)</div><div class="ttdef"><b>Definition</b> <a href="lib_2error_8c_source.html#l00065">error.c:65</a></div></div>
<div class="ttc" id="astructdecrypt__info_html_aabd5d6d63519e0dbd40321bf2d201afa"><div class="ttname"><a href="structdecrypt__info.html#aabd5d6d63519e0dbd40321bf2d201afa">decrypt_info::key_id</a></div><div class="ttdeci">uint16_t key_id</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8h_source.html#l00079">yubihsm_pkcs11.h:79</a></div></div>
<div class="ttc" id="astructmechanism_html_a8b470fe3b4b86e373f85264f1d2df962"><div class="ttname"><a href="structmechanism.html#a8b470fe3b4b86e373f85264f1d2df962">mechanism::oaep</a></div><div class="ttdeci">struct mechanism::@110::@112 oaep</div></div>
<div class="ttc" id="ayubihsm_8c_html_a550567a0f56d8536b9b5f34e905da7ec"><div class="ttname"><a href="yubihsm_8c.html#a550567a0f56d8536b9b5f34e905da7ec">yh_util_unwrap_data</a></div><div class="ttdeci">yh_rc yh_util_unwrap_data(yh_session *session, uint16_t key_id, const uint8_t *in, size_t in_len, uint8_t *out, size_t *out_len)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l03716">yubihsm.c:3716</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_a5ebf6932cd2e68b9a23787c27fde3e26"><div class="ttname"><a href="yubihsm_8c.html#a5ebf6932cd2e68b9a23787c27fde3e26">yh_util_decrypt_pkcs1v1_5</a></div><div class="ttdeci">yh_rc yh_util_decrypt_pkcs1v1_5(yh_session *session, uint16_t key_id, const uint8_t *in, size_t in_len, uint8_t *out, size_t *out_len)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l02059">yubihsm.c:2059</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_aa939f8764ed0cca27884d9c8f640ac14"><div class="ttname"><a href="yubihsm_8c.html#aa939f8764ed0cca27884d9c8f640ac14">yh_util_decrypt_oaep</a></div><div class="ttdeci">yh_rc yh_util_decrypt_oaep(yh_session *session, uint16_t key_id, const uint8_t *in, size_t in_len, uint8_t *out, size_t *out_len, const uint8_t *label, size_t label_len, yh_algorithm mgf1Algo)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l02107">yubihsm.c:2107</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util__pkcs11_8h_a9a4b5890a6a8d01800fdb68e1935ae05_cgraph.png" border="0" usemap="#autil__pkcs11_8h_a9a4b5890a6a8d01800fdb68e1935ae05_cgraph" alt=""/></div>
<map name="autil__pkcs11_8h_a9a4b5890a6a8d01800fdb68e1935ae05_cgraph" id="autil__pkcs11_8h_a9a4b5890a6a8d01800fdb68e1935ae05_cgraph">
<area shape="rect" title=" " alt="" coords="5,208,121,234"/>
<area shape="rect" href="structmechanism.html#afeb8198b0f33f94f4520c0ffbc584a9a" title=" " alt="" coords="177,5,340,31"/>
<area shape="poly" title=" " alt="" coords="66,207,79,175,100,132,130,87,167,48,187,35,190,40,170,52,134,91,105,135,84,177,71,209"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="822,184,893,210"/>
<area shape="poly" title=" " alt="" coords="80,205,119,179,168,156,329,105,397,90,462,83,527,83,595,90,671,106,759,130,798,148,831,172,828,176,796,153,757,135,670,111,594,96,526,88,462,88,398,96,331,110,170,161,121,184,83,210"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="816,385,899,411"/>
<area shape="poly" title=" " alt="" coords="76,232,121,285,194,357,238,395,288,430,341,459,397,481,462,486,579,487,695,484,757,478,779,467,800,453,834,421,838,425,803,457,782,472,758,483,695,489,579,492,462,491,395,486,339,464,285,434,235,399,190,361,117,288,72,236"/>
<area shape="rect" href="yubihsm_8c.html#aa939f8764ed0cca27884d9c8f640ac14" title=" " alt="" coords="186,171,330,196"/>
<area shape="poly" title=" " alt="" coords="121,207,172,197,173,203,122,212"/>
<area shape="rect" href="yubihsm_8c.html#a5ebf6932cd2e68b9a23787c27fde3e26" title=" " alt="" coords="169,233,348,259"/>
<area shape="poly" title=" " alt="" coords="121,226,153,230,153,235,121,231"/>
<area shape="rect" href="yubihsm_8c.html#a550567a0f56d8536b9b5f34e905da7ec" title=" " alt="" coords="188,296,328,322"/>
<area shape="poly" title=" " alt="" coords="92,232,170,269,211,287,209,292,168,274,90,237"/>
<area shape="poly" title=" " alt="" coords="305,167,396,149,584,146,758,150,791,160,821,174,819,179,789,165,757,155,584,152,396,154,306,173"/>
<area shape="poly" title=" " alt="" coords="313,194,424,232,487,260,546,295,561,308,570,322,579,334,594,345,645,367,700,382,753,391,800,395,800,400,753,396,699,387,644,372,591,350,575,338,566,325,557,312,543,299,484,265,422,237,311,200"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="396,309,544,335"/>
<area shape="poly" title=" " alt="" coords="299,195,349,219,403,258,447,296,443,300,400,262,347,223,297,199"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="592,309,758,335"/>
<area shape="poly" title=" " alt="" coords="544,320,577,320,577,325,544,325"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="610,260,740,286"/>
<area shape="poly" title=" " alt="" coords="526,306,603,287,604,293,527,311"/>
<area shape="poly" title=" " alt="" coords="735,306,756,296,771,285,781,273,804,246,830,219,834,223,808,249,786,277,775,289,759,300,737,311"/>
<area shape="poly" title=" " alt="" coords="712,333,759,352,814,376,812,381,757,357,710,338"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="823,309,892,335"/>
<area shape="poly" title=" " alt="" coords="758,320,808,320,808,325,758,325"/>
<area shape="poly" title=" " alt="" coords="710,257,757,238,812,214,814,219,759,243,712,262"/>
<area shape="poly" title=" " alt="" coords="737,284,759,295,775,306,786,318,808,346,834,372,830,376,804,349,781,322,771,310,756,299,735,289"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="806,260,909,286"/>
<area shape="poly" title=" " alt="" coords="741,270,790,270,790,276,741,276"/>
<area shape="poly" title=" " alt="" coords="345,230,462,214,592,201,707,195,806,194,806,199,707,201,593,206,463,219,346,235"/>
<area shape="poly" title=" " alt="" coords="305,257,328,268,350,281,365,299,374,315,382,331,398,345,447,371,500,390,555,402,611,409,716,411,800,404,800,410,716,417,610,415,554,408,498,395,445,376,394,350,378,334,369,318,361,302,346,286,325,272,303,262"/>
<area shape="poly" title=" " alt="" coords="297,257,419,301,417,306,296,262"/>
<area shape="poly" title=" " alt="" coords="328,293,806,204,807,209,329,298"/>
<area shape="poly" title=" " alt="" coords="270,320,289,348,318,382,354,415,397,440,449,458,494,470,535,475,573,475,655,462,757,440,789,430,819,416,821,421,791,435,758,445,656,467,574,480,534,480,493,475,447,464,395,445,351,419,314,385,285,351,266,324"/>
<area shape="poly" title=" " alt="" coords="329,311,381,314,380,319,329,316"/>
</map>
</div>

</div>
</div>
<a id="a302f2929b31dff615158d284b2f56e79" name="a302f2929b31dff615158d284b2f56e79"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a302f2929b31dff615158d284b2f56e79">&#9670;&#160;</a></span>perform_digest()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CK_RV perform_digest </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__pkcs11__op__info.html">yubihsm_pkcs11_op_info</a> *</td>          <td class="paramname"><span class="paramname"><em>op_info</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>digest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *</td>          <td class="paramname"><span class="paramname"><em>digest_len</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="util__pkcs11_8c_source.html#l02533">2533</a> of file <a class="el" href="util__pkcs11_8c_source.html">util_pkcs11.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2534</span>                                           {</div>
<div class="line"><span class="lineno"> 2535</span> </div>
<div class="line"><span class="lineno"> 2536</span>  <span class="keywordflow">if</span> (op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ac226105a253c6fda70b44e14a525007a">buffer_length</a> &gt; *<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa7984cb33ffce49c6276aa9cd928a5a6">digest_len</a>) {</div>
<div class="line"><span class="lineno"> 2537</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a9f2ea08f0e13c3fc129863fdd46352b6">CKR_BUFFER_TOO_SMALL</a>;</div>
<div class="line"><span class="lineno"> 2538</span>  }</div>
<div class="line"><span class="lineno"> 2539</span> </div>
<div class="line"><span class="lineno"> 2540</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(digest, op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ad4fd174ba5f77aad7e1f1c66079529ba">buffer</a>, op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ac226105a253c6fda70b44e14a525007a">buffer_length</a>);</div>
<div class="line"><span class="lineno"> 2541</span>  *<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa7984cb33ffce49c6276aa9cd928a5a6">digest_len</a> = op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ac226105a253c6fda70b44e14a525007a">buffer_length</a>;</div>
<div class="line"><span class="lineno"> 2542</span> </div>
<div class="line"><span class="lineno"> 2543</span>  <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>;</div>
<div class="line"><span class="lineno"> 2544</span>}</div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_aa7984cb33ffce49c6276aa9cd928a5a6"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#aa7984cb33ffce49c6276aa9cd928a5a6">digest_len</a></div><div class="ttdeci">session operation op digest digest_len</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l03126">yubihsm_pkcs11.c:3126</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util__pkcs11_8h_a302f2929b31dff615158d284b2f56e79_cgraph.png" border="0" usemap="#autil__pkcs11_8h_a302f2929b31dff615158d284b2f56e79_cgraph" alt=""/></div>
<map name="autil__pkcs11_8h_a302f2929b31dff615158d284b2f56e79_cgraph" id="autil__pkcs11_8h_a302f2929b31dff615158d284b2f56e79_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,113,31"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="161,5,232,31"/>
<area shape="poly" title=" " alt="" coords="113,16,145,16,145,21,113,21"/>
</map>
</div>

</div>
</div>
<a id="a1cc0fad44d221fb1f13c2bb30935ff49" name="a1cc0fad44d221fb1f13c2bb30935ff49"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1cc0fad44d221fb1f13c2bb30935ff49">&#9670;&#160;</a></span>perform_encrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CK_RV perform_encrypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__session.html">yh_session</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structyubihsm__pkcs11__op__info.html">yubihsm_pkcs11_op_info</a> *</td>          <td class="paramname"><span class="paramname"><em>op_info</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>plaintext</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *</td>          <td class="paramname"><span class="paramname"><em>plaintext_len</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="util__pkcs11_8c_source.html#l02505">2505</a> of file <a class="el" href="util__pkcs11_8c_source.html">util_pkcs11.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2506</span>                                                         {</div>
<div class="line"><span class="lineno"> 2507</span> </div>
<div class="line"><span class="lineno"> 2508</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 2509</span>  <span class="keywordtype">size_t</span> outlen = <span class="keyword">sizeof</span>(op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ad4fd174ba5f77aad7e1f1c66079529ba">buffer</a>);</div>
<div class="line"><span class="lineno"> 2510</span> </div>
<div class="line"><span class="lineno"> 2511</span>  <span class="keywordflow">if</span> (op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a261664672f3ef63ab3a20b864627c49a">mechanism</a>.<a class="code hl_variable" href="structmechanism.html#afeb8198b0f33f94f4520c0ffbc584a9a">mechanism</a> == <a class="code hl_define" href="pkcs11y_8h.html#a631efbda997696a7f7ce71df0e3e779a">CKM_YUBICO_AES_CCM_WRAP</a>) {</div>
<div class="line"><span class="lineno"> 2512</span>    <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> =</div>
<div class="line"><span class="lineno"> 2513</span>      <a class="code hl_function" href="yubihsm_8c.html#a7c2e101be04ad1546d99d5600e732eca">yh_util_wrap_data</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#a511016f53f468cbe53728403a03df05a">decrypt</a>.<a class="code hl_variable" href="structdecrypt__info.html#aabd5d6d63519e0dbd40321bf2d201afa">key_id</a>, op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ad4fd174ba5f77aad7e1f1c66079529ba">buffer</a>,</div>
<div class="line"><span class="lineno"> 2514</span>                        op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ac226105a253c6fda70b44e14a525007a">buffer_length</a>, op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ad4fd174ba5f77aad7e1f1c66079529ba">buffer</a>, &amp;outlen);</div>
<div class="line"><span class="lineno"> 2515</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2516</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Mechanism %lu not supported&quot;</span>, op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a261664672f3ef63ab3a20b864627c49a">mechanism</a>.<a class="code hl_variable" href="structmechanism.html#afeb8198b0f33f94f4520c0ffbc584a9a">mechanism</a>);</div>
<div class="line"><span class="lineno"> 2517</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a0664e99597a479c7fce5b19411cfc1b1">CKR_MECHANISM_INVALID</a>;</div>
<div class="line"><span class="lineno"> 2518</span>  }</div>
<div class="line"><span class="lineno"> 2519</span> </div>
<div class="line"><span class="lineno"> 2520</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 2521</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a91150ecacbaa624fcc7d861f1b54f57c">CKR_FUNCTION_FAILED</a>;</div>
<div class="line"><span class="lineno"> 2522</span>  }</div>
<div class="line"><span class="lineno"> 2523</span> </div>
<div class="line"><span class="lineno"> 2524</span>  <span class="keywordflow">if</span> (outlen &gt; *data_len) {</div>
<div class="line"><span class="lineno"> 2525</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a9f2ea08f0e13c3fc129863fdd46352b6">CKR_BUFFER_TOO_SMALL</a>;</div>
<div class="line"><span class="lineno"> 2526</span>  }</div>
<div class="line"><span class="lineno"> 2527</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(data, op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ad4fd174ba5f77aad7e1f1c66079529ba">buffer</a>, outlen);</div>
<div class="line"><span class="lineno"> 2528</span>  *data_len = outlen;</div>
<div class="line"><span class="lineno"> 2529</span> </div>
<div class="line"><span class="lineno"> 2530</span>  <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>;</div>
<div class="line"><span class="lineno"> 2531</span>}</div>
<div class="ttc" id="ayubihsm_8c_html_a7c2e101be04ad1546d99d5600e732eca"><div class="ttname"><a href="yubihsm_8c.html#a7c2e101be04ad1546d99d5600e732eca">yh_util_wrap_data</a></div><div class="ttdeci">yh_rc yh_util_wrap_data(yh_session *session, uint16_t key_id, const uint8_t *in, size_t in_len, uint8_t *out, size_t *out_len)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l03667">yubihsm.c:3667</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util__pkcs11_8h_a1cc0fad44d221fb1f13c2bb30935ff49_cgraph.png" border="0" usemap="#autil__pkcs11_8h_a1cc0fad44d221fb1f13c2bb30935ff49_cgraph" alt=""/></div>
<map name="autil__pkcs11_8h_a1cc0fad44d221fb1f13c2bb30935ff49_cgraph" id="autil__pkcs11_8h_a1cc0fad44d221fb1f13c2bb30935ff49_cgraph">
<area shape="rect" title=" " alt="" coords="5,56,121,82"/>
<area shape="rect" href="structmechanism.html#afeb8198b0f33f94f4520c0ffbc584a9a" title=" " alt="" coords="169,5,332,31"/>
<area shape="poly" title=" " alt="" coords="113,53,185,33,186,38,114,58"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="806,108,877,134"/>
<area shape="poly" title=" " alt="" coords="121,69,389,83,742,108,791,112,790,118,741,113,389,88,121,74"/>
<area shape="rect" href="yubihsm_8c.html#a7c2e101be04ad1546d99d5600e732eca" title=" " alt="" coords="187,132,314,158"/>
<area shape="poly" title=" " alt="" coords="98,80,204,123,202,128,96,85"/>
<area shape="poly" title=" " alt="" coords="314,140,790,120,791,126,314,145"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="380,157,528,183"/>
<area shape="poly" title=" " alt="" coords="314,150,365,156,364,162,313,155"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="800,207,883,232"/>
<area shape="poly" title=" " alt="" coords="283,156,381,193,480,224,559,244,639,250,741,242,784,234,785,239,742,247,639,255,558,249,478,230,379,198,281,161"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="576,157,742,183"/>
<area shape="poly" title=" " alt="" coords="528,168,561,168,561,173,528,173"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="594,207,724,232"/>
<area shape="poly" title=" " alt="" coords="511,181,588,200,587,205,510,186"/>
<area shape="poly" title=" " alt="" coords="709,154,790,132,791,137,710,159"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="807,157,876,183"/>
<area shape="poly" title=" " alt="" coords="742,168,792,168,792,173,742,173"/>
<area shape="poly" title=" " alt="" coords="710,181,785,202,784,207,709,186"/>
<area shape="poly" title=" " alt="" coords="719,204,740,193,755,181,764,169,773,156,788,143,793,139,796,144,791,147,777,160,768,173,759,185,743,198,721,208"/>
<area shape="poly" title=" " alt="" coords="725,217,784,217,784,222,725,222"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="790,256,893,282"/>
<area shape="poly" title=" " alt="" coords="710,230,777,249,775,254,709,236"/>
</map>
</div>

</div>
</div>
<a id="a547f9032e3bcd7d6a5a810e94822e337" name="a547f9032e3bcd7d6a5a810e94822e337"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a547f9032e3bcd7d6a5a810e94822e337">&#9670;&#160;</a></span>perform_signature()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CK_RV perform_signature </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__session.html">yh_session</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structyubihsm__pkcs11__op__info.html">yubihsm_pkcs11_op_info</a> *</td>          <td class="paramname"><span class="paramname"><em>op_info</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>signature</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> *</td>          <td class="paramname"><span class="paramname"><em>signature_len</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="util__pkcs11_8c_source.html#l02410">2410</a> of file <a class="el" href="util__pkcs11_8c_source.html">util_pkcs11.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2411</span>                                                                     {</div>
<div class="line"><span class="lineno"> 2412</span> </div>
<div class="line"><span class="lineno"> 2413</span>  <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 2414</span>  <span class="keywordtype">size_t</span> outlen = <span class="keyword">sizeof</span>(op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ad4fd174ba5f77aad7e1f1c66079529ba">buffer</a>);</div>
<div class="line"><span class="lineno"> 2415</span> </div>
<div class="line"><span class="lineno"> 2416</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="util__pkcs11_8c.html#a7c0da3eb6986b1e9466392de8eb4b9f5">is_RSA_sign_mechanism</a>(op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a261664672f3ef63ab3a20b864627c49a">mechanism</a>.<a class="code hl_variable" href="structmechanism.html#afeb8198b0f33f94f4520c0ffbc584a9a">mechanism</a>)) {</div>
<div class="line"><span class="lineno"> 2417</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="util__pkcs11_8c.html#a34722aea70286e920362e216c048f629">is_PSS_sign_mechanism</a>(op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a261664672f3ef63ab3a20b864627c49a">mechanism</a>.<a class="code hl_variable" href="structmechanism.html#afeb8198b0f33f94f4520c0ffbc584a9a">mechanism</a>)) {</div>
<div class="line"><span class="lineno"> 2418</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#a944e6f31487857709f032598fd43fef5">yh_util_sign_pss</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#af6e088c2d57f2582d353bec69b48c023">sign</a>.<a class="code hl_variable" href="structsign__info.html#a78845a7498c7d284694674fede0d9cc8">key_id</a>, op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ad4fd174ba5f77aad7e1f1c66079529ba">buffer</a>,</div>
<div class="line"><span class="lineno"> 2419</span>                             op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ac226105a253c6fda70b44e14a525007a">buffer_length</a>, op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ad4fd174ba5f77aad7e1f1c66079529ba">buffer</a>, &amp;outlen,</div>
<div class="line"><span class="lineno"> 2420</span>                             op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a261664672f3ef63ab3a20b864627c49a">mechanism</a>.<a class="code hl_variable" href="structmechanism.html#ac8e33c4d8b2b2ec42e7a942f3c157328">pss</a>.salt_len,</div>
<div class="line"><span class="lineno"> 2421</span>                             op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a261664672f3ef63ab3a20b864627c49a">mechanism</a>.<a class="code hl_variable" href="structmechanism.html#ac8e33c4d8b2b2ec42e7a942f3c157328">pss</a>.mgf1Algo);</div>
<div class="line"><span class="lineno"> 2422</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2423</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#aa0a7644b7b368d6aaf8b4aff5e3d19b8">yh_util_sign_pkcs1v1_5</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#af6e088c2d57f2582d353bec69b48c023">sign</a>.<a class="code hl_variable" href="structsign__info.html#a78845a7498c7d284694674fede0d9cc8">key_id</a>,</div>
<div class="line"><span class="lineno"> 2424</span>                                   <a class="code hl_function" href="util__pkcs11_8c.html#a3f1010425d5308dfa15d696b4853c68c">is_hashed_mechanism</a>(</div>
<div class="line"><span class="lineno"> 2425</span>                                     op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a261664672f3ef63ab3a20b864627c49a">mechanism</a>.<a class="code hl_variable" href="structmechanism.html#afeb8198b0f33f94f4520c0ffbc584a9a">mechanism</a>),</div>
<div class="line"><span class="lineno"> 2426</span>                                   op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ad4fd174ba5f77aad7e1f1c66079529ba">buffer</a>, op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ac226105a253c6fda70b44e14a525007a">buffer_length</a>,</div>
<div class="line"><span class="lineno"> 2427</span>                                   op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ad4fd174ba5f77aad7e1f1c66079529ba">buffer</a>, &amp;outlen);</div>
<div class="line"><span class="lineno"> 2428</span>    }</div>
<div class="line"><span class="lineno"> 2429</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="util__pkcs11_8c.html#a03746a942ba1eaafbec20b675463ee00">is_ECDSA_sign_mechanism</a>(op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a261664672f3ef63ab3a20b864627c49a">mechanism</a>.<a class="code hl_variable" href="structmechanism.html#afeb8198b0f33f94f4520c0ffbc584a9a">mechanism</a>)) {</div>
<div class="line"><span class="lineno"> 2430</span>    <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#a5121c90d3bd745afd8264fef2ef39ace">yh_util_sign_ecdsa</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#af6e088c2d57f2582d353bec69b48c023">sign</a>.<a class="code hl_variable" href="structsign__info.html#a78845a7498c7d284694674fede0d9cc8">key_id</a>, op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ad4fd174ba5f77aad7e1f1c66079529ba">buffer</a>,</div>
<div class="line"><span class="lineno"> 2431</span>                             op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ac226105a253c6fda70b44e14a525007a">buffer_length</a>, op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ad4fd174ba5f77aad7e1f1c66079529ba">buffer</a>, &amp;outlen);</div>
<div class="line"><span class="lineno"> 2432</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="util__pkcs11_8c.html#a3da5875af7a71b11ee5ead6b160d1ff4">is_HMAC_sign_mechanism</a>(op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a261664672f3ef63ab3a20b864627c49a">mechanism</a>.<a class="code hl_variable" href="structmechanism.html#afeb8198b0f33f94f4520c0ffbc584a9a">mechanism</a>)) {</div>
<div class="line"><span class="lineno"> 2433</span>    <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#a9000d43fe8cf7313b319f316521eb0c4">yh_util_sign_hmac</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#af6e088c2d57f2582d353bec69b48c023">sign</a>.<a class="code hl_variable" href="structsign__info.html#a78845a7498c7d284694674fede0d9cc8">key_id</a>, op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ad4fd174ba5f77aad7e1f1c66079529ba">buffer</a>,</div>
<div class="line"><span class="lineno"> 2434</span>                            op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ac226105a253c6fda70b44e14a525007a">buffer_length</a>, op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ad4fd174ba5f77aad7e1f1c66079529ba">buffer</a>, &amp;outlen);</div>
<div class="line"><span class="lineno"> 2435</span> </div>
<div class="line"><span class="lineno"> 2436</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2437</span>    <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Mechanism %lu not supported&quot;</span>, op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a261664672f3ef63ab3a20b864627c49a">mechanism</a>.<a class="code hl_variable" href="structmechanism.html#afeb8198b0f33f94f4520c0ffbc584a9a">mechanism</a>);</div>
<div class="line"><span class="lineno"> 2438</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a0664e99597a479c7fce5b19411cfc1b1">CKR_MECHANISM_INVALID</a>;</div>
<div class="line"><span class="lineno"> 2439</span>  }</div>
<div class="line"><span class="lineno"> 2440</span> </div>
<div class="line"><span class="lineno"> 2441</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 2442</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a91150ecacbaa624fcc7d861f1b54f57c">CKR_FUNCTION_FAILED</a>;</div>
<div class="line"><span class="lineno"> 2443</span>  }</div>
<div class="line"><span class="lineno"> 2444</span> </div>
<div class="line"><span class="lineno"> 2445</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="util__pkcs11_8c.html#a03746a942ba1eaafbec20b675463ee00">is_ECDSA_sign_mechanism</a>(op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a261664672f3ef63ab3a20b864627c49a">mechanism</a>.<a class="code hl_variable" href="structmechanism.html#afeb8198b0f33f94f4520c0ffbc584a9a">mechanism</a>)) {</div>
<div class="line"><span class="lineno"> 2446</span>    <span class="comment">// NOTE(adma): ECDSA, we must remove the DER encoding and only</span></div>
<div class="line"><span class="lineno"> 2447</span>    <span class="comment">// return R,S as required by the specs</span></div>
<div class="line"><span class="lineno"> 2448</span>    <span class="keywordflow">if</span> (strip_DER_encoding_from_ECSIG(op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ad4fd174ba5f77aad7e1f1c66079529ba">buffer</a>, &amp;outlen,</div>
<div class="line"><span class="lineno"> 2449</span>                                      op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#af6e088c2d57f2582d353bec69b48c023">sign</a>.<a class="code hl_variable" href="structsign__info.html#ae691c5b3f66d72902403622f40a5a94f">sig_len</a>) == <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 2450</span>      <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a91150ecacbaa624fcc7d861f1b54f57c">CKR_FUNCTION_FAILED</a>;</div>
<div class="line"><span class="lineno"> 2451</span>    }</div>
<div class="line"><span class="lineno"> 2452</span>  }</div>
<div class="line"><span class="lineno"> 2453</span> </div>
<div class="line"><span class="lineno"> 2454</span>  <span class="keywordflow">if</span> (outlen &gt; *signature_len) {</div>
<div class="line"><span class="lineno"> 2455</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a9f2ea08f0e13c3fc129863fdd46352b6">CKR_BUFFER_TOO_SMALL</a>;</div>
<div class="line"><span class="lineno"> 2456</span>  }</div>
<div class="line"><span class="lineno"> 2457</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(signature, op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ad4fd174ba5f77aad7e1f1c66079529ba">buffer</a>, outlen);</div>
<div class="line"><span class="lineno"> 2458</span>  *signature_len = outlen;</div>
<div class="line"><span class="lineno"> 2459</span> </div>
<div class="line"><span class="lineno"> 2460</span>  <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>;</div>
<div class="line"><span class="lineno"> 2461</span>}</div>
<div class="ttc" id="astructmechanism_html_ac8e33c4d8b2b2ec42e7a942f3c157328"><div class="ttname"><a href="structmechanism.html#ac8e33c4d8b2b2ec42e7a942f3c157328">mechanism::pss</a></div><div class="ttdeci">struct mechanism::@110::@113 pss</div></div>
<div class="ttc" id="astructsign__info_html_a78845a7498c7d284694674fede0d9cc8"><div class="ttname"><a href="structsign__info.html#a78845a7498c7d284694674fede0d9cc8">sign_info::key_id</a></div><div class="ttdeci">uint16_t key_id</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8h_source.html#l00067">yubihsm_pkcs11.h:67</a></div></div>
<div class="ttc" id="autil__pkcs11_8c_html_a34722aea70286e920362e216c048f629"><div class="ttname"><a href="util__pkcs11_8c.html#a34722aea70286e920362e216c048f629">is_PSS_sign_mechanism</a></div><div class="ttdeci">bool is_PSS_sign_mechanism(CK_MECHANISM_TYPE m)</div><div class="ttdef"><b>Definition</b> <a href="util__pkcs11_8c_source.html#l02707">util_pkcs11.c:2707</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_a5121c90d3bd745afd8264fef2ef39ace"><div class="ttname"><a href="yubihsm_8c.html#a5121c90d3bd745afd8264fef2ef39ace">yh_util_sign_ecdsa</a></div><div class="ttdeci">yh_rc yh_util_sign_ecdsa(yh_session *session, uint16_t key_id, const uint8_t *in, size_t in_len, uint8_t *out, size_t *out_len)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l01411">yubihsm.c:1411</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_a9000d43fe8cf7313b319f316521eb0c4"><div class="ttname"><a href="yubihsm_8c.html#a9000d43fe8cf7313b319f316521eb0c4">yh_util_sign_hmac</a></div><div class="ttdeci">yh_rc yh_util_sign_hmac(yh_session *session, uint16_t key_id, const uint8_t *in, size_t in_len, uint8_t *out, size_t *out_len)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l01520">yubihsm.c:1520</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_a944e6f31487857709f032598fd43fef5"><div class="ttname"><a href="yubihsm_8c.html#a944e6f31487857709f032598fd43fef5">yh_util_sign_pss</a></div><div class="ttdeci">yh_rc yh_util_sign_pss(yh_session *session, uint16_t key_id, const uint8_t *in, size_t in_len, uint8_t *out, size_t *out_len, size_t salt_len, yh_algorithm mgf1Algo)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l01346">yubihsm.c:1346</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_aa0a7644b7b368d6aaf8b4aff5e3d19b8"><div class="ttname"><a href="yubihsm_8c.html#aa0a7644b7b368d6aaf8b4aff5e3d19b8">yh_util_sign_pkcs1v1_5</a></div><div class="ttdeci">yh_rc yh_util_sign_pkcs1v1_5(yh_session *session, uint16_t key_id, bool hashed, const uint8_t *in, size_t in_len, uint8_t *out, size_t *out_len)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l01287">yubihsm.c:1287</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util__pkcs11_8h_a547f9032e3bcd7d6a5a810e94822e337_cgraph.png" border="0" usemap="#autil__pkcs11_8h_a547f9032e3bcd7d6a5a810e94822e337_cgraph" alt=""/></div>
<map name="autil__pkcs11_8h_a547f9032e3bcd7d6a5a810e94822e337_cgraph" id="autil__pkcs11_8h_a547f9032e3bcd7d6a5a810e94822e337_cgraph">
<area shape="rect" title=" " alt="" coords="5,252,131,278"/>
<area shape="rect" href="util__pkcs11_8c.html#a03746a942ba1eaafbec20b675463ee00" title=" " alt="" coords="179,5,369,31"/>
<area shape="poly" title=" " alt="" coords="69,251,80,210,100,153,131,92,152,64,177,40,181,37,184,41,180,44,156,68,136,95,104,155,85,211,74,252"/>
<area shape="rect" href="util__pkcs11_8c.html#a3f1010425d5308dfa15d696b4853c68c" title=" " alt="" coords="197,55,351,80"/>
<area shape="poly" title=" " alt="" coords="71,251,84,218,106,174,137,128,177,89,183,86,186,90,180,94,141,132,111,177,89,220,76,253"/>
<area shape="rect" href="util__pkcs11_8c.html#a3da5875af7a71b11ee5ead6b160d1ff4" title=" " alt="" coords="182,104,366,130"/>
<area shape="poly" title=" " alt="" coords="75,250,114,196,143,165,177,139,186,134,188,139,180,143,147,169,118,199,79,253"/>
<area shape="rect" href="util__pkcs11_8c.html#a34722aea70286e920362e216c048f629" title=" " alt="" coords="189,153,359,179"/>
<area shape="poly" title=" " alt="" coords="83,249,124,219,177,188,192,182,194,187,180,193,127,223,87,254"/>
<area shape="rect" href="util__pkcs11_8c.html#a7c0da3eb6986b1e9466392de8eb4b9f5" title=" " alt="" coords="188,203,360,228"/>
<area shape="poly" title=" " alt="" coords="124,249,202,230,203,235,125,254"/>
<area shape="rect" href="structmechanism.html#afeb8198b0f33f94f4520c0ffbc584a9a" title=" " alt="" coords="192,252,356,278"/>
<area shape="poly" title=" " alt="" coords="131,262,177,262,177,268,131,268"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="843,451,914,476"/>
<area shape="poly" title=" " alt="" coords="125,276,179,288,271,302,350,310,485,315,550,321,618,332,693,352,780,385,821,410,855,438,852,442,818,414,778,390,692,357,617,337,549,326,485,321,349,315,270,308,178,293,124,281"/>
<area shape="rect" href="yubihsm_8c.html#a5121c90d3bd745afd8264fef2ef39ace" title=" " alt="" coords="208,360,340,386"/>
<area shape="poly" title=" " alt="" coords="90,276,130,303,180,332,223,351,220,356,177,337,128,308,87,280"/>
<area shape="rect" href="yubihsm_8c.html#a9000d43fe8cf7313b319f316521eb0c4" title=" " alt="" coords="209,423,338,448"/>
<area shape="poly" title=" " alt="" coords="79,277,118,333,147,367,180,396,213,414,210,419,177,400,143,370,114,337,75,280"/>
<area shape="rect" href="yubihsm_8c.html#aa0a7644b7b368d6aaf8b4aff5e3d19b8" title=" " alt="" coords="194,497,354,523"/>
<area shape="poly" title=" " alt="" coords="76,277,89,312,111,360,142,412,181,459,201,475,224,488,221,493,198,480,177,463,137,415,107,362,84,314,71,279"/>
<area shape="rect" href="yubihsm_8c.html#a944e6f31487857709f032598fd43fef5" title=" " alt="" coords="215,547,333,572"/>
<area shape="poly" title=" " alt="" coords="73,278,81,326,98,395,112,433,130,470,153,504,180,533,201,546,199,551,177,538,149,507,126,472,107,435,93,397,75,327,68,278"/>
<area shape="poly" title=" " alt="" coords="340,370,428,372,538,380,659,394,779,418,840,441,838,446,778,423,659,399,538,385,428,378,340,375"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="417,501,565,527"/>
<area shape="poly" title=" " alt="" coords="318,384,370,408,425,448,468,488,465,492,421,452,368,412,316,389"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="837,677,920,703"/>
<area shape="poly" title=" " alt="" coords="332,384,353,394,371,408,384,425,391,442,396,474,401,505,407,521,419,538,464,579,506,603,614,637,668,653,724,666,822,681,821,687,723,671,667,658,613,642,504,607,461,584,415,541,403,524,396,507,391,475,386,443,379,428,367,412,350,399,330,389"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="613,552,779,578"/>
<area shape="poly" title=" " alt="" coords="547,525,627,545,626,550,545,530"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="631,601,761,627"/>
<area shape="poly" title=" " alt="" coords="512,525,557,556,614,588,628,593,626,598,612,593,554,561,509,530"/>
<area shape="poly" title=" " alt="" coords="736,549,777,530,847,484,850,488,780,535,738,554"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="844,552,912,578"/>
<area shape="poly" title=" " alt="" coords="779,562,829,562,829,568,779,568"/>
<area shape="poly" title=" " alt="" coords="758,576,780,587,796,598,807,610,829,638,855,664,851,668,825,641,802,614,792,602,777,591,756,581"/>
<area shape="poly" title=" " alt="" coords="757,598,777,588,795,571,816,545,858,488,862,491,820,549,799,575,780,592,760,603"/>
<area shape="poly" title=" " alt="" coords="733,625,780,644,835,668,833,673,778,649,731,630"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="827,601,930,627"/>
<area shape="poly" title=" " alt="" coords="762,612,811,612,811,617,762,617"/>
<area shape="poly" title=" " alt="" coords="339,431,536,429,657,433,779,442,828,450,827,455,778,447,657,438,536,435,339,436"/>
<area shape="poly" title=" " alt="" coords="312,446,440,493,438,498,311,451"/>
<area shape="poly" title=" " alt="" coords="319,447,347,461,371,483,387,511,393,538,390,590,388,615,390,638,399,660,419,681,448,696,491,705,543,710,601,711,720,705,821,695,821,700,721,710,601,716,543,715,490,711,446,701,415,686,395,663,385,639,383,615,385,590,387,538,382,513,367,487,344,466,317,451"/>
<area shape="poly" title=" " alt="" coords="354,494,417,486,646,469,827,462,827,467,646,475,417,491,355,500"/>
<area shape="poly" title=" " alt="" coords="355,509,401,510,401,515,354,514"/>
<area shape="poly" title=" " alt="" coords="356,521,371,532,389,558,396,585,396,611,393,638,390,663,391,688,399,711,419,732,443,748,469,761,524,775,583,778,642,772,699,759,753,743,837,708,839,713,754,748,701,764,643,777,583,784,523,781,467,766,440,753,415,736,395,713,386,689,385,663,387,637,391,611,391,585,384,560,367,536,353,525"/>
<area shape="poly" title=" " alt="" coords="333,556,441,550,565,537,708,507,827,476,829,481,710,513,566,542,442,556,333,561"/>
<area shape="poly" title=" " alt="" coords="333,545,411,528,412,533,334,550"/>
<area shape="poly" title=" " alt="" coords="281,572,296,616,322,675,341,706,363,736,389,762,418,783,468,807,513,823,554,832,595,834,635,829,678,819,778,782,802,769,824,752,858,714,861,718,827,756,805,774,780,787,680,824,636,834,595,839,554,837,511,829,466,812,416,787,385,766,359,739,336,709,318,678,291,618,276,574"/>
</map>
</div>

</div>
</div>
<a id="ab17f6ba85432d715def5185e7832c9e8" name="ab17f6ba85432d715def5185e7832c9e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab17f6ba85432d715def5185e7832c9e8">&#9670;&#160;</a></span>perform_verify()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CK_RV perform_verify </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyh__session.html">yh_session</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structyubihsm__pkcs11__op__info.html">yubihsm_pkcs11_op_info</a> *</td>          <td class="paramname"><span class="paramname"><em>op_info</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>signature</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a></td>          <td class="paramname"><span class="paramname"><em>signature_len</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="util__pkcs11_8c_source.html#l02225">2225</a> of file <a class="el" href="util__pkcs11_8c_source.html">util_pkcs11.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2226</span>                                                                 {</div>
<div class="line"><span class="lineno"> 2227</span> </div>
<div class="line"><span class="lineno"> 2228</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="util__pkcs11_8c.html#a3da5875af7a71b11ee5ead6b160d1ff4">is_HMAC_sign_mechanism</a>(op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a261664672f3ef63ab3a20b864627c49a">mechanism</a>.<a class="code hl_variable" href="structmechanism.html#afeb8198b0f33f94f4520c0ffbc584a9a">mechanism</a>)) {</div>
<div class="line"><span class="lineno"> 2229</span>    <a class="code hl_enumeration" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366">yh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a>;</div>
<div class="line"><span class="lineno"> 2230</span>    <span class="keywordtype">bool</span> verified = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2231</span> </div>
<div class="line"><span class="lineno"> 2232</span>    <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> = <a class="code hl_function" href="yubihsm_8c.html#ab37ae2f7fc6857b420e173284130686d">yh_util_verify_hmac</a>(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#a769d855aca7e13b69c58abd1de1bb410">verify</a>.<a class="code hl_variable" href="structverify__info.html#a1e8b3790ebac9ac474f5c7e932b228a0">key_id</a>, signature,</div>
<div class="line"><span class="lineno"> 2233</span>                              signature_len, op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ad4fd174ba5f77aad7e1f1c66079529ba">buffer</a>,</div>
<div class="line"><span class="lineno"> 2234</span>                              op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ac226105a253c6fda70b44e14a525007a">buffer_length</a>, &amp;verified);</div>
<div class="line"><span class="lineno"> 2235</span> </div>
<div class="line"><span class="lineno"> 2236</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9c8d6a4a7a87f74f070e816dca1a547b">yrc</a> != <a class="code hl_enumvalue" href="yubihsm_8h.html#ae4f602d2343d01b1727dfd633169d366a405155512dc2284dc210ed15be1d0815">YHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 2237</span>      <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a91150ecacbaa624fcc7d861f1b54f57c">CKR_FUNCTION_FAILED</a>;</div>
<div class="line"><span class="lineno"> 2238</span>    }</div>
<div class="line"><span class="lineno"> 2239</span> </div>
<div class="line"><span class="lineno"> 2240</span>    <span class="keywordflow">if</span> (verified == <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 2241</span>      <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a4027a099409c7d9bbc650c766e605903">CKR_SIGNATURE_INVALID</a>;</div>
<div class="line"><span class="lineno"> 2242</span>    }</div>
<div class="line"><span class="lineno"> 2243</span> </div>
<div class="line"><span class="lineno"> 2244</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>;</div>
<div class="line"><span class="lineno"> 2245</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2246</span>    CK_RV <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a>;</div>
<div class="line"><span class="lineno"> 2247</span>    EVP_PKEY *key = EVP_PKEY_new();</div>
<div class="line"><span class="lineno"> 2248</span>    <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> md_data[EVP_MAX_MD_SIZE];</div>
<div class="line"><span class="lineno"> 2249</span>    <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *md = md_data;</div>
<div class="line"><span class="lineno"> 2250</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> md_len = <span class="keyword">sizeof</span>(md_data);</div>
<div class="line"><span class="lineno"> 2251</span>    EVP_PKEY_CTX *ctx = NULL;</div>
<div class="line"><span class="lineno"> 2252</span> </div>
<div class="line"><span class="lineno"> 2253</span>    <span class="keywordflow">if</span> (key == NULL) {</div>
<div class="line"><span class="lineno"> 2254</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a> = <a class="code hl_define" href="pkcs11_8h.html#a91150ecacbaa624fcc7d861f1b54f57c">CKR_FUNCTION_FAILED</a>;</div>
<div class="line"><span class="lineno"> 2255</span>      <span class="keywordflow">goto</span> pv_failure;</div>
<div class="line"><span class="lineno"> 2256</span>    }</div>
<div class="line"><span class="lineno"> 2257</span> </div>
<div class="line"><span class="lineno"> 2258</span>    <span class="keywordflow">if</span> (load_public_key(<a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>, op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#a769d855aca7e13b69c58abd1de1bb410">verify</a>.<a class="code hl_variable" href="structverify__info.html#a1e8b3790ebac9ac474f5c7e932b228a0">key_id</a>, key) == <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 2259</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a> = <a class="code hl_define" href="pkcs11_8h.html#a91150ecacbaa624fcc7d861f1b54f57c">CKR_FUNCTION_FAILED</a>;</div>
<div class="line"><span class="lineno"> 2260</span>      <span class="keywordflow">goto</span> pv_failure;</div>
<div class="line"><span class="lineno"> 2261</span>    }</div>
<div class="line"><span class="lineno"> 2262</span> </div>
<div class="line"><span class="lineno"> 2263</span>    ctx = EVP_PKEY_CTX_new(key, NULL);</div>
<div class="line"><span class="lineno"> 2264</span>    <span class="keywordflow">if</span> (ctx == NULL) {</div>
<div class="line"><span class="lineno"> 2265</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a> = <a class="code hl_define" href="pkcs11_8h.html#a91150ecacbaa624fcc7d861f1b54f57c">CKR_FUNCTION_FAILED</a>;</div>
<div class="line"><span class="lineno"> 2266</span>      <span class="keywordflow">goto</span> pv_failure;</div>
<div class="line"><span class="lineno"> 2267</span>    }</div>
<div class="line"><span class="lineno"> 2268</span>    <span class="keywordflow">if</span> (EVP_PKEY_verify_init(ctx) &lt;= 0) {</div>
<div class="line"><span class="lineno"> 2269</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a> = <a class="code hl_define" href="pkcs11_8h.html#a91150ecacbaa624fcc7d861f1b54f57c">CKR_FUNCTION_FAILED</a>;</div>
<div class="line"><span class="lineno"> 2270</span>      <span class="keywordflow">goto</span> pv_failure;</div>
<div class="line"><span class="lineno"> 2271</span>    }</div>
<div class="line"><span class="lineno"> 2272</span> </div>
<div class="line"><span class="lineno"> 2273</span>    <span class="keywordtype">int</span> res;</div>
<div class="line"><span class="lineno"> 2274</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> data[2048];</div>
<div class="line"><span class="lineno"> 2275</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="util__pkcs11_8c.html#a3f1010425d5308dfa15d696b4853c68c">is_hashed_mechanism</a>(op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a261664672f3ef63ab3a20b864627c49a">mechanism</a>.<a class="code hl_variable" href="structmechanism.html#afeb8198b0f33f94f4520c0ffbc584a9a">mechanism</a>)) {</div>
<div class="line"><span class="lineno"> 2276</span>      <span class="keywordflow">if</span> (EVP_DigestFinal_ex(op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#a769d855aca7e13b69c58abd1de1bb410">verify</a>.<a class="code hl_variable" href="structverify__info.html#a920d34cab9f1b9ddcaf849d5b08c921d">md_ctx</a>, md, &amp;md_len) &lt;= 0) {</div>
<div class="line"><span class="lineno"> 2277</span>        <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a> = <a class="code hl_define" href="pkcs11_8h.html#a91150ecacbaa624fcc7d861f1b54f57c">CKR_FUNCTION_FAILED</a>;</div>
<div class="line"><span class="lineno"> 2278</span>        <span class="keywordflow">goto</span> pv_failure;</div>
<div class="line"><span class="lineno"> 2279</span>      }</div>
<div class="line"><span class="lineno"> 2280</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (EVP_PKEY_base_id(key) == EVP_PKEY_RSA) {</div>
<div class="line"><span class="lineno"> 2281</span>      <span class="keyword">const</span> EVP_MD *md_type;</div>
<div class="line"><span class="lineno"> 2282</span>      <span class="keywordtype">int</span> di_len;</div>
<div class="line"><span class="lineno"> 2283</span> </div>
<div class="line"><span class="lineno"> 2284</span>      <span class="keywordflow">if</span> (op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a261664672f3ef63ab3a20b864627c49a">mechanism</a>.<a class="code hl_variable" href="structmechanism.html#afeb8198b0f33f94f4520c0ffbc584a9a">mechanism</a> == <a class="code hl_define" href="pkcs11_8h.html#ad4f5697408b23623c904df2b1ca8a9f1">CKM_RSA_PKCS_PSS</a>) {</div>
<div class="line"><span class="lineno"> 2285</span>        md = op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ad4fd174ba5f77aad7e1f1c66079529ba">buffer</a>;</div>
<div class="line"><span class="lineno"> 2286</span>        md_len = op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ac226105a253c6fda70b44e14a525007a">buffer_length</a>;</div>
<div class="line"><span class="lineno"> 2287</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2288</span>        <a class="code hl_function" href="util_8c.html#ad370ce9b010ffc168e85acb7c8412caf">parse_NID</a>(op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ad4fd174ba5f77aad7e1f1c66079529ba">buffer</a>, op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ac226105a253c6fda70b44e14a525007a">buffer_length</a>, &amp;md_type, &amp;di_len);</div>
<div class="line"><span class="lineno"> 2289</span>        <span class="keywordflow">if</span> (md_type == EVP_md_null()) {</div>
<div class="line"><span class="lineno"> 2290</span>          <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a> = <a class="code hl_define" href="pkcs11_8h.html#a1740789d62501fea6688fb211b02d1a2">CKR_DATA_INVALID</a>;</div>
<div class="line"><span class="lineno"> 2291</span>          <span class="keywordflow">goto</span> pv_failure;</div>
<div class="line"><span class="lineno"> 2292</span>        }</div>
<div class="line"><span class="lineno"> 2293</span> </div>
<div class="line"><span class="lineno"> 2294</span>        op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#a769d855aca7e13b69c58abd1de1bb410">verify</a>.<a class="code hl_variable" href="structverify__info.html#a9547582fc2ac4625f9029f6d285bdb68">md</a> = md_type;</div>
<div class="line"><span class="lineno"> 2295</span>        md = op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ad4fd174ba5f77aad7e1f1c66079529ba">buffer</a> + di_len;</div>
<div class="line"><span class="lineno"> 2296</span>        md_len = op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ac226105a253c6fda70b44e14a525007a">buffer_length</a> - di_len;</div>
<div class="line"><span class="lineno"> 2297</span>      }</div>
<div class="line"><span class="lineno"> 2298</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (EVP_PKEY_base_id(key) == EVP_PKEY_EC) {</div>
<div class="line"><span class="lineno"> 2299</span>      md = op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ad4fd174ba5f77aad7e1f1c66079529ba">buffer</a>;</div>
<div class="line"><span class="lineno"> 2300</span>      md_len = op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#ac226105a253c6fda70b44e14a525007a">buffer_length</a>;</div>
<div class="line"><span class="lineno"> 2301</span>      <span class="keywordflow">if</span> (md_len == 20) {</div>
<div class="line"><span class="lineno"> 2302</span>        op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#a769d855aca7e13b69c58abd1de1bb410">verify</a>.<a class="code hl_variable" href="structverify__info.html#a9547582fc2ac4625f9029f6d285bdb68">md</a> = EVP_sha1();</div>
<div class="line"><span class="lineno"> 2303</span>      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (md_len == 32) {</div>
<div class="line"><span class="lineno"> 2304</span>        op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#a769d855aca7e13b69c58abd1de1bb410">verify</a>.<a class="code hl_variable" href="structverify__info.html#a9547582fc2ac4625f9029f6d285bdb68">md</a> = EVP_sha256();</div>
<div class="line"><span class="lineno"> 2305</span>      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (md_len == 48) {</div>
<div class="line"><span class="lineno"> 2306</span>        op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#a769d855aca7e13b69c58abd1de1bb410">verify</a>.<a class="code hl_variable" href="structverify__info.html#a9547582fc2ac4625f9029f6d285bdb68">md</a> = EVP_sha384();</div>
<div class="line"><span class="lineno"> 2307</span>      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (md_len == 64) {</div>
<div class="line"><span class="lineno"> 2308</span>        op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#a769d855aca7e13b69c58abd1de1bb410">verify</a>.<a class="code hl_variable" href="structverify__info.html#a9547582fc2ac4625f9029f6d285bdb68">md</a> = EVP_sha512();</div>
<div class="line"><span class="lineno"> 2309</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2310</span>        <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a> = <a class="code hl_define" href="pkcs11_8h.html#a91150ecacbaa624fcc7d861f1b54f57c">CKR_FUNCTION_FAILED</a>;</div>
<div class="line"><span class="lineno"> 2311</span>        <span class="keywordflow">goto</span> pv_failure;</div>
<div class="line"><span class="lineno"> 2312</span>      }</div>
<div class="line"><span class="lineno"> 2313</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2314</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a> = <a class="code hl_define" href="pkcs11_8h.html#a91150ecacbaa624fcc7d861f1b54f57c">CKR_FUNCTION_FAILED</a>;</div>
<div class="line"><span class="lineno"> 2315</span>      <span class="keywordflow">goto</span> pv_failure;</div>
<div class="line"><span class="lineno"> 2316</span>    }</div>
<div class="line"><span class="lineno"> 2317</span>    <span class="keywordflow">if</span> (EVP_PKEY_CTX_set_signature_md(ctx, op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#a769d855aca7e13b69c58abd1de1bb410">verify</a>.<a class="code hl_variable" href="structverify__info.html#a9547582fc2ac4625f9029f6d285bdb68">md</a>) &lt;= 0) {</div>
<div class="line"><span class="lineno"> 2318</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a> = <a class="code hl_define" href="pkcs11_8h.html#a91150ecacbaa624fcc7d861f1b54f57c">CKR_FUNCTION_FAILED</a>;</div>
<div class="line"><span class="lineno"> 2319</span>      <span class="keywordflow">goto</span> pv_failure;</div>
<div class="line"><span class="lineno"> 2320</span>    }</div>
<div class="line"><span class="lineno"> 2321</span>    <span class="keywordflow">if</span> (op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#a769d855aca7e13b69c58abd1de1bb410">verify</a>.<a class="code hl_variable" href="structverify__info.html#a69841d9be2ea9074f4a8dd3972c532cf">padding</a>) {</div>
<div class="line"><span class="lineno"> 2322</span>      <span class="keywordflow">if</span> (EVP_PKEY_CTX_set_rsa_padding(ctx, op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#a769d855aca7e13b69c58abd1de1bb410">verify</a>.<a class="code hl_variable" href="structverify__info.html#a69841d9be2ea9074f4a8dd3972c532cf">padding</a>) &lt;= 0) {</div>
<div class="line"><span class="lineno"> 2323</span>        <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a> = <a class="code hl_define" href="pkcs11_8h.html#a91150ecacbaa624fcc7d861f1b54f57c">CKR_FUNCTION_FAILED</a>;</div>
<div class="line"><span class="lineno"> 2324</span>        <span class="keywordflow">goto</span> pv_failure;</div>
<div class="line"><span class="lineno"> 2325</span>      }</div>
<div class="line"><span class="lineno"> 2326</span>      <span class="keywordflow">if</span> (op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#a769d855aca7e13b69c58abd1de1bb410">verify</a>.<a class="code hl_variable" href="structverify__info.html#a69841d9be2ea9074f4a8dd3972c532cf">padding</a> == RSA_PKCS1_PSS_PADDING) {</div>
<div class="line"><span class="lineno"> 2327</span>        <span class="keywordflow">if</span> (EVP_PKEY_CTX_set_rsa_pss_saltlen(ctx, op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#a769d855aca7e13b69c58abd1de1bb410">verify</a>.<a class="code hl_variable" href="structverify__info.html#a8e050dd7549467897d666046c1754aaf">saltLen</a>) &lt;=</div>
<div class="line"><span class="lineno"> 2328</span>            0) {</div>
<div class="line"><span class="lineno"> 2329</span>          <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a> = <a class="code hl_define" href="pkcs11_8h.html#a91150ecacbaa624fcc7d861f1b54f57c">CKR_FUNCTION_FAILED</a>;</div>
<div class="line"><span class="lineno"> 2330</span>          <span class="keywordflow">goto</span> pv_failure;</div>
<div class="line"><span class="lineno"> 2331</span>        }</div>
<div class="line"><span class="lineno"> 2332</span>        <span class="keywordflow">if</span> (EVP_PKEY_CTX_set_rsa_mgf1_md(ctx, op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#a769d855aca7e13b69c58abd1de1bb410">verify</a>.<a class="code hl_variable" href="structverify__info.html#ae1b2e1bec7e3c36d68558b61401cf5df">mgf1md</a>) &lt;= 0) {</div>
<div class="line"><span class="lineno"> 2333</span>          <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a> = <a class="code hl_define" href="pkcs11_8h.html#a91150ecacbaa624fcc7d861f1b54f57c">CKR_FUNCTION_FAILED</a>;</div>
<div class="line"><span class="lineno"> 2334</span>          <span class="keywordflow">goto</span> pv_failure;</div>
<div class="line"><span class="lineno"> 2335</span>        }</div>
<div class="line"><span class="lineno"> 2336</span>      }</div>
<div class="line"><span class="lineno"> 2337</span>    }</div>
<div class="line"><span class="lineno"> 2338</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="util__pkcs11_8c.html#a03746a942ba1eaafbec20b675463ee00">is_ECDSA_sign_mechanism</a>(op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a261664672f3ef63ab3a20b864627c49a">mechanism</a>.<a class="code hl_variable" href="structmechanism.html#afeb8198b0f33f94f4520c0ffbc584a9a">mechanism</a>)) {</div>
<div class="line"><span class="lineno"> 2339</span>      <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(data, signature, signature_len);</div>
<div class="line"><span class="lineno"> 2340</span>      <a class="code hl_typedef" href="namespacefc_1_1ecc.html#a7c10bdf37d2fad7c122133f284e47f3e">signature</a> = data;</div>
<div class="line"><span class="lineno"> 2341</span>      <span class="keywordflow">if</span> (apply_DER_encoding_to_ECSIG(signature, &amp;signature_len) == <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 2342</span>        <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Failed to apply DER encoding to ECDSA signature&quot;</span>);</div>
<div class="line"><span class="lineno"> 2343</span>        <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a> = <a class="code hl_define" href="pkcs11_8h.html#a91150ecacbaa624fcc7d861f1b54f57c">CKR_FUNCTION_FAILED</a>;</div>
<div class="line"><span class="lineno"> 2344</span>        <span class="keywordflow">goto</span> pv_failure;</div>
<div class="line"><span class="lineno"> 2345</span>      }</div>
<div class="line"><span class="lineno"> 2346</span>    }</div>
<div class="line"><span class="lineno"> 2347</span>    res = EVP_PKEY_verify(ctx, signature, signature_len, md, md_len);</div>
<div class="line"><span class="lineno"> 2348</span> </div>
<div class="line"><span class="lineno"> 2349</span>    <span class="keywordflow">if</span> (res == 1) {</div>
<div class="line"><span class="lineno"> 2350</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a> = <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>;</div>
<div class="line"><span class="lineno"> 2351</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (res == 0) {</div>
<div class="line"><span class="lineno"> 2352</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a> = <a class="code hl_define" href="pkcs11_8h.html#a4027a099409c7d9bbc650c766e605903">CKR_SIGNATURE_INVALID</a>;</div>
<div class="line"><span class="lineno"> 2353</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2354</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a> = <a class="code hl_define" href="pkcs11_8h.html#a91150ecacbaa624fcc7d861f1b54f57c">CKR_FUNCTION_FAILED</a>;</div>
<div class="line"><span class="lineno"> 2355</span>    }</div>
<div class="line"><span class="lineno"> 2356</span> </div>
<div class="line"><span class="lineno"> 2357</span>  pv_failure:</div>
<div class="line"><span class="lineno"> 2358</span>    <span class="keywordflow">if</span> (ctx != NULL) {</div>
<div class="line"><span class="lineno"> 2359</span>      EVP_PKEY_CTX_free(ctx);</div>
<div class="line"><span class="lineno"> 2360</span>      ctx = NULL;</div>
<div class="line"><span class="lineno"> 2361</span>    }</div>
<div class="line"><span class="lineno"> 2362</span> </div>
<div class="line"><span class="lineno"> 2363</span>    <span class="keywordflow">if</span> (key != NULL) {</div>
<div class="line"><span class="lineno"> 2364</span>      EVP_PKEY_free(key);</div>
<div class="line"><span class="lineno"> 2365</span>      key = NULL;</div>
<div class="line"><span class="lineno"> 2366</span>    }</div>
<div class="line"><span class="lineno"> 2367</span> </div>
<div class="line"><span class="lineno"> 2368</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a>;</div>
<div class="line"><span class="lineno"> 2369</span>  }</div>
<div class="line"><span class="lineno"> 2370</span> </div>
<div class="line"><span class="lineno"> 2371</span>  <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a91150ecacbaa624fcc7d861f1b54f57c">CKR_FUNCTION_FAILED</a>;</div>
<div class="line"><span class="lineno"> 2372</span>}</div>
<div class="ttc" id="anamespacefc_1_1ecc_html_a7c10bdf37d2fad7c122133f284e47f3e"><div class="ttname"><a href="namespacefc_1_1ecc.html#a7c10bdf37d2fad7c122133f284e47f3e">fc::ecc::signature</a></div><div class="ttdeci">fc::array&lt; char, 72 &gt; signature</div><div class="ttdef"><b>Definition</b> <a href="elliptic_8hpp_source.html#l00025">elliptic.hpp:25</a></div></div>
<div class="ttc" id="apkcs11_8h_html_a1740789d62501fea6688fb211b02d1a2"><div class="ttname"><a href="pkcs11_8h.html#a1740789d62501fea6688fb211b02d1a2">CKR_DATA_INVALID</a></div><div class="ttdeci">#define CKR_DATA_INVALID</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l01106">pkcs11.h:1106</a></div></div>
<div class="ttc" id="apkcs11_8h_html_a4027a099409c7d9bbc650c766e605903"><div class="ttname"><a href="pkcs11_8h.html#a4027a099409c7d9bbc650c766e605903">CKR_SIGNATURE_INVALID</a></div><div class="ttdeci">#define CKR_SIGNATURE_INVALID</div><div class="ttdef"><b>Definition</b> <a href="pkcs11_8h_source.html#l01144">pkcs11.h:1144</a></div></div>
<div class="ttc" id="astructverify__info_html_a1e8b3790ebac9ac474f5c7e932b228a0"><div class="ttname"><a href="structverify__info.html#a1e8b3790ebac9ac474f5c7e932b228a0">verify_info::key_id</a></div><div class="ttdeci">uint16_t key_id</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8h_source.html#l00094">yubihsm_pkcs11.h:94</a></div></div>
<div class="ttc" id="autil_8c_html_ad370ce9b010ffc168e85acb7c8412caf"><div class="ttname"><a href="util_8c.html#ad370ce9b010ffc168e85acb7c8412caf">parse_NID</a></div><div class="ttdeci">void parse_NID(uint8_t *data, uint16_t data_len, const EVP_MD **md_type, int *digestinfo_len)</div><div class="ttdef"><b>Definition</b> <a href="util_8c_source.html#l00452">util.c:452</a></div></div>
<div class="ttc" id="ayubihsm_8c_html_ab37ae2f7fc6857b420e173284130686d"><div class="ttname"><a href="yubihsm_8c.html#ab37ae2f7fc6857b420e173284130686d">yh_util_verify_hmac</a></div><div class="ttdeci">yh_rc yh_util_verify_hmac(yh_session *session, uint16_t key_id, const uint8_t *signature, size_t signature_len, const uint8_t *data, size_t data_len, bool *verified)</div><div class="ttdef"><b>Definition</b> <a href="yubihsm_8c_source.html#l01939">yubihsm.c:1939</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util__pkcs11_8h_ab17f6ba85432d715def5185e7832c9e8_cgraph.png" border="0" usemap="#autil__pkcs11_8h_ab17f6ba85432d715def5185e7832c9e8_cgraph" alt=""/></div>
<map name="autil__pkcs11_8h_ab17f6ba85432d715def5185e7832c9e8_cgraph" id="autil__pkcs11_8h_ab17f6ba85432d715def5185e7832c9e8_cgraph">
<area shape="rect" title=" " alt="" coords="5,153,110,179"/>
<area shape="rect" href="util__pkcs11_8c.html#a03746a942ba1eaafbec20b675463ee00" title=" " alt="" coords="158,5,348,31"/>
<area shape="poly" title=" " alt="" coords="63,152,98,97,124,66,156,40,164,35,167,40,159,44,128,70,102,100,68,154"/>
<area shape="rect" href="util__pkcs11_8c.html#a3f1010425d5308dfa15d696b4853c68c" title=" " alt="" coords="176,55,330,80"/>
<area shape="poly" title=" " alt="" coords="71,151,108,120,156,89,170,83,172,88,159,94,111,124,74,155"/>
<area shape="rect" href="util__pkcs11_8c.html#a3da5875af7a71b11ee5ead6b160d1ff4" title=" " alt="" coords="161,104,344,130"/>
<area shape="poly" title=" " alt="" coords="109,150,157,138,183,131,185,137,158,143,111,156"/>
<area shape="rect" href="structmechanism.html#afeb8198b0f33f94f4520c0ffbc584a9a" title=" " alt="" coords="171,153,334,179"/>
<area shape="poly" title=" " alt="" coords="110,164,156,164,156,169,110,169"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="822,256,893,282"/>
<area shape="poly" title=" " alt="" coords="106,177,158,189,326,212,457,221,589,229,758,248,807,256,806,261,757,253,589,234,457,227,325,218,157,194,105,182"/>
<area shape="rect" href="util_8c.html#ad370ce9b010ffc168e85acb7c8412caf" title=" " alt="" coords="211,304,295,330"/>
<area shape="poly" title=" " alt="" coords="68,178,102,233,128,264,159,291,197,306,195,311,156,295,124,268,97,236,63,181"/>
<area shape="rect" href="yubihsm_8c.html#ab37ae2f7fc6857b420e173284130686d" title=" " alt="" coords="184,255,322,280"/>
<area shape="poly" title=" " alt="" coords="76,177,113,205,159,233,190,247,188,251,156,238,110,209,73,182"/>
<area shape="poly" title=" " alt="" coords="322,265,807,266,807,271,322,270"/>
<area shape="rect" href="yubihsm_8c.html#a4c26f003b72e800e9c934bca922a404a" title=" " alt="" coords="396,305,544,331"/>
<area shape="poly" title=" " alt="" coords="312,278,398,299,397,304,311,284"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="816,355,899,380"/>
<area shape="poly" title=" " alt="" coords="323,277,349,289,365,302,374,316,383,329,397,341,448,367,490,379,593,390,675,397,757,390,800,382,801,387,758,395,675,402,592,395,489,384,446,372,395,346,379,333,370,319,361,306,347,294,321,282"/>
<area shape="rect" href="yubihsm_8c.html#a77870209747d5ccd90f9da3aae2bdfa8" title=" " alt="" coords="592,305,758,331"/>
<area shape="poly" title=" " alt="" coords="544,316,577,316,577,321,544,321"/>
<area shape="rect" href="yubihsm_8c.html#a0e96ea59c5f32def80843fec5a3c2142" title=" " alt="" coords="610,355,740,380"/>
<area shape="poly" title=" " alt="" coords="527,329,604,348,603,353,526,334"/>
<area shape="poly" title=" " alt="" coords="725,302,806,280,807,285,726,307"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="823,305,892,331"/>
<area shape="poly" title=" " alt="" coords="758,316,808,316,808,321,758,321"/>
<area shape="poly" title=" " alt="" coords="726,329,801,350,800,355,725,334"/>
<area shape="poly" title=" " alt="" coords="735,352,756,341,771,329,780,317,789,304,804,291,809,287,812,292,807,295,793,308,784,321,775,333,759,346,737,356"/>
<area shape="poly" title=" " alt="" coords="741,365,800,365,800,370,741,370"/>
<area shape="rect" href="rand_8c.html#a2d3d1e86f4093fbe0a1b2a7eede4cd75" title=" " alt="" coords="806,404,909,430"/>
<area shape="poly" title=" " alt="" coords="726,378,793,397,791,402,725,384"/>
</map>
</div>

</div>
</div>
<a id="a1a7af578cd3ef13f8ae12652086c7a18" name="a1a7af578cd3ef13f8ae12652086c7a18"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a7af578cd3ef13f8ae12652086c7a18">&#9670;&#160;</a></span>populate_template()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CK_RV populate_template </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>type</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>object</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pkcs11_8h.html#a5db3536793782f135785609e4a849fc6">CK_ATTRIBUTE_PTR</a></td>          <td class="paramname"><span class="paramname"><em>pTemplate</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pkcs11_8h.html#a35181858a3b7a0a81f49d180d8f446ef">CK_ULONG</a></td>          <td class="paramname"><span class="paramname"><em>ulCount</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structyh__session.html">yh_session</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="util__pkcs11_8c_source.html#l03872">3872</a> of file <a class="el" href="util__pkcs11_8c_source.html">util_pkcs11.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3873</span>                                                               {</div>
<div class="line"><span class="lineno"> 3874</span> </div>
<div class="line"><span class="lineno"> 3875</span>  CK_RV <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a> = <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>;</div>
<div class="line"><span class="lineno"> 3876</span> </div>
<div class="line"><span class="lineno"> 3877</span>  <span class="keywordflow">for</span> (<a class="code hl_typedef" href="pkcs11_8h.html#a35181858a3b7a0a81f49d180d8f446ef">CK_ULONG</a> i = 0; i &lt; <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a490d37150a3d116225298faf1cb780b6">ulCount</a>; i++) {</div>
<div class="line"><span class="lineno"> 3878</span>    <a class="code hl_define" href="debug__lib_8h.html#a8c4742440a149ad8bcb5d58ae76c5ed3">DBG_INFO</a>(<span class="stringliteral">&quot;Getting attribute 0x%lx&quot;</span>, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa4c2296db6853afc30383aec1a404972">pTemplate</a>[i].type);</div>
<div class="line"><span class="lineno"> 3879</span> </div>
<div class="line"><span class="lineno"> 3880</span>    <a class="code hl_typedef" href="pkcs11_8h.html#a88e8d2cf99e26f3b3f86a0a698b0ab64">CK_VOID_PTR</a> object_ptr;</div>
<div class="line"><span class="lineno"> 3881</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa4c2296db6853afc30383aec1a404972">pTemplate</a>[i].pValue == NULL) {</div>
<div class="line"><span class="lineno"> 3882</span>      <span class="comment">// NOTE(adma): just asking for the length</span></div>
<div class="line"><span class="lineno"> 3883</span>      object_ptr = NULL;</div>
<div class="line"><span class="lineno"> 3884</span>      <a class="code hl_define" href="debug__lib_8h.html#a8c4742440a149ad8bcb5d58ae76c5ed3">DBG_INFO</a>(<span class="stringliteral">&quot;Retrieving length&quot;</span>);</div>
<div class="line"><span class="lineno"> 3885</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3886</span>      <span class="comment">// NOTE(adma): actually get the attribute</span></div>
<div class="line"><span class="lineno"> 3887</span>      object_ptr = <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa4c2296db6853afc30383aec1a404972">pTemplate</a>[i].pValue;</div>
<div class="line"><span class="lineno"> 3888</span>      <a class="code hl_define" href="debug__lib_8h.html#a8c4742440a149ad8bcb5d58ae76c5ed3">DBG_INFO</a>(<span class="stringliteral">&quot;Retrieving attribute&quot;</span>);</div>
<div class="line"><span class="lineno"> 3889</span>    }</div>
<div class="line"><span class="lineno"> 3890</span> </div>
<div class="line"><span class="lineno"> 3891</span>    CK_RV attribute_rc;</div>
<div class="line"><span class="lineno"> 3892</span>    <span class="keywordflow">if</span> (type == <a class="code hl_define" href="yubihsm__pkcs11_8h.html#ae849403f78233718f9beeea0a8b4dfd9">ECDH_KEY_TYPE</a>) {</div>
<div class="line"><span class="lineno"> 3893</span>      <a class="code hl_struct" href="structecdh__session__key.html">ecdh_session_key</a> *key = <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a85d991d90970121ba1480cd98d93aab9">object</a>;</div>
<div class="line"><span class="lineno"> 3894</span>      attribute_rc =</div>
<div class="line"><span class="lineno"> 3895</span>        <a class="code hl_function" href="util__pkcs11_8c.html#a5c8c35826a58c280a290c49a5a1e5b03">get_attribute_ecsession_key</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa4c2296db6853afc30383aec1a404972">pTemplate</a>[i].type, key, object_ptr,</div>
<div class="line"><span class="lineno"> 3896</span>                                    &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa4c2296db6853afc30383aec1a404972">pTemplate</a>[i].ulValueLen);</div>
<div class="line"><span class="lineno"> 3897</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3898</span>      <a class="code hl_struct" href="structyubihsm__pkcs11__object__desc.html">yubihsm_pkcs11_object_desc</a> *desc = <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a85d991d90970121ba1480cd98d93aab9">object</a>;</div>
<div class="line"><span class="lineno"> 3899</span>      attribute_rc = <a class="code hl_function" href="util__pkcs11_8c.html#acc3b093830e7126a8655e9b8ec77ad10">get_attribute</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa4c2296db6853afc30383aec1a404972">pTemplate</a>[i].type, &amp;desc-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__object__desc.html#a6029acaef1678d77702d2c51fb75540a">object</a>, object_ptr,</div>
<div class="line"><span class="lineno"> 3900</span>                                   &amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa4c2296db6853afc30383aec1a404972">pTemplate</a>[i].ulValueLen, <a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>);</div>
<div class="line"><span class="lineno"> 3901</span>    }</div>
<div class="line"><span class="lineno"> 3902</span> </div>
<div class="line"><span class="lineno"> 3903</span>    <span class="keywordflow">if</span> (attribute_rc != <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>) {</div>
<div class="line"><span class="lineno"> 3904</span>      <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a> = attribute_rc;</div>
<div class="line"><span class="lineno"> 3905</span>      <span class="keywordflow">if</span> (attribute_rc == <a class="code hl_define" href="pkcs11_8h.html#a0afbefc1a4ce05ba5faea1778eb602ca">CKR_ATTRIBUTE_TYPE_INVALID</a>) {</div>
<div class="line"><span class="lineno"> 3906</span>        <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Unable to get attribute&quot;</span>);</div>
<div class="line"><span class="lineno"> 3907</span>      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (attribute_rc == <a class="code hl_define" href="pkcs11_8h.html#a9f2ea08f0e13c3fc129863fdd46352b6">CKR_BUFFER_TOO_SMALL</a>) {</div>
<div class="line"><span class="lineno"> 3908</span>        <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Skipping attribute because buffer is too small&quot;</span>);</div>
<div class="line"><span class="lineno"> 3909</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3910</span>        <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Get attribute failed. %s&quot;</span>, <a class="code hl_function" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b">yh_strerror</a>(attribute_rc));</div>
<div class="line"><span class="lineno"> 3911</span>      }</div>
<div class="line"><span class="lineno"> 3912</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3913</span>      <a class="code hl_define" href="debug__lib_8h.html#a8c4742440a149ad8bcb5d58ae76c5ed3">DBG_INFO</a>(<span class="stringliteral">&quot;Attribute/length successfully returned with length %lu&quot;</span>,</div>
<div class="line"><span class="lineno"> 3914</span>               <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#aa4c2296db6853afc30383aec1a404972">pTemplate</a>[i].ulValueLen);</div>
<div class="line"><span class="lineno"> 3915</span>    }</div>
<div class="line"><span class="lineno"> 3916</span> </div>
<div class="line"><span class="lineno"> 3917</span>    <span class="comment">// NOTE(adma): Array of attributes like CKA_WRAP_TEMPLATE are special</span></div>
<div class="line"><span class="lineno"> 3918</span>    <span class="comment">// cases.</span></div>
<div class="line"><span class="lineno"> 3919</span>    <span class="comment">/* In the special case of an attribute whose value is an array of</span></div>
<div class="line"><span class="lineno"> 3920</span><span class="comment">     * attributes, for example CKA_WRAP_TEMPLATE, where it is passed in with</span></div>
<div class="line"><span class="lineno"> 3921</span><span class="comment">     * pValue not NULL, then if the pValue of elements within the array is</span></div>
<div class="line"><span class="lineno"> 3922</span><span class="comment">     * NULL_PTR then the ulValueLen of elements within the array will be set</span></div>
<div class="line"><span class="lineno"> 3923</span><span class="comment">     * to the required length. If the pValue of elements within the array is</span></div>
<div class="line"><span class="lineno"> 3924</span><span class="comment">     * not NULL_PTR, then the ulValueLen element of attributes within the</span></div>
<div class="line"><span class="lineno"> 3925</span><span class="comment">     * array MUST reflect the space that the corresponding pValue points to,</span></div>
<div class="line"><span class="lineno"> 3926</span><span class="comment">     * and pValue is filled in if there is sufficient room. Therefore it is</span></div>
<div class="line"><span class="lineno"> 3927</span><span class="comment">     * important to initialize the contents of a buffer before calling</span></div>
<div class="line"><span class="lineno"> 3928</span><span class="comment">     * C_GetAttributeValue to get such an array value. If any ulValueLen</span></div>
<div class="line"><span class="lineno"> 3929</span><span class="comment">     * within the array isn&#39;t large enough, it will be set to</span></div>
<div class="line"><span class="lineno"> 3930</span><span class="comment">     * CK_UNAVAILABLE_INFORMATION and the function will return</span></div>
<div class="line"><span class="lineno"> 3931</span><span class="comment">     * CKR_BUFFER_TOO_SMALL, as it does if an attribute in the pTemplate</span></div>
<div class="line"><span class="lineno"> 3932</span><span class="comment">     * argument has ulValueLen too small. Note that any attribute whose value</span></div>
<div class="line"><span class="lineno"> 3933</span><span class="comment">     * is an array of attributes is identifiable by virtue of the attribute</span></div>
<div class="line"><span class="lineno"> 3934</span><span class="comment">     * type having the CKF_ARRAY_ATTRIBUTE bit set.*/</span></div>
<div class="line"><span class="lineno"> 3935</span>  }</div>
<div class="line"><span class="lineno"> 3936</span> </div>
<div class="line"><span class="lineno"> 3937</span>  <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a9dbb22e3510dddb1ebb576404a972e7d">rv</a>;</div>
<div class="line"><span class="lineno"> 3938</span>}</div>
<div class="ttc" id="autil__pkcs11_8c_html_a5c8c35826a58c280a290c49a5a1e5b03"><div class="ttname"><a href="util__pkcs11_8c.html#a5c8c35826a58c280a290c49a5a1e5b03">get_attribute_ecsession_key</a></div><div class="ttdeci">CK_RV get_attribute_ecsession_key(CK_ATTRIBUTE_TYPE type, ecdh_session_key *key, CK_VOID_PTR value, CK_ULONG_PTR length)</div><div class="ttdef"><b>Definition</b> <a href="util__pkcs11_8c_source.html#l01493">util_pkcs11.c:1493</a></div></div>
<div class="ttc" id="autil__pkcs11_8c_html_acc3b093830e7126a8655e9b8ec77ad10"><div class="ttname"><a href="util__pkcs11_8c.html#acc3b093830e7126a8655e9b8ec77ad10">get_attribute</a></div><div class="ttdeci">CK_RV get_attribute(CK_ATTRIBUTE_TYPE type, yh_object_descriptor *object, CK_VOID_PTR value, CK_ULONG_PTR length, yh_session *session)</div><div class="ttdef"><b>Definition</b> <a href="util__pkcs11_8c_source.html#l01455">util_pkcs11.c:1455</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8h_html_ae849403f78233718f9beeea0a8b4dfd9"><div class="ttname"><a href="yubihsm__pkcs11_8h.html#ae849403f78233718f9beeea0a8b4dfd9">ECDH_KEY_TYPE</a></div><div class="ttdeci">#define ECDH_KEY_TYPE</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8h_source.html#l00028">yubihsm_pkcs11.h:28</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util__pkcs11_8h_a1a7af578cd3ef13f8ae12652086c7a18_cgraph.png" border="0" usemap="#autil__pkcs11_8h_a1a7af578cd3ef13f8ae12652086c7a18_cgraph" alt=""/></div>
<map name="autil__pkcs11_8h_a1a7af578cd3ef13f8ae12652086c7a18_cgraph" id="autil__pkcs11_8h_a1a7af578cd3ef13f8ae12652086c7a18_cgraph">
<area shape="rect" title=" " alt="" coords="5,55,133,80"/>
<area shape="rect" href="util__pkcs11_8c.html#acc3b093830e7126a8655e9b8ec77ad10" title=" " alt="" coords="228,5,321,31"/>
<area shape="poly" title=" " alt="" coords="125,51,212,30,213,35,126,57"/>
<area shape="rect" href="util__pkcs11_8c.html#a5c8c35826a58c280a290c49a5a1e5b03" title=" " alt="" coords="181,55,368,80"/>
<area shape="poly" title=" " alt="" coords="133,65,165,65,165,70,133,70"/>
<area shape="rect" href="lib_2error_8c.html#a238eedb1e27dbff2a0ab9a3932eb3f8b" title=" " alt="" coords="233,104,316,130"/>
<area shape="poly" title=" " alt="" coords="126,78,218,101,217,106,125,84"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="416,55,487,80"/>
<area shape="poly" title=" " alt="" coords="369,65,401,65,401,70,369,70"/>
</map>
</div>

</div>
</div>
<a id="aa7658e32c6ee781921b7e80a9d1fe2f8" name="aa7658e32c6ee781921b7e80a9d1fe2f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa7658e32c6ee781921b7e80a9d1fe2f8">&#9670;&#160;</a></span>release_session()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void release_session </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__pkcs11__context.html">yubihsm_pkcs11_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structyubihsm__pkcs11__session.html">yubihsm_pkcs11_session</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="util__pkcs11_8c_source.html#l02850">2850</a> of file <a class="el" href="util__pkcs11_8c_source.html">util_pkcs11.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2851</span>                                                      {</div>
<div class="line"><span class="lineno"> 2852</span> </div>
<div class="line"><span class="lineno"> 2853</span>  <a class="code hl_function" href="util__pkcs11_8c.html#a3754cf5cb42a5e282658cf94f405574e">release_slot</a>(ctx, <a class="code hl_variable" href="ecdh__derive__test_8c.html#a0a2c7706d971796d7dc84fee36d6c84f">session</a>-&gt;slot);</div>
<div class="line"><span class="lineno"> 2854</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util__pkcs11_8h_aa7658e32c6ee781921b7e80a9d1fe2f8_cgraph.png" border="0" usemap="#autil__pkcs11_8h_aa7658e32c6ee781921b7e80a9d1fe2f8_cgraph" alt=""/></div>
<map name="autil__pkcs11_8h_aa7658e32c6ee781921b7e80a9d1fe2f8_cgraph" id="autil__pkcs11_8h_aa7658e32c6ee781921b7e80a9d1fe2f8_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,121,31"/>
<area shape="rect" href="util__pkcs11_8c.html#a3754cf5cb42a5e282658cf94f405574e" title=" " alt="" coords="169,5,260,31"/>
<area shape="poly" title=" " alt="" coords="121,16,153,16,153,21,121,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util__pkcs11_8h_aa7658e32c6ee781921b7e80a9d1fe2f8_icgraph.png" border="0" usemap="#autil__pkcs11_8h_aa7658e32c6ee781921b7e80a9d1fe2f8_icgraph" alt=""/></div>
<map name="autil__pkcs11_8h_aa7658e32c6ee781921b7e80a9d1fe2f8_icgraph" id="autil__pkcs11_8h_aa7658e32c6ee781921b7e80a9d1fe2f8_icgraph">
<area shape="rect" title=" " alt="" coords="228,55,343,80"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae42be1463b17c635f1d1db61afc0db16" title=" " alt="" coords="5,5,180,31"/>
<area shape="poly" title=" " alt="" coords="217,53,145,34,146,29,218,48"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#a43267eb905aa786de5a5bbf4bd08d775" title=" " alt="" coords="5,55,180,80"/>
<area shape="poly" title=" " alt="" coords="212,70,180,70,180,65,212,65"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#a011b512f4b9e6e43e3ab56b5534f3fde" title=" " alt="" coords="5,104,180,130"/>
<area shape="poly" title=" " alt="" coords="218,87,146,106,145,101,217,82"/>
</map>
</div>

</div>
</div>
<a id="a3754cf5cb42a5e282658cf94f405574e" name="a3754cf5cb42a5e282658cf94f405574e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3754cf5cb42a5e282658cf94f405574e">&#9670;&#160;</a></span>release_slot()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void release_slot </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__pkcs11__context.html">yubihsm_pkcs11_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structyubihsm__pkcs11__slot.html">yubihsm_pkcs11_slot</a> *</td>          <td class="paramname"><span class="paramname"><em>slot</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="util__pkcs11_8c_source.html#l02782">2782</a> of file <a class="el" href="util__pkcs11_8c_source.html">util_pkcs11.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2782</span>                                                                          {</div>
<div class="line"><span class="lineno"> 2783</span> </div>
<div class="line"><span class="lineno"> 2784</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__slot.html#a3ecfa0dfb39d722e9a0fad07a8d9334d">mutex</a> != NULL) {</div>
<div class="line"><span class="lineno"> 2785</span>    ctx-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__context.html#a1c6d1e9158ea469cdef15d6040318cc0">unlock_mutex</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a0209f1d92740f251d8686fd2d2a989e1">slot</a>-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__slot.html#a3ecfa0dfb39d722e9a0fad07a8d9334d">mutex</a>);</div>
<div class="line"><span class="lineno"> 2786</span>  }</div>
<div class="line"><span class="lineno"> 2787</span>}</div>
<div class="ttc" id="astructyubihsm__pkcs11__context_html_a1c6d1e9158ea469cdef15d6040318cc0"><div class="ttname"><a href="structyubihsm__pkcs11__context.html#a1c6d1e9158ea469cdef15d6040318cc0">yubihsm_pkcs11_context::unlock_mutex</a></div><div class="ttdeci">CK_UNLOCKMUTEX unlock_mutex</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8h_source.html#l00146">yubihsm_pkcs11.h:146</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util__pkcs11_8h_a3754cf5cb42a5e282658cf94f405574e_icgraph.png" border="0" usemap="#autil__pkcs11_8h_a3754cf5cb42a5e282658cf94f405574e_icgraph" alt=""/></div>
<map name="autil__pkcs11_8h_a3754cf5cb42a5e282658cf94f405574e_icgraph" id="autil__pkcs11_8h_a3754cf5cb42a5e282658cf94f405574e_icgraph">
<area shape="rect" title=" " alt="" coords="450,80,541,106"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#a48d97eeb2196fb96be0f0ba4c82d5063" title=" " alt="" coords="228,5,402,31"/>
<area shape="poly" title=" " alt="" coords="459,74,401,45,370,34,372,29,403,40,462,70"/>
<area shape="rect" href="util__pkcs11_8c.html#a85ea84ffb047281f34a733572f67b254" title=" " alt="" coords="261,55,369,80"/>
<area shape="poly" title=" " alt="" coords="434,87,369,78,370,72,435,82"/>
<area shape="rect" href="util__pkcs11_8c.html#a45da02427ecf4427e4c4c181bdd9891b" title=" " alt="" coords="269,104,360,130"/>
<area shape="poly" title=" " alt="" coords="435,104,361,113,361,108,434,98"/>
<area shape="rect" href="util__pkcs11_8c.html#aa7658e32c6ee781921b7e80a9d1fe2f8" title=" " alt="" coords="257,153,372,179"/>
<area shape="poly" title=" " alt="" coords="461,116,403,145,372,155,370,150,401,140,458,111"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae42be1463b17c635f1d1db61afc0db16" title=" " alt="" coords="5,55,180,80"/>
<area shape="poly" title=" " alt="" coords="245,70,180,70,180,65,245,65"/>
<area shape="poly" title=" " alt="" coords="253,106,153,84,154,78,254,101"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#a43267eb905aa786de5a5bbf4bd08d775" title=" " alt="" coords="5,153,180,179"/>
<area shape="poly" title=" " alt="" coords="254,133,154,155,153,150,253,128"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#a011b512f4b9e6e43e3ab56b5534f3fde" title=" " alt="" coords="5,104,180,130"/>
<area shape="poly" title=" " alt="" coords="253,120,180,120,180,114,253,114"/>
<area shape="poly" title=" " alt="" coords="241,152,226,144,211,132,201,118,193,106,178,94,156,83,158,78,181,89,197,102,206,115,215,128,229,140,244,147"/>
<area shape="poly" title=" " alt="" coords="242,169,180,169,180,164,242,164"/>
<area shape="poly" title=" " alt="" coords="241,153,153,133,154,128,243,148"/>
</map>
</div>

</div>
</div>
<a id="a7f93d30a54aef41540b4c31d8b2be064" name="a7f93d30a54aef41540b4c31d8b2be064"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f93d30a54aef41540b4c31d8b2be064">&#9670;&#160;</a></span>set_native_locking()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void set_native_locking </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__pkcs11__context.html">yubihsm_pkcs11_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="util__pkcs11_8c_source.html#l02916">2916</a> of file <a class="el" href="util__pkcs11_8c_source.html">util_pkcs11.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2916</span>                                                     {</div>
<div class="line"><span class="lineno"> 2917</span> </div>
<div class="line"><span class="lineno"> 2918</span>  ctx-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__context.html#a8fd07ddac920f2f93a360fb466b15e5f">create_mutex</a> = native_create_mutex;</div>
<div class="line"><span class="lineno"> 2919</span>  ctx-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__context.html#a7cf1c255226587a98fd93b5bb31b8fb4">destroy_mutex</a> = native_destroy_mutex;</div>
<div class="line"><span class="lineno"> 2920</span>  ctx-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__context.html#a499767227a12b9a3309bfd1220dc8ed9">lock_mutex</a> = native_lock_mutex;</div>
<div class="line"><span class="lineno"> 2921</span>  ctx-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__context.html#a1c6d1e9158ea469cdef15d6040318cc0">unlock_mutex</a> = native_unlock_mutex;</div>
<div class="line"><span class="lineno"> 2922</span>}</div>
<div class="ttc" id="astructyubihsm__pkcs11__context_html_a7cf1c255226587a98fd93b5bb31b8fb4"><div class="ttname"><a href="structyubihsm__pkcs11__context.html#a7cf1c255226587a98fd93b5bb31b8fb4">yubihsm_pkcs11_context::destroy_mutex</a></div><div class="ttdeci">CK_DESTROYMUTEX destroy_mutex</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8h_source.html#l00144">yubihsm_pkcs11.h:144</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util__pkcs11_8h_a7f93d30a54aef41540b4c31d8b2be064_icgraph.png" border="0" usemap="#autil__pkcs11_8h_a7f93d30a54aef41540b4c31d8b2be064_icgraph" alt=""/></div>
<map name="autil__pkcs11_8h_a7f93d30a54aef41540b4c31d8b2be064_icgraph" id="autil__pkcs11_8h_a7f93d30a54aef41540b4c31d8b2be064_icgraph">
<area shape="rect" title=" " alt="" coords="228,5,357,31"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#a553b528011491713b85dc590221ea616" title=" " alt="" coords="5,5,180,31"/>
<area shape="poly" title=" " alt="" coords="212,21,180,21,180,16,212,16"/>
</map>
</div>

</div>
</div>
<a id="a03b553175220c8747145497de5032100" name="a03b553175220c8747145497de5032100"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03b553175220c8747145497de5032100">&#9670;&#160;</a></span>set_template_attribute()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CK_RV set_template_attribute </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="yubihsm__pkcs11_8h.html#ade78776cf4e2dd3e25c4170aeb4edc63">yubihsm_pkcs11_attribute</a> *</td>          <td class="paramname"><span class="paramname"><em>attribute</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>value</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="util__pkcs11_8c_source.html#l02953">2953</a> of file <a class="el" href="util__pkcs11_8c_source.html">util_pkcs11.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2953</span>                                                                               {</div>
<div class="line"><span class="lineno"> 2954</span>  <span class="keywordflow">if</span> (*attribute == <a class="code hl_enumvalue" href="yubihsm__pkcs11_8h.html#ade78776cf4e2dd3e25c4170aeb4edc63a0f62ed9fb666d4152a3aca4662f9c6e7">ATTRIBUTE_NOT_SET</a>) {</div>
<div class="line"><span class="lineno"> 2955</span>    <span class="keywordflow">if</span> ((*(<a class="code hl_typedef" href="pkcs11_8h.html#a9dc289e62be691f41a9c6b875789b1f2">CK_BBOOL</a> *) <a class="code hl_define" href="pkcs11_8h.html#a32aff7c6c4cd253fdf6563677afab5ce">value</a>) == <span class="keyword">true</span>) {</div>
<div class="line"><span class="lineno"> 2956</span>      *attribute = <a class="code hl_enumvalue" href="yubihsm__pkcs11_8h.html#ade78776cf4e2dd3e25c4170aeb4edc63a4f7bc3f41284650799ceee38c4b55fad">ATTRIBUTE_TRUE</a>;</div>
<div class="line"><span class="lineno"> 2957</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2958</span>      *attribute = <a class="code hl_enumvalue" href="yubihsm__pkcs11_8h.html#ade78776cf4e2dd3e25c4170aeb4edc63aeb3ec728110a56f2e99435a1119562a8">ATTRIBUTE_FALSE</a>;</div>
<div class="line"><span class="lineno"> 2959</span>    }</div>
<div class="line"><span class="lineno"> 2960</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>;</div>
<div class="line"><span class="lineno"> 2961</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2962</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a98d78208707bfa2c51d6f051af1794e9">CKR_TEMPLATE_INCONSISTENT</a>;</div>
<div class="line"><span class="lineno"> 2963</span>  }</div>
<div class="line"><span class="lineno"> 2964</span>}</div>
<div class="ttc" id="ayubihsm__pkcs11_8h_html_ade78776cf4e2dd3e25c4170aeb4edc63a0f62ed9fb666d4152a3aca4662f9c6e7"><div class="ttname"><a href="yubihsm__pkcs11_8h.html#ade78776cf4e2dd3e25c4170aeb4edc63a0f62ed9fb666d4152a3aca4662f9c6e7">ATTRIBUTE_NOT_SET</a></div><div class="ttdeci">@ ATTRIBUTE_NOT_SET</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8h_source.html#l00172">yubihsm_pkcs11.h:172</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8h_html_ade78776cf4e2dd3e25c4170aeb4edc63a4f7bc3f41284650799ceee38c4b55fad"><div class="ttname"><a href="yubihsm__pkcs11_8h.html#ade78776cf4e2dd3e25c4170aeb4edc63a4f7bc3f41284650799ceee38c4b55fad">ATTRIBUTE_TRUE</a></div><div class="ttdeci">@ ATTRIBUTE_TRUE</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8h_source.html#l00174">yubihsm_pkcs11.h:174</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8h_html_ade78776cf4e2dd3e25c4170aeb4edc63aeb3ec728110a56f2e99435a1119562a8"><div class="ttname"><a href="yubihsm__pkcs11_8h.html#ade78776cf4e2dd3e25c4170aeb4edc63aeb3ec728110a56f2e99435a1119562a8">ATTRIBUTE_FALSE</a></div><div class="ttdeci">@ ATTRIBUTE_FALSE</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8h_source.html#l00173">yubihsm_pkcs11.h:173</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util__pkcs11_8h_a03b553175220c8747145497de5032100_icgraph.png" border="0" usemap="#autil__pkcs11_8h_a03b553175220c8747145497de5032100_icgraph" alt=""/></div>
<map name="autil__pkcs11_8h_a03b553175220c8747145497de5032100_icgraph" id="autil__pkcs11_8h_a03b553175220c8747145497de5032100_icgraph">
<area shape="rect" title=" " alt="" coords="328,153,478,179"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#a38dd348b8383c21c34929b6d73124029" title=" " alt="" coords="167,5,205,31"/>
<area shape="poly" title=" " alt="" coords="382,143,338,92,310,66,279,45,240,29,205,23,206,17,242,24,281,40,313,62,342,89,386,139"/>
<area shape="rect" href="util__pkcs11_8c.html#a2413ad4604ce34308256962fb1098ec7" title=" " alt="" coords="92,55,280,80"/>
<area shape="poly" title=" " alt="" coords="370,146,328,119,279,94,249,83,250,78,281,89,331,114,373,142"/>
<area shape="rect" href="util__pkcs11_8c.html#a67949ebcead5efdd41af1683033d525e" title=" " alt="" coords="120,104,252,130"/>
<area shape="poly" title=" " alt="" coords="328,152,245,133,246,128,329,147"/>
<area shape="rect" href="util__pkcs11_8c.html#a7bf21a80e49d821dfcc0b5e97c056a69" title=" " alt="" coords="111,153,261,179"/>
<area shape="poly" title=" " alt="" coords="312,169,261,169,261,164,312,164"/>
<area shape="rect" href="util__pkcs11_8c.html#a3ae0dc7de593ff0d92ff81baaae9d5cb" title=" " alt="" coords="118,203,254,244"/>
<area shape="poly" title=" " alt="" coords="338,186,255,208,253,203,336,181"/>
<area shape="rect" href="util__pkcs11_8c.html#ab6a02fb5fc61b638c0f202f561d42445" title=" " alt="" coords="118,268,254,294"/>
<area shape="poly" title=" " alt="" coords="378,191,335,225,281,258,250,270,248,265,279,253,332,221,375,187"/>
<area shape="rect" href="util__pkcs11_8c.html#a63b36e79f7eb240fe1de611008509389" title=" " alt="" coords="113,317,259,343"/>
<area shape="poly" title=" " alt="" coords="388,194,345,252,315,283,281,308,259,319,257,314,279,304,312,279,341,248,384,191"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#a77fecb6dade7b2f34dfa308233446aaf" title=" " alt="" coords="5,211,44,236"/>
<area shape="poly" title=" " alt="" coords="103,226,44,226,44,221,103,221"/>
</map>
</div>

</div>
</div>
<a id="a6959529c0513c47315e393d4e4827619" name="a6959529c0513c47315e393d4e4827619"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6959529c0513c47315e393d4e4827619">&#9670;&#160;</a></span>sign_mechanism_cleanup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool sign_mechanism_cleanup </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__pkcs11__op__info.html">yubihsm_pkcs11_op_info</a> *</td>          <td class="paramname"><span class="paramname"><em>op_info</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="util__pkcs11_8c_source.html#l02546">2546</a> of file <a class="el" href="util__pkcs11_8c_source.html">util_pkcs11.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2546</span>                                                             {</div>
<div class="line"><span class="lineno"> 2547</span> </div>
<div class="line"><span class="lineno"> 2548</span>  <span class="keywordflow">if</span> (op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#af6e088c2d57f2582d353bec69b48c023">sign</a>.<a class="code hl_variable" href="structsign__info.html#a575aca68f9e4dec0e3cc9de8bc560725">md_ctx</a> != NULL) {</div>
<div class="line"><span class="lineno"> 2549</span>    EVP_MD_CTX_destroy(op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#af6e088c2d57f2582d353bec69b48c023">sign</a>.<a class="code hl_variable" href="structsign__info.html#a575aca68f9e4dec0e3cc9de8bc560725">md_ctx</a>);</div>
<div class="line"><span class="lineno"> 2550</span>    op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#af6e088c2d57f2582d353bec69b48c023">sign</a>.<a class="code hl_variable" href="structsign__info.html#a575aca68f9e4dec0e3cc9de8bc560725">md_ctx</a> = NULL;</div>
<div class="line"><span class="lineno"> 2551</span>  }</div>
<div class="line"><span class="lineno"> 2552</span> </div>
<div class="line"><span class="lineno"> 2553</span>  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2554</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5a10abc0d61cfd172e37c78948354243" name="a5a10abc0d61cfd172e37c78948354243"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a10abc0d61cfd172e37c78948354243">&#9670;&#160;</a></span>validate_derive_key_attribute()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CK_RV validate_derive_key_attribute </td>
          <td>(</td>
          <td class="paramtype">CK_ATTRIBUTE_TYPE</td>          <td class="paramname"><span class="paramname"><em>type</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>value</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="util__pkcs11_8c_source.html#l03940">3940</a> of file <a class="el" href="util__pkcs11_8c_source.html">util_pkcs11.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3940</span>                                                                         {</div>
<div class="line"><span class="lineno"> 3941</span>  <span class="keywordflow">switch</span> (type) {</div>
<div class="line"><span class="lineno"> 3942</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#a05c1c460160443a739c6e0ce47ae3fc8">CKA_TOKEN</a>:</div>
<div class="line"><span class="lineno"> 3943</span>      <span class="keywordflow">if</span> (*((<a class="code hl_typedef" href="pkcs11_8h.html#a9dc289e62be691f41a9c6b875789b1f2">CK_BBOOL</a> *) <a class="code hl_define" href="pkcs11_8h.html#a32aff7c6c4cd253fdf6563677afab5ce">value</a>) == <a class="code hl_define" href="pkcs11_8h.html#a76edf786ed8cccb1b3d2cf9e9f0800cd">CK_TRUE</a>) {</div>
<div class="line"><span class="lineno"> 3944</span>        <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Derived key can only be a session object&quot;</span>);</div>
<div class="line"><span class="lineno"> 3945</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#ab818f05c56d56675438515a7ba5ebb70">CKR_ATTRIBUTE_VALUE_INVALID</a>;</div>
<div class="line"><span class="lineno"> 3946</span>      }</div>
<div class="line"><span class="lineno"> 3947</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3948</span> </div>
<div class="line"><span class="lineno"> 3949</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#af867d3ae9286fe0f8cab4995bb6af337">CKA_CLASS</a>:</div>
<div class="line"><span class="lineno"> 3950</span>      <span class="keywordflow">if</span> (*((<a class="code hl_typedef" href="pkcs11_8h.html#a2c6426aaa1ca6dd1f48a01b8490482fa">CK_ULONG_PTR</a>) <a class="code hl_define" href="pkcs11_8h.html#a32aff7c6c4cd253fdf6563677afab5ce">value</a>) != <a class="code hl_define" href="pkcs11_8h.html#a35306ac9f52ce0f9f45ac66b8bc4dcc7">CKO_SECRET_KEY</a>) {</div>
<div class="line"><span class="lineno"> 3951</span>        <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Derived key class is unsupported&quot;</span>);</div>
<div class="line"><span class="lineno"> 3952</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#ab818f05c56d56675438515a7ba5ebb70">CKR_ATTRIBUTE_VALUE_INVALID</a>;</div>
<div class="line"><span class="lineno"> 3953</span>      }</div>
<div class="line"><span class="lineno"> 3954</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3955</span> </div>
<div class="line"><span class="lineno"> 3956</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#aa438b88cbcb8a921288eeefba5613274">CKA_KEY_TYPE</a>:</div>
<div class="line"><span class="lineno"> 3957</span>      <span class="keywordflow">if</span> (*((<a class="code hl_typedef" href="pkcs11_8h.html#a2c6426aaa1ca6dd1f48a01b8490482fa">CK_ULONG_PTR</a>) <a class="code hl_define" href="pkcs11_8h.html#a32aff7c6c4cd253fdf6563677afab5ce">value</a>) != <a class="code hl_define" href="pkcs11_8h.html#aaf8c226acc7ea8b6b9e021465b1ae65b">CKK_GENERIC_SECRET</a>) {</div>
<div class="line"><span class="lineno"> 3958</span>        <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;Derived key type is unsupported&quot;</span>);</div>
<div class="line"><span class="lineno"> 3959</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#ab818f05c56d56675438515a7ba5ebb70">CKR_ATTRIBUTE_VALUE_INVALID</a>;</div>
<div class="line"><span class="lineno"> 3960</span>      }</div>
<div class="line"><span class="lineno"> 3961</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3962</span> </div>
<div class="line"><span class="lineno"> 3963</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="pkcs11_8h.html#acf37955a2a229d208289962c6f1183b8">CKA_EXTRACTABLE</a>:</div>
<div class="line"><span class="lineno"> 3964</span>      <span class="keywordflow">if</span> (*((<a class="code hl_typedef" href="pkcs11_8h.html#a9dc289e62be691f41a9c6b875789b1f2">CK_BBOOL</a> *) <a class="code hl_define" href="pkcs11_8h.html#a32aff7c6c4cd253fdf6563677afab5ce">value</a>) == <a class="code hl_define" href="pkcs11_8h.html#a1df8841072c48f0b511ccad3bbb25812">CK_FALSE</a>) {</div>
<div class="line"><span class="lineno"> 3965</span>        <a class="code hl_define" href="debug__lib_8h.html#a2e3ed21e5ffba18d940d164aaec64a2a">DBG_ERR</a>(<span class="stringliteral">&quot;The derived key will be extractable&quot;</span>);</div>
<div class="line"><span class="lineno"> 3966</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#ab818f05c56d56675438515a7ba5ebb70">CKR_ATTRIBUTE_VALUE_INVALID</a>;</div>
<div class="line"><span class="lineno"> 3967</span>      }</div>
<div class="line"><span class="lineno"> 3968</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3969</span> </div>
<div class="line"><span class="lineno"> 3970</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 3971</span>      <a class="code hl_define" href="debug__p11_8h.html#a83297f68021d78fbf8313d8f3570e5ac">DBG_WARN</a>(<span class="stringliteral">&quot;ECDH key derive template contains the ignored attribute: %lx&quot;</span>,</div>
<div class="line"><span class="lineno"> 3972</span>               type);</div>
<div class="line"><span class="lineno"> 3973</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3974</span>  }</div>
<div class="line"><span class="lineno"> 3975</span> </div>
<div class="line"><span class="lineno"> 3976</span>  <span class="keywordflow">return</span> <a class="code hl_define" href="pkcs11_8h.html#a41f4ccf8d6aeae2795be204b4f91c076">CKR_OK</a>;</div>
<div class="line"><span class="lineno"> 3977</span>}</div>
<div class="ttc" id="adebug__p11_8h_html_a83297f68021d78fbf8313d8f3570e5ac"><div class="ttname"><a href="debug__p11_8h.html#a83297f68021d78fbf8313d8f3570e5ac">DBG_WARN</a></div><div class="ttdeci">#define DBG_WARN(...)</div><div class="ttdef"><b>Definition</b> <a href="debug__p11_8h_source.html#l00036">debug_p11.h:36</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a16a62896091be5cd8b7537d7f01d3f21" name="a16a62896091be5cd8b7537d7f01d3f21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16a62896091be5cd8b7537d7f01d3f21">&#9670;&#160;</a></span>verify_mechanism_cleanup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool verify_mechanism_cleanup </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyubihsm__pkcs11__op__info.html">yubihsm_pkcs11_op_info</a> *</td>          <td class="paramname"><span class="paramname"><em>op_info</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="util__pkcs11_8c_source.html#l02556">2556</a> of file <a class="el" href="util__pkcs11_8c_source.html">util_pkcs11.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2556</span>                                                               {</div>
<div class="line"><span class="lineno"> 2557</span> </div>
<div class="line"><span class="lineno"> 2558</span>  <span class="keywordflow">if</span> (op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#a769d855aca7e13b69c58abd1de1bb410">verify</a>.<a class="code hl_variable" href="structverify__info.html#a920d34cab9f1b9ddcaf849d5b08c921d">md_ctx</a> != NULL) {</div>
<div class="line"><span class="lineno"> 2559</span>    EVP_MD_CTX_destroy(op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#a769d855aca7e13b69c58abd1de1bb410">verify</a>.<a class="code hl_variable" href="structverify__info.html#a920d34cab9f1b9ddcaf849d5b08c921d">md_ctx</a>);</div>
<div class="line"><span class="lineno"> 2560</span>    op_info-&gt;<a class="code hl_variable" href="structyubihsm__pkcs11__op__info.html#a2a88bfeb3f914ab4bc36697f02838057">op</a>.<a class="code hl_variable" href="unionop.html#a769d855aca7e13b69c58abd1de1bb410">verify</a>.<a class="code hl_variable" href="structverify__info.html#a920d34cab9f1b9ddcaf849d5b08c921d">md_ctx</a> = NULL;</div>
<div class="line"><span class="lineno"> 2561</span>  }</div>
<div class="line"><span class="lineno"> 2562</span> </div>
<div class="line"><span class="lineno"> 2563</span>  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2564</span>}</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_428556e0652617aa37d2f7d8bcaf7fdf.html">libraries</a></li><li class="navelem"><a class="el" href="dir_63c6fe01b05f3098165849fc89c17214.html">yubihsm</a></li><li class="navelem"><a class="el" href="dir_39ed0158acd1e5130b413442d29607b8.html">pkcs11</a></li><li class="navelem"><a class="el" href="util__pkcs11_8h.html">util_pkcs11.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0 </li>
  </ul>
</div>
</body>
</html>
