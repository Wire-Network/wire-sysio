\doxysection{authorization\+\_\+manager.\+cpp}
\hypertarget{authorization__manager_8cpp_source}{}\label{authorization__manager_8cpp_source}\index{libraries/chain/authorization\_manager.cpp@{libraries/chain/authorization\_manager.cpp}}
\mbox{\hyperlink{authorization__manager_8cpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00001}00001\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{authorization__manager_8hpp}{sysio/chain/authorization\_manager.hpp}}>}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00002}00002\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{chain_2include_2sysio_2chain_2exceptions_8hpp}{sysio/chain/exceptions.hpp}}>}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00003}00003\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{permission__object_8hpp}{sysio/chain/permission\_object.hpp}}>}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00004}00004\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{permission__link__object_8hpp}{sysio/chain/permission\_link\_object.hpp}}>}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00005}00005\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{authority__checker_8hpp}{sysio/chain/authority\_checker.hpp}}>}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00006}00006\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{controller_8hpp}{sysio/chain/controller.hpp}}>}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00007}00007\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{global__property__object_8hpp}{sysio/chain/global\_property\_object.hpp}}>}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00008}00008\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{contract__types_8hpp}{sysio/chain/contract\_types.hpp}}>}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00009}00009\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{generated__transaction__object_8hpp}{sysio/chain/generated\_transaction\_object.hpp}}>}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00010}00010\ \textcolor{preprocessor}{\#include\ <boost/tuple/tuple\_io.hpp>}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00011}00011\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{database__utils_8hpp}{sysio/chain/database\_utils.hpp}}>}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00012}00012\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{protocol__state__object_8hpp}{sysio/chain/protocol\_state\_object.hpp}}>}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00013}00013\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{deep__mind_8hpp}{sysio/chain/deep\_mind.hpp}}>}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00014}00014\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00015}00015\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00016}00016\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacesysio}{sysio}}\ \{\ \textcolor{keyword}{namespace\ }chain\ \{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00017}00017\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00018}\mbox{\hyperlink{namespacesysio_1_1chain_ac3f9d7d38aaf6d65c84a280e5ed40477}{00018}}\ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{classsysio_1_1chain_1_1index__set}{authorization\_index\_set}}\ =\ \mbox{\hyperlink{classsysio_1_1chain_1_1index__set}{index\_set}}<}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00019}00019\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesysio_1_1chain_a4e24a1668746342d40487d1019880986}{permission\_index}},}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00020}00020\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesysio_1_1chain_ad2f4ad05ff8f6e64102bf097f596589e}{permission\_usage\_index}},}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00021}00021\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesysio_1_1chain_a255011fa21760c6c73a1187a23d0afd1}{permission\_link\_index}}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00022}00022\ \ \ \ >;}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00023}00023\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00024}\mbox{\hyperlink{classsysio_1_1chain_1_1authorization__manager_a00571cdbafaf86b7de83655d89229280}{00024}}\ \ \ \ \mbox{\hyperlink{classsysio_1_1chain_1_1authorization__manager_a00571cdbafaf86b7de83655d89229280}{authorization\_manager::authorization\_manager}}(\mbox{\hyperlink{classsysio_1_1chain_1_1controller}{controller}}\&\ c,\ \mbox{\hyperlink{classchainbase_1_1database}{database}}\&\ d)}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00025}00025\ \ \ \ :\_control(c),\_db(\mbox{\hyperlink{yubihsm__pkcs11_8c_a107648633008a7f2d872b4b3d98c2f96}{d}})\{\}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00026}00026\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00027}\mbox{\hyperlink{classsysio_1_1chain_1_1authorization__manager_a112c1fae696fe6f53103076e9afa5a16}{00027}}\ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classsysio_1_1chain_1_1authorization__manager_a112c1fae696fe6f53103076e9afa5a16}{authorization\_manager::add\_indices}}()\ \{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00028}00028\ \ \ \ \ \ \ authorization\_index\_set::add\_indices(\_db);}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00029}00029\ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00030}00030\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00031}\mbox{\hyperlink{classsysio_1_1chain_1_1authorization__manager_a27cfd5f70c12c10a9939e7bf6b3a52e4}{00031}}\ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classsysio_1_1chain_1_1authorization__manager_a27cfd5f70c12c10a9939e7bf6b3a52e4}{authorization\_manager::initialize\_database}}()\ \{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00032}00032\ \ \ \ \ \ \ \_db.\mbox{\hyperlink{classchainbase_1_1database_adc8f336b33d7013d1b0400399b16c5a7}{create}}<\mbox{\hyperlink{classsysio_1_1chain_1_1permission__object}{permission\_object}}>([](\textcolor{keyword}{auto}\&)\{\});\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00033}00033\ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00034}00034\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00035}\mbox{\hyperlink{namespacesysio_1_1chain_1_1detail}{00035}}\ \ \ \ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacedetail}{detail}}\ \{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00036}00036\ \ \ \ \ \ \ \textcolor{keyword}{template}<>}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00037}\mbox{\hyperlink{structsysio_1_1chain_1_1detail_1_1snapshot__row__traits_3_01permission__object_01_4}{00037}}\ \ \ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structsysio_1_1chain_1_1detail_1_1snapshot__row__traits}{snapshot\_row\_traits}}<\mbox{\hyperlink{classsysio_1_1chain_1_1permission__object}{permission\_object}}>\ \{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00038}\mbox{\hyperlink{structsysio_1_1chain_1_1detail_1_1snapshot__row__traits_3_01permission__object_01_4_a0753180733352ef97bff8af354db0628}{00038}}\ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{classsysio_1_1chain_1_1permission__object}{value\_type}}\ =\ \mbox{\hyperlink{classsysio_1_1chain_1_1permission__object}{permission\_object}};}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00039}\mbox{\hyperlink{structsysio_1_1chain_1_1detail_1_1snapshot__row__traits_3_01permission__object_01_4_ab457384ceefd63ab4f150d39f3d9c6f0}{00039}}\ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{structsysio_1_1chain_1_1snapshot__permission__object}{snapshot\_type}}\ =\ \mbox{\hyperlink{structsysio_1_1chain_1_1snapshot__permission__object}{snapshot\_permission\_object}};}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00040}00040\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00041}\mbox{\hyperlink{structsysio_1_1chain_1_1detail_1_1snapshot__row__traits_3_01permission__object_01_4_a9e45fd801cd6f077e1025fb092a18223}{00041}}\ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{structsysio_1_1chain_1_1snapshot__permission__object}{snapshot\_permission\_object}}\ \mbox{\hyperlink{structsysio_1_1chain_1_1detail_1_1snapshot__row__traits_3_01permission__object_01_4_a9e45fd801cd6f077e1025fb092a18223}{to\_snapshot\_row}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classsysio_1_1chain_1_1permission__object}{permission\_object}}\&\ \mbox{\hyperlink{pkcs11_8h_a32aff7c6c4cd253fdf6563677afab5ce}{value}},\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classchainbase_1_1database}{chainbase::database}}\&\ db)\ \{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00042}00042\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structsysio_1_1chain_1_1snapshot__permission__object}{snapshot\_permission\_object}}\ res;}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00043}00043\ \ \ \ \ \ \ \ \ \ \ \ \ res.\mbox{\hyperlink{structsysio_1_1chain_1_1snapshot__permission__object_ab717b57132e2b8c47442468be92bd167}{name}}\ =\ \mbox{\hyperlink{pkcs11_8h_a32aff7c6c4cd253fdf6563677afab5ce}{value}}.\mbox{\hyperlink{structsysio_1_1chain_1_1name_a8847252c767dea5c3e8b60cc9d78505f}{name}};}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00044}00044\ \ \ \ \ \ \ \ \ \ \ \ \ res.\mbox{\hyperlink{structsysio_1_1chain_1_1snapshot__permission__object_aabb140f7580c588302dc3038e7ed83b8}{owner}}\ =\ \mbox{\hyperlink{pkcs11_8h_a32aff7c6c4cd253fdf6563677afab5ce}{value}}.owner;}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00045}00045\ \ \ \ \ \ \ \ \ \ \ \ \ res.\mbox{\hyperlink{structsysio_1_1chain_1_1snapshot__permission__object_a6252fb98de04b0a812b044bf78552386}{last\_updated}}\ =\ \mbox{\hyperlink{pkcs11_8h_a32aff7c6c4cd253fdf6563677afab5ce}{value}}.last\_updated;}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00046}00046\ \ \ \ \ \ \ \ \ \ \ \ \ res.\mbox{\hyperlink{structsysio_1_1chain_1_1snapshot__permission__object_a08632f1e4dd62a964d83f81cdbf7b522}{auth}}\ =\ \mbox{\hyperlink{pkcs11_8h_a32aff7c6c4cd253fdf6563677afab5ce}{value}}.auth.to\_authority();}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00047}00047\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00048}00048\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ lookup\ parent\ name}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00049}00049\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ parent\ =\ db.\mbox{\hyperlink{classchainbase_1_1database_afcfe00f81a526c1376d4f51197dd3a9a}{get}}(\mbox{\hyperlink{pkcs11_8h_a32aff7c6c4cd253fdf6563677afab5ce}{value}}.parent);}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00050}00050\ \ \ \ \ \ \ \ \ \ \ \ \ res.\mbox{\hyperlink{structsysio_1_1chain_1_1snapshot__permission__object_a369423725eb667c68b10d2653e07872e}{parent}}\ =\ parent.\mbox{\hyperlink{structsysio_1_1chain_1_1name_a8847252c767dea5c3e8b60cc9d78505f}{name}};}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00051}00051\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00052}00052\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ lookup\ the\ usage\ object}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00053}00053\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ usage\ =\ db.\mbox{\hyperlink{classchainbase_1_1database_afcfe00f81a526c1376d4f51197dd3a9a}{get}}<\mbox{\hyperlink{classsysio_1_1chain_1_1permission__usage__object}{permission\_usage\_object}}>(\mbox{\hyperlink{pkcs11_8h_a32aff7c6c4cd253fdf6563677afab5ce}{value}}.usage\_id);}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00054}00054\ \ \ \ \ \ \ \ \ \ \ \ \ res.\mbox{\hyperlink{structsysio_1_1chain_1_1snapshot__permission__object_ae88d394c8874eed2f4366c6aaa4b9803}{last\_used}}\ =\ usage.last\_used;}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00055}00055\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00056}00056\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ res;}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00057}00057\ \ \ \ \ \ \ \ \ \ \};}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00058}00058\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00059}\mbox{\hyperlink{structsysio_1_1chain_1_1detail_1_1snapshot__row__traits_3_01permission__object_01_4_ac900d123e7677aff1cbe872b65b04ee5}{00059}}\ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structsysio_1_1chain_1_1detail_1_1snapshot__row__traits_3_01permission__object_01_4_ac900d123e7677aff1cbe872b65b04ee5}{from\_snapshot\_row}}(\mbox{\hyperlink{structsysio_1_1chain_1_1snapshot__permission__object}{snapshot\_permission\_object}}\&\&\ row,\ \mbox{\hyperlink{classsysio_1_1chain_1_1permission__object}{permission\_object}}\&\ \mbox{\hyperlink{pkcs11_8h_a32aff7c6c4cd253fdf6563677afab5ce}{value}},\ \mbox{\hyperlink{classchainbase_1_1database}{chainbase::database}}\&\ db)\ \{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00060}00060\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{pkcs11_8h_a32aff7c6c4cd253fdf6563677afab5ce}{value}}.name\ =\ row.name;}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00061}00061\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{pkcs11_8h_a32aff7c6c4cd253fdf6563677afab5ce}{value}}.owner\ =\ row.owner;}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00062}00062\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{pkcs11_8h_a32aff7c6c4cd253fdf6563677afab5ce}{value}}.last\_updated\ =\ row.last\_updated;}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00063}00063\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{pkcs11_8h_a32aff7c6c4cd253fdf6563677afab5ce}{value}}.auth\ =\ row.auth;}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00064}00064\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00065}00065\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{pkcs11_8h_a32aff7c6c4cd253fdf6563677afab5ce}{value}}.parent\ =\ 0;}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00066}00066\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{pkcs11_8h_a32aff7c6c4cd253fdf6563677afab5ce}{value}}.id\ ==\ 0)\ \{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00067}00067\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{chain_2include_2sysio_2chain_2exceptions_8hpp_a40c2826a6fba35c1ffbf912bdf559792}{SYS\_ASSERT}}(row.parent\ ==\ \mbox{\hyperlink{structsysio_1_1chain_1_1name}{permission\_name}}(),\ snapshot\_exception,\ \textcolor{stringliteral}{"{}Unexpected\ parent\ name\ on\ reserved\ permission\ 0"{}});}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00068}00068\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{chain_2include_2sysio_2chain_2exceptions_8hpp_a40c2826a6fba35c1ffbf912bdf559792}{SYS\_ASSERT}}(row.name\ ==\ \mbox{\hyperlink{structsysio_1_1chain_1_1name}{permission\_name}}(),\ snapshot\_exception,\ \textcolor{stringliteral}{"{}Unexpected\ permission\ name\ on\ reserved\ permission\ 0"{}});}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00069}00069\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{chain_2include_2sysio_2chain_2exceptions_8hpp_a40c2826a6fba35c1ffbf912bdf559792}{SYS\_ASSERT}}(row.owner\ ==\ \mbox{\hyperlink{structsysio_1_1chain_1_1name}{name}}(),\ snapshot\_exception,\ \textcolor{stringliteral}{"{}Unexpected\ owner\ name\ on\ reserved\ permission\ 0"{}});}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00070}00070\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{chain_2include_2sysio_2chain_2exceptions_8hpp_a40c2826a6fba35c1ffbf912bdf559792}{SYS\_ASSERT}}(row.auth.accounts.size()\ ==\ 0,\ \ snapshot\_exception,\ \textcolor{stringliteral}{"{}Unexpected\ auth\ accounts\ on\ reserved\ permission\ 0"{}});}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00071}00071\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{chain_2include_2sysio_2chain_2exceptions_8hpp_a40c2826a6fba35c1ffbf912bdf559792}{SYS\_ASSERT}}(row.auth.keys.size()\ ==\ 0,\ \ snapshot\_exception,\ \textcolor{stringliteral}{"{}Unexpected\ auth\ keys\ on\ reserved\ permission\ 0"{}});}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00072}00072\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{chain_2include_2sysio_2chain_2exceptions_8hpp_a40c2826a6fba35c1ffbf912bdf559792}{SYS\_ASSERT}}(row.auth.waits.size()\ ==\ 0,\ \ snapshot\_exception,\ \textcolor{stringliteral}{"{}Unexpected\ auth\ waits\ on\ reserved\ permission\ 0"{}});}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00073}00073\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{chain_2include_2sysio_2chain_2exceptions_8hpp_a40c2826a6fba35c1ffbf912bdf559792}{SYS\_ASSERT}}(row.auth.threshold\ ==\ 0,\ \ snapshot\_exception,\ \textcolor{stringliteral}{"{}Unexpected\ auth\ threshold\ on\ reserved\ permission\ 0"{}});}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00074}00074\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{chain_2include_2sysio_2chain_2exceptions_8hpp_a40c2826a6fba35c1ffbf912bdf559792}{SYS\_ASSERT}}(row.last\_updated\ ==\ \mbox{\hyperlink{classfc_1_1time__point}{time\_point}}(),\ \ snapshot\_exception,\ \textcolor{stringliteral}{"{}Unexpected\ auth\ last\ updated\ on\ reserved\ permission\ 0"{}});}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00075}00075\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{pkcs11_8h_a32aff7c6c4cd253fdf6563677afab5ce}{value}}.parent\ =\ 0;}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00076}00076\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\ row.parent\ !=\ \mbox{\hyperlink{structsysio_1_1chain_1_1name}{permission\_name}}())\{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00077}00077\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ parent\ =\ db.\mbox{\hyperlink{classchainbase_1_1database_afcfe00f81a526c1376d4f51197dd3a9a}{get}}<\mbox{\hyperlink{classsysio_1_1chain_1_1permission__object}{permission\_object}},\ by\_owner>(boost::make\_tuple(row.owner,\ row.parent));}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00078}00078\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00079}00079\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{chain_2include_2sysio_2chain_2exceptions_8hpp_a40c2826a6fba35c1ffbf912bdf559792}{SYS\_ASSERT}}(parent.id\ !=\ 0,\ snapshot\_exception,\ \textcolor{stringliteral}{"{}Unexpected\ mapping\ to\ reserved\ permission\ 0"{}});}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00080}00080\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{pkcs11_8h_a32aff7c6c4cd253fdf6563677afab5ce}{value}}.parent\ =\ parent.id;}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00081}00081\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00082}00082\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00083}00083\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{pkcs11_8h_a32aff7c6c4cd253fdf6563677afab5ce}{value}}.id\ !=\ 0)\ \{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00084}00084\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ create\ the\ usage\ object}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00085}00085\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ usage\ =\ db.\mbox{\hyperlink{classchainbase_1_1database_adc8f336b33d7013d1b0400399b16c5a7}{create}}<\mbox{\hyperlink{classsysio_1_1chain_1_1permission__usage__object}{permission\_usage\_object}}>([\&](\textcolor{keyword}{auto}\&\ \mbox{\hyperlink{bn_8cpp_a8b0eadcc506862e9d751ab45185053aa}{p}})\ \{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00086}00086\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{bn_8cpp_a8b0eadcc506862e9d751ab45185053aa}{p}}.last\_used\ =\ row.last\_used;}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00087}00087\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00088}00088\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{pkcs11_8h_a32aff7c6c4cd253fdf6563677afab5ce}{value}}.usage\_id\ =\ usage.id;}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00089}00089\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00090}00090\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{pkcs11_8h_a32aff7c6c4cd253fdf6563677afab5ce}{value}}.usage\_id\ =\ 0;}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00091}00091\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00092}00092\ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00093}00093\ \ \ \ \ \ \ \};}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00094}00094\ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00095}00095\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00096}\mbox{\hyperlink{classsysio_1_1chain_1_1authorization__manager_a24e23281d4ccfdddcc761c83e14a4080}{00096}}\ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classsysio_1_1chain_1_1authorization__manager_a24e23281d4ccfdddcc761c83e14a4080}{authorization\_manager::add\_to\_snapshot}}(\ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespacesysio_1_1chain_a80afaa06d96e661a0f93e0ba4b09c8dc}{snapshot\_writer\_ptr}}\&\ snapshot\ )\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00097}00097\ \ \ \ \ \ \ authorization\_index\_set::walk\_indices([\textcolor{keyword}{this},\ \&snapshot](\ \textcolor{keyword}{auto}\ utils\ )\{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00098}00098\ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{using\ }section\_t\ =\ \textcolor{keyword}{typename}\ \textcolor{keyword}{decltype}(utils)::index\_t::value\_type;}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00099}00099\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00100}00100\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ skip\ the\ permission\_usage\_index\ as\ its\ inlined\ with\ permission\_index}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00101}00101\ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (std::is\_same<section\_t,\ permission\_usage\_object>::value)\ \{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00102}00102\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00103}00103\ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00104}00104\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00105}00105\ \ \ \ \ \ \ \ \ \ snapshot-\/>write\_section<section\_t>([\textcolor{keyword}{this}](\ \textcolor{keyword}{auto}\&\ section\ )\{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00106}00106\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{decltype}(utils)::walk(\_db,\ [\textcolor{keyword}{this},\ \&section](\ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ \&row\ )\ \{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00107}00107\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ section.add\_row(row,\ \_db);}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00108}00108\ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00109}00109\ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00110}00110\ \ \ \ \ \ \ \});}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00111}00111\ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00112}00112\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00113}\mbox{\hyperlink{classsysio_1_1chain_1_1authorization__manager_a7a4d84d47bcd9069ab0c8d8f9f9ac5f3}{00113}}\ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classsysio_1_1chain_1_1authorization__manager_a7a4d84d47bcd9069ab0c8d8f9f9ac5f3}{authorization\_manager::read\_from\_snapshot}}(\ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespacesysio_1_1chain_aaa27dacddc54cea475602788c8e7a02c}{snapshot\_reader\_ptr}}\&\ snapshot\ )\ \{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00114}00114\ \ \ \ \ \ \ authorization\_index\_set::walk\_indices([\textcolor{keyword}{this},\ \&snapshot](\ \textcolor{keyword}{auto}\ utils\ )\{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00115}00115\ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{using\ }section\_t\ =\ \textcolor{keyword}{typename}\ \textcolor{keyword}{decltype}(utils)::index\_t::value\_type;}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00116}00116\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00117}00117\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ skip\ the\ permission\_usage\_index\ as\ its\ inlined\ with\ permission\_index}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00118}00118\ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (std::is\_same<section\_t,\ permission\_usage\_object>::value)\ \{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00119}00119\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00120}00120\ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00121}00121\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00122}00122\ \ \ \ \ \ \ \ \ \ snapshot-\/>read\_section<section\_t>([\textcolor{keyword}{this}](\ \textcolor{keyword}{auto}\&\ section\ )\ \{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00123}00123\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ more\ =\ !section.empty();}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00124}00124\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}(more)\ \{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00125}00125\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{decltype}(utils)::create(\_db,\ [\textcolor{keyword}{this},\ \&section,\ \&more](\ \textcolor{keyword}{auto}\ \&row\ )\ \{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00126}00126\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ more\ =\ section.read\_row(row,\ \_db);}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00127}00127\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00128}00128\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00129}00129\ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00130}00130\ \ \ \ \ \ \ \});}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00131}00131\ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00132}00132\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00133}\mbox{\hyperlink{classsysio_1_1chain_1_1authorization__manager_aac57733c5aa05c1c78a023a80b2f447f}{00133}}\ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classsysio_1_1chain_1_1permission__object}{permission\_object}}\&\ \mbox{\hyperlink{classsysio_1_1chain_1_1authorization__manager_aac57733c5aa05c1c78a023a80b2f447f}{authorization\_manager::create\_permission}}(\ \mbox{\hyperlink{structsysio_1_1chain_1_1name}{account\_name}}\ account,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00134}00134\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structsysio_1_1chain_1_1name}{permission\_name}}\ \mbox{\hyperlink{structsysio_1_1chain_1_1name}{name}},}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00135}00135\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classsysio_1_1chain_1_1authorization__manager_add79267df1f466480b18703845327a78}{permission\_id\_type}}\ parent,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00136}00136\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structsysio_1_1chain_1_1authority}{authority}}\&\ auth,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00137}00137\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classfc_1_1time__point}{time\_point}}\ initial\_creation\_time}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00138}00138\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00139}00139\ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00140}00140\ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structsysio_1_1chain_1_1key__weight}{key\_weight}}\&\ k:\ auth.\mbox{\hyperlink{structsysio_1_1chain_1_1authority_ae43c8d325b117257317c793fbb248770}{keys}})}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00141}00141\ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{chain_2include_2sysio_2chain_2exceptions_8hpp_a40c2826a6fba35c1ffbf912bdf559792}{SYS\_ASSERT}}(k.\mbox{\hyperlink{structsysio_1_1chain_1_1key__weight_ac0d64507dc98ab3078451bf7675b59e9}{key}}.\mbox{\hyperlink{classfc_1_1crypto_1_1public__key_aa96a2da856cbba914572aa8629c06c09}{which}}()\ <\ \_db.\mbox{\hyperlink{classchainbase_1_1database_afcfe00f81a526c1376d4f51197dd3a9a}{get}}<\mbox{\hyperlink{classsysio_1_1chain_1_1protocol__state__object}{protocol\_state\_object}}>().\mbox{\hyperlink{classsysio_1_1chain_1_1protocol__state__object_af0f14fd2383a20afd49de85013402cdc}{num\_supported\_key\_types}},\ unactivated\_key\_type,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00142}00142\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Unactivated\ key\ type\ used\ when\ creating\ permission"{}});}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00143}00143\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00144}00144\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ creation\_time\ =\ initial\_creation\_time;}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00145}00145\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ creation\_time\ ==\ \mbox{\hyperlink{classfc_1_1time__point}{time\_point}}()\ )\ \{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00146}00146\ \ \ \ \ \ \ \ \ \ creation\_time\ =\ \_control.\mbox{\hyperlink{classsysio_1_1chain_1_1controller_abb1d81f96986df3bce46bd37caaf6a69}{pending\_block\_time}}();}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00147}00147\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00148}00148\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00149}00149\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ perm\_usage\ =\ \_db.\mbox{\hyperlink{classchainbase_1_1database_adc8f336b33d7013d1b0400399b16c5a7}{create}}<\mbox{\hyperlink{classsysio_1_1chain_1_1permission__usage__object}{permission\_usage\_object}}>([\&](\textcolor{keyword}{auto}\&\ \mbox{\hyperlink{bn_8cpp_a8b0eadcc506862e9d751ab45185053aa}{p}})\ \{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00150}00150\ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{bn_8cpp_a8b0eadcc506862e9d751ab45185053aa}{p}}.last\_used\ =\ creation\_time;}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00151}00151\ \ \ \ \ \ \ \});}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00152}00152\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00153}00153\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ perm\ =\ \_db.\mbox{\hyperlink{classchainbase_1_1database_adc8f336b33d7013d1b0400399b16c5a7}{create}}<\mbox{\hyperlink{classsysio_1_1chain_1_1permission__object}{permission\_object}}>([\&](\textcolor{keyword}{auto}\&\ \mbox{\hyperlink{bn_8cpp_a8b0eadcc506862e9d751ab45185053aa}{p}})\ \{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00154}00154\ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{bn_8cpp_a8b0eadcc506862e9d751ab45185053aa}{p}}.usage\_id\ \ \ \ \ =\ perm\_usage.id;}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00155}00155\ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{bn_8cpp_a8b0eadcc506862e9d751ab45185053aa}{p}}.parent\ \ \ \ \ \ \ =\ parent;}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00156}00156\ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{bn_8cpp_a8b0eadcc506862e9d751ab45185053aa}{p}}.owner\ \ \ \ \ \ \ \ =\ account;}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00157}00157\ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{bn_8cpp_a8b0eadcc506862e9d751ab45185053aa}{p}}.name\ \ \ \ \ \ \ \ \ =\ \mbox{\hyperlink{catch__reporter__console_8cpp_a9b45b3e13bd9167aab02e17e08916231}{name}};}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00158}00158\ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{bn_8cpp_a8b0eadcc506862e9d751ab45185053aa}{p}}.last\_updated\ =\ creation\_time;}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00159}00159\ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{bn_8cpp_a8b0eadcc506862e9d751ab45185053aa}{p}}.auth\ \ \ \ \ \ \ \ \ =\ auth;}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00160}00160\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00161}00161\ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\textcolor{keyword}{auto}\ dm\_logger\ =\ \_control.\mbox{\hyperlink{classsysio_1_1chain_1_1controller_a4f6404b355a3a4bf7fb60c92e85443d1}{get\_deep\_mind\_logger}}())\ \{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00162}00162\ \ \ \ \ \ \ \ \ \ \ \ \ dm\_logger-\/>on\_create\_permission(\mbox{\hyperlink{bn_8cpp_a8b0eadcc506862e9d751ab45185053aa}{p}});}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00163}00163\ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00164}00164\ \ \ \ \ \ \ \});}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00165}00165\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ perm;}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00166}00166\ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00167}00167\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00168}\mbox{\hyperlink{classsysio_1_1chain_1_1authorization__manager_a258e0daa2cd72440bfe34a2aa92c9104}{00168}}\ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classsysio_1_1chain_1_1permission__object}{permission\_object}}\&\ \mbox{\hyperlink{classsysio_1_1chain_1_1authorization__manager_aac57733c5aa05c1c78a023a80b2f447f}{authorization\_manager::create\_permission}}(\ \mbox{\hyperlink{structsysio_1_1chain_1_1name}{account\_name}}\ account,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00169}00169\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structsysio_1_1chain_1_1name}{permission\_name}}\ \mbox{\hyperlink{structsysio_1_1chain_1_1name}{name}},}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00170}00170\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classsysio_1_1chain_1_1authorization__manager_add79267df1f466480b18703845327a78}{permission\_id\_type}}\ parent,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00171}00171\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structsysio_1_1chain_1_1authority}{authority}}\&\&\ auth,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00172}00172\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classfc_1_1time__point}{time\_point}}\ initial\_creation\_time}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00173}00173\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00174}00174\ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00175}00175\ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structsysio_1_1chain_1_1key__weight}{key\_weight}}\&\ k:\ auth.keys)}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00176}00176\ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{chain_2include_2sysio_2chain_2exceptions_8hpp_a40c2826a6fba35c1ffbf912bdf559792}{SYS\_ASSERT}}(k.\mbox{\hyperlink{structsysio_1_1chain_1_1key__weight_ac0d64507dc98ab3078451bf7675b59e9}{key}}.\mbox{\hyperlink{classfc_1_1crypto_1_1public__key_aa96a2da856cbba914572aa8629c06c09}{which}}()\ <\ \_db.\mbox{\hyperlink{classchainbase_1_1database_afcfe00f81a526c1376d4f51197dd3a9a}{get}}<\mbox{\hyperlink{classsysio_1_1chain_1_1protocol__state__object}{protocol\_state\_object}}>().\mbox{\hyperlink{classsysio_1_1chain_1_1protocol__state__object_af0f14fd2383a20afd49de85013402cdc}{num\_supported\_key\_types}},\ unactivated\_key\_type,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00177}00177\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Unactivated\ key\ type\ used\ when\ creating\ permission"{}});}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00178}00178\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00179}00179\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ creation\_time\ =\ initial\_creation\_time;}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00180}00180\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ creation\_time\ ==\ \mbox{\hyperlink{classfc_1_1time__point}{time\_point}}()\ )\ \{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00181}00181\ \ \ \ \ \ \ \ \ \ creation\_time\ =\ \_control.\mbox{\hyperlink{classsysio_1_1chain_1_1controller_abb1d81f96986df3bce46bd37caaf6a69}{pending\_block\_time}}();}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00182}00182\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00183}00183\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00184}00184\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ perm\_usage\ =\ \_db.\mbox{\hyperlink{classchainbase_1_1database_adc8f336b33d7013d1b0400399b16c5a7}{create}}<\mbox{\hyperlink{classsysio_1_1chain_1_1permission__usage__object}{permission\_usage\_object}}>([\&](\textcolor{keyword}{auto}\&\ \mbox{\hyperlink{bn_8cpp_a8b0eadcc506862e9d751ab45185053aa}{p}})\ \{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00185}00185\ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{bn_8cpp_a8b0eadcc506862e9d751ab45185053aa}{p}}.last\_used\ =\ creation\_time;}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00186}00186\ \ \ \ \ \ \ \});}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00187}00187\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00188}00188\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ perm\ =\ \_db.\mbox{\hyperlink{classchainbase_1_1database_adc8f336b33d7013d1b0400399b16c5a7}{create}}<\mbox{\hyperlink{classsysio_1_1chain_1_1permission__object}{permission\_object}}>([\&](\textcolor{keyword}{auto}\&\ \mbox{\hyperlink{bn_8cpp_a8b0eadcc506862e9d751ab45185053aa}{p}})\ \{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00189}00189\ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{bn_8cpp_a8b0eadcc506862e9d751ab45185053aa}{p}}.usage\_id\ \ \ \ \ =\ perm\_usage.id;}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00190}00190\ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{bn_8cpp_a8b0eadcc506862e9d751ab45185053aa}{p}}.parent\ \ \ \ \ \ \ =\ parent;}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00191}00191\ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{bn_8cpp_a8b0eadcc506862e9d751ab45185053aa}{p}}.owner\ \ \ \ \ \ \ \ =\ account;}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00192}00192\ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{bn_8cpp_a8b0eadcc506862e9d751ab45185053aa}{p}}.name\ \ \ \ \ \ \ \ \ =\ \mbox{\hyperlink{catch__reporter__console_8cpp_a9b45b3e13bd9167aab02e17e08916231}{name}};}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00193}00193\ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{bn_8cpp_a8b0eadcc506862e9d751ab45185053aa}{p}}.last\_updated\ =\ creation\_time;}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00194}00194\ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{bn_8cpp_a8b0eadcc506862e9d751ab45185053aa}{p}}.auth\ \ \ \ \ \ \ \ \ =\ std::move(auth);}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00195}00195\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00196}00196\ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\textcolor{keyword}{auto}\ dm\_logger\ =\ \_control.\mbox{\hyperlink{classsysio_1_1chain_1_1controller_a4f6404b355a3a4bf7fb60c92e85443d1}{get\_deep\_mind\_logger}}())\ \{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00197}00197\ \ \ \ \ \ \ \ \ \ \ \ \ dm\_logger-\/>on\_create\_permission(\mbox{\hyperlink{bn_8cpp_a8b0eadcc506862e9d751ab45185053aa}{p}});}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00198}00198\ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00199}00199\ \ \ \ \ \ \ \});}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00200}00200\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ perm;}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00201}00201\ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00202}00202\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00203}\mbox{\hyperlink{classsysio_1_1chain_1_1authorization__manager_abf01ddda4cd475bf2530ad1d28c72dfb}{00203}}\ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classsysio_1_1chain_1_1authorization__manager_abf01ddda4cd475bf2530ad1d28c72dfb}{authorization\_manager::modify\_permission}}(\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classsysio_1_1chain_1_1permission__object}{permission\_object}}\&\ permission,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structsysio_1_1chain_1_1authority}{authority}}\&\ auth\ )\ \{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00204}00204\ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structsysio_1_1chain_1_1key__weight}{key\_weight}}\&\ k:\ auth.\mbox{\hyperlink{structsysio_1_1chain_1_1authority_ae43c8d325b117257317c793fbb248770}{keys}})}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00205}00205\ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{chain_2include_2sysio_2chain_2exceptions_8hpp_a40c2826a6fba35c1ffbf912bdf559792}{SYS\_ASSERT}}(k.\mbox{\hyperlink{structsysio_1_1chain_1_1key__weight_ac0d64507dc98ab3078451bf7675b59e9}{key}}.\mbox{\hyperlink{classfc_1_1crypto_1_1public__key_aa96a2da856cbba914572aa8629c06c09}{which}}()\ <\ \_db.\mbox{\hyperlink{classchainbase_1_1database_afcfe00f81a526c1376d4f51197dd3a9a}{get}}<\mbox{\hyperlink{classsysio_1_1chain_1_1protocol__state__object}{protocol\_state\_object}}>().\mbox{\hyperlink{classsysio_1_1chain_1_1protocol__state__object_af0f14fd2383a20afd49de85013402cdc}{num\_supported\_key\_types}},\ unactivated\_key\_type,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00206}00206\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Unactivated\ key\ type\ used\ when\ modifying\ permission"{}});}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00207}00207\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00208}00208\ \ \ \ \ \ \ \_db.\mbox{\hyperlink{classchainbase_1_1database_a9ebc006075e8fc2e84357a0e068b58d4}{modify}}(\ permission,\ [\&](\mbox{\hyperlink{classsysio_1_1chain_1_1permission__object}{permission\_object}}\&\ po)\ \{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00209}00209\ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ dm\_logger\ =\ \_control.\mbox{\hyperlink{classsysio_1_1chain_1_1controller_a4f6404b355a3a4bf7fb60c92e85443d1}{get\_deep\_mind\_logger}}();}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00210}00210\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00211}00211\ \ \ \ \ \ \ \ \ \ std::optional<permission\_object>\ old\_permission;}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00212}00212\ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (dm\_logger)\ \{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00213}00213\ \ \ \ \ \ \ \ \ \ \ \ \ old\_permission\ =\ po;}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00214}00214\ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00215}00215\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00216}00216\ \ \ \ \ \ \ \ \ \ po.auth\ =\ auth;}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00217}00217\ \ \ \ \ \ \ \ \ \ po.last\_updated\ =\ \_control.\mbox{\hyperlink{classsysio_1_1chain_1_1controller_abb1d81f96986df3bce46bd37caaf6a69}{pending\_block\_time}}();}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00218}00218\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00219}00219\ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\textcolor{keyword}{auto}\ dm\_logger\ =\ \_control.\mbox{\hyperlink{classsysio_1_1chain_1_1controller_a4f6404b355a3a4bf7fb60c92e85443d1}{get\_deep\_mind\_logger}}())\ \{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00220}00220\ \ \ \ \ \ \ \ \ \ \ \ \ dm\_logger-\/>on\_modify\_permission(*old\_permission,\ po);}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00221}00221\ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00222}00222\ \ \ \ \ \ \ \});}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00223}00223\ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00224}00224\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00225}\mbox{\hyperlink{classsysio_1_1chain_1_1authorization__manager_a9c889c94c63b7c53a5b4919738d6166b}{00225}}\ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classsysio_1_1chain_1_1authorization__manager_a9c889c94c63b7c53a5b4919738d6166b}{authorization\_manager::remove\_permission}}(\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classsysio_1_1chain_1_1permission__object}{permission\_object}}\&\ permission\ )\ \{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00226}00226\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ index\ =\ \_db.template\ \mbox{\hyperlink{namespacefc_ae009b19d1fecf5979996e9f326cd98c3}{get\_index<permission\_index,\ by\_parent>}}();}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00227}00227\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ range\ =\ index.equal\_range(permission.id);}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00228}00228\ \ \ \ \ \ \ \mbox{\hyperlink{chain_2include_2sysio_2chain_2exceptions_8hpp_a40c2826a6fba35c1ffbf912bdf559792}{SYS\_ASSERT}}(\ range.first\ ==\ range.second,\ \mbox{\hyperlink{namespacesysio_1_1chain_a764b50974b9b72a0e233e72176913d6b}{action\_validate\_exception}},}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00229}00229\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Cannot\ remove\ a\ permission\ which\ has\ children.\ Remove\ the\ children\ first."{}});}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00230}00230\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00231}00231\ \ \ \ \ \ \ \_db.\mbox{\hyperlink{classchainbase_1_1database_afaea057692a8bbbf3f506b64c60308b6}{get\_mutable\_index}}<\mbox{\hyperlink{namespacesysio_1_1chain_ad2f4ad05ff8f6e64102bf097f596589e}{permission\_usage\_index}}>().remove\_object(\ permission.usage\_id.\_id\ );}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00232}00232\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00233}00233\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\textcolor{keyword}{auto}\ dm\_logger\ =\ \_control.\mbox{\hyperlink{classsysio_1_1chain_1_1controller_a4f6404b355a3a4bf7fb60c92e85443d1}{get\_deep\_mind\_logger}}())\ \{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00234}00234\ \ \ \ \ \ \ \ \ \ dm\_logger-\/>on\_remove\_permission(permission);}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00235}00235\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00236}00236\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00237}00237\ \ \ \ \ \ \ \_db.\mbox{\hyperlink{classchainbase_1_1database_ac6bb29708e4fdfb6899028e3c351fe0b}{remove}}(\ permission\ );}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00238}00238\ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00239}00239\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00240}\mbox{\hyperlink{classsysio_1_1chain_1_1authorization__manager_a6755c0b39298b2933eb4e74649a36442}{00240}}\ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classsysio_1_1chain_1_1authorization__manager_a6755c0b39298b2933eb4e74649a36442}{authorization\_manager::update\_permission\_usage}}(\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classsysio_1_1chain_1_1permission__object}{permission\_object}}\&\ permission\ )\ \{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00241}00241\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ puo\ =\ \_db.\mbox{\hyperlink{classchainbase_1_1database_afcfe00f81a526c1376d4f51197dd3a9a}{get}}<\mbox{\hyperlink{classsysio_1_1chain_1_1permission__usage__object}{permission\_usage\_object}},\ by\_id>(\ permission.usage\_id\ );}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00242}00242\ \ \ \ \ \ \ \_db.\mbox{\hyperlink{classchainbase_1_1database_a9ebc006075e8fc2e84357a0e068b58d4}{modify}}(\ puo,\ [\&](\mbox{\hyperlink{classsysio_1_1chain_1_1permission__usage__object}{permission\_usage\_object}}\&\ \mbox{\hyperlink{bn_8cpp_a8b0eadcc506862e9d751ab45185053aa}{p}})\ \{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00243}00243\ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{bn_8cpp_a8b0eadcc506862e9d751ab45185053aa}{p}}.last\_used\ =\ \_control.\mbox{\hyperlink{classsysio_1_1chain_1_1controller_abb1d81f96986df3bce46bd37caaf6a69}{pending\_block\_time}}();}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00244}00244\ \ \ \ \ \ \ \});}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00245}00245\ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00246}00246\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00247}\mbox{\hyperlink{classsysio_1_1chain_1_1authorization__manager_a0909c7f81928fd8ffc4269861d12ad3f}{00247}}\ \ \ \ \mbox{\hyperlink{classfc_1_1time__point}{fc::time\_point}}\ \mbox{\hyperlink{classsysio_1_1chain_1_1authorization__manager_a0909c7f81928fd8ffc4269861d12ad3f}{authorization\_manager::get\_permission\_last\_used}}(\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classsysio_1_1chain_1_1permission__object}{permission\_object}}\&\ permission\ )\textcolor{keyword}{const\ }\{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00248}00248\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \_db.\mbox{\hyperlink{classchainbase_1_1database_afcfe00f81a526c1376d4f51197dd3a9a}{get}}<\mbox{\hyperlink{classsysio_1_1chain_1_1permission__usage__object}{permission\_usage\_object}},\ by\_id>(\ permission.usage\_id\ ).last\_used;}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00249}00249\ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00250}00250\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00251}\mbox{\hyperlink{classsysio_1_1chain_1_1authorization__manager_ab0acfec50b75044030d082d1aa3fbf5c}{00251}}\ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classsysio_1_1chain_1_1permission__object}{permission\_object}}*\ \ \mbox{\hyperlink{classsysio_1_1chain_1_1authorization__manager_ab0acfec50b75044030d082d1aa3fbf5c}{authorization\_manager::find\_permission}}(\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structsysio_1_1chain_1_1permission__level}{permission\_level}}\&\ level\ )\textcolor{keyword}{const}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00252}00252\ \textcolor{keyword}{\ \ \ }\{\ \textcolor{keywordflow}{try}\ \{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00253}00253\ \ \ \ \ \ \ \mbox{\hyperlink{chain_2include_2sysio_2chain_2exceptions_8hpp_a40c2826a6fba35c1ffbf912bdf559792}{SYS\_ASSERT}}(\ !level.actor.empty()\ \&\&\ !level.permission.empty(),\ invalid\_permission,\ \textcolor{stringliteral}{"{}Invalid\ permission"{}}\ );}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00254}00254\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \_db.\mbox{\hyperlink{classchainbase_1_1database_aa5a2ca0da0092693ac49b36b7ec6817a}{find}}<\mbox{\hyperlink{classsysio_1_1chain_1_1permission__object}{permission\_object}},\ by\_owner>(\ boost::make\_tuple(level.actor,level.permission)\ );}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00255}00255\ \ \ \ \}\ \mbox{\hyperlink{chain_2include_2sysio_2chain_2exceptions_8hpp_a43bd817895cb757183fcecafc6ae7dc1}{SYS\_RETHROW\_EXCEPTIONS}}(\ chain::permission\_query\_exception,\ \textcolor{stringliteral}{"{}Failed\ to\ retrieve\ permission:\ \$\{level\}"{}},\ (\textcolor{stringliteral}{"{}level"{}},\ level)\ )\ \}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00256}00256\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00257}\mbox{\hyperlink{classsysio_1_1chain_1_1authorization__manager_a96924f6aca32a602e24d991d12278a69}{00257}}\ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classsysio_1_1chain_1_1permission__object}{permission\_object}}\&\ \ \mbox{\hyperlink{classsysio_1_1chain_1_1authorization__manager_a96924f6aca32a602e24d991d12278a69}{authorization\_manager::get\_permission}}(\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structsysio_1_1chain_1_1permission__level}{permission\_level}}\&\ level\ )\textcolor{keyword}{const}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00258}00258\ \textcolor{keyword}{\ \ \ }\{\ \textcolor{keywordflow}{try}\ \{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00259}00259\ \ \ \ \ \ \ \mbox{\hyperlink{chain_2include_2sysio_2chain_2exceptions_8hpp_a40c2826a6fba35c1ffbf912bdf559792}{SYS\_ASSERT}}(\ !level.actor.empty()\ \&\&\ !level.permission.empty(),\ invalid\_permission,\ \textcolor{stringliteral}{"{}Invalid\ permission"{}}\ );}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00260}00260\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \_db.\mbox{\hyperlink{classchainbase_1_1database_afcfe00f81a526c1376d4f51197dd3a9a}{get}}<\mbox{\hyperlink{classsysio_1_1chain_1_1permission__object}{permission\_object}},\ by\_owner>(\ boost::make\_tuple(level.actor,level.permission)\ );}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00261}00261\ \ \ \ \}\ \mbox{\hyperlink{chain_2include_2sysio_2chain_2exceptions_8hpp_a43bd817895cb757183fcecafc6ae7dc1}{SYS\_RETHROW\_EXCEPTIONS}}(\ chain::permission\_query\_exception,\ \textcolor{stringliteral}{"{}Failed\ to\ retrieve\ permission:\ \$\{level\}"{}},\ (\textcolor{stringliteral}{"{}level"{}},\ level)\ )\ \}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00262}00262\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00263}00263\ \ \ \ std::optional<permission\_name>\ authorization\_manager::lookup\_linked\_permission(\ \mbox{\hyperlink{structsysio_1_1chain_1_1name}{account\_name}}\ authorizer\_account,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00264}00264\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structsysio_1_1chain_1_1name}{account\_name}}\ scope,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00265}00265\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesysio_1_1chain_a7a1685bcc352cda9e45f055932069428}{action\_name}}\ act\_name}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00266}00266\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )\textcolor{keyword}{const}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00267}00267\ \textcolor{keyword}{\ \ \ }\{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00268}00268\ \ \ \ \ \ \ \textcolor{keywordflow}{try}\ \{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00269}00269\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ First\ look\ up\ a\ specific\ link\ for\ this\ message\ act\_name}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00270}00270\ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ key\ =\ boost::make\_tuple(authorizer\_account,\ scope,\ act\_name);}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00271}00271\ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ link\ =\ \_db.\mbox{\hyperlink{classchainbase_1_1database_aa5a2ca0da0092693ac49b36b7ec6817a}{find}}<\mbox{\hyperlink{classsysio_1_1chain_1_1permission__link__object}{permission\_link\_object}},\ by\_action\_name>(\mbox{\hyperlink{yubico__otp_8c_a9246c20bb98ad2b4c60313c053c70f08}{key}});}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00272}00272\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ If\ no\ specific\ link\ found,\ check\ for\ a\ contract-\/wide\ default}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00273}00273\ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (link\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00274}00274\ \ \ \ \ \ \ \ \ \ \ \ \ boost::get<2>(key)\ =\ \{\};}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00275}00275\ \ \ \ \ \ \ \ \ \ \ \ \ link\ =\ \_db.\mbox{\hyperlink{classchainbase_1_1database_aa5a2ca0da0092693ac49b36b7ec6817a}{find}}<\mbox{\hyperlink{classsysio_1_1chain_1_1permission__link__object}{permission\_link\_object}},\ by\_action\_name>(\mbox{\hyperlink{yubico__otp_8c_a9246c20bb98ad2b4c60313c053c70f08}{key}});}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00276}00276\ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00277}00277\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00278}00278\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ If\ no\ specific\ or\ default\ link\ found,\ use\ active\ permission}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00279}00279\ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (link\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00280}00280\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ link-\/>required\_permission;}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00281}00281\ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00282}00282\ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ std::optional<permission\_name>();}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00283}00283\ \ \ \ \ \ \ \}\ \mbox{\hyperlink{exception_8hpp_a094902280cad82ad6529ebbd12a697eb}{FC\_CAPTURE\_AND\_RETHROW}}((authorizer\_account)(scope)(act\_name))}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00284}00284\ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00285}00285\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00286}\mbox{\hyperlink{classsysio_1_1chain_1_1authorization__manager_a6193726fcf21c9b75f460696a67b6839}{00286}}\ \ \ \ std::optional<permission\_name>\ \mbox{\hyperlink{classsysio_1_1chain_1_1authorization__manager_a6193726fcf21c9b75f460696a67b6839}{authorization\_manager::lookup\_minimum\_permission}}(\ \mbox{\hyperlink{structsysio_1_1chain_1_1name}{account\_name}}\ authorizer\_account,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00287}00287\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structsysio_1_1chain_1_1name}{account\_name}}\ scope,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00288}00288\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesysio_1_1chain_a7a1685bcc352cda9e45f055932069428}{action\_name}}\ act\_name}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00289}00289\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )\textcolor{keyword}{const}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00290}00290\ \textcolor{keyword}{\ \ \ }\{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00291}00291\ \ \ \ \ \ \ \textcolor{comment}{//\ Special\ case\ native\ actions\ cannot\ be\ linked\ to\ a\ minimum\ permission,\ so\ there\ is\ no\ need\ to\ check.}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00292}00292\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ scope\ ==\ config::system\_account\_name\ )\ \{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00293}00293\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{chain_2include_2sysio_2chain_2exceptions_8hpp_a40c2826a6fba35c1ffbf912bdf559792}{SYS\_ASSERT}}(\ act\_name\ !=\ \mbox{\hyperlink{structsysio_1_1chain_1_1updateauth_afc31c0680242885924f64fc347780814}{updateauth::get\_name}}()\ \&\&}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00294}00294\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ act\_name\ !=\ \mbox{\hyperlink{structsysio_1_1chain_1_1deleteauth_add712cbf63b55d0e2db2b874dca6576d}{deleteauth::get\_name}}()\ \&\&}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00295}00295\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ act\_name\ !=\ \mbox{\hyperlink{structsysio_1_1chain_1_1linkauth_a41eafdd131f5b3c8a8b7688449986f2b}{linkauth::get\_name}}()\ \&\&}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00296}00296\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ act\_name\ !=\ \mbox{\hyperlink{structsysio_1_1chain_1_1unlinkauth_a438dbc3c8575ab1f129c0fdd5c074327}{unlinkauth::get\_name}}()\ \&\&}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00297}00297\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ act\_name\ !=\ \mbox{\hyperlink{structsysio_1_1chain_1_1canceldelay_a23c3d201f9917509b74001716daf254f}{canceldelay::get\_name}}(),}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00298}00298\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ unlinkable\_min\_permission\_action,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00299}00299\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}cannot\ call\ lookup\_minimum\_permission\ on\ native\ actions\ that\ are\ not\ allowed\ to\ be\ linked\ to\ minimum\ permissions"{}}\ );}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00300}00300\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00301}00301\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00302}00302\ \ \ \ \ \ \ \textcolor{keywordflow}{try}\ \{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00303}00303\ \ \ \ \ \ \ \ \ \ std::optional<permission\_name>\ linked\_permission\ =\ lookup\_linked\_permission(authorizer\_account,\ scope,\ act\_name);}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00304}00304\ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ !linked\_permission\ )}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00305}00305\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ config::active\_name;}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00306}00306\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00307}00307\ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ *linked\_permission\ ==\ config::sysio\_any\_name\ )}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00308}00308\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ std::optional<permission\_name>();}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00309}00309\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00310}00310\ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ linked\_permission;}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00311}00311\ \ \ \ \ \ \ \}\ \mbox{\hyperlink{exception_8hpp_a094902280cad82ad6529ebbd12a697eb}{FC\_CAPTURE\_AND\_RETHROW}}((authorizer\_account)(scope)(act\_name))}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00312}00312\ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00313}00313\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00314}00314\ \ \ \ \textcolor{keywordtype}{void}\ authorization\_manager::check\_updateauth\_authorization(\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structsysio_1_1chain_1_1updateauth}{updateauth}}\&\ update,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00315}00315\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classfc_1_1vector}{vector<permission\_level>}}\&\ auths}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00316}00316\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )\textcolor{keyword}{const}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00317}00317\ \textcolor{keyword}{\ \ \ }\{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00318}00318\ \ \ \ \ \ \ \mbox{\hyperlink{chain_2include_2sysio_2chain_2exceptions_8hpp_a40c2826a6fba35c1ffbf912bdf559792}{SYS\_ASSERT}}(\ auths.size()\ ==\ 1,\ irrelevant\_auth\_exception,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00319}00319\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}updateauth\ action\ should\ only\ have\ one\ declared\ authorization"{}}\ );}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00320}00320\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ auth\ =\ auths[0];}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00321}00321\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00322}00322\ \ \ \ \ \ \ \textcolor{comment}{//\ **\ OR\ statement\ is\ custom,\ added\ to\ allow\ for\ sysio\ to\ add\ 'auth.ext'\ and\ 'auth.session'\ to\ users\ via\ our\ custom\ 'onlinkauth'\ from\ system\ contract.}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00323}00323\ \ \ \ \ \ \ \mbox{\hyperlink{chain_2include_2sysio_2chain_2exceptions_8hpp_a40c2826a6fba35c1ffbf912bdf559792}{SYS\_ASSERT}}(\ (auth.actor\ ==\ update.\mbox{\hyperlink{structsysio_1_1chain_1_1updateauth_a7ee3ebcba6271b4c675f1fedbed1a27e}{account}}\ ||\ auth.actor\ ==\ \mbox{\hyperlink{structsysio_1_1chain_1_1name}{name}}(\textcolor{stringliteral}{"{}sysio"{}})),\ irrelevant\_auth\_exception,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00324}00324\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}the\ owner\ of\ the\ affected\ permission\ needs\ to\ be\ the\ actor\ of\ the\ declared\ authorization"{}}\ );}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00325}00325\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00326}00326\ \ \ \ \ \ \ \textcolor{comment}{//\ **\ New:\ Prevents\ users\ from\ updating\ /\ adding\ 'auth.ext'\ and\ 'auth.session'\ special\ permissions.}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00327}00327\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(update.\mbox{\hyperlink{structsysio_1_1chain_1_1updateauth_a6a6754666f37b5dc06165b954bc6c4fc}{permission}}\ ==\ \mbox{\hyperlink{structsysio_1_1chain_1_1name}{name}}(\textcolor{stringliteral}{"{}auth.ext"{}})\ ||\ update.\mbox{\hyperlink{structsysio_1_1chain_1_1updateauth_a6a6754666f37b5dc06165b954bc6c4fc}{permission}}\ ==\ \mbox{\hyperlink{structsysio_1_1chain_1_1name}{name}}(\textcolor{stringliteral}{"{}auth.session"{}}))\ \{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00328}00328\ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{chain_2include_2sysio_2chain_2exceptions_8hpp_a40c2826a6fba35c1ffbf912bdf559792}{SYS\_ASSERT}}(\ auth.actor\ ==\ \mbox{\hyperlink{structsysio_1_1chain_1_1name}{name}}(\textcolor{stringliteral}{"{}sysio"{}}),\ invalid\_permission,\ \textcolor{stringliteral}{"{}Special\ permission,\ only\ assignable\ by\ 'sysio'\ as\ a\ result\ of\ 'onlinkauth'"{}}\ );}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00329}00329\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00330}00330\ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}*\ min\_permission\ =\ \mbox{\hyperlink{classsysio_1_1chain_1_1authorization__manager_ab0acfec50b75044030d082d1aa3fbf5c}{find\_permission}}(\{update.\mbox{\hyperlink{structsysio_1_1chain_1_1updateauth_a7ee3ebcba6271b4c675f1fedbed1a27e}{account}},\ update.\mbox{\hyperlink{structsysio_1_1chain_1_1updateauth_a6a6754666f37b5dc06165b954bc6c4fc}{permission}}\});}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00331}00331\ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ !min\_permission\ )\ \{\ \textcolor{comment}{//\ creating\ a\ new\ permission}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00332}00332\ \ \ \ \ \ \ \ \ \ \ \ \ min\_permission\ =\ \&\mbox{\hyperlink{classsysio_1_1chain_1_1authorization__manager_a96924f6aca32a602e24d991d12278a69}{get\_permission}}(\{update.\mbox{\hyperlink{structsysio_1_1chain_1_1updateauth_a7ee3ebcba6271b4c675f1fedbed1a27e}{account}},\ update.\mbox{\hyperlink{structsysio_1_1chain_1_1updateauth_a63fdeac4d73b22271c0dae827f3eae48}{parent}}\});}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00333}00333\ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00334}00334\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00335}00335\ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{chain_2include_2sysio_2chain_2exceptions_8hpp_a40c2826a6fba35c1ffbf912bdf559792}{SYS\_ASSERT}}(\ \mbox{\hyperlink{classsysio_1_1chain_1_1authorization__manager_a96924f6aca32a602e24d991d12278a69}{get\_permission}}(auth).satisfies(\ *min\_permission,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00336}00336\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_db.\mbox{\hyperlink{classchainbase_1_1database_a4d5297635dcf70be481d9b600da9bc13}{get\_index}}<\mbox{\hyperlink{namespacesysio_1_1chain_a4e24a1668746342d40487d1019880986}{permission\_index}}>().indices()\ ),}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00337}00337\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ irrelevant\_auth\_exception,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00338}00338\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}updateauth\ action\ declares\ irrelevant\ authority\ '\$\{auth\}';\ minimum\ authority\ is\ \$\{min\}"{}},}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00339}00339\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{"{}auth"{}},\ auth)(\textcolor{stringliteral}{"{}min"{}},\ permission\_level\{update.account,\ min\_permission-\/>name\})\ );}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00340}00340\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00341}00341\ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00342}00342\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00343}00343\ \ \ \ \textcolor{keywordtype}{void}\ authorization\_manager::check\_deleteauth\_authorization(\ \textcolor{keyword}{const}\ deleteauth\&\ del,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00344}00344\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ vector<permission\_level>\&\ auths}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00345}00345\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )\textcolor{keyword}{const}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00346}00346\ \textcolor{keyword}{\ \ \ }\{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00347}00347\ \ \ \ \ \ \ \mbox{\hyperlink{chain_2include_2sysio_2chain_2exceptions_8hpp_a40c2826a6fba35c1ffbf912bdf559792}{SYS\_ASSERT}}(\ auths.size()\ ==\ 1,\ irrelevant\_auth\_exception,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00348}00348\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}deleteauth\ action\ should\ only\ have\ one\ declared\ authorization"{}}\ );}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00349}00349\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ auth\ =\ auths[0];}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00350}00350\ \ \ \ \ \ \ \mbox{\hyperlink{chain_2include_2sysio_2chain_2exceptions_8hpp_a40c2826a6fba35c1ffbf912bdf559792}{SYS\_ASSERT}}(\ auth.actor\ ==\ del.account,\ irrelevant\_auth\_exception,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00351}00351\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}the\ owner\ of\ the\ permission\ to\ delete\ needs\ to\ be\ the\ actor\ of\ the\ declared\ authorization"{}}\ );}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00352}00352\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00353}00353\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ min\_permission\ =\ \mbox{\hyperlink{classsysio_1_1chain_1_1authorization__manager_a96924f6aca32a602e24d991d12278a69}{get\_permission}}(\{del.account,\ del.permission\});}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00354}00354\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00355}00355\ \ \ \ \ \ \ \mbox{\hyperlink{chain_2include_2sysio_2chain_2exceptions_8hpp_a40c2826a6fba35c1ffbf912bdf559792}{SYS\_ASSERT}}(\ \mbox{\hyperlink{classsysio_1_1chain_1_1authorization__manager_a96924f6aca32a602e24d991d12278a69}{get\_permission}}(auth).satisfies(\ min\_permission,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00356}00356\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_db.\mbox{\hyperlink{classchainbase_1_1database_a4d5297635dcf70be481d9b600da9bc13}{get\_index}}<\mbox{\hyperlink{namespacesysio_1_1chain_a4e24a1668746342d40487d1019880986}{permission\_index}}>().indices()\ ),}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00357}00357\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ irrelevant\_auth\_exception,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00358}00358\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}updateauth\ action\ declares\ irrelevant\ authority\ '\$\{auth\}';\ minimum\ authority\ is\ \$\{min\}"{}},}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00359}00359\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{"{}auth"{}},\ auth)(\textcolor{stringliteral}{"{}min"{}},\ permission\_level\{min\_permission.owner,\ min\_permission.name\})\ );}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00360}00360\ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00361}00361\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00362}00362\ \ \ \ \textcolor{keywordtype}{void}\ authorization\_manager::check\_linkauth\_authorization(\ \textcolor{keyword}{const}\ linkauth\&\ link,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00363}00363\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ vector<permission\_level>\&\ auths}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00364}00364\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )\textcolor{keyword}{const}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00365}00365\ \textcolor{keyword}{\ \ \ }\{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00366}00366\ \ \ \ \ \ \ \mbox{\hyperlink{chain_2include_2sysio_2chain_2exceptions_8hpp_a40c2826a6fba35c1ffbf912bdf559792}{SYS\_ASSERT}}(\ auths.size()\ ==\ 1,\ irrelevant\_auth\_exception,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00367}00367\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}link\ action\ should\ only\ have\ one\ declared\ authorization"{}}\ );}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00368}00368\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ auth\ =\ auths[0];}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00369}00369\ \ \ \ \ \ \ \mbox{\hyperlink{chain_2include_2sysio_2chain_2exceptions_8hpp_a40c2826a6fba35c1ffbf912bdf559792}{SYS\_ASSERT}}(\ auth.actor\ ==\ link.account,\ irrelevant\_auth\_exception,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00370}00370\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}the\ owner\ of\ the\ linked\ permission\ needs\ to\ be\ the\ actor\ of\ the\ declared\ authorization"{}}\ );}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00371}00371\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00372}00372\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ link.code\ ==\ config::system\_account\_name}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00373}00373\ \ \ \ \ \ \ \ \ \ \ \ \ ||\ !\_control.\mbox{\hyperlink{classsysio_1_1chain_1_1controller_aa808acf858e93c567ff983ccbf8fb6d3}{is\_builtin\_activated}}(\ \mbox{\hyperlink{namespacesysio_1_1chain_a406d45a184cdba0af316b5bf34bf56cfaa1c8246337a0813da762617fa567c3e5}{builtin\_protocol\_feature\_t::fix\_linkauth\_restriction}}\ )\ )\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00374}00374\ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00375}00375\ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{chain_2include_2sysio_2chain_2exceptions_8hpp_a40c2826a6fba35c1ffbf912bdf559792}{SYS\_ASSERT}}(\ link.type\ !=\ \mbox{\hyperlink{structsysio_1_1chain_1_1updateauth_afc31c0680242885924f64fc347780814}{updateauth::get\_name}}(),\ \ \mbox{\hyperlink{namespacesysio_1_1chain_a764b50974b9b72a0e233e72176913d6b}{action\_validate\_exception}},}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00376}00376\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Cannot\ link\ sysio::updateauth\ to\ a\ minimum\ permission"{}}\ );}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00377}00377\ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{chain_2include_2sysio_2chain_2exceptions_8hpp_a40c2826a6fba35c1ffbf912bdf559792}{SYS\_ASSERT}}(\ link.type\ !=\ \mbox{\hyperlink{structsysio_1_1chain_1_1deleteauth_add712cbf63b55d0e2db2b874dca6576d}{deleteauth::get\_name}}(),\ \ \mbox{\hyperlink{namespacesysio_1_1chain_a764b50974b9b72a0e233e72176913d6b}{action\_validate\_exception}},}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00378}00378\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Cannot\ link\ sysio::deleteauth\ to\ a\ minimum\ permission"{}}\ );}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00379}00379\ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{chain_2include_2sysio_2chain_2exceptions_8hpp_a40c2826a6fba35c1ffbf912bdf559792}{SYS\_ASSERT}}(\ link.type\ !=\ \mbox{\hyperlink{structsysio_1_1chain_1_1linkauth_a41eafdd131f5b3c8a8b7688449986f2b}{linkauth::get\_name}}(),\ \ \ \ \mbox{\hyperlink{namespacesysio_1_1chain_a764b50974b9b72a0e233e72176913d6b}{action\_validate\_exception}},}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00380}00380\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Cannot\ link\ sysio::linkauth\ to\ a\ minimum\ permission"{}}\ );}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00381}00381\ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{chain_2include_2sysio_2chain_2exceptions_8hpp_a40c2826a6fba35c1ffbf912bdf559792}{SYS\_ASSERT}}(\ link.type\ !=\ \mbox{\hyperlink{structsysio_1_1chain_1_1unlinkauth_a438dbc3c8575ab1f129c0fdd5c074327}{unlinkauth::get\_name}}(),\ \ \mbox{\hyperlink{namespacesysio_1_1chain_a764b50974b9b72a0e233e72176913d6b}{action\_validate\_exception}},}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00382}00382\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Cannot\ link\ sysio::unlinkauth\ to\ a\ minimum\ permission"{}}\ );}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00383}00383\ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{chain_2include_2sysio_2chain_2exceptions_8hpp_a40c2826a6fba35c1ffbf912bdf559792}{SYS\_ASSERT}}(\ link.type\ !=\ \mbox{\hyperlink{structsysio_1_1chain_1_1canceldelay_a23c3d201f9917509b74001716daf254f}{canceldelay::get\_name}}(),\ \mbox{\hyperlink{namespacesysio_1_1chain_a764b50974b9b72a0e233e72176913d6b}{action\_validate\_exception}},}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00384}00384\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Cannot\ link\ sysio::canceldelay\ to\ a\ minimum\ permission"{}}\ );}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00385}00385\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00386}00386\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00387}00387\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ linked\_permission\_name\ =\ \mbox{\hyperlink{classsysio_1_1chain_1_1authorization__manager_a6193726fcf21c9b75f460696a67b6839}{lookup\_minimum\_permission}}(link.account,\ link.code,\ link.type);}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00388}00388\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00389}00389\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ !linked\_permission\_name\ )\ \textcolor{comment}{//\ if\ action\ is\ linked\ to\ sysio.any\ permission}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00390}00390\ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00391}00391\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00392}00392\ \ \ \ \ \ \ \mbox{\hyperlink{chain_2include_2sysio_2chain_2exceptions_8hpp_a40c2826a6fba35c1ffbf912bdf559792}{SYS\_ASSERT}}(\ \mbox{\hyperlink{classsysio_1_1chain_1_1authorization__manager_a96924f6aca32a602e24d991d12278a69}{get\_permission}}(auth).satisfies(\ \mbox{\hyperlink{classsysio_1_1chain_1_1authorization__manager_a96924f6aca32a602e24d991d12278a69}{get\_permission}}(\{link.account,\ *linked\_permission\_name\}),}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00393}00393\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_db.\mbox{\hyperlink{classchainbase_1_1database_a4d5297635dcf70be481d9b600da9bc13}{get\_index}}<\mbox{\hyperlink{namespacesysio_1_1chain_a4e24a1668746342d40487d1019880986}{permission\_index}}>().indices()\ \ \ \ \ \ \ \ \ \ \ \ \ \ ),}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00394}00394\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ irrelevant\_auth\_exception,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00395}00395\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}link\ action\ declares\ irrelevant\ authority\ '\$\{auth\}';\ minimum\ authority\ is\ \$\{min\}"{}},}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00396}00396\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{"{}auth"{}},\ auth)(\textcolor{stringliteral}{"{}min"{}},\ permission\_level\{link.account,\ *linked\_permission\_name\})\ );}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00397}00397\ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00398}00398\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00399}00399\ \ \ \ \textcolor{keywordtype}{void}\ authorization\_manager::check\_unlinkauth\_authorization(\ \textcolor{keyword}{const}\ unlinkauth\&\ unlink,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00400}00400\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ vector<permission\_level>\&\ auths}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00401}00401\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )\textcolor{keyword}{const}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00402}00402\ \textcolor{keyword}{\ \ \ }\{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00403}00403\ \ \ \ \ \ \ \mbox{\hyperlink{chain_2include_2sysio_2chain_2exceptions_8hpp_a40c2826a6fba35c1ffbf912bdf559792}{SYS\_ASSERT}}(\ auths.size()\ ==\ 1,\ irrelevant\_auth\_exception,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00404}00404\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}unlink\ action\ should\ only\ have\ one\ declared\ authorization"{}}\ );}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00405}00405\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ auth\ =\ auths[0];}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00406}00406\ \ \ \ \ \ \ \mbox{\hyperlink{chain_2include_2sysio_2chain_2exceptions_8hpp_a40c2826a6fba35c1ffbf912bdf559792}{SYS\_ASSERT}}(\ auth.actor\ ==\ unlink.account,\ irrelevant\_auth\_exception,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00407}00407\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}the\ owner\ of\ the\ linked\ permission\ needs\ to\ be\ the\ actor\ of\ the\ declared\ authorization"{}}\ );}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00408}00408\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00409}00409\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ unlinked\_permission\_name\ =\ lookup\_linked\_permission(unlink.account,\ unlink.code,\ unlink.type);}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00410}00410\ \ \ \ \ \ \ \mbox{\hyperlink{chain_2include_2sysio_2chain_2exceptions_8hpp_a40c2826a6fba35c1ffbf912bdf559792}{SYS\_ASSERT}}(\ unlinked\_permission\_name,\ \mbox{\hyperlink{namespacesysio_1_1chain_a5dfe17906469eaf079c180c1afb4ad94}{transaction\_exception}},}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00411}00411\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}cannot\ unlink\ non-\/existent\ permission\ link\ of\ account\ '\$\{account\}'\ for\ actions\ matching\ '\$\{code\}::\$\{action\}'"{}},}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00412}00412\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{"{}account"{}},\ unlink.account)(\textcolor{stringliteral}{"{}code"{}},\ unlink.code)(\textcolor{stringliteral}{"{}action"{}},\ unlink.type)\ );}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00413}00413\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00414}00414\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ *unlinked\_permission\_name\ ==\ config::sysio\_any\_name\ )}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00415}00415\ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00416}00416\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00417}00417\ \ \ \ \ \ \ \mbox{\hyperlink{chain_2include_2sysio_2chain_2exceptions_8hpp_a40c2826a6fba35c1ffbf912bdf559792}{SYS\_ASSERT}}(\ \mbox{\hyperlink{classsysio_1_1chain_1_1authorization__manager_a96924f6aca32a602e24d991d12278a69}{get\_permission}}(auth).satisfies(\ \mbox{\hyperlink{classsysio_1_1chain_1_1authorization__manager_a96924f6aca32a602e24d991d12278a69}{get\_permission}}(\{unlink.account,\ *unlinked\_permission\_name\}),}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00418}00418\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_db.\mbox{\hyperlink{classchainbase_1_1database_a4d5297635dcf70be481d9b600da9bc13}{get\_index}}<\mbox{\hyperlink{namespacesysio_1_1chain_a4e24a1668746342d40487d1019880986}{permission\_index}}>().indices()\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ),}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00419}00419\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ irrelevant\_auth\_exception,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00420}00420\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}unlink\ action\ declares\ irrelevant\ authority\ '\$\{auth\}';\ minimum\ authority\ is\ \$\{min\}"{}},}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00421}00421\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{"{}auth"{}},\ auth)(\textcolor{stringliteral}{"{}min"{}},\ permission\_level\{unlink.account,\ *unlinked\_permission\_name\})\ );}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00422}00422\ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00423}00423\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00424}00424\ \ \ \ \mbox{\hyperlink{classfc_1_1microseconds}{fc::microseconds}}\ authorization\_manager::check\_canceldelay\_authorization(\ \textcolor{keyword}{const}\ canceldelay\&\ cancel,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00425}00425\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ vector<permission\_level>\&\ auths}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00426}00426\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )\textcolor{keyword}{const}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00427}00427\ \textcolor{keyword}{\ \ \ }\{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00428}00428\ \ \ \ \ \ \ \mbox{\hyperlink{chain_2include_2sysio_2chain_2exceptions_8hpp_a40c2826a6fba35c1ffbf912bdf559792}{SYS\_ASSERT}}(\ auths.size()\ ==\ 1,\ irrelevant\_auth\_exception,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00429}00429\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}canceldelay\ action\ should\ only\ have\ one\ declared\ authorization"{}}\ );}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00430}00430\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ auth\ =\ auths[0];}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00431}00431\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00432}00432\ \ \ \ \ \ \ \mbox{\hyperlink{chain_2include_2sysio_2chain_2exceptions_8hpp_a40c2826a6fba35c1ffbf912bdf559792}{SYS\_ASSERT}}(\ \mbox{\hyperlink{classsysio_1_1chain_1_1authorization__manager_a96924f6aca32a602e24d991d12278a69}{get\_permission}}(auth).satisfies(\ \mbox{\hyperlink{classsysio_1_1chain_1_1authorization__manager_a96924f6aca32a602e24d991d12278a69}{get\_permission}}(cancel.canceling\_auth),}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00433}00433\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_db.\mbox{\hyperlink{classchainbase_1_1database_a4d5297635dcf70be481d9b600da9bc13}{get\_index}}<\mbox{\hyperlink{namespacesysio_1_1chain_a4e24a1668746342d40487d1019880986}{permission\_index}}>().indices()\ ),}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00434}00434\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ irrelevant\_auth\_exception,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00435}00435\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}canceldelay\ action\ declares\ irrelevant\ authority\ '\$\{auth\}';\ specified\ authority\ to\ satisfy\ is\ \$\{min\}"{}},}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00436}00436\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{"{}auth"{}},\ auth)(\textcolor{stringliteral}{"{}min"{}},\ cancel.canceling\_auth)\ );}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00437}00437\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00438}00438\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ trx\_id\ =\ cancel.trx\_id;}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00439}00439\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00440}00440\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ generated\_transaction\_idx\ =\ \_control.\mbox{\hyperlink{classsysio_1_1chain_1_1controller_a0c79d00dae8c0d90efc18f4d091b2391}{db}}().\mbox{\hyperlink{classchainbase_1_1database_a4d5297635dcf70be481d9b600da9bc13}{get\_index}}<\mbox{\hyperlink{namespacesysio_1_1chain_a9e9842ee49526c2423e014a696edc602}{generated\_transaction\_multi\_index}}>();}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00441}00441\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ generated\_index\ =\ generated\_transaction\_idx.indices().get<by\_trx\_id>();}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00442}00442\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ itr\ =\ generated\_index.lower\_bound(trx\_id);}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00443}00443\ \ \ \ \ \ \ \mbox{\hyperlink{chain_2include_2sysio_2chain_2exceptions_8hpp_a40c2826a6fba35c1ffbf912bdf559792}{SYS\_ASSERT}}(\ itr\ !=\ generated\_index.end()\ \&\&\ itr-\/>sender\ ==\ \mbox{\hyperlink{namespacesysio_1_1chain_ac32ce8e75243f2b3f76aff0c1984f11b}{account\_name}}()\ \&\&\ itr-\/>trx\_id\ ==\ trx\_id,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00444}00444\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tx\_not\_found,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00445}00445\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}cannot\ cancel\ trx\_id=\$\{tid\},\ there\ is\ no\ deferred\ transaction\ with\ that\ transaction\ id"{}},}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00446}00446\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{"{}tid"{}},\ trx\_id)\ );}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00447}00447\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00448}00448\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ trx\ =\ \mbox{\hyperlink{namespacefc_1_1raw_a0b442d98ceb22dd5a6ae84745e43ffab}{fc::raw::unpack<transaction>}}(itr-\/>packed\_trx.data(),\ itr-\/>packed\_trx.size());}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00449}00449\ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ found\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00450}00450\ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ act\ :\ trx.actions\ )\ \{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00451}00451\ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ auth\ :\ act.authorization\ )\ \{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00452}00452\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ auth\ ==\ cancel.canceling\_auth\ )\ \{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00453}00453\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ found\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00454}00454\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00455}00455\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00456}00456\ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00457}00457\ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ found\ )\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00458}00458\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00459}00459\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00460}00460\ \ \ \ \ \ \ \mbox{\hyperlink{chain_2include_2sysio_2chain_2exceptions_8hpp_a40c2826a6fba35c1ffbf912bdf559792}{SYS\_ASSERT}}(\ found,\ \mbox{\hyperlink{namespacesysio_1_1chain_a764b50974b9b72a0e233e72176913d6b}{action\_validate\_exception}},}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00461}00461\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}canceling\_auth\ in\ canceldelay\ action\ was\ not\ found\ as\ authorization\ in\ the\ original\ delayed\ transaction"{}}\ );}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00462}00462\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00463}00463\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (itr-\/>delay\_until\ -\/\ itr-\/>published);}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00464}00464\ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00465}00465\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00466}\mbox{\hyperlink{namespacesysio_1_1chain_a057ec53a1f8d23b2fb89de6c19b41c32}{00466}}\ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespacesysio_1_1chain_a057ec53a1f8d23b2fb89de6c19b41c32}{noop\_checktime}}()\ \{\}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00467}00467\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00468}00468\ \ \ \ std::function<void()>\ \mbox{\hyperlink{classsysio_1_1chain_1_1authorization__manager_a1e4aa0f280bcaa3057bc2970063f74b8}{authorization\_manager::\_noop\_checktime}}\{\&\mbox{\hyperlink{namespacesysio_1_1chain_a057ec53a1f8d23b2fb89de6c19b41c32}{noop\_checktime}}\};}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00469}00469\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00470}00470\ \ \ \ \textcolor{keywordtype}{void}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00471}\mbox{\hyperlink{classsysio_1_1chain_1_1authorization__manager_a8566f4407e33eb1e4029455e4feae2f1}{00471}}\ \ \ \ \mbox{\hyperlink{classsysio_1_1chain_1_1authorization__manager_a8566f4407e33eb1e4029455e4feae2f1}{authorization\_manager::check\_authorization}}(\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classfc_1_1vector}{vector<action>}}\&\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ actions,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00472}00472\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ flat\_set<public\_key\_type>\&\ \ \ \ \ provided\_keys,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00473}00473\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ flat\_set<permission\_level>\&\ \ \ \ provided\_permissions,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00474}00474\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classfc_1_1microseconds}{fc::microseconds}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ provided\_delay,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00475}00475\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::function<\textcolor{keywordtype}{void}()>\&\ \ \ \ \ \ \ \ \ \_checktime,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00476}00476\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ allow\_unused\_keys,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00477}00477\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ check\_but\_dont\_fail,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00478}00478\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ flat\_set<permission\_level>\&\ \ \ \ satisfied\_authorizations}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00479}00479\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )\textcolor{keyword}{const}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00480}00480\ \textcolor{keyword}{\ \ \ }\{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00481}00481\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ checktime\ =\ (\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{bool}\textcolor{keyword}{>}(\_checktime)\ ?\ \_checktime\ :\ \mbox{\hyperlink{classsysio_1_1chain_1_1authorization__manager_a1e4aa0f280bcaa3057bc2970063f74b8}{\_noop\_checktime}}\ );}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00482}00482\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00483}00483\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ delay\_max\_limit\ =\ \mbox{\hyperlink{namespacefc_a9623b8cae3f48bbed6aa1fc2afe9b174}{fc::seconds}}(\ \_control.\mbox{\hyperlink{classsysio_1_1chain_1_1controller_a0bb11e832a05b6437c79bf81758b1b7d}{get\_global\_properties}}().\mbox{\hyperlink{classsysio_1_1chain_1_1global__property__object_a7f149fcf87034217c899838eb4430496}{configuration}}.\mbox{\hyperlink{structsysio_1_1chain_1_1chain__config__v0_ad98015ab0842f0258be2df72e7ace5e3}{max\_transaction\_delay}}\ );}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00484}00484\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00485}00485\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ effective\_provided\_delay\ =\ \ (provided\_delay\ >=\ delay\_max\_limit)\ ?\ \mbox{\hyperlink{classfc_1_1microseconds_afc3eb0bfd792c7b1cda062e559e30c2e}{fc::microseconds::maximum}}()\ :\ provided\_delay;}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00486}00486\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00487}00487\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ checker\ =\ \mbox{\hyperlink{namespacesysio_1_1chain_a9935b13f160accddca2509476a2cad8b}{make\_auth\_checker}}(\ [\&](\textcolor{keyword}{const}\ \mbox{\hyperlink{structsysio_1_1chain_1_1permission__level}{permission\_level}}\&\ \mbox{\hyperlink{bn_8cpp_a8b0eadcc506862e9d751ab45185053aa}{p}})\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classsysio_1_1chain_1_1authorization__manager_a96924f6aca32a602e24d991d12278a69}{get\_permission}}(\mbox{\hyperlink{bn_8cpp_a8b0eadcc506862e9d751ab45185053aa}{p}}).auth;\ \},}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00488}00488\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_control.\mbox{\hyperlink{classsysio_1_1chain_1_1controller_a0bb11e832a05b6437c79bf81758b1b7d}{get\_global\_properties}}().configuration.max\_authority\_depth,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00489}00489\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ provided\_keys,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00490}00490\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ provided\_permissions,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00491}00491\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ effective\_provided\_delay,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00492}00492\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ checktime}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00493}00493\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ );}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00494}00494\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00495}00495\ \ \ \ \ \ \ map<permission\_level,\ fc::microseconds>\ permissions\_to\_satisfy;}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00496}00496\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00497}00497\ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ act\ :\ actions\ )\ \{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00498}00498\ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ special\_case\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00499}00499\ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classfc_1_1microseconds}{fc::microseconds}}\ delay\ =\ effective\_provided\_delay;}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00500}00500\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00501}00501\ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ act.account\ ==\ config::system\_account\_name\ )\ \{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00502}00502\ \ \ \ \ \ \ \ \ \ \ \ \ special\_case\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00503}00503\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00504}00504\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ act.name\ ==\ \mbox{\hyperlink{structsysio_1_1chain_1_1updateauth_afc31c0680242885924f64fc347780814}{updateauth::get\_name}}()\ )\ \{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00505}00505\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ check\_updateauth\_authorization(\ act.data\_as<\mbox{\hyperlink{structsysio_1_1chain_1_1updateauth}{updateauth}}>(),\ act.authorization\ );}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00506}00506\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(\ act.name\ ==\ \mbox{\hyperlink{structsysio_1_1chain_1_1deleteauth_add712cbf63b55d0e2db2b874dca6576d}{deleteauth::get\_name}}()\ )\ \{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00507}00507\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ check\_deleteauth\_authorization(\ act.data\_as<\mbox{\hyperlink{structsysio_1_1chain_1_1deleteauth}{deleteauth}}>(),\ act.authorization\ );}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00508}00508\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(\ act.name\ ==\ \mbox{\hyperlink{structsysio_1_1chain_1_1linkauth_a41eafdd131f5b3c8a8b7688449986f2b}{linkauth::get\_name}}()\ )\ \{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00509}00509\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ check\_linkauth\_authorization(\ act.data\_as<\mbox{\hyperlink{structsysio_1_1chain_1_1linkauth}{linkauth}}>(),\ act.authorization\ );}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00510}00510\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(\ act.name\ ==\ \mbox{\hyperlink{structsysio_1_1chain_1_1unlinkauth_a438dbc3c8575ab1f129c0fdd5c074327}{unlinkauth::get\_name}}()\ )\ \{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00511}00511\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ check\_unlinkauth\_authorization(\ act.data\_as<\mbox{\hyperlink{structsysio_1_1chain_1_1unlinkauth}{unlinkauth}}>(),\ act.authorization\ );}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00512}00512\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(\ act.name\ ==\ \ \mbox{\hyperlink{structsysio_1_1chain_1_1canceldelay_a23c3d201f9917509b74001716daf254f}{canceldelay::get\_name}}()\ )\ \{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00513}00513\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ delay\ =\ std::max(\ delay,\ check\_canceldelay\_authorization(act.data\_as<\mbox{\hyperlink{structsysio_1_1chain_1_1canceldelay}{canceldelay}}>(),\ act.authorization)\ );}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00514}00514\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00515}00515\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ special\_case\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00516}00516\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00517}00517\ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00518}00518\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00519}00519\ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ declared\_auth\ :\ act.authorization\ )\ \{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00520}00520\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00521}00521\ \ \ \ \ \ \ \ \ \ \ \ \ checktime();}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00522}00522\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00523}00523\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ !special\_case\ )\ \{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00524}00524\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ min\_permission\_name\ =\ \mbox{\hyperlink{classsysio_1_1chain_1_1authorization__manager_a6193726fcf21c9b75f460696a67b6839}{lookup\_minimum\_permission}}(declared\_auth.actor,\ act.account,\ act.name);}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00525}00525\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ min\_permission\_name\ )\ \{\ \textcolor{comment}{//\ since\ special\ cases\ were\ already\ handled,\ it\ should\ only\ be\ false\ if\ the\ permission\ is\ sysio.any}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00526}00526\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ min\_permission\ =\ \mbox{\hyperlink{classsysio_1_1chain_1_1authorization__manager_a96924f6aca32a602e24d991d12278a69}{get\_permission}}(\{declared\_auth.actor,\ *min\_permission\_name\});}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00527}00527\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{chain_2include_2sysio_2chain_2exceptions_8hpp_a40c2826a6fba35c1ffbf912bdf559792}{SYS\_ASSERT}}(\ \mbox{\hyperlink{classsysio_1_1chain_1_1authorization__manager_a96924f6aca32a602e24d991d12278a69}{get\_permission}}(declared\_auth).satisfies(\ min\_permission,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00528}00528\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_db.\mbox{\hyperlink{classchainbase_1_1database_a4d5297635dcf70be481d9b600da9bc13}{get\_index}}<\mbox{\hyperlink{namespacesysio_1_1chain_a4e24a1668746342d40487d1019880986}{permission\_index}}>().indices()\ ),}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00529}00529\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ irrelevant\_auth\_exception,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00530}00530\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}action\ declares\ irrelevant\ authority\ '\$\{auth\}';\ minimum\ authority\ is\ \$\{min\}"{}},}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00531}00531\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{"{}auth"{}},\ declared\_auth)(\textcolor{stringliteral}{"{}min"{}},\ \mbox{\hyperlink{structsysio_1_1chain_1_1permission__level}{permission\_level}}\{min\_permission.owner,\ min\_permission.name\})\ );}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00532}00532\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00533}00533\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00534}00534\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00535}00535\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ satisfied\_authorizations.find(\ declared\_auth\ )\ ==\ satisfied\_authorizations.end()\ )\ \{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00536}00536\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ res\ =\ permissions\_to\_satisfy.emplace(\ declared\_auth,\ delay\ );}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00537}00537\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ !res.second\ \&\&\ res.first-\/>second\ >\ delay)\ \{\ \textcolor{comment}{//\ if\ the\ declared\_auth\ was\ already\ in\ the\ map\ and\ with\ a\ higher\ delay}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00538}00538\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ res.first-\/>second\ =\ \mbox{\hyperlink{integration_8cpp_a6e9635897de7740b7389a391f613626b}{delay}};}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00539}00539\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00540}00540\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00541}00541\ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00542}00542\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00543}00543\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00544}00544\ \ \ \ \ \ \ \textcolor{comment}{//\ Now\ verify\ that\ all\ the\ declared\ authorizations\ are\ satisfied:}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00545}00545\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00546}00546\ \ \ \ \ \ \ \textcolor{comment}{//\ Although\ this\ can\ be\ made\ parallel\ (especially\ for\ input\ transactions)\ with\ the\ optimistic\ assumption\ that\ the}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00547}00547\ \ \ \ \ \ \ \textcolor{comment}{//\ CPU\ limit\ is\ not\ reached,\ because\ of\ the\ CPU\ limit\ the\ protocol\ must\ officially\ specify\ a\ sequential\ algorithm}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00548}00548\ \ \ \ \ \ \ \textcolor{comment}{//\ for\ checking\ the\ set\ of\ declared\ authorizations.}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00549}00549\ \ \ \ \ \ \ \textcolor{comment}{//\ The\ permission\_levels\ are\ traversed\ in\ ascending\ order,\ which\ is:}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00550}00550\ \ \ \ \ \ \ \textcolor{comment}{//\ ascending\ order\ of\ the\ actor\ name\ with\ ties\ broken\ by\ ascending\ order\ of\ the\ permission\ name.}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00551}00551\ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ \mbox{\hyperlink{bn_8cpp_a8b0eadcc506862e9d751ab45185053aa}{p}}\ :\ permissions\_to\_satisfy\ )\ \{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00552}00552\ \ \ \ \ \ \ \ \ \ checktime();\ \textcolor{comment}{//\ TODO:\ this\ should\ eventually\ move\ into\ authority\_checker\ instead}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00553}00553\ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{chain_2include_2sysio_2chain_2exceptions_8hpp_a40c2826a6fba35c1ffbf912bdf559792}{SYS\_ASSERT}}(\ checker.satisfied(\ \mbox{\hyperlink{bn_8cpp_a8b0eadcc506862e9d751ab45185053aa}{p}}.first,\ \mbox{\hyperlink{bn_8cpp_a8b0eadcc506862e9d751ab45185053aa}{p}}.second\ )\ ||\ check\_but\_dont\_fail,\ unsatisfied\_authorization,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00554}00554\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}transaction\ declares\ authority\ '\$\{auth\}',\ "{}}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00555}00555\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}but\ does\ not\ have\ signatures\ for\ it\ under\ a\ provided\ delay\ of\ \$\{provided\_delay\}\ ms,\ "{}}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00556}00556\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}provided\ permissions\ \$\{provided\_permissions\},\ provided\ keys\ \$\{provided\_keys\},\ "{}}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00557}00557\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}and\ a\ delay\ max\ limit\ of\ \$\{delay\_max\_limit\_ms\}\ ms"{}},}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00558}00558\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{"{}auth"{}},\ \mbox{\hyperlink{bn_8cpp_a8b0eadcc506862e9d751ab45185053aa}{p}}.first)}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00559}00559\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{"{}provided\_delay"{}},\ provided\_delay.\mbox{\hyperlink{classfc_1_1microseconds_a20fba59ec7e1f50c6b8f2c9443cc9b92}{count}}()/1000)}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00560}00560\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{"{}provided\_permissions"{}},\ provided\_permissions)}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00561}00561\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{"{}provided\_keys"{}},\ provided\_keys)}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00562}00562\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{"{}delay\_max\_limit\_ms"{}},\ delay\_max\_limit.count()/1000)}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00563}00563\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ );}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00564}00564\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00565}00565\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00566}00566\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00567}00567\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ !allow\_unused\_keys\ \ ||\ check\_but\_dont\_fail)\ \{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00568}00568\ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{chain_2include_2sysio_2chain_2exceptions_8hpp_a40c2826a6fba35c1ffbf912bdf559792}{SYS\_ASSERT}}(\ checker.all\_keys\_used(),\ tx\_irrelevant\_sig,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00569}00569\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}transaction\ bears\ irrelevant\ signatures\ from\ these\ keys:\ \$\{keys\}"{}},}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00570}00570\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{"{}keys"{}},\ checker.unused\_keys())\ );}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00571}00571\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00572}00572\ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00573}00573\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00574}00574\ \ \ \ \textcolor{keywordtype}{void}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00575}\mbox{\hyperlink{classsysio_1_1chain_1_1authorization__manager_a9f6cf6c813f4a578fddc10cf24aa396a}{00575}}\ \ \ \ \mbox{\hyperlink{classsysio_1_1chain_1_1authorization__manager_a8566f4407e33eb1e4029455e4feae2f1}{authorization\_manager::check\_authorization}}(\ \mbox{\hyperlink{structsysio_1_1chain_1_1name}{account\_name}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ account,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00576}00576\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structsysio_1_1chain_1_1name}{permission\_name}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ permission,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00577}00577\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ flat\_set<public\_key\_type>\&\ \ \ \ \ provided\_keys,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00578}00578\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ flat\_set<permission\_level>\&\ \ \ \ provided\_permissions,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00579}00579\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classfc_1_1microseconds}{fc::microseconds}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ provided\_delay,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00580}00580\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::function<\textcolor{keywordtype}{void}()>\&\ \ \ \ \ \ \ \ \ \_checktime,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00581}00581\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ allow\_unused\_keys}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00582}00582\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )\textcolor{keyword}{const}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00583}00583\ \textcolor{keyword}{\ \ \ }\{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00584}00584\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ checktime\ =\ (\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{bool}\textcolor{keyword}{>}(\_checktime)\ ?\ \_checktime\ :\ \mbox{\hyperlink{classsysio_1_1chain_1_1authorization__manager_a1e4aa0f280bcaa3057bc2970063f74b8}{\_noop\_checktime}}\ );}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00585}00585\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00586}00586\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ delay\_max\_limit\ =\ \mbox{\hyperlink{namespacefc_a9623b8cae3f48bbed6aa1fc2afe9b174}{fc::seconds}}(\ \_control.\mbox{\hyperlink{classsysio_1_1chain_1_1controller_a0bb11e832a05b6437c79bf81758b1b7d}{get\_global\_properties}}().\mbox{\hyperlink{classsysio_1_1chain_1_1global__property__object_a7f149fcf87034217c899838eb4430496}{configuration}}.\mbox{\hyperlink{structsysio_1_1chain_1_1chain__config__v0_ad98015ab0842f0258be2df72e7ace5e3}{max\_transaction\_delay}}\ );}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00587}00587\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00588}00588\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ checker\ =\ \mbox{\hyperlink{namespacesysio_1_1chain_a9935b13f160accddca2509476a2cad8b}{make\_auth\_checker}}(\ [\&](\textcolor{keyword}{const}\ \mbox{\hyperlink{structsysio_1_1chain_1_1permission__level}{permission\_level}}\&\ \mbox{\hyperlink{bn_8cpp_a8b0eadcc506862e9d751ab45185053aa}{p}})\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classsysio_1_1chain_1_1authorization__manager_a96924f6aca32a602e24d991d12278a69}{get\_permission}}(\mbox{\hyperlink{bn_8cpp_a8b0eadcc506862e9d751ab45185053aa}{p}}).auth;\ \},}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00589}00589\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_control.\mbox{\hyperlink{classsysio_1_1chain_1_1controller_a0bb11e832a05b6437c79bf81758b1b7d}{get\_global\_properties}}().configuration.max\_authority\_depth,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00590}00590\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ provided\_keys,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00591}00591\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ provided\_permissions,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00592}00592\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\ provided\_delay\ >=\ delay\_max\_limit\ )\ ?\ \mbox{\hyperlink{classfc_1_1microseconds_afc3eb0bfd792c7b1cda062e559e30c2e}{fc::microseconds::maximum}}()\ :\ provided\_delay,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00593}00593\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ checktime}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00594}00594\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ );}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00595}00595\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00596}00596\ \ \ \ \ \ \ \mbox{\hyperlink{chain_2include_2sysio_2chain_2exceptions_8hpp_a40c2826a6fba35c1ffbf912bdf559792}{SYS\_ASSERT}}(\ checker.satisfied(\{account,\ permission\}),\ unsatisfied\_authorization,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00597}00597\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}permission\ '\$\{auth\}'\ was\ not\ satisfied\ under\ a\ provided\ delay\ of\ \$\{provided\_delay\}\ ms,\ "{}}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00598}00598\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}provided\ permissions\ \$\{provided\_permissions\},\ provided\ keys\ \$\{provided\_keys\},\ "{}}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00599}00599\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}and\ a\ delay\ max\ limit\ of\ \$\{delay\_max\_limit\_ms\}\ ms"{}},}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00600}00600\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{"{}auth"{}},\ \mbox{\hyperlink{structsysio_1_1chain_1_1permission__level}{permission\_level}}\{account,\ permission\})}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00601}00601\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{"{}provided\_delay"{}},\ provided\_delay.\mbox{\hyperlink{classfc_1_1microseconds_a20fba59ec7e1f50c6b8f2c9443cc9b92}{count}}()/1000)}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00602}00602\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{"{}provided\_permissions"{}},\ provided\_permissions)}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00603}00603\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{"{}provided\_keys"{}},\ provided\_keys)}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00604}00604\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{"{}delay\_max\_limit\_ms"{}},\ delay\_max\_limit.count()/1000)}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00605}00605\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ );}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00606}00606\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00607}00607\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ !allow\_unused\_keys\ )\ \{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00608}00608\ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{chain_2include_2sysio_2chain_2exceptions_8hpp_a40c2826a6fba35c1ffbf912bdf559792}{SYS\_ASSERT}}(\ checker.all\_keys\_used(),\ tx\_irrelevant\_sig,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00609}00609\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}irrelevant\ keys\ provided:\ \$\{keys\}"{}},}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00610}00610\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{"{}keys"{}},\ checker.unused\_keys())\ );}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00611}00611\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00612}00612\ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00613}00613\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00614}\mbox{\hyperlink{classsysio_1_1chain_1_1authorization__manager_ac1e69cb344bd39871d1c92993a491e95}{00614}}\ \ \ \ flat\_set<public\_key\_type>\ \mbox{\hyperlink{classsysio_1_1chain_1_1authorization__manager_ac1e69cb344bd39871d1c92993a491e95}{authorization\_manager::get\_required\_keys}}(\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structsysio_1_1chain_1_1transaction}{transaction}}\&\ trx,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00615}00615\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ flat\_set<public\_key\_type>\&\ candidate\_keys,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00616}00616\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classfc_1_1microseconds}{fc::microseconds}}\ provided\_delay}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00617}00617\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )\textcolor{keyword}{const}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00618}00618\ \textcolor{keyword}{\ \ \ }\{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00619}00619\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ checker\ =\ \mbox{\hyperlink{namespacesysio_1_1chain_a9935b13f160accddca2509476a2cad8b}{make\_auth\_checker}}(\ [\&](\textcolor{keyword}{const}\ \mbox{\hyperlink{structsysio_1_1chain_1_1permission__level}{permission\_level}}\&\ \mbox{\hyperlink{bn_8cpp_a8b0eadcc506862e9d751ab45185053aa}{p}})\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classsysio_1_1chain_1_1authorization__manager_a96924f6aca32a602e24d991d12278a69}{get\_permission}}(\mbox{\hyperlink{bn_8cpp_a8b0eadcc506862e9d751ab45185053aa}{p}}).auth;\ \},}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00620}00620\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_control.\mbox{\hyperlink{classsysio_1_1chain_1_1controller_a0bb11e832a05b6437c79bf81758b1b7d}{get\_global\_properties}}().configuration.max\_authority\_depth,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00621}00621\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ candidate\_keys,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00622}00622\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{\},}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00623}00623\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ provided\_delay,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00624}00624\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classsysio_1_1chain_1_1authorization__manager_a1e4aa0f280bcaa3057bc2970063f74b8}{\_noop\_checktime}}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00625}00625\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ );}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00626}00626\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00627}00627\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ act\ :\ trx.\mbox{\hyperlink{structsysio_1_1chain_1_1transaction_a407fcf1868b81bb30b85f80d388bbac2}{actions}}\ )\ \{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00628}00628\ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ declared\_auth\ :\ act.authorization)\ \{}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00629}00629\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{chain_2include_2sysio_2chain_2exceptions_8hpp_a40c2826a6fba35c1ffbf912bdf559792}{SYS\_ASSERT}}(\ checker.satisfied(declared\_auth),\ unsatisfied\_authorization,}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00630}00630\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}transaction\ declares\ authority\ '\$\{auth\}',\ but\ does\ not\ have\ signatures\ for\ it."{}},}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00631}00631\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{"{}auth"{}},\ declared\_auth)\ );}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00632}00632\ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00633}00633\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00634}00634\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00635}00635\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ checker.used\_keys();}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00636}00636\ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00637}00637\ }
\DoxyCodeLine{\Hypertarget{authorization__manager_8cpp_source_l00638}00638\ \}\ \}\ }

\end{DoxyCode}
