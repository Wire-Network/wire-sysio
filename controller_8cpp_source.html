<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Wire Sysio: libraries/chain/controller.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Wire Sysio<span id="projectnumber">&#160;Wire Sysion 1.0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('controller_8cpp_source.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">controller.cpp</div></div>
</div><!--header-->
<div class="contents">
<a href="controller_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="preprocessor">#include &lt;<a class="code" href="controller_8hpp.html">sysio/chain/controller.hpp</a>&gt;</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="preprocessor">#include &lt;<a class="code" href="transaction__context_8hpp.html">sysio/chain/transaction_context.hpp</a>&gt;</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span> </div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="preprocessor">#include &lt;<a class="code" href="block__log_8hpp.html">sysio/chain/block_log.hpp</a>&gt;</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="preprocessor">#include &lt;<a class="code" href="fork__database_8hpp.html">sysio/chain/fork_database.hpp</a>&gt;</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="preprocessor">#include &lt;<a class="code" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html">sysio/chain/exceptions.hpp</a>&gt;</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span> </div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="preprocessor">#include &lt;<a class="code" href="account__object_8hpp.html">sysio/chain/account_object.hpp</a>&gt;</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="preprocessor">#include &lt;<a class="code" href="code__object_8hpp.html">sysio/chain/code_object.hpp</a>&gt;</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="preprocessor">#include &lt;<a class="code" href="block__summary__object_8hpp.html">sysio/chain/block_summary_object.hpp</a>&gt;</span></div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="preprocessor">#include &lt;<a class="code" href="sysio__contract_8hpp.html">sysio/chain/sysio_contract.hpp</a>&gt;</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="preprocessor">#include &lt;<a class="code" href="global__property__object_8hpp.html">sysio/chain/global_property_object.hpp</a>&gt;</span></div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="preprocessor">#include &lt;<a class="code" href="protocol__state__object_8hpp.html">sysio/chain/protocol_state_object.hpp</a>&gt;</span></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="preprocessor">#include &lt;<a class="code" href="contract__table__objects_8hpp.html">sysio/chain/contract_table_objects.hpp</a>&gt;</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span><span class="preprocessor">#include &lt;<a class="code" href="generated__transaction__object_8hpp.html">sysio/chain/generated_transaction_object.hpp</a>&gt;</span></div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="preprocessor">#include &lt;<a class="code" href="transaction__object_8hpp.html">sysio/chain/transaction_object.hpp</a>&gt;</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="preprocessor">#include &lt;<a class="code" href="genesis__intrinsics_8hpp.html">sysio/chain/genesis_intrinsics.hpp</a>&gt;</span></div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span><span class="preprocessor">#include &lt;<a class="code" href="whitelisted__intrinsics_8hpp.html">sysio/chain/whitelisted_intrinsics.hpp</a>&gt;</span></div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span><span class="preprocessor">#include &lt;<a class="code" href="database__header__object_8hpp.html">sysio/chain/database_header_object.hpp</a>&gt;</span></div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span> </div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span><span class="preprocessor">#include &lt;<a class="code" href="protocol__feature__manager_8hpp.html">sysio/chain/protocol_feature_manager.hpp</a>&gt;</span></div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span><span class="preprocessor">#include &lt;<a class="code" href="authorization__manager_8hpp.html">sysio/chain/authorization_manager.hpp</a>&gt;</span></div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span><span class="preprocessor">#include &lt;<a class="code" href="resource__limits_8hpp.html">sysio/chain/resource_limits.hpp</a>&gt;</span></div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span><span class="preprocessor">#include &lt;<a class="code" href="chain__snapshot_8hpp.html">sysio/chain/chain_snapshot.hpp</a>&gt;</span></div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span><span class="preprocessor">#include &lt;<a class="code" href="thread__utils_8hpp.html">sysio/chain/thread_utils.hpp</a>&gt;</span></div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span><span class="preprocessor">#include &lt;<a class="code" href="platform__timer_8hpp.html">sysio/chain/platform_timer.hpp</a>&gt;</span></div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span><span class="preprocessor">#include &lt;<a class="code" href="deep__mind_8hpp.html">sysio/chain/deep_mind.hpp</a>&gt;</span></div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span> </div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span><span class="preprocessor">#include &lt;<a class="code" href="chainbase_8hpp.html">chainbase/chainbase.hpp</a>&gt;</span></div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span><span class="preprocessor">#include &lt;sysio/vm/allocator.hpp&gt;</span></div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span><span class="preprocessor">#include &lt;<a class="code" href="json_8hpp.html">fc/io/json.hpp</a>&gt;</span></div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span><span class="preprocessor">#include &lt;<a class="code" href="logger__config_8hpp.html">fc/log/logger_config.hpp</a>&gt;</span></div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span><span class="preprocessor">#include &lt;<a class="code" href="scoped__exit_8hpp.html">fc/scoped_exit.hpp</a>&gt;</span></div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span><span class="preprocessor">#include &lt;<a class="code" href="variant__object_8hpp.html">fc/variant_object.hpp</a>&gt;</span></div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span> </div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span><span class="preprocessor">#include &lt;new&gt;</span></div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span> </div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span><span class="keyword">namespace </span><a class="code hl_namespace" href="namespacesysio.html">sysio</a> { <span class="keyword">namespace </span>chain {</div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span> </div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span><span class="keyword">using </span>resource_limits::resource_limits_manager;</div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span> </div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno"><a class="line" href="namespacesysio_1_1chain.html#a5af72ea2ff72b80b5f7c50c5a43722c5">   42</a></span><span class="keyword">using </span><a class="code hl_class" href="classsysio_1_1chain_1_1index__set.html">controller_index_set</a> = <a class="code hl_class" href="classsysio_1_1chain_1_1index__set.html">index_set</a>&lt;</div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span>   <a class="code hl_typedef" href="namespacesysio_1_1chain.html#a1736163b16f1771314cd01a1208621c7">account_index</a>,</div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span>   <a class="code hl_typedef" href="namespacesysio_1_1chain.html#aeced8cdafcddda68b18c6c579dea0cc1">account_metadata_index</a>,</div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span>   <a class="code hl_typedef" href="namespacesysio_1_1chain.html#a4c900d23edfaeb9e6e25aa3a21e0ab4b">account_ram_correction_index</a>,</div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span>   <a class="code hl_typedef" href="namespacesysio_1_1chain.html#a0612ad4956bca2a7b23f9a14e2b32106">global_property_multi_index</a>,</div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span>   <a class="code hl_typedef" href="namespacesysio_1_1chain.html#ab03689aa0bc2fbf321d7644f838f23a5">protocol_state_multi_index</a>,</div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span>   <a class="code hl_typedef" href="namespacesysio_1_1chain.html#a7f5e587f777791897526e74e58c086be">dynamic_global_property_multi_index</a>,</div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span>   <a class="code hl_typedef" href="namespacesysio_1_1chain.html#a2c8a11798aa7d85bd95fec0fb483d91b">block_summary_multi_index</a>,</div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span>   <a class="code hl_typedef" href="namespacesysio_1_1chain.html#a7ae1398893dd587589ee5593a952a2ef">transaction_multi_index</a>,</div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span>   <a class="code hl_typedef" href="namespacesysio_1_1chain.html#a9e9842ee49526c2423e014a696edc602">generated_transaction_multi_index</a>,</div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span>   <a class="code hl_typedef" href="namespacesysio_1_1chain.html#aacd8d660fd83146e0a5d6a9cb7b19a29">table_id_multi_index</a>,</div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span>   <a class="code hl_typedef" href="namespacesysio_1_1chain.html#a0f69872bbb285f6f90ff8b5e30ef6aa8">code_index</a>,</div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span>   <a class="code hl_typedef" href="namespacesysio_1_1chain.html#a7d61e01ac919d654401a1db8399a3945">database_header_multi_index</a></div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span>&gt;;</div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span> </div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno"><a class="line" href="namespacesysio_1_1chain.html#ac4f7cb93debf1865241d63e122d5e689">   57</a></span><span class="keyword">using </span><a class="code hl_class" href="classsysio_1_1chain_1_1index__set.html">contract_database_index_set</a> = <a class="code hl_class" href="classsysio_1_1chain_1_1index__set.html">index_set</a>&lt;</div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span>   <a class="code hl_typedef" href="namespacesysio_1_1chain.html#aac1a2c1330fcb6c8002d59d4d1de5858">key_value_index</a>,</div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span>   <a class="code hl_typedef" href="namespacesysio_1_1chain.html#a6575ee303f00a9488efc0e9c0614c62e">index64_index</a>,</div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>   <a class="code hl_typedef" href="namespacesysio_1_1chain.html#a3aa50d622507be5b1de392b4aae55b0d">index128_index</a>,</div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span>   <a class="code hl_typedef" href="namespacesysio_1_1chain.html#a8e9186f3a170838216f0535ee44b6d7b">index256_index</a>,</div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span>   <a class="code hl_typedef" href="namespacesysio_1_1chain.html#a613ce5969969e88f01eba861173d2b1b">index_double_index</a>,</div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span>   <a class="code hl_typedef" href="namespacesysio_1_1chain.html#afd7252a1e9677ed6c7762531cc275f41">index_long_double_index</a></div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span>&gt;;</div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span> </div>
<div class="foldopen" id="foldopen00066" data-start="{" data-end="};">
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1maybe__session.html">   66</a></span><span class="keyword">class </span><a class="code hl_class" href="classsysio_1_1chain_1_1maybe__session.html">maybe_session</a> {</div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span>   <span class="keyword">public</span>:</div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1maybe__session.html#a58384b7d055e54178bda99e67c165878">   68</a></span>      <a class="code hl_function" href="classsysio_1_1chain_1_1maybe__session.html#a58384b7d055e54178bda99e67c165878">maybe_session</a>() = <span class="keywordflow">default</span>;</div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span> </div>
<div class="foldopen" id="foldopen00070" data-start="{" data-end="}">
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1maybe__session.html#afcc5601bfdefa774205a1dd4845eba73">   70</a></span>      <a class="code hl_function" href="classsysio_1_1chain_1_1maybe__session.html#afcc5601bfdefa774205a1dd4845eba73">maybe_session</a>( <a class="code hl_class" href="classsysio_1_1chain_1_1maybe__session.html">maybe_session</a>&amp;&amp; other)</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span>      :_session(move(other._session))</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span>      {</div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span>      }</div>
</div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span> </div>
<div class="foldopen" id="foldopen00075" data-start="{" data-end="}">
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1maybe__session.html#a438e4a87d88afef121f9a2c9c89e30c8">   75</a></span>      <span class="keyword">explicit</span> <a class="code hl_function" href="classsysio_1_1chain_1_1maybe__session.html#a438e4a87d88afef121f9a2c9c89e30c8">maybe_session</a>(<a class="code hl_class" href="classchainbase_1_1database.html">database</a>&amp; db) {</div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span>         _session.emplace(db.<a class="code hl_function" href="classchainbase_1_1database.html#abb570c03bda1ee6ae1b428d41481b476">start_undo_session</a>(<span class="keyword">true</span>));</div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span>      }</div>
</div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span> </div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1maybe__session.html#aaba101b94bc3ac6f5f3a88b1ceba284a">   79</a></span>      <a class="code hl_function" href="classsysio_1_1chain_1_1maybe__session.html#aaba101b94bc3ac6f5f3a88b1ceba284a">maybe_session</a>(<span class="keyword">const</span> <a class="code hl_class" href="classsysio_1_1chain_1_1maybe__session.html">maybe_session</a>&amp;) = <span class="keyword">delete</span>;</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span> </div>
<div class="foldopen" id="foldopen00081" data-start="{" data-end="}">
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1maybe__session.html#a1e5c5b89d2b1fac7f982ede7f0b1b545">   81</a></span>      <span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1chain_1_1maybe__session.html#a1e5c5b89d2b1fac7f982ede7f0b1b545">squash</a>() {</div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>         <span class="keywordflow">if</span> (_session)</div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>            _session-&gt;squash();</div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span>      }</div>
</div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span> </div>
<div class="foldopen" id="foldopen00086" data-start="{" data-end="}">
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1maybe__session.html#a749517d619768ab8885fc8e2785e3b40">   86</a></span>      <span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1chain_1_1maybe__session.html#a749517d619768ab8885fc8e2785e3b40">undo</a>() {</div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span>         <span class="keywordflow">if</span> (_session)</div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>            _session-&gt;undo();</div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>      }</div>
</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span> </div>
<div class="foldopen" id="foldopen00091" data-start="{" data-end="}">
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1maybe__session.html#ab35e3889eb7fd6cd0c65d2d349111050">   91</a></span>      <span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1chain_1_1maybe__session.html#ab35e3889eb7fd6cd0c65d2d349111050">push</a>() {</div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span>         <span class="keywordflow">if</span> (_session)</div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span>            _session-&gt;push();</div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>      }</div>
</div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span> </div>
<div class="foldopen" id="foldopen00096" data-start="{" data-end="}">
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1maybe__session.html#a142562a4ca875304802fc6d2cc41d669">   96</a></span>      <a class="code hl_class" href="classsysio_1_1chain_1_1maybe__session.html">maybe_session</a>&amp; <a class="code hl_function" href="classsysio_1_1chain_1_1maybe__session.html#a142562a4ca875304802fc6d2cc41d669">operator = </a>( <a class="code hl_class" href="classsysio_1_1chain_1_1maybe__session.html">maybe_session</a>&amp;&amp; mv ) {</div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>         <span class="keywordflow">if</span> (mv._session) {</div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span>            _session.emplace(move(*mv._session));</div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span>            mv._session.reset();</div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span>         } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span>            _session.reset();</div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span>         }</div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span> </div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span>         <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span>      };</div>
</div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span> </div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span>   <span class="keyword">private</span>:</div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span>      std::optional&lt;database::session&gt;     _session;</div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span>};</div>
</div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span> </div>
<div class="foldopen" id="foldopen00111" data-start="{" data-end="};">
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1building__block.html">  111</a></span><span class="keyword">struct </span><a class="code hl_struct" href="structsysio_1_1chain_1_1building__block.html">building_block</a> {</div>
<div class="foldopen" id="foldopen00112" data-start="{" data-end="}">
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1building__block.html#ad1a55d886f919432dd2cf5a2179ad697">  112</a></span>   <a class="code hl_function" href="structsysio_1_1chain_1_1building__block.html#ad1a55d886f919432dd2cf5a2179ad697">building_block</a>( <span class="keyword">const</span> <a class="code hl_struct" href="structsysio_1_1chain_1_1block__header__state.html">block_header_state</a>&amp; prev,</div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>                   <a class="code hl_class" href="classsysio_1_1chain_1_1block__timestamp.html">block_timestamp_type</a> when,</div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>                   <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> num_prev_blocks_to_confirm,</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>                   <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1vector.html">vector&lt;digest_type&gt;</a>&amp; new_protocol_feature_activations )</div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>   :<a class="code hl_variable" href="structsysio_1_1chain_1_1building__block.html#a6f4c847bd9e684175c5c2dd9a293bcce">_pending_block_header_state</a>( prev.next( when, num_prev_blocks_to_confirm ) )</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span>   ,<a class="code hl_variable" href="structsysio_1_1chain_1_1building__block.html#a505d69cba19e3830b35a7794d7c4adca">_new_protocol_feature_activations</a>( new_protocol_feature_activations )</div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>   {}</div>
</div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span> </div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1building__block.html#a6f4c847bd9e684175c5c2dd9a293bcce">  120</a></span>   <a class="code hl_struct" href="structsysio_1_1chain_1_1pending__block__header__state.html">pending_block_header_state</a>                 <a class="code hl_variable" href="structsysio_1_1chain_1_1building__block.html#a6f4c847bd9e684175c5c2dd9a293bcce">_pending_block_header_state</a>;</div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1building__block.html#ad23c5b9aff9e1e2033ee5ff0e0b38a13">  121</a></span>   std::optional&lt;producer_authority_schedule&gt; <a class="code hl_variable" href="structsysio_1_1chain_1_1building__block.html#ad23c5b9aff9e1e2033ee5ff0e0b38a13">_new_pending_producer_schedule</a>;</div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1building__block.html#a505d69cba19e3830b35a7794d7c4adca">  122</a></span>   <a class="code hl_class" href="classfc_1_1vector.html">vector&lt;digest_type&gt;</a>                        <a class="code hl_variable" href="structsysio_1_1chain_1_1building__block.html#a505d69cba19e3830b35a7794d7c4adca">_new_protocol_feature_activations</a>;</div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1building__block.html#a185ab69ca6d476247057e18672aed3ad">  123</a></span>   <span class="keywordtype">size_t</span>                                     <a class="code hl_variable" href="structsysio_1_1chain_1_1building__block.html#a185ab69ca6d476247057e18672aed3ad">_num_new_protocol_features_that_have_activated</a> = 0;</div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1building__block.html#a44bbb13d65743e9b5370f928cd57fa0c">  124</a></span>   <a class="code hl_class" href="classfc_1_1vector.html">vector&lt;transaction_metadata_ptr&gt;</a>           <a class="code hl_variable" href="structsysio_1_1chain_1_1building__block.html#a44bbb13d65743e9b5370f928cd57fa0c">_pending_trx_metas</a>;</div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1building__block.html#af666a80cf6adc295cc63a81e1ab421bf">  125</a></span>   <a class="code hl_class" href="classfc_1_1vector.html">vector&lt;transaction_receipt&gt;</a>                <a class="code hl_variable" href="structsysio_1_1chain_1_1building__block.html#af666a80cf6adc295cc63a81e1ab421bf">_pending_trx_receipts</a>;</div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1building__block.html#a798382d177c089494b584b5a9b3f1af1">  126</a></span>   <a class="code hl_class" href="classfc_1_1vector.html">vector&lt;digest_type&gt;</a>                        <a class="code hl_variable" href="structsysio_1_1chain_1_1building__block.html#a798382d177c089494b584b5a9b3f1af1">_action_receipt_digests</a>;</div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1building__block.html#a0f41d6d213209b2c8c73acb198b44d31">  127</a></span>   std::optional&lt;checksum256_type&gt;            <a class="code hl_variable" href="structsysio_1_1chain_1_1building__block.html#a0f41d6d213209b2c8c73acb198b44d31">_transaction_mroot</a>;</div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1building__block.html#a431e096b0d1fe2977a905f332bc67fe3">  128</a></span>   std::optional&lt;s_header&gt;                    <a class="code hl_variable" href="structsysio_1_1chain_1_1building__block.html#a431e096b0d1fe2977a905f332bc67fe3">_s_header</a>; <span class="comment">// Added new functionality to pass an optional s_header to be included in block header extension</span></div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span>};</div>
</div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span> </div>
<div class="foldopen" id="foldopen00131" data-start="{" data-end="};">
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1assembled__block.html">  131</a></span><span class="keyword">struct </span><a class="code hl_struct" href="structsysio_1_1chain_1_1assembled__block.html">assembled_block</a> {</div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1assembled__block.html#a67c880fe80f20c21ab50b9e597610c49">  132</a></span>   <a class="code hl_class" href="classfc_1_1sha256.html">block_id_type</a>                     <a class="code hl_variable" href="structsysio_1_1chain_1_1assembled__block.html#a67c880fe80f20c21ab50b9e597610c49">_id</a>;</div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1assembled__block.html#a421c03cda1ddda0efe26b080545fa423">  133</a></span>   <a class="code hl_struct" href="structsysio_1_1chain_1_1pending__block__header__state.html">pending_block_header_state</a>        <a class="code hl_variable" href="structsysio_1_1chain_1_1assembled__block.html#a421c03cda1ddda0efe26b080545fa423">_pending_block_header_state</a>;</div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1assembled__block.html#a5ddb3774763eee6d0817ad927559d215">  134</a></span>   <a class="code hl_class" href="classfc_1_1vector.html">vector&lt;transaction_metadata_ptr&gt;</a>  <a class="code hl_variable" href="structsysio_1_1chain_1_1assembled__block.html#a5ddb3774763eee6d0817ad927559d215">_trx_metas</a>;</div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1assembled__block.html#aeb5b3ffe37e9ba44bdc8fb0cefa3f5f6">  135</a></span>   <a class="code hl_typedef" href="namespacesysio_1_1chain.html#aa10ee348c57604b615bc8570f6685102">signed_block_ptr</a>                  <a class="code hl_variable" href="structsysio_1_1chain_1_1assembled__block.html#aeb5b3ffe37e9ba44bdc8fb0cefa3f5f6">_unsigned_block</a>;</div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span> </div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span>   <span class="comment">// if the _unsigned_block pre-dates block-signing authorities this may be present.</span></div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1assembled__block.html#ac8104404bca401ce911462d43578b5ba">  138</a></span>   std::optional&lt;producer_authority_schedule&gt; <a class="code hl_variable" href="structsysio_1_1chain_1_1assembled__block.html#ac8104404bca401ce911462d43578b5ba">_new_producer_authority_cache</a>;</div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>};</div>
</div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span> </div>
<div class="foldopen" id="foldopen00141" data-start="{" data-end="};">
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1completed__block.html">  141</a></span><span class="keyword">struct </span><a class="code hl_struct" href="structsysio_1_1chain_1_1completed__block.html">completed_block</a> {</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1completed__block.html#a07a433c3d74af71add53f639c88d86a2">  142</a></span>   <a class="code hl_typedef" href="namespacesysio_1_1chain.html#ab9b14f4554cc4a0da2c361e9757b1662">block_state_ptr</a>                   <a class="code hl_variable" href="structsysio_1_1chain_1_1completed__block.html#a07a433c3d74af71add53f639c88d86a2">_block_state</a>;</div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span>};</div>
</div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span> </div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno"><a class="line" href="namespacesysio_1_1chain.html#a4d2a657824ea3c4e231edee184c29b20">  145</a></span><span class="keyword">using </span><a class="code hl_typedef" href="namespacesysio_1_1chain.html#a4d2a657824ea3c4e231edee184c29b20">block_stage_type</a> = std::variant&lt;building_block, assembled_block, completed_block&gt;;</div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span> </div>
<div class="foldopen" id="foldopen00147" data-start="{" data-end="};">
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1pending__state.html">  147</a></span><span class="keyword">struct </span><a class="code hl_struct" href="structsysio_1_1chain_1_1pending__state.html">pending_state</a> {</div>
<div class="foldopen" id="foldopen00148" data-start="{" data-end="}">
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1pending__state.html#a13e2c50cfff7b6b71fb7492f4d1fb062">  148</a></span>   <a class="code hl_function" href="structsysio_1_1chain_1_1pending__state.html#a13e2c50cfff7b6b71fb7492f4d1fb062">pending_state</a>( <a class="code hl_class" href="classsysio_1_1chain_1_1maybe__session.html">maybe_session</a>&amp;&amp; <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a>, <span class="keyword">const</span> <a class="code hl_struct" href="structsysio_1_1chain_1_1block__header__state.html">block_header_state</a>&amp; prev,</div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>                  <a class="code hl_class" href="classsysio_1_1chain_1_1block__timestamp.html">block_timestamp_type</a> when,</div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>                  <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> num_prev_blocks_to_confirm,</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>                  <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1vector.html">vector&lt;digest_type&gt;</a>&amp; new_protocol_feature_activations )</div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>   :<a class="code hl_variable" href="structsysio_1_1chain_1_1pending__state.html#a517fdd298cc25b04ae5cd0392922e777">_db_session</a>( move(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a>) )</div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>   ,<a class="code hl_variable" href="structsysio_1_1chain_1_1pending__state.html#ae74607271d60d9118b221f3596b16271">_block_stage</a>( <a class="code hl_struct" href="structsysio_1_1chain_1_1building__block.html">building_block</a>( prev, when, num_prev_blocks_to_confirm, new_protocol_feature_activations ) )</div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>   {}</div>
</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span> </div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1pending__state.html#a517fdd298cc25b04ae5cd0392922e777">  156</a></span>   <a class="code hl_class" href="classsysio_1_1chain_1_1maybe__session.html">maybe_session</a>                      <a class="code hl_variable" href="structsysio_1_1chain_1_1pending__state.html#a517fdd298cc25b04ae5cd0392922e777">_db_session</a>;</div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1pending__state.html#ae74607271d60d9118b221f3596b16271">  157</a></span>   <a class="code hl_typedef" href="namespacesysio_1_1chain.html#a4d2a657824ea3c4e231edee184c29b20">block_stage_type</a>                   <a class="code hl_variable" href="structsysio_1_1chain_1_1pending__state.html#ae74607271d60d9118b221f3596b16271">_block_stage</a>;</div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1pending__state.html#ae760ba9e1dec40b2ebf90dff08a3efec">  158</a></span>   <a class="code hl_enumeration" href="classsysio_1_1chain_1_1controller.html#a8b5124e077de1a73bb193e9c72b366b6">controller::block_status</a>           <a class="code hl_variable" href="structsysio_1_1chain_1_1pending__state.html#ae760ba9e1dec40b2ebf90dff08a3efec">_block_status</a> = <a class="code hl_enumvalue" href="classsysio_1_1chain_1_1controller.html#a8b5124e077de1a73bb193e9c72b366b6a5ed4e9858ad8d239145ef285b6210a00">controller::block_status::incomplete</a>;</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1pending__state.html#a990d04e147e24c39dd40fe0be53109fb">  159</a></span>   std::optional&lt;block_id_type&gt;       <a class="code hl_variable" href="structsysio_1_1chain_1_1pending__state.html#a990d04e147e24c39dd40fe0be53109fb">_producer_block_id</a>;</div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span> </div>
<div class="foldopen" id="foldopen00162" data-start="{" data-end="}">
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1pending__state.html#a2c405d44fcef39bacfe70543cfe39f45">  162</a></span>   <span class="keyword">const</span> <a class="code hl_struct" href="structsysio_1_1chain_1_1pending__block__header__state.html">pending_block_header_state</a>&amp; <a class="code hl_function" href="structsysio_1_1chain_1_1pending__state.html#a2c405d44fcef39bacfe70543cfe39f45">get_pending_block_header_state</a>()<span class="keyword">const </span>{</div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>      <span class="keywordflow">if</span>( std::holds_alternative&lt;building_block&gt;(<a class="code hl_variable" href="structsysio_1_1chain_1_1pending__state.html#ae74607271d60d9118b221f3596b16271">_block_stage</a>) )</div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>         <span class="keywordflow">return</span> std::get&lt;building_block&gt;(<a class="code hl_variable" href="structsysio_1_1chain_1_1pending__state.html#ae74607271d60d9118b221f3596b16271">_block_stage</a>)._pending_block_header_state;</div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span> </div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>      <span class="keywordflow">return</span> std::get&lt;assembled_block&gt;(<a class="code hl_variable" href="structsysio_1_1chain_1_1pending__state.html#ae74607271d60d9118b221f3596b16271">_block_stage</a>)._pending_block_header_state;</div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>   }</div>
</div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span> </div>
<div class="foldopen" id="foldopen00169" data-start="{" data-end="}">
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1pending__state.html#aaa0b61ca367d56e4954e753286a8f5fb">  169</a></span>   <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1vector.html">vector&lt;transaction_receipt&gt;</a>&amp; <a class="code hl_function" href="structsysio_1_1chain_1_1pending__state.html#aaa0b61ca367d56e4954e753286a8f5fb">get_trx_receipts</a>()<span class="keyword">const </span>{</div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span>      <span class="keywordflow">if</span>( std::holds_alternative&lt;building_block&gt;(<a class="code hl_variable" href="structsysio_1_1chain_1_1pending__state.html#ae74607271d60d9118b221f3596b16271">_block_stage</a>) )</div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span>         <span class="keywordflow">return</span> std::get&lt;building_block&gt;(<a class="code hl_variable" href="structsysio_1_1chain_1_1pending__state.html#ae74607271d60d9118b221f3596b16271">_block_stage</a>)._pending_trx_receipts;</div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span> </div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>      <span class="keywordflow">if</span>( std::holds_alternative&lt;assembled_block&gt;(<a class="code hl_variable" href="structsysio_1_1chain_1_1pending__state.html#ae74607271d60d9118b221f3596b16271">_block_stage</a>) )</div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span>         <span class="keywordflow">return</span> std::get&lt;assembled_block&gt;(<a class="code hl_variable" href="structsysio_1_1chain_1_1pending__state.html#ae74607271d60d9118b221f3596b16271">_block_stage</a>)._unsigned_block-&gt;transactions;</div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span> </div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span>      <span class="keywordflow">return</span> std::get&lt;completed_block&gt;(<a class="code hl_variable" href="structsysio_1_1chain_1_1pending__state.html#ae74607271d60d9118b221f3596b16271">_block_stage</a>)._block_state-&gt;block-&gt;transactions;</div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span>    }</div>
</div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span> </div>
<div class="foldopen" id="foldopen00179" data-start="{" data-end="}">
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1pending__state.html#a7421746433955d65443ce99c8eb80162">  179</a></span>   <a class="code hl_class" href="classfc_1_1vector.html">vector&lt;transaction_metadata_ptr&gt;</a> <a class="code hl_function" href="structsysio_1_1chain_1_1pending__state.html#a7421746433955d65443ce99c8eb80162">extract_trx_metas</a>() {</div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>      <span class="keywordflow">if</span>( std::holds_alternative&lt;building_block&gt;(<a class="code hl_variable" href="structsysio_1_1chain_1_1pending__state.html#ae74607271d60d9118b221f3596b16271">_block_stage</a>) )</div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>         <span class="keywordflow">return</span> std::move( std::get&lt;building_block&gt;(<a class="code hl_variable" href="structsysio_1_1chain_1_1pending__state.html#ae74607271d60d9118b221f3596b16271">_block_stage</a>)._pending_trx_metas );</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span> </div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>      <span class="keywordflow">if</span>( std::holds_alternative&lt;assembled_block&gt;(<a class="code hl_variable" href="structsysio_1_1chain_1_1pending__state.html#ae74607271d60d9118b221f3596b16271">_block_stage</a>) )</div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span>         <span class="keywordflow">return</span> std::move( std::get&lt;assembled_block&gt;(<a class="code hl_variable" href="structsysio_1_1chain_1_1pending__state.html#ae74607271d60d9118b221f3596b16271">_block_stage</a>)._trx_metas );</div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span> </div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>      <span class="keywordflow">return</span> std::get&lt;completed_block&gt;(<a class="code hl_variable" href="structsysio_1_1chain_1_1pending__state.html#ae74607271d60d9118b221f3596b16271">_block_stage</a>)._block_state-&gt;extract_trxs_metas();</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>   }</div>
</div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span> </div>
<div class="foldopen" id="foldopen00189" data-start="{" data-end="}">
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1pending__state.html#a30e2df8beb27a0811a10a033d783caf8">  189</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="structsysio_1_1chain_1_1pending__state.html#a30e2df8beb27a0811a10a033d783caf8">is_protocol_feature_activated</a>( <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1sha256.html">digest_type</a>&amp; feature_digest )<span class="keyword">const </span>{</div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>      <span class="keywordflow">if</span>( std::holds_alternative&lt;building_block&gt;(<a class="code hl_variable" href="structsysio_1_1chain_1_1pending__state.html#ae74607271d60d9118b221f3596b16271">_block_stage</a>) ) {</div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span>        <span class="keyword">auto</span>&amp; bb = std::get&lt;building_block&gt;(<a class="code hl_variable" href="structsysio_1_1chain_1_1pending__state.html#ae74607271d60d9118b221f3596b16271">_block_stage</a>);</div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span>         <span class="keyword">const</span> <span class="keyword">auto</span>&amp; activated_features = bb._pending_block_header_state.prev_activated_protocol_features-&gt;protocol_features;</div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span> </div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span>         <span class="keywordflow">if</span>( activated_features.find( feature_digest ) != activated_features.end() ) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span> </div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span>         <span class="keywordflow">if</span>( bb._num_new_protocol_features_that_have_activated == 0 ) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span> </div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>         <span class="keyword">auto</span> end = bb._new_protocol_feature_activations.begin() + bb._num_new_protocol_features_that_have_activated;</div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span>         <span class="keywordflow">return</span> (std::find( bb._new_protocol_feature_activations.begin(), end, feature_digest ) != end);</div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>      }</div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span> </div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span>      <span class="keywordflow">if</span>( std::holds_alternative&lt;assembled_block&gt;(<a class="code hl_variable" href="structsysio_1_1chain_1_1pending__state.html#ae74607271d60d9118b221f3596b16271">_block_stage</a>) ) {</div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>         <span class="comment">// Calling is_protocol_feature_activated during the assembled_block stage is not efficient.</span></div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span>         <span class="comment">// We should avoid doing it.</span></div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>         <span class="comment">// In fact for now it isn&#39;t even implemented.</span></div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span>         <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a1bfa656552ea0534b2c91ee0fe33f850">SYS_THROW</a>( misc_exception,</div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>                    <span class="stringliteral">&quot;checking if protocol feature is activated in the assembled_block stage is not yet supported&quot;</span> );</div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>         <span class="comment">// TODO: implement this</span></div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>      }</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span> </div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; activated_features = std::get&lt;completed_block&gt;(<a class="code hl_variable" href="structsysio_1_1chain_1_1pending__state.html#ae74607271d60d9118b221f3596b16271">_block_stage</a>)._block_state-&gt;activated_protocol_features-&gt;protocol_features;</div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>      <span class="keywordflow">return</span> (activated_features.find( feature_digest ) != activated_features.end());</div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>   }</div>
</div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span> </div>
<div class="foldopen" id="foldopen00215" data-start="{" data-end="}">
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1pending__state.html#a6d01b8752e2c1422ca60ffa14a1b9c98">  215</a></span>   <span class="keywordtype">void</span> <a class="code hl_function" href="structsysio_1_1chain_1_1pending__state.html#a6d01b8752e2c1422ca60ffa14a1b9c98">push</a>() {</div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span>      <a class="code hl_variable" href="structsysio_1_1chain_1_1pending__state.html#a517fdd298cc25b04ae5cd0392922e777">_db_session</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1maybe__session.html#ab35e3889eb7fd6cd0c65d2d349111050">push</a>();</div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span>   }</div>
</div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span>};</div>
</div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span> </div>
<div class="foldopen" id="foldopen00220" data-start="{" data-end="};">
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html">  220</a></span><span class="keyword">struct </span><a class="code hl_struct" href="structsysio_1_1chain_1_1controller__impl.html">controller_impl</a> {</div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span> </div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span>   <span class="comment">// LLVM sets the new handler, we need to reset this to throw a bad_alloc exception so we can possibly exit cleanly</span></div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>   <span class="comment">// and not just abort.</span></div>
<div class="foldopen" id="foldopen00224" data-start="{" data-end="};">
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl_1_1reset__new__handler.html">  224</a></span>   <span class="keyword">struct </span><a class="code hl_struct" href="structsysio_1_1chain_1_1controller__impl_1_1reset__new__handler.html">reset_new_handler</a> {</div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl_1_1reset__new__handler.html#a32e46acf3fe5190e6640413f0295ebee">  225</a></span>      <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl_1_1reset__new__handler.html#a32e46acf3fe5190e6640413f0295ebee">reset_new_handler</a>() { std::set_new_handler([](){ <span class="keywordflow">throw</span> std::bad_alloc(); }); }</div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>   };</div>
</div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span> </div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#a342fd89592616d7ca931ff64fe75ead7">  228</a></span>   <a class="code hl_struct" href="structsysio_1_1chain_1_1controller__impl_1_1reset__new__handler.html">reset_new_handler</a>               <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a342fd89592616d7ca931ff64fe75ead7">rnh</a>; <span class="comment">// placed here to allow for this to be set before constructing the other fields</span></div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#a64851fb4e041dc49ab22cf2ba335720d">  229</a></span>   <a class="code hl_class" href="classsysio_1_1chain_1_1controller.html">controller</a>&amp;                     <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a64851fb4e041dc49ab22cf2ba335720d">self</a>;</div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#a8054e1b3da405a7765275b76d6628928">  230</a></span>   std::function&lt;void()&gt;           <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a8054e1b3da405a7765275b76d6628928">shutdown</a>;</div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">  231</a></span>   <a class="code hl_class" href="classchainbase_1_1database.html">chainbase::database</a>             <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>;</div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#a958ab2b868a2a7ec9644199a80e0ad9e">  232</a></span>   <a class="code hl_class" href="classsysio_1_1chain_1_1block__log.html">block_log</a>                       <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a958ab2b868a2a7ec9644199a80e0ad9e">blog</a>;</div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#a0e355919fd924a05344ef2b59f7dd587">  233</a></span>   std::optional&lt;pending_state&gt;    <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a0e355919fd924a05344ef2b59f7dd587">pending</a>;</div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#a56a0f369b58e6597b62569ff2853ee90">  234</a></span>   <a class="code hl_typedef" href="namespacesysio_1_1chain.html#ab9b14f4554cc4a0da2c361e9757b1662">block_state_ptr</a>                 <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a56a0f369b58e6597b62569ff2853ee90">head</a>;</div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#af7f72e6389799b7921aa98f30534f0d9">  235</a></span>   <a class="code hl_class" href="classsysio_1_1chain_1_1fork__database.html">fork_database</a>                   <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af7f72e6389799b7921aa98f30534f0d9">fork_db</a>;</div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#af94aa57dba3a7504a8047a11d37c3b27">  236</a></span>   <a class="code hl_class" href="classsysio_1_1chain_1_1wasm__interface.html">wasm_interface</a>                  <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af94aa57dba3a7504a8047a11d37c3b27">wasmif</a>;</div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#a83a037a61ce8e07b39d2d38b0f54f8f7">  237</a></span>   <a class="code hl_class" href="classsysio_1_1chain_1_1resource__limits_1_1resource__limits__manager.html">resource_limits_manager</a>         <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a83a037a61ce8e07b39d2d38b0f54f8f7">resource_limits</a>;</div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#ab90d295ac18fa98f2520e4eade5b3773">  238</a></span>   <a class="code hl_class" href="classsysio_1_1chain_1_1authorization__manager.html">authorization_manager</a>           <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#ab90d295ac18fa98f2520e4eade5b3773">authorization</a>;</div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#a24a100a7be5e562ac3966924b0c9ccb6">  239</a></span>   <a class="code hl_class" href="classsysio_1_1chain_1_1protocol__feature__manager.html">protocol_feature_manager</a>        <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a24a100a7be5e562ac3966924b0c9ccb6">protocol_features</a>;</div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#a048ac8e4d4436902a1888df13575b252">  240</a></span>   <a class="code hl_struct" href="structsysio_1_1chain_1_1controller_1_1config.html">controller::config</a>              <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a048ac8e4d4436902a1888df13575b252">conf</a>;</div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#a2f7115cf9c5daa3abca8e0467dce5a5a">  241</a></span>   <span class="keyword">const</span> <a class="code hl_struct" href="structsysio_1_1chain_1_1chain__id__type.html">chain_id_type</a>             <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a2f7115cf9c5daa3abca8e0467dce5a5a">chain_id</a>; <span class="comment">// read by thread_pool threads, value will not be changed</span></div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#a3bd1eefa999ba89597c3686e0acc463e">  242</a></span>   <span class="keywordtype">bool</span>                            <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a3bd1eefa999ba89597c3686e0acc463e">replaying</a> = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#a4a18397f763ebe4880b6ccd970bedf85">  243</a></span>   <a class="code hl_enumeration" href="namespacesysio_1_1chain.html#af3e35f3e1b78dd00fa247009a2d9ba5e">db_read_mode</a>                    <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a4a18397f763ebe4880b6ccd970bedf85">read_mode</a> = <a class="code hl_enumvalue" href="namespacesysio_1_1chain.html#af3e35f3e1b78dd00fa247009a2d9ba5ea26ca3b6826ca765f741f39ec4754d581">db_read_mode::SPECULATIVE</a>;</div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#ab02dbb970f5b16869e123b77eb090e9b">  244</a></span>   <span class="keywordtype">bool</span>                            <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#ab02dbb970f5b16869e123b77eb090e9b">in_trx_requiring_checks</a> = <span class="keyword">false</span>; </div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#ab952243b3b18aaec46cce82670687075">  245</a></span>   std::optional&lt;fc::microseconds&gt; <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#ab952243b3b18aaec46cce82670687075">subjective_cpu_leeway</a>;</div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#af3f88c130012bd7de2401b5b80fd3129">  246</a></span>   <span class="keywordtype">bool</span>                            <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af3f88c130012bd7de2401b5b80fd3129">trusted_producer_light_validation</a> = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#afe8c6fe322a239e2f910f26a385786f0">  247</a></span>   <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>                        <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#afe8c6fe322a239e2f910f26a385786f0">snapshot_head_block</a> = 0;</div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#ab76d9091b7e62fb25a0fdd63c8210af9">  248</a></span>   <a class="code hl_class" href="classsysio_1_1chain_1_1named__thread__pool.html">named_thread_pool</a>               <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#ab76d9091b7e62fb25a0fdd63c8210af9">thread_pool</a>;</div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#ad3c19aea29c2fbb28ca7120d591ba088">  249</a></span>   <a class="code hl_struct" href="structsysio_1_1chain_1_1platform__timer.html">platform_timer</a>                  <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#ad3c19aea29c2fbb28ca7120d591ba088">timer</a>;</div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#a4f73eb03cb9df364b792166a70f78320">  250</a></span>   <a class="code hl_class" href="classsysio_1_1chain_1_1deep__mind__handler.html">deep_mind_handler</a>*              <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a4f73eb03cb9df364b792166a70f78320">deep_mind_logger</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span><span class="preprocessor">#if defined(SYSIO_SYS_VM_RUNTIME_ENABLED) || defined(SYSIO_SYS_VM_JIT_RUNTIME_ENABLED)</span></div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span>   <a class="code hl_class" href="classsysio_1_1vm_1_1wasm__allocator.html">vm::wasm_allocator</a>               wasm_alloc;</div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span> </div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#a80cb28cfbb823c8688106b0229d0169c">  255</a></span>   <span class="keyword">typedef</span> pair&lt;scope_name,action_name&gt;                   <a class="code hl_typedef" href="structsysio_1_1chain_1_1controller__impl.html#a80cb28cfbb823c8688106b0229d0169c">handler_key</a>;</div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#a67d7a4050a78ec74aaf524a46bbcdf54">  256</a></span>   map&lt; account_name, map&lt;handler_key, apply_handler&gt; &gt;   <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a67d7a4050a78ec74aaf524a46bbcdf54">apply_handlers</a>;</div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#ac9a42879c69a343b4405b035e7cff29a">  257</a></span>   unordered_map&lt; <a class="code hl_enumeration" href="namespacesysio_1_1chain.html#a406d45a184cdba0af316b5bf34bf56cf">builtin_protocol_feature_t</a>, std::function&lt;void(<a class="code hl_struct" href="structsysio_1_1chain_1_1controller__impl.html">controller_impl</a>&amp;)&gt;, <a class="code hl_struct" href="structsysio_1_1chain_1_1enum__hash.html">enum_hash&lt;builtin_protocol_feature_t&gt;</a> &gt; <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#ac9a42879c69a343b4405b035e7cff29a">protocol_feature_activation_handlers</a>;</div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span> </div>
<div class="foldopen" id="foldopen00259" data-start="{" data-end="}">
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#a571b0d08f97b43706abab71f59d4d9f7">  259</a></span>   <span class="keywordtype">void</span> <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a571b0d08f97b43706abab71f59d4d9f7">pop_block</a>() {</div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span>      <span class="keyword">auto</span> prev = <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af7f72e6389799b7921aa98f30534f0d9">fork_db</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1fork__database.html#aee9daa00e2698a868ad36853e58d3908">get_block</a>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a56a0f369b58e6597b62569ff2853ee90">head</a>-&gt;header.previous );</div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span> </div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span>      <span class="keywordflow">if</span>( !prev ) {</div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span>         <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af7f72e6389799b7921aa98f30534f0d9">fork_db</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1fork__database.html#a31db3526cc966f5db1046cebcfc45219">root</a>()-&gt;id == <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a56a0f369b58e6597b62569ff2853ee90">head</a>-&gt;header.previous, <a class="code hl_variable" href="namespacesysio_1_1chain.html#a910243f6a0327fb2d4fc80f7e89f103e">block_validate_exception</a>, <span class="stringliteral">&quot;attempt to pop beyond last irreversible block&quot;</span> );</div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span>         prev = <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af7f72e6389799b7921aa98f30534f0d9">fork_db</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1fork__database.html#a31db3526cc966f5db1046cebcfc45219">root</a>();</div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span>      }</div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span> </div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span>      <span class="keywordflow">if</span> ( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a4a18397f763ebe4880b6ccd970bedf85">read_mode</a> == <a class="code hl_enumvalue" href="namespacesysio_1_1chain.html#af3e35f3e1b78dd00fa247009a2d9ba5ea26ca3b6826ca765f741f39ec4754d581">db_read_mode::SPECULATIVE</a> ) {</div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span>         <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a56a0f369b58e6597b62569ff2853ee90">head</a>-&gt;block, <a class="code hl_variable" href="namespacesysio_1_1chain.html#a910243f6a0327fb2d4fc80f7e89f103e">block_validate_exception</a>, <span class="stringliteral">&quot;attempting to pop a block that was sparsely loaded from a snapshot&quot;</span>);</div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>      }</div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span> </div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span>      <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a56a0f369b58e6597b62569ff2853ee90">head</a> = prev;</div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span> </div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span>      <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>.<a class="code hl_function" href="classchainbase_1_1database.html#a167bce30384de1f373ebe0c25d4d0de6">undo</a>();</div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span> </div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span>      <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a24a100a7be5e562ac3966924b0c9ccb6">protocol_features</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1protocol__feature__manager.html#a5b8ed9cc5cb5822d6cb645a3b7a5f98c">popped_blocks_to</a>( prev-&gt;block_num );</div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span>   }</div>
</div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span> </div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span>   <span class="keyword">template</span>&lt;builtin_protocol_feature_t F&gt;</div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#ab1190a7a5947a5d8441eafcf33fba744">  279</a></span>   <span class="keywordtype">void</span> <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#ab1190a7a5947a5d8441eafcf33fba744">on_activation</a>();</div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span> </div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>   <span class="keyword">template</span>&lt;builtin_protocol_feature_t F&gt;</div>
<div class="foldopen" id="foldopen00282" data-start="{" data-end="}">
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#a2bfcf9116962baafa5ca07d198183189">  282</a></span>   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a2bfcf9116962baafa5ca07d198183189">set_activation_handler</a>() {</div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span>      <span class="keyword">auto</span> res = <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#ac9a42879c69a343b4405b035e7cff29a">protocol_feature_activation_handlers</a>.emplace( F, &amp;<a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#ab1190a7a5947a5d8441eafcf33fba744">controller_impl::on_activation&lt;F&gt;</a> );</div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span>      <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( res.second, misc_exception, <span class="stringliteral">&quot;attempting to set activation handler twice&quot;</span> );</div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>   }</div>
</div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span> </div>
<div class="foldopen" id="foldopen00287" data-start="{" data-end="}">
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#a9335673a748ff21decfddf837016e2ff">  287</a></span>   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a9335673a748ff21decfddf837016e2ff">trigger_activation_handler</a>( <a class="code hl_enumeration" href="namespacesysio_1_1chain.html#a406d45a184cdba0af316b5bf34bf56cf">builtin_protocol_feature_t</a> <a class="code hl_variable" href="_x02-_disabled_macros_8cpp.html#ae28240b98d91d6eb7da702b770490f39">f</a> ) {</div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span>      <span class="keyword">auto</span> itr = <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#ac9a42879c69a343b4405b035e7cff29a">protocol_feature_activation_handlers</a>.find( <a class="code hl_variable" href="_x02-_disabled_macros_8cpp.html#ae28240b98d91d6eb7da702b770490f39">f</a> );</div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span>      <span class="keywordflow">if</span>( itr == <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#ac9a42879c69a343b4405b035e7cff29a">protocol_feature_activation_handlers</a>.end() ) <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span>      (itr-&gt;second)( *<span class="keyword">this</span> );</div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span>   }</div>
</div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span> </div>
<div class="foldopen" id="foldopen00293" data-start="{" data-end="}">
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#a866a2ded537cb72ff21ae968a7940432">  293</a></span>   <span class="keywordtype">void</span> <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a866a2ded537cb72ff21ae968a7940432">set_apply_handler</a>( <a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">account_name</a> receiver, <a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">account_name</a> contract, <a class="code hl_typedef" href="namespacesysio_1_1chain.html#a7a1685bcc352cda9e45f055932069428">action_name</a> <a class="code hl_struct" href="structsysio_1_1chain_1_1action.html">action</a>, <a class="code hl_typedef" href="namespacesysio_1_1chain.html#ab143988ae1cae85e839b01eb768804c3">apply_handler</a> v ) {</div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span>      <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a67d7a4050a78ec74aaf524a46bbcdf54">apply_handlers</a>[receiver][make_pair(contract,<a class="code hl_struct" href="structsysio_1_1chain_1_1action.html">action</a>)] = v;</div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span>   }</div>
</div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span> </div>
<div class="foldopen" id="foldopen00297" data-start="{" data-end="}">
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#afcd800bda7495ddc4ddee1074d5bfcb7">  297</a></span>   <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#afcd800bda7495ddc4ddee1074d5bfcb7">controller_impl</a>( <span class="keyword">const</span> <a class="code hl_struct" href="structsysio_1_1chain_1_1controller_1_1config.html">controller::config</a>&amp; cfg, <a class="code hl_class" href="classsysio_1_1chain_1_1controller.html">controller</a>&amp; <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a>, <a class="code hl_class" href="classsysio_1_1chain_1_1protocol__feature__set.html">protocol_feature_set</a>&amp;&amp; pfs, <span class="keyword">const</span> <a class="code hl_struct" href="structsysio_1_1chain_1_1chain__id__type.html">chain_id_type</a>&amp; <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a2f7115cf9c5daa3abca8e0467dce5a5a">chain_id</a> )</div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span>   :<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a342fd89592616d7ca931ff64fe75ead7">rnh</a>(),</div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span>    <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a64851fb4e041dc49ab22cf2ba335720d">self</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a>),</div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span>    <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>( cfg.state_dir,</div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span>        cfg.<a class="code hl_enumvalue" href="namespacefc.html#a3d8a2be677709cc41f09aa7925f2d55fad6bcd1364809e1b881bb22334d14cd56">read_only</a> ? <a class="code hl_class" href="classchainbase_1_1database.html">database</a>::<a class="code hl_enumvalue" href="namespacefc.html#a3d8a2be677709cc41f09aa7925f2d55fad6bcd1364809e1b881bb22334d14cd56">read_only</a> : <a class="code hl_class" href="classchainbase_1_1database.html">database</a>::<a class="code hl_enumvalue" href="namespacefc.html#a3d8a2be677709cc41f09aa7925f2d55fa4eaf6936474fac52a87743f3de041c42">read_write</a>,</div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span>        cfg.state_size, false, cfg.db_map_mode ),</div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span>    <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a958ab2b868a2a7ec9644199a80e0ad9e">blog</a>( cfg.blocks_dir, cfg.prune_config ),</div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span>    <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af7f72e6389799b7921aa98f30534f0d9">fork_db</a>( cfg.blocks_dir / <a class="code hl_struct" href="classconfig.html">config</a>::reversible_blocks_dir_name ),</div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span>    <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af94aa57dba3a7504a8047a11d37c3b27">wasmif</a>( cfg.wasm_runtime, cfg.eosvmoc_tierup, <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>, cfg.state_dir, cfg.eosvmoc_config, !cfg.profile_accounts.empty() ),</div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span>    <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a83a037a61ce8e07b39d2d38b0f54f8f7">resource_limits</a>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>, [&amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a>]() { <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a>.get_deep_mind_logger(); }),</div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span>    <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#ab90d295ac18fa98f2520e4eade5b3773">authorization</a>( <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a>, <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a> ),</div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span>    <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a24a100a7be5e562ac3966924b0c9ccb6">protocol_features</a>( std::move(pfs), [&amp;<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a>]() { <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a>.get_deep_mind_logger(); } ),</div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span>    <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a048ac8e4d4436902a1888df13575b252">conf</a>( cfg ),</div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span>    <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a2f7115cf9c5daa3abca8e0467dce5a5a">chain_id</a>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a2f7115cf9c5daa3abca8e0467dce5a5a">chain_id</a> ),</div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span>    <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a4a18397f763ebe4880b6ccd970bedf85">read_mode</a>( cfg.read_mode ),</div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span>    <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#ab76d9091b7e62fb25a0fdd63c8210af9">thread_pool</a>( <span class="stringliteral">&quot;chain&quot;</span>, cfg.thread_pool_size )</div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span>   {</div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span>      <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af7f72e6389799b7921aa98f30534f0d9">fork_db</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1fork__database.html#a378b089fe1ff7ac016ee51058ff52cb2">open</a>( [<span class="keyword">this</span>]( <a class="code hl_class" href="classsysio_1_1chain_1_1block__timestamp.html">block_timestamp_type</a> timestamp,</div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span>                            <span class="keyword">const</span> flat_set&lt;digest_type&gt;&amp; cur_features,</div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span>                            <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1vector.html">vector&lt;digest_type&gt;</a>&amp; new_features )</div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span>                           { <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#ae66494cb9657c0157ee468c21b545f60">check_protocol_features</a>( timestamp, cur_features, new_features ); }</div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span>      );</div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span> </div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span>      <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a2bfcf9116962baafa5ca07d198183189">set_activation_handler&lt;builtin_protocol_feature_t::preactivate_feature&gt;</a>();</div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span>      <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a2bfcf9116962baafa5ca07d198183189">set_activation_handler&lt;builtin_protocol_feature_t::replace_deferred&gt;</a>();</div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span>      <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a2bfcf9116962baafa5ca07d198183189">set_activation_handler&lt;builtin_protocol_feature_t::get_sender&gt;</a>();</div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span>      <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a2bfcf9116962baafa5ca07d198183189">set_activation_handler&lt;builtin_protocol_feature_t::webauthn_key&gt;</a>();</div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span>      <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a2bfcf9116962baafa5ca07d198183189">set_activation_handler&lt;builtin_protocol_feature_t::wtmsig_block_signatures&gt;</a>();</div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span>      <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a2bfcf9116962baafa5ca07d198183189">set_activation_handler&lt;builtin_protocol_feature_t::action_return_value&gt;</a>();</div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span>      <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a2bfcf9116962baafa5ca07d198183189">set_activation_handler&lt;builtin_protocol_feature_t::configurable_wasm_limits&gt;</a>();</div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span>      <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a2bfcf9116962baafa5ca07d198183189">set_activation_handler&lt;builtin_protocol_feature_t::blockchain_parameters&gt;</a>();</div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span>      <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a2bfcf9116962baafa5ca07d198183189">set_activation_handler&lt;builtin_protocol_feature_t::get_code_hash&gt;</a>();</div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span>      <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a2bfcf9116962baafa5ca07d198183189">set_activation_handler&lt;builtin_protocol_feature_t::get_block_num&gt;</a>();</div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span>      <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a2bfcf9116962baafa5ca07d198183189">set_activation_handler&lt;builtin_protocol_feature_t::crypto_primitives&gt;</a>();</div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span>      <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a2bfcf9116962baafa5ca07d198183189">set_activation_handler&lt;builtin_protocol_feature_t::em_key&gt;</a>();</div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span> </div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span>      <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a64851fb4e041dc49ab22cf2ba335720d">self</a>.<a class="code hl_variable" href="classsysio_1_1chain_1_1controller.html#a27266ebf16b6dd19a860635f7d1f9930">irreversible_block</a>.connect([<span class="keyword">this</span>](<span class="keyword">const</span> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#ab9b14f4554cc4a0da2c361e9757b1662">block_state_ptr</a>&amp; bsp) {</div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span>         <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af94aa57dba3a7504a8047a11d37c3b27">wasmif</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1wasm__interface.html#ab8938ee3dc1cd9964f4d13671f0058bd">current_lib</a>(bsp-&gt;block_num);</div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span>      });</div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span> </div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span> </div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span><span class="preprocessor">#define SET_APP_HANDLER( receiver, contract, action) \</span></div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span><span class="preprocessor">   set_apply_handler( account_name(#receiver), account_name(#contract), action_name(#action), \</span></div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span><span class="preprocessor">                      &amp;BOOST_PP_CAT(apply_, BOOST_PP_CAT(contract, BOOST_PP_CAT(_,action) ) ) )</span></div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span> </div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span>   <a class="code hl_define" href="controller_8cpp.html#a903c4d2c725a565b423b8c7978ba252c">SET_APP_HANDLER</a>( <a class="code hl_namespace" href="namespacesysio.html">sysio</a>, <a class="code hl_namespace" href="namespacesysio.html">sysio</a>, newaccount );</div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span>   <a class="code hl_define" href="controller_8cpp.html#a903c4d2c725a565b423b8c7978ba252c">SET_APP_HANDLER</a>( <a class="code hl_namespace" href="namespacesysio.html">sysio</a>, <a class="code hl_namespace" href="namespacesysio.html">sysio</a>, setcode );</div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span>   <a class="code hl_define" href="controller_8cpp.html#a903c4d2c725a565b423b8c7978ba252c">SET_APP_HANDLER</a>( <a class="code hl_namespace" href="namespacesysio.html">sysio</a>, <a class="code hl_namespace" href="namespacesysio.html">sysio</a>, setabi );</div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span>   <a class="code hl_define" href="controller_8cpp.html#a903c4d2c725a565b423b8c7978ba252c">SET_APP_HANDLER</a>( <a class="code hl_namespace" href="namespacesysio.html">sysio</a>, <a class="code hl_namespace" href="namespacesysio.html">sysio</a>, updateauth );</div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span>   <a class="code hl_define" href="controller_8cpp.html#a903c4d2c725a565b423b8c7978ba252c">SET_APP_HANDLER</a>( <a class="code hl_namespace" href="namespacesysio.html">sysio</a>, <a class="code hl_namespace" href="namespacesysio.html">sysio</a>, deleteauth );</div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span>   <a class="code hl_define" href="controller_8cpp.html#a903c4d2c725a565b423b8c7978ba252c">SET_APP_HANDLER</a>( <a class="code hl_namespace" href="namespacesysio.html">sysio</a>, <a class="code hl_namespace" href="namespacesysio.html">sysio</a>, linkauth );</div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span>   <a class="code hl_define" href="controller_8cpp.html#a903c4d2c725a565b423b8c7978ba252c">SET_APP_HANDLER</a>( <a class="code hl_namespace" href="namespacesysio.html">sysio</a>, <a class="code hl_namespace" href="namespacesysio.html">sysio</a>, unlinkauth );</div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span><span class="comment">/*</span></div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span><span class="comment">   SET_APP_HANDLER( sysio, sysio, postrecovery );</span></div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span><span class="comment">   SET_APP_HANDLER( sysio, sysio, passrecovery );</span></div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span><span class="comment">   SET_APP_HANDLER( sysio, sysio, vetorecovery );</span></div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span><span class="comment">*/</span></div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span> </div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span>   <a class="code hl_define" href="controller_8cpp.html#a903c4d2c725a565b423b8c7978ba252c">SET_APP_HANDLER</a>( <a class="code hl_namespace" href="namespacesysio.html">sysio</a>, <a class="code hl_namespace" href="namespacesysio.html">sysio</a>, canceldelay );</div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span>   }</div>
</div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span> </div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span>   <span class="keyword">template</span>&lt;<span class="keyword">typename</span> Signal, <span class="keyword">typename</span> Arg&gt;</div>
<div class="foldopen" id="foldopen00368" data-start="{" data-end="}">
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#a6380e434da95a328ff48ccab33df9cb0">  368</a></span>   <span class="keywordtype">void</span> <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a6380e434da95a328ff48ccab33df9cb0">emit</a>( <span class="keyword">const</span> Signal&amp; <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a>, Arg&amp;&amp; <a class="code hl_variable" href="pointer_8h.html#aeeddce917cf130d62c370b8f216026dd">a</a> ) {</div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span>      <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span>         <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a>( std::forward&lt;Arg&gt;( <a class="code hl_variable" href="pointer_8h.html#aeeddce917cf130d62c370b8f216026dd">a</a> ));</div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span>      } <span class="keywordflow">catch</span> (std::bad_alloc&amp; e) {</div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span>         <a class="code hl_define" href="logger_8hpp.html#a1759e5c9691d8ad754bdf5eff8bb23ac">wlog</a>( <span class="stringliteral">&quot;std::bad_alloc: ${w}&quot;</span>, (<span class="stringliteral">&quot;w&quot;</span>, e.what()) );</div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span>         <span class="keywordflow">throw</span> e;</div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span>      } <span class="keywordflow">catch</span> (boost::interprocess::bad_alloc&amp; e) {</div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span>         <a class="code hl_define" href="logger_8hpp.html#a1759e5c9691d8ad754bdf5eff8bb23ac">wlog</a>( <span class="stringliteral">&quot;boost::interprocess::bad alloc: ${w}&quot;</span>, (<span class="stringliteral">&quot;w&quot;</span>, e.what()) );</div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span>         <span class="keywordflow">throw</span> e;</div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span>      } <span class="keywordflow">catch</span> ( controller_emit_signal_exception&amp; e ) {</div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span>         <a class="code hl_define" href="logger_8hpp.html#a1759e5c9691d8ad754bdf5eff8bb23ac">wlog</a>( <span class="stringliteral">&quot;controller_emit_signal_exception: ${details}&quot;</span>, (<span class="stringliteral">&quot;details&quot;</span>, e.to_detail_string()) );</div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span>         <span class="keywordflow">throw</span> e;</div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span>      } <span class="keywordflow">catch</span> ( <a class="code hl_class" href="classfc_1_1exception.html">fc::exception</a>&amp; e ) {</div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span>         <a class="code hl_define" href="logger_8hpp.html#a1759e5c9691d8ad754bdf5eff8bb23ac">wlog</a>( <span class="stringliteral">&quot;fc::exception: ${details}&quot;</span>, (<span class="stringliteral">&quot;details&quot;</span>, e.to_detail_string()) );</div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span>      } <span class="keywordflow">catch</span> ( std::exception&amp; e ) {</div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span>         <a class="code hl_define" href="logger_8hpp.html#a1759e5c9691d8ad754bdf5eff8bb23ac">wlog</a>( <span class="stringliteral">&quot;std::exception: ${details}&quot;</span>, (<span class="stringliteral">&quot;details&quot;</span>, e.what()) );</div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span>      } <span class="keywordflow">catch</span> ( ... ) {</div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span>         <a class="code hl_define" href="logger_8hpp.html#a1759e5c9691d8ad754bdf5eff8bb23ac">wlog</a>( <span class="stringliteral">&quot;signal handler threw exception&quot;</span> );</div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span>      }</div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span>   }</div>
</div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span> </div>
<div class="foldopen" id="foldopen00389" data-start="{" data-end="}">
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#a8cdd409341efde24915eadc5f25a51f9">  389</a></span>   <span class="keywordtype">void</span> <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a8cdd409341efde24915eadc5f25a51f9">dmlog_applied_transaction</a>(<span class="keyword">const</span> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#a4ee2867a6bec961c7a78b203cfd76be9">transaction_trace_ptr</a>&amp; t) {</div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span>      <span class="keywordflow">if</span> (<span class="keyword">auto</span> dm_logger = <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a1b67831f3be3a668c170723427236954">get_deep_mind_logger</a>()) {</div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span>         dm_logger-&gt;on_applied_transaction(<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a64851fb4e041dc49ab22cf2ba335720d">self</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a33704b4936bb9bbd2ea6b0874ca521b4">head_block_num</a>() + 1, t);</div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span>      }</div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span>   }</div>
</div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span> </div>
<div class="foldopen" id="foldopen00395" data-start="{" data-end="}">
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#ad0130874bac31eb408dd6e766084b814">  395</a></span>   <span class="keywordtype">void</span> <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#ad0130874bac31eb408dd6e766084b814">log_irreversible</a>() {</div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span>      <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af7f72e6389799b7921aa98f30534f0d9">fork_db</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1fork__database.html#a31db3526cc966f5db1046cebcfc45219">root</a>(), <a class="code hl_variable" href="namespacesysio_1_1chain.html#acad19c1ca23d796138841046c67b3ea9">fork_database_exception</a>, <span class="stringliteral">&quot;fork database not properly initialized&quot;</span> );</div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span> </div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span>      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; log_head = <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a958ab2b868a2a7ec9644199a80e0ad9e">blog</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1block__log.html#ae787e7866ebfcd4c5dd5632c15c07c88">head</a>();</div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span> </div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span>      <span class="keyword">auto</span> lib_num = log_head ? log_head-&gt;block_num() : (<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a958ab2b868a2a7ec9644199a80e0ad9e">blog</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1block__log.html#ac5f1c1e78e72414fbf9bae75da42303e">first_block_num</a>() - 1);</div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span> </div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span>      <span class="keyword">auto</span> root_id = <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af7f72e6389799b7921aa98f30534f0d9">fork_db</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1fork__database.html#a31db3526cc966f5db1046cebcfc45219">root</a>()-&gt;id;</div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span> </div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span>      <span class="keywordflow">if</span>( log_head ) {</div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span>         <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( root_id == <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a958ab2b868a2a7ec9644199a80e0ad9e">blog</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1block__log.html#a4d0b6ecf420faffc4f00ba6af3d0af99">head_id</a>(), <a class="code hl_variable" href="namespacesysio_1_1chain.html#acad19c1ca23d796138841046c67b3ea9">fork_database_exception</a>, <span class="stringliteral">&quot;fork database root does not match block log head&quot;</span> );</div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span>         <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af7f72e6389799b7921aa98f30534f0d9">fork_db</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1fork__database.html#a31db3526cc966f5db1046cebcfc45219">root</a>()-&gt;block_num == lib_num, <a class="code hl_variable" href="namespacesysio_1_1chain.html#acad19c1ca23d796138841046c67b3ea9">fork_database_exception</a>,</div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span>                     <span class="stringliteral">&quot;empty block log expects the first appended block to build off a block that is not the fork database root. root block number: ${block_num}, lib: ${lib_num}&quot;</span>, (<span class="stringliteral">&quot;block_num&quot;</span>, <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af7f72e6389799b7921aa98f30534f0d9">fork_db</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1fork__database.html#a31db3526cc966f5db1046cebcfc45219">root</a>()-&gt;block_num) (<span class="stringliteral">&quot;lib_num&quot;</span>, lib_num) );</div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span>      }</div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span> </div>
<div class="line"><a id="l00411" name="l00411"></a><span class="lineno">  411</span>      <span class="keyword">auto</span> fork_head = (<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a4a18397f763ebe4880b6ccd970bedf85">read_mode</a> == <a class="code hl_enumvalue" href="namespacesysio_1_1chain.html#af3e35f3e1b78dd00fa247009a2d9ba5ea88537e4e57a14e27d354f8ef6fc03d63">db_read_mode::IRREVERSIBLE</a>) ? <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af7f72e6389799b7921aa98f30534f0d9">fork_db</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1fork__database.html#a16e619525d86741f3e5344b39ab91868">pending_head</a>() : <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af7f72e6389799b7921aa98f30534f0d9">fork_db</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1fork__database.html#a3b128a7d57c262ef6351d83c16cffae3">head</a>();</div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno">  412</span> </div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span>      <span class="keywordflow">if</span>( fork_head-&gt;dpos_irreversible_blocknum &lt;= lib_num )</div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span>         <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span> </div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span>      <span class="keyword">const</span> <span class="keyword">auto</span> branch = <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af7f72e6389799b7921aa98f30534f0d9">fork_db</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1fork__database.html#a18e51b748469f97473d120ef69e1da22">fetch_branch</a>( fork_head-&gt;id, fork_head-&gt;dpos_irreversible_blocknum );</div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span>      <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span> </div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span>         <span class="keywordflow">for</span>( <span class="keyword">auto</span> bitr = branch.rbegin(); bitr != branch.rend(); ++bitr ) {</div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span>            <span class="keywordflow">if</span>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a4a18397f763ebe4880b6ccd970bedf85">read_mode</a> == <a class="code hl_enumvalue" href="namespacesysio_1_1chain.html#af3e35f3e1b78dd00fa247009a2d9ba5ea88537e4e57a14e27d354f8ef6fc03d63">db_read_mode::IRREVERSIBLE</a> ) {</div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span>               <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#aaf795677a1a49a35ac1a819a1a157929">apply_block</a>( *bitr, <a class="code hl_enumvalue" href="classsysio_1_1chain_1_1controller.html#a8b5124e077de1a73bb193e9c72b366b6ad9a22d7a8178d5b42a8750123cbfe5b1">controller::block_status::complete</a>, <a class="code hl_typedef" href="namespacesysio_1_1chain.html#ad7e9cbb02002c4e7ab9825becb9f9f50">trx_meta_cache_lookup</a>{} );</div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span>               <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a56a0f369b58e6597b62569ff2853ee90">head</a> = (*bitr);</div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span>               <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af7f72e6389799b7921aa98f30534f0d9">fork_db</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1fork__database.html#a764fc46000bb93901ba6440fec07b5f9">mark_valid</a>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a56a0f369b58e6597b62569ff2853ee90">head</a> );</div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno">  424</span>            }</div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span> </div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span>            <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a6380e434da95a328ff48ccab33df9cb0">emit</a>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a64851fb4e041dc49ab22cf2ba335720d">self</a>.<a class="code hl_variable" href="classsysio_1_1chain_1_1controller.html#a27266ebf16b6dd19a860635f7d1f9930">irreversible_block</a>, *bitr );</div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span> </div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span>            <span class="comment">// blog.append could fail due to failures like running out of space.</span></div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span>            <span class="comment">// Do it before commit so that in case it throws, DB can be rolled back.</span></div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span>            <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a958ab2b868a2a7ec9644199a80e0ad9e">blog</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1block__log.html#aca2eca093aee072fc3f599a7c642a227">append</a>( (*bitr)-&gt;block );</div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span> </div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span>            <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>.<a class="code hl_function" href="classchainbase_1_1database.html#aca6d7bcd700644f077b89203b2e8b7ef">commit</a>( (*bitr)-&gt;block_num );</div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span>            root_id = (*bitr)-&gt;id;</div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span>         }</div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span>      } <span class="keywordflow">catch</span>( std::exception&amp; ) {</div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span>         <span class="keywordflow">if</span>( root_id != <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af7f72e6389799b7921aa98f30534f0d9">fork_db</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1fork__database.html#a31db3526cc966f5db1046cebcfc45219">root</a>()-&gt;id ) {</div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span>            <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af7f72e6389799b7921aa98f30534f0d9">fork_db</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1fork__database.html#ae911acbc996994cb6dfd21fddfb89a45">advance_root</a>( root_id );</div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span>         }</div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span>         <span class="keywordflow">throw</span>;</div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span>      }</div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span> </div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span>      <span class="comment">//db.commit( fork_head-&gt;dpos_irreversible_blocknum ); // redundant</span></div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span> </div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span>      <span class="keywordflow">if</span>( root_id != <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af7f72e6389799b7921aa98f30534f0d9">fork_db</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1fork__database.html#a31db3526cc966f5db1046cebcfc45219">root</a>()-&gt;id ) {</div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno">  445</span>         <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af7f72e6389799b7921aa98f30534f0d9">fork_db</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1fork__database.html#ae911acbc996994cb6dfd21fddfb89a45">advance_root</a>( root_id );</div>
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno">  446</span>      }</div>
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno">  447</span>   }</div>
</div>
<div class="line"><a id="l00448" name="l00448"></a><span class="lineno">  448</span> </div>
<div class="foldopen" id="foldopen00452" data-start="{" data-end="}">
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#a8d08d7c15ecb706c0bd54e992019c30d">  452</a></span>   <span class="keywordtype">void</span> <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a8d08d7c15ecb706c0bd54e992019c30d">initialize_blockchain_state</a>(<span class="keyword">const</span> <a class="code hl_struct" href="structsysio_1_1chain_1_1genesis__state.html">genesis_state</a>&amp; genesis) {</div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span>      <a class="code hl_define" href="logger_8hpp.html#a1759e5c9691d8ad754bdf5eff8bb23ac">wlog</a>( <span class="stringliteral">&quot;Initializing new blockchain with genesis state&quot;</span> );</div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span>      <a class="code hl_struct" href="structsysio_1_1chain_1_1producer__authority__schedule.html">producer_authority_schedule</a> initial_schedule = { 0, { <a class="code hl_struct" href="structsysio_1_1chain_1_1producer__authority.html">producer_authority</a>{config::system_account_name, <a class="code hl_struct" href="structsysio_1_1chain_1_1block__signing__authority__v0.html">block_signing_authority_v0</a>{ 1, {{genesis.initial_key, 1}} } } } };</div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno">  455</span>      <a class="code hl_struct" href="structsysio_1_1chain_1_1legacy_1_1producer__schedule__type.html">legacy::producer_schedule_type</a> initial_legacy_schedule{ 0, {{config::system_account_name, genesis.initial_key}} };</div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span> </div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span>      <a class="code hl_struct" href="structsysio_1_1chain_1_1block__header__state.html">block_header_state</a> genheader;</div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span>      genheader.<a class="code hl_variable" href="structsysio_1_1chain_1_1detail_1_1block__header__state__common.html#abfdafe630675287e81a2bc479aa6ce20">active_schedule</a>                = initial_schedule;</div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span>      genheader.<a class="code hl_variable" href="structsysio_1_1chain_1_1block__header__state.html#a5345ec8573d52d400076e739db4cccce">pending_schedule</a>.<a class="code hl_variable" href="structsysio_1_1chain_1_1detail_1_1schedule__info.html#a4f1fa6ff028fd822e1e566bdb7dd95a7">schedule</a>      = initial_schedule;</div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span>      <span class="comment">// NOTE: if wtmsig block signatures are enabled at genesis time this should be the hash of a producer authority schedule</span></div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span>      genheader.<a class="code hl_variable" href="structsysio_1_1chain_1_1block__header__state.html#a5345ec8573d52d400076e739db4cccce">pending_schedule</a>.<a class="code hl_variable" href="structsysio_1_1chain_1_1detail_1_1schedule__info.html#ace19480f2ab629e6b82a3a8286b38729">schedule_hash</a> = <a class="code hl_function" href="classfc_1_1sha256.html#a474784de7d6213b855abd7e952df5e36">fc::sha256::hash</a>(initial_legacy_schedule);</div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span>      genheader.<a class="code hl_variable" href="structsysio_1_1chain_1_1block__header__state.html#a6f6971715037cfbddcfbd54a88ff4d0f">header</a>.<a class="code hl_variable" href="structsysio_1_1chain_1_1block__header.html#a0fe1e5860e2b78b0a14da6565e2294bb">timestamp</a>               = genesis.initial_timestamp;</div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span>      genheader.<a class="code hl_variable" href="structsysio_1_1chain_1_1block__header__state.html#a6f6971715037cfbddcfbd54a88ff4d0f">header</a>.<a class="code hl_variable" href="structsysio_1_1chain_1_1block__header.html#a4096ec8f931ab9180ae80f6e06332103">action_mroot</a>            = genesis.compute_chain_id();</div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno">  464</span>      genheader.<a class="code hl_variable" href="structsysio_1_1chain_1_1block__header__state.html#a19f6899e80705092e990411eaed6e7a8">id</a>                             = genheader.<a class="code hl_variable" href="structsysio_1_1chain_1_1block__header__state.html#a6f6971715037cfbddcfbd54a88ff4d0f">header</a>.<a class="code hl_function" href="structsysio_1_1chain_1_1block__header.html#ab1f18a64cbf39c54da83f75c9632f9cd">calculate_id</a>();</div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span>      genheader.<a class="code hl_variable" href="structsysio_1_1chain_1_1detail_1_1block__header__state__common.html#ae85e3375836639cb1e7543aea7cf0552">block_num</a>                      = genheader.<a class="code hl_variable" href="structsysio_1_1chain_1_1block__header__state.html#a6f6971715037cfbddcfbd54a88ff4d0f">header</a>.<a class="code hl_function" href="structsysio_1_1chain_1_1block__header.html#a84daf28c790313cfaffff12e2a962cdb">block_num</a>();</div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno">  466</span> </div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno">  467</span>      <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a56a0f369b58e6597b62569ff2853ee90">head</a> = std::make_shared&lt;block_state&gt;();</div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno">  468</span>      <span class="keyword">static_cast&lt;</span><a class="code hl_struct" href="structsysio_1_1chain_1_1block__header__state.html">block_header_state</a>&amp;<span class="keyword">&gt;</span>(*head) = genheader;</div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno">  469</span>      <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a56a0f369b58e6597b62569ff2853ee90">head</a>-&gt;<a class="code hl_variable" href="structsysio_1_1chain_1_1block__header__state.html#a20bdbb99af936c532c6c316d8abc981c">activated_protocol_features</a> = std::make_shared&lt;protocol_feature_activation_set&gt;();</div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span>      <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a56a0f369b58e6597b62569ff2853ee90">head</a>-&gt;block = std::make_shared&lt;signed_block&gt;(genheader.<a class="code hl_variable" href="structsysio_1_1chain_1_1block__header__state.html#a6f6971715037cfbddcfbd54a88ff4d0f">header</a>);</div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno">  471</span>      <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>.<a class="code hl_function" href="classchainbase_1_1database.html#a24e7f6336cad0bd2fc280dab381665ed">set_revision</a>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a56a0f369b58e6597b62569ff2853ee90">head</a>-&gt;block_num );</div>
<div class="line"><a id="l00472" name="l00472"></a><span class="lineno">  472</span>      <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a01cf826f5503f482715ca2b724279cde">initialize_database</a>(genesis);</div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno">  473</span>   }</div>
</div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno">  474</span> </div>
<div class="foldopen" id="foldopen00475" data-start="{" data-end="}">
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#a9a9e4b6fe15eb93e63ac98af9f170647">  475</a></span>   <span class="keywordtype">void</span> <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a9a9e4b6fe15eb93e63ac98af9f170647">replay</a>(std::function&lt;<span class="keywordtype">bool</span>()&gt; check_shutdown) {</div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span>      <span class="keywordflow">if</span>( !<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a958ab2b868a2a7ec9644199a80e0ad9e">blog</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1block__log.html#ae787e7866ebfcd4c5dd5632c15c07c88">head</a>() &amp;&amp; !<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af7f72e6389799b7921aa98f30534f0d9">fork_db</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1fork__database.html#a31db3526cc966f5db1046cebcfc45219">root</a>() ) {</div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno">  477</span>         <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af7f72e6389799b7921aa98f30534f0d9">fork_db</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1fork__database.html#a7dd3012e6d7e68e24b2f223d5be09c02">reset</a>( *<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a56a0f369b58e6597b62569ff2853ee90">head</a> );</div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno">  478</span>         <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno">  479</span>      }</div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno">  480</span> </div>
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno">  481</span>      <span class="keyword">auto</span> blog_head = <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a958ab2b868a2a7ec9644199a80e0ad9e">blog</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1block__log.html#ae787e7866ebfcd4c5dd5632c15c07c88">head</a>();</div>
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno">  482</span>      <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a3bd1eefa999ba89597c3686e0acc463e">replaying</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span>      <span class="keyword">auto</span> start_block_num = <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a56a0f369b58e6597b62569ff2853ee90">head</a>-&gt;block_num + 1;</div>
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno">  484</span>      <span class="keyword">auto</span> start = <a class="code hl_function" href="classfc_1_1time__point.html#aa164ff1268a16d4b32afcff181f6100e">fc::time_point::now</a>();</div>
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno">  485</span> </div>
<div class="line"><a id="l00486" name="l00486"></a><span class="lineno">  486</span>      std::exception_ptr except_ptr;</div>
<div class="line"><a id="l00487" name="l00487"></a><span class="lineno">  487</span> </div>
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno">  488</span>      <span class="keywordflow">if</span>( blog_head &amp;&amp; start_block_num &lt;= blog_head-&gt;block_num() ) {</div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno">  489</span>         <a class="code hl_define" href="logger_8hpp.html#a831cf08dc63704c11fd154132c6e8bdb">ilog</a>( <span class="stringliteral">&quot;existing block log, attempting to replay from ${s} to ${n} blocks&quot;</span>,</div>
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno">  490</span>               (<span class="stringliteral">&quot;s&quot;</span>, start_block_num)(<span class="stringliteral">&quot;n&quot;</span>, blog_head-&gt;block_num()) );</div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno">  491</span>         <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno">  492</span>            <span class="keywordflow">while</span>( <span class="keyword">auto</span> next = <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a958ab2b868a2a7ec9644199a80e0ad9e">blog</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1block__log.html#a99c59d29b262144ad99eacc827f76107">read_block_by_num</a>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a56a0f369b58e6597b62569ff2853ee90">head</a>-&gt;block_num + 1 ) ) {</div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno">  493</span>               <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a2fe4194f0202db6c18bc17572b2adaa2">replay_push_block</a>( next, <a class="code hl_enumvalue" href="classsysio_1_1chain_1_1controller.html#a8b5124e077de1a73bb193e9c72b366b6a7e6e4eb3ff27864637756cb4d2a2a45d">controller::block_status::irreversible</a> );</div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span>               <span class="keywordflow">if</span>( check_shutdown() ) <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno">  495</span>               <span class="keywordflow">if</span>( next-&gt;block_num() % 500 == 0 ) {</div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno">  496</span>                  <a class="code hl_define" href="logger_8hpp.html#a831cf08dc63704c11fd154132c6e8bdb">ilog</a>( <span class="stringliteral">&quot;${n} of ${head}&quot;</span>, (<span class="stringliteral">&quot;n&quot;</span>, next-&gt;block_num())(<span class="stringliteral">&quot;head&quot;</span>, blog_head-&gt;block_num()) );</div>
<div class="line"><a id="l00497" name="l00497"></a><span class="lineno">  497</span>               }</div>
<div class="line"><a id="l00498" name="l00498"></a><span class="lineno">  498</span>            }</div>
<div class="line"><a id="l00499" name="l00499"></a><span class="lineno">  499</span>         } <span class="keywordflow">catch</span>(  <span class="keyword">const</span> database_guard_exception&amp; e ) {</div>
<div class="line"><a id="l00500" name="l00500"></a><span class="lineno">  500</span>            except_ptr = std::current_exception();</div>
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno">  501</span>         }</div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno">  502</span>         <a class="code hl_define" href="logger_8hpp.html#a831cf08dc63704c11fd154132c6e8bdb">ilog</a>( <span class="stringliteral">&quot;${n} irreversible blocks replayed&quot;</span>, (<span class="stringliteral">&quot;n&quot;</span>, 1 + <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a56a0f369b58e6597b62569ff2853ee90">head</a>-&gt;block_num - start_block_num) );</div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span> </div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span>         <span class="keyword">auto</span> pending_head = <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af7f72e6389799b7921aa98f30534f0d9">fork_db</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1fork__database.html#a16e619525d86741f3e5344b39ab91868">pending_head</a>();</div>
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno">  505</span>         <span class="keywordflow">if</span>( pending_head ) {</div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno">  506</span>            <a class="code hl_define" href="logger_8hpp.html#a831cf08dc63704c11fd154132c6e8bdb">ilog</a>( <span class="stringliteral">&quot;fork database head ${h}, root ${r}&quot;</span>, (<span class="stringliteral">&quot;h&quot;</span>, pending_head-&gt;block_num)( <span class="stringliteral">&quot;r&quot;</span>, <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af7f72e6389799b7921aa98f30534f0d9">fork_db</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1fork__database.html#a31db3526cc966f5db1046cebcfc45219">root</a>()-&gt;block_num ) );</div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span>            <span class="keywordflow">if</span>( pending_head-&gt;block_num &lt; <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a56a0f369b58e6597b62569ff2853ee90">head</a>-&gt;block_num || <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a56a0f369b58e6597b62569ff2853ee90">head</a>-&gt;block_num &lt; <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af7f72e6389799b7921aa98f30534f0d9">fork_db</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1fork__database.html#a31db3526cc966f5db1046cebcfc45219">root</a>()-&gt;block_num ) {</div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span>               <a class="code hl_define" href="logger_8hpp.html#a831cf08dc63704c11fd154132c6e8bdb">ilog</a>( <span class="stringliteral">&quot;resetting fork database with new last irreversible block as the new root: ${id}&quot;</span>, (<span class="stringliteral">&quot;id&quot;</span>, <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a56a0f369b58e6597b62569ff2853ee90">head</a>-&gt;id) );</div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno">  509</span>               <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af7f72e6389799b7921aa98f30534f0d9">fork_db</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1fork__database.html#a7dd3012e6d7e68e24b2f223d5be09c02">reset</a>( *<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a56a0f369b58e6597b62569ff2853ee90">head</a> );</div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span>            } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a56a0f369b58e6597b62569ff2853ee90">head</a>-&gt;block_num != <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af7f72e6389799b7921aa98f30534f0d9">fork_db</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1fork__database.html#a31db3526cc966f5db1046cebcfc45219">root</a>()-&gt;block_num ) {</div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span>               <span class="keyword">auto</span> new_root = <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af7f72e6389799b7921aa98f30534f0d9">fork_db</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1fork__database.html#a17185d8543965b7cd40066019bbf5740">search_on_branch</a>( pending_head-&gt;id, <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a56a0f369b58e6597b62569ff2853ee90">head</a>-&gt;block_num );</div>
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno">  512</span>               <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( new_root, <a class="code hl_variable" href="namespacesysio_1_1chain.html#acad19c1ca23d796138841046c67b3ea9">fork_database_exception</a>,</div>
<div class="line"><a id="l00513" name="l00513"></a><span class="lineno">  513</span>                           <span class="stringliteral">&quot;unexpected error: could not find new LIB in fork database&quot;</span> );</div>
<div class="line"><a id="l00514" name="l00514"></a><span class="lineno">  514</span>               <a class="code hl_define" href="logger_8hpp.html#a831cf08dc63704c11fd154132c6e8bdb">ilog</a>( <span class="stringliteral">&quot;advancing fork database root to new last irreversible block within existing fork database: ${id}&quot;</span>,</div>
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno">  515</span>                     (<span class="stringliteral">&quot;id&quot;</span>, new_root-&gt;id) );</div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span>               <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af7f72e6389799b7921aa98f30534f0d9">fork_db</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1fork__database.html#a764fc46000bb93901ba6440fec07b5f9">mark_valid</a>( new_root );</div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span>               <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af7f72e6389799b7921aa98f30534f0d9">fork_db</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1fork__database.html#ae911acbc996994cb6dfd21fddfb89a45">advance_root</a>( new_root-&gt;id );</div>
<div class="line"><a id="l00518" name="l00518"></a><span class="lineno">  518</span>            }</div>
<div class="line"><a id="l00519" name="l00519"></a><span class="lineno">  519</span>         }</div>
<div class="line"><a id="l00520" name="l00520"></a><span class="lineno">  520</span> </div>
<div class="line"><a id="l00521" name="l00521"></a><span class="lineno">  521</span>         <span class="comment">// if the irreverible log is played without undo sessions enabled, we need to sync the</span></div>
<div class="line"><a id="l00522" name="l00522"></a><span class="lineno">  522</span>         <span class="comment">// revision ordinal to the appropriate expected value here.</span></div>
<div class="line"><a id="l00523" name="l00523"></a><span class="lineno">  523</span>         <span class="keywordflow">if</span>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a64851fb4e041dc49ab22cf2ba335720d">self</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#ac8eea0639eeef0fc0d304f645b80d884">skip_db_sessions</a>( <a class="code hl_enumvalue" href="classsysio_1_1chain_1_1controller.html#a8b5124e077de1a73bb193e9c72b366b6a7e6e4eb3ff27864637756cb4d2a2a45d">controller::block_status::irreversible</a> ) )</div>
<div class="line"><a id="l00524" name="l00524"></a><span class="lineno">  524</span>            <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>.<a class="code hl_function" href="classchainbase_1_1database.html#a24e7f6336cad0bd2fc280dab381665ed">set_revision</a>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a56a0f369b58e6597b62569ff2853ee90">head</a>-&gt;block_num );</div>
<div class="line"><a id="l00525" name="l00525"></a><span class="lineno">  525</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00526" name="l00526"></a><span class="lineno">  526</span>         <a class="code hl_define" href="logger_8hpp.html#a831cf08dc63704c11fd154132c6e8bdb">ilog</a>( <span class="stringliteral">&quot;no irreversible blocks need to be replayed&quot;</span> );</div>
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno">  527</span>      }</div>
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno">  528</span> </div>
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno">  529</span>      <span class="keywordflow">if</span>( !except_ptr &amp;&amp; !check_shutdown() &amp;&amp; <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af7f72e6389799b7921aa98f30534f0d9">fork_db</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1fork__database.html#a3b128a7d57c262ef6351d83c16cffae3">head</a>() ) {</div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span>         <span class="keyword">auto</span> head_block_num = <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a56a0f369b58e6597b62569ff2853ee90">head</a>-&gt;block_num;</div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span>         <span class="keyword">auto</span> branch = <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af7f72e6389799b7921aa98f30534f0d9">fork_db</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1fork__database.html#a18e51b748469f97473d120ef69e1da22">fetch_branch</a>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af7f72e6389799b7921aa98f30534f0d9">fork_db</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1fork__database.html#a3b128a7d57c262ef6351d83c16cffae3">head</a>()-&gt;id );</div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno">  532</span>         <span class="keywordtype">int</span> rev = 0;</div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span>         <span class="keywordflow">for</span>( <span class="keyword">auto</span> i = branch.rbegin(); i != branch.rend(); ++i ) {</div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span>            <span class="keywordflow">if</span>( check_shutdown() ) <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno">  535</span>            <span class="keywordflow">if</span>( (*i)-&gt;block_num &lt;= head_block_num ) <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno">  536</span>            ++rev;</div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span>            <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a2fe4194f0202db6c18bc17572b2adaa2">replay_push_block</a>( (*i)-&gt;block, <a class="code hl_enumvalue" href="classsysio_1_1chain_1_1controller.html#a8b5124e077de1a73bb193e9c72b366b6ac9e825f4641cd3bec0ba01a0c2d67755">controller::block_status::validated</a> );</div>
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno">  538</span>         }</div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span>         <a class="code hl_define" href="logger_8hpp.html#a831cf08dc63704c11fd154132c6e8bdb">ilog</a>( <span class="stringliteral">&quot;${n} reversible blocks replayed&quot;</span>, (<span class="stringliteral">&quot;n&quot;</span>,rev) );</div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span>      }</div>
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno">  541</span> </div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno">  542</span>      <span class="keywordflow">if</span>( !<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af7f72e6389799b7921aa98f30534f0d9">fork_db</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1fork__database.html#a3b128a7d57c262ef6351d83c16cffae3">head</a>() ) {</div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span>         <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af7f72e6389799b7921aa98f30534f0d9">fork_db</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1fork__database.html#a7dd3012e6d7e68e24b2f223d5be09c02">reset</a>( *<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a56a0f369b58e6597b62569ff2853ee90">head</a> );</div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno">  544</span>      }</div>
<div class="line"><a id="l00545" name="l00545"></a><span class="lineno">  545</span> </div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno">  546</span>      <span class="keyword">auto</span> end = <a class="code hl_function" href="classfc_1_1time__point.html#aa164ff1268a16d4b32afcff181f6100e">fc::time_point::now</a>();</div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno">  547</span>      <a class="code hl_define" href="logger_8hpp.html#a831cf08dc63704c11fd154132c6e8bdb">ilog</a>( <span class="stringliteral">&quot;replayed ${n} blocks in ${duration} seconds, ${mspb} ms/block&quot;</span>,</div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno">  548</span>            (<span class="stringliteral">&quot;n&quot;</span>, <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a56a0f369b58e6597b62569ff2853ee90">head</a>-&gt;block_num + 1 - start_block_num)(<span class="stringliteral">&quot;duration&quot;</span>, (end-start).count()/1000000)</div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno">  549</span>            (<span class="stringliteral">&quot;mspb&quot;</span>, ((end-start).count()/1000.0)/(<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a56a0f369b58e6597b62569ff2853ee90">head</a>-&gt;block_num-start_block_num)) );</div>
<div class="line"><a id="l00550" name="l00550"></a><span class="lineno">  550</span>      <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a3bd1eefa999ba89597c3686e0acc463e">replaying</a> = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00551" name="l00551"></a><span class="lineno">  551</span> </div>
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno">  552</span>      <span class="keywordflow">if</span>( except_ptr ) {</div>
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno">  553</span>         std::rethrow_exception( except_ptr );</div>
<div class="line"><a id="l00554" name="l00554"></a><span class="lineno">  554</span>      }</div>
<div class="line"><a id="l00555" name="l00555"></a><span class="lineno">  555</span>   }</div>
</div>
<div class="line"><a id="l00556" name="l00556"></a><span class="lineno">  556</span> </div>
<div class="foldopen" id="foldopen00557" data-start="{" data-end="}">
<div class="line"><a id="l00557" name="l00557"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#a18bcf25847599b0f9caa6566364bb0ac">  557</a></span>   <span class="keywordtype">void</span> <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a18bcf25847599b0f9caa6566364bb0ac">startup</a>(std::function&lt;<span class="keywordtype">void</span>()&gt; <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a8054e1b3da405a7765275b76d6628928">shutdown</a>, std::function&lt;<span class="keywordtype">bool</span>()&gt; check_shutdown, <span class="keyword">const</span> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#aaa27dacddc54cea475602788c8e7a02c">snapshot_reader_ptr</a>&amp; snapshot) {</div>
<div class="line"><a id="l00558" name="l00558"></a><span class="lineno">  558</span>      <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( snapshot, snapshot_exception, <span class="stringliteral">&quot;No snapshot reader provided&quot;</span> );</div>
<div class="line"><a id="l00559" name="l00559"></a><span class="lineno">  559</span>      this-&gt;shutdown = <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a8054e1b3da405a7765275b76d6628928">shutdown</a>;</div>
<div class="line"><a id="l00560" name="l00560"></a><span class="lineno">  560</span>      <a class="code hl_define" href="logger_8hpp.html#a831cf08dc63704c11fd154132c6e8bdb">ilog</a>( <span class="stringliteral">&quot;Starting initialization from snapshot, this may take a significant amount of time&quot;</span> );</div>
<div class="line"><a id="l00561" name="l00561"></a><span class="lineno">  561</span>      <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l00562" name="l00562"></a><span class="lineno">  562</span>         snapshot-&gt;validate();</div>
<div class="line"><a id="l00563" name="l00563"></a><span class="lineno">  563</span>         <span class="keywordflow">if</span>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a958ab2b868a2a7ec9644199a80e0ad9e">blog</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1block__log.html#ae787e7866ebfcd4c5dd5632c15c07c88">head</a>() ) {</div>
<div class="line"><a id="l00564" name="l00564"></a><span class="lineno">  564</span>            <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a247c87d241e707c5e482c3d6d8872a7f">read_from_snapshot</a>( snapshot, <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a958ab2b868a2a7ec9644199a80e0ad9e">blog</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1block__log.html#ac5f1c1e78e72414fbf9bae75da42303e">first_block_num</a>(), <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a958ab2b868a2a7ec9644199a80e0ad9e">blog</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1block__log.html#ae787e7866ebfcd4c5dd5632c15c07c88">head</a>()-&gt;block_num() );</div>
<div class="line"><a id="l00565" name="l00565"></a><span class="lineno">  565</span>         } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno">  566</span>            <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a247c87d241e707c5e482c3d6d8872a7f">read_from_snapshot</a>( snapshot, 0, std::numeric_limits&lt;uint32_t&gt;::max() );</div>
<div class="line"><a id="l00567" name="l00567"></a><span class="lineno">  567</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> lib_num = <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a56a0f369b58e6597b62569ff2853ee90">head</a>-&gt;block_num;</div>
<div class="line"><a id="l00568" name="l00568"></a><span class="lineno">  568</span>            <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( lib_num &gt; 0, snapshot_exception,</div>
<div class="line"><a id="l00569" name="l00569"></a><span class="lineno">  569</span>                        <span class="stringliteral">&quot;Snapshot indicates controller head at block number 0, but that is not allowed. &quot;</span></div>
<div class="line"><a id="l00570" name="l00570"></a><span class="lineno">  570</span>                        <span class="stringliteral">&quot;Snapshot is invalid.&quot;</span> );</div>
<div class="line"><a id="l00571" name="l00571"></a><span class="lineno">  571</span>            <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a958ab2b868a2a7ec9644199a80e0ad9e">blog</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1block__log.html#af7c368f1aa0e3e827d619228c4e144bd">reset</a>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a2f7115cf9c5daa3abca8e0467dce5a5a">chain_id</a>, lib_num + 1 );</div>
<div class="line"><a id="l00572" name="l00572"></a><span class="lineno">  572</span>         }</div>
<div class="line"><a id="l00573" name="l00573"></a><span class="lineno">  573</span>         <span class="keyword">const</span> <span class="keyword">auto</span> hash = <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#ae80ad4ddd1eff225dc19c50439d82ef6">calculate_integrity_hash</a>();</div>
<div class="line"><a id="l00574" name="l00574"></a><span class="lineno">  574</span>         <a class="code hl_define" href="logger_8hpp.html#a831cf08dc63704c11fd154132c6e8bdb">ilog</a>( <span class="stringliteral">&quot;database initialized with hash: ${hash}&quot;</span>, (<span class="stringliteral">&quot;hash&quot;</span>, hash) );</div>
<div class="line"><a id="l00575" name="l00575"></a><span class="lineno">  575</span> </div>
<div class="line"><a id="l00576" name="l00576"></a><span class="lineno">  576</span>         <a class="code hl_function" href="lib_8h.html#a02fd73d861ef2e4aabb38c0c9ff82947">init</a>(check_shutdown);</div>
<div class="line"><a id="l00577" name="l00577"></a><span class="lineno">  577</span>         <a class="code hl_define" href="logger_8hpp.html#a831cf08dc63704c11fd154132c6e8bdb">ilog</a>( <span class="stringliteral">&quot;Finished initialization from snapshot&quot;</span> );</div>
<div class="line"><a id="l00578" name="l00578"></a><span class="lineno">  578</span>      } <span class="keywordflow">catch</span> (boost::interprocess::bad_alloc&amp; e) {</div>
<div class="line"><a id="l00579" name="l00579"></a><span class="lineno">  579</span>         <a class="code hl_define" href="logger_8hpp.html#a9e3cdbaecd5a34b42956e888f7326fad">elog</a>( <span class="stringliteral">&quot;Failed initialization from snapshot - db storage not configured to have enough storage for the provided snapshot, please increase and retry snapshot&quot;</span> );</div>
<div class="line"><a id="l00580" name="l00580"></a><span class="lineno">  580</span>         <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a8054e1b3da405a7765275b76d6628928">shutdown</a>();</div>
<div class="line"><a id="l00581" name="l00581"></a><span class="lineno">  581</span>      }</div>
<div class="line"><a id="l00582" name="l00582"></a><span class="lineno">  582</span> </div>
<div class="line"><a id="l00583" name="l00583"></a><span class="lineno">  583</span>   }</div>
</div>
<div class="line"><a id="l00584" name="l00584"></a><span class="lineno">  584</span> </div>
<div class="foldopen" id="foldopen00585" data-start="{" data-end="}">
<div class="line"><a id="l00585" name="l00585"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#a7863870ecde398ac7def54e4814db6bc">  585</a></span>   <span class="keywordtype">void</span> <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a7863870ecde398ac7def54e4814db6bc">startup</a>(std::function&lt;<span class="keywordtype">void</span>()&gt; <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a8054e1b3da405a7765275b76d6628928">shutdown</a>, std::function&lt;<span class="keywordtype">bool</span>()&gt; check_shutdown, <span class="keyword">const</span> <a class="code hl_struct" href="structsysio_1_1chain_1_1genesis__state.html">genesis_state</a>&amp; genesis) {</div>
<div class="line"><a id="l00586" name="l00586"></a><span class="lineno">  586</span>      <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>.<a class="code hl_function" href="classchainbase_1_1database.html#a224fc0c346a93fd027bfa2515f54bf98">revision</a>() &lt; 1, <a class="code hl_variable" href="namespacesysio_1_1chain.html#a6b9cb254135911c4a6d577a9ab7fdd4e">database_exception</a>, <span class="stringliteral">&quot;This version of controller::startup only works with a fresh state database.&quot;</span> );</div>
<div class="line"><a id="l00587" name="l00587"></a><span class="lineno">  587</span>      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; genesis_chain_id = genesis.compute_chain_id();</div>
<div class="line"><a id="l00588" name="l00588"></a><span class="lineno">  588</span>      <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( genesis_chain_id == <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a2f7115cf9c5daa3abca8e0467dce5a5a">chain_id</a>, chain_id_type_exception,</div>
<div class="line"><a id="l00589" name="l00589"></a><span class="lineno">  589</span>                  <span class="stringliteral">&quot;genesis state provided to startup corresponds to a chain ID (${genesis_chain_id}) that does not match the chain ID that controller was constructed with (${controller_chain_id})&quot;</span>,</div>
<div class="line"><a id="l00590" name="l00590"></a><span class="lineno">  590</span>                  (<span class="stringliteral">&quot;genesis_chain_id&quot;</span>, genesis_chain_id)(<span class="stringliteral">&quot;controller_chain_id&quot;</span>, <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a2f7115cf9c5daa3abca8e0467dce5a5a">chain_id</a>)</div>
<div class="line"><a id="l00591" name="l00591"></a><span class="lineno">  591</span>      );</div>
<div class="line"><a id="l00592" name="l00592"></a><span class="lineno">  592</span> </div>
<div class="line"><a id="l00593" name="l00593"></a><span class="lineno">  593</span>      this-&gt;shutdown = <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a8054e1b3da405a7765275b76d6628928">shutdown</a>;</div>
<div class="line"><a id="l00594" name="l00594"></a><span class="lineno">  594</span>      <span class="keywordflow">if</span>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af7f72e6389799b7921aa98f30534f0d9">fork_db</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1fork__database.html#a3b128a7d57c262ef6351d83c16cffae3">head</a>() ) {</div>
<div class="line"><a id="l00595" name="l00595"></a><span class="lineno">  595</span>         <span class="keywordflow">if</span>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a4a18397f763ebe4880b6ccd970bedf85">read_mode</a> == <a class="code hl_enumvalue" href="namespacesysio_1_1chain.html#af3e35f3e1b78dd00fa247009a2d9ba5ea88537e4e57a14e27d354f8ef6fc03d63">db_read_mode::IRREVERSIBLE</a> &amp;&amp; <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af7f72e6389799b7921aa98f30534f0d9">fork_db</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1fork__database.html#a3b128a7d57c262ef6351d83c16cffae3">head</a>()-&gt;id != <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af7f72e6389799b7921aa98f30534f0d9">fork_db</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1fork__database.html#a31db3526cc966f5db1046cebcfc45219">root</a>()-&gt;id ) {</div>
<div class="line"><a id="l00596" name="l00596"></a><span class="lineno">  596</span>            <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af7f72e6389799b7921aa98f30534f0d9">fork_db</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1fork__database.html#a611cc70b13dee823c43ffe99df5522d4">rollback_head_to_root</a>();</div>
<div class="line"><a id="l00597" name="l00597"></a><span class="lineno">  597</span>         }</div>
<div class="line"><a id="l00598" name="l00598"></a><span class="lineno">  598</span>         <a class="code hl_define" href="logger_8hpp.html#a1759e5c9691d8ad754bdf5eff8bb23ac">wlog</a>( <span class="stringliteral">&quot;No existing chain state. Initializing fresh blockchain state.&quot;</span> );</div>
<div class="line"><a id="l00599" name="l00599"></a><span class="lineno">  599</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00600" name="l00600"></a><span class="lineno">  600</span>         <a class="code hl_define" href="logger_8hpp.html#a1759e5c9691d8ad754bdf5eff8bb23ac">wlog</a>( <span class="stringliteral">&quot;No existing chain state or fork database. Initializing fresh blockchain state and resetting fork database.&quot;</span>);</div>
<div class="line"><a id="l00601" name="l00601"></a><span class="lineno">  601</span>      }</div>
<div class="line"><a id="l00602" name="l00602"></a><span class="lineno">  602</span>      <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a8d08d7c15ecb706c0bd54e992019c30d">initialize_blockchain_state</a>(genesis); <span class="comment">// sets head to genesis state</span></div>
<div class="line"><a id="l00603" name="l00603"></a><span class="lineno">  603</span> </div>
<div class="line"><a id="l00604" name="l00604"></a><span class="lineno">  604</span>      <span class="keywordflow">if</span>( !<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af7f72e6389799b7921aa98f30534f0d9">fork_db</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1fork__database.html#a3b128a7d57c262ef6351d83c16cffae3">head</a>() ) {</div>
<div class="line"><a id="l00605" name="l00605"></a><span class="lineno">  605</span>         <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af7f72e6389799b7921aa98f30534f0d9">fork_db</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1fork__database.html#a7dd3012e6d7e68e24b2f223d5be09c02">reset</a>( *<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a56a0f369b58e6597b62569ff2853ee90">head</a> );</div>
<div class="line"><a id="l00606" name="l00606"></a><span class="lineno">  606</span>      }</div>
<div class="line"><a id="l00607" name="l00607"></a><span class="lineno">  607</span> </div>
<div class="line"><a id="l00608" name="l00608"></a><span class="lineno">  608</span>      <span class="keywordflow">if</span>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a958ab2b868a2a7ec9644199a80e0ad9e">blog</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1block__log.html#ae787e7866ebfcd4c5dd5632c15c07c88">head</a>() ) {</div>
<div class="line"><a id="l00609" name="l00609"></a><span class="lineno">  609</span>         <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a958ab2b868a2a7ec9644199a80e0ad9e">blog</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1block__log.html#ac5f1c1e78e72414fbf9bae75da42303e">first_block_num</a>() == 1, block_log_exception,</div>
<div class="line"><a id="l00610" name="l00610"></a><span class="lineno">  610</span>                     <span class="stringliteral">&quot;block log does not start with genesis block&quot;</span></div>
<div class="line"><a id="l00611" name="l00611"></a><span class="lineno">  611</span>         );</div>
<div class="line"><a id="l00612" name="l00612"></a><span class="lineno">  612</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00613" name="l00613"></a><span class="lineno">  613</span>         <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a958ab2b868a2a7ec9644199a80e0ad9e">blog</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1block__log.html#af7c368f1aa0e3e827d619228c4e144bd">reset</a>( genesis, <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a56a0f369b58e6597b62569ff2853ee90">head</a>-&gt;block );</div>
<div class="line"><a id="l00614" name="l00614"></a><span class="lineno">  614</span>      }</div>
<div class="line"><a id="l00615" name="l00615"></a><span class="lineno">  615</span>      <a class="code hl_function" href="lib_8h.html#a02fd73d861ef2e4aabb38c0c9ff82947">init</a>(check_shutdown);</div>
<div class="line"><a id="l00616" name="l00616"></a><span class="lineno">  616</span>   }</div>
</div>
<div class="line"><a id="l00617" name="l00617"></a><span class="lineno">  617</span> </div>
<div class="foldopen" id="foldopen00618" data-start="{" data-end="}">
<div class="line"><a id="l00618" name="l00618"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#a90da90c73cb32b5e5ec498da5e02753f">  618</a></span>   <span class="keywordtype">void</span> <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a90da90c73cb32b5e5ec498da5e02753f">startup</a>(std::function&lt;<span class="keywordtype">void</span>()&gt; <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a8054e1b3da405a7765275b76d6628928">shutdown</a>, std::function&lt;<span class="keywordtype">bool</span>()&gt; check_shutdown) {</div>
<div class="line"><a id="l00619" name="l00619"></a><span class="lineno">  619</span>      <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>.<a class="code hl_function" href="classchainbase_1_1database.html#a224fc0c346a93fd027bfa2515f54bf98">revision</a>() &gt;= 1, <a class="code hl_variable" href="namespacesysio_1_1chain.html#a6b9cb254135911c4a6d577a9ab7fdd4e">database_exception</a>, <span class="stringliteral">&quot;This version of controller::startup does not work with a fresh state database.&quot;</span> );</div>
<div class="line"><a id="l00620" name="l00620"></a><span class="lineno">  620</span>      <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af7f72e6389799b7921aa98f30534f0d9">fork_db</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1fork__database.html#a3b128a7d57c262ef6351d83c16cffae3">head</a>(), <a class="code hl_variable" href="namespacesysio_1_1chain.html#acad19c1ca23d796138841046c67b3ea9">fork_database_exception</a>, <span class="stringliteral">&quot;No existing fork database despite existing chain state. Replay required.&quot;</span> );</div>
<div class="line"><a id="l00621" name="l00621"></a><span class="lineno">  621</span> </div>
<div class="line"><a id="l00622" name="l00622"></a><span class="lineno">  622</span>      this-&gt;shutdown = <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a8054e1b3da405a7765275b76d6628928">shutdown</a>;</div>
<div class="line"><a id="l00623" name="l00623"></a><span class="lineno">  623</span>      <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> lib_num = <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af7f72e6389799b7921aa98f30534f0d9">fork_db</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1fork__database.html#a31db3526cc966f5db1046cebcfc45219">root</a>()-&gt;block_num;</div>
<div class="line"><a id="l00624" name="l00624"></a><span class="lineno">  624</span>      <span class="keyword">auto</span> first_block_num = <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a958ab2b868a2a7ec9644199a80e0ad9e">blog</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1block__log.html#ac5f1c1e78e72414fbf9bae75da42303e">first_block_num</a>();</div>
<div class="line"><a id="l00625" name="l00625"></a><span class="lineno">  625</span>      <span class="keywordflow">if</span>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a958ab2b868a2a7ec9644199a80e0ad9e">blog</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1block__log.html#ae787e7866ebfcd4c5dd5632c15c07c88">head</a>() ) {</div>
<div class="line"><a id="l00626" name="l00626"></a><span class="lineno">  626</span>         <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( first_block_num &lt;= lib_num &amp;&amp; lib_num &lt;= <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a958ab2b868a2a7ec9644199a80e0ad9e">blog</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1block__log.html#ae787e7866ebfcd4c5dd5632c15c07c88">head</a>()-&gt;block_num(),</div>
<div class="line"><a id="l00627" name="l00627"></a><span class="lineno">  627</span>                     block_log_exception,</div>
<div class="line"><a id="l00628" name="l00628"></a><span class="lineno">  628</span>                     <span class="stringliteral">&quot;block log (ranging from ${block_log_first_num} to ${block_log_last_num}) does not contain the last irreversible block (${fork_db_lib})&quot;</span>,</div>
<div class="line"><a id="l00629" name="l00629"></a><span class="lineno">  629</span>                     (<span class="stringliteral">&quot;block_log_first_num&quot;</span>, first_block_num)</div>
<div class="line"><a id="l00630" name="l00630"></a><span class="lineno">  630</span>                     (<span class="stringliteral">&quot;block_log_last_num&quot;</span>, <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a958ab2b868a2a7ec9644199a80e0ad9e">blog</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1block__log.html#ae787e7866ebfcd4c5dd5632c15c07c88">head</a>()-&gt;block_num())</div>
<div class="line"><a id="l00631" name="l00631"></a><span class="lineno">  631</span>                     (<span class="stringliteral">&quot;fork_db_lib&quot;</span>, lib_num)</div>
<div class="line"><a id="l00632" name="l00632"></a><span class="lineno">  632</span>         );</div>
<div class="line"><a id="l00633" name="l00633"></a><span class="lineno">  633</span>         lib_num = <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a958ab2b868a2a7ec9644199a80e0ad9e">blog</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1block__log.html#ae787e7866ebfcd4c5dd5632c15c07c88">head</a>()-&gt;block_num();</div>
<div class="line"><a id="l00634" name="l00634"></a><span class="lineno">  634</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00635" name="l00635"></a><span class="lineno">  635</span>         <span class="keywordflow">if</span>( first_block_num != (lib_num + 1) ) {</div>
<div class="line"><a id="l00636" name="l00636"></a><span class="lineno">  636</span>            <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a958ab2b868a2a7ec9644199a80e0ad9e">blog</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1block__log.html#af7c368f1aa0e3e827d619228c4e144bd">reset</a>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a2f7115cf9c5daa3abca8e0467dce5a5a">chain_id</a>, lib_num + 1 );</div>
<div class="line"><a id="l00637" name="l00637"></a><span class="lineno">  637</span>         }</div>
<div class="line"><a id="l00638" name="l00638"></a><span class="lineno">  638</span>      }</div>
<div class="line"><a id="l00639" name="l00639"></a><span class="lineno">  639</span> </div>
<div class="line"><a id="l00640" name="l00640"></a><span class="lineno">  640</span>      <span class="keywordflow">if</span>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a4a18397f763ebe4880b6ccd970bedf85">read_mode</a> == <a class="code hl_enumvalue" href="namespacesysio_1_1chain.html#af3e35f3e1b78dd00fa247009a2d9ba5ea88537e4e57a14e27d354f8ef6fc03d63">db_read_mode::IRREVERSIBLE</a> &amp;&amp; <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af7f72e6389799b7921aa98f30534f0d9">fork_db</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1fork__database.html#a3b128a7d57c262ef6351d83c16cffae3">head</a>()-&gt;id != <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af7f72e6389799b7921aa98f30534f0d9">fork_db</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1fork__database.html#a31db3526cc966f5db1046cebcfc45219">root</a>()-&gt;id ) {</div>
<div class="line"><a id="l00641" name="l00641"></a><span class="lineno">  641</span>         <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af7f72e6389799b7921aa98f30534f0d9">fork_db</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1fork__database.html#a611cc70b13dee823c43ffe99df5522d4">rollback_head_to_root</a>();</div>
<div class="line"><a id="l00642" name="l00642"></a><span class="lineno">  642</span>      }</div>
<div class="line"><a id="l00643" name="l00643"></a><span class="lineno">  643</span>      <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a56a0f369b58e6597b62569ff2853ee90">head</a> = <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af7f72e6389799b7921aa98f30534f0d9">fork_db</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1fork__database.html#a3b128a7d57c262ef6351d83c16cffae3">head</a>();</div>
<div class="line"><a id="l00644" name="l00644"></a><span class="lineno">  644</span> </div>
<div class="line"><a id="l00645" name="l00645"></a><span class="lineno">  645</span>      <a class="code hl_function" href="lib_8h.html#a02fd73d861ef2e4aabb38c0c9ff82947">init</a>(check_shutdown);</div>
<div class="line"><a id="l00646" name="l00646"></a><span class="lineno">  646</span>   }</div>
</div>
<div class="line"><a id="l00647" name="l00647"></a><span class="lineno">  647</span> </div>
<div class="line"><a id="l00648" name="l00648"></a><span class="lineno">  648</span> </div>
<div class="foldopen" id="foldopen00649" data-start="{" data-end="}">
<div class="line"><a id="l00649" name="l00649"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#addaaa85d266d34e5f247ec9214354139">  649</a></span>   <span class="keyword">static</span> <span class="keyword">auto</span> <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#addaaa85d266d34e5f247ec9214354139">validate_db_version</a>( <span class="keyword">const</span> <a class="code hl_class" href="classchainbase_1_1database.html">chainbase::database</a>&amp; <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a> ) {</div>
<div class="line"><a id="l00650" name="l00650"></a><span class="lineno">  650</span>      <span class="comment">// check database version</span></div>
<div class="line"><a id="l00651" name="l00651"></a><span class="lineno">  651</span>      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; header_idx = <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>.<a class="code hl_function" href="classchainbase_1_1database.html#a4d5297635dcf70be481d9b600da9bc13">get_index</a>&lt;<a class="code hl_typedef" href="namespacesysio_1_1chain.html#a7d61e01ac919d654401a1db8399a3945">database_header_multi_index</a>&gt;().indices().get&lt;by_id&gt;();</div>
<div class="line"><a id="l00652" name="l00652"></a><span class="lineno">  652</span> </div>
<div class="line"><a id="l00653" name="l00653"></a><span class="lineno">  653</span>      <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>(header_idx.begin() != header_idx.end(), bad_database_version_exception,</div>
<div class="line"><a id="l00654" name="l00654"></a><span class="lineno">  654</span>                 <span class="stringliteral">&quot;state database version pre-dates versioning, please restore from a compatible snapshot or replay!&quot;</span>);</div>
<div class="line"><a id="l00655" name="l00655"></a><span class="lineno">  655</span> </div>
<div class="line"><a id="l00656" name="l00656"></a><span class="lineno">  656</span>      <span class="keyword">auto</span> header_itr = header_idx.begin();</div>
<div class="line"><a id="l00657" name="l00657"></a><span class="lineno">  657</span>      header_itr-&gt;validate();</div>
<div class="line"><a id="l00658" name="l00658"></a><span class="lineno">  658</span> </div>
<div class="line"><a id="l00659" name="l00659"></a><span class="lineno">  659</span>      <span class="keywordflow">return</span> header_itr;</div>
<div class="line"><a id="l00660" name="l00660"></a><span class="lineno">  660</span>   }</div>
</div>
<div class="line"><a id="l00661" name="l00661"></a><span class="lineno">  661</span> </div>
<div class="foldopen" id="foldopen00662" data-start="{" data-end="}">
<div class="line"><a id="l00662" name="l00662"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#a9efbc515682ae5dede91184c36af73f7">  662</a></span>   <span class="keywordtype">void</span> <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a9efbc515682ae5dede91184c36af73f7">init</a>(std::function&lt;<span class="keywordtype">bool</span>()&gt; check_shutdown) {</div>
<div class="line"><a id="l00663" name="l00663"></a><span class="lineno">  663</span>      <span class="keyword">auto</span> header_itr = <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#addaaa85d266d34e5f247ec9214354139">validate_db_version</a>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a> );</div>
<div class="line"><a id="l00664" name="l00664"></a><span class="lineno">  664</span> </div>
<div class="line"><a id="l00665" name="l00665"></a><span class="lineno">  665</span>      {</div>
<div class="line"><a id="l00666" name="l00666"></a><span class="lineno">  666</span>         <span class="keyword">const</span> <span class="keyword">auto</span>&amp; state_chain_id = <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>.<a class="code hl_function" href="classchainbase_1_1database.html#afcfe00f81a526c1376d4f51197dd3a9a">get</a>&lt;<a class="code hl_class" href="classsysio_1_1chain_1_1global__property__object.html">global_property_object</a>&gt;().<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a2f7115cf9c5daa3abca8e0467dce5a5a">chain_id</a>;</div>
<div class="line"><a id="l00667" name="l00667"></a><span class="lineno">  667</span>         <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( state_chain_id == <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a2f7115cf9c5daa3abca8e0467dce5a5a">chain_id</a>, chain_id_type_exception,</div>
<div class="line"><a id="l00668" name="l00668"></a><span class="lineno">  668</span>                     <span class="stringliteral">&quot;chain ID in state (${state_chain_id}) does not match the chain ID that controller was constructed with (${controller_chain_id})&quot;</span>,</div>
<div class="line"><a id="l00669" name="l00669"></a><span class="lineno">  669</span>                     (<span class="stringliteral">&quot;state_chain_id&quot;</span>, state_chain_id)(<span class="stringliteral">&quot;controller_chain_id&quot;</span>, <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a2f7115cf9c5daa3abca8e0467dce5a5a">chain_id</a>)</div>
<div class="line"><a id="l00670" name="l00670"></a><span class="lineno">  670</span>         );</div>
<div class="line"><a id="l00671" name="l00671"></a><span class="lineno">  671</span>      }</div>
<div class="line"><a id="l00672" name="l00672"></a><span class="lineno">  672</span> </div>
<div class="line"><a id="l00673" name="l00673"></a><span class="lineno">  673</span>      <span class="comment">// upgrade to the latest compatible version</span></div>
<div class="line"><a id="l00674" name="l00674"></a><span class="lineno">  674</span>      <span class="keywordflow">if</span> (header_itr-&gt;version != database_header_object::current_version) {</div>
<div class="line"><a id="l00675" name="l00675"></a><span class="lineno">  675</span>         <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>.<a class="code hl_function" href="classchainbase_1_1database.html#a9ebc006075e8fc2e84357a0e068b58d4">modify</a>(*header_itr, [](<span class="keyword">auto</span>&amp; header) {</div>
<div class="line"><a id="l00676" name="l00676"></a><span class="lineno">  676</span>            header.version = database_header_object::current_version;</div>
<div class="line"><a id="l00677" name="l00677"></a><span class="lineno">  677</span>         });</div>
<div class="line"><a id="l00678" name="l00678"></a><span class="lineno">  678</span>      }</div>
<div class="line"><a id="l00679" name="l00679"></a><span class="lineno">  679</span> </div>
<div class="line"><a id="l00680" name="l00680"></a><span class="lineno">  680</span>      <span class="comment">// At this point head != nullptr</span></div>
<div class="line"><a id="l00681" name="l00681"></a><span class="lineno">  681</span>      <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>.<a class="code hl_function" href="classchainbase_1_1database.html#a224fc0c346a93fd027bfa2515f54bf98">revision</a>() &gt;= <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a56a0f369b58e6597b62569ff2853ee90">head</a>-&gt;block_num, <a class="code hl_variable" href="namespacesysio_1_1chain.html#acad19c1ca23d796138841046c67b3ea9">fork_database_exception</a>,</div>
<div class="line"><a id="l00682" name="l00682"></a><span class="lineno">  682</span>                  <span class="stringliteral">&quot;fork database head (${head}) is inconsistent with state (${db})&quot;</span>,</div>
<div class="line"><a id="l00683" name="l00683"></a><span class="lineno">  683</span>                  (<span class="stringliteral">&quot;db&quot;</span>,<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>.<a class="code hl_function" href="classchainbase_1_1database.html#a224fc0c346a93fd027bfa2515f54bf98">revision</a>())(<span class="stringliteral">&quot;head&quot;</span>,<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a56a0f369b58e6597b62569ff2853ee90">head</a>-&gt;block_num) );</div>
<div class="line"><a id="l00684" name="l00684"></a><span class="lineno">  684</span> </div>
<div class="line"><a id="l00685" name="l00685"></a><span class="lineno">  685</span>      <span class="keywordflow">if</span>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>.<a class="code hl_function" href="classchainbase_1_1database.html#a224fc0c346a93fd027bfa2515f54bf98">revision</a>() &gt; <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a56a0f369b58e6597b62569ff2853ee90">head</a>-&gt;block_num ) {</div>
<div class="line"><a id="l00686" name="l00686"></a><span class="lineno">  686</span>         <a class="code hl_define" href="logger_8hpp.html#a1759e5c9691d8ad754bdf5eff8bb23ac">wlog</a>( <span class="stringliteral">&quot;database revision (${db}) is greater than head block number (${head}), &quot;</span></div>
<div class="line"><a id="l00687" name="l00687"></a><span class="lineno">  687</span>               <span class="stringliteral">&quot;attempting to undo pending changes&quot;</span>,</div>
<div class="line"><a id="l00688" name="l00688"></a><span class="lineno">  688</span>               (<span class="stringliteral">&quot;db&quot;</span>,<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>.<a class="code hl_function" href="classchainbase_1_1database.html#a224fc0c346a93fd027bfa2515f54bf98">revision</a>())(<span class="stringliteral">&quot;head&quot;</span>,<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a56a0f369b58e6597b62569ff2853ee90">head</a>-&gt;block_num) );</div>
<div class="line"><a id="l00689" name="l00689"></a><span class="lineno">  689</span>      }</div>
<div class="line"><a id="l00690" name="l00690"></a><span class="lineno">  690</span>      <span class="keywordflow">while</span>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>.<a class="code hl_function" href="classchainbase_1_1database.html#a224fc0c346a93fd027bfa2515f54bf98">revision</a>() &gt; <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a56a0f369b58e6597b62569ff2853ee90">head</a>-&gt;block_num ) {</div>
<div class="line"><a id="l00691" name="l00691"></a><span class="lineno">  691</span>         <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>.<a class="code hl_function" href="classchainbase_1_1database.html#a167bce30384de1f373ebe0c25d4d0de6">undo</a>();</div>
<div class="line"><a id="l00692" name="l00692"></a><span class="lineno">  692</span>      }</div>
<div class="line"><a id="l00693" name="l00693"></a><span class="lineno">  693</span> </div>
<div class="line"><a id="l00694" name="l00694"></a><span class="lineno">  694</span>      <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a24a100a7be5e562ac3966924b0c9ccb6">protocol_features</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1protocol__feature__manager.html#a573b85f64307919aa077810980b74b43">init</a>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a> );</div>
<div class="line"><a id="l00695" name="l00695"></a><span class="lineno">  695</span> </div>
<div class="line"><a id="l00696" name="l00696"></a><span class="lineno">  696</span>      <span class="keywordflow">if</span> (<span class="keyword">auto</span> dm_logger = <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a1b67831f3be3a668c170723427236954">get_deep_mind_logger</a>()) {</div>
<div class="line"><a id="l00697" name="l00697"></a><span class="lineno">  697</span>         dm_logger-&gt;on_startup(<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>, <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a56a0f369b58e6597b62569ff2853ee90">head</a>-&gt;block_num);</div>
<div class="line"><a id="l00698" name="l00698"></a><span class="lineno">  698</span>      }</div>
<div class="line"><a id="l00699" name="l00699"></a><span class="lineno">  699</span> </div>
<div class="line"><a id="l00700" name="l00700"></a><span class="lineno">  700</span>      <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a9a9e4b6fe15eb93e63ac98af9f170647">replay</a>( check_shutdown ); <span class="comment">// replay any irreversible and reversible blocks ahead of current head</span></div>
<div class="line"><a id="l00701" name="l00701"></a><span class="lineno">  701</span> </div>
<div class="line"><a id="l00702" name="l00702"></a><span class="lineno">  702</span>      <span class="keywordflow">if</span>( check_shutdown() ) <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00703" name="l00703"></a><span class="lineno">  703</span> </div>
<div class="line"><a id="l00704" name="l00704"></a><span class="lineno">  704</span>      <span class="comment">// At this point head != nullptr &amp;&amp; fork_db.head() != nullptr &amp;&amp; fork_db.root() != nullptr.</span></div>
<div class="line"><a id="l00705" name="l00705"></a><span class="lineno">  705</span>      <span class="comment">// Furthermore, fork_db.root()-&gt;block_num &lt;= lib_num.</span></div>
<div class="line"><a id="l00706" name="l00706"></a><span class="lineno">  706</span>      <span class="comment">// Also, even though blog.head() may still be nullptr, blog.first_block_num() is guaranteed to be lib_num + 1.</span></div>
<div class="line"><a id="l00707" name="l00707"></a><span class="lineno">  707</span> </div>
<div class="line"><a id="l00708" name="l00708"></a><span class="lineno">  708</span>      <span class="keywordflow">if</span>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a4a18397f763ebe4880b6ccd970bedf85">read_mode</a> != <a class="code hl_enumvalue" href="namespacesysio_1_1chain.html#af3e35f3e1b78dd00fa247009a2d9ba5ea88537e4e57a14e27d354f8ef6fc03d63">db_read_mode::IRREVERSIBLE</a></div>
<div class="line"><a id="l00709" name="l00709"></a><span class="lineno">  709</span>          &amp;&amp; <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af7f72e6389799b7921aa98f30534f0d9">fork_db</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1fork__database.html#a16e619525d86741f3e5344b39ab91868">pending_head</a>()-&gt;id != <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af7f72e6389799b7921aa98f30534f0d9">fork_db</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1fork__database.html#a3b128a7d57c262ef6351d83c16cffae3">head</a>()-&gt;id</div>
<div class="line"><a id="l00710" name="l00710"></a><span class="lineno">  710</span>          &amp;&amp; <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af7f72e6389799b7921aa98f30534f0d9">fork_db</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1fork__database.html#a3b128a7d57c262ef6351d83c16cffae3">head</a>()-&gt;id == <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af7f72e6389799b7921aa98f30534f0d9">fork_db</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1fork__database.html#a31db3526cc966f5db1046cebcfc45219">root</a>()-&gt;id</div>
<div class="line"><a id="l00711" name="l00711"></a><span class="lineno">  711</span>      ) {</div>
<div class="line"><a id="l00712" name="l00712"></a><span class="lineno">  712</span>         <a class="code hl_define" href="logger_8hpp.html#a1759e5c9691d8ad754bdf5eff8bb23ac">wlog</a>( <span class="stringliteral">&quot;read_mode has changed from irreversible: applying best branch from fork database&quot;</span> );</div>
<div class="line"><a id="l00713" name="l00713"></a><span class="lineno">  713</span> </div>
<div class="line"><a id="l00714" name="l00714"></a><span class="lineno">  714</span>         <span class="keywordflow">for</span>( <span class="keyword">auto</span> pending_head = <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af7f72e6389799b7921aa98f30534f0d9">fork_db</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1fork__database.html#a16e619525d86741f3e5344b39ab91868">pending_head</a>();</div>
<div class="line"><a id="l00715" name="l00715"></a><span class="lineno">  715</span>              pending_head-&gt;id != <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af7f72e6389799b7921aa98f30534f0d9">fork_db</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1fork__database.html#a3b128a7d57c262ef6351d83c16cffae3">head</a>()-&gt;id;</div>
<div class="line"><a id="l00716" name="l00716"></a><span class="lineno">  716</span>              pending_head = <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af7f72e6389799b7921aa98f30534f0d9">fork_db</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1fork__database.html#a16e619525d86741f3e5344b39ab91868">pending_head</a>()</div>
<div class="line"><a id="l00717" name="l00717"></a><span class="lineno">  717</span>         ) {</div>
<div class="line"><a id="l00718" name="l00718"></a><span class="lineno">  718</span>            <a class="code hl_define" href="logger_8hpp.html#a1759e5c9691d8ad754bdf5eff8bb23ac">wlog</a>( <span class="stringliteral">&quot;applying branch from fork database ending with block: ${id}&quot;</span>, (<span class="stringliteral">&quot;id&quot;</span>, pending_head-&gt;id) );</div>
<div class="line"><a id="l00719" name="l00719"></a><span class="lineno">  719</span>            <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#af15d89f9220ba97aa5c521e643746587">maybe_switch_forks</a>( pending_head, <a class="code hl_enumvalue" href="classsysio_1_1chain_1_1controller.html#a8b5124e077de1a73bb193e9c72b366b6ad9a22d7a8178d5b42a8750123cbfe5b1">controller::block_status::complete</a>, <a class="code hl_typedef" href="namespacesysio_1_1chain.html#ae043a3bf1321067bf1e4e7e5ab0ce3cd">forked_branch_callback</a>{}, <a class="code hl_typedef" href="namespacesysio_1_1chain.html#ad7e9cbb02002c4e7ab9825becb9f9f50">trx_meta_cache_lookup</a>{} );</div>
<div class="line"><a id="l00720" name="l00720"></a><span class="lineno">  720</span>         }</div>
<div class="line"><a id="l00721" name="l00721"></a><span class="lineno">  721</span>      }</div>
<div class="line"><a id="l00722" name="l00722"></a><span class="lineno">  722</span>   }</div>
</div>
<div class="line"><a id="l00723" name="l00723"></a><span class="lineno">  723</span> </div>
<div class="foldopen" id="foldopen00724" data-start="{" data-end="}">
<div class="line"><a id="l00724" name="l00724"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#af239089382ffa593908091df9d6d0cbd">  724</a></span>   <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#af239089382ffa593908091df9d6d0cbd">~controller_impl</a>() {</div>
<div class="line"><a id="l00725" name="l00725"></a><span class="lineno">  725</span>      <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#ab76d9091b7e62fb25a0fdd63c8210af9">thread_pool</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1named__thread__pool.html#a2cf9d662cfa57de6d29cd900f8375208">stop</a>();</div>
<div class="line"><a id="l00726" name="l00726"></a><span class="lineno">  726</span>      <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a0e355919fd924a05344ef2b59f7dd587">pending</a>.reset();</div>
<div class="line"><a id="l00727" name="l00727"></a><span class="lineno">  727</span>   }</div>
</div>
<div class="line"><a id="l00728" name="l00728"></a><span class="lineno">  728</span> </div>
<div class="foldopen" id="foldopen00729" data-start="{" data-end="}">
<div class="line"><a id="l00729" name="l00729"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#ac7dedae4e6f8bcbd20e69d1e5551e378">  729</a></span>   <span class="keywordtype">void</span> <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#ac7dedae4e6f8bcbd20e69d1e5551e378">add_indices</a>() {</div>
<div class="line"><a id="l00730" name="l00730"></a><span class="lineno">  730</span>      controller_index_set::add_indices(<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>);</div>
<div class="line"><a id="l00731" name="l00731"></a><span class="lineno">  731</span>      contract_database_index_set::add_indices(<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>);</div>
<div class="line"><a id="l00732" name="l00732"></a><span class="lineno">  732</span> </div>
<div class="line"><a id="l00733" name="l00733"></a><span class="lineno">  733</span>      <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#ab90d295ac18fa98f2520e4eade5b3773">authorization</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1authorization__manager.html#a112c1fae696fe6f53103076e9afa5a16">add_indices</a>();</div>
<div class="line"><a id="l00734" name="l00734"></a><span class="lineno">  734</span>      <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a83a037a61ce8e07b39d2d38b0f54f8f7">resource_limits</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1resource__limits_1_1resource__limits__manager.html#acc5c0d662f97873d93dadbf8b6451978">add_indices</a>();</div>
<div class="line"><a id="l00735" name="l00735"></a><span class="lineno">  735</span>   }</div>
</div>
<div class="line"><a id="l00736" name="l00736"></a><span class="lineno">  736</span> </div>
<div class="foldopen" id="foldopen00737" data-start="{" data-end="}">
<div class="line"><a id="l00737" name="l00737"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#ade7505662796ff416f1d43862b0507fb">  737</a></span>   <span class="keywordtype">void</span> <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#ade7505662796ff416f1d43862b0507fb">clear_all_undo</a>() {</div>
<div class="line"><a id="l00738" name="l00738"></a><span class="lineno">  738</span>      <span class="comment">// Rewind the database to the last irreversible block</span></div>
<div class="line"><a id="l00739" name="l00739"></a><span class="lineno">  739</span>      <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>.<a class="code hl_function" href="classchainbase_1_1database.html#a832c383b7d8573d399e6149d4c715bd6">undo_all</a>();</div>
<div class="line"><a id="l00740" name="l00740"></a><span class="lineno">  740</span>      <span class="comment">/*</span></div>
<div class="line"><a id="l00741" name="l00741"></a><span class="lineno">  741</span><span class="comment">      FC_ASSERT(db.revision() == self.head_block_num(),</span></div>
<div class="line"><a id="l00742" name="l00742"></a><span class="lineno">  742</span><span class="comment">                  &quot;Chainbase revision does not match head block num&quot;,</span></div>
<div class="line"><a id="l00743" name="l00743"></a><span class="lineno">  743</span><span class="comment">                  (&quot;rev&quot;, db.revision())(&quot;head_block&quot;, self.head_block_num()));</span></div>
<div class="line"><a id="l00744" name="l00744"></a><span class="lineno">  744</span><span class="comment">                  */</span></div>
<div class="line"><a id="l00745" name="l00745"></a><span class="lineno">  745</span>   }</div>
</div>
<div class="line"><a id="l00746" name="l00746"></a><span class="lineno">  746</span> </div>
<div class="foldopen" id="foldopen00747" data-start="{" data-end="}">
<div class="line"><a id="l00747" name="l00747"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#afb7b8a4e7c718c1262fe755aa1c2f148">  747</a></span>   <span class="keywordtype">void</span> <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#afb7b8a4e7c718c1262fe755aa1c2f148">add_contract_tables_to_snapshot</a>( <span class="keyword">const</span> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#a80afaa06d96e661a0f93e0ba4b09c8dc">snapshot_writer_ptr</a>&amp; snapshot )<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00748" name="l00748"></a><span class="lineno">  748</span>      snapshot-&gt;write_section(<span class="stringliteral">&quot;contract_tables&quot;</span>, [<span class="keyword">this</span>]( <span class="keyword">auto</span>&amp; section ) {</div>
<div class="line"><a id="l00749" name="l00749"></a><span class="lineno">  749</span>         <a class="code hl_function" href="classsysio_1_1chain_1_1index__utils.html#a20f6cbb7f55f78ff4d35a4bf7e928a86">index_utils&lt;table_id_multi_index&gt;::walk</a>(<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>, [<span class="keyword">this</span>, &amp;section]( <span class="keyword">const</span> <a class="code hl_class" href="classsysio_1_1chain_1_1table__id__object.html">table_id_object</a>&amp; table_row ){</div>
<div class="line"><a id="l00750" name="l00750"></a><span class="lineno">  750</span>            <span class="comment">// add a row for the table</span></div>
<div class="line"><a id="l00751" name="l00751"></a><span class="lineno">  751</span>            section.add_row(table_row, <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>);</div>
<div class="line"><a id="l00752" name="l00752"></a><span class="lineno">  752</span> </div>
<div class="line"><a id="l00753" name="l00753"></a><span class="lineno">  753</span>            <span class="comment">// followed by a size row and then N data rows for each type of table</span></div>
<div class="line"><a id="l00754" name="l00754"></a><span class="lineno">  754</span>            contract_database_index_set::walk_indices([<span class="keyword">this</span>, &amp;section, &amp;table_row]( <span class="keyword">auto</span> utils ) {</div>
<div class="line"><a id="l00755" name="l00755"></a><span class="lineno">  755</span>               <span class="keyword">using </span>utils_t = <span class="keyword">decltype</span>(utils);</div>
<div class="line"><a id="l00756" name="l00756"></a><span class="lineno">  756</span>               <span class="keyword">using </span>value_t = <span class="keyword">typename</span> <span class="keyword">decltype</span>(utils)::index_t::value_type;</div>
<div class="line"><a id="l00757" name="l00757"></a><span class="lineno">  757</span>               <span class="keyword">using </span>by_table_id = <a class="code hl_typedef" href="namespacesysio_1_1chain.html#a551a62ef64d082b2bbc5a50e2b6ccaa9">object_to_table_id_tag_t&lt;value_t&gt;</a>;</div>
<div class="line"><a id="l00758" name="l00758"></a><span class="lineno">  758</span> </div>
<div class="line"><a id="l00759" name="l00759"></a><span class="lineno">  759</span>               <span class="keyword">auto</span> tid_key = boost::make_tuple(table_row.id);</div>
<div class="line"><a id="l00760" name="l00760"></a><span class="lineno">  760</span>               <span class="keyword">auto</span> next_tid_key = boost::make_tuple(<a class="code hl_class" href="classchainbase_1_1oid.html">table_id_object::id_type</a>(table_row.id.<a class="code hl_variable" href="classchainbase_1_1oid.html#a572c4ef080a7db37d93631ab0fbb123a">_id</a> + 1));</div>
<div class="line"><a id="l00761" name="l00761"></a><span class="lineno">  761</span> </div>
<div class="line"><a id="l00762" name="l00762"></a><span class="lineno">  762</span>               <a class="code hl_struct" href="structfc_1_1unsigned__int.html">unsigned_int</a> size = utils_t::template size_range&lt;by_table_id&gt;(<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>, tid_key, next_tid_key);</div>
<div class="line"><a id="l00763" name="l00763"></a><span class="lineno">  763</span>               section.add_row(size, <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>);</div>
<div class="line"><a id="l00764" name="l00764"></a><span class="lineno">  764</span> </div>
<div class="line"><a id="l00765" name="l00765"></a><span class="lineno">  765</span>               utils_t::template walk_range&lt;by_table_id&gt;(<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>, tid_key, next_tid_key, [<span class="keyword">this</span>, &amp;section]( <span class="keyword">const</span> <span class="keyword">auto</span> &amp;row ) {</div>
<div class="line"><a id="l00766" name="l00766"></a><span class="lineno">  766</span>                  section.add_row(row, <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>);</div>
<div class="line"><a id="l00767" name="l00767"></a><span class="lineno">  767</span>               });</div>
<div class="line"><a id="l00768" name="l00768"></a><span class="lineno">  768</span>            });</div>
<div class="line"><a id="l00769" name="l00769"></a><span class="lineno">  769</span>         });</div>
<div class="line"><a id="l00770" name="l00770"></a><span class="lineno">  770</span>      });</div>
<div class="line"><a id="l00771" name="l00771"></a><span class="lineno">  771</span>   }</div>
</div>
<div class="line"><a id="l00772" name="l00772"></a><span class="lineno">  772</span> </div>
<div class="foldopen" id="foldopen00773" data-start="{" data-end="}">
<div class="line"><a id="l00773" name="l00773"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#ab2a0087a0d30ff324e2b0bff4a3c4e22">  773</a></span>   <span class="keywordtype">void</span> <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#ab2a0087a0d30ff324e2b0bff4a3c4e22">read_contract_tables_from_snapshot</a>( <span class="keyword">const</span> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#aaa27dacddc54cea475602788c8e7a02c">snapshot_reader_ptr</a>&amp; snapshot ) {</div>
<div class="line"><a id="l00774" name="l00774"></a><span class="lineno">  774</span>      snapshot-&gt;read_section(<span class="stringliteral">&quot;contract_tables&quot;</span>, [<span class="keyword">this</span>]( <span class="keyword">auto</span>&amp; section ) {</div>
<div class="line"><a id="l00775" name="l00775"></a><span class="lineno">  775</span>         <span class="keywordtype">bool</span> more = !section.empty();</div>
<div class="line"><a id="l00776" name="l00776"></a><span class="lineno">  776</span>         <span class="keywordflow">while</span> (more) {</div>
<div class="line"><a id="l00777" name="l00777"></a><span class="lineno">  777</span>            <span class="comment">// read the row for the table</span></div>
<div class="line"><a id="l00778" name="l00778"></a><span class="lineno">  778</span>            <a class="code hl_class" href="classchainbase_1_1oid.html">table_id_object::id_type</a> t_id;</div>
<div class="line"><a id="l00779" name="l00779"></a><span class="lineno">  779</span>            <a class="code hl_function" href="classsysio_1_1chain_1_1index__utils.html#a4ba170946682ddcea81d558b0ee8899a">index_utils&lt;table_id_multi_index&gt;::create</a>(<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>, [<span class="keyword">this</span>, &amp;section, &amp;t_id](<span class="keyword">auto</span>&amp; row) {</div>
<div class="line"><a id="l00780" name="l00780"></a><span class="lineno">  780</span>               section.read_row(row, <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>);</div>
<div class="line"><a id="l00781" name="l00781"></a><span class="lineno">  781</span>               t_id = row.id;</div>
<div class="line"><a id="l00782" name="l00782"></a><span class="lineno">  782</span>            });</div>
<div class="line"><a id="l00783" name="l00783"></a><span class="lineno">  783</span> </div>
<div class="line"><a id="l00784" name="l00784"></a><span class="lineno">  784</span>            <span class="comment">// read the size and data rows for each type of table</span></div>
<div class="line"><a id="l00785" name="l00785"></a><span class="lineno">  785</span>            contract_database_index_set::walk_indices([<span class="keyword">this</span>, &amp;section, &amp;t_id, &amp;more](<span class="keyword">auto</span> utils) {</div>
<div class="line"><a id="l00786" name="l00786"></a><span class="lineno">  786</span>               <span class="keyword">using </span>utils_t = <span class="keyword">decltype</span>(utils);</div>
<div class="line"><a id="l00787" name="l00787"></a><span class="lineno">  787</span> </div>
<div class="line"><a id="l00788" name="l00788"></a><span class="lineno">  788</span>               <a class="code hl_struct" href="structfc_1_1unsigned__int.html">unsigned_int</a> size;</div>
<div class="line"><a id="l00789" name="l00789"></a><span class="lineno">  789</span>               more = section.read_row(size, <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>);</div>
<div class="line"><a id="l00790" name="l00790"></a><span class="lineno">  790</span> </div>
<div class="line"><a id="l00791" name="l00791"></a><span class="lineno">  791</span>               <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> idx = 0; idx &lt; size.<a class="code hl_variable" href="structfc_1_1unsigned__int.html#ac54ac972d3e38a5852616aaee955ff3f">value</a>; idx++) {</div>
<div class="line"><a id="l00792" name="l00792"></a><span class="lineno">  792</span>                  utils_t::create(<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>, [<span class="keyword">this</span>, &amp;section, &amp;more, &amp;t_id](<span class="keyword">auto</span>&amp; row) {</div>
<div class="line"><a id="l00793" name="l00793"></a><span class="lineno">  793</span>                     row.t_id = t_id;</div>
<div class="line"><a id="l00794" name="l00794"></a><span class="lineno">  794</span>                     more = section.read_row(row, <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>);</div>
<div class="line"><a id="l00795" name="l00795"></a><span class="lineno">  795</span>                  });</div>
<div class="line"><a id="l00796" name="l00796"></a><span class="lineno">  796</span>               }</div>
<div class="line"><a id="l00797" name="l00797"></a><span class="lineno">  797</span>            });</div>
<div class="line"><a id="l00798" name="l00798"></a><span class="lineno">  798</span>         }</div>
<div class="line"><a id="l00799" name="l00799"></a><span class="lineno">  799</span>      });</div>
<div class="line"><a id="l00800" name="l00800"></a><span class="lineno">  800</span>   }</div>
</div>
<div class="line"><a id="l00801" name="l00801"></a><span class="lineno">  801</span> </div>
<div class="foldopen" id="foldopen00802" data-start="{" data-end="}">
<div class="line"><a id="l00802" name="l00802"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#a8477bef06de9c6d5f1c8a0a8cf1c8795">  802</a></span>   <span class="keywordtype">void</span> <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a8477bef06de9c6d5f1c8a0a8cf1c8795">add_to_snapshot</a>( <span class="keyword">const</span> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#a80afaa06d96e661a0f93e0ba4b09c8dc">snapshot_writer_ptr</a>&amp; snapshot ) {</div>
<div class="line"><a id="l00803" name="l00803"></a><span class="lineno">  803</span>      <span class="comment">// clear in case the previous call to clear did not finish in time of deadline</span></div>
<div class="line"><a id="l00804" name="l00804"></a><span class="lineno">  804</span>      <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a338cb13e3b27ade2ee719b5421edcf7e">clear_expired_input_transactions</a>( <a class="code hl_function" href="classfc_1_1time__point.html#aeccf1b70aa34b132c5269313b8a50573">fc::time_point::maximum</a>() );</div>
<div class="line"><a id="l00805" name="l00805"></a><span class="lineno">  805</span> </div>
<div class="line"><a id="l00806" name="l00806"></a><span class="lineno">  806</span>      snapshot-&gt;write_section&lt;<a class="code hl_struct" href="structsysio_1_1chain_1_1chain__snapshot__header.html">chain_snapshot_header</a>&gt;([<span class="keyword">this</span>]( <span class="keyword">auto</span> &amp;section ){</div>
<div class="line"><a id="l00807" name="l00807"></a><span class="lineno">  807</span>         section.add_row(<a class="code hl_struct" href="structsysio_1_1chain_1_1chain__snapshot__header.html">chain_snapshot_header</a>(), <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>);</div>
<div class="line"><a id="l00808" name="l00808"></a><span class="lineno">  808</span>      });</div>
<div class="line"><a id="l00809" name="l00809"></a><span class="lineno">  809</span> </div>
<div class="line"><a id="l00810" name="l00810"></a><span class="lineno">  810</span>      snapshot-&gt;write_section&lt;<a class="code hl_struct" href="structsysio_1_1chain_1_1block__state.html">block_state</a>&gt;([<span class="keyword">this</span>]( <span class="keyword">auto</span> &amp;section ){</div>
<div class="line"><a id="l00811" name="l00811"></a><span class="lineno">  811</span>         section.template add_row&lt;block_header_state&gt;(*<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a56a0f369b58e6597b62569ff2853ee90">head</a>, <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>);</div>
<div class="line"><a id="l00812" name="l00812"></a><span class="lineno">  812</span>      });</div>
<div class="line"><a id="l00813" name="l00813"></a><span class="lineno">  813</span> </div>
<div class="line"><a id="l00814" name="l00814"></a><span class="lineno">  814</span>      controller_index_set::walk_indices([<span class="keyword">this</span>, &amp;snapshot]( <span class="keyword">auto</span> utils ){</div>
<div class="line"><a id="l00815" name="l00815"></a><span class="lineno">  815</span>         <span class="keyword">using </span>value_t = <span class="keyword">typename</span> <span class="keyword">decltype</span>(utils)::index_t::value_type;</div>
<div class="line"><a id="l00816" name="l00816"></a><span class="lineno">  816</span> </div>
<div class="line"><a id="l00817" name="l00817"></a><span class="lineno">  817</span>         <span class="comment">// skip the table_id_object as its inlined with contract tables section</span></div>
<div class="line"><a id="l00818" name="l00818"></a><span class="lineno">  818</span>         <span class="keywordflow">if</span> (std::is_same&lt;value_t, table_id_object&gt;::value) {</div>
<div class="line"><a id="l00819" name="l00819"></a><span class="lineno">  819</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00820" name="l00820"></a><span class="lineno">  820</span>         }</div>
<div class="line"><a id="l00821" name="l00821"></a><span class="lineno">  821</span> </div>
<div class="line"><a id="l00822" name="l00822"></a><span class="lineno">  822</span>         <span class="comment">// skip the database_header as it is only relevant to in-memory database</span></div>
<div class="line"><a id="l00823" name="l00823"></a><span class="lineno">  823</span>         <span class="keywordflow">if</span> (std::is_same&lt;value_t, database_header_object&gt;::value) {</div>
<div class="line"><a id="l00824" name="l00824"></a><span class="lineno">  824</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00825" name="l00825"></a><span class="lineno">  825</span>         }</div>
<div class="line"><a id="l00826" name="l00826"></a><span class="lineno">  826</span> </div>
<div class="line"><a id="l00827" name="l00827"></a><span class="lineno">  827</span>         snapshot-&gt;write_section&lt;value_t&gt;([<span class="keyword">this</span>]( <span class="keyword">auto</span>&amp; section ){</div>
<div class="line"><a id="l00828" name="l00828"></a><span class="lineno">  828</span>            <span class="keyword">decltype</span>(utils)::walk(<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>, [<span class="keyword">this</span>, &amp;section]( <span class="keyword">const</span> <span class="keyword">auto</span> &amp;row ) {</div>
<div class="line"><a id="l00829" name="l00829"></a><span class="lineno">  829</span>               section.add_row(row, <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>);</div>
<div class="line"><a id="l00830" name="l00830"></a><span class="lineno">  830</span>            });</div>
<div class="line"><a id="l00831" name="l00831"></a><span class="lineno">  831</span>         });</div>
<div class="line"><a id="l00832" name="l00832"></a><span class="lineno">  832</span>      });</div>
<div class="line"><a id="l00833" name="l00833"></a><span class="lineno">  833</span> </div>
<div class="line"><a id="l00834" name="l00834"></a><span class="lineno">  834</span>      <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#afb7b8a4e7c718c1262fe755aa1c2f148">add_contract_tables_to_snapshot</a>(snapshot);</div>
<div class="line"><a id="l00835" name="l00835"></a><span class="lineno">  835</span> </div>
<div class="line"><a id="l00836" name="l00836"></a><span class="lineno">  836</span>      <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#ab90d295ac18fa98f2520e4eade5b3773">authorization</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1authorization__manager.html#a24e23281d4ccfdddcc761c83e14a4080">add_to_snapshot</a>(snapshot);</div>
<div class="line"><a id="l00837" name="l00837"></a><span class="lineno">  837</span>      <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a83a037a61ce8e07b39d2d38b0f54f8f7">resource_limits</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1resource__limits_1_1resource__limits__manager.html#a7160417d30f5ef3a91467fefebf65dc6">add_to_snapshot</a>(snapshot);</div>
<div class="line"><a id="l00838" name="l00838"></a><span class="lineno">  838</span>   }</div>
</div>
<div class="line"><a id="l00839" name="l00839"></a><span class="lineno">  839</span> </div>
<div class="foldopen" id="foldopen00840" data-start="{" data-end="}">
<div class="line"><a id="l00840" name="l00840"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#a6353a2e6b51e1b83231f41a8bcc66c47">  840</a></span>   <span class="keyword">static</span> std::optional&lt;genesis_state&gt; <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a6353a2e6b51e1b83231f41a8bcc66c47">extract_legacy_genesis_state</a>( <a class="code hl_class" href="classsysio_1_1chain_1_1snapshot__reader.html">snapshot_reader</a>&amp; snapshot, <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> version ) {</div>
<div class="line"><a id="l00841" name="l00841"></a><span class="lineno">  841</span>      std::optional&lt;genesis_state&gt; genesis;</div>
<div class="line"><a id="l00842" name="l00842"></a><span class="lineno">  842</span>      <span class="keyword">using </span>v2 = <a class="code hl_struct" href="structsysio_1_1chain_1_1legacy_1_1snapshot__global__property__object__v2.html">legacy::snapshot_global_property_object_v2</a>;</div>
<div class="line"><a id="l00843" name="l00843"></a><span class="lineno">  843</span> </div>
<div class="line"><a id="l00844" name="l00844"></a><span class="lineno">  844</span>      <span class="keywordflow">if</span> (std::clamp(version, v2::minimum_version, v2::maximum_version) == version ) {</div>
<div class="line"><a id="l00845" name="l00845"></a><span class="lineno">  845</span>         genesis.emplace();</div>
<div class="line"><a id="l00846" name="l00846"></a><span class="lineno">  846</span>         snapshot.read_section&lt;<a class="code hl_struct" href="structsysio_1_1chain_1_1genesis__state.html">genesis_state</a>&gt;([&amp;genesis=*genesis]( <span class="keyword">auto</span> &amp;section ){</div>
<div class="line"><a id="l00847" name="l00847"></a><span class="lineno">  847</span>            section.read_row(genesis);</div>
<div class="line"><a id="l00848" name="l00848"></a><span class="lineno">  848</span>         });</div>
<div class="line"><a id="l00849" name="l00849"></a><span class="lineno">  849</span>      }</div>
<div class="line"><a id="l00850" name="l00850"></a><span class="lineno">  850</span>      <span class="keywordflow">return</span> genesis;</div>
<div class="line"><a id="l00851" name="l00851"></a><span class="lineno">  851</span>   }</div>
</div>
<div class="line"><a id="l00852" name="l00852"></a><span class="lineno">  852</span> </div>
<div class="foldopen" id="foldopen00853" data-start="{" data-end="}">
<div class="line"><a id="l00853" name="l00853"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#a247c87d241e707c5e482c3d6d8872a7f">  853</a></span>   <span class="keywordtype">void</span> <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a247c87d241e707c5e482c3d6d8872a7f">read_from_snapshot</a>( <span class="keyword">const</span> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#aaa27dacddc54cea475602788c8e7a02c">snapshot_reader_ptr</a>&amp; snapshot, <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> blog_start, <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> blog_end ) {</div>
<div class="line"><a id="l00854" name="l00854"></a><span class="lineno">  854</span>      <a class="code hl_struct" href="structsysio_1_1chain_1_1chain__snapshot__header.html">chain_snapshot_header</a> header;</div>
<div class="line"><a id="l00855" name="l00855"></a><span class="lineno">  855</span>      snapshot-&gt;read_section&lt;<a class="code hl_struct" href="structsysio_1_1chain_1_1chain__snapshot__header.html">chain_snapshot_header</a>&gt;([<span class="keyword">this</span>, &amp;header]( <span class="keyword">auto</span> &amp;section ){</div>
<div class="line"><a id="l00856" name="l00856"></a><span class="lineno">  856</span>         section.read_row(header, <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>);</div>
<div class="line"><a id="l00857" name="l00857"></a><span class="lineno">  857</span>         header.<a class="code hl_function" href="structsysio_1_1chain_1_1chain__snapshot__header.html#a6f183a866ea3a474243c55484f0c700e">validate</a>();</div>
<div class="line"><a id="l00858" name="l00858"></a><span class="lineno">  858</span>      });</div>
<div class="line"><a id="l00859" name="l00859"></a><span class="lineno">  859</span> </div>
<div class="line"><a id="l00860" name="l00860"></a><span class="lineno">  860</span>      { </div>
<div class="line"><a id="l00861" name="l00861"></a><span class="lineno">  861</span>         <a class="code hl_struct" href="structsysio_1_1chain_1_1block__header__state.html">block_header_state</a> head_header_state;</div>
<div class="line"><a id="l00862" name="l00862"></a><span class="lineno">  862</span>         <span class="keyword">using </span>v2 = <a class="code hl_struct" href="structsysio_1_1chain_1_1legacy_1_1snapshot__block__header__state__v2.html">legacy::snapshot_block_header_state_v2</a>;</div>
<div class="line"><a id="l00863" name="l00863"></a><span class="lineno">  863</span> </div>
<div class="line"><a id="l00864" name="l00864"></a><span class="lineno">  864</span>         <span class="keywordflow">if</span> (std::clamp(header.<a class="code hl_variable" href="structsysio_1_1chain_1_1chain__snapshot__header.html#a57ba8d21e5d5c9e1325e9ef03f96d54e">version</a>, v2::minimum_version, v2::maximum_version) == header.<a class="code hl_variable" href="structsysio_1_1chain_1_1chain__snapshot__header.html#a57ba8d21e5d5c9e1325e9ef03f96d54e">version</a> ) {</div>
<div class="line"><a id="l00865" name="l00865"></a><span class="lineno">  865</span>            snapshot-&gt;read_section&lt;<a class="code hl_struct" href="structsysio_1_1chain_1_1block__state.html">block_state</a>&gt;([<span class="keyword">this</span>, &amp;head_header_state]( <span class="keyword">auto</span> &amp;section ) {</div>
<div class="line"><a id="l00866" name="l00866"></a><span class="lineno">  866</span>               <a class="code hl_struct" href="structsysio_1_1chain_1_1legacy_1_1snapshot__block__header__state__v2.html">legacy::snapshot_block_header_state_v2</a> legacy_header_state;</div>
<div class="line"><a id="l00867" name="l00867"></a><span class="lineno">  867</span>               section.read_row(legacy_header_state, <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>);</div>
<div class="line"><a id="l00868" name="l00868"></a><span class="lineno">  868</span>               head_header_state = <a class="code hl_struct" href="structsysio_1_1chain_1_1block__header__state.html">block_header_state</a>(std::move(legacy_header_state));</div>
<div class="line"><a id="l00869" name="l00869"></a><span class="lineno">  869</span>            });</div>
<div class="line"><a id="l00870" name="l00870"></a><span class="lineno">  870</span>         } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00871" name="l00871"></a><span class="lineno">  871</span>            snapshot-&gt;read_section&lt;<a class="code hl_struct" href="structsysio_1_1chain_1_1block__state.html">block_state</a>&gt;([<span class="keyword">this</span>,&amp;head_header_state]( <span class="keyword">auto</span> &amp;section ){</div>
<div class="line"><a id="l00872" name="l00872"></a><span class="lineno">  872</span>               section.read_row(head_header_state, <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>);</div>
<div class="line"><a id="l00873" name="l00873"></a><span class="lineno">  873</span>            });</div>
<div class="line"><a id="l00874" name="l00874"></a><span class="lineno">  874</span>         }</div>
<div class="line"><a id="l00875" name="l00875"></a><span class="lineno">  875</span> </div>
<div class="line"><a id="l00876" name="l00876"></a><span class="lineno">  876</span>         <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#afe8c6fe322a239e2f910f26a385786f0">snapshot_head_block</a> = head_header_state.<a class="code hl_variable" href="structsysio_1_1chain_1_1detail_1_1block__header__state__common.html#ae85e3375836639cb1e7543aea7cf0552">block_num</a>;</div>
<div class="line"><a id="l00877" name="l00877"></a><span class="lineno">  877</span>         <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( blog_start &lt;= (<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#afe8c6fe322a239e2f910f26a385786f0">snapshot_head_block</a> + 1) &amp;&amp; <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#afe8c6fe322a239e2f910f26a385786f0">snapshot_head_block</a> &lt;= blog_end,</div>
<div class="line"><a id="l00878" name="l00878"></a><span class="lineno">  878</span>                     block_log_exception,</div>
<div class="line"><a id="l00879" name="l00879"></a><span class="lineno">  879</span>                     <span class="stringliteral">&quot;Block log is provided with snapshot but does not contain the head block from the snapshot nor a block right after it&quot;</span>,</div>
<div class="line"><a id="l00880" name="l00880"></a><span class="lineno">  880</span>                     (<span class="stringliteral">&quot;snapshot_head_block&quot;</span>, <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#afe8c6fe322a239e2f910f26a385786f0">snapshot_head_block</a>)</div>
<div class="line"><a id="l00881" name="l00881"></a><span class="lineno">  881</span>                     (<span class="stringliteral">&quot;block_log_first_num&quot;</span>, blog_start)</div>
<div class="line"><a id="l00882" name="l00882"></a><span class="lineno">  882</span>                     (<span class="stringliteral">&quot;block_log_last_num&quot;</span>, blog_end)</div>
<div class="line"><a id="l00883" name="l00883"></a><span class="lineno">  883</span>         );</div>
<div class="line"><a id="l00884" name="l00884"></a><span class="lineno">  884</span> </div>
<div class="line"><a id="l00885" name="l00885"></a><span class="lineno">  885</span>         <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a56a0f369b58e6597b62569ff2853ee90">head</a> = std::make_shared&lt;block_state&gt;();</div>
<div class="line"><a id="l00886" name="l00886"></a><span class="lineno">  886</span>         <span class="keyword">static_cast&lt;</span><a class="code hl_struct" href="structsysio_1_1chain_1_1block__header__state.html">block_header_state</a>&amp;<span class="keyword">&gt;</span>(*head) = head_header_state;</div>
<div class="line"><a id="l00887" name="l00887"></a><span class="lineno">  887</span>      }</div>
<div class="line"><a id="l00888" name="l00888"></a><span class="lineno">  888</span> </div>
<div class="line"><a id="l00889" name="l00889"></a><span class="lineno">  889</span>      controller_index_set::walk_indices([<span class="keyword">this</span>, &amp;snapshot, &amp;header]( <span class="keyword">auto</span> utils ){</div>
<div class="line"><a id="l00890" name="l00890"></a><span class="lineno">  890</span>         <span class="keyword">using </span>value_t = <span class="keyword">typename</span> <span class="keyword">decltype</span>(utils)::index_t::value_type;</div>
<div class="line"><a id="l00891" name="l00891"></a><span class="lineno">  891</span> </div>
<div class="line"><a id="l00892" name="l00892"></a><span class="lineno">  892</span>         <span class="comment">// skip the table_id_object as its inlined with contract tables section</span></div>
<div class="line"><a id="l00893" name="l00893"></a><span class="lineno">  893</span>         <span class="keywordflow">if</span> (std::is_same&lt;value_t, table_id_object&gt;::value) {</div>
<div class="line"><a id="l00894" name="l00894"></a><span class="lineno">  894</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00895" name="l00895"></a><span class="lineno">  895</span>         }</div>
<div class="line"><a id="l00896" name="l00896"></a><span class="lineno">  896</span> </div>
<div class="line"><a id="l00897" name="l00897"></a><span class="lineno">  897</span>         <span class="comment">// skip the database_header as it is only relevant to in-memory database</span></div>
<div class="line"><a id="l00898" name="l00898"></a><span class="lineno">  898</span>         <span class="keywordflow">if</span> (std::is_same&lt;value_t, database_header_object&gt;::value) {</div>
<div class="line"><a id="l00899" name="l00899"></a><span class="lineno">  899</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00900" name="l00900"></a><span class="lineno">  900</span>         }</div>
<div class="line"><a id="l00901" name="l00901"></a><span class="lineno">  901</span> </div>
<div class="line"><a id="l00902" name="l00902"></a><span class="lineno">  902</span>         <span class="comment">// special case for in-place upgrade of global_property_object</span></div>
<div class="line"><a id="l00903" name="l00903"></a><span class="lineno">  903</span>         <span class="keywordflow">if</span> (std::is_same&lt;value_t, global_property_object&gt;::value) {</div>
<div class="line"><a id="l00904" name="l00904"></a><span class="lineno">  904</span>            <span class="keyword">using </span>v2 = <a class="code hl_struct" href="structsysio_1_1chain_1_1legacy_1_1snapshot__global__property__object__v2.html">legacy::snapshot_global_property_object_v2</a>;</div>
<div class="line"><a id="l00905" name="l00905"></a><span class="lineno">  905</span>            <span class="keyword">using </span>v3 = <a class="code hl_struct" href="structsysio_1_1chain_1_1legacy_1_1snapshot__global__property__object__v3.html">legacy::snapshot_global_property_object_v3</a>;</div>
<div class="line"><a id="l00906" name="l00906"></a><span class="lineno">  906</span>            <span class="keyword">using </span>v4 = <a class="code hl_struct" href="structsysio_1_1chain_1_1legacy_1_1snapshot__global__property__object__v4.html">legacy::snapshot_global_property_object_v4</a>;</div>
<div class="line"><a id="l00907" name="l00907"></a><span class="lineno">  907</span> </div>
<div class="line"><a id="l00908" name="l00908"></a><span class="lineno">  908</span>            <span class="keywordflow">if</span> (std::clamp(header.<a class="code hl_variable" href="structsysio_1_1chain_1_1chain__snapshot__header.html#a57ba8d21e5d5c9e1325e9ef03f96d54e">version</a>, v2::minimum_version, v2::maximum_version) == header.<a class="code hl_variable" href="structsysio_1_1chain_1_1chain__snapshot__header.html#a57ba8d21e5d5c9e1325e9ef03f96d54e">version</a> ) {</div>
<div class="line"><a id="l00909" name="l00909"></a><span class="lineno">  909</span>               std::optional&lt;genesis_state&gt; genesis = <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a6353a2e6b51e1b83231f41a8bcc66c47">extract_legacy_genesis_state</a>(*snapshot, header.<a class="code hl_variable" href="structsysio_1_1chain_1_1chain__snapshot__header.html#a57ba8d21e5d5c9e1325e9ef03f96d54e">version</a>);</div>
<div class="line"><a id="l00910" name="l00910"></a><span class="lineno">  910</span>               <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( genesis, snapshot_exception,</div>
<div class="line"><a id="l00911" name="l00911"></a><span class="lineno">  911</span>                           <span class="stringliteral">&quot;Snapshot indicates chain_snapshot_header version 2, but does not contain a genesis_state. &quot;</span></div>
<div class="line"><a id="l00912" name="l00912"></a><span class="lineno">  912</span>                           <span class="stringliteral">&quot;It must be corrupted.&quot;</span>);</div>
<div class="line"><a id="l00913" name="l00913"></a><span class="lineno">  913</span>               snapshot-&gt;read_section&lt;<a class="code hl_class" href="classsysio_1_1chain_1_1global__property__object.html">global_property_object</a>&gt;([&amp;<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>=this-&gt;<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>,gs_chain_id=genesis-&gt;compute_chain_id()]( <span class="keyword">auto</span> &amp;section ) {</div>
<div class="line"><a id="l00914" name="l00914"></a><span class="lineno">  914</span>                  v2 legacy_global_properties;</div>
<div class="line"><a id="l00915" name="l00915"></a><span class="lineno">  915</span>                  section.read_row(legacy_global_properties, <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>);</div>
<div class="line"><a id="l00916" name="l00916"></a><span class="lineno">  916</span> </div>
<div class="line"><a id="l00917" name="l00917"></a><span class="lineno">  917</span>                  <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>.<a class="code hl_function" href="classchainbase_1_1database.html#adc8f336b33d7013d1b0400399b16c5a7">create</a>&lt;<a class="code hl_class" href="classsysio_1_1chain_1_1global__property__object.html">global_property_object</a>&gt;([&amp;legacy_global_properties,&amp;gs_chain_id](<span class="keyword">auto</span>&amp; gpo ){</div>
<div class="line"><a id="l00918" name="l00918"></a><span class="lineno">  918</span>                     gpo.initalize_from(legacy_global_properties, gs_chain_id, <a class="code hl_struct" href="structsysio_1_1chain_1_1kv__database__config.html">kv_database_config</a>{},</div>
<div class="line"><a id="l00919" name="l00919"></a><span class="lineno">  919</span>                                       <a class="code hl_variable" href="structsysio_1_1chain_1_1genesis__state.html#a3e6e5eb6e7b0107b1f105eb8a4dcca41">genesis_state::default_initial_wasm_configuration</a>);</div>
<div class="line"><a id="l00920" name="l00920"></a><span class="lineno">  920</span>                  });</div>
<div class="line"><a id="l00921" name="l00921"></a><span class="lineno">  921</span>               });</div>
<div class="line"><a id="l00922" name="l00922"></a><span class="lineno">  922</span>               <span class="keywordflow">return</span>; <span class="comment">// early out to avoid default processing</span></div>
<div class="line"><a id="l00923" name="l00923"></a><span class="lineno">  923</span>            }</div>
<div class="line"><a id="l00924" name="l00924"></a><span class="lineno">  924</span> </div>
<div class="line"><a id="l00925" name="l00925"></a><span class="lineno">  925</span>            <span class="keywordflow">if</span> (std::clamp(header.<a class="code hl_variable" href="structsysio_1_1chain_1_1chain__snapshot__header.html#a57ba8d21e5d5c9e1325e9ef03f96d54e">version</a>, v3::minimum_version, v3::maximum_version) == header.<a class="code hl_variable" href="structsysio_1_1chain_1_1chain__snapshot__header.html#a57ba8d21e5d5c9e1325e9ef03f96d54e">version</a> ) {</div>
<div class="line"><a id="l00926" name="l00926"></a><span class="lineno">  926</span>               snapshot-&gt;read_section&lt;<a class="code hl_class" href="classsysio_1_1chain_1_1global__property__object.html">global_property_object</a>&gt;([&amp;<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>=this-&gt;<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>]( <span class="keyword">auto</span> &amp;section ) {</div>
<div class="line"><a id="l00927" name="l00927"></a><span class="lineno">  927</span>                  v3 legacy_global_properties;</div>
<div class="line"><a id="l00928" name="l00928"></a><span class="lineno">  928</span>                  section.read_row(legacy_global_properties, <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>);</div>
<div class="line"><a id="l00929" name="l00929"></a><span class="lineno">  929</span> </div>
<div class="line"><a id="l00930" name="l00930"></a><span class="lineno">  930</span>                  <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>.<a class="code hl_function" href="classchainbase_1_1database.html#adc8f336b33d7013d1b0400399b16c5a7">create</a>&lt;<a class="code hl_class" href="classsysio_1_1chain_1_1global__property__object.html">global_property_object</a>&gt;([&amp;legacy_global_properties](<span class="keyword">auto</span>&amp; gpo ){</div>
<div class="line"><a id="l00931" name="l00931"></a><span class="lineno">  931</span>                     gpo.initalize_from(legacy_global_properties, <a class="code hl_struct" href="structsysio_1_1chain_1_1kv__database__config.html">kv_database_config</a>{},</div>
<div class="line"><a id="l00932" name="l00932"></a><span class="lineno">  932</span>                                        <a class="code hl_variable" href="structsysio_1_1chain_1_1genesis__state.html#a3e6e5eb6e7b0107b1f105eb8a4dcca41">genesis_state::default_initial_wasm_configuration</a>);</div>
<div class="line"><a id="l00933" name="l00933"></a><span class="lineno">  933</span>                  });</div>
<div class="line"><a id="l00934" name="l00934"></a><span class="lineno">  934</span>               });</div>
<div class="line"><a id="l00935" name="l00935"></a><span class="lineno">  935</span>               <span class="keywordflow">return</span>; <span class="comment">// early out to avoid default processing</span></div>
<div class="line"><a id="l00936" name="l00936"></a><span class="lineno">  936</span>            }</div>
<div class="line"><a id="l00937" name="l00937"></a><span class="lineno">  937</span> </div>
<div class="line"><a id="l00938" name="l00938"></a><span class="lineno">  938</span>            <span class="keywordflow">if</span> (std::clamp(header.<a class="code hl_variable" href="structsysio_1_1chain_1_1chain__snapshot__header.html#a57ba8d21e5d5c9e1325e9ef03f96d54e">version</a>, v4::minimum_version, v4::maximum_version) == header.<a class="code hl_variable" href="structsysio_1_1chain_1_1chain__snapshot__header.html#a57ba8d21e5d5c9e1325e9ef03f96d54e">version</a>) {</div>
<div class="line"><a id="l00939" name="l00939"></a><span class="lineno">  939</span>               snapshot-&gt;read_section&lt;<a class="code hl_class" href="classsysio_1_1chain_1_1global__property__object.html">global_property_object</a>&gt;([&amp;<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a> = this-&gt;<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>](<span class="keyword">auto</span>&amp; section) {</div>
<div class="line"><a id="l00940" name="l00940"></a><span class="lineno">  940</span>                  v4 legacy_global_properties;</div>
<div class="line"><a id="l00941" name="l00941"></a><span class="lineno">  941</span>                  section.read_row(legacy_global_properties, <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>);</div>
<div class="line"><a id="l00942" name="l00942"></a><span class="lineno">  942</span> </div>
<div class="line"><a id="l00943" name="l00943"></a><span class="lineno">  943</span>                  <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>.<a class="code hl_function" href="classchainbase_1_1database.html#adc8f336b33d7013d1b0400399b16c5a7">create</a>&lt;<a class="code hl_class" href="classsysio_1_1chain_1_1global__property__object.html">global_property_object</a>&gt;([&amp;legacy_global_properties](<span class="keyword">auto</span>&amp; gpo) {</div>
<div class="line"><a id="l00944" name="l00944"></a><span class="lineno">  944</span>                     gpo.initalize_from(legacy_global_properties);</div>
<div class="line"><a id="l00945" name="l00945"></a><span class="lineno">  945</span>                  });</div>
<div class="line"><a id="l00946" name="l00946"></a><span class="lineno">  946</span>               });</div>
<div class="line"><a id="l00947" name="l00947"></a><span class="lineno">  947</span>               <span class="keywordflow">return</span>; <span class="comment">// early out to avoid default processing</span></div>
<div class="line"><a id="l00948" name="l00948"></a><span class="lineno">  948</span>            }</div>
<div class="line"><a id="l00949" name="l00949"></a><span class="lineno">  949</span>         }</div>
<div class="line"><a id="l00950" name="l00950"></a><span class="lineno">  950</span> </div>
<div class="line"><a id="l00951" name="l00951"></a><span class="lineno">  951</span>         snapshot-&gt;read_section&lt;value_t&gt;([<span class="keyword">this</span>]( <span class="keyword">auto</span>&amp; section ) {</div>
<div class="line"><a id="l00952" name="l00952"></a><span class="lineno">  952</span>            <span class="keywordtype">bool</span> more = !section.empty();</div>
<div class="line"><a id="l00953" name="l00953"></a><span class="lineno">  953</span>            <span class="keywordflow">while</span>(more) {</div>
<div class="line"><a id="l00954" name="l00954"></a><span class="lineno">  954</span>               <span class="keyword">decltype</span>(utils)::create(<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>, [<span class="keyword">this</span>, &amp;section, &amp;more]( <span class="keyword">auto</span> &amp;row ) {</div>
<div class="line"><a id="l00955" name="l00955"></a><span class="lineno">  955</span>                  more = section.read_row(row, <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>);</div>
<div class="line"><a id="l00956" name="l00956"></a><span class="lineno">  956</span>               });</div>
<div class="line"><a id="l00957" name="l00957"></a><span class="lineno">  957</span>            }</div>
<div class="line"><a id="l00958" name="l00958"></a><span class="lineno">  958</span>         });</div>
<div class="line"><a id="l00959" name="l00959"></a><span class="lineno">  959</span>      });</div>
<div class="line"><a id="l00960" name="l00960"></a><span class="lineno">  960</span> </div>
<div class="line"><a id="l00961" name="l00961"></a><span class="lineno">  961</span>      <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#ab2a0087a0d30ff324e2b0bff4a3c4e22">read_contract_tables_from_snapshot</a>(snapshot);</div>
<div class="line"><a id="l00962" name="l00962"></a><span class="lineno">  962</span> </div>
<div class="line"><a id="l00963" name="l00963"></a><span class="lineno">  963</span>      <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#ab90d295ac18fa98f2520e4eade5b3773">authorization</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1authorization__manager.html#a7a4d84d47bcd9069ab0c8d8f9f9ac5f3">read_from_snapshot</a>(snapshot);</div>
<div class="line"><a id="l00964" name="l00964"></a><span class="lineno">  964</span>      <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a83a037a61ce8e07b39d2d38b0f54f8f7">resource_limits</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1resource__limits_1_1resource__limits__manager.html#a32baa74135a1423302de3a849dc8b40c">read_from_snapshot</a>(snapshot);</div>
<div class="line"><a id="l00965" name="l00965"></a><span class="lineno">  965</span> </div>
<div class="line"><a id="l00966" name="l00966"></a><span class="lineno">  966</span>      <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>.<a class="code hl_function" href="classchainbase_1_1database.html#a24e7f6336cad0bd2fc280dab381665ed">set_revision</a>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a56a0f369b58e6597b62569ff2853ee90">head</a>-&gt;block_num );</div>
<div class="line"><a id="l00967" name="l00967"></a><span class="lineno">  967</span>      <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>.<a class="code hl_function" href="classchainbase_1_1database.html#adc8f336b33d7013d1b0400399b16c5a7">create</a>&lt;<a class="code hl_class" href="classsysio_1_1chain_1_1database__header__object.html">database_header_object</a>&gt;([](<span class="keyword">const</span> <span class="keyword">auto</span>&amp; header){</div>
<div class="line"><a id="l00968" name="l00968"></a><span class="lineno">  968</span>         <span class="comment">// nothing to do</span></div>
<div class="line"><a id="l00969" name="l00969"></a><span class="lineno">  969</span>      });</div>
<div class="line"><a id="l00970" name="l00970"></a><span class="lineno">  970</span> </div>
<div class="line"><a id="l00971" name="l00971"></a><span class="lineno">  971</span>      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; gpo = <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>.<a class="code hl_function" href="classchainbase_1_1database.html#afcfe00f81a526c1376d4f51197dd3a9a">get</a>&lt;<a class="code hl_class" href="classsysio_1_1chain_1_1global__property__object.html">global_property_object</a>&gt;();</div>
<div class="line"><a id="l00972" name="l00972"></a><span class="lineno">  972</span>      <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( gpo.chain_id == <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a2f7115cf9c5daa3abca8e0467dce5a5a">chain_id</a>, chain_id_type_exception,</div>
<div class="line"><a id="l00973" name="l00973"></a><span class="lineno">  973</span>                  <span class="stringliteral">&quot;chain ID in snapshot (${snapshot_chain_id}) does not match the chain ID that controller was constructed with (${controller_chain_id})&quot;</span>,</div>
<div class="line"><a id="l00974" name="l00974"></a><span class="lineno">  974</span>                  (<span class="stringliteral">&quot;snapshot_chain_id&quot;</span>, gpo.chain_id)(<span class="stringliteral">&quot;controller_chain_id&quot;</span>, <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a2f7115cf9c5daa3abca8e0467dce5a5a">chain_id</a>)</div>
<div class="line"><a id="l00975" name="l00975"></a><span class="lineno">  975</span>      );</div>
<div class="line"><a id="l00976" name="l00976"></a><span class="lineno">  976</span>   }</div>
</div>
<div class="line"><a id="l00977" name="l00977"></a><span class="lineno">  977</span> </div>
<div class="foldopen" id="foldopen00978" data-start="{" data-end="}">
<div class="line"><a id="l00978" name="l00978"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#ae80ad4ddd1eff225dc19c50439d82ef6">  978</a></span>   <a class="code hl_class" href="classfc_1_1sha256.html">sha256</a> <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#ae80ad4ddd1eff225dc19c50439d82ef6">calculate_integrity_hash</a>() {</div>
<div class="line"><a id="l00979" name="l00979"></a><span class="lineno">  979</span>      <a class="code hl_class" href="classfc_1_1sha256_1_1encoder.html">sha256::encoder</a> enc;</div>
<div class="line"><a id="l00980" name="l00980"></a><span class="lineno">  980</span>      <span class="keyword">auto</span> hash_writer = std::make_shared&lt;integrity_hash_snapshot_writer&gt;(enc);</div>
<div class="line"><a id="l00981" name="l00981"></a><span class="lineno">  981</span>      <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a8477bef06de9c6d5f1c8a0a8cf1c8795">add_to_snapshot</a>(hash_writer);</div>
<div class="line"><a id="l00982" name="l00982"></a><span class="lineno">  982</span>      hash_writer-&gt;finalize();</div>
<div class="line"><a id="l00983" name="l00983"></a><span class="lineno">  983</span> </div>
<div class="line"><a id="l00984" name="l00984"></a><span class="lineno">  984</span>      <span class="keywordflow">return</span> enc.<a class="code hl_function" href="classfc_1_1sha256_1_1encoder.html#a4d8b8181e912194cf98a56164671adf8">result</a>();</div>
<div class="line"><a id="l00985" name="l00985"></a><span class="lineno">  985</span>   }</div>
</div>
<div class="line"><a id="l00986" name="l00986"></a><span class="lineno">  986</span> </div>
<div class="foldopen" id="foldopen00987" data-start="{" data-end="}">
<div class="line"><a id="l00987" name="l00987"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#ae2c30acb1a0557f6c3967c6a154f7b23">  987</a></span>   <span class="keywordtype">void</span> <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#ae2c30acb1a0557f6c3967c6a154f7b23">create_native_account</a>( <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1time__point.html">fc::time_point</a>&amp; initial_timestamp, <a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">account_name</a> <a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">name</a>, <span class="keyword">const</span> <a class="code hl_struct" href="structsysio_1_1chain_1_1authority.html">authority</a>&amp; owner, <span class="keyword">const</span> <a class="code hl_struct" href="structsysio_1_1chain_1_1authority.html">authority</a>&amp; active, <span class="keywordtype">bool</span> is_privileged = <span class="keyword">false</span> ) {</div>
<div class="line"><a id="l00988" name="l00988"></a><span class="lineno">  988</span>      <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>.<a class="code hl_function" href="classchainbase_1_1database.html#adc8f336b33d7013d1b0400399b16c5a7">create</a>&lt;<a class="code hl_class" href="classsysio_1_1chain_1_1account__object.html">account_object</a>&gt;([&amp;](<span class="keyword">auto</span>&amp; <a class="code hl_variable" href="pointer_8h.html#aeeddce917cf130d62c370b8f216026dd">a</a>) {</div>
<div class="line"><a id="l00989" name="l00989"></a><span class="lineno">  989</span>         <a class="code hl_variable" href="pointer_8h.html#aeeddce917cf130d62c370b8f216026dd">a</a>.name = <a class="code hl_variable" href="catch__reporter__console_8cpp.html#a9b45b3e13bd9167aab02e17e08916231">name</a>;</div>
<div class="line"><a id="l00990" name="l00990"></a><span class="lineno">  990</span>         <a class="code hl_variable" href="pointer_8h.html#aeeddce917cf130d62c370b8f216026dd">a</a>.creation_date = initial_timestamp;</div>
<div class="line"><a id="l00991" name="l00991"></a><span class="lineno">  991</span> </div>
<div class="line"><a id="l00992" name="l00992"></a><span class="lineno">  992</span>         <span class="keywordflow">if</span>( <a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">name</a> == config::system_account_name ) {</div>
<div class="line"><a id="l00993" name="l00993"></a><span class="lineno">  993</span>            <span class="comment">// The initial sysio ABI value affects consensus; see  https://github.com/SYSIO/eos/issues/7794</span></div>
<div class="line"><a id="l00994" name="l00994"></a><span class="lineno">  994</span>            <span class="comment">// TODO: This doesn&#39;t charge RAM; a fix requires a consensus upgrade.</span></div>
<div class="line"><a id="l00995" name="l00995"></a><span class="lineno">  995</span>            <a class="code hl_variable" href="pointer_8h.html#aeeddce917cf130d62c370b8f216026dd">a</a>.abi.assign(<a class="code hl_variable" href="namespacesysio_1_1chain.html#aa290df66096212c62e680f2c839ec925">sysio_abi_bin</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="namespacesysio_1_1chain.html#aa290df66096212c62e680f2c839ec925">sysio_abi_bin</a>));</div>
<div class="line"><a id="l00996" name="l00996"></a><span class="lineno">  996</span>         }</div>
<div class="line"><a id="l00997" name="l00997"></a><span class="lineno">  997</span>      });</div>
<div class="line"><a id="l00998" name="l00998"></a><span class="lineno">  998</span>      <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>.<a class="code hl_function" href="classchainbase_1_1database.html#adc8f336b33d7013d1b0400399b16c5a7">create</a>&lt;<a class="code hl_class" href="classsysio_1_1chain_1_1account__metadata__object.html">account_metadata_object</a>&gt;([&amp;](<span class="keyword">auto</span> &amp; <a class="code hl_variable" href="pointer_8h.html#aeeddce917cf130d62c370b8f216026dd">a</a>) {</div>
<div class="line"><a id="l00999" name="l00999"></a><span class="lineno">  999</span>         <a class="code hl_variable" href="pointer_8h.html#aeeddce917cf130d62c370b8f216026dd">a</a>.name = <a class="code hl_variable" href="catch__reporter__console_8cpp.html#a9b45b3e13bd9167aab02e17e08916231">name</a>;</div>
<div class="line"><a id="l01000" name="l01000"></a><span class="lineno"> 1000</span>         <a class="code hl_variable" href="pointer_8h.html#aeeddce917cf130d62c370b8f216026dd">a</a>.set_privileged( is_privileged );</div>
<div class="line"><a id="l01001" name="l01001"></a><span class="lineno"> 1001</span>      });</div>
<div class="line"><a id="l01002" name="l01002"></a><span class="lineno"> 1002</span> </div>
<div class="line"><a id="l01003" name="l01003"></a><span class="lineno"> 1003</span>      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; owner_permission  = <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#ab90d295ac18fa98f2520e4eade5b3773">authorization</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1authorization__manager.html#aac57733c5aa05c1c78a023a80b2f447f">create_permission</a>(<a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">name</a>, config::owner_name, 0,</div>
<div class="line"><a id="l01004" name="l01004"></a><span class="lineno"> 1004</span>                                                                      owner, initial_timestamp );</div>
<div class="line"><a id="l01005" name="l01005"></a><span class="lineno"> 1005</span>      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; active_permission = <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#ab90d295ac18fa98f2520e4eade5b3773">authorization</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1authorization__manager.html#aac57733c5aa05c1c78a023a80b2f447f">create_permission</a>(<a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">name</a>, config::active_name, owner_permission.id,</div>
<div class="line"><a id="l01006" name="l01006"></a><span class="lineno"> 1006</span>                                                                      active, initial_timestamp );</div>
<div class="line"><a id="l01007" name="l01007"></a><span class="lineno"> 1007</span> </div>
<div class="line"><a id="l01008" name="l01008"></a><span class="lineno"> 1008</span>      <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a83a037a61ce8e07b39d2d38b0f54f8f7">resource_limits</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1resource__limits_1_1resource__limits__manager.html#a30cd4db6f08948e05aba424431ec0605">initialize_account</a>(<a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">name</a>);</div>
<div class="line"><a id="l01009" name="l01009"></a><span class="lineno"> 1009</span> </div>
<div class="line"><a id="l01010" name="l01010"></a><span class="lineno"> 1010</span>      <a class="code hl_typedef" href="stdint_8h.html#a414156feea104f8f75b4ed9e3121b2f6">int64_t</a> ram_delta = config::overhead_per_account_ram_bytes;</div>
<div class="line"><a id="l01011" name="l01011"></a><span class="lineno"> 1011</span>      ram_delta += 2*<a class="code hl_variable" href="namespacesysio_1_1chain_1_1config.html#a2772c77657b1f6fda680bbe8f7282d13">config::billable_size_v&lt;permission_object&gt;</a>;</div>
<div class="line"><a id="l01012" name="l01012"></a><span class="lineno"> 1012</span>      ram_delta += owner_permission.auth.get_billable_size();</div>
<div class="line"><a id="l01013" name="l01013"></a><span class="lineno"> 1013</span>      ram_delta += active_permission.auth.get_billable_size();</div>
<div class="line"><a id="l01014" name="l01014"></a><span class="lineno"> 1014</span> </div>
<div class="line"><a id="l01015" name="l01015"></a><span class="lineno"> 1015</span>      <span class="keywordflow">if</span> (<span class="keyword">auto</span> dm_logger = <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a1b67831f3be3a668c170723427236954">get_deep_mind_logger</a>()) {</div>
<div class="line"><a id="l01016" name="l01016"></a><span class="lineno"> 1016</span>         dm_logger-&gt;on_ram_trace(<a class="code hl_define" href="deep__mind_8hpp.html#aaaa2f1dbd522de03ccbaa73f01db5f50">RAM_EVENT_ID</a>(<span class="stringliteral">&quot;${name}&quot;</span>, (<span class="stringliteral">&quot;name&quot;</span>, <a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">name</a>)), <span class="stringliteral">&quot;account&quot;</span>, <span class="stringliteral">&quot;add&quot;</span>, <span class="stringliteral">&quot;newaccount&quot;</span>);</div>
<div class="line"><a id="l01017" name="l01017"></a><span class="lineno"> 1017</span>      }</div>
<div class="line"><a id="l01018" name="l01018"></a><span class="lineno"> 1018</span> </div>
<div class="line"><a id="l01019" name="l01019"></a><span class="lineno"> 1019</span>      <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a83a037a61ce8e07b39d2d38b0f54f8f7">resource_limits</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1resource__limits_1_1resource__limits__manager.html#a7fea1de6a3806590de0bda86e53c7995">add_pending_ram_usage</a>(<a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">name</a>, ram_delta);</div>
<div class="line"><a id="l01020" name="l01020"></a><span class="lineno"> 1020</span>      <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a83a037a61ce8e07b39d2d38b0f54f8f7">resource_limits</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1resource__limits_1_1resource__limits__manager.html#af72734af83f353fae77fbf837776db10">verify_account_ram_usage</a>(<a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">name</a>);</div>
<div class="line"><a id="l01021" name="l01021"></a><span class="lineno"> 1021</span>   }</div>
</div>
<div class="line"><a id="l01022" name="l01022"></a><span class="lineno"> 1022</span> </div>
<div class="foldopen" id="foldopen01023" data-start="{" data-end="}">
<div class="line"><a id="l01023" name="l01023"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#a01cf826f5503f482715ca2b724279cde"> 1023</a></span>   <span class="keywordtype">void</span> <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a01cf826f5503f482715ca2b724279cde">initialize_database</a>(<span class="keyword">const</span> <a class="code hl_struct" href="structsysio_1_1chain_1_1genesis__state.html">genesis_state</a>&amp; genesis) {</div>
<div class="line"><a id="l01024" name="l01024"></a><span class="lineno"> 1024</span>      <span class="comment">// create the database header sigil</span></div>
<div class="line"><a id="l01025" name="l01025"></a><span class="lineno"> 1025</span>      <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>.<a class="code hl_function" href="classchainbase_1_1database.html#adc8f336b33d7013d1b0400399b16c5a7">create</a>&lt;<a class="code hl_class" href="classsysio_1_1chain_1_1database__header__object.html">database_header_object</a>&gt;([&amp;]( <span class="keyword">auto</span>&amp; header ){</div>
<div class="line"><a id="l01026" name="l01026"></a><span class="lineno"> 1026</span>         <span class="comment">// nothing to do for now</span></div>
<div class="line"><a id="l01027" name="l01027"></a><span class="lineno"> 1027</span>      });</div>
<div class="line"><a id="l01028" name="l01028"></a><span class="lineno"> 1028</span> </div>
<div class="line"><a id="l01029" name="l01029"></a><span class="lineno"> 1029</span>      <span class="comment">// Initialize block summary index</span></div>
<div class="line"><a id="l01030" name="l01030"></a><span class="lineno"> 1030</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 0x10000; i++)</div>
<div class="line"><a id="l01031" name="l01031"></a><span class="lineno"> 1031</span>         <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>.<a class="code hl_function" href="classchainbase_1_1database.html#adc8f336b33d7013d1b0400399b16c5a7">create</a>&lt;<a class="code hl_class" href="classsysio_1_1chain_1_1block__summary__object.html">block_summary_object</a>&gt;([&amp;](<a class="code hl_class" href="classsysio_1_1chain_1_1block__summary__object.html">block_summary_object</a>&amp;) {});</div>
<div class="line"><a id="l01032" name="l01032"></a><span class="lineno"> 1032</span> </div>
<div class="line"><a id="l01033" name="l01033"></a><span class="lineno"> 1033</span>      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; tapos_block_summary = <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>.<a class="code hl_function" href="classchainbase_1_1database.html#afcfe00f81a526c1376d4f51197dd3a9a">get</a>&lt;<a class="code hl_class" href="classsysio_1_1chain_1_1block__summary__object.html">block_summary_object</a>&gt;(1);</div>
<div class="line"><a id="l01034" name="l01034"></a><span class="lineno"> 1034</span>      <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>.<a class="code hl_function" href="classchainbase_1_1database.html#a9ebc006075e8fc2e84357a0e068b58d4">modify</a>( tapos_block_summary, [&amp;]( <span class="keyword">auto</span>&amp; bs ) {</div>
<div class="line"><a id="l01035" name="l01035"></a><span class="lineno"> 1035</span>         bs.block_id = <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a56a0f369b58e6597b62569ff2853ee90">head</a>-&gt;id;</div>
<div class="line"><a id="l01036" name="l01036"></a><span class="lineno"> 1036</span>      });</div>
<div class="line"><a id="l01037" name="l01037"></a><span class="lineno"> 1037</span> </div>
<div class="line"><a id="l01038" name="l01038"></a><span class="lineno"> 1038</span>      genesis.initial_configuration.validate();</div>
<div class="line"><a id="l01039" name="l01039"></a><span class="lineno"> 1039</span>      <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>.<a class="code hl_function" href="classchainbase_1_1database.html#adc8f336b33d7013d1b0400399b16c5a7">create</a>&lt;<a class="code hl_class" href="classsysio_1_1chain_1_1global__property__object.html">global_property_object</a>&gt;([&amp;genesis,&amp;<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a2f7115cf9c5daa3abca8e0467dce5a5a">chain_id</a>=this-&gt;<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a2f7115cf9c5daa3abca8e0467dce5a5a">chain_id</a>](<span class="keyword">auto</span>&amp; gpo ){</div>
<div class="line"><a id="l01040" name="l01040"></a><span class="lineno"> 1040</span>         gpo.configuration = genesis.initial_configuration;</div>
<div class="line"><a id="l01041" name="l01041"></a><span class="lineno"> 1041</span>         <span class="comment">// TODO: Update this when genesis protocol features are enabled.</span></div>
<div class="line"><a id="l01042" name="l01042"></a><span class="lineno"> 1042</span>         gpo.wasm_configuration = <a class="code hl_variable" href="structsysio_1_1chain_1_1genesis__state.html#a3e6e5eb6e7b0107b1f105eb8a4dcca41">genesis_state::default_initial_wasm_configuration</a>;</div>
<div class="line"><a id="l01043" name="l01043"></a><span class="lineno"> 1043</span>         gpo.chain_id = <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a2f7115cf9c5daa3abca8e0467dce5a5a">chain_id</a>;</div>
<div class="line"><a id="l01044" name="l01044"></a><span class="lineno"> 1044</span>      });</div>
<div class="line"><a id="l01045" name="l01045"></a><span class="lineno"> 1045</span> </div>
<div class="line"><a id="l01046" name="l01046"></a><span class="lineno"> 1046</span>      <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>.<a class="code hl_function" href="classchainbase_1_1database.html#adc8f336b33d7013d1b0400399b16c5a7">create</a>&lt;<a class="code hl_class" href="classsysio_1_1chain_1_1protocol__state__object.html">protocol_state_object</a>&gt;([&amp;](<span class="keyword">auto</span>&amp; pso ){</div>
<div class="line"><a id="l01047" name="l01047"></a><span class="lineno"> 1047</span>         pso.num_supported_key_types = config::genesis_num_supported_key_types;</div>
<div class="line"><a id="l01048" name="l01048"></a><span class="lineno"> 1048</span>         <span class="keywordflow">for</span>( <span class="keyword">const</span> <span class="keyword">auto</span>&amp; i : <a class="code hl_variable" href="namespacesysio_1_1chain.html#a01ed37e95a76bcd3dec49672be7acfaa">genesis_intrinsics</a> ) {</div>
<div class="line"><a id="l01049" name="l01049"></a><span class="lineno"> 1049</span>            <a class="code hl_function" href="namespacesysio_1_1chain.html#a32f7ac67403d93f11d6098fb6abd1cc3">add_intrinsic_to_whitelist</a>( pso.whitelisted_intrinsics, i );</div>
<div class="line"><a id="l01050" name="l01050"></a><span class="lineno"> 1050</span>         }</div>
<div class="line"><a id="l01051" name="l01051"></a><span class="lineno"> 1051</span>      });</div>
<div class="line"><a id="l01052" name="l01052"></a><span class="lineno"> 1052</span> </div>
<div class="line"><a id="l01053" name="l01053"></a><span class="lineno"> 1053</span>      <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>.<a class="code hl_function" href="classchainbase_1_1database.html#adc8f336b33d7013d1b0400399b16c5a7">create</a>&lt;<a class="code hl_class" href="classsysio_1_1chain_1_1dynamic__global__property__object.html">dynamic_global_property_object</a>&gt;([](<span class="keyword">auto</span>&amp;){});</div>
<div class="line"><a id="l01054" name="l01054"></a><span class="lineno"> 1054</span> </div>
<div class="line"><a id="l01055" name="l01055"></a><span class="lineno"> 1055</span>      <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#ab90d295ac18fa98f2520e4eade5b3773">authorization</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1authorization__manager.html#a27cfd5f70c12c10a9939e7bf6b3a52e4">initialize_database</a>();</div>
<div class="line"><a id="l01056" name="l01056"></a><span class="lineno"> 1056</span>      <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a83a037a61ce8e07b39d2d38b0f54f8f7">resource_limits</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1resource__limits_1_1resource__limits__manager.html#a1b9d0326965430166923c2241a3a6a45">initialize_database</a>();</div>
<div class="line"><a id="l01057" name="l01057"></a><span class="lineno"> 1057</span> </div>
<div class="line"><a id="l01058" name="l01058"></a><span class="lineno"> 1058</span>      <a class="code hl_struct" href="structsysio_1_1chain_1_1authority.html">authority</a> system_auth(genesis.initial_key);</div>
<div class="line"><a id="l01059" name="l01059"></a><span class="lineno"> 1059</span>      <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#ae2c30acb1a0557f6c3967c6a154f7b23">create_native_account</a>( genesis.initial_timestamp, config::system_account_name, system_auth, system_auth, <span class="keyword">true</span> );</div>
<div class="line"><a id="l01060" name="l01060"></a><span class="lineno"> 1060</span> </div>
<div class="line"><a id="l01061" name="l01061"></a><span class="lineno"> 1061</span>      <span class="keyword">auto</span> empty_authority = <a class="code hl_struct" href="structsysio_1_1chain_1_1authority.html">authority</a>(1, {}, {});</div>
<div class="line"><a id="l01062" name="l01062"></a><span class="lineno"> 1062</span>      <span class="keyword">auto</span> active_producers_authority = <a class="code hl_struct" href="structsysio_1_1chain_1_1authority.html">authority</a>(1, {}, {});</div>
<div class="line"><a id="l01063" name="l01063"></a><span class="lineno"> 1063</span>      active_producers_authority.<a class="code hl_variable" href="structsysio_1_1chain_1_1authority.html#a89e0cd6c19b4d59a0d37c499d6e90dd0">accounts</a>.push_back({{config::system_account_name, config::active_name}, 1});</div>
<div class="line"><a id="l01064" name="l01064"></a><span class="lineno"> 1064</span> </div>
<div class="line"><a id="l01065" name="l01065"></a><span class="lineno"> 1065</span>      <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#ae2c30acb1a0557f6c3967c6a154f7b23">create_native_account</a>( genesis.initial_timestamp, config::null_account_name, empty_authority, empty_authority );</div>
<div class="line"><a id="l01066" name="l01066"></a><span class="lineno"> 1066</span>      <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#ae2c30acb1a0557f6c3967c6a154f7b23">create_native_account</a>( genesis.initial_timestamp, config::producers_account_name, empty_authority, active_producers_authority );</div>
<div class="line"><a id="l01067" name="l01067"></a><span class="lineno"> 1067</span>      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; active_permission       = <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#ab90d295ac18fa98f2520e4eade5b3773">authorization</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1authorization__manager.html#a96924f6aca32a602e24d991d12278a69">get_permission</a>({config::producers_account_name, config::active_name});</div>
<div class="line"><a id="l01068" name="l01068"></a><span class="lineno"> 1068</span>      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; majority_permission     = <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#ab90d295ac18fa98f2520e4eade5b3773">authorization</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1authorization__manager.html#aac57733c5aa05c1c78a023a80b2f447f">create_permission</a>( config::producers_account_name,</div>
<div class="line"><a id="l01069" name="l01069"></a><span class="lineno"> 1069</span>                                                                             config::majority_producers_permission_name,</div>
<div class="line"><a id="l01070" name="l01070"></a><span class="lineno"> 1070</span>                                                                             active_permission.id,</div>
<div class="line"><a id="l01071" name="l01071"></a><span class="lineno"> 1071</span>                                                                             active_producers_authority,</div>
<div class="line"><a id="l01072" name="l01072"></a><span class="lineno"> 1072</span>                                                                             genesis.initial_timestamp );</div>
<div class="line"><a id="l01073" name="l01073"></a><span class="lineno"> 1073</span>                                            <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#ab90d295ac18fa98f2520e4eade5b3773">authorization</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1authorization__manager.html#aac57733c5aa05c1c78a023a80b2f447f">create_permission</a>( config::producers_account_name,</div>
<div class="line"><a id="l01074" name="l01074"></a><span class="lineno"> 1074</span>                                                                             config::minority_producers_permission_name,</div>
<div class="line"><a id="l01075" name="l01075"></a><span class="lineno"> 1075</span>                                                                             majority_permission.id,</div>
<div class="line"><a id="l01076" name="l01076"></a><span class="lineno"> 1076</span>                                                                             active_producers_authority,</div>
<div class="line"><a id="l01077" name="l01077"></a><span class="lineno"> 1077</span>                                                                             genesis.initial_timestamp );</div>
<div class="line"><a id="l01078" name="l01078"></a><span class="lineno"> 1078</span> </div>
<div class="line"><a id="l01079" name="l01079"></a><span class="lineno"> 1079</span>   }</div>
</div>
<div class="line"><a id="l01080" name="l01080"></a><span class="lineno"> 1080</span> </div>
<div class="line"><a id="l01081" name="l01081"></a><span class="lineno"> 1081</span>   <span class="comment">// The returned scoped_exit should not exceed the lifetime of the pending which existed when make_block_restore_point was called.</span></div>
<div class="foldopen" id="foldopen01082" data-start="{" data-end="}">
<div class="line"><a id="l01082" name="l01082"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#a89d9e83d4de2f7aec957e54dce4a76f5"> 1082</a></span>   <a class="code hl_class" href="classfc_1_1scoped__exit.html">fc::scoped_exit</a>&lt;std::function&lt;void()&gt;&gt; <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a89d9e83d4de2f7aec957e54dce4a76f5">make_block_restore_point</a>() {</div>
<div class="line"><a id="l01083" name="l01083"></a><span class="lineno"> 1083</span>      <span class="keyword">auto</span>&amp; bb = std::get&lt;building_block&gt;(<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a0e355919fd924a05344ef2b59f7dd587">pending</a>-&gt;_block_stage);</div>
<div class="line"><a id="l01084" name="l01084"></a><span class="lineno"> 1084</span>      <span class="keyword">auto</span> orig_block_transactions_size = bb._pending_trx_receipts.size();</div>
<div class="line"><a id="l01085" name="l01085"></a><span class="lineno"> 1085</span>      <span class="keyword">auto</span> orig_state_transactions_size = bb._pending_trx_metas.size();</div>
<div class="line"><a id="l01086" name="l01086"></a><span class="lineno"> 1086</span>      <span class="keyword">auto</span> orig_action_receipt_digests_size = bb._action_receipt_digests.size();</div>
<div class="line"><a id="l01087" name="l01087"></a><span class="lineno"> 1087</span> </div>
<div class="line"><a id="l01088" name="l01088"></a><span class="lineno"> 1088</span>      std::function&lt;void()&gt; callback = [<span class="keyword">this</span>,</div>
<div class="line"><a id="l01089" name="l01089"></a><span class="lineno"> 1089</span>                                        orig_block_transactions_size,</div>
<div class="line"><a id="l01090" name="l01090"></a><span class="lineno"> 1090</span>                                        orig_state_transactions_size,</div>
<div class="line"><a id="l01091" name="l01091"></a><span class="lineno"> 1091</span>                                        orig_action_receipt_digests_size]()</div>
<div class="line"><a id="l01092" name="l01092"></a><span class="lineno"> 1092</span>      {</div>
<div class="line"><a id="l01093" name="l01093"></a><span class="lineno"> 1093</span>         <span class="keyword">auto</span>&amp; bb = std::get&lt;building_block&gt;(<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a0e355919fd924a05344ef2b59f7dd587">pending</a>-&gt;_block_stage);</div>
<div class="line"><a id="l01094" name="l01094"></a><span class="lineno"> 1094</span>         bb._pending_trx_receipts.resize(orig_block_transactions_size);</div>
<div class="line"><a id="l01095" name="l01095"></a><span class="lineno"> 1095</span>         bb._pending_trx_metas.resize(orig_state_transactions_size);</div>
<div class="line"><a id="l01096" name="l01096"></a><span class="lineno"> 1096</span>         bb._action_receipt_digests.resize(orig_action_receipt_digests_size);</div>
<div class="line"><a id="l01097" name="l01097"></a><span class="lineno"> 1097</span>      };</div>
<div class="line"><a id="l01098" name="l01098"></a><span class="lineno"> 1098</span> </div>
<div class="line"><a id="l01099" name="l01099"></a><span class="lineno"> 1099</span>      <span class="keywordflow">return</span> <a class="code hl_function" href="namespacefc.html#a23d89b54a8ffd84f7e7efeb21747d846">fc::make_scoped_exit</a>( std::move(callback) );</div>
<div class="line"><a id="l01100" name="l01100"></a><span class="lineno"> 1100</span>   }</div>
</div>
<div class="line"><a id="l01101" name="l01101"></a><span class="lineno"> 1101</span> </div>
<div class="foldopen" id="foldopen01102" data-start="{" data-end="}">
<div class="line"><a id="l01102" name="l01102"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#aa7c2a2da2eed15c5d55146b0ebd6646b"> 1102</a></span>   <a class="code hl_typedef" href="namespacesysio_1_1chain.html#a4ee2867a6bec961c7a78b203cfd76be9">transaction_trace_ptr</a> <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#aa7c2a2da2eed15c5d55146b0ebd6646b">apply_onerror</a>( <span class="keyword">const</span> <a class="code hl_class" href="classsysio_1_1chain_1_1generated__transaction.html">generated_transaction</a>&amp; gtrx,</div>
<div class="line"><a id="l01103" name="l01103"></a><span class="lineno"> 1103</span>                                        <a class="code hl_class" href="classfc_1_1time__point.html">fc::time_point</a> block_deadline,</div>
<div class="line"><a id="l01104" name="l01104"></a><span class="lineno"> 1104</span>                                        <a class="code hl_class" href="classfc_1_1microseconds.html">fc::microseconds</a> max_transaction_time,</div>
<div class="line"><a id="l01105" name="l01105"></a><span class="lineno"> 1105</span>                                        <a class="code hl_class" href="classfc_1_1time__point.html">fc::time_point</a> start,</div>
<div class="line"><a id="l01106" name="l01106"></a><span class="lineno"> 1106</span>                                        <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&amp; cpu_time_to_bill_us, <span class="comment">// only set on failure</span></div>
<div class="line"><a id="l01107" name="l01107"></a><span class="lineno"> 1107</span>                                        <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> billed_cpu_time_us,</div>
<div class="line"><a id="l01108" name="l01108"></a><span class="lineno"> 1108</span>                                        <span class="keywordtype">bool</span> explicit_billed_cpu_time = <span class="keyword">false</span>,</div>
<div class="line"><a id="l01109" name="l01109"></a><span class="lineno"> 1109</span>                                        <span class="keywordtype">bool</span> enforce_whiteblacklist = <span class="keyword">true</span></div>
<div class="line"><a id="l01110" name="l01110"></a><span class="lineno"> 1110</span>                                      )</div>
<div class="line"><a id="l01111" name="l01111"></a><span class="lineno"> 1111</span>   {</div>
<div class="line"><a id="l01112" name="l01112"></a><span class="lineno"> 1112</span>      <a class="code hl_struct" href="structsysio_1_1chain_1_1signed__transaction.html">signed_transaction</a> etrx;</div>
<div class="line"><a id="l01113" name="l01113"></a><span class="lineno"> 1113</span>      <span class="comment">// Deliver onerror action containing the failed deferred transaction directly back to the sender.</span></div>
<div class="line"><a id="l01114" name="l01114"></a><span class="lineno"> 1114</span>      etrx.<a class="code hl_variable" href="structsysio_1_1chain_1_1transaction.html#a407fcf1868b81bb30b85f80d388bbac2">actions</a>.emplace_back( <a class="code hl_class" href="classfc_1_1vector.html">vector&lt;permission_level&gt;</a>{{gtrx.<a class="code hl_variable" href="classsysio_1_1chain_1_1generated__transaction.html#a6908b60ff3382855ee46b8c1e0ab2690">sender</a>, config::active_name}},</div>
<div class="line"><a id="l01115" name="l01115"></a><span class="lineno"> 1115</span>                                 <a class="code hl_struct" href="structsysio_1_1chain_1_1onerror.html">onerror</a>( gtrx.<a class="code hl_variable" href="classsysio_1_1chain_1_1generated__transaction.html#af49dc304254627bac1f43fc182b143e8">sender_id</a>, gtrx.<a class="code hl_variable" href="classsysio_1_1chain_1_1generated__transaction.html#ae7161050b7f947df1748a6c1ae0cba5d">packed_trx</a>.data(), gtrx.<a class="code hl_variable" href="classsysio_1_1chain_1_1generated__transaction.html#ae7161050b7f947df1748a6c1ae0cba5d">packed_trx</a>.size() ) );</div>
<div class="line"><a id="l01116" name="l01116"></a><span class="lineno"> 1116</span>      <span class="keywordflow">if</span>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a64851fb4e041dc49ab22cf2ba335720d">self</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#aa808acf858e93c567ff983ccbf8fb6d3">is_builtin_activated</a>( <a class="code hl_enumvalue" href="namespacesysio_1_1chain.html#a406d45a184cdba0af316b5bf34bf56cfa1e0a5b7203c3f4124dc8c1880b04e36b">builtin_protocol_feature_t::no_duplicate_deferred_id</a> ) ) {</div>
<div class="line"><a id="l01117" name="l01117"></a><span class="lineno"> 1117</span>         etrx.<a class="code hl_variable" href="structsysio_1_1chain_1_1transaction__header.html#ad1ed2586e8ace769fdb9a54d09a752ce">expiration</a> = <a class="code hl_class" href="classfc_1_1time__point__sec.html">time_point_sec</a>();</div>
<div class="line"><a id="l01118" name="l01118"></a><span class="lineno"> 1118</span>         etrx.<a class="code hl_variable" href="structsysio_1_1chain_1_1transaction__header.html#a459d803b930351f4a1565d9c082debea">ref_block_num</a> = 0;</div>
<div class="line"><a id="l01119" name="l01119"></a><span class="lineno"> 1119</span>         etrx.<a class="code hl_variable" href="structsysio_1_1chain_1_1transaction__header.html#a6f02077864a99b91d043cd329433a532">ref_block_prefix</a> = 0;</div>
<div class="line"><a id="l01120" name="l01120"></a><span class="lineno"> 1120</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01121" name="l01121"></a><span class="lineno"> 1121</span>         etrx.<a class="code hl_variable" href="structsysio_1_1chain_1_1transaction__header.html#ad1ed2586e8ace769fdb9a54d09a752ce">expiration</a> = <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a64851fb4e041dc49ab22cf2ba335720d">self</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#abb1d81f96986df3bce46bd37caaf6a69">pending_block_time</a>() + <a class="code hl_class" href="classfc_1_1microseconds.html">fc::microseconds</a>(999&#39;999); <span class="comment">// Round up to nearest second to avoid appearing expired</span></div>
<div class="line"><a id="l01122" name="l01122"></a><span class="lineno"> 1122</span>         etrx.<a class="code hl_function" href="structsysio_1_1chain_1_1transaction__header.html#a220798b433002112ac85e5545a99ec51">set_reference_block</a>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a64851fb4e041dc49ab22cf2ba335720d">self</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a37d0a44faef74cf0f96127982c1ce124">head_block_id</a>() );</div>
<div class="line"><a id="l01123" name="l01123"></a><span class="lineno"> 1123</span>      }</div>
<div class="line"><a id="l01124" name="l01124"></a><span class="lineno"> 1124</span> </div>
<div class="line"><a id="l01125" name="l01125"></a><span class="lineno"> 1125</span>      <span class="keywordflow">if</span> (<span class="keyword">auto</span> dm_logger = <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a1b67831f3be3a668c170723427236954">get_deep_mind_logger</a>()) {</div>
<div class="line"><a id="l01126" name="l01126"></a><span class="lineno"> 1126</span>         dm_logger-&gt;on_onerror(etrx);</div>
<div class="line"><a id="l01127" name="l01127"></a><span class="lineno"> 1127</span>      }</div>
<div class="line"><a id="l01128" name="l01128"></a><span class="lineno"> 1128</span> </div>
<div class="line"><a id="l01129" name="l01129"></a><span class="lineno"> 1129</span>      <a class="code hl_struct" href="structsysio_1_1chain_1_1transaction__checktime__timer.html">transaction_checktime_timer</a> trx_timer(<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#ad3c19aea29c2fbb28ca7120d591ba088">timer</a>);</div>
<div class="line"><a id="l01130" name="l01130"></a><span class="lineno"> 1130</span>      <span class="keyword">const</span> <a class="code hl_struct" href="structsysio_1_1chain_1_1packed__transaction.html">packed_transaction</a> trx( std::move( etrx ) );</div>
<div class="line"><a id="l01131" name="l01131"></a><span class="lineno"> 1131</span>      <a class="code hl_class" href="classsysio_1_1chain_1_1transaction__context.html">transaction_context</a> trx_context( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a64851fb4e041dc49ab22cf2ba335720d">self</a>, trx, std::move(trx_timer), start );</div>
<div class="line"><a id="l01132" name="l01132"></a><span class="lineno"> 1132</span> </div>
<div class="line"><a id="l01133" name="l01133"></a><span class="lineno"> 1133</span>      trx_context.<a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a708229aea669816e99b0039d716c3ed5">block_deadline</a> = block_deadline;</div>
<div class="line"><a id="l01134" name="l01134"></a><span class="lineno"> 1134</span>      trx_context.max_transaction_time_subjective = max_transaction_time;</div>
<div class="line"><a id="l01135" name="l01135"></a><span class="lineno"> 1135</span>      trx_context.<a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a05dbab6e9e0d4f3e30fa1392ac4430a1">explicit_billed_cpu_time</a> = explicit_billed_cpu_time;</div>
<div class="line"><a id="l01136" name="l01136"></a><span class="lineno"> 1136</span>      trx_context.<a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a08b550fccea696363035c6736c146436">billed_cpu_time_us</a> = billed_cpu_time_us;</div>
<div class="line"><a id="l01137" name="l01137"></a><span class="lineno"> 1137</span>      trx_context.<a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a799e9208ec6d2ea3d1dfccfd4eb97cec">enforce_whiteblacklist</a> = enforce_whiteblacklist;</div>
<div class="line"><a id="l01138" name="l01138"></a><span class="lineno"> 1138</span>      <a class="code hl_typedef" href="namespacesysio_1_1chain.html#a4ee2867a6bec961c7a78b203cfd76be9">transaction_trace_ptr</a> trace = trx_context.<a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a7211fab425e4375e247c2a3d1924e63f">trace</a>;</div>
<div class="line"><a id="l01139" name="l01139"></a><span class="lineno"> 1139</span> </div>
<div class="line"><a id="l01140" name="l01140"></a><span class="lineno"> 1140</span>      <span class="keyword">auto</span> handle_exception = [&amp;](<span class="keyword">const</span> <span class="keyword">auto</span>&amp; e)</div>
<div class="line"><a id="l01141" name="l01141"></a><span class="lineno"> 1141</span>      {</div>
<div class="line"><a id="l01142" name="l01142"></a><span class="lineno"> 1142</span>         cpu_time_to_bill_us = trx_context.<a class="code hl_function" href="classsysio_1_1chain_1_1transaction__context.html#a2f8dc57cb2e3562de132326b0d06e15d">update_billed_cpu_time</a>( <a class="code hl_function" href="classfc_1_1time__point.html#aa164ff1268a16d4b32afcff181f6100e">fc::time_point::now</a>() );</div>
<div class="line"><a id="l01143" name="l01143"></a><span class="lineno"> 1143</span>         trace-&gt;error_code = <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#ae60743ce36f1fa0912ff26b1da40afe6">controller::convert_exception_to_error_code</a>( e );</div>
<div class="line"><a id="l01144" name="l01144"></a><span class="lineno"> 1144</span>         trace-&gt;except = e;</div>
<div class="line"><a id="l01145" name="l01145"></a><span class="lineno"> 1145</span>         trace-&gt;except_ptr = std::current_exception();</div>
<div class="line"><a id="l01146" name="l01146"></a><span class="lineno"> 1146</span>      };</div>
<div class="line"><a id="l01147" name="l01147"></a><span class="lineno"> 1147</span> </div>
<div class="line"><a id="l01148" name="l01148"></a><span class="lineno"> 1148</span>      <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l01149" name="l01149"></a><span class="lineno"> 1149</span>         trx_context.<a class="code hl_function" href="classsysio_1_1chain_1_1transaction__context.html#a5d3d1260b6f77fdc4b6a8cef3417e94c">init_for_implicit_trx</a>();</div>
<div class="line"><a id="l01150" name="l01150"></a><span class="lineno"> 1150</span>         trx_context.<a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#ab8e1aaec319ed2ae90b6a6f499919c89">published</a> = gtrx.<a class="code hl_variable" href="classsysio_1_1chain_1_1generated__transaction.html#a01a19b0ce89dd3ef4a668455365a7c0a">published</a>;</div>
<div class="line"><a id="l01151" name="l01151"></a><span class="lineno"> 1151</span>         trx_context.execute_action( trx_context.schedule_action( trx.<a class="code hl_function" href="structsysio_1_1chain_1_1packed__transaction.html#ad193d26eb97cfd5b3f7d8b957eaa35a2">get_transaction</a>().<a class="code hl_variable" href="structsysio_1_1chain_1_1transaction.html#a407fcf1868b81bb30b85f80d388bbac2">actions</a>.back(), gtrx.<a class="code hl_variable" href="classsysio_1_1chain_1_1generated__transaction.html#a6908b60ff3382855ee46b8c1e0ab2690">sender</a>, <span class="keyword">false</span>, 0, 0 ), 0 );</div>
<div class="line"><a id="l01152" name="l01152"></a><span class="lineno"> 1152</span>         trx_context.<a class="code hl_function" href="classsysio_1_1chain_1_1transaction__context.html#a300b3d2c25e7de11562c579c41f43dda">finalize</a>(); <span class="comment">// Automatically rounds up network and CPU usage in trace and bills payers if successful</span></div>
<div class="line"><a id="l01153" name="l01153"></a><span class="lineno"> 1153</span> </div>
<div class="line"><a id="l01154" name="l01154"></a><span class="lineno"> 1154</span>         <span class="keyword">auto</span> restore = <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a89d9e83d4de2f7aec957e54dce4a76f5">make_block_restore_point</a>();</div>
<div class="line"><a id="l01155" name="l01155"></a><span class="lineno"> 1155</span>         trace-&gt;receipt = <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#aae2b1bfeee1e7c1c0237f12776e75dd7">push_receipt</a>( gtrx.<a class="code hl_variable" href="classsysio_1_1chain_1_1generated__transaction.html#abe73e701a3935f3369f212a744c9a6cc">trx_id</a>, <a class="code hl_enumvalue" href="structsysio_1_1chain_1_1transaction__receipt__header.html#a2bb00bac16048e6f624c2ded867ebf55a98d0df834b74445e549f5d2123443b4e">transaction_receipt::soft_fail</a>,</div>
<div class="line"><a id="l01156" name="l01156"></a><span class="lineno"> 1156</span>                                        trx_context.<a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a08b550fccea696363035c6736c146436">billed_cpu_time_us</a>, trace-&gt;net_usage );</div>
<div class="line"><a id="l01157" name="l01157"></a><span class="lineno"> 1157</span>         <a class="code hl_function" href="namespacefc.html#a219f556e23004060631ffb2baaeaff02">fc::move_append</a>( std::get&lt;building_block&gt;(<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a0e355919fd924a05344ef2b59f7dd587">pending</a>-&gt;_block_stage)._action_receipt_digests,</div>
<div class="line"><a id="l01158" name="l01158"></a><span class="lineno"> 1158</span>                          std::move(trx_context.<a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#aa16627a2b31f924e998137ba14f22123">executed_action_receipt_digests</a>) );</div>
<div class="line"><a id="l01159" name="l01159"></a><span class="lineno"> 1159</span> </div>
<div class="line"><a id="l01160" name="l01160"></a><span class="lineno"> 1160</span>         trx_context.<a class="code hl_function" href="classsysio_1_1chain_1_1transaction__context.html#a558e8aff8e48deb61fae7407e10e8788">squash</a>();</div>
<div class="line"><a id="l01161" name="l01161"></a><span class="lineno"> 1161</span>         restore.cancel();</div>
<div class="line"><a id="l01162" name="l01162"></a><span class="lineno"> 1162</span>         <span class="keywordflow">return</span> trace;</div>
<div class="line"><a id="l01163" name="l01163"></a><span class="lineno"> 1163</span>      } <span class="keywordflow">catch</span>( <span class="keyword">const</span> disallowed_transaction_extensions_bad_block_exception&amp; ) {</div>
<div class="line"><a id="l01164" name="l01164"></a><span class="lineno"> 1164</span>         <span class="keywordflow">throw</span>;</div>
<div class="line"><a id="l01165" name="l01165"></a><span class="lineno"> 1165</span>      } <span class="keywordflow">catch</span>( <span class="keyword">const</span> protocol_feature_bad_block_exception&amp; ) {</div>
<div class="line"><a id="l01166" name="l01166"></a><span class="lineno"> 1166</span>         <span class="keywordflow">throw</span>;</div>
<div class="line"><a id="l01167" name="l01167"></a><span class="lineno"> 1167</span>      } <span class="keywordflow">catch</span> ( <span class="keyword">const</span> std::bad_alloc&amp; ) {</div>
<div class="line"><a id="l01168" name="l01168"></a><span class="lineno"> 1168</span>         <span class="keywordflow">throw</span>;</div>
<div class="line"><a id="l01169" name="l01169"></a><span class="lineno"> 1169</span>      } <span class="keywordflow">catch</span> ( <span class="keyword">const</span> boost::interprocess::bad_alloc&amp; ) {</div>
<div class="line"><a id="l01170" name="l01170"></a><span class="lineno"> 1170</span>         <span class="keywordflow">throw</span>;</div>
<div class="line"><a id="l01171" name="l01171"></a><span class="lineno"> 1171</span>      } <span class="keywordflow">catch</span>( <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1exception.html">fc::exception</a>&amp; e ) {</div>
<div class="line"><a id="l01172" name="l01172"></a><span class="lineno"> 1172</span>         handle_exception(e);</div>
<div class="line"><a id="l01173" name="l01173"></a><span class="lineno"> 1173</span>      } <span class="keywordflow">catch</span> ( <span class="keyword">const</span> std::exception&amp; e ) {</div>
<div class="line"><a id="l01174" name="l01174"></a><span class="lineno"> 1174</span>         <span class="keyword">auto</span> wrapper = <a class="code hl_function" href="classfc_1_1std__exception__wrapper.html#ae5ad64f84b1d373f5b92031566284c7c">fc::std_exception_wrapper::from_current_exception</a>(e);</div>
<div class="line"><a id="l01175" name="l01175"></a><span class="lineno"> 1175</span>         handle_exception(wrapper);</div>
<div class="line"><a id="l01176" name="l01176"></a><span class="lineno"> 1176</span>      }</div>
<div class="line"><a id="l01177" name="l01177"></a><span class="lineno"> 1177</span>      <span class="keywordflow">return</span> trace;</div>
<div class="line"><a id="l01178" name="l01178"></a><span class="lineno"> 1178</span>   }</div>
</div>
<div class="line"><a id="l01179" name="l01179"></a><span class="lineno"> 1179</span> </div>
<div class="foldopen" id="foldopen01180" data-start="{" data-end="}">
<div class="line"><a id="l01180" name="l01180"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#a1dac6da3cb5899f6bcd62b9012c75e43"> 1180</a></span>   <a class="code hl_typedef" href="stdint_8h.html#a414156feea104f8f75b4ed9e3121b2f6">int64_t</a> <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a1dac6da3cb5899f6bcd62b9012c75e43">remove_scheduled_transaction</a>( <span class="keyword">const</span> <a class="code hl_class" href="classsysio_1_1chain_1_1generated__transaction__object.html">generated_transaction_object</a>&amp; gto ) {</div>
<div class="line"><a id="l01181" name="l01181"></a><span class="lineno"> 1181</span>      <span class="keywordflow">if</span> (<span class="keyword">auto</span> dm_logger = <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a1b67831f3be3a668c170723427236954">get_deep_mind_logger</a>()) {</div>
<div class="line"><a id="l01182" name="l01182"></a><span class="lineno"> 1182</span>         dm_logger-&gt;on_ram_trace(<a class="code hl_define" href="deep__mind_8hpp.html#aaaa2f1dbd522de03ccbaa73f01db5f50">RAM_EVENT_ID</a>(<span class="stringliteral">&quot;${id}&quot;</span>, (<span class="stringliteral">&quot;id&quot;</span>, gto.id)), <span class="stringliteral">&quot;deferred_trx&quot;</span>, <span class="stringliteral">&quot;remove&quot;</span>, <span class="stringliteral">&quot;deferred_trx_removed&quot;</span>);</div>
<div class="line"><a id="l01183" name="l01183"></a><span class="lineno"> 1183</span>      }</div>
<div class="line"><a id="l01184" name="l01184"></a><span class="lineno"> 1184</span> </div>
<div class="line"><a id="l01185" name="l01185"></a><span class="lineno"> 1185</span>      <a class="code hl_typedef" href="stdint_8h.html#a414156feea104f8f75b4ed9e3121b2f6">int64_t</a> ram_delta = -(<a class="code hl_variable" href="namespacesysio_1_1chain_1_1config.html#a2772c77657b1f6fda680bbe8f7282d13">config::billable_size_v&lt;generated_transaction_object&gt;</a> + gto.packed_trx.<a class="code hl_function" href="classchainbase_1_1shared__cow__string.html#a3b3c57c0d2ee027bb70beb283be2a0f2">size</a>());</div>
<div class="line"><a id="l01186" name="l01186"></a><span class="lineno"> 1186</span>      <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a83a037a61ce8e07b39d2d38b0f54f8f7">resource_limits</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1resource__limits_1_1resource__limits__manager.html#a7fea1de6a3806590de0bda86e53c7995">add_pending_ram_usage</a>( gto.payer, ram_delta );</div>
<div class="line"><a id="l01187" name="l01187"></a><span class="lineno"> 1187</span>      <span class="comment">// No need to verify_account_ram_usage since we are only reducing memory</span></div>
<div class="line"><a id="l01188" name="l01188"></a><span class="lineno"> 1188</span> </div>
<div class="line"><a id="l01189" name="l01189"></a><span class="lineno"> 1189</span>      <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>.<a class="code hl_function" href="classchainbase_1_1database.html#ac6bb29708e4fdfb6899028e3c351fe0b">remove</a>( gto );</div>
<div class="line"><a id="l01190" name="l01190"></a><span class="lineno"> 1190</span>      <span class="keywordflow">return</span> ram_delta;</div>
<div class="line"><a id="l01191" name="l01191"></a><span class="lineno"> 1191</span>   }</div>
</div>
<div class="line"><a id="l01192" name="l01192"></a><span class="lineno"> 1192</span> </div>
<div class="foldopen" id="foldopen01193" data-start="{" data-end="}">
<div class="line"><a id="l01193" name="l01193"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#ad0d5a921dd01458d1464f63b0f0121c6"> 1193</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#ad0d5a921dd01458d1464f63b0f0121c6">failure_is_subjective</a>( <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1exception.html">fc::exception</a>&amp; e )<span class="keyword"> const </span>{</div>
<div class="line"><a id="l01194" name="l01194"></a><span class="lineno"> 1194</span>      <span class="keyword">auto</span> code = e.<a class="code hl_function" href="classfc_1_1exception.html#a79a36225cde10dcd23057bbe19d3390f">code</a>();</div>
<div class="line"><a id="l01195" name="l01195"></a><span class="lineno"> 1195</span>      <span class="keywordflow">return</span>    (code == subjective_block_production_exception::code_value)</div>
<div class="line"><a id="l01196" name="l01196"></a><span class="lineno"> 1196</span>             || (code == block_net_usage_exceeded::code_value)</div>
<div class="line"><a id="l01197" name="l01197"></a><span class="lineno"> 1197</span>             || (code == greylist_net_usage_exceeded::code_value)</div>
<div class="line"><a id="l01198" name="l01198"></a><span class="lineno"> 1198</span>             || (code == block_cpu_usage_exceeded::code_value)</div>
<div class="line"><a id="l01199" name="l01199"></a><span class="lineno"> 1199</span>             || (code == greylist_cpu_usage_exceeded::code_value)</div>
<div class="line"><a id="l01200" name="l01200"></a><span class="lineno"> 1200</span>             || (code == deadline_exception::code_value)</div>
<div class="line"><a id="l01201" name="l01201"></a><span class="lineno"> 1201</span>             || (code == leeway_deadline_exception::code_value)</div>
<div class="line"><a id="l01202" name="l01202"></a><span class="lineno"> 1202</span>             || (code == actor_whitelist_exception::code_value)</div>
<div class="line"><a id="l01203" name="l01203"></a><span class="lineno"> 1203</span>             || (code == actor_blacklist_exception::code_value)</div>
<div class="line"><a id="l01204" name="l01204"></a><span class="lineno"> 1204</span>             || (code == contract_whitelist_exception::code_value)</div>
<div class="line"><a id="l01205" name="l01205"></a><span class="lineno"> 1205</span>             || (code == contract_blacklist_exception::code_value)</div>
<div class="line"><a id="l01206" name="l01206"></a><span class="lineno"> 1206</span>             || (code == action_blacklist_exception::code_value)</div>
<div class="line"><a id="l01207" name="l01207"></a><span class="lineno"> 1207</span>             || (code == key_blacklist_exception::code_value)</div>
<div class="line"><a id="l01208" name="l01208"></a><span class="lineno"> 1208</span>             || (code == sig_variable_size_limit_exception::code_value)</div>
<div class="line"><a id="l01209" name="l01209"></a><span class="lineno"> 1209</span>             || (code == inline_action_too_big_nonprivileged::code_value);</div>
<div class="line"><a id="l01210" name="l01210"></a><span class="lineno"> 1210</span>   }</div>
</div>
<div class="line"><a id="l01211" name="l01211"></a><span class="lineno"> 1211</span> </div>
<div class="foldopen" id="foldopen01212" data-start="{" data-end="}">
<div class="line"><a id="l01212" name="l01212"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#ab9468e19953b5bb9ace497c98ee4ecc1"> 1212</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#ab9468e19953b5bb9ace497c98ee4ecc1">scheduled_failure_is_subjective</a>( <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1exception.html">fc::exception</a>&amp; e )<span class="keyword"> const </span>{</div>
<div class="line"><a id="l01213" name="l01213"></a><span class="lineno"> 1213</span>      <span class="keyword">auto</span> code = e.<a class="code hl_function" href="classfc_1_1exception.html#a79a36225cde10dcd23057bbe19d3390f">code</a>();</div>
<div class="line"><a id="l01214" name="l01214"></a><span class="lineno"> 1214</span>      <span class="keywordflow">return</span>    (code == tx_cpu_usage_exceeded::code_value)</div>
<div class="line"><a id="l01215" name="l01215"></a><span class="lineno"> 1215</span>             || <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#ad0d5a921dd01458d1464f63b0f0121c6">failure_is_subjective</a>(e);</div>
<div class="line"><a id="l01216" name="l01216"></a><span class="lineno"> 1216</span>   }</div>
</div>
<div class="line"><a id="l01217" name="l01217"></a><span class="lineno"> 1217</span> </div>
<div class="foldopen" id="foldopen01218" data-start="{" data-end="}">
<div class="line"><a id="l01218" name="l01218"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#a148db3e15c5b5a5cd3fd6b42799d1152"> 1218</a></span>   <a class="code hl_typedef" href="namespacesysio_1_1chain.html#a4ee2867a6bec961c7a78b203cfd76be9">transaction_trace_ptr</a> <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a148db3e15c5b5a5cd3fd6b42799d1152">push_scheduled_transaction</a>( <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1sha256.html">transaction_id_type</a>&amp; trxid,</div>
<div class="line"><a id="l01219" name="l01219"></a><span class="lineno"> 1219</span>                                                     <a class="code hl_class" href="classfc_1_1time__point.html">fc::time_point</a> block_deadline, <a class="code hl_class" href="classfc_1_1microseconds.html">fc::microseconds</a> max_transaction_time,</div>
<div class="line"><a id="l01220" name="l01220"></a><span class="lineno"> 1220</span>                                                     <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> billed_cpu_time_us, <span class="keywordtype">bool</span> explicit_billed_cpu_time = <span class="keyword">false</span> )</div>
<div class="line"><a id="l01221" name="l01221"></a><span class="lineno"> 1221</span>   {</div>
<div class="line"><a id="l01222" name="l01222"></a><span class="lineno"> 1222</span>      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; idx = <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>.<a class="code hl_function" href="classchainbase_1_1database.html#a4d5297635dcf70be481d9b600da9bc13">get_index</a>&lt;<a class="code hl_typedef" href="namespacesysio_1_1chain.html#a9e9842ee49526c2423e014a696edc602">generated_transaction_multi_index</a>,by_trx_id&gt;();</div>
<div class="line"><a id="l01223" name="l01223"></a><span class="lineno"> 1223</span>      <span class="keyword">auto</span> itr = idx.find( trxid );</div>
<div class="line"><a id="l01224" name="l01224"></a><span class="lineno"> 1224</span>      <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( itr != idx.end(), unknown_transaction_exception, <span class="stringliteral">&quot;unknown transaction&quot;</span> );</div>
<div class="line"><a id="l01225" name="l01225"></a><span class="lineno"> 1225</span>      <span class="keywordflow">return</span> <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a148db3e15c5b5a5cd3fd6b42799d1152">push_scheduled_transaction</a>( *itr, block_deadline, max_transaction_time, billed_cpu_time_us, explicit_billed_cpu_time );</div>
<div class="line"><a id="l01226" name="l01226"></a><span class="lineno"> 1226</span>   }</div>
</div>
<div class="line"><a id="l01227" name="l01227"></a><span class="lineno"> 1227</span> </div>
<div class="foldopen" id="foldopen01228" data-start="{" data-end="}">
<div class="line"><a id="l01228" name="l01228"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#a43b89d301b09c599969412d7db819bd3"> 1228</a></span>   <a class="code hl_typedef" href="namespacesysio_1_1chain.html#a4ee2867a6bec961c7a78b203cfd76be9">transaction_trace_ptr</a> <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a43b89d301b09c599969412d7db819bd3">push_scheduled_transaction</a>( <span class="keyword">const</span> <a class="code hl_class" href="classsysio_1_1chain_1_1generated__transaction__object.html">generated_transaction_object</a>&amp; gto,</div>
<div class="line"><a id="l01229" name="l01229"></a><span class="lineno"> 1229</span>                                                     <a class="code hl_class" href="classfc_1_1time__point.html">fc::time_point</a> block_deadline, <a class="code hl_class" href="classfc_1_1microseconds.html">fc::microseconds</a> max_transaction_time,</div>
<div class="line"><a id="l01230" name="l01230"></a><span class="lineno"> 1230</span>                                                     <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> billed_cpu_time_us, <span class="keywordtype">bool</span> explicit_billed_cpu_time = <span class="keyword">false</span> )</div>
<div class="line"><a id="l01231" name="l01231"></a><span class="lineno"> 1231</span>   { <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l01232" name="l01232"></a><span class="lineno"> 1232</span> </div>
<div class="line"><a id="l01233" name="l01233"></a><span class="lineno"> 1233</span>      <span class="keyword">const</span> <span class="keywordtype">bool</span> validating = !<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a64851fb4e041dc49ab22cf2ba335720d">self</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a0fcc85a590581560765686050fe105a8">is_producing_block</a>();</div>
<div class="line"><a id="l01234" name="l01234"></a><span class="lineno"> 1234</span>      <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( !validating || explicit_billed_cpu_time, <a class="code hl_variable" href="namespacesysio_1_1chain.html#a5dfe17906469eaf079c180c1afb4ad94">transaction_exception</a>, <span class="stringliteral">&quot;validating requires explicit billing&quot;</span> );</div>
<div class="line"><a id="l01235" name="l01235"></a><span class="lineno"> 1235</span> </div>
<div class="line"><a id="l01236" name="l01236"></a><span class="lineno"> 1236</span>      <a class="code hl_class" href="classsysio_1_1chain_1_1maybe__session.html">maybe_session</a> undo_session;</div>
<div class="line"><a id="l01237" name="l01237"></a><span class="lineno"> 1237</span>      <span class="keywordflow">if</span> ( !<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a64851fb4e041dc49ab22cf2ba335720d">self</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#ac8eea0639eeef0fc0d304f645b80d884">skip_db_sessions</a>() )</div>
<div class="line"><a id="l01238" name="l01238"></a><span class="lineno"> 1238</span>         undo_session = <a class="code hl_class" href="classsysio_1_1chain_1_1maybe__session.html">maybe_session</a>(<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>);</div>
<div class="line"><a id="l01239" name="l01239"></a><span class="lineno"> 1239</span> </div>
<div class="line"><a id="l01240" name="l01240"></a><span class="lineno"> 1240</span>      <span class="keyword">auto</span> gtrx = <a class="code hl_class" href="classsysio_1_1chain_1_1generated__transaction.html">generated_transaction</a>(gto);</div>
<div class="line"><a id="l01241" name="l01241"></a><span class="lineno"> 1241</span> </div>
<div class="line"><a id="l01242" name="l01242"></a><span class="lineno"> 1242</span>      <span class="comment">// remove the generated transaction object after making a copy</span></div>
<div class="line"><a id="l01243" name="l01243"></a><span class="lineno"> 1243</span>      <span class="comment">// this will ensure that anything which affects the GTO multi-index-container will not invalidate</span></div>
<div class="line"><a id="l01244" name="l01244"></a><span class="lineno"> 1244</span>      <span class="comment">// data we need to successfully retire this transaction.</span></div>
<div class="line"><a id="l01245" name="l01245"></a><span class="lineno"> 1245</span>      <span class="comment">//</span></div>
<div class="line"><a id="l01246" name="l01246"></a><span class="lineno"> 1246</span>      <span class="comment">// IF the transaction FAILs in a subjective way, `undo_session` should expire without being squashed</span></div>
<div class="line"><a id="l01247" name="l01247"></a><span class="lineno"> 1247</span>      <span class="comment">// resulting in the GTO being restored and available for a future block to retire.</span></div>
<div class="line"><a id="l01248" name="l01248"></a><span class="lineno"> 1248</span>      <a class="code hl_typedef" href="stdint_8h.html#a414156feea104f8f75b4ed9e3121b2f6">int64_t</a> trx_removal_ram_delta = <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a1dac6da3cb5899f6bcd62b9012c75e43">remove_scheduled_transaction</a>(gto);</div>
<div class="line"><a id="l01249" name="l01249"></a><span class="lineno"> 1249</span> </div>
<div class="line"><a id="l01250" name="l01250"></a><span class="lineno"> 1250</span>      <a class="code hl_class" href="classfc_1_1datastream.html">fc::datastream&lt;const char*&gt;</a> ds( gtrx.packed_trx.data(), gtrx.packed_trx.size() );</div>
<div class="line"><a id="l01251" name="l01251"></a><span class="lineno"> 1251</span> </div>
<div class="line"><a id="l01252" name="l01252"></a><span class="lineno"> 1252</span>      <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( gtrx.delay_until &lt;= <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a64851fb4e041dc49ab22cf2ba335720d">self</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#abb1d81f96986df3bce46bd37caaf6a69">pending_block_time</a>(), <a class="code hl_variable" href="namespacesysio_1_1chain.html#a5dfe17906469eaf079c180c1afb4ad94">transaction_exception</a>, <span class="stringliteral">&quot;this transaction isn&#39;t ready&quot;</span>,</div>
<div class="line"><a id="l01253" name="l01253"></a><span class="lineno"> 1253</span>                 (<span class="stringliteral">&quot;gtrx.delay_until&quot;</span>,gtrx.delay_until)(<span class="stringliteral">&quot;pbt&quot;</span>,<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a64851fb4e041dc49ab22cf2ba335720d">self</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#abb1d81f96986df3bce46bd37caaf6a69">pending_block_time</a>())          );</div>
<div class="line"><a id="l01254" name="l01254"></a><span class="lineno"> 1254</span> </div>
<div class="line"><a id="l01255" name="l01255"></a><span class="lineno"> 1255</span>      <a class="code hl_struct" href="structsysio_1_1chain_1_1signed__transaction.html">signed_transaction</a> dtrx;</div>
<div class="line"><a id="l01256" name="l01256"></a><span class="lineno"> 1256</span>      <a class="code hl_function" href="namespacefc_1_1raw.html#a0b442d98ceb22dd5a6ae84745e43ffab">fc::raw::unpack</a>(ds,<span class="keyword">static_cast&lt;</span><a class="code hl_struct" href="structsysio_1_1chain_1_1transaction.html">transaction</a>&amp;<span class="keyword">&gt;</span>(dtrx) );</div>
<div class="line"><a id="l01257" name="l01257"></a><span class="lineno"> 1257</span>      <a class="code hl_typedef" href="namespacesysio_1_1chain.html#ad795329e0af850251f4f47cc32e8d770">transaction_metadata_ptr</a> trx =</div>
<div class="line"><a id="l01258" name="l01258"></a><span class="lineno"> 1258</span>            <a class="code hl_function" href="classsysio_1_1chain_1_1transaction__metadata.html#acb14de2d02033c2d43c65319825d3d5b">transaction_metadata::create_no_recover_keys</a>( std::make_shared&lt;packed_transaction&gt;( std::move(dtrx)  ),</div>
<div class="line"><a id="l01259" name="l01259"></a><span class="lineno"> 1259</span>                                                          <a class="code hl_enumvalue" href="classsysio_1_1chain_1_1transaction__metadata.html#a841053d8fa06ceea3cb8096625f053eda638a6d925c422c868b28b9562498ea1d">transaction_metadata::trx_type::scheduled</a> );</div>
<div class="line"><a id="l01260" name="l01260"></a><span class="lineno"> 1260</span>      trx-&gt;accepted = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01261" name="l01261"></a><span class="lineno"> 1261</span> </div>
<div class="line"><a id="l01262" name="l01262"></a><span class="lineno"> 1262</span>      <a class="code hl_typedef" href="namespacesysio_1_1chain.html#a4ee2867a6bec961c7a78b203cfd76be9">transaction_trace_ptr</a> trace;</div>
<div class="line"><a id="l01263" name="l01263"></a><span class="lineno"> 1263</span>      <span class="keywordflow">if</span>( gtrx.expiration &lt; <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a64851fb4e041dc49ab22cf2ba335720d">self</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#abb1d81f96986df3bce46bd37caaf6a69">pending_block_time</a>() ) {</div>
<div class="line"><a id="l01264" name="l01264"></a><span class="lineno"> 1264</span>         trace = std::make_shared&lt;transaction_trace&gt;();</div>
<div class="line"><a id="l01265" name="l01265"></a><span class="lineno"> 1265</span>         trace-&gt;id = gtrx.trx_id;</div>
<div class="line"><a id="l01266" name="l01266"></a><span class="lineno"> 1266</span>         trace-&gt;block_num = <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a64851fb4e041dc49ab22cf2ba335720d">self</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a33704b4936bb9bbd2ea6b0874ca521b4">head_block_num</a>() + 1;</div>
<div class="line"><a id="l01267" name="l01267"></a><span class="lineno"> 1267</span>         trace-&gt;block_time = <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a64851fb4e041dc49ab22cf2ba335720d">self</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#abb1d81f96986df3bce46bd37caaf6a69">pending_block_time</a>();</div>
<div class="line"><a id="l01268" name="l01268"></a><span class="lineno"> 1268</span>         trace-&gt;producer_block_id = <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a64851fb4e041dc49ab22cf2ba335720d">self</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a8ad92bdf81057887fdc4b732cb864bc4">pending_producer_block_id</a>();</div>
<div class="line"><a id="l01269" name="l01269"></a><span class="lineno"> 1269</span>         trace-&gt;scheduled = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01270" name="l01270"></a><span class="lineno"> 1270</span>         trace-&gt;receipt = <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#aae2b1bfeee1e7c1c0237f12776e75dd7">push_receipt</a>( gtrx.trx_id, <a class="code hl_enumvalue" href="structsysio_1_1chain_1_1transaction__receipt__header.html#a2bb00bac16048e6f624c2ded867ebf55ac9a3d403c49bf068d1f8f07e20df72b5">transaction_receipt::expired</a>, billed_cpu_time_us, 0 ); <span class="comment">// expire the transaction</span></div>
<div class="line"><a id="l01271" name="l01271"></a><span class="lineno"> 1271</span>         trace-&gt;account_ram_delta = <a class="code hl_struct" href="structsysio_1_1chain_1_1account__delta.html">account_delta</a>( gtrx.payer, trx_removal_ram_delta );</div>
<div class="line"><a id="l01272" name="l01272"></a><span class="lineno"> 1272</span>         <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a6380e434da95a328ff48ccab33df9cb0">emit</a>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a64851fb4e041dc49ab22cf2ba335720d">self</a>.<a class="code hl_variable" href="classsysio_1_1chain_1_1controller.html#a063e3e3149bf8b88460900cef4b4571b">accepted_transaction</a>, trx );</div>
<div class="line"><a id="l01273" name="l01273"></a><span class="lineno"> 1273</span>         <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a8cdd409341efde24915eadc5f25a51f9">dmlog_applied_transaction</a>(trace);</div>
<div class="line"><a id="l01274" name="l01274"></a><span class="lineno"> 1274</span>         <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a6380e434da95a328ff48ccab33df9cb0">emit</a>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a64851fb4e041dc49ab22cf2ba335720d">self</a>.<a class="code hl_variable" href="classsysio_1_1chain_1_1controller.html#ac5fbe5586943483c7d167bc0088098b1">applied_transaction</a>, std::tie(trace, trx-&gt;packed_trx()) );</div>
<div class="line"><a id="l01275" name="l01275"></a><span class="lineno"> 1275</span>         undo_session.<a class="code hl_function" href="classsysio_1_1chain_1_1maybe__session.html#a1e5c5b89d2b1fac7f982ede7f0b1b545">squash</a>();</div>
<div class="line"><a id="l01276" name="l01276"></a><span class="lineno"> 1276</span>         <span class="keywordflow">return</span> trace;</div>
<div class="line"><a id="l01277" name="l01277"></a><span class="lineno"> 1277</span>      }</div>
<div class="line"><a id="l01278" name="l01278"></a><span class="lineno"> 1278</span> </div>
<div class="line"><a id="l01279" name="l01279"></a><span class="lineno"> 1279</span>      <span class="keyword">auto</span> reset_in_trx_requiring_checks = <a class="code hl_function" href="namespacefc.html#a23d89b54a8ffd84f7e7efeb21747d846">fc::make_scoped_exit</a>([old_value=<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#ab02dbb970f5b16869e123b77eb090e9b">in_trx_requiring_checks</a>,<span class="keyword">this</span>](){</div>
<div class="line"><a id="l01280" name="l01280"></a><span class="lineno"> 1280</span>         <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#ab02dbb970f5b16869e123b77eb090e9b">in_trx_requiring_checks</a> = old_value;</div>
<div class="line"><a id="l01281" name="l01281"></a><span class="lineno"> 1281</span>      });</div>
<div class="line"><a id="l01282" name="l01282"></a><span class="lineno"> 1282</span>      <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#ab02dbb970f5b16869e123b77eb090e9b">in_trx_requiring_checks</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01283" name="l01283"></a><span class="lineno"> 1283</span> </div>
<div class="line"><a id="l01284" name="l01284"></a><span class="lineno"> 1284</span>      <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> cpu_time_to_bill_us = billed_cpu_time_us;</div>
<div class="line"><a id="l01285" name="l01285"></a><span class="lineno"> 1285</span> </div>
<div class="line"><a id="l01286" name="l01286"></a><span class="lineno"> 1286</span>      <a class="code hl_struct" href="structsysio_1_1chain_1_1transaction__checktime__timer.html">transaction_checktime_timer</a> trx_timer(<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#ad3c19aea29c2fbb28ca7120d591ba088">timer</a>);</div>
<div class="line"><a id="l01287" name="l01287"></a><span class="lineno"> 1287</span>      <a class="code hl_class" href="classsysio_1_1chain_1_1transaction__context.html">transaction_context</a> trx_context( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a64851fb4e041dc49ab22cf2ba335720d">self</a>, *trx-&gt;packed_trx(), std::move(trx_timer) );</div>
<div class="line"><a id="l01288" name="l01288"></a><span class="lineno"> 1288</span>      trx_context.<a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a1fafa59ca3817a6fc89466a7da19b72c">leeway</a> =  <a class="code hl_class" href="classfc_1_1microseconds.html">fc::microseconds</a>(0); <span class="comment">// avoid stealing cpu resource</span></div>
<div class="line"><a id="l01289" name="l01289"></a><span class="lineno"> 1289</span>      trx_context.<a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a708229aea669816e99b0039d716c3ed5">block_deadline</a> = block_deadline;</div>
<div class="line"><a id="l01290" name="l01290"></a><span class="lineno"> 1290</span>      trx_context.max_transaction_time_subjective = max_transaction_time;</div>
<div class="line"><a id="l01291" name="l01291"></a><span class="lineno"> 1291</span>      trx_context.<a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a05dbab6e9e0d4f3e30fa1392ac4430a1">explicit_billed_cpu_time</a> = explicit_billed_cpu_time;</div>
<div class="line"><a id="l01292" name="l01292"></a><span class="lineno"> 1292</span>      trx_context.<a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a08b550fccea696363035c6736c146436">billed_cpu_time_us</a> = billed_cpu_time_us;</div>
<div class="line"><a id="l01293" name="l01293"></a><span class="lineno"> 1293</span>      trx_context.<a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a799e9208ec6d2ea3d1dfccfd4eb97cec">enforce_whiteblacklist</a> = gtrx.sender.empty() ? true : !<a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#aea41b3020ee2994f7a15980fcbf9b735">sender_avoids_whitelist_blacklist_enforcement</a>( gtrx.sender );</div>
<div class="line"><a id="l01294" name="l01294"></a><span class="lineno"> 1294</span>      trace = trx_context.<a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a7211fab425e4375e247c2a3d1924e63f">trace</a>;</div>
<div class="line"><a id="l01295" name="l01295"></a><span class="lineno"> 1295</span> </div>
<div class="line"><a id="l01296" name="l01296"></a><span class="lineno"> 1296</span>      <span class="keyword">auto</span> handle_exception = [&amp;](<span class="keyword">const</span> <span class="keyword">auto</span>&amp; e)</div>
<div class="line"><a id="l01297" name="l01297"></a><span class="lineno"> 1297</span>      {</div>
<div class="line"><a id="l01298" name="l01298"></a><span class="lineno"> 1298</span>         cpu_time_to_bill_us = trx_context.<a class="code hl_function" href="classsysio_1_1chain_1_1transaction__context.html#a2f8dc57cb2e3562de132326b0d06e15d">update_billed_cpu_time</a>( <a class="code hl_function" href="classfc_1_1time__point.html#aa164ff1268a16d4b32afcff181f6100e">fc::time_point::now</a>() );</div>
<div class="line"><a id="l01299" name="l01299"></a><span class="lineno"> 1299</span>         trace-&gt;error_code = <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#ae60743ce36f1fa0912ff26b1da40afe6">controller::convert_exception_to_error_code</a>( e );</div>
<div class="line"><a id="l01300" name="l01300"></a><span class="lineno"> 1300</span>         trace-&gt;except = e;</div>
<div class="line"><a id="l01301" name="l01301"></a><span class="lineno"> 1301</span>         trace-&gt;except_ptr = std::current_exception();</div>
<div class="line"><a id="l01302" name="l01302"></a><span class="lineno"> 1302</span>         trace-&gt;elapsed = <a class="code hl_function" href="classfc_1_1time__point.html#aa164ff1268a16d4b32afcff181f6100e">fc::time_point::now</a>() - trx_context.<a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a9c12181bd0bd8a5aea0200c80e7b00e7">start</a>;</div>
<div class="line"><a id="l01303" name="l01303"></a><span class="lineno"> 1303</span> </div>
<div class="line"><a id="l01304" name="l01304"></a><span class="lineno"> 1304</span>         <span class="keywordflow">if</span> (<span class="keyword">auto</span> dm_logger = <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a1b67831f3be3a668c170723427236954">get_deep_mind_logger</a>()) {</div>
<div class="line"><a id="l01305" name="l01305"></a><span class="lineno"> 1305</span>            dm_logger-&gt;on_fail_deferred();</div>
<div class="line"><a id="l01306" name="l01306"></a><span class="lineno"> 1306</span>         }</div>
<div class="line"><a id="l01307" name="l01307"></a><span class="lineno"> 1307</span>      };</div>
<div class="line"><a id="l01308" name="l01308"></a><span class="lineno"> 1308</span> </div>
<div class="line"><a id="l01309" name="l01309"></a><span class="lineno"> 1309</span>      <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l01310" name="l01310"></a><span class="lineno"> 1310</span>         trx_context.<a class="code hl_function" href="classsysio_1_1chain_1_1transaction__context.html#a03f76febe2160f0f23a5f60dae262184">init_for_deferred_trx</a>( gtrx.published );</div>
<div class="line"><a id="l01311" name="l01311"></a><span class="lineno"> 1311</span> </div>
<div class="line"><a id="l01312" name="l01312"></a><span class="lineno"> 1312</span>         <span class="keywordflow">if</span>( trx_context.<a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a799e9208ec6d2ea3d1dfccfd4eb97cec">enforce_whiteblacklist</a> &amp;&amp; <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a0e355919fd924a05344ef2b59f7dd587">pending</a>-&gt;_block_status == <a class="code hl_enumvalue" href="classsysio_1_1chain_1_1controller.html#a8b5124e077de1a73bb193e9c72b366b6a5ed4e9858ad8d239145ef285b6210a00">controller::block_status::incomplete</a> ) {</div>
<div class="line"><a id="l01313" name="l01313"></a><span class="lineno"> 1313</span>            flat_set&lt;account_name&gt; actors;</div>
<div class="line"><a id="l01314" name="l01314"></a><span class="lineno"> 1314</span>            <span class="keywordflow">for</span>( <span class="keyword">const</span> <span class="keyword">auto</span>&amp; act : trx-&gt;packed_trx()-&gt;get_transaction().actions ) {</div>
<div class="line"><a id="l01315" name="l01315"></a><span class="lineno"> 1315</span>               <span class="keywordflow">for</span>( <span class="keyword">const</span> <span class="keyword">auto</span>&amp; auth : act.authorization ) {</div>
<div class="line"><a id="l01316" name="l01316"></a><span class="lineno"> 1316</span>                  actors.insert( auth.actor );</div>
<div class="line"><a id="l01317" name="l01317"></a><span class="lineno"> 1317</span>               }</div>
<div class="line"><a id="l01318" name="l01318"></a><span class="lineno"> 1318</span>            }</div>
<div class="line"><a id="l01319" name="l01319"></a><span class="lineno"> 1319</span>            <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#ac79d2ab18d201291e9fbd0b38044e1f1">check_actor_list</a>( actors );</div>
<div class="line"><a id="l01320" name="l01320"></a><span class="lineno"> 1320</span>         }</div>
<div class="line"><a id="l01321" name="l01321"></a><span class="lineno"> 1321</span> </div>
<div class="line"><a id="l01322" name="l01322"></a><span class="lineno"> 1322</span>         trx_context.<a class="code hl_function" href="classsysio_1_1chain_1_1transaction__context.html#a01f9fd71b2b5511311c8817a8b32c845">exec</a>();</div>
<div class="line"><a id="l01323" name="l01323"></a><span class="lineno"> 1323</span>         trx_context.<a class="code hl_function" href="classsysio_1_1chain_1_1transaction__context.html#a300b3d2c25e7de11562c579c41f43dda">finalize</a>(); <span class="comment">// Automatically rounds up network and CPU usage in trace and bills payers if successful</span></div>
<div class="line"><a id="l01324" name="l01324"></a><span class="lineno"> 1324</span> </div>
<div class="line"><a id="l01325" name="l01325"></a><span class="lineno"> 1325</span>         <span class="keyword">auto</span> restore = <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a89d9e83d4de2f7aec957e54dce4a76f5">make_block_restore_point</a>();</div>
<div class="line"><a id="l01326" name="l01326"></a><span class="lineno"> 1326</span> </div>
<div class="line"><a id="l01327" name="l01327"></a><span class="lineno"> 1327</span>         trace-&gt;receipt = <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#aae2b1bfeee1e7c1c0237f12776e75dd7">push_receipt</a>( gtrx.trx_id,</div>
<div class="line"><a id="l01328" name="l01328"></a><span class="lineno"> 1328</span>                                        <a class="code hl_enumvalue" href="structsysio_1_1chain_1_1transaction__receipt__header.html#a2bb00bac16048e6f624c2ded867ebf55a7a6de58f1f84063a5f85bbfb59b43608">transaction_receipt::executed</a>,</div>
<div class="line"><a id="l01329" name="l01329"></a><span class="lineno"> 1329</span>                                        trx_context.<a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a08b550fccea696363035c6736c146436">billed_cpu_time_us</a>,</div>
<div class="line"><a id="l01330" name="l01330"></a><span class="lineno"> 1330</span>                                        trace-&gt;net_usage );</div>
<div class="line"><a id="l01331" name="l01331"></a><span class="lineno"> 1331</span> </div>
<div class="line"><a id="l01332" name="l01332"></a><span class="lineno"> 1332</span>         <a class="code hl_function" href="namespacefc.html#a219f556e23004060631ffb2baaeaff02">fc::move_append</a>( std::get&lt;building_block&gt;(<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a0e355919fd924a05344ef2b59f7dd587">pending</a>-&gt;_block_stage)._action_receipt_digests,</div>
<div class="line"><a id="l01333" name="l01333"></a><span class="lineno"> 1333</span>                          std::move(trx_context.<a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#aa16627a2b31f924e998137ba14f22123">executed_action_receipt_digests</a>) );</div>
<div class="line"><a id="l01334" name="l01334"></a><span class="lineno"> 1334</span> </div>
<div class="line"><a id="l01335" name="l01335"></a><span class="lineno"> 1335</span>         trace-&gt;account_ram_delta = <a class="code hl_struct" href="structsysio_1_1chain_1_1account__delta.html">account_delta</a>( gtrx.payer, trx_removal_ram_delta );</div>
<div class="line"><a id="l01336" name="l01336"></a><span class="lineno"> 1336</span> </div>
<div class="line"><a id="l01337" name="l01337"></a><span class="lineno"> 1337</span>         <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a6380e434da95a328ff48ccab33df9cb0">emit</a>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a64851fb4e041dc49ab22cf2ba335720d">self</a>.<a class="code hl_variable" href="classsysio_1_1chain_1_1controller.html#a063e3e3149bf8b88460900cef4b4571b">accepted_transaction</a>, trx );</div>
<div class="line"><a id="l01338" name="l01338"></a><span class="lineno"> 1338</span>         <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a8cdd409341efde24915eadc5f25a51f9">dmlog_applied_transaction</a>(trace);</div>
<div class="line"><a id="l01339" name="l01339"></a><span class="lineno"> 1339</span>         <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a6380e434da95a328ff48ccab33df9cb0">emit</a>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a64851fb4e041dc49ab22cf2ba335720d">self</a>.<a class="code hl_variable" href="classsysio_1_1chain_1_1controller.html#ac5fbe5586943483c7d167bc0088098b1">applied_transaction</a>, std::tie(trace, trx-&gt;packed_trx()) );</div>
<div class="line"><a id="l01340" name="l01340"></a><span class="lineno"> 1340</span> </div>
<div class="line"><a id="l01341" name="l01341"></a><span class="lineno"> 1341</span>         trx_context.<a class="code hl_function" href="classsysio_1_1chain_1_1transaction__context.html#a558e8aff8e48deb61fae7407e10e8788">squash</a>();</div>
<div class="line"><a id="l01342" name="l01342"></a><span class="lineno"> 1342</span>         undo_session.<a class="code hl_function" href="classsysio_1_1chain_1_1maybe__session.html#a1e5c5b89d2b1fac7f982ede7f0b1b545">squash</a>();</div>
<div class="line"><a id="l01343" name="l01343"></a><span class="lineno"> 1343</span> </div>
<div class="line"><a id="l01344" name="l01344"></a><span class="lineno"> 1344</span>         restore.cancel();</div>
<div class="line"><a id="l01345" name="l01345"></a><span class="lineno"> 1345</span> </div>
<div class="line"><a id="l01346" name="l01346"></a><span class="lineno"> 1346</span>         <span class="keywordflow">return</span> trace;</div>
<div class="line"><a id="l01347" name="l01347"></a><span class="lineno"> 1347</span>      } <span class="keywordflow">catch</span>( <span class="keyword">const</span> disallowed_transaction_extensions_bad_block_exception&amp; ) {</div>
<div class="line"><a id="l01348" name="l01348"></a><span class="lineno"> 1348</span>         <span class="keywordflow">throw</span>;</div>
<div class="line"><a id="l01349" name="l01349"></a><span class="lineno"> 1349</span>      } <span class="keywordflow">catch</span>( <span class="keyword">const</span> protocol_feature_bad_block_exception&amp; ) {</div>
<div class="line"><a id="l01350" name="l01350"></a><span class="lineno"> 1350</span>         <span class="keywordflow">throw</span>;</div>
<div class="line"><a id="l01351" name="l01351"></a><span class="lineno"> 1351</span>      } <span class="keywordflow">catch</span> ( <span class="keyword">const</span> std::bad_alloc&amp; ) {</div>
<div class="line"><a id="l01352" name="l01352"></a><span class="lineno"> 1352</span>         <span class="keywordflow">throw</span>;</div>
<div class="line"><a id="l01353" name="l01353"></a><span class="lineno"> 1353</span>      } <span class="keywordflow">catch</span> ( <span class="keyword">const</span> boost::interprocess::bad_alloc&amp; ) {</div>
<div class="line"><a id="l01354" name="l01354"></a><span class="lineno"> 1354</span>         <span class="keywordflow">throw</span>;</div>
<div class="line"><a id="l01355" name="l01355"></a><span class="lineno"> 1355</span>      } <span class="keywordflow">catch</span>( <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1exception.html">fc::exception</a>&amp; e ) {</div>
<div class="line"><a id="l01356" name="l01356"></a><span class="lineno"> 1356</span>        handle_exception(e);</div>
<div class="line"><a id="l01357" name="l01357"></a><span class="lineno"> 1357</span>      } <span class="keywordflow">catch</span> ( <span class="keyword">const</span> std::exception&amp; e) {</div>
<div class="line"><a id="l01358" name="l01358"></a><span class="lineno"> 1358</span>        <span class="keyword">auto</span> wrapper = <a class="code hl_function" href="classfc_1_1std__exception__wrapper.html#ae5ad64f84b1d373f5b92031566284c7c">fc::std_exception_wrapper::from_current_exception</a>(e);</div>
<div class="line"><a id="l01359" name="l01359"></a><span class="lineno"> 1359</span>        handle_exception(wrapper);</div>
<div class="line"><a id="l01360" name="l01360"></a><span class="lineno"> 1360</span>      }</div>
<div class="line"><a id="l01361" name="l01361"></a><span class="lineno"> 1361</span> </div>
<div class="line"><a id="l01362" name="l01362"></a><span class="lineno"> 1362</span>      trx_context.<a class="code hl_function" href="classsysio_1_1chain_1_1transaction__context.html#a5631f6c990c61c078e0de6f0e53171be">undo</a>();</div>
<div class="line"><a id="l01363" name="l01363"></a><span class="lineno"> 1363</span> </div>
<div class="line"><a id="l01364" name="l01364"></a><span class="lineno"> 1364</span>      <span class="comment">// Only subjective OR soft OR hard failure logic below:</span></div>
<div class="line"><a id="l01365" name="l01365"></a><span class="lineno"> 1365</span> </div>
<div class="line"><a id="l01366" name="l01366"></a><span class="lineno"> 1366</span>      <span class="keywordflow">if</span>( gtrx.sender != <a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">account_name</a>() &amp;&amp; !(validating ? <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#ad0d5a921dd01458d1464f63b0f0121c6">failure_is_subjective</a>(*trace-&gt;except) : <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#ab9468e19953b5bb9ace497c98ee4ecc1">scheduled_failure_is_subjective</a>(*trace-&gt;except))) {</div>
<div class="line"><a id="l01367" name="l01367"></a><span class="lineno"> 1367</span>         <span class="comment">// Attempt error handling for the generated transaction.</span></div>
<div class="line"><a id="l01368" name="l01368"></a><span class="lineno"> 1368</span> </div>
<div class="line"><a id="l01369" name="l01369"></a><span class="lineno"> 1369</span>         <span class="keyword">auto</span> error_trace = <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#aa7c2a2da2eed15c5d55146b0ebd6646b">apply_onerror</a>( gtrx, block_deadline, max_transaction_time, trx_context.pseudo_start,</div>
<div class="line"><a id="l01370" name="l01370"></a><span class="lineno"> 1370</span>                                           cpu_time_to_bill_us, billed_cpu_time_us, explicit_billed_cpu_time,</div>
<div class="line"><a id="l01371" name="l01371"></a><span class="lineno"> 1371</span>                                           trx_context.<a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a799e9208ec6d2ea3d1dfccfd4eb97cec">enforce_whiteblacklist</a> );</div>
<div class="line"><a id="l01372" name="l01372"></a><span class="lineno"> 1372</span>         error_trace-&gt;failed_dtrx_trace = trace;</div>
<div class="line"><a id="l01373" name="l01373"></a><span class="lineno"> 1373</span>         trace = error_trace;</div>
<div class="line"><a id="l01374" name="l01374"></a><span class="lineno"> 1374</span>         <span class="keywordflow">if</span>( !trace-&gt;except_ptr ) {</div>
<div class="line"><a id="l01375" name="l01375"></a><span class="lineno"> 1375</span>            trace-&gt;account_ram_delta = <a class="code hl_struct" href="structsysio_1_1chain_1_1account__delta.html">account_delta</a>( gtrx.payer, trx_removal_ram_delta );</div>
<div class="line"><a id="l01376" name="l01376"></a><span class="lineno"> 1376</span>            <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a6380e434da95a328ff48ccab33df9cb0">emit</a>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a64851fb4e041dc49ab22cf2ba335720d">self</a>.<a class="code hl_variable" href="classsysio_1_1chain_1_1controller.html#a063e3e3149bf8b88460900cef4b4571b">accepted_transaction</a>, trx );</div>
<div class="line"><a id="l01377" name="l01377"></a><span class="lineno"> 1377</span>            <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a8cdd409341efde24915eadc5f25a51f9">dmlog_applied_transaction</a>(trace);</div>
<div class="line"><a id="l01378" name="l01378"></a><span class="lineno"> 1378</span>            <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a6380e434da95a328ff48ccab33df9cb0">emit</a>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a64851fb4e041dc49ab22cf2ba335720d">self</a>.<a class="code hl_variable" href="classsysio_1_1chain_1_1controller.html#ac5fbe5586943483c7d167bc0088098b1">applied_transaction</a>, std::tie(trace, trx-&gt;packed_trx()) );</div>
<div class="line"><a id="l01379" name="l01379"></a><span class="lineno"> 1379</span>            undo_session.<a class="code hl_function" href="classsysio_1_1chain_1_1maybe__session.html#a1e5c5b89d2b1fac7f982ede7f0b1b545">squash</a>();</div>
<div class="line"><a id="l01380" name="l01380"></a><span class="lineno"> 1380</span>            <span class="keywordflow">return</span> trace;</div>
<div class="line"><a id="l01381" name="l01381"></a><span class="lineno"> 1381</span>         }</div>
<div class="line"><a id="l01382" name="l01382"></a><span class="lineno"> 1382</span>         trace-&gt;elapsed = <a class="code hl_function" href="classfc_1_1time__point.html#aa164ff1268a16d4b32afcff181f6100e">fc::time_point::now</a>() - trx_context.<a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a9c12181bd0bd8a5aea0200c80e7b00e7">start</a>;</div>
<div class="line"><a id="l01383" name="l01383"></a><span class="lineno"> 1383</span>      }</div>
<div class="line"><a id="l01384" name="l01384"></a><span class="lineno"> 1384</span> </div>
<div class="line"><a id="l01385" name="l01385"></a><span class="lineno"> 1385</span>      <span class="comment">// Only subjective OR hard failure logic below:</span></div>
<div class="line"><a id="l01386" name="l01386"></a><span class="lineno"> 1386</span> </div>
<div class="line"><a id="l01387" name="l01387"></a><span class="lineno"> 1387</span>      <span class="comment">// subjectivity changes based on producing vs validating</span></div>
<div class="line"><a id="l01388" name="l01388"></a><span class="lineno"> 1388</span>      <span class="keywordtype">bool</span> subjective  = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01389" name="l01389"></a><span class="lineno"> 1389</span>      <span class="keywordflow">if</span> (validating) {</div>
<div class="line"><a id="l01390" name="l01390"></a><span class="lineno"> 1390</span>         subjective = <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#ad0d5a921dd01458d1464f63b0f0121c6">failure_is_subjective</a>(*trace-&gt;except);</div>
<div class="line"><a id="l01391" name="l01391"></a><span class="lineno"> 1391</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01392" name="l01392"></a><span class="lineno"> 1392</span>         subjective = <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#ab9468e19953b5bb9ace497c98ee4ecc1">scheduled_failure_is_subjective</a>(*trace-&gt;except);</div>
<div class="line"><a id="l01393" name="l01393"></a><span class="lineno"> 1393</span>      }</div>
<div class="line"><a id="l01394" name="l01394"></a><span class="lineno"> 1394</span> </div>
<div class="line"><a id="l01395" name="l01395"></a><span class="lineno"> 1395</span>      <span class="keywordflow">if</span> ( !subjective ) {</div>
<div class="line"><a id="l01396" name="l01396"></a><span class="lineno"> 1396</span>         <span class="comment">// hard failure logic</span></div>
<div class="line"><a id="l01397" name="l01397"></a><span class="lineno"> 1397</span> </div>
<div class="line"><a id="l01398" name="l01398"></a><span class="lineno"> 1398</span>         <span class="keywordflow">if</span>( !validating ) {</div>
<div class="line"><a id="l01399" name="l01399"></a><span class="lineno"> 1399</span>            <span class="keyword">auto</span>&amp; rl = <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a64851fb4e041dc49ab22cf2ba335720d">self</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#add2453cf4d0208ca9f277337c9a5ed7a">get_mutable_resource_limits_manager</a>();</div>
<div class="line"><a id="l01400" name="l01400"></a><span class="lineno"> 1400</span>            rl.<a class="code hl_function" href="classsysio_1_1chain_1_1resource__limits_1_1resource__limits__manager.html#aaa7345adbf341592a81c087c50655597">update_account_usage</a>( trx_context.<a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#ac178b3a7e2ef905025ae4e2f262422ff">bill_to_accounts</a>, <a class="code hl_class" href="classsysio_1_1chain_1_1block__timestamp.html">block_timestamp_type</a>(<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a64851fb4e041dc49ab22cf2ba335720d">self</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#abb1d81f96986df3bce46bd37caaf6a69">pending_block_time</a>()).<a class="code hl_variable" href="classsysio_1_1chain_1_1block__timestamp.html#a1bdb67323980085a2d4002d877b6c232">slot</a> );</div>
<div class="line"><a id="l01401" name="l01401"></a><span class="lineno"> 1401</span>            <a class="code hl_typedef" href="stdint_8h.html#a414156feea104f8f75b4ed9e3121b2f6">int64_t</a> account_cpu_limit = 0;</div>
<div class="line"><a id="l01402" name="l01402"></a><span class="lineno"> 1402</span>            std::tie( std::ignore, account_cpu_limit, std::ignore, std::ignore ) = trx_context.<a class="code hl_function" href="classsysio_1_1chain_1_1transaction__context.html#ad525fafe1ffad93dc767bf2b5b9ea0cc">max_bandwidth_billed_accounts_can_pay</a>( <span class="keyword">true</span> );</div>
<div class="line"><a id="l01403" name="l01403"></a><span class="lineno"> 1403</span> </div>
<div class="line"><a id="l01404" name="l01404"></a><span class="lineno"> 1404</span>            <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> limited_cpu_time_to_bill_us = <span class="keyword">static_cast&lt;</span><a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a><span class="keyword">&gt;</span>( std::min(</div>
<div class="line"><a id="l01405" name="l01405"></a><span class="lineno"> 1405</span>                  std::min( <span class="keyword">static_cast&lt;</span><a class="code hl_typedef" href="stdint_8h.html#a414156feea104f8f75b4ed9e3121b2f6">int64_t</a><span class="keyword">&gt;</span>(cpu_time_to_bill_us), account_cpu_limit ),</div>
<div class="line"><a id="l01406" name="l01406"></a><span class="lineno"> 1406</span>                  trx_context.initial_objective_duration_limit.<a class="code hl_function" href="classfc_1_1microseconds.html#a20fba59ec7e1f50c6b8f2c9443cc9b92">count</a>() ) );</div>
<div class="line"><a id="l01407" name="l01407"></a><span class="lineno"> 1407</span>            <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( !explicit_billed_cpu_time || (cpu_time_to_bill_us == limited_cpu_time_to_bill_us),</div>
<div class="line"><a id="l01408" name="l01408"></a><span class="lineno"> 1408</span>                        <a class="code hl_variable" href="namespacesysio_1_1chain.html#a5dfe17906469eaf079c180c1afb4ad94">transaction_exception</a>, <span class="stringliteral">&quot;cpu to bill ${cpu} != limited ${limit}&quot;</span>, (<span class="stringliteral">&quot;cpu&quot;</span>, cpu_time_to_bill_us)(<span class="stringliteral">&quot;limit&quot;</span>, limited_cpu_time_to_bill_us) );</div>
<div class="line"><a id="l01409" name="l01409"></a><span class="lineno"> 1409</span>            cpu_time_to_bill_us = limited_cpu_time_to_bill_us;</div>
<div class="line"><a id="l01410" name="l01410"></a><span class="lineno"> 1410</span>         }</div>
<div class="line"><a id="l01411" name="l01411"></a><span class="lineno"> 1411</span> </div>
<div class="line"><a id="l01412" name="l01412"></a><span class="lineno"> 1412</span>         <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a83a037a61ce8e07b39d2d38b0f54f8f7">resource_limits</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1resource__limits_1_1resource__limits__manager.html#ae6e413bd0a6e43b36deff7aacdd0bfd6">add_transaction_usage</a>( trx_context.<a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#ac178b3a7e2ef905025ae4e2f262422ff">bill_to_accounts</a>, cpu_time_to_bill_us, 0,</div>
<div class="line"><a id="l01413" name="l01413"></a><span class="lineno"> 1413</span>                                                <a class="code hl_class" href="classsysio_1_1chain_1_1block__timestamp.html">block_timestamp_type</a>(<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a64851fb4e041dc49ab22cf2ba335720d">self</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#abb1d81f96986df3bce46bd37caaf6a69">pending_block_time</a>()).<a class="code hl_variable" href="classsysio_1_1chain_1_1block__timestamp.html#a1bdb67323980085a2d4002d877b6c232">slot</a> ); <span class="comment">// Should never fail</span></div>
<div class="line"><a id="l01414" name="l01414"></a><span class="lineno"> 1414</span> </div>
<div class="line"><a id="l01415" name="l01415"></a><span class="lineno"> 1415</span>         trace-&gt;receipt = <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#aae2b1bfeee1e7c1c0237f12776e75dd7">push_receipt</a>(gtrx.trx_id, <a class="code hl_enumvalue" href="structsysio_1_1chain_1_1transaction__receipt__header.html#a2bb00bac16048e6f624c2ded867ebf55ac705728ca8b5f3a44d8026e14990c463">transaction_receipt::hard_fail</a>, cpu_time_to_bill_us, 0);</div>
<div class="line"><a id="l01416" name="l01416"></a><span class="lineno"> 1416</span>         trace-&gt;account_ram_delta = <a class="code hl_struct" href="structsysio_1_1chain_1_1account__delta.html">account_delta</a>( gtrx.payer, trx_removal_ram_delta );</div>
<div class="line"><a id="l01417" name="l01417"></a><span class="lineno"> 1417</span> </div>
<div class="line"><a id="l01418" name="l01418"></a><span class="lineno"> 1418</span>         <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a6380e434da95a328ff48ccab33df9cb0">emit</a>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a64851fb4e041dc49ab22cf2ba335720d">self</a>.<a class="code hl_variable" href="classsysio_1_1chain_1_1controller.html#a063e3e3149bf8b88460900cef4b4571b">accepted_transaction</a>, trx );</div>
<div class="line"><a id="l01419" name="l01419"></a><span class="lineno"> 1419</span>         <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a8cdd409341efde24915eadc5f25a51f9">dmlog_applied_transaction</a>(trace);</div>
<div class="line"><a id="l01420" name="l01420"></a><span class="lineno"> 1420</span>         <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a6380e434da95a328ff48ccab33df9cb0">emit</a>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a64851fb4e041dc49ab22cf2ba335720d">self</a>.<a class="code hl_variable" href="classsysio_1_1chain_1_1controller.html#ac5fbe5586943483c7d167bc0088098b1">applied_transaction</a>, std::tie(trace, trx-&gt;packed_trx()) );</div>
<div class="line"><a id="l01421" name="l01421"></a><span class="lineno"> 1421</span> </div>
<div class="line"><a id="l01422" name="l01422"></a><span class="lineno"> 1422</span>         undo_session.<a class="code hl_function" href="classsysio_1_1chain_1_1maybe__session.html#a1e5c5b89d2b1fac7f982ede7f0b1b545">squash</a>();</div>
<div class="line"><a id="l01423" name="l01423"></a><span class="lineno"> 1423</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01424" name="l01424"></a><span class="lineno"> 1424</span>         <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a6380e434da95a328ff48ccab33df9cb0">emit</a>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a64851fb4e041dc49ab22cf2ba335720d">self</a>.<a class="code hl_variable" href="classsysio_1_1chain_1_1controller.html#a063e3e3149bf8b88460900cef4b4571b">accepted_transaction</a>, trx );</div>
<div class="line"><a id="l01425" name="l01425"></a><span class="lineno"> 1425</span>         <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a8cdd409341efde24915eadc5f25a51f9">dmlog_applied_transaction</a>(trace);</div>
<div class="line"><a id="l01426" name="l01426"></a><span class="lineno"> 1426</span>         <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a6380e434da95a328ff48ccab33df9cb0">emit</a>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a64851fb4e041dc49ab22cf2ba335720d">self</a>.<a class="code hl_variable" href="classsysio_1_1chain_1_1controller.html#ac5fbe5586943483c7d167bc0088098b1">applied_transaction</a>, std::tie(trace, trx-&gt;packed_trx()) );</div>
<div class="line"><a id="l01427" name="l01427"></a><span class="lineno"> 1427</span>      }</div>
<div class="line"><a id="l01428" name="l01428"></a><span class="lineno"> 1428</span> </div>
<div class="line"><a id="l01429" name="l01429"></a><span class="lineno"> 1429</span>      <span class="keywordflow">return</span> trace;</div>
<div class="line"><a id="l01430" name="l01430"></a><span class="lineno"> 1430</span>   } <a class="code hl_define" href="exception_8hpp.html#a094902280cad82ad6529ebbd12a697eb">FC_CAPTURE_AND_RETHROW</a>() } </div>
</div>
<div class="line"><a id="l01431" name="l01431"></a><span class="lineno"> 1431</span> </div>
<div class="line"><a id="l01432" name="l01432"></a><span class="lineno"> 1432</span> </div>
<div class="line"><a id="l01436" name="l01436"></a><span class="lineno"> 1436</span>   <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</div>
<div class="foldopen" id="foldopen01437" data-start="{" data-end="}">
<div class="line"><a id="l01437" name="l01437"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#aae2b1bfeee1e7c1c0237f12776e75dd7"> 1437</a></span>   <span class="keyword">const</span> <a class="code hl_struct" href="structsysio_1_1chain_1_1transaction__receipt.html">transaction_receipt</a>&amp; <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#aae2b1bfeee1e7c1c0237f12776e75dd7">push_receipt</a>( <span class="keyword">const</span> <a class="code hl_define" href="prettywritertest_8cpp.html#a6283df8c4e365cc8a01727e2d7ad44bf">T</a>&amp; trx, <a class="code hl_enumeration" href="structsysio_1_1chain_1_1transaction__receipt__header.html#a2bb00bac16048e6f624c2ded867ebf55">transaction_receipt_header::status_enum</a> status,</div>
<div class="line"><a id="l01438" name="l01438"></a><span class="lineno"> 1438</span>                                            <a class="code hl_typedef" href="stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a> cpu_usage_us, <a class="code hl_typedef" href="stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a> net_usage ) {</div>
<div class="line"><a id="l01439" name="l01439"></a><span class="lineno"> 1439</span>      <a class="code hl_typedef" href="stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a> net_usage_words = net_usage / 8;</div>
<div class="line"><a id="l01440" name="l01440"></a><span class="lineno"> 1440</span>      <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( net_usage_words*8 == net_usage, <a class="code hl_variable" href="namespacesysio_1_1chain.html#a5dfe17906469eaf079c180c1afb4ad94">transaction_exception</a>, <span class="stringliteral">&quot;net_usage is not divisible by 8&quot;</span> );</div>
<div class="line"><a id="l01441" name="l01441"></a><span class="lineno"> 1441</span>      <span class="keyword">auto</span>&amp; receipts = std::get&lt;building_block&gt;(<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a0e355919fd924a05344ef2b59f7dd587">pending</a>-&gt;_block_stage)._pending_trx_receipts;</div>
<div class="line"><a id="l01442" name="l01442"></a><span class="lineno"> 1442</span>      receipts.emplace_back( trx );</div>
<div class="line"><a id="l01443" name="l01443"></a><span class="lineno"> 1443</span>      <a class="code hl_struct" href="structsysio_1_1chain_1_1transaction__receipt.html">transaction_receipt</a>&amp; <a class="code hl_variable" href="bn_8cpp.html#af0a5201ca8846f05f25435b41d7f39f7">r</a> = receipts.back();</div>
<div class="line"><a id="l01444" name="l01444"></a><span class="lineno"> 1444</span>      <a class="code hl_variable" href="bn_8cpp.html#af0a5201ca8846f05f25435b41d7f39f7">r</a>.cpu_usage_us         = cpu_usage_us;</div>
<div class="line"><a id="l01445" name="l01445"></a><span class="lineno"> 1445</span>      <a class="code hl_variable" href="bn_8cpp.html#af0a5201ca8846f05f25435b41d7f39f7">r</a>.net_usage_words      = net_usage_words;</div>
<div class="line"><a id="l01446" name="l01446"></a><span class="lineno"> 1446</span>      <a class="code hl_variable" href="bn_8cpp.html#af0a5201ca8846f05f25435b41d7f39f7">r</a>.status               = status;</div>
<div class="line"><a id="l01447" name="l01447"></a><span class="lineno"> 1447</span>      <span class="keywordflow">return</span> <a class="code hl_variable" href="bn_8cpp.html#af0a5201ca8846f05f25435b41d7f39f7">r</a>;</div>
<div class="line"><a id="l01448" name="l01448"></a><span class="lineno"> 1448</span>   }</div>
</div>
<div class="line"><a id="l01449" name="l01449"></a><span class="lineno"> 1449</span> </div>
<div class="foldopen" id="foldopen01455" data-start="{" data-end="}">
<div class="line"><a id="l01455" name="l01455"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#af381eb0fcede18ab0ae4cddaaa9df6cd"> 1455</a></span>   <a class="code hl_typedef" href="namespacesysio_1_1chain.html#a4ee2867a6bec961c7a78b203cfd76be9">transaction_trace_ptr</a> <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#af381eb0fcede18ab0ae4cddaaa9df6cd">push_transaction</a>( <span class="keyword">const</span> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#ad795329e0af850251f4f47cc32e8d770">transaction_metadata_ptr</a>&amp; trx,</div>
<div class="line"><a id="l01456" name="l01456"></a><span class="lineno"> 1456</span>                                           <a class="code hl_class" href="classfc_1_1time__point.html">fc::time_point</a> block_deadline,</div>
<div class="line"><a id="l01457" name="l01457"></a><span class="lineno"> 1457</span>                                           <a class="code hl_class" href="classfc_1_1microseconds.html">fc::microseconds</a> max_transaction_time,</div>
<div class="line"><a id="l01458" name="l01458"></a><span class="lineno"> 1458</span>                                           <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> billed_cpu_time_us,</div>
<div class="line"><a id="l01459" name="l01459"></a><span class="lineno"> 1459</span>                                           <span class="keywordtype">bool</span> explicit_billed_cpu_time,</div>
<div class="line"><a id="l01460" name="l01460"></a><span class="lineno"> 1460</span>                                           <a class="code hl_typedef" href="stdint_8h.html#a414156feea104f8f75b4ed9e3121b2f6">int64_t</a> subjective_cpu_bill_us )</div>
<div class="line"><a id="l01461" name="l01461"></a><span class="lineno"> 1461</span>   {</div>
<div class="line"><a id="l01462" name="l01462"></a><span class="lineno"> 1462</span>      <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>(block_deadline != <a class="code hl_class" href="classfc_1_1time__point.html">fc::time_point</a>(), <a class="code hl_variable" href="namespacesysio_1_1chain.html#a5dfe17906469eaf079c180c1afb4ad94">transaction_exception</a>, <span class="stringliteral">&quot;deadline cannot be uninitialized&quot;</span>);</div>
<div class="line"><a id="l01463" name="l01463"></a><span class="lineno"> 1463</span> </div>
<div class="line"><a id="l01464" name="l01464"></a><span class="lineno"> 1464</span>      <a class="code hl_typedef" href="namespacesysio_1_1chain.html#a4ee2867a6bec961c7a78b203cfd76be9">transaction_trace_ptr</a> trace;</div>
<div class="line"><a id="l01465" name="l01465"></a><span class="lineno"> 1465</span>      <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l01466" name="l01466"></a><span class="lineno"> 1466</span>         <span class="keyword">auto</span> start = <a class="code hl_function" href="classfc_1_1time__point.html#aa164ff1268a16d4b32afcff181f6100e">fc::time_point::now</a>();</div>
<div class="line"><a id="l01467" name="l01467"></a><span class="lineno"> 1467</span>         <span class="keyword">const</span> <span class="keywordtype">bool</span> check_auth = !<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a64851fb4e041dc49ab22cf2ba335720d">self</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a42a29a059b847799ae3a75953b6bff1e">skip_auth_check</a>() &amp;&amp; !trx-&gt;implicit;</div>
<div class="line"><a id="l01468" name="l01468"></a><span class="lineno"> 1468</span>         <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1microseconds.html">fc::microseconds</a> sig_cpu_usage = trx-&gt;signature_cpu_usage();</div>
<div class="line"><a id="l01469" name="l01469"></a><span class="lineno"> 1469</span> </div>
<div class="line"><a id="l01470" name="l01470"></a><span class="lineno"> 1470</span>         <span class="keywordflow">if</span>( !explicit_billed_cpu_time ) {</div>
<div class="line"><a id="l01471" name="l01471"></a><span class="lineno"> 1471</span>            <a class="code hl_class" href="classfc_1_1microseconds.html">fc::microseconds</a> already_consumed_time( <a class="code hl_function" href="chain_2include_2sysio_2chain_2config_8hpp.html#a0b4bacb63f31764f50a185f320551fbc">SYS_PERCENT</a>(sig_cpu_usage.<a class="code hl_function" href="classfc_1_1microseconds.html#a20fba59ec7e1f50c6b8f2c9443cc9b92">count</a>(), <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a048ac8e4d4436902a1888df13575b252">conf</a>.<a class="code hl_variable" href="structsysio_1_1chain_1_1controller_1_1config.html#a681e42f55477a7b01ba14c05a76e9b18">sig_cpu_bill_pct</a>) );</div>
<div class="line"><a id="l01472" name="l01472"></a><span class="lineno"> 1472</span> </div>
<div class="line"><a id="l01473" name="l01473"></a><span class="lineno"> 1473</span>            <span class="keywordflow">if</span>( start.time_since_epoch() &lt;  already_consumed_time ) {</div>
<div class="line"><a id="l01474" name="l01474"></a><span class="lineno"> 1474</span>               start = <a class="code hl_class" href="classfc_1_1time__point.html">fc::time_point</a>();</div>
<div class="line"><a id="l01475" name="l01475"></a><span class="lineno"> 1475</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01476" name="l01476"></a><span class="lineno"> 1476</span>               start -= already_consumed_time;</div>
<div class="line"><a id="l01477" name="l01477"></a><span class="lineno"> 1477</span>            }</div>
<div class="line"><a id="l01478" name="l01478"></a><span class="lineno"> 1478</span>         }</div>
<div class="line"><a id="l01479" name="l01479"></a><span class="lineno"> 1479</span> </div>
<div class="line"><a id="l01480" name="l01480"></a><span class="lineno"> 1480</span>         <span class="keyword">const</span> <a class="code hl_struct" href="structsysio_1_1chain_1_1signed__transaction.html">signed_transaction</a>&amp; trn = trx-&gt;packed_trx()-&gt;get_signed_transaction();</div>
<div class="line"><a id="l01481" name="l01481"></a><span class="lineno"> 1481</span>         <a class="code hl_struct" href="structsysio_1_1chain_1_1transaction__checktime__timer.html">transaction_checktime_timer</a> trx_timer(<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#ad3c19aea29c2fbb28ca7120d591ba088">timer</a>);</div>
<div class="line"><a id="l01482" name="l01482"></a><span class="lineno"> 1482</span>         <a class="code hl_class" href="classsysio_1_1chain_1_1transaction__context.html">transaction_context</a> trx_context(<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a64851fb4e041dc49ab22cf2ba335720d">self</a>, *trx-&gt;packed_trx(), std::move(trx_timer), start, trx-&gt;read_only);</div>
<div class="line"><a id="l01483" name="l01483"></a><span class="lineno"> 1483</span>         <span class="keywordflow">if</span> ((<span class="keywordtype">bool</span>)<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#ab952243b3b18aaec46cce82670687075">subjective_cpu_leeway</a> &amp;&amp; <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a0e355919fd924a05344ef2b59f7dd587">pending</a>-&gt;_block_status == <a class="code hl_enumvalue" href="classsysio_1_1chain_1_1controller.html#a8b5124e077de1a73bb193e9c72b366b6a5ed4e9858ad8d239145ef285b6210a00">controller::block_status::incomplete</a>) {</div>
<div class="line"><a id="l01484" name="l01484"></a><span class="lineno"> 1484</span>            trx_context.<a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a1fafa59ca3817a6fc89466a7da19b72c">leeway</a> = *<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#ab952243b3b18aaec46cce82670687075">subjective_cpu_leeway</a>;</div>
<div class="line"><a id="l01485" name="l01485"></a><span class="lineno"> 1485</span>         }</div>
<div class="line"><a id="l01486" name="l01486"></a><span class="lineno"> 1486</span>         trx_context.<a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a708229aea669816e99b0039d716c3ed5">block_deadline</a> = block_deadline;</div>
<div class="line"><a id="l01487" name="l01487"></a><span class="lineno"> 1487</span>         trx_context.max_transaction_time_subjective = max_transaction_time;</div>
<div class="line"><a id="l01488" name="l01488"></a><span class="lineno"> 1488</span>         trx_context.<a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a05dbab6e9e0d4f3e30fa1392ac4430a1">explicit_billed_cpu_time</a> = explicit_billed_cpu_time;</div>
<div class="line"><a id="l01489" name="l01489"></a><span class="lineno"> 1489</span>         trx_context.<a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a08b550fccea696363035c6736c146436">billed_cpu_time_us</a> = billed_cpu_time_us;</div>
<div class="line"><a id="l01490" name="l01490"></a><span class="lineno"> 1490</span>         trx_context.<a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#af80f48b601534a0adc286de6195e26a2">subjective_cpu_bill_us</a> = subjective_cpu_bill_us;</div>
<div class="line"><a id="l01491" name="l01491"></a><span class="lineno"> 1491</span>         trace = trx_context.<a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a7211fab425e4375e247c2a3d1924e63f">trace</a>;</div>
<div class="line"><a id="l01492" name="l01492"></a><span class="lineno"> 1492</span> </div>
<div class="line"><a id="l01493" name="l01493"></a><span class="lineno"> 1493</span>         <span class="keyword">auto</span> handle_exception =[&amp;](<span class="keyword">const</span> <span class="keyword">auto</span>&amp; e)</div>
<div class="line"><a id="l01494" name="l01494"></a><span class="lineno"> 1494</span>         {</div>
<div class="line"><a id="l01495" name="l01495"></a><span class="lineno"> 1495</span>            trace-&gt;error_code = <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#ae60743ce36f1fa0912ff26b1da40afe6">controller::convert_exception_to_error_code</a>( e );</div>
<div class="line"><a id="l01496" name="l01496"></a><span class="lineno"> 1496</span>            trace-&gt;except = e;</div>
<div class="line"><a id="l01497" name="l01497"></a><span class="lineno"> 1497</span>            trace-&gt;except_ptr = std::current_exception();</div>
<div class="line"><a id="l01498" name="l01498"></a><span class="lineno"> 1498</span>            trace-&gt;elapsed = <a class="code hl_function" href="classfc_1_1time__point.html#aa164ff1268a16d4b32afcff181f6100e">fc::time_point::now</a>() - trx_context.<a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a9c12181bd0bd8a5aea0200c80e7b00e7">start</a>;</div>
<div class="line"><a id="l01499" name="l01499"></a><span class="lineno"> 1499</span>         };</div>
<div class="line"><a id="l01500" name="l01500"></a><span class="lineno"> 1500</span> </div>
<div class="line"><a id="l01501" name="l01501"></a><span class="lineno"> 1501</span>         <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l01502" name="l01502"></a><span class="lineno"> 1502</span>            <span class="keywordflow">if</span>( trx-&gt;implicit ) {</div>
<div class="line"><a id="l01503" name="l01503"></a><span class="lineno"> 1503</span>               trx_context.<a class="code hl_function" href="classsysio_1_1chain_1_1transaction__context.html#a5d3d1260b6f77fdc4b6a8cef3417e94c">init_for_implicit_trx</a>();</div>
<div class="line"><a id="l01504" name="l01504"></a><span class="lineno"> 1504</span>               trx_context.<a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a799e9208ec6d2ea3d1dfccfd4eb97cec">enforce_whiteblacklist</a> = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01505" name="l01505"></a><span class="lineno"> 1505</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01506" name="l01506"></a><span class="lineno"> 1506</span>               trx_context.<a class="code hl_function" href="classsysio_1_1chain_1_1transaction__context.html#adbf0d6f8a8a8d3b4544fafe24cd0a135">init_for_input_trx</a>( trx-&gt;packed_trx()-&gt;get_unprunable_size(),</div>
<div class="line"><a id="l01507" name="l01507"></a><span class="lineno"> 1507</span>                                               trx-&gt;packed_trx()-&gt;get_prunable_size() );</div>
<div class="line"><a id="l01508" name="l01508"></a><span class="lineno"> 1508</span>            }</div>
<div class="line"><a id="l01509" name="l01509"></a><span class="lineno"> 1509</span> </div>
<div class="line"><a id="l01510" name="l01510"></a><span class="lineno"> 1510</span>            trx_context.<a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a73f4035fab7271fec7fcac5aa01bd461">delay</a> = <a class="code hl_function" href="namespacefc.html#a9623b8cae3f48bbed6aa1fc2afe9b174">fc::seconds</a>(trn.<a class="code hl_variable" href="structsysio_1_1chain_1_1transaction__header.html#a349b11695387e3dbe91f918ee759d4b4">delay_sec</a>);</div>
<div class="line"><a id="l01511" name="l01511"></a><span class="lineno"> 1511</span> </div>
<div class="line"><a id="l01512" name="l01512"></a><span class="lineno"> 1512</span>            <span class="keywordflow">if</span>( check_auth ) {</div>
<div class="line"><a id="l01513" name="l01513"></a><span class="lineno"> 1513</span>               <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#ab90d295ac18fa98f2520e4eade5b3773">authorization</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1authorization__manager.html#a8566f4407e33eb1e4029455e4feae2f1">check_authorization</a>(</div>
<div class="line"><a id="l01514" name="l01514"></a><span class="lineno"> 1514</span>                       trn.<a class="code hl_variable" href="structsysio_1_1chain_1_1transaction.html#a407fcf1868b81bb30b85f80d388bbac2">actions</a>,</div>
<div class="line"><a id="l01515" name="l01515"></a><span class="lineno"> 1515</span>                       trx-&gt;recovered_keys(),</div>
<div class="line"><a id="l01516" name="l01516"></a><span class="lineno"> 1516</span>                       {},</div>
<div class="line"><a id="l01517" name="l01517"></a><span class="lineno"> 1517</span>                       trx_context.<a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a73f4035fab7271fec7fcac5aa01bd461">delay</a>,</div>
<div class="line"><a id="l01518" name="l01518"></a><span class="lineno"> 1518</span>                       [&amp;trx_context](){ trx_context.checktime(); },</div>
<div class="line"><a id="l01519" name="l01519"></a><span class="lineno"> 1519</span>                       <span class="keyword">false</span>,</div>
<div class="line"><a id="l01520" name="l01520"></a><span class="lineno"> 1520</span>                       trx-&gt;read_only</div>
<div class="line"><a id="l01521" name="l01521"></a><span class="lineno"> 1521</span>               );</div>
<div class="line"><a id="l01522" name="l01522"></a><span class="lineno"> 1522</span>            }</div>
<div class="line"><a id="l01523" name="l01523"></a><span class="lineno"> 1523</span>            trx_context.<a class="code hl_function" href="classsysio_1_1chain_1_1transaction__context.html#a01f9fd71b2b5511311c8817a8b32c845">exec</a>();</div>
<div class="line"><a id="l01524" name="l01524"></a><span class="lineno"> 1524</span>            trx_context.<a class="code hl_function" href="classsysio_1_1chain_1_1transaction__context.html#a300b3d2c25e7de11562c579c41f43dda">finalize</a>(); <span class="comment">// Automatically rounds up network and CPU usage in trace and bills payers if successful</span></div>
<div class="line"><a id="l01525" name="l01525"></a><span class="lineno"> 1525</span> </div>
<div class="line"><a id="l01526" name="l01526"></a><span class="lineno"> 1526</span>            <span class="keyword">auto</span> restore = <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a89d9e83d4de2f7aec957e54dce4a76f5">make_block_restore_point</a>();</div>
<div class="line"><a id="l01527" name="l01527"></a><span class="lineno"> 1527</span> </div>
<div class="line"><a id="l01528" name="l01528"></a><span class="lineno"> 1528</span>            <span class="keywordflow">if</span> (!trx-&gt;implicit) {</div>
<div class="line"><a id="l01529" name="l01529"></a><span class="lineno"> 1529</span>               <a class="code hl_enumeration" href="structsysio_1_1chain_1_1transaction__receipt__header.html#a2bb00bac16048e6f624c2ded867ebf55">transaction_receipt::status_enum</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a> = (trx_context.<a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a73f4035fab7271fec7fcac5aa01bd461">delay</a> == <a class="code hl_function" href="namespacefc.html#a9623b8cae3f48bbed6aa1fc2afe9b174">fc::seconds</a>(0))</div>
<div class="line"><a id="l01530" name="l01530"></a><span class="lineno"> 1530</span>                                                    ? <a class="code hl_enumvalue" href="structsysio_1_1chain_1_1transaction__receipt__header.html#a2bb00bac16048e6f624c2ded867ebf55a7a6de58f1f84063a5f85bbfb59b43608">transaction_receipt::executed</a></div>
<div class="line"><a id="l01531" name="l01531"></a><span class="lineno"> 1531</span>                                                    : <a class="code hl_enumvalue" href="structsysio_1_1chain_1_1transaction__receipt__header.html#a2bb00bac16048e6f624c2ded867ebf55a6b6365bc9e75414c669484391aa7729d">transaction_receipt::delayed</a>;</div>
<div class="line"><a id="l01532" name="l01532"></a><span class="lineno"> 1532</span>               trace-&gt;receipt = <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#aae2b1bfeee1e7c1c0237f12776e75dd7">push_receipt</a>(*trx-&gt;packed_trx(), <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a>, trx_context.<a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a08b550fccea696363035c6736c146436">billed_cpu_time_us</a>, trace-&gt;net_usage);</div>
<div class="line"><a id="l01533" name="l01533"></a><span class="lineno"> 1533</span>               trx-&gt;billed_cpu_time_us = trx_context.<a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a08b550fccea696363035c6736c146436">billed_cpu_time_us</a>;</div>
<div class="line"><a id="l01534" name="l01534"></a><span class="lineno"> 1534</span>               std::get&lt;building_block&gt;(<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a0e355919fd924a05344ef2b59f7dd587">pending</a>-&gt;_block_stage)._pending_trx_metas.emplace_back(trx);</div>
<div class="line"><a id="l01535" name="l01535"></a><span class="lineno"> 1535</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01536" name="l01536"></a><span class="lineno"> 1536</span>               <a class="code hl_struct" href="structsysio_1_1chain_1_1transaction__receipt__header.html">transaction_receipt_header</a> <a class="code hl_variable" href="bn_8cpp.html#af0a5201ca8846f05f25435b41d7f39f7">r</a>;</div>
<div class="line"><a id="l01537" name="l01537"></a><span class="lineno"> 1537</span>               <a class="code hl_variable" href="bn_8cpp.html#af0a5201ca8846f05f25435b41d7f39f7">r</a>.status = <a class="code hl_enumvalue" href="structsysio_1_1chain_1_1transaction__receipt__header.html#a2bb00bac16048e6f624c2ded867ebf55a7a6de58f1f84063a5f85bbfb59b43608">transaction_receipt::executed</a>;</div>
<div class="line"><a id="l01538" name="l01538"></a><span class="lineno"> 1538</span>               <a class="code hl_variable" href="bn_8cpp.html#af0a5201ca8846f05f25435b41d7f39f7">r</a>.cpu_usage_us = trx_context.<a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#a08b550fccea696363035c6736c146436">billed_cpu_time_us</a>;</div>
<div class="line"><a id="l01539" name="l01539"></a><span class="lineno"> 1539</span>               <a class="code hl_variable" href="bn_8cpp.html#af0a5201ca8846f05f25435b41d7f39f7">r</a>.net_usage_words = trace-&gt;net_usage / 8;</div>
<div class="line"><a id="l01540" name="l01540"></a><span class="lineno"> 1540</span>               trace-&gt;receipt = <a class="code hl_variable" href="bn_8cpp.html#af0a5201ca8846f05f25435b41d7f39f7">r</a>;</div>
<div class="line"><a id="l01541" name="l01541"></a><span class="lineno"> 1541</span>            }</div>
<div class="line"><a id="l01542" name="l01542"></a><span class="lineno"> 1542</span> </div>
<div class="line"><a id="l01543" name="l01543"></a><span class="lineno"> 1543</span>            <a class="code hl_function" href="namespacefc.html#a219f556e23004060631ffb2baaeaff02">fc::move_append</a>( std::get&lt;building_block&gt;(<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a0e355919fd924a05344ef2b59f7dd587">pending</a>-&gt;_block_stage)._action_receipt_digests,</div>
<div class="line"><a id="l01544" name="l01544"></a><span class="lineno"> 1544</span>                             std::move(trx_context.<a class="code hl_variable" href="classsysio_1_1chain_1_1transaction__context.html#aa16627a2b31f924e998137ba14f22123">executed_action_receipt_digests</a>) );</div>
<div class="line"><a id="l01545" name="l01545"></a><span class="lineno"> 1545</span> </div>
<div class="line"><a id="l01546" name="l01546"></a><span class="lineno"> 1546</span>            <span class="comment">// call the accept signal but only once for this transaction</span></div>
<div class="line"><a id="l01547" name="l01547"></a><span class="lineno"> 1547</span>            <span class="keywordflow">if</span> (!trx-&gt;read_only) {</div>
<div class="line"><a id="l01548" name="l01548"></a><span class="lineno"> 1548</span>                <span class="keywordflow">if</span> (!trx-&gt;accepted) {</div>
<div class="line"><a id="l01549" name="l01549"></a><span class="lineno"> 1549</span>                    trx-&gt;accepted = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01550" name="l01550"></a><span class="lineno"> 1550</span>                    <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a6380e434da95a328ff48ccab33df9cb0">emit</a>(<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a64851fb4e041dc49ab22cf2ba335720d">self</a>.<a class="code hl_variable" href="classsysio_1_1chain_1_1controller.html#a063e3e3149bf8b88460900cef4b4571b">accepted_transaction</a>, trx);</div>
<div class="line"><a id="l01551" name="l01551"></a><span class="lineno"> 1551</span>                }</div>
<div class="line"><a id="l01552" name="l01552"></a><span class="lineno"> 1552</span> </div>
<div class="line"><a id="l01553" name="l01553"></a><span class="lineno"> 1553</span>                <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a8cdd409341efde24915eadc5f25a51f9">dmlog_applied_transaction</a>(trace);</div>
<div class="line"><a id="l01554" name="l01554"></a><span class="lineno"> 1554</span>                <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a6380e434da95a328ff48ccab33df9cb0">emit</a>(<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a64851fb4e041dc49ab22cf2ba335720d">self</a>.<a class="code hl_variable" href="classsysio_1_1chain_1_1controller.html#ac5fbe5586943483c7d167bc0088098b1">applied_transaction</a>, std::tie(trace, trx-&gt;packed_trx()));</div>
<div class="line"><a id="l01555" name="l01555"></a><span class="lineno"> 1555</span>            }</div>
<div class="line"><a id="l01556" name="l01556"></a><span class="lineno"> 1556</span> </div>
<div class="line"><a id="l01557" name="l01557"></a><span class="lineno"> 1557</span> </div>
<div class="line"><a id="l01558" name="l01558"></a><span class="lineno"> 1558</span>            <span class="keywordflow">if</span> ( (<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a4a18397f763ebe4880b6ccd970bedf85">read_mode</a> != <a class="code hl_enumvalue" href="namespacesysio_1_1chain.html#af3e35f3e1b78dd00fa247009a2d9ba5ea26ca3b6826ca765f741f39ec4754d581">db_read_mode::SPECULATIVE</a> &amp;&amp; <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a0e355919fd924a05344ef2b59f7dd587">pending</a>-&gt;_block_status == <a class="code hl_enumvalue" href="classsysio_1_1chain_1_1controller.html#a8b5124e077de1a73bb193e9c72b366b6a5ed4e9858ad8d239145ef285b6210a00">controller::block_status::incomplete</a>) || trx-&gt;read_only ) {</div>
<div class="line"><a id="l01559" name="l01559"></a><span class="lineno"> 1559</span>               <span class="comment">//this may happen automatically in destructor, but I prefer make it more explicit</span></div>
<div class="line"><a id="l01560" name="l01560"></a><span class="lineno"> 1560</span>               trx_context.<a class="code hl_function" href="classsysio_1_1chain_1_1transaction__context.html#a5631f6c990c61c078e0de6f0e53171be">undo</a>();</div>
<div class="line"><a id="l01561" name="l01561"></a><span class="lineno"> 1561</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01562" name="l01562"></a><span class="lineno"> 1562</span>               restore.cancel();</div>
<div class="line"><a id="l01563" name="l01563"></a><span class="lineno"> 1563</span>               trx_context.<a class="code hl_function" href="classsysio_1_1chain_1_1transaction__context.html#a558e8aff8e48deb61fae7407e10e8788">squash</a>();</div>
<div class="line"><a id="l01564" name="l01564"></a><span class="lineno"> 1564</span>            }</div>
<div class="line"><a id="l01565" name="l01565"></a><span class="lineno"> 1565</span> </div>
<div class="line"><a id="l01566" name="l01566"></a><span class="lineno"> 1566</span>            <span class="keywordflow">return</span> trace;</div>
<div class="line"><a id="l01567" name="l01567"></a><span class="lineno"> 1567</span>         } <span class="keywordflow">catch</span>( <span class="keyword">const</span> disallowed_transaction_extensions_bad_block_exception&amp; ) {</div>
<div class="line"><a id="l01568" name="l01568"></a><span class="lineno"> 1568</span>            <span class="keywordflow">throw</span>;</div>
<div class="line"><a id="l01569" name="l01569"></a><span class="lineno"> 1569</span>         } <span class="keywordflow">catch</span>( <span class="keyword">const</span> protocol_feature_bad_block_exception&amp; ) {</div>
<div class="line"><a id="l01570" name="l01570"></a><span class="lineno"> 1570</span>            <span class="keywordflow">throw</span>;</div>
<div class="line"><a id="l01571" name="l01571"></a><span class="lineno"> 1571</span>         } <span class="keywordflow">catch</span> ( <span class="keyword">const</span> std::bad_alloc&amp; ) {</div>
<div class="line"><a id="l01572" name="l01572"></a><span class="lineno"> 1572</span>           <span class="keywordflow">throw</span>;</div>
<div class="line"><a id="l01573" name="l01573"></a><span class="lineno"> 1573</span>         } <span class="keywordflow">catch</span> ( <span class="keyword">const</span> boost::interprocess::bad_alloc&amp; ) {</div>
<div class="line"><a id="l01574" name="l01574"></a><span class="lineno"> 1574</span>           <span class="keywordflow">throw</span>;</div>
<div class="line"><a id="l01575" name="l01575"></a><span class="lineno"> 1575</span>         } <span class="keywordflow">catch</span> (<span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1exception.html">fc::exception</a>&amp; e) {</div>
<div class="line"><a id="l01576" name="l01576"></a><span class="lineno"> 1576</span>           handle_exception(e);</div>
<div class="line"><a id="l01577" name="l01577"></a><span class="lineno"> 1577</span>         } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; e) {</div>
<div class="line"><a id="l01578" name="l01578"></a><span class="lineno"> 1578</span>           <span class="keyword">auto</span> wrapper = <a class="code hl_function" href="classfc_1_1std__exception__wrapper.html#ae5ad64f84b1d373f5b92031566284c7c">fc::std_exception_wrapper::from_current_exception</a>(e);</div>
<div class="line"><a id="l01579" name="l01579"></a><span class="lineno"> 1579</span>           handle_exception(wrapper);</div>
<div class="line"><a id="l01580" name="l01580"></a><span class="lineno"> 1580</span>         }</div>
<div class="line"><a id="l01581" name="l01581"></a><span class="lineno"> 1581</span> </div>
<div class="line"><a id="l01582" name="l01582"></a><span class="lineno"> 1582</span>         <span class="keywordflow">if</span> (!trx-&gt;read_only) {</div>
<div class="line"><a id="l01583" name="l01583"></a><span class="lineno"> 1583</span>             <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a6380e434da95a328ff48ccab33df9cb0">emit</a>(<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a64851fb4e041dc49ab22cf2ba335720d">self</a>.<a class="code hl_variable" href="classsysio_1_1chain_1_1controller.html#a063e3e3149bf8b88460900cef4b4571b">accepted_transaction</a>, trx);</div>
<div class="line"><a id="l01584" name="l01584"></a><span class="lineno"> 1584</span>             <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a8cdd409341efde24915eadc5f25a51f9">dmlog_applied_transaction</a>(trace);</div>
<div class="line"><a id="l01585" name="l01585"></a><span class="lineno"> 1585</span>             <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a6380e434da95a328ff48ccab33df9cb0">emit</a>(<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a64851fb4e041dc49ab22cf2ba335720d">self</a>.<a class="code hl_variable" href="classsysio_1_1chain_1_1controller.html#ac5fbe5586943483c7d167bc0088098b1">applied_transaction</a>, std::tie(trace, trx-&gt;packed_trx()));</div>
<div class="line"><a id="l01586" name="l01586"></a><span class="lineno"> 1586</span>         }</div>
<div class="line"><a id="l01587" name="l01587"></a><span class="lineno"> 1587</span> </div>
<div class="line"><a id="l01588" name="l01588"></a><span class="lineno"> 1588</span>         <span class="keywordflow">return</span> trace;</div>
<div class="line"><a id="l01589" name="l01589"></a><span class="lineno"> 1589</span>      } <a class="code hl_define" href="exception_8hpp.html#a094902280cad82ad6529ebbd12a697eb">FC_CAPTURE_AND_RETHROW</a>((trace))</div>
<div class="line"><a id="l01590" name="l01590"></a><span class="lineno"> 1590</span>   } </div>
</div>
<div class="line"><a id="l01591" name="l01591"></a><span class="lineno"> 1591</span> </div>
<div class="foldopen" id="foldopen01592" data-start="{" data-end="}">
<div class="line"><a id="l01592" name="l01592"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#a9dbf7da25185959b9a8ea1bf7a47a566"> 1592</a></span>   <span class="keywordtype">void</span> <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a9dbf7da25185959b9a8ea1bf7a47a566">start_block</a>( <a class="code hl_class" href="classsysio_1_1chain_1_1block__timestamp.html">block_timestamp_type</a> when,</div>
<div class="line"><a id="l01593" name="l01593"></a><span class="lineno"> 1593</span>                     <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> confirm_block_count,</div>
<div class="line"><a id="l01594" name="l01594"></a><span class="lineno"> 1594</span>                     <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1vector.html">vector&lt;digest_type&gt;</a>&amp; new_protocol_feature_activations,</div>
<div class="line"><a id="l01595" name="l01595"></a><span class="lineno"> 1595</span>                     <a class="code hl_enumeration" href="classsysio_1_1chain_1_1controller.html#a8b5124e077de1a73bb193e9c72b366b6">controller::block_status</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a>,</div>
<div class="line"><a id="l01596" name="l01596"></a><span class="lineno"> 1596</span>                     <span class="keyword">const</span> std::optional&lt;block_id_type&gt;&amp; producer_block_id,</div>
<div class="line"><a id="l01597" name="l01597"></a><span class="lineno"> 1597</span>                     <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1time__point.html">fc::time_point</a>&amp; deadline )</div>
<div class="line"><a id="l01598" name="l01598"></a><span class="lineno"> 1598</span>   {</div>
<div class="line"><a id="l01599" name="l01599"></a><span class="lineno"> 1599</span>      <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( !<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a0e355919fd924a05344ef2b59f7dd587">pending</a>, <a class="code hl_variable" href="namespacesysio_1_1chain.html#a910243f6a0327fb2d4fc80f7e89f103e">block_validate_exception</a>, <span class="stringliteral">&quot;pending block already exists&quot;</span> );</div>
<div class="line"><a id="l01600" name="l01600"></a><span class="lineno"> 1600</span> </div>
<div class="line"><a id="l01601" name="l01601"></a><span class="lineno"> 1601</span>      <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a6380e434da95a328ff48ccab33df9cb0">emit</a>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a64851fb4e041dc49ab22cf2ba335720d">self</a>.<a class="code hl_variable" href="classsysio_1_1chain_1_1controller.html#adbf19ff6a0a51a5d85e2be416a586dcc">block_start</a>, <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a56a0f369b58e6597b62569ff2853ee90">head</a>-&gt;block_num + 1 );</div>
<div class="line"><a id="l01602" name="l01602"></a><span class="lineno"> 1602</span> </div>
<div class="line"><a id="l01603" name="l01603"></a><span class="lineno"> 1603</span>      <span class="keywordflow">if</span> (<span class="keyword">auto</span> dm_logger = <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a1b67831f3be3a668c170723427236954">get_deep_mind_logger</a>()) {</div>
<div class="line"><a id="l01604" name="l01604"></a><span class="lineno"> 1604</span>         <span class="comment">// The head block represents the block just before this one that is about to start, so add 1 to get this block num</span></div>
<div class="line"><a id="l01605" name="l01605"></a><span class="lineno"> 1605</span>         dm_logger-&gt;on_start_block(<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a56a0f369b58e6597b62569ff2853ee90">head</a>-&gt;block_num + 1);</div>
<div class="line"><a id="l01606" name="l01606"></a><span class="lineno"> 1606</span>      }</div>
<div class="line"><a id="l01607" name="l01607"></a><span class="lineno"> 1607</span> </div>
<div class="line"><a id="l01608" name="l01608"></a><span class="lineno"> 1608</span>      <span class="keyword">auto</span> guard_pending = <a class="code hl_function" href="namespacefc.html#a23d89b54a8ffd84f7e7efeb21747d846">fc::make_scoped_exit</a>([<span class="keyword">this</span>, head_block_num=<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a56a0f369b58e6597b62569ff2853ee90">head</a>-&gt;block_num](){</div>
<div class="line"><a id="l01609" name="l01609"></a><span class="lineno"> 1609</span>         protocol_features.popped_blocks_to( head_block_num );</div>
<div class="line"><a id="l01610" name="l01610"></a><span class="lineno"> 1610</span>         pending.reset();</div>
<div class="line"><a id="l01611" name="l01611"></a><span class="lineno"> 1611</span>      });</div>
<div class="line"><a id="l01612" name="l01612"></a><span class="lineno"> 1612</span> </div>
<div class="line"><a id="l01613" name="l01613"></a><span class="lineno"> 1613</span>      <span class="keywordflow">if</span> (!<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a64851fb4e041dc49ab22cf2ba335720d">self</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#ac8eea0639eeef0fc0d304f645b80d884">skip_db_sessions</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a>)) {</div>
<div class="line"><a id="l01614" name="l01614"></a><span class="lineno"> 1614</span>         <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>.<a class="code hl_function" href="classchainbase_1_1database.html#a224fc0c346a93fd027bfa2515f54bf98">revision</a>() == <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a56a0f369b58e6597b62569ff2853ee90">head</a>-&gt;block_num, <a class="code hl_variable" href="namespacesysio_1_1chain.html#a6b9cb254135911c4a6d577a9ab7fdd4e">database_exception</a>, <span class="stringliteral">&quot;db revision is not on par with head block&quot;</span>,</div>
<div class="line"><a id="l01615" name="l01615"></a><span class="lineno"> 1615</span>                     (<span class="stringliteral">&quot;db.revision()&quot;</span>, <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>.<a class="code hl_function" href="classchainbase_1_1database.html#a224fc0c346a93fd027bfa2515f54bf98">revision</a>())(<span class="stringliteral">&quot;controller_head_block&quot;</span>, <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a56a0f369b58e6597b62569ff2853ee90">head</a>-&gt;block_num)(<span class="stringliteral">&quot;fork_db_head_block&quot;</span>, <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af7f72e6389799b7921aa98f30534f0d9">fork_db</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1fork__database.html#a3b128a7d57c262ef6351d83c16cffae3">head</a>()-&gt;block_num) );</div>
<div class="line"><a id="l01616" name="l01616"></a><span class="lineno"> 1616</span> </div>
<div class="line"><a id="l01617" name="l01617"></a><span class="lineno"> 1617</span>         <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a0e355919fd924a05344ef2b59f7dd587">pending</a>.emplace( <a class="code hl_class" href="classsysio_1_1chain_1_1maybe__session.html">maybe_session</a>(<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>), *<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a56a0f369b58e6597b62569ff2853ee90">head</a>, when, confirm_block_count, new_protocol_feature_activations );</div>
<div class="line"><a id="l01618" name="l01618"></a><span class="lineno"> 1618</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01619" name="l01619"></a><span class="lineno"> 1619</span>         <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a0e355919fd924a05344ef2b59f7dd587">pending</a>.emplace( <a class="code hl_class" href="classsysio_1_1chain_1_1maybe__session.html">maybe_session</a>(), *<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a56a0f369b58e6597b62569ff2853ee90">head</a>, when, confirm_block_count, new_protocol_feature_activations );</div>
<div class="line"><a id="l01620" name="l01620"></a><span class="lineno"> 1620</span>      }</div>
<div class="line"><a id="l01621" name="l01621"></a><span class="lineno"> 1621</span> </div>
<div class="line"><a id="l01622" name="l01622"></a><span class="lineno"> 1622</span>      <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a0e355919fd924a05344ef2b59f7dd587">pending</a>-&gt;_block_status = <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a>;</div>
<div class="line"><a id="l01623" name="l01623"></a><span class="lineno"> 1623</span>      <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a0e355919fd924a05344ef2b59f7dd587">pending</a>-&gt;_producer_block_id = producer_block_id;</div>
<div class="line"><a id="l01624" name="l01624"></a><span class="lineno"> 1624</span> </div>
<div class="line"><a id="l01625" name="l01625"></a><span class="lineno"> 1625</span>      <span class="keyword">auto</span>&amp; bb = std::get&lt;building_block&gt;(<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a0e355919fd924a05344ef2b59f7dd587">pending</a>-&gt;_block_stage);</div>
<div class="line"><a id="l01626" name="l01626"></a><span class="lineno"> 1626</span>      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; pbhs = bb._pending_block_header_state;</div>
<div class="line"><a id="l01627" name="l01627"></a><span class="lineno"> 1627</span> </div>
<div class="line"><a id="l01628" name="l01628"></a><span class="lineno"> 1628</span>      <span class="comment">// modify state of speculative block only if we are in speculative read mode (otherwise we need clean state for head or read-only modes)</span></div>
<div class="line"><a id="l01629" name="l01629"></a><span class="lineno"> 1629</span>      <span class="keywordflow">if</span> ( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a4a18397f763ebe4880b6ccd970bedf85">read_mode</a> == <a class="code hl_enumvalue" href="namespacesysio_1_1chain.html#af3e35f3e1b78dd00fa247009a2d9ba5ea26ca3b6826ca765f741f39ec4754d581">db_read_mode::SPECULATIVE</a> || <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a0e355919fd924a05344ef2b59f7dd587">pending</a>-&gt;_block_status != <a class="code hl_enumvalue" href="classsysio_1_1chain_1_1controller.html#a8b5124e077de1a73bb193e9c72b366b6a5ed4e9858ad8d239145ef285b6210a00">controller::block_status::incomplete</a> )</div>
<div class="line"><a id="l01630" name="l01630"></a><span class="lineno"> 1630</span>      {</div>
<div class="line"><a id="l01631" name="l01631"></a><span class="lineno"> 1631</span>         <span class="keyword">const</span> <span class="keyword">auto</span>&amp; pso = <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>.<a class="code hl_function" href="classchainbase_1_1database.html#afcfe00f81a526c1376d4f51197dd3a9a">get</a>&lt;<a class="code hl_class" href="classsysio_1_1chain_1_1protocol__state__object.html">protocol_state_object</a>&gt;();</div>
<div class="line"><a id="l01632" name="l01632"></a><span class="lineno"> 1632</span> </div>
<div class="line"><a id="l01633" name="l01633"></a><span class="lineno"> 1633</span>         <span class="keyword">auto</span> num_preactivated_protocol_features = pso.<a class="code hl_variable" href="classsysio_1_1chain_1_1protocol__state__object.html#af9aaf45cddecb84f71b527784984b83a">preactivated_protocol_features</a>.size();</div>
<div class="line"><a id="l01634" name="l01634"></a><span class="lineno"> 1634</span>         <span class="keywordtype">bool</span> handled_all_preactivated_features = (num_preactivated_protocol_features == 0);</div>
<div class="line"><a id="l01635" name="l01635"></a><span class="lineno"> 1635</span> </div>
<div class="line"><a id="l01636" name="l01636"></a><span class="lineno"> 1636</span>         <span class="keywordflow">if</span>( new_protocol_feature_activations.size() &gt; 0 ) {</div>
<div class="line"><a id="l01637" name="l01637"></a><span class="lineno"> 1637</span>            flat_map&lt;digest_type, bool&gt; activated_protocol_features;</div>
<div class="line"><a id="l01638" name="l01638"></a><span class="lineno"> 1638</span>            activated_protocol_features.reserve( std::max( num_preactivated_protocol_features,</div>
<div class="line"><a id="l01639" name="l01639"></a><span class="lineno"> 1639</span>                                                           new_protocol_feature_activations.size() ) );</div>
<div class="line"><a id="l01640" name="l01640"></a><span class="lineno"> 1640</span>            <span class="keywordflow">for</span>( <span class="keyword">const</span> <span class="keyword">auto</span>&amp; feature_digest : pso.preactivated_protocol_features ) {</div>
<div class="line"><a id="l01641" name="l01641"></a><span class="lineno"> 1641</span>               activated_protocol_features.emplace( feature_digest, <span class="keyword">false</span> );</div>
<div class="line"><a id="l01642" name="l01642"></a><span class="lineno"> 1642</span>            }</div>
<div class="line"><a id="l01643" name="l01643"></a><span class="lineno"> 1643</span> </div>
<div class="line"><a id="l01644" name="l01644"></a><span class="lineno"> 1644</span>            <span class="keywordtype">size_t</span> num_preactivated_features_that_have_activated = 0;</div>
<div class="line"><a id="l01645" name="l01645"></a><span class="lineno"> 1645</span> </div>
<div class="line"><a id="l01646" name="l01646"></a><span class="lineno"> 1646</span>            <span class="keyword">const</span> <span class="keyword">auto</span>&amp; pfs = <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a24a100a7be5e562ac3966924b0c9ccb6">protocol_features</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1protocol__feature__manager.html#a9e6c1310749c4fd04035aa2c01310ce4">get_protocol_feature_set</a>();</div>
<div class="line"><a id="l01647" name="l01647"></a><span class="lineno"> 1647</span>            <span class="keywordflow">for</span>( <span class="keyword">const</span> <span class="keyword">auto</span>&amp; feature_digest : new_protocol_feature_activations ) {</div>
<div class="line"><a id="l01648" name="l01648"></a><span class="lineno"> 1648</span>               <span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code hl_variable" href="_x02-_disabled_macros_8cpp.html#ae28240b98d91d6eb7da702b770490f39">f</a> = pfs.get_protocol_feature( feature_digest );</div>
<div class="line"><a id="l01649" name="l01649"></a><span class="lineno"> 1649</span> </div>
<div class="line"><a id="l01650" name="l01650"></a><span class="lineno"> 1650</span>               <span class="keyword">auto</span> res = activated_protocol_features.emplace( feature_digest, <span class="keyword">true</span> );</div>
<div class="line"><a id="l01651" name="l01651"></a><span class="lineno"> 1651</span>               <span class="keywordflow">if</span>( res.second ) {</div>
<div class="line"><a id="l01652" name="l01652"></a><span class="lineno"> 1652</span>                  <span class="comment">// feature_digest was not preactivated</span></div>
<div class="line"><a id="l01653" name="l01653"></a><span class="lineno"> 1653</span>                  <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( !<a class="code hl_variable" href="_x02-_disabled_macros_8cpp.html#ae28240b98d91d6eb7da702b770490f39">f</a>.preactivation_required, protocol_feature_exception,</div>
<div class="line"><a id="l01654" name="l01654"></a><span class="lineno"> 1654</span>                              <span class="stringliteral">&quot;attempted to activate protocol feature without prior required preactivation: ${digest}&quot;</span>,</div>
<div class="line"><a id="l01655" name="l01655"></a><span class="lineno"> 1655</span>                              (<span class="stringliteral">&quot;digest&quot;</span>, feature_digest)</div>
<div class="line"><a id="l01656" name="l01656"></a><span class="lineno"> 1656</span>                  );</div>
<div class="line"><a id="l01657" name="l01657"></a><span class="lineno"> 1657</span>               } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01658" name="l01658"></a><span class="lineno"> 1658</span>                  <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( !res.first-&gt;second, <a class="code hl_variable" href="namespacesysio_1_1chain.html#a910243f6a0327fb2d4fc80f7e89f103e">block_validate_exception</a>,</div>
<div class="line"><a id="l01659" name="l01659"></a><span class="lineno"> 1659</span>                              <span class="stringliteral">&quot;attempted duplicate activation within a single block: ${digest}&quot;</span>,</div>
<div class="line"><a id="l01660" name="l01660"></a><span class="lineno"> 1660</span>                              (<span class="stringliteral">&quot;digest&quot;</span>, feature_digest)</div>
<div class="line"><a id="l01661" name="l01661"></a><span class="lineno"> 1661</span>                  );</div>
<div class="line"><a id="l01662" name="l01662"></a><span class="lineno"> 1662</span>                  <span class="comment">// feature_digest was preactivated</span></div>
<div class="line"><a id="l01663" name="l01663"></a><span class="lineno"> 1663</span>                  res.first-&gt;second = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01664" name="l01664"></a><span class="lineno"> 1664</span>                  ++num_preactivated_features_that_have_activated;</div>
<div class="line"><a id="l01665" name="l01665"></a><span class="lineno"> 1665</span>               }</div>
<div class="line"><a id="l01666" name="l01666"></a><span class="lineno"> 1666</span> </div>
<div class="line"><a id="l01667" name="l01667"></a><span class="lineno"> 1667</span>               <span class="keywordflow">if</span>( <a class="code hl_variable" href="_x02-_disabled_macros_8cpp.html#ae28240b98d91d6eb7da702b770490f39">f</a>.builtin_feature ) {</div>
<div class="line"><a id="l01668" name="l01668"></a><span class="lineno"> 1668</span>                  <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a9335673a748ff21decfddf837016e2ff">trigger_activation_handler</a>( *<a class="code hl_variable" href="_x02-_disabled_macros_8cpp.html#ae28240b98d91d6eb7da702b770490f39">f</a>.builtin_feature );</div>
<div class="line"><a id="l01669" name="l01669"></a><span class="lineno"> 1669</span>               }</div>
<div class="line"><a id="l01670" name="l01670"></a><span class="lineno"> 1670</span> </div>
<div class="line"><a id="l01671" name="l01671"></a><span class="lineno"> 1671</span>               <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a24a100a7be5e562ac3966924b0c9ccb6">protocol_features</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1protocol__feature__manager.html#a9fd76dbd437aa9d52791de3e7893be48">activate_feature</a>( feature_digest, pbhs.block_num );</div>
<div class="line"><a id="l01672" name="l01672"></a><span class="lineno"> 1672</span> </div>
<div class="line"><a id="l01673" name="l01673"></a><span class="lineno"> 1673</span>               ++bb._num_new_protocol_features_that_have_activated;</div>
<div class="line"><a id="l01674" name="l01674"></a><span class="lineno"> 1674</span>            }</div>
<div class="line"><a id="l01675" name="l01675"></a><span class="lineno"> 1675</span> </div>
<div class="line"><a id="l01676" name="l01676"></a><span class="lineno"> 1676</span>            <span class="keywordflow">if</span>( num_preactivated_features_that_have_activated == num_preactivated_protocol_features ) {</div>
<div class="line"><a id="l01677" name="l01677"></a><span class="lineno"> 1677</span>               handled_all_preactivated_features = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01678" name="l01678"></a><span class="lineno"> 1678</span>            }</div>
<div class="line"><a id="l01679" name="l01679"></a><span class="lineno"> 1679</span>         }</div>
<div class="line"><a id="l01680" name="l01680"></a><span class="lineno"> 1680</span> </div>
<div class="line"><a id="l01681" name="l01681"></a><span class="lineno"> 1681</span>         <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( handled_all_preactivated_features, <a class="code hl_variable" href="namespacesysio_1_1chain.html#a910243f6a0327fb2d4fc80f7e89f103e">block_validate_exception</a>,</div>
<div class="line"><a id="l01682" name="l01682"></a><span class="lineno"> 1682</span>                     <span class="stringliteral">&quot;There are pre-activated protocol features that were not activated at the start of this block&quot;</span></div>
<div class="line"><a id="l01683" name="l01683"></a><span class="lineno"> 1683</span>         );</div>
<div class="line"><a id="l01684" name="l01684"></a><span class="lineno"> 1684</span> </div>
<div class="line"><a id="l01685" name="l01685"></a><span class="lineno"> 1685</span>         <span class="keywordflow">if</span>( new_protocol_feature_activations.size() &gt; 0 ) {</div>
<div class="line"><a id="l01686" name="l01686"></a><span class="lineno"> 1686</span>            <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>.<a class="code hl_function" href="classchainbase_1_1database.html#a9ebc006075e8fc2e84357a0e068b58d4">modify</a>( pso, [&amp;]( <span class="keyword">auto</span>&amp; ps ) {</div>
<div class="line"><a id="l01687" name="l01687"></a><span class="lineno"> 1687</span>               ps.preactivated_protocol_features.clear();</div>
<div class="line"><a id="l01688" name="l01688"></a><span class="lineno"> 1688</span> </div>
<div class="line"><a id="l01689" name="l01689"></a><span class="lineno"> 1689</span>               ps.activated_protocol_features.reserve( ps.activated_protocol_features.size()</div>
<div class="line"><a id="l01690" name="l01690"></a><span class="lineno"> 1690</span>                                                         + new_protocol_feature_activations.size() );</div>
<div class="line"><a id="l01691" name="l01691"></a><span class="lineno"> 1691</span>               <span class="keywordflow">for</span>( <span class="keyword">const</span> <span class="keyword">auto</span>&amp; feature_digest : new_protocol_feature_activations ) {</div>
<div class="line"><a id="l01692" name="l01692"></a><span class="lineno"> 1692</span>                  ps.activated_protocol_features.emplace_back( feature_digest, pbhs.block_num );</div>
<div class="line"><a id="l01693" name="l01693"></a><span class="lineno"> 1693</span>               }</div>
<div class="line"><a id="l01694" name="l01694"></a><span class="lineno"> 1694</span>            });</div>
<div class="line"><a id="l01695" name="l01695"></a><span class="lineno"> 1695</span>         }</div>
<div class="line"><a id="l01696" name="l01696"></a><span class="lineno"> 1696</span> </div>
<div class="line"><a id="l01697" name="l01697"></a><span class="lineno"> 1697</span>         <span class="keyword">const</span> <span class="keyword">auto</span>&amp; gpo = <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>.<a class="code hl_function" href="classchainbase_1_1database.html#afcfe00f81a526c1376d4f51197dd3a9a">get</a>&lt;<a class="code hl_class" href="classsysio_1_1chain_1_1global__property__object.html">global_property_object</a>&gt;();</div>
<div class="line"><a id="l01698" name="l01698"></a><span class="lineno"> 1698</span> </div>
<div class="line"><a id="l01699" name="l01699"></a><span class="lineno"> 1699</span>         <span class="keywordflow">if</span>( gpo.proposed_schedule_block_num &amp;&amp; <span class="comment">// if there is a proposed schedule that was proposed in a block ...</span></div>
<div class="line"><a id="l01700" name="l01700"></a><span class="lineno"> 1700</span>             ( *gpo.proposed_schedule_block_num &lt;= pbhs.dpos_irreversible_blocknum ) &amp;&amp; <span class="comment">// ... that has now become irreversible ...</span></div>
<div class="line"><a id="l01701" name="l01701"></a><span class="lineno"> 1701</span>             pbhs.prev_pending_schedule.schedule.producers.size() == 0 <span class="comment">// ... and there was room for a new pending schedule prior to any possible promotion</span></div>
<div class="line"><a id="l01702" name="l01702"></a><span class="lineno"> 1702</span>         )</div>
<div class="line"><a id="l01703" name="l01703"></a><span class="lineno"> 1703</span>         {</div>
<div class="line"><a id="l01704" name="l01704"></a><span class="lineno"> 1704</span>            <span class="comment">// Promote proposed schedule to pending schedule.</span></div>
<div class="line"><a id="l01705" name="l01705"></a><span class="lineno"> 1705</span>            <span class="keywordflow">if</span>( !<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a3bd1eefa999ba89597c3686e0acc463e">replaying</a> ) {</div>
<div class="line"><a id="l01706" name="l01706"></a><span class="lineno"> 1706</span>               <a class="code hl_define" href="logger_8hpp.html#a831cf08dc63704c11fd154132c6e8bdb">ilog</a>( <span class="stringliteral">&quot;promoting proposed schedule (set in block ${proposed_num}) to pending; current block: ${n} lib: ${lib} schedule: ${schedule} &quot;</span>,</div>
<div class="line"><a id="l01707" name="l01707"></a><span class="lineno"> 1707</span>                     (<span class="stringliteral">&quot;proposed_num&quot;</span>, *gpo.proposed_schedule_block_num)(<span class="stringliteral">&quot;n&quot;</span>, pbhs.block_num)</div>
<div class="line"><a id="l01708" name="l01708"></a><span class="lineno"> 1708</span>                     (<span class="stringliteral">&quot;lib&quot;</span>, pbhs.dpos_irreversible_blocknum)</div>
<div class="line"><a id="l01709" name="l01709"></a><span class="lineno"> 1709</span>                     (<span class="stringliteral">&quot;schedule&quot;</span>, <a class="code hl_function" href="structsysio_1_1chain_1_1producer__authority__schedule.html#a4b0d95b22a8be15ac06dc3b105638c54">producer_authority_schedule::from_shared</a>(gpo.proposed_schedule) ) );</div>
<div class="line"><a id="l01710" name="l01710"></a><span class="lineno"> 1710</span>            }</div>
<div class="line"><a id="l01711" name="l01711"></a><span class="lineno"> 1711</span> </div>
<div class="line"><a id="l01712" name="l01712"></a><span class="lineno"> 1712</span>            <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( gpo.proposed_schedule.version == pbhs.active_schedule_version + 1,</div>
<div class="line"><a id="l01713" name="l01713"></a><span class="lineno"> 1713</span>                        producer_schedule_exception, <span class="stringliteral">&quot;wrong producer schedule version specified&quot;</span> );</div>
<div class="line"><a id="l01714" name="l01714"></a><span class="lineno"> 1714</span> </div>
<div class="line"><a id="l01715" name="l01715"></a><span class="lineno"> 1715</span>            std::get&lt;building_block&gt;(<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a0e355919fd924a05344ef2b59f7dd587">pending</a>-&gt;_block_stage)._new_pending_producer_schedule = <a class="code hl_function" href="structsysio_1_1chain_1_1producer__authority__schedule.html#a4b0d95b22a8be15ac06dc3b105638c54">producer_authority_schedule::from_shared</a>(gpo.proposed_schedule);</div>
<div class="line"><a id="l01716" name="l01716"></a><span class="lineno"> 1716</span>            <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>.<a class="code hl_function" href="classchainbase_1_1database.html#a9ebc006075e8fc2e84357a0e068b58d4">modify</a>( gpo, [&amp;]( <span class="keyword">auto</span>&amp; gp ) {</div>
<div class="line"><a id="l01717" name="l01717"></a><span class="lineno"> 1717</span>               gp.proposed_schedule_block_num = std::optional&lt;block_num_type&gt;();</div>
<div class="line"><a id="l01718" name="l01718"></a><span class="lineno"> 1718</span>               gp.proposed_schedule.version=0;</div>
<div class="line"><a id="l01719" name="l01719"></a><span class="lineno"> 1719</span>               gp.proposed_schedule.producers.clear();</div>
<div class="line"><a id="l01720" name="l01720"></a><span class="lineno"> 1720</span>            });</div>
<div class="line"><a id="l01721" name="l01721"></a><span class="lineno"> 1721</span>         }</div>
<div class="line"><a id="l01722" name="l01722"></a><span class="lineno"> 1722</span> </div>
<div class="line"><a id="l01723" name="l01723"></a><span class="lineno"> 1723</span>         <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l01724" name="l01724"></a><span class="lineno"> 1724</span>            <a class="code hl_typedef" href="namespacesysio_1_1chain.html#ad795329e0af850251f4f47cc32e8d770">transaction_metadata_ptr</a> onbtrx =</div>
<div class="line"><a id="l01725" name="l01725"></a><span class="lineno"> 1725</span>                  <a class="code hl_function" href="classsysio_1_1chain_1_1transaction__metadata.html#acb14de2d02033c2d43c65319825d3d5b">transaction_metadata::create_no_recover_keys</a>( std::make_shared&lt;packed_transaction&gt;( <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a3f2b256d3a667ffeed8f7fd03e36c902">get_on_block_transaction</a>() ),</div>
<div class="line"><a id="l01726" name="l01726"></a><span class="lineno"> 1726</span>                                                                <a class="code hl_enumvalue" href="classsysio_1_1chain_1_1transaction__metadata.html#a841053d8fa06ceea3cb8096625f053edacd1fed5e3277af3a9210b25059d86ff9">transaction_metadata::trx_type::implicit</a> );</div>
<div class="line"><a id="l01727" name="l01727"></a><span class="lineno"> 1727</span>            <span class="keyword">auto</span> reset_in_trx_requiring_checks = <a class="code hl_function" href="namespacefc.html#a23d89b54a8ffd84f7e7efeb21747d846">fc::make_scoped_exit</a>([old_value=<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#ab02dbb970f5b16869e123b77eb090e9b">in_trx_requiring_checks</a>,<span class="keyword">this</span>](){</div>
<div class="line"><a id="l01728" name="l01728"></a><span class="lineno"> 1728</span>                  <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#ab02dbb970f5b16869e123b77eb090e9b">in_trx_requiring_checks</a> = old_value;</div>
<div class="line"><a id="l01729" name="l01729"></a><span class="lineno"> 1729</span>               });</div>
<div class="line"><a id="l01730" name="l01730"></a><span class="lineno"> 1730</span>            <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#ab02dbb970f5b16869e123b77eb090e9b">in_trx_requiring_checks</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01731" name="l01731"></a><span class="lineno"> 1731</span>            <span class="keyword">auto</span> trace = <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#af381eb0fcede18ab0ae4cddaaa9df6cd">push_transaction</a>( onbtrx, <a class="code hl_function" href="classfc_1_1time__point.html#aeccf1b70aa34b132c5269313b8a50573">fc::time_point::maximum</a>(), <a class="code hl_function" href="classfc_1_1microseconds.html#afc3eb0bfd792c7b1cda062e559e30c2e">fc::microseconds::maximum</a>(),</div>
<div class="line"><a id="l01732" name="l01732"></a><span class="lineno"> 1732</span>                                           <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a64851fb4e041dc49ab22cf2ba335720d">self</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a0bb11e832a05b6437c79bf81758b1b7d">get_global_properties</a>().<a class="code hl_variable" href="classsysio_1_1chain_1_1global__property__object.html#a7f149fcf87034217c899838eb4430496">configuration</a>.<a class="code hl_variable" href="structsysio_1_1chain_1_1chain__config__v0.html#a460f6b269c9da35d40b1cc5927c2205a">min_transaction_cpu_usage</a>, <span class="keyword">true</span>, 0 );</div>
<div class="line"><a id="l01733" name="l01733"></a><span class="lineno"> 1733</span>            <span class="keywordflow">if</span>( trace-&gt;except ) {</div>
<div class="line"><a id="l01734" name="l01734"></a><span class="lineno"> 1734</span>               <a class="code hl_define" href="logger_8hpp.html#a1759e5c9691d8ad754bdf5eff8bb23ac">wlog</a>(<span class="stringliteral">&quot;onblock ${block_num} is REJECTING: ${entire_trace}&quot;</span>,(<span class="stringliteral">&quot;block_num&quot;</span>, <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a56a0f369b58e6597b62569ff2853ee90">head</a>-&gt;block_num + 1)(<span class="stringliteral">&quot;entire_trace&quot;</span>, trace));</div>
<div class="line"><a id="l01735" name="l01735"></a><span class="lineno"> 1735</span>            }</div>
<div class="line"><a id="l01736" name="l01736"></a><span class="lineno"> 1736</span>         } <span class="keywordflow">catch</span>( <span class="keyword">const</span> std::bad_alloc&amp; e ) {</div>
<div class="line"><a id="l01737" name="l01737"></a><span class="lineno"> 1737</span>            <a class="code hl_define" href="logger_8hpp.html#a9e3cdbaecd5a34b42956e888f7326fad">elog</a>( <span class="stringliteral">&quot;on block transaction failed due to a std::bad_alloc&quot;</span> );</div>
<div class="line"><a id="l01738" name="l01738"></a><span class="lineno"> 1738</span>            <span class="keywordflow">throw</span>;</div>
<div class="line"><a id="l01739" name="l01739"></a><span class="lineno"> 1739</span>         } <span class="keywordflow">catch</span>( <span class="keyword">const</span> boost::interprocess::bad_alloc&amp; e ) {</div>
<div class="line"><a id="l01740" name="l01740"></a><span class="lineno"> 1740</span>            <a class="code hl_define" href="logger_8hpp.html#a9e3cdbaecd5a34b42956e888f7326fad">elog</a>( <span class="stringliteral">&quot;on block transaction failed due to a bad allocation&quot;</span> );</div>
<div class="line"><a id="l01741" name="l01741"></a><span class="lineno"> 1741</span>            <span class="keywordflow">throw</span>;</div>
<div class="line"><a id="l01742" name="l01742"></a><span class="lineno"> 1742</span>         } <span class="keywordflow">catch</span>( <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1exception.html">fc::exception</a>&amp; e ) {</div>
<div class="line"><a id="l01743" name="l01743"></a><span class="lineno"> 1743</span>            <a class="code hl_define" href="logger_8hpp.html#a1759e5c9691d8ad754bdf5eff8bb23ac">wlog</a>( <span class="stringliteral">&quot;on block transaction failed, but shouldn&#39;t impact block generation, system contract needs update&quot;</span> );</div>
<div class="line"><a id="l01744" name="l01744"></a><span class="lineno"> 1744</span>            <a class="code hl_define" href="logger_8hpp.html#a26aaf645dd9dc96836635d6b18bd1090">edump</a>((e.to_detail_string()));</div>
<div class="line"><a id="l01745" name="l01745"></a><span class="lineno"> 1745</span>         } <span class="keywordflow">catch</span>( <span class="keyword">const</span> std::exception&amp; e ) {</div>
<div class="line"><a id="l01746" name="l01746"></a><span class="lineno"> 1746</span>            <a class="code hl_define" href="logger_8hpp.html#a1759e5c9691d8ad754bdf5eff8bb23ac">wlog</a>( <span class="stringliteral">&quot;on block transaction failed due to unexpected exception&quot;</span> );</div>
<div class="line"><a id="l01747" name="l01747"></a><span class="lineno"> 1747</span>            <a class="code hl_define" href="logger_8hpp.html#a26aaf645dd9dc96836635d6b18bd1090">edump</a>((e.what()));</div>
<div class="line"><a id="l01748" name="l01748"></a><span class="lineno"> 1748</span>         } <span class="keywordflow">catch</span>( ... ) {</div>
<div class="line"><a id="l01749" name="l01749"></a><span class="lineno"> 1749</span>            <a class="code hl_define" href="logger_8hpp.html#a9e3cdbaecd5a34b42956e888f7326fad">elog</a>( <span class="stringliteral">&quot;on block transaction failed due to unknown exception&quot;</span> );</div>
<div class="line"><a id="l01750" name="l01750"></a><span class="lineno"> 1750</span>         }</div>
<div class="line"><a id="l01751" name="l01751"></a><span class="lineno"> 1751</span> </div>
<div class="line"><a id="l01752" name="l01752"></a><span class="lineno"> 1752</span>         <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a338cb13e3b27ade2ee719b5421edcf7e">clear_expired_input_transactions</a>(deadline);</div>
<div class="line"><a id="l01753" name="l01753"></a><span class="lineno"> 1753</span>         <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a69d180992926a229a5e3573ea09d762f">update_producers_authority</a>();</div>
<div class="line"><a id="l01754" name="l01754"></a><span class="lineno"> 1754</span>      }</div>
<div class="line"><a id="l01755" name="l01755"></a><span class="lineno"> 1755</span> </div>
<div class="line"><a id="l01756" name="l01756"></a><span class="lineno"> 1756</span>      guard_pending.cancel();</div>
<div class="line"><a id="l01757" name="l01757"></a><span class="lineno"> 1757</span>   } </div>
</div>
<div class="line"><a id="l01758" name="l01758"></a><span class="lineno"> 1758</span> </div>
<div class="foldopen" id="foldopen01759" data-start="{" data-end="}">
<div class="line"><a id="l01759" name="l01759"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#a5eb5bb7961c3ae6496caca42b84ab192"> 1759</a></span>   <span class="keywordtype">void</span> <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a5eb5bb7961c3ae6496caca42b84ab192">finalize_block</a>()</div>
<div class="line"><a id="l01760" name="l01760"></a><span class="lineno"> 1760</span>   {</div>
<div class="line"><a id="l01761" name="l01761"></a><span class="lineno"> 1761</span>      <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a0e355919fd924a05344ef2b59f7dd587">pending</a>, <a class="code hl_variable" href="namespacesysio_1_1chain.html#a910243f6a0327fb2d4fc80f7e89f103e">block_validate_exception</a>, <span class="stringliteral">&quot;it is not valid to finalize when there is no pending block&quot;</span>);</div>
<div class="line"><a id="l01762" name="l01762"></a><span class="lineno"> 1762</span>      <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( std::holds_alternative&lt;building_block&gt;(<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a0e355919fd924a05344ef2b59f7dd587">pending</a>-&gt;_block_stage), <a class="code hl_variable" href="namespacesysio_1_1chain.html#a910243f6a0327fb2d4fc80f7e89f103e">block_validate_exception</a>, <span class="stringliteral">&quot;already called finalize_block&quot;</span>);</div>
<div class="line"><a id="l01763" name="l01763"></a><span class="lineno"> 1763</span> </div>
<div class="line"><a id="l01764" name="l01764"></a><span class="lineno"> 1764</span>      <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l01765" name="l01765"></a><span class="lineno"> 1765</span> </div>
<div class="line"><a id="l01766" name="l01766"></a><span class="lineno"> 1766</span>      <span class="keyword">auto</span>&amp; pbhs = <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a0e355919fd924a05344ef2b59f7dd587">pending</a>-&gt;get_pending_block_header_state();</div>
<div class="line"><a id="l01767" name="l01767"></a><span class="lineno"> 1767</span> </div>
<div class="line"><a id="l01768" name="l01768"></a><span class="lineno"> 1768</span>      <span class="comment">// Update resource limits:</span></div>
<div class="line"><a id="l01769" name="l01769"></a><span class="lineno"> 1769</span>      <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a83a037a61ce8e07b39d2d38b0f54f8f7">resource_limits</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1resource__limits_1_1resource__limits__manager.html#a983919d376e5757bceee573e52b3c571">process_account_limit_updates</a>();</div>
<div class="line"><a id="l01770" name="l01770"></a><span class="lineno"> 1770</span>      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code hl_struct" href="structsysio_1_1chain_1_1chain__config__v1.html">chain_config</a> = <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a64851fb4e041dc49ab22cf2ba335720d">self</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a0bb11e832a05b6437c79bf81758b1b7d">get_global_properties</a>().<a class="code hl_variable" href="classsysio_1_1chain_1_1global__property__object.html#a7f149fcf87034217c899838eb4430496">configuration</a>;</div>
<div class="line"><a id="l01771" name="l01771"></a><span class="lineno"> 1771</span>      <a class="code hl_typedef" href="stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a> CPU_TARGET = <a class="code hl_function" href="chain_2include_2sysio_2chain_2config_8hpp.html#a0b4bacb63f31764f50a185f320551fbc">SYS_PERCENT</a>(<a class="code hl_struct" href="structsysio_1_1chain_1_1chain__config__v1.html">chain_config</a>.<a class="code hl_variable" href="structsysio_1_1chain_1_1chain__config__v0.html#a292759d9e893bccf78a5d22279fb5752">max_block_cpu_usage</a>, <a class="code hl_struct" href="structsysio_1_1chain_1_1chain__config__v1.html">chain_config</a>.<a class="code hl_variable" href="structsysio_1_1chain_1_1chain__config__v0.html#af2b14c2153bc64969ca85c8df8fbb7f9">target_block_cpu_usage_pct</a>);</div>
<div class="line"><a id="l01772" name="l01772"></a><span class="lineno"> 1772</span>      <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a83a037a61ce8e07b39d2d38b0f54f8f7">resource_limits</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1resource__limits_1_1resource__limits__manager.html#a4396d0acb70ebbd8054b13ff4c564e20">set_block_parameters</a>(</div>
<div class="line"><a id="l01773" name="l01773"></a><span class="lineno"> 1773</span>         { CPU_TARGET, <a class="code hl_struct" href="structsysio_1_1chain_1_1chain__config__v1.html">chain_config</a>.<a class="code hl_variable" href="structsysio_1_1chain_1_1chain__config__v0.html#a292759d9e893bccf78a5d22279fb5752">max_block_cpu_usage</a>, config::block_cpu_usage_average_window_ms / config::block_interval_ms, config::maximum_elastic_resource_multiplier, {99, 100}, {1000, 999}},</div>
<div class="line"><a id="l01774" name="l01774"></a><span class="lineno"> 1774</span>         {<a class="code hl_function" href="chain_2include_2sysio_2chain_2config_8hpp.html#a0b4bacb63f31764f50a185f320551fbc">SYS_PERCENT</a>(<a class="code hl_struct" href="structsysio_1_1chain_1_1chain__config__v1.html">chain_config</a>.<a class="code hl_variable" href="structsysio_1_1chain_1_1chain__config__v0.html#a796dada63527fcff40f838efc42a04ec">max_block_net_usage</a>, <a class="code hl_struct" href="structsysio_1_1chain_1_1chain__config__v1.html">chain_config</a>.<a class="code hl_variable" href="structsysio_1_1chain_1_1chain__config__v0.html#a216d150c1c6ad9ea64aaf82d86926d19">target_block_net_usage_pct</a>), <a class="code hl_struct" href="structsysio_1_1chain_1_1chain__config__v1.html">chain_config</a>.<a class="code hl_variable" href="structsysio_1_1chain_1_1chain__config__v0.html#a796dada63527fcff40f838efc42a04ec">max_block_net_usage</a>, config::block_size_average_window_ms / config::block_interval_ms, config::maximum_elastic_resource_multiplier, {99, 100}, {1000, 999}}</div>
<div class="line"><a id="l01775" name="l01775"></a><span class="lineno"> 1775</span>      );</div>
<div class="line"><a id="l01776" name="l01776"></a><span class="lineno"> 1776</span>      <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a83a037a61ce8e07b39d2d38b0f54f8f7">resource_limits</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1resource__limits_1_1resource__limits__manager.html#a5ebf5f04366d7120f58430d9ba4f8c7a">process_block_usage</a>(pbhs.block_num);</div>
<div class="line"><a id="l01777" name="l01777"></a><span class="lineno"> 1777</span> </div>
<div class="line"><a id="l01778" name="l01778"></a><span class="lineno"> 1778</span>      <span class="keyword">auto</span>&amp; bb = std::get&lt;building_block&gt;(<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a0e355919fd924a05344ef2b59f7dd587">pending</a>-&gt;_block_stage);</div>
<div class="line"><a id="l01779" name="l01779"></a><span class="lineno"> 1779</span> </div>
<div class="line"><a id="l01780" name="l01780"></a><span class="lineno"> 1780</span>      <span class="keywordflow">if</span> (bb._s_header){</div>
<div class="line"><a id="l01781" name="l01781"></a><span class="lineno"> 1781</span>         <a class="code hl_define" href="logger_8hpp.html#a831cf08dc63704c11fd154132c6e8bdb">ilog</a>(<span class="stringliteral">&quot;s_header present in finalize block, adding to block header: ${s}&quot;</span>, (<span class="stringliteral">&quot;s&quot;</span>, bb._s_header-&gt;to_string()));</div>
<div class="line"><a id="l01782" name="l01782"></a><span class="lineno"> 1782</span>      }</div>
<div class="line"><a id="l01783" name="l01783"></a><span class="lineno"> 1783</span> </div>
<div class="line"><a id="l01784" name="l01784"></a><span class="lineno"> 1784</span>      <span class="comment">// Create (unsigned) block:</span></div>
<div class="line"><a id="l01785" name="l01785"></a><span class="lineno"> 1785</span>      <span class="keyword">auto</span> block_ptr = std::make_shared&lt;signed_block&gt;( pbhs.make_block_header(</div>
<div class="line"><a id="l01786" name="l01786"></a><span class="lineno"> 1786</span>         bb._transaction_mroot ? *bb._transaction_mroot : <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a9ae4fff15a76a1c3089fdf0f3353a17f">calculate_trx_merkle</a>( bb._pending_trx_receipts ),</div>
<div class="line"><a id="l01787" name="l01787"></a><span class="lineno"> 1787</span>         <a class="code hl_function" href="namespacesysio_1_1chain.html#a80d7ea5476f97bf51a25149b55469c40">merkle</a>( std::move( std::get&lt;building_block&gt;(<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a0e355919fd924a05344ef2b59f7dd587">pending</a>-&gt;_block_stage)._action_receipt_digests ) ),</div>
<div class="line"><a id="l01788" name="l01788"></a><span class="lineno"> 1788</span>         bb._new_pending_producer_schedule,</div>
<div class="line"><a id="l01789" name="l01789"></a><span class="lineno"> 1789</span>         std::move( bb._new_protocol_feature_activations ),</div>
<div class="line"><a id="l01790" name="l01790"></a><span class="lineno"> 1790</span>         <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a24a100a7be5e562ac3966924b0c9ccb6">protocol_features</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1protocol__feature__manager.html#a9e6c1310749c4fd04035aa2c01310ce4">get_protocol_feature_set</a>(),</div>
<div class="line"><a id="l01791" name="l01791"></a><span class="lineno"> 1791</span>         bb._s_header <span class="comment">// Include optional s_header in block header</span></div>
<div class="line"><a id="l01792" name="l01792"></a><span class="lineno"> 1792</span>      ) );</div>
<div class="line"><a id="l01793" name="l01793"></a><span class="lineno"> 1793</span> </div>
<div class="line"><a id="l01794" name="l01794"></a><span class="lineno"> 1794</span>      block_ptr-&gt;transactions = std::move( bb._pending_trx_receipts );</div>
<div class="line"><a id="l01795" name="l01795"></a><span class="lineno"> 1795</span> </div>
<div class="line"><a id="l01796" name="l01796"></a><span class="lineno"> 1796</span>      <span class="keyword">auto</span> <span class="keywordtype">id</span> = block_ptr-&gt;calculate_id();</div>
<div class="line"><a id="l01797" name="l01797"></a><span class="lineno"> 1797</span> </div>
<div class="line"><a id="l01798" name="l01798"></a><span class="lineno"> 1798</span>      <span class="comment">// Update TaPoS table:</span></div>
<div class="line"><a id="l01799" name="l01799"></a><span class="lineno"> 1799</span>      <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a78427c6c856e3f2398f434c7d9366a84">create_block_summary</a>( <span class="keywordtype">id</span> );</div>
<div class="line"><a id="l01800" name="l01800"></a><span class="lineno"> 1800</span> </div>
<div class="line"><a id="l01801" name="l01801"></a><span class="lineno"> 1801</span>      <span class="comment">/*</span></div>
<div class="line"><a id="l01802" name="l01802"></a><span class="lineno"> 1802</span><span class="comment">      ilog( &quot;finalized block ${n} (${id}) at ${t} by ${p} (${signing_key}); schedule_version: ${v} lib: ${lib} #dtrxs: ${ndtrxs} ${np}&quot;,</span></div>
<div class="line"><a id="l01803" name="l01803"></a><span class="lineno"> 1803</span><span class="comment">            (&quot;n&quot;,pbhs.block_num)</span></div>
<div class="line"><a id="l01804" name="l01804"></a><span class="lineno"> 1804</span><span class="comment">            (&quot;id&quot;,id)</span></div>
<div class="line"><a id="l01805" name="l01805"></a><span class="lineno"> 1805</span><span class="comment">            (&quot;t&quot;,pbhs.timestamp)</span></div>
<div class="line"><a id="l01806" name="l01806"></a><span class="lineno"> 1806</span><span class="comment">            (&quot;p&quot;,pbhs.producer)</span></div>
<div class="line"><a id="l01807" name="l01807"></a><span class="lineno"> 1807</span><span class="comment">            (&quot;signing_key&quot;, pbhs.block_signing_key)</span></div>
<div class="line"><a id="l01808" name="l01808"></a><span class="lineno"> 1808</span><span class="comment">            (&quot;v&quot;,pbhs.active_schedule_version)</span></div>
<div class="line"><a id="l01809" name="l01809"></a><span class="lineno"> 1809</span><span class="comment">            (&quot;lib&quot;,pbhs.dpos_irreversible_blocknum)</span></div>
<div class="line"><a id="l01810" name="l01810"></a><span class="lineno"> 1810</span><span class="comment">            (&quot;ndtrxs&quot;,db.get_index&lt;generated_transaction_multi_index,by_trx_id&gt;().size())</span></div>
<div class="line"><a id="l01811" name="l01811"></a><span class="lineno"> 1811</span><span class="comment">            (&quot;np&quot;,block_ptr-&gt;new_producers)</span></div>
<div class="line"><a id="l01812" name="l01812"></a><span class="lineno"> 1812</span><span class="comment">      );</span></div>
<div class="line"><a id="l01813" name="l01813"></a><span class="lineno"> 1813</span><span class="comment">      */</span></div>
<div class="line"><a id="l01814" name="l01814"></a><span class="lineno"> 1814</span> </div>
<div class="line"><a id="l01815" name="l01815"></a><span class="lineno"> 1815</span>      <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a0e355919fd924a05344ef2b59f7dd587">pending</a>-&gt;_block_stage = <a class="code hl_struct" href="structsysio_1_1chain_1_1assembled__block.html">assembled_block</a>{</div>
<div class="line"><a id="l01816" name="l01816"></a><span class="lineno"> 1816</span>                                 <a class="code hl_variable" href="code__cache_8cpp.html#aa0efefe21f4700d78692edc823e763be">id</a>,</div>
<div class="line"><a id="l01817" name="l01817"></a><span class="lineno"> 1817</span>                                 std::move( bb._pending_block_header_state ),</div>
<div class="line"><a id="l01818" name="l01818"></a><span class="lineno"> 1818</span>                                 std::move( bb._pending_trx_metas ),</div>
<div class="line"><a id="l01819" name="l01819"></a><span class="lineno"> 1819</span>                                 std::move( block_ptr ),</div>
<div class="line"><a id="l01820" name="l01820"></a><span class="lineno"> 1820</span>                                 std::move( bb._new_pending_producer_schedule )</div>
<div class="line"><a id="l01821" name="l01821"></a><span class="lineno"> 1821</span>                              };</div>
<div class="line"><a id="l01822" name="l01822"></a><span class="lineno"> 1822</span>   } <a class="code hl_define" href="exception_8hpp.html#a094902280cad82ad6529ebbd12a697eb">FC_CAPTURE_AND_RETHROW</a>() } </div>
</div>
<div class="line"><a id="l01823" name="l01823"></a><span class="lineno"> 1823</span> </div>
<div class="foldopen" id="foldopen01827" data-start="{" data-end="}">
<div class="line"><a id="l01827" name="l01827"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#abde6bacce9f720ad552d0e342c52d3b4"> 1827</a></span>   <span class="keywordtype">void</span> <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#abde6bacce9f720ad552d0e342c52d3b4">commit_block</a>( <span class="keywordtype">bool</span> add_to_fork_db ) {</div>
<div class="line"><a id="l01828" name="l01828"></a><span class="lineno"> 1828</span>      <span class="keyword">auto</span> reset_pending_on_exit = <a class="code hl_function" href="namespacefc.html#a23d89b54a8ffd84f7e7efeb21747d846">fc::make_scoped_exit</a>([<span class="keyword">this</span>]{</div>
<div class="line"><a id="l01829" name="l01829"></a><span class="lineno"> 1829</span>         <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a0e355919fd924a05344ef2b59f7dd587">pending</a>.reset();</div>
<div class="line"><a id="l01830" name="l01830"></a><span class="lineno"> 1830</span>      });</div>
<div class="line"><a id="l01831" name="l01831"></a><span class="lineno"> 1831</span> </div>
<div class="line"><a id="l01832" name="l01832"></a><span class="lineno"> 1832</span>      <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l01833" name="l01833"></a><span class="lineno"> 1833</span>         <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( std::holds_alternative&lt;completed_block&gt;(<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a0e355919fd924a05344ef2b59f7dd587">pending</a>-&gt;_block_stage), <a class="code hl_variable" href="namespacesysio_1_1chain.html#a910243f6a0327fb2d4fc80f7e89f103e">block_validate_exception</a>,</div>
<div class="line"><a id="l01834" name="l01834"></a><span class="lineno"> 1834</span>                     <span class="stringliteral">&quot;cannot call commit_block until pending block is completed&quot;</span> );</div>
<div class="line"><a id="l01835" name="l01835"></a><span class="lineno"> 1835</span> </div>
<div class="line"><a id="l01836" name="l01836"></a><span class="lineno"> 1836</span>         <span class="keyword">auto</span> bsp = std::get&lt;completed_block&gt;(<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a0e355919fd924a05344ef2b59f7dd587">pending</a>-&gt;_block_stage)._block_state;</div>
<div class="line"><a id="l01837" name="l01837"></a><span class="lineno"> 1837</span> </div>
<div class="line"><a id="l01838" name="l01838"></a><span class="lineno"> 1838</span>         <span class="keywordflow">if</span>( add_to_fork_db ) {</div>
<div class="line"><a id="l01839" name="l01839"></a><span class="lineno"> 1839</span>            <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af7f72e6389799b7921aa98f30534f0d9">fork_db</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1fork__database.html#a97cf1402b71020048ae0054e4d7c8079">add</a>( bsp );</div>
<div class="line"><a id="l01840" name="l01840"></a><span class="lineno"> 1840</span>            <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af7f72e6389799b7921aa98f30534f0d9">fork_db</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1fork__database.html#a764fc46000bb93901ba6440fec07b5f9">mark_valid</a>( bsp );</div>
<div class="line"><a id="l01841" name="l01841"></a><span class="lineno"> 1841</span>            <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a6380e434da95a328ff48ccab33df9cb0">emit</a>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a64851fb4e041dc49ab22cf2ba335720d">self</a>.<a class="code hl_variable" href="classsysio_1_1chain_1_1controller.html#a0a0659166483870bf065f4d5e671484e">accepted_block_header</a>, bsp );</div>
<div class="line"><a id="l01842" name="l01842"></a><span class="lineno"> 1842</span>            <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a56a0f369b58e6597b62569ff2853ee90">head</a> = <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af7f72e6389799b7921aa98f30534f0d9">fork_db</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1fork__database.html#a3b128a7d57c262ef6351d83c16cffae3">head</a>();</div>
<div class="line"><a id="l01843" name="l01843"></a><span class="lineno"> 1843</span>            <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( bsp == <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a56a0f369b58e6597b62569ff2853ee90">head</a>, <a class="code hl_variable" href="namespacesysio_1_1chain.html#acad19c1ca23d796138841046c67b3ea9">fork_database_exception</a>, <span class="stringliteral">&quot;committed block did not become the new head in fork database&quot;</span>);</div>
<div class="line"><a id="l01844" name="l01844"></a><span class="lineno"> 1844</span>         }</div>
<div class="line"><a id="l01845" name="l01845"></a><span class="lineno"> 1845</span> </div>
<div class="line"><a id="l01846" name="l01846"></a><span class="lineno"> 1846</span>         <span class="keywordflow">if</span> (<span class="keyword">auto</span> dm_logger = <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a1b67831f3be3a668c170723427236954">get_deep_mind_logger</a>()) {</div>
<div class="line"><a id="l01847" name="l01847"></a><span class="lineno"> 1847</span>            dm_logger-&gt;on_accepted_block(bsp);</div>
<div class="line"><a id="l01848" name="l01848"></a><span class="lineno"> 1848</span>         }</div>
<div class="line"><a id="l01849" name="l01849"></a><span class="lineno"> 1849</span> </div>
<div class="line"><a id="l01850" name="l01850"></a><span class="lineno"> 1850</span>         <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a6380e434da95a328ff48ccab33df9cb0">emit</a>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a64851fb4e041dc49ab22cf2ba335720d">self</a>.<a class="code hl_variable" href="classsysio_1_1chain_1_1controller.html#a1ff3607461fff45552db45cec5aca012">accepted_block</a>, bsp );</div>
<div class="line"><a id="l01851" name="l01851"></a><span class="lineno"> 1851</span> </div>
<div class="line"><a id="l01852" name="l01852"></a><span class="lineno"> 1852</span>         <span class="keywordflow">if</span>( add_to_fork_db ) {</div>
<div class="line"><a id="l01853" name="l01853"></a><span class="lineno"> 1853</span>            <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#ad0130874bac31eb408dd6e766084b814">log_irreversible</a>();</div>
<div class="line"><a id="l01854" name="l01854"></a><span class="lineno"> 1854</span>         }</div>
<div class="line"><a id="l01855" name="l01855"></a><span class="lineno"> 1855</span>      } <span class="keywordflow">catch</span> (...) {</div>
<div class="line"><a id="l01856" name="l01856"></a><span class="lineno"> 1856</span>         <span class="comment">// dont bother resetting pending, instead abort the block</span></div>
<div class="line"><a id="l01857" name="l01857"></a><span class="lineno"> 1857</span>         reset_pending_on_exit.cancel();</div>
<div class="line"><a id="l01858" name="l01858"></a><span class="lineno"> 1858</span>         <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#aed82882c38a7b9a2ab8ccf26b7d68126">abort_block</a>();</div>
<div class="line"><a id="l01859" name="l01859"></a><span class="lineno"> 1859</span>         <span class="keywordflow">throw</span>;</div>
<div class="line"><a id="l01860" name="l01860"></a><span class="lineno"> 1860</span>      }</div>
<div class="line"><a id="l01861" name="l01861"></a><span class="lineno"> 1861</span> </div>
<div class="line"><a id="l01862" name="l01862"></a><span class="lineno"> 1862</span>      <span class="comment">// push the state for pending.</span></div>
<div class="line"><a id="l01863" name="l01863"></a><span class="lineno"> 1863</span>      <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a0e355919fd924a05344ef2b59f7dd587">pending</a>-&gt;push();</div>
<div class="line"><a id="l01864" name="l01864"></a><span class="lineno"> 1864</span>   }</div>
</div>
<div class="line"><a id="l01865" name="l01865"></a><span class="lineno"> 1865</span> </div>
<div class="foldopen" id="foldopen01875" data-start="{" data-end="}">
<div class="line"><a id="l01875" name="l01875"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#ae66494cb9657c0157ee468c21b545f60"> 1875</a></span>   <span class="keywordtype">void</span> <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#ae66494cb9657c0157ee468c21b545f60">check_protocol_features</a>( <a class="code hl_class" href="classsysio_1_1chain_1_1block__timestamp.html">block_timestamp_type</a> timestamp,</div>
<div class="line"><a id="l01876" name="l01876"></a><span class="lineno"> 1876</span>                                 <span class="keyword">const</span> flat_set&lt;digest_type&gt;&amp; currently_activated_protocol_features,</div>
<div class="line"><a id="l01877" name="l01877"></a><span class="lineno"> 1877</span>                                 <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1vector.html">vector&lt;digest_type&gt;</a>&amp; new_protocol_features )</div>
<div class="line"><a id="l01878" name="l01878"></a><span class="lineno"> 1878</span>   {</div>
<div class="line"><a id="l01879" name="l01879"></a><span class="lineno"> 1879</span>      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; pfs = <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a24a100a7be5e562ac3966924b0c9ccb6">protocol_features</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1protocol__feature__manager.html#a9e6c1310749c4fd04035aa2c01310ce4">get_protocol_feature_set</a>();</div>
<div class="line"><a id="l01880" name="l01880"></a><span class="lineno"> 1880</span> </div>
<div class="line"><a id="l01881" name="l01881"></a><span class="lineno"> 1881</span>      <span class="keywordflow">for</span>( <span class="keyword">auto</span> itr = new_protocol_features.begin(); itr != new_protocol_features.end(); ++itr ) {</div>
<div class="line"><a id="l01882" name="l01882"></a><span class="lineno"> 1882</span>         <span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code hl_variable" href="_x02-_disabled_macros_8cpp.html#ae28240b98d91d6eb7da702b770490f39">f</a> = *itr;</div>
<div class="line"><a id="l01883" name="l01883"></a><span class="lineno"> 1883</span> </div>
<div class="line"><a id="l01884" name="l01884"></a><span class="lineno"> 1884</span>         <span class="keyword">auto</span> status = pfs.is_recognized( <a class="code hl_variable" href="_x02-_disabled_macros_8cpp.html#ae28240b98d91d6eb7da702b770490f39">f</a>, timestamp );</div>
<div class="line"><a id="l01885" name="l01885"></a><span class="lineno"> 1885</span>         <span class="keywordflow">switch</span>( status ) {</div>
<div class="line"><a id="l01886" name="l01886"></a><span class="lineno"> 1886</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classsysio_1_1chain_1_1protocol__feature__set.html#a1d6d013242864bc12ae2a1f6fcc95427a96d8e9e3b92248258403f7fc4cb25644">protocol_feature_set::recognized_t::unrecognized</a>:</div>
<div class="line"><a id="l01887" name="l01887"></a><span class="lineno"> 1887</span>               <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a1bfa656552ea0534b2c91ee0fe33f850">SYS_THROW</a>( protocol_feature_exception,</div>
<div class="line"><a id="l01888" name="l01888"></a><span class="lineno"> 1888</span>                          <span class="stringliteral">&quot;protocol feature with digest &#39;${digest}&#39; is unrecognized&quot;</span>, (<span class="stringliteral">&quot;digest&quot;</span>, <a class="code hl_variable" href="_x02-_disabled_macros_8cpp.html#ae28240b98d91d6eb7da702b770490f39">f</a>) );</div>
<div class="line"><a id="l01889" name="l01889"></a><span class="lineno"> 1889</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01890" name="l01890"></a><span class="lineno"> 1890</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classsysio_1_1chain_1_1protocol__feature__set.html#a1d6d013242864bc12ae2a1f6fcc95427a075ae3d2fc31640504f814f60e5ef713">protocol_feature_set::recognized_t::disabled</a>:</div>
<div class="line"><a id="l01891" name="l01891"></a><span class="lineno"> 1891</span>               <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a1bfa656552ea0534b2c91ee0fe33f850">SYS_THROW</a>( protocol_feature_exception,</div>
<div class="line"><a id="l01892" name="l01892"></a><span class="lineno"> 1892</span>                          <span class="stringliteral">&quot;protocol feature with digest &#39;${digest}&#39; is disabled&quot;</span>, (<span class="stringliteral">&quot;digest&quot;</span>, <a class="code hl_variable" href="_x02-_disabled_macros_8cpp.html#ae28240b98d91d6eb7da702b770490f39">f</a>) );</div>
<div class="line"><a id="l01893" name="l01893"></a><span class="lineno"> 1893</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01894" name="l01894"></a><span class="lineno"> 1894</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classsysio_1_1chain_1_1protocol__feature__set.html#a1d6d013242864bc12ae2a1f6fcc95427a5d203566b82250f4113257b6db12e488">protocol_feature_set::recognized_t::too_early</a>:</div>
<div class="line"><a id="l01895" name="l01895"></a><span class="lineno"> 1895</span>               <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a1bfa656552ea0534b2c91ee0fe33f850">SYS_THROW</a>( protocol_feature_exception,</div>
<div class="line"><a id="l01896" name="l01896"></a><span class="lineno"> 1896</span>                          <span class="stringliteral">&quot;${timestamp} is too early for the earliest allowed activation time of the protocol feature with digest &#39;${digest}&#39;&quot;</span>, (<span class="stringliteral">&quot;digest&quot;</span>, <a class="code hl_variable" href="_x02-_disabled_macros_8cpp.html#ae28240b98d91d6eb7da702b770490f39">f</a>)(<span class="stringliteral">&quot;timestamp&quot;</span>, timestamp) );</div>
<div class="line"><a id="l01897" name="l01897"></a><span class="lineno"> 1897</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01898" name="l01898"></a><span class="lineno"> 1898</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classsysio_1_1chain_1_1protocol__feature__set.html#a1d6d013242864bc12ae2a1f6fcc95427ab2fdab230a2c39f3595a947861863cb7">protocol_feature_set::recognized_t::ready</a>:</div>
<div class="line"><a id="l01899" name="l01899"></a><span class="lineno"> 1899</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01900" name="l01900"></a><span class="lineno"> 1900</span>            <span class="keywordflow">default</span>:</div>
<div class="line"><a id="l01901" name="l01901"></a><span class="lineno"> 1901</span>               <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a1bfa656552ea0534b2c91ee0fe33f850">SYS_THROW</a>( protocol_feature_exception, <span class="stringliteral">&quot;unexpected recognized_t status&quot;</span> );</div>
<div class="line"><a id="l01902" name="l01902"></a><span class="lineno"> 1902</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01903" name="l01903"></a><span class="lineno"> 1903</span>         }</div>
<div class="line"><a id="l01904" name="l01904"></a><span class="lineno"> 1904</span> </div>
<div class="line"><a id="l01905" name="l01905"></a><span class="lineno"> 1905</span>         <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( currently_activated_protocol_features.find( <a class="code hl_variable" href="_x02-_disabled_macros_8cpp.html#ae28240b98d91d6eb7da702b770490f39">f</a> ) == currently_activated_protocol_features.end(),</div>
<div class="line"><a id="l01906" name="l01906"></a><span class="lineno"> 1906</span>                     protocol_feature_exception,</div>
<div class="line"><a id="l01907" name="l01907"></a><span class="lineno"> 1907</span>                     <span class="stringliteral">&quot;protocol feature with digest &#39;${digest}&#39; has already been activated&quot;</span>,</div>
<div class="line"><a id="l01908" name="l01908"></a><span class="lineno"> 1908</span>                     (<span class="stringliteral">&quot;digest&quot;</span>, <a class="code hl_variable" href="_x02-_disabled_macros_8cpp.html#ae28240b98d91d6eb7da702b770490f39">f</a>)</div>
<div class="line"><a id="l01909" name="l01909"></a><span class="lineno"> 1909</span>         );</div>
<div class="line"><a id="l01910" name="l01910"></a><span class="lineno"> 1910</span> </div>
<div class="line"><a id="l01911" name="l01911"></a><span class="lineno"> 1911</span>         <span class="keyword">auto</span> dependency_checker = [&amp;currently_activated_protocol_features, &amp;new_protocol_features, &amp;itr]</div>
<div class="line"><a id="l01912" name="l01912"></a><span class="lineno"> 1912</span>                                   ( <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1sha256.html">digest_type</a>&amp; <a class="code hl_variable" href="_x02-_disabled_macros_8cpp.html#ae28240b98d91d6eb7da702b770490f39">f</a> ) -&gt; <span class="keywordtype">bool</span></div>
<div class="line"><a id="l01913" name="l01913"></a><span class="lineno"> 1913</span>         {</div>
<div class="line"><a id="l01914" name="l01914"></a><span class="lineno"> 1914</span>            <span class="keywordflow">if</span>( currently_activated_protocol_features.find( <a class="code hl_variable" href="_x02-_disabled_macros_8cpp.html#ae28240b98d91d6eb7da702b770490f39">f</a> ) != currently_activated_protocol_features.end() )</div>
<div class="line"><a id="l01915" name="l01915"></a><span class="lineno"> 1915</span>               <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01916" name="l01916"></a><span class="lineno"> 1916</span> </div>
<div class="line"><a id="l01917" name="l01917"></a><span class="lineno"> 1917</span>            <span class="keywordflow">return</span> (std::find( new_protocol_features.begin(), itr, <a class="code hl_variable" href="_x02-_disabled_macros_8cpp.html#ae28240b98d91d6eb7da702b770490f39">f</a> ) != itr);</div>
<div class="line"><a id="l01918" name="l01918"></a><span class="lineno"> 1918</span>         };</div>
<div class="line"><a id="l01919" name="l01919"></a><span class="lineno"> 1919</span> </div>
<div class="line"><a id="l01920" name="l01920"></a><span class="lineno"> 1920</span>         <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( pfs.validate_dependencies( <a class="code hl_variable" href="_x02-_disabled_macros_8cpp.html#ae28240b98d91d6eb7da702b770490f39">f</a>, dependency_checker ), protocol_feature_exception,</div>
<div class="line"><a id="l01921" name="l01921"></a><span class="lineno"> 1921</span>                     <span class="stringliteral">&quot;not all dependencies of protocol feature with digest &#39;${digest}&#39; have been activated&quot;</span>,</div>
<div class="line"><a id="l01922" name="l01922"></a><span class="lineno"> 1922</span>                     (<span class="stringliteral">&quot;digest&quot;</span>, <a class="code hl_variable" href="_x02-_disabled_macros_8cpp.html#ae28240b98d91d6eb7da702b770490f39">f</a>)</div>
<div class="line"><a id="l01923" name="l01923"></a><span class="lineno"> 1923</span>         );</div>
<div class="line"><a id="l01924" name="l01924"></a><span class="lineno"> 1924</span>      }</div>
<div class="line"><a id="l01925" name="l01925"></a><span class="lineno"> 1925</span>   }</div>
</div>
<div class="line"><a id="l01926" name="l01926"></a><span class="lineno"> 1926</span> </div>
<div class="foldopen" id="foldopen01927" data-start="{" data-end="}">
<div class="line"><a id="l01927" name="l01927"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#af932f3160706510eaf30e2b76f386973"> 1927</a></span>   <span class="keywordtype">void</span> <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#af932f3160706510eaf30e2b76f386973">report_block_header_diff</a>( <span class="keyword">const</span> <a class="code hl_struct" href="structsysio_1_1chain_1_1block__header.html">block_header</a>&amp; b, <span class="keyword">const</span> <a class="code hl_struct" href="structsysio_1_1chain_1_1block__header.html">block_header</a>&amp; ab ) {</div>
<div class="line"><a id="l01928" name="l01928"></a><span class="lineno"> 1928</span> </div>
<div class="line"><a id="l01929" name="l01929"></a><span class="lineno"> 1929</span><span class="preprocessor">#define SYS_REPORT(DESC,A,B) \</span></div>
<div class="line"><a id="l01930" name="l01930"></a><span class="lineno"> 1930</span><span class="preprocessor">   if( A != B ) { \</span></div>
<div class="line"><a id="l01931" name="l01931"></a><span class="lineno"> 1931</span><span class="preprocessor">      elog(&quot;${desc}: ${bv} != ${abv}&quot;, (&quot;desc&quot;, DESC)(&quot;bv&quot;, A)(&quot;abv&quot;, B)); \</span></div>
<div class="line"><a id="l01932" name="l01932"></a><span class="lineno"> 1932</span><span class="preprocessor">   }</span></div>
<div class="line"><a id="l01933" name="l01933"></a><span class="lineno"> 1933</span> </div>
<div class="line"><a id="l01934" name="l01934"></a><span class="lineno"> 1934</span>      <a class="code hl_define" href="controller_8cpp.html#aefcef1ac3f0ac4f01876837e1e9f66d7">SYS_REPORT</a>( <span class="stringliteral">&quot;timestamp&quot;</span>, b.<a class="code hl_variable" href="structsysio_1_1chain_1_1block__header.html#a0fe1e5860e2b78b0a14da6565e2294bb">timestamp</a>, ab.<a class="code hl_variable" href="structsysio_1_1chain_1_1block__header.html#a0fe1e5860e2b78b0a14da6565e2294bb">timestamp</a> )</div>
<div class="line"><a id="l01935" name="l01935"></a><span class="lineno"> 1935</span>      <a class="code hl_define" href="controller_8cpp.html#aefcef1ac3f0ac4f01876837e1e9f66d7">SYS_REPORT</a>( <span class="stringliteral">&quot;producer&quot;</span>, b.<a class="code hl_variable" href="structsysio_1_1chain_1_1block__header.html#ab73cce40ff45b968f3d9283d7ce1fcbd">producer</a>, ab.<a class="code hl_variable" href="structsysio_1_1chain_1_1block__header.html#ab73cce40ff45b968f3d9283d7ce1fcbd">producer</a> )</div>
<div class="line"><a id="l01936" name="l01936"></a><span class="lineno"> 1936</span>      <a class="code hl_define" href="controller_8cpp.html#aefcef1ac3f0ac4f01876837e1e9f66d7">SYS_REPORT</a>( <span class="stringliteral">&quot;confirmed&quot;</span>, b.<a class="code hl_variable" href="structsysio_1_1chain_1_1block__header.html#a2d039a5279169467dd1b3dae80ff2be3">confirmed</a>, ab.<a class="code hl_variable" href="structsysio_1_1chain_1_1block__header.html#a2d039a5279169467dd1b3dae80ff2be3">confirmed</a> )</div>
<div class="line"><a id="l01937" name="l01937"></a><span class="lineno"> 1937</span>      <a class="code hl_define" href="controller_8cpp.html#aefcef1ac3f0ac4f01876837e1e9f66d7">SYS_REPORT</a>( <span class="stringliteral">&quot;previous&quot;</span>, b.<a class="code hl_variable" href="structsysio_1_1chain_1_1block__header.html#a449ed3d87648accf54bd0eae4424a3df">previous</a>, ab.<a class="code hl_variable" href="structsysio_1_1chain_1_1block__header.html#a449ed3d87648accf54bd0eae4424a3df">previous</a> )</div>
<div class="line"><a id="l01938" name="l01938"></a><span class="lineno"> 1938</span>      <a class="code hl_define" href="controller_8cpp.html#aefcef1ac3f0ac4f01876837e1e9f66d7">SYS_REPORT</a>( <span class="stringliteral">&quot;transaction_mroot&quot;</span>, b.<a class="code hl_variable" href="structsysio_1_1chain_1_1block__header.html#a2e1b24b48c9bbbe2d56ba6db5666673d">transaction_mroot</a>, ab.<a class="code hl_variable" href="structsysio_1_1chain_1_1block__header.html#a2e1b24b48c9bbbe2d56ba6db5666673d">transaction_mroot</a> )</div>
<div class="line"><a id="l01939" name="l01939"></a><span class="lineno"> 1939</span>      <a class="code hl_define" href="controller_8cpp.html#aefcef1ac3f0ac4f01876837e1e9f66d7">SYS_REPORT</a>( <span class="stringliteral">&quot;action_mroot&quot;</span>, b.<a class="code hl_variable" href="structsysio_1_1chain_1_1block__header.html#a4096ec8f931ab9180ae80f6e06332103">action_mroot</a>, ab.<a class="code hl_variable" href="structsysio_1_1chain_1_1block__header.html#a4096ec8f931ab9180ae80f6e06332103">action_mroot</a> )</div>
<div class="line"><a id="l01940" name="l01940"></a><span class="lineno"> 1940</span>      <a class="code hl_define" href="controller_8cpp.html#aefcef1ac3f0ac4f01876837e1e9f66d7">SYS_REPORT</a>( <span class="stringliteral">&quot;schedule_version&quot;</span>, b.<a class="code hl_variable" href="structsysio_1_1chain_1_1block__header.html#a8529628ed392b72693f23a636814172f">schedule_version</a>, ab.<a class="code hl_variable" href="structsysio_1_1chain_1_1block__header.html#a8529628ed392b72693f23a636814172f">schedule_version</a> )</div>
<div class="line"><a id="l01941" name="l01941"></a><span class="lineno"> 1941</span>      <a class="code hl_define" href="controller_8cpp.html#aefcef1ac3f0ac4f01876837e1e9f66d7">SYS_REPORT</a>( <span class="stringliteral">&quot;new_producers&quot;</span>, b.<a class="code hl_variable" href="structsysio_1_1chain_1_1block__header.html#afbddec026595d42b3a280f8c0fddf336">new_producers</a>, ab.<a class="code hl_variable" href="structsysio_1_1chain_1_1block__header.html#afbddec026595d42b3a280f8c0fddf336">new_producers</a> )</div>
<div class="line"><a id="l01942" name="l01942"></a><span class="lineno"> 1942</span>      <a class="code hl_define" href="controller_8cpp.html#aefcef1ac3f0ac4f01876837e1e9f66d7">SYS_REPORT</a>( <span class="stringliteral">&quot;header_extensions&quot;</span>, b.<a class="code hl_variable" href="structsysio_1_1chain_1_1block__header.html#a8b87aa5950dbd992025ff7c213b1858a">header_extensions</a>, ab.<a class="code hl_variable" href="structsysio_1_1chain_1_1block__header.html#a8b87aa5950dbd992025ff7c213b1858a">header_extensions</a> )</div>
<div class="line"><a id="l01943" name="l01943"></a><span class="lineno"> 1943</span> </div>
<div class="line"><a id="l01944" name="l01944"></a><span class="lineno"> 1944</span><span class="preprocessor">#undef SYS_REPORT</span></div>
<div class="line"><a id="l01945" name="l01945"></a><span class="lineno"> 1945</span>   }</div>
</div>
<div class="line"><a id="l01946" name="l01946"></a><span class="lineno"> 1946</span> </div>
<div class="line"><a id="l01947" name="l01947"></a><span class="lineno"> 1947</span> </div>
<div class="foldopen" id="foldopen01948" data-start="{" data-end="}">
<div class="line"><a id="l01948" name="l01948"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#aaf795677a1a49a35ac1a819a1a157929"> 1948</a></span>   <span class="keywordtype">void</span> <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#aaf795677a1a49a35ac1a819a1a157929">apply_block</a>( <span class="keyword">const</span> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#ab9b14f4554cc4a0da2c361e9757b1662">block_state_ptr</a>&amp; bsp, <a class="code hl_enumeration" href="classsysio_1_1chain_1_1controller.html#a8b5124e077de1a73bb193e9c72b366b6">controller::block_status</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a>, <span class="keyword">const</span> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#ad7e9cbb02002c4e7ab9825becb9f9f50">trx_meta_cache_lookup</a>&amp; trx_lookup )</div>
<div class="line"><a id="l01949" name="l01949"></a><span class="lineno"> 1949</span>   { <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l01950" name="l01950"></a><span class="lineno"> 1950</span>      <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l01951" name="l01951"></a><span class="lineno"> 1951</span>         <span class="keyword">const</span> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#aa10ee348c57604b615bc8570f6685102">signed_block_ptr</a>&amp; b = bsp-&gt;block;</div>
<div class="line"><a id="l01952" name="l01952"></a><span class="lineno"> 1952</span>         <span class="keyword">const</span> <span class="keyword">auto</span>&amp; new_protocol_feature_activations = bsp-&gt;get_new_protocol_feature_activations();</div>
<div class="line"><a id="l01953" name="l01953"></a><span class="lineno"> 1953</span> </div>
<div class="line"><a id="l01954" name="l01954"></a><span class="lineno"> 1954</span>         <span class="keyword">auto</span> producer_block_id = bsp-&gt;id;</div>
<div class="line"><a id="l01955" name="l01955"></a><span class="lineno"> 1955</span>         <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a9dbf7da25185959b9a8ea1bf7a47a566">start_block</a>( b-&gt;timestamp, b-&gt;confirmed, new_protocol_feature_activations, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a>, producer_block_id, <a class="code hl_function" href="classfc_1_1time__point.html#aeccf1b70aa34b132c5269313b8a50573">fc::time_point::maximum</a>() );</div>
<div class="line"><a id="l01956" name="l01956"></a><span class="lineno"> 1956</span> </div>
<div class="line"><a id="l01957" name="l01957"></a><span class="lineno"> 1957</span>         <span class="keyword">const</span> <span class="keywordtype">bool</span> existing_trxs_metas = !bsp-&gt;trxs_metas().empty();</div>
<div class="line"><a id="l01958" name="l01958"></a><span class="lineno"> 1958</span>         <span class="keyword">const</span> <span class="keywordtype">bool</span> pub_keys_recovered = bsp-&gt;is_pub_keys_recovered();</div>
<div class="line"><a id="l01959" name="l01959"></a><span class="lineno"> 1959</span>         <span class="keyword">const</span> <span class="keywordtype">bool</span> skip_auth_checks = <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a64851fb4e041dc49ab22cf2ba335720d">self</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a42a29a059b847799ae3a75953b6bff1e">skip_auth_check</a>();</div>
<div class="line"><a id="l01960" name="l01960"></a><span class="lineno"> 1960</span>         std::vector&lt;std::tuple&lt;transaction_metadata_ptr, recover_keys_future&gt;&gt; trx_metas;</div>
<div class="line"><a id="l01961" name="l01961"></a><span class="lineno"> 1961</span>         <span class="keywordtype">bool</span> use_bsp_cached = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01962" name="l01962"></a><span class="lineno"> 1962</span>         <span class="keywordflow">if</span>( pub_keys_recovered || (skip_auth_checks &amp;&amp; existing_trxs_metas) ) {</div>
<div class="line"><a id="l01963" name="l01963"></a><span class="lineno"> 1963</span>            use_bsp_cached = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01964" name="l01964"></a><span class="lineno"> 1964</span>         } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01965" name="l01965"></a><span class="lineno"> 1965</span>            trx_metas.reserve( b-&gt;transactions.size() );</div>
<div class="line"><a id="l01966" name="l01966"></a><span class="lineno"> 1966</span>            <span class="keywordflow">for</span>( <span class="keyword">const</span> <span class="keyword">auto</span>&amp; receipt : b-&gt;transactions ) {</div>
<div class="line"><a id="l01967" name="l01967"></a><span class="lineno"> 1967</span>               <span class="keywordflow">if</span>( std::holds_alternative&lt;packed_transaction&gt;(receipt.trx)) {</div>
<div class="line"><a id="l01968" name="l01968"></a><span class="lineno"> 1968</span>                  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; pt = std::get&lt;packed_transaction&gt;(receipt.trx);</div>
<div class="line"><a id="l01969" name="l01969"></a><span class="lineno"> 1969</span>                  <a class="code hl_typedef" href="namespacesysio_1_1chain.html#ad795329e0af850251f4f47cc32e8d770">transaction_metadata_ptr</a> trx_meta_ptr = trx_lookup ? trx_lookup( pt.id() ) : <a class="code hl_typedef" href="namespacesysio_1_1chain.html#ad795329e0af850251f4f47cc32e8d770">transaction_metadata_ptr</a>{};</div>
<div class="line"><a id="l01970" name="l01970"></a><span class="lineno"> 1970</span>                  <span class="keywordflow">if</span>( trx_meta_ptr &amp;&amp; *trx_meta_ptr-&gt;packed_trx() != pt ) trx_meta_ptr = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l01971" name="l01971"></a><span class="lineno"> 1971</span>                  <span class="keywordflow">if</span>( trx_meta_ptr &amp;&amp; ( skip_auth_checks || !trx_meta_ptr-&gt;recovered_keys().empty() ) ) {</div>
<div class="line"><a id="l01972" name="l01972"></a><span class="lineno"> 1972</span>                     trx_metas.emplace_back( std::move( trx_meta_ptr ), <a class="code hl_typedef" href="namespacesysio_1_1chain.html#a036ea97f093bf3270bd2c9a097cbcaba">recover_keys_future</a>{} );</div>
<div class="line"><a id="l01973" name="l01973"></a><span class="lineno"> 1973</span>                  } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( skip_auth_checks ) {</div>
<div class="line"><a id="l01974" name="l01974"></a><span class="lineno"> 1974</span>                     <a class="code hl_typedef" href="namespacesysio_1_1chain.html#a7041c0316bd294d0866609ab3e0cc7a7">packed_transaction_ptr</a> ptrx( b, &amp;pt ); <span class="comment">// alias signed_block_ptr</span></div>
<div class="line"><a id="l01975" name="l01975"></a><span class="lineno"> 1975</span>                     trx_metas.emplace_back(</div>
<div class="line"><a id="l01976" name="l01976"></a><span class="lineno"> 1976</span>                           <a class="code hl_function" href="classsysio_1_1chain_1_1transaction__metadata.html#acb14de2d02033c2d43c65319825d3d5b">transaction_metadata::create_no_recover_keys</a>( std::move(ptrx), <a class="code hl_enumvalue" href="classsysio_1_1chain_1_1transaction__metadata.html#a841053d8fa06ceea3cb8096625f053edaa43c1b0aa53a0c908810c06ab1ff3967">transaction_metadata::trx_type::input</a> ),</div>
<div class="line"><a id="l01977" name="l01977"></a><span class="lineno"> 1977</span>                           <a class="code hl_typedef" href="namespacesysio_1_1chain.html#a036ea97f093bf3270bd2c9a097cbcaba">recover_keys_future</a>{} );</div>
<div class="line"><a id="l01978" name="l01978"></a><span class="lineno"> 1978</span>                  } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01979" name="l01979"></a><span class="lineno"> 1979</span>                     <a class="code hl_typedef" href="namespacesysio_1_1chain.html#a7041c0316bd294d0866609ab3e0cc7a7">packed_transaction_ptr</a> ptrx( b, &amp;pt ); <span class="comment">// alias signed_block_ptr</span></div>
<div class="line"><a id="l01980" name="l01980"></a><span class="lineno"> 1980</span>                     <span class="keyword">auto</span> fut = <a class="code hl_function" href="classsysio_1_1chain_1_1transaction__metadata.html#a122861328470aa67ebf9ac5cb798755d">transaction_metadata::start_recover_keys</a>(</div>
<div class="line"><a id="l01981" name="l01981"></a><span class="lineno"> 1981</span>                           std::move( ptrx ), <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#ab76d9091b7e62fb25a0fdd63c8210af9">thread_pool</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1named__thread__pool.html#ae2f5fa4611193d13bb40e34708d897ea">get_executor</a>(), <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a2f7115cf9c5daa3abca8e0467dce5a5a">chain_id</a>, <a class="code hl_function" href="classfc_1_1microseconds.html#afc3eb0bfd792c7b1cda062e559e30c2e">microseconds::maximum</a>(), <a class="code hl_enumvalue" href="classsysio_1_1chain_1_1transaction__metadata.html#a841053d8fa06ceea3cb8096625f053edaa43c1b0aa53a0c908810c06ab1ff3967">transaction_metadata::trx_type::input</a>  );</div>
<div class="line"><a id="l01982" name="l01982"></a><span class="lineno"> 1982</span>                     trx_metas.emplace_back( <a class="code hl_typedef" href="namespacesysio_1_1chain.html#ad795329e0af850251f4f47cc32e8d770">transaction_metadata_ptr</a>{}, std::move( fut ) );</div>
<div class="line"><a id="l01983" name="l01983"></a><span class="lineno"> 1983</span>                  }</div>
<div class="line"><a id="l01984" name="l01984"></a><span class="lineno"> 1984</span>               }</div>
<div class="line"><a id="l01985" name="l01985"></a><span class="lineno"> 1985</span>            }</div>
<div class="line"><a id="l01986" name="l01986"></a><span class="lineno"> 1986</span>         }</div>
<div class="line"><a id="l01987" name="l01987"></a><span class="lineno"> 1987</span> </div>
<div class="line"><a id="l01988" name="l01988"></a><span class="lineno"> 1988</span>         <a class="code hl_typedef" href="namespacesysio_1_1chain.html#a4ee2867a6bec961c7a78b203cfd76be9">transaction_trace_ptr</a> trace;</div>
<div class="line"><a id="l01989" name="l01989"></a><span class="lineno"> 1989</span> </div>
<div class="line"><a id="l01990" name="l01990"></a><span class="lineno"> 1990</span>         <span class="keywordtype">size_t</span> packed_idx = 0;</div>
<div class="line"><a id="l01991" name="l01991"></a><span class="lineno"> 1991</span>         <span class="keywordflow">for</span>( <span class="keyword">const</span> <span class="keyword">auto</span>&amp; receipt : b-&gt;transactions ) {</div>
<div class="line"><a id="l01992" name="l01992"></a><span class="lineno"> 1992</span>            <span class="keyword">const</span> <span class="keyword">auto</span>&amp; trx_receipts = std::get&lt;building_block&gt;(<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a0e355919fd924a05344ef2b59f7dd587">pending</a>-&gt;_block_stage)._pending_trx_receipts;</div>
<div class="line"><a id="l01993" name="l01993"></a><span class="lineno"> 1993</span>            <span class="keyword">auto</span> num_pending_receipts = trx_receipts.size();</div>
<div class="line"><a id="l01994" name="l01994"></a><span class="lineno"> 1994</span>            <span class="keywordflow">if</span>( std::holds_alternative&lt;packed_transaction&gt;(receipt.trx) ) {</div>
<div class="line"><a id="l01995" name="l01995"></a><span class="lineno"> 1995</span>               <span class="keyword">const</span> <span class="keyword">auto</span>&amp; trx_meta = ( use_bsp_cached ? bsp-&gt;trxs_metas().at( packed_idx )</div>
<div class="line"><a id="l01996" name="l01996"></a><span class="lineno"> 1996</span>                                                       : ( !!std::get&lt;0&gt;( trx_metas.at( packed_idx ) ) ?</div>
<div class="line"><a id="l01997" name="l01997"></a><span class="lineno"> 1997</span>                                                             std::get&lt;0&gt;( trx_metas.at( packed_idx ) )</div>
<div class="line"><a id="l01998" name="l01998"></a><span class="lineno"> 1998</span>                                                             : std::get&lt;1&gt;( trx_metas.at( packed_idx ) ).get() ) );</div>
<div class="line"><a id="l01999" name="l01999"></a><span class="lineno"> 1999</span>               trace = <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#af381eb0fcede18ab0ae4cddaaa9df6cd">push_transaction</a>( trx_meta, <a class="code hl_function" href="classfc_1_1time__point.html#aeccf1b70aa34b132c5269313b8a50573">fc::time_point::maximum</a>(), <a class="code hl_function" href="classfc_1_1microseconds.html#afc3eb0bfd792c7b1cda062e559e30c2e">fc::microseconds::maximum</a>(), receipt.cpu_usage_us, <span class="keyword">true</span>, 0 );</div>
<div class="line"><a id="l02000" name="l02000"></a><span class="lineno"> 2000</span>               ++packed_idx;</div>
<div class="line"><a id="l02001" name="l02001"></a><span class="lineno"> 2001</span>            } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( std::holds_alternative&lt;transaction_id_type&gt;(receipt.trx) ) {</div>
<div class="line"><a id="l02002" name="l02002"></a><span class="lineno"> 2002</span>               trace = <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a148db3e15c5b5a5cd3fd6b42799d1152">push_scheduled_transaction</a>( std::get&lt;transaction_id_type&gt;(receipt.trx), <a class="code hl_function" href="classfc_1_1time__point.html#aeccf1b70aa34b132c5269313b8a50573">fc::time_point::maximum</a>(), <a class="code hl_function" href="classfc_1_1microseconds.html#afc3eb0bfd792c7b1cda062e559e30c2e">fc::microseconds::maximum</a>(), receipt.cpu_usage_us, <span class="keyword">true</span> );</div>
<div class="line"><a id="l02003" name="l02003"></a><span class="lineno"> 2003</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l02004" name="l02004"></a><span class="lineno"> 2004</span>               <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( <span class="keyword">false</span>, <a class="code hl_variable" href="namespacesysio_1_1chain.html#a910243f6a0327fb2d4fc80f7e89f103e">block_validate_exception</a>, <span class="stringliteral">&quot;encountered unexpected receipt type&quot;</span> );</div>
<div class="line"><a id="l02005" name="l02005"></a><span class="lineno"> 2005</span>            }</div>
<div class="line"><a id="l02006" name="l02006"></a><span class="lineno"> 2006</span> </div>
<div class="line"><a id="l02007" name="l02007"></a><span class="lineno"> 2007</span>            <span class="keywordtype">bool</span> transaction_failed =  trace &amp;&amp; trace-&gt;except;</div>
<div class="line"><a id="l02008" name="l02008"></a><span class="lineno"> 2008</span>            <span class="keywordtype">bool</span> transaction_can_fail = receipt.status == <a class="code hl_enumvalue" href="structsysio_1_1chain_1_1transaction__receipt__header.html#a2bb00bac16048e6f624c2ded867ebf55ac705728ca8b5f3a44d8026e14990c463">transaction_receipt_header::hard_fail</a> &amp;&amp; std::holds_alternative&lt;transaction_id_type&gt;(receipt.trx);</div>
<div class="line"><a id="l02009" name="l02009"></a><span class="lineno"> 2009</span>            <span class="keywordflow">if</span>( transaction_failed &amp;&amp; !transaction_can_fail) {</div>
<div class="line"><a id="l02010" name="l02010"></a><span class="lineno"> 2010</span>               <a class="code hl_define" href="logger_8hpp.html#a26aaf645dd9dc96836635d6b18bd1090">edump</a>((*trace));</div>
<div class="line"><a id="l02011" name="l02011"></a><span class="lineno"> 2011</span>               <span class="keywordflow">throw</span> *trace-&gt;except;</div>
<div class="line"><a id="l02012" name="l02012"></a><span class="lineno"> 2012</span>            }</div>
<div class="line"><a id="l02013" name="l02013"></a><span class="lineno"> 2013</span> </div>
<div class="line"><a id="l02014" name="l02014"></a><span class="lineno"> 2014</span>            <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( trx_receipts.size() &gt; 0,</div>
<div class="line"><a id="l02015" name="l02015"></a><span class="lineno"> 2015</span>                        <a class="code hl_variable" href="namespacesysio_1_1chain.html#a910243f6a0327fb2d4fc80f7e89f103e">block_validate_exception</a>, <span class="stringliteral">&quot;expected a receipt, block_num ${bn}, block_id ${id}, receipt ${e}&quot;</span>,</div>
<div class="line"><a id="l02016" name="l02016"></a><span class="lineno"> 2016</span>                        (<span class="stringliteral">&quot;bn&quot;</span>, b-&gt;block_num())(<span class="stringliteral">&quot;id&quot;</span>, producer_block_id)(<span class="stringliteral">&quot;e&quot;</span>, receipt)</div>
<div class="line"><a id="l02017" name="l02017"></a><span class="lineno"> 2017</span>                      );</div>
<div class="line"><a id="l02018" name="l02018"></a><span class="lineno"> 2018</span>            <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( trx_receipts.size() == num_pending_receipts + 1,</div>
<div class="line"><a id="l02019" name="l02019"></a><span class="lineno"> 2019</span>                        <a class="code hl_variable" href="namespacesysio_1_1chain.html#a910243f6a0327fb2d4fc80f7e89f103e">block_validate_exception</a>, <span class="stringliteral">&quot;expected receipt was not added, block_num ${bn}, block_id ${id}, receipt ${e}&quot;</span>,</div>
<div class="line"><a id="l02020" name="l02020"></a><span class="lineno"> 2020</span>                        (<span class="stringliteral">&quot;bn&quot;</span>, b-&gt;block_num())(<span class="stringliteral">&quot;id&quot;</span>, producer_block_id)(<span class="stringliteral">&quot;e&quot;</span>, receipt)</div>
<div class="line"><a id="l02021" name="l02021"></a><span class="lineno"> 2021</span>                      );</div>
<div class="line"><a id="l02022" name="l02022"></a><span class="lineno"> 2022</span>            <span class="keyword">const</span> <a class="code hl_struct" href="structsysio_1_1chain_1_1transaction__receipt__header.html">transaction_receipt_header</a>&amp; <a class="code hl_variable" href="bn_8cpp.html#af0a5201ca8846f05f25435b41d7f39f7">r</a> = trx_receipts.back();</div>
<div class="line"><a id="l02023" name="l02023"></a><span class="lineno"> 2023</span>            <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( <a class="code hl_variable" href="bn_8cpp.html#af0a5201ca8846f05f25435b41d7f39f7">r</a> == <span class="keyword">static_cast&lt;</span><span class="keyword">const </span><a class="code hl_struct" href="structsysio_1_1chain_1_1transaction__receipt__header.html">transaction_receipt_header</a>&amp;<span class="keyword">&gt;</span>(receipt),</div>
<div class="line"><a id="l02024" name="l02024"></a><span class="lineno"> 2024</span>                        <a class="code hl_variable" href="namespacesysio_1_1chain.html#a910243f6a0327fb2d4fc80f7e89f103e">block_validate_exception</a>, <span class="stringliteral">&quot;receipt does not match, ${lhs} != ${rhs}&quot;</span>,</div>
<div class="line"><a id="l02025" name="l02025"></a><span class="lineno"> 2025</span>                        (<span class="stringliteral">&quot;lhs&quot;</span>, <a class="code hl_variable" href="bn_8cpp.html#af0a5201ca8846f05f25435b41d7f39f7">r</a>)(<span class="stringliteral">&quot;rhs&quot;</span>, <span class="keyword">static_cast&lt;</span><span class="keyword">const </span><a class="code hl_struct" href="structsysio_1_1chain_1_1transaction__receipt__header.html">transaction_receipt_header</a>&amp;<span class="keyword">&gt;</span>(receipt)) );</div>
<div class="line"><a id="l02026" name="l02026"></a><span class="lineno"> 2026</span>         }</div>
<div class="line"><a id="l02027" name="l02027"></a><span class="lineno"> 2027</span> </div>
<div class="line"><a id="l02028" name="l02028"></a><span class="lineno"> 2028</span>         <span class="comment">// validated in create_block_state_future()</span></div>
<div class="line"><a id="l02029" name="l02029"></a><span class="lineno"> 2029</span>         std::get&lt;building_block&gt;(<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a0e355919fd924a05344ef2b59f7dd587">pending</a>-&gt;_block_stage)._transaction_mroot = b-&gt;transaction_mroot;</div>
<div class="line"><a id="l02030" name="l02030"></a><span class="lineno"> 2030</span> </div>
<div class="line"><a id="l02031" name="l02031"></a><span class="lineno"> 2031</span>         <span class="comment">// New: Process the s_header from block header extensions</span></div>
<div class="line"><a id="l02032" name="l02032"></a><span class="lineno"> 2032</span>         <span class="keyword">auto</span> s_header_it = std::find_if(b-&gt;header_extensions.begin(), b-&gt;header_extensions.end(),</div>
<div class="line"><a id="l02033" name="l02033"></a><span class="lineno"> 2033</span>                                       [](<span class="keyword">const</span> <span class="keyword">auto</span>&amp; ext) { return ext.first == s_root_extension::extension_id(); });</div>
<div class="line"><a id="l02034" name="l02034"></a><span class="lineno"> 2034</span>         <span class="keywordflow">if</span> (s_header_it != b-&gt;header_extensions.end()) {</div>
<div class="line"><a id="l02035" name="l02035"></a><span class="lineno"> 2035</span>            <a class="code hl_define" href="logger_8hpp.html#a831cf08dc63704c11fd154132c6e8bdb">ilog</a>(<span class="stringliteral">&quot;Found s_root_extension in header_extensions, attempting to extract...&quot;</span>);</div>
<div class="line"><a id="l02036" name="l02036"></a><span class="lineno"> 2036</span>            <a class="code hl_struct" href="structsysio_1_1chain_1_1s__header.html">s_header</a> extracted_s_header = <a class="code hl_function" href="namespacefc_1_1raw.html#a0b442d98ceb22dd5a6ae84745e43ffab">fc::raw::unpack&lt;s_header&gt;</a>(s_header_it-&gt;second);</div>
<div class="line"><a id="l02037" name="l02037"></a><span class="lineno"> 2037</span>            <a class="code hl_define" href="logger_8hpp.html#a831cf08dc63704c11fd154132c6e8bdb">ilog</a>(<span class="stringliteral">&quot;Extracted s_header: ${s_header}&quot;</span>, (<span class="stringliteral">&quot;s_header&quot;</span>, extracted_s_header.<a class="code hl_function" href="structsysio_1_1chain_1_1s__header.html#a2075610dd92e3718f545b14adcd3ebf7">to_string</a>()));</div>
<div class="line"><a id="l02038" name="l02038"></a><span class="lineno"> 2038</span>            <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a64851fb4e041dc49ab22cf2ba335720d">self</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a59e341a41ba27734555c54c37bacf358">set_s_header</a>(extracted_s_header); <span class="comment">// Attempt to set s-header</span></div>
<div class="line"><a id="l02039" name="l02039"></a><span class="lineno"> 2039</span>         }</div>
<div class="line"><a id="l02040" name="l02040"></a><span class="lineno"> 2040</span> </div>
<div class="line"><a id="l02041" name="l02041"></a><span class="lineno"> 2041</span>         <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a5eb5bb7961c3ae6496caca42b84ab192">finalize_block</a>();</div>
<div class="line"><a id="l02042" name="l02042"></a><span class="lineno"> 2042</span> </div>
<div class="line"><a id="l02043" name="l02043"></a><span class="lineno"> 2043</span>         <span class="keyword">auto</span>&amp; ab = std::get&lt;assembled_block&gt;(<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a0e355919fd924a05344ef2b59f7dd587">pending</a>-&gt;_block_stage);</div>
<div class="line"><a id="l02044" name="l02044"></a><span class="lineno"> 2044</span> </div>
<div class="line"><a id="l02045" name="l02045"></a><span class="lineno"> 2045</span>         </div>
<div class="line"><a id="l02046" name="l02046"></a><span class="lineno"> 2046</span> </div>
<div class="line"><a id="l02047" name="l02047"></a><span class="lineno"> 2047</span>         <span class="keywordflow">if</span>( producer_block_id != ab._id ) {</div>
<div class="line"><a id="l02048" name="l02048"></a><span class="lineno"> 2048</span>            <a class="code hl_define" href="logger_8hpp.html#a9e3cdbaecd5a34b42956e888f7326fad">elog</a>( <span class="stringliteral">&quot;Validation block id does not match producer block id&quot;</span> );</div>
<div class="line"><a id="l02049" name="l02049"></a><span class="lineno"> 2049</span>            <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#af932f3160706510eaf30e2b76f386973">report_block_header_diff</a>( *b, *ab._unsigned_block );</div>
<div class="line"><a id="l02050" name="l02050"></a><span class="lineno"> 2050</span>            <span class="comment">// this implicitly asserts that all header fields (less the signature) are identical</span></div>
<div class="line"><a id="l02051" name="l02051"></a><span class="lineno"> 2051</span>            <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( producer_block_id == ab._id, <a class="code hl_variable" href="namespacesysio_1_1chain.html#a910243f6a0327fb2d4fc80f7e89f103e">block_validate_exception</a>, <span class="stringliteral">&quot;Block ID does not match&quot;</span>,</div>
<div class="line"><a id="l02052" name="l02052"></a><span class="lineno"> 2052</span>                        (<span class="stringliteral">&quot;producer_block_id&quot;</span>, producer_block_id)(<span class="stringliteral">&quot;validator_block_id&quot;</span>, ab._id) );</div>
<div class="line"><a id="l02053" name="l02053"></a><span class="lineno"> 2053</span>         }</div>
<div class="line"><a id="l02054" name="l02054"></a><span class="lineno"> 2054</span> </div>
<div class="line"><a id="l02055" name="l02055"></a><span class="lineno"> 2055</span>         <span class="keywordflow">if</span>( !use_bsp_cached ) {</div>
<div class="line"><a id="l02056" name="l02056"></a><span class="lineno"> 2056</span>            bsp-&gt;set_trxs_metas( std::move( ab._trx_metas ), !skip_auth_checks );</div>
<div class="line"><a id="l02057" name="l02057"></a><span class="lineno"> 2057</span>         }</div>
<div class="line"><a id="l02058" name="l02058"></a><span class="lineno"> 2058</span>         <span class="comment">// create completed_block with the existing block_state as we just verified it is the same as assembled_block</span></div>
<div class="line"><a id="l02059" name="l02059"></a><span class="lineno"> 2059</span>         <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a0e355919fd924a05344ef2b59f7dd587">pending</a>-&gt;_block_stage = <a class="code hl_struct" href="structsysio_1_1chain_1_1completed__block.html">completed_block</a>{ bsp };</div>
<div class="line"><a id="l02060" name="l02060"></a><span class="lineno"> 2060</span> </div>
<div class="line"><a id="l02061" name="l02061"></a><span class="lineno"> 2061</span>         <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#abde6bacce9f720ad552d0e342c52d3b4">commit_block</a>(<span class="keyword">false</span>);</div>
<div class="line"><a id="l02062" name="l02062"></a><span class="lineno"> 2062</span>         <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l02063" name="l02063"></a><span class="lineno"> 2063</span>      } <span class="keywordflow">catch</span> ( <span class="keyword">const</span> std::bad_alloc&amp; ) {</div>
<div class="line"><a id="l02064" name="l02064"></a><span class="lineno"> 2064</span>         <span class="keywordflow">throw</span>;</div>
<div class="line"><a id="l02065" name="l02065"></a><span class="lineno"> 2065</span>      } <span class="keywordflow">catch</span> ( <span class="keyword">const</span> boost::interprocess::bad_alloc&amp; ) {</div>
<div class="line"><a id="l02066" name="l02066"></a><span class="lineno"> 2066</span>         <span class="keywordflow">throw</span>;</div>
<div class="line"><a id="l02067" name="l02067"></a><span class="lineno"> 2067</span>      } <span class="keywordflow">catch</span> ( <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1exception.html">fc::exception</a>&amp; e ) {</div>
<div class="line"><a id="l02068" name="l02068"></a><span class="lineno"> 2068</span>         <a class="code hl_define" href="logger_8hpp.html#a26aaf645dd9dc96836635d6b18bd1090">edump</a>((e.<a class="code hl_function" href="classfc_1_1exception.html#a7611ea8fbe25dde56649b685c2298a37">to_detail_string</a>()));</div>
<div class="line"><a id="l02069" name="l02069"></a><span class="lineno"> 2069</span>         <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#aed82882c38a7b9a2ab8ccf26b7d68126">abort_block</a>();</div>
<div class="line"><a id="l02070" name="l02070"></a><span class="lineno"> 2070</span>         <span class="keywordflow">throw</span>;</div>
<div class="line"><a id="l02071" name="l02071"></a><span class="lineno"> 2071</span>      } <span class="keywordflow">catch</span> ( <span class="keyword">const</span> std::exception&amp; e ) {</div>
<div class="line"><a id="l02072" name="l02072"></a><span class="lineno"> 2072</span>         <a class="code hl_define" href="logger_8hpp.html#a26aaf645dd9dc96836635d6b18bd1090">edump</a>((e.<a class="code hl_function" href="classfc_1_1exception.html#ab1104818bf0d9b6a29f0dfe036cf97f6">what</a>()));</div>
<div class="line"><a id="l02073" name="l02073"></a><span class="lineno"> 2073</span>         <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#aed82882c38a7b9a2ab8ccf26b7d68126">abort_block</a>();</div>
<div class="line"><a id="l02074" name="l02074"></a><span class="lineno"> 2074</span>         <span class="keywordflow">throw</span>;</div>
<div class="line"><a id="l02075" name="l02075"></a><span class="lineno"> 2075</span>      }</div>
<div class="line"><a id="l02076" name="l02076"></a><span class="lineno"> 2076</span>   } <a class="code hl_define" href="exception_8hpp.html#a094902280cad82ad6529ebbd12a697eb">FC_CAPTURE_AND_RETHROW</a>() } </div>
</div>
<div class="line"><a id="l02077" name="l02077"></a><span class="lineno"> 2077</span> </div>
<div class="line"><a id="l02078" name="l02078"></a><span class="lineno"> 2078</span> </div>
<div class="line"><a id="l02079" name="l02079"></a><span class="lineno"> 2079</span>   <span class="comment">// thread safe, expected to be called from thread other than the main thread</span></div>
<div class="foldopen" id="foldopen02080" data-start="{" data-end="}">
<div class="line"><a id="l02080" name="l02080"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#a2eee00b79604bc3dfa0a93f397a2d4d8"> 2080</a></span>   <a class="code hl_typedef" href="namespacesysio_1_1chain.html#ab9b14f4554cc4a0da2c361e9757b1662">block_state_ptr</a> <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a2eee00b79604bc3dfa0a93f397a2d4d8">create_block_state_i</a>( <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1sha256.html">block_id_type</a>&amp; <span class="keywordtype">id</span>, <span class="keyword">const</span> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#aa10ee348c57604b615bc8570f6685102">signed_block_ptr</a>&amp; b, <span class="keyword">const</span> <a class="code hl_struct" href="structsysio_1_1chain_1_1block__header__state.html">block_header_state</a>&amp; prev ) {</div>
<div class="line"><a id="l02081" name="l02081"></a><span class="lineno"> 2081</span>      <span class="keyword">auto</span> trx_mroot = <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a9ae4fff15a76a1c3089fdf0f3353a17f">calculate_trx_merkle</a>( b-&gt;transactions );</div>
<div class="line"><a id="l02082" name="l02082"></a><span class="lineno"> 2082</span>      <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( b-&gt;transaction_mroot == trx_mroot, <a class="code hl_variable" href="namespacesysio_1_1chain.html#a910243f6a0327fb2d4fc80f7e89f103e">block_validate_exception</a>,</div>
<div class="line"><a id="l02083" name="l02083"></a><span class="lineno"> 2083</span>                  <span class="stringliteral">&quot;invalid block transaction merkle root ${b} != ${c}&quot;</span>, (<span class="stringliteral">&quot;b&quot;</span>, b-&gt;transaction_mroot)(<span class="stringliteral">&quot;c&quot;</span>, trx_mroot) );</div>
<div class="line"><a id="l02084" name="l02084"></a><span class="lineno"> 2084</span> </div>
<div class="line"><a id="l02085" name="l02085"></a><span class="lineno"> 2085</span>      <span class="keyword">const</span> <span class="keywordtype">bool</span> skip_validate_signee = <span class="keyword">false</span>;</div>
<div class="line"><a id="l02086" name="l02086"></a><span class="lineno"> 2086</span>      <span class="keyword">auto</span> bsp = std::make_shared&lt;block_state&gt;(</div>
<div class="line"><a id="l02087" name="l02087"></a><span class="lineno"> 2087</span>            prev,</div>
<div class="line"><a id="l02088" name="l02088"></a><span class="lineno"> 2088</span>            b,</div>
<div class="line"><a id="l02089" name="l02089"></a><span class="lineno"> 2089</span>            <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a24a100a7be5e562ac3966924b0c9ccb6">protocol_features</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1protocol__feature__manager.html#a9e6c1310749c4fd04035aa2c01310ce4">get_protocol_feature_set</a>(),</div>
<div class="line"><a id="l02090" name="l02090"></a><span class="lineno"> 2090</span>            [<span class="keyword">this</span>]( <a class="code hl_class" href="classsysio_1_1chain_1_1block__timestamp.html">block_timestamp_type</a> timestamp,</div>
<div class="line"><a id="l02091" name="l02091"></a><span class="lineno"> 2091</span>                    <span class="keyword">const</span> flat_set&lt;digest_type&gt;&amp; cur_features,</div>
<div class="line"><a id="l02092" name="l02092"></a><span class="lineno"> 2092</span>                    <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1vector.html">vector&lt;digest_type&gt;</a>&amp; new_features )</div>
<div class="line"><a id="l02093" name="l02093"></a><span class="lineno"> 2093</span>            { check_protocol_features( timestamp, cur_features, new_features ); },</div>
<div class="line"><a id="l02094" name="l02094"></a><span class="lineno"> 2094</span>            skip_validate_signee</div>
<div class="line"><a id="l02095" name="l02095"></a><span class="lineno"> 2095</span>      );</div>
<div class="line"><a id="l02096" name="l02096"></a><span class="lineno"> 2096</span> </div>
<div class="line"><a id="l02097" name="l02097"></a><span class="lineno"> 2097</span>      <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( <span class="keywordtype">id</span> == bsp-&gt;id, <a class="code hl_variable" href="namespacesysio_1_1chain.html#a910243f6a0327fb2d4fc80f7e89f103e">block_validate_exception</a>,</div>
<div class="line"><a id="l02098" name="l02098"></a><span class="lineno"> 2098</span>                  <span class="stringliteral">&quot;provided id ${id} does not match block id ${bid}&quot;</span>, (<span class="stringliteral">&quot;id&quot;</span>, <span class="keywordtype">id</span>)(<span class="stringliteral">&quot;bid&quot;</span>, bsp-&gt;id) );</div>
<div class="line"><a id="l02099" name="l02099"></a><span class="lineno"> 2099</span>      <span class="keywordflow">return</span> bsp;</div>
<div class="line"><a id="l02100" name="l02100"></a><span class="lineno"> 2100</span>   }</div>
</div>
<div class="line"><a id="l02101" name="l02101"></a><span class="lineno"> 2101</span> </div>
<div class="foldopen" id="foldopen02102" data-start="{" data-end="}">
<div class="line"><a id="l02102" name="l02102"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#af1df7b3285411e4e9ae6781353ad4d80"> 2102</a></span>   std::future&lt;block_state_ptr&gt; <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#af1df7b3285411e4e9ae6781353ad4d80">create_block_state_future</a>( <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1sha256.html">block_id_type</a>&amp; <span class="keywordtype">id</span>, <span class="keyword">const</span> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#aa10ee348c57604b615bc8570f6685102">signed_block_ptr</a>&amp; b ) {</div>
<div class="line"><a id="l02103" name="l02103"></a><span class="lineno"> 2103</span>      <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( b, <a class="code hl_variable" href="namespacesysio_1_1chain.html#a910243f6a0327fb2d4fc80f7e89f103e">block_validate_exception</a>, <span class="stringliteral">&quot;null block&quot;</span> );</div>
<div class="line"><a id="l02104" name="l02104"></a><span class="lineno"> 2104</span> </div>
<div class="line"><a id="l02105" name="l02105"></a><span class="lineno"> 2105</span>      <span class="keywordflow">return</span> <a class="code hl_function" href="namespacesysio_1_1chain.html#a7c89dacf49f9737b2395006400c5a26c">async_thread_pool</a>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#ab76d9091b7e62fb25a0fdd63c8210af9">thread_pool</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1named__thread__pool.html#ae2f5fa4611193d13bb40e34708d897ea">get_executor</a>(), [b, <span class="keywordtype">id</span>, control=<span class="keyword">this</span>]() {</div>
<div class="line"><a id="l02106" name="l02106"></a><span class="lineno"> 2106</span>         <span class="comment">// no reason for a block_state if fork_db already knows about block</span></div>
<div class="line"><a id="l02107" name="l02107"></a><span class="lineno"> 2107</span>         auto existing = control-&gt;fork_db.get_block( id );</div>
<div class="line"><a id="l02108" name="l02108"></a><span class="lineno"> 2108</span>         SYS_ASSERT( !existing, fork_database_exception, <span class="stringliteral">&quot;we already know about this block: ${id}&quot;</span>, (<span class="stringliteral">&quot;id&quot;</span>, id) );</div>
<div class="line"><a id="l02109" name="l02109"></a><span class="lineno"> 2109</span> </div>
<div class="line"><a id="l02110" name="l02110"></a><span class="lineno"> 2110</span>         auto prev = control-&gt;fork_db.get_block_header( b-&gt;previous );</div>
<div class="line"><a id="l02111" name="l02111"></a><span class="lineno"> 2111</span>         SYS_ASSERT( prev, unlinkable_block_exception,</div>
<div class="line"><a id="l02112" name="l02112"></a><span class="lineno"> 2112</span>                     <span class="stringliteral">&quot;unlinkable block ${id}&quot;</span>, (<span class="stringliteral">&quot;id&quot;</span>, id)(<span class="stringliteral">&quot;previous&quot;</span>, b-&gt;previous) );</div>
<div class="line"><a id="l02113" name="l02113"></a><span class="lineno"> 2113</span> </div>
<div class="line"><a id="l02114" name="l02114"></a><span class="lineno"> 2114</span>         return control-&gt;create_block_state_i( id, b, *prev );</div>
<div class="line"><a id="l02115" name="l02115"></a><span class="lineno"> 2115</span>      } );</div>
<div class="line"><a id="l02116" name="l02116"></a><span class="lineno"> 2116</span>   }</div>
</div>
<div class="line"><a id="l02117" name="l02117"></a><span class="lineno"> 2117</span> </div>
<div class="line"><a id="l02118" name="l02118"></a><span class="lineno"> 2118</span>   <span class="comment">// thread safe, expected to be called from thread other than the main thread</span></div>
<div class="foldopen" id="foldopen02119" data-start="{" data-end="}">
<div class="line"><a id="l02119" name="l02119"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#ad5c91b7cff820c07efed35a7b3912d68"> 2119</a></span>   <a class="code hl_typedef" href="namespacesysio_1_1chain.html#ab9b14f4554cc4a0da2c361e9757b1662">block_state_ptr</a> <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#ad5c91b7cff820c07efed35a7b3912d68">create_block_state</a>( <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1sha256.html">block_id_type</a>&amp; <span class="keywordtype">id</span>, <span class="keyword">const</span> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#aa10ee348c57604b615bc8570f6685102">signed_block_ptr</a>&amp; b ) {</div>
<div class="line"><a id="l02120" name="l02120"></a><span class="lineno"> 2120</span>      <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( b, <a class="code hl_variable" href="namespacesysio_1_1chain.html#a910243f6a0327fb2d4fc80f7e89f103e">block_validate_exception</a>, <span class="stringliteral">&quot;null block&quot;</span> );</div>
<div class="line"><a id="l02121" name="l02121"></a><span class="lineno"> 2121</span> </div>
<div class="line"><a id="l02122" name="l02122"></a><span class="lineno"> 2122</span>      <span class="comment">// no reason for a block_state if fork_db already knows about block</span></div>
<div class="line"><a id="l02123" name="l02123"></a><span class="lineno"> 2123</span>      <span class="keyword">auto</span> existing = <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af7f72e6389799b7921aa98f30534f0d9">fork_db</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1fork__database.html#aee9daa00e2698a868ad36853e58d3908">get_block</a>( <span class="keywordtype">id</span> );</div>
<div class="line"><a id="l02124" name="l02124"></a><span class="lineno"> 2124</span>      <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( !existing, <a class="code hl_variable" href="namespacesysio_1_1chain.html#acad19c1ca23d796138841046c67b3ea9">fork_database_exception</a>, <span class="stringliteral">&quot;we already know about this block: ${id}&quot;</span>, (<span class="stringliteral">&quot;id&quot;</span>, <span class="keywordtype">id</span>) );</div>
<div class="line"><a id="l02125" name="l02125"></a><span class="lineno"> 2125</span> </div>
<div class="line"><a id="l02126" name="l02126"></a><span class="lineno"> 2126</span>      <span class="comment">// previous not found could mean that previous block not applied yet</span></div>
<div class="line"><a id="l02127" name="l02127"></a><span class="lineno"> 2127</span>      <span class="keyword">auto</span> prev = <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af7f72e6389799b7921aa98f30534f0d9">fork_db</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1fork__database.html#a681f9146e0afd70a0e8c0421efb0a41f">get_block_header</a>( b-&gt;previous );</div>
<div class="line"><a id="l02128" name="l02128"></a><span class="lineno"> 2128</span>      <span class="keywordflow">if</span>( !prev ) <span class="keywordflow">return</span> {};</div>
<div class="line"><a id="l02129" name="l02129"></a><span class="lineno"> 2129</span> </div>
<div class="line"><a id="l02130" name="l02130"></a><span class="lineno"> 2130</span>      <span class="keywordflow">return</span> <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a2eee00b79604bc3dfa0a93f397a2d4d8">create_block_state_i</a>( <span class="keywordtype">id</span>, b, *prev );</div>
<div class="line"><a id="l02131" name="l02131"></a><span class="lineno"> 2131</span>   }</div>
</div>
<div class="line"><a id="l02132" name="l02132"></a><span class="lineno"> 2132</span> </div>
<div class="foldopen" id="foldopen02133" data-start="{" data-end="}">
<div class="line"><a id="l02133" name="l02133"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#ac2d3794f1bd0ff1bd5837d8ead15d289"> 2133</a></span>   <span class="keywordtype">void</span> <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#ac2d3794f1bd0ff1bd5837d8ead15d289">push_block</a>( <span class="keyword">const</span> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#ab9b14f4554cc4a0da2c361e9757b1662">block_state_ptr</a>&amp; bsp,</div>
<div class="line"><a id="l02134" name="l02134"></a><span class="lineno"> 2134</span>                    <span class="keyword">const</span> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#ae043a3bf1321067bf1e4e7e5ab0ce3cd">forked_branch_callback</a>&amp; forked_branch_cb,</div>
<div class="line"><a id="l02135" name="l02135"></a><span class="lineno"> 2135</span>                    <span class="keyword">const</span> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#ad7e9cbb02002c4e7ab9825becb9f9f50">trx_meta_cache_lookup</a>&amp; trx_lookup )</div>
<div class="line"><a id="l02136" name="l02136"></a><span class="lineno"> 2136</span>   {</div>
<div class="line"><a id="l02137" name="l02137"></a><span class="lineno"> 2137</span>      <a class="code hl_enumeration" href="classsysio_1_1chain_1_1controller.html#a8b5124e077de1a73bb193e9c72b366b6">controller::block_status</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a> = <a class="code hl_enumvalue" href="classsysio_1_1chain_1_1controller.html#a8b5124e077de1a73bb193e9c72b366b6ad9a22d7a8178d5b42a8750123cbfe5b1">controller::block_status::complete</a>;</div>
<div class="line"><a id="l02138" name="l02138"></a><span class="lineno"> 2138</span>      <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>(!<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a0e355919fd924a05344ef2b59f7dd587">pending</a>, <a class="code hl_variable" href="namespacesysio_1_1chain.html#a910243f6a0327fb2d4fc80f7e89f103e">block_validate_exception</a>, <span class="stringliteral">&quot;it is not valid to push a block when there is a pending block&quot;</span>);</div>
<div class="line"><a id="l02139" name="l02139"></a><span class="lineno"> 2139</span> </div>
<div class="line"><a id="l02140" name="l02140"></a><span class="lineno"> 2140</span>      <span class="keyword">auto</span> reset_prod_light_validation = <a class="code hl_function" href="namespacefc.html#a23d89b54a8ffd84f7e7efeb21747d846">fc::make_scoped_exit</a>([old_value=<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af3f88c130012bd7de2401b5b80fd3129">trusted_producer_light_validation</a>, <span class="keyword">this</span>]() {</div>
<div class="line"><a id="l02141" name="l02141"></a><span class="lineno"> 2141</span>         <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af3f88c130012bd7de2401b5b80fd3129">trusted_producer_light_validation</a> = old_value;</div>
<div class="line"><a id="l02142" name="l02142"></a><span class="lineno"> 2142</span>      });</div>
<div class="line"><a id="l02143" name="l02143"></a><span class="lineno"> 2143</span>      <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l02144" name="l02144"></a><span class="lineno"> 2144</span>         <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( bsp, <a class="code hl_variable" href="namespacesysio_1_1chain.html#a910243f6a0327fb2d4fc80f7e89f103e">block_validate_exception</a>, <span class="stringliteral">&quot;null block&quot;</span> );</div>
<div class="line"><a id="l02145" name="l02145"></a><span class="lineno"> 2145</span>         <span class="keyword">const</span> <span class="keyword">auto</span>&amp; b = bsp-&gt;block;</div>
<div class="line"><a id="l02146" name="l02146"></a><span class="lineno"> 2146</span> </div>
<div class="line"><a id="l02147" name="l02147"></a><span class="lineno"> 2147</span>         <span class="keywordflow">if</span>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a048ac8e4d4436902a1888df13575b252">conf</a>.<a class="code hl_variable" href="structsysio_1_1chain_1_1controller_1_1config.html#a5352099a52d4b3f078ec78122393ba21">terminate_at_block</a> &gt; 0 &amp;&amp; <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a048ac8e4d4436902a1888df13575b252">conf</a>.<a class="code hl_variable" href="structsysio_1_1chain_1_1controller_1_1config.html#a5352099a52d4b3f078ec78122393ba21">terminate_at_block</a> &lt; <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a64851fb4e041dc49ab22cf2ba335720d">self</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a33704b4936bb9bbd2ea6b0874ca521b4">head_block_num</a>()) {</div>
<div class="line"><a id="l02148" name="l02148"></a><span class="lineno"> 2148</span>            <a class="code hl_define" href="logger_8hpp.html#a831cf08dc63704c11fd154132c6e8bdb">ilog</a>(<span class="stringliteral">&quot;Reached configured maximum block ${num}; terminating&quot;</span>, (<span class="stringliteral">&quot;num&quot;</span>, <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a048ac8e4d4436902a1888df13575b252">conf</a>.<a class="code hl_variable" href="structsysio_1_1chain_1_1controller_1_1config.html#a5352099a52d4b3f078ec78122393ba21">terminate_at_block</a>) );</div>
<div class="line"><a id="l02149" name="l02149"></a><span class="lineno"> 2149</span>            <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a8054e1b3da405a7765275b76d6628928">shutdown</a>();</div>
<div class="line"><a id="l02150" name="l02150"></a><span class="lineno"> 2150</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l02151" name="l02151"></a><span class="lineno"> 2151</span>         }</div>
<div class="line"><a id="l02152" name="l02152"></a><span class="lineno"> 2152</span> </div>
<div class="line"><a id="l02153" name="l02153"></a><span class="lineno"> 2153</span>         <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a6380e434da95a328ff48ccab33df9cb0">emit</a>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a64851fb4e041dc49ab22cf2ba335720d">self</a>.<a class="code hl_variable" href="classsysio_1_1chain_1_1controller.html#a4fc6dcda025714506dce2a3ed924a21c">pre_accepted_block</a>, b );</div>
<div class="line"><a id="l02154" name="l02154"></a><span class="lineno"> 2154</span> </div>
<div class="line"><a id="l02155" name="l02155"></a><span class="lineno"> 2155</span>         <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af7f72e6389799b7921aa98f30534f0d9">fork_db</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1fork__database.html#a97cf1402b71020048ae0054e4d7c8079">add</a>( bsp );</div>
<div class="line"><a id="l02156" name="l02156"></a><span class="lineno"> 2156</span> </div>
<div class="line"><a id="l02157" name="l02157"></a><span class="lineno"> 2157</span>         <span class="keywordflow">if</span> (<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a64851fb4e041dc49ab22cf2ba335720d">self</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a1196ffe0c4905238026e4923cf24cb3e">is_trusted_producer</a>(b-&gt;producer)) {</div>
<div class="line"><a id="l02158" name="l02158"></a><span class="lineno"> 2158</span>            <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af3f88c130012bd7de2401b5b80fd3129">trusted_producer_light_validation</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l02159" name="l02159"></a><span class="lineno"> 2159</span>         };</div>
<div class="line"><a id="l02160" name="l02160"></a><span class="lineno"> 2160</span> </div>
<div class="line"><a id="l02161" name="l02161"></a><span class="lineno"> 2161</span>         <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a6380e434da95a328ff48ccab33df9cb0">emit</a>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a64851fb4e041dc49ab22cf2ba335720d">self</a>.<a class="code hl_variable" href="classsysio_1_1chain_1_1controller.html#a0a0659166483870bf065f4d5e671484e">accepted_block_header</a>, bsp );</div>
<div class="line"><a id="l02162" name="l02162"></a><span class="lineno"> 2162</span> </div>
<div class="line"><a id="l02163" name="l02163"></a><span class="lineno"> 2163</span>         <span class="keywordflow">if</span>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a4a18397f763ebe4880b6ccd970bedf85">read_mode</a> != <a class="code hl_enumvalue" href="namespacesysio_1_1chain.html#af3e35f3e1b78dd00fa247009a2d9ba5ea88537e4e57a14e27d354f8ef6fc03d63">db_read_mode::IRREVERSIBLE</a> ) {</div>
<div class="line"><a id="l02164" name="l02164"></a><span class="lineno"> 2164</span>            <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#af15d89f9220ba97aa5c521e643746587">maybe_switch_forks</a>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af7f72e6389799b7921aa98f30534f0d9">fork_db</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1fork__database.html#a16e619525d86741f3e5344b39ab91868">pending_head</a>(), <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a>, forked_branch_cb, trx_lookup );</div>
<div class="line"><a id="l02165" name="l02165"></a><span class="lineno"> 2165</span>         } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l02166" name="l02166"></a><span class="lineno"> 2166</span>            <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#ad0130874bac31eb408dd6e766084b814">log_irreversible</a>();</div>
<div class="line"><a id="l02167" name="l02167"></a><span class="lineno"> 2167</span>         }</div>
<div class="line"><a id="l02168" name="l02168"></a><span class="lineno"> 2168</span> </div>
<div class="line"><a id="l02169" name="l02169"></a><span class="lineno"> 2169</span>      } <a class="code hl_define" href="exception_8hpp.html#ae70bfa24f5a3bc0917382b3c17fc033c">FC_LOG_AND_RETHROW</a>( )</div>
<div class="line"><a id="l02170" name="l02170"></a><span class="lineno"> 2170</span>   }</div>
</div>
<div class="line"><a id="l02171" name="l02171"></a><span class="lineno"> 2171</span> </div>
<div class="foldopen" id="foldopen02172" data-start="{" data-end="}">
<div class="line"><a id="l02172" name="l02172"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#a2fe4194f0202db6c18bc17572b2adaa2"> 2172</a></span>   <span class="keywordtype">void</span> <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a2fe4194f0202db6c18bc17572b2adaa2">replay_push_block</a>( <span class="keyword">const</span> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#aa10ee348c57604b615bc8570f6685102">signed_block_ptr</a>&amp; b, <a class="code hl_enumeration" href="classsysio_1_1chain_1_1controller.html#a8b5124e077de1a73bb193e9c72b366b6">controller::block_status</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a> ) {</div>
<div class="line"><a id="l02173" name="l02173"></a><span class="lineno"> 2173</span>      <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a64851fb4e041dc49ab22cf2ba335720d">self</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a7b2f18a21e18a1bdc6837a567bb259eb">validate_db_available_size</a>();</div>
<div class="line"><a id="l02174" name="l02174"></a><span class="lineno"> 2174</span> </div>
<div class="line"><a id="l02175" name="l02175"></a><span class="lineno"> 2175</span>      <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>(!<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a0e355919fd924a05344ef2b59f7dd587">pending</a>, <a class="code hl_variable" href="namespacesysio_1_1chain.html#a910243f6a0327fb2d4fc80f7e89f103e">block_validate_exception</a>, <span class="stringliteral">&quot;it is not valid to push a block when there is a pending block&quot;</span>);</div>
<div class="line"><a id="l02176" name="l02176"></a><span class="lineno"> 2176</span> </div>
<div class="line"><a id="l02177" name="l02177"></a><span class="lineno"> 2177</span>      <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l02178" name="l02178"></a><span class="lineno"> 2178</span>         <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( b, <a class="code hl_variable" href="namespacesysio_1_1chain.html#a910243f6a0327fb2d4fc80f7e89f103e">block_validate_exception</a>, <span class="stringliteral">&quot;trying to push empty block&quot;</span> );</div>
<div class="line"><a id="l02179" name="l02179"></a><span class="lineno"> 2179</span>         <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a> == <a class="code hl_enumvalue" href="classsysio_1_1chain_1_1controller.html#a8b5124e077de1a73bb193e9c72b366b6a7e6e4eb3ff27864637756cb4d2a2a45d">controller::block_status::irreversible</a> || <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a> == <a class="code hl_enumvalue" href="classsysio_1_1chain_1_1controller.html#a8b5124e077de1a73bb193e9c72b366b6ac9e825f4641cd3bec0ba01a0c2d67755">controller::block_status::validated</a>),</div>
<div class="line"><a id="l02180" name="l02180"></a><span class="lineno"> 2180</span>                     <a class="code hl_variable" href="namespacesysio_1_1chain.html#a910243f6a0327fb2d4fc80f7e89f103e">block_validate_exception</a>, <span class="stringliteral">&quot;invalid block status for replay&quot;</span> );</div>
<div class="line"><a id="l02181" name="l02181"></a><span class="lineno"> 2181</span> </div>
<div class="line"><a id="l02182" name="l02182"></a><span class="lineno"> 2182</span>         <span class="keywordflow">if</span>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a048ac8e4d4436902a1888df13575b252">conf</a>.<a class="code hl_variable" href="structsysio_1_1chain_1_1controller_1_1config.html#a5352099a52d4b3f078ec78122393ba21">terminate_at_block</a> &gt; 0 &amp;&amp; <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a048ac8e4d4436902a1888df13575b252">conf</a>.<a class="code hl_variable" href="structsysio_1_1chain_1_1controller_1_1config.html#a5352099a52d4b3f078ec78122393ba21">terminate_at_block</a> &lt; <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a64851fb4e041dc49ab22cf2ba335720d">self</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a33704b4936bb9bbd2ea6b0874ca521b4">head_block_num</a>() ) {</div>
<div class="line"><a id="l02183" name="l02183"></a><span class="lineno"> 2183</span>            <a class="code hl_define" href="logger_8hpp.html#a831cf08dc63704c11fd154132c6e8bdb">ilog</a>(<span class="stringliteral">&quot;Reached configured maximum block ${num}; terminating&quot;</span>, (<span class="stringliteral">&quot;num&quot;</span>, <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a048ac8e4d4436902a1888df13575b252">conf</a>.<a class="code hl_variable" href="structsysio_1_1chain_1_1controller_1_1config.html#a5352099a52d4b3f078ec78122393ba21">terminate_at_block</a>) );</div>
<div class="line"><a id="l02184" name="l02184"></a><span class="lineno"> 2184</span>            <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a8054e1b3da405a7765275b76d6628928">shutdown</a>();</div>
<div class="line"><a id="l02185" name="l02185"></a><span class="lineno"> 2185</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l02186" name="l02186"></a><span class="lineno"> 2186</span>         }</div>
<div class="line"><a id="l02187" name="l02187"></a><span class="lineno"> 2187</span> </div>
<div class="line"><a id="l02188" name="l02188"></a><span class="lineno"> 2188</span>         <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a6380e434da95a328ff48ccab33df9cb0">emit</a>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a64851fb4e041dc49ab22cf2ba335720d">self</a>.<a class="code hl_variable" href="classsysio_1_1chain_1_1controller.html#a4fc6dcda025714506dce2a3ed924a21c">pre_accepted_block</a>, b );</div>
<div class="line"><a id="l02189" name="l02189"></a><span class="lineno"> 2189</span>         <span class="keyword">const</span> <span class="keywordtype">bool</span> skip_validate_signee = !<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a048ac8e4d4436902a1888df13575b252">conf</a>.<a class="code hl_variable" href="structsysio_1_1chain_1_1controller_1_1config.html#a5845874d26f30413374713814cde5749">force_all_checks</a>;</div>
<div class="line"><a id="l02190" name="l02190"></a><span class="lineno"> 2190</span> </div>
<div class="line"><a id="l02191" name="l02191"></a><span class="lineno"> 2191</span>         <span class="keyword">auto</span> bsp = std::make_shared&lt;block_state&gt;(</div>
<div class="line"><a id="l02192" name="l02192"></a><span class="lineno"> 2192</span>                        *<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a56a0f369b58e6597b62569ff2853ee90">head</a>,</div>
<div class="line"><a id="l02193" name="l02193"></a><span class="lineno"> 2193</span>                        b,</div>
<div class="line"><a id="l02194" name="l02194"></a><span class="lineno"> 2194</span>                        <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a24a100a7be5e562ac3966924b0c9ccb6">protocol_features</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1protocol__feature__manager.html#a9e6c1310749c4fd04035aa2c01310ce4">get_protocol_feature_set</a>(),</div>
<div class="line"><a id="l02195" name="l02195"></a><span class="lineno"> 2195</span>                        [<span class="keyword">this</span>]( <a class="code hl_class" href="classsysio_1_1chain_1_1block__timestamp.html">block_timestamp_type</a> timestamp,</div>
<div class="line"><a id="l02196" name="l02196"></a><span class="lineno"> 2196</span>                                <span class="keyword">const</span> flat_set&lt;digest_type&gt;&amp; cur_features,</div>
<div class="line"><a id="l02197" name="l02197"></a><span class="lineno"> 2197</span>                                <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1vector.html">vector&lt;digest_type&gt;</a>&amp; new_features )</div>
<div class="line"><a id="l02198" name="l02198"></a><span class="lineno"> 2198</span>                        { check_protocol_features( timestamp, cur_features, new_features ); },</div>
<div class="line"><a id="l02199" name="l02199"></a><span class="lineno"> 2199</span>                        skip_validate_signee</div>
<div class="line"><a id="l02200" name="l02200"></a><span class="lineno"> 2200</span>         );</div>
<div class="line"><a id="l02201" name="l02201"></a><span class="lineno"> 2201</span> </div>
<div class="line"><a id="l02202" name="l02202"></a><span class="lineno"> 2202</span>         <span class="keywordflow">if</span>( <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a> != <a class="code hl_enumvalue" href="classsysio_1_1chain_1_1controller.html#a8b5124e077de1a73bb193e9c72b366b6a7e6e4eb3ff27864637756cb4d2a2a45d">controller::block_status::irreversible</a> ) {</div>
<div class="line"><a id="l02203" name="l02203"></a><span class="lineno"> 2203</span>            <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af7f72e6389799b7921aa98f30534f0d9">fork_db</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1fork__database.html#a97cf1402b71020048ae0054e4d7c8079">add</a>( bsp, <span class="keyword">true</span> );</div>
<div class="line"><a id="l02204" name="l02204"></a><span class="lineno"> 2204</span>         }</div>
<div class="line"><a id="l02205" name="l02205"></a><span class="lineno"> 2205</span> </div>
<div class="line"><a id="l02206" name="l02206"></a><span class="lineno"> 2206</span>         <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a6380e434da95a328ff48ccab33df9cb0">emit</a>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a64851fb4e041dc49ab22cf2ba335720d">self</a>.<a class="code hl_variable" href="classsysio_1_1chain_1_1controller.html#a0a0659166483870bf065f4d5e671484e">accepted_block_header</a>, bsp );</div>
<div class="line"><a id="l02207" name="l02207"></a><span class="lineno"> 2207</span> </div>
<div class="line"><a id="l02208" name="l02208"></a><span class="lineno"> 2208</span>         <span class="keywordflow">if</span>( <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a> == <a class="code hl_enumvalue" href="classsysio_1_1chain_1_1controller.html#a8b5124e077de1a73bb193e9c72b366b6a7e6e4eb3ff27864637756cb4d2a2a45d">controller::block_status::irreversible</a> ) {</div>
<div class="line"><a id="l02209" name="l02209"></a><span class="lineno"> 2209</span>            <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#aaf795677a1a49a35ac1a819a1a157929">apply_block</a>( bsp, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a>, <a class="code hl_typedef" href="namespacesysio_1_1chain.html#ad7e9cbb02002c4e7ab9825becb9f9f50">trx_meta_cache_lookup</a>{} );</div>
<div class="line"><a id="l02210" name="l02210"></a><span class="lineno"> 2210</span>            <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a56a0f369b58e6597b62569ff2853ee90">head</a> = bsp;</div>
<div class="line"><a id="l02211" name="l02211"></a><span class="lineno"> 2211</span> </div>
<div class="line"><a id="l02212" name="l02212"></a><span class="lineno"> 2212</span>            <span class="comment">// On replay, log_irreversible is not called and so no irreversible_block signal is emitted.</span></div>
<div class="line"><a id="l02213" name="l02213"></a><span class="lineno"> 2213</span>            <span class="comment">// So emit it explicitly here.</span></div>
<div class="line"><a id="l02214" name="l02214"></a><span class="lineno"> 2214</span>            <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a6380e434da95a328ff48ccab33df9cb0">emit</a>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a64851fb4e041dc49ab22cf2ba335720d">self</a>.<a class="code hl_variable" href="classsysio_1_1chain_1_1controller.html#a27266ebf16b6dd19a860635f7d1f9930">irreversible_block</a>, bsp );</div>
<div class="line"><a id="l02215" name="l02215"></a><span class="lineno"> 2215</span> </div>
<div class="line"><a id="l02216" name="l02216"></a><span class="lineno"> 2216</span>            <span class="keywordflow">if</span> (!<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a64851fb4e041dc49ab22cf2ba335720d">self</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#ac8eea0639eeef0fc0d304f645b80d884">skip_db_sessions</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a>)) {</div>
<div class="line"><a id="l02217" name="l02217"></a><span class="lineno"> 2217</span>               <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>.<a class="code hl_function" href="classchainbase_1_1database.html#aca6d7bcd700644f077b89203b2e8b7ef">commit</a>(bsp-&gt;block_num);</div>
<div class="line"><a id="l02218" name="l02218"></a><span class="lineno"> 2218</span>            }</div>
<div class="line"><a id="l02219" name="l02219"></a><span class="lineno"> 2219</span> </div>
<div class="line"><a id="l02220" name="l02220"></a><span class="lineno"> 2220</span>         } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l02221" name="l02221"></a><span class="lineno"> 2221</span>            <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a4a18397f763ebe4880b6ccd970bedf85">read_mode</a> != <a class="code hl_enumvalue" href="namespacesysio_1_1chain.html#af3e35f3e1b78dd00fa247009a2d9ba5ea88537e4e57a14e27d354f8ef6fc03d63">db_read_mode::IRREVERSIBLE</a>, <a class="code hl_variable" href="namespacesysio_1_1chain.html#a910243f6a0327fb2d4fc80f7e89f103e">block_validate_exception</a>,</div>
<div class="line"><a id="l02222" name="l02222"></a><span class="lineno"> 2222</span>                        <span class="stringliteral">&quot;invariant failure: cannot replay reversible blocks while in irreversible mode&quot;</span> );</div>
<div class="line"><a id="l02223" name="l02223"></a><span class="lineno"> 2223</span>            <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#af15d89f9220ba97aa5c521e643746587">maybe_switch_forks</a>( bsp, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a>, <a class="code hl_typedef" href="namespacesysio_1_1chain.html#ae043a3bf1321067bf1e4e7e5ab0ce3cd">forked_branch_callback</a>{}, <a class="code hl_typedef" href="namespacesysio_1_1chain.html#ad7e9cbb02002c4e7ab9825becb9f9f50">trx_meta_cache_lookup</a>{} );</div>
<div class="line"><a id="l02224" name="l02224"></a><span class="lineno"> 2224</span>         }</div>
<div class="line"><a id="l02225" name="l02225"></a><span class="lineno"> 2225</span> </div>
<div class="line"><a id="l02226" name="l02226"></a><span class="lineno"> 2226</span>      } <a class="code hl_define" href="exception_8hpp.html#ae70bfa24f5a3bc0917382b3c17fc033c">FC_LOG_AND_RETHROW</a>( )</div>
<div class="line"><a id="l02227" name="l02227"></a><span class="lineno"> 2227</span>   }</div>
</div>
<div class="line"><a id="l02228" name="l02228"></a><span class="lineno"> 2228</span> </div>
<div class="foldopen" id="foldopen02229" data-start="{" data-end="}">
<div class="line"><a id="l02229" name="l02229"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#af15d89f9220ba97aa5c521e643746587"> 2229</a></span>   <span class="keywordtype">void</span> <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#af15d89f9220ba97aa5c521e643746587">maybe_switch_forks</a>( <span class="keyword">const</span> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#ab9b14f4554cc4a0da2c361e9757b1662">block_state_ptr</a>&amp; new_head, <a class="code hl_enumeration" href="classsysio_1_1chain_1_1controller.html#a8b5124e077de1a73bb193e9c72b366b6">controller::block_status</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a>,</div>
<div class="line"><a id="l02230" name="l02230"></a><span class="lineno"> 2230</span>                            <span class="keyword">const</span> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#ae043a3bf1321067bf1e4e7e5ab0ce3cd">forked_branch_callback</a>&amp; forked_branch_cb, <span class="keyword">const</span> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#ad7e9cbb02002c4e7ab9825becb9f9f50">trx_meta_cache_lookup</a>&amp; trx_lookup )</div>
<div class="line"><a id="l02231" name="l02231"></a><span class="lineno"> 2231</span>   {</div>
<div class="line"><a id="l02232" name="l02232"></a><span class="lineno"> 2232</span>      <span class="keywordtype">bool</span> head_changed = <span class="keyword">true</span>;</div>
<div class="line"><a id="l02233" name="l02233"></a><span class="lineno"> 2233</span>      <span class="keywordflow">if</span>( new_head-&gt;header.previous == <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a56a0f369b58e6597b62569ff2853ee90">head</a>-&gt;id ) {</div>
<div class="line"><a id="l02234" name="l02234"></a><span class="lineno"> 2234</span>         <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l02235" name="l02235"></a><span class="lineno"> 2235</span>            <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#aaf795677a1a49a35ac1a819a1a157929">apply_block</a>( new_head, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a>, trx_lookup );</div>
<div class="line"><a id="l02236" name="l02236"></a><span class="lineno"> 2236</span>            <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af7f72e6389799b7921aa98f30534f0d9">fork_db</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1fork__database.html#a764fc46000bb93901ba6440fec07b5f9">mark_valid</a>( new_head );</div>
<div class="line"><a id="l02237" name="l02237"></a><span class="lineno"> 2237</span>            <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a56a0f369b58e6597b62569ff2853ee90">head</a> = new_head;</div>
<div class="line"><a id="l02238" name="l02238"></a><span class="lineno"> 2238</span>         } <span class="keywordflow">catch</span> ( <span class="keyword">const</span> std::exception&amp; e ) {</div>
<div class="line"><a id="l02239" name="l02239"></a><span class="lineno"> 2239</span>            <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af7f72e6389799b7921aa98f30534f0d9">fork_db</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1fork__database.html#a193f10ce12656c580b023d36193a5cdc">remove</a>( new_head-&gt;id );</div>
<div class="line"><a id="l02240" name="l02240"></a><span class="lineno"> 2240</span>            <span class="keywordflow">throw</span>;</div>
<div class="line"><a id="l02241" name="l02241"></a><span class="lineno"> 2241</span>         }</div>
<div class="line"><a id="l02242" name="l02242"></a><span class="lineno"> 2242</span>      } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( new_head-&gt;id != <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a56a0f369b58e6597b62569ff2853ee90">head</a>-&gt;id ) {</div>
<div class="line"><a id="l02243" name="l02243"></a><span class="lineno"> 2243</span>         <span class="keyword">auto</span> old_head = <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a56a0f369b58e6597b62569ff2853ee90">head</a>;</div>
<div class="line"><a id="l02244" name="l02244"></a><span class="lineno"> 2244</span>         <a class="code hl_define" href="logger_8hpp.html#a831cf08dc63704c11fd154132c6e8bdb">ilog</a>(<span class="stringliteral">&quot;switching forks from ${current_head_id} (block number ${current_head_num}) to ${new_head_id} (block number ${new_head_num})&quot;</span>,</div>
<div class="line"><a id="l02245" name="l02245"></a><span class="lineno"> 2245</span>              (<span class="stringliteral">&quot;current_head_id&quot;</span>, <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a56a0f369b58e6597b62569ff2853ee90">head</a>-&gt;id)(<span class="stringliteral">&quot;current_head_num&quot;</span>, <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a56a0f369b58e6597b62569ff2853ee90">head</a>-&gt;block_num)(<span class="stringliteral">&quot;new_head_id&quot;</span>, new_head-&gt;id)(<span class="stringliteral">&quot;new_head_num&quot;</span>, new_head-&gt;block_num) );</div>
<div class="line"><a id="l02246" name="l02246"></a><span class="lineno"> 2246</span> </div>
<div class="line"><a id="l02247" name="l02247"></a><span class="lineno"> 2247</span>         <span class="keywordflow">if</span> (<span class="keyword">auto</span> dm_logger = <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a1b67831f3be3a668c170723427236954">get_deep_mind_logger</a>()) {</div>
<div class="line"><a id="l02248" name="l02248"></a><span class="lineno"> 2248</span>            dm_logger-&gt;on_switch_forks(<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a56a0f369b58e6597b62569ff2853ee90">head</a>-&gt;id, new_head-&gt;id);</div>
<div class="line"><a id="l02249" name="l02249"></a><span class="lineno"> 2249</span>         }</div>
<div class="line"><a id="l02250" name="l02250"></a><span class="lineno"> 2250</span> </div>
<div class="line"><a id="l02251" name="l02251"></a><span class="lineno"> 2251</span>         <span class="keyword">auto</span> branches = <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af7f72e6389799b7921aa98f30534f0d9">fork_db</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1fork__database.html#a77f152572f2703a40e9c198456fad748">fetch_branch_from</a>( new_head-&gt;id, <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a56a0f369b58e6597b62569ff2853ee90">head</a>-&gt;id );</div>
<div class="line"><a id="l02252" name="l02252"></a><span class="lineno"> 2252</span> </div>
<div class="line"><a id="l02253" name="l02253"></a><span class="lineno"> 2253</span>         <span class="keywordflow">if</span>( branches.second.size() &gt; 0 ) {</div>
<div class="line"><a id="l02254" name="l02254"></a><span class="lineno"> 2254</span>            <span class="keywordflow">for</span>( <span class="keyword">auto</span> itr = branches.second.begin(); itr != branches.second.end(); ++itr ) {</div>
<div class="line"><a id="l02255" name="l02255"></a><span class="lineno"> 2255</span>               <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a571b0d08f97b43706abab71f59d4d9f7">pop_block</a>();</div>
<div class="line"><a id="l02256" name="l02256"></a><span class="lineno"> 2256</span>            }</div>
<div class="line"><a id="l02257" name="l02257"></a><span class="lineno"> 2257</span>            <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a64851fb4e041dc49ab22cf2ba335720d">self</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a37d0a44faef74cf0f96127982c1ce124">head_block_id</a>() == branches.second.back()-&gt;header.previous, <a class="code hl_variable" href="namespacesysio_1_1chain.html#acad19c1ca23d796138841046c67b3ea9">fork_database_exception</a>,</div>
<div class="line"><a id="l02258" name="l02258"></a><span class="lineno"> 2258</span>                     <span class="stringliteral">&quot;loss of sync between fork_db and chainbase during fork switch&quot;</span> ); <span class="comment">// _should_ never fail</span></div>
<div class="line"><a id="l02259" name="l02259"></a><span class="lineno"> 2259</span> </div>
<div class="line"><a id="l02260" name="l02260"></a><span class="lineno"> 2260</span>            <span class="keywordflow">if</span>( forked_branch_cb ) forked_branch_cb( branches.second );</div>
<div class="line"><a id="l02261" name="l02261"></a><span class="lineno"> 2261</span>         }</div>
<div class="line"><a id="l02262" name="l02262"></a><span class="lineno"> 2262</span> </div>
<div class="line"><a id="l02263" name="l02263"></a><span class="lineno"> 2263</span>         <span class="keywordflow">for</span>( <span class="keyword">auto</span> ritr = branches.first.rbegin(); ritr != branches.first.rend(); ++ritr ) {</div>
<div class="line"><a id="l02264" name="l02264"></a><span class="lineno"> 2264</span>            <span class="keyword">auto</span> except = std::exception_ptr{};</div>
<div class="line"><a id="l02265" name="l02265"></a><span class="lineno"> 2265</span>            <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l02266" name="l02266"></a><span class="lineno"> 2266</span>               <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#aaf795677a1a49a35ac1a819a1a157929">apply_block</a>( *ritr, (*ritr)-&gt;is_valid() ? <a class="code hl_enumvalue" href="classsysio_1_1chain_1_1controller.html#a8b5124e077de1a73bb193e9c72b366b6ac9e825f4641cd3bec0ba01a0c2d67755">controller::block_status::validated</a></div>
<div class="line"><a id="l02267" name="l02267"></a><span class="lineno"> 2267</span>                                                       : <a class="code hl_enumvalue" href="classsysio_1_1chain_1_1controller.html#a8b5124e077de1a73bb193e9c72b366b6ad9a22d7a8178d5b42a8750123cbfe5b1">controller::block_status::complete</a>, trx_lookup );</div>
<div class="line"><a id="l02268" name="l02268"></a><span class="lineno"> 2268</span>               <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af7f72e6389799b7921aa98f30534f0d9">fork_db</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1fork__database.html#a764fc46000bb93901ba6440fec07b5f9">mark_valid</a>( *ritr );</div>
<div class="line"><a id="l02269" name="l02269"></a><span class="lineno"> 2269</span>               <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a56a0f369b58e6597b62569ff2853ee90">head</a> = *ritr;</div>
<div class="line"><a id="l02270" name="l02270"></a><span class="lineno"> 2270</span>            } <span class="keywordflow">catch</span> ( <span class="keyword">const</span> std::bad_alloc&amp; ) {</div>
<div class="line"><a id="l02271" name="l02271"></a><span class="lineno"> 2271</span>              <span class="keywordflow">throw</span>;</div>
<div class="line"><a id="l02272" name="l02272"></a><span class="lineno"> 2272</span>            } <span class="keywordflow">catch</span> ( <span class="keyword">const</span> boost::interprocess::bad_alloc&amp; ) {</div>
<div class="line"><a id="l02273" name="l02273"></a><span class="lineno"> 2273</span>              <span class="keywordflow">throw</span>;</div>
<div class="line"><a id="l02274" name="l02274"></a><span class="lineno"> 2274</span>            } <span class="keywordflow">catch</span> (<span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1exception.html">fc::exception</a>&amp; e) {</div>
<div class="line"><a id="l02275" name="l02275"></a><span class="lineno"> 2275</span>               <a class="code hl_define" href="logger_8hpp.html#a9e3cdbaecd5a34b42956e888f7326fad">elog</a>(<span class="stringliteral">&quot;exception thrown while switching forks ${e}&quot;</span>, (<span class="stringliteral">&quot;e&quot;</span>, e.<a class="code hl_function" href="classfc_1_1exception.html#a7611ea8fbe25dde56649b685c2298a37">to_detail_string</a>()));</div>
<div class="line"><a id="l02276" name="l02276"></a><span class="lineno"> 2276</span>               except = std::current_exception();</div>
<div class="line"><a id="l02277" name="l02277"></a><span class="lineno"> 2277</span>            } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; e) {</div>
<div class="line"><a id="l02278" name="l02278"></a><span class="lineno"> 2278</span>               <a class="code hl_define" href="logger_8hpp.html#a9e3cdbaecd5a34b42956e888f7326fad">elog</a>(<span class="stringliteral">&quot;exception thrown while switching forks ${e}&quot;</span>, (<span class="stringliteral">&quot;e&quot;</span>, e.<a class="code hl_function" href="classfc_1_1exception.html#ab1104818bf0d9b6a29f0dfe036cf97f6">what</a>()));</div>
<div class="line"><a id="l02279" name="l02279"></a><span class="lineno"> 2279</span>               except = std::current_exception();</div>
<div class="line"><a id="l02280" name="l02280"></a><span class="lineno"> 2280</span>            }</div>
<div class="line"><a id="l02281" name="l02281"></a><span class="lineno"> 2281</span> </div>
<div class="line"><a id="l02282" name="l02282"></a><span class="lineno"> 2282</span>            <span class="keywordflow">if</span>( except ) {</div>
<div class="line"><a id="l02283" name="l02283"></a><span class="lineno"> 2283</span>               <span class="comment">// ritr currently points to the block that threw</span></div>
<div class="line"><a id="l02284" name="l02284"></a><span class="lineno"> 2284</span>               <span class="comment">// Remove the block that threw and all forks built off it.</span></div>
<div class="line"><a id="l02285" name="l02285"></a><span class="lineno"> 2285</span>               <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af7f72e6389799b7921aa98f30534f0d9">fork_db</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1fork__database.html#a193f10ce12656c580b023d36193a5cdc">remove</a>( (*ritr)-&gt;id );</div>
<div class="line"><a id="l02286" name="l02286"></a><span class="lineno"> 2286</span> </div>
<div class="line"><a id="l02287" name="l02287"></a><span class="lineno"> 2287</span>               <span class="comment">// pop all blocks from the bad fork, discarding their transactions</span></div>
<div class="line"><a id="l02288" name="l02288"></a><span class="lineno"> 2288</span>               <span class="comment">// ritr base is a forward itr to the last block successfully applied</span></div>
<div class="line"><a id="l02289" name="l02289"></a><span class="lineno"> 2289</span>               <span class="keyword">auto</span> applied_itr = ritr.base();</div>
<div class="line"><a id="l02290" name="l02290"></a><span class="lineno"> 2290</span>               <span class="keywordflow">for</span>( <span class="keyword">auto</span> itr = applied_itr; itr != branches.first.end(); ++itr ) {</div>
<div class="line"><a id="l02291" name="l02291"></a><span class="lineno"> 2291</span>                  <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a571b0d08f97b43706abab71f59d4d9f7">pop_block</a>();</div>
<div class="line"><a id="l02292" name="l02292"></a><span class="lineno"> 2292</span>               }</div>
<div class="line"><a id="l02293" name="l02293"></a><span class="lineno"> 2293</span>               <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a64851fb4e041dc49ab22cf2ba335720d">self</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a37d0a44faef74cf0f96127982c1ce124">head_block_id</a>() == branches.second.back()-&gt;header.previous, <a class="code hl_variable" href="namespacesysio_1_1chain.html#acad19c1ca23d796138841046c67b3ea9">fork_database_exception</a>,</div>
<div class="line"><a id="l02294" name="l02294"></a><span class="lineno"> 2294</span>                           <span class="stringliteral">&quot;loss of sync between fork_db and chainbase during fork switch reversal&quot;</span> ); <span class="comment">// _should_ never fail</span></div>
<div class="line"><a id="l02295" name="l02295"></a><span class="lineno"> 2295</span> </div>
<div class="line"><a id="l02296" name="l02296"></a><span class="lineno"> 2296</span>               <span class="comment">// re-apply good blocks</span></div>
<div class="line"><a id="l02297" name="l02297"></a><span class="lineno"> 2297</span>               <span class="keywordflow">for</span>( <span class="keyword">auto</span> ritr = branches.second.rbegin(); ritr != branches.second.rend(); ++ritr ) {</div>
<div class="line"><a id="l02298" name="l02298"></a><span class="lineno"> 2298</span>                  <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#aaf795677a1a49a35ac1a819a1a157929">apply_block</a>( *ritr, <a class="code hl_enumvalue" href="classsysio_1_1chain_1_1controller.html#a8b5124e077de1a73bb193e9c72b366b6ac9e825f4641cd3bec0ba01a0c2d67755">controller::block_status::validated</a> <span class="comment">/* we previously validated these blocks*/</span>, trx_lookup );</div>
<div class="line"><a id="l02299" name="l02299"></a><span class="lineno"> 2299</span>                  <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a56a0f369b58e6597b62569ff2853ee90">head</a> = *ritr;</div>
<div class="line"><a id="l02300" name="l02300"></a><span class="lineno"> 2300</span>               }</div>
<div class="line"><a id="l02301" name="l02301"></a><span class="lineno"> 2301</span>               std::rethrow_exception(except);</div>
<div class="line"><a id="l02302" name="l02302"></a><span class="lineno"> 2302</span>            } <span class="comment">// end if exception</span></div>
<div class="line"><a id="l02303" name="l02303"></a><span class="lineno"> 2303</span>         } </div>
<div class="line"><a id="l02304" name="l02304"></a><span class="lineno"> 2304</span> </div>
<div class="line"><a id="l02305" name="l02305"></a><span class="lineno"> 2305</span>         <a class="code hl_define" href="logger_8hpp.html#a831cf08dc63704c11fd154132c6e8bdb">ilog</a>(<span class="stringliteral">&quot;successfully switched fork to new head ${new_head_id}&quot;</span>, (<span class="stringliteral">&quot;new_head_id&quot;</span>, new_head-&gt;id));</div>
<div class="line"><a id="l02306" name="l02306"></a><span class="lineno"> 2306</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l02307" name="l02307"></a><span class="lineno"> 2307</span>         head_changed = <span class="keyword">false</span>;</div>
<div class="line"><a id="l02308" name="l02308"></a><span class="lineno"> 2308</span>      }</div>
<div class="line"><a id="l02309" name="l02309"></a><span class="lineno"> 2309</span> </div>
<div class="line"><a id="l02310" name="l02310"></a><span class="lineno"> 2310</span>      <span class="keywordflow">if</span>( head_changed )</div>
<div class="line"><a id="l02311" name="l02311"></a><span class="lineno"> 2311</span>         <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#ad0130874bac31eb408dd6e766084b814">log_irreversible</a>();</div>
<div class="line"><a id="l02312" name="l02312"></a><span class="lineno"> 2312</span> </div>
<div class="line"><a id="l02313" name="l02313"></a><span class="lineno"> 2313</span>   } </div>
</div>
<div class="line"><a id="l02314" name="l02314"></a><span class="lineno"> 2314</span> </div>
<div class="foldopen" id="foldopen02315" data-start="{" data-end="}">
<div class="line"><a id="l02315" name="l02315"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#aed82882c38a7b9a2ab8ccf26b7d68126"> 2315</a></span>   <a class="code hl_class" href="classfc_1_1vector.html">vector&lt;transaction_metadata_ptr&gt;</a> <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#aed82882c38a7b9a2ab8ccf26b7d68126">abort_block</a>() {</div>
<div class="line"><a id="l02316" name="l02316"></a><span class="lineno"> 2316</span>      <a class="code hl_class" href="classfc_1_1vector.html">vector&lt;transaction_metadata_ptr&gt;</a> applied_trxs;</div>
<div class="line"><a id="l02317" name="l02317"></a><span class="lineno"> 2317</span>      <span class="keywordflow">if</span>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a0e355919fd924a05344ef2b59f7dd587">pending</a> ) {</div>
<div class="line"><a id="l02318" name="l02318"></a><span class="lineno"> 2318</span>         applied_trxs = <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a0e355919fd924a05344ef2b59f7dd587">pending</a>-&gt;extract_trx_metas();</div>
<div class="line"><a id="l02319" name="l02319"></a><span class="lineno"> 2319</span>         <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a0e355919fd924a05344ef2b59f7dd587">pending</a>.reset();</div>
<div class="line"><a id="l02320" name="l02320"></a><span class="lineno"> 2320</span>         <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a24a100a7be5e562ac3966924b0c9ccb6">protocol_features</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1protocol__feature__manager.html#a5b8ed9cc5cb5822d6cb645a3b7a5f98c">popped_blocks_to</a>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a56a0f369b58e6597b62569ff2853ee90">head</a>-&gt;block_num );</div>
<div class="line"><a id="l02321" name="l02321"></a><span class="lineno"> 2321</span>      }</div>
<div class="line"><a id="l02322" name="l02322"></a><span class="lineno"> 2322</span>      <span class="keywordflow">return</span> applied_trxs;</div>
<div class="line"><a id="l02323" name="l02323"></a><span class="lineno"> 2323</span>   }</div>
</div>
<div class="line"><a id="l02324" name="l02324"></a><span class="lineno"> 2324</span> </div>
<div class="foldopen" id="foldopen02325" data-start="{" data-end="}">
<div class="line"><a id="l02325" name="l02325"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#a9ae4fff15a76a1c3089fdf0f3353a17f"> 2325</a></span>   <span class="keyword">static</span> <a class="code hl_class" href="classfc_1_1sha256.html">checksum256_type</a> <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a9ae4fff15a76a1c3089fdf0f3353a17f">calculate_trx_merkle</a>( <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1vector.html">vector&lt;transaction_receipt&gt;</a>&amp; trxs ) {</div>
<div class="line"><a id="l02326" name="l02326"></a><span class="lineno"> 2326</span>      <a class="code hl_class" href="classfc_1_1vector.html">vector&lt;digest_type&gt;</a> trx_digests;</div>
<div class="line"><a id="l02327" name="l02327"></a><span class="lineno"> 2327</span>      trx_digests.reserve( trxs.size() );</div>
<div class="line"><a id="l02328" name="l02328"></a><span class="lineno"> 2328</span>      <span class="keywordflow">for</span>( <span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code hl_variable" href="pointer_8h.html#aeeddce917cf130d62c370b8f216026dd">a</a> : trxs )</div>
<div class="line"><a id="l02329" name="l02329"></a><span class="lineno"> 2329</span>         trx_digests.emplace_back( <a class="code hl_variable" href="pointer_8h.html#aeeddce917cf130d62c370b8f216026dd">a</a>.digest() );</div>
<div class="line"><a id="l02330" name="l02330"></a><span class="lineno"> 2330</span> </div>
<div class="line"><a id="l02331" name="l02331"></a><span class="lineno"> 2331</span>      <span class="keywordflow">return</span> <a class="code hl_function" href="namespacesysio_1_1chain.html#a80d7ea5476f97bf51a25149b55469c40">merkle</a>( move(trx_digests) );</div>
<div class="line"><a id="l02332" name="l02332"></a><span class="lineno"> 2332</span>   }</div>
</div>
<div class="line"><a id="l02333" name="l02333"></a><span class="lineno"> 2333</span> </div>
<div class="foldopen" id="foldopen02334" data-start="{" data-end="}">
<div class="line"><a id="l02334" name="l02334"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#a69d180992926a229a5e3573ea09d762f"> 2334</a></span>   <span class="keywordtype">void</span> <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a69d180992926a229a5e3573ea09d762f">update_producers_authority</a>() {</div>
<div class="line"><a id="l02335" name="l02335"></a><span class="lineno"> 2335</span>      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code hl_function" href="programs_2sysio-launcher_2main_8cpp.html#a6d42fdcc89e90507ee6f095c8e92fa2b">producers</a> = <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a0e355919fd924a05344ef2b59f7dd587">pending</a>-&gt;get_pending_block_header_state().active_schedule.producers;</div>
<div class="line"><a id="l02336" name="l02336"></a><span class="lineno"> 2336</span> </div>
<div class="line"><a id="l02337" name="l02337"></a><span class="lineno"> 2337</span>      <span class="keyword">auto</span> update_permission = [&amp;]( <span class="keyword">auto</span>&amp; permission, <span class="keyword">auto</span> threshold ) {</div>
<div class="line"><a id="l02338" name="l02338"></a><span class="lineno"> 2338</span>         <span class="keyword">auto</span> auth = <a class="code hl_struct" href="structsysio_1_1chain_1_1authority.html">authority</a>( threshold, {}, {});</div>
<div class="line"><a id="l02339" name="l02339"></a><span class="lineno"> 2339</span>         <span class="keywordflow">for</span>( <span class="keyword">auto</span>&amp; <a class="code hl_variable" href="bn_8cpp.html#a8b0eadcc506862e9d751ab45185053aa">p</a> : <a class="code hl_function" href="programs_2sysio-launcher_2main_8cpp.html#a6d42fdcc89e90507ee6f095c8e92fa2b">producers</a> ) {</div>
<div class="line"><a id="l02340" name="l02340"></a><span class="lineno"> 2340</span>            auth.accounts.push_back({{<a class="code hl_variable" href="bn_8cpp.html#a8b0eadcc506862e9d751ab45185053aa">p</a>.producer_name, config::active_name}, 1});</div>
<div class="line"><a id="l02341" name="l02341"></a><span class="lineno"> 2341</span>         }</div>
<div class="line"><a id="l02342" name="l02342"></a><span class="lineno"> 2342</span> </div>
<div class="line"><a id="l02343" name="l02343"></a><span class="lineno"> 2343</span>         <span class="keywordflow">if</span>( <span class="keyword">static_cast&lt;</span><a class="code hl_struct" href="structsysio_1_1chain_1_1authority.html">authority</a><span class="keyword">&gt;</span>(permission.auth) != auth ) { <span class="comment">// TODO: use a more efficient way to check that authority has not changed</span></div>
<div class="line"><a id="l02344" name="l02344"></a><span class="lineno"> 2344</span>            <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>.<a class="code hl_function" href="classchainbase_1_1database.html#a9ebc006075e8fc2e84357a0e068b58d4">modify</a>(permission, [&amp;]( <span class="keyword">auto</span>&amp; po ) {</div>
<div class="line"><a id="l02345" name="l02345"></a><span class="lineno"> 2345</span>               po.auth = auth;</div>
<div class="line"><a id="l02346" name="l02346"></a><span class="lineno"> 2346</span>            });</div>
<div class="line"><a id="l02347" name="l02347"></a><span class="lineno"> 2347</span>         }</div>
<div class="line"><a id="l02348" name="l02348"></a><span class="lineno"> 2348</span>      };</div>
<div class="line"><a id="l02349" name="l02349"></a><span class="lineno"> 2349</span> </div>
<div class="line"><a id="l02350" name="l02350"></a><span class="lineno"> 2350</span>      <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> num_producers = <a class="code hl_function" href="programs_2sysio-launcher_2main_8cpp.html#a6d42fdcc89e90507ee6f095c8e92fa2b">producers</a>.size();</div>
<div class="line"><a id="l02351" name="l02351"></a><span class="lineno"> 2351</span>      <span class="keyword">auto</span> calculate_threshold = [=]( <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> numerator, <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> denominator ) {</div>
<div class="line"><a id="l02352" name="l02352"></a><span class="lineno"> 2352</span>         <span class="keywordflow">return</span> ( (num_producers * numerator) / denominator ) + 1;</div>
<div class="line"><a id="l02353" name="l02353"></a><span class="lineno"> 2353</span>      };</div>
<div class="line"><a id="l02354" name="l02354"></a><span class="lineno"> 2354</span> </div>
<div class="line"><a id="l02355" name="l02355"></a><span class="lineno"> 2355</span>      update_permission( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#ab90d295ac18fa98f2520e4eade5b3773">authorization</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1authorization__manager.html#a96924f6aca32a602e24d991d12278a69">get_permission</a>({config::producers_account_name,</div>
<div class="line"><a id="l02356" name="l02356"></a><span class="lineno"> 2356</span>                                                       config::active_name}),</div>
<div class="line"><a id="l02357" name="l02357"></a><span class="lineno"> 2357</span>                         calculate_threshold( 2, 3 ) <span class="comment">/* more than two-thirds */</span>                      );</div>
<div class="line"><a id="l02358" name="l02358"></a><span class="lineno"> 2358</span> </div>
<div class="line"><a id="l02359" name="l02359"></a><span class="lineno"> 2359</span>      update_permission( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#ab90d295ac18fa98f2520e4eade5b3773">authorization</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1authorization__manager.html#a96924f6aca32a602e24d991d12278a69">get_permission</a>({config::producers_account_name,</div>
<div class="line"><a id="l02360" name="l02360"></a><span class="lineno"> 2360</span>                                                       config::majority_producers_permission_name}),</div>
<div class="line"><a id="l02361" name="l02361"></a><span class="lineno"> 2361</span>                         calculate_threshold( 1, 2 ) <span class="comment">/* more than one-half */</span>                        );</div>
<div class="line"><a id="l02362" name="l02362"></a><span class="lineno"> 2362</span> </div>
<div class="line"><a id="l02363" name="l02363"></a><span class="lineno"> 2363</span>      update_permission( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#ab90d295ac18fa98f2520e4eade5b3773">authorization</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1authorization__manager.html#a96924f6aca32a602e24d991d12278a69">get_permission</a>({config::producers_account_name,</div>
<div class="line"><a id="l02364" name="l02364"></a><span class="lineno"> 2364</span>                                                       config::minority_producers_permission_name}),</div>
<div class="line"><a id="l02365" name="l02365"></a><span class="lineno"> 2365</span>                         calculate_threshold( 1, 3 ) <span class="comment">/* more than one-third */</span>                       );</div>
<div class="line"><a id="l02366" name="l02366"></a><span class="lineno"> 2366</span> </div>
<div class="line"><a id="l02367" name="l02367"></a><span class="lineno"> 2367</span>      <span class="comment">//TODO: Add tests</span></div>
<div class="line"><a id="l02368" name="l02368"></a><span class="lineno"> 2368</span>   }</div>
</div>
<div class="line"><a id="l02369" name="l02369"></a><span class="lineno"> 2369</span> </div>
<div class="foldopen" id="foldopen02370" data-start="{" data-end="}">
<div class="line"><a id="l02370" name="l02370"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#a78427c6c856e3f2398f434c7d9366a84"> 2370</a></span>   <span class="keywordtype">void</span> <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a78427c6c856e3f2398f434c7d9366a84">create_block_summary</a>(<span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1sha256.html">block_id_type</a>&amp; <span class="keywordtype">id</span>) {</div>
<div class="line"><a id="l02371" name="l02371"></a><span class="lineno"> 2371</span>      <span class="keyword">auto</span> block_num = <a class="code hl_function" href="structsysio_1_1chain_1_1block__header.html#a39d57e33ef8d3f6ba59b4c458f0ae375">block_header::num_from_id</a>(<span class="keywordtype">id</span>);</div>
<div class="line"><a id="l02372" name="l02372"></a><span class="lineno"> 2372</span>      <span class="keyword">auto</span> sid = block_num &amp; 0xffff;</div>
<div class="line"><a id="l02373" name="l02373"></a><span class="lineno"> 2373</span>      <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>.<a class="code hl_function" href="classchainbase_1_1database.html#a9ebc006075e8fc2e84357a0e068b58d4">modify</a>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>.<a class="code hl_function" href="classchainbase_1_1database.html#afcfe00f81a526c1376d4f51197dd3a9a">get</a>&lt;<a class="code hl_class" href="classsysio_1_1chain_1_1block__summary__object.html">block_summary_object</a>,by_id&gt;(sid), [&amp;](<a class="code hl_class" href="classsysio_1_1chain_1_1block__summary__object.html">block_summary_object</a>&amp; bso ) {</div>
<div class="line"><a id="l02374" name="l02374"></a><span class="lineno"> 2374</span>          bso.block_id = id;</div>
<div class="line"><a id="l02375" name="l02375"></a><span class="lineno"> 2375</span>      });</div>
<div class="line"><a id="l02376" name="l02376"></a><span class="lineno"> 2376</span>   }</div>
</div>
<div class="line"><a id="l02377" name="l02377"></a><span class="lineno"> 2377</span> </div>
<div class="line"><a id="l02378" name="l02378"></a><span class="lineno"> 2378</span> </div>
<div class="foldopen" id="foldopen02379" data-start="{" data-end="}">
<div class="line"><a id="l02379" name="l02379"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#a338cb13e3b27ade2ee719b5421edcf7e"> 2379</a></span>   <span class="keywordtype">void</span> <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a338cb13e3b27ade2ee719b5421edcf7e">clear_expired_input_transactions</a>(<span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1time__point.html">fc::time_point</a>&amp; deadline) {</div>
<div class="line"><a id="l02380" name="l02380"></a><span class="lineno"> 2380</span>      <span class="comment">//Look for expired transactions in the deduplication list, and remove them.</span></div>
<div class="line"><a id="l02381" name="l02381"></a><span class="lineno"> 2381</span>      <span class="keyword">auto</span>&amp; transaction_idx = <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">db</a>.<a class="code hl_function" href="classchainbase_1_1database.html#afaea057692a8bbbf3f506b64c60308b6">get_mutable_index</a>&lt;<a class="code hl_typedef" href="namespacesysio_1_1chain.html#a7ae1398893dd587589ee5593a952a2ef">transaction_multi_index</a>&gt;();</div>
<div class="line"><a id="l02382" name="l02382"></a><span class="lineno"> 2382</span>      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; dedupe_index = transaction_idx.indices().get&lt;by_expiration&gt;();</div>
<div class="line"><a id="l02383" name="l02383"></a><span class="lineno"> 2383</span>      <span class="keyword">auto</span> now = <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a64851fb4e041dc49ab22cf2ba335720d">self</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a286751cd6498b500b70a0d3678672263">is_building_block</a>() ? <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a64851fb4e041dc49ab22cf2ba335720d">self</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#abb1d81f96986df3bce46bd37caaf6a69">pending_block_time</a>() : <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a64851fb4e041dc49ab22cf2ba335720d">self</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#aea3612e7cb52dfcaa2e6afdc1b3e2f51">head_block_time</a>();</div>
<div class="line"><a id="l02384" name="l02384"></a><span class="lineno"> 2384</span>      <span class="keyword">const</span> <span class="keyword">auto</span> total = dedupe_index.size();</div>
<div class="line"><a id="l02385" name="l02385"></a><span class="lineno"> 2385</span>      <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> num_removed = 0;</div>
<div class="line"><a id="l02386" name="l02386"></a><span class="lineno"> 2386</span>      <span class="keywordflow">while</span>( (!dedupe_index.empty()) &amp;&amp; ( now &gt; <a class="code hl_class" href="classfc_1_1time__point.html">fc::time_point</a>(dedupe_index.begin()-&gt;expiration) ) ) {</div>
<div class="line"><a id="l02387" name="l02387"></a><span class="lineno"> 2387</span>         transaction_idx.remove(*dedupe_index.begin());</div>
<div class="line"><a id="l02388" name="l02388"></a><span class="lineno"> 2388</span>         ++num_removed;</div>
<div class="line"><a id="l02389" name="l02389"></a><span class="lineno"> 2389</span>         <span class="keywordflow">if</span>( deadline &lt;= <a class="code hl_function" href="classfc_1_1time__point.html#aa164ff1268a16d4b32afcff181f6100e">fc::time_point::now</a>() ) {</div>
<div class="line"><a id="l02390" name="l02390"></a><span class="lineno"> 2390</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l02391" name="l02391"></a><span class="lineno"> 2391</span>         }</div>
<div class="line"><a id="l02392" name="l02392"></a><span class="lineno"> 2392</span>      }</div>
<div class="line"><a id="l02393" name="l02393"></a><span class="lineno"> 2393</span>      <a class="code hl_define" href="logger_8hpp.html#a3da1571bad6ca6c94df9a3660b2115ee">dlog</a>(<span class="stringliteral">&quot;removed ${n} expired transactions of the ${t} input dedup list, pending block time ${pt}&quot;</span>,</div>
<div class="line"><a id="l02394" name="l02394"></a><span class="lineno"> 2394</span>           (<span class="stringliteral">&quot;n&quot;</span>, num_removed)(<span class="stringliteral">&quot;t&quot;</span>, total)(<span class="stringliteral">&quot;pt&quot;</span>, now));</div>
<div class="line"><a id="l02395" name="l02395"></a><span class="lineno"> 2395</span>   }</div>
</div>
<div class="line"><a id="l02396" name="l02396"></a><span class="lineno"> 2396</span> </div>
<div class="foldopen" id="foldopen02397" data-start="{" data-end="}">
<div class="line"><a id="l02397" name="l02397"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#aea41b3020ee2994f7a15980fcbf9b735"> 2397</a></span>   <span class="keywordtype">bool</span> <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#aea41b3020ee2994f7a15980fcbf9b735">sender_avoids_whitelist_blacklist_enforcement</a>( <a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">account_name</a> sender )<span class="keyword">const </span>{</div>
<div class="line"><a id="l02398" name="l02398"></a><span class="lineno"> 2398</span>      <span class="keywordflow">if</span>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a048ac8e4d4436902a1888df13575b252">conf</a>.<a class="code hl_variable" href="structsysio_1_1chain_1_1controller_1_1config.html#a8440b353861fe179036cb8af088323ff">sender_bypass_whiteblacklist</a>.size() &gt; 0 &amp;&amp;</div>
<div class="line"><a id="l02399" name="l02399"></a><span class="lineno"> 2399</span>          ( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a048ac8e4d4436902a1888df13575b252">conf</a>.<a class="code hl_variable" href="structsysio_1_1chain_1_1controller_1_1config.html#a8440b353861fe179036cb8af088323ff">sender_bypass_whiteblacklist</a>.find( sender ) != <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a048ac8e4d4436902a1888df13575b252">conf</a>.<a class="code hl_variable" href="structsysio_1_1chain_1_1controller_1_1config.html#a8440b353861fe179036cb8af088323ff">sender_bypass_whiteblacklist</a>.end() ) )</div>
<div class="line"><a id="l02400" name="l02400"></a><span class="lineno"> 2400</span>      {</div>
<div class="line"><a id="l02401" name="l02401"></a><span class="lineno"> 2401</span>         <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l02402" name="l02402"></a><span class="lineno"> 2402</span>      }</div>
<div class="line"><a id="l02403" name="l02403"></a><span class="lineno"> 2403</span> </div>
<div class="line"><a id="l02404" name="l02404"></a><span class="lineno"> 2404</span>      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l02405" name="l02405"></a><span class="lineno"> 2405</span>   }</div>
</div>
<div class="line"><a id="l02406" name="l02406"></a><span class="lineno"> 2406</span> </div>
<div class="foldopen" id="foldopen02407" data-start="{" data-end="}">
<div class="line"><a id="l02407" name="l02407"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#ac79d2ab18d201291e9fbd0b38044e1f1"> 2407</a></span>   <span class="keywordtype">void</span> <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#ac79d2ab18d201291e9fbd0b38044e1f1">check_actor_list</a>( <span class="keyword">const</span> flat_set&lt;account_name&gt;&amp; actors )<span class="keyword">const </span>{</div>
<div class="line"><a id="l02408" name="l02408"></a><span class="lineno"> 2408</span>      <span class="keywordflow">if</span>( actors.size() == 0 ) <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l02409" name="l02409"></a><span class="lineno"> 2409</span> </div>
<div class="line"><a id="l02410" name="l02410"></a><span class="lineno"> 2410</span>      <span class="keywordflow">if</span>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a048ac8e4d4436902a1888df13575b252">conf</a>.<a class="code hl_variable" href="structsysio_1_1chain_1_1controller_1_1config.html#a64ea139aa98e2d67dfed0a5c2f36eb77">actor_whitelist</a>.size() &gt; 0 ) {</div>
<div class="line"><a id="l02411" name="l02411"></a><span class="lineno"> 2411</span>         <span class="comment">// throw if actors is not a subset of whitelist</span></div>
<div class="line"><a id="l02412" name="l02412"></a><span class="lineno"> 2412</span>         <span class="keyword">const</span> <span class="keyword">auto</span>&amp; whitelist = <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a048ac8e4d4436902a1888df13575b252">conf</a>.<a class="code hl_variable" href="structsysio_1_1chain_1_1controller_1_1config.html#a64ea139aa98e2d67dfed0a5c2f36eb77">actor_whitelist</a>;</div>
<div class="line"><a id="l02413" name="l02413"></a><span class="lineno"> 2413</span>         <span class="keywordtype">bool</span> is_subset = <span class="keyword">true</span>;</div>
<div class="line"><a id="l02414" name="l02414"></a><span class="lineno"> 2414</span> </div>
<div class="line"><a id="l02415" name="l02415"></a><span class="lineno"> 2415</span>         <span class="comment">// quick extents check, then brute force the check actors</span></div>
<div class="line"><a id="l02416" name="l02416"></a><span class="lineno"> 2416</span>         <span class="keywordflow">if</span> (*actors.cbegin() &gt;= *whitelist.cbegin() &amp;&amp; *actors.crbegin() &lt;= *whitelist.crbegin() ) {</div>
<div class="line"><a id="l02417" name="l02417"></a><span class="lineno"> 2417</span>            <span class="keyword">auto</span> lower_bound = whitelist.cbegin();</div>
<div class="line"><a id="l02418" name="l02418"></a><span class="lineno"> 2418</span>            <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code hl_class" href="classfc_1_1actor.html">actor</a>: actors) {</div>
<div class="line"><a id="l02419" name="l02419"></a><span class="lineno"> 2419</span>               lower_bound = std::lower_bound(lower_bound, whitelist.cend(), <a class="code hl_class" href="classfc_1_1actor.html">actor</a>);</div>
<div class="line"><a id="l02420" name="l02420"></a><span class="lineno"> 2420</span> </div>
<div class="line"><a id="l02421" name="l02421"></a><span class="lineno"> 2421</span>               <span class="comment">// if the actor is not found, this is not a subset</span></div>
<div class="line"><a id="l02422" name="l02422"></a><span class="lineno"> 2422</span>               <span class="keywordflow">if</span> (lower_bound == whitelist.cend() || *lower_bound != <a class="code hl_class" href="classfc_1_1actor.html">actor</a> ) {</div>
<div class="line"><a id="l02423" name="l02423"></a><span class="lineno"> 2423</span>                  is_subset = <span class="keyword">false</span>;</div>
<div class="line"><a id="l02424" name="l02424"></a><span class="lineno"> 2424</span>                  <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l02425" name="l02425"></a><span class="lineno"> 2425</span>               }</div>
<div class="line"><a id="l02426" name="l02426"></a><span class="lineno"> 2426</span> </div>
<div class="line"><a id="l02427" name="l02427"></a><span class="lineno"> 2427</span>               <span class="comment">// if the actor was found, we are guaranteed that other actors are either not present in the whitelist</span></div>
<div class="line"><a id="l02428" name="l02428"></a><span class="lineno"> 2428</span>               <span class="comment">// or will be present in the range defined as [next actor,end)</span></div>
<div class="line"><a id="l02429" name="l02429"></a><span class="lineno"> 2429</span>               lower_bound = std::next(lower_bound);</div>
<div class="line"><a id="l02430" name="l02430"></a><span class="lineno"> 2430</span>            }</div>
<div class="line"><a id="l02431" name="l02431"></a><span class="lineno"> 2431</span>         } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l02432" name="l02432"></a><span class="lineno"> 2432</span>            is_subset = <span class="keyword">false</span>;</div>
<div class="line"><a id="l02433" name="l02433"></a><span class="lineno"> 2433</span>         }</div>
<div class="line"><a id="l02434" name="l02434"></a><span class="lineno"> 2434</span> </div>
<div class="line"><a id="l02435" name="l02435"></a><span class="lineno"> 2435</span>         <span class="comment">// helper lambda to lazily calculate the actors for error messaging</span></div>
<div class="line"><a id="l02436" name="l02436"></a><span class="lineno"> 2436</span>         <span class="keyword">static</span> <span class="keyword">auto</span> generate_missing_actors = [](<span class="keyword">const</span> flat_set&lt;account_name&gt;&amp; actors, <span class="keyword">const</span> flat_set&lt;account_name&gt;&amp; whitelist) -&gt; <a class="code hl_class" href="classfc_1_1vector.html">vector&lt;account_name&gt;</a> {</div>
<div class="line"><a id="l02437" name="l02437"></a><span class="lineno"> 2437</span>            <a class="code hl_class" href="classfc_1_1vector.html">vector&lt;account_name&gt;</a> excluded;</div>
<div class="line"><a id="l02438" name="l02438"></a><span class="lineno"> 2438</span>            excluded.reserve( actors.size() );</div>
<div class="line"><a id="l02439" name="l02439"></a><span class="lineno"> 2439</span>            set_difference( actors.begin(), actors.end(),</div>
<div class="line"><a id="l02440" name="l02440"></a><span class="lineno"> 2440</span>                            whitelist.begin(), whitelist.end(),</div>
<div class="line"><a id="l02441" name="l02441"></a><span class="lineno"> 2441</span>                            std::back_inserter(excluded) );</div>
<div class="line"><a id="l02442" name="l02442"></a><span class="lineno"> 2442</span>            <span class="keywordflow">return</span> excluded;</div>
<div class="line"><a id="l02443" name="l02443"></a><span class="lineno"> 2443</span>         };</div>
<div class="line"><a id="l02444" name="l02444"></a><span class="lineno"> 2444</span> </div>
<div class="line"><a id="l02445" name="l02445"></a><span class="lineno"> 2445</span>         <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( is_subset,  actor_whitelist_exception,</div>
<div class="line"><a id="l02446" name="l02446"></a><span class="lineno"> 2446</span>                     <span class="stringliteral">&quot;authorizing actor(s) in transaction are not on the actor whitelist: ${actors}&quot;</span>,</div>
<div class="line"><a id="l02447" name="l02447"></a><span class="lineno"> 2447</span>                     (<span class="stringliteral">&quot;actors&quot;</span>, generate_missing_actors(actors, whitelist))</div>
<div class="line"><a id="l02448" name="l02448"></a><span class="lineno"> 2448</span>                   );</div>
<div class="line"><a id="l02449" name="l02449"></a><span class="lineno"> 2449</span>      } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a048ac8e4d4436902a1888df13575b252">conf</a>.<a class="code hl_variable" href="structsysio_1_1chain_1_1controller_1_1config.html#a5922ec305c682477fd9ef6ce74293c9d">actor_blacklist</a>.size() &gt; 0 ) {</div>
<div class="line"><a id="l02450" name="l02450"></a><span class="lineno"> 2450</span>         <span class="comment">// throw if actors intersects blacklist</span></div>
<div class="line"><a id="l02451" name="l02451"></a><span class="lineno"> 2451</span>         <span class="keyword">const</span> <span class="keyword">auto</span>&amp; blacklist = <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a048ac8e4d4436902a1888df13575b252">conf</a>.<a class="code hl_variable" href="structsysio_1_1chain_1_1controller_1_1config.html#a5922ec305c682477fd9ef6ce74293c9d">actor_blacklist</a>;</div>
<div class="line"><a id="l02452" name="l02452"></a><span class="lineno"> 2452</span>         <span class="keywordtype">bool</span> intersects = <span class="keyword">false</span>;</div>
<div class="line"><a id="l02453" name="l02453"></a><span class="lineno"> 2453</span> </div>
<div class="line"><a id="l02454" name="l02454"></a><span class="lineno"> 2454</span>         <span class="comment">// quick extents check then brute force check actors</span></div>
<div class="line"><a id="l02455" name="l02455"></a><span class="lineno"> 2455</span>         <span class="keywordflow">if</span>( *actors.cbegin() &lt;= *blacklist.crbegin() &amp;&amp; *actors.crbegin() &gt;= *blacklist.cbegin() ) {</div>
<div class="line"><a id="l02456" name="l02456"></a><span class="lineno"> 2456</span>            <span class="keyword">auto</span> lower_bound = blacklist.cbegin();</div>
<div class="line"><a id="l02457" name="l02457"></a><span class="lineno"> 2457</span>            <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code hl_class" href="classfc_1_1actor.html">actor</a>: actors) {</div>
<div class="line"><a id="l02458" name="l02458"></a><span class="lineno"> 2458</span>               lower_bound = std::lower_bound(lower_bound, blacklist.cend(), <a class="code hl_class" href="classfc_1_1actor.html">actor</a>);</div>
<div class="line"><a id="l02459" name="l02459"></a><span class="lineno"> 2459</span> </div>
<div class="line"><a id="l02460" name="l02460"></a><span class="lineno"> 2460</span>               <span class="comment">// if the lower bound in the blacklist is at the end, all other actors are guaranteed to</span></div>
<div class="line"><a id="l02461" name="l02461"></a><span class="lineno"> 2461</span>               <span class="comment">// not exist in the blacklist</span></div>
<div class="line"><a id="l02462" name="l02462"></a><span class="lineno"> 2462</span>               <span class="keywordflow">if</span> (lower_bound == blacklist.cend()) {</div>
<div class="line"><a id="l02463" name="l02463"></a><span class="lineno"> 2463</span>                  <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l02464" name="l02464"></a><span class="lineno"> 2464</span>               }</div>
<div class="line"><a id="l02465" name="l02465"></a><span class="lineno"> 2465</span> </div>
<div class="line"><a id="l02466" name="l02466"></a><span class="lineno"> 2466</span>               <span class="comment">// if the lower bound of an actor IS the actor, then we have an intersection</span></div>
<div class="line"><a id="l02467" name="l02467"></a><span class="lineno"> 2467</span>               <span class="keywordflow">if</span> (*lower_bound == <a class="code hl_class" href="classfc_1_1actor.html">actor</a>) {</div>
<div class="line"><a id="l02468" name="l02468"></a><span class="lineno"> 2468</span>                  intersects = <span class="keyword">true</span>;</div>
<div class="line"><a id="l02469" name="l02469"></a><span class="lineno"> 2469</span>                  <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l02470" name="l02470"></a><span class="lineno"> 2470</span>               }</div>
<div class="line"><a id="l02471" name="l02471"></a><span class="lineno"> 2471</span>            }</div>
<div class="line"><a id="l02472" name="l02472"></a><span class="lineno"> 2472</span>         }</div>
<div class="line"><a id="l02473" name="l02473"></a><span class="lineno"> 2473</span> </div>
<div class="line"><a id="l02474" name="l02474"></a><span class="lineno"> 2474</span>         <span class="comment">// helper lambda to lazily calculate the actors for error messaging</span></div>
<div class="line"><a id="l02475" name="l02475"></a><span class="lineno"> 2475</span>         <span class="keyword">static</span> <span class="keyword">auto</span> generate_blacklisted_actors = [](<span class="keyword">const</span> flat_set&lt;account_name&gt;&amp; actors, <span class="keyword">const</span> flat_set&lt;account_name&gt;&amp; <a class="code hl_variable" href="spec__test__generator_8cpp.html#a38761dc1394ef77d1a39dd282d9e64f5">blacklist</a>) -&gt; <a class="code hl_class" href="classfc_1_1vector.html">vector&lt;account_name&gt;</a> {</div>
<div class="line"><a id="l02476" name="l02476"></a><span class="lineno"> 2476</span>            <a class="code hl_class" href="classfc_1_1vector.html">vector&lt;account_name&gt;</a> blacklisted;</div>
<div class="line"><a id="l02477" name="l02477"></a><span class="lineno"> 2477</span>            blacklisted.reserve( actors.size() );</div>
<div class="line"><a id="l02478" name="l02478"></a><span class="lineno"> 2478</span>            set_intersection( actors.begin(), actors.end(),</div>
<div class="line"><a id="l02479" name="l02479"></a><span class="lineno"> 2479</span>                              blacklist.begin(), blacklist.end(),</div>
<div class="line"><a id="l02480" name="l02480"></a><span class="lineno"> 2480</span>                              std::back_inserter(blacklisted)</div>
<div class="line"><a id="l02481" name="l02481"></a><span class="lineno"> 2481</span>                            );</div>
<div class="line"><a id="l02482" name="l02482"></a><span class="lineno"> 2482</span>            <span class="keywordflow">return</span> blacklisted;</div>
<div class="line"><a id="l02483" name="l02483"></a><span class="lineno"> 2483</span>         };</div>
<div class="line"><a id="l02484" name="l02484"></a><span class="lineno"> 2484</span> </div>
<div class="line"><a id="l02485" name="l02485"></a><span class="lineno"> 2485</span>         <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( !intersects, actor_blacklist_exception,</div>
<div class="line"><a id="l02486" name="l02486"></a><span class="lineno"> 2486</span>                     <span class="stringliteral">&quot;authorizing actor(s) in transaction are on the actor blacklist: ${actors}&quot;</span>,</div>
<div class="line"><a id="l02487" name="l02487"></a><span class="lineno"> 2487</span>                     (<span class="stringliteral">&quot;actors&quot;</span>, generate_blacklisted_actors(actors, blacklist))</div>
<div class="line"><a id="l02488" name="l02488"></a><span class="lineno"> 2488</span>                   );</div>
<div class="line"><a id="l02489" name="l02489"></a><span class="lineno"> 2489</span>      }</div>
<div class="line"><a id="l02490" name="l02490"></a><span class="lineno"> 2490</span>   }</div>
</div>
<div class="line"><a id="l02491" name="l02491"></a><span class="lineno"> 2491</span> </div>
<div class="foldopen" id="foldopen02492" data-start="{" data-end="}">
<div class="line"><a id="l02492" name="l02492"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#a16289260be252f6ebbd80763f657fb38"> 2492</a></span>   <span class="keywordtype">void</span> <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a16289260be252f6ebbd80763f657fb38">check_contract_list</a>( <a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">account_name</a> code )<span class="keyword">const </span>{</div>
<div class="line"><a id="l02493" name="l02493"></a><span class="lineno"> 2493</span>      <span class="keywordflow">if</span>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a048ac8e4d4436902a1888df13575b252">conf</a>.<a class="code hl_variable" href="structsysio_1_1chain_1_1controller_1_1config.html#a0c34416a36f48ede90d9701b986d3487">contract_whitelist</a>.size() &gt; 0 ) {</div>
<div class="line"><a id="l02494" name="l02494"></a><span class="lineno"> 2494</span>         <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a048ac8e4d4436902a1888df13575b252">conf</a>.<a class="code hl_variable" href="structsysio_1_1chain_1_1controller_1_1config.html#a0c34416a36f48ede90d9701b986d3487">contract_whitelist</a>.find( code ) != <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a048ac8e4d4436902a1888df13575b252">conf</a>.<a class="code hl_variable" href="structsysio_1_1chain_1_1controller_1_1config.html#a0c34416a36f48ede90d9701b986d3487">contract_whitelist</a>.end(),</div>
<div class="line"><a id="l02495" name="l02495"></a><span class="lineno"> 2495</span>                     contract_whitelist_exception,</div>
<div class="line"><a id="l02496" name="l02496"></a><span class="lineno"> 2496</span>                     <span class="stringliteral">&quot;account &#39;${code}&#39; is not on the contract whitelist&quot;</span>, (<span class="stringliteral">&quot;code&quot;</span>, code)</div>
<div class="line"><a id="l02497" name="l02497"></a><span class="lineno"> 2497</span>                   );</div>
<div class="line"><a id="l02498" name="l02498"></a><span class="lineno"> 2498</span>      } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a048ac8e4d4436902a1888df13575b252">conf</a>.<a class="code hl_variable" href="structsysio_1_1chain_1_1controller_1_1config.html#a71961d4eb70d927b9d0003f6255db95f">contract_blacklist</a>.size() &gt; 0 ) {</div>
<div class="line"><a id="l02499" name="l02499"></a><span class="lineno"> 2499</span>         <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a048ac8e4d4436902a1888df13575b252">conf</a>.<a class="code hl_variable" href="structsysio_1_1chain_1_1controller_1_1config.html#a71961d4eb70d927b9d0003f6255db95f">contract_blacklist</a>.find( code ) == <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a048ac8e4d4436902a1888df13575b252">conf</a>.<a class="code hl_variable" href="structsysio_1_1chain_1_1controller_1_1config.html#a71961d4eb70d927b9d0003f6255db95f">contract_blacklist</a>.end(),</div>
<div class="line"><a id="l02500" name="l02500"></a><span class="lineno"> 2500</span>                     contract_blacklist_exception,</div>
<div class="line"><a id="l02501" name="l02501"></a><span class="lineno"> 2501</span>                     <span class="stringliteral">&quot;account &#39;${code}&#39; is on the contract blacklist&quot;</span>, (<span class="stringliteral">&quot;code&quot;</span>, code)</div>
<div class="line"><a id="l02502" name="l02502"></a><span class="lineno"> 2502</span>                   );</div>
<div class="line"><a id="l02503" name="l02503"></a><span class="lineno"> 2503</span>      }</div>
<div class="line"><a id="l02504" name="l02504"></a><span class="lineno"> 2504</span>   }</div>
</div>
<div class="line"><a id="l02505" name="l02505"></a><span class="lineno"> 2505</span> </div>
<div class="foldopen" id="foldopen02506" data-start="{" data-end="}">
<div class="line"><a id="l02506" name="l02506"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#aff9373c6d02a511984f20486e90585f5"> 2506</a></span>   <span class="keywordtype">void</span> <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#aff9373c6d02a511984f20486e90585f5">check_action_list</a>( <a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">account_name</a> code, <a class="code hl_typedef" href="namespacesysio_1_1chain.html#a7a1685bcc352cda9e45f055932069428">action_name</a> <a class="code hl_struct" href="structsysio_1_1chain_1_1action.html">action</a> )<span class="keyword">const </span>{</div>
<div class="line"><a id="l02507" name="l02507"></a><span class="lineno"> 2507</span>      <span class="keywordflow">if</span>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a048ac8e4d4436902a1888df13575b252">conf</a>.<a class="code hl_variable" href="structsysio_1_1chain_1_1controller_1_1config.html#a979219adeffbc78b1fe73460a8005e39">action_blacklist</a>.size() &gt; 0 ) {</div>
<div class="line"><a id="l02508" name="l02508"></a><span class="lineno"> 2508</span>         <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a048ac8e4d4436902a1888df13575b252">conf</a>.<a class="code hl_variable" href="structsysio_1_1chain_1_1controller_1_1config.html#a979219adeffbc78b1fe73460a8005e39">action_blacklist</a>.find( std::make_pair(code, <a class="code hl_struct" href="structsysio_1_1chain_1_1action.html">action</a>) ) == <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a048ac8e4d4436902a1888df13575b252">conf</a>.<a class="code hl_variable" href="structsysio_1_1chain_1_1controller_1_1config.html#a979219adeffbc78b1fe73460a8005e39">action_blacklist</a>.end(),</div>
<div class="line"><a id="l02509" name="l02509"></a><span class="lineno"> 2509</span>                     action_blacklist_exception,</div>
<div class="line"><a id="l02510" name="l02510"></a><span class="lineno"> 2510</span>                     <span class="stringliteral">&quot;action &#39;${code}::${action}&#39; is on the action blacklist&quot;</span>,</div>
<div class="line"><a id="l02511" name="l02511"></a><span class="lineno"> 2511</span>                     (<span class="stringliteral">&quot;code&quot;</span>, code)(<span class="stringliteral">&quot;action&quot;</span>, <a class="code hl_struct" href="structsysio_1_1chain_1_1action.html">action</a>)</div>
<div class="line"><a id="l02512" name="l02512"></a><span class="lineno"> 2512</span>                   );</div>
<div class="line"><a id="l02513" name="l02513"></a><span class="lineno"> 2513</span>      }</div>
<div class="line"><a id="l02514" name="l02514"></a><span class="lineno"> 2514</span>   }</div>
</div>
<div class="line"><a id="l02515" name="l02515"></a><span class="lineno"> 2515</span> </div>
<div class="foldopen" id="foldopen02516" data-start="{" data-end="}">
<div class="line"><a id="l02516" name="l02516"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#ad83ca3895f901f87cbf1060493698f55"> 2516</a></span>   <span class="keywordtype">void</span> <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#ad83ca3895f901f87cbf1060493698f55">check_key_list</a>( <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1crypto_1_1public__key.html">public_key_type</a>&amp; key )<span class="keyword">const </span>{</div>
<div class="line"><a id="l02517" name="l02517"></a><span class="lineno"> 2517</span>      <span class="keywordflow">if</span>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a048ac8e4d4436902a1888df13575b252">conf</a>.<a class="code hl_variable" href="structsysio_1_1chain_1_1controller_1_1config.html#ae36a724cde28ee8bc40c6b73206f8a61">key_blacklist</a>.size() &gt; 0 ) {</div>
<div class="line"><a id="l02518" name="l02518"></a><span class="lineno"> 2518</span>         <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a048ac8e4d4436902a1888df13575b252">conf</a>.<a class="code hl_variable" href="structsysio_1_1chain_1_1controller_1_1config.html#ae36a724cde28ee8bc40c6b73206f8a61">key_blacklist</a>.find( key ) == <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a048ac8e4d4436902a1888df13575b252">conf</a>.<a class="code hl_variable" href="structsysio_1_1chain_1_1controller_1_1config.html#ae36a724cde28ee8bc40c6b73206f8a61">key_blacklist</a>.end(),</div>
<div class="line"><a id="l02519" name="l02519"></a><span class="lineno"> 2519</span>                     key_blacklist_exception,</div>
<div class="line"><a id="l02520" name="l02520"></a><span class="lineno"> 2520</span>                     <span class="stringliteral">&quot;public key &#39;${key}&#39; is on the key blacklist&quot;</span>,</div>
<div class="line"><a id="l02521" name="l02521"></a><span class="lineno"> 2521</span>                     (<span class="stringliteral">&quot;key&quot;</span>, key)</div>
<div class="line"><a id="l02522" name="l02522"></a><span class="lineno"> 2522</span>                   );</div>
<div class="line"><a id="l02523" name="l02523"></a><span class="lineno"> 2523</span>      }</div>
<div class="line"><a id="l02524" name="l02524"></a><span class="lineno"> 2524</span>   }</div>
</div>
<div class="line"><a id="l02525" name="l02525"></a><span class="lineno"> 2525</span> </div>
<div class="line"><a id="l02526" name="l02526"></a><span class="lineno"> 2526</span>   <span class="comment">/*</span></div>
<div class="line"><a id="l02527" name="l02527"></a><span class="lineno"> 2527</span><span class="comment">   bool should_check_tapos()const { return true; }</span></div>
<div class="line"><a id="l02528" name="l02528"></a><span class="lineno"> 2528</span><span class="comment"></span> </div>
<div class="line"><a id="l02529" name="l02529"></a><span class="lineno"> 2529</span><span class="comment">   void validate_tapos( const transaction&amp; trx )const {</span></div>
<div class="line"><a id="l02530" name="l02530"></a><span class="lineno"> 2530</span><span class="comment">      if( !should_check_tapos() ) return;</span></div>
<div class="line"><a id="l02531" name="l02531"></a><span class="lineno"> 2531</span><span class="comment"></span> </div>
<div class="line"><a id="l02532" name="l02532"></a><span class="lineno"> 2532</span><span class="comment">      const auto&amp; tapos_block_summary = db.get&lt;block_summary_object&gt;((uint16_t)trx.ref_block_num);</span></div>
<div class="line"><a id="l02533" name="l02533"></a><span class="lineno"> 2533</span><span class="comment"></span> </div>
<div class="line"><a id="l02534" name="l02534"></a><span class="lineno"> 2534</span><span class="comment">      //Verify TaPoS block summary has correct ID prefix, and that this block&#39;s time is not past the expiration</span></div>
<div class="line"><a id="l02535" name="l02535"></a><span class="lineno"> 2535</span><span class="comment">      SYS_ASSERT(trx.verify_reference_block(tapos_block_summary.block_id), invalid_ref_block_exception,</span></div>
<div class="line"><a id="l02536" name="l02536"></a><span class="lineno"> 2536</span><span class="comment">                 &quot;Transaction&#39;s reference block did not match. Is this transaction from a different fork?&quot;,</span></div>
<div class="line"><a id="l02537" name="l02537"></a><span class="lineno"> 2537</span><span class="comment">                 (&quot;tapos_summary&quot;, tapos_block_summary));</span></div>
<div class="line"><a id="l02538" name="l02538"></a><span class="lineno"> 2538</span><span class="comment">   }</span></div>
<div class="line"><a id="l02539" name="l02539"></a><span class="lineno"> 2539</span><span class="comment">   */</span></div>
<div class="line"><a id="l02540" name="l02540"></a><span class="lineno"> 2540</span> </div>
<div class="line"><a id="l02541" name="l02541"></a><span class="lineno"> 2541</span> </div>
<div class="foldopen" id="foldopen02546" data-start="{" data-end="}">
<div class="line"><a id="l02546" name="l02546"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#a3f2b256d3a667ffeed8f7fd03e36c902"> 2546</a></span>   <a class="code hl_struct" href="structsysio_1_1chain_1_1signed__transaction.html">signed_transaction</a> <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a3f2b256d3a667ffeed8f7fd03e36c902">get_on_block_transaction</a>()</div>
<div class="line"><a id="l02547" name="l02547"></a><span class="lineno"> 2547</span>   {</div>
<div class="line"><a id="l02548" name="l02548"></a><span class="lineno"> 2548</span>      <a class="code hl_struct" href="structsysio_1_1chain_1_1action.html">action</a> on_block_act;</div>
<div class="line"><a id="l02549" name="l02549"></a><span class="lineno"> 2549</span>      on_block_act.<a class="code hl_variable" href="structsysio_1_1chain_1_1action__base.html#a3598da3f8df67037e69dab758ce168be">account</a> = config::system_account_name;</div>
<div class="line"><a id="l02550" name="l02550"></a><span class="lineno"> 2550</span>      on_block_act.<a class="code hl_variable" href="structsysio_1_1chain_1_1action__base.html#a013fae07403bd6deffcade4fd5be095c">name</a> = <span class="stringliteral">&quot;onblock&quot;</span>_n;</div>
<div class="line"><a id="l02551" name="l02551"></a><span class="lineno"> 2551</span>      on_block_act.<a class="code hl_variable" href="structsysio_1_1chain_1_1action__base.html#a40939533bca9e44d169ee7e25ebb1945">authorization</a> = <a class="code hl_class" href="classfc_1_1vector.html">vector&lt;permission_level&gt;</a>{{config::system_account_name, config::active_name}};</div>
<div class="line"><a id="l02552" name="l02552"></a><span class="lineno"> 2552</span>      on_block_act.<a class="code hl_variable" href="structsysio_1_1chain_1_1action.html#abeb8e7f99c1779b22ebcd13f534f0205">data</a> = <a class="code hl_function" href="namespacefc_1_1raw.html#a3a18d8161aa5b4f4f02b6fcfdff5e5d1">fc::raw::pack</a>(<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a64851fb4e041dc49ab22cf2ba335720d">self</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#ad39b3fade2e84d4a743230a27c650f1f">head_block_header</a>());</div>
<div class="line"><a id="l02553" name="l02553"></a><span class="lineno"> 2553</span> </div>
<div class="line"><a id="l02554" name="l02554"></a><span class="lineno"> 2554</span>      <a class="code hl_struct" href="structsysio_1_1chain_1_1signed__transaction.html">signed_transaction</a> trx;</div>
<div class="line"><a id="l02555" name="l02555"></a><span class="lineno"> 2555</span>      trx.<a class="code hl_variable" href="structsysio_1_1chain_1_1transaction.html#a407fcf1868b81bb30b85f80d388bbac2">actions</a>.emplace_back(std::move(on_block_act));</div>
<div class="line"><a id="l02556" name="l02556"></a><span class="lineno"> 2556</span>      <span class="keywordflow">if</span>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a64851fb4e041dc49ab22cf2ba335720d">self</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#aa808acf858e93c567ff983ccbf8fb6d3">is_builtin_activated</a>( <a class="code hl_enumvalue" href="namespacesysio_1_1chain.html#a406d45a184cdba0af316b5bf34bf56cfa1e0a5b7203c3f4124dc8c1880b04e36b">builtin_protocol_feature_t::no_duplicate_deferred_id</a> ) ) {</div>
<div class="line"><a id="l02557" name="l02557"></a><span class="lineno"> 2557</span>         trx.<a class="code hl_variable" href="structsysio_1_1chain_1_1transaction__header.html#ad1ed2586e8ace769fdb9a54d09a752ce">expiration</a> = <a class="code hl_class" href="classfc_1_1time__point__sec.html">time_point_sec</a>();</div>
<div class="line"><a id="l02558" name="l02558"></a><span class="lineno"> 2558</span>         trx.<a class="code hl_variable" href="structsysio_1_1chain_1_1transaction__header.html#a459d803b930351f4a1565d9c082debea">ref_block_num</a> = 0;</div>
<div class="line"><a id="l02559" name="l02559"></a><span class="lineno"> 2559</span>         trx.<a class="code hl_variable" href="structsysio_1_1chain_1_1transaction__header.html#a6f02077864a99b91d043cd329433a532">ref_block_prefix</a> = 0;</div>
<div class="line"><a id="l02560" name="l02560"></a><span class="lineno"> 2560</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l02561" name="l02561"></a><span class="lineno"> 2561</span>         trx.<a class="code hl_variable" href="structsysio_1_1chain_1_1transaction__header.html#ad1ed2586e8ace769fdb9a54d09a752ce">expiration</a> = <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a64851fb4e041dc49ab22cf2ba335720d">self</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#abb1d81f96986df3bce46bd37caaf6a69">pending_block_time</a>() + <a class="code hl_class" href="classfc_1_1microseconds.html">fc::microseconds</a>(999&#39;999); <span class="comment">// Round up to nearest second to avoid appearing expired</span></div>
<div class="line"><a id="l02562" name="l02562"></a><span class="lineno"> 2562</span>         trx.<a class="code hl_function" href="structsysio_1_1chain_1_1transaction__header.html#a220798b433002112ac85e5545a99ec51">set_reference_block</a>( <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a64851fb4e041dc49ab22cf2ba335720d">self</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a37d0a44faef74cf0f96127982c1ce124">head_block_id</a>() );</div>
<div class="line"><a id="l02563" name="l02563"></a><span class="lineno"> 2563</span>      }</div>
<div class="line"><a id="l02564" name="l02564"></a><span class="lineno"> 2564</span> </div>
<div class="line"><a id="l02565" name="l02565"></a><span class="lineno"> 2565</span>      <span class="keywordflow">if</span> (<span class="keyword">auto</span> dm_logger = <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a1b67831f3be3a668c170723427236954">get_deep_mind_logger</a>()) {</div>
<div class="line"><a id="l02566" name="l02566"></a><span class="lineno"> 2566</span>         dm_logger-&gt;on_onblock(trx);</div>
<div class="line"><a id="l02567" name="l02567"></a><span class="lineno"> 2567</span>      }</div>
<div class="line"><a id="l02568" name="l02568"></a><span class="lineno"> 2568</span> </div>
<div class="line"><a id="l02569" name="l02569"></a><span class="lineno"> 2569</span>      <span class="keywordflow">return</span> trx;</div>
<div class="line"><a id="l02570" name="l02570"></a><span class="lineno"> 2570</span>   }</div>
</div>
<div class="line"><a id="l02571" name="l02571"></a><span class="lineno"> 2571</span> </div>
<div class="foldopen" id="foldopen02572" data-start="{" data-end="}">
<div class="line"><a id="l02572" name="l02572"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#a1b67831f3be3a668c170723427236954"> 2572</a></span>   <span class="keyword">inline</span> <a class="code hl_class" href="classsysio_1_1chain_1_1deep__mind__handler.html">deep_mind_handler</a>* <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a1b67831f3be3a668c170723427236954">get_deep_mind_logger</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a id="l02573" name="l02573"></a><span class="lineno"> 2573</span>      <span class="keywordflow">return</span> <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a4f73eb03cb9df364b792166a70f78320">deep_mind_logger</a>;</div>
<div class="line"><a id="l02574" name="l02574"></a><span class="lineno"> 2574</span>   }</div>
</div>
<div class="line"><a id="l02575" name="l02575"></a><span class="lineno"> 2575</span> </div>
<div class="foldopen" id="foldopen02576" data-start="{" data-end="}">
<div class="line"><a id="l02576" name="l02576"></a><span class="lineno"><a class="line" href="structsysio_1_1chain_1_1controller__impl.html#a8618218d7168450c383cde9860d57706"> 2576</a></span>   <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a8618218d7168450c383cde9860d57706">earliest_available_block_num</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a id="l02577" name="l02577"></a><span class="lineno"> 2577</span>      <span class="keywordflow">return</span> (<a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a958ab2b868a2a7ec9644199a80e0ad9e">blog</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1block__log.html#ac5f1c1e78e72414fbf9bae75da42303e">first_block_num</a>() != 0) ? <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#a958ab2b868a2a7ec9644199a80e0ad9e">blog</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1block__log.html#ac5f1c1e78e72414fbf9bae75da42303e">first_block_num</a>() : <a class="code hl_variable" href="structsysio_1_1chain_1_1controller__impl.html#af7f72e6389799b7921aa98f30534f0d9">fork_db</a>.<a class="code hl_function" href="classsysio_1_1chain_1_1fork__database.html#a31db3526cc966f5db1046cebcfc45219">root</a>()-&gt;block_num;</div>
<div class="line"><a id="l02578" name="l02578"></a><span class="lineno"> 2578</span>   }</div>
</div>
<div class="line"><a id="l02579" name="l02579"></a><span class="lineno"> 2579</span> </div>
<div class="line"><a id="l02580" name="l02580"></a><span class="lineno"> 2580</span>}; </div>
</div>
<div class="line"><a id="l02581" name="l02581"></a><span class="lineno"> 2581</span> </div>
<div class="foldopen" id="foldopen02582" data-start="{" data-end="}">
<div class="line"><a id="l02582" name="l02582"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#af096f331aa6ac6b3fe3aa71b3768daa8"> 2582</a></span><span class="keyword">const</span> <a class="code hl_class" href="classsysio_1_1chain_1_1resource__limits_1_1resource__limits__manager.html">resource_limits_manager</a>&amp;   <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#af096f331aa6ac6b3fe3aa71b3768daa8">controller::get_resource_limits_manager</a>()<span class="keyword">const</span></div>
<div class="line"><a id="l02583" name="l02583"></a><span class="lineno"> 2583</span><span class="keyword"></span>{</div>
<div class="line"><a id="l02584" name="l02584"></a><span class="lineno"> 2584</span>   <span class="keywordflow">return</span> my-&gt;resource_limits;</div>
<div class="line"><a id="l02585" name="l02585"></a><span class="lineno"> 2585</span>}</div>
</div>
<div class="foldopen" id="foldopen02586" data-start="{" data-end="}">
<div class="line"><a id="l02586" name="l02586"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#add2453cf4d0208ca9f277337c9a5ed7a"> 2586</a></span><a class="code hl_class" href="classsysio_1_1chain_1_1resource__limits_1_1resource__limits__manager.html">resource_limits_manager</a>&amp;         <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#add2453cf4d0208ca9f277337c9a5ed7a">controller::get_mutable_resource_limits_manager</a>()</div>
<div class="line"><a id="l02587" name="l02587"></a><span class="lineno"> 2587</span>{</div>
<div class="line"><a id="l02588" name="l02588"></a><span class="lineno"> 2588</span>   <span class="keywordflow">return</span> my-&gt;resource_limits;</div>
<div class="line"><a id="l02589" name="l02589"></a><span class="lineno"> 2589</span>}</div>
</div>
<div class="line"><a id="l02590" name="l02590"></a><span class="lineno"> 2590</span> </div>
<div class="foldopen" id="foldopen02591" data-start="{" data-end="}">
<div class="line"><a id="l02591" name="l02591"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a8f7456b81f2657ccf6c39b35afb16af4"> 2591</a></span><span class="keyword">const</span> <a class="code hl_class" href="classsysio_1_1chain_1_1authorization__manager.html">authorization_manager</a>&amp;   <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a8f7456b81f2657ccf6c39b35afb16af4">controller::get_authorization_manager</a>()<span class="keyword">const</span></div>
<div class="line"><a id="l02592" name="l02592"></a><span class="lineno"> 2592</span><span class="keyword"></span>{</div>
<div class="line"><a id="l02593" name="l02593"></a><span class="lineno"> 2593</span>   <span class="keywordflow">return</span> my-&gt;authorization;</div>
<div class="line"><a id="l02594" name="l02594"></a><span class="lineno"> 2594</span>}</div>
</div>
<div class="foldopen" id="foldopen02595" data-start="{" data-end="}">
<div class="line"><a id="l02595" name="l02595"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a4c7e83b4e4c21205b0fb9b2e4b7fb227"> 2595</a></span><a class="code hl_class" href="classsysio_1_1chain_1_1authorization__manager.html">authorization_manager</a>&amp;         <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a4c7e83b4e4c21205b0fb9b2e4b7fb227">controller::get_mutable_authorization_manager</a>()</div>
<div class="line"><a id="l02596" name="l02596"></a><span class="lineno"> 2596</span>{</div>
<div class="line"><a id="l02597" name="l02597"></a><span class="lineno"> 2597</span>   <span class="keywordflow">return</span> my-&gt;authorization;</div>
<div class="line"><a id="l02598" name="l02598"></a><span class="lineno"> 2598</span>}</div>
</div>
<div class="line"><a id="l02599" name="l02599"></a><span class="lineno"> 2599</span> </div>
<div class="foldopen" id="foldopen02600" data-start="{" data-end="}">
<div class="line"><a id="l02600" name="l02600"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a67876c4bcb4b26fa679d347472ff14ee"> 2600</a></span><span class="keyword">const</span> <a class="code hl_class" href="classsysio_1_1chain_1_1protocol__feature__manager.html">protocol_feature_manager</a>&amp; <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a67876c4bcb4b26fa679d347472ff14ee">controller::get_protocol_feature_manager</a>()<span class="keyword">const</span></div>
<div class="line"><a id="l02601" name="l02601"></a><span class="lineno"> 2601</span><span class="keyword"></span>{</div>
<div class="line"><a id="l02602" name="l02602"></a><span class="lineno"> 2602</span>   <span class="keywordflow">return</span> my-&gt;protocol_features;</div>
<div class="line"><a id="l02603" name="l02603"></a><span class="lineno"> 2603</span>}</div>
</div>
<div class="line"><a id="l02604" name="l02604"></a><span class="lineno"> 2604</span> </div>
<div class="foldopen" id="foldopen02605" data-start="{" data-end="}">
<div class="line"><a id="l02605" name="l02605"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a5e15777ff13440123a46783623744202"> 2605</a></span><a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a5e15777ff13440123a46783623744202">controller::get_max_nonprivileged_inline_action_size</a>()<span class="keyword">const</span></div>
<div class="line"><a id="l02606" name="l02606"></a><span class="lineno"> 2606</span><span class="keyword"></span>{</div>
<div class="line"><a id="l02607" name="l02607"></a><span class="lineno"> 2607</span>   <span class="keywordflow">return</span> my-&gt;conf.max_nonprivileged_inline_action_size;</div>
<div class="line"><a id="l02608" name="l02608"></a><span class="lineno"> 2608</span>}</div>
</div>
<div class="line"><a id="l02609" name="l02609"></a><span class="lineno"> 2609</span> </div>
<div class="foldopen" id="foldopen02610" data-start="{" data-end="}">
<div class="line"><a id="l02610" name="l02610"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#afe391de926abcc0efbd938ac88bad300"> 2610</a></span><a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#afe391de926abcc0efbd938ac88bad300">controller::controller</a>( <span class="keyword">const</span> <a class="code hl_struct" href="structsysio_1_1chain_1_1controller_1_1config.html">controller::config</a>&amp; cfg, <span class="keyword">const</span> <a class="code hl_struct" href="structsysio_1_1chain_1_1chain__id__type.html">chain_id_type</a>&amp; chain_id )</div>
<div class="line"><a id="l02611" name="l02611"></a><span class="lineno"> 2611</span>:my( new <a class="code hl_struct" href="structsysio_1_1chain_1_1controller__impl.html">controller_impl</a>( cfg, *this, <a class="code hl_class" href="classsysio_1_1chain_1_1protocol__feature__set.html">protocol_feature_set</a>{}, chain_id ) )</div>
<div class="line"><a id="l02612" name="l02612"></a><span class="lineno"> 2612</span>{</div>
<div class="line"><a id="l02613" name="l02613"></a><span class="lineno"> 2613</span>}</div>
</div>
<div class="line"><a id="l02614" name="l02614"></a><span class="lineno"> 2614</span> </div>
<div class="foldopen" id="foldopen02615" data-start="{" data-end="}">
<div class="line"><a id="l02615" name="l02615"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#ac40db9ac3ab5a2c21da04976dee838f9"> 2615</a></span><a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#afe391de926abcc0efbd938ac88bad300">controller::controller</a>( <span class="keyword">const</span> <a class="code hl_struct" href="structsysio_1_1chain_1_1controller_1_1config.html">config</a>&amp; cfg, <a class="code hl_class" href="classsysio_1_1chain_1_1protocol__feature__set.html">protocol_feature_set</a>&amp;&amp; pfs, <span class="keyword">const</span> <a class="code hl_struct" href="structsysio_1_1chain_1_1chain__id__type.html">chain_id_type</a>&amp; chain_id )</div>
<div class="line"><a id="l02616" name="l02616"></a><span class="lineno"> 2616</span>:my( new <a class="code hl_struct" href="structsysio_1_1chain_1_1controller__impl.html">controller_impl</a>( cfg, *this, <a class="code hl_namespace" href="namespacestd.html">std</a>::move(pfs), chain_id ) )</div>
<div class="line"><a id="l02617" name="l02617"></a><span class="lineno"> 2617</span>{</div>
<div class="line"><a id="l02618" name="l02618"></a><span class="lineno"> 2618</span>}</div>
</div>
<div class="line"><a id="l02619" name="l02619"></a><span class="lineno"> 2619</span> </div>
<div class="foldopen" id="foldopen02620" data-start="{" data-end="}">
<div class="line"><a id="l02620" name="l02620"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a67be65a69cad78d9f44be1b2822d6367"> 2620</a></span><a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a67be65a69cad78d9f44be1b2822d6367">controller::~controller</a>() {</div>
<div class="line"><a id="l02621" name="l02621"></a><span class="lineno"> 2621</span>   my-&gt;abort_block();</div>
<div class="line"><a id="l02622" name="l02622"></a><span class="lineno"> 2622</span>   <span class="comment">/* Shouldn&#39;t be needed anymore.</span></div>
<div class="line"><a id="l02623" name="l02623"></a><span class="lineno"> 2623</span><span class="comment">   //close fork_db here, because it can generate &quot;irreversible&quot; signal to this controller,</span></div>
<div class="line"><a id="l02624" name="l02624"></a><span class="lineno"> 2624</span><span class="comment">   //in case if read-mode == IRREVERSIBLE, we will apply latest irreversible block</span></div>
<div class="line"><a id="l02625" name="l02625"></a><span class="lineno"> 2625</span><span class="comment">   //for that we need &#39;my&#39; to be valid pointer pointing to valid controller_impl.</span></div>
<div class="line"><a id="l02626" name="l02626"></a><span class="lineno"> 2626</span><span class="comment">   my-&gt;fork_db.close();</span></div>
<div class="line"><a id="l02627" name="l02627"></a><span class="lineno"> 2627</span><span class="comment">   */</span></div>
<div class="line"><a id="l02628" name="l02628"></a><span class="lineno"> 2628</span>}</div>
</div>
<div class="line"><a id="l02629" name="l02629"></a><span class="lineno"> 2629</span> </div>
<div class="foldopen" id="foldopen02630" data-start="{" data-end="}">
<div class="line"><a id="l02630" name="l02630"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#af22cf279943012cd05e62ba48d5e747a"> 2630</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#af22cf279943012cd05e62ba48d5e747a">controller::add_indices</a>() {</div>
<div class="line"><a id="l02631" name="l02631"></a><span class="lineno"> 2631</span>   my-&gt;add_indices();</div>
<div class="line"><a id="l02632" name="l02632"></a><span class="lineno"> 2632</span>}</div>
</div>
<div class="line"><a id="l02633" name="l02633"></a><span class="lineno"> 2633</span> </div>
<div class="foldopen" id="foldopen02634" data-start="{" data-end="}">
<div class="line"><a id="l02634" name="l02634"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#afa7e11a1dbbe3ae89d6220304a3e4bd3"> 2634</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#afa7e11a1dbbe3ae89d6220304a3e4bd3">controller::startup</a>( std::function&lt;<span class="keywordtype">void</span>()&gt; shutdown, std::function&lt;<span class="keywordtype">bool</span>()&gt; check_shutdown, <span class="keyword">const</span> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#aaa27dacddc54cea475602788c8e7a02c">snapshot_reader_ptr</a>&amp; snapshot ) {</div>
<div class="line"><a id="l02635" name="l02635"></a><span class="lineno"> 2635</span>   my-&gt;startup(shutdown, check_shutdown, snapshot);</div>
<div class="line"><a id="l02636" name="l02636"></a><span class="lineno"> 2636</span>}</div>
</div>
<div class="line"><a id="l02637" name="l02637"></a><span class="lineno"> 2637</span> </div>
<div class="foldopen" id="foldopen02638" data-start="{" data-end="}">
<div class="line"><a id="l02638" name="l02638"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a07763d4f62277a9dfbc882906179e95b"> 2638</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#afa7e11a1dbbe3ae89d6220304a3e4bd3">controller::startup</a>( std::function&lt;<span class="keywordtype">void</span>()&gt; shutdown, std::function&lt;<span class="keywordtype">bool</span>()&gt; check_shutdown, <span class="keyword">const</span> <a class="code hl_struct" href="structsysio_1_1chain_1_1genesis__state.html">genesis_state</a>&amp; genesis ) {</div>
<div class="line"><a id="l02639" name="l02639"></a><span class="lineno"> 2639</span>   my-&gt;startup(shutdown, check_shutdown, genesis);</div>
<div class="line"><a id="l02640" name="l02640"></a><span class="lineno"> 2640</span>}</div>
</div>
<div class="line"><a id="l02641" name="l02641"></a><span class="lineno"> 2641</span> </div>
<div class="foldopen" id="foldopen02642" data-start="{" data-end="}">
<div class="line"><a id="l02642" name="l02642"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a7527d6d9fe83b8862ff0bf7fabbd4701"> 2642</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#afa7e11a1dbbe3ae89d6220304a3e4bd3">controller::startup</a>(std::function&lt;<span class="keywordtype">void</span>()&gt; shutdown, std::function&lt;<span class="keywordtype">bool</span>()&gt; check_shutdown) {</div>
<div class="line"><a id="l02643" name="l02643"></a><span class="lineno"> 2643</span>   my-&gt;startup(shutdown, check_shutdown);</div>
<div class="line"><a id="l02644" name="l02644"></a><span class="lineno"> 2644</span>}</div>
</div>
<div class="line"><a id="l02645" name="l02645"></a><span class="lineno"> 2645</span> </div>
<div class="line"><a id="l02646" name="l02646"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a0c79d00dae8c0d90efc18f4d091b2391"> 2646</a></span><span class="keyword">const</span> <a class="code hl_class" href="classchainbase_1_1database.html">chainbase::database</a>&amp; <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a0c79d00dae8c0d90efc18f4d091b2391">controller::db</a>()<span class="keyword">const </span>{ <span class="keywordflow">return</span> my-&gt;db; }</div>
<div class="line"><a id="l02647" name="l02647"></a><span class="lineno"> 2647</span> </div>
<div class="line"><a id="l02648" name="l02648"></a><span class="lineno"> 2648</span><a class="code hl_class" href="classchainbase_1_1database.html">chainbase::database</a>&amp; controller::mutable_db()<span class="keyword">const </span>{ <span class="keywordflow">return</span> my-&gt;db; }</div>
<div class="line"><a id="l02649" name="l02649"></a><span class="lineno"> 2649</span> </div>
<div class="line"><a id="l02650" name="l02650"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#ade2fbb6f840258b36eb12724ecb06314"> 2650</a></span><span class="keyword">const</span> <a class="code hl_class" href="classsysio_1_1chain_1_1fork__database.html">fork_database</a>&amp; <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#ade2fbb6f840258b36eb12724ecb06314">controller::fork_db</a>()<span class="keyword">const </span>{ <span class="keywordflow">return</span> my-&gt;fork_db; }</div>
<div class="line"><a id="l02651" name="l02651"></a><span class="lineno"> 2651</span> </div>
<div class="foldopen" id="foldopen02652" data-start="{" data-end="}">
<div class="line"><a id="l02652" name="l02652"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a393457dadb84d77ad0a8a8561f05bcc2"> 2652</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a393457dadb84d77ad0a8a8561f05bcc2">controller::preactivate_feature</a>( <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1sha256.html">digest_type</a>&amp; feature_digest ) {</div>
<div class="line"><a id="l02653" name="l02653"></a><span class="lineno"> 2653</span>   <span class="keyword">const</span> <span class="keyword">auto</span>&amp; pfs = my-&gt;protocol_features.get_protocol_feature_set();</div>
<div class="line"><a id="l02654" name="l02654"></a><span class="lineno"> 2654</span>   <span class="keyword">auto</span> cur_time = <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#abb1d81f96986df3bce46bd37caaf6a69">pending_block_time</a>();</div>
<div class="line"><a id="l02655" name="l02655"></a><span class="lineno"> 2655</span> </div>
<div class="line"><a id="l02656" name="l02656"></a><span class="lineno"> 2656</span>   <span class="keyword">auto</span> status = pfs.is_recognized( feature_digest, cur_time );</div>
<div class="line"><a id="l02657" name="l02657"></a><span class="lineno"> 2657</span>   <span class="keywordflow">switch</span>( status ) {</div>
<div class="line"><a id="l02658" name="l02658"></a><span class="lineno"> 2658</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classsysio_1_1chain_1_1protocol__feature__set.html#a1d6d013242864bc12ae2a1f6fcc95427a96d8e9e3b92248258403f7fc4cb25644">protocol_feature_set::recognized_t::unrecognized</a>:</div>
<div class="line"><a id="l02659" name="l02659"></a><span class="lineno"> 2659</span>         <span class="keywordflow">if</span>( <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a0fcc85a590581560765686050fe105a8">is_producing_block</a>() ) {</div>
<div class="line"><a id="l02660" name="l02660"></a><span class="lineno"> 2660</span>            <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a1bfa656552ea0534b2c91ee0fe33f850">SYS_THROW</a>( subjective_block_production_exception,</div>
<div class="line"><a id="l02661" name="l02661"></a><span class="lineno"> 2661</span>                       <span class="stringliteral">&quot;protocol feature with digest &#39;${digest}&#39; is unrecognized&quot;</span>, (<span class="stringliteral">&quot;digest&quot;</span>, feature_digest) );</div>
<div class="line"><a id="l02662" name="l02662"></a><span class="lineno"> 2662</span>         } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l02663" name="l02663"></a><span class="lineno"> 2663</span>            <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a1bfa656552ea0534b2c91ee0fe33f850">SYS_THROW</a>( protocol_feature_bad_block_exception,</div>
<div class="line"><a id="l02664" name="l02664"></a><span class="lineno"> 2664</span>                       <span class="stringliteral">&quot;protocol feature with digest &#39;${digest}&#39; is unrecognized&quot;</span>, (<span class="stringliteral">&quot;digest&quot;</span>, feature_digest) );</div>
<div class="line"><a id="l02665" name="l02665"></a><span class="lineno"> 2665</span>         }</div>
<div class="line"><a id="l02666" name="l02666"></a><span class="lineno"> 2666</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l02667" name="l02667"></a><span class="lineno"> 2667</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classsysio_1_1chain_1_1protocol__feature__set.html#a1d6d013242864bc12ae2a1f6fcc95427a075ae3d2fc31640504f814f60e5ef713">protocol_feature_set::recognized_t::disabled</a>:</div>
<div class="line"><a id="l02668" name="l02668"></a><span class="lineno"> 2668</span>         <span class="keywordflow">if</span>( <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a0fcc85a590581560765686050fe105a8">is_producing_block</a>() ) {</div>
<div class="line"><a id="l02669" name="l02669"></a><span class="lineno"> 2669</span>            <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a1bfa656552ea0534b2c91ee0fe33f850">SYS_THROW</a>( subjective_block_production_exception,</div>
<div class="line"><a id="l02670" name="l02670"></a><span class="lineno"> 2670</span>                       <span class="stringliteral">&quot;protocol feature with digest &#39;${digest}&#39; is disabled&quot;</span>, (<span class="stringliteral">&quot;digest&quot;</span>, feature_digest) );</div>
<div class="line"><a id="l02671" name="l02671"></a><span class="lineno"> 2671</span>         } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l02672" name="l02672"></a><span class="lineno"> 2672</span>            <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a1bfa656552ea0534b2c91ee0fe33f850">SYS_THROW</a>( protocol_feature_bad_block_exception,</div>
<div class="line"><a id="l02673" name="l02673"></a><span class="lineno"> 2673</span>                       <span class="stringliteral">&quot;protocol feature with digest &#39;${digest}&#39; is disabled&quot;</span>, (<span class="stringliteral">&quot;digest&quot;</span>, feature_digest) );</div>
<div class="line"><a id="l02674" name="l02674"></a><span class="lineno"> 2674</span>         }</div>
<div class="line"><a id="l02675" name="l02675"></a><span class="lineno"> 2675</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l02676" name="l02676"></a><span class="lineno"> 2676</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classsysio_1_1chain_1_1protocol__feature__set.html#a1d6d013242864bc12ae2a1f6fcc95427a5d203566b82250f4113257b6db12e488">protocol_feature_set::recognized_t::too_early</a>:</div>
<div class="line"><a id="l02677" name="l02677"></a><span class="lineno"> 2677</span>         <span class="keywordflow">if</span>( <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a0fcc85a590581560765686050fe105a8">is_producing_block</a>() ) {</div>
<div class="line"><a id="l02678" name="l02678"></a><span class="lineno"> 2678</span>            <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a1bfa656552ea0534b2c91ee0fe33f850">SYS_THROW</a>( subjective_block_production_exception,</div>
<div class="line"><a id="l02679" name="l02679"></a><span class="lineno"> 2679</span>                       <span class="stringliteral">&quot;${timestamp} is too early for the earliest allowed activation time of the protocol feature with digest &#39;${digest}&#39;&quot;</span>, (<span class="stringliteral">&quot;digest&quot;</span>, feature_digest)(<span class="stringliteral">&quot;timestamp&quot;</span>, cur_time) );</div>
<div class="line"><a id="l02680" name="l02680"></a><span class="lineno"> 2680</span>         } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l02681" name="l02681"></a><span class="lineno"> 2681</span>            <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a1bfa656552ea0534b2c91ee0fe33f850">SYS_THROW</a>( protocol_feature_bad_block_exception,</div>
<div class="line"><a id="l02682" name="l02682"></a><span class="lineno"> 2682</span>                       <span class="stringliteral">&quot;${timestamp} is too early for the earliest allowed activation time of the protocol feature with digest &#39;${digest}&#39;&quot;</span>, (<span class="stringliteral">&quot;digest&quot;</span>, feature_digest)(<span class="stringliteral">&quot;timestamp&quot;</span>, cur_time) );</div>
<div class="line"><a id="l02683" name="l02683"></a><span class="lineno"> 2683</span>         }</div>
<div class="line"><a id="l02684" name="l02684"></a><span class="lineno"> 2684</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l02685" name="l02685"></a><span class="lineno"> 2685</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classsysio_1_1chain_1_1protocol__feature__set.html#a1d6d013242864bc12ae2a1f6fcc95427ab2fdab230a2c39f3595a947861863cb7">protocol_feature_set::recognized_t::ready</a>:</div>
<div class="line"><a id="l02686" name="l02686"></a><span class="lineno"> 2686</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l02687" name="l02687"></a><span class="lineno"> 2687</span>      <span class="keywordflow">default</span>:</div>
<div class="line"><a id="l02688" name="l02688"></a><span class="lineno"> 2688</span>         <span class="keywordflow">if</span>( <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a0fcc85a590581560765686050fe105a8">is_producing_block</a>() ) {</div>
<div class="line"><a id="l02689" name="l02689"></a><span class="lineno"> 2689</span>            <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a1bfa656552ea0534b2c91ee0fe33f850">SYS_THROW</a>( subjective_block_production_exception, <span class="stringliteral">&quot;unexpected recognized_t status&quot;</span> );</div>
<div class="line"><a id="l02690" name="l02690"></a><span class="lineno"> 2690</span>         } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l02691" name="l02691"></a><span class="lineno"> 2691</span>            <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a1bfa656552ea0534b2c91ee0fe33f850">SYS_THROW</a>( protocol_feature_bad_block_exception, <span class="stringliteral">&quot;unexpected recognized_t status&quot;</span> );</div>
<div class="line"><a id="l02692" name="l02692"></a><span class="lineno"> 2692</span>         }</div>
<div class="line"><a id="l02693" name="l02693"></a><span class="lineno"> 2693</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l02694" name="l02694"></a><span class="lineno"> 2694</span>   }</div>
<div class="line"><a id="l02695" name="l02695"></a><span class="lineno"> 2695</span> </div>
<div class="line"><a id="l02696" name="l02696"></a><span class="lineno"> 2696</span>   <span class="comment">// The above failures depend on subjective information.</span></div>
<div class="line"><a id="l02697" name="l02697"></a><span class="lineno"> 2697</span>   <span class="comment">// Because of deferred transactions, this complicates things considerably.</span></div>
<div class="line"><a id="l02698" name="l02698"></a><span class="lineno"> 2698</span> </div>
<div class="line"><a id="l02699" name="l02699"></a><span class="lineno"> 2699</span>   <span class="comment">// If producing a block, we throw a subjective failure if the feature is not properly recognized in order</span></div>
<div class="line"><a id="l02700" name="l02700"></a><span class="lineno"> 2700</span>   <span class="comment">// to try to avoid retiring into a block a deferred transacton driven by subjective information.</span></div>
<div class="line"><a id="l02701" name="l02701"></a><span class="lineno"> 2701</span> </div>
<div class="line"><a id="l02702" name="l02702"></a><span class="lineno"> 2702</span>   <span class="comment">// But it is still possible for a producer to retire a deferred transaction that deals with this subjective</span></div>
<div class="line"><a id="l02703" name="l02703"></a><span class="lineno"> 2703</span>   <span class="comment">// information. If they recognized the feature, they would retire it successfully, but a validator that</span></div>
<div class="line"><a id="l02704" name="l02704"></a><span class="lineno"> 2704</span>   <span class="comment">// does not recognize the feature should reject the entire block (not just fail the deferred transaction).</span></div>
<div class="line"><a id="l02705" name="l02705"></a><span class="lineno"> 2705</span>   <span class="comment">// Even if they don&#39;t recognize the feature, the producer could change their nodeop code to treat it like an</span></div>
<div class="line"><a id="l02706" name="l02706"></a><span class="lineno"> 2706</span>   <span class="comment">// objective failure thus leading the deferred transaction to retire with soft_fail or hard_fail.</span></div>
<div class="line"><a id="l02707" name="l02707"></a><span class="lineno"> 2707</span>   <span class="comment">// In this case, validators that don&#39;t recognize the feature would reject the whole block immediately, and</span></div>
<div class="line"><a id="l02708" name="l02708"></a><span class="lineno"> 2708</span>   <span class="comment">// validators that do recognize the feature would likely lead to a different retire status which would</span></div>
<div class="line"><a id="l02709" name="l02709"></a><span class="lineno"> 2709</span>   <span class="comment">// ultimately cause a validation failure and thus rejection of the block.</span></div>
<div class="line"><a id="l02710" name="l02710"></a><span class="lineno"> 2710</span>   <span class="comment">// In either case, it results in rejection of the block which is the desired behavior in this scenario.</span></div>
<div class="line"><a id="l02711" name="l02711"></a><span class="lineno"> 2711</span> </div>
<div class="line"><a id="l02712" name="l02712"></a><span class="lineno"> 2712</span>   <span class="comment">// If the feature is properly recognized by producer and validator, we have dealt with the subjectivity and</span></div>
<div class="line"><a id="l02713" name="l02713"></a><span class="lineno"> 2713</span>   <span class="comment">// now only consider the remaining failure modes which are deterministic and objective.</span></div>
<div class="line"><a id="l02714" name="l02714"></a><span class="lineno"> 2714</span>   <span class="comment">// Thus the exceptions that can be thrown below can be regular objective exceptions</span></div>
<div class="line"><a id="l02715" name="l02715"></a><span class="lineno"> 2715</span>   <span class="comment">// that do not cause immediate rejection of the block.</span></div>
<div class="line"><a id="l02716" name="l02716"></a><span class="lineno"> 2716</span> </div>
<div class="line"><a id="l02717" name="l02717"></a><span class="lineno"> 2717</span>   <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( !<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a0ab467ff13b82630da7533410a8131c3">is_protocol_feature_activated</a>( feature_digest ),</div>
<div class="line"><a id="l02718" name="l02718"></a><span class="lineno"> 2718</span>               protocol_feature_exception,</div>
<div class="line"><a id="l02719" name="l02719"></a><span class="lineno"> 2719</span>               <span class="stringliteral">&quot;protocol feature with digest &#39;${digest}&#39; is already activated&quot;</span>,</div>
<div class="line"><a id="l02720" name="l02720"></a><span class="lineno"> 2720</span>               (<span class="stringliteral">&quot;digest&quot;</span>, feature_digest)</div>
<div class="line"><a id="l02721" name="l02721"></a><span class="lineno"> 2721</span>   );</div>
<div class="line"><a id="l02722" name="l02722"></a><span class="lineno"> 2722</span> </div>
<div class="line"><a id="l02723" name="l02723"></a><span class="lineno"> 2723</span>   <span class="keyword">const</span> <span class="keyword">auto</span>&amp; pso = my-&gt;db.get&lt;<a class="code hl_class" href="classsysio_1_1chain_1_1protocol__state__object.html">protocol_state_object</a>&gt;();</div>
<div class="line"><a id="l02724" name="l02724"></a><span class="lineno"> 2724</span> </div>
<div class="line"><a id="l02725" name="l02725"></a><span class="lineno"> 2725</span>   <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( std::find( pso.preactivated_protocol_features.begin(),</div>
<div class="line"><a id="l02726" name="l02726"></a><span class="lineno"> 2726</span>                          pso.preactivated_protocol_features.end(),</div>
<div class="line"><a id="l02727" name="l02727"></a><span class="lineno"> 2727</span>                          feature_digest</div>
<div class="line"><a id="l02728" name="l02728"></a><span class="lineno"> 2728</span>               ) == pso.preactivated_protocol_features.end(),</div>
<div class="line"><a id="l02729" name="l02729"></a><span class="lineno"> 2729</span>               protocol_feature_exception,</div>
<div class="line"><a id="l02730" name="l02730"></a><span class="lineno"> 2730</span>               <span class="stringliteral">&quot;protocol feature with digest &#39;${digest}&#39; is already pre-activated&quot;</span>,</div>
<div class="line"><a id="l02731" name="l02731"></a><span class="lineno"> 2731</span>               (<span class="stringliteral">&quot;digest&quot;</span>, feature_digest)</div>
<div class="line"><a id="l02732" name="l02732"></a><span class="lineno"> 2732</span>   );</div>
<div class="line"><a id="l02733" name="l02733"></a><span class="lineno"> 2733</span> </div>
<div class="line"><a id="l02734" name="l02734"></a><span class="lineno"> 2734</span>   <span class="keyword">auto</span> dependency_checker = [&amp;]( <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1sha256.html">digest_type</a>&amp; <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a107648633008a7f2d872b4b3d98c2f96">d</a> ) -&gt; <span class="keywordtype">bool</span></div>
<div class="line"><a id="l02735" name="l02735"></a><span class="lineno"> 2735</span>   {</div>
<div class="line"><a id="l02736" name="l02736"></a><span class="lineno"> 2736</span>      <span class="keywordflow">if</span>( <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a0ab467ff13b82630da7533410a8131c3">is_protocol_feature_activated</a>( <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a107648633008a7f2d872b4b3d98c2f96">d</a> ) ) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l02737" name="l02737"></a><span class="lineno"> 2737</span> </div>
<div class="line"><a id="l02738" name="l02738"></a><span class="lineno"> 2738</span>      <span class="keywordflow">return</span> ( std::find( pso.preactivated_protocol_features.begin(),</div>
<div class="line"><a id="l02739" name="l02739"></a><span class="lineno"> 2739</span>                          pso.preactivated_protocol_features.end(),</div>
<div class="line"><a id="l02740" name="l02740"></a><span class="lineno"> 2740</span>                          <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a107648633008a7f2d872b4b3d98c2f96">d</a> ) != pso.preactivated_protocol_features.end() );</div>
<div class="line"><a id="l02741" name="l02741"></a><span class="lineno"> 2741</span>   };</div>
<div class="line"><a id="l02742" name="l02742"></a><span class="lineno"> 2742</span> </div>
<div class="line"><a id="l02743" name="l02743"></a><span class="lineno"> 2743</span>   <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( pfs.validate_dependencies( feature_digest, dependency_checker ),</div>
<div class="line"><a id="l02744" name="l02744"></a><span class="lineno"> 2744</span>               protocol_feature_exception,</div>
<div class="line"><a id="l02745" name="l02745"></a><span class="lineno"> 2745</span>               <span class="stringliteral">&quot;not all dependencies of protocol feature with digest &#39;${digest}&#39; have been activated or pre-activated&quot;</span>,</div>
<div class="line"><a id="l02746" name="l02746"></a><span class="lineno"> 2746</span>               (<span class="stringliteral">&quot;digest&quot;</span>, feature_digest)</div>
<div class="line"><a id="l02747" name="l02747"></a><span class="lineno"> 2747</span>   );</div>
<div class="line"><a id="l02748" name="l02748"></a><span class="lineno"> 2748</span> </div>
<div class="line"><a id="l02749" name="l02749"></a><span class="lineno"> 2749</span>   <span class="keywordflow">if</span> (<span class="keyword">auto</span> dm_logger = <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a4f6404b355a3a4bf7fb60c92e85443d1">get_deep_mind_logger</a>()) {</div>
<div class="line"><a id="l02750" name="l02750"></a><span class="lineno"> 2750</span>      <span class="keyword">const</span> <span class="keyword">auto</span> feature = pfs.get_protocol_feature(feature_digest);</div>
<div class="line"><a id="l02751" name="l02751"></a><span class="lineno"> 2751</span> </div>
<div class="line"><a id="l02752" name="l02752"></a><span class="lineno"> 2752</span>      dm_logger-&gt;on_preactivate_feature(feature);</div>
<div class="line"><a id="l02753" name="l02753"></a><span class="lineno"> 2753</span>   }</div>
<div class="line"><a id="l02754" name="l02754"></a><span class="lineno"> 2754</span> </div>
<div class="line"><a id="l02755" name="l02755"></a><span class="lineno"> 2755</span>   my-&gt;db.modify( pso, [&amp;]( <span class="keyword">auto</span>&amp; ps ) {</div>
<div class="line"><a id="l02756" name="l02756"></a><span class="lineno"> 2756</span>      ps.preactivated_protocol_features.push_back( feature_digest );</div>
<div class="line"><a id="l02757" name="l02757"></a><span class="lineno"> 2757</span>   } );</div>
<div class="line"><a id="l02758" name="l02758"></a><span class="lineno"> 2758</span>}</div>
</div>
<div class="line"><a id="l02759" name="l02759"></a><span class="lineno"> 2759</span> </div>
<div class="foldopen" id="foldopen02760" data-start="{" data-end="}">
<div class="line"><a id="l02760" name="l02760"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#ac81c5e33faa52c5a78a67fc2032ce1aa"> 2760</a></span><a class="code hl_class" href="classfc_1_1vector.html">vector&lt;digest_type&gt;</a> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#ac81c5e33faa52c5a78a67fc2032ce1aa">controller::get_preactivated_protocol_features</a>()<span class="keyword">const </span>{</div>
<div class="line"><a id="l02761" name="l02761"></a><span class="lineno"> 2761</span>   <span class="keyword">const</span> <span class="keyword">auto</span>&amp; pso = my-&gt;db.get&lt;<a class="code hl_class" href="classsysio_1_1chain_1_1protocol__state__object.html">protocol_state_object</a>&gt;();</div>
<div class="line"><a id="l02762" name="l02762"></a><span class="lineno"> 2762</span> </div>
<div class="line"><a id="l02763" name="l02763"></a><span class="lineno"> 2763</span>   <span class="keywordflow">if</span>( pso.preactivated_protocol_features.size() == 0 ) <span class="keywordflow">return</span> {};</div>
<div class="line"><a id="l02764" name="l02764"></a><span class="lineno"> 2764</span> </div>
<div class="line"><a id="l02765" name="l02765"></a><span class="lineno"> 2765</span>   <a class="code hl_class" href="classfc_1_1vector.html">vector&lt;digest_type&gt;</a> preactivated_protocol_features;</div>
<div class="line"><a id="l02766" name="l02766"></a><span class="lineno"> 2766</span> </div>
<div class="line"><a id="l02767" name="l02767"></a><span class="lineno"> 2767</span>   <span class="keywordflow">for</span>( <span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code hl_variable" href="_x02-_disabled_macros_8cpp.html#ae28240b98d91d6eb7da702b770490f39">f</a> : pso.preactivated_protocol_features ) {</div>
<div class="line"><a id="l02768" name="l02768"></a><span class="lineno"> 2768</span>      preactivated_protocol_features.emplace_back( <a class="code hl_variable" href="_x02-_disabled_macros_8cpp.html#ae28240b98d91d6eb7da702b770490f39">f</a> );</div>
<div class="line"><a id="l02769" name="l02769"></a><span class="lineno"> 2769</span>   }</div>
<div class="line"><a id="l02770" name="l02770"></a><span class="lineno"> 2770</span> </div>
<div class="line"><a id="l02771" name="l02771"></a><span class="lineno"> 2771</span>   <span class="keywordflow">return</span> preactivated_protocol_features;</div>
<div class="line"><a id="l02772" name="l02772"></a><span class="lineno"> 2772</span>}</div>
</div>
<div class="line"><a id="l02773" name="l02773"></a><span class="lineno"> 2773</span> </div>
<div class="foldopen" id="foldopen02774" data-start="{" data-end="}">
<div class="line"><a id="l02774" name="l02774"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#abf042d0e964b46d1a401119d3575ff82"> 2774</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#abf042d0e964b46d1a401119d3575ff82">controller::validate_protocol_features</a>( <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1vector.html">vector&lt;digest_type&gt;</a>&amp; features_to_activate )<span class="keyword">const </span>{</div>
<div class="line"><a id="l02775" name="l02775"></a><span class="lineno"> 2775</span>   my-&gt;check_protocol_features( my-&gt;head-&gt;header.timestamp,</div>
<div class="line"><a id="l02776" name="l02776"></a><span class="lineno"> 2776</span>                                my-&gt;head-&gt;activated_protocol_features-&gt;protocol_features,</div>
<div class="line"><a id="l02777" name="l02777"></a><span class="lineno"> 2777</span>                                features_to_activate );</div>
<div class="line"><a id="l02778" name="l02778"></a><span class="lineno"> 2778</span>}</div>
</div>
<div class="line"><a id="l02779" name="l02779"></a><span class="lineno"> 2779</span> </div>
<div class="foldopen" id="foldopen02780" data-start="{" data-end="}">
<div class="line"><a id="l02780" name="l02780"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#afe40d1beedb5ec60de7e8d6575ba68ee"> 2780</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#afe40d1beedb5ec60de7e8d6575ba68ee">controller::start_block</a>( <a class="code hl_class" href="classsysio_1_1chain_1_1block__timestamp.html">block_timestamp_type</a> when, <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> confirm_block_count )</div>
<div class="line"><a id="l02781" name="l02781"></a><span class="lineno"> 2781</span>{</div>
<div class="line"><a id="l02782" name="l02782"></a><span class="lineno"> 2782</span>   <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a7b2f18a21e18a1bdc6837a567bb259eb">validate_db_available_size</a>();</div>
<div class="line"><a id="l02783" name="l02783"></a><span class="lineno"> 2783</span> </div>
<div class="line"><a id="l02784" name="l02784"></a><span class="lineno"> 2784</span>   <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( !my-&gt;pending, <a class="code hl_variable" href="namespacesysio_1_1chain.html#a910243f6a0327fb2d4fc80f7e89f103e">block_validate_exception</a>, <span class="stringliteral">&quot;pending block already exists&quot;</span> );</div>
<div class="line"><a id="l02785" name="l02785"></a><span class="lineno"> 2785</span> </div>
<div class="line"><a id="l02786" name="l02786"></a><span class="lineno"> 2786</span>   <a class="code hl_class" href="classfc_1_1vector.html">vector&lt;digest_type&gt;</a> new_protocol_feature_activations;</div>
<div class="line"><a id="l02787" name="l02787"></a><span class="lineno"> 2787</span> </div>
<div class="line"><a id="l02788" name="l02788"></a><span class="lineno"> 2788</span>   <span class="keyword">const</span> <span class="keyword">auto</span>&amp; pso = my-&gt;db.get&lt;<a class="code hl_class" href="classsysio_1_1chain_1_1protocol__state__object.html">protocol_state_object</a>&gt;();</div>
<div class="line"><a id="l02789" name="l02789"></a><span class="lineno"> 2789</span>   <span class="keywordflow">if</span>( pso.preactivated_protocol_features.size() &gt; 0 ) {</div>
<div class="line"><a id="l02790" name="l02790"></a><span class="lineno"> 2790</span>      <span class="keywordflow">for</span>( <span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code hl_variable" href="_x02-_disabled_macros_8cpp.html#ae28240b98d91d6eb7da702b770490f39">f</a> : pso.preactivated_protocol_features ) {</div>
<div class="line"><a id="l02791" name="l02791"></a><span class="lineno"> 2791</span>         new_protocol_feature_activations.emplace_back( <a class="code hl_variable" href="_x02-_disabled_macros_8cpp.html#ae28240b98d91d6eb7da702b770490f39">f</a> );</div>
<div class="line"><a id="l02792" name="l02792"></a><span class="lineno"> 2792</span>      }</div>
<div class="line"><a id="l02793" name="l02793"></a><span class="lineno"> 2793</span>   }</div>
<div class="line"><a id="l02794" name="l02794"></a><span class="lineno"> 2794</span> </div>
<div class="line"><a id="l02795" name="l02795"></a><span class="lineno"> 2795</span>   <span class="keywordflow">if</span>( new_protocol_feature_activations.size() &gt; 0 ) {</div>
<div class="line"><a id="l02796" name="l02796"></a><span class="lineno"> 2796</span>      <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#abf042d0e964b46d1a401119d3575ff82">validate_protocol_features</a>( new_protocol_feature_activations );</div>
<div class="line"><a id="l02797" name="l02797"></a><span class="lineno"> 2797</span>   }</div>
<div class="line"><a id="l02798" name="l02798"></a><span class="lineno"> 2798</span> </div>
<div class="line"><a id="l02799" name="l02799"></a><span class="lineno"> 2799</span>   my-&gt;start_block( when, confirm_block_count, new_protocol_feature_activations,</div>
<div class="line"><a id="l02800" name="l02800"></a><span class="lineno"> 2800</span>                    <a class="code hl_enumvalue" href="classsysio_1_1chain_1_1controller.html#a8b5124e077de1a73bb193e9c72b366b6a5ed4e9858ad8d239145ef285b6210a00">block_status::incomplete</a>, std::optional&lt;block_id_type&gt;(), <a class="code hl_function" href="classfc_1_1time__point.html#aeccf1b70aa34b132c5269313b8a50573">fc::time_point::maximum</a>() );</div>
<div class="line"><a id="l02801" name="l02801"></a><span class="lineno"> 2801</span>}</div>
</div>
<div class="line"><a id="l02802" name="l02802"></a><span class="lineno"> 2802</span> </div>
<div class="foldopen" id="foldopen02803" data-start="{" data-end="}">
<div class="line"><a id="l02803" name="l02803"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#ad1d4d35a6c82209259dd126a886477e4"> 2803</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#afe40d1beedb5ec60de7e8d6575ba68ee">controller::start_block</a>( <a class="code hl_class" href="classsysio_1_1chain_1_1block__timestamp.html">block_timestamp_type</a> when,</div>
<div class="line"><a id="l02804" name="l02804"></a><span class="lineno"> 2804</span>                              <a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> confirm_block_count,</div>
<div class="line"><a id="l02805" name="l02805"></a><span class="lineno"> 2805</span>                              <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1vector.html">vector&lt;digest_type&gt;</a>&amp; new_protocol_feature_activations,</div>
<div class="line"><a id="l02806" name="l02806"></a><span class="lineno"> 2806</span>                              <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1time__point.html">fc::time_point</a>&amp; deadline )</div>
<div class="line"><a id="l02807" name="l02807"></a><span class="lineno"> 2807</span>{</div>
<div class="line"><a id="l02808" name="l02808"></a><span class="lineno"> 2808</span>   <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a7b2f18a21e18a1bdc6837a567bb259eb">validate_db_available_size</a>();</div>
<div class="line"><a id="l02809" name="l02809"></a><span class="lineno"> 2809</span> </div>
<div class="line"><a id="l02810" name="l02810"></a><span class="lineno"> 2810</span>   <span class="keywordflow">if</span>( new_protocol_feature_activations.size() &gt; 0 ) {</div>
<div class="line"><a id="l02811" name="l02811"></a><span class="lineno"> 2811</span>      <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#abf042d0e964b46d1a401119d3575ff82">validate_protocol_features</a>( new_protocol_feature_activations );</div>
<div class="line"><a id="l02812" name="l02812"></a><span class="lineno"> 2812</span>   }</div>
<div class="line"><a id="l02813" name="l02813"></a><span class="lineno"> 2813</span> </div>
<div class="line"><a id="l02814" name="l02814"></a><span class="lineno"> 2814</span>   my-&gt;start_block( when, confirm_block_count, new_protocol_feature_activations,</div>
<div class="line"><a id="l02815" name="l02815"></a><span class="lineno"> 2815</span>                    <a class="code hl_enumvalue" href="classsysio_1_1chain_1_1controller.html#a8b5124e077de1a73bb193e9c72b366b6a5ed4e9858ad8d239145ef285b6210a00">block_status::incomplete</a>, std::optional&lt;block_id_type&gt;(), deadline );</div>
<div class="line"><a id="l02816" name="l02816"></a><span class="lineno"> 2816</span>}</div>
</div>
<div class="line"><a id="l02817" name="l02817"></a><span class="lineno"> 2817</span> </div>
<div class="foldopen" id="foldopen02818" data-start="{" data-end="}">
<div class="line"><a id="l02818" name="l02818"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a90ac1d5081d727041b7bef384771fda9"> 2818</a></span><a class="code hl_typedef" href="namespacesysio_1_1chain.html#ab9b14f4554cc4a0da2c361e9757b1662">block_state_ptr</a> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a90ac1d5081d727041b7bef384771fda9">controller::finalize_block</a>( <span class="keyword">const</span> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#a2cfc12be90aaa9b98843b120fecc71b0">signer_callback_type</a>&amp; signer_callback ) {</div>
<div class="line"><a id="l02819" name="l02819"></a><span class="lineno"> 2819</span>   <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a7b2f18a21e18a1bdc6837a567bb259eb">validate_db_available_size</a>();</div>
<div class="line"><a id="l02820" name="l02820"></a><span class="lineno"> 2820</span> </div>
<div class="line"><a id="l02821" name="l02821"></a><span class="lineno"> 2821</span>   my-&gt;finalize_block();</div>
<div class="line"><a id="l02822" name="l02822"></a><span class="lineno"> 2822</span> </div>
<div class="line"><a id="l02823" name="l02823"></a><span class="lineno"> 2823</span>   <span class="keyword">auto</span>&amp; ab = std::get&lt;assembled_block&gt;(my-&gt;pending-&gt;_block_stage);</div>
<div class="line"><a id="l02824" name="l02824"></a><span class="lineno"> 2824</span> </div>
<div class="line"><a id="l02825" name="l02825"></a><span class="lineno"> 2825</span>   <span class="keyword">auto</span> bsp = std::make_shared&lt;block_state&gt;(</div>
<div class="line"><a id="l02826" name="l02826"></a><span class="lineno"> 2826</span>                  std::move( ab._pending_block_header_state ),</div>
<div class="line"><a id="l02827" name="l02827"></a><span class="lineno"> 2827</span>                  std::move( ab._unsigned_block ),</div>
<div class="line"><a id="l02828" name="l02828"></a><span class="lineno"> 2828</span>                  std::move( ab._trx_metas ),</div>
<div class="line"><a id="l02829" name="l02829"></a><span class="lineno"> 2829</span>                  my-&gt;protocol_features.get_protocol_feature_set(),</div>
<div class="line"><a id="l02830" name="l02830"></a><span class="lineno"> 2830</span>                  []( <a class="code hl_class" href="classsysio_1_1chain_1_1block__timestamp.html">block_timestamp_type</a> timestamp,</div>
<div class="line"><a id="l02831" name="l02831"></a><span class="lineno"> 2831</span>                      <span class="keyword">const</span> flat_set&lt;digest_type&gt;&amp; cur_features,</div>
<div class="line"><a id="l02832" name="l02832"></a><span class="lineno"> 2832</span>                      <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1vector.html">vector&lt;digest_type&gt;</a>&amp; new_features )</div>
<div class="line"><a id="l02833" name="l02833"></a><span class="lineno"> 2833</span>                  {},</div>
<div class="line"><a id="l02834" name="l02834"></a><span class="lineno"> 2834</span>                  signer_callback</div>
<div class="line"><a id="l02835" name="l02835"></a><span class="lineno"> 2835</span>              );</div>
<div class="line"><a id="l02836" name="l02836"></a><span class="lineno"> 2836</span> </div>
<div class="line"><a id="l02837" name="l02837"></a><span class="lineno"> 2837</span>   my-&gt;pending-&gt;_block_stage = <a class="code hl_struct" href="structsysio_1_1chain_1_1completed__block.html">completed_block</a>{ bsp };</div>
<div class="line"><a id="l02838" name="l02838"></a><span class="lineno"> 2838</span> </div>
<div class="line"><a id="l02839" name="l02839"></a><span class="lineno"> 2839</span>   <span class="keywordflow">return</span> bsp;</div>
<div class="line"><a id="l02840" name="l02840"></a><span class="lineno"> 2840</span>}</div>
</div>
<div class="line"><a id="l02841" name="l02841"></a><span class="lineno"> 2841</span> </div>
<div class="foldopen" id="foldopen02842" data-start="{" data-end="}">
<div class="line"><a id="l02842" name="l02842"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a16975bb6b23c3e9ffaf7590006e81439"> 2842</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a16975bb6b23c3e9ffaf7590006e81439">controller::commit_block</a>() {</div>
<div class="line"><a id="l02843" name="l02843"></a><span class="lineno"> 2843</span>   <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a7b2f18a21e18a1bdc6837a567bb259eb">validate_db_available_size</a>();</div>
<div class="line"><a id="l02844" name="l02844"></a><span class="lineno"> 2844</span>   my-&gt;commit_block(<span class="keyword">true</span>);</div>
<div class="line"><a id="l02845" name="l02845"></a><span class="lineno"> 2845</span>}</div>
</div>
<div class="line"><a id="l02846" name="l02846"></a><span class="lineno"> 2846</span> </div>
<div class="foldopen" id="foldopen02847" data-start="{" data-end="}">
<div class="line"><a id="l02847" name="l02847"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a3079bf203cd6e26ed902a84ff3ec7856"> 2847</a></span><a class="code hl_class" href="classfc_1_1vector.html">vector&lt;transaction_metadata_ptr&gt;</a> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a3079bf203cd6e26ed902a84ff3ec7856">controller::abort_block</a>() {</div>
<div class="line"><a id="l02848" name="l02848"></a><span class="lineno"> 2848</span>   <span class="keywordflow">return</span> my-&gt;abort_block();</div>
<div class="line"><a id="l02849" name="l02849"></a><span class="lineno"> 2849</span>}</div>
</div>
<div class="line"><a id="l02850" name="l02850"></a><span class="lineno"> 2850</span> </div>
<div class="foldopen" id="foldopen02851" data-start="{" data-end="}">
<div class="line"><a id="l02851" name="l02851"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a64826ea9f453742f28801991e2ceba02"> 2851</a></span>boost::asio::io_context&amp; <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a64826ea9f453742f28801991e2ceba02">controller::get_thread_pool</a>() {</div>
<div class="line"><a id="l02852" name="l02852"></a><span class="lineno"> 2852</span>   <span class="keywordflow">return</span> my-&gt;thread_pool.get_executor();</div>
<div class="line"><a id="l02853" name="l02853"></a><span class="lineno"> 2853</span>}</div>
</div>
<div class="line"><a id="l02854" name="l02854"></a><span class="lineno"> 2854</span> </div>
<div class="foldopen" id="foldopen02855" data-start="{" data-end="}">
<div class="line"><a id="l02855" name="l02855"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#ad6f2e99d29c27a09b7f52101dde030db"> 2855</a></span>std::future&lt;block_state_ptr&gt; <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#ad6f2e99d29c27a09b7f52101dde030db">controller::create_block_state_future</a>( <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1sha256.html">block_id_type</a>&amp; <span class="keywordtype">id</span>, <span class="keyword">const</span> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#aa10ee348c57604b615bc8570f6685102">signed_block_ptr</a>&amp; b ) {</div>
<div class="line"><a id="l02856" name="l02856"></a><span class="lineno"> 2856</span>   <span class="keywordflow">return</span> my-&gt;create_block_state_future( <span class="keywordtype">id</span>, b );</div>
<div class="line"><a id="l02857" name="l02857"></a><span class="lineno"> 2857</span>}</div>
</div>
<div class="line"><a id="l02858" name="l02858"></a><span class="lineno"> 2858</span> </div>
<div class="foldopen" id="foldopen02859" data-start="{" data-end="}">
<div class="line"><a id="l02859" name="l02859"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a31dc2787a93d98c0c591d7432aea569a"> 2859</a></span><a class="code hl_typedef" href="namespacesysio_1_1chain.html#ab9b14f4554cc4a0da2c361e9757b1662">block_state_ptr</a> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a31dc2787a93d98c0c591d7432aea569a">controller::create_block_state</a>( <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1sha256.html">block_id_type</a>&amp; <span class="keywordtype">id</span>, <span class="keyword">const</span> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#aa10ee348c57604b615bc8570f6685102">signed_block_ptr</a>&amp; b )<span class="keyword"> const </span>{</div>
<div class="line"><a id="l02860" name="l02860"></a><span class="lineno"> 2860</span>   <span class="keywordflow">return</span> my-&gt;create_block_state( <span class="keywordtype">id</span>, b );</div>
<div class="line"><a id="l02861" name="l02861"></a><span class="lineno"> 2861</span>}</div>
</div>
<div class="line"><a id="l02862" name="l02862"></a><span class="lineno"> 2862</span> </div>
<div class="foldopen" id="foldopen02863" data-start="{" data-end="}">
<div class="line"><a id="l02863" name="l02863"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a35b9a3485ef36e6456483f4307e9ad53"> 2863</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a35b9a3485ef36e6456483f4307e9ad53">controller::push_block</a>( <span class="keyword">const</span> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#ab9b14f4554cc4a0da2c361e9757b1662">block_state_ptr</a>&amp; bsp,</div>
<div class="line"><a id="l02864" name="l02864"></a><span class="lineno"> 2864</span>                             <span class="keyword">const</span> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#ae043a3bf1321067bf1e4e7e5ab0ce3cd">forked_branch_callback</a>&amp; forked_branch_cb,</div>
<div class="line"><a id="l02865" name="l02865"></a><span class="lineno"> 2865</span>                             <span class="keyword">const</span> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#ad7e9cbb02002c4e7ab9825becb9f9f50">trx_meta_cache_lookup</a>&amp; trx_lookup )</div>
<div class="line"><a id="l02866" name="l02866"></a><span class="lineno"> 2866</span>{</div>
<div class="line"><a id="l02867" name="l02867"></a><span class="lineno"> 2867</span>   <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a7b2f18a21e18a1bdc6837a567bb259eb">validate_db_available_size</a>();</div>
<div class="line"><a id="l02868" name="l02868"></a><span class="lineno"> 2868</span>   my-&gt;push_block( bsp, forked_branch_cb, trx_lookup );</div>
<div class="line"><a id="l02869" name="l02869"></a><span class="lineno"> 2869</span>}</div>
</div>
<div class="line"><a id="l02870" name="l02870"></a><span class="lineno"> 2870</span> </div>
<div class="foldopen" id="foldopen02871" data-start="{" data-end="}">
<div class="line"><a id="l02871" name="l02871"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a31c23187243554bdb6b54bb31bdb4bcd"> 2871</a></span><a class="code hl_typedef" href="namespacesysio_1_1chain.html#a4ee2867a6bec961c7a78b203cfd76be9">transaction_trace_ptr</a> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a31c23187243554bdb6b54bb31bdb4bcd">controller::push_transaction</a>( <span class="keyword">const</span> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#ad795329e0af850251f4f47cc32e8d770">transaction_metadata_ptr</a>&amp; trx,</div>
<div class="line"><a id="l02872" name="l02872"></a><span class="lineno"> 2872</span>                                                    <a class="code hl_class" href="classfc_1_1time__point.html">fc::time_point</a> block_deadline, <a class="code hl_class" href="classfc_1_1microseconds.html">fc::microseconds</a> max_transaction_time,</div>
<div class="line"><a id="l02873" name="l02873"></a><span class="lineno"> 2873</span>                                                    <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> billed_cpu_time_us, <span class="keywordtype">bool</span> explicit_billed_cpu_time,</div>
<div class="line"><a id="l02874" name="l02874"></a><span class="lineno"> 2874</span>                                                    <a class="code hl_typedef" href="stdint_8h.html#a414156feea104f8f75b4ed9e3121b2f6">int64_t</a> subjective_cpu_bill_us ) {</div>
<div class="line"><a id="l02875" name="l02875"></a><span class="lineno"> 2875</span>   <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a7b2f18a21e18a1bdc6837a567bb259eb">validate_db_available_size</a>();</div>
<div class="line"><a id="l02876" name="l02876"></a><span class="lineno"> 2876</span>   <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a28d33629f3badcb8155c08be3e05b99e">get_read_mode</a>() != <a class="code hl_enumvalue" href="namespacesysio_1_1chain.html#af3e35f3e1b78dd00fa247009a2d9ba5ea88537e4e57a14e27d354f8ef6fc03d63">db_read_mode::IRREVERSIBLE</a>, transaction_type_exception, <span class="stringliteral">&quot;push transaction not allowed in irreversible mode&quot;</span> );</div>
<div class="line"><a id="l02877" name="l02877"></a><span class="lineno"> 2877</span>   <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( trx &amp;&amp; !trx-&gt;implicit &amp;&amp; !trx-&gt;scheduled, transaction_type_exception, <span class="stringliteral">&quot;Implicit/Scheduled transaction not allowed&quot;</span> );</div>
<div class="line"><a id="l02878" name="l02878"></a><span class="lineno"> 2878</span>   <span class="keywordflow">return</span> my-&gt;push_transaction(trx, block_deadline, max_transaction_time, billed_cpu_time_us, explicit_billed_cpu_time, subjective_cpu_bill_us );</div>
<div class="line"><a id="l02879" name="l02879"></a><span class="lineno"> 2879</span>}</div>
</div>
<div class="line"><a id="l02880" name="l02880"></a><span class="lineno"> 2880</span> </div>
<div class="foldopen" id="foldopen02881" data-start="{" data-end="}">
<div class="line"><a id="l02881" name="l02881"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#aade04f20db1bea1fbc9aa22a90cf87c0"> 2881</a></span><a class="code hl_typedef" href="namespacesysio_1_1chain.html#a4ee2867a6bec961c7a78b203cfd76be9">transaction_trace_ptr</a> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#aade04f20db1bea1fbc9aa22a90cf87c0">controller::push_scheduled_transaction</a>( <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1sha256.html">transaction_id_type</a>&amp; trxid,</div>
<div class="line"><a id="l02882" name="l02882"></a><span class="lineno"> 2882</span>                                                              <a class="code hl_class" href="classfc_1_1time__point.html">fc::time_point</a> block_deadline, <a class="code hl_class" href="classfc_1_1microseconds.html">fc::microseconds</a> max_transaction_time,</div>
<div class="line"><a id="l02883" name="l02883"></a><span class="lineno"> 2883</span>                                                              <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> billed_cpu_time_us, <span class="keywordtype">bool</span> explicit_billed_cpu_time )</div>
<div class="line"><a id="l02884" name="l02884"></a><span class="lineno"> 2884</span>{</div>
<div class="line"><a id="l02885" name="l02885"></a><span class="lineno"> 2885</span>   <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a28d33629f3badcb8155c08be3e05b99e">get_read_mode</a>() != <a class="code hl_enumvalue" href="namespacesysio_1_1chain.html#af3e35f3e1b78dd00fa247009a2d9ba5ea88537e4e57a14e27d354f8ef6fc03d63">db_read_mode::IRREVERSIBLE</a>, transaction_type_exception, <span class="stringliteral">&quot;push scheduled transaction not allowed in irreversible mode&quot;</span> );</div>
<div class="line"><a id="l02886" name="l02886"></a><span class="lineno"> 2886</span>   <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a7b2f18a21e18a1bdc6837a567bb259eb">validate_db_available_size</a>();</div>
<div class="line"><a id="l02887" name="l02887"></a><span class="lineno"> 2887</span>   <span class="keywordflow">return</span> my-&gt;push_scheduled_transaction( trxid, block_deadline, max_transaction_time, billed_cpu_time_us, explicit_billed_cpu_time );</div>
<div class="line"><a id="l02888" name="l02888"></a><span class="lineno"> 2888</span>}</div>
</div>
<div class="line"><a id="l02889" name="l02889"></a><span class="lineno"> 2889</span> </div>
<div class="foldopen" id="foldopen02890" data-start="{" data-end="}">
<div class="line"><a id="l02890" name="l02890"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#ae2572c1888aa71c5386d8d3fc7df75c5"> 2890</a></span><span class="keyword">const</span> flat_set&lt;account_name&gt;&amp; <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#ae2572c1888aa71c5386d8d3fc7df75c5">controller::get_actor_whitelist</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a id="l02891" name="l02891"></a><span class="lineno"> 2891</span>   <span class="keywordflow">return</span> my-&gt;conf.actor_whitelist;</div>
<div class="line"><a id="l02892" name="l02892"></a><span class="lineno"> 2892</span>}</div>
</div>
<div class="foldopen" id="foldopen02893" data-start="{" data-end="}">
<div class="line"><a id="l02893" name="l02893"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a087c940aa88be2ccc1fbb7dd1bc28da6"> 2893</a></span><span class="keyword">const</span> flat_set&lt;account_name&gt;&amp; <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a087c940aa88be2ccc1fbb7dd1bc28da6">controller::get_actor_blacklist</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a id="l02894" name="l02894"></a><span class="lineno"> 2894</span>   <span class="keywordflow">return</span> my-&gt;conf.actor_blacklist;</div>
<div class="line"><a id="l02895" name="l02895"></a><span class="lineno"> 2895</span>}</div>
</div>
<div class="foldopen" id="foldopen02896" data-start="{" data-end="}">
<div class="line"><a id="l02896" name="l02896"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a7408289ee5f740f797b9b9d9b192704a"> 2896</a></span><span class="keyword">const</span> flat_set&lt;account_name&gt;&amp; <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a7408289ee5f740f797b9b9d9b192704a">controller::get_contract_whitelist</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a id="l02897" name="l02897"></a><span class="lineno"> 2897</span>   <span class="keywordflow">return</span> my-&gt;conf.contract_whitelist;</div>
<div class="line"><a id="l02898" name="l02898"></a><span class="lineno"> 2898</span>}</div>
</div>
<div class="foldopen" id="foldopen02899" data-start="{" data-end="}">
<div class="line"><a id="l02899" name="l02899"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a99c90ed934995116348fe891223e1037"> 2899</a></span><span class="keyword">const</span> flat_set&lt;account_name&gt;&amp; <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a99c90ed934995116348fe891223e1037">controller::get_contract_blacklist</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a id="l02900" name="l02900"></a><span class="lineno"> 2900</span>   <span class="keywordflow">return</span> my-&gt;conf.contract_blacklist;</div>
<div class="line"><a id="l02901" name="l02901"></a><span class="lineno"> 2901</span>}</div>
</div>
<div class="foldopen" id="foldopen02902" data-start="{" data-end="}">
<div class="line"><a id="l02902" name="l02902"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a8a195d27a416c714bdc058b7f1919267"> 2902</a></span><span class="keyword">const</span> flat_set&lt; pair&lt;account_name, action_name&gt; &gt;&amp; <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a8a195d27a416c714bdc058b7f1919267">controller::get_action_blacklist</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a id="l02903" name="l02903"></a><span class="lineno"> 2903</span>   <span class="keywordflow">return</span> my-&gt;conf.action_blacklist;</div>
<div class="line"><a id="l02904" name="l02904"></a><span class="lineno"> 2904</span>}</div>
</div>
<div class="foldopen" id="foldopen02905" data-start="{" data-end="}">
<div class="line"><a id="l02905" name="l02905"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#aabfe5c42521aa0550a5f5e60ec89fd19"> 2905</a></span><span class="keyword">const</span> flat_set&lt;public_key_type&gt;&amp; <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#aabfe5c42521aa0550a5f5e60ec89fd19">controller::get_key_blacklist</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a id="l02906" name="l02906"></a><span class="lineno"> 2906</span>   <span class="keywordflow">return</span> my-&gt;conf.key_blacklist;</div>
<div class="line"><a id="l02907" name="l02907"></a><span class="lineno"> 2907</span>}</div>
</div>
<div class="line"><a id="l02908" name="l02908"></a><span class="lineno"> 2908</span> </div>
<div class="foldopen" id="foldopen02909" data-start="{" data-end="}">
<div class="line"><a id="l02909" name="l02909"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a06ea0e9e805452cdd189f13df09916e8"> 2909</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a06ea0e9e805452cdd189f13df09916e8">controller::set_actor_whitelist</a>( <span class="keyword">const</span> flat_set&lt;account_name&gt;&amp; new_actor_whitelist ) {</div>
<div class="line"><a id="l02910" name="l02910"></a><span class="lineno"> 2910</span>   my-&gt;conf.actor_whitelist = new_actor_whitelist;</div>
<div class="line"><a id="l02911" name="l02911"></a><span class="lineno"> 2911</span>}</div>
</div>
<div class="foldopen" id="foldopen02912" data-start="{" data-end="}">
<div class="line"><a id="l02912" name="l02912"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a1a695a1daba0cf887e71851a61911a37"> 2912</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a1a695a1daba0cf887e71851a61911a37">controller::set_actor_blacklist</a>( <span class="keyword">const</span> flat_set&lt;account_name&gt;&amp; new_actor_blacklist ) {</div>
<div class="line"><a id="l02913" name="l02913"></a><span class="lineno"> 2913</span>   my-&gt;conf.actor_blacklist = new_actor_blacklist;</div>
<div class="line"><a id="l02914" name="l02914"></a><span class="lineno"> 2914</span>}</div>
</div>
<div class="foldopen" id="foldopen02915" data-start="{" data-end="}">
<div class="line"><a id="l02915" name="l02915"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#ab156fd6d4e3f28e14373c8dbbeb5a0ed"> 2915</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#ab156fd6d4e3f28e14373c8dbbeb5a0ed">controller::set_contract_whitelist</a>( <span class="keyword">const</span> flat_set&lt;account_name&gt;&amp; new_contract_whitelist ) {</div>
<div class="line"><a id="l02916" name="l02916"></a><span class="lineno"> 2916</span>   my-&gt;conf.contract_whitelist = new_contract_whitelist;</div>
<div class="line"><a id="l02917" name="l02917"></a><span class="lineno"> 2917</span>}</div>
</div>
<div class="foldopen" id="foldopen02918" data-start="{" data-end="}">
<div class="line"><a id="l02918" name="l02918"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a904bf66cadfa73c918e9d835c819a524"> 2918</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a904bf66cadfa73c918e9d835c819a524">controller::set_contract_blacklist</a>( <span class="keyword">const</span> flat_set&lt;account_name&gt;&amp; new_contract_blacklist ) {</div>
<div class="line"><a id="l02919" name="l02919"></a><span class="lineno"> 2919</span>   my-&gt;conf.contract_blacklist = new_contract_blacklist;</div>
<div class="line"><a id="l02920" name="l02920"></a><span class="lineno"> 2920</span>}</div>
</div>
<div class="foldopen" id="foldopen02921" data-start="{" data-end="}">
<div class="line"><a id="l02921" name="l02921"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#af1e44676760107bf3ed8979feb1d4f00"> 2921</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#af1e44676760107bf3ed8979feb1d4f00">controller::set_action_blacklist</a>( <span class="keyword">const</span> flat_set&lt; pair&lt;account_name, action_name&gt; &gt;&amp; new_action_blacklist ) {</div>
<div class="line"><a id="l02922" name="l02922"></a><span class="lineno"> 2922</span>   <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; act: new_action_blacklist) {</div>
<div class="line"><a id="l02923" name="l02923"></a><span class="lineno"> 2923</span>      <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>(act.first != <a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">account_name</a>(), name_type_exception, <span class="stringliteral">&quot;Action blacklist - contract name should not be empty&quot;</span>);</div>
<div class="line"><a id="l02924" name="l02924"></a><span class="lineno"> 2924</span>      <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>(act.second != <a class="code hl_typedef" href="namespacesysio_1_1chain.html#a7a1685bcc352cda9e45f055932069428">action_name</a>(), action_type_exception, <span class="stringliteral">&quot;Action blacklist - action name should not be empty&quot;</span>);</div>
<div class="line"><a id="l02925" name="l02925"></a><span class="lineno"> 2925</span>   }</div>
<div class="line"><a id="l02926" name="l02926"></a><span class="lineno"> 2926</span>   my-&gt;conf.action_blacklist = new_action_blacklist;</div>
<div class="line"><a id="l02927" name="l02927"></a><span class="lineno"> 2927</span>}</div>
</div>
<div class="foldopen" id="foldopen02928" data-start="{" data-end="}">
<div class="line"><a id="l02928" name="l02928"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a5711e4cc0cff77f67d04b64373252412"> 2928</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a5711e4cc0cff77f67d04b64373252412">controller::set_key_blacklist</a>( <span class="keyword">const</span> flat_set&lt;public_key_type&gt;&amp; new_key_blacklist ) {</div>
<div class="line"><a id="l02929" name="l02929"></a><span class="lineno"> 2929</span>   my-&gt;conf.key_blacklist = new_key_blacklist;</div>
<div class="line"><a id="l02930" name="l02930"></a><span class="lineno"> 2930</span>}</div>
</div>
<div class="foldopen" id="foldopen02931" data-start="{" data-end="}">
<div class="line"><a id="l02931" name="l02931"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a59e341a41ba27734555c54c37bacf358"> 2931</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a59e341a41ba27734555c54c37bacf358">controller::set_s_header</a>( <span class="keyword">const</span> <a class="code hl_struct" href="structsysio_1_1chain_1_1s__header.html">s_header</a>&amp; <a class="code hl_struct" href="structsysio_1_1chain_1_1s__header.html">s_header</a> ) {</div>
<div class="line"><a id="l02932" name="l02932"></a><span class="lineno"> 2932</span>   <span class="comment">//  ilog(&quot;CONTROLLER - setting s header: ${s}&quot;, (&quot;s&quot;, s_header.to_string()));</span></div>
<div class="line"><a id="l02933" name="l02933"></a><span class="lineno"> 2933</span>   <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( my-&gt;pending, <a class="code hl_variable" href="namespacesysio_1_1chain.html#a910243f6a0327fb2d4fc80f7e89f103e">block_validate_exception</a>, <span class="stringliteral">&quot;it is not valid to set_s_header when there is no pending block&quot;</span>);</div>
<div class="line"><a id="l02934" name="l02934"></a><span class="lineno"> 2934</span>   <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( std::holds_alternative&lt;building_block&gt;(my-&gt;pending-&gt;_block_stage), <a class="code hl_variable" href="namespacesysio_1_1chain.html#a910243f6a0327fb2d4fc80f7e89f103e">block_validate_exception</a>, <span class="stringliteral">&quot;already called finalize_block&quot;</span>);</div>
<div class="line"><a id="l02935" name="l02935"></a><span class="lineno"> 2935</span>   <span class="comment">// SYS_ASSERT( std::get&lt;assembled_block&gt;(pending-&gt;_block_stage)._id == id, block_validate_exception, &quot;mismatching block id&quot; );</span></div>
<div class="line"><a id="l02936" name="l02936"></a><span class="lineno"> 2936</span>   <span class="comment">// Try to set it first in the pending block</span></div>
<div class="line"><a id="l02937" name="l02937"></a><span class="lineno"> 2937</span>   <span class="keyword">auto</span>&amp; bb = std::get&lt;building_block&gt;(my-&gt;pending-&gt;_block_stage);</div>
<div class="line"><a id="l02938" name="l02938"></a><span class="lineno"> 2938</span>   bb._s_header = <a class="code hl_struct" href="structsysio_1_1chain_1_1s__header.html">s_header</a>; <span class="comment">// Attempt to set s-header</span></div>
<div class="line"><a id="l02939" name="l02939"></a><span class="lineno"> 2939</span>   <span class="keyword">auto</span>&amp; check_s_header = std::get&lt;building_block&gt;(my-&gt;pending-&gt;_block_stage)._s_header;</div>
<div class="line"><a id="l02940" name="l02940"></a><span class="lineno"> 2940</span>   <span class="keywordflow">if</span> (check_s_header){</div>
<div class="line"><a id="l02941" name="l02941"></a><span class="lineno"> 2941</span>      <a class="code hl_define" href="logger_8hpp.html#a831cf08dc63704c11fd154132c6e8bdb">ilog</a>(<span class="stringliteral">&quot;Pending building block s_header set: ${s_header}\n\t\tand matches what was passed: ${match}&quot;</span>, </div>
<div class="line"><a id="l02942" name="l02942"></a><span class="lineno"> 2942</span>         (<span class="stringliteral">&quot;s_header&quot;</span>, check_s_header-&gt;to_string())(<span class="stringliteral">&quot;match&quot;</span>, check_s_header == <a class="code hl_struct" href="structsysio_1_1chain_1_1s__header.html">s_header</a>));</div>
<div class="line"><a id="l02943" name="l02943"></a><span class="lineno"> 2943</span>   }</div>
<div class="line"><a id="l02944" name="l02944"></a><span class="lineno"> 2944</span>   <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l02945" name="l02945"></a><span class="lineno"> 2945</span>      <a class="code hl_define" href="logger_8hpp.html#a831cf08dc63704c11fd154132c6e8bdb">ilog</a>(<span class="stringliteral">&quot;Pending building block s_header NOT SET&quot;</span>);</div>
<div class="line"><a id="l02946" name="l02946"></a><span class="lineno"> 2946</span>   }</div>
<div class="line"><a id="l02947" name="l02947"></a><span class="lineno"> 2947</span>}</div>
</div>
<div class="line"><a id="l02948" name="l02948"></a><span class="lineno"> 2948</span> </div>
<div class="foldopen" id="foldopen02949" data-start="{" data-end="}">
<div class="line"><a id="l02949" name="l02949"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a33704b4936bb9bbd2ea6b0874ca521b4"> 2949</a></span><a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a33704b4936bb9bbd2ea6b0874ca521b4">controller::head_block_num</a>()<span class="keyword">const </span>{</div>
<div class="line"><a id="l02950" name="l02950"></a><span class="lineno"> 2950</span>   <span class="keywordflow">return</span> my-&gt;head-&gt;block_num;</div>
<div class="line"><a id="l02951" name="l02951"></a><span class="lineno"> 2951</span>}</div>
</div>
<div class="foldopen" id="foldopen02952" data-start="{" data-end="}">
<div class="line"><a id="l02952" name="l02952"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#aea3612e7cb52dfcaa2e6afdc1b3e2f51"> 2952</a></span><a class="code hl_class" href="classfc_1_1time__point.html">time_point</a> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#aea3612e7cb52dfcaa2e6afdc1b3e2f51">controller::head_block_time</a>()<span class="keyword">const </span>{</div>
<div class="line"><a id="l02953" name="l02953"></a><span class="lineno"> 2953</span>   <span class="keywordflow">return</span> my-&gt;head-&gt;header.timestamp;</div>
<div class="line"><a id="l02954" name="l02954"></a><span class="lineno"> 2954</span>}</div>
</div>
<div class="foldopen" id="foldopen02955" data-start="{" data-end="}">
<div class="line"><a id="l02955" name="l02955"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a37d0a44faef74cf0f96127982c1ce124"> 2955</a></span><a class="code hl_class" href="classfc_1_1sha256.html">block_id_type</a> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a37d0a44faef74cf0f96127982c1ce124">controller::head_block_id</a>()<span class="keyword">const </span>{</div>
<div class="line"><a id="l02956" name="l02956"></a><span class="lineno"> 2956</span>   <span class="keywordflow">return</span> my-&gt;head-&gt;id;</div>
<div class="line"><a id="l02957" name="l02957"></a><span class="lineno"> 2957</span>}</div>
</div>
<div class="foldopen" id="foldopen02958" data-start="{" data-end="}">
<div class="line"><a id="l02958" name="l02958"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a307c14eafe6dd6c43f6de377bbc2d10d"> 2958</a></span><a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">account_name</a>  <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a307c14eafe6dd6c43f6de377bbc2d10d">controller::head_block_producer</a>()<span class="keyword">const </span>{</div>
<div class="line"><a id="l02959" name="l02959"></a><span class="lineno"> 2959</span>   <span class="keywordflow">return</span> my-&gt;head-&gt;header.producer;</div>
<div class="line"><a id="l02960" name="l02960"></a><span class="lineno"> 2960</span>}</div>
</div>
<div class="foldopen" id="foldopen02961" data-start="{" data-end="}">
<div class="line"><a id="l02961" name="l02961"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#ad39b3fade2e84d4a743230a27c650f1f"> 2961</a></span><span class="keyword">const</span> <a class="code hl_struct" href="structsysio_1_1chain_1_1block__header.html">block_header</a>&amp; <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#ad39b3fade2e84d4a743230a27c650f1f">controller::head_block_header</a>()<span class="keyword">const </span>{</div>
<div class="line"><a id="l02962" name="l02962"></a><span class="lineno"> 2962</span>   <span class="keywordflow">return</span> my-&gt;head-&gt;header;</div>
<div class="line"><a id="l02963" name="l02963"></a><span class="lineno"> 2963</span>}</div>
</div>
<div class="foldopen" id="foldopen02964" data-start="{" data-end="}">
<div class="line"><a id="l02964" name="l02964"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a3e445e8e2da032a322a1348091a1a702"> 2964</a></span><a class="code hl_typedef" href="namespacesysio_1_1chain.html#ab9b14f4554cc4a0da2c361e9757b1662">block_state_ptr</a> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a3e445e8e2da032a322a1348091a1a702">controller::head_block_state</a>()<span class="keyword">const </span>{</div>
<div class="line"><a id="l02965" name="l02965"></a><span class="lineno"> 2965</span>   <span class="keywordflow">return</span> my-&gt;head;</div>
<div class="line"><a id="l02966" name="l02966"></a><span class="lineno"> 2966</span>}</div>
</div>
<div class="line"><a id="l02967" name="l02967"></a><span class="lineno"> 2967</span> </div>
<div class="foldopen" id="foldopen02968" data-start="{" data-end="}">
<div class="line"><a id="l02968" name="l02968"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#ae1ab54d0324632cd8826d35feb328204"> 2968</a></span><a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#ae1ab54d0324632cd8826d35feb328204">controller::fork_db_head_block_num</a>()<span class="keyword">const </span>{</div>
<div class="line"><a id="l02969" name="l02969"></a><span class="lineno"> 2969</span>   <span class="keywordflow">return</span> my-&gt;fork_db.head()-&gt;block_num;</div>
<div class="line"><a id="l02970" name="l02970"></a><span class="lineno"> 2970</span>}</div>
</div>
<div class="line"><a id="l02971" name="l02971"></a><span class="lineno"> 2971</span> </div>
<div class="foldopen" id="foldopen02972" data-start="{" data-end="}">
<div class="line"><a id="l02972" name="l02972"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a6592e04d224ee0bddaab2ad94428b1fc"> 2972</a></span><a class="code hl_class" href="classfc_1_1sha256.html">block_id_type</a> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a6592e04d224ee0bddaab2ad94428b1fc">controller::fork_db_head_block_id</a>()<span class="keyword">const </span>{</div>
<div class="line"><a id="l02973" name="l02973"></a><span class="lineno"> 2973</span>   <span class="keywordflow">return</span> my-&gt;fork_db.head()-&gt;id;</div>
<div class="line"><a id="l02974" name="l02974"></a><span class="lineno"> 2974</span>}</div>
</div>
<div class="line"><a id="l02975" name="l02975"></a><span class="lineno"> 2975</span> </div>
<div class="foldopen" id="foldopen02976" data-start="{" data-end="}">
<div class="line"><a id="l02976" name="l02976"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a8160acef1ebb811902e1ad51f1161650"> 2976</a></span><a class="code hl_class" href="classfc_1_1time__point.html">time_point</a> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a8160acef1ebb811902e1ad51f1161650">controller::fork_db_head_block_time</a>()<span class="keyword">const </span>{</div>
<div class="line"><a id="l02977" name="l02977"></a><span class="lineno"> 2977</span>   <span class="keywordflow">return</span> my-&gt;fork_db.head()-&gt;header.timestamp;</div>
<div class="line"><a id="l02978" name="l02978"></a><span class="lineno"> 2978</span>}</div>
</div>
<div class="line"><a id="l02979" name="l02979"></a><span class="lineno"> 2979</span> </div>
<div class="foldopen" id="foldopen02980" data-start="{" data-end="}">
<div class="line"><a id="l02980" name="l02980"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a738dfae20ac656096578c8959746e126"> 2980</a></span><a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">account_name</a>  <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a738dfae20ac656096578c8959746e126">controller::fork_db_head_block_producer</a>()<span class="keyword">const </span>{</div>
<div class="line"><a id="l02981" name="l02981"></a><span class="lineno"> 2981</span>   <span class="keywordflow">return</span> my-&gt;fork_db.head()-&gt;header.producer;</div>
<div class="line"><a id="l02982" name="l02982"></a><span class="lineno"> 2982</span>}</div>
</div>
<div class="line"><a id="l02983" name="l02983"></a><span class="lineno"> 2983</span> </div>
<div class="foldopen" id="foldopen02984" data-start="{" data-end="}">
<div class="line"><a id="l02984" name="l02984"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a5d51f89938499d2cf479a6f16d42848d"> 2984</a></span><a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a5d51f89938499d2cf479a6f16d42848d">controller::fork_db_pending_head_block_num</a>()<span class="keyword">const </span>{</div>
<div class="line"><a id="l02985" name="l02985"></a><span class="lineno"> 2985</span>   <span class="keywordflow">return</span> my-&gt;fork_db.pending_head()-&gt;block_num;</div>
<div class="line"><a id="l02986" name="l02986"></a><span class="lineno"> 2986</span>}</div>
</div>
<div class="line"><a id="l02987" name="l02987"></a><span class="lineno"> 2987</span> </div>
<div class="foldopen" id="foldopen02988" data-start="{" data-end="}">
<div class="line"><a id="l02988" name="l02988"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a19f994be76ccda4705a54ac7af6bfe29"> 2988</a></span><a class="code hl_class" href="classfc_1_1sha256.html">block_id_type</a> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a19f994be76ccda4705a54ac7af6bfe29">controller::fork_db_pending_head_block_id</a>()<span class="keyword">const </span>{</div>
<div class="line"><a id="l02989" name="l02989"></a><span class="lineno"> 2989</span>   <span class="keywordflow">return</span> my-&gt;fork_db.pending_head()-&gt;id;</div>
<div class="line"><a id="l02990" name="l02990"></a><span class="lineno"> 2990</span>}</div>
</div>
<div class="line"><a id="l02991" name="l02991"></a><span class="lineno"> 2991</span> </div>
<div class="foldopen" id="foldopen02992" data-start="{" data-end="}">
<div class="line"><a id="l02992" name="l02992"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#aba5b781dfa681fa948e32470a76d0419"> 2992</a></span><a class="code hl_class" href="classfc_1_1time__point.html">time_point</a> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#aba5b781dfa681fa948e32470a76d0419">controller::fork_db_pending_head_block_time</a>()<span class="keyword">const </span>{</div>
<div class="line"><a id="l02993" name="l02993"></a><span class="lineno"> 2993</span>   <span class="keywordflow">return</span> my-&gt;fork_db.pending_head()-&gt;header.timestamp;</div>
<div class="line"><a id="l02994" name="l02994"></a><span class="lineno"> 2994</span>}</div>
</div>
<div class="line"><a id="l02995" name="l02995"></a><span class="lineno"> 2995</span> </div>
<div class="foldopen" id="foldopen02996" data-start="{" data-end="}">
<div class="line"><a id="l02996" name="l02996"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a182f205721eaef19d84a5a6aef37be21"> 2996</a></span><a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">account_name</a>  <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a182f205721eaef19d84a5a6aef37be21">controller::fork_db_pending_head_block_producer</a>()<span class="keyword">const </span>{</div>
<div class="line"><a id="l02997" name="l02997"></a><span class="lineno"> 2997</span>   <span class="keywordflow">return</span> my-&gt;fork_db.pending_head()-&gt;header.producer;</div>
<div class="line"><a id="l02998" name="l02998"></a><span class="lineno"> 2998</span>}</div>
</div>
<div class="line"><a id="l02999" name="l02999"></a><span class="lineno"> 2999</span> </div>
<div class="foldopen" id="foldopen03000" data-start="{" data-end="}">
<div class="line"><a id="l03000" name="l03000"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#abb1d81f96986df3bce46bd37caaf6a69"> 3000</a></span><a class="code hl_class" href="classfc_1_1time__point.html">time_point</a> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#abb1d81f96986df3bce46bd37caaf6a69">controller::pending_block_time</a>()<span class="keyword">const </span>{</div>
<div class="line"><a id="l03001" name="l03001"></a><span class="lineno"> 3001</span>   <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( my-&gt;pending, <a class="code hl_variable" href="namespacesysio_1_1chain.html#a910243f6a0327fb2d4fc80f7e89f103e">block_validate_exception</a>, <span class="stringliteral">&quot;no pending block&quot;</span> );</div>
<div class="line"><a id="l03002" name="l03002"></a><span class="lineno"> 3002</span> </div>
<div class="line"><a id="l03003" name="l03003"></a><span class="lineno"> 3003</span>   <span class="keywordflow">if</span>( std::holds_alternative&lt;completed_block&gt;(my-&gt;pending-&gt;_block_stage) )</div>
<div class="line"><a id="l03004" name="l03004"></a><span class="lineno"> 3004</span>      <span class="keywordflow">return</span> std::get&lt;completed_block&gt;(my-&gt;pending-&gt;_block_stage)._block_state-&gt;header.timestamp;</div>
<div class="line"><a id="l03005" name="l03005"></a><span class="lineno"> 3005</span> </div>
<div class="line"><a id="l03006" name="l03006"></a><span class="lineno"> 3006</span>   <span class="keywordflow">return</span> my-&gt;pending-&gt;get_pending_block_header_state().timestamp;</div>
<div class="line"><a id="l03007" name="l03007"></a><span class="lineno"> 3007</span>}</div>
</div>
<div class="line"><a id="l03008" name="l03008"></a><span class="lineno"> 3008</span> </div>
<div class="foldopen" id="foldopen03009" data-start="{" data-end="}">
<div class="line"><a id="l03009" name="l03009"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a47ba4879ad3153282cba14e185f98d71"> 3009</a></span><a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a47ba4879ad3153282cba14e185f98d71">controller::pending_block_num</a>()<span class="keyword">const </span>{</div>
<div class="line"><a id="l03010" name="l03010"></a><span class="lineno"> 3010</span>   <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( my-&gt;pending, <a class="code hl_variable" href="namespacesysio_1_1chain.html#a910243f6a0327fb2d4fc80f7e89f103e">block_validate_exception</a>, <span class="stringliteral">&quot;no pending block&quot;</span> );</div>
<div class="line"><a id="l03011" name="l03011"></a><span class="lineno"> 3011</span> </div>
<div class="line"><a id="l03012" name="l03012"></a><span class="lineno"> 3012</span>   <span class="keywordflow">if</span>( std::holds_alternative&lt;completed_block&gt;(my-&gt;pending-&gt;_block_stage) )</div>
<div class="line"><a id="l03013" name="l03013"></a><span class="lineno"> 3013</span>      <span class="keywordflow">return</span> std::get&lt;completed_block&gt;(my-&gt;pending-&gt;_block_stage)._block_state-&gt;header.block_num();</div>
<div class="line"><a id="l03014" name="l03014"></a><span class="lineno"> 3014</span> </div>
<div class="line"><a id="l03015" name="l03015"></a><span class="lineno"> 3015</span>   <span class="keywordflow">return</span> my-&gt;pending-&gt;get_pending_block_header_state().block_num;</div>
<div class="line"><a id="l03016" name="l03016"></a><span class="lineno"> 3016</span>}</div>
</div>
<div class="line"><a id="l03017" name="l03017"></a><span class="lineno"> 3017</span> </div>
<div class="foldopen" id="foldopen03018" data-start="{" data-end="}">
<div class="line"><a id="l03018" name="l03018"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a7a7a09290738585cd0e05580eeba0a95"> 3018</a></span><a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">account_name</a> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a7a7a09290738585cd0e05580eeba0a95">controller::pending_block_producer</a>()<span class="keyword">const </span>{</div>
<div class="line"><a id="l03019" name="l03019"></a><span class="lineno"> 3019</span>   <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( my-&gt;pending, <a class="code hl_variable" href="namespacesysio_1_1chain.html#a910243f6a0327fb2d4fc80f7e89f103e">block_validate_exception</a>, <span class="stringliteral">&quot;no pending block&quot;</span> );</div>
<div class="line"><a id="l03020" name="l03020"></a><span class="lineno"> 3020</span> </div>
<div class="line"><a id="l03021" name="l03021"></a><span class="lineno"> 3021</span>   <span class="keywordflow">if</span>( std::holds_alternative&lt;completed_block&gt;(my-&gt;pending-&gt;_block_stage) )</div>
<div class="line"><a id="l03022" name="l03022"></a><span class="lineno"> 3022</span>      <span class="keywordflow">return</span> std::get&lt;completed_block&gt;(my-&gt;pending-&gt;_block_stage)._block_state-&gt;header.producer;</div>
<div class="line"><a id="l03023" name="l03023"></a><span class="lineno"> 3023</span> </div>
<div class="line"><a id="l03024" name="l03024"></a><span class="lineno"> 3024</span>   <span class="keywordflow">return</span> my-&gt;pending-&gt;get_pending_block_header_state().producer;</div>
<div class="line"><a id="l03025" name="l03025"></a><span class="lineno"> 3025</span>}</div>
</div>
<div class="line"><a id="l03026" name="l03026"></a><span class="lineno"> 3026</span> </div>
<div class="foldopen" id="foldopen03027" data-start="{" data-end="}">
<div class="line"><a id="l03027" name="l03027"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a7ac238f10e3a4ccf5c746a4e6a43b184"> 3027</a></span><span class="keyword">const</span> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#a5d68aec4c925d17b62f0a9b543fabfc5">block_signing_authority</a>&amp; <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a7ac238f10e3a4ccf5c746a4e6a43b184">controller::pending_block_signing_authority</a>()<span class="keyword">const </span>{</div>
<div class="line"><a id="l03028" name="l03028"></a><span class="lineno"> 3028</span>   <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( my-&gt;pending, <a class="code hl_variable" href="namespacesysio_1_1chain.html#a910243f6a0327fb2d4fc80f7e89f103e">block_validate_exception</a>, <span class="stringliteral">&quot;no pending block&quot;</span> );</div>
<div class="line"><a id="l03029" name="l03029"></a><span class="lineno"> 3029</span> </div>
<div class="line"><a id="l03030" name="l03030"></a><span class="lineno"> 3030</span>   <span class="keywordflow">if</span>( std::holds_alternative&lt;completed_block&gt;(my-&gt;pending-&gt;_block_stage) )</div>
<div class="line"><a id="l03031" name="l03031"></a><span class="lineno"> 3031</span>      <span class="keywordflow">return</span> std::get&lt;completed_block&gt;(my-&gt;pending-&gt;_block_stage)._block_state-&gt;valid_block_signing_authority;</div>
<div class="line"><a id="l03032" name="l03032"></a><span class="lineno"> 3032</span> </div>
<div class="line"><a id="l03033" name="l03033"></a><span class="lineno"> 3033</span>   <span class="keywordflow">return</span> my-&gt;pending-&gt;get_pending_block_header_state().valid_block_signing_authority;</div>
<div class="line"><a id="l03034" name="l03034"></a><span class="lineno"> 3034</span>}</div>
</div>
<div class="line"><a id="l03035" name="l03035"></a><span class="lineno"> 3035</span> </div>
<div class="foldopen" id="foldopen03036" data-start="{" data-end="}">
<div class="line"><a id="l03036" name="l03036"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a8ad92bdf81057887fdc4b732cb864bc4"> 3036</a></span>std::optional&lt;block_id_type&gt; <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a8ad92bdf81057887fdc4b732cb864bc4">controller::pending_producer_block_id</a>()<span class="keyword">const </span>{</div>
<div class="line"><a id="l03037" name="l03037"></a><span class="lineno"> 3037</span>   <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( my-&gt;pending, <a class="code hl_variable" href="namespacesysio_1_1chain.html#a910243f6a0327fb2d4fc80f7e89f103e">block_validate_exception</a>, <span class="stringliteral">&quot;no pending block&quot;</span> );</div>
<div class="line"><a id="l03038" name="l03038"></a><span class="lineno"> 3038</span>   <span class="keywordflow">return</span> my-&gt;pending-&gt;_producer_block_id;</div>
<div class="line"><a id="l03039" name="l03039"></a><span class="lineno"> 3039</span>}</div>
</div>
<div class="line"><a id="l03040" name="l03040"></a><span class="lineno"> 3040</span> </div>
<div class="foldopen" id="foldopen03041" data-start="{" data-end="}">
<div class="line"><a id="l03041" name="l03041"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#ad6f4e938fb4b051c1d6b6c5cede09c76"> 3041</a></span><span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1vector.html">vector&lt;transaction_receipt&gt;</a>&amp; <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#ad6f4e938fb4b051c1d6b6c5cede09c76">controller::get_pending_trx_receipts</a>()<span class="keyword">const </span>{</div>
<div class="line"><a id="l03042" name="l03042"></a><span class="lineno"> 3042</span>   <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( my-&gt;pending, <a class="code hl_variable" href="namespacesysio_1_1chain.html#a910243f6a0327fb2d4fc80f7e89f103e">block_validate_exception</a>, <span class="stringliteral">&quot;no pending block&quot;</span> );</div>
<div class="line"><a id="l03043" name="l03043"></a><span class="lineno"> 3043</span>   <span class="keywordflow">return</span> my-&gt;pending-&gt;get_trx_receipts();</div>
<div class="line"><a id="l03044" name="l03044"></a><span class="lineno"> 3044</span>}</div>
</div>
<div class="line"><a id="l03045" name="l03045"></a><span class="lineno"> 3045</span> </div>
<div class="foldopen" id="foldopen03046" data-start="{" data-end="}">
<div class="line"><a id="l03046" name="l03046"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a53495de416021a4e56e889e771b25a52"> 3046</a></span><a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a53495de416021a4e56e889e771b25a52">controller::last_irreversible_block_num</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a id="l03047" name="l03047"></a><span class="lineno"> 3047</span>   <span class="keywordflow">return</span> my-&gt;fork_db.root()-&gt;block_num;</div>
<div class="line"><a id="l03048" name="l03048"></a><span class="lineno"> 3048</span>}</div>
</div>
<div class="line"><a id="l03049" name="l03049"></a><span class="lineno"> 3049</span> </div>
<div class="foldopen" id="foldopen03050" data-start="{" data-end="}">
<div class="line"><a id="l03050" name="l03050"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a992401ccd9d3ecf5484c7d97bea18f51"> 3050</a></span><a class="code hl_class" href="classfc_1_1sha256.html">block_id_type</a> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a992401ccd9d3ecf5484c7d97bea18f51">controller::last_irreversible_block_id</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a id="l03051" name="l03051"></a><span class="lineno"> 3051</span>   <span class="keywordflow">return</span> my-&gt;fork_db.root()-&gt;id;</div>
<div class="line"><a id="l03052" name="l03052"></a><span class="lineno"> 3052</span>}</div>
</div>
<div class="line"><a id="l03053" name="l03053"></a><span class="lineno"> 3053</span> </div>
<div class="foldopen" id="foldopen03054" data-start="{" data-end="}">
<div class="line"><a id="l03054" name="l03054"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a878ff6368c473051417382a9d485030d"> 3054</a></span><a class="code hl_class" href="classfc_1_1time__point.html">time_point</a> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a878ff6368c473051417382a9d485030d">controller::last_irreversible_block_time</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a id="l03055" name="l03055"></a><span class="lineno"> 3055</span>   <span class="keywordflow">return</span> my-&gt;fork_db.root()-&gt;header.timestamp.to_time_point();</div>
<div class="line"><a id="l03056" name="l03056"></a><span class="lineno"> 3056</span>}</div>
</div>
<div class="line"><a id="l03057" name="l03057"></a><span class="lineno"> 3057</span> </div>
<div class="line"><a id="l03058" name="l03058"></a><span class="lineno"> 3058</span> </div>
<div class="foldopen" id="foldopen03059" data-start="{" data-end="}">
<div class="line"><a id="l03059" name="l03059"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a148eb08aa44ff6a177015a66004d0e49"> 3059</a></span><span class="keyword">const</span> <a class="code hl_class" href="classsysio_1_1chain_1_1dynamic__global__property__object.html">dynamic_global_property_object</a>&amp; <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a148eb08aa44ff6a177015a66004d0e49">controller::get_dynamic_global_properties</a>()<span class="keyword">const </span>{</div>
<div class="line"><a id="l03060" name="l03060"></a><span class="lineno"> 3060</span>  <span class="keywordflow">return</span> my-&gt;db.get&lt;<a class="code hl_class" href="classsysio_1_1chain_1_1dynamic__global__property__object.html">dynamic_global_property_object</a>&gt;();</div>
<div class="line"><a id="l03061" name="l03061"></a><span class="lineno"> 3061</span>}</div>
</div>
<div class="foldopen" id="foldopen03062" data-start="{" data-end="}">
<div class="line"><a id="l03062" name="l03062"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a0bb11e832a05b6437c79bf81758b1b7d"> 3062</a></span><span class="keyword">const</span> <a class="code hl_class" href="classsysio_1_1chain_1_1global__property__object.html">global_property_object</a>&amp; <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a0bb11e832a05b6437c79bf81758b1b7d">controller::get_global_properties</a>()<span class="keyword">const </span>{</div>
<div class="line"><a id="l03063" name="l03063"></a><span class="lineno"> 3063</span>  <span class="keywordflow">return</span> my-&gt;db.get&lt;<a class="code hl_class" href="classsysio_1_1chain_1_1global__property__object.html">global_property_object</a>&gt;();</div>
<div class="line"><a id="l03064" name="l03064"></a><span class="lineno"> 3064</span>}</div>
</div>
<div class="line"><a id="l03065" name="l03065"></a><span class="lineno"> 3065</span> </div>
<div class="foldopen" id="foldopen03066" data-start="{" data-end="}">
<div class="line"><a id="l03066" name="l03066"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a7d6e058e892e067510650db853794338"> 3066</a></span><a class="code hl_typedef" href="namespacesysio_1_1chain.html#aa10ee348c57604b615bc8570f6685102">signed_block_ptr</a> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a7d6e058e892e067510650db853794338">controller::fetch_block_by_id</a>( <a class="code hl_class" href="classfc_1_1sha256.html">block_id_type</a> <span class="keywordtype">id</span> )<span class="keyword">const </span>{</div>
<div class="line"><a id="l03067" name="l03067"></a><span class="lineno"> 3067</span>   <span class="keyword">auto</span> <a class="code hl_struct" href="structstate.html">state</a> = my-&gt;fork_db.get_block(<span class="keywordtype">id</span>);</div>
<div class="line"><a id="l03068" name="l03068"></a><span class="lineno"> 3068</span>   <span class="keywordflow">if</span>( <a class="code hl_struct" href="structstate.html">state</a> &amp;&amp; <a class="code hl_struct" href="structstate.html">state</a>-&gt;block ) <span class="keywordflow">return</span> <a class="code hl_struct" href="structstate.html">state</a>-&gt;block;</div>
<div class="line"><a id="l03069" name="l03069"></a><span class="lineno"> 3069</span>   <span class="keyword">auto</span> bptr = my-&gt;blog.read_block_by_num( <a class="code hl_function" href="structsysio_1_1chain_1_1block__header.html#a39d57e33ef8d3f6ba59b4c458f0ae375">block_header::num_from_id</a>(<span class="keywordtype">id</span>) );</div>
<div class="line"><a id="l03070" name="l03070"></a><span class="lineno"> 3070</span>   <span class="keywordflow">if</span>( bptr &amp;&amp; bptr-&gt;calculate_id() == <span class="keywordtype">id</span> ) <span class="keywordflow">return</span> bptr;</div>
<div class="line"><a id="l03071" name="l03071"></a><span class="lineno"> 3071</span>   <span class="keywordflow">return</span> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#aa10ee348c57604b615bc8570f6685102">signed_block_ptr</a>();</div>
<div class="line"><a id="l03072" name="l03072"></a><span class="lineno"> 3072</span>}</div>
</div>
<div class="line"><a id="l03073" name="l03073"></a><span class="lineno"> 3073</span> </div>
<div class="foldopen" id="foldopen03074" data-start="{" data-end="}">
<div class="line"><a id="l03074" name="l03074"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a1379e43325b7e517a058bddce15571eb"> 3074</a></span><a class="code hl_typedef" href="namespacesysio_1_1chain.html#aa10ee348c57604b615bc8570f6685102">signed_block_ptr</a> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a1379e43325b7e517a058bddce15571eb">controller::fetch_block_by_number</a>( <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> block_num )<span class="keyword">const  </span>{ <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l03075" name="l03075"></a><span class="lineno"> 3075</span>   <span class="keyword">auto</span> blk_state = <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a04f3c55da09b359224510af99502490f">fetch_block_state_by_number</a>( block_num );</div>
<div class="line"><a id="l03076" name="l03076"></a><span class="lineno"> 3076</span>   <span class="keywordflow">if</span>( blk_state ) {</div>
<div class="line"><a id="l03077" name="l03077"></a><span class="lineno"> 3077</span>      <span class="keywordflow">return</span> blk_state-&gt;block;</div>
<div class="line"><a id="l03078" name="l03078"></a><span class="lineno"> 3078</span>   }</div>
<div class="line"><a id="l03079" name="l03079"></a><span class="lineno"> 3079</span> </div>
<div class="line"><a id="l03080" name="l03080"></a><span class="lineno"> 3080</span>   <span class="keywordflow">return</span> my-&gt;blog.read_block_by_num(block_num);</div>
<div class="line"><a id="l03081" name="l03081"></a><span class="lineno"> 3081</span>} <a class="code hl_define" href="exception_8hpp.html#a094902280cad82ad6529ebbd12a697eb">FC_CAPTURE_AND_RETHROW</a>( (block_num) ) }</div>
</div>
<div class="line"><a id="l03082" name="l03082"></a><span class="lineno"> 3082</span> </div>
<div class="foldopen" id="foldopen03083" data-start="{" data-end="}">
<div class="line"><a id="l03083" name="l03083"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#acd214861da435dc956d30c81de7c50ff"> 3083</a></span><a class="code hl_typedef" href="namespacesysio_1_1chain.html#ab9b14f4554cc4a0da2c361e9757b1662">block_state_ptr</a> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#acd214861da435dc956d30c81de7c50ff">controller::fetch_block_state_by_id</a>( <a class="code hl_class" href="classfc_1_1sha256.html">block_id_type</a> <span class="keywordtype">id</span> )<span class="keyword">const </span>{</div>
<div class="line"><a id="l03084" name="l03084"></a><span class="lineno"> 3084</span>   <span class="keyword">auto</span> <a class="code hl_struct" href="structstate.html">state</a> = my-&gt;fork_db.get_block(<span class="keywordtype">id</span>);</div>
<div class="line"><a id="l03085" name="l03085"></a><span class="lineno"> 3085</span>   <span class="keywordflow">return</span> <a class="code hl_struct" href="structstate.html">state</a>;</div>
<div class="line"><a id="l03086" name="l03086"></a><span class="lineno"> 3086</span>}</div>
</div>
<div class="line"><a id="l03087" name="l03087"></a><span class="lineno"> 3087</span> </div>
<div class="foldopen" id="foldopen03088" data-start="{" data-end="}">
<div class="line"><a id="l03088" name="l03088"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a04f3c55da09b359224510af99502490f"> 3088</a></span><a class="code hl_typedef" href="namespacesysio_1_1chain.html#ab9b14f4554cc4a0da2c361e9757b1662">block_state_ptr</a> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a04f3c55da09b359224510af99502490f">controller::fetch_block_state_by_number</a>( <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> block_num )<span class="keyword">const  </span>{ <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l03089" name="l03089"></a><span class="lineno"> 3089</span>   <span class="keywordflow">if</span>( my-&gt;read_mode == <a class="code hl_enumvalue" href="namespacesysio_1_1chain.html#af3e35f3e1b78dd00fa247009a2d9ba5ea88537e4e57a14e27d354f8ef6fc03d63">db_read_mode::IRREVERSIBLE</a> ) {</div>
<div class="line"><a id="l03090" name="l03090"></a><span class="lineno"> 3090</span>      <span class="keywordflow">return</span> my-&gt;fork_db.search_on_branch( my-&gt;fork_db.pending_head()-&gt;id, block_num );</div>
<div class="line"><a id="l03091" name="l03091"></a><span class="lineno"> 3091</span>   } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l03092" name="l03092"></a><span class="lineno"> 3092</span>      <span class="keywordflow">return</span> my-&gt;fork_db.search_on_branch( my-&gt;fork_db.head()-&gt;id, block_num );</div>
<div class="line"><a id="l03093" name="l03093"></a><span class="lineno"> 3093</span>   }</div>
<div class="line"><a id="l03094" name="l03094"></a><span class="lineno"> 3094</span>} <a class="code hl_define" href="exception_8hpp.html#a094902280cad82ad6529ebbd12a697eb">FC_CAPTURE_AND_RETHROW</a>( (block_num) ) }</div>
</div>
<div class="line"><a id="l03095" name="l03095"></a><span class="lineno"> 3095</span> </div>
<div class="foldopen" id="foldopen03096" data-start="{" data-end="}">
<div class="line"><a id="l03096" name="l03096"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a9a55edb4766f1f3302ede12e329b1ea6"> 3096</a></span><a class="code hl_class" href="classfc_1_1sha256.html">block_id_type</a> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a9a55edb4766f1f3302ede12e329b1ea6">controller::get_block_id_for_num</a>( <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> block_num )<span class="keyword">const </span>{ <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l03097" name="l03097"></a><span class="lineno"> 3097</span>   <span class="keyword">const</span> <span class="keyword">auto</span>&amp; tapos_block_summary = <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a0c79d00dae8c0d90efc18f4d091b2391">db</a>().<a class="code hl_function" href="classchainbase_1_1database.html#afcfe00f81a526c1376d4f51197dd3a9a">get</a>&lt;<a class="code hl_class" href="classsysio_1_1chain_1_1block__summary__object.html">block_summary_object</a>&gt;((<a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a>)block_num);</div>
<div class="line"><a id="l03098" name="l03098"></a><span class="lineno"> 3098</span> </div>
<div class="line"><a id="l03099" name="l03099"></a><span class="lineno"> 3099</span>   <span class="keywordflow">if</span>( <a class="code hl_function" href="structsysio_1_1chain_1_1block__header.html#a39d57e33ef8d3f6ba59b4c458f0ae375">block_header::num_from_id</a>(tapos_block_summary.block_id) == block_num )</div>
<div class="line"><a id="l03100" name="l03100"></a><span class="lineno"> 3100</span>      <span class="keywordflow">return</span> tapos_block_summary.block_id;</div>
<div class="line"><a id="l03101" name="l03101"></a><span class="lineno"> 3101</span> </div>
<div class="line"><a id="l03102" name="l03102"></a><span class="lineno"> 3102</span>   <span class="keyword">const</span> <span class="keyword">auto</span>&amp; blog_head = my-&gt;blog.head();</div>
<div class="line"><a id="l03103" name="l03103"></a><span class="lineno"> 3103</span> </div>
<div class="line"><a id="l03104" name="l03104"></a><span class="lineno"> 3104</span>   <span class="keywordtype">bool</span> find_in_blog = (blog_head &amp;&amp; block_num &lt;= blog_head-&gt;block_num());</div>
<div class="line"><a id="l03105" name="l03105"></a><span class="lineno"> 3105</span> </div>
<div class="line"><a id="l03106" name="l03106"></a><span class="lineno"> 3106</span>   <span class="keywordflow">if</span>( !find_in_blog ) {</div>
<div class="line"><a id="l03107" name="l03107"></a><span class="lineno"> 3107</span>      <span class="keyword">auto</span> bsp = <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a04f3c55da09b359224510af99502490f">fetch_block_state_by_number</a>( block_num );</div>
<div class="line"><a id="l03108" name="l03108"></a><span class="lineno"> 3108</span>      <span class="keywordflow">if</span>( bsp ) <span class="keywordflow">return</span> bsp-&gt;id;</div>
<div class="line"><a id="l03109" name="l03109"></a><span class="lineno"> 3109</span>   }</div>
<div class="line"><a id="l03110" name="l03110"></a><span class="lineno"> 3110</span> </div>
<div class="line"><a id="l03111" name="l03111"></a><span class="lineno"> 3111</span>   <span class="keyword">auto</span> <span class="keywordtype">id</span> = my-&gt;blog.read_block_id_by_num(block_num);</div>
<div class="line"><a id="l03112" name="l03112"></a><span class="lineno"> 3112</span> </div>
<div class="line"><a id="l03113" name="l03113"></a><span class="lineno"> 3113</span>   <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( BOOST_LIKELY( <span class="keywordtype">id</span> != <a class="code hl_typedef" href="namespacesysio_1_1chain.html#a4b8e4b7ed9dcd18ee75d0de62e88aa17">block_id_type</a>() ), unknown_block_exception,</div>
<div class="line"><a id="l03114" name="l03114"></a><span class="lineno"> 3114</span>               <span class="stringliteral">&quot;Could not find block: ${block}&quot;</span>, (<span class="stringliteral">&quot;block&quot;</span>, block_num) );</div>
<div class="line"><a id="l03115" name="l03115"></a><span class="lineno"> 3115</span> </div>
<div class="line"><a id="l03116" name="l03116"></a><span class="lineno"> 3116</span>   <span class="keywordflow">return</span> <a class="code hl_variable" href="code__cache_8cpp.html#aa0efefe21f4700d78692edc823e763be">id</a>;</div>
<div class="line"><a id="l03117" name="l03117"></a><span class="lineno"> 3117</span>} <a class="code hl_define" href="exception_8hpp.html#a094902280cad82ad6529ebbd12a697eb">FC_CAPTURE_AND_RETHROW</a>( (block_num) ) }</div>
</div>
<div class="line"><a id="l03118" name="l03118"></a><span class="lineno"> 3118</span> </div>
<div class="foldopen" id="foldopen03119" data-start="{" data-end="}">
<div class="line"><a id="l03119" name="l03119"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#ae0a4a81d5d603085be18b54fb5a709b9"> 3119</a></span><a class="code hl_class" href="classfc_1_1sha256.html">sha256</a> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#ae0a4a81d5d603085be18b54fb5a709b9">controller::calculate_integrity_hash</a>() { <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l03120" name="l03120"></a><span class="lineno"> 3120</span>   <span class="keywordflow">return</span> my-&gt;calculate_integrity_hash();</div>
<div class="line"><a id="l03121" name="l03121"></a><span class="lineno"> 3121</span>} <a class="code hl_define" href="exception_8hpp.html#ae70bfa24f5a3bc0917382b3c17fc033c">FC_LOG_AND_RETHROW</a>() }</div>
</div>
<div class="line"><a id="l03122" name="l03122"></a><span class="lineno"> 3122</span> </div>
<div class="foldopen" id="foldopen03123" data-start="{" data-end="}">
<div class="line"><a id="l03123" name="l03123"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a407d1c6dfd6e7b3e1d4e1567d15e344c"> 3123</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a407d1c6dfd6e7b3e1d4e1567d15e344c">controller::write_snapshot</a>( <span class="keyword">const</span> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#a80afaa06d96e661a0f93e0ba4b09c8dc">snapshot_writer_ptr</a>&amp; snapshot ) {</div>
<div class="line"><a id="l03124" name="l03124"></a><span class="lineno"> 3124</span>   <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( !my-&gt;pending, <a class="code hl_variable" href="namespacesysio_1_1chain.html#a910243f6a0327fb2d4fc80f7e89f103e">block_validate_exception</a>, <span class="stringliteral">&quot;cannot take a consistent snapshot with a pending block&quot;</span> );</div>
<div class="line"><a id="l03125" name="l03125"></a><span class="lineno"> 3125</span>   <span class="keywordflow">return</span> my-&gt;add_to_snapshot(snapshot);</div>
<div class="line"><a id="l03126" name="l03126"></a><span class="lineno"> 3126</span>}</div>
</div>
<div class="line"><a id="l03127" name="l03127"></a><span class="lineno"> 3127</span> </div>
<div class="foldopen" id="foldopen03128" data-start="{" data-end="}">
<div class="line"><a id="l03128" name="l03128"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#ab4cab73bf67a1686c6c595e08a63b632"> 3128</a></span><a class="code hl_typedef" href="stdint_8h.html#a414156feea104f8f75b4ed9e3121b2f6">int64_t</a> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#ab4cab73bf67a1686c6c595e08a63b632">controller::set_proposed_producers</a>( <a class="code hl_class" href="classfc_1_1vector.html">vector&lt;producer_authority&gt;</a> <a class="code hl_function" href="programs_2sysio-launcher_2main_8cpp.html#a6d42fdcc89e90507ee6f095c8e92fa2b">producers</a> ) {</div>
<div class="line"><a id="l03129" name="l03129"></a><span class="lineno"> 3129</span>   <span class="keyword">const</span> <span class="keyword">auto</span>&amp; gpo = <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a0bb11e832a05b6437c79bf81758b1b7d">get_global_properties</a>();</div>
<div class="line"><a id="l03130" name="l03130"></a><span class="lineno"> 3130</span>   <span class="keyword">auto</span> cur_block_num = <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a33704b4936bb9bbd2ea6b0874ca521b4">head_block_num</a>() + 1;</div>
<div class="line"><a id="l03131" name="l03131"></a><span class="lineno"> 3131</span> </div>
<div class="line"><a id="l03132" name="l03132"></a><span class="lineno"> 3132</span>   <span class="keywordflow">if</span>( <a class="code hl_function" href="programs_2sysio-launcher_2main_8cpp.html#a6d42fdcc89e90507ee6f095c8e92fa2b">producers</a>.size() == 0 &amp;&amp; <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#aa808acf858e93c567ff983ccbf8fb6d3">is_builtin_activated</a>( <a class="code hl_enumvalue" href="namespacesysio_1_1chain.html#a406d45a184cdba0af316b5bf34bf56cfa65ea05874d490a8ea760dd8b76c2c504">builtin_protocol_feature_t::disallow_empty_producer_schedule</a> ) ) {</div>
<div class="line"><a id="l03133" name="l03133"></a><span class="lineno"> 3133</span>      <span class="keywordflow">return</span> -1;</div>
<div class="line"><a id="l03134" name="l03134"></a><span class="lineno"> 3134</span>   }</div>
<div class="line"><a id="l03135" name="l03135"></a><span class="lineno"> 3135</span> </div>
<div class="line"><a id="l03136" name="l03136"></a><span class="lineno"> 3136</span>   <span class="keywordflow">if</span>( gpo.proposed_schedule_block_num ) {</div>
<div class="line"><a id="l03137" name="l03137"></a><span class="lineno"> 3137</span>      <span class="keywordflow">if</span>( *gpo.proposed_schedule_block_num != cur_block_num )</div>
<div class="line"><a id="l03138" name="l03138"></a><span class="lineno"> 3138</span>         <span class="keywordflow">return</span> -1; <span class="comment">// there is already a proposed schedule set in a previous block, wait for it to become pending</span></div>
<div class="line"><a id="l03139" name="l03139"></a><span class="lineno"> 3139</span> </div>
<div class="line"><a id="l03140" name="l03140"></a><span class="lineno"> 3140</span>      <span class="keywordflow">if</span>( std::equal( <a class="code hl_function" href="programs_2sysio-launcher_2main_8cpp.html#a6d42fdcc89e90507ee6f095c8e92fa2b">producers</a>.begin(), <a class="code hl_function" href="programs_2sysio-launcher_2main_8cpp.html#a6d42fdcc89e90507ee6f095c8e92fa2b">producers</a>.end(),</div>
<div class="line"><a id="l03141" name="l03141"></a><span class="lineno"> 3141</span>                      gpo.proposed_schedule.producers.begin(), gpo.proposed_schedule.producers.end() ) )</div>
<div class="line"><a id="l03142" name="l03142"></a><span class="lineno"> 3142</span>         <span class="keywordflow">return</span> -1; <span class="comment">// the proposed producer schedule does not change</span></div>
<div class="line"><a id="l03143" name="l03143"></a><span class="lineno"> 3143</span>   }</div>
<div class="line"><a id="l03144" name="l03144"></a><span class="lineno"> 3144</span> </div>
<div class="line"><a id="l03145" name="l03145"></a><span class="lineno"> 3145</span>   <a class="code hl_struct" href="structsysio_1_1chain_1_1producer__authority__schedule.html">producer_authority_schedule</a> sch;</div>
<div class="line"><a id="l03146" name="l03146"></a><span class="lineno"> 3146</span> </div>
<div class="line"><a id="l03147" name="l03147"></a><span class="lineno"> 3147</span>   <span class="keyword">decltype</span>(sch.<a class="code hl_variable" href="structsysio_1_1chain_1_1producer__authority__schedule.html#afb0f1bdb282b3d8e1a60ee37c70657d4">producers</a>.cend()) end;</div>
<div class="line"><a id="l03148" name="l03148"></a><span class="lineno"> 3148</span>   <span class="keyword">decltype</span>(end)                  begin;</div>
<div class="line"><a id="l03149" name="l03149"></a><span class="lineno"> 3149</span> </div>
<div class="line"><a id="l03150" name="l03150"></a><span class="lineno"> 3150</span>   <span class="keyword">const</span> <span class="keyword">auto</span>&amp; pending_sch = <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a54645293859c265a7492eb002719c3dc">pending_producers</a>();</div>
<div class="line"><a id="l03151" name="l03151"></a><span class="lineno"> 3151</span> </div>
<div class="line"><a id="l03152" name="l03152"></a><span class="lineno"> 3152</span>   <span class="keywordflow">if</span>( pending_sch.producers.size() == 0 ) {</div>
<div class="line"><a id="l03153" name="l03153"></a><span class="lineno"> 3153</span>      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; active_sch = <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#ae0a1946cc6f7b87bd0cfa94bc9aa20b7">active_producers</a>();</div>
<div class="line"><a id="l03154" name="l03154"></a><span class="lineno"> 3154</span>      begin = active_sch.producers.begin();</div>
<div class="line"><a id="l03155" name="l03155"></a><span class="lineno"> 3155</span>      end   = active_sch.producers.end();</div>
<div class="line"><a id="l03156" name="l03156"></a><span class="lineno"> 3156</span>      sch.<a class="code hl_variable" href="structsysio_1_1chain_1_1producer__authority__schedule.html#a477f957323b97c0af6700ef384326b83">version</a> = active_sch.version + 1;</div>
<div class="line"><a id="l03157" name="l03157"></a><span class="lineno"> 3157</span>   } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l03158" name="l03158"></a><span class="lineno"> 3158</span>      begin = pending_sch.producers.begin();</div>
<div class="line"><a id="l03159" name="l03159"></a><span class="lineno"> 3159</span>      end   = pending_sch.producers.end();</div>
<div class="line"><a id="l03160" name="l03160"></a><span class="lineno"> 3160</span>      sch.<a class="code hl_variable" href="structsysio_1_1chain_1_1producer__authority__schedule.html#a477f957323b97c0af6700ef384326b83">version</a> = pending_sch.version + 1;</div>
<div class="line"><a id="l03161" name="l03161"></a><span class="lineno"> 3161</span>   }</div>
<div class="line"><a id="l03162" name="l03162"></a><span class="lineno"> 3162</span> </div>
<div class="line"><a id="l03163" name="l03163"></a><span class="lineno"> 3163</span>   <span class="keywordflow">if</span>( std::equal( <a class="code hl_function" href="programs_2sysio-launcher_2main_8cpp.html#a6d42fdcc89e90507ee6f095c8e92fa2b">producers</a>.begin(), <a class="code hl_function" href="programs_2sysio-launcher_2main_8cpp.html#a6d42fdcc89e90507ee6f095c8e92fa2b">producers</a>.end(), begin, end ) )</div>
<div class="line"><a id="l03164" name="l03164"></a><span class="lineno"> 3164</span>      <span class="keywordflow">return</span> -1; <span class="comment">// the producer schedule would not change</span></div>
<div class="line"><a id="l03165" name="l03165"></a><span class="lineno"> 3165</span> </div>
<div class="line"><a id="l03166" name="l03166"></a><span class="lineno"> 3166</span>   sch.<a class="code hl_variable" href="structsysio_1_1chain_1_1producer__authority__schedule.html#afb0f1bdb282b3d8e1a60ee37c70657d4">producers</a> = std::move(<a class="code hl_function" href="programs_2sysio-launcher_2main_8cpp.html#a6d42fdcc89e90507ee6f095c8e92fa2b">producers</a>);</div>
<div class="line"><a id="l03167" name="l03167"></a><span class="lineno"> 3167</span> </div>
<div class="line"><a id="l03168" name="l03168"></a><span class="lineno"> 3168</span>   <a class="code hl_typedef" href="stdint_8h.html#a414156feea104f8f75b4ed9e3121b2f6">int64_t</a> version = sch.<a class="code hl_variable" href="structsysio_1_1chain_1_1producer__authority__schedule.html#a477f957323b97c0af6700ef384326b83">version</a>;</div>
<div class="line"><a id="l03169" name="l03169"></a><span class="lineno"> 3169</span> </div>
<div class="line"><a id="l03170" name="l03170"></a><span class="lineno"> 3170</span>   <a class="code hl_define" href="logger_8hpp.html#a831cf08dc63704c11fd154132c6e8bdb">ilog</a>( <span class="stringliteral">&quot;proposed producer schedule with version ${v}&quot;</span>, (<span class="stringliteral">&quot;v&quot;</span>, version) );</div>
<div class="line"><a id="l03171" name="l03171"></a><span class="lineno"> 3171</span> </div>
<div class="line"><a id="l03172" name="l03172"></a><span class="lineno"> 3172</span>   my-&gt;db.modify( gpo, [&amp;]( <span class="keyword">auto</span>&amp; gp ) {</div>
<div class="line"><a id="l03173" name="l03173"></a><span class="lineno"> 3173</span>      gp.proposed_schedule_block_num = cur_block_num;</div>
<div class="line"><a id="l03174" name="l03174"></a><span class="lineno"> 3174</span>      gp.proposed_schedule = sch.<a class="code hl_function" href="structsysio_1_1chain_1_1producer__authority__schedule.html#aca17ff9b0f16d16b6f04d4e47bd0d522">to_shared</a>(gp.proposed_schedule.producers.get_allocator());</div>
<div class="line"><a id="l03175" name="l03175"></a><span class="lineno"> 3175</span>   });</div>
<div class="line"><a id="l03176" name="l03176"></a><span class="lineno"> 3176</span>   <span class="keywordflow">return</span> version;</div>
<div class="line"><a id="l03177" name="l03177"></a><span class="lineno"> 3177</span>}</div>
</div>
<div class="line"><a id="l03178" name="l03178"></a><span class="lineno"> 3178</span> </div>
<div class="foldopen" id="foldopen03179" data-start="{" data-end="}">
<div class="line"><a id="l03179" name="l03179"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#ae0a1946cc6f7b87bd0cfa94bc9aa20b7"> 3179</a></span><span class="keyword">const</span> <a class="code hl_struct" href="structsysio_1_1chain_1_1producer__authority__schedule.html">producer_authority_schedule</a>&amp;    <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#ae0a1946cc6f7b87bd0cfa94bc9aa20b7">controller::active_producers</a>()<span class="keyword">const </span>{</div>
<div class="line"><a id="l03180" name="l03180"></a><span class="lineno"> 3180</span>   <span class="keywordflow">if</span>( !(my-&gt;pending) )</div>
<div class="line"><a id="l03181" name="l03181"></a><span class="lineno"> 3181</span>      <span class="keywordflow">return</span>  my-&gt;head-&gt;active_schedule;</div>
<div class="line"><a id="l03182" name="l03182"></a><span class="lineno"> 3182</span> </div>
<div class="line"><a id="l03183" name="l03183"></a><span class="lineno"> 3183</span>   <span class="keywordflow">if</span>( std::holds_alternative&lt;completed_block&gt;(my-&gt;pending-&gt;_block_stage) )</div>
<div class="line"><a id="l03184" name="l03184"></a><span class="lineno"> 3184</span>      <span class="keywordflow">return</span> std::get&lt;completed_block&gt;(my-&gt;pending-&gt;_block_stage)._block_state-&gt;active_schedule;</div>
<div class="line"><a id="l03185" name="l03185"></a><span class="lineno"> 3185</span> </div>
<div class="line"><a id="l03186" name="l03186"></a><span class="lineno"> 3186</span>   <span class="keywordflow">return</span> my-&gt;pending-&gt;get_pending_block_header_state().active_schedule;</div>
<div class="line"><a id="l03187" name="l03187"></a><span class="lineno"> 3187</span>}</div>
</div>
<div class="line"><a id="l03188" name="l03188"></a><span class="lineno"> 3188</span> </div>
<div class="foldopen" id="foldopen03189" data-start="{" data-end="}">
<div class="line"><a id="l03189" name="l03189"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a54645293859c265a7492eb002719c3dc"> 3189</a></span><span class="keyword">const</span> <a class="code hl_struct" href="structsysio_1_1chain_1_1producer__authority__schedule.html">producer_authority_schedule</a>&amp; <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a54645293859c265a7492eb002719c3dc">controller::pending_producers</a>()<span class="keyword">const </span>{</div>
<div class="line"><a id="l03190" name="l03190"></a><span class="lineno"> 3190</span>   <span class="keywordflow">if</span>( !(my-&gt;pending) )</div>
<div class="line"><a id="l03191" name="l03191"></a><span class="lineno"> 3191</span>      <span class="keywordflow">return</span>  my-&gt;head-&gt;pending_schedule.schedule;</div>
<div class="line"><a id="l03192" name="l03192"></a><span class="lineno"> 3192</span> </div>
<div class="line"><a id="l03193" name="l03193"></a><span class="lineno"> 3193</span>   <span class="keywordflow">if</span>( std::holds_alternative&lt;completed_block&gt;(my-&gt;pending-&gt;_block_stage) )</div>
<div class="line"><a id="l03194" name="l03194"></a><span class="lineno"> 3194</span>      <span class="keywordflow">return</span> std::get&lt;completed_block&gt;(my-&gt;pending-&gt;_block_stage)._block_state-&gt;pending_schedule.schedule;</div>
<div class="line"><a id="l03195" name="l03195"></a><span class="lineno"> 3195</span> </div>
<div class="line"><a id="l03196" name="l03196"></a><span class="lineno"> 3196</span>   <span class="keywordflow">if</span>( std::holds_alternative&lt;assembled_block&gt;(my-&gt;pending-&gt;_block_stage) ) {</div>
<div class="line"><a id="l03197" name="l03197"></a><span class="lineno"> 3197</span>      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; new_prods_cache = std::get&lt;assembled_block&gt;(my-&gt;pending-&gt;_block_stage)._new_producer_authority_cache;</div>
<div class="line"><a id="l03198" name="l03198"></a><span class="lineno"> 3198</span>      <span class="keywordflow">if</span>( new_prods_cache ) {</div>
<div class="line"><a id="l03199" name="l03199"></a><span class="lineno"> 3199</span>         <span class="keywordflow">return</span> *new_prods_cache;</div>
<div class="line"><a id="l03200" name="l03200"></a><span class="lineno"> 3200</span>      }</div>
<div class="line"><a id="l03201" name="l03201"></a><span class="lineno"> 3201</span>   }</div>
<div class="line"><a id="l03202" name="l03202"></a><span class="lineno"> 3202</span> </div>
<div class="line"><a id="l03203" name="l03203"></a><span class="lineno"> 3203</span>   <span class="keyword">const</span> <span class="keyword">auto</span>&amp; bb = std::get&lt;building_block&gt;(my-&gt;pending-&gt;_block_stage);</div>
<div class="line"><a id="l03204" name="l03204"></a><span class="lineno"> 3204</span> </div>
<div class="line"><a id="l03205" name="l03205"></a><span class="lineno"> 3205</span>   <span class="keywordflow">if</span>( bb._new_pending_producer_schedule )</div>
<div class="line"><a id="l03206" name="l03206"></a><span class="lineno"> 3206</span>      <span class="keywordflow">return</span> *bb._new_pending_producer_schedule;</div>
<div class="line"><a id="l03207" name="l03207"></a><span class="lineno"> 3207</span> </div>
<div class="line"><a id="l03208" name="l03208"></a><span class="lineno"> 3208</span>   <span class="keywordflow">return</span> bb._pending_block_header_state.prev_pending_schedule.schedule;</div>
<div class="line"><a id="l03209" name="l03209"></a><span class="lineno"> 3209</span>}</div>
</div>
<div class="line"><a id="l03210" name="l03210"></a><span class="lineno"> 3210</span> </div>
<div class="foldopen" id="foldopen03211" data-start="{" data-end="}">
<div class="line"><a id="l03211" name="l03211"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a3c16d661e137dbe654a1c40a972759d4"> 3211</a></span>std::optional&lt;producer_authority_schedule&gt; <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a3c16d661e137dbe654a1c40a972759d4">controller::proposed_producers</a>()<span class="keyword">const </span>{</div>
<div class="line"><a id="l03212" name="l03212"></a><span class="lineno"> 3212</span>   <span class="keyword">const</span> <span class="keyword">auto</span>&amp; gpo = <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a0bb11e832a05b6437c79bf81758b1b7d">get_global_properties</a>();</div>
<div class="line"><a id="l03213" name="l03213"></a><span class="lineno"> 3213</span>   <span class="keywordflow">if</span>( !gpo.proposed_schedule_block_num )</div>
<div class="line"><a id="l03214" name="l03214"></a><span class="lineno"> 3214</span>      <span class="keywordflow">return</span> std::optional&lt;producer_authority_schedule&gt;();</div>
<div class="line"><a id="l03215" name="l03215"></a><span class="lineno"> 3215</span> </div>
<div class="line"><a id="l03216" name="l03216"></a><span class="lineno"> 3216</span>   <span class="keywordflow">return</span> <a class="code hl_function" href="structsysio_1_1chain_1_1producer__authority__schedule.html#a4b0d95b22a8be15ac06dc3b105638c54">producer_authority_schedule::from_shared</a>(gpo.proposed_schedule);</div>
<div class="line"><a id="l03217" name="l03217"></a><span class="lineno"> 3217</span>}</div>
</div>
<div class="line"><a id="l03218" name="l03218"></a><span class="lineno"> 3218</span> </div>
<div class="foldopen" id="foldopen03219" data-start="{" data-end="}">
<div class="line"><a id="l03219" name="l03219"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a7109e865e8dee8629db47f2503e351df"> 3219</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a7109e865e8dee8629db47f2503e351df">controller::light_validation_allowed</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a id="l03220" name="l03220"></a><span class="lineno"> 3220</span>   <span class="keywordflow">if</span> (!my-&gt;pending || my-&gt;in_trx_requiring_checks) {</div>
<div class="line"><a id="l03221" name="l03221"></a><span class="lineno"> 3221</span>      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l03222" name="l03222"></a><span class="lineno"> 3222</span>   }</div>
<div class="line"><a id="l03223" name="l03223"></a><span class="lineno"> 3223</span> </div>
<div class="line"><a id="l03224" name="l03224"></a><span class="lineno"> 3224</span>   <span class="keyword">const</span> <span class="keyword">auto</span> pb_status = my-&gt;pending-&gt;_block_status;</div>
<div class="line"><a id="l03225" name="l03225"></a><span class="lineno"> 3225</span> </div>
<div class="line"><a id="l03226" name="l03226"></a><span class="lineno"> 3226</span>   <span class="comment">// in a pending irreversible or previously validated block and we have forcing all checks</span></div>
<div class="line"><a id="l03227" name="l03227"></a><span class="lineno"> 3227</span>   <span class="keyword">const</span> <span class="keywordtype">bool</span> consider_skipping_on_replay =</div>
<div class="line"><a id="l03228" name="l03228"></a><span class="lineno"> 3228</span>         (pb_status == <a class="code hl_enumvalue" href="classsysio_1_1chain_1_1controller.html#a8b5124e077de1a73bb193e9c72b366b6a7e6e4eb3ff27864637756cb4d2a2a45d">block_status::irreversible</a> || pb_status == <a class="code hl_enumvalue" href="classsysio_1_1chain_1_1controller.html#a8b5124e077de1a73bb193e9c72b366b6ac9e825f4641cd3bec0ba01a0c2d67755">block_status::validated</a>) &amp;&amp; !my-&gt;conf.force_all_checks;</div>
<div class="line"><a id="l03229" name="l03229"></a><span class="lineno"> 3229</span> </div>
<div class="line"><a id="l03230" name="l03230"></a><span class="lineno"> 3230</span>   <span class="comment">// OR in a signed block and in light validation mode</span></div>
<div class="line"><a id="l03231" name="l03231"></a><span class="lineno"> 3231</span>   <span class="keyword">const</span> <span class="keywordtype">bool</span> consider_skipping_on_validate = (pb_status == <a class="code hl_enumvalue" href="classsysio_1_1chain_1_1controller.html#a8b5124e077de1a73bb193e9c72b366b6ad9a22d7a8178d5b42a8750123cbfe5b1">block_status::complete</a> &amp;&amp;</div>
<div class="line"><a id="l03232" name="l03232"></a><span class="lineno"> 3232</span>         (my-&gt;conf.block_validation_mode == <a class="code hl_enumvalue" href="namespacesysio_1_1chain.html#a7d207c8c6bf978826102eca76da530e0af8589806bbf66241917092b2a6e18c6f">validation_mode::LIGHT</a> || my-&gt;trusted_producer_light_validation));</div>
<div class="line"><a id="l03233" name="l03233"></a><span class="lineno"> 3233</span> </div>
<div class="line"><a id="l03234" name="l03234"></a><span class="lineno"> 3234</span>   <span class="keywordflow">return</span> consider_skipping_on_replay || consider_skipping_on_validate;</div>
<div class="line"><a id="l03235" name="l03235"></a><span class="lineno"> 3235</span>}</div>
</div>
<div class="line"><a id="l03236" name="l03236"></a><span class="lineno"> 3236</span> </div>
<div class="line"><a id="l03237" name="l03237"></a><span class="lineno"> 3237</span> </div>
<div class="foldopen" id="foldopen03238" data-start="{" data-end="}">
<div class="line"><a id="l03238" name="l03238"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a42a29a059b847799ae3a75953b6bff1e"> 3238</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a42a29a059b847799ae3a75953b6bff1e">controller::skip_auth_check</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a id="l03239" name="l03239"></a><span class="lineno"> 3239</span>   <span class="keywordflow">return</span> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a7109e865e8dee8629db47f2503e351df">light_validation_allowed</a>();</div>
<div class="line"><a id="l03240" name="l03240"></a><span class="lineno"> 3240</span>}</div>
</div>
<div class="line"><a id="l03241" name="l03241"></a><span class="lineno"> 3241</span> </div>
<div class="foldopen" id="foldopen03242" data-start="{" data-end="}">
<div class="line"><a id="l03242" name="l03242"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#afc8b0aff5d6f215c336a682c83badf6e"> 3242</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#afc8b0aff5d6f215c336a682c83badf6e">controller::skip_trx_checks</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a id="l03243" name="l03243"></a><span class="lineno"> 3243</span>   <span class="keywordflow">return</span> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a7109e865e8dee8629db47f2503e351df">light_validation_allowed</a>();</div>
<div class="line"><a id="l03244" name="l03244"></a><span class="lineno"> 3244</span>}</div>
</div>
<div class="line"><a id="l03245" name="l03245"></a><span class="lineno"> 3245</span> </div>
<div class="foldopen" id="foldopen03246" data-start="{" data-end="}">
<div class="line"><a id="l03246" name="l03246"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a7cca9fe34a1d9811e0497c55596c16cb"> 3246</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#ac8eea0639eeef0fc0d304f645b80d884">controller::skip_db_sessions</a>( <a class="code hl_enumeration" href="classsysio_1_1chain_1_1controller.html#a8b5124e077de1a73bb193e9c72b366b6">block_status</a> bs )<span class="keyword"> const </span>{</div>
<div class="line"><a id="l03247" name="l03247"></a><span class="lineno"> 3247</span>   <span class="keywordtype">bool</span> consider_skipping = bs == <a class="code hl_enumvalue" href="classsysio_1_1chain_1_1controller.html#a8b5124e077de1a73bb193e9c72b366b6a7e6e4eb3ff27864637756cb4d2a2a45d">block_status::irreversible</a>;</div>
<div class="line"><a id="l03248" name="l03248"></a><span class="lineno"> 3248</span>   <span class="keywordflow">return</span> consider_skipping</div>
<div class="line"><a id="l03249" name="l03249"></a><span class="lineno"> 3249</span>      &amp;&amp; !my-&gt;conf.disable_replay_opts</div>
<div class="line"><a id="l03250" name="l03250"></a><span class="lineno"> 3250</span>      &amp;&amp; !my-&gt;in_trx_requiring_checks;</div>
<div class="line"><a id="l03251" name="l03251"></a><span class="lineno"> 3251</span>}</div>
</div>
<div class="line"><a id="l03252" name="l03252"></a><span class="lineno"> 3252</span> </div>
<div class="foldopen" id="foldopen03253" data-start="{" data-end="}">
<div class="line"><a id="l03253" name="l03253"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#ac8eea0639eeef0fc0d304f645b80d884"> 3253</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#ac8eea0639eeef0fc0d304f645b80d884">controller::skip_db_sessions</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a id="l03254" name="l03254"></a><span class="lineno"> 3254</span>   <span class="keywordflow">if</span> (my-&gt;pending) {</div>
<div class="line"><a id="l03255" name="l03255"></a><span class="lineno"> 3255</span>      <span class="keywordflow">return</span> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#ac8eea0639eeef0fc0d304f645b80d884">skip_db_sessions</a>(my-&gt;pending-&gt;_block_status);</div>
<div class="line"><a id="l03256" name="l03256"></a><span class="lineno"> 3256</span>   } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l03257" name="l03257"></a><span class="lineno"> 3257</span>      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l03258" name="l03258"></a><span class="lineno"> 3258</span>   }</div>
<div class="line"><a id="l03259" name="l03259"></a><span class="lineno"> 3259</span>}</div>
</div>
<div class="line"><a id="l03260" name="l03260"></a><span class="lineno"> 3260</span> </div>
<div class="foldopen" id="foldopen03261" data-start="{" data-end="}">
<div class="line"><a id="l03261" name="l03261"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a1196ffe0c4905238026e4923cf24cb3e"> 3261</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a1196ffe0c4905238026e4923cf24cb3e">controller::is_trusted_producer</a>( <span class="keyword">const</span> <a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">account_name</a>&amp; producer)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l03262" name="l03262"></a><span class="lineno"> 3262</span>   <span class="keywordflow">return</span> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a125b3c8fdc58904ce8179b68d1ea4172">get_validation_mode</a>() == <a class="code hl_enumvalue" href="namespacesysio_1_1chain.html#a7d207c8c6bf978826102eca76da530e0af8589806bbf66241917092b2a6e18c6f">chain::validation_mode::LIGHT</a> || my-&gt;conf.trusted_producers.count(producer);</div>
<div class="line"><a id="l03263" name="l03263"></a><span class="lineno"> 3263</span>}</div>
</div>
<div class="line"><a id="l03264" name="l03264"></a><span class="lineno"> 3264</span> </div>
<div class="foldopen" id="foldopen03265" data-start="{" data-end="}">
<div class="line"><a id="l03265" name="l03265"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#afb3840481287ef2685e61375a44b0305"> 3265</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#afb3840481287ef2685e61375a44b0305">controller::contracts_console</a>()<span class="keyword">const </span>{</div>
<div class="line"><a id="l03266" name="l03266"></a><span class="lineno"> 3266</span>   <span class="keywordflow">return</span> my-&gt;conf.contracts_console;</div>
<div class="line"><a id="l03267" name="l03267"></a><span class="lineno"> 3267</span>}</div>
</div>
<div class="line"><a id="l03268" name="l03268"></a><span class="lineno"> 3268</span> </div>
<div class="foldopen" id="foldopen03269" data-start="{" data-end="}">
<div class="line"><a id="l03269" name="l03269"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a449c46cd54dde8387e020cc86a2f1d41"> 3269</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a449c46cd54dde8387e020cc86a2f1d41">controller::is_profiling</a>(<a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">account_name</a> account)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l03270" name="l03270"></a><span class="lineno"> 3270</span>   <span class="keywordflow">return</span> my-&gt;conf.profile_accounts.find(account) != my-&gt;conf.profile_accounts.end();</div>
<div class="line"><a id="l03271" name="l03271"></a><span class="lineno"> 3271</span>}</div>
</div>
<div class="line"><a id="l03272" name="l03272"></a><span class="lineno"> 3272</span> </div>
<div class="foldopen" id="foldopen03273" data-start="{" data-end="}">
<div class="line"><a id="l03273" name="l03273"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#aa62c0e462ac0a8c8b3345e59623ffad0"> 3273</a></span><a class="code hl_struct" href="structsysio_1_1chain_1_1chain__id__type.html">chain_id_type</a> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#aa62c0e462ac0a8c8b3345e59623ffad0">controller::get_chain_id</a>()<span class="keyword">const </span>{</div>
<div class="line"><a id="l03274" name="l03274"></a><span class="lineno"> 3274</span>   <span class="keywordflow">return</span> my-&gt;chain_id;</div>
<div class="line"><a id="l03275" name="l03275"></a><span class="lineno"> 3275</span>}</div>
</div>
<div class="line"><a id="l03276" name="l03276"></a><span class="lineno"> 3276</span> </div>
<div class="foldopen" id="foldopen03277" data-start="{" data-end="}">
<div class="line"><a id="l03277" name="l03277"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a28d33629f3badcb8155c08be3e05b99e"> 3277</a></span><a class="code hl_enumeration" href="namespacesysio_1_1chain.html#af3e35f3e1b78dd00fa247009a2d9ba5e">db_read_mode</a> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a28d33629f3badcb8155c08be3e05b99e">controller::get_read_mode</a>()<span class="keyword">const </span>{</div>
<div class="line"><a id="l03278" name="l03278"></a><span class="lineno"> 3278</span>   <span class="keywordflow">return</span> my-&gt;read_mode;</div>
<div class="line"><a id="l03279" name="l03279"></a><span class="lineno"> 3279</span>}</div>
</div>
<div class="line"><a id="l03280" name="l03280"></a><span class="lineno"> 3280</span> </div>
<div class="foldopen" id="foldopen03281" data-start="{" data-end="}">
<div class="line"><a id="l03281" name="l03281"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a125b3c8fdc58904ce8179b68d1ea4172"> 3281</a></span><a class="code hl_enumeration" href="namespacesysio_1_1chain.html#a7d207c8c6bf978826102eca76da530e0">validation_mode</a> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a125b3c8fdc58904ce8179b68d1ea4172">controller::get_validation_mode</a>()<span class="keyword">const </span>{</div>
<div class="line"><a id="l03282" name="l03282"></a><span class="lineno"> 3282</span>   <span class="keywordflow">return</span> my-&gt;conf.block_validation_mode;</div>
<div class="line"><a id="l03283" name="l03283"></a><span class="lineno"> 3283</span>}</div>
</div>
<div class="line"><a id="l03284" name="l03284"></a><span class="lineno"> 3284</span> </div>
<div class="foldopen" id="foldopen03285" data-start="{" data-end="}">
<div class="line"><a id="l03285" name="l03285"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a8b86f2ee0fa63f9d01ee437f83b0e1d1"> 3285</a></span><a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a8b86f2ee0fa63f9d01ee437f83b0e1d1">controller::get_terminate_at_block</a>()<span class="keyword">const </span>{</div>
<div class="line"><a id="l03286" name="l03286"></a><span class="lineno"> 3286</span>   <span class="keywordflow">return</span> my-&gt;conf.terminate_at_block;</div>
<div class="line"><a id="l03287" name="l03287"></a><span class="lineno"> 3287</span>}</div>
</div>
<div class="line"><a id="l03288" name="l03288"></a><span class="lineno"> 3288</span> </div>
<div class="foldopen" id="foldopen03289" data-start="{" data-end="}">
<div class="line"><a id="l03289" name="l03289"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a4a2e2a5327580a667b803e3bf3ce5f82"> 3289</a></span><span class="keyword">const</span> <a class="code hl_typedef" href="namespacesysio_1_1chain.html#ab143988ae1cae85e839b01eb768804c3">apply_handler</a>* <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a4a2e2a5327580a667b803e3bf3ce5f82">controller::find_apply_handler</a>( <a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">account_name</a> receiver, <a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">account_name</a> scope, <a class="code hl_typedef" href="namespacesysio_1_1chain.html#a7a1685bcc352cda9e45f055932069428">action_name</a> act )<span class="keyword"> const</span></div>
<div class="line"><a id="l03290" name="l03290"></a><span class="lineno"> 3290</span><span class="keyword"></span>{</div>
<div class="line"><a id="l03291" name="l03291"></a><span class="lineno"> 3291</span>   <span class="keyword">auto</span> native_handler_scope = my-&gt;apply_handlers.find( receiver );</div>
<div class="line"><a id="l03292" name="l03292"></a><span class="lineno"> 3292</span>   <span class="keywordflow">if</span>( native_handler_scope != my-&gt;apply_handlers.end() ) {</div>
<div class="line"><a id="l03293" name="l03293"></a><span class="lineno"> 3293</span>      <span class="keyword">auto</span> handler = native_handler_scope-&gt;second.find( make_pair( scope, act ) );</div>
<div class="line"><a id="l03294" name="l03294"></a><span class="lineno"> 3294</span>      <span class="keywordflow">if</span>( handler != native_handler_scope-&gt;second.end() )</div>
<div class="line"><a id="l03295" name="l03295"></a><span class="lineno"> 3295</span>         <span class="keywordflow">return</span> &amp;handler-&gt;second;</div>
<div class="line"><a id="l03296" name="l03296"></a><span class="lineno"> 3296</span>   }</div>
<div class="line"><a id="l03297" name="l03297"></a><span class="lineno"> 3297</span>   <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l03298" name="l03298"></a><span class="lineno"> 3298</span>}</div>
</div>
<div class="foldopen" id="foldopen03299" data-start="{" data-end="}">
<div class="line"><a id="l03299" name="l03299"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a888b36bb7d737244a2b200375b199247"> 3299</a></span><a class="code hl_class" href="classsysio_1_1chain_1_1wasm__interface.html">wasm_interface</a>&amp; <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a888b36bb7d737244a2b200375b199247">controller::get_wasm_interface</a>() {</div>
<div class="line"><a id="l03300" name="l03300"></a><span class="lineno"> 3300</span>   <span class="keywordflow">return</span> my-&gt;wasmif;</div>
<div class="line"><a id="l03301" name="l03301"></a><span class="lineno"> 3301</span>}</div>
</div>
<div class="line"><a id="l03302" name="l03302"></a><span class="lineno"> 3302</span> </div>
<div class="foldopen" id="foldopen03303" data-start="{" data-end="}">
<div class="line"><a id="l03303" name="l03303"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#aae65799cffdae12a65e38811b0c4d8b6"> 3303</a></span><span class="keyword">const</span> <a class="code hl_class" href="classsysio_1_1chain_1_1account__object.html">account_object</a>&amp; <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#aae65799cffdae12a65e38811b0c4d8b6">controller::get_account</a>( <a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">account_name</a> <a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">name</a> )<span class="keyword">const</span></div>
<div class="line"><a id="l03304" name="l03304"></a><span class="lineno"> 3304</span><span class="keyword"></span>{ <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l03305" name="l03305"></a><span class="lineno"> 3305</span>   <span class="keywordflow">return</span> my-&gt;db.get&lt;<a class="code hl_class" href="classsysio_1_1chain_1_1account__object.html">account_object</a>, by_name&gt;(<a class="code hl_variable" href="catch__reporter__console_8cpp.html#a9b45b3e13bd9167aab02e17e08916231">name</a>);</div>
<div class="line"><a id="l03306" name="l03306"></a><span class="lineno"> 3306</span>} <a class="code hl_define" href="exception_8hpp.html#a094902280cad82ad6529ebbd12a697eb">FC_CAPTURE_AND_RETHROW</a>( (<a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">name</a>) ) }</div>
</div>
<div class="line"><a id="l03307" name="l03307"></a><span class="lineno"> 3307</span> </div>
<div class="foldopen" id="foldopen03308" data-start="{" data-end="}">
<div class="line"><a id="l03308" name="l03308"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#aa82f197374a4e96fd3e952e18106eae9"> 3308</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#aa82f197374a4e96fd3e952e18106eae9">controller::sender_avoids_whitelist_blacklist_enforcement</a>( <a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">account_name</a> sender )<span class="keyword">const </span>{</div>
<div class="line"><a id="l03309" name="l03309"></a><span class="lineno"> 3309</span>   <span class="keywordflow">return</span> my-&gt;sender_avoids_whitelist_blacklist_enforcement( sender );</div>
<div class="line"><a id="l03310" name="l03310"></a><span class="lineno"> 3310</span>}</div>
</div>
<div class="line"><a id="l03311" name="l03311"></a><span class="lineno"> 3311</span> </div>
<div class="foldopen" id="foldopen03312" data-start="{" data-end="}">
<div class="line"><a id="l03312" name="l03312"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#aa378f4265708c1bc41e4ee058ed71e6a"> 3312</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#aa378f4265708c1bc41e4ee058ed71e6a">controller::check_actor_list</a>( <span class="keyword">const</span> flat_set&lt;account_name&gt;&amp; actors )<span class="keyword">const </span>{</div>
<div class="line"><a id="l03313" name="l03313"></a><span class="lineno"> 3313</span>   my-&gt;check_actor_list( actors );</div>
<div class="line"><a id="l03314" name="l03314"></a><span class="lineno"> 3314</span>}</div>
</div>
<div class="line"><a id="l03315" name="l03315"></a><span class="lineno"> 3315</span> </div>
<div class="foldopen" id="foldopen03316" data-start="{" data-end="}">
<div class="line"><a id="l03316" name="l03316"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#affb3f9edd37be65bd34a4d6a783051c0"> 3316</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#affb3f9edd37be65bd34a4d6a783051c0">controller::check_contract_list</a>( <a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">account_name</a> code )<span class="keyword">const </span>{</div>
<div class="line"><a id="l03317" name="l03317"></a><span class="lineno"> 3317</span>   my-&gt;check_contract_list( code );</div>
<div class="line"><a id="l03318" name="l03318"></a><span class="lineno"> 3318</span>}</div>
</div>
<div class="line"><a id="l03319" name="l03319"></a><span class="lineno"> 3319</span> </div>
<div class="foldopen" id="foldopen03320" data-start="{" data-end="}">
<div class="line"><a id="l03320" name="l03320"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a0884a15f8a10b5a0037601289908a0d9"> 3320</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a0884a15f8a10b5a0037601289908a0d9">controller::check_action_list</a>( <a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">account_name</a> code, <a class="code hl_typedef" href="namespacesysio_1_1chain.html#a7a1685bcc352cda9e45f055932069428">action_name</a> <a class="code hl_struct" href="structsysio_1_1chain_1_1action.html">action</a> )<span class="keyword">const </span>{</div>
<div class="line"><a id="l03321" name="l03321"></a><span class="lineno"> 3321</span>   my-&gt;check_action_list( code, <a class="code hl_struct" href="structsysio_1_1chain_1_1action.html">action</a> );</div>
<div class="line"><a id="l03322" name="l03322"></a><span class="lineno"> 3322</span>}</div>
</div>
<div class="line"><a id="l03323" name="l03323"></a><span class="lineno"> 3323</span> </div>
<div class="foldopen" id="foldopen03324" data-start="{" data-end="}">
<div class="line"><a id="l03324" name="l03324"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#aa26307ee72e8095e9125f086ea570be9"> 3324</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#aa26307ee72e8095e9125f086ea570be9">controller::check_key_list</a>( <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1crypto_1_1public__key.html">public_key_type</a>&amp; key )<span class="keyword">const </span>{</div>
<div class="line"><a id="l03325" name="l03325"></a><span class="lineno"> 3325</span>   my-&gt;check_key_list( key );</div>
<div class="line"><a id="l03326" name="l03326"></a><span class="lineno"> 3326</span>}</div>
</div>
<div class="line"><a id="l03327" name="l03327"></a><span class="lineno"> 3327</span> </div>
<div class="foldopen" id="foldopen03328" data-start="{" data-end="}">
<div class="line"><a id="l03328" name="l03328"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a286751cd6498b500b70a0d3678672263"> 3328</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a286751cd6498b500b70a0d3678672263">controller::is_building_block</a>()<span class="keyword">const </span>{</div>
<div class="line"><a id="l03329" name="l03329"></a><span class="lineno"> 3329</span>   <span class="keywordflow">return</span> my-&gt;pending.has_value();</div>
<div class="line"><a id="l03330" name="l03330"></a><span class="lineno"> 3330</span>}</div>
</div>
<div class="line"><a id="l03331" name="l03331"></a><span class="lineno"> 3331</span> </div>
<div class="foldopen" id="foldopen03332" data-start="{" data-end="}">
<div class="line"><a id="l03332" name="l03332"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a0fcc85a590581560765686050fe105a8"> 3332</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a0fcc85a590581560765686050fe105a8">controller::is_producing_block</a>()<span class="keyword">const </span>{</div>
<div class="line"><a id="l03333" name="l03333"></a><span class="lineno"> 3333</span>   <span class="keywordflow">if</span>( !my-&gt;pending ) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l03334" name="l03334"></a><span class="lineno"> 3334</span> </div>
<div class="line"><a id="l03335" name="l03335"></a><span class="lineno"> 3335</span>   <span class="keywordflow">return</span> (my-&gt;pending-&gt;_block_status == <a class="code hl_enumvalue" href="classsysio_1_1chain_1_1controller.html#a8b5124e077de1a73bb193e9c72b366b6a5ed4e9858ad8d239145ef285b6210a00">block_status::incomplete</a>);</div>
<div class="line"><a id="l03336" name="l03336"></a><span class="lineno"> 3336</span>}</div>
</div>
<div class="line"><a id="l03337" name="l03337"></a><span class="lineno"> 3337</span> </div>
<div class="foldopen" id="foldopen03338" data-start="{" data-end="}">
<div class="line"><a id="l03338" name="l03338"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a4afbf4e4448a73468eb6947b68a0c348"> 3338</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a4afbf4e4448a73468eb6947b68a0c348">controller::is_ram_billing_in_notify_allowed</a>()<span class="keyword">const </span>{</div>
<div class="line"><a id="l03339" name="l03339"></a><span class="lineno"> 3339</span>   <span class="keywordflow">return</span> my-&gt;conf.disable_all_subjective_mitigations || !<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a0fcc85a590581560765686050fe105a8">is_producing_block</a>() || my-&gt;conf.allow_ram_billing_in_notify;</div>
<div class="line"><a id="l03340" name="l03340"></a><span class="lineno"> 3340</span>}</div>
</div>
<div class="line"><a id="l03341" name="l03341"></a><span class="lineno"> 3341</span> </div>
<div class="foldopen" id="foldopen03342" data-start="{" data-end="}">
<div class="line"><a id="l03342" name="l03342"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a701a2bfcee8df0244e1a8ac8900bc657"> 3342</a></span><a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a701a2bfcee8df0244e1a8ac8900bc657">controller::configured_subjective_signature_length_limit</a>()<span class="keyword">const </span>{</div>
<div class="line"><a id="l03343" name="l03343"></a><span class="lineno"> 3343</span>   <span class="keywordflow">return</span> my-&gt;conf.maximum_variable_signature_length;</div>
<div class="line"><a id="l03344" name="l03344"></a><span class="lineno"> 3344</span>}</div>
</div>
<div class="line"><a id="l03345" name="l03345"></a><span class="lineno"> 3345</span> </div>
<div class="foldopen" id="foldopen03346" data-start="{" data-end="}">
<div class="line"><a id="l03346" name="l03346"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a3c9f983e8d4aba41afbb0a473feca18f"> 3346</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a3c9f983e8d4aba41afbb0a473feca18f">controller::validate_expiration</a>( <span class="keyword">const</span> <a class="code hl_struct" href="structsysio_1_1chain_1_1transaction.html">transaction</a>&amp; trx )<span class="keyword">const </span>{ <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l03347" name="l03347"></a><span class="lineno"> 3347</span>   <span class="keyword">const</span> <span class="keyword">auto</span>&amp; chain_configuration = <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a0bb11e832a05b6437c79bf81758b1b7d">get_global_properties</a>().<a class="code hl_variable" href="classsysio_1_1chain_1_1global__property__object.html#a7f149fcf87034217c899838eb4430496">configuration</a>;</div>
<div class="line"><a id="l03348" name="l03348"></a><span class="lineno"> 3348</span> </div>
<div class="line"><a id="l03349" name="l03349"></a><span class="lineno"> 3349</span>   <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( <a class="code hl_class" href="classfc_1_1time__point.html">time_point</a>(trx.<a class="code hl_variable" href="structsysio_1_1chain_1_1transaction__header.html#ad1ed2586e8ace769fdb9a54d09a752ce">expiration</a>) &gt;= <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#abb1d81f96986df3bce46bd37caaf6a69">pending_block_time</a>(),</div>
<div class="line"><a id="l03350" name="l03350"></a><span class="lineno"> 3350</span>               expired_tx_exception,</div>
<div class="line"><a id="l03351" name="l03351"></a><span class="lineno"> 3351</span>               <span class="stringliteral">&quot;transaction has expired, &quot;</span></div>
<div class="line"><a id="l03352" name="l03352"></a><span class="lineno"> 3352</span>               <span class="stringliteral">&quot;expiration is ${trx.expiration} and pending block time is ${pending_block_time}&quot;</span>,</div>
<div class="line"><a id="l03353" name="l03353"></a><span class="lineno"> 3353</span>               (<span class="stringliteral">&quot;trx.expiration&quot;</span>,trx.<a class="code hl_variable" href="structsysio_1_1chain_1_1transaction__header.html#ad1ed2586e8ace769fdb9a54d09a752ce">expiration</a>)(<span class="stringliteral">&quot;pending_block_time&quot;</span>,<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#abb1d81f96986df3bce46bd37caaf6a69">pending_block_time</a>()));</div>
<div class="line"><a id="l03354" name="l03354"></a><span class="lineno"> 3354</span>   <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( <a class="code hl_class" href="classfc_1_1time__point.html">time_point</a>(trx.<a class="code hl_variable" href="structsysio_1_1chain_1_1transaction__header.html#ad1ed2586e8ace769fdb9a54d09a752ce">expiration</a>) &lt;= <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#abb1d81f96986df3bce46bd37caaf6a69">pending_block_time</a>() + <a class="code hl_function" href="namespacefc.html#a9623b8cae3f48bbed6aa1fc2afe9b174">fc::seconds</a>(chain_configuration.max_transaction_lifetime),</div>
<div class="line"><a id="l03355" name="l03355"></a><span class="lineno"> 3355</span>               tx_exp_too_far_exception,</div>
<div class="line"><a id="l03356" name="l03356"></a><span class="lineno"> 3356</span>               <span class="stringliteral">&quot;Transaction expiration is too far in the future relative to the reference time of ${reference_time}, &quot;</span></div>
<div class="line"><a id="l03357" name="l03357"></a><span class="lineno"> 3357</span>               <span class="stringliteral">&quot;expiration is ${trx.expiration} and the maximum transaction lifetime is ${max_til_exp} seconds&quot;</span>,</div>
<div class="line"><a id="l03358" name="l03358"></a><span class="lineno"> 3358</span>               (<span class="stringliteral">&quot;trx.expiration&quot;</span>,trx.<a class="code hl_variable" href="structsysio_1_1chain_1_1transaction__header.html#ad1ed2586e8ace769fdb9a54d09a752ce">expiration</a>)(<span class="stringliteral">&quot;reference_time&quot;</span>,<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#abb1d81f96986df3bce46bd37caaf6a69">pending_block_time</a>())</div>
<div class="line"><a id="l03359" name="l03359"></a><span class="lineno"> 3359</span>               (<span class="stringliteral">&quot;max_til_exp&quot;</span>,chain_configuration.max_transaction_lifetime) );</div>
<div class="line"><a id="l03360" name="l03360"></a><span class="lineno"> 3360</span>} <a class="code hl_define" href="exception_8hpp.html#a094902280cad82ad6529ebbd12a697eb">FC_CAPTURE_AND_RETHROW</a>((trx)) }</div>
</div>
<div class="line"><a id="l03361" name="l03361"></a><span class="lineno"> 3361</span> </div>
<div class="foldopen" id="foldopen03362" data-start="{" data-end="}">
<div class="line"><a id="l03362" name="l03362"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a92e84ef71388fa365bcf17a4fbcce047"> 3362</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a92e84ef71388fa365bcf17a4fbcce047">controller::validate_tapos</a>( <span class="keyword">const</span> <a class="code hl_struct" href="structsysio_1_1chain_1_1transaction.html">transaction</a>&amp; trx )<span class="keyword">const </span>{ <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l03363" name="l03363"></a><span class="lineno"> 3363</span>   <span class="keyword">const</span> <span class="keyword">auto</span>&amp; tapos_block_summary = <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a0c79d00dae8c0d90efc18f4d091b2391">db</a>().<a class="code hl_function" href="classchainbase_1_1database.html#afcfe00f81a526c1376d4f51197dd3a9a">get</a>&lt;<a class="code hl_class" href="classsysio_1_1chain_1_1block__summary__object.html">block_summary_object</a>&gt;((<a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a>)trx.<a class="code hl_variable" href="structsysio_1_1chain_1_1transaction__header.html#a459d803b930351f4a1565d9c082debea">ref_block_num</a>);</div>
<div class="line"><a id="l03364" name="l03364"></a><span class="lineno"> 3364</span> </div>
<div class="line"><a id="l03365" name="l03365"></a><span class="lineno"> 3365</span>   <span class="comment">//Verify TaPoS block summary has correct ID prefix, and that this block&#39;s time is not past the expiration</span></div>
<div class="line"><a id="l03366" name="l03366"></a><span class="lineno"> 3366</span>   <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>(trx.<a class="code hl_function" href="structsysio_1_1chain_1_1transaction__header.html#a92adbf497323e601b30eb8475881fb52">verify_reference_block</a>(tapos_block_summary.block_id), invalid_ref_block_exception,</div>
<div class="line"><a id="l03367" name="l03367"></a><span class="lineno"> 3367</span>              <span class="stringliteral">&quot;Transaction&#39;s reference block did not match. Is this transaction from a different fork?&quot;</span>,</div>
<div class="line"><a id="l03368" name="l03368"></a><span class="lineno"> 3368</span>              (<span class="stringliteral">&quot;tapos_summary&quot;</span>, tapos_block_summary));</div>
<div class="line"><a id="l03369" name="l03369"></a><span class="lineno"> 3369</span>} <a class="code hl_define" href="exception_8hpp.html#a094902280cad82ad6529ebbd12a697eb">FC_CAPTURE_AND_RETHROW</a>() }</div>
</div>
<div class="line"><a id="l03370" name="l03370"></a><span class="lineno"> 3370</span> </div>
<div class="foldopen" id="foldopen03371" data-start="{" data-end="}">
<div class="line"><a id="l03371" name="l03371"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a7b2f18a21e18a1bdc6837a567bb259eb"> 3371</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a7b2f18a21e18a1bdc6837a567bb259eb">controller::validate_db_available_size</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a id="l03372" name="l03372"></a><span class="lineno"> 3372</span>   <span class="keyword">const</span> <span class="keyword">auto</span> free = <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a0c79d00dae8c0d90efc18f4d091b2391">db</a>().<a class="code hl_function" href="classchainbase_1_1database.html#a64133afb9e0ae374eeab86bd1d4db08b">get_segment_manager</a>()-&gt;get_free_memory();</div>
<div class="line"><a id="l03373" name="l03373"></a><span class="lineno"> 3373</span>   <span class="keyword">const</span> <span class="keyword">auto</span> guard = my-&gt;conf.state_guard_size;</div>
<div class="line"><a id="l03374" name="l03374"></a><span class="lineno"> 3374</span>   <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>(free &gt;= guard, database_guard_exception, <span class="stringliteral">&quot;database free: ${f}, guard size: ${g}&quot;</span>, (<span class="stringliteral">&quot;f&quot;</span>, free)(<span class="stringliteral">&quot;g&quot;</span>,guard));</div>
<div class="line"><a id="l03375" name="l03375"></a><span class="lineno"> 3375</span>}</div>
</div>
<div class="line"><a id="l03376" name="l03376"></a><span class="lineno"> 3376</span> </div>
<div class="foldopen" id="foldopen03377" data-start="{" data-end="}">
<div class="line"><a id="l03377" name="l03377"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a0ab467ff13b82630da7533410a8131c3"> 3377</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a0ab467ff13b82630da7533410a8131c3">controller::is_protocol_feature_activated</a>( <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1sha256.html">digest_type</a>&amp; feature_digest )<span class="keyword">const </span>{</div>
<div class="line"><a id="l03378" name="l03378"></a><span class="lineno"> 3378</span>   <span class="keywordflow">if</span>( my-&gt;pending )</div>
<div class="line"><a id="l03379" name="l03379"></a><span class="lineno"> 3379</span>      <span class="keywordflow">return</span> my-&gt;pending-&gt;is_protocol_feature_activated( feature_digest );</div>
<div class="line"><a id="l03380" name="l03380"></a><span class="lineno"> 3380</span> </div>
<div class="line"><a id="l03381" name="l03381"></a><span class="lineno"> 3381</span>   <span class="keyword">const</span> <span class="keyword">auto</span>&amp; activated_features = my-&gt;head-&gt;activated_protocol_features-&gt;protocol_features;</div>
<div class="line"><a id="l03382" name="l03382"></a><span class="lineno"> 3382</span>   <span class="keywordflow">return</span> (activated_features.find( feature_digest ) != activated_features.end());</div>
<div class="line"><a id="l03383" name="l03383"></a><span class="lineno"> 3383</span>}</div>
</div>
<div class="line"><a id="l03384" name="l03384"></a><span class="lineno"> 3384</span> </div>
<div class="foldopen" id="foldopen03385" data-start="{" data-end="}">
<div class="line"><a id="l03385" name="l03385"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#aa808acf858e93c567ff983ccbf8fb6d3"> 3385</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#aa808acf858e93c567ff983ccbf8fb6d3">controller::is_builtin_activated</a>( <a class="code hl_enumeration" href="namespacesysio_1_1chain.html#a406d45a184cdba0af316b5bf34bf56cf">builtin_protocol_feature_t</a> <a class="code hl_variable" href="_x02-_disabled_macros_8cpp.html#ae28240b98d91d6eb7da702b770490f39">f</a> )<span class="keyword">const </span>{</div>
<div class="line"><a id="l03386" name="l03386"></a><span class="lineno"> 3386</span>   <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> current_block_num = <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a33704b4936bb9bbd2ea6b0874ca521b4">head_block_num</a>();</div>
<div class="line"><a id="l03387" name="l03387"></a><span class="lineno"> 3387</span> </div>
<div class="line"><a id="l03388" name="l03388"></a><span class="lineno"> 3388</span>   <span class="keywordflow">if</span>( my-&gt;pending ) {</div>
<div class="line"><a id="l03389" name="l03389"></a><span class="lineno"> 3389</span>      ++current_block_num;</div>
<div class="line"><a id="l03390" name="l03390"></a><span class="lineno"> 3390</span>   }</div>
<div class="line"><a id="l03391" name="l03391"></a><span class="lineno"> 3391</span> </div>
<div class="line"><a id="l03392" name="l03392"></a><span class="lineno"> 3392</span>   <span class="keywordflow">return</span> my-&gt;protocol_features.is_builtin_activated( <a class="code hl_variable" href="_x02-_disabled_macros_8cpp.html#ae28240b98d91d6eb7da702b770490f39">f</a>, current_block_num );</div>
<div class="line"><a id="l03393" name="l03393"></a><span class="lineno"> 3393</span>}</div>
</div>
<div class="line"><a id="l03394" name="l03394"></a><span class="lineno"> 3394</span> </div>
<div class="foldopen" id="foldopen03395" data-start="{" data-end="}">
<div class="line"><a id="l03395" name="l03395"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#ad5e154b110a034f3a6430f7827e9c4b3"> 3395</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#ad5e154b110a034f3a6430f7827e9c4b3">controller::is_known_unexpired_transaction</a>( <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1sha256.html">transaction_id_type</a>&amp; <span class="keywordtype">id</span>)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l03396" name="l03396"></a><span class="lineno"> 3396</span>   <span class="keywordflow">return</span> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a0c79d00dae8c0d90efc18f4d091b2391">db</a>().<a class="code hl_function" href="classchainbase_1_1database.html#aa5a2ca0da0092693ac49b36b7ec6817a">find</a>&lt;<a class="code hl_class" href="classsysio_1_1chain_1_1transaction__object.html">transaction_object</a>, by_trx_id&gt;(<a class="code hl_variable" href="code__cache_8cpp.html#aa0efefe21f4700d78692edc823e763be">id</a>);</div>
<div class="line"><a id="l03397" name="l03397"></a><span class="lineno"> 3397</span>}</div>
</div>
<div class="line"><a id="l03398" name="l03398"></a><span class="lineno"> 3398</span> </div>
<div class="foldopen" id="foldopen03399" data-start="{" data-end="}">
<div class="line"><a id="l03399" name="l03399"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#ac8d3310c59100f18efeb9a7007a21103"> 3399</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#ac8d3310c59100f18efeb9a7007a21103">controller::set_subjective_cpu_leeway</a>(<a class="code hl_class" href="classfc_1_1microseconds.html">fc::microseconds</a> leeway) {</div>
<div class="line"><a id="l03400" name="l03400"></a><span class="lineno"> 3400</span>   my-&gt;subjective_cpu_leeway = leeway;</div>
<div class="line"><a id="l03401" name="l03401"></a><span class="lineno"> 3401</span>}</div>
</div>
<div class="line"><a id="l03402" name="l03402"></a><span class="lineno"> 3402</span> </div>
<div class="foldopen" id="foldopen03403" data-start="{" data-end="}">
<div class="line"><a id="l03403" name="l03403"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#af234ccfa5634942083d52efa1ff5a2ae"> 3403</a></span>std::optional&lt;fc::microseconds&gt; <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#af234ccfa5634942083d52efa1ff5a2ae">controller::get_subjective_cpu_leeway</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a id="l03404" name="l03404"></a><span class="lineno"> 3404</span>    <span class="keywordflow">return</span> my-&gt;subjective_cpu_leeway;</div>
<div class="line"><a id="l03405" name="l03405"></a><span class="lineno"> 3405</span>}</div>
</div>
<div class="line"><a id="l03406" name="l03406"></a><span class="lineno"> 3406</span> </div>
<div class="foldopen" id="foldopen03407" data-start="{" data-end="}">
<div class="line"><a id="l03407" name="l03407"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a03d5ea18c641a8899af9bdbdf9da9f81"> 3407</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a03d5ea18c641a8899af9bdbdf9da9f81">controller::set_greylist_limit</a>( <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> limit ) {</div>
<div class="line"><a id="l03408" name="l03408"></a><span class="lineno"> 3408</span>   <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( 0 &lt; limit &amp;&amp; limit &lt;= chain::config::maximum_elastic_resource_multiplier,</div>
<div class="line"><a id="l03409" name="l03409"></a><span class="lineno"> 3409</span>               misc_exception,</div>
<div class="line"><a id="l03410" name="l03410"></a><span class="lineno"> 3410</span>               <span class="stringliteral">&quot;Invalid limit (${limit}) passed into set_greylist_limit. &quot;</span></div>
<div class="line"><a id="l03411" name="l03411"></a><span class="lineno"> 3411</span>               <span class="stringliteral">&quot;Must be between 1 and ${max}.&quot;</span>,</div>
<div class="line"><a id="l03412" name="l03412"></a><span class="lineno"> 3412</span>               (<span class="stringliteral">&quot;limit&quot;</span>, limit)(<span class="stringliteral">&quot;max&quot;</span>, chain::config::maximum_elastic_resource_multiplier)</div>
<div class="line"><a id="l03413" name="l03413"></a><span class="lineno"> 3413</span>   );</div>
<div class="line"><a id="l03414" name="l03414"></a><span class="lineno"> 3414</span>   my-&gt;conf.greylist_limit = limit;</div>
<div class="line"><a id="l03415" name="l03415"></a><span class="lineno"> 3415</span>}</div>
</div>
<div class="line"><a id="l03416" name="l03416"></a><span class="lineno"> 3416</span> </div>
<div class="foldopen" id="foldopen03417" data-start="{" data-end="}">
<div class="line"><a id="l03417" name="l03417"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a9d7c53697f9d587b6f2e583af9f7e712"> 3417</a></span><a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a9d7c53697f9d587b6f2e583af9f7e712">controller::get_greylist_limit</a>()<span class="keyword">const </span>{</div>
<div class="line"><a id="l03418" name="l03418"></a><span class="lineno"> 3418</span>   <span class="keywordflow">return</span> my-&gt;conf.greylist_limit;</div>
<div class="line"><a id="l03419" name="l03419"></a><span class="lineno"> 3419</span>}</div>
</div>
<div class="line"><a id="l03420" name="l03420"></a><span class="lineno"> 3420</span> </div>
<div class="foldopen" id="foldopen03421" data-start="{" data-end="}">
<div class="line"><a id="l03421" name="l03421"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#ad0b710fd894bc8c7265b7e8c958df7bc"> 3421</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#ad0b710fd894bc8c7265b7e8c958df7bc">controller::add_resource_greylist</a>(<span class="keyword">const</span> <a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">account_name</a> &amp;<a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">name</a>) {</div>
<div class="line"><a id="l03422" name="l03422"></a><span class="lineno"> 3422</span>   my-&gt;conf.resource_greylist.insert(<a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">name</a>);</div>
<div class="line"><a id="l03423" name="l03423"></a><span class="lineno"> 3423</span>}</div>
</div>
<div class="line"><a id="l03424" name="l03424"></a><span class="lineno"> 3424</span> </div>
<div class="foldopen" id="foldopen03425" data-start="{" data-end="}">
<div class="line"><a id="l03425" name="l03425"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a9ebce710613bffd9b019b8d9fc15d20e"> 3425</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a9ebce710613bffd9b019b8d9fc15d20e">controller::remove_resource_greylist</a>(<span class="keyword">const</span> <a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">account_name</a> &amp;<a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">name</a>) {</div>
<div class="line"><a id="l03426" name="l03426"></a><span class="lineno"> 3426</span>   my-&gt;conf.resource_greylist.erase(<a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">name</a>);</div>
<div class="line"><a id="l03427" name="l03427"></a><span class="lineno"> 3427</span>}</div>
</div>
<div class="line"><a id="l03428" name="l03428"></a><span class="lineno"> 3428</span> </div>
<div class="foldopen" id="foldopen03429" data-start="{" data-end="}">
<div class="line"><a id="l03429" name="l03429"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#aa1c6dcfae09e0e0ea50ba3fda8915114"> 3429</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#aa1c6dcfae09e0e0ea50ba3fda8915114">controller::is_resource_greylisted</a>(<span class="keyword">const</span> <a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">account_name</a> &amp;<a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">name</a>)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l03430" name="l03430"></a><span class="lineno"> 3430</span>   <span class="keywordflow">return</span> my-&gt;conf.resource_greylist.find(<a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">name</a>) !=  my-&gt;conf.resource_greylist.end();</div>
<div class="line"><a id="l03431" name="l03431"></a><span class="lineno"> 3431</span>}</div>
</div>
<div class="line"><a id="l03432" name="l03432"></a><span class="lineno"> 3432</span> </div>
<div class="foldopen" id="foldopen03433" data-start="{" data-end="}">
<div class="line"><a id="l03433" name="l03433"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#aac87d5e13183ec45393587036b89a14a"> 3433</a></span><span class="keyword">const</span> flat_set&lt;account_name&gt; &amp;<a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#aac87d5e13183ec45393587036b89a14a">controller::get_resource_greylist</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a id="l03434" name="l03434"></a><span class="lineno"> 3434</span>   <span class="keywordflow">return</span>  my-&gt;conf.resource_greylist;</div>
<div class="line"><a id="l03435" name="l03435"></a><span class="lineno"> 3435</span>}</div>
</div>
<div class="line"><a id="l03436" name="l03436"></a><span class="lineno"> 3436</span> </div>
<div class="line"><a id="l03437" name="l03437"></a><span class="lineno"> 3437</span> </div>
<div class="foldopen" id="foldopen03438" data-start="{" data-end="}">
<div class="line"><a id="l03438" name="l03438"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a205a357919f596bf80ba1d2d6e84c9e8"> 3438</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a205a357919f596bf80ba1d2d6e84c9e8">controller::add_to_ram_correction</a>( <a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">account_name</a> account, <a class="code hl_typedef" href="stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a> ram_bytes ) {</div>
<div class="line"><a id="l03439" name="l03439"></a><span class="lineno"> 3439</span>   <span class="keyword">auto</span> ptr = my-&gt;db.find&lt;<a class="code hl_class" href="classsysio_1_1chain_1_1account__ram__correction__object.html">account_ram_correction_object</a>, by_name&gt;( account );</div>
<div class="line"><a id="l03440" name="l03440"></a><span class="lineno"> 3440</span>   <span class="keywordflow">if</span>( ptr ) {</div>
<div class="line"><a id="l03441" name="l03441"></a><span class="lineno"> 3441</span>      my-&gt;db.modify&lt;<a class="code hl_class" href="classsysio_1_1chain_1_1account__ram__correction__object.html">account_ram_correction_object</a>&gt;( *ptr, [&amp;]( <span class="keyword">auto</span>&amp; rco ) {</div>
<div class="line"><a id="l03442" name="l03442"></a><span class="lineno"> 3442</span>         rco.ram_correction += ram_bytes;</div>
<div class="line"><a id="l03443" name="l03443"></a><span class="lineno"> 3443</span>      } );</div>
<div class="line"><a id="l03444" name="l03444"></a><span class="lineno"> 3444</span>   } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l03445" name="l03445"></a><span class="lineno"> 3445</span>      ptr = &amp;my-&gt;db.create&lt;<a class="code hl_class" href="classsysio_1_1chain_1_1account__ram__correction__object.html">account_ram_correction_object</a>&gt;( [&amp;]( <span class="keyword">auto</span>&amp; rco ) {</div>
<div class="line"><a id="l03446" name="l03446"></a><span class="lineno"> 3446</span>         rco.name = account;</div>
<div class="line"><a id="l03447" name="l03447"></a><span class="lineno"> 3447</span>         rco.ram_correction = ram_bytes;</div>
<div class="line"><a id="l03448" name="l03448"></a><span class="lineno"> 3448</span>      } );</div>
<div class="line"><a id="l03449" name="l03449"></a><span class="lineno"> 3449</span>   }</div>
<div class="line"><a id="l03450" name="l03450"></a><span class="lineno"> 3450</span> </div>
<div class="line"><a id="l03451" name="l03451"></a><span class="lineno"> 3451</span>   <span class="keywordflow">if</span> (<span class="keyword">auto</span> dm_logger = <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a4f6404b355a3a4bf7fb60c92e85443d1">get_deep_mind_logger</a>()) {</div>
<div class="line"><a id="l03452" name="l03452"></a><span class="lineno"> 3452</span>      dm_logger-&gt;on_add_ram_correction(*ptr, ram_bytes);</div>
<div class="line"><a id="l03453" name="l03453"></a><span class="lineno"> 3453</span>   }</div>
<div class="line"><a id="l03454" name="l03454"></a><span class="lineno"> 3454</span>}</div>
</div>
<div class="line"><a id="l03455" name="l03455"></a><span class="lineno"> 3455</span> </div>
<div class="foldopen" id="foldopen03456" data-start="{" data-end="}">
<div class="line"><a id="l03456" name="l03456"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#af99330e9d5db1211d2c7cd7b3669830d"> 3456</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#af99330e9d5db1211d2c7cd7b3669830d">controller::all_subjective_mitigations_disabled</a>()<span class="keyword">const </span>{</div>
<div class="line"><a id="l03457" name="l03457"></a><span class="lineno"> 3457</span>   <span class="keywordflow">return</span> my-&gt;conf.disable_all_subjective_mitigations;</div>
<div class="line"><a id="l03458" name="l03458"></a><span class="lineno"> 3458</span>}</div>
</div>
<div class="line"><a id="l03459" name="l03459"></a><span class="lineno"> 3459</span> </div>
<div class="foldopen" id="foldopen03460" data-start="{" data-end="}">
<div class="line"><a id="l03460" name="l03460"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a4f6404b355a3a4bf7fb60c92e85443d1"> 3460</a></span><a class="code hl_class" href="classsysio_1_1chain_1_1deep__mind__handler.html">deep_mind_handler</a>* <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a4f6404b355a3a4bf7fb60c92e85443d1">controller::get_deep_mind_logger</a>()<span class="keyword">const </span>{</div>
<div class="line"><a id="l03461" name="l03461"></a><span class="lineno"> 3461</span>   <span class="keywordflow">return</span> my-&gt;get_deep_mind_logger();</div>
<div class="line"><a id="l03462" name="l03462"></a><span class="lineno"> 3462</span>}</div>
</div>
<div class="line"><a id="l03463" name="l03463"></a><span class="lineno"> 3463</span> </div>
<div class="foldopen" id="foldopen03464" data-start="{" data-end="}">
<div class="line"><a id="l03464" name="l03464"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a86e3c557fb55c04a7e469be06cce72ed"> 3464</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a86e3c557fb55c04a7e469be06cce72ed">controller::enable_deep_mind</a>(<a class="code hl_class" href="classsysio_1_1chain_1_1deep__mind__handler.html">deep_mind_handler</a>* <a class="code hl_class" href="classfc_1_1logger.html">logger</a>) {</div>
<div class="line"><a id="l03465" name="l03465"></a><span class="lineno"> 3465</span>   <a class="code hl_define" href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a>( <a class="code hl_class" href="classfc_1_1logger.html">logger</a> != <span class="keyword">nullptr</span>, misc_exception, <span class="stringliteral">&quot;Invalid logger passed into enable_deep_mind, must be set&quot;</span> );</div>
<div class="line"><a id="l03466" name="l03466"></a><span class="lineno"> 3466</span>   my-&gt;deep_mind_logger = <a class="code hl_variable" href="namespacesysio.html#a6f5e3e21259b1b0b6d4f035e8c7d5a4e">logger</a>;</div>
<div class="line"><a id="l03467" name="l03467"></a><span class="lineno"> 3467</span>}</div>
</div>
<div class="line"><a id="l03468" name="l03468"></a><span class="lineno"> 3468</span> </div>
<div class="foldopen" id="foldopen03469" data-start="{" data-end="}">
<div class="line"><a id="l03469" name="l03469"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#ab75ec0f541f777960752f52f2a194294"> 3469</a></span><a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#ab75ec0f541f777960752f52f2a194294">controller::earliest_available_block_num</a>()<span class="keyword"> const</span>{</div>
<div class="line"><a id="l03470" name="l03470"></a><span class="lineno"> 3470</span>   <span class="keywordflow">return</span> my-&gt;earliest_available_block_num();</div>
<div class="line"><a id="l03471" name="l03471"></a><span class="lineno"> 3471</span>}</div>
</div>
<div class="line"><a id="l03472" name="l03472"></a><span class="lineno"> 3472</span><span class="preprocessor">#if defined(SYSIO_SYS_VM_RUNTIME_ENABLED) || defined(SYSIO_SYS_VM_JIT_RUNTIME_ENABLED)</span></div>
<div class="line"><a id="l03473" name="l03473"></a><span class="lineno"> 3473</span><a class="code hl_class" href="classsysio_1_1vm_1_1wasm__allocator.html">vm::wasm_allocator</a>&amp; controller::get_wasm_allocator() {</div>
<div class="line"><a id="l03474" name="l03474"></a><span class="lineno"> 3474</span>   <span class="keywordflow">return</span> my-&gt;wasm_alloc;</div>
<div class="line"><a id="l03475" name="l03475"></a><span class="lineno"> 3475</span>}</div>
<div class="line"><a id="l03476" name="l03476"></a><span class="lineno"> 3476</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l03477" name="l03477"></a><span class="lineno"> 3477</span> </div>
<div class="foldopen" id="foldopen03478" data-start="{" data-end="}">
<div class="line"><a id="l03478" name="l03478"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#ae60743ce36f1fa0912ff26b1da40afe6"> 3478</a></span>std::optional&lt;uint64_t&gt; <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#ae60743ce36f1fa0912ff26b1da40afe6">controller::convert_exception_to_error_code</a>( <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1exception.html">fc::exception</a>&amp; e ) {</div>
<div class="line"><a id="l03479" name="l03479"></a><span class="lineno"> 3479</span>   <span class="keyword">const</span> chain_exception* e_ptr = <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span>chain_exception*<span class="keyword">&gt;</span>( &amp;e );</div>
<div class="line"><a id="l03480" name="l03480"></a><span class="lineno"> 3480</span> </div>
<div class="line"><a id="l03481" name="l03481"></a><span class="lineno"> 3481</span>   <span class="keywordflow">if</span>( e_ptr == <span class="keyword">nullptr</span> ) <span class="keywordflow">return</span> {};</div>
<div class="line"><a id="l03482" name="l03482"></a><span class="lineno"> 3482</span> </div>
<div class="line"><a id="l03483" name="l03483"></a><span class="lineno"> 3483</span>   <span class="keywordflow">if</span>( !e_ptr-&gt;error_code ) <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><a class="code hl_typedef" href="stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a><span class="keyword">&gt;</span>(<a class="code hl_enumvalue" href="namespacesysio_1_1chain.html#a8b5ff492474737d62d2b925435c687cfab6c5ca8c8a308fb98a68c0d3a83ce3bc">system_error_code::generic_system_error</a>);</div>
<div class="line"><a id="l03484" name="l03484"></a><span class="lineno"> 3484</span> </div>
<div class="line"><a id="l03485" name="l03485"></a><span class="lineno"> 3485</span>   <span class="keywordflow">return</span> e_ptr-&gt;error_code;</div>
<div class="line"><a id="l03486" name="l03486"></a><span class="lineno"> 3486</span>}</div>
</div>
<div class="line"><a id="l03487" name="l03487"></a><span class="lineno"> 3487</span> </div>
<div class="foldopen" id="foldopen03488" data-start="{" data-end="}">
<div class="line"><a id="l03488" name="l03488"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a2c8b0888cae831840ac03980e206c874"> 3488</a></span><a class="code hl_struct" href="structsysio_1_1chain_1_1chain__id__type.html">chain_id_type</a> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a2c8b0888cae831840ac03980e206c874">controller::extract_chain_id</a>(<a class="code hl_class" href="classsysio_1_1chain_1_1snapshot__reader.html">snapshot_reader</a>&amp; snapshot) {</div>
<div class="line"><a id="l03489" name="l03489"></a><span class="lineno"> 3489</span>   <a class="code hl_struct" href="structsysio_1_1chain_1_1chain__snapshot__header.html">chain_snapshot_header</a> header;</div>
<div class="line"><a id="l03490" name="l03490"></a><span class="lineno"> 3490</span>   snapshot.read_section&lt;<a class="code hl_struct" href="structsysio_1_1chain_1_1chain__snapshot__header.html">chain_snapshot_header</a>&gt;([&amp;header]( <span class="keyword">auto</span> &amp;section ){</div>
<div class="line"><a id="l03491" name="l03491"></a><span class="lineno"> 3491</span>      section.read_row(header);</div>
<div class="line"><a id="l03492" name="l03492"></a><span class="lineno"> 3492</span>      header.<a class="code hl_function" href="structsysio_1_1chain_1_1chain__snapshot__header.html#a6f183a866ea3a474243c55484f0c700e">validate</a>();</div>
<div class="line"><a id="l03493" name="l03493"></a><span class="lineno"> 3493</span>   });</div>
<div class="line"><a id="l03494" name="l03494"></a><span class="lineno"> 3494</span> </div>
<div class="line"><a id="l03495" name="l03495"></a><span class="lineno"> 3495</span>   <span class="comment">// check if this is a legacy version of the snapshot, which has a genesis state instead of chain id</span></div>
<div class="line"><a id="l03496" name="l03496"></a><span class="lineno"> 3496</span>   std::optional&lt;genesis_state&gt; genesis = <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#a6353a2e6b51e1b83231f41a8bcc66c47">controller_impl::extract_legacy_genesis_state</a>(snapshot, header.<a class="code hl_variable" href="structsysio_1_1chain_1_1chain__snapshot__header.html#a57ba8d21e5d5c9e1325e9ef03f96d54e">version</a>);</div>
<div class="line"><a id="l03497" name="l03497"></a><span class="lineno"> 3497</span>   <span class="keywordflow">if</span> (genesis) {</div>
<div class="line"><a id="l03498" name="l03498"></a><span class="lineno"> 3498</span>      <span class="keywordflow">return</span> genesis-&gt;compute_chain_id();</div>
<div class="line"><a id="l03499" name="l03499"></a><span class="lineno"> 3499</span>   }</div>
<div class="line"><a id="l03500" name="l03500"></a><span class="lineno"> 3500</span> </div>
<div class="line"><a id="l03501" name="l03501"></a><span class="lineno"> 3501</span>   <a class="code hl_struct" href="structsysio_1_1chain_1_1chain__id__type.html">chain_id_type</a> chain_id;</div>
<div class="line"><a id="l03502" name="l03502"></a><span class="lineno"> 3502</span> </div>
<div class="line"><a id="l03503" name="l03503"></a><span class="lineno"> 3503</span>   <span class="keyword">using </span>v4 = <a class="code hl_struct" href="structsysio_1_1chain_1_1legacy_1_1snapshot__global__property__object__v4.html">legacy::snapshot_global_property_object_v4</a>;</div>
<div class="line"><a id="l03504" name="l03504"></a><span class="lineno"> 3504</span>   <span class="keywordflow">if</span> (header.<a class="code hl_variable" href="structsysio_1_1chain_1_1chain__snapshot__header.html#a57ba8d21e5d5c9e1325e9ef03f96d54e">version</a> &lt;= v4::maximum_version) {</div>
<div class="line"><a id="l03505" name="l03505"></a><span class="lineno"> 3505</span>      snapshot.read_section&lt;<a class="code hl_class" href="classsysio_1_1chain_1_1global__property__object.html">global_property_object</a>&gt;([&amp;chain_id]( <span class="keyword">auto</span> &amp;section ){</div>
<div class="line"><a id="l03506" name="l03506"></a><span class="lineno"> 3506</span>         v4 global_properties;</div>
<div class="line"><a id="l03507" name="l03507"></a><span class="lineno"> 3507</span>         section.read_row(global_properties);</div>
<div class="line"><a id="l03508" name="l03508"></a><span class="lineno"> 3508</span>         chain_id = global_properties.chain_id;</div>
<div class="line"><a id="l03509" name="l03509"></a><span class="lineno"> 3509</span>      });</div>
<div class="line"><a id="l03510" name="l03510"></a><span class="lineno"> 3510</span>   }</div>
<div class="line"><a id="l03511" name="l03511"></a><span class="lineno"> 3511</span>   <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l03512" name="l03512"></a><span class="lineno"> 3512</span>      snapshot.read_section&lt;<a class="code hl_class" href="classsysio_1_1chain_1_1global__property__object.html">global_property_object</a>&gt;([&amp;chain_id]( <span class="keyword">auto</span> &amp;section ){</div>
<div class="line"><a id="l03513" name="l03513"></a><span class="lineno"> 3513</span>         <a class="code hl_struct" href="structsysio_1_1chain_1_1snapshot__global__property__object.html">snapshot_global_property_object</a> global_properties;</div>
<div class="line"><a id="l03514" name="l03514"></a><span class="lineno"> 3514</span>         section.read_row(global_properties);</div>
<div class="line"><a id="l03515" name="l03515"></a><span class="lineno"> 3515</span>         chain_id = global_properties.<a class="code hl_variable" href="structsysio_1_1chain_1_1snapshot__global__property__object.html#a999715132a697f29e1ad6b7b0c4fde2a">chain_id</a>;</div>
<div class="line"><a id="l03516" name="l03516"></a><span class="lineno"> 3516</span>      });</div>
<div class="line"><a id="l03517" name="l03517"></a><span class="lineno"> 3517</span>   }</div>
<div class="line"><a id="l03518" name="l03518"></a><span class="lineno"> 3518</span> </div>
<div class="line"><a id="l03519" name="l03519"></a><span class="lineno"> 3519</span>   <span class="keywordflow">return</span> chain_id;</div>
<div class="line"><a id="l03520" name="l03520"></a><span class="lineno"> 3520</span>}</div>
</div>
<div class="line"><a id="l03521" name="l03521"></a><span class="lineno"> 3521</span> </div>
<div class="foldopen" id="foldopen03522" data-start="{" data-end="}">
<div class="line"><a id="l03522" name="l03522"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a1fba60b779aae78110279aeda9aae351"> 3522</a></span>std::optional&lt;chain_id_type&gt; <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a1fba60b779aae78110279aeda9aae351">controller::extract_chain_id_from_db</a>( <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1path.html">path</a>&amp; state_dir ) {</div>
<div class="line"><a id="l03523" name="l03523"></a><span class="lineno"> 3523</span>   <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l03524" name="l03524"></a><span class="lineno"> 3524</span>      <a class="code hl_class" href="classchainbase_1_1database.html">chainbase::database</a> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a0c79d00dae8c0d90efc18f4d091b2391">db</a>( state_dir, <a class="code hl_enumvalue" href="classchainbase_1_1database.html#a3d0148ef1d3bf633f3d0bfab420250eea51c3754046d280c74c384e0e74a45b47">chainbase::database::read_only</a> );</div>
<div class="line"><a id="l03525" name="l03525"></a><span class="lineno"> 3525</span> </div>
<div class="line"><a id="l03526" name="l03526"></a><span class="lineno"> 3526</span>      <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a0c79d00dae8c0d90efc18f4d091b2391">db</a>.<a class="code hl_function" href="classchainbase_1_1database.html#a43a85f8b7d728b69dbf7a9d69c9ebc1c">add_index</a>&lt;<a class="code hl_typedef" href="namespacesysio_1_1chain.html#a7d61e01ac919d654401a1db8399a3945">database_header_multi_index</a>&gt;();</div>
<div class="line"><a id="l03527" name="l03527"></a><span class="lineno"> 3527</span>      <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a0c79d00dae8c0d90efc18f4d091b2391">db</a>.<a class="code hl_function" href="classchainbase_1_1database.html#a43a85f8b7d728b69dbf7a9d69c9ebc1c">add_index</a>&lt;<a class="code hl_typedef" href="namespacesysio_1_1chain.html#a0612ad4956bca2a7b23f9a14e2b32106">global_property_multi_index</a>&gt;();</div>
<div class="line"><a id="l03528" name="l03528"></a><span class="lineno"> 3528</span> </div>
<div class="line"><a id="l03529" name="l03529"></a><span class="lineno"> 3529</span>      <a class="code hl_function" href="structsysio_1_1chain_1_1controller__impl.html#addaaa85d266d34e5f247ec9214354139">controller_impl::validate_db_version</a>( <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a0c79d00dae8c0d90efc18f4d091b2391">db</a> );</div>
<div class="line"><a id="l03530" name="l03530"></a><span class="lineno"> 3530</span> </div>
<div class="line"><a id="l03531" name="l03531"></a><span class="lineno"> 3531</span>      <span class="keywordflow">if</span>( <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a0c79d00dae8c0d90efc18f4d091b2391">db</a>.<a class="code hl_function" href="classchainbase_1_1database.html#a224fc0c346a93fd027bfa2515f54bf98">revision</a>() &lt; 1 ) <span class="keywordflow">return</span> {};</div>
<div class="line"><a id="l03532" name="l03532"></a><span class="lineno"> 3532</span> </div>
<div class="line"><a id="l03533" name="l03533"></a><span class="lineno"> 3533</span>      <span class="keywordflow">return</span> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a0c79d00dae8c0d90efc18f4d091b2391">db</a>.<a class="code hl_function" href="classchainbase_1_1database.html#afcfe00f81a526c1376d4f51197dd3a9a">get</a>&lt;<a class="code hl_class" href="classsysio_1_1chain_1_1global__property__object.html">global_property_object</a>&gt;().chain_id;</div>
<div class="line"><a id="l03534" name="l03534"></a><span class="lineno"> 3534</span>   } <span class="keywordflow">catch</span>( <span class="keyword">const</span> bad_database_version_exception&amp; ) {</div>
<div class="line"><a id="l03535" name="l03535"></a><span class="lineno"> 3535</span>      <span class="keywordflow">throw</span>;</div>
<div class="line"><a id="l03536" name="l03536"></a><span class="lineno"> 3536</span>   } <span class="keywordflow">catch</span>( ... ) {</div>
<div class="line"><a id="l03537" name="l03537"></a><span class="lineno"> 3537</span>   }</div>
<div class="line"><a id="l03538" name="l03538"></a><span class="lineno"> 3538</span> </div>
<div class="line"><a id="l03539" name="l03539"></a><span class="lineno"> 3539</span>   <span class="keywordflow">return</span> {};</div>
<div class="line"><a id="l03540" name="l03540"></a><span class="lineno"> 3540</span>}</div>
</div>
<div class="line"><a id="l03541" name="l03541"></a><span class="lineno"> 3541</span> </div>
<div class="foldopen" id="foldopen03542" data-start="{" data-end="}">
<div class="line"><a id="l03542" name="l03542"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#ac9ea99fba10c923e5949b3949ac3283f"> 3542</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#ac9ea99fba10c923e5949b3949ac3283f">controller::replace_producer_keys</a>( <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1crypto_1_1public__key.html">public_key_type</a>&amp; key ) {</div>
<div class="line"><a id="l03543" name="l03543"></a><span class="lineno"> 3543</span>   <a class="code hl_define" href="logger_8hpp.html#a831cf08dc63704c11fd154132c6e8bdb">ilog</a>(<span class="stringliteral">&quot;Replace producer keys with ${k}&quot;</span>, (<span class="stringliteral">&quot;k&quot;</span>, key));</div>
<div class="line"><a id="l03544" name="l03544"></a><span class="lineno"> 3544</span>   mutable_db().<a class="code hl_function" href="classchainbase_1_1database.html#a9ebc006075e8fc2e84357a0e068b58d4">modify</a>( <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a0c79d00dae8c0d90efc18f4d091b2391">db</a>().get&lt;global_property_object&gt;(), [&amp;]( <span class="keyword">auto</span>&amp; gp ) {</div>
<div class="line"><a id="l03545" name="l03545"></a><span class="lineno"> 3545</span>      gp.proposed_schedule_block_num = {};</div>
<div class="line"><a id="l03546" name="l03546"></a><span class="lineno"> 3546</span>      gp.proposed_schedule.version = 0;</div>
<div class="line"><a id="l03547" name="l03547"></a><span class="lineno"> 3547</span>      gp.proposed_schedule.producers.clear();</div>
<div class="line"><a id="l03548" name="l03548"></a><span class="lineno"> 3548</span>   });</div>
<div class="line"><a id="l03549" name="l03549"></a><span class="lineno"> 3549</span>   <span class="keyword">auto</span> version = my-&gt;head-&gt;pending_schedule.schedule.version;</div>
<div class="line"><a id="l03550" name="l03550"></a><span class="lineno"> 3550</span>   my-&gt;head-&gt;pending_schedule = {};</div>
<div class="line"><a id="l03551" name="l03551"></a><span class="lineno"> 3551</span>   my-&gt;head-&gt;pending_schedule.schedule.version = version;</div>
<div class="line"><a id="l03552" name="l03552"></a><span class="lineno"> 3552</span>   <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; prod: my-&gt;head-&gt;active_schedule.producers ) {</div>
<div class="line"><a id="l03553" name="l03553"></a><span class="lineno"> 3553</span>      <a class="code hl_define" href="logger_8hpp.html#a831cf08dc63704c11fd154132c6e8bdb">ilog</a>(<span class="stringliteral">&quot;${n}&quot;</span>, (<span class="stringliteral">&quot;n&quot;</span>, prod.producer_name));</div>
<div class="line"><a id="l03554" name="l03554"></a><span class="lineno"> 3554</span>      std::visit([&amp;](<span class="keyword">auto</span> &amp;auth) {</div>
<div class="line"><a id="l03555" name="l03555"></a><span class="lineno"> 3555</span>         auth.threshold = 1;</div>
<div class="line"><a id="l03556" name="l03556"></a><span class="lineno"> 3556</span>         auth.keys = {<a class="code hl_struct" href="structsysio_1_1chain_1_1key__weight.html">key_weight</a>{<a class="code hl_variable" href="yubico__otp_8c.html#a9246c20bb98ad2b4c60313c053c70f08">key</a>, 1}};</div>
<div class="line"><a id="l03557" name="l03557"></a><span class="lineno"> 3557</span>      }, prod.authority);</div>
<div class="line"><a id="l03558" name="l03558"></a><span class="lineno"> 3558</span>   }</div>
<div class="line"><a id="l03559" name="l03559"></a><span class="lineno"> 3559</span>}</div>
</div>
<div class="line"><a id="l03560" name="l03560"></a><span class="lineno"> 3560</span> </div>
<div class="foldopen" id="foldopen03561" data-start="{" data-end="}">
<div class="line"><a id="l03561" name="l03561"></a><span class="lineno"><a class="line" href="classsysio_1_1chain_1_1controller.html#a72b5d03a47c8644a68d625fc4dca44bf"> 3561</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a72b5d03a47c8644a68d625fc4dca44bf">controller::replace_account_keys</a>( <a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">name</a> account, <a class="code hl_struct" href="structsysio_1_1chain_1_1name.html">name</a> permission, <span class="keyword">const</span> <a class="code hl_class" href="classfc_1_1crypto_1_1public__key.html">public_key_type</a>&amp; key ) {</div>
<div class="line"><a id="l03562" name="l03562"></a><span class="lineno"> 3562</span>   <span class="keyword">auto</span>&amp; rlm = <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#add2453cf4d0208ca9f277337c9a5ed7a">get_mutable_resource_limits_manager</a>();</div>
<div class="line"><a id="l03563" name="l03563"></a><span class="lineno"> 3563</span>   <span class="keyword">auto</span>* perm = <a class="code hl_function" href="classsysio_1_1chain_1_1controller.html#a0c79d00dae8c0d90efc18f4d091b2391">db</a>().<a class="code hl_function" href="classchainbase_1_1database.html#aa5a2ca0da0092693ac49b36b7ec6817a">find</a>&lt;<a class="code hl_class" href="classsysio_1_1chain_1_1permission__object.html">permission_object</a>, by_owner&gt;(boost::make_tuple(account, permission));</div>
<div class="line"><a id="l03564" name="l03564"></a><span class="lineno"> 3564</span>   <span class="keywordflow">if</span> (!perm)</div>
<div class="line"><a id="l03565" name="l03565"></a><span class="lineno"> 3565</span>      <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l03566" name="l03566"></a><span class="lineno"> 3566</span>   <a class="code hl_typedef" href="stdint_8h.html#a414156feea104f8f75b4ed9e3121b2f6">int64_t</a> old_size = (<a class="code hl_typedef" href="stdint_8h.html#a414156feea104f8f75b4ed9e3121b2f6">int64_t</a>)(<a class="code hl_variable" href="namespacesysio_1_1chain_1_1config.html#a2772c77657b1f6fda680bbe8f7282d13">chain::config::billable_size_v&lt;permission_object&gt;</a> + perm-&gt;auth.get_billable_size());</div>
<div class="line"><a id="l03567" name="l03567"></a><span class="lineno"> 3567</span>   mutable_db().<a class="code hl_function" href="classchainbase_1_1database.html#a9ebc006075e8fc2e84357a0e068b58d4">modify</a>(*perm, [&amp;](<span class="keyword">auto</span>&amp; <a class="code hl_variable" href="bn_8cpp.html#a8b0eadcc506862e9d751ab45185053aa">p</a>) {</div>
<div class="line"><a id="l03568" name="l03568"></a><span class="lineno"> 3568</span>      <a class="code hl_variable" href="bn_8cpp.html#a8b0eadcc506862e9d751ab45185053aa">p</a>.auth = <a class="code hl_struct" href="structsysio_1_1chain_1_1authority.html">authority</a>(key);</div>
<div class="line"><a id="l03569" name="l03569"></a><span class="lineno"> 3569</span>   });</div>
<div class="line"><a id="l03570" name="l03570"></a><span class="lineno"> 3570</span>   <a class="code hl_typedef" href="stdint_8h.html#a414156feea104f8f75b4ed9e3121b2f6">int64_t</a> new_size = (<a class="code hl_typedef" href="stdint_8h.html#a414156feea104f8f75b4ed9e3121b2f6">int64_t</a>)(<a class="code hl_variable" href="namespacesysio_1_1chain_1_1config.html#a2772c77657b1f6fda680bbe8f7282d13">chain::config::billable_size_v&lt;permission_object&gt;</a> + perm-&gt;auth.get_billable_size());</div>
<div class="line"><a id="l03571" name="l03571"></a><span class="lineno"> 3571</span>   rlm.add_pending_ram_usage(account, new_size - old_size);</div>
<div class="line"><a id="l03572" name="l03572"></a><span class="lineno"> 3572</span>   rlm.verify_account_ram_usage(account);</div>
<div class="line"><a id="l03573" name="l03573"></a><span class="lineno"> 3573</span>}</div>
</div>
<div class="line"><a id="l03574" name="l03574"></a><span class="lineno"> 3574</span> </div>
<div class="line"><a id="l03576" name="l03576"></a><span class="lineno"> 3576</span> </div>
<div class="line"><a id="l03577" name="l03577"></a><span class="lineno"> 3577</span><span class="keyword">template</span>&lt;&gt;</div>
<div class="foldopen" id="foldopen03578" data-start="{" data-end="}">
<div class="line"><a id="l03578" name="l03578"></a><span class="lineno"><a class="line" href="namespacesysio_1_1chain.html#ad489cfc4ad2a8e6c83ba6df824cdf86a"> 3578</a></span><span class="keywordtype">void</span> controller_impl::on_activation&lt;builtin_protocol_feature_t::preactivate_feature&gt;() {</div>
<div class="line"><a id="l03579" name="l03579"></a><span class="lineno"> 3579</span>   db.<a class="code hl_function" href="classchainbase_1_1database.html#a9ebc006075e8fc2e84357a0e068b58d4">modify</a>( db.<a class="code hl_function" href="classchainbase_1_1database.html#afcfe00f81a526c1376d4f51197dd3a9a">get</a>&lt;<a class="code hl_class" href="classsysio_1_1chain_1_1protocol__state__object.html">protocol_state_object</a>&gt;(), [&amp;]( <span class="keyword">auto</span>&amp; ps ) {</div>
<div class="line"><a id="l03580" name="l03580"></a><span class="lineno"> 3580</span>      add_intrinsic_to_whitelist( ps.whitelisted_intrinsics, <span class="stringliteral">&quot;preactivate_feature&quot;</span> );</div>
<div class="line"><a id="l03581" name="l03581"></a><span class="lineno"> 3581</span>      add_intrinsic_to_whitelist( ps.whitelisted_intrinsics, <span class="stringliteral">&quot;is_feature_activated&quot;</span> );</div>
<div class="line"><a id="l03582" name="l03582"></a><span class="lineno"> 3582</span>   } );</div>
<div class="line"><a id="l03583" name="l03583"></a><span class="lineno"> 3583</span>}</div>
</div>
<div class="line"><a id="l03584" name="l03584"></a><span class="lineno"> 3584</span> </div>
<div class="line"><a id="l03585" name="l03585"></a><span class="lineno"> 3585</span><span class="keyword">template</span>&lt;&gt;</div>
<div class="foldopen" id="foldopen03586" data-start="{" data-end="}">
<div class="line"><a id="l03586" name="l03586"></a><span class="lineno"><a class="line" href="namespacesysio_1_1chain.html#abe48b8bdbfc90c716c2829e1b1179502"> 3586</a></span><span class="keywordtype">void</span> controller_impl::on_activation&lt;builtin_protocol_feature_t::get_sender&gt;() {</div>
<div class="line"><a id="l03587" name="l03587"></a><span class="lineno"> 3587</span>   db.<a class="code hl_function" href="classchainbase_1_1database.html#a9ebc006075e8fc2e84357a0e068b58d4">modify</a>( db.<a class="code hl_function" href="classchainbase_1_1database.html#afcfe00f81a526c1376d4f51197dd3a9a">get</a>&lt;<a class="code hl_class" href="classsysio_1_1chain_1_1protocol__state__object.html">protocol_state_object</a>&gt;(), [&amp;]( <span class="keyword">auto</span>&amp; ps ) {</div>
<div class="line"><a id="l03588" name="l03588"></a><span class="lineno"> 3588</span>      add_intrinsic_to_whitelist( ps.whitelisted_intrinsics, <span class="stringliteral">&quot;get_sender&quot;</span> );</div>
<div class="line"><a id="l03589" name="l03589"></a><span class="lineno"> 3589</span>   } );</div>
<div class="line"><a id="l03590" name="l03590"></a><span class="lineno"> 3590</span>}</div>
</div>
<div class="line"><a id="l03591" name="l03591"></a><span class="lineno"> 3591</span> </div>
<div class="line"><a id="l03592" name="l03592"></a><span class="lineno"> 3592</span><span class="keyword">template</span>&lt;&gt;</div>
<div class="foldopen" id="foldopen03593" data-start="{" data-end="}">
<div class="line"><a id="l03593" name="l03593"></a><span class="lineno"><a class="line" href="namespacesysio_1_1chain.html#a97599248411293cb485c399a25bd8988"> 3593</a></span><span class="keywordtype">void</span> controller_impl::on_activation&lt;builtin_protocol_feature_t::replace_deferred&gt;() {</div>
<div class="line"><a id="l03594" name="l03594"></a><span class="lineno"> 3594</span>   <span class="keyword">const</span> <span class="keyword">auto</span>&amp; indx = db.<a class="code hl_function" href="classchainbase_1_1database.html#a4d5297635dcf70be481d9b600da9bc13">get_index</a>&lt;<a class="code hl_typedef" href="namespacesysio_1_1chain.html#a4c900d23edfaeb9e6e25aa3a21e0ab4b">account_ram_correction_index</a>, by_id&gt;();</div>
<div class="line"><a id="l03595" name="l03595"></a><span class="lineno"> 3595</span>   <span class="keywordflow">for</span>( <span class="keyword">auto</span> itr = indx.begin(); itr != indx.end(); itr = indx.begin() ) {</div>
<div class="line"><a id="l03596" name="l03596"></a><span class="lineno"> 3596</span>      <a class="code hl_typedef" href="stdint_8h.html#a414156feea104f8f75b4ed9e3121b2f6">int64_t</a> current_ram_usage = resource_limits.<a class="code hl_function" href="classsysio_1_1chain_1_1resource__limits_1_1resource__limits__manager.html#ae7d1b3c435910424a1142b052a8774be">get_account_ram_usage</a>( itr-&gt;name );</div>
<div class="line"><a id="l03597" name="l03597"></a><span class="lineno"> 3597</span>      <a class="code hl_typedef" href="stdint_8h.html#a414156feea104f8f75b4ed9e3121b2f6">int64_t</a> ram_delta = -<span class="keyword">static_cast&lt;</span><a class="code hl_typedef" href="stdint_8h.html#a414156feea104f8f75b4ed9e3121b2f6">int64_t</a><span class="keyword">&gt;</span>(itr-&gt;ram_correction);</div>
<div class="line"><a id="l03598" name="l03598"></a><span class="lineno"> 3598</span>      <span class="keywordflow">if</span>( itr-&gt;ram_correction &gt; <span class="keyword">static_cast&lt;</span><a class="code hl_typedef" href="stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a><span class="keyword">&gt;</span>(current_ram_usage) ) {</div>
<div class="line"><a id="l03599" name="l03599"></a><span class="lineno"> 3599</span>         ram_delta = -current_ram_usage;</div>
<div class="line"><a id="l03600" name="l03600"></a><span class="lineno"> 3600</span>         <a class="code hl_define" href="logger_8hpp.html#a9e3cdbaecd5a34b42956e888f7326fad">elog</a>( <span class="stringliteral">&quot;account ${name} was to be reduced by ${adjust} bytes of RAM despite only using ${current} bytes of RAM&quot;</span>,</div>
<div class="line"><a id="l03601" name="l03601"></a><span class="lineno"> 3601</span>               (<span class="stringliteral">&quot;name&quot;</span>, itr-&gt;name)(<span class="stringliteral">&quot;adjust&quot;</span>, itr-&gt;ram_correction)(<span class="stringliteral">&quot;current&quot;</span>, current_ram_usage) );</div>
<div class="line"><a id="l03602" name="l03602"></a><span class="lineno"> 3602</span>      }</div>
<div class="line"><a id="l03603" name="l03603"></a><span class="lineno"> 3603</span> </div>
<div class="line"><a id="l03604" name="l03604"></a><span class="lineno"> 3604</span>      <span class="keywordflow">if</span> (<span class="keyword">auto</span> dm_logger = get_deep_mind_logger()) {</div>
<div class="line"><a id="l03605" name="l03605"></a><span class="lineno"> 3605</span>         dm_logger-&gt;on_ram_trace(<a class="code hl_define" href="deep__mind_8hpp.html#aaaa2f1dbd522de03ccbaa73f01db5f50">RAM_EVENT_ID</a>(<span class="stringliteral">&quot;${id}&quot;</span>, (<span class="stringliteral">&quot;id&quot;</span>, itr-&gt;id._id)), <span class="stringliteral">&quot;deferred_trx&quot;</span>, <span class="stringliteral">&quot;correction&quot;</span>, <span class="stringliteral">&quot;deferred_trx_ram_correction&quot;</span>);</div>
<div class="line"><a id="l03606" name="l03606"></a><span class="lineno"> 3606</span>      }</div>
<div class="line"><a id="l03607" name="l03607"></a><span class="lineno"> 3607</span> </div>
<div class="line"><a id="l03608" name="l03608"></a><span class="lineno"> 3608</span>      resource_limits.<a class="code hl_function" href="classsysio_1_1chain_1_1resource__limits_1_1resource__limits__manager.html#a7fea1de6a3806590de0bda86e53c7995">add_pending_ram_usage</a>( itr-&gt;name, ram_delta );</div>
<div class="line"><a id="l03609" name="l03609"></a><span class="lineno"> 3609</span>      db.<a class="code hl_function" href="classchainbase_1_1database.html#ac6bb29708e4fdfb6899028e3c351fe0b">remove</a>( *itr );</div>
<div class="line"><a id="l03610" name="l03610"></a><span class="lineno"> 3610</span>   }</div>
<div class="line"><a id="l03611" name="l03611"></a><span class="lineno"> 3611</span>}</div>
</div>
<div class="line"><a id="l03612" name="l03612"></a><span class="lineno"> 3612</span> </div>
<div class="line"><a id="l03613" name="l03613"></a><span class="lineno"> 3613</span><span class="keyword">template</span>&lt;&gt;</div>
<div class="foldopen" id="foldopen03614" data-start="{" data-end="}">
<div class="line"><a id="l03614" name="l03614"></a><span class="lineno"><a class="line" href="namespacesysio_1_1chain.html#aac086788d0a960567236f63be7577125"> 3614</a></span><span class="keywordtype">void</span> controller_impl::on_activation&lt;builtin_protocol_feature_t::webauthn_key&gt;() {</div>
<div class="line"><a id="l03615" name="l03615"></a><span class="lineno"> 3615</span>   db.<a class="code hl_function" href="classchainbase_1_1database.html#a9ebc006075e8fc2e84357a0e068b58d4">modify</a>( db.<a class="code hl_function" href="classchainbase_1_1database.html#afcfe00f81a526c1376d4f51197dd3a9a">get</a>&lt;<a class="code hl_class" href="classsysio_1_1chain_1_1protocol__state__object.html">protocol_state_object</a>&gt;(), [&amp;]( <span class="keyword">auto</span>&amp; ps ) {</div>
<div class="line"><a id="l03616" name="l03616"></a><span class="lineno"> 3616</span>      ps.num_supported_key_types = 3;</div>
<div class="line"><a id="l03617" name="l03617"></a><span class="lineno"> 3617</span>   } );</div>
<div class="line"><a id="l03618" name="l03618"></a><span class="lineno"> 3618</span>}</div>
</div>
<div class="line"><a id="l03619" name="l03619"></a><span class="lineno"> 3619</span> </div>
<div class="line"><a id="l03620" name="l03620"></a><span class="lineno"> 3620</span><span class="keyword">template</span>&lt;&gt;</div>
<div class="foldopen" id="foldopen03621" data-start="{" data-end="}">
<div class="line"><a id="l03621" name="l03621"></a><span class="lineno"><a class="line" href="namespacesysio_1_1chain.html#aaa84e3c493ad81712088b1185ad986b9"> 3621</a></span><span class="keywordtype">void</span> controller_impl::on_activation&lt;builtin_protocol_feature_t::em_key&gt;() {</div>
<div class="line"><a id="l03622" name="l03622"></a><span class="lineno"> 3622</span>   db.<a class="code hl_function" href="classchainbase_1_1database.html#a9ebc006075e8fc2e84357a0e068b58d4">modify</a>( db.<a class="code hl_function" href="classchainbase_1_1database.html#afcfe00f81a526c1376d4f51197dd3a9a">get</a>&lt;<a class="code hl_class" href="classsysio_1_1chain_1_1protocol__state__object.html">protocol_state_object</a>&gt;(), [&amp;]( <span class="keyword">auto</span>&amp; ps ) {</div>
<div class="line"><a id="l03623" name="l03623"></a><span class="lineno"> 3623</span>      ps.num_supported_key_types = 4;</div>
<div class="line"><a id="l03624" name="l03624"></a><span class="lineno"> 3624</span>   } );</div>
<div class="line"><a id="l03625" name="l03625"></a><span class="lineno"> 3625</span>}</div>
</div>
<div class="line"><a id="l03626" name="l03626"></a><span class="lineno"> 3626</span> </div>
<div class="line"><a id="l03627" name="l03627"></a><span class="lineno"> 3627</span> </div>
<div class="line"><a id="l03628" name="l03628"></a><span class="lineno"> 3628</span><span class="keyword">template</span>&lt;&gt;</div>
<div class="foldopen" id="foldopen03629" data-start="{" data-end="}">
<div class="line"><a id="l03629" name="l03629"></a><span class="lineno"><a class="line" href="namespacesysio_1_1chain.html#a4393e09bb7b222765c0ce7b4e6476904"> 3629</a></span><span class="keywordtype">void</span> controller_impl::on_activation&lt;builtin_protocol_feature_t::wtmsig_block_signatures&gt;() {</div>
<div class="line"><a id="l03630" name="l03630"></a><span class="lineno"> 3630</span>   db.<a class="code hl_function" href="classchainbase_1_1database.html#a9ebc006075e8fc2e84357a0e068b58d4">modify</a>( db.<a class="code hl_function" href="classchainbase_1_1database.html#afcfe00f81a526c1376d4f51197dd3a9a">get</a>&lt;<a class="code hl_class" href="classsysio_1_1chain_1_1protocol__state__object.html">protocol_state_object</a>&gt;(), [&amp;]( <span class="keyword">auto</span>&amp; ps ) {</div>
<div class="line"><a id="l03631" name="l03631"></a><span class="lineno"> 3631</span>      add_intrinsic_to_whitelist( ps.whitelisted_intrinsics, <span class="stringliteral">&quot;set_proposed_producers_ex&quot;</span> );</div>
<div class="line"><a id="l03632" name="l03632"></a><span class="lineno"> 3632</span>   } );</div>
<div class="line"><a id="l03633" name="l03633"></a><span class="lineno"> 3633</span>}</div>
</div>
<div class="line"><a id="l03634" name="l03634"></a><span class="lineno"> 3634</span> </div>
<div class="line"><a id="l03635" name="l03635"></a><span class="lineno"> 3635</span><span class="keyword">template</span>&lt;&gt;</div>
<div class="foldopen" id="foldopen03636" data-start="{" data-end="}">
<div class="line"><a id="l03636" name="l03636"></a><span class="lineno"><a class="line" href="namespacesysio_1_1chain.html#aa6bdd154dacf21ee6930994377762448"> 3636</a></span><span class="keywordtype">void</span> controller_impl::on_activation&lt;builtin_protocol_feature_t::action_return_value&gt;() {</div>
<div class="line"><a id="l03637" name="l03637"></a><span class="lineno"> 3637</span>   db.<a class="code hl_function" href="classchainbase_1_1database.html#a9ebc006075e8fc2e84357a0e068b58d4">modify</a>( db.<a class="code hl_function" href="classchainbase_1_1database.html#afcfe00f81a526c1376d4f51197dd3a9a">get</a>&lt;<a class="code hl_class" href="classsysio_1_1chain_1_1protocol__state__object.html">protocol_state_object</a>&gt;(), [&amp;]( <span class="keyword">auto</span>&amp; ps ) {</div>
<div class="line"><a id="l03638" name="l03638"></a><span class="lineno"> 3638</span>      add_intrinsic_to_whitelist( ps.whitelisted_intrinsics, <span class="stringliteral">&quot;set_action_return_value&quot;</span> );</div>
<div class="line"><a id="l03639" name="l03639"></a><span class="lineno"> 3639</span>   } );</div>
<div class="line"><a id="l03640" name="l03640"></a><span class="lineno"> 3640</span>}</div>
</div>
<div class="line"><a id="l03641" name="l03641"></a><span class="lineno"> 3641</span> </div>
<div class="line"><a id="l03642" name="l03642"></a><span class="lineno"> 3642</span><span class="keyword">template</span>&lt;&gt;</div>
<div class="foldopen" id="foldopen03643" data-start="{" data-end="}">
<div class="line"><a id="l03643" name="l03643"></a><span class="lineno"><a class="line" href="namespacesysio_1_1chain.html#aa0cebf01441e8d48e3f59d1e71952216"> 3643</a></span><span class="keywordtype">void</span> controller_impl::on_activation&lt;builtin_protocol_feature_t::configurable_wasm_limits&gt;() {</div>
<div class="line"><a id="l03644" name="l03644"></a><span class="lineno"> 3644</span>   db.<a class="code hl_function" href="classchainbase_1_1database.html#a9ebc006075e8fc2e84357a0e068b58d4">modify</a>( db.<a class="code hl_function" href="classchainbase_1_1database.html#afcfe00f81a526c1376d4f51197dd3a9a">get</a>&lt;<a class="code hl_class" href="classsysio_1_1chain_1_1protocol__state__object.html">protocol_state_object</a>&gt;(), [&amp;]( <span class="keyword">auto</span>&amp; ps ) {</div>
<div class="line"><a id="l03645" name="l03645"></a><span class="lineno"> 3645</span>      add_intrinsic_to_whitelist( ps.whitelisted_intrinsics, <span class="stringliteral">&quot;set_wasm_parameters_packed&quot;</span> );</div>
<div class="line"><a id="l03646" name="l03646"></a><span class="lineno"> 3646</span>      add_intrinsic_to_whitelist( ps.whitelisted_intrinsics, <span class="stringliteral">&quot;get_wasm_parameters_packed&quot;</span> );</div>
<div class="line"><a id="l03647" name="l03647"></a><span class="lineno"> 3647</span>   } );</div>
<div class="line"><a id="l03648" name="l03648"></a><span class="lineno"> 3648</span>}</div>
</div>
<div class="line"><a id="l03649" name="l03649"></a><span class="lineno"> 3649</span> </div>
<div class="line"><a id="l03650" name="l03650"></a><span class="lineno"> 3650</span><span class="keyword">template</span>&lt;&gt;</div>
<div class="foldopen" id="foldopen03651" data-start="{" data-end="}">
<div class="line"><a id="l03651" name="l03651"></a><span class="lineno"><a class="line" href="namespacesysio_1_1chain.html#a5b554a28a2283bf08cf5a087ad9aa263"> 3651</a></span><span class="keywordtype">void</span> controller_impl::on_activation&lt;builtin_protocol_feature_t::blockchain_parameters&gt;() {</div>
<div class="line"><a id="l03652" name="l03652"></a><span class="lineno"> 3652</span>   db.<a class="code hl_function" href="classchainbase_1_1database.html#a9ebc006075e8fc2e84357a0e068b58d4">modify</a>( db.<a class="code hl_function" href="classchainbase_1_1database.html#afcfe00f81a526c1376d4f51197dd3a9a">get</a>&lt;<a class="code hl_class" href="classsysio_1_1chain_1_1protocol__state__object.html">protocol_state_object</a>&gt;(), [&amp;]( <span class="keyword">auto</span>&amp; ps ) {</div>
<div class="line"><a id="l03653" name="l03653"></a><span class="lineno"> 3653</span>      add_intrinsic_to_whitelist( ps.whitelisted_intrinsics, <span class="stringliteral">&quot;get_parameters_packed&quot;</span> );</div>
<div class="line"><a id="l03654" name="l03654"></a><span class="lineno"> 3654</span>      add_intrinsic_to_whitelist( ps.whitelisted_intrinsics, <span class="stringliteral">&quot;set_parameters_packed&quot;</span> );</div>
<div class="line"><a id="l03655" name="l03655"></a><span class="lineno"> 3655</span>   } );</div>
<div class="line"><a id="l03656" name="l03656"></a><span class="lineno"> 3656</span>}</div>
</div>
<div class="line"><a id="l03657" name="l03657"></a><span class="lineno"> 3657</span> </div>
<div class="line"><a id="l03658" name="l03658"></a><span class="lineno"> 3658</span><span class="keyword">template</span>&lt;&gt;</div>
<div class="foldopen" id="foldopen03659" data-start="{" data-end="}">
<div class="line"><a id="l03659" name="l03659"></a><span class="lineno"><a class="line" href="namespacesysio_1_1chain.html#a3035aa4ca3ab051f87561bee854ae8e3"> 3659</a></span><span class="keywordtype">void</span> controller_impl::on_activation&lt;builtin_protocol_feature_t::get_code_hash&gt;() {</div>
<div class="line"><a id="l03660" name="l03660"></a><span class="lineno"> 3660</span>   db.<a class="code hl_function" href="classchainbase_1_1database.html#a9ebc006075e8fc2e84357a0e068b58d4">modify</a>( db.<a class="code hl_function" href="classchainbase_1_1database.html#afcfe00f81a526c1376d4f51197dd3a9a">get</a>&lt;<a class="code hl_class" href="classsysio_1_1chain_1_1protocol__state__object.html">protocol_state_object</a>&gt;(), [&amp;]( <span class="keyword">auto</span>&amp; ps ) {</div>
<div class="line"><a id="l03661" name="l03661"></a><span class="lineno"> 3661</span>      add_intrinsic_to_whitelist( ps.whitelisted_intrinsics, <span class="stringliteral">&quot;get_code_hash&quot;</span> );</div>
<div class="line"><a id="l03662" name="l03662"></a><span class="lineno"> 3662</span>   } );</div>
<div class="line"><a id="l03663" name="l03663"></a><span class="lineno"> 3663</span>}</div>
</div>
<div class="line"><a id="l03664" name="l03664"></a><span class="lineno"> 3664</span> </div>
<div class="line"><a id="l03665" name="l03665"></a><span class="lineno"> 3665</span><span class="keyword">template</span>&lt;&gt;</div>
<div class="foldopen" id="foldopen03666" data-start="{" data-end="}">
<div class="line"><a id="l03666" name="l03666"></a><span class="lineno"><a class="line" href="namespacesysio_1_1chain.html#a9506d121391f12b3301d4e52e4b73910"> 3666</a></span><span class="keywordtype">void</span> controller_impl::on_activation&lt;builtin_protocol_feature_t::get_block_num&gt;() {</div>
<div class="line"><a id="l03667" name="l03667"></a><span class="lineno"> 3667</span>   db.<a class="code hl_function" href="classchainbase_1_1database.html#a9ebc006075e8fc2e84357a0e068b58d4">modify</a>( db.<a class="code hl_function" href="classchainbase_1_1database.html#afcfe00f81a526c1376d4f51197dd3a9a">get</a>&lt;<a class="code hl_class" href="classsysio_1_1chain_1_1protocol__state__object.html">protocol_state_object</a>&gt;(), [&amp;]( <span class="keyword">auto</span>&amp; ps ) {</div>
<div class="line"><a id="l03668" name="l03668"></a><span class="lineno"> 3668</span>      add_intrinsic_to_whitelist( ps.whitelisted_intrinsics, <span class="stringliteral">&quot;get_block_num&quot;</span> );</div>
<div class="line"><a id="l03669" name="l03669"></a><span class="lineno"> 3669</span>   } );</div>
<div class="line"><a id="l03670" name="l03670"></a><span class="lineno"> 3670</span>}</div>
</div>
<div class="line"><a id="l03671" name="l03671"></a><span class="lineno"> 3671</span> </div>
<div class="line"><a id="l03672" name="l03672"></a><span class="lineno"> 3672</span><span class="keyword">template</span>&lt;&gt;</div>
<div class="foldopen" id="foldopen03673" data-start="{" data-end="}">
<div class="line"><a id="l03673" name="l03673"></a><span class="lineno"><a class="line" href="namespacesysio_1_1chain.html#a709635b6f069bd2cde699931d8182e87"> 3673</a></span><span class="keywordtype">void</span> controller_impl::on_activation&lt;builtin_protocol_feature_t::crypto_primitives&gt;() {</div>
<div class="line"><a id="l03674" name="l03674"></a><span class="lineno"> 3674</span>   db.<a class="code hl_function" href="classchainbase_1_1database.html#a9ebc006075e8fc2e84357a0e068b58d4">modify</a>( db.<a class="code hl_function" href="classchainbase_1_1database.html#afcfe00f81a526c1376d4f51197dd3a9a">get</a>&lt;<a class="code hl_class" href="classsysio_1_1chain_1_1protocol__state__object.html">protocol_state_object</a>&gt;(), [&amp;]( <span class="keyword">auto</span>&amp; ps ) {</div>
<div class="line"><a id="l03675" name="l03675"></a><span class="lineno"> 3675</span>      add_intrinsic_to_whitelist( ps.whitelisted_intrinsics, <span class="stringliteral">&quot;alt_bn128_add&quot;</span> );</div>
<div class="line"><a id="l03676" name="l03676"></a><span class="lineno"> 3676</span>      add_intrinsic_to_whitelist( ps.whitelisted_intrinsics, <span class="stringliteral">&quot;alt_bn128_mul&quot;</span> );</div>
<div class="line"><a id="l03677" name="l03677"></a><span class="lineno"> 3677</span>      add_intrinsic_to_whitelist( ps.whitelisted_intrinsics, <span class="stringliteral">&quot;alt_bn128_pair&quot;</span> );</div>
<div class="line"><a id="l03678" name="l03678"></a><span class="lineno"> 3678</span>      add_intrinsic_to_whitelist( ps.whitelisted_intrinsics, <span class="stringliteral">&quot;mod_exp&quot;</span> );</div>
<div class="line"><a id="l03679" name="l03679"></a><span class="lineno"> 3679</span>      add_intrinsic_to_whitelist( ps.whitelisted_intrinsics, <span class="stringliteral">&quot;blake2_f&quot;</span> );</div>
<div class="line"><a id="l03680" name="l03680"></a><span class="lineno"> 3680</span>      add_intrinsic_to_whitelist( ps.whitelisted_intrinsics, <span class="stringliteral">&quot;sha3&quot;</span> );</div>
<div class="line"><a id="l03681" name="l03681"></a><span class="lineno"> 3681</span>      add_intrinsic_to_whitelist( ps.whitelisted_intrinsics, <span class="stringliteral">&quot;k1_recover&quot;</span> );</div>
<div class="line"><a id="l03682" name="l03682"></a><span class="lineno"> 3682</span>   } );</div>
<div class="line"><a id="l03683" name="l03683"></a><span class="lineno"> 3683</span>}</div>
</div>
<div class="line"><a id="l03684" name="l03684"></a><span class="lineno"> 3684</span> </div>
<div class="line"><a id="l03686" name="l03686"></a><span class="lineno"> 3686</span> </div>
<div class="line"><a id="l03687" name="l03687"></a><span class="lineno"> 3687</span>} } </div>
<div class="ttc" id="a_x02-_disabled_macros_8cpp_html_ae28240b98d91d6eb7da702b770490f39"><div class="ttname"><a href="_x02-_disabled_macros_8cpp.html#ae28240b98d91d6eb7da702b770490f39">f</a></div><div class="ttdeci">foo f</div><div class="ttdef"><b>Definition</b> <a href="_x02-_disabled_macros_8cpp_source.html#l00025">X02-DisabledMacros.cpp:25</a></div></div>
<div class="ttc" id="aaccount__object_8hpp_html"><div class="ttname"><a href="account__object_8hpp.html">account_object.hpp</a></div></div>
<div class="ttc" id="aauthorization__manager_8hpp_html"><div class="ttname"><a href="authorization__manager_8hpp.html">authorization_manager.hpp</a></div></div>
<div class="ttc" id="ablock__log_8hpp_html"><div class="ttname"><a href="block__log_8hpp.html">block_log.hpp</a></div></div>
<div class="ttc" id="ablock__summary__object_8hpp_html"><div class="ttname"><a href="block__summary__object_8hpp.html">block_summary_object.hpp</a></div></div>
<div class="ttc" id="abn_8cpp_html_a8b0eadcc506862e9d751ab45185053aa"><div class="ttname"><a href="bn_8cpp.html#a8b0eadcc506862e9d751ab45185053aa">p</a></div><div class="ttdeci">const mie::Vuint &amp; p</div><div class="ttdef"><b>Definition</b> <a href="bn_8cpp_source.html#l00027">bn.cpp:27</a></div></div>
<div class="ttc" id="abn_8cpp_html_af0a5201ca8846f05f25435b41d7f39f7"><div class="ttname"><a href="bn_8cpp.html#af0a5201ca8846f05f25435b41d7f39f7">r</a></div><div class="ttdeci">const mie::Vuint &amp; r</div><div class="ttdef"><b>Definition</b> <a href="bn_8cpp_source.html#l00028">bn.cpp:28</a></div></div>
<div class="ttc" id="acatch__reporter__console_8cpp_html_a9b45b3e13bd9167aab02e17e08916231"><div class="ttname"><a href="catch__reporter__console_8cpp.html#a9b45b3e13bd9167aab02e17e08916231">name</a></div><div class="ttdeci">std::string name</div><div class="ttdef"><b>Definition</b> <a href="catch__reporter__console_8cpp_source.html#l00186">catch_reporter_console.cpp:186</a></div></div>
<div class="ttc" id="achain_2include_2sysio_2chain_2config_8hpp_html_a0b4bacb63f31764f50a185f320551fbc"><div class="ttname"><a href="chain_2include_2sysio_2chain_2config_8hpp.html#a0b4bacb63f31764f50a185f320551fbc">SYS_PERCENT</a></div><div class="ttdeci">constexpr uint64_t SYS_PERCENT(uint64_t value, uint32_t percentage)</div><div class="ttdef"><b>Definition</b> <a href="chain_2include_2sysio_2chain_2config_8hpp_source.html#l00152">config.hpp:152</a></div></div>
<div class="ttc" id="achain_2include_2sysio_2chain_2exceptions_8hpp_html"><div class="ttname"><a href="chain_2include_2sysio_2chain_2exceptions_8hpp.html">exceptions.hpp</a></div></div>
<div class="ttc" id="achain_2include_2sysio_2chain_2exceptions_8hpp_html_a1bfa656552ea0534b2c91ee0fe33f850"><div class="ttname"><a href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a1bfa656552ea0534b2c91ee0fe33f850">SYS_THROW</a></div><div class="ttdeci">#define SYS_THROW(exc_type, FORMAT,...)</div><div class="ttdef"><b>Definition</b> <a href="chain_2include_2sysio_2chain_2exceptions_8hpp_source.html#l00013">exceptions.hpp:13</a></div></div>
<div class="ttc" id="achain_2include_2sysio_2chain_2exceptions_8hpp_html_a40c2826a6fba35c1ffbf912bdf559792"><div class="ttname"><a href="chain_2include_2sysio_2chain_2exceptions_8hpp.html#a40c2826a6fba35c1ffbf912bdf559792">SYS_ASSERT</a></div><div class="ttdeci">#define SYS_ASSERT(expr, exc_type, FORMAT,...)</div><div class="ttdef"><b>Definition</b> <a href="chain_2include_2sysio_2chain_2exceptions_8hpp_source.html#l00007">exceptions.hpp:7</a></div></div>
<div class="ttc" id="achain__snapshot_8hpp_html"><div class="ttname"><a href="chain__snapshot_8hpp.html">chain_snapshot.hpp</a></div></div>
<div class="ttc" id="achainbase_8hpp_html"><div class="ttname"><a href="chainbase_8hpp.html">chainbase.hpp</a></div></div>
<div class="ttc" id="aclasschainbase_1_1database_html"><div class="ttname"><a href="classchainbase_1_1database.html">chainbase::database</a></div><div class="ttdef"><b>Definition</b> <a href="chainbase_8hpp_source.html#l00252">chainbase.hpp:253</a></div></div>
<div class="ttc" id="aclasschainbase_1_1database_html_a167bce30384de1f373ebe0c25d4d0de6"><div class="ttname"><a href="classchainbase_1_1database.html#a167bce30384de1f373ebe0c25d4d0de6">chainbase::database::undo</a></div><div class="ttdeci">void undo()</div><div class="ttdef"><b>Definition</b> <a href="chainbase_8cpp_source.html#l00041">chainbase.cpp:41</a></div></div>
<div class="ttc" id="aclasschainbase_1_1database_html_a224fc0c346a93fd027bfa2515f54bf98"><div class="ttname"><a href="classchainbase_1_1database.html#a224fc0c346a93fd027bfa2515f54bf98">chainbase::database::revision</a></div><div class="ttdeci">int64_t revision() const</div><div class="ttdef"><b>Definition</b> <a href="chainbase_8hpp_source.html#l00325">chainbase.hpp:325</a></div></div>
<div class="ttc" id="aclasschainbase_1_1database_html_a24e7f6336cad0bd2fc280dab381665ed"><div class="ttname"><a href="classchainbase_1_1database.html#a24e7f6336cad0bd2fc280dab381665ed">chainbase::database::set_revision</a></div><div class="ttdeci">void set_revision(uint64_t revision)</div><div class="ttdef"><b>Definition</b> <a href="chainbase_8hpp_source.html#l00336">chainbase.hpp:336</a></div></div>
<div class="ttc" id="aclasschainbase_1_1database_html_a3d0148ef1d3bf633f3d0bfab420250eea51c3754046d280c74c384e0e74a45b47"><div class="ttname"><a href="classchainbase_1_1database.html#a3d0148ef1d3bf633f3d0bfab420250eea51c3754046d280c74c384e0e74a45b47">chainbase::database::read_only</a></div><div class="ttdeci">@ read_only</div><div class="ttdef"><b>Definition</b> <a href="chainbase_8hpp_source.html#l00256">chainbase.hpp:256</a></div></div>
<div class="ttc" id="aclasschainbase_1_1database_html_a43a85f8b7d728b69dbf7a9d69c9ebc1c"><div class="ttname"><a href="classchainbase_1_1database.html#a43a85f8b7d728b69dbf7a9d69c9ebc1c">chainbase::database::add_index</a></div><div class="ttdeci">void add_index()</div><div class="ttdef"><b>Definition</b> <a href="chainbase_8hpp_source.html#l00344">chainbase.hpp:344</a></div></div>
<div class="ttc" id="aclasschainbase_1_1database_html_a4d5297635dcf70be481d9b600da9bc13"><div class="ttname"><a href="classchainbase_1_1database.html#a4d5297635dcf70be481d9b600da9bc13">chainbase::database::get_index</a></div><div class="ttdeci">const generic_index&lt; MultiIndexType &gt; &amp; get_index() const</div><div class="ttdef"><b>Definition</b> <a href="chainbase_8hpp_source.html#l00425">chainbase.hpp:425</a></div></div>
<div class="ttc" id="aclasschainbase_1_1database_html_a64133afb9e0ae374eeab86bd1d4db08b"><div class="ttname"><a href="classchainbase_1_1database.html#a64133afb9e0ae374eeab86bd1d4db08b">chainbase::database::get_segment_manager</a></div><div class="ttdeci">pinnable_mapped_file::segment_manager * get_segment_manager()</div><div class="ttdef"><b>Definition</b> <a href="chainbase_8hpp_source.html#l00411">chainbase.hpp:411</a></div></div>
<div class="ttc" id="aclasschainbase_1_1database_html_a832c383b7d8573d399e6149d4c715bd6"><div class="ttname"><a href="classchainbase_1_1database.html#a832c383b7d8573d399e6149d4c715bd6">chainbase::database::undo_all</a></div><div class="ttdeci">void undo_all()</div><div class="ttdef"><b>Definition</b> <a href="chainbase_8cpp_source.html#l00065">chainbase.cpp:65</a></div></div>
<div class="ttc" id="aclasschainbase_1_1database_html_a9ebc006075e8fc2e84357a0e068b58d4"><div class="ttname"><a href="classchainbase_1_1database.html#a9ebc006075e8fc2e84357a0e068b58d4">chainbase::database::modify</a></div><div class="ttdeci">void modify(const ObjectType &amp;obj, Modifier &amp;&amp;m)</div><div class="ttdef"><b>Definition</b> <a href="chainbase_8hpp_source.html#l00503">chainbase.hpp:503</a></div></div>
<div class="ttc" id="aclasschainbase_1_1database_html_aa5a2ca0da0092693ac49b36b7ec6817a"><div class="ttname"><a href="classchainbase_1_1database.html#aa5a2ca0da0092693ac49b36b7ec6817a">chainbase::database::find</a></div><div class="ttdeci">const ObjectType * find(CompatibleKey &amp;&amp;key) const</div><div class="ttdef"><b>Definition</b> <a href="chainbase_8hpp_source.html#l00458">chainbase.hpp:458</a></div></div>
<div class="ttc" id="aclasschainbase_1_1database_html_abb570c03bda1ee6ae1b428d41481b476"><div class="ttname"><a href="classchainbase_1_1database.html#abb570c03bda1ee6ae1b428d41481b476">chainbase::database::start_undo_session</a></div><div class="ttdeci">session start_undo_session(bool enabled)</div><div class="ttdef"><b>Definition</b> <a href="chainbase_8cpp_source.html#l00073">chainbase.cpp:73</a></div></div>
<div class="ttc" id="aclasschainbase_1_1database_html_ac6bb29708e4fdfb6899028e3c351fe0b"><div class="ttname"><a href="classchainbase_1_1database.html#ac6bb29708e4fdfb6899028e3c351fe0b">chainbase::database::remove</a></div><div class="ttdeci">void remove(const ObjectType &amp;obj)</div><div class="ttdef"><b>Definition</b> <a href="chainbase_8hpp_source.html#l00511">chainbase.hpp:511</a></div></div>
<div class="ttc" id="aclasschainbase_1_1database_html_aca6d7bcd700644f077b89203b2e8b7ef"><div class="ttname"><a href="classchainbase_1_1database.html#aca6d7bcd700644f077b89203b2e8b7ef">chainbase::database::commit</a></div><div class="ttdeci">void commit(int64_t revision)</div><div class="ttdef"><b>Definition</b> <a href="chainbase_8cpp_source.html#l00057">chainbase.cpp:57</a></div></div>
<div class="ttc" id="aclasschainbase_1_1database_html_adc8f336b33d7013d1b0400399b16c5a7"><div class="ttname"><a href="classchainbase_1_1database.html#adc8f336b33d7013d1b0400399b16c5a7">chainbase::database::create</a></div><div class="ttdeci">const ObjectType &amp; create(Constructor &amp;&amp;con)</div><div class="ttdef"><b>Definition</b> <a href="chainbase_8hpp_source.html#l00519">chainbase.hpp:519</a></div></div>
<div class="ttc" id="aclasschainbase_1_1database_html_afaea057692a8bbbf3f506b64c60308b6"><div class="ttname"><a href="classchainbase_1_1database.html#afaea057692a8bbbf3f506b64c60308b6">chainbase::database::get_mutable_index</a></div><div class="ttdeci">generic_index&lt; MultiIndexType &gt; &amp; get_mutable_index()</div><div class="ttdef"><b>Definition</b> <a href="chainbase_8hpp_source.html#l00447">chainbase.hpp:447</a></div></div>
<div class="ttc" id="aclasschainbase_1_1database_html_afcfe00f81a526c1376d4f51197dd3a9a"><div class="ttname"><a href="classchainbase_1_1database.html#afcfe00f81a526c1376d4f51197dd3a9a">chainbase::database::get</a></div><div class="ttdeci">const ObjectType &amp; get(CompatibleKey &amp;&amp;key) const</div><div class="ttdef"><b>Definition</b> <a href="chainbase_8hpp_source.html#l00477">chainbase.hpp:477</a></div></div>
<div class="ttc" id="aclasschainbase_1_1oid_html"><div class="ttname"><a href="classchainbase_1_1oid.html">chainbase::oid</a></div><div class="ttdef"><b>Definition</b> <a href="chainbase_8hpp_source.html#l00070">chainbase.hpp:70</a></div></div>
<div class="ttc" id="aclasschainbase_1_1oid_html_a572c4ef080a7db37d93631ab0fbb123a"><div class="ttname"><a href="classchainbase_1_1oid.html#a572c4ef080a7db37d93631ab0fbb123a">chainbase::oid::_id</a></div><div class="ttdeci">int64_t _id</div><div class="ttdef"><b>Definition</b> <a href="chainbase_8hpp_source.html#l00086">chainbase.hpp:86</a></div></div>
<div class="ttc" id="aclasschainbase_1_1shared__cow__string_html_a3b3c57c0d2ee027bb70beb283be2a0f2"><div class="ttname"><a href="classchainbase_1_1shared__cow__string.html#a3b3c57c0d2ee027bb70beb283be2a0f2">chainbase::shared_cow_string::size</a></div><div class="ttdeci">std::size_t size() const</div><div class="ttdef"><b>Definition</b> <a href="shared__cow__string_8hpp_source.html#l00107">shared_cow_string.hpp:107</a></div></div>
<div class="ttc" id="aclassconfig_html"><div class="ttname"><a href="classconfig.html">config</a></div><div class="ttdef"><b>Definition</b> <a href="permessage__deflate_8cpp_source.html#l00042">permessage_deflate.cpp:42</a></div></div>
<div class="ttc" id="aclassfc_1_1actor_html"><div class="ttname"><a href="classfc_1_1actor.html">fc::actor</a></div><div class="ttdef"><b>Definition</b> <a href="actor_8hpp_source.html#l00053">actor.hpp:53</a></div></div>
<div class="ttc" id="aclassfc_1_1crypto_1_1public__key_html"><div class="ttname"><a href="classfc_1_1crypto_1_1public__key.html">fc::crypto::public_key</a></div><div class="ttdef"><b>Definition</b> <a href="public__key_8hpp_source.html#l00023">public_key.hpp:24</a></div></div>
<div class="ttc" id="aclassfc_1_1datastream_html"><div class="ttname"><a href="classfc_1_1datastream.html">fc::datastream</a></div><div class="ttdef"><b>Definition</b> <a href="datastream_8hpp_source.html#l00018">datastream.hpp:18</a></div></div>
<div class="ttc" id="aclassfc_1_1exception_html"><div class="ttname"><a href="classfc_1_1exception.html">fc::exception</a></div><div class="ttdoc">Used to generate a useful error report when an exception is thrown.</div><div class="ttdef"><b>Definition</b> <a href="exception_8hpp_source.html#l00057">exception.hpp:58</a></div></div>
<div class="ttc" id="aclassfc_1_1exception_html_a7611ea8fbe25dde56649b685c2298a37"><div class="ttname"><a href="classfc_1_1exception.html#a7611ea8fbe25dde56649b685c2298a37">fc::exception::to_detail_string</a></div><div class="ttdeci">std::string to_detail_string(log_level ll=log_level::all) const</div><div class="ttdef"><b>Definition</b> <a href="exception_8cpp_source.html#l00158">exception.cpp:158</a></div></div>
<div class="ttc" id="aclassfc_1_1exception_html_a79a36225cde10dcd23057bbe19d3390f"><div class="ttname"><a href="classfc_1_1exception.html#a79a36225cde10dcd23057bbe19d3390f">fc::exception::code</a></div><div class="ttdeci">int64_t code() const</div><div class="ttdef"><b>Definition</b> <a href="exception_8cpp_source.html#l00122">exception.cpp:122</a></div></div>
<div class="ttc" id="aclassfc_1_1exception_html_ab1104818bf0d9b6a29f0dfe036cf97f6"><div class="ttname"><a href="classfc_1_1exception.html#ab1104818bf0d9b6a29f0dfe036cf97f6">fc::exception::what</a></div><div class="ttdeci">const char * what() const noexcept override</div><div class="ttdef"><b>Definition</b> <a href="exception_8cpp_source.html#l00121">exception.cpp:121</a></div></div>
<div class="ttc" id="aclassfc_1_1logger_html"><div class="ttname"><a href="classfc_1_1logger.html">fc::logger</a></div><div class="ttdef"><b>Definition</b> <a href="logger_8hpp_source.html#l00025">logger.hpp:26</a></div></div>
<div class="ttc" id="aclassfc_1_1microseconds_html"><div class="ttname"><a href="classfc_1_1microseconds.html">fc::microseconds</a></div><div class="ttdef"><b>Definition</b> <a href="include_2fc_2time_8hpp_source.html#l00011">time.hpp:11</a></div></div>
<div class="ttc" id="aclassfc_1_1microseconds_html_a20fba59ec7e1f50c6b8f2c9443cc9b92"><div class="ttname"><a href="classfc_1_1microseconds.html#a20fba59ec7e1f50c6b8f2c9443cc9b92">fc::microseconds::count</a></div><div class="ttdeci">constexpr int64_t count() const</div><div class="ttdef"><b>Definition</b> <a href="include_2fc_2time_8hpp_source.html#l00026">time.hpp:26</a></div></div>
<div class="ttc" id="aclassfc_1_1microseconds_html_afc3eb0bfd792c7b1cda062e559e30c2e"><div class="ttname"><a href="classfc_1_1microseconds.html#afc3eb0bfd792c7b1cda062e559e30c2e">fc::microseconds::maximum</a></div><div class="ttdeci">static constexpr microseconds maximum()</div><div class="ttdef"><b>Definition</b> <a href="include_2fc_2time_8hpp_source.html#l00014">time.hpp:14</a></div></div>
<div class="ttc" id="aclassfc_1_1path_html"><div class="ttname"><a href="classfc_1_1path.html">fc::path</a></div><div class="ttdoc">wraps boost::filesystem::path to provide platform independent path manipulation.</div><div class="ttdef"><b>Definition</b> <a href="filesystem_8hpp_source.html#l00028">filesystem.hpp:28</a></div></div>
<div class="ttc" id="aclassfc_1_1scoped__exit_html"><div class="ttname"><a href="classfc_1_1scoped__exit.html">fc::scoped_exit</a></div><div class="ttdef"><b>Definition</b> <a href="scoped__exit_8hpp_source.html#l00008">scoped_exit.hpp:8</a></div></div>
<div class="ttc" id="aclassfc_1_1sha256_1_1encoder_html"><div class="ttname"><a href="classfc_1_1sha256_1_1encoder.html">fc::sha256::encoder</a></div><div class="ttdef"><b>Definition</b> <a href="sha256_8hpp_source.html#l00037">sha256.hpp:38</a></div></div>
<div class="ttc" id="aclassfc_1_1sha256_1_1encoder_html_a4d8b8181e912194cf98a56164671adf8"><div class="ttname"><a href="classfc_1_1sha256_1_1encoder.html#a4d8b8181e912194cf98a56164671adf8">fc::sha256::encoder::result</a></div><div class="ttdeci">sha256 result()</div><div class="ttdef"><b>Definition</b> <a href="sha256_8cpp_source.html#l00062">sha256.cpp:62</a></div></div>
<div class="ttc" id="aclassfc_1_1sha256_html"><div class="ttname"><a href="classfc_1_1sha256.html">fc::sha256</a></div><div class="ttdef"><b>Definition</b> <a href="sha256_8hpp_source.html#l00011">sha256.hpp:12</a></div></div>
<div class="ttc" id="aclassfc_1_1sha256_html_a474784de7d6213b855abd7e952df5e36"><div class="ttname"><a href="classfc_1_1sha256.html#a474784de7d6213b855abd7e952df5e36">fc::sha256::hash</a></div><div class="ttdeci">static sha256 hash(const char *d, uint32_t dlen)</div><div class="ttdef"><b>Definition</b> <a href="sha256_8cpp_source.html#l00044">sha256.cpp:44</a></div></div>
<div class="ttc" id="aclassfc_1_1std__exception__wrapper_html_ae5ad64f84b1d373f5b92031566284c7c"><div class="ttname"><a href="classfc_1_1std__exception__wrapper.html#ae5ad64f84b1d373f5b92031566284c7c">fc::std_exception_wrapper::from_current_exception</a></div><div class="ttdeci">static std_exception_wrapper from_current_exception(const std::exception &amp;e)</div><div class="ttdef"><b>Definition</b> <a href="exception_8cpp_source.html#l00335">exception.cpp:335</a></div></div>
<div class="ttc" id="aclassfc_1_1time__point__sec_html"><div class="ttname"><a href="classfc_1_1time__point__sec.html">fc::time_point_sec</a></div><div class="ttdef"><b>Definition</b> <a href="include_2fc_2time_8hpp_source.html#l00072">time.hpp:73</a></div></div>
<div class="ttc" id="aclassfc_1_1time__point_html"><div class="ttname"><a href="classfc_1_1time__point.html">fc::time_point</a></div><div class="ttdef"><b>Definition</b> <a href="include_2fc_2time_8hpp_source.html#l00042">time.hpp:42</a></div></div>
<div class="ttc" id="aclassfc_1_1time__point_html_aa164ff1268a16d4b32afcff181f6100e"><div class="ttname"><a href="classfc_1_1time__point.html#aa164ff1268a16d4b32afcff181f6100e">fc::time_point::now</a></div><div class="ttdeci">static time_point now()</div><div class="ttdef"><b>Definition</b> <a href="time_8cpp_source.html#l00014">time.cpp:14</a></div></div>
<div class="ttc" id="aclassfc_1_1time__point_html_aeccf1b70aa34b132c5269313b8a50573"><div class="ttname"><a href="classfc_1_1time__point.html#aeccf1b70aa34b132c5269313b8a50573">fc::time_point::maximum</a></div><div class="ttdeci">static constexpr time_point maximum()</div><div class="ttdef"><b>Definition</b> <a href="include_2fc_2time_8hpp_source.html#l00046">time.hpp:46</a></div></div>
<div class="ttc" id="aclassfc_1_1vector_html"><div class="ttname"><a href="classfc_1_1vector.html">fc::vector</a></div><div class="ttdef"><b>Definition</b> <a href="vector__fwd_8hpp_source.html#l00007">vector_fwd.hpp:7</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1account__metadata__object_html"><div class="ttname"><a href="classsysio_1_1chain_1_1account__metadata__object.html">sysio::chain::account_metadata_object</a></div><div class="ttdef"><b>Definition</b> <a href="account__object_8hpp_source.html#l00047">account_object.hpp:48</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1account__object_html"><div class="ttname"><a href="classsysio_1_1chain_1_1account__object.html">sysio::chain::account_object</a></div><div class="ttdef"><b>Definition</b> <a href="account__object_8hpp_source.html#l00012">account_object.hpp:12</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1account__ram__correction__object_html"><div class="ttname"><a href="classsysio_1_1chain_1_1account__ram__correction__object.html">sysio::chain::account_ram_correction_object</a></div><div class="ttdef"><b>Definition</b> <a href="account__object_8hpp_source.html#l00083">account_object.hpp:84</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1authorization__manager_html"><div class="ttname"><a href="classsysio_1_1chain_1_1authorization__manager.html">sysio::chain::authorization_manager</a></div><div class="ttdef"><b>Definition</b> <a href="authorization__manager_8hpp_source.html#l00019">authorization_manager.hpp:19</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1authorization__manager_html_a112c1fae696fe6f53103076e9afa5a16"><div class="ttname"><a href="classsysio_1_1chain_1_1authorization__manager.html#a112c1fae696fe6f53103076e9afa5a16">sysio::chain::authorization_manager::add_indices</a></div><div class="ttdeci">void add_indices()</div><div class="ttdef"><b>Definition</b> <a href="authorization__manager_8cpp_source.html#l00027">authorization_manager.cpp:27</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1authorization__manager_html_a24e23281d4ccfdddcc761c83e14a4080"><div class="ttname"><a href="classsysio_1_1chain_1_1authorization__manager.html#a24e23281d4ccfdddcc761c83e14a4080">sysio::chain::authorization_manager::add_to_snapshot</a></div><div class="ttdeci">void add_to_snapshot(const snapshot_writer_ptr &amp;snapshot) const</div><div class="ttdef"><b>Definition</b> <a href="authorization__manager_8cpp_source.html#l00096">authorization_manager.cpp:96</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1authorization__manager_html_a27cfd5f70c12c10a9939e7bf6b3a52e4"><div class="ttname"><a href="classsysio_1_1chain_1_1authorization__manager.html#a27cfd5f70c12c10a9939e7bf6b3a52e4">sysio::chain::authorization_manager::initialize_database</a></div><div class="ttdeci">void initialize_database()</div><div class="ttdef"><b>Definition</b> <a href="authorization__manager_8cpp_source.html#l00031">authorization_manager.cpp:31</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1authorization__manager_html_a7a4d84d47bcd9069ab0c8d8f9f9ac5f3"><div class="ttname"><a href="classsysio_1_1chain_1_1authorization__manager.html#a7a4d84d47bcd9069ab0c8d8f9f9ac5f3">sysio::chain::authorization_manager::read_from_snapshot</a></div><div class="ttdeci">void read_from_snapshot(const snapshot_reader_ptr &amp;snapshot)</div><div class="ttdef"><b>Definition</b> <a href="authorization__manager_8cpp_source.html#l00113">authorization_manager.cpp:113</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1authorization__manager_html_a8566f4407e33eb1e4029455e4feae2f1"><div class="ttname"><a href="classsysio_1_1chain_1_1authorization__manager.html#a8566f4407e33eb1e4029455e4feae2f1">sysio::chain::authorization_manager::check_authorization</a></div><div class="ttdeci">void check_authorization(const vector&lt; action &gt; &amp;actions, const flat_set&lt; public_key_type &gt; &amp;provided_keys, const flat_set&lt; permission_level &gt; &amp;provided_permissions=flat_set&lt; permission_level &gt;(), fc::microseconds provided_delay=fc::microseconds(0), const std::function&lt; void()&gt; &amp;checktime=std::function&lt; void()&gt;(), bool allow_unused_keys=false, bool check_but_dont_fail=false, const flat_set&lt; permission_level &gt; &amp;satisfied_authorizations=flat_set&lt; permission_level &gt;()) const</div><div class="ttdoc">Check authorizations of a vector of actions with provided keys, permission levels,...</div><div class="ttdef"><b>Definition</b> <a href="authorization__manager_8cpp_source.html#l00471">authorization_manager.cpp:471</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1authorization__manager_html_a96924f6aca32a602e24d991d12278a69"><div class="ttname"><a href="classsysio_1_1chain_1_1authorization__manager.html#a96924f6aca32a602e24d991d12278a69">sysio::chain::authorization_manager::get_permission</a></div><div class="ttdeci">const permission_object &amp; get_permission(const permission_level &amp;level) const</div><div class="ttdef"><b>Definition</b> <a href="authorization__manager_8cpp_source.html#l00257">authorization_manager.cpp:257</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1authorization__manager_html_aac57733c5aa05c1c78a023a80b2f447f"><div class="ttname"><a href="classsysio_1_1chain_1_1authorization__manager.html#aac57733c5aa05c1c78a023a80b2f447f">sysio::chain::authorization_manager::create_permission</a></div><div class="ttdeci">const permission_object &amp; create_permission(account_name account, permission_name name, permission_id_type parent, const authority &amp;auth, time_point initial_creation_time=time_point())</div><div class="ttdef"><b>Definition</b> <a href="authorization__manager_8cpp_source.html#l00133">authorization_manager.cpp:133</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1block__log_html"><div class="ttname"><a href="classsysio_1_1chain_1_1block__log.html">sysio::chain::block_log</a></div><div class="ttdef"><b>Definition</b> <a href="block__log_8hpp_source.html#l00045">block_log.hpp:45</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1block__log_html_a4d0b6ecf420faffc4f00ba6af3d0af99"><div class="ttname"><a href="classsysio_1_1chain_1_1block__log.html#a4d0b6ecf420faffc4f00ba6af3d0af99">sysio::chain::block_log::head_id</a></div><div class="ttdeci">const block_id_type &amp; head_id() const</div><div class="ttdef"><b>Definition</b> <a href="block__log_8cpp_source.html#l00702">block_log.cpp:702</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1block__log_html_a99c59d29b262144ad99eacc827f76107"><div class="ttname"><a href="classsysio_1_1chain_1_1block__log.html#a99c59d29b262144ad99eacc827f76107">sysio::chain::block_log::read_block_by_num</a></div><div class="ttdeci">signed_block_ptr read_block_by_num(uint32_t block_num) const</div><div class="ttdef"><b>Definition</b> <a href="block__log_8cpp_source.html#l00630">block_log.cpp:630</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1block__log_html_ac5f1c1e78e72414fbf9bae75da42303e"><div class="ttname"><a href="classsysio_1_1chain_1_1block__log.html#ac5f1c1e78e72414fbf9bae75da42303e">sysio::chain::block_log::first_block_num</a></div><div class="ttdeci">uint32_t first_block_num() const</div><div class="ttdef"><b>Definition</b> <a href="block__log_8cpp_source.html#l00706">block_log.cpp:706</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1block__log_html_aca2eca093aee072fc3f599a7c642a227"><div class="ttname"><a href="classsysio_1_1chain_1_1block__log.html#aca2eca093aee072fc3f599a7c642a227">sysio::chain::block_log::append</a></div><div class="ttdeci">void append(const signed_block_ptr &amp;b)</div><div class="ttdef"><b>Definition</b> <a href="block__log_8cpp_source.html#l00358">block_log.cpp:358</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1block__log_html_ae787e7866ebfcd4c5dd5632c15c07c88"><div class="ttname"><a href="classsysio_1_1chain_1_1block__log.html#ae787e7866ebfcd4c5dd5632c15c07c88">sysio::chain::block_log::head</a></div><div class="ttdeci">const signed_block_ptr &amp; head() const</div><div class="ttdef"><b>Definition</b> <a href="block__log_8cpp_source.html#l00698">block_log.cpp:698</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1block__log_html_af7c368f1aa0e3e827d619228c4e144bd"><div class="ttname"><a href="classsysio_1_1chain_1_1block__log.html#af7c368f1aa0e3e827d619228c4e144bd">sysio::chain::block_log::reset</a></div><div class="ttdeci">void reset(const genesis_state &amp;gs, const signed_block_ptr &amp;genesis_block)</div><div class="ttdef"><b>Definition</b> <a href="block__log_8cpp_source.html#l00593">block_log.cpp:593</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1block__summary__object_html"><div class="ttname"><a href="classsysio_1_1chain_1_1block__summary__object.html">sysio::chain::block_summary_object</a></div><div class="ttdoc">tracks minimal information about past blocks to implement TaPOS</div><div class="ttdef"><b>Definition</b> <a href="block__summary__object_8hpp_source.html#l00016">block_summary_object.hpp:17</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1block__timestamp_html"><div class="ttname"><a href="classsysio_1_1chain_1_1block__timestamp.html">sysio::chain::block_timestamp&lt; config::block_interval_ms, config::block_timestamp_epoch &gt;</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1block__timestamp_html_a1bdb67323980085a2d4002d877b6c232"><div class="ttname"><a href="classsysio_1_1chain_1_1block__timestamp.html#a1bdb67323980085a2d4002d877b6c232">sysio::chain::block_timestamp::slot</a></div><div class="ttdeci">uint32_t slot</div><div class="ttdef"><b>Definition</b> <a href="block__timestamp_8hpp_source.html#l00060">block_timestamp.hpp:60</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html">sysio::chain::controller</a></div><div class="ttdef"><b>Definition</b> <a href="controller_8hpp_source.html#l00063">controller.hpp:63</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a03d5ea18c641a8899af9bdbdf9da9f81"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a03d5ea18c641a8899af9bdbdf9da9f81">sysio::chain::controller::set_greylist_limit</a></div><div class="ttdeci">void set_greylist_limit(uint32_t limit)</div><div class="ttdef"><b>Definition</b> <a href="#l03407">controller.cpp:3407</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a04f3c55da09b359224510af99502490f"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a04f3c55da09b359224510af99502490f">sysio::chain::controller::fetch_block_state_by_number</a></div><div class="ttdeci">block_state_ptr fetch_block_state_by_number(uint32_t block_num) const</div><div class="ttdef"><b>Definition</b> <a href="#l03088">controller.cpp:3088</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a063e3e3149bf8b88460900cef4b4571b"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a063e3e3149bf8b88460900cef4b4571b">sysio::chain::controller::accepted_transaction</a></div><div class="ttdeci">signal&lt; void(const transaction_metadata_ptr &amp;)&gt; accepted_transaction</div><div class="ttdef"><b>Definition</b> <a href="controller_8hpp_source.html#l00331">controller.hpp:331</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a06ea0e9e805452cdd189f13df09916e8"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a06ea0e9e805452cdd189f13df09916e8">sysio::chain::controller::set_actor_whitelist</a></div><div class="ttdeci">void set_actor_whitelist(const flat_set&lt; account_name &gt; &amp;)</div><div class="ttdef"><b>Definition</b> <a href="#l02909">controller.cpp:2909</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a087c940aa88be2ccc1fbb7dd1bc28da6"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a087c940aa88be2ccc1fbb7dd1bc28da6">sysio::chain::controller::get_actor_blacklist</a></div><div class="ttdeci">const flat_set&lt; account_name &gt; &amp; get_actor_blacklist() const</div><div class="ttdef"><b>Definition</b> <a href="#l02893">controller.cpp:2893</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a0884a15f8a10b5a0037601289908a0d9"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a0884a15f8a10b5a0037601289908a0d9">sysio::chain::controller::check_action_list</a></div><div class="ttdeci">void check_action_list(account_name code, action_name action) const</div><div class="ttdef"><b>Definition</b> <a href="#l03320">controller.cpp:3320</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a0a0659166483870bf065f4d5e671484e"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a0a0659166483870bf065f4d5e671484e">sysio::chain::controller::accepted_block_header</a></div><div class="ttdeci">signal&lt; void(const block_state_ptr &amp;)&gt; accepted_block_header</div><div class="ttdef"><b>Definition</b> <a href="controller_8hpp_source.html#l00328">controller.hpp:328</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a0ab467ff13b82630da7533410a8131c3"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a0ab467ff13b82630da7533410a8131c3">sysio::chain::controller::is_protocol_feature_activated</a></div><div class="ttdeci">bool is_protocol_feature_activated(const digest_type &amp;feature_digest) const</div><div class="ttdef"><b>Definition</b> <a href="#l03377">controller.cpp:3377</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a0bb11e832a05b6437c79bf81758b1b7d"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a0bb11e832a05b6437c79bf81758b1b7d">sysio::chain::controller::get_global_properties</a></div><div class="ttdeci">const global_property_object &amp; get_global_properties() const</div><div class="ttdef"><b>Definition</b> <a href="#l03062">controller.cpp:3062</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a0c79d00dae8c0d90efc18f4d091b2391"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a0c79d00dae8c0d90efc18f4d091b2391">sysio::chain::controller::db</a></div><div class="ttdeci">const chainbase::database &amp; db() const</div><div class="ttdef"><b>Definition</b> <a href="#l02646">controller.cpp:2646</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a0fcc85a590581560765686050fe105a8"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a0fcc85a590581560765686050fe105a8">sysio::chain::controller::is_producing_block</a></div><div class="ttdeci">bool is_producing_block() const</div><div class="ttdef"><b>Definition</b> <a href="#l03332">controller.cpp:3332</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a1196ffe0c4905238026e4923cf24cb3e"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a1196ffe0c4905238026e4923cf24cb3e">sysio::chain::controller::is_trusted_producer</a></div><div class="ttdeci">bool is_trusted_producer(const account_name &amp;producer) const</div><div class="ttdef"><b>Definition</b> <a href="#l03261">controller.cpp:3261</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a125b3c8fdc58904ce8179b68d1ea4172"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a125b3c8fdc58904ce8179b68d1ea4172">sysio::chain::controller::get_validation_mode</a></div><div class="ttdeci">validation_mode get_validation_mode() const</div><div class="ttdef"><b>Definition</b> <a href="#l03281">controller.cpp:3281</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a1379e43325b7e517a058bddce15571eb"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a1379e43325b7e517a058bddce15571eb">sysio::chain::controller::fetch_block_by_number</a></div><div class="ttdeci">signed_block_ptr fetch_block_by_number(uint32_t block_num) const</div><div class="ttdef"><b>Definition</b> <a href="#l03074">controller.cpp:3074</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a148eb08aa44ff6a177015a66004d0e49"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a148eb08aa44ff6a177015a66004d0e49">sysio::chain::controller::get_dynamic_global_properties</a></div><div class="ttdeci">const dynamic_global_property_object &amp; get_dynamic_global_properties() const</div><div class="ttdef"><b>Definition</b> <a href="#l03059">controller.cpp:3059</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a16975bb6b23c3e9ffaf7590006e81439"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a16975bb6b23c3e9ffaf7590006e81439">sysio::chain::controller::commit_block</a></div><div class="ttdeci">void commit_block()</div><div class="ttdef"><b>Definition</b> <a href="#l02842">controller.cpp:2842</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a182f205721eaef19d84a5a6aef37be21"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a182f205721eaef19d84a5a6aef37be21">sysio::chain::controller::fork_db_pending_head_block_producer</a></div><div class="ttdeci">account_name fork_db_pending_head_block_producer() const</div><div class="ttdef"><b>Definition</b> <a href="#l02996">controller.cpp:2996</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a19f994be76ccda4705a54ac7af6bfe29"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a19f994be76ccda4705a54ac7af6bfe29">sysio::chain::controller::fork_db_pending_head_block_id</a></div><div class="ttdeci">block_id_type fork_db_pending_head_block_id() const</div><div class="ttdef"><b>Definition</b> <a href="#l02988">controller.cpp:2988</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a1a695a1daba0cf887e71851a61911a37"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a1a695a1daba0cf887e71851a61911a37">sysio::chain::controller::set_actor_blacklist</a></div><div class="ttdeci">void set_actor_blacklist(const flat_set&lt; account_name &gt; &amp;)</div><div class="ttdef"><b>Definition</b> <a href="#l02912">controller.cpp:2912</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a1fba60b779aae78110279aeda9aae351"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a1fba60b779aae78110279aeda9aae351">sysio::chain::controller::extract_chain_id_from_db</a></div><div class="ttdeci">static std::optional&lt; chain_id_type &gt; extract_chain_id_from_db(const path &amp;state_dir)</div><div class="ttdef"><b>Definition</b> <a href="#l03522">controller.cpp:3522</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a1ff3607461fff45552db45cec5aca012"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a1ff3607461fff45552db45cec5aca012">sysio::chain::controller::accepted_block</a></div><div class="ttdeci">signal&lt; void(const block_state_ptr &amp;)&gt; accepted_block</div><div class="ttdef"><b>Definition</b> <a href="controller_8hpp_source.html#l00329">controller.hpp:329</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a205a357919f596bf80ba1d2d6e84c9e8"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a205a357919f596bf80ba1d2d6e84c9e8">sysio::chain::controller::add_to_ram_correction</a></div><div class="ttdeci">void add_to_ram_correction(account_name account, uint64_t ram_bytes)</div><div class="ttdef"><b>Definition</b> <a href="#l03438">controller.cpp:3438</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a27266ebf16b6dd19a860635f7d1f9930"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a27266ebf16b6dd19a860635f7d1f9930">sysio::chain::controller::irreversible_block</a></div><div class="ttdeci">signal&lt; void(const block_state_ptr &amp;)&gt; irreversible_block</div><div class="ttdef"><b>Definition</b> <a href="controller_8hpp_source.html#l00330">controller.hpp:330</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a286751cd6498b500b70a0d3678672263"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a286751cd6498b500b70a0d3678672263">sysio::chain::controller::is_building_block</a></div><div class="ttdeci">bool is_building_block() const</div><div class="ttdef"><b>Definition</b> <a href="#l03328">controller.cpp:3328</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a28d33629f3badcb8155c08be3e05b99e"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a28d33629f3badcb8155c08be3e05b99e">sysio::chain::controller::get_read_mode</a></div><div class="ttdeci">db_read_mode get_read_mode() const</div><div class="ttdef"><b>Definition</b> <a href="#l03277">controller.cpp:3277</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a2c8b0888cae831840ac03980e206c874"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a2c8b0888cae831840ac03980e206c874">sysio::chain::controller::extract_chain_id</a></div><div class="ttdeci">static chain_id_type extract_chain_id(snapshot_reader &amp;snapshot)</div><div class="ttdef"><b>Definition</b> <a href="#l03488">controller.cpp:3488</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a3079bf203cd6e26ed902a84ff3ec7856"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a3079bf203cd6e26ed902a84ff3ec7856">sysio::chain::controller::abort_block</a></div><div class="ttdeci">vector&lt; transaction_metadata_ptr &gt; abort_block()</div><div class="ttdef"><b>Definition</b> <a href="#l02847">controller.cpp:2847</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a307c14eafe6dd6c43f6de377bbc2d10d"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a307c14eafe6dd6c43f6de377bbc2d10d">sysio::chain::controller::head_block_producer</a></div><div class="ttdeci">account_name head_block_producer() const</div><div class="ttdef"><b>Definition</b> <a href="#l02958">controller.cpp:2958</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a31c23187243554bdb6b54bb31bdb4bcd"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a31c23187243554bdb6b54bb31bdb4bcd">sysio::chain::controller::push_transaction</a></div><div class="ttdeci">transaction_trace_ptr push_transaction(const transaction_metadata_ptr &amp;trx, fc::time_point deadline, fc::microseconds max_transaction_time, uint32_t billed_cpu_time_us, bool explicit_billed_cpu_time, int64_t subjective_cpu_bill_us)</div><div class="ttdef"><b>Definition</b> <a href="#l02871">controller.cpp:2871</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a31dc2787a93d98c0c591d7432aea569a"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a31dc2787a93d98c0c591d7432aea569a">sysio::chain::controller::create_block_state</a></div><div class="ttdeci">block_state_ptr create_block_state(const block_id_type &amp;id, const signed_block_ptr &amp;b) const</div><div class="ttdef"><b>Definition</b> <a href="#l02859">controller.cpp:2859</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a33704b4936bb9bbd2ea6b0874ca521b4"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a33704b4936bb9bbd2ea6b0874ca521b4">sysio::chain::controller::head_block_num</a></div><div class="ttdeci">uint32_t head_block_num() const</div><div class="ttdef"><b>Definition</b> <a href="#l02949">controller.cpp:2949</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a35b9a3485ef36e6456483f4307e9ad53"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a35b9a3485ef36e6456483f4307e9ad53">sysio::chain::controller::push_block</a></div><div class="ttdeci">void push_block(const block_state_ptr &amp;bsp, const forked_branch_callback &amp;cb, const trx_meta_cache_lookup &amp;trx_lookup)</div><div class="ttdef"><b>Definition</b> <a href="#l02863">controller.cpp:2863</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a37d0a44faef74cf0f96127982c1ce124"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a37d0a44faef74cf0f96127982c1ce124">sysio::chain::controller::head_block_id</a></div><div class="ttdeci">block_id_type head_block_id() const</div><div class="ttdef"><b>Definition</b> <a href="#l02955">controller.cpp:2955</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a393457dadb84d77ad0a8a8561f05bcc2"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a393457dadb84d77ad0a8a8561f05bcc2">sysio::chain::controller::preactivate_feature</a></div><div class="ttdeci">void preactivate_feature(const digest_type &amp;feature_digest)</div><div class="ttdef"><b>Definition</b> <a href="#l02652">controller.cpp:2652</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a3c16d661e137dbe654a1c40a972759d4"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a3c16d661e137dbe654a1c40a972759d4">sysio::chain::controller::proposed_producers</a></div><div class="ttdeci">std::optional&lt; producer_authority_schedule &gt; proposed_producers() const</div><div class="ttdef"><b>Definition</b> <a href="#l03211">controller.cpp:3211</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a3c9f983e8d4aba41afbb0a473feca18f"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a3c9f983e8d4aba41afbb0a473feca18f">sysio::chain::controller::validate_expiration</a></div><div class="ttdeci">void validate_expiration(const transaction &amp;t) const</div><div class="ttdef"><b>Definition</b> <a href="#l03346">controller.cpp:3346</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a3e445e8e2da032a322a1348091a1a702"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a3e445e8e2da032a322a1348091a1a702">sysio::chain::controller::head_block_state</a></div><div class="ttdeci">block_state_ptr head_block_state() const</div><div class="ttdef"><b>Definition</b> <a href="#l02964">controller.cpp:2964</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a407d1c6dfd6e7b3e1d4e1567d15e344c"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a407d1c6dfd6e7b3e1d4e1567d15e344c">sysio::chain::controller::write_snapshot</a></div><div class="ttdeci">void write_snapshot(const snapshot_writer_ptr &amp;snapshot)</div><div class="ttdef"><b>Definition</b> <a href="#l03123">controller.cpp:3123</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a42a29a059b847799ae3a75953b6bff1e"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a42a29a059b847799ae3a75953b6bff1e">sysio::chain::controller::skip_auth_check</a></div><div class="ttdeci">bool skip_auth_check() const</div><div class="ttdef"><b>Definition</b> <a href="#l03238">controller.cpp:3238</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a449c46cd54dde8387e020cc86a2f1d41"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a449c46cd54dde8387e020cc86a2f1d41">sysio::chain::controller::is_profiling</a></div><div class="ttdeci">bool is_profiling(account_name name) const</div><div class="ttdef"><b>Definition</b> <a href="#l03269">controller.cpp:3269</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a47ba4879ad3153282cba14e185f98d71"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a47ba4879ad3153282cba14e185f98d71">sysio::chain::controller::pending_block_num</a></div><div class="ttdeci">uint32_t pending_block_num() const</div><div class="ttdef"><b>Definition</b> <a href="#l03009">controller.cpp:3009</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a4a2e2a5327580a667b803e3bf3ce5f82"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a4a2e2a5327580a667b803e3bf3ce5f82">sysio::chain::controller::find_apply_handler</a></div><div class="ttdeci">const apply_handler * find_apply_handler(account_name contract, scope_name scope, action_name act) const</div><div class="ttdef"><b>Definition</b> <a href="#l03289">controller.cpp:3289</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a4afbf4e4448a73468eb6947b68a0c348"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a4afbf4e4448a73468eb6947b68a0c348">sysio::chain::controller::is_ram_billing_in_notify_allowed</a></div><div class="ttdeci">bool is_ram_billing_in_notify_allowed() const</div><div class="ttdef"><b>Definition</b> <a href="#l03338">controller.cpp:3338</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a4c7e83b4e4c21205b0fb9b2e4b7fb227"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a4c7e83b4e4c21205b0fb9b2e4b7fb227">sysio::chain::controller::get_mutable_authorization_manager</a></div><div class="ttdeci">authorization_manager &amp; get_mutable_authorization_manager()</div><div class="ttdef"><b>Definition</b> <a href="#l02595">controller.cpp:2595</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a4f6404b355a3a4bf7fb60c92e85443d1"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a4f6404b355a3a4bf7fb60c92e85443d1">sysio::chain::controller::get_deep_mind_logger</a></div><div class="ttdeci">deep_mind_handler * get_deep_mind_logger() const</div><div class="ttdef"><b>Definition</b> <a href="#l03460">controller.cpp:3460</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a4fc6dcda025714506dce2a3ed924a21c"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a4fc6dcda025714506dce2a3ed924a21c">sysio::chain::controller::pre_accepted_block</a></div><div class="ttdeci">signal&lt; void(const signed_block_ptr &amp;)&gt; pre_accepted_block</div><div class="ttdef"><b>Definition</b> <a href="controller_8hpp_source.html#l00327">controller.hpp:327</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a53495de416021a4e56e889e771b25a52"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a53495de416021a4e56e889e771b25a52">sysio::chain::controller::last_irreversible_block_num</a></div><div class="ttdeci">uint32_t last_irreversible_block_num() const</div><div class="ttdef"><b>Definition</b> <a href="#l03046">controller.cpp:3046</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a54645293859c265a7492eb002719c3dc"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a54645293859c265a7492eb002719c3dc">sysio::chain::controller::pending_producers</a></div><div class="ttdeci">const producer_authority_schedule &amp; pending_producers() const</div><div class="ttdef"><b>Definition</b> <a href="#l03189">controller.cpp:3189</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a5711e4cc0cff77f67d04b64373252412"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a5711e4cc0cff77f67d04b64373252412">sysio::chain::controller::set_key_blacklist</a></div><div class="ttdeci">void set_key_blacklist(const flat_set&lt; public_key_type &gt; &amp;)</div><div class="ttdef"><b>Definition</b> <a href="#l02928">controller.cpp:2928</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a59e341a41ba27734555c54c37bacf358"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a59e341a41ba27734555c54c37bacf358">sysio::chain::controller::set_s_header</a></div><div class="ttdeci">void set_s_header(const s_header &amp;)</div><div class="ttdef"><b>Definition</b> <a href="#l02931">controller.cpp:2931</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a5d51f89938499d2cf479a6f16d42848d"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a5d51f89938499d2cf479a6f16d42848d">sysio::chain::controller::fork_db_pending_head_block_num</a></div><div class="ttdeci">uint32_t fork_db_pending_head_block_num() const</div><div class="ttdef"><b>Definition</b> <a href="#l02984">controller.cpp:2984</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a5e15777ff13440123a46783623744202"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a5e15777ff13440123a46783623744202">sysio::chain::controller::get_max_nonprivileged_inline_action_size</a></div><div class="ttdeci">uint32_t get_max_nonprivileged_inline_action_size() const</div><div class="ttdef"><b>Definition</b> <a href="#l02605">controller.cpp:2605</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a64826ea9f453742f28801991e2ceba02"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a64826ea9f453742f28801991e2ceba02">sysio::chain::controller::get_thread_pool</a></div><div class="ttdeci">boost::asio::io_context &amp; get_thread_pool()</div><div class="ttdef"><b>Definition</b> <a href="#l02851">controller.cpp:2851</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a6592e04d224ee0bddaab2ad94428b1fc"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a6592e04d224ee0bddaab2ad94428b1fc">sysio::chain::controller::fork_db_head_block_id</a></div><div class="ttdeci">block_id_type fork_db_head_block_id() const</div><div class="ttdef"><b>Definition</b> <a href="#l02972">controller.cpp:2972</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a67876c4bcb4b26fa679d347472ff14ee"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a67876c4bcb4b26fa679d347472ff14ee">sysio::chain::controller::get_protocol_feature_manager</a></div><div class="ttdeci">const protocol_feature_manager &amp; get_protocol_feature_manager() const</div><div class="ttdef"><b>Definition</b> <a href="#l02600">controller.cpp:2600</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a67be65a69cad78d9f44be1b2822d6367"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a67be65a69cad78d9f44be1b2822d6367">sysio::chain::controller::~controller</a></div><div class="ttdeci">~controller()</div><div class="ttdef"><b>Definition</b> <a href="#l02620">controller.cpp:2620</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a701a2bfcee8df0244e1a8ac8900bc657"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a701a2bfcee8df0244e1a8ac8900bc657">sysio::chain::controller::configured_subjective_signature_length_limit</a></div><div class="ttdeci">uint32_t configured_subjective_signature_length_limit() const</div><div class="ttdef"><b>Definition</b> <a href="#l03342">controller.cpp:3342</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a7109e865e8dee8629db47f2503e351df"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a7109e865e8dee8629db47f2503e351df">sysio::chain::controller::light_validation_allowed</a></div><div class="ttdeci">bool light_validation_allowed() const</div><div class="ttdef"><b>Definition</b> <a href="#l03219">controller.cpp:3219</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a72b5d03a47c8644a68d625fc4dca44bf"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a72b5d03a47c8644a68d625fc4dca44bf">sysio::chain::controller::replace_account_keys</a></div><div class="ttdeci">void replace_account_keys(name account, name permission, const public_key_type &amp;key)</div><div class="ttdef"><b>Definition</b> <a href="#l03561">controller.cpp:3561</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a738dfae20ac656096578c8959746e126"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a738dfae20ac656096578c8959746e126">sysio::chain::controller::fork_db_head_block_producer</a></div><div class="ttdeci">account_name fork_db_head_block_producer() const</div><div class="ttdef"><b>Definition</b> <a href="#l02980">controller.cpp:2980</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a7408289ee5f740f797b9b9d9b192704a"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a7408289ee5f740f797b9b9d9b192704a">sysio::chain::controller::get_contract_whitelist</a></div><div class="ttdeci">const flat_set&lt; account_name &gt; &amp; get_contract_whitelist() const</div><div class="ttdef"><b>Definition</b> <a href="#l02896">controller.cpp:2896</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a7a7a09290738585cd0e05580eeba0a95"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a7a7a09290738585cd0e05580eeba0a95">sysio::chain::controller::pending_block_producer</a></div><div class="ttdeci">account_name pending_block_producer() const</div><div class="ttdef"><b>Definition</b> <a href="#l03018">controller.cpp:3018</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a7ac238f10e3a4ccf5c746a4e6a43b184"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a7ac238f10e3a4ccf5c746a4e6a43b184">sysio::chain::controller::pending_block_signing_authority</a></div><div class="ttdeci">const block_signing_authority &amp; pending_block_signing_authority() const</div><div class="ttdef"><b>Definition</b> <a href="#l03027">controller.cpp:3027</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a7b2f18a21e18a1bdc6837a567bb259eb"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a7b2f18a21e18a1bdc6837a567bb259eb">sysio::chain::controller::validate_db_available_size</a></div><div class="ttdeci">void validate_db_available_size() const</div><div class="ttdef"><b>Definition</b> <a href="#l03371">controller.cpp:3371</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a7d6e058e892e067510650db853794338"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a7d6e058e892e067510650db853794338">sysio::chain::controller::fetch_block_by_id</a></div><div class="ttdeci">signed_block_ptr fetch_block_by_id(block_id_type id) const</div><div class="ttdef"><b>Definition</b> <a href="#l03066">controller.cpp:3066</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a8160acef1ebb811902e1ad51f1161650"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a8160acef1ebb811902e1ad51f1161650">sysio::chain::controller::fork_db_head_block_time</a></div><div class="ttdeci">time_point fork_db_head_block_time() const</div><div class="ttdef"><b>Definition</b> <a href="#l02976">controller.cpp:2976</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a86e3c557fb55c04a7e469be06cce72ed"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a86e3c557fb55c04a7e469be06cce72ed">sysio::chain::controller::enable_deep_mind</a></div><div class="ttdeci">void enable_deep_mind(deep_mind_handler *logger)</div><div class="ttdef"><b>Definition</b> <a href="#l03464">controller.cpp:3464</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a878ff6368c473051417382a9d485030d"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a878ff6368c473051417382a9d485030d">sysio::chain::controller::last_irreversible_block_time</a></div><div class="ttdeci">time_point last_irreversible_block_time() const</div><div class="ttdef"><b>Definition</b> <a href="#l03054">controller.cpp:3054</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a888b36bb7d737244a2b200375b199247"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a888b36bb7d737244a2b200375b199247">sysio::chain::controller::get_wasm_interface</a></div><div class="ttdeci">wasm_interface &amp; get_wasm_interface()</div><div class="ttdef"><b>Definition</b> <a href="#l03299">controller.cpp:3299</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a8a195d27a416c714bdc058b7f1919267"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a8a195d27a416c714bdc058b7f1919267">sysio::chain::controller::get_action_blacklist</a></div><div class="ttdeci">const flat_set&lt; pair&lt; account_name, action_name &gt; &gt; &amp; get_action_blacklist() const</div><div class="ttdef"><b>Definition</b> <a href="#l02902">controller.cpp:2902</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a8ad92bdf81057887fdc4b732cb864bc4"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a8ad92bdf81057887fdc4b732cb864bc4">sysio::chain::controller::pending_producer_block_id</a></div><div class="ttdeci">std::optional&lt; block_id_type &gt; pending_producer_block_id() const</div><div class="ttdef"><b>Definition</b> <a href="#l03036">controller.cpp:3036</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a8b5124e077de1a73bb193e9c72b366b6"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a8b5124e077de1a73bb193e9c72b366b6">sysio::chain::controller::block_status</a></div><div class="ttdeci">block_status</div><div class="ttdef"><b>Definition</b> <a href="controller_8hpp_source.html#l00106">controller.hpp:106</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a8b5124e077de1a73bb193e9c72b366b6a5ed4e9858ad8d239145ef285b6210a00"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a8b5124e077de1a73bb193e9c72b366b6a5ed4e9858ad8d239145ef285b6210a00">sysio::chain::controller::block_status::incomplete</a></div><div class="ttdeci">@ incomplete</div><div class="ttdoc">this is an incomplete block (either being produced by a producer or speculatively produced by a node)</div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a8b5124e077de1a73bb193e9c72b366b6a7e6e4eb3ff27864637756cb4d2a2a45d"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a8b5124e077de1a73bb193e9c72b366b6a7e6e4eb3ff27864637756cb4d2a2a45d">sysio::chain::controller::block_status::irreversible</a></div><div class="ttdeci">@ irreversible</div><div class="ttdoc">this block has already been applied before by this node and is considered irreversible</div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a8b5124e077de1a73bb193e9c72b366b6ac9e825f4641cd3bec0ba01a0c2d67755"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a8b5124e077de1a73bb193e9c72b366b6ac9e825f4641cd3bec0ba01a0c2d67755">sysio::chain::controller::block_status::validated</a></div><div class="ttdeci">@ validated</div><div class="ttdoc">this is a complete block signed by a valid producer and has been previously applied by this node and ...</div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a8b5124e077de1a73bb193e9c72b366b6ad9a22d7a8178d5b42a8750123cbfe5b1"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a8b5124e077de1a73bb193e9c72b366b6ad9a22d7a8178d5b42a8750123cbfe5b1">sysio::chain::controller::block_status::complete</a></div><div class="ttdeci">@ complete</div><div class="ttdoc">this is a complete block signed by a valid producer but is not yet irreversible nor has it yet been a...</div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a8b86f2ee0fa63f9d01ee437f83b0e1d1"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a8b86f2ee0fa63f9d01ee437f83b0e1d1">sysio::chain::controller::get_terminate_at_block</a></div><div class="ttdeci">uint32_t get_terminate_at_block() const</div><div class="ttdef"><b>Definition</b> <a href="#l03285">controller.cpp:3285</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a8f7456b81f2657ccf6c39b35afb16af4"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a8f7456b81f2657ccf6c39b35afb16af4">sysio::chain::controller::get_authorization_manager</a></div><div class="ttdeci">const authorization_manager &amp; get_authorization_manager() const</div><div class="ttdef"><b>Definition</b> <a href="#l02591">controller.cpp:2591</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a904bf66cadfa73c918e9d835c819a524"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a904bf66cadfa73c918e9d835c819a524">sysio::chain::controller::set_contract_blacklist</a></div><div class="ttdeci">void set_contract_blacklist(const flat_set&lt; account_name &gt; &amp;)</div><div class="ttdef"><b>Definition</b> <a href="#l02918">controller.cpp:2918</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a90ac1d5081d727041b7bef384771fda9"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a90ac1d5081d727041b7bef384771fda9">sysio::chain::controller::finalize_block</a></div><div class="ttdeci">block_state_ptr finalize_block(const signer_callback_type &amp;signer_callback)</div><div class="ttdef"><b>Definition</b> <a href="#l02818">controller.cpp:2818</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a92e84ef71388fa365bcf17a4fbcce047"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a92e84ef71388fa365bcf17a4fbcce047">sysio::chain::controller::validate_tapos</a></div><div class="ttdeci">void validate_tapos(const transaction &amp;t) const</div><div class="ttdef"><b>Definition</b> <a href="#l03362">controller.cpp:3362</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a992401ccd9d3ecf5484c7d97bea18f51"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a992401ccd9d3ecf5484c7d97bea18f51">sysio::chain::controller::last_irreversible_block_id</a></div><div class="ttdeci">block_id_type last_irreversible_block_id() const</div><div class="ttdef"><b>Definition</b> <a href="#l03050">controller.cpp:3050</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a99c90ed934995116348fe891223e1037"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a99c90ed934995116348fe891223e1037">sysio::chain::controller::get_contract_blacklist</a></div><div class="ttdeci">const flat_set&lt; account_name &gt; &amp; get_contract_blacklist() const</div><div class="ttdef"><b>Definition</b> <a href="#l02899">controller.cpp:2899</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a9a55edb4766f1f3302ede12e329b1ea6"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a9a55edb4766f1f3302ede12e329b1ea6">sysio::chain::controller::get_block_id_for_num</a></div><div class="ttdeci">block_id_type get_block_id_for_num(uint32_t block_num) const</div><div class="ttdef"><b>Definition</b> <a href="#l03096">controller.cpp:3096</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a9d7c53697f9d587b6f2e583af9f7e712"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a9d7c53697f9d587b6f2e583af9f7e712">sysio::chain::controller::get_greylist_limit</a></div><div class="ttdeci">uint32_t get_greylist_limit() const</div><div class="ttdef"><b>Definition</b> <a href="#l03417">controller.cpp:3417</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_a9ebce710613bffd9b019b8d9fc15d20e"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#a9ebce710613bffd9b019b8d9fc15d20e">sysio::chain::controller::remove_resource_greylist</a></div><div class="ttdeci">void remove_resource_greylist(const account_name &amp;name)</div><div class="ttdef"><b>Definition</b> <a href="#l03425">controller.cpp:3425</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_aa1c6dcfae09e0e0ea50ba3fda8915114"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#aa1c6dcfae09e0e0ea50ba3fda8915114">sysio::chain::controller::is_resource_greylisted</a></div><div class="ttdeci">bool is_resource_greylisted(const account_name &amp;name) const</div><div class="ttdef"><b>Definition</b> <a href="#l03429">controller.cpp:3429</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_aa26307ee72e8095e9125f086ea570be9"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#aa26307ee72e8095e9125f086ea570be9">sysio::chain::controller::check_key_list</a></div><div class="ttdeci">void check_key_list(const public_key_type &amp;key) const</div><div class="ttdef"><b>Definition</b> <a href="#l03324">controller.cpp:3324</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_aa378f4265708c1bc41e4ee058ed71e6a"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#aa378f4265708c1bc41e4ee058ed71e6a">sysio::chain::controller::check_actor_list</a></div><div class="ttdeci">void check_actor_list(const flat_set&lt; account_name &gt; &amp;actors) const</div><div class="ttdef"><b>Definition</b> <a href="#l03312">controller.cpp:3312</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_aa62c0e462ac0a8c8b3345e59623ffad0"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#aa62c0e462ac0a8c8b3345e59623ffad0">sysio::chain::controller::get_chain_id</a></div><div class="ttdeci">chain_id_type get_chain_id() const</div><div class="ttdef"><b>Definition</b> <a href="#l03273">controller.cpp:3273</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_aa808acf858e93c567ff983ccbf8fb6d3"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#aa808acf858e93c567ff983ccbf8fb6d3">sysio::chain::controller::is_builtin_activated</a></div><div class="ttdeci">bool is_builtin_activated(builtin_protocol_feature_t f) const</div><div class="ttdef"><b>Definition</b> <a href="#l03385">controller.cpp:3385</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_aa82f197374a4e96fd3e952e18106eae9"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#aa82f197374a4e96fd3e952e18106eae9">sysio::chain::controller::sender_avoids_whitelist_blacklist_enforcement</a></div><div class="ttdeci">bool sender_avoids_whitelist_blacklist_enforcement(account_name sender) const</div><div class="ttdef"><b>Definition</b> <a href="#l03308">controller.cpp:3308</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_aabfe5c42521aa0550a5f5e60ec89fd19"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#aabfe5c42521aa0550a5f5e60ec89fd19">sysio::chain::controller::get_key_blacklist</a></div><div class="ttdeci">const flat_set&lt; public_key_type &gt; &amp; get_key_blacklist() const</div><div class="ttdef"><b>Definition</b> <a href="#l02905">controller.cpp:2905</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_aac87d5e13183ec45393587036b89a14a"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#aac87d5e13183ec45393587036b89a14a">sysio::chain::controller::get_resource_greylist</a></div><div class="ttdeci">const flat_set&lt; account_name &gt; &amp; get_resource_greylist() const</div><div class="ttdef"><b>Definition</b> <a href="#l03433">controller.cpp:3433</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_aade04f20db1bea1fbc9aa22a90cf87c0"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#aade04f20db1bea1fbc9aa22a90cf87c0">sysio::chain::controller::push_scheduled_transaction</a></div><div class="ttdeci">transaction_trace_ptr push_scheduled_transaction(const transaction_id_type &amp;scheduled, fc::time_point block_deadline, fc::microseconds max_transaction_time, uint32_t billed_cpu_time_us, bool explicit_billed_cpu_time)</div><div class="ttdef"><b>Definition</b> <a href="#l02881">controller.cpp:2881</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_aae65799cffdae12a65e38811b0c4d8b6"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#aae65799cffdae12a65e38811b0c4d8b6">sysio::chain::controller::get_account</a></div><div class="ttdeci">const account_object &amp; get_account(account_name n) const</div><div class="ttdef"><b>Definition</b> <a href="#l03303">controller.cpp:3303</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_ab156fd6d4e3f28e14373c8dbbeb5a0ed"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#ab156fd6d4e3f28e14373c8dbbeb5a0ed">sysio::chain::controller::set_contract_whitelist</a></div><div class="ttdeci">void set_contract_whitelist(const flat_set&lt; account_name &gt; &amp;)</div><div class="ttdef"><b>Definition</b> <a href="#l02915">controller.cpp:2915</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_ab4cab73bf67a1686c6c595e08a63b632"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#ab4cab73bf67a1686c6c595e08a63b632">sysio::chain::controller::set_proposed_producers</a></div><div class="ttdeci">int64_t set_proposed_producers(vector&lt; producer_authority &gt; producers)</div><div class="ttdef"><b>Definition</b> <a href="#l03128">controller.cpp:3128</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_ab75ec0f541f777960752f52f2a194294"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#ab75ec0f541f777960752f52f2a194294">sysio::chain::controller::earliest_available_block_num</a></div><div class="ttdeci">uint32_t earliest_available_block_num() const</div><div class="ttdef"><b>Definition</b> <a href="#l03469">controller.cpp:3469</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_aba5b781dfa681fa948e32470a76d0419"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#aba5b781dfa681fa948e32470a76d0419">sysio::chain::controller::fork_db_pending_head_block_time</a></div><div class="ttdeci">time_point fork_db_pending_head_block_time() const</div><div class="ttdef"><b>Definition</b> <a href="#l02992">controller.cpp:2992</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_abb1d81f96986df3bce46bd37caaf6a69"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#abb1d81f96986df3bce46bd37caaf6a69">sysio::chain::controller::pending_block_time</a></div><div class="ttdeci">time_point pending_block_time() const</div><div class="ttdef"><b>Definition</b> <a href="#l03000">controller.cpp:3000</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_abf042d0e964b46d1a401119d3575ff82"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#abf042d0e964b46d1a401119d3575ff82">sysio::chain::controller::validate_protocol_features</a></div><div class="ttdeci">void validate_protocol_features(const vector&lt; digest_type &gt; &amp;features_to_activate) const</div><div class="ttdef"><b>Definition</b> <a href="#l02774">controller.cpp:2774</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_ac5fbe5586943483c7d167bc0088098b1"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#ac5fbe5586943483c7d167bc0088098b1">sysio::chain::controller::applied_transaction</a></div><div class="ttdeci">signal&lt; void(std::tuple&lt; const transaction_trace_ptr &amp;, const packed_transaction_ptr &amp; &gt;)&gt; applied_transaction</div><div class="ttdef"><b>Definition</b> <a href="controller_8hpp_source.html#l00332">controller.hpp:332</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_ac81c5e33faa52c5a78a67fc2032ce1aa"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#ac81c5e33faa52c5a78a67fc2032ce1aa">sysio::chain::controller::get_preactivated_protocol_features</a></div><div class="ttdeci">vector&lt; digest_type &gt; get_preactivated_protocol_features() const</div><div class="ttdef"><b>Definition</b> <a href="#l02760">controller.cpp:2760</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_ac8d3310c59100f18efeb9a7007a21103"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#ac8d3310c59100f18efeb9a7007a21103">sysio::chain::controller::set_subjective_cpu_leeway</a></div><div class="ttdeci">void set_subjective_cpu_leeway(fc::microseconds leeway)</div><div class="ttdef"><b>Definition</b> <a href="#l03399">controller.cpp:3399</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_ac8eea0639eeef0fc0d304f645b80d884"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#ac8eea0639eeef0fc0d304f645b80d884">sysio::chain::controller::skip_db_sessions</a></div><div class="ttdeci">bool skip_db_sessions() const</div><div class="ttdef"><b>Definition</b> <a href="#l03253">controller.cpp:3253</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_ac9ea99fba10c923e5949b3949ac3283f"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#ac9ea99fba10c923e5949b3949ac3283f">sysio::chain::controller::replace_producer_keys</a></div><div class="ttdeci">void replace_producer_keys(const public_key_type &amp;key)</div><div class="ttdef"><b>Definition</b> <a href="#l03542">controller.cpp:3542</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_acd214861da435dc956d30c81de7c50ff"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#acd214861da435dc956d30c81de7c50ff">sysio::chain::controller::fetch_block_state_by_id</a></div><div class="ttdeci">block_state_ptr fetch_block_state_by_id(block_id_type id) const</div><div class="ttdef"><b>Definition</b> <a href="#l03083">controller.cpp:3083</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_ad0b710fd894bc8c7265b7e8c958df7bc"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#ad0b710fd894bc8c7265b7e8c958df7bc">sysio::chain::controller::add_resource_greylist</a></div><div class="ttdeci">void add_resource_greylist(const account_name &amp;name)</div><div class="ttdef"><b>Definition</b> <a href="#l03421">controller.cpp:3421</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_ad39b3fade2e84d4a743230a27c650f1f"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#ad39b3fade2e84d4a743230a27c650f1f">sysio::chain::controller::head_block_header</a></div><div class="ttdeci">const block_header &amp; head_block_header() const</div><div class="ttdef"><b>Definition</b> <a href="#l02961">controller.cpp:2961</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_ad5e154b110a034f3a6430f7827e9c4b3"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#ad5e154b110a034f3a6430f7827e9c4b3">sysio::chain::controller::is_known_unexpired_transaction</a></div><div class="ttdeci">bool is_known_unexpired_transaction(const transaction_id_type &amp;id) const</div><div class="ttdef"><b>Definition</b> <a href="#l03395">controller.cpp:3395</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_ad6f2e99d29c27a09b7f52101dde030db"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#ad6f2e99d29c27a09b7f52101dde030db">sysio::chain::controller::create_block_state_future</a></div><div class="ttdeci">std::future&lt; block_state_ptr &gt; create_block_state_future(const block_id_type &amp;id, const signed_block_ptr &amp;b)</div><div class="ttdef"><b>Definition</b> <a href="#l02855">controller.cpp:2855</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_ad6f4e938fb4b051c1d6b6c5cede09c76"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#ad6f4e938fb4b051c1d6b6c5cede09c76">sysio::chain::controller::get_pending_trx_receipts</a></div><div class="ttdeci">const vector&lt; transaction_receipt &gt; &amp; get_pending_trx_receipts() const</div><div class="ttdef"><b>Definition</b> <a href="#l03041">controller.cpp:3041</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_adbf19ff6a0a51a5d85e2be416a586dcc"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#adbf19ff6a0a51a5d85e2be416a586dcc">sysio::chain::controller::block_start</a></div><div class="ttdeci">signal&lt; void(uint32_t)&gt; block_start</div><div class="ttdef"><b>Definition</b> <a href="controller_8hpp_source.html#l00326">controller.hpp:326</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_add2453cf4d0208ca9f277337c9a5ed7a"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#add2453cf4d0208ca9f277337c9a5ed7a">sysio::chain::controller::get_mutable_resource_limits_manager</a></div><div class="ttdeci">resource_limits_manager &amp; get_mutable_resource_limits_manager()</div><div class="ttdef"><b>Definition</b> <a href="#l02586">controller.cpp:2586</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_ade2fbb6f840258b36eb12724ecb06314"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#ade2fbb6f840258b36eb12724ecb06314">sysio::chain::controller::fork_db</a></div><div class="ttdeci">const fork_database &amp; fork_db() const</div><div class="ttdef"><b>Definition</b> <a href="#l02650">controller.cpp:2650</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_ae0a1946cc6f7b87bd0cfa94bc9aa20b7"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#ae0a1946cc6f7b87bd0cfa94bc9aa20b7">sysio::chain::controller::active_producers</a></div><div class="ttdeci">const producer_authority_schedule &amp; active_producers() const</div><div class="ttdef"><b>Definition</b> <a href="#l03179">controller.cpp:3179</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_ae0a4a81d5d603085be18b54fb5a709b9"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#ae0a4a81d5d603085be18b54fb5a709b9">sysio::chain::controller::calculate_integrity_hash</a></div><div class="ttdeci">sha256 calculate_integrity_hash()</div><div class="ttdef"><b>Definition</b> <a href="#l03119">controller.cpp:3119</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_ae1ab54d0324632cd8826d35feb328204"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#ae1ab54d0324632cd8826d35feb328204">sysio::chain::controller::fork_db_head_block_num</a></div><div class="ttdeci">uint32_t fork_db_head_block_num() const</div><div class="ttdef"><b>Definition</b> <a href="#l02968">controller.cpp:2968</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_ae2572c1888aa71c5386d8d3fc7df75c5"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#ae2572c1888aa71c5386d8d3fc7df75c5">sysio::chain::controller::get_actor_whitelist</a></div><div class="ttdeci">const flat_set&lt; account_name &gt; &amp; get_actor_whitelist() const</div><div class="ttdef"><b>Definition</b> <a href="#l02890">controller.cpp:2890</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_ae60743ce36f1fa0912ff26b1da40afe6"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#ae60743ce36f1fa0912ff26b1da40afe6">sysio::chain::controller::convert_exception_to_error_code</a></div><div class="ttdeci">static std::optional&lt; uint64_t &gt; convert_exception_to_error_code(const fc::exception &amp;e)</div><div class="ttdef"><b>Definition</b> <a href="#l03478">controller.cpp:3478</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_aea3612e7cb52dfcaa2e6afdc1b3e2f51"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#aea3612e7cb52dfcaa2e6afdc1b3e2f51">sysio::chain::controller::head_block_time</a></div><div class="ttdeci">time_point head_block_time() const</div><div class="ttdef"><b>Definition</b> <a href="#l02952">controller.cpp:2952</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_af096f331aa6ac6b3fe3aa71b3768daa8"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#af096f331aa6ac6b3fe3aa71b3768daa8">sysio::chain::controller::get_resource_limits_manager</a></div><div class="ttdeci">const resource_limits_manager &amp; get_resource_limits_manager() const</div><div class="ttdoc">controller_impl</div><div class="ttdef"><b>Definition</b> <a href="#l02582">controller.cpp:2582</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_af1e44676760107bf3ed8979feb1d4f00"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#af1e44676760107bf3ed8979feb1d4f00">sysio::chain::controller::set_action_blacklist</a></div><div class="ttdeci">void set_action_blacklist(const flat_set&lt; pair&lt; account_name, action_name &gt; &gt; &amp;)</div><div class="ttdef"><b>Definition</b> <a href="#l02921">controller.cpp:2921</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_af22cf279943012cd05e62ba48d5e747a"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#af22cf279943012cd05e62ba48d5e747a">sysio::chain::controller::add_indices</a></div><div class="ttdeci">void add_indices()</div><div class="ttdef"><b>Definition</b> <a href="#l02630">controller.cpp:2630</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_af234ccfa5634942083d52efa1ff5a2ae"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#af234ccfa5634942083d52efa1ff5a2ae">sysio::chain::controller::get_subjective_cpu_leeway</a></div><div class="ttdeci">std::optional&lt; fc::microseconds &gt; get_subjective_cpu_leeway() const</div><div class="ttdef"><b>Definition</b> <a href="#l03403">controller.cpp:3403</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_af99330e9d5db1211d2c7cd7b3669830d"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#af99330e9d5db1211d2c7cd7b3669830d">sysio::chain::controller::all_subjective_mitigations_disabled</a></div><div class="ttdeci">bool all_subjective_mitigations_disabled() const</div><div class="ttdef"><b>Definition</b> <a href="#l03456">controller.cpp:3456</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_afa7e11a1dbbe3ae89d6220304a3e4bd3"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#afa7e11a1dbbe3ae89d6220304a3e4bd3">sysio::chain::controller::startup</a></div><div class="ttdeci">void startup(std::function&lt; void()&gt; shutdown, std::function&lt; bool()&gt; check_shutdown, const snapshot_reader_ptr &amp;snapshot)</div><div class="ttdef"><b>Definition</b> <a href="#l02634">controller.cpp:2634</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_afb3840481287ef2685e61375a44b0305"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#afb3840481287ef2685e61375a44b0305">sysio::chain::controller::contracts_console</a></div><div class="ttdeci">bool contracts_console() const</div><div class="ttdef"><b>Definition</b> <a href="#l03265">controller.cpp:3265</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_afc8b0aff5d6f215c336a682c83badf6e"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#afc8b0aff5d6f215c336a682c83badf6e">sysio::chain::controller::skip_trx_checks</a></div><div class="ttdeci">bool skip_trx_checks() const</div><div class="ttdef"><b>Definition</b> <a href="#l03242">controller.cpp:3242</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_afe391de926abcc0efbd938ac88bad300"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#afe391de926abcc0efbd938ac88bad300">sysio::chain::controller::controller</a></div><div class="ttdeci">controller(const config &amp;cfg, const chain_id_type &amp;chain_id)</div><div class="ttdef"><b>Definition</b> <a href="#l02610">controller.cpp:2610</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_afe40d1beedb5ec60de7e8d6575ba68ee"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#afe40d1beedb5ec60de7e8d6575ba68ee">sysio::chain::controller::start_block</a></div><div class="ttdeci">void start_block(block_timestamp_type time=block_timestamp_type(), uint16_t confirm_block_count=0)</div><div class="ttdef"><b>Definition</b> <a href="#l02780">controller.cpp:2780</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1controller_html_affb3f9edd37be65bd34a4d6a783051c0"><div class="ttname"><a href="classsysio_1_1chain_1_1controller.html#affb3f9edd37be65bd34a4d6a783051c0">sysio::chain::controller::check_contract_list</a></div><div class="ttdeci">void check_contract_list(account_name code) const</div><div class="ttdef"><b>Definition</b> <a href="#l03316">controller.cpp:3316</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1database__header__object_html"><div class="ttname"><a href="classsysio_1_1chain_1_1database__header__object.html">sysio::chain::database_header_object</a></div><div class="ttdoc">tracks the version of the application data stored in the database</div><div class="ttdef"><b>Definition</b> <a href="database__header__object_8hpp_source.html#l00016">database_header_object.hpp:17</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1deep__mind__handler_html"><div class="ttname"><a href="classsysio_1_1chain_1_1deep__mind__handler.html">sysio::chain::deep_mind_handler</a></div><div class="ttdef"><b>Definition</b> <a href="deep__mind_8hpp_source.html#l00045">deep_mind.hpp:46</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1dynamic__global__property__object_html"><div class="ttname"><a href="classsysio_1_1chain_1_1dynamic__global__property__object.html">sysio::chain::dynamic_global_property_object</a></div><div class="ttdoc">Maintains global state information that frequently change.</div><div class="ttdef"><b>Definition</b> <a href="global__property__object_8hpp_source.html#l00150">global_property_object.hpp:151</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1fork__database_html"><div class="ttname"><a href="classsysio_1_1chain_1_1fork__database.html">sysio::chain::fork_database</a></div><div class="ttdoc">manages light-weight state for all potential unconfirmed forks</div><div class="ttdef"><b>Definition</b> <a href="fork__database_8hpp_source.html#l00022">fork_database.hpp:22</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1fork__database_html_a16e619525d86741f3e5344b39ab91868"><div class="ttname"><a href="classsysio_1_1chain_1_1fork__database.html#a16e619525d86741f3e5344b39ab91868">sysio::chain::fork_database::pending_head</a></div><div class="ttdeci">block_state_ptr pending_head() const</div><div class="ttdef"><b>Definition</b> <a href="fork__database_8cpp_source.html#l00405">fork_database.cpp:405</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1fork__database_html_a17185d8543965b7cd40066019bbf5740"><div class="ttname"><a href="classsysio_1_1chain_1_1fork__database.html#a17185d8543965b7cd40066019bbf5740">sysio::chain::fork_database::search_on_branch</a></div><div class="ttdeci">block_state_ptr search_on_branch(const block_id_type &amp;h, uint32_t block_num) const</div><div class="ttdef"><b>Definition</b> <a href="fork__database_8cpp_source.html#l00433">fork_database.cpp:433</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1fork__database_html_a18e51b748469f97473d120ef69e1da22"><div class="ttname"><a href="classsysio_1_1chain_1_1fork__database.html#a18e51b748469f97473d120ef69e1da22">sysio::chain::fork_database::fetch_branch</a></div><div class="ttdeci">branch_type fetch_branch(const block_id_type &amp;h, uint32_t trim_after_block_num=std::numeric_limits&lt; uint32_t &gt;::max()) const</div><div class="ttdef"><b>Definition</b> <a href="fork__database_8cpp_source.html#l00418">fork_database.cpp:418</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1fork__database_html_a193f10ce12656c580b023d36193a5cdc"><div class="ttname"><a href="classsysio_1_1chain_1_1fork__database.html#a193f10ce12656c580b023d36193a5cdc">sysio::chain::fork_database::remove</a></div><div class="ttdeci">void remove(const block_id_type &amp;id)</div><div class="ttdoc">fetch_branch_from_impl</div><div class="ttdef"><b>Definition</b> <a href="fork__database_8cpp_source.html#l00517">fork_database.cpp:517</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1fork__database_html_a31db3526cc966f5db1046cebcfc45219"><div class="ttname"><a href="classsysio_1_1chain_1_1fork__database.html#a31db3526cc966f5db1046cebcfc45219">sysio::chain::fork_database::root</a></div><div class="ttdeci">block_state_ptr root() const</div><div class="ttdef"><b>Definition</b> <a href="fork__database_8cpp_source.html#l00395">fork_database.cpp:395</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1fork__database_html_a378b089fe1ff7ac016ee51058ff52cb2"><div class="ttname"><a href="classsysio_1_1chain_1_1fork__database.html#a378b089fe1ff7ac016ee51058ff52cb2">sysio::chain::fork_database::open</a></div><div class="ttdeci">void open(const std::function&lt; void(block_timestamp_type, const flat_set&lt; digest_type &gt; &amp;, const vector&lt; digest_type &gt; &amp;)&gt; &amp;validator)</div><div class="ttdef"><b>Definition</b> <a href="fork__database_8cpp_source.html#l00105">fork_database.cpp:105</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1fork__database_html_a3b128a7d57c262ef6351d83c16cffae3"><div class="ttname"><a href="classsysio_1_1chain_1_1fork__database.html#a3b128a7d57c262ef6351d83c16cffae3">sysio::chain::fork_database::head</a></div><div class="ttdeci">block_state_ptr head() const</div><div class="ttdef"><b>Definition</b> <a href="fork__database_8cpp_source.html#l00400">fork_database.cpp:400</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1fork__database_html_a611cc70b13dee823c43ffe99df5522d4"><div class="ttname"><a href="classsysio_1_1chain_1_1fork__database.html#a611cc70b13dee823c43ffe99df5522d4">sysio::chain::fork_database::rollback_head_to_root</a></div><div class="ttdeci">void rollback_head_to_root()</div><div class="ttdef"><b>Definition</b> <a href="fork__database_8cpp_source.html#l00276">fork_database.cpp:276</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1fork__database_html_a681f9146e0afd70a0e8c0421efb0a41f"><div class="ttname"><a href="classsysio_1_1chain_1_1fork__database.html#a681f9146e0afd70a0e8c0421efb0a41f">sysio::chain::fork_database::get_block_header</a></div><div class="ttdeci">block_header_state_ptr get_block_header(const block_id_type &amp;id) const</div><div class="ttdef"><b>Definition</b> <a href="fork__database_8cpp_source.html#l00331">fork_database.cpp:331</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1fork__database_html_a764fc46000bb93901ba6440fec07b5f9"><div class="ttname"><a href="classsysio_1_1chain_1_1fork__database.html#a764fc46000bb93901ba6440fec07b5f9">sysio::chain::fork_database::mark_valid</a></div><div class="ttdeci">void mark_valid(const block_state_ptr &amp;h)</div><div class="ttdef"><b>Definition</b> <a href="fork__database_8cpp_source.html#l00543">fork_database.cpp:543</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1fork__database_html_a77f152572f2703a40e9c198456fad748"><div class="ttname"><a href="classsysio_1_1chain_1_1fork__database.html#a77f152572f2703a40e9c198456fad748">sysio::chain::fork_database::fetch_branch_from</a></div><div class="ttdeci">pair&lt; branch_type, branch_type &gt; fetch_branch_from(const block_id_type &amp;first, const block_id_type &amp;second) const</div><div class="ttdef"><b>Definition</b> <a href="fork__database_8cpp_source.html#l00451">fork_database.cpp:451</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1fork__database_html_a7dd3012e6d7e68e24b2f223d5be09c02"><div class="ttname"><a href="classsysio_1_1chain_1_1fork__database.html#a7dd3012e6d7e68e24b2f223d5be09c02">sysio::chain::fork_database::reset</a></div><div class="ttdeci">void reset(const block_header_state &amp;root_bhs)</div><div class="ttdef"><b>Definition</b> <a href="fork__database_8cpp_source.html#l00263">fork_database.cpp:263</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1fork__database_html_a97cf1402b71020048ae0054e4d7c8079"><div class="ttname"><a href="classsysio_1_1chain_1_1fork__database.html#a97cf1402b71020048ae0054e4d7c8079">sysio::chain::fork_database::add</a></div><div class="ttdeci">void add(const block_state_ptr &amp;next_block, bool ignore_duplicate=false)</div><div class="ttdef"><b>Definition</b> <a href="fork__database_8cpp_source.html#l00385">fork_database.cpp:385</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1fork__database_html_ae911acbc996994cb6dfd21fddfb89a45"><div class="ttname"><a href="classsysio_1_1chain_1_1fork__database.html#ae911acbc996994cb6dfd21fddfb89a45">sysio::chain::fork_database::advance_root</a></div><div class="ttdeci">void advance_root(const block_id_type &amp;id)</div><div class="ttdef"><b>Definition</b> <a href="fork__database_8cpp_source.html#l00293">fork_database.cpp:293</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1fork__database_html_aee9daa00e2698a868ad36853e58d3908"><div class="ttname"><a href="classsysio_1_1chain_1_1fork__database.html#aee9daa00e2698a868ad36853e58d3908">sysio::chain::fork_database::get_block</a></div><div class="ttdeci">block_state_ptr get_block(const block_id_type &amp;id) const</div><div class="ttdef"><b>Definition</b> <a href="fork__database_8cpp_source.html#l00568">fork_database.cpp:568</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1generated__transaction__object_html"><div class="ttname"><a href="classsysio_1_1chain_1_1generated__transaction__object.html">sysio::chain::generated_transaction_object</a></div><div class="ttdef"><b>Definition</b> <a href="generated__transaction__object_8hpp_source.html#l00022">generated_transaction_object.hpp:23</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1generated__transaction_html"><div class="ttname"><a href="classsysio_1_1chain_1_1generated__transaction.html">sysio::chain::generated_transaction</a></div><div class="ttdef"><b>Definition</b> <a href="generated__transaction__object_8hpp_source.html#l00078">generated_transaction_object.hpp:79</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1generated__transaction_html_a01a19b0ce89dd3ef4a668455365a7c0a"><div class="ttname"><a href="classsysio_1_1chain_1_1generated__transaction.html#a01a19b0ce89dd3ef4a668455365a7c0a">sysio::chain::generated_transaction::published</a></div><div class="ttdeci">time_point published</div><div class="ttdoc">this generated transaction will not be applied after this time</div><div class="ttdef"><b>Definition</b> <a href="generated__transaction__object_8hpp_source.html#l00101">generated_transaction_object.hpp:101</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1generated__transaction_html_a6908b60ff3382855ee46b8c1e0ab2690"><div class="ttname"><a href="classsysio_1_1chain_1_1generated__transaction.html#a6908b60ff3382855ee46b8c1e0ab2690">sysio::chain::generated_transaction::sender</a></div><div class="ttdeci">account_name sender</div><div class="ttdef"><b>Definition</b> <a href="generated__transaction__object_8hpp_source.html#l00096">generated_transaction_object.hpp:96</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1generated__transaction_html_abe73e701a3935f3369f212a744c9a6cc"><div class="ttname"><a href="classsysio_1_1chain_1_1generated__transaction.html#abe73e701a3935f3369f212a744c9a6cc">sysio::chain::generated_transaction::trx_id</a></div><div class="ttdeci">transaction_id_type trx_id</div><div class="ttdef"><b>Definition</b> <a href="generated__transaction__object_8hpp_source.html#l00095">generated_transaction_object.hpp:95</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1generated__transaction_html_ae7161050b7f947df1748a6c1ae0cba5d"><div class="ttname"><a href="classsysio_1_1chain_1_1generated__transaction.html#ae7161050b7f947df1748a6c1ae0cba5d">sysio::chain::generated_transaction::packed_trx</a></div><div class="ttdeci">vector&lt; char &gt; packed_trx</div><div class="ttdef"><b>Definition</b> <a href="generated__transaction__object_8hpp_source.html#l00102">generated_transaction_object.hpp:102</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1generated__transaction_html_af49dc304254627bac1f43fc182b143e8"><div class="ttname"><a href="classsysio_1_1chain_1_1generated__transaction.html#af49dc304254627bac1f43fc182b143e8">sysio::chain::generated_transaction::sender_id</a></div><div class="ttdeci">uint128_t sender_id</div><div class="ttdef"><b>Definition</b> <a href="generated__transaction__object_8hpp_source.html#l00097">generated_transaction_object.hpp:97</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1global__property__object_html"><div class="ttname"><a href="classsysio_1_1chain_1_1global__property__object.html">sysio::chain::global_property_object</a></div><div class="ttdoc">Maintains global state information about block producer schedules and chain configuration parameters.</div><div class="ttdef"><b>Definition</b> <a href="global__property__object_8hpp_source.html#l00063">global_property_object.hpp:64</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1global__property__object_html_a7f149fcf87034217c899838eb4430496"><div class="ttname"><a href="classsysio_1_1chain_1_1global__property__object.html#a7f149fcf87034217c899838eb4430496">sysio::chain::global_property_object::configuration</a></div><div class="ttdeci">chain_config configuration</div><div class="ttdef"><b>Definition</b> <a href="global__property__object_8hpp_source.html#l00071">global_property_object.hpp:71</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1index__set_html"><div class="ttname"><a href="classsysio_1_1chain_1_1index__set.html">sysio::chain::index_set</a></div><div class="ttdef"><b>Definition</b> <a href="database__utils_8hpp_source.html#l00010">database_utils.hpp:10</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1index__utils_html_a20f6cbb7f55f78ff4d35a4bf7e928a86"><div class="ttname"><a href="classsysio_1_1chain_1_1index__utils.html#a20f6cbb7f55f78ff4d35a4bf7e928a86">sysio::chain::index_utils::walk</a></div><div class="ttdeci">static void walk(const chainbase::database &amp;db, F function)</div><div class="ttdef"><b>Definition</b> <a href="database__utils_8hpp_source.html#l00018">database_utils.hpp:18</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1index__utils_html_a4ba170946682ddcea81d558b0ee8899a"><div class="ttname"><a href="classsysio_1_1chain_1_1index__utils.html#a4ba170946682ddcea81d558b0ee8899a">sysio::chain::index_utils::create</a></div><div class="ttdeci">static void create(chainbase::database &amp;db, F cons)</div><div class="ttdef"><b>Definition</b> <a href="database__utils_8hpp_source.html#l00050">database_utils.hpp:50</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1maybe__session_html"><div class="ttname"><a href="classsysio_1_1chain_1_1maybe__session.html">sysio::chain::maybe_session</a></div><div class="ttdef"><b>Definition</b> <a href="#l00066">controller.cpp:66</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1maybe__session_html_a142562a4ca875304802fc6d2cc41d669"><div class="ttname"><a href="classsysio_1_1chain_1_1maybe__session.html#a142562a4ca875304802fc6d2cc41d669">sysio::chain::maybe_session::operator=</a></div><div class="ttdeci">maybe_session &amp; operator=(maybe_session &amp;&amp;mv)</div><div class="ttdef"><b>Definition</b> <a href="#l00096">controller.cpp:96</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1maybe__session_html_a1e5c5b89d2b1fac7f982ede7f0b1b545"><div class="ttname"><a href="classsysio_1_1chain_1_1maybe__session.html#a1e5c5b89d2b1fac7f982ede7f0b1b545">sysio::chain::maybe_session::squash</a></div><div class="ttdeci">void squash()</div><div class="ttdef"><b>Definition</b> <a href="#l00081">controller.cpp:81</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1maybe__session_html_a438e4a87d88afef121f9a2c9c89e30c8"><div class="ttname"><a href="classsysio_1_1chain_1_1maybe__session.html#a438e4a87d88afef121f9a2c9c89e30c8">sysio::chain::maybe_session::maybe_session</a></div><div class="ttdeci">maybe_session(database &amp;db)</div><div class="ttdef"><b>Definition</b> <a href="#l00075">controller.cpp:75</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1maybe__session_html_a58384b7d055e54178bda99e67c165878"><div class="ttname"><a href="classsysio_1_1chain_1_1maybe__session.html#a58384b7d055e54178bda99e67c165878">sysio::chain::maybe_session::maybe_session</a></div><div class="ttdeci">maybe_session()=default</div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1maybe__session_html_a749517d619768ab8885fc8e2785e3b40"><div class="ttname"><a href="classsysio_1_1chain_1_1maybe__session.html#a749517d619768ab8885fc8e2785e3b40">sysio::chain::maybe_session::undo</a></div><div class="ttdeci">void undo()</div><div class="ttdef"><b>Definition</b> <a href="#l00086">controller.cpp:86</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1maybe__session_html_aaba101b94bc3ac6f5f3a88b1ceba284a"><div class="ttname"><a href="classsysio_1_1chain_1_1maybe__session.html#aaba101b94bc3ac6f5f3a88b1ceba284a">sysio::chain::maybe_session::maybe_session</a></div><div class="ttdeci">maybe_session(const maybe_session &amp;)=delete</div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1maybe__session_html_ab35e3889eb7fd6cd0c65d2d349111050"><div class="ttname"><a href="classsysio_1_1chain_1_1maybe__session.html#ab35e3889eb7fd6cd0c65d2d349111050">sysio::chain::maybe_session::push</a></div><div class="ttdeci">void push()</div><div class="ttdef"><b>Definition</b> <a href="#l00091">controller.cpp:91</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1maybe__session_html_afcc5601bfdefa774205a1dd4845eba73"><div class="ttname"><a href="classsysio_1_1chain_1_1maybe__session.html#afcc5601bfdefa774205a1dd4845eba73">sysio::chain::maybe_session::maybe_session</a></div><div class="ttdeci">maybe_session(maybe_session &amp;&amp;other)</div><div class="ttdef"><b>Definition</b> <a href="#l00070">controller.cpp:70</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1named__thread__pool_html"><div class="ttname"><a href="classsysio_1_1chain_1_1named__thread__pool.html">sysio::chain::named_thread_pool</a></div><div class="ttdef"><b>Definition</b> <a href="thread__utils_8hpp_source.html#l00016">thread_utils.hpp:16</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1named__thread__pool_html_a2cf9d662cfa57de6d29cd900f8375208"><div class="ttname"><a href="classsysio_1_1chain_1_1named__thread__pool.html#a2cf9d662cfa57de6d29cd900f8375208">sysio::chain::named_thread_pool::stop</a></div><div class="ttdeci">void stop()</div><div class="ttdef"><b>Definition</b> <a href="thread__utils_8cpp_source.html#l00028">thread_utils.cpp:28</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1named__thread__pool_html_ae2f5fa4611193d13bb40e34708d897ea"><div class="ttname"><a href="classsysio_1_1chain_1_1named__thread__pool.html#ae2f5fa4611193d13bb40e34708d897ea">sysio::chain::named_thread_pool::get_executor</a></div><div class="ttdeci">boost::asio::io_context &amp; get_executor()</div><div class="ttdef"><b>Definition</b> <a href="thread__utils_8hpp_source.html#l00025">thread_utils.hpp:25</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1permission__object_html"><div class="ttname"><a href="classsysio_1_1chain_1_1permission__object.html">sysio::chain::permission_object</a></div><div class="ttdef"><b>Definition</b> <a href="permission__object_8hpp_source.html#l00025">permission_object.hpp:25</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1protocol__feature__manager_html"><div class="ttname"><a href="classsysio_1_1chain_1_1protocol__feature__manager.html">sysio::chain::protocol_feature_manager</a></div><div class="ttdef"><b>Definition</b> <a href="protocol__feature__manager_8hpp_source.html#l00265">protocol_feature_manager.hpp:265</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1protocol__feature__manager_html_a573b85f64307919aa077810980b74b43"><div class="ttname"><a href="classsysio_1_1chain_1_1protocol__feature__manager.html#a573b85f64307919aa077810980b74b43">sysio::chain::protocol_feature_manager::init</a></div><div class="ttdeci">void init(chainbase::database &amp;db)</div><div class="ttdef"><b>Definition</b> <a href="protocol__feature__manager_8cpp_source.html#l00588">protocol_feature_manager.cpp:588</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1protocol__feature__manager_html_a5b8ed9cc5cb5822d6cb645a3b7a5f98c"><div class="ttname"><a href="classsysio_1_1chain_1_1protocol__feature__manager.html#a5b8ed9cc5cb5822d6cb645a3b7a5f98c">sysio::chain::protocol_feature_manager::popped_blocks_to</a></div><div class="ttdeci">void popped_blocks_to(uint32_t block_num)</div><div class="ttdef"><b>Definition</b> <a href="protocol__feature__manager_8cpp_source.html#l00773">protocol_feature_manager.cpp:773</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1protocol__feature__manager_html_a9e6c1310749c4fd04035aa2c01310ce4"><div class="ttname"><a href="classsysio_1_1chain_1_1protocol__feature__manager.html#a9e6c1310749c4fd04035aa2c01310ce4">sysio::chain::protocol_feature_manager::get_protocol_feature_set</a></div><div class="ttdeci">const protocol_feature_set &amp; get_protocol_feature_set() const</div><div class="ttdef"><b>Definition</b> <a href="protocol__feature__manager_8hpp_source.html#l00342">protocol_feature_manager.hpp:342</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1protocol__feature__manager_html_a9fd76dbd437aa9d52791de3e7893be48"><div class="ttname"><a href="classsysio_1_1chain_1_1protocol__feature__manager.html#a9fd76dbd437aa9d52791de3e7893be48">sysio::chain::protocol_feature_manager::activate_feature</a></div><div class="ttdeci">void activate_feature(const digest_type &amp;feature_digest, uint32_t current_block_num)</div><div class="ttdef"><b>Definition</b> <a href="protocol__feature__manager_8cpp_source.html#l00721">protocol_feature_manager.cpp:721</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1protocol__feature__set_html"><div class="ttname"><a href="classsysio_1_1chain_1_1protocol__feature__set.html">sysio::chain::protocol_feature_set</a></div><div class="ttdef"><b>Definition</b> <a href="protocol__feature__manager_8hpp_source.html#l00131">protocol_feature_manager.hpp:131</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1protocol__feature__set_html_a1d6d013242864bc12ae2a1f6fcc95427a075ae3d2fc31640504f814f60e5ef713"><div class="ttname"><a href="classsysio_1_1chain_1_1protocol__feature__set.html#a1d6d013242864bc12ae2a1f6fcc95427a075ae3d2fc31640504f814f60e5ef713">sysio::chain::protocol_feature_set::recognized_t::disabled</a></div><div class="ttdeci">@ disabled</div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1protocol__feature__set_html_a1d6d013242864bc12ae2a1f6fcc95427a5d203566b82250f4113257b6db12e488"><div class="ttname"><a href="classsysio_1_1chain_1_1protocol__feature__set.html#a1d6d013242864bc12ae2a1f6fcc95427a5d203566b82250f4113257b6db12e488">sysio::chain::protocol_feature_set::recognized_t::too_early</a></div><div class="ttdeci">@ too_early</div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1protocol__feature__set_html_a1d6d013242864bc12ae2a1f6fcc95427a96d8e9e3b92248258403f7fc4cb25644"><div class="ttname"><a href="classsysio_1_1chain_1_1protocol__feature__set.html#a1d6d013242864bc12ae2a1f6fcc95427a96d8e9e3b92248258403f7fc4cb25644">sysio::chain::protocol_feature_set::recognized_t::unrecognized</a></div><div class="ttdeci">@ unrecognized</div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1protocol__feature__set_html_a1d6d013242864bc12ae2a1f6fcc95427ab2fdab230a2c39f3595a947861863cb7"><div class="ttname"><a href="classsysio_1_1chain_1_1protocol__feature__set.html#a1d6d013242864bc12ae2a1f6fcc95427ab2fdab230a2c39f3595a947861863cb7">sysio::chain::protocol_feature_set::recognized_t::ready</a></div><div class="ttdeci">@ ready</div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1protocol__state__object_html"><div class="ttname"><a href="classsysio_1_1chain_1_1protocol__state__object.html">sysio::chain::protocol_state_object</a></div><div class="ttdoc">Maintains global state information about consensus protocol rules.</div><div class="ttdef"><b>Definition</b> <a href="protocol__state__object_8hpp_source.html#l00017">protocol_state_object.hpp:18</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1protocol__state__object_html_af9aaf45cddecb84f71b527784984b83a"><div class="ttname"><a href="classsysio_1_1chain_1_1protocol__state__object.html#af9aaf45cddecb84f71b527784984b83a">sysio::chain::protocol_state_object::preactivated_protocol_features</a></div><div class="ttdeci">shared_vector&lt; digest_type &gt; preactivated_protocol_features</div><div class="ttdef"><b>Definition</b> <a href="protocol__state__object_8hpp_source.html#l00041">protocol_state_object.hpp:41</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1resource__limits_1_1resource__limits__manager_html"><div class="ttname"><a href="classsysio_1_1chain_1_1resource__limits_1_1resource__limits__manager.html">sysio::chain::resource_limits::resource_limits_manager</a></div><div class="ttdef"><b>Definition</b> <a href="resource__limits_8hpp_source.html#l00061">resource_limits.hpp:61</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1resource__limits_1_1resource__limits__manager_html_a1b9d0326965430166923c2241a3a6a45"><div class="ttname"><a href="classsysio_1_1chain_1_1resource__limits_1_1resource__limits__manager.html#a1b9d0326965430166923c2241a3a6a45">sysio::chain::resource_limits::resource_limits_manager::initialize_database</a></div><div class="ttdeci">void initialize_database()</div><div class="ttdef"><b>Definition</b> <a href="resource__limits_8cpp_source.html#l00055">resource_limits.cpp:55</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1resource__limits_1_1resource__limits__manager_html_a30cd4db6f08948e05aba424431ec0605"><div class="ttname"><a href="classsysio_1_1chain_1_1resource__limits_1_1resource__limits__manager.html#a30cd4db6f08948e05aba424431ec0605">sysio::chain::resource_limits::resource_limits_manager::initialize_account</a></div><div class="ttdeci">void initialize_account(const account_name &amp;account)</div><div class="ttdef"><b>Definition</b> <a href="resource__limits_8cpp_source.html#l00096">resource_limits.cpp:96</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1resource__limits_1_1resource__limits__manager_html_a32baa74135a1423302de3a849dc8b40c"><div class="ttname"><a href="classsysio_1_1chain_1_1resource__limits_1_1resource__limits__manager.html#a32baa74135a1423302de3a849dc8b40c">sysio::chain::resource_limits::resource_limits_manager::read_from_snapshot</a></div><div class="ttdeci">void read_from_snapshot(const snapshot_reader_ptr &amp;snapshot)</div><div class="ttdef"><b>Definition</b> <a href="resource__limits_8cpp_source.html#l00083">resource_limits.cpp:83</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1resource__limits_1_1resource__limits__manager_html_a4396d0acb70ebbd8054b13ff4c564e20"><div class="ttname"><a href="classsysio_1_1chain_1_1resource__limits_1_1resource__limits__manager.html#a4396d0acb70ebbd8054b13ff4c564e20">sysio::chain::resource_limits::resource_limits_manager::set_block_parameters</a></div><div class="ttdeci">void set_block_parameters(const elastic_limit_parameters &amp;cpu_limit_parameters, const elastic_limit_parameters &amp;net_limit_parameters)</div><div class="ttdef"><b>Definition</b> <a href="resource__limits_8cpp_source.html#l00109">resource_limits.cpp:109</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1resource__limits_1_1resource__limits__manager_html_a5ebf5f04366d7120f58430d9ba4f8c7a"><div class="ttname"><a href="classsysio_1_1chain_1_1resource__limits_1_1resource__limits__manager.html#a5ebf5f04366d7120f58430d9ba4f8c7a">sysio::chain::resource_limits::resource_limits_manager::process_block_usage</a></div><div class="ttdeci">void process_block_usage(uint32_t block_num)</div><div class="ttdef"><b>Definition</b> <a href="resource__limits_8cpp_source.html#l00363">resource_limits.cpp:363</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1resource__limits_1_1resource__limits__manager_html_a7160417d30f5ef3a91467fefebf65dc6"><div class="ttname"><a href="classsysio_1_1chain_1_1resource__limits_1_1resource__limits__manager.html#a7160417d30f5ef3a91467fefebf65dc6">sysio::chain::resource_limits::resource_limits_manager::add_to_snapshot</a></div><div class="ttdeci">void add_to_snapshot(const snapshot_writer_ptr &amp;snapshot) const</div><div class="ttdef"><b>Definition</b> <a href="resource__limits_8cpp_source.html#l00073">resource_limits.cpp:73</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1resource__limits_1_1resource__limits__manager_html_a7fea1de6a3806590de0bda86e53c7995"><div class="ttname"><a href="classsysio_1_1chain_1_1resource__limits_1_1resource__limits__manager.html#a7fea1de6a3806590de0bda86e53c7995">sysio::chain::resource_limits::resource_limits_manager::add_pending_ram_usage</a></div><div class="ttdeci">void add_pending_ram_usage(const account_name account, int64_t ram_delta)</div><div class="ttdef"><b>Definition</b> <a href="resource__limits_8cpp_source.html#l00206">resource_limits.cpp:206</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1resource__limits_1_1resource__limits__manager_html_a983919d376e5757bceee573e52b3c571"><div class="ttname"><a href="classsysio_1_1chain_1_1resource__limits_1_1resource__limits__manager.html#a983919d376e5757bceee573e52b3c571">sysio::chain::resource_limits::resource_limits_manager::process_account_limit_updates</a></div><div class="ttdeci">void process_account_limit_updates()</div><div class="ttdef"><b>Definition</b> <a href="resource__limits_8cpp_source.html#l00320">resource_limits.cpp:320</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1resource__limits_1_1resource__limits__manager_html_aaa7345adbf341592a81c087c50655597"><div class="ttname"><a href="classsysio_1_1chain_1_1resource__limits_1_1resource__limits__manager.html#aaa7345adbf341592a81c087c50655597">sysio::chain::resource_limits::resource_limits_manager::update_account_usage</a></div><div class="ttdeci">void update_account_usage(const flat_set&lt; account_name &gt; &amp;accounts, uint32_t ordinal)</div><div class="ttdef"><b>Definition</b> <a href="resource__limits_8cpp_source.html#l00125">resource_limits.cpp:125</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1resource__limits_1_1resource__limits__manager_html_acc5c0d662f97873d93dadbf8b6451978"><div class="ttname"><a href="classsysio_1_1chain_1_1resource__limits_1_1resource__limits__manager.html#acc5c0d662f97873d93dadbf8b6451978">sysio::chain::resource_limits::resource_limits_manager::add_indices</a></div><div class="ttdeci">void add_indices()</div><div class="ttdef"><b>Definition</b> <a href="resource__limits_8cpp_source.html#l00051">resource_limits.cpp:51</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1resource__limits_1_1resource__limits__manager_html_ae6e413bd0a6e43b36deff7aacdd0bfd6"><div class="ttname"><a href="classsysio_1_1chain_1_1resource__limits_1_1resource__limits__manager.html#ae6e413bd0a6e43b36deff7aacdd0bfd6">sysio::chain::resource_limits::resource_limits_manager::add_transaction_usage</a></div><div class="ttdeci">void add_transaction_usage(const flat_set&lt; account_name &gt; &amp;accounts, uint64_t cpu_usage, uint64_t net_usage, uint32_t ordinal)</div><div class="ttdef"><b>Definition</b> <a href="resource__limits_8cpp_source.html#l00136">resource_limits.cpp:136</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1resource__limits_1_1resource__limits__manager_html_ae7d1b3c435910424a1142b052a8774be"><div class="ttname"><a href="classsysio_1_1chain_1_1resource__limits_1_1resource__limits__manager.html#ae7d1b3c435910424a1142b052a8774be">sysio::chain::resource_limits::resource_limits_manager::get_account_ram_usage</a></div><div class="ttdeci">int64_t get_account_ram_usage(const account_name &amp;name) const</div><div class="ttdef"><b>Definition</b> <a href="resource__limits_8cpp_source.html#l00239">resource_limits.cpp:239</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1resource__limits_1_1resource__limits__manager_html_af72734af83f353fae77fbf837776db10"><div class="ttname"><a href="classsysio_1_1chain_1_1resource__limits_1_1resource__limits__manager.html#af72734af83f353fae77fbf837776db10">sysio::chain::resource_limits::resource_limits_manager::verify_account_ram_usage</a></div><div class="ttdeci">void verify_account_ram_usage(const account_name accunt) const</div><div class="ttdef"><b>Definition</b> <a href="resource__limits_8cpp_source.html#l00227">resource_limits.cpp:227</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1snapshot__reader_html"><div class="ttname"><a href="classsysio_1_1chain_1_1snapshot__reader.html">sysio::chain::snapshot_reader</a></div><div class="ttdef"><b>Definition</b> <a href="snapshot_8hpp_source.html#l00224">snapshot.hpp:224</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1table__id__object_html"><div class="ttname"><a href="classsysio_1_1chain_1_1table__id__object.html">sysio::chain::table_id_object</a></div><div class="ttdoc">The table_id_object class tracks the mapping of (scope, code, table) to an opaque identifier.</div><div class="ttdef"><b>Definition</b> <a href="contract__table__objects_8hpp_source.html#l00015">contract_table_objects.hpp:15</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1transaction__context_html"><div class="ttname"><a href="classsysio_1_1chain_1_1transaction__context.html">sysio::chain::transaction_context</a></div><div class="ttdef"><b>Definition</b> <a href="transaction__context_8hpp_source.html#l00032">transaction_context.hpp:32</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1transaction__context_html_a01f9fd71b2b5511311c8817a8b32c845"><div class="ttname"><a href="classsysio_1_1chain_1_1transaction__context.html#a01f9fd71b2b5511311c8817a8b32c845">sysio::chain::transaction_context::exec</a></div><div class="ttdeci">void exec()</div><div class="ttdef"><b>Definition</b> <a href="transaction__context_8cpp_source.html#l00313">transaction_context.cpp:313</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1transaction__context_html_a03f76febe2160f0f23a5f60dae262184"><div class="ttname"><a href="classsysio_1_1chain_1_1transaction__context.html#a03f76febe2160f0f23a5f60dae262184">sysio::chain::transaction_context::init_for_deferred_trx</a></div><div class="ttdeci">void init_for_deferred_trx(fc::time_point published)</div><div class="ttdef"><b>Definition</b> <a href="transaction__context_8cpp_source.html#l00296">transaction_context.cpp:296</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1transaction__context_html_a05dbab6e9e0d4f3e30fa1392ac4430a1"><div class="ttname"><a href="classsysio_1_1chain_1_1transaction__context.html#a05dbab6e9e0d4f3e30fa1392ac4430a1">sysio::chain::transaction_context::explicit_billed_cpu_time</a></div><div class="ttdeci">bool explicit_billed_cpu_time</div><div class="ttdef"><b>Definition</b> <a href="transaction__context_8hpp_source.html#l00147">transaction_context.hpp:147</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1transaction__context_html_a08b550fccea696363035c6736c146436"><div class="ttname"><a href="classsysio_1_1chain_1_1transaction__context.html#a08b550fccea696363035c6736c146436">sysio::chain::transaction_context::billed_cpu_time_us</a></div><div class="ttdeci">int64_t billed_cpu_time_us</div><div class="ttdef"><b>Definition</b> <a href="transaction__context_8hpp_source.html#l00145">transaction_context.hpp:145</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1transaction__context_html_a1fafa59ca3817a6fc89466a7da19b72c"><div class="ttname"><a href="classsysio_1_1chain_1_1transaction__context.html#a1fafa59ca3817a6fc89466a7da19b72c">sysio::chain::transaction_context::leeway</a></div><div class="ttdeci">fc::microseconds leeway</div><div class="ttdef"><b>Definition</b> <a href="transaction__context_8hpp_source.html#l00144">transaction_context.hpp:144</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1transaction__context_html_a2f8dc57cb2e3562de132326b0d06e15d"><div class="ttname"><a href="classsysio_1_1chain_1_1transaction__context.html#a2f8dc57cb2e3562de132326b0d06e15d">sysio::chain::transaction_context::update_billed_cpu_time</a></div><div class="ttdeci">uint32_t update_billed_cpu_time(fc::time_point now)</div><div class="ttdef"><b>Definition</b> <a href="transaction__context_8cpp_source.html#l00565">transaction_context.cpp:565</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1transaction__context_html_a300b3d2c25e7de11562c579c41f43dda"><div class="ttname"><a href="classsysio_1_1chain_1_1transaction__context.html#a300b3d2c25e7de11562c579c41f43dda">sysio::chain::transaction_context::finalize</a></div><div class="ttdeci">void finalize()</div><div class="ttdef"><b>Definition</b> <a href="transaction__context_8cpp_source.html#l00340">transaction_context.cpp:340</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1transaction__context_html_a558e8aff8e48deb61fae7407e10e8788"><div class="ttname"><a href="classsysio_1_1chain_1_1transaction__context.html#a558e8aff8e48deb61fae7407e10e8788">sysio::chain::transaction_context::squash</a></div><div class="ttdeci">void squash()</div><div class="ttdef"><b>Definition</b> <a href="transaction__context_8cpp_source.html#l00396">transaction_context.cpp:396</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1transaction__context_html_a5631f6c990c61c078e0de6f0e53171be"><div class="ttname"><a href="classsysio_1_1chain_1_1transaction__context.html#a5631f6c990c61c078e0de6f0e53171be">sysio::chain::transaction_context::undo</a></div><div class="ttdeci">void undo()</div><div class="ttdef"><b>Definition</b> <a href="transaction__context_8cpp_source.html#l00400">transaction_context.cpp:400</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1transaction__context_html_a5d3d1260b6f77fdc4b6a8cef3417e94c"><div class="ttname"><a href="classsysio_1_1chain_1_1transaction__context.html#a5d3d1260b6f77fdc4b6a8cef3417e94c">sysio::chain::transaction_context::init_for_implicit_trx</a></div><div class="ttdeci">void init_for_implicit_trx(uint64_t initial_net_usage=0)</div><div class="ttdef"><b>Definition</b> <a href="transaction__context_8cpp_source.html#l00244">transaction_context.cpp:244</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1transaction__context_html_a708229aea669816e99b0039d716c3ed5"><div class="ttname"><a href="classsysio_1_1chain_1_1transaction__context.html#a708229aea669816e99b0039d716c3ed5">sysio::chain::transaction_context::block_deadline</a></div><div class="ttdeci">fc::time_point block_deadline</div><div class="ttdef"><b>Definition</b> <a href="transaction__context_8hpp_source.html#l00143">transaction_context.hpp:143</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1transaction__context_html_a7211fab425e4375e247c2a3d1924e63f"><div class="ttname"><a href="classsysio_1_1chain_1_1transaction__context.html#a7211fab425e4375e247c2a3d1924e63f">sysio::chain::transaction_context::trace</a></div><div class="ttdeci">transaction_trace_ptr trace</div><div class="ttdef"><b>Definition</b> <a href="transaction__context_8hpp_source.html#l00125">transaction_context.hpp:125</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1transaction__context_html_a73f4035fab7271fec7fcac5aa01bd461"><div class="ttname"><a href="classsysio_1_1chain_1_1transaction__context.html#a73f4035fab7271fec7fcac5aa01bd461">sysio::chain::transaction_context::delay</a></div><div class="ttdeci">fc::microseconds delay</div><div class="ttdef"><b>Definition</b> <a href="transaction__context_8hpp_source.html#l00138">transaction_context.hpp:138</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1transaction__context_html_a799e9208ec6d2ea3d1dfccfd4eb97cec"><div class="ttname"><a href="classsysio_1_1chain_1_1transaction__context.html#a799e9208ec6d2ea3d1dfccfd4eb97cec">sysio::chain::transaction_context::enforce_whiteblacklist</a></div><div class="ttdeci">bool enforce_whiteblacklist</div><div class="ttdef"><b>Definition</b> <a href="transaction__context_8hpp_source.html#l00141">transaction_context.hpp:141</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1transaction__context_html_a9c12181bd0bd8a5aea0200c80e7b00e7"><div class="ttname"><a href="classsysio_1_1chain_1_1transaction__context.html#a9c12181bd0bd8a5aea0200c80e7b00e7">sysio::chain::transaction_context::start</a></div><div class="ttdeci">fc::time_point start</div><div class="ttdef"><b>Definition</b> <a href="transaction__context_8hpp_source.html#l00126">transaction_context.hpp:126</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1transaction__context_html_aa16627a2b31f924e998137ba14f22123"><div class="ttname"><a href="classsysio_1_1chain_1_1transaction__context.html#aa16627a2b31f924e998137ba14f22123">sysio::chain::transaction_context::executed_action_receipt_digests</a></div><div class="ttdeci">vector&lt; digest_type &gt; executed_action_receipt_digests</div><div class="ttdef"><b>Definition</b> <a href="transaction__context_8hpp_source.html#l00131">transaction_context.hpp:131</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1transaction__context_html_ab8e1aaec319ed2ae90b6a6f499919c89"><div class="ttname"><a href="classsysio_1_1chain_1_1transaction__context.html#ab8e1aaec319ed2ae90b6a6f499919c89">sysio::chain::transaction_context::published</a></div><div class="ttdeci">fc::time_point published</div><div class="ttdef"><b>Definition</b> <a href="transaction__context_8hpp_source.html#l00128">transaction_context.hpp:128</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1transaction__context_html_ac178b3a7e2ef905025ae4e2f262422ff"><div class="ttname"><a href="classsysio_1_1chain_1_1transaction__context.html#ac178b3a7e2ef905025ae4e2f262422ff">sysio::chain::transaction_context::bill_to_accounts</a></div><div class="ttdeci">flat_set&lt; account_name &gt; bill_to_accounts</div><div class="ttdef"><b>Definition</b> <a href="transaction__context_8hpp_source.html#l00132">transaction_context.hpp:132</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1transaction__context_html_ad525fafe1ffad93dc767bf2b5b9ea0cc"><div class="ttname"><a href="classsysio_1_1chain_1_1transaction__context.html#ad525fafe1ffad93dc767bf2b5b9ea0cc">sysio::chain::transaction_context::max_bandwidth_billed_accounts_can_pay</a></div><div class="ttdeci">std::tuple&lt; int64_t, int64_t, bool, bool &gt; max_bandwidth_billed_accounts_can_pay(bool force_elastic_limits=false) const</div><div class="ttdef"><b>Definition</b> <a href="transaction__context_8cpp_source.html#l00574">transaction_context.cpp:574</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1transaction__context_html_adbf0d6f8a8a8d3b4544fafe24cd0a135"><div class="ttname"><a href="classsysio_1_1chain_1_1transaction__context.html#adbf0d6f8a8a8d3b4544fafe24cd0a135">sysio::chain::transaction_context::init_for_input_trx</a></div><div class="ttdeci">void init_for_input_trx(uint64_t packed_trx_unprunable_size, uint64_t packed_trx_prunable_size)</div><div class="ttdef"><b>Definition</b> <a href="transaction__context_8cpp_source.html#l00255">transaction_context.cpp:255</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1transaction__context_html_af80f48b601534a0adc286de6195e26a2"><div class="ttname"><a href="classsysio_1_1chain_1_1transaction__context.html#af80f48b601534a0adc286de6195e26a2">sysio::chain::transaction_context::subjective_cpu_bill_us</a></div><div class="ttdeci">int64_t subjective_cpu_bill_us</div><div class="ttdef"><b>Definition</b> <a href="transaction__context_8hpp_source.html#l00146">transaction_context.hpp:146</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1transaction__metadata_html_a122861328470aa67ebf9ac5cb798755d"><div class="ttname"><a href="classsysio_1_1chain_1_1transaction__metadata.html#a122861328470aa67ebf9ac5cb798755d">sysio::chain::transaction_metadata::start_recover_keys</a></div><div class="ttdeci">static recover_keys_future start_recover_keys(packed_transaction_ptr trx, boost::asio::io_context &amp;thread_pool, const chain_id_type &amp;chain_id, fc::microseconds time_limit, trx_type t, uint32_t max_variable_sig_size=UINT32_MAX)</div><div class="ttdef"><b>Definition</b> <a href="transaction__metadata_8cpp_source.html#l00007">transaction_metadata.cpp:7</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1transaction__metadata_html_a841053d8fa06ceea3cb8096625f053eda638a6d925c422c868b28b9562498ea1d"><div class="ttname"><a href="classsysio_1_1chain_1_1transaction__metadata.html#a841053d8fa06ceea3cb8096625f053eda638a6d925c422c868b28b9562498ea1d">sysio::chain::transaction_metadata::trx_type::scheduled</a></div><div class="ttdeci">@ scheduled</div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1transaction__metadata_html_a841053d8fa06ceea3cb8096625f053edaa43c1b0aa53a0c908810c06ab1ff3967"><div class="ttname"><a href="classsysio_1_1chain_1_1transaction__metadata.html#a841053d8fa06ceea3cb8096625f053edaa43c1b0aa53a0c908810c06ab1ff3967">sysio::chain::transaction_metadata::trx_type::input</a></div><div class="ttdeci">@ input</div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1transaction__metadata_html_a841053d8fa06ceea3cb8096625f053edacd1fed5e3277af3a9210b25059d86ff9"><div class="ttname"><a href="classsysio_1_1chain_1_1transaction__metadata.html#a841053d8fa06ceea3cb8096625f053edacd1fed5e3277af3a9210b25059d86ff9">sysio::chain::transaction_metadata::trx_type::implicit</a></div><div class="ttdeci">@ implicit</div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1transaction__metadata_html_acb14de2d02033c2d43c65319825d3d5b"><div class="ttname"><a href="classsysio_1_1chain_1_1transaction__metadata.html#acb14de2d02033c2d43c65319825d3d5b">sysio::chain::transaction_metadata::create_no_recover_keys</a></div><div class="ttdeci">static transaction_metadata_ptr create_no_recover_keys(packed_transaction_ptr trx, trx_type t)</div><div class="ttdef"><b>Definition</b> <a href="transaction__metadata_8hpp_source.html#l00086">transaction_metadata.hpp:86</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1transaction__object_html"><div class="ttname"><a href="classsysio_1_1chain_1_1transaction__object.html">sysio::chain::transaction_object</a></div><div class="ttdef"><b>Definition</b> <a href="transaction__object_8hpp_source.html#l00020">transaction_object.hpp:21</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1wasm__interface_html"><div class="ttname"><a href="classsysio_1_1chain_1_1wasm__interface.html">sysio::chain::wasm_interface</a></div><div class="ttdef"><b>Definition</b> <a href="wasm__interface_8hpp_source.html#l00025">wasm_interface.hpp:25</a></div></div>
<div class="ttc" id="aclasssysio_1_1chain_1_1wasm__interface_html_ab8938ee3dc1cd9964f4d13671f0058bd"><div class="ttname"><a href="classsysio_1_1chain_1_1wasm__interface.html#ab8938ee3dc1cd9964f4d13671f0058bd">sysio::chain::wasm_interface::current_lib</a></div><div class="ttdeci">void current_lib(const uint32_t lib)</div><div class="ttdef"><b>Definition</b> <a href="wasm__interface_8cpp_source.html#l00077">wasm_interface.cpp:77</a></div></div>
<div class="ttc" id="aclasssysio_1_1vm_1_1wasm__allocator_html"><div class="ttname"><a href="classsysio_1_1vm_1_1wasm__allocator.html">sysio::vm::wasm_allocator</a></div><div class="ttdef"><b>Definition</b> <a href="vm_2allocator_8hpp_source.html#l00409">allocator.hpp:409</a></div></div>
<div class="ttc" id="acode__cache_8cpp_html_aa0efefe21f4700d78692edc823e763be"><div class="ttname"><a href="code__cache_8cpp.html#aa0efefe21f4700d78692edc823e763be">id</a></div><div class="ttdeci">uint64_t id</div><div class="ttdef"><b>Definition</b> <a href="code__cache_8cpp_source.html#l00000">code_cache.cpp:0</a></div></div>
<div class="ttc" id="acode__object_8hpp_html"><div class="ttname"><a href="code__object_8hpp.html">code_object.hpp</a></div></div>
<div class="ttc" id="acontract__table__objects_8hpp_html"><div class="ttname"><a href="contract__table__objects_8hpp.html">contract_table_objects.hpp</a></div></div>
<div class="ttc" id="acontroller_8cpp_html_a903c4d2c725a565b423b8c7978ba252c"><div class="ttname"><a href="controller_8cpp.html#a903c4d2c725a565b423b8c7978ba252c">SET_APP_HANDLER</a></div><div class="ttdeci">#define SET_APP_HANDLER(receiver, contract, action)</div></div>
<div class="ttc" id="acontroller_8cpp_html_aefcef1ac3f0ac4f01876837e1e9f66d7"><div class="ttname"><a href="controller_8cpp.html#aefcef1ac3f0ac4f01876837e1e9f66d7">SYS_REPORT</a></div><div class="ttdeci">#define SYS_REPORT(DESC, A, B)</div></div>
<div class="ttc" id="acontroller_8hpp_html"><div class="ttname"><a href="controller_8hpp.html">controller.hpp</a></div></div>
<div class="ttc" id="adatabase__header__object_8hpp_html"><div class="ttname"><a href="database__header__object_8hpp.html">database_header_object.hpp</a></div></div>
<div class="ttc" id="adeep__mind_8hpp_html"><div class="ttname"><a href="deep__mind_8hpp.html">deep_mind.hpp</a></div></div>
<div class="ttc" id="adeep__mind_8hpp_html_aaaa2f1dbd522de03ccbaa73f01db5f50"><div class="ttname"><a href="deep__mind_8hpp.html#aaaa2f1dbd522de03ccbaa73f01db5f50">RAM_EVENT_ID</a></div><div class="ttdeci">#define RAM_EVENT_ID(FORMAT,...)</div><div class="ttdef"><b>Definition</b> <a href="deep__mind_8hpp_source.html#l00027">deep_mind.hpp:27</a></div></div>
<div class="ttc" id="aexception_8hpp_html_a094902280cad82ad6529ebbd12a697eb"><div class="ttname"><a href="exception_8hpp.html#a094902280cad82ad6529ebbd12a697eb">FC_CAPTURE_AND_RETHROW</a></div><div class="ttdeci">#define FC_CAPTURE_AND_RETHROW(...)</div><div class="ttdef"><b>Definition</b> <a href="exception_8hpp_source.html#l00523">exception.hpp:523</a></div></div>
<div class="ttc" id="aexception_8hpp_html_ae70bfa24f5a3bc0917382b3c17fc033c"><div class="ttname"><a href="exception_8hpp.html#ae70bfa24f5a3bc0917382b3c17fc033c">FC_LOG_AND_RETHROW</a></div><div class="ttdeci">#define FC_LOG_AND_RETHROW()</div><div class="ttdef"><b>Definition</b> <a href="exception_8hpp_source.html#l00411">exception.hpp:411</a></div></div>
<div class="ttc" id="afork__database_8hpp_html"><div class="ttname"><a href="fork__database_8hpp.html">fork_database.hpp</a></div></div>
<div class="ttc" id="agenerated__transaction__object_8hpp_html"><div class="ttname"><a href="generated__transaction__object_8hpp.html">generated_transaction_object.hpp</a></div></div>
<div class="ttc" id="agenesis__intrinsics_8hpp_html"><div class="ttname"><a href="genesis__intrinsics_8hpp.html">genesis_intrinsics.hpp</a></div></div>
<div class="ttc" id="aglobal__property__object_8hpp_html"><div class="ttname"><a href="global__property__object_8hpp.html">global_property_object.hpp</a></div></div>
<div class="ttc" id="ajson_8hpp_html"><div class="ttname"><a href="json_8hpp.html">json.hpp</a></div></div>
<div class="ttc" id="alib_8h_html_a02fd73d861ef2e4aabb38c0c9ff82947"><div class="ttname"><a href="lib_8h.html#a02fd73d861ef2e4aabb38c0c9ff82947">init</a></div><div class="ttdeci">void init()</div><div class="ttdef"><b>Definition</b> <a href="lib__test_8cpp_source.html#l00003">lib_test.cpp:3</a></div></div>
<div class="ttc" id="alogger_8hpp_html_a1759e5c9691d8ad754bdf5eff8bb23ac"><div class="ttname"><a href="logger_8hpp.html#a1759e5c9691d8ad754bdf5eff8bb23ac">wlog</a></div><div class="ttdeci">#define wlog(FORMAT,...)</div><div class="ttdef"><b>Definition</b> <a href="logger_8hpp_source.html#l00124">logger.hpp:124</a></div></div>
<div class="ttc" id="alogger_8hpp_html_a26aaf645dd9dc96836635d6b18bd1090"><div class="ttname"><a href="logger_8hpp.html#a26aaf645dd9dc96836635d6b18bd1090">edump</a></div><div class="ttdeci">#define edump(SEQ)</div><div class="ttdef"><b>Definition</b> <a href="logger_8hpp_source.html#l00162">logger.hpp:162</a></div></div>
<div class="ttc" id="alogger_8hpp_html_a3da1571bad6ca6c94df9a3660b2115ee"><div class="ttname"><a href="logger_8hpp.html#a3da1571bad6ca6c94df9a3660b2115ee">dlog</a></div><div class="ttdeci">#define dlog(FORMAT,...)</div><div class="ttdef"><b>Definition</b> <a href="logger_8hpp_source.html#l00101">logger.hpp:101</a></div></div>
<div class="ttc" id="alogger_8hpp_html_a831cf08dc63704c11fd154132c6e8bdb"><div class="ttname"><a href="logger_8hpp.html#a831cf08dc63704c11fd154132c6e8bdb">ilog</a></div><div class="ttdeci">#define ilog(FORMAT,...)</div><div class="ttdef"><b>Definition</b> <a href="logger_8hpp_source.html#l00118">logger.hpp:118</a></div></div>
<div class="ttc" id="alogger_8hpp_html_a9e3cdbaecd5a34b42956e888f7326fad"><div class="ttname"><a href="logger_8hpp.html#a9e3cdbaecd5a34b42956e888f7326fad">elog</a></div><div class="ttdeci">#define elog(FORMAT,...)</div><div class="ttdef"><b>Definition</b> <a href="logger_8hpp_source.html#l00130">logger.hpp:130</a></div></div>
<div class="ttc" id="alogger__config_8hpp_html"><div class="ttname"><a href="logger__config_8hpp.html">logger_config.hpp</a></div></div>
<div class="ttc" id="anamespacefc_1_1raw_html_a0b442d98ceb22dd5a6ae84745e43ffab"><div class="ttname"><a href="namespacefc_1_1raw.html#a0b442d98ceb22dd5a6ae84745e43ffab">fc::raw::unpack</a></div><div class="ttdeci">void unpack(Stream &amp;s, std::deque&lt; T &gt; &amp;value)</div><div class="ttdef"><b>Definition</b> <a href="raw_8hpp_source.html#l00540">raw.hpp:540</a></div></div>
<div class="ttc" id="anamespacefc_1_1raw_html_a3a18d8161aa5b4f4f02b6fcfdff5e5d1"><div class="ttname"><a href="namespacefc_1_1raw.html#a3a18d8161aa5b4f4f02b6fcfdff5e5d1">fc::raw::pack</a></div><div class="ttdeci">void pack(Stream &amp;s, const std::deque&lt; T &gt; &amp;value)</div><div class="ttdef"><b>Definition</b> <a href="raw_8hpp_source.html#l00531">raw.hpp:531</a></div></div>
<div class="ttc" id="anamespacefc_html_a219f556e23004060631ffb2baaeaff02"><div class="ttname"><a href="namespacefc.html#a219f556e23004060631ffb2baaeaff02">fc::move_append</a></div><div class="ttdeci">void move_append(Container &amp;dest, Container &amp;&amp;src)</div><div class="ttdef"><b>Definition</b> <a href="utility_8hpp_source.html#l00151">utility.hpp:151</a></div></div>
<div class="ttc" id="anamespacefc_html_a23d89b54a8ffd84f7e7efeb21747d846"><div class="ttname"><a href="namespacefc.html#a23d89b54a8ffd84f7e7efeb21747d846">fc::make_scoped_exit</a></div><div class="ttdeci">scoped_exit&lt; Callback &gt; make_scoped_exit(Callback &amp;&amp;c)</div><div class="ttdef"><b>Definition</b> <a href="scoped__exit_8hpp_source.html#l00035">scoped_exit.hpp:35</a></div></div>
<div class="ttc" id="anamespacefc_html_a3d8a2be677709cc41f09aa7925f2d55fa4eaf6936474fac52a87743f3de041c42"><div class="ttname"><a href="namespacefc.html#a3d8a2be677709cc41f09aa7925f2d55fa4eaf6936474fac52a87743f3de041c42">fc::read_write</a></div><div class="ttdeci">@ read_write</div><div class="ttdef"><b>Definition</b> <a href="file__mapping_8hpp_source.html#l00016">file_mapping.hpp:15</a></div></div>
<div class="ttc" id="anamespacefc_html_a3d8a2be677709cc41f09aa7925f2d55fad6bcd1364809e1b881bb22334d14cd56"><div class="ttname"><a href="namespacefc.html#a3d8a2be677709cc41f09aa7925f2d55fad6bcd1364809e1b881bb22334d14cd56">fc::read_only</a></div><div class="ttdeci">@ read_only</div><div class="ttdef"><b>Definition</b> <a href="file__mapping_8hpp_source.html#l00013">file_mapping.hpp:13</a></div></div>
<div class="ttc" id="anamespacefc_html_a9623b8cae3f48bbed6aa1fc2afe9b174"><div class="ttname"><a href="namespacefc.html#a9623b8cae3f48bbed6aa1fc2afe9b174">fc::seconds</a></div><div class="ttdeci">constexpr microseconds seconds(int64_t s)</div><div class="ttdef"><b>Definition</b> <a href="include_2fc_2time_8hpp_source.html#l00032">time.hpp:32</a></div></div>
<div class="ttc" id="anamespacestd_html"><div class="ttname"><a href="namespacestd.html">std</a></div><div class="ttdef"><b>Definition</b> <a href="name_8hpp_source.html#l00106">name.hpp:106</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_1_1config_html_a2772c77657b1f6fda680bbe8f7282d13"><div class="ttname"><a href="namespacesysio_1_1chain_1_1config.html#a2772c77657b1f6fda680bbe8f7282d13">sysio::chain::config::billable_size_v</a></div><div class="ttdeci">constexpr uint64_t billable_size_v</div><div class="ttdef"><b>Definition</b> <a href="chain_2include_2sysio_2chain_2config_8hpp_source.html#l00147">config.hpp:147</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_a01ed37e95a76bcd3dec49672be7acfaa"><div class="ttname"><a href="namespacesysio_1_1chain.html#a01ed37e95a76bcd3dec49672be7acfaa">sysio::chain::genesis_intrinsics</a></div><div class="ttdeci">const std::vector&lt; const char * &gt; genesis_intrinsics</div><div class="ttdef"><b>Definition</b> <a href="genesis__intrinsics_8cpp_source.html#l00005">genesis_intrinsics.cpp:5</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_a036ea97f093bf3270bd2c9a097cbcaba"><div class="ttname"><a href="namespacesysio_1_1chain.html#a036ea97f093bf3270bd2c9a097cbcaba">sysio::chain::recover_keys_future</a></div><div class="ttdeci">std::future&lt; transaction_metadata_ptr &gt; recover_keys_future</div><div class="ttdef"><b>Definition</b> <a href="transaction__metadata_8hpp_source.html#l00015">transaction_metadata.hpp:15</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_a0612ad4956bca2a7b23f9a14e2b32106"><div class="ttname"><a href="namespacesysio_1_1chain.html#a0612ad4956bca2a7b23f9a14e2b32106">sysio::chain::global_property_multi_index</a></div><div class="ttdeci">chainbase::shared_multi_index_container&lt; global_property_object, indexed_by&lt; ordered_unique&lt; tag&lt; by_id &gt;, &gt; &gt; &gt; global_property_multi_index</div><div class="ttdef"><b>Definition</b> <a href="global__property__object_8hpp_source.html#l00105">global_property_object.hpp:105</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_a0f69872bbb285f6f90ff8b5e30ef6aa8"><div class="ttname"><a href="namespacesysio_1_1chain.html#a0f69872bbb285f6f90ff8b5e30ef6aa8">sysio::chain::code_index</a></div><div class="ttdeci">chainbase::shared_multi_index_container&lt; code_object, indexed_by&lt; ordered_unique&lt; tag&lt; by_id &gt;, member&lt; code_object, code_object::id_type, &amp;code_object::id &gt; &gt;, ordered_unique&lt; tag&lt; by_code_hash &gt;, composite_key&lt; code_object, member&lt; code_object, digest_type, &amp;code_object::code_hash &gt;, member&lt; code_object, uint8_t, &amp;code_object::vm_type &gt;, member&lt; code_object, uint8_t, &amp;code_object::vm_version &gt; &gt; &gt; &gt; &gt; code_index</div><div class="ttdef"><b>Definition</b> <a href="code__object_8hpp_source.html#l00022">code_object.hpp:22</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_a1736163b16f1771314cd01a1208621c7"><div class="ttname"><a href="namespacesysio_1_1chain.html#a1736163b16f1771314cd01a1208621c7">sysio::chain::account_index</a></div><div class="ttdeci">chainbase::shared_multi_index_container&lt; account_object, indexed_by&lt; ordered_unique&lt; tag&lt; by_id &gt;, member&lt; account_object, account_object::id_type, &amp;account_object::id &gt; &gt;, ordered_unique&lt; tag&lt; by_name &gt;, member&lt; account_object, account_name, &amp;account_object::name &gt; &gt; &gt; &gt; account_index</div><div class="ttdef"><b>Definition</b> <a href="account__object_8hpp_source.html#l00039">account_object.hpp:39</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_a2c8a11798aa7d85bd95fec0fb483d91b"><div class="ttname"><a href="namespacesysio_1_1chain.html#a2c8a11798aa7d85bd95fec0fb483d91b">sysio::chain::block_summary_multi_index</a></div><div class="ttdeci">chainbase::shared_multi_index_container&lt; block_summary_object, indexed_by&lt; ordered_unique&lt; tag&lt; by_id &gt;, BOOST_MULTI_INDEX_MEMBER(block_summary_object, block_summary_object::id_type, id)&gt; &gt; &gt; block_summary_multi_index</div><div class="ttdef"><b>Definition</b> <a href="block__summary__object_8hpp_source.html#l00025">block_summary_object.hpp:25</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_a2cfc12be90aaa9b98843b120fecc71b0"><div class="ttname"><a href="namespacesysio_1_1chain.html#a2cfc12be90aaa9b98843b120fecc71b0">sysio::chain::signer_callback_type</a></div><div class="ttdeci">std::function&lt; std::vector&lt; signature_type &gt;(const digest_type &amp;)&gt; signer_callback_type</div><div class="ttdef"><b>Definition</b> <a href="block__header__state_8hpp_source.html#l00047">block_header_state.hpp:47</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_a32f7ac67403d93f11d6098fb6abd1cc3"><div class="ttname"><a href="namespacesysio_1_1chain.html#a32f7ac67403d93f11d6098fb6abd1cc3">sysio::chain::add_intrinsic_to_whitelist</a></div><div class="ttdeci">void add_intrinsic_to_whitelist(whitelisted_intrinsics_type &amp;whitelisted_intrinsics, std::string_view name)</div><div class="ttdef"><b>Definition</b> <a href="whitelisted__intrinsics_8cpp_source.html#l00051">whitelisted_intrinsics.cpp:51</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_a3aa50d622507be5b1de392b4aae55b0d"><div class="ttname"><a href="namespacesysio_1_1chain.html#a3aa50d622507be5b1de392b4aae55b0d">sysio::chain::index128_index</a></div><div class="ttdeci">secondary_index&lt; uint128_t, index128_object_type &gt;::index_index index128_index</div><div class="ttdef"><b>Definition</b> <a href="contract__table__objects_8hpp_source.html#l00123">contract_table_objects.hpp:123</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_a406d45a184cdba0af316b5bf34bf56cf"><div class="ttname"><a href="namespacesysio_1_1chain.html#a406d45a184cdba0af316b5bf34bf56cf">sysio::chain::builtin_protocol_feature_t</a></div><div class="ttdeci">builtin_protocol_feature_t</div><div class="ttdef"><b>Definition</b> <a href="protocol__feature__manager_8hpp_source.html#l00016">protocol_feature_manager.hpp:16</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_a406d45a184cdba0af316b5bf34bf56cfa1e0a5b7203c3f4124dc8c1880b04e36b"><div class="ttname"><a href="namespacesysio_1_1chain.html#a406d45a184cdba0af316b5bf34bf56cfa1e0a5b7203c3f4124dc8c1880b04e36b">sysio::chain::builtin_protocol_feature_t::no_duplicate_deferred_id</a></div><div class="ttdeci">@ no_duplicate_deferred_id</div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_a406d45a184cdba0af316b5bf34bf56cfa65ea05874d490a8ea760dd8b76c2c504"><div class="ttname"><a href="namespacesysio_1_1chain.html#a406d45a184cdba0af316b5bf34bf56cfa65ea05874d490a8ea760dd8b76c2c504">sysio::chain::builtin_protocol_feature_t::disallow_empty_producer_schedule</a></div><div class="ttdeci">@ disallow_empty_producer_schedule</div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_a4b8e4b7ed9dcd18ee75d0de62e88aa17"><div class="ttname"><a href="namespacesysio_1_1chain.html#a4b8e4b7ed9dcd18ee75d0de62e88aa17">sysio::chain::block_id_type</a></div><div class="ttdeci">fc::sha256 block_id_type</div><div class="ttdef"><b>Definition</b> <a href="chain_2include_2sysio_2chain_2types_8hpp_source.html#l00231">types.hpp:231</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_a4c900d23edfaeb9e6e25aa3a21e0ab4b"><div class="ttname"><a href="namespacesysio_1_1chain.html#a4c900d23edfaeb9e6e25aa3a21e0ab4b">sysio::chain::account_ram_correction_index</a></div><div class="ttdeci">chainbase::shared_multi_index_container&lt; account_ram_correction_object, indexed_by&lt; ordered_unique&lt; tag&lt; by_id &gt;, member&lt; account_ram_correction_object, account_ram_correction_object::id_type, &amp;account_ram_correction_object::id &gt; &gt;, ordered_unique&lt; tag&lt; by_name &gt;, member&lt; account_ram_correction_object, account_name, &amp;account_ram_correction_object::name &gt; &gt; &gt; &gt; account_ram_correction_index</div><div class="ttdef"><b>Definition</b> <a href="account__object_8hpp_source.html#l00093">account_object.hpp:93</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_a4d2a657824ea3c4e231edee184c29b20"><div class="ttname"><a href="namespacesysio_1_1chain.html#a4d2a657824ea3c4e231edee184c29b20">sysio::chain::block_stage_type</a></div><div class="ttdeci">std::variant&lt; building_block, assembled_block, completed_block &gt; block_stage_type</div><div class="ttdef"><b>Definition</b> <a href="#l00145">controller.cpp:145</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_a4ee2867a6bec961c7a78b203cfd76be9"><div class="ttname"><a href="namespacesysio_1_1chain.html#a4ee2867a6bec961c7a78b203cfd76be9">sysio::chain::transaction_trace_ptr</a></div><div class="ttdeci">std::shared_ptr&lt; transaction_trace &gt; transaction_trace_ptr</div><div class="ttdef"><b>Definition</b> <a href="libraries_2chain_2include_2sysio_2chain_2trace_8hpp_source.html#l00020">trace.hpp:20</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_a551a62ef64d082b2bbc5a50e2b6ccaa9"><div class="ttname"><a href="namespacesysio_1_1chain.html#a551a62ef64d082b2bbc5a50e2b6ccaa9">sysio::chain::object_to_table_id_tag_t</a></div><div class="ttdeci">typename object_to_table_id_tag&lt; T &gt;::tag_type object_to_table_id_tag_t</div><div class="ttdef"><b>Definition</b> <a href="contract__table__objects_8hpp_source.html#l00238">contract_table_objects.hpp:238</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_a5d68aec4c925d17b62f0a9b543fabfc5"><div class="ttname"><a href="namespacesysio_1_1chain.html#a5d68aec4c925d17b62f0a9b543fabfc5">sysio::chain::block_signing_authority</a></div><div class="ttdeci">std::variant&lt; block_signing_authority_v0 &gt; block_signing_authority</div><div class="ttdef"><b>Definition</b> <a href="producer__schedule_8hpp_source.html#l00161">producer_schedule.hpp:161</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_a5dfe17906469eaf079c180c1afb4ad94"><div class="ttname"><a href="namespacesysio_1_1chain.html#a5dfe17906469eaf079c180c1afb4ad94">sysio::chain::transaction_exception</a></div><div class="ttdeci">key Invalid authority Invalid transaction Invalid block ID Invalid packed transaction Invalid chain ID Invalid symbol Signature type is not a currently activated type Block can not be found Unlinkable block Block does not guarantee concurrent execution without conflicts Block exhausted allowed resources Block is from the future Block is not signed by expected producer Block includes an ill formed protocol feature activation extension Block includes an ill formed additional block signature extension transaction_exception</div><div class="ttdef"><b>Definition</b> <a href="chain_2include_2sysio_2chain_2exceptions_8hpp_source.html#l00243">exceptions.hpp:243</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_a613ce5969969e88f01eba861173d2b1b"><div class="ttname"><a href="namespacesysio_1_1chain.html#a613ce5969969e88f01eba861173d2b1b">sysio::chain::index_double_index</a></div><div class="ttdeci">secondary_index&lt; float64_t, index_double_object_type, soft_double_less &gt;::index_index index_double_index</div><div class="ttdef"><b>Definition</b> <a href="contract__table__objects_8hpp_source.html#l00148">contract_table_objects.hpp:148</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_a6575ee303f00a9488efc0e9c0614c62e"><div class="ttname"><a href="namespacesysio_1_1chain.html#a6575ee303f00a9488efc0e9c0614c62e">sysio::chain::index64_index</a></div><div class="ttdeci">secondary_index&lt; uint64_t, index64_object_type &gt;::index_index index64_index</div><div class="ttdef"><b>Definition</b> <a href="contract__table__objects_8hpp_source.html#l00120">contract_table_objects.hpp:120</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_a6b9cb254135911c4a6d577a9ab7fdd4e"><div class="ttname"><a href="namespacesysio_1_1chain.html#a6b9cb254135911c4a6d577a9ab7fdd4e">sysio::chain::database_exception</a></div><div class="ttdeci">key Invalid authority Invalid transaction Invalid block ID Invalid packed transaction Invalid chain ID Invalid symbol Signature type is not a currently activated type Block can not be found Unlinkable block Block does not guarantee concurrent execution without conflicts Block exhausted allowed resources Block is from the future Block is not signed by expected producer Block includes an ill formed protocol feature activation extension Block includes an ill formed additional block signature extension Error decompressing transaction Transaction should have at least one required authority Expired Transaction Invalid Reference Block Duplicate deferred transaction The transaction can not be found Transaction is too big Invalid transaction extension Transaction includes disallowed Transaction exceeded transient resource limit Account name already exists sysio_assert_message assertion failure Action can not be found Attempt to use unaccessible API Inline Action exceeds maximum size limit sysio_assert_code assertion failure uses restricted error code value action return value size too big database_exception</div><div class="ttdef"><b>Definition</b> <a href="chain_2include_2sysio_2chain_2exceptions_8hpp_source.html#l00314">exceptions.hpp:314</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_a7041c0316bd294d0866609ab3e0cc7a7"><div class="ttname"><a href="namespacesysio_1_1chain.html#a7041c0316bd294d0866609ab3e0cc7a7">sysio::chain::packed_transaction_ptr</a></div><div class="ttdeci">std::shared_ptr&lt; const packed_transaction &gt; packed_transaction_ptr</div><div class="ttdef"><b>Definition</b> <a href="transaction_8hpp_source.html#l00214">transaction.hpp:214</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_a7a1685bcc352cda9e45f055932069428"><div class="ttname"><a href="namespacesysio_1_1chain.html#a7a1685bcc352cda9e45f055932069428">sysio::chain::action_name</a></div><div class="ttdeci">sysio::chain::action_name action_name</div><div class="ttdef"><b>Definition</b> <a href="contract__types_8hpp_source.html#l00008">contract_types.hpp:8</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_a7ae1398893dd587589ee5593a952a2ef"><div class="ttname"><a href="namespacesysio_1_1chain.html#a7ae1398893dd587589ee5593a952a2ef">sysio::chain::transaction_multi_index</a></div><div class="ttdeci">chainbase::shared_multi_index_container&lt; transaction_object, indexed_by&lt; ordered_unique&lt; tag&lt; by_id &gt;, BOOST_MULTI_INDEX_MEMBER(transaction_object, transaction_object::id_type, id)&gt;, ordered_unique&lt; tag&lt; by_trx_id &gt;, BOOST_MULTI_INDEX_MEMBER(transaction_object, transaction_id_type, trx_id)&gt;, ordered_unique&lt; tag&lt; by_expiration &gt;, composite_key&lt; transaction_object, BOOST_MULTI_INDEX_MEMBER(transaction_object, time_point_sec, expiration), &gt; &gt; &gt; &gt; transaction_multi_index</div><div class="ttdef"><b>Definition</b> <a href="transaction__object_8hpp_source.html#l00031">transaction_object.hpp:31</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_a7c89dacf49f9737b2395006400c5a26c"><div class="ttname"><a href="namespacesysio_1_1chain.html#a7c89dacf49f9737b2395006400c5a26c">sysio::chain::async_thread_pool</a></div><div class="ttdeci">auto async_thread_pool(boost::asio::io_context &amp;thread_pool, F &amp;&amp;f)</div><div class="ttdef"><b>Definition</b> <a href="thread__utils_8hpp_source.html#l00041">thread_utils.hpp:41</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_a7d207c8c6bf978826102eca76da530e0"><div class="ttname"><a href="namespacesysio_1_1chain.html#a7d207c8c6bf978826102eca76da530e0">sysio::chain::validation_mode</a></div><div class="ttdeci">validation_mode</div><div class="ttdef"><b>Definition</b> <a href="controller_8hpp_source.html#l00058">controller.hpp:58</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_a7d207c8c6bf978826102eca76da530e0af8589806bbf66241917092b2a6e18c6f"><div class="ttname"><a href="namespacesysio_1_1chain.html#a7d207c8c6bf978826102eca76da530e0af8589806bbf66241917092b2a6e18c6f">sysio::chain::validation_mode::LIGHT</a></div><div class="ttdeci">@ LIGHT</div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_a7d61e01ac919d654401a1db8399a3945"><div class="ttname"><a href="namespacesysio_1_1chain.html#a7d61e01ac919d654401a1db8399a3945">sysio::chain::database_header_multi_index</a></div><div class="ttdeci">chainbase::shared_multi_index_container&lt; database_header_object, indexed_by&lt; ordered_unique&lt; tag&lt; by_id &gt;, BOOST_MULTI_INDEX_MEMBER(database_header_object, database_header_object::id_type, id)&gt; &gt; &gt; database_header_multi_index</div><div class="ttdef"><b>Definition</b> <a href="database__header__object_8hpp_source.html#l00043">database_header_object.hpp:43</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_a7f5e587f777791897526e74e58c086be"><div class="ttname"><a href="namespacesysio_1_1chain.html#a7f5e587f777791897526e74e58c086be">sysio::chain::dynamic_global_property_multi_index</a></div><div class="ttdeci">chainbase::shared_multi_index_container&lt; dynamic_global_property_object, indexed_by&lt; ordered_unique&lt; tag&lt; by_id &gt;, &gt; &gt; &gt; dynamic_global_property_multi_index</div><div class="ttdef"><b>Definition</b> <a href="global__property__object_8hpp_source.html#l00158">global_property_object.hpp:158</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_a80afaa06d96e661a0f93e0ba4b09c8dc"><div class="ttname"><a href="namespacesysio_1_1chain.html#a80afaa06d96e661a0f93e0ba4b09c8dc">sysio::chain::snapshot_writer_ptr</a></div><div class="ttdeci">std::shared_ptr&lt; snapshot_writer &gt; snapshot_writer_ptr</div><div class="ttdef"><b>Definition</b> <a href="snapshot_8hpp_source.html#l00155">snapshot.hpp:155</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_a80d7ea5476f97bf51a25149b55469c40"><div class="ttname"><a href="namespacesysio_1_1chain.html#a80d7ea5476f97bf51a25149b55469c40">sysio::chain::merkle</a></div><div class="ttdeci">digest_type merkle(vector&lt; digest_type &gt; ids)</div><div class="ttdef"><b>Definition</b> <a href="merkle_8cpp_source.html#l00035">merkle.cpp:35</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_a8b5ff492474737d62d2b925435c687cfab6c5ca8c8a308fb98a68c0d3a83ce3bc"><div class="ttname"><a href="namespacesysio_1_1chain.html#a8b5ff492474737d62d2b925435c687cfab6c5ca8c8a308fb98a68c0d3a83ce3bc">sysio::chain::system_error_code::generic_system_error</a></div><div class="ttdeci">@ generic_system_error</div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_a8e9186f3a170838216f0535ee44b6d7b"><div class="ttname"><a href="namespacesysio_1_1chain.html#a8e9186f3a170838216f0535ee44b6d7b">sysio::chain::index256_index</a></div><div class="ttdeci">secondary_index&lt; key256_t, index256_object_type &gt;::index_index index256_index</div><div class="ttdef"><b>Definition</b> <a href="contract__table__objects_8hpp_source.html#l00127">contract_table_objects.hpp:127</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_a910243f6a0327fb2d4fc80f7e89f103e"><div class="ttname"><a href="namespacesysio_1_1chain.html#a910243f6a0327fb2d4fc80f7e89f103e">sysio::chain::block_validate_exception</a></div><div class="ttdeci">key Invalid authority Invalid transaction Invalid block ID Invalid packed transaction Invalid chain ID Invalid symbol Signature type is not a currently activated type Block can not be found block_validate_exception</div><div class="ttdef"><b>Definition</b> <a href="chain_2include_2sysio_2chain_2exceptions_8hpp_source.html#l00212">exceptions.hpp:212</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_a9e9842ee49526c2423e014a696edc602"><div class="ttname"><a href="namespacesysio_1_1chain.html#a9e9842ee49526c2423e014a696edc602">sysio::chain::generated_transaction_multi_index</a></div><div class="ttdeci">chainbase::shared_multi_index_container&lt; generated_transaction_object, indexed_by&lt; ordered_unique&lt; tag&lt; by_id &gt;, BOOST_MULTI_INDEX_MEMBER(generated_transaction_object, generated_transaction_object::id_type, id)&gt;, ordered_unique&lt; tag&lt; by_trx_id &gt;, BOOST_MULTI_INDEX_MEMBER(generated_transaction_object, transaction_id_type, trx_id)&gt;, ordered_unique&lt; tag&lt; by_expiration &gt;, composite_key&lt; generated_transaction_object, BOOST_MULTI_INDEX_MEMBER(generated_transaction_object, time_point, expiration), &gt; &gt;, ordered_unique&lt; tag&lt; by_delay &gt;, composite_key&lt; generated_transaction_object, BOOST_MULTI_INDEX_MEMBER(generated_transaction_object, time_point, delay_until), &gt; &gt;, ordered_unique&lt; tag&lt; by_sender_id &gt;, composite_key&lt; generated_transaction_object, BOOST_MULTI_INDEX_MEMBER(generated_transaction_object, account_name, sender), &gt; &gt; &gt; &gt; generated_transaction_multi_index</div><div class="ttdef"><b>Definition</b> <a href="generated__transaction__object_8hpp_source.html#l00052">generated_transaction_object.hpp:52</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_aa10ee348c57604b615bc8570f6685102"><div class="ttname"><a href="namespacesysio_1_1chain.html#aa10ee348c57604b615bc8570f6685102">sysio::chain::signed_block_ptr</a></div><div class="ttdeci">std::shared_ptr&lt; signed_block &gt; signed_block_ptr</div><div class="ttdef"><b>Definition</b> <a href="block_8hpp_source.html#l00105">block.hpp:105</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_aa290df66096212c62e680f2c839ec925"><div class="ttname"><a href="namespacesysio_1_1chain.html#aa290df66096212c62e680f2c839ec925">sysio::chain::sysio_abi_bin</a></div><div class="ttdeci">unsigned char sysio_abi_bin[2132]</div><div class="ttdef"><b>Definition</b> <a href="sysio__contract__abi__bin_8cpp_source.html#l00009">sysio_contract_abi_bin.cpp:9</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_aaa27dacddc54cea475602788c8e7a02c"><div class="ttname"><a href="namespacesysio_1_1chain.html#aaa27dacddc54cea475602788c8e7a02c">sysio::chain::snapshot_reader_ptr</a></div><div class="ttdeci">std::shared_ptr&lt; snapshot_reader &gt; snapshot_reader_ptr</div><div class="ttdef"><b>Definition</b> <a href="snapshot_8hpp_source.html#l00294">snapshot.hpp:294</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_aac1a2c1330fcb6c8002d59d4d1de5858"><div class="ttname"><a href="namespacesysio_1_1chain.html#aac1a2c1330fcb6c8002d59d4d1de5858">sysio::chain::key_value_index</a></div><div class="ttdeci">chainbase::shared_multi_index_container&lt; key_value_object, indexed_by&lt; ordered_unique&lt; tag&lt; by_id &gt;, member&lt; key_value_object, key_value_object::id_type, &amp;key_value_object::id &gt; &gt;, ordered_unique&lt; tag&lt; by_scope_primary &gt;, composite_key&lt; key_value_object, member&lt; key_value_object, table_id, &amp;key_value_object::t_id &gt;, member&lt; key_value_object, uint64_t, &amp;key_value_object::primary_key &gt; &gt;, composite_key_compare&lt; std::less&lt; table_id &gt;, std::less&lt; uint64_t &gt; &gt; &gt; &gt; &gt; key_value_index</div><div class="ttdef"><b>Definition</b> <a href="contract__table__objects_8hpp_source.html#l00064">contract_table_objects.hpp:64</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_aacd8d660fd83146e0a5d6a9cb7b19a29"><div class="ttname"><a href="namespacesysio_1_1chain.html#aacd8d660fd83146e0a5d6a9cb7b19a29">sysio::chain::table_id_multi_index</a></div><div class="ttdeci">chainbase::shared_multi_index_container&lt; table_id_object, indexed_by&lt; ordered_unique&lt; tag&lt; by_id &gt;, member&lt; table_id_object, table_id_object::id_type, &amp;table_id_object::id &gt; &gt;, ordered_unique&lt; tag&lt; by_code_scope_table &gt;, composite_key&lt; table_id_object, member&lt; table_id_object, account_name, &amp;table_id_object::code &gt;, member&lt; table_id_object, scope_name, &amp;table_id_object::scope &gt;, member&lt; table_id_object, table_name, &amp;table_id_object::table &gt; &gt; &gt; &gt; &gt; table_id_multi_index</div><div class="ttdef"><b>Definition</b> <a href="contract__table__objects_8hpp_source.html#l00028">contract_table_objects.hpp:28</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_ab03689aa0bc2fbf321d7644f838f23a5"><div class="ttname"><a href="namespacesysio_1_1chain.html#ab03689aa0bc2fbf321d7644f838f23a5">sysio::chain::protocol_state_multi_index</a></div><div class="ttdeci">chainbase::shared_multi_index_container&lt; protocol_state_object, indexed_by&lt; ordered_unique&lt; tag&lt; by_id &gt;, &gt; &gt; &gt; protocol_state_multi_index</div><div class="ttdef"><b>Definition</b> <a href="protocol__state__object_8hpp_source.html#l00046">protocol_state_object.hpp:46</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_ab143988ae1cae85e839b01eb768804c3"><div class="ttname"><a href="namespacesysio_1_1chain.html#ab143988ae1cae85e839b01eb768804c3">sysio::chain::apply_handler</a></div><div class="ttdeci">std::function&lt; void(apply_context &amp;)&gt; apply_handler</div><div class="ttdef"><b>Definition</b> <a href="apply__context_8hpp_source.html#l00635">apply_context.hpp:635</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_ab9b14f4554cc4a0da2c361e9757b1662"><div class="ttname"><a href="namespacesysio_1_1chain.html#ab9b14f4554cc4a0da2c361e9757b1662">sysio::chain::block_state_ptr</a></div><div class="ttdeci">std::shared_ptr&lt; block_state &gt; block_state_ptr</div><div class="ttdef"><b>Definition</b> <a href="block__state_8hpp_source.html#l00067">block_state.hpp:67</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_acad19c1ca23d796138841046c67b3ea9"><div class="ttname"><a href="namespacesysio_1_1chain.html#acad19c1ca23d796138841046c67b3ea9">sysio::chain::fork_database_exception</a></div><div class="ttdeci">key Invalid authority Invalid transaction Invalid block ID Invalid packed transaction Invalid chain ID Invalid symbol Signature type is not a currently activated type fork_database_exception</div><div class="ttdef"><b>Definition</b> <a href="chain_2include_2sysio_2chain_2exceptions_8hpp_source.html#l00205">exceptions.hpp:205</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_ad795329e0af850251f4f47cc32e8d770"><div class="ttname"><a href="namespacesysio_1_1chain.html#ad795329e0af850251f4f47cc32e8d770">sysio::chain::transaction_metadata_ptr</a></div><div class="ttdeci">std::shared_ptr&lt; transaction_metadata &gt; transaction_metadata_ptr</div><div class="ttdef"><b>Definition</b> <a href="transaction__metadata_8hpp_source.html#l00014">transaction_metadata.hpp:14</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_ad7e9cbb02002c4e7ab9825becb9f9f50"><div class="ttname"><a href="namespacesysio_1_1chain.html#ad7e9cbb02002c4e7ab9825becb9f9f50">sysio::chain::trx_meta_cache_lookup</a></div><div class="ttdeci">std::function&lt; transaction_metadata_ptr(const transaction_id_type &amp;)&gt; trx_meta_cache_lookup</div><div class="ttdef"><b>Definition</b> <a href="controller_8hpp_source.html#l00047">controller.hpp:47</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_ae043a3bf1321067bf1e4e7e5ab0ce3cd"><div class="ttname"><a href="namespacesysio_1_1chain.html#ae043a3bf1321067bf1e4e7e5ab0ce3cd">sysio::chain::forked_branch_callback</a></div><div class="ttdeci">std::function&lt; void(const branch_type &amp;)&gt; forked_branch_callback</div><div class="ttdef"><b>Definition</b> <a href="controller_8hpp_source.html#l00045">controller.hpp:45</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_aeced8cdafcddda68b18c6c579dea0cc1"><div class="ttname"><a href="namespacesysio_1_1chain.html#aeced8cdafcddda68b18c6c579dea0cc1">sysio::chain::account_metadata_index</a></div><div class="ttdeci">chainbase::shared_multi_index_container&lt; account_metadata_object, indexed_by&lt; ordered_unique&lt; tag&lt; by_id &gt;, member&lt; account_metadata_object, account_metadata_object::id_type, &amp;account_metadata_object::id &gt; &gt;, ordered_unique&lt; tag&lt; by_name &gt;, member&lt; account_metadata_object, account_name, &amp;account_metadata_object::name &gt; &gt; &gt; &gt; account_metadata_index</div><div class="ttdef"><b>Definition</b> <a href="account__object_8hpp_source.html#l00075">account_object.hpp:75</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_af3e35f3e1b78dd00fa247009a2d9ba5e"><div class="ttname"><a href="namespacesysio_1_1chain.html#af3e35f3e1b78dd00fa247009a2d9ba5e">sysio::chain::db_read_mode</a></div><div class="ttdeci">db_read_mode</div><div class="ttdef"><b>Definition</b> <a href="controller_8hpp_source.html#l00051">controller.hpp:51</a></div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_af3e35f3e1b78dd00fa247009a2d9ba5ea26ca3b6826ca765f741f39ec4754d581"><div class="ttname"><a href="namespacesysio_1_1chain.html#af3e35f3e1b78dd00fa247009a2d9ba5ea26ca3b6826ca765f741f39ec4754d581">sysio::chain::db_read_mode::SPECULATIVE</a></div><div class="ttdeci">@ SPECULATIVE</div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_af3e35f3e1b78dd00fa247009a2d9ba5ea88537e4e57a14e27d354f8ef6fc03d63"><div class="ttname"><a href="namespacesysio_1_1chain.html#af3e35f3e1b78dd00fa247009a2d9ba5ea88537e4e57a14e27d354f8ef6fc03d63">sysio::chain::db_read_mode::IRREVERSIBLE</a></div><div class="ttdeci">@ IRREVERSIBLE</div></div>
<div class="ttc" id="anamespacesysio_1_1chain_html_afd7252a1e9677ed6c7762531cc275f41"><div class="ttname"><a href="namespacesysio_1_1chain.html#afd7252a1e9677ed6c7762531cc275f41">sysio::chain::index_long_double_index</a></div><div class="ttdeci">secondary_index&lt; float128_t, index_long_double_object_type, soft_long_double_less &gt;::index_index index_long_double_index</div><div class="ttdef"><b>Definition</b> <a href="contract__table__objects_8hpp_source.html#l00156">contract_table_objects.hpp:156</a></div></div>
<div class="ttc" id="anamespacesysio_html"><div class="ttname"><a href="namespacesysio.html">sysio</a></div><div class="ttdef"><b>Definition</b> <a href="abi__serializer_8cpp_source.html#l00008">abi_serializer.cpp:8</a></div></div>
<div class="ttc" id="anamespacesysio_html_a6f5e3e21259b1b0b6d4f035e8c7d5a4e"><div class="ttname"><a href="namespacesysio.html#a6f5e3e21259b1b0b6d4f035e8c7d5a4e">sysio::logger</a></div><div class="ttdeci">fc::logger logger</div><div class="ttdef"><b>Definition</b> <a href="net__plugin_8cpp_source.html#l00355">net_plugin.cpp:355</a></div></div>
<div class="ttc" id="aplatform__timer_8hpp_html"><div class="ttname"><a href="platform__timer_8hpp.html">platform_timer.hpp</a></div></div>
<div class="ttc" id="apointer_8h_html_aeeddce917cf130d62c370b8f216026dd"><div class="ttname"><a href="pointer_8h.html#aeeddce917cf130d62c370b8f216026dd">a</a></div><div class="ttdeci">const GenericPointer&lt; typename T::ValueType &gt; T2 T::AllocatorType &amp; a</div><div class="ttdef"><b>Definition</b> <a href="pointer_8h_source.html#l01181">pointer.h:1181</a></div></div>
<div class="ttc" id="aprettywritertest_8cpp_html_a6283df8c4e365cc8a01727e2d7ad44bf"><div class="ttname"><a href="prettywritertest_8cpp.html#a6283df8c4e365cc8a01727e2d7ad44bf">T</a></div><div class="ttdeci">#define T(meth, val, expected)</div></div>
<div class="ttc" id="aprograms_2sysio-launcher_2main_8cpp_html_a6d42fdcc89e90507ee6f095c8e92fa2b"><div class="ttname"><a href="programs_2sysio-launcher_2main_8cpp.html#a6d42fdcc89e90507ee6f095c8e92fa2b">producers</a></div><div class="ttdeci">schedule config_dir_name data_dir_name p2p_port http_port file_size name name keys peers producers(dont_start)) FC_REFLECT(testnet_def</div></div>
<div class="ttc" id="aprotocol__feature__manager_8hpp_html"><div class="ttname"><a href="protocol__feature__manager_8hpp.html">protocol_feature_manager.hpp</a></div></div>
<div class="ttc" id="aprotocol__state__object_8hpp_html"><div class="ttname"><a href="protocol__state__object_8hpp.html">protocol_state_object.hpp</a></div></div>
<div class="ttc" id="aresource__limits_8hpp_html"><div class="ttname"><a href="resource__limits_8hpp.html">resource_limits.hpp</a></div></div>
<div class="ttc" id="ascoped__exit_8hpp_html"><div class="ttname"><a href="scoped__exit_8hpp.html">scoped_exit.hpp</a></div></div>
<div class="ttc" id="aspec__test__generator_8cpp_html_a38761dc1394ef77d1a39dd282d9e64f5"><div class="ttname"><a href="spec__test__generator_8cpp.html#a38761dc1394ef77d1a39dd282d9e64f5">blacklist</a></div><div class="ttdeci">const std::set&lt; std::string &gt; blacklist</div><div class="ttdef"><b>Definition</b> <a href="spec__test__generator_8cpp_source.html#l01273">spec_test_generator.cpp:1273</a></div></div>
<div class="ttc" id="astdint_8h_html_a273cf69d639a59973b6019625df33e30"><div class="ttname"><a href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a></div><div class="ttdeci">unsigned short uint16_t</div><div class="ttdef"><b>Definition</b> <a href="stdint_8h_source.html#l00125">stdint.h:125</a></div></div>
<div class="ttc" id="astdint_8h_html_a414156feea104f8f75b4ed9e3121b2f6"><div class="ttname"><a href="stdint_8h.html#a414156feea104f8f75b4ed9e3121b2f6">int64_t</a></div><div class="ttdeci">signed __int64 int64_t</div><div class="ttdef"><b>Definition</b> <a href="stdint_8h_source.html#l00135">stdint.h:135</a></div></div>
<div class="ttc" id="astdint_8h_html_a435d1572bf3f880d55459d9805097f62"><div class="ttname"><a href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a></div><div class="ttdeci">unsigned int uint32_t</div><div class="ttdef"><b>Definition</b> <a href="stdint_8h_source.html#l00126">stdint.h:126</a></div></div>
<div class="ttc" id="astdint_8h_html_aec6fcb673ff035718c238c8c9d544c47"><div class="ttname"><a href="stdint_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a></div><div class="ttdeci">unsigned __int64 uint64_t</div><div class="ttdef"><b>Definition</b> <a href="stdint_8h_source.html#l00136">stdint.h:136</a></div></div>
<div class="ttc" id="astructfc_1_1unsigned__int_html"><div class="ttname"><a href="structfc_1_1unsigned__int.html">fc::unsigned_int</a></div><div class="ttdef"><b>Definition</b> <a href="varint_8hpp_source.html#l00006">varint.hpp:6</a></div></div>
<div class="ttc" id="astructfc_1_1unsigned__int_html_ac54ac972d3e38a5852616aaee955ff3f"><div class="ttname"><a href="structfc_1_1unsigned__int.html#ac54ac972d3e38a5852616aaee955ff3f">fc::unsigned_int::value</a></div><div class="ttdeci">uint32_t value</div><div class="ttdef"><b>Definition</b> <a href="varint_8hpp_source.html#l00017">varint.hpp:17</a></div></div>
<div class="ttc" id="astructstate_html"><div class="ttname"><a href="structstate.html">state</a></div><div class="ttdef"><b>Definition</b> <a href="yubihsm__curl_8c_source.html#l00028">yubihsm_curl.c:28</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1account__delta_html"><div class="ttname"><a href="structsysio_1_1chain_1_1account__delta.html">sysio::chain::account_delta</a></div><div class="ttdef"><b>Definition</b> <a href="libraries_2chain_2include_2sysio_2chain_2trace_8hpp_source.html#l00009">trace.hpp:9</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1action__base_html_a013fae07403bd6deffcade4fd5be095c"><div class="ttname"><a href="structsysio_1_1chain_1_1action__base.html#a013fae07403bd6deffcade4fd5be095c">sysio::chain::action_base::name</a></div><div class="ttdeci">action_name name</div><div class="ttdef"><b>Definition</b> <a href="action_8hpp_source.html#l00058">action.hpp:58</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1action__base_html_a3598da3f8df67037e69dab758ce168be"><div class="ttname"><a href="structsysio_1_1chain_1_1action__base.html#a3598da3f8df67037e69dab758ce168be">sysio::chain::action_base::account</a></div><div class="ttdeci">account_name account</div><div class="ttdef"><b>Definition</b> <a href="action_8hpp_source.html#l00057">action.hpp:57</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1action__base_html_a40939533bca9e44d169ee7e25ebb1945"><div class="ttname"><a href="structsysio_1_1chain_1_1action__base.html#a40939533bca9e44d169ee7e25ebb1945">sysio::chain::action_base::authorization</a></div><div class="ttdeci">vector&lt; permission_level &gt; authorization</div><div class="ttdef"><b>Definition</b> <a href="action_8hpp_source.html#l00059">action.hpp:59</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1action_html"><div class="ttname"><a href="structsysio_1_1chain_1_1action.html">sysio::chain::action</a></div><div class="ttdef"><b>Definition</b> <a href="action_8hpp_source.html#l00069">action.hpp:69</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1action_html_abeb8e7f99c1779b22ebcd13f534f0205"><div class="ttname"><a href="structsysio_1_1chain_1_1action.html#abeb8e7f99c1779b22ebcd13f534f0205">sysio::chain::action::data</a></div><div class="ttdeci">bytes data</div><div class="ttdef"><b>Definition</b> <a href="action_8hpp_source.html#l00070">action.hpp:70</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1assembled__block_html"><div class="ttname"><a href="structsysio_1_1chain_1_1assembled__block.html">sysio::chain::assembled_block</a></div><div class="ttdef"><b>Definition</b> <a href="#l00131">controller.cpp:131</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1assembled__block_html_a421c03cda1ddda0efe26b080545fa423"><div class="ttname"><a href="structsysio_1_1chain_1_1assembled__block.html#a421c03cda1ddda0efe26b080545fa423">sysio::chain::assembled_block::_pending_block_header_state</a></div><div class="ttdeci">pending_block_header_state _pending_block_header_state</div><div class="ttdef"><b>Definition</b> <a href="#l00133">controller.cpp:133</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1assembled__block_html_a5ddb3774763eee6d0817ad927559d215"><div class="ttname"><a href="structsysio_1_1chain_1_1assembled__block.html#a5ddb3774763eee6d0817ad927559d215">sysio::chain::assembled_block::_trx_metas</a></div><div class="ttdeci">vector&lt; transaction_metadata_ptr &gt; _trx_metas</div><div class="ttdef"><b>Definition</b> <a href="#l00134">controller.cpp:134</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1assembled__block_html_a67c880fe80f20c21ab50b9e597610c49"><div class="ttname"><a href="structsysio_1_1chain_1_1assembled__block.html#a67c880fe80f20c21ab50b9e597610c49">sysio::chain::assembled_block::_id</a></div><div class="ttdeci">block_id_type _id</div><div class="ttdef"><b>Definition</b> <a href="#l00132">controller.cpp:132</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1assembled__block_html_ac8104404bca401ce911462d43578b5ba"><div class="ttname"><a href="structsysio_1_1chain_1_1assembled__block.html#ac8104404bca401ce911462d43578b5ba">sysio::chain::assembled_block::_new_producer_authority_cache</a></div><div class="ttdeci">std::optional&lt; producer_authority_schedule &gt; _new_producer_authority_cache</div><div class="ttdef"><b>Definition</b> <a href="#l00138">controller.cpp:138</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1assembled__block_html_aeb5b3ffe37e9ba44bdc8fb0cefa3f5f6"><div class="ttname"><a href="structsysio_1_1chain_1_1assembled__block.html#aeb5b3ffe37e9ba44bdc8fb0cefa3f5f6">sysio::chain::assembled_block::_unsigned_block</a></div><div class="ttdeci">signed_block_ptr _unsigned_block</div><div class="ttdef"><b>Definition</b> <a href="#l00135">controller.cpp:135</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1authority_html"><div class="ttname"><a href="structsysio_1_1chain_1_1authority.html">sysio::chain::authority</a></div><div class="ttdef"><b>Definition</b> <a href="authority_8hpp_source.html#l00165">authority.hpp:165</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1authority_html_a89e0cd6c19b4d59a0d37c499d6e90dd0"><div class="ttname"><a href="structsysio_1_1chain_1_1authority.html#a89e0cd6c19b4d59a0d37c499d6e90dd0">sysio::chain::authority::accounts</a></div><div class="ttdeci">vector&lt; permission_level_weight &gt; accounts</div><div class="ttdef"><b>Definition</b> <a href="authority_8hpp_source.html#l00190">authority.hpp:190</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1block__header__state_html"><div class="ttname"><a href="structsysio_1_1chain_1_1block__header__state.html">sysio::chain::block_header_state</a></div><div class="ttdoc">defines the minimum state necessary to validate transaction headers</div><div class="ttdef"><b>Definition</b> <a href="block__header__state_8hpp_source.html#l00119">block_header_state.hpp:119</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1block__header__state_html_a19f6899e80705092e990411eaed6e7a8"><div class="ttname"><a href="structsysio_1_1chain_1_1block__header__state.html#a19f6899e80705092e990411eaed6e7a8">sysio::chain::block_header_state::id</a></div><div class="ttdeci">block_id_type id</div><div class="ttdef"><b>Definition</b> <a href="block__header__state_8hpp_source.html#l00120">block_header_state.hpp:120</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1block__header__state_html_a20bdbb99af936c532c6c316d8abc981c"><div class="ttname"><a href="structsysio_1_1chain_1_1block__header__state.html#a20bdbb99af936c532c6c316d8abc981c">sysio::chain::block_header_state::activated_protocol_features</a></div><div class="ttdeci">protocol_feature_activation_set_ptr activated_protocol_features</div><div class="ttdef"><b>Definition</b> <a href="block__header__state_8hpp_source.html#l00123">block_header_state.hpp:123</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1block__header__state_html_a5345ec8573d52d400076e739db4cccce"><div class="ttname"><a href="structsysio_1_1chain_1_1block__header__state.html#a5345ec8573d52d400076e739db4cccce">sysio::chain::block_header_state::pending_schedule</a></div><div class="ttdeci">detail::schedule_info pending_schedule</div><div class="ttdef"><b>Definition</b> <a href="block__header__state_8hpp_source.html#l00122">block_header_state.hpp:122</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1block__header__state_html_a6f6971715037cfbddcfbd54a88ff4d0f"><div class="ttname"><a href="structsysio_1_1chain_1_1block__header__state.html#a6f6971715037cfbddcfbd54a88ff4d0f">sysio::chain::block_header_state::header</a></div><div class="ttdeci">signed_block_header header</div><div class="ttdef"><b>Definition</b> <a href="block__header__state_8hpp_source.html#l00121">block_header_state.hpp:121</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1block__header_html"><div class="ttname"><a href="structsysio_1_1chain_1_1block__header.html">sysio::chain::block_header</a></div><div class="ttdef"><b>Definition</b> <a href="block__header_8hpp_source.html#l00026">block_header.hpp:27</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1block__header_html_a0fe1e5860e2b78b0a14da6565e2294bb"><div class="ttname"><a href="structsysio_1_1chain_1_1block__header.html#a0fe1e5860e2b78b0a14da6565e2294bb">sysio::chain::block_header::timestamp</a></div><div class="ttdeci">block_timestamp_type timestamp</div><div class="ttdef"><b>Definition</b> <a href="block__header_8hpp_source.html#l00028">block_header.hpp:28</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1block__header_html_a2d039a5279169467dd1b3dae80ff2be3"><div class="ttname"><a href="structsysio_1_1chain_1_1block__header.html#a2d039a5279169467dd1b3dae80ff2be3">sysio::chain::block_header::confirmed</a></div><div class="ttdeci">uint16_t confirmed</div><div class="ttdef"><b>Definition</b> <a href="block__header_8hpp_source.html#l00040">block_header.hpp:40</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1block__header_html_a2e1b24b48c9bbbe2d56ba6db5666673d"><div class="ttname"><a href="structsysio_1_1chain_1_1block__header.html#a2e1b24b48c9bbbe2d56ba6db5666673d">sysio::chain::block_header::transaction_mroot</a></div><div class="ttdeci">checksum256_type transaction_mroot</div><div class="ttdef"><b>Definition</b> <a href="block__header_8hpp_source.html#l00044">block_header.hpp:44</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1block__header_html_a39d57e33ef8d3f6ba59b4c458f0ae375"><div class="ttname"><a href="structsysio_1_1chain_1_1block__header.html#a39d57e33ef8d3f6ba59b4c458f0ae375">sysio::chain::block_header::num_from_id</a></div><div class="ttdeci">static uint32_t num_from_id(const block_id_type &amp;id)</div><div class="ttdef"><b>Definition</b> <a href="block__header_8cpp_source.html#l00013">block_header.cpp:13</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1block__header_html_a4096ec8f931ab9180ae80f6e06332103"><div class="ttname"><a href="structsysio_1_1chain_1_1block__header.html#a4096ec8f931ab9180ae80f6e06332103">sysio::chain::block_header::action_mroot</a></div><div class="ttdeci">checksum256_type action_mroot</div><div class="ttdoc">mroot of cycles_summary</div><div class="ttdef"><b>Definition</b> <a href="block__header_8hpp_source.html#l00045">block_header.hpp:45</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1block__header_html_a449ed3d87648accf54bd0eae4424a3df"><div class="ttname"><a href="structsysio_1_1chain_1_1block__header.html#a449ed3d87648accf54bd0eae4424a3df">sysio::chain::block_header::previous</a></div><div class="ttdeci">block_id_type previous</div><div class="ttdef"><b>Definition</b> <a href="block__header_8hpp_source.html#l00042">block_header.hpp:42</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1block__header_html_a84daf28c790313cfaffff12e2a962cdb"><div class="ttname"><a href="structsysio_1_1chain_1_1block__header.html#a84daf28c790313cfaffff12e2a962cdb">sysio::chain::block_header::block_num</a></div><div class="ttdeci">uint32_t block_num() const</div><div class="ttdef"><b>Definition</b> <a href="block__header_8hpp_source.html#l00068">block_header.hpp:68</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1block__header_html_a8529628ed392b72693f23a636814172f"><div class="ttname"><a href="structsysio_1_1chain_1_1block__header.html#a8529628ed392b72693f23a636814172f">sysio::chain::block_header::schedule_version</a></div><div class="ttdeci">uint32_t schedule_version</div><div class="ttdef"><b>Definition</b> <a href="block__header_8hpp_source.html#l00059">block_header.hpp:59</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1block__header_html_a8b87aa5950dbd992025ff7c213b1858a"><div class="ttname"><a href="structsysio_1_1chain_1_1block__header.html#a8b87aa5950dbd992025ff7c213b1858a">sysio::chain::block_header::header_extensions</a></div><div class="ttdeci">extensions_type header_extensions</div><div class="ttdef"><b>Definition</b> <a href="block__header_8hpp_source.html#l00061">block_header.hpp:61</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1block__header_html_ab1f18a64cbf39c54da83f75c9632f9cd"><div class="ttname"><a href="structsysio_1_1chain_1_1block__header.html#ab1f18a64cbf39c54da83f75c9632f9cd">sysio::chain::block_header::calculate_id</a></div><div class="ttdeci">block_id_type calculate_id() const</div><div class="ttdef"><b>Definition</b> <a href="block__header_8cpp_source.html#l00018">block_header.cpp:18</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1block__header_html_ab73cce40ff45b968f3d9283d7ce1fcbd"><div class="ttname"><a href="structsysio_1_1chain_1_1block__header.html#ab73cce40ff45b968f3d9283d7ce1fcbd">sysio::chain::block_header::producer</a></div><div class="ttdeci">account_name producer</div><div class="ttdef"><b>Definition</b> <a href="block__header_8hpp_source.html#l00029">block_header.hpp:29</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1block__header_html_afbddec026595d42b3a280f8c0fddf336"><div class="ttname"><a href="structsysio_1_1chain_1_1block__header.html#afbddec026595d42b3a280f8c0fddf336">sysio::chain::block_header::new_producers</a></div><div class="ttdeci">new_producers_type new_producers</div><div class="ttdef"><b>Definition</b> <a href="block__header_8hpp_source.html#l00060">block_header.hpp:60</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1block__signing__authority__v0_html"><div class="ttname"><a href="structsysio_1_1chain_1_1block__signing__authority__v0.html">sysio::chain::block_signing_authority_v0</a></div><div class="ttdef"><b>Definition</b> <a href="producer__schedule_8hpp_source.html#l00100">producer_schedule.hpp:100</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1block__state_html"><div class="ttname"><a href="structsysio_1_1chain_1_1block__state.html">sysio::chain::block_state</a></div><div class="ttdef"><b>Definition</b> <a href="block__state_8hpp_source.html#l00010">block_state.hpp:10</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1building__block_html"><div class="ttname"><a href="structsysio_1_1chain_1_1building__block.html">sysio::chain::building_block</a></div><div class="ttdef"><b>Definition</b> <a href="#l00111">controller.cpp:111</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1building__block_html_a0f41d6d213209b2c8c73acb198b44d31"><div class="ttname"><a href="structsysio_1_1chain_1_1building__block.html#a0f41d6d213209b2c8c73acb198b44d31">sysio::chain::building_block::_transaction_mroot</a></div><div class="ttdeci">std::optional&lt; checksum256_type &gt; _transaction_mroot</div><div class="ttdef"><b>Definition</b> <a href="#l00127">controller.cpp:127</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1building__block_html_a185ab69ca6d476247057e18672aed3ad"><div class="ttname"><a href="structsysio_1_1chain_1_1building__block.html#a185ab69ca6d476247057e18672aed3ad">sysio::chain::building_block::_num_new_protocol_features_that_have_activated</a></div><div class="ttdeci">size_t _num_new_protocol_features_that_have_activated</div><div class="ttdef"><b>Definition</b> <a href="#l00123">controller.cpp:123</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1building__block_html_a431e096b0d1fe2977a905f332bc67fe3"><div class="ttname"><a href="structsysio_1_1chain_1_1building__block.html#a431e096b0d1fe2977a905f332bc67fe3">sysio::chain::building_block::_s_header</a></div><div class="ttdeci">std::optional&lt; s_header &gt; _s_header</div><div class="ttdef"><b>Definition</b> <a href="#l00128">controller.cpp:128</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1building__block_html_a44bbb13d65743e9b5370f928cd57fa0c"><div class="ttname"><a href="structsysio_1_1chain_1_1building__block.html#a44bbb13d65743e9b5370f928cd57fa0c">sysio::chain::building_block::_pending_trx_metas</a></div><div class="ttdeci">vector&lt; transaction_metadata_ptr &gt; _pending_trx_metas</div><div class="ttdef"><b>Definition</b> <a href="#l00124">controller.cpp:124</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1building__block_html_a505d69cba19e3830b35a7794d7c4adca"><div class="ttname"><a href="structsysio_1_1chain_1_1building__block.html#a505d69cba19e3830b35a7794d7c4adca">sysio::chain::building_block::_new_protocol_feature_activations</a></div><div class="ttdeci">vector&lt; digest_type &gt; _new_protocol_feature_activations</div><div class="ttdef"><b>Definition</b> <a href="#l00122">controller.cpp:122</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1building__block_html_a6f4c847bd9e684175c5c2dd9a293bcce"><div class="ttname"><a href="structsysio_1_1chain_1_1building__block.html#a6f4c847bd9e684175c5c2dd9a293bcce">sysio::chain::building_block::_pending_block_header_state</a></div><div class="ttdeci">pending_block_header_state _pending_block_header_state</div><div class="ttdef"><b>Definition</b> <a href="#l00120">controller.cpp:120</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1building__block_html_a798382d177c089494b584b5a9b3f1af1"><div class="ttname"><a href="structsysio_1_1chain_1_1building__block.html#a798382d177c089494b584b5a9b3f1af1">sysio::chain::building_block::_action_receipt_digests</a></div><div class="ttdeci">vector&lt; digest_type &gt; _action_receipt_digests</div><div class="ttdef"><b>Definition</b> <a href="#l00126">controller.cpp:126</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1building__block_html_ad1a55d886f919432dd2cf5a2179ad697"><div class="ttname"><a href="structsysio_1_1chain_1_1building__block.html#ad1a55d886f919432dd2cf5a2179ad697">sysio::chain::building_block::building_block</a></div><div class="ttdeci">building_block(const block_header_state &amp;prev, block_timestamp_type when, uint16_t num_prev_blocks_to_confirm, const vector&lt; digest_type &gt; &amp;new_protocol_feature_activations)</div><div class="ttdef"><b>Definition</b> <a href="#l00112">controller.cpp:112</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1building__block_html_ad23c5b9aff9e1e2033ee5ff0e0b38a13"><div class="ttname"><a href="structsysio_1_1chain_1_1building__block.html#ad23c5b9aff9e1e2033ee5ff0e0b38a13">sysio::chain::building_block::_new_pending_producer_schedule</a></div><div class="ttdeci">std::optional&lt; producer_authority_schedule &gt; _new_pending_producer_schedule</div><div class="ttdef"><b>Definition</b> <a href="#l00121">controller.cpp:121</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1building__block_html_af666a80cf6adc295cc63a81e1ab421bf"><div class="ttname"><a href="structsysio_1_1chain_1_1building__block.html#af666a80cf6adc295cc63a81e1ab421bf">sysio::chain::building_block::_pending_trx_receipts</a></div><div class="ttdeci">vector&lt; transaction_receipt &gt; _pending_trx_receipts</div><div class="ttdef"><b>Definition</b> <a href="#l00125">controller.cpp:125</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1chain__config__v0_html_a216d150c1c6ad9ea64aaf82d86926d19"><div class="ttname"><a href="structsysio_1_1chain_1_1chain__config__v0.html#a216d150c1c6ad9ea64aaf82d86926d19">sysio::chain::chain_config_v0::target_block_net_usage_pct</a></div><div class="ttdeci">uint32_t target_block_net_usage_pct</div><div class="ttdoc">the target percent (1% == 100, 100%= 10,000) of maximum net usage; exceeding this triggers congestion...</div><div class="ttdef"><b>Definition</b> <a href="chain__config_8hpp_source.html#l00041">chain_config.hpp:41</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1chain__config__v0_html_a292759d9e893bccf78a5d22279fb5752"><div class="ttname"><a href="structsysio_1_1chain_1_1chain__config__v0.html#a292759d9e893bccf78a5d22279fb5752">sysio::chain::chain_config_v0::max_block_cpu_usage</a></div><div class="ttdeci">uint32_t max_block_cpu_usage</div><div class="ttdoc">the maxiumum billable cpu usage (in microseconds) for a block</div><div class="ttdef"><b>Definition</b> <a href="chain__config_8hpp_source.html#l00048">chain_config.hpp:48</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1chain__config__v0_html_a460f6b269c9da35d40b1cc5927c2205a"><div class="ttname"><a href="structsysio_1_1chain_1_1chain__config__v0.html#a460f6b269c9da35d40b1cc5927c2205a">sysio::chain::chain_config_v0::min_transaction_cpu_usage</a></div><div class="ttdeci">uint32_t min_transaction_cpu_usage</div><div class="ttdoc">the minimum billable cpu usage (in microseconds) that the chain requires</div><div class="ttdef"><b>Definition</b> <a href="chain__config_8hpp_source.html#l00051">chain_config.hpp:51</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1chain__config__v0_html_a796dada63527fcff40f838efc42a04ec"><div class="ttname"><a href="structsysio_1_1chain_1_1chain__config__v0.html#a796dada63527fcff40f838efc42a04ec">sysio::chain::chain_config_v0::max_block_net_usage</a></div><div class="ttdeci">uint64_t max_block_net_usage</div><div class="ttdoc">the maxiumum net usage in instructions for a block</div><div class="ttdef"><b>Definition</b> <a href="chain__config_8hpp_source.html#l00040">chain_config.hpp:40</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1chain__config__v0_html_af2b14c2153bc64969ca85c8df8fbb7f9"><div class="ttname"><a href="structsysio_1_1chain_1_1chain__config__v0.html#af2b14c2153bc64969ca85c8df8fbb7f9">sysio::chain::chain_config_v0::target_block_cpu_usage_pct</a></div><div class="ttdeci">uint32_t target_block_cpu_usage_pct</div><div class="ttdoc">the target percent (1% == 100, 100%= 10,000) of maximum cpu usage; exceeding this triggers congestion...</div><div class="ttdef"><b>Definition</b> <a href="chain__config_8hpp_source.html#l00049">chain_config.hpp:49</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1chain__config__v1_html"><div class="ttname"><a href="structsysio_1_1chain_1_1chain__config__v1.html">sysio::chain::chain_config_v1</a></div><div class="ttdoc">v1 Producer-voted blockchain configuration parameters</div><div class="ttdef"><b>Definition</b> <a href="chain__config_8hpp_source.html#l00143">chain_config.hpp:143</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1chain__id__type_html"><div class="ttname"><a href="structsysio_1_1chain_1_1chain__id__type.html">sysio::chain::chain_id_type</a></div><div class="ttdef"><b>Definition</b> <a href="chain__id__type_8hpp_source.html#l00023">chain_id_type.hpp:23</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1chain__snapshot__header_html"><div class="ttname"><a href="structsysio_1_1chain_1_1chain__snapshot__header.html">sysio::chain::chain_snapshot_header</a></div><div class="ttdef"><b>Definition</b> <a href="chain__snapshot_8hpp_source.html#l00007">chain_snapshot.hpp:7</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1chain__snapshot__header_html_a57ba8d21e5d5c9e1325e9ef03f96d54e"><div class="ttname"><a href="structsysio_1_1chain_1_1chain__snapshot__header.html#a57ba8d21e5d5c9e1325e9ef03f96d54e">sysio::chain::chain_snapshot_header::version</a></div><div class="ttdeci">uint32_t version</div><div class="ttdef"><b>Definition</b> <a href="chain__snapshot_8hpp_source.html#l00031">chain_snapshot.hpp:31</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1chain__snapshot__header_html_a6f183a866ea3a474243c55484f0c700e"><div class="ttname"><a href="structsysio_1_1chain_1_1chain__snapshot__header.html#a6f183a866ea3a474243c55484f0c700e">sysio::chain::chain_snapshot_header::validate</a></div><div class="ttdeci">void validate() const</div><div class="ttdef"><b>Definition</b> <a href="chain__snapshot_8hpp_source.html#l00033">chain_snapshot.hpp:33</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1completed__block_html"><div class="ttname"><a href="structsysio_1_1chain_1_1completed__block.html">sysio::chain::completed_block</a></div><div class="ttdef"><b>Definition</b> <a href="#l00141">controller.cpp:141</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1completed__block_html_a07a433c3d74af71add53f639c88d86a2"><div class="ttname"><a href="structsysio_1_1chain_1_1completed__block.html#a07a433c3d74af71add53f639c88d86a2">sysio::chain::completed_block::_block_state</a></div><div class="ttdeci">block_state_ptr _block_state</div><div class="ttdef"><b>Definition</b> <a href="#l00142">controller.cpp:142</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller_1_1config_html"><div class="ttname"><a href="structsysio_1_1chain_1_1controller_1_1config.html">sysio::chain::controller::config</a></div><div class="ttdef"><b>Definition</b> <a href="controller_8hpp_source.html#l00065">controller.hpp:65</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller_1_1config_html_a0c34416a36f48ede90d9701b986d3487"><div class="ttname"><a href="structsysio_1_1chain_1_1controller_1_1config.html#a0c34416a36f48ede90d9701b986d3487">sysio::chain::controller::config::contract_whitelist</a></div><div class="ttdeci">flat_set&lt; account_name &gt; contract_whitelist</div><div class="ttdef"><b>Definition</b> <a href="controller_8hpp_source.html#l00069">controller.hpp:69</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller_1_1config_html_a5352099a52d4b3f078ec78122393ba21"><div class="ttname"><a href="structsysio_1_1chain_1_1controller_1_1config.html#a5352099a52d4b3f078ec78122393ba21">sysio::chain::controller::config::terminate_at_block</a></div><div class="ttdeci">uint32_t terminate_at_block</div><div class="ttdef"><b>Definition</b> <a href="controller_8hpp_source.html#l00088">controller.hpp:88</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller_1_1config_html_a5845874d26f30413374713814cde5749"><div class="ttname"><a href="structsysio_1_1chain_1_1controller_1_1config.html#a5845874d26f30413374713814cde5749">sysio::chain::controller::config::force_all_checks</a></div><div class="ttdeci">bool force_all_checks</div><div class="ttdef"><b>Definition</b> <a href="controller_8hpp_source.html#l00082">controller.hpp:82</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller_1_1config_html_a5922ec305c682477fd9ef6ce74293c9d"><div class="ttname"><a href="structsysio_1_1chain_1_1controller_1_1config.html#a5922ec305c682477fd9ef6ce74293c9d">sysio::chain::controller::config::actor_blacklist</a></div><div class="ttdeci">flat_set&lt; account_name &gt; actor_blacklist</div><div class="ttdef"><b>Definition</b> <a href="controller_8hpp_source.html#l00068">controller.hpp:68</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller_1_1config_html_a64ea139aa98e2d67dfed0a5c2f36eb77"><div class="ttname"><a href="structsysio_1_1chain_1_1controller_1_1config.html#a64ea139aa98e2d67dfed0a5c2f36eb77">sysio::chain::controller::config::actor_whitelist</a></div><div class="ttdeci">flat_set&lt; account_name &gt; actor_whitelist</div><div class="ttdef"><b>Definition</b> <a href="controller_8hpp_source.html#l00067">controller.hpp:67</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller_1_1config_html_a681e42f55477a7b01ba14c05a76e9b18"><div class="ttname"><a href="structsysio_1_1chain_1_1controller_1_1config.html#a681e42f55477a7b01ba14c05a76e9b18">sysio::chain::controller::config::sig_cpu_bill_pct</a></div><div class="ttdeci">uint32_t sig_cpu_bill_pct</div><div class="ttdef"><b>Definition</b> <a href="controller_8hpp_source.html#l00078">controller.hpp:78</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller_1_1config_html_a71961d4eb70d927b9d0003f6255db95f"><div class="ttname"><a href="structsysio_1_1chain_1_1controller_1_1config.html#a71961d4eb70d927b9d0003f6255db95f">sysio::chain::controller::config::contract_blacklist</a></div><div class="ttdeci">flat_set&lt; account_name &gt; contract_blacklist</div><div class="ttdef"><b>Definition</b> <a href="controller_8hpp_source.html#l00070">controller.hpp:70</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller_1_1config_html_a8440b353861fe179036cb8af088323ff"><div class="ttname"><a href="structsysio_1_1chain_1_1controller_1_1config.html#a8440b353861fe179036cb8af088323ff">sysio::chain::controller::config::sender_bypass_whiteblacklist</a></div><div class="ttdeci">flat_set&lt; account_name &gt; sender_bypass_whiteblacklist</div><div class="ttdef"><b>Definition</b> <a href="controller_8hpp_source.html#l00066">controller.hpp:66</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller_1_1config_html_a979219adeffbc78b1fe73460a8005e39"><div class="ttname"><a href="structsysio_1_1chain_1_1controller_1_1config.html#a979219adeffbc78b1fe73460a8005e39">sysio::chain::controller::config::action_blacklist</a></div><div class="ttdeci">flat_set&lt; pair&lt; account_name, action_name &gt; &gt; action_blacklist</div><div class="ttdef"><b>Definition</b> <a href="controller_8hpp_source.html#l00071">controller.hpp:71</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller_1_1config_html_ae36a724cde28ee8bc40c6b73206f8a61"><div class="ttname"><a href="structsysio_1_1chain_1_1controller_1_1config.html#ae36a724cde28ee8bc40c6b73206f8a61">sysio::chain::controller::config::key_blacklist</a></div><div class="ttdeci">flat_set&lt; public_key_type &gt; key_blacklist</div><div class="ttdef"><b>Definition</b> <a href="controller_8hpp_source.html#l00072">controller.hpp:72</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_1_1reset__new__handler_html"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl_1_1reset__new__handler.html">sysio::chain::controller_impl::reset_new_handler</a></div><div class="ttdef"><b>Definition</b> <a href="#l00224">controller.cpp:224</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_1_1reset__new__handler_html_a32e46acf3fe5190e6640413f0295ebee"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl_1_1reset__new__handler.html#a32e46acf3fe5190e6640413f0295ebee">sysio::chain::controller_impl::reset_new_handler::reset_new_handler</a></div><div class="ttdeci">reset_new_handler()</div><div class="ttdef"><b>Definition</b> <a href="#l00225">controller.cpp:225</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html">sysio::chain::controller_impl</a></div><div class="ttdef"><b>Definition</b> <a href="#l00220">controller.cpp:220</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_a01cf826f5503f482715ca2b724279cde"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#a01cf826f5503f482715ca2b724279cde">sysio::chain::controller_impl::initialize_database</a></div><div class="ttdeci">void initialize_database(const genesis_state &amp;genesis)</div><div class="ttdef"><b>Definition</b> <a href="#l01023">controller.cpp:1023</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_a048ac8e4d4436902a1888df13575b252"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#a048ac8e4d4436902a1888df13575b252">sysio::chain::controller_impl::conf</a></div><div class="ttdeci">controller::config conf</div><div class="ttdef"><b>Definition</b> <a href="#l00240">controller.cpp:240</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_a0e355919fd924a05344ef2b59f7dd587"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#a0e355919fd924a05344ef2b59f7dd587">sysio::chain::controller_impl::pending</a></div><div class="ttdeci">std::optional&lt; pending_state &gt; pending</div><div class="ttdef"><b>Definition</b> <a href="#l00233">controller.cpp:233</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_a148db3e15c5b5a5cd3fd6b42799d1152"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#a148db3e15c5b5a5cd3fd6b42799d1152">sysio::chain::controller_impl::push_scheduled_transaction</a></div><div class="ttdeci">transaction_trace_ptr push_scheduled_transaction(const transaction_id_type &amp;trxid, fc::time_point block_deadline, fc::microseconds max_transaction_time, uint32_t billed_cpu_time_us, bool explicit_billed_cpu_time=false)</div><div class="ttdef"><b>Definition</b> <a href="#l01218">controller.cpp:1218</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_a16289260be252f6ebbd80763f657fb38"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#a16289260be252f6ebbd80763f657fb38">sysio::chain::controller_impl::check_contract_list</a></div><div class="ttdeci">void check_contract_list(account_name code) const</div><div class="ttdef"><b>Definition</b> <a href="#l02492">controller.cpp:2492</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_a18bcf25847599b0f9caa6566364bb0ac"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#a18bcf25847599b0f9caa6566364bb0ac">sysio::chain::controller_impl::startup</a></div><div class="ttdeci">void startup(std::function&lt; void()&gt; shutdown, std::function&lt; bool()&gt; check_shutdown, const snapshot_reader_ptr &amp;snapshot)</div><div class="ttdef"><b>Definition</b> <a href="#l00557">controller.cpp:557</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_a1b67831f3be3a668c170723427236954"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#a1b67831f3be3a668c170723427236954">sysio::chain::controller_impl::get_deep_mind_logger</a></div><div class="ttdeci">deep_mind_handler * get_deep_mind_logger() const</div><div class="ttdef"><b>Definition</b> <a href="#l02572">controller.cpp:2572</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_a1c3e5eaaf816a6fa2f790cd2ef6dbdce"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#a1c3e5eaaf816a6fa2f790cd2ef6dbdce">sysio::chain::controller_impl::db</a></div><div class="ttdeci">chainbase::database db</div><div class="ttdef"><b>Definition</b> <a href="#l00231">controller.cpp:231</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_a1dac6da3cb5899f6bcd62b9012c75e43"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#a1dac6da3cb5899f6bcd62b9012c75e43">sysio::chain::controller_impl::remove_scheduled_transaction</a></div><div class="ttdeci">int64_t remove_scheduled_transaction(const generated_transaction_object &amp;gto)</div><div class="ttdef"><b>Definition</b> <a href="#l01180">controller.cpp:1180</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_a247c87d241e707c5e482c3d6d8872a7f"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#a247c87d241e707c5e482c3d6d8872a7f">sysio::chain::controller_impl::read_from_snapshot</a></div><div class="ttdeci">void read_from_snapshot(const snapshot_reader_ptr &amp;snapshot, uint32_t blog_start, uint32_t blog_end)</div><div class="ttdef"><b>Definition</b> <a href="#l00853">controller.cpp:853</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_a24a100a7be5e562ac3966924b0c9ccb6"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#a24a100a7be5e562ac3966924b0c9ccb6">sysio::chain::controller_impl::protocol_features</a></div><div class="ttdeci">protocol_feature_manager protocol_features</div><div class="ttdef"><b>Definition</b> <a href="#l00239">controller.cpp:239</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_a2bfcf9116962baafa5ca07d198183189"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#a2bfcf9116962baafa5ca07d198183189">sysio::chain::controller_impl::set_activation_handler</a></div><div class="ttdeci">void set_activation_handler()</div><div class="ttdef"><b>Definition</b> <a href="#l00282">controller.cpp:282</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_a2eee00b79604bc3dfa0a93f397a2d4d8"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#a2eee00b79604bc3dfa0a93f397a2d4d8">sysio::chain::controller_impl::create_block_state_i</a></div><div class="ttdeci">block_state_ptr create_block_state_i(const block_id_type &amp;id, const signed_block_ptr &amp;b, const block_header_state &amp;prev)</div><div class="ttdoc">apply_block</div><div class="ttdef"><b>Definition</b> <a href="#l02080">controller.cpp:2080</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_a2f7115cf9c5daa3abca8e0467dce5a5a"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#a2f7115cf9c5daa3abca8e0467dce5a5a">sysio::chain::controller_impl::chain_id</a></div><div class="ttdeci">const chain_id_type chain_id</div><div class="ttdef"><b>Definition</b> <a href="#l00241">controller.cpp:241</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_a2fe4194f0202db6c18bc17572b2adaa2"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#a2fe4194f0202db6c18bc17572b2adaa2">sysio::chain::controller_impl::replay_push_block</a></div><div class="ttdeci">void replay_push_block(const signed_block_ptr &amp;b, controller::block_status s)</div><div class="ttdef"><b>Definition</b> <a href="#l02172">controller.cpp:2172</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_a338cb13e3b27ade2ee719b5421edcf7e"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#a338cb13e3b27ade2ee719b5421edcf7e">sysio::chain::controller_impl::clear_expired_input_transactions</a></div><div class="ttdeci">void clear_expired_input_transactions(const fc::time_point &amp;deadline)</div><div class="ttdef"><b>Definition</b> <a href="#l02379">controller.cpp:2379</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_a342fd89592616d7ca931ff64fe75ead7"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#a342fd89592616d7ca931ff64fe75ead7">sysio::chain::controller_impl::rnh</a></div><div class="ttdeci">reset_new_handler rnh</div><div class="ttdef"><b>Definition</b> <a href="#l00228">controller.cpp:228</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_a3bd1eefa999ba89597c3686e0acc463e"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#a3bd1eefa999ba89597c3686e0acc463e">sysio::chain::controller_impl::replaying</a></div><div class="ttdeci">bool replaying</div><div class="ttdef"><b>Definition</b> <a href="#l00242">controller.cpp:242</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_a3f2b256d3a667ffeed8f7fd03e36c902"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#a3f2b256d3a667ffeed8f7fd03e36c902">sysio::chain::controller_impl::get_on_block_transaction</a></div><div class="ttdeci">signed_transaction get_on_block_transaction()</div><div class="ttdef"><b>Definition</b> <a href="#l02546">controller.cpp:2546</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_a43b89d301b09c599969412d7db819bd3"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#a43b89d301b09c599969412d7db819bd3">sysio::chain::controller_impl::push_scheduled_transaction</a></div><div class="ttdeci">transaction_trace_ptr push_scheduled_transaction(const generated_transaction_object &amp;gto, fc::time_point block_deadline, fc::microseconds max_transaction_time, uint32_t billed_cpu_time_us, bool explicit_billed_cpu_time=false)</div><div class="ttdef"><b>Definition</b> <a href="#l01228">controller.cpp:1228</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_a4a18397f763ebe4880b6ccd970bedf85"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#a4a18397f763ebe4880b6ccd970bedf85">sysio::chain::controller_impl::read_mode</a></div><div class="ttdeci">db_read_mode read_mode</div><div class="ttdef"><b>Definition</b> <a href="#l00243">controller.cpp:243</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_a4f73eb03cb9df364b792166a70f78320"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#a4f73eb03cb9df364b792166a70f78320">sysio::chain::controller_impl::deep_mind_logger</a></div><div class="ttdeci">deep_mind_handler * deep_mind_logger</div><div class="ttdef"><b>Definition</b> <a href="#l00250">controller.cpp:250</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_a56a0f369b58e6597b62569ff2853ee90"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#a56a0f369b58e6597b62569ff2853ee90">sysio::chain::controller_impl::head</a></div><div class="ttdeci">block_state_ptr head</div><div class="ttdef"><b>Definition</b> <a href="#l00234">controller.cpp:234</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_a571b0d08f97b43706abab71f59d4d9f7"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#a571b0d08f97b43706abab71f59d4d9f7">sysio::chain::controller_impl::pop_block</a></div><div class="ttdeci">void pop_block()</div><div class="ttdef"><b>Definition</b> <a href="#l00259">controller.cpp:259</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_a5eb5bb7961c3ae6496caca42b84ab192"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#a5eb5bb7961c3ae6496caca42b84ab192">sysio::chain::controller_impl::finalize_block</a></div><div class="ttdeci">void finalize_block()</div><div class="ttdoc">start_block</div><div class="ttdef"><b>Definition</b> <a href="#l01759">controller.cpp:1759</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_a6353a2e6b51e1b83231f41a8bcc66c47"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#a6353a2e6b51e1b83231f41a8bcc66c47">sysio::chain::controller_impl::extract_legacy_genesis_state</a></div><div class="ttdeci">static std::optional&lt; genesis_state &gt; extract_legacy_genesis_state(snapshot_reader &amp;snapshot, uint32_t version)</div><div class="ttdef"><b>Definition</b> <a href="#l00840">controller.cpp:840</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_a6380e434da95a328ff48ccab33df9cb0"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#a6380e434da95a328ff48ccab33df9cb0">sysio::chain::controller_impl::emit</a></div><div class="ttdeci">void emit(const Signal &amp;s, Arg &amp;&amp;a)</div><div class="ttdef"><b>Definition</b> <a href="#l00368">controller.cpp:368</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_a64851fb4e041dc49ab22cf2ba335720d"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#a64851fb4e041dc49ab22cf2ba335720d">sysio::chain::controller_impl::self</a></div><div class="ttdeci">controller &amp; self</div><div class="ttdef"><b>Definition</b> <a href="#l00229">controller.cpp:229</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_a67d7a4050a78ec74aaf524a46bbcdf54"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#a67d7a4050a78ec74aaf524a46bbcdf54">sysio::chain::controller_impl::apply_handlers</a></div><div class="ttdeci">map&lt; account_name, map&lt; handler_key, apply_handler &gt; &gt; apply_handlers</div><div class="ttdef"><b>Definition</b> <a href="#l00256">controller.cpp:256</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_a69d180992926a229a5e3573ea09d762f"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#a69d180992926a229a5e3573ea09d762f">sysio::chain::controller_impl::update_producers_authority</a></div><div class="ttdeci">void update_producers_authority()</div><div class="ttdef"><b>Definition</b> <a href="#l02334">controller.cpp:2334</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_a78427c6c856e3f2398f434c7d9366a84"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#a78427c6c856e3f2398f434c7d9366a84">sysio::chain::controller_impl::create_block_summary</a></div><div class="ttdeci">void create_block_summary(const block_id_type &amp;id)</div><div class="ttdef"><b>Definition</b> <a href="#l02370">controller.cpp:2370</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_a7863870ecde398ac7def54e4814db6bc"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#a7863870ecde398ac7def54e4814db6bc">sysio::chain::controller_impl::startup</a></div><div class="ttdeci">void startup(std::function&lt; void()&gt; shutdown, std::function&lt; bool()&gt; check_shutdown, const genesis_state &amp;genesis)</div><div class="ttdef"><b>Definition</b> <a href="#l00585">controller.cpp:585</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_a8054e1b3da405a7765275b76d6628928"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#a8054e1b3da405a7765275b76d6628928">sysio::chain::controller_impl::shutdown</a></div><div class="ttdeci">std::function&lt; void()&gt; shutdown</div><div class="ttdef"><b>Definition</b> <a href="#l00230">controller.cpp:230</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_a80cb28cfbb823c8688106b0229d0169c"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#a80cb28cfbb823c8688106b0229d0169c">sysio::chain::controller_impl::handler_key</a></div><div class="ttdeci">pair&lt; scope_name, action_name &gt; handler_key</div><div class="ttdef"><b>Definition</b> <a href="#l00255">controller.cpp:255</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_a83a037a61ce8e07b39d2d38b0f54f8f7"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#a83a037a61ce8e07b39d2d38b0f54f8f7">sysio::chain::controller_impl::resource_limits</a></div><div class="ttdeci">resource_limits_manager resource_limits</div><div class="ttdef"><b>Definition</b> <a href="#l00237">controller.cpp:237</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_a8477bef06de9c6d5f1c8a0a8cf1c8795"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#a8477bef06de9c6d5f1c8a0a8cf1c8795">sysio::chain::controller_impl::add_to_snapshot</a></div><div class="ttdeci">void add_to_snapshot(const snapshot_writer_ptr &amp;snapshot)</div><div class="ttdef"><b>Definition</b> <a href="#l00802">controller.cpp:802</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_a8618218d7168450c383cde9860d57706"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#a8618218d7168450c383cde9860d57706">sysio::chain::controller_impl::earliest_available_block_num</a></div><div class="ttdeci">uint32_t earliest_available_block_num() const</div><div class="ttdef"><b>Definition</b> <a href="#l02576">controller.cpp:2576</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_a866a2ded537cb72ff21ae968a7940432"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#a866a2ded537cb72ff21ae968a7940432">sysio::chain::controller_impl::set_apply_handler</a></div><div class="ttdeci">void set_apply_handler(account_name receiver, account_name contract, action_name action, apply_handler v)</div><div class="ttdef"><b>Definition</b> <a href="#l00293">controller.cpp:293</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_a89d9e83d4de2f7aec957e54dce4a76f5"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#a89d9e83d4de2f7aec957e54dce4a76f5">sysio::chain::controller_impl::make_block_restore_point</a></div><div class="ttdeci">fc::scoped_exit&lt; std::function&lt; void()&gt; &gt; make_block_restore_point()</div><div class="ttdef"><b>Definition</b> <a href="#l01082">controller.cpp:1082</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_a8cdd409341efde24915eadc5f25a51f9"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#a8cdd409341efde24915eadc5f25a51f9">sysio::chain::controller_impl::dmlog_applied_transaction</a></div><div class="ttdeci">void dmlog_applied_transaction(const transaction_trace_ptr &amp;t)</div><div class="ttdef"><b>Definition</b> <a href="#l00389">controller.cpp:389</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_a8d08d7c15ecb706c0bd54e992019c30d"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#a8d08d7c15ecb706c0bd54e992019c30d">sysio::chain::controller_impl::initialize_blockchain_state</a></div><div class="ttdeci">void initialize_blockchain_state(const genesis_state &amp;genesis)</div><div class="ttdef"><b>Definition</b> <a href="#l00452">controller.cpp:452</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_a90da90c73cb32b5e5ec498da5e02753f"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#a90da90c73cb32b5e5ec498da5e02753f">sysio::chain::controller_impl::startup</a></div><div class="ttdeci">void startup(std::function&lt; void()&gt; shutdown, std::function&lt; bool()&gt; check_shutdown)</div><div class="ttdef"><b>Definition</b> <a href="#l00618">controller.cpp:618</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_a9335673a748ff21decfddf837016e2ff"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#a9335673a748ff21decfddf837016e2ff">sysio::chain::controller_impl::trigger_activation_handler</a></div><div class="ttdeci">void trigger_activation_handler(builtin_protocol_feature_t f)</div><div class="ttdef"><b>Definition</b> <a href="#l00287">controller.cpp:287</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_a958ab2b868a2a7ec9644199a80e0ad9e"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#a958ab2b868a2a7ec9644199a80e0ad9e">sysio::chain::controller_impl::blog</a></div><div class="ttdeci">block_log blog</div><div class="ttdef"><b>Definition</b> <a href="#l00232">controller.cpp:232</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_a9a9e4b6fe15eb93e63ac98af9f170647"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#a9a9e4b6fe15eb93e63ac98af9f170647">sysio::chain::controller_impl::replay</a></div><div class="ttdeci">void replay(std::function&lt; bool()&gt; check_shutdown)</div><div class="ttdef"><b>Definition</b> <a href="#l00475">controller.cpp:475</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_a9ae4fff15a76a1c3089fdf0f3353a17f"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#a9ae4fff15a76a1c3089fdf0f3353a17f">sysio::chain::controller_impl::calculate_trx_merkle</a></div><div class="ttdeci">static checksum256_type calculate_trx_merkle(const vector&lt; transaction_receipt &gt; &amp;trxs)</div><div class="ttdef"><b>Definition</b> <a href="#l02325">controller.cpp:2325</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_a9dbf7da25185959b9a8ea1bf7a47a566"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#a9dbf7da25185959b9a8ea1bf7a47a566">sysio::chain::controller_impl::start_block</a></div><div class="ttdeci">void start_block(block_timestamp_type when, uint16_t confirm_block_count, const vector&lt; digest_type &gt; &amp;new_protocol_feature_activations, controller::block_status s, const std::optional&lt; block_id_type &gt; &amp;producer_block_id, const fc::time_point &amp;deadline)</div><div class="ttdoc">push_transaction</div><div class="ttdef"><b>Definition</b> <a href="#l01592">controller.cpp:1592</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_a9efbc515682ae5dede91184c36af73f7"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#a9efbc515682ae5dede91184c36af73f7">sysio::chain::controller_impl::init</a></div><div class="ttdeci">void init(std::function&lt; bool()&gt; check_shutdown)</div><div class="ttdef"><b>Definition</b> <a href="#l00662">controller.cpp:662</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_aa7c2a2da2eed15c5d55146b0ebd6646b"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#aa7c2a2da2eed15c5d55146b0ebd6646b">sysio::chain::controller_impl::apply_onerror</a></div><div class="ttdeci">transaction_trace_ptr apply_onerror(const generated_transaction &amp;gtrx, fc::time_point block_deadline, fc::microseconds max_transaction_time, fc::time_point start, uint32_t &amp;cpu_time_to_bill_us, uint32_t billed_cpu_time_us, bool explicit_billed_cpu_time=false, bool enforce_whiteblacklist=true)</div><div class="ttdef"><b>Definition</b> <a href="#l01102">controller.cpp:1102</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_aae2b1bfeee1e7c1c0237f12776e75dd7"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#aae2b1bfeee1e7c1c0237f12776e75dd7">sysio::chain::controller_impl::push_receipt</a></div><div class="ttdeci">const transaction_receipt &amp; push_receipt(const T &amp;trx, transaction_receipt_header::status_enum status, uint64_t cpu_usage_us, uint64_t net_usage)</div><div class="ttdoc">push_scheduled_transaction</div><div class="ttdef"><b>Definition</b> <a href="#l01437">controller.cpp:1437</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_aaf795677a1a49a35ac1a819a1a157929"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#aaf795677a1a49a35ac1a819a1a157929">sysio::chain::controller_impl::apply_block</a></div><div class="ttdeci">void apply_block(const block_state_ptr &amp;bsp, controller::block_status s, const trx_meta_cache_lookup &amp;trx_lookup)</div><div class="ttdef"><b>Definition</b> <a href="#l01948">controller.cpp:1948</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_ab02dbb970f5b16869e123b77eb090e9b"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#ab02dbb970f5b16869e123b77eb090e9b">sysio::chain::controller_impl::in_trx_requiring_checks</a></div><div class="ttdeci">bool in_trx_requiring_checks</div><div class="ttdoc">if true, checks that are normally skipped on replay (e.g. auth checks) cannot be skipped</div><div class="ttdef"><b>Definition</b> <a href="#l00244">controller.cpp:244</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_ab1190a7a5947a5d8441eafcf33fba744"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#ab1190a7a5947a5d8441eafcf33fba744">sysio::chain::controller_impl::on_activation</a></div><div class="ttdeci">void on_activation()</div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_ab2a0087a0d30ff324e2b0bff4a3c4e22"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#ab2a0087a0d30ff324e2b0bff4a3c4e22">sysio::chain::controller_impl::read_contract_tables_from_snapshot</a></div><div class="ttdeci">void read_contract_tables_from_snapshot(const snapshot_reader_ptr &amp;snapshot)</div><div class="ttdef"><b>Definition</b> <a href="#l00773">controller.cpp:773</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_ab76d9091b7e62fb25a0fdd63c8210af9"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#ab76d9091b7e62fb25a0fdd63c8210af9">sysio::chain::controller_impl::thread_pool</a></div><div class="ttdeci">named_thread_pool thread_pool</div><div class="ttdef"><b>Definition</b> <a href="#l00248">controller.cpp:248</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_ab90d295ac18fa98f2520e4eade5b3773"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#ab90d295ac18fa98f2520e4eade5b3773">sysio::chain::controller_impl::authorization</a></div><div class="ttdeci">authorization_manager authorization</div><div class="ttdef"><b>Definition</b> <a href="#l00238">controller.cpp:238</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_ab9468e19953b5bb9ace497c98ee4ecc1"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#ab9468e19953b5bb9ace497c98ee4ecc1">sysio::chain::controller_impl::scheduled_failure_is_subjective</a></div><div class="ttdeci">bool scheduled_failure_is_subjective(const fc::exception &amp;e) const</div><div class="ttdef"><b>Definition</b> <a href="#l01212">controller.cpp:1212</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_ab952243b3b18aaec46cce82670687075"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#ab952243b3b18aaec46cce82670687075">sysio::chain::controller_impl::subjective_cpu_leeway</a></div><div class="ttdeci">std::optional&lt; fc::microseconds &gt; subjective_cpu_leeway</div><div class="ttdef"><b>Definition</b> <a href="#l00245">controller.cpp:245</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_abde6bacce9f720ad552d0e342c52d3b4"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#abde6bacce9f720ad552d0e342c52d3b4">sysio::chain::controller_impl::commit_block</a></div><div class="ttdeci">void commit_block(bool add_to_fork_db)</div><div class="ttdoc">finalize_block</div><div class="ttdef"><b>Definition</b> <a href="#l01827">controller.cpp:1827</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_ac2d3794f1bd0ff1bd5837d8ead15d289"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#ac2d3794f1bd0ff1bd5837d8ead15d289">sysio::chain::controller_impl::push_block</a></div><div class="ttdeci">void push_block(const block_state_ptr &amp;bsp, const forked_branch_callback &amp;forked_branch_cb, const trx_meta_cache_lookup &amp;trx_lookup)</div><div class="ttdef"><b>Definition</b> <a href="#l02133">controller.cpp:2133</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_ac79d2ab18d201291e9fbd0b38044e1f1"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#ac79d2ab18d201291e9fbd0b38044e1f1">sysio::chain::controller_impl::check_actor_list</a></div><div class="ttdeci">void check_actor_list(const flat_set&lt; account_name &gt; &amp;actors) const</div><div class="ttdef"><b>Definition</b> <a href="#l02407">controller.cpp:2407</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_ac7dedae4e6f8bcbd20e69d1e5551e378"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#ac7dedae4e6f8bcbd20e69d1e5551e378">sysio::chain::controller_impl::add_indices</a></div><div class="ttdeci">void add_indices()</div><div class="ttdef"><b>Definition</b> <a href="#l00729">controller.cpp:729</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_ac9a42879c69a343b4405b035e7cff29a"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#ac9a42879c69a343b4405b035e7cff29a">sysio::chain::controller_impl::protocol_feature_activation_handlers</a></div><div class="ttdeci">unordered_map&lt; builtin_protocol_feature_t, std::function&lt; void(controller_impl &amp;)&gt;, enum_hash&lt; builtin_protocol_feature_t &gt; &gt; protocol_feature_activation_handlers</div><div class="ttdef"><b>Definition</b> <a href="#l00257">controller.cpp:257</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_ad0130874bac31eb408dd6e766084b814"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#ad0130874bac31eb408dd6e766084b814">sysio::chain::controller_impl::log_irreversible</a></div><div class="ttdeci">void log_irreversible()</div><div class="ttdef"><b>Definition</b> <a href="#l00395">controller.cpp:395</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_ad0d5a921dd01458d1464f63b0f0121c6"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#ad0d5a921dd01458d1464f63b0f0121c6">sysio::chain::controller_impl::failure_is_subjective</a></div><div class="ttdeci">bool failure_is_subjective(const fc::exception &amp;e) const</div><div class="ttdef"><b>Definition</b> <a href="#l01193">controller.cpp:1193</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_ad3c19aea29c2fbb28ca7120d591ba088"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#ad3c19aea29c2fbb28ca7120d591ba088">sysio::chain::controller_impl::timer</a></div><div class="ttdeci">platform_timer timer</div><div class="ttdef"><b>Definition</b> <a href="#l00249">controller.cpp:249</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_ad5c91b7cff820c07efed35a7b3912d68"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#ad5c91b7cff820c07efed35a7b3912d68">sysio::chain::controller_impl::create_block_state</a></div><div class="ttdeci">block_state_ptr create_block_state(const block_id_type &amp;id, const signed_block_ptr &amp;b)</div><div class="ttdef"><b>Definition</b> <a href="#l02119">controller.cpp:2119</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_ad83ca3895f901f87cbf1060493698f55"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#ad83ca3895f901f87cbf1060493698f55">sysio::chain::controller_impl::check_key_list</a></div><div class="ttdeci">void check_key_list(const public_key_type &amp;key) const</div><div class="ttdef"><b>Definition</b> <a href="#l02516">controller.cpp:2516</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_addaaa85d266d34e5f247ec9214354139"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#addaaa85d266d34e5f247ec9214354139">sysio::chain::controller_impl::validate_db_version</a></div><div class="ttdeci">static auto validate_db_version(const chainbase::database &amp;db)</div><div class="ttdef"><b>Definition</b> <a href="#l00649">controller.cpp:649</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_ade7505662796ff416f1d43862b0507fb"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#ade7505662796ff416f1d43862b0507fb">sysio::chain::controller_impl::clear_all_undo</a></div><div class="ttdeci">void clear_all_undo()</div><div class="ttdef"><b>Definition</b> <a href="#l00737">controller.cpp:737</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_ae2c30acb1a0557f6c3967c6a154f7b23"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#ae2c30acb1a0557f6c3967c6a154f7b23">sysio::chain::controller_impl::create_native_account</a></div><div class="ttdeci">void create_native_account(const fc::time_point &amp;initial_timestamp, account_name name, const authority &amp;owner, const authority &amp;active, bool is_privileged=false)</div><div class="ttdef"><b>Definition</b> <a href="#l00987">controller.cpp:987</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_ae66494cb9657c0157ee468c21b545f60"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#ae66494cb9657c0157ee468c21b545f60">sysio::chain::controller_impl::check_protocol_features</a></div><div class="ttdeci">void check_protocol_features(block_timestamp_type timestamp, const flat_set&lt; digest_type &gt; &amp;currently_activated_protocol_features, const vector&lt; digest_type &gt; &amp;new_protocol_features)</div><div class="ttdef"><b>Definition</b> <a href="#l01875">controller.cpp:1875</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_ae80ad4ddd1eff225dc19c50439d82ef6"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#ae80ad4ddd1eff225dc19c50439d82ef6">sysio::chain::controller_impl::calculate_integrity_hash</a></div><div class="ttdeci">sha256 calculate_integrity_hash()</div><div class="ttdef"><b>Definition</b> <a href="#l00978">controller.cpp:978</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_aea41b3020ee2994f7a15980fcbf9b735"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#aea41b3020ee2994f7a15980fcbf9b735">sysio::chain::controller_impl::sender_avoids_whitelist_blacklist_enforcement</a></div><div class="ttdeci">bool sender_avoids_whitelist_blacklist_enforcement(account_name sender) const</div><div class="ttdef"><b>Definition</b> <a href="#l02397">controller.cpp:2397</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_aed82882c38a7b9a2ab8ccf26b7d68126"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#aed82882c38a7b9a2ab8ccf26b7d68126">sysio::chain::controller_impl::abort_block</a></div><div class="ttdeci">vector&lt; transaction_metadata_ptr &gt; abort_block()</div><div class="ttdoc">push_block</div><div class="ttdef"><b>Definition</b> <a href="#l02315">controller.cpp:2315</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_af15d89f9220ba97aa5c521e643746587"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#af15d89f9220ba97aa5c521e643746587">sysio::chain::controller_impl::maybe_switch_forks</a></div><div class="ttdeci">void maybe_switch_forks(const block_state_ptr &amp;new_head, controller::block_status s, const forked_branch_callback &amp;forked_branch_cb, const trx_meta_cache_lookup &amp;trx_lookup)</div><div class="ttdef"><b>Definition</b> <a href="#l02229">controller.cpp:2229</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_af1df7b3285411e4e9ae6781353ad4d80"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#af1df7b3285411e4e9ae6781353ad4d80">sysio::chain::controller_impl::create_block_state_future</a></div><div class="ttdeci">std::future&lt; block_state_ptr &gt; create_block_state_future(const block_id_type &amp;id, const signed_block_ptr &amp;b)</div><div class="ttdef"><b>Definition</b> <a href="#l02102">controller.cpp:2102</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_af239089382ffa593908091df9d6d0cbd"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#af239089382ffa593908091df9d6d0cbd">sysio::chain::controller_impl::~controller_impl</a></div><div class="ttdeci">~controller_impl()</div><div class="ttdef"><b>Definition</b> <a href="#l00724">controller.cpp:724</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_af381eb0fcede18ab0ae4cddaaa9df6cd"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#af381eb0fcede18ab0ae4cddaaa9df6cd">sysio::chain::controller_impl::push_transaction</a></div><div class="ttdeci">transaction_trace_ptr push_transaction(const transaction_metadata_ptr &amp;trx, fc::time_point block_deadline, fc::microseconds max_transaction_time, uint32_t billed_cpu_time_us, bool explicit_billed_cpu_time, int64_t subjective_cpu_bill_us)</div><div class="ttdef"><b>Definition</b> <a href="#l01455">controller.cpp:1455</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_af3f88c130012bd7de2401b5b80fd3129"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#af3f88c130012bd7de2401b5b80fd3129">sysio::chain::controller_impl::trusted_producer_light_validation</a></div><div class="ttdeci">bool trusted_producer_light_validation</div><div class="ttdef"><b>Definition</b> <a href="#l00246">controller.cpp:246</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_af7f72e6389799b7921aa98f30534f0d9"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#af7f72e6389799b7921aa98f30534f0d9">sysio::chain::controller_impl::fork_db</a></div><div class="ttdeci">fork_database fork_db</div><div class="ttdef"><b>Definition</b> <a href="#l00235">controller.cpp:235</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_af932f3160706510eaf30e2b76f386973"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#af932f3160706510eaf30e2b76f386973">sysio::chain::controller_impl::report_block_header_diff</a></div><div class="ttdeci">void report_block_header_diff(const block_header &amp;b, const block_header &amp;ab)</div><div class="ttdef"><b>Definition</b> <a href="#l01927">controller.cpp:1927</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_af94aa57dba3a7504a8047a11d37c3b27"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#af94aa57dba3a7504a8047a11d37c3b27">sysio::chain::controller_impl::wasmif</a></div><div class="ttdeci">wasm_interface wasmif</div><div class="ttdef"><b>Definition</b> <a href="#l00236">controller.cpp:236</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_afb7b8a4e7c718c1262fe755aa1c2f148"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#afb7b8a4e7c718c1262fe755aa1c2f148">sysio::chain::controller_impl::add_contract_tables_to_snapshot</a></div><div class="ttdeci">void add_contract_tables_to_snapshot(const snapshot_writer_ptr &amp;snapshot) const</div><div class="ttdef"><b>Definition</b> <a href="#l00747">controller.cpp:747</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_afcd800bda7495ddc4ddee1074d5bfcb7"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#afcd800bda7495ddc4ddee1074d5bfcb7">sysio::chain::controller_impl::controller_impl</a></div><div class="ttdeci">controller_impl(const controller::config &amp;cfg, controller &amp;s, protocol_feature_set &amp;&amp;pfs, const chain_id_type &amp;chain_id)</div><div class="ttdef"><b>Definition</b> <a href="#l00297">controller.cpp:297</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_afe8c6fe322a239e2f910f26a385786f0"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#afe8c6fe322a239e2f910f26a385786f0">sysio::chain::controller_impl::snapshot_head_block</a></div><div class="ttdeci">uint32_t snapshot_head_block</div><div class="ttdef"><b>Definition</b> <a href="#l00247">controller.cpp:247</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1controller__impl_html_aff9373c6d02a511984f20486e90585f5"><div class="ttname"><a href="structsysio_1_1chain_1_1controller__impl.html#aff9373c6d02a511984f20486e90585f5">sysio::chain::controller_impl::check_action_list</a></div><div class="ttdeci">void check_action_list(account_name code, action_name action) const</div><div class="ttdef"><b>Definition</b> <a href="#l02506">controller.cpp:2506</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1detail_1_1block__header__state__common_html_abfdafe630675287e81a2bc479aa6ce20"><div class="ttname"><a href="structsysio_1_1chain_1_1detail_1_1block__header__state__common.html#abfdafe630675287e81a2bc479aa6ce20">sysio::chain::detail::block_header_state_common::active_schedule</a></div><div class="ttdeci">producer_authority_schedule active_schedule</div><div class="ttdef"><b>Definition</b> <a href="block__header__state_8hpp_source.html#l00056">block_header_state.hpp:56</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1detail_1_1block__header__state__common_html_ae85e3375836639cb1e7543aea7cf0552"><div class="ttname"><a href="structsysio_1_1chain_1_1detail_1_1block__header__state__common.html#ae85e3375836639cb1e7543aea7cf0552">sysio::chain::detail::block_header_state_common::block_num</a></div><div class="ttdeci">uint32_t block_num</div><div class="ttdef"><b>Definition</b> <a href="block__header__state_8hpp_source.html#l00053">block_header_state.hpp:53</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1detail_1_1schedule__info_html_a4f1fa6ff028fd822e1e566bdb7dd95a7"><div class="ttname"><a href="structsysio_1_1chain_1_1detail_1_1schedule__info.html#a4f1fa6ff028fd822e1e566bdb7dd95a7">sysio::chain::detail::schedule_info::schedule</a></div><div class="ttdeci">producer_authority_schedule schedule</div><div class="ttdef"><b>Definition</b> <a href="block__header__state_8hpp_source.html#l00067">block_header_state.hpp:67</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1detail_1_1schedule__info_html_ace19480f2ab629e6b82a3a8286b38729"><div class="ttname"><a href="structsysio_1_1chain_1_1detail_1_1schedule__info.html#ace19480f2ab629e6b82a3a8286b38729">sysio::chain::detail::schedule_info::schedule_hash</a></div><div class="ttdeci">digest_type schedule_hash</div><div class="ttdoc">last irr block num</div><div class="ttdef"><b>Definition</b> <a href="block__header__state_8hpp_source.html#l00066">block_header_state.hpp:66</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1enum__hash_html"><div class="ttname"><a href="structsysio_1_1chain_1_1enum__hash.html">sysio::chain::enum_hash</a></div><div class="ttdef"><b>Definition</b> <a href="chain_2include_2sysio_2chain_2types_8hpp_source.html#l00308">types.hpp:309</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1genesis__state_html"><div class="ttname"><a href="structsysio_1_1chain_1_1genesis__state.html">sysio::chain::genesis_state</a></div><div class="ttdef"><b>Definition</b> <a href="genesis__state_8hpp_source.html#l00014">genesis_state.hpp:14</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1genesis__state_html_a3e6e5eb6e7b0107b1f105eb8a4dcca41"><div class="ttname"><a href="structsysio_1_1chain_1_1genesis__state.html#a3e6e5eb6e7b0107b1f105eb8a4dcca41">sysio::chain::genesis_state::default_initial_wasm_configuration</a></div><div class="ttdeci">static constexpr wasm_config default_initial_wasm_configuration</div><div class="ttdef"><b>Definition</b> <a href="genesis__state_8hpp_source.html#l00041">genesis_state.hpp:41</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1key__weight_html"><div class="ttname"><a href="structsysio_1_1chain_1_1key__weight.html">sysio::chain::key_weight</a></div><div class="ttdef"><b>Definition</b> <a href="authority_8hpp_source.html#l00095">authority.hpp:95</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1kv__database__config_html"><div class="ttname"><a href="structsysio_1_1chain_1_1kv__database__config.html">sysio::chain::kv_database_config</a></div><div class="ttdoc">limits for a kv database.</div><div class="ttdef"><b>Definition</b> <a href="kv__config_8hpp_source.html#l00015">kv_config.hpp:15</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1legacy_1_1producer__schedule__type_html"><div class="ttname"><a href="structsysio_1_1chain_1_1legacy_1_1producer__schedule__type.html">sysio::chain::legacy::producer_schedule_type</a></div><div class="ttdef"><b>Definition</b> <a href="producer__schedule_8hpp_source.html#l00029">producer_schedule.hpp:29</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1legacy_1_1snapshot__block__header__state__v2_html"><div class="ttname"><a href="structsysio_1_1chain_1_1legacy_1_1snapshot__block__header__state__v2.html">sysio::chain::legacy::snapshot_block_header_state_v2</a></div><div class="ttdef"><b>Definition</b> <a href="block__header__state_8hpp_source.html#l00017">block_header_state.hpp:17</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1legacy_1_1snapshot__global__property__object__v2_html"><div class="ttname"><a href="structsysio_1_1chain_1_1legacy_1_1snapshot__global__property__object__v2.html">sysio::chain::legacy::snapshot_global_property_object_v2</a></div><div class="ttdef"><b>Definition</b> <a href="global__property__object_8hpp_source.html#l00024">global_property_object.hpp:24</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1legacy_1_1snapshot__global__property__object__v3_html"><div class="ttname"><a href="structsysio_1_1chain_1_1legacy_1_1snapshot__global__property__object__v3.html">sysio::chain::legacy::snapshot_global_property_object_v3</a></div><div class="ttdef"><b>Definition</b> <a href="global__property__object_8hpp_source.html#l00033">global_property_object.hpp:33</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1legacy_1_1snapshot__global__property__object__v4_html"><div class="ttname"><a href="structsysio_1_1chain_1_1legacy_1_1snapshot__global__property__object__v4.html">sysio::chain::legacy::snapshot_global_property_object_v4</a></div><div class="ttdef"><b>Definition</b> <a href="global__property__object_8hpp_source.html#l00043">global_property_object.hpp:43</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1name_html"><div class="ttname"><a href="structsysio_1_1chain_1_1name.html">sysio::chain::name</a></div><div class="ttdoc">Immutable except for fc::from_variant.</div><div class="ttdef"><b>Definition</b> <a href="name_8hpp_source.html#l00043">name.hpp:43</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1onerror_html"><div class="ttname"><a href="structsysio_1_1chain_1_1onerror.html">sysio::chain::onerror</a></div><div class="ttdef"><b>Definition</b> <a href="contract__types_8hpp_source.html#l00139">contract_types.hpp:139</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1packed__transaction_html"><div class="ttname"><a href="structsysio_1_1chain_1_1packed__transaction.html">sysio::chain::packed_transaction</a></div><div class="ttdef"><b>Definition</b> <a href="transaction_8hpp_source.html#l00136">transaction.hpp:136</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1packed__transaction_html_ad193d26eb97cfd5b3f7d8b957eaa35a2"><div class="ttname"><a href="structsysio_1_1chain_1_1packed__transaction.html#ad193d26eb97cfd5b3f7d8b957eaa35a2">sysio::chain::packed_transaction::get_transaction</a></div><div class="ttdeci">const transaction &amp; get_transaction() const</div><div class="ttdef"><b>Definition</b> <a href="transaction_8hpp_source.html#l00184">transaction.hpp:184</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1pending__block__header__state_html"><div class="ttname"><a href="structsysio_1_1chain_1_1pending__block__header__state.html">sysio::chain::pending_block_header_state</a></div><div class="ttdef"><b>Definition</b> <a href="block__header__state_8hpp_source.html#l00075">block_header_state.hpp:75</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1pending__state_html"><div class="ttname"><a href="structsysio_1_1chain_1_1pending__state.html">sysio::chain::pending_state</a></div><div class="ttdef"><b>Definition</b> <a href="#l00147">controller.cpp:147</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1pending__state_html_a13e2c50cfff7b6b71fb7492f4d1fb062"><div class="ttname"><a href="structsysio_1_1chain_1_1pending__state.html#a13e2c50cfff7b6b71fb7492f4d1fb062">sysio::chain::pending_state::pending_state</a></div><div class="ttdeci">pending_state(maybe_session &amp;&amp;s, const block_header_state &amp;prev, block_timestamp_type when, uint16_t num_prev_blocks_to_confirm, const vector&lt; digest_type &gt; &amp;new_protocol_feature_activations)</div><div class="ttdef"><b>Definition</b> <a href="#l00148">controller.cpp:148</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1pending__state_html_a2c405d44fcef39bacfe70543cfe39f45"><div class="ttname"><a href="structsysio_1_1chain_1_1pending__state.html#a2c405d44fcef39bacfe70543cfe39f45">sysio::chain::pending_state::get_pending_block_header_state</a></div><div class="ttdeci">const pending_block_header_state &amp; get_pending_block_header_state() const</div><div class="ttdef"><b>Definition</b> <a href="#l00162">controller.cpp:162</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1pending__state_html_a30e2df8beb27a0811a10a033d783caf8"><div class="ttname"><a href="structsysio_1_1chain_1_1pending__state.html#a30e2df8beb27a0811a10a033d783caf8">sysio::chain::pending_state::is_protocol_feature_activated</a></div><div class="ttdeci">bool is_protocol_feature_activated(const digest_type &amp;feature_digest) const</div><div class="ttdef"><b>Definition</b> <a href="#l00189">controller.cpp:189</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1pending__state_html_a517fdd298cc25b04ae5cd0392922e777"><div class="ttname"><a href="structsysio_1_1chain_1_1pending__state.html#a517fdd298cc25b04ae5cd0392922e777">sysio::chain::pending_state::_db_session</a></div><div class="ttdeci">maybe_session _db_session</div><div class="ttdef"><b>Definition</b> <a href="#l00156">controller.cpp:156</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1pending__state_html_a6d01b8752e2c1422ca60ffa14a1b9c98"><div class="ttname"><a href="structsysio_1_1chain_1_1pending__state.html#a6d01b8752e2c1422ca60ffa14a1b9c98">sysio::chain::pending_state::push</a></div><div class="ttdeci">void push()</div><div class="ttdef"><b>Definition</b> <a href="#l00215">controller.cpp:215</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1pending__state_html_a7421746433955d65443ce99c8eb80162"><div class="ttname"><a href="structsysio_1_1chain_1_1pending__state.html#a7421746433955d65443ce99c8eb80162">sysio::chain::pending_state::extract_trx_metas</a></div><div class="ttdeci">vector&lt; transaction_metadata_ptr &gt; extract_trx_metas()</div><div class="ttdef"><b>Definition</b> <a href="#l00179">controller.cpp:179</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1pending__state_html_a990d04e147e24c39dd40fe0be53109fb"><div class="ttname"><a href="structsysio_1_1chain_1_1pending__state.html#a990d04e147e24c39dd40fe0be53109fb">sysio::chain::pending_state::_producer_block_id</a></div><div class="ttdeci">std::optional&lt; block_id_type &gt; _producer_block_id</div><div class="ttdef"><b>Definition</b> <a href="#l00159">controller.cpp:159</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1pending__state_html_aaa0b61ca367d56e4954e753286a8f5fb"><div class="ttname"><a href="structsysio_1_1chain_1_1pending__state.html#aaa0b61ca367d56e4954e753286a8f5fb">sysio::chain::pending_state::get_trx_receipts</a></div><div class="ttdeci">const vector&lt; transaction_receipt &gt; &amp; get_trx_receipts() const</div><div class="ttdef"><b>Definition</b> <a href="#l00169">controller.cpp:169</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1pending__state_html_ae74607271d60d9118b221f3596b16271"><div class="ttname"><a href="structsysio_1_1chain_1_1pending__state.html#ae74607271d60d9118b221f3596b16271">sysio::chain::pending_state::_block_stage</a></div><div class="ttdeci">block_stage_type _block_stage</div><div class="ttdef"><b>Definition</b> <a href="#l00157">controller.cpp:157</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1pending__state_html_ae760ba9e1dec40b2ebf90dff08a3efec"><div class="ttname"><a href="structsysio_1_1chain_1_1pending__state.html#ae760ba9e1dec40b2ebf90dff08a3efec">sysio::chain::pending_state::_block_status</a></div><div class="ttdeci">controller::block_status _block_status</div><div class="ttdef"><b>Definition</b> <a href="#l00158">controller.cpp:158</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1platform__timer_html"><div class="ttname"><a href="structsysio_1_1chain_1_1platform__timer.html">sysio::chain::platform_timer</a></div><div class="ttdef"><b>Definition</b> <a href="platform__timer_8hpp_source.html#l00014">platform_timer.hpp:14</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1producer__authority__schedule_html"><div class="ttname"><a href="structsysio_1_1chain_1_1producer__authority__schedule.html">sysio::chain::producer_authority_schedule</a></div><div class="ttdef"><b>Definition</b> <a href="producer__schedule_8hpp_source.html#l00231">producer_schedule.hpp:231</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1producer__authority__schedule_html_a477f957323b97c0af6700ef384326b83"><div class="ttname"><a href="structsysio_1_1chain_1_1producer__authority__schedule.html#a477f957323b97c0af6700ef384326b83">sysio::chain::producer_authority_schedule::version</a></div><div class="ttdeci">uint32_t version</div><div class="ttdoc">sequentially incrementing version number</div><div class="ttdef"><b>Definition</b> <a href="producer__schedule_8hpp_source.html#l00272">producer_schedule.hpp:272</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1producer__authority__schedule_html_a4b0d95b22a8be15ac06dc3b105638c54"><div class="ttname"><a href="structsysio_1_1chain_1_1producer__authority__schedule.html#a4b0d95b22a8be15ac06dc3b105638c54">sysio::chain::producer_authority_schedule::from_shared</a></div><div class="ttdeci">static auto from_shared(const shared_producer_authority_schedule &amp;src)</div><div class="ttdef"><b>Definition</b> <a href="producer__schedule_8hpp_source.html#l00261">producer_schedule.hpp:261</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1producer__authority__schedule_html_aca17ff9b0f16d16b6f04d4e47bd0d522"><div class="ttname"><a href="structsysio_1_1chain_1_1producer__authority__schedule.html#aca17ff9b0f16d16b6f04d4e47bd0d522">sysio::chain::producer_authority_schedule::to_shared</a></div><div class="ttdeci">auto to_shared(chainbase::allocator&lt; char &gt; alloc) const</div><div class="ttdef"><b>Definition</b> <a href="producer__schedule_8hpp_source.html#l00250">producer_schedule.hpp:250</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1producer__authority__schedule_html_afb0f1bdb282b3d8e1a60ee37c70657d4"><div class="ttname"><a href="structsysio_1_1chain_1_1producer__authority__schedule.html#afb0f1bdb282b3d8e1a60ee37c70657d4">sysio::chain::producer_authority_schedule::producers</a></div><div class="ttdeci">vector&lt; producer_authority &gt; producers</div><div class="ttdef"><b>Definition</b> <a href="producer__schedule_8hpp_source.html#l00273">producer_schedule.hpp:273</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1producer__authority_html"><div class="ttname"><a href="structsysio_1_1chain_1_1producer__authority.html">sysio::chain::producer_authority</a></div><div class="ttdef"><b>Definition</b> <a href="producer__schedule_8hpp_source.html#l00163">producer_schedule.hpp:163</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1s__header_html"><div class="ttname"><a href="structsysio_1_1chain_1_1s__header.html">sysio::chain::s_header</a></div><div class="ttdef"><b>Definition</b> <a href="s__root__extension_8hpp_source.html#l00007">s_root_extension.hpp:7</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1s__header_html_a2075610dd92e3718f545b14adcd3ebf7"><div class="ttname"><a href="structsysio_1_1chain_1_1s__header.html#a2075610dd92e3718f545b14adcd3ebf7">sysio::chain::s_header::to_string</a></div><div class="ttdeci">std::string to_string() const</div><div class="ttdef"><b>Definition</b> <a href="s__root__extension_8hpp_source.html#l00036">s_root_extension.hpp:36</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1signed__transaction_html"><div class="ttname"><a href="structsysio_1_1chain_1_1signed__transaction.html">sysio::chain::signed_transaction</a></div><div class="ttdef"><b>Definition</b> <a href="transaction_8hpp_source.html#l00110">transaction.hpp:111</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1snapshot__global__property__object_html"><div class="ttname"><a href="structsysio_1_1chain_1_1snapshot__global__property__object.html">sysio::chain::snapshot_global_property_object</a></div><div class="ttdef"><b>Definition</b> <a href="global__property__object_8hpp_source.html#l00114">global_property_object.hpp:114</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1snapshot__global__property__object_html_a999715132a697f29e1ad6b7b0c4fde2a"><div class="ttname"><a href="structsysio_1_1chain_1_1snapshot__global__property__object.html#a999715132a697f29e1ad6b7b0c4fde2a">sysio::chain::snapshot_global_property_object::chain_id</a></div><div class="ttdeci">chain_id_type chain_id</div><div class="ttdef"><b>Definition</b> <a href="global__property__object_8hpp_source.html#l00118">global_property_object.hpp:118</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1transaction__checktime__timer_html"><div class="ttname"><a href="structsysio_1_1chain_1_1transaction__checktime__timer.html">sysio::chain::transaction_checktime_timer</a></div><div class="ttdef"><b>Definition</b> <a href="transaction__context_8hpp_source.html#l00009">transaction_context.hpp:9</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1transaction__header_html_a220798b433002112ac85e5545a99ec51"><div class="ttname"><a href="structsysio_1_1chain_1_1transaction__header.html#a220798b433002112ac85e5545a99ec51">sysio::chain::transaction_header::set_reference_block</a></div><div class="ttdeci">void set_reference_block(const block_id_type &amp;reference_block)</div><div class="ttdef"><b>Definition</b> <a href="transaction_8cpp_source.html#l00026">transaction.cpp:26</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1transaction__header_html_a349b11695387e3dbe91f918ee759d4b4"><div class="ttname"><a href="structsysio_1_1chain_1_1transaction__header.html#a349b11695387e3dbe91f918ee759d4b4">sysio::chain::transaction_header::delay_sec</a></div><div class="ttdeci">fc::unsigned_int delay_sec</div><div class="ttdoc">upper limit on the total CPU time billed for this transaction</div><div class="ttdef"><b>Definition</b> <a href="transaction_8hpp_source.html#l00065">transaction.hpp:65</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1transaction__header_html_a459d803b930351f4a1565d9c082debea"><div class="ttname"><a href="structsysio_1_1chain_1_1transaction__header.html#a459d803b930351f4a1565d9c082debea">sysio::chain::transaction_header::ref_block_num</a></div><div class="ttdeci">uint16_t ref_block_num</div><div class="ttdoc">specifies a block num in the last 2^16 blocks.</div><div class="ttdef"><b>Definition</b> <a href="transaction_8hpp_source.html#l00061">transaction.hpp:61</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1transaction__header_html_a6f02077864a99b91d043cd329433a532"><div class="ttname"><a href="structsysio_1_1chain_1_1transaction__header.html#a6f02077864a99b91d043cd329433a532">sysio::chain::transaction_header::ref_block_prefix</a></div><div class="ttdeci">uint32_t ref_block_prefix</div><div class="ttdoc">specifies the lower 32 bits of the blockid at get_ref_blocknum</div><div class="ttdef"><b>Definition</b> <a href="transaction_8hpp_source.html#l00062">transaction.hpp:62</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1transaction__header_html_a92adbf497323e601b30eb8475881fb52"><div class="ttname"><a href="structsysio_1_1chain_1_1transaction__header.html#a92adbf497323e601b30eb8475881fb52">sysio::chain::transaction_header::verify_reference_block</a></div><div class="ttdeci">bool verify_reference_block(const block_id_type &amp;reference_block) const</div><div class="ttdef"><b>Definition</b> <a href="transaction_8cpp_source.html#l00031">transaction.cpp:31</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1transaction__header_html_ad1ed2586e8ace769fdb9a54d09a752ce"><div class="ttname"><a href="structsysio_1_1chain_1_1transaction__header.html#ad1ed2586e8ace769fdb9a54d09a752ce">sysio::chain::transaction_header::expiration</a></div><div class="ttdeci">time_point_sec expiration</div><div class="ttdoc">the time at which a transaction expires</div><div class="ttdef"><b>Definition</b> <a href="transaction_8hpp_source.html#l00060">transaction.hpp:60</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1transaction__receipt__header_html"><div class="ttname"><a href="structsysio_1_1chain_1_1transaction__receipt__header.html">sysio::chain::transaction_receipt_header</a></div><div class="ttdef"><b>Definition</b> <a href="block_8hpp_source.html#l00012">block.hpp:12</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1transaction__receipt__header_html_a2bb00bac16048e6f624c2ded867ebf55"><div class="ttname"><a href="structsysio_1_1chain_1_1transaction__receipt__header.html#a2bb00bac16048e6f624c2ded867ebf55">sysio::chain::transaction_receipt_header::status_enum</a></div><div class="ttdeci">status_enum</div><div class="ttdef"><b>Definition</b> <a href="block_8hpp_source.html#l00013">block.hpp:13</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1transaction__receipt__header_html_a2bb00bac16048e6f624c2ded867ebf55a6b6365bc9e75414c669484391aa7729d"><div class="ttname"><a href="structsysio_1_1chain_1_1transaction__receipt__header.html#a2bb00bac16048e6f624c2ded867ebf55a6b6365bc9e75414c669484391aa7729d">sysio::chain::transaction_receipt_header::delayed</a></div><div class="ttdeci">@ delayed</div><div class="ttdoc">transaction delayed/deferred/scheduled for future execution</div><div class="ttdef"><b>Definition</b> <a href="block_8hpp_source.html#l00017">block.hpp:17</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1transaction__receipt__header_html_a2bb00bac16048e6f624c2ded867ebf55a7a6de58f1f84063a5f85bbfb59b43608"><div class="ttname"><a href="structsysio_1_1chain_1_1transaction__receipt__header.html#a2bb00bac16048e6f624c2ded867ebf55a7a6de58f1f84063a5f85bbfb59b43608">sysio::chain::transaction_receipt_header::executed</a></div><div class="ttdeci">@ executed</div><div class="ttdoc">succeed, no error handler executed</div><div class="ttdef"><b>Definition</b> <a href="block_8hpp_source.html#l00014">block.hpp:14</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1transaction__receipt__header_html_a2bb00bac16048e6f624c2ded867ebf55a98d0df834b74445e549f5d2123443b4e"><div class="ttname"><a href="structsysio_1_1chain_1_1transaction__receipt__header.html#a2bb00bac16048e6f624c2ded867ebf55a98d0df834b74445e549f5d2123443b4e">sysio::chain::transaction_receipt_header::soft_fail</a></div><div class="ttdeci">@ soft_fail</div><div class="ttdoc">objectively failed (not executed), error handler executed</div><div class="ttdef"><b>Definition</b> <a href="block_8hpp_source.html#l00015">block.hpp:15</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1transaction__receipt__header_html_a2bb00bac16048e6f624c2ded867ebf55ac705728ca8b5f3a44d8026e14990c463"><div class="ttname"><a href="structsysio_1_1chain_1_1transaction__receipt__header.html#a2bb00bac16048e6f624c2ded867ebf55ac705728ca8b5f3a44d8026e14990c463">sysio::chain::transaction_receipt_header::hard_fail</a></div><div class="ttdeci">@ hard_fail</div><div class="ttdoc">objectively failed and error handler objectively failed thus no state change</div><div class="ttdef"><b>Definition</b> <a href="block_8hpp_source.html#l00016">block.hpp:16</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1transaction__receipt__header_html_a2bb00bac16048e6f624c2ded867ebf55ac9a3d403c49bf068d1f8f07e20df72b5"><div class="ttname"><a href="structsysio_1_1chain_1_1transaction__receipt__header.html#a2bb00bac16048e6f624c2ded867ebf55ac9a3d403c49bf068d1f8f07e20df72b5">sysio::chain::transaction_receipt_header::expired</a></div><div class="ttdeci">@ expired</div><div class="ttdoc">transaction expired and storage space refuned to user</div><div class="ttdef"><b>Definition</b> <a href="block_8hpp_source.html#l00019">block.hpp:18</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1transaction__receipt_html"><div class="ttname"><a href="structsysio_1_1chain_1_1transaction__receipt.html">sysio::chain::transaction_receipt</a></div><div class="ttdef"><b>Definition</b> <a href="block_8hpp_source.html#l00033">block.hpp:33</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1transaction_html"><div class="ttname"><a href="structsysio_1_1chain_1_1transaction.html">sysio::chain::transaction</a></div><div class="ttdef"><b>Definition</b> <a href="transaction_8hpp_source.html#l00083">transaction.hpp:83</a></div></div>
<div class="ttc" id="astructsysio_1_1chain_1_1transaction_html_a407fcf1868b81bb30b85f80d388bbac2"><div class="ttname"><a href="structsysio_1_1chain_1_1transaction.html#a407fcf1868b81bb30b85f80d388bbac2">sysio::chain::transaction::actions</a></div><div class="ttdeci">vector&lt; action &gt; actions</div><div class="ttdef"><b>Definition</b> <a href="transaction_8hpp_source.html#l00085">transaction.hpp:85</a></div></div>
<div class="ttc" id="asysio__contract_8hpp_html"><div class="ttname"><a href="sysio__contract_8hpp.html">sysio_contract.hpp</a></div></div>
<div class="ttc" id="athread__utils_8hpp_html"><div class="ttname"><a href="thread__utils_8hpp.html">thread_utils.hpp</a></div></div>
<div class="ttc" id="atransaction__context_8hpp_html"><div class="ttname"><a href="transaction__context_8hpp.html">transaction_context.hpp</a></div></div>
<div class="ttc" id="atransaction__object_8hpp_html"><div class="ttname"><a href="transaction__object_8hpp.html">transaction_object.hpp</a></div></div>
<div class="ttc" id="avariant__object_8hpp_html"><div class="ttname"><a href="variant__object_8hpp.html">variant_object.hpp</a></div></div>
<div class="ttc" id="awhitelisted__intrinsics_8hpp_html"><div class="ttname"><a href="whitelisted__intrinsics_8hpp.html">whitelisted_intrinsics.hpp</a></div></div>
<div class="ttc" id="ayubico__otp_8c_html_a9246c20bb98ad2b4c60313c053c70f08"><div class="ttname"><a href="yubico__otp_8c.html#a9246c20bb98ad2b4c60313c053c70f08">key</a></div><div class="ttdeci">uint8_t key[16]</div><div class="ttdef"><b>Definition</b> <a href="yubico__otp_8c_source.html#l00041">yubico_otp.c:41</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a107648633008a7f2d872b4b3d98c2f96"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a107648633008a7f2d872b4b3d98c2f96">d</a></div><div class="ttdeci">CK_ULONG d</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l01238">yubihsm_pkcs11.c:1238</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a506da415c9307c897ca9be93acfe1d0f"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a></div><div class="ttdeci">char * s</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l00524">yubihsm_pkcs11.c:524</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_428556e0652617aa37d2f7d8bcaf7fdf.html">libraries</a></li><li class="navelem"><a class="el" href="dir_0d4aba5c25a4be0a24c819a636048cb8.html">chain</a></li><li class="navelem"><a class="el" href="controller_8cpp.html">controller.cpp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0 </li>
  </ul>
</div>
</body>
</html>
