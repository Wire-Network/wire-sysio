<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Wire Sysio: libraries/yubihsm/ykyh/ykyh.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Wire Sysio<span id="projectnumber">&#160;Wire Sysion 1.0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('ykyh_8c.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">ykyh.c File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;<a class="el" href="stdint_8h_source.html">stdint.h</a>&gt;</code><br />
<code>#include &quot;<a class="el" href="ykyh_2internal_8h_source.html">internal.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="ykyh_8h_source.html">ykyh.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for ykyh.c:</div>
<div class="dyncontent">
<div class="center"><img src="ykyh_8c__incl.png" border="0" usemap="#alibraries_2yubihsm_2ykyh_2ykyh_8c" alt=""/></div>
<map name="alibraries_2yubihsm_2ykyh_2ykyh_8c" id="alibraries_2yubihsm_2ykyh_2ykyh_8c">
<area shape="rect" title=" " alt="" coords="184,5,336,46"/>
<area shape="rect" title=" " alt="" coords="8,94,72,120"/>
<area shape="poly" title=" " alt="" coords="206,49,87,92,85,87,204,44"/>
<area shape="rect" title=" " alt="" coords="96,94,160,120"/>
<area shape="poly" title=" " alt="" coords="228,49,162,88,160,83,226,44"/>
<area shape="rect" title=" " alt="" coords="184,94,245,120"/>
<area shape="poly" title=" " alt="" coords="251,48,231,82,227,79,246,45"/>
<area shape="rect" href="stdint_8h.html" title=" " alt="" coords="405,168,469,193"/>
<area shape="poly" title=" " alt="" coords="293,44,358,92,420,154,416,158,354,96,290,49"/>
<area shape="rect" href="ykyh_2internal_8h.html" title=" " alt="" coords="269,94,344,120"/>
<area shape="poly" title=" " alt="" coords="274,45,294,79,289,82,269,48"/>
<area shape="rect" href="ykyh_8h.html" title=" " alt="" coords="419,94,479,120"/>
<area shape="poly" title=" " alt="" coords="308,44,407,85,405,90,306,49"/>
<area shape="rect" title=" " alt="" coords="360,241,424,267"/>
<area shape="poly" title=" " alt="" coords="432,195,410,230,405,227,427,192"/>
<area shape="rect" title=" " alt="" coords="448,241,514,267"/>
<area shape="poly" title=" " alt="" coords="447,192,468,226,463,229,442,195"/>
<area shape="rect" title=" " alt="" coords="5,168,80,193"/>
<area shape="poly" title=" " alt="" coords="269,121,95,168,94,163,268,116"/>
<area shape="rect" title=" " alt="" coords="103,168,230,193"/>
<area shape="poly" title=" " alt="" coords="284,123,205,163,203,158,282,118"/>
<area shape="rect" title=" " alt="" coords="254,168,380,193"/>
<area shape="poly" title=" " alt="" coords="311,119,316,152,310,153,306,120"/>
<area shape="poly" title=" " alt="" coords="450,120,444,153,439,152,445,119"/>
<area shape="rect" title=" " alt="" coords="494,168,562,193"/>
<area shape="poly" title=" " alt="" coords="464,118,505,155,502,159,461,122"/>
</map>
</div>
</div>
<p><a href="ykyh_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aaf8c4d6e022e4363c006d9066991776b" id="r_aaf8c4d6e022e4363c006d9066991776b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112">ykyh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aaf8c4d6e022e4363c006d9066991776b">ykyh_init</a> (<a class="el" href="structykyh__state.html">ykyh_state</a> **<a class="el" href="structstate.html">state</a>, int verbose)</td></tr>
<tr class="separator:aaf8c4d6e022e4363c006d9066991776b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6833a1e74b0e7494cc904dc94cf276c0" id="r_a6833a1e74b0e7494cc904dc94cf276c0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112">ykyh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6833a1e74b0e7494cc904dc94cf276c0">ykyh_done</a> (<a class="el" href="structykyh__state.html">ykyh_state</a> *<a class="el" href="structstate.html">state</a>)</td></tr>
<tr class="separator:a6833a1e74b0e7494cc904dc94cf276c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8e0c6bd9abb1282586aa040b8c03d45" id="r_af8e0c6bd9abb1282586aa040b8c03d45"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112">ykyh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af8e0c6bd9abb1282586aa040b8c03d45">ykyh_disconnect</a> (<a class="el" href="structykyh__state.html">ykyh_state</a> *<a class="el" href="structstate.html">state</a>)</td></tr>
<tr class="separator:af8e0c6bd9abb1282586aa040b8c03d45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b53f9d9825a88a6a20352c9734e4a4d" id="r_a6b53f9d9825a88a6a20352c9734e4a4d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112">ykyh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6b53f9d9825a88a6a20352c9734e4a4d">ykyh_connect</a> (<a class="el" href="structykyh__state.html">ykyh_state</a> *<a class="el" href="structstate.html">state</a>, const char *wanted)</td></tr>
<tr class="separator:a6b53f9d9825a88a6a20352c9734e4a4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a87b4e80e8f980badba176c4b713e13" id="r_a9a87b4e80e8f980badba176c4b713e13"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112">ykyh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9a87b4e80e8f980badba176c4b713e13">ykyh_list_readers</a> (<a class="el" href="structykyh__state.html">ykyh_state</a> *<a class="el" href="structstate.html">state</a>, char *readers, size_t *<a class="el" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>)</td></tr>
<tr class="separator:a9a87b4e80e8f980badba176c4b713e13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14f49c7ef8ee9ac66936346e7f21d6ce" id="r_a14f49c7ef8ee9ac66936346e7f21d6ce"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112">ykyh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a14f49c7ef8ee9ac66936346e7f21d6ce">ykyh_get_version</a> (<a class="el" href="structykyh__state.html">ykyh_state</a> *<a class="el" href="structstate.html">state</a>, char *version, size_t <a class="el" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>)</td></tr>
<tr class="separator:a14f49c7ef8ee9ac66936346e7f21d6ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b123e6c68508162de189bcac06a3954" id="r_a0b123e6c68508162de189bcac06a3954"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112">ykyh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0b123e6c68508162de189bcac06a3954">ykyh_put</a> (<a class="el" href="structykyh__state.html">ykyh_state</a> *<a class="el" href="structstate.html">state</a>, const char *<a class="el" href="catch__reporter__console_8cpp.html#a9b45b3e13bd9167aab02e17e08916231">name</a>, const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *key_enc, size_t key_enc_len, const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *key_mac, size_t key_mac_len, const char *pw, const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> touch_policy)</td></tr>
<tr class="separator:a0b123e6c68508162de189bcac06a3954"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acfb1affcb2e434d0cfdb9dd468ddbc8a" id="r_acfb1affcb2e434d0cfdb9dd468ddbc8a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112">ykyh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acfb1affcb2e434d0cfdb9dd468ddbc8a">ykyh_delete</a> (<a class="el" href="structykyh__state.html">ykyh_state</a> *<a class="el" href="structstate.html">state</a>, char *<a class="el" href="catch__reporter__console_8cpp.html#a9b45b3e13bd9167aab02e17e08916231">name</a>)</td></tr>
<tr class="separator:acfb1affcb2e434d0cfdb9dd468ddbc8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6e95562757fb174ae74843f2ec6304a" id="r_af6e95562757fb174ae74843f2ec6304a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112">ykyh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af6e95562757fb174ae74843f2ec6304a">ykyh_calculate</a> (<a class="el" href="structykyh__state.html">ykyh_state</a> *<a class="el" href="structstate.html">state</a>, const char *<a class="el" href="catch__reporter__console_8cpp.html#a9b45b3e13bd9167aab02e17e08916231">name</a>, <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *<a class="el" href="structcontext.html">context</a>, size_t context_len, const char *pw, <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *key_s_enc, size_t key_s_enc_len, <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *key_s_mac, size_t key_s_mac_len, <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *key_s_rmac, size_t key_s_rmac_len, <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *retries)</td></tr>
<tr class="separator:af6e95562757fb174ae74843f2ec6304a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94ec07237ae4d03c38751f3d966194e3" id="r_a94ec07237ae4d03c38751f3d966194e3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112">ykyh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a94ec07237ae4d03c38751f3d966194e3">ykyh_reset</a> (<a class="el" href="structykyh__state.html">ykyh_state</a> *<a class="el" href="structstate.html">state</a>)</td></tr>
<tr class="separator:a94ec07237ae4d03c38751f3d966194e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a869199318f736641bf0779c5d2e90866" id="r_a869199318f736641bf0779c5d2e90866"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112">ykyh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a869199318f736641bf0779c5d2e90866">ykyh_list_keys</a> (<a class="el" href="structykyh__state.html">ykyh_state</a> *<a class="el" href="structstate.html">state</a>, <a class="el" href="structykyh__list__entry.html">ykyh_list_entry</a> *list, size_t *list_items)</td></tr>
<tr class="separator:a869199318f736641bf0779c5d2e90866"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55f6b7523751ffb9d6b54f9088f4d90c" id="r_a55f6b7523751ffb9d6b54f9088f4d90c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112">ykyh_rc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a55f6b7523751ffb9d6b54f9088f4d90c">ykyh_get_challenge</a> (<a class="el" href="structykyh__state.html">ykyh_state</a> *<a class="el" href="structstate.html">state</a>)</td></tr>
<tr class="separator:a55f6b7523751ffb9d6b54f9088f4d90c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="af6e95562757fb174ae74843f2ec6304a" name="af6e95562757fb174ae74843f2ec6304a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6e95562757fb174ae74843f2ec6304a">&#9670;&#160;</a></span>ykyh_calculate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112">ykyh_rc</a> ykyh_calculate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structykyh__state.html">ykyh_state</a> *</td>          <td class="paramname"><span class="paramname"><em>state</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>name</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>context</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>context_len</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>pw</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>key_s_enc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>key_s_enc_len</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>key_s_mac</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>key_s_mac_len</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>key_s_rmac</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>key_s_rmac_len</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>retries</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ykyh_8c_source.html#l00403">403</a> of file <a class="el" href="ykyh_8c_source.html">ykyh.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  407</span>                                                                {</div>
<div class="line"><span class="lineno">  408</span>  <a class="code hl_union" href="unionu___a_p_d_u.html">APDU</a> apdu;</div>
<div class="line"><span class="lineno">  409</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *ptr;</div>
<div class="line"><span class="lineno">  410</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> data[64]; <span class="comment">// NOTE(adma): must be &gt;= (YKYH_KEY_LEN * 3) + 2 = 50</span></div>
<div class="line"><span class="lineno">  411</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> recv_len = <span class="keyword">sizeof</span>(data);</div>
<div class="line"><span class="lineno">  412</span>  <span class="keywordtype">int</span> sw;</div>
<div class="line"><span class="lineno">  413</span>  <a class="code hl_enumeration" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112">ykyh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a97917e1d5a9fa5e8b7a4495dc9234ac7">rc</a>;</div>
<div class="line"><span class="lineno">  414</span> </div>
<div class="line"><span class="lineno">  415</span>  <span class="keywordflow">if</span> (<a class="code hl_struct" href="structstate.html">state</a> == NULL || <a class="code hl_variable" href="catch__reporter__console_8cpp.html#a9b45b3e13bd9167aab02e17e08916231">name</a> == NULL || strlen(<a class="code hl_variable" href="catch__reporter__console_8cpp.html#a9b45b3e13bd9167aab02e17e08916231">name</a>) &lt; <a class="code hl_define" href="ykyh_8h.html#ae8331a6f47276895ad08a1cbf3a6a508">YKYH_MIN_NAME_LEN</a> ||</div>
<div class="line"><span class="lineno">  416</span>      strlen(<a class="code hl_variable" href="catch__reporter__console_8cpp.html#a9b45b3e13bd9167aab02e17e08916231">name</a>) &gt; <a class="code hl_define" href="ykyh_8h.html#aba3c1d3e48c3662d8e58a87bc564cc82">YKYH_MAX_NAME_LEN</a> || <a class="code hl_struct" href="structcontext.html">context</a> == NULL ||</div>
<div class="line"><span class="lineno">  417</span>      context_len != <a class="code hl_define" href="ykyh_8h.html#a6bbc44e9048c273ded8a25a0b799b3ee">YKYH_CONTEXT_LEN</a> || pw == NULL ||</div>
<div class="line"><span class="lineno">  418</span>      strlen(pw) != <a class="code hl_define" href="ykyh_8h.html#a00e800150afe4404120c2090461fdf1a">YKYH_PW_LEN</a> || key_s_enc == NULL ||</div>
<div class="line"><span class="lineno">  419</span>      key_s_enc_len != <a class="code hl_define" href="ykyh_8h.html#aa076fd48c09e4acec46eace24ad27a2f">YKYH_KEY_LEN</a> || key_s_mac == NULL ||</div>
<div class="line"><span class="lineno">  420</span>      key_s_mac_len != <a class="code hl_define" href="ykyh_8h.html#aa076fd48c09e4acec46eace24ad27a2f">YKYH_KEY_LEN</a> || key_s_rmac == NULL ||</div>
<div class="line"><span class="lineno">  421</span>      key_s_rmac_len != <a class="code hl_define" href="ykyh_8h.html#aa076fd48c09e4acec46eace24ad27a2f">YKYH_KEY_LEN</a>) {</div>
<div class="line"><span class="lineno">  422</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112a3616b15980deeeb94e24538ede829d84">YKYHR_INVALID_PARAMS</a>;</div>
<div class="line"><span class="lineno">  423</span>  }</div>
<div class="line"><span class="lineno">  424</span> </div>
<div class="line"><span class="lineno">  425</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105">memset</a>(apdu.<a class="code hl_variable" href="unionu___a_p_d_u.html#a864cd8b850ed1d88c60064c17b29fec9">raw</a>, 0, <span class="keyword">sizeof</span>(apdu));</div>
<div class="line"><span class="lineno">  426</span>  apdu.<a class="code hl_variable" href="unionu___a_p_d_u.html#abe564f763a61d62cb4de9b5cff4b2530">st</a>.ins = <a class="code hl_define" href="ykyh_8h.html#a93f62213473fb25da833d39f7f51ec95">YKYH_INS_CALCULATE</a>;</div>
<div class="line"><span class="lineno">  427</span> </div>
<div class="line"><span class="lineno">  428</span>  ptr = apdu.<a class="code hl_variable" href="unionu___a_p_d_u.html#abe564f763a61d62cb4de9b5cff4b2530">st</a>.data;</div>
<div class="line"><span class="lineno">  429</span> </div>
<div class="line"><span class="lineno">  430</span>  *(ptr++) = <a class="code hl_define" href="ykyh_8h.html#a1d9d05d1211e99f0edff27bfa82df0b8">YKYH_TAG_NAME</a>;</div>
<div class="line"><span class="lineno">  431</span>  apdu.<a class="code hl_variable" href="unionu___a_p_d_u.html#abe564f763a61d62cb4de9b5cff4b2530">st</a>.lc++;</div>
<div class="line"><span class="lineno">  432</span>  *(ptr++) = strlen(<a class="code hl_variable" href="catch__reporter__console_8cpp.html#a9b45b3e13bd9167aab02e17e08916231">name</a>);</div>
<div class="line"><span class="lineno">  433</span>  apdu.<a class="code hl_variable" href="unionu___a_p_d_u.html#abe564f763a61d62cb4de9b5cff4b2530">st</a>.lc++;</div>
<div class="line"><span class="lineno">  434</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(ptr, <a class="code hl_variable" href="catch__reporter__console_8cpp.html#a9b45b3e13bd9167aab02e17e08916231">name</a>, strlen(<a class="code hl_variable" href="catch__reporter__console_8cpp.html#a9b45b3e13bd9167aab02e17e08916231">name</a>));</div>
<div class="line"><span class="lineno">  435</span>  ptr += strlen(<a class="code hl_variable" href="catch__reporter__console_8cpp.html#a9b45b3e13bd9167aab02e17e08916231">name</a>);</div>
<div class="line"><span class="lineno">  436</span>  apdu.<a class="code hl_variable" href="unionu___a_p_d_u.html#abe564f763a61d62cb4de9b5cff4b2530">st</a>.lc += strlen(<a class="code hl_variable" href="catch__reporter__console_8cpp.html#a9b45b3e13bd9167aab02e17e08916231">name</a>);</div>
<div class="line"><span class="lineno">  437</span> </div>
<div class="line"><span class="lineno">  438</span>  *(ptr++) = <a class="code hl_define" href="ykyh_8h.html#affd0605d22de3476bb44cae076c1302e">YKYH_TAG_CONTEXT</a>;</div>
<div class="line"><span class="lineno">  439</span>  apdu.<a class="code hl_variable" href="unionu___a_p_d_u.html#abe564f763a61d62cb4de9b5cff4b2530">st</a>.lc++;</div>
<div class="line"><span class="lineno">  440</span>  *(ptr++) = context_len;</div>
<div class="line"><span class="lineno">  441</span>  apdu.<a class="code hl_variable" href="unionu___a_p_d_u.html#abe564f763a61d62cb4de9b5cff4b2530">st</a>.lc++;</div>
<div class="line"><span class="lineno">  442</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(ptr, <a class="code hl_struct" href="structcontext.html">context</a>, context_len);</div>
<div class="line"><span class="lineno">  443</span>  ptr += context_len;</div>
<div class="line"><span class="lineno">  444</span>  apdu.<a class="code hl_variable" href="unionu___a_p_d_u.html#abe564f763a61d62cb4de9b5cff4b2530">st</a>.lc += context_len;</div>
<div class="line"><span class="lineno">  445</span> </div>
<div class="line"><span class="lineno">  446</span>  *(ptr++) = <a class="code hl_define" href="ykyh_8h.html#a2df9aee745a0c8a8cd5d127c72dea523">YKYH_TAG_PW</a>;</div>
<div class="line"><span class="lineno">  447</span>  apdu.<a class="code hl_variable" href="unionu___a_p_d_u.html#abe564f763a61d62cb4de9b5cff4b2530">st</a>.lc++;</div>
<div class="line"><span class="lineno">  448</span>  *(ptr++) = <a class="code hl_define" href="ykyh_8h.html#a00e800150afe4404120c2090461fdf1a">YKYH_PW_LEN</a>;</div>
<div class="line"><span class="lineno">  449</span>  apdu.<a class="code hl_variable" href="unionu___a_p_d_u.html#abe564f763a61d62cb4de9b5cff4b2530">st</a>.lc++;</div>
<div class="line"><span class="lineno">  450</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(ptr, pw, <a class="code hl_define" href="ykyh_8h.html#a00e800150afe4404120c2090461fdf1a">YKYH_PW_LEN</a>);</div>
<div class="line"><span class="lineno">  451</span>  ptr += <a class="code hl_define" href="ykyh_8h.html#a00e800150afe4404120c2090461fdf1a">YKYH_PW_LEN</a>;</div>
<div class="line"><span class="lineno">  452</span>  apdu.<a class="code hl_variable" href="unionu___a_p_d_u.html#abe564f763a61d62cb4de9b5cff4b2530">st</a>.lc += <a class="code hl_define" href="ykyh_8h.html#a00e800150afe4404120c2090461fdf1a">YKYH_PW_LEN</a>;</div>
<div class="line"><span class="lineno">  453</span> </div>
<div class="line"><span class="lineno">  454</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a97917e1d5a9fa5e8b7a4495dc9234ac7">rc</a> = send_data(<a class="code hl_struct" href="structstate.html">state</a>, &amp;apdu, data, &amp;recv_len, &amp;sw);</div>
<div class="line"><span class="lineno">  455</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a97917e1d5a9fa5e8b7a4495dc9234ac7">rc</a> != <a class="code hl_enumvalue" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112a40500f2b4bd15d31f1348475e35f2459">YKYHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno">  456</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a97917e1d5a9fa5e8b7a4495dc9234ac7">rc</a>;</div>
<div class="line"><span class="lineno">  457</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sw != <a class="code hl_define" href="ykyh_8h.html#a3328a41be5837af4761365aafb108025">SW_SUCCESS</a>) {</div>
<div class="line"><span class="lineno">  458</span>    <span class="keywordflow">if</span> (<a class="code hl_struct" href="structstate.html">state</a>-&gt;verbose) {</div>
<div class="line"><span class="lineno">  459</span>      fprintf(stderr, <span class="stringliteral">&quot;Unable to derive keys: %04x\n&quot;</span>, sw);</div>
<div class="line"><span class="lineno">  460</span>    }</div>
<div class="line"><span class="lineno">  461</span>    <span class="keywordflow">if</span> ((sw &amp; 0xfff0) == <a class="code hl_define" href="ykyh_8h.html#a1ab82884b9dfbbb754379f78eeb6ee3f">SW_ERR_AUTHENTICATION_FAILED</a>) {</div>
<div class="line"><span class="lineno">  462</span>      <span class="keywordflow">if</span> (retries != NULL) {</div>
<div class="line"><span class="lineno">  463</span>        *retries = sw &amp; ~SW_ERR_AUTHENTICATION_FAILED;</div>
<div class="line"><span class="lineno">  464</span>      }</div>
<div class="line"><span class="lineno">  465</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112ae58239391b2ac02c8bb353666cdf9ac8">YKYHR_WRONG_PW</a>;</div>
<div class="line"><span class="lineno">  466</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  467</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112acd0e2c78f0a0e431afb2a4ba555f821e">YKYHR_ENTRY_NOT_FOUND</a>;</div>
<div class="line"><span class="lineno">  468</span>    }</div>
<div class="line"><span class="lineno">  469</span>  }</div>
<div class="line"><span class="lineno">  470</span> </div>
<div class="line"><span class="lineno">  471</span>  ptr = data;</div>
<div class="line"><span class="lineno">  472</span> </div>
<div class="line"><span class="lineno">  473</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(key_s_enc, ptr, <a class="code hl_define" href="ykyh_8h.html#aa076fd48c09e4acec46eace24ad27a2f">YKYH_KEY_LEN</a>);</div>
<div class="line"><span class="lineno">  474</span>  ptr += <a class="code hl_define" href="ykyh_8h.html#aa076fd48c09e4acec46eace24ad27a2f">YKYH_KEY_LEN</a>;</div>
<div class="line"><span class="lineno">  475</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(key_s_mac, ptr, <a class="code hl_define" href="ykyh_8h.html#aa076fd48c09e4acec46eace24ad27a2f">YKYH_KEY_LEN</a>);</div>
<div class="line"><span class="lineno">  476</span>  ptr += <a class="code hl_define" href="ykyh_8h.html#aa076fd48c09e4acec46eace24ad27a2f">YKYH_KEY_LEN</a>;</div>
<div class="line"><span class="lineno">  477</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(key_s_rmac, ptr, <a class="code hl_define" href="ykyh_8h.html#aa076fd48c09e4acec46eace24ad27a2f">YKYH_KEY_LEN</a>);</div>
<div class="line"><span class="lineno">  478</span>  ptr += <a class="code hl_define" href="ykyh_8h.html#aa076fd48c09e4acec46eace24ad27a2f">YKYH_KEY_LEN</a>;</div>
<div class="line"><span class="lineno">  479</span> </div>
<div class="line"><span class="lineno">  480</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112a40500f2b4bd15d31f1348475e35f2459">YKYHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno">  481</span>}</div>
<div class="ttc" id="acatch__reporter__console_8cpp_html_a9b45b3e13bd9167aab02e17e08916231"><div class="ttname"><a href="catch__reporter__console_8cpp.html#a9b45b3e13bd9167aab02e17e08916231">name</a></div><div class="ttdeci">std::string name</div><div class="ttdef"><b>Definition</b> <a href="catch__reporter__console_8cpp_source.html#l00186">catch_reporter_console.cpp:186</a></div></div>
<div class="ttc" id="astdint_8h_html_aba7bc1797add20fe3efdf37ced1182c5"><div class="ttname"><a href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a></div><div class="ttdeci">unsigned char uint8_t</div><div class="ttdef"><b>Definition</b> <a href="stdint_8h_source.html#l00124">stdint.h:124</a></div></div>
<div class="ttc" id="astructcontext_html"><div class="ttname"><a href="structcontext.html">context</a></div><div class="ttdef"><b>Definition</b> <a href="yubihsm__winhttp_8c_source.html#l00052">yubihsm_winhttp.c:52</a></div></div>
<div class="ttc" id="astructstate_html"><div class="ttname"><a href="structstate.html">state</a></div><div class="ttdef"><b>Definition</b> <a href="yubihsm__curl_8c_source.html#l00028">yubihsm_curl.c:28</a></div></div>
<div class="ttc" id="aunionu___a_p_d_u_html"><div class="ttname"><a href="unionu___a_p_d_u.html">u_APDU</a></div><div class="ttdef"><b>Definition</b> <a href="ykyh_2internal_8h_source.html#l00040">internal.h:40</a></div></div>
<div class="ttc" id="aunionu___a_p_d_u_html_a864cd8b850ed1d88c60064c17b29fec9"><div class="ttname"><a href="unionu___a_p_d_u.html#a864cd8b850ed1d88c60064c17b29fec9">u_APDU::raw</a></div><div class="ttdeci">unsigned char raw[0xff+5]</div><div class="ttdef"><b>Definition</b> <a href="ykyh_2internal_8h_source.html#l00049">internal.h:49</a></div></div>
<div class="ttc" id="aunionu___a_p_d_u_html_abe564f763a61d62cb4de9b5cff4b2530"><div class="ttname"><a href="unionu___a_p_d_u.html#abe564f763a61d62cb4de9b5cff4b2530">u_APDU::st</a></div><div class="ttdeci">struct u_APDU::@119 st</div></div>
<div class="ttc" id="aykyh_8h_html_a00e800150afe4404120c2090461fdf1a"><div class="ttname"><a href="ykyh_8h.html#a00e800150afe4404120c2090461fdf1a">YKYH_PW_LEN</a></div><div class="ttdeci">#define YKYH_PW_LEN</div><div class="ttdef"><b>Definition</b> <a href="ykyh_8h_source.html#l00067">ykyh.h:67</a></div></div>
<div class="ttc" id="aykyh_8h_html_a1ab82884b9dfbbb754379f78eeb6ee3f"><div class="ttname"><a href="ykyh_8h.html#a1ab82884b9dfbbb754379f78eeb6ee3f">SW_ERR_AUTHENTICATION_FAILED</a></div><div class="ttdeci">#define SW_ERR_AUTHENTICATION_FAILED</div><div class="ttdef"><b>Definition</b> <a href="ykyh_8h_source.html#l00061">ykyh.h:61</a></div></div>
<div class="ttc" id="aykyh_8h_html_a1d9d05d1211e99f0edff27bfa82df0b8"><div class="ttname"><a href="ykyh_8h.html#a1d9d05d1211e99f0edff27bfa82df0b8">YKYH_TAG_NAME</a></div><div class="ttdeci">#define YKYH_TAG_NAME</div><div class="ttdef"><b>Definition</b> <a href="ykyh_8h_source.html#l00045">ykyh.h:45</a></div></div>
<div class="ttc" id="aykyh_8h_html_a2df9aee745a0c8a8cd5d127c72dea523"><div class="ttname"><a href="ykyh_8h.html#a2df9aee745a0c8a8cd5d127c72dea523">YKYH_TAG_PW</a></div><div class="ttdeci">#define YKYH_TAG_PW</div><div class="ttdef"><b>Definition</b> <a href="ykyh_8h_source.html#l00047">ykyh.h:47</a></div></div>
<div class="ttc" id="aykyh_8h_html_a3328a41be5837af4761365aafb108025"><div class="ttname"><a href="ykyh_8h.html#a3328a41be5837af4761365aafb108025">SW_SUCCESS</a></div><div class="ttdeci">#define SW_SUCCESS</div><div class="ttdef"><b>Definition</b> <a href="ykyh_8h_source.html#l00060">ykyh.h:60</a></div></div>
<div class="ttc" id="aykyh_8h_html_a6bbc44e9048c273ded8a25a0b799b3ee"><div class="ttname"><a href="ykyh_8h.html#a6bbc44e9048c273ded8a25a0b799b3ee">YKYH_CONTEXT_LEN</a></div><div class="ttdeci">#define YKYH_CONTEXT_LEN</div><div class="ttdef"><b>Definition</b> <a href="ykyh_8h_source.html#l00068">ykyh.h:68</a></div></div>
<div class="ttc" id="aykyh_8h_html_a93aafaa60a79c75641302448631ea112"><div class="ttname"><a href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112">ykyh_rc</a></div><div class="ttdeci">ykyh_rc</div><div class="ttdef"><b>Definition</b> <a href="ykyh_8h_source.html#l00076">ykyh.h:76</a></div></div>
<div class="ttc" id="aykyh_8h_html_a93aafaa60a79c75641302448631ea112a3616b15980deeeb94e24538ede829d84"><div class="ttname"><a href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112a3616b15980deeeb94e24538ede829d84">YKYHR_INVALID_PARAMS</a></div><div class="ttdeci">@ YKYHR_INVALID_PARAMS</div><div class="ttdef"><b>Definition</b> <a href="ykyh_8h_source.html#l00082">ykyh.h:82</a></div></div>
<div class="ttc" id="aykyh_8h_html_a93aafaa60a79c75641302448631ea112a40500f2b4bd15d31f1348475e35f2459"><div class="ttname"><a href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112a40500f2b4bd15d31f1348475e35f2459">YKYHR_SUCCESS</a></div><div class="ttdeci">@ YKYHR_SUCCESS</div><div class="ttdef"><b>Definition</b> <a href="ykyh_8h_source.html#l00077">ykyh.h:77</a></div></div>
<div class="ttc" id="aykyh_8h_html_a93aafaa60a79c75641302448631ea112acd0e2c78f0a0e431afb2a4ba555f821e"><div class="ttname"><a href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112acd0e2c78f0a0e431afb2a4ba555f821e">YKYHR_ENTRY_NOT_FOUND</a></div><div class="ttdeci">@ YKYHR_ENTRY_NOT_FOUND</div><div class="ttdef"><b>Definition</b> <a href="ykyh_8h_source.html#l00083">ykyh.h:83</a></div></div>
<div class="ttc" id="aykyh_8h_html_a93aafaa60a79c75641302448631ea112ae58239391b2ac02c8bb353666cdf9ac8"><div class="ttname"><a href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112ae58239391b2ac02c8bb353666cdf9ac8">YKYHR_WRONG_PW</a></div><div class="ttdeci">@ YKYHR_WRONG_PW</div><div class="ttdef"><b>Definition</b> <a href="ykyh_8h_source.html#l00081">ykyh.h:81</a></div></div>
<div class="ttc" id="aykyh_8h_html_a93f62213473fb25da833d39f7f51ec95"><div class="ttname"><a href="ykyh_8h.html#a93f62213473fb25da833d39f7f51ec95">YKYH_INS_CALCULATE</a></div><div class="ttdeci">#define YKYH_INS_CALCULATE</div><div class="ttdef"><b>Definition</b> <a href="ykyh_8h_source.html#l00032">ykyh.h:32</a></div></div>
<div class="ttc" id="aykyh_8h_html_aa076fd48c09e4acec46eace24ad27a2f"><div class="ttname"><a href="ykyh_8h.html#aa076fd48c09e4acec46eace24ad27a2f">YKYH_KEY_LEN</a></div><div class="ttdeci">#define YKYH_KEY_LEN</div><div class="ttdef"><b>Definition</b> <a href="ykyh_8h_source.html#l00066">ykyh.h:66</a></div></div>
<div class="ttc" id="aykyh_8h_html_aba3c1d3e48c3662d8e58a87bc564cc82"><div class="ttname"><a href="ykyh_8h.html#aba3c1d3e48c3662d8e58a87bc564cc82">YKYH_MAX_NAME_LEN</a></div><div class="ttdeci">#define YKYH_MAX_NAME_LEN</div><div class="ttdef"><b>Definition</b> <a href="ykyh_8h_source.html#l00065">ykyh.h:65</a></div></div>
<div class="ttc" id="aykyh_8h_html_ae8331a6f47276895ad08a1cbf3a6a508"><div class="ttname"><a href="ykyh_8h.html#ae8331a6f47276895ad08a1cbf3a6a508">YKYH_MIN_NAME_LEN</a></div><div class="ttdeci">#define YKYH_MIN_NAME_LEN</div><div class="ttdef"><b>Definition</b> <a href="ykyh_8h_source.html#l00064">ykyh.h:64</a></div></div>
<div class="ttc" id="aykyh_8h_html_affd0605d22de3476bb44cae076c1302e"><div class="ttname"><a href="ykyh_8h.html#affd0605d22de3476bb44cae076c1302e">YKYH_TAG_CONTEXT</a></div><div class="ttdeci">#define YKYH_TAG_CONTEXT</div><div class="ttdef"><b>Definition</b> <a href="ykyh_8h_source.html#l00051">ykyh.h:51</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a97917e1d5a9fa5e8b7a4495dc9234ac7"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a97917e1d5a9fa5e8b7a4495dc9234ac7">rc</a></div><div class="ttdeci">yh_rc rc</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l01308">yubihsm_pkcs11.c:1308</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_adc4bd59a60361844aa0e852efa210105"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105">memset</a></div><div class="ttdeci">memset(pInfo-&gt;slotDescription, ' ', 64)</div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_ae785d5badbf1f08b491af31f32a135a1"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a></div><div class="ttdeci">memcpy((char *) pInfo-&gt;slotDescription, s, l)</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ykyh_8c_af6e95562757fb174ae74843f2ec6304a_cgraph.png" border="0" usemap="#aykyh_8c_af6e95562757fb174ae74843f2ec6304a_cgraph" alt=""/></div>
<map name="aykyh_8c_af6e95562757fb174ae74843f2ec6304a_cgraph" id="aykyh_8c_af6e95562757fb174ae74843f2ec6304a_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,114,56"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="162,5,233,31"/>
<area shape="poly" title=" " alt="" coords="114,31,146,25,147,30,115,36"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="163,55,232,80"/>
<area shape="poly" title=" " alt="" coords="115,50,148,56,148,62,114,56"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ykyh_8c_af6e95562757fb174ae74843f2ec6304a_icgraph.png" border="0" usemap="#aykyh_8c_af6e95562757fb174ae74843f2ec6304a_icgraph" alt=""/></div>
<map name="aykyh_8c_af6e95562757fb174ae74843f2ec6304a_icgraph" id="aykyh_8c_af6e95562757fb174ae74843f2ec6304a_icgraph">
<area shape="rect" title=" " alt="" coords="498,31,607,56"/>
<area shape="rect" href="commands_8c.html#a22f22a25151b12c7573f80563a341368" title=" " alt="" coords="296,31,450,56"/>
<area shape="poly" title=" " alt="" coords="483,46,451,46,451,41,483,41"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,5,248,31"/>
<area shape="poly" title=" " alt="" coords="280,34,248,30,249,25,281,29"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,31,55,56"/>
<area shape="poly" title=" " alt="" coords="280,46,55,46,55,41,280,41"/>
<area shape="poly" title=" " alt="" coords="88,36,55,42,54,37,87,31"/>
</map>
</div>

</div>
</div>
<a id="a6b53f9d9825a88a6a20352c9734e4a4d" name="a6b53f9d9825a88a6a20352c9734e4a4d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b53f9d9825a88a6a20352c9734e4a4d">&#9670;&#160;</a></span>ykyh_connect()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112">ykyh_rc</a> ykyh_connect </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structykyh__state.html">ykyh_state</a> *</td>          <td class="paramname"><span class="paramname"><em>state</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>wanted</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ykyh_8c_source.html#l00092">92</a> of file <a class="el" href="ykyh_8c_source.html">ykyh.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   92</span>                                                            {</div>
<div class="line"><span class="lineno">   93</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> active_protocol;</div>
<div class="line"><span class="lineno">   94</span>  <span class="keywordtype">char</span> reader_buf[2048];</div>
<div class="line"><span class="lineno">   95</span>  <span class="keywordtype">size_t</span> num_readers = <span class="keyword">sizeof</span>(reader_buf);</div>
<div class="line"><span class="lineno">   96</span>  <span class="keywordtype">long</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a97917e1d5a9fa5e8b7a4495dc9234ac7">rc</a>;</div>
<div class="line"><span class="lineno">   97</span>  <span class="keywordtype">char</span> *reader_ptr;</div>
<div class="line"><span class="lineno">   98</span> </div>
<div class="line"><span class="lineno">   99</span>  <span class="keywordflow">if</span> (<a class="code hl_struct" href="structstate.html">state</a> == NULL) {</div>
<div class="line"><span class="lineno">  100</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112a3616b15980deeeb94e24538ede829d84">YKYHR_INVALID_PARAMS</a>;</div>
<div class="line"><span class="lineno">  101</span>  }</div>
<div class="line"><span class="lineno">  102</span> </div>
<div class="line"><span class="lineno">  103</span>  <a class="code hl_enumeration" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112">ykyh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a3d854b6efad16a16e4d7b4539d4fc71f">ret</a> = <a class="code hl_function" href="#a9a87b4e80e8f980badba176c4b713e13">ykyh_list_readers</a>(<a class="code hl_struct" href="structstate.html">state</a>, reader_buf, &amp;num_readers);</div>
<div class="line"><span class="lineno">  104</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a3d854b6efad16a16e4d7b4539d4fc71f">ret</a> != <a class="code hl_enumvalue" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112a40500f2b4bd15d31f1348475e35f2459">YKYHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno">  105</span>    <span class="keywordflow">if</span> (<a class="code hl_struct" href="structstate.html">state</a>-&gt;verbose) {</div>
<div class="line"><span class="lineno">  106</span>      fprintf(stderr, <span class="stringliteral">&quot;Unable to list_readers: %s&quot;</span>, <a class="code hl_function" href="ykyh_2error_8c.html#a4544a3e0741c078e01233bb1ab541805">ykyh_strerror</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a3d854b6efad16a16e4d7b4539d4fc71f">ret</a>));</div>
<div class="line"><span class="lineno">  107</span>    }</div>
<div class="line"><span class="lineno">  108</span> </div>
<div class="line"><span class="lineno">  109</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a3d854b6efad16a16e4d7b4539d4fc71f">ret</a>;</div>
<div class="line"><span class="lineno">  110</span>  }</div>
<div class="line"><span class="lineno">  111</span> </div>
<div class="line"><span class="lineno">  112</span>  <span class="keywordflow">for</span> (reader_ptr = reader_buf; *reader_ptr != <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno">  113</span>       reader_ptr += strlen(reader_ptr) + 1) {</div>
<div class="line"><span class="lineno">  114</span>    <span class="keywordflow">if</span> (wanted) {</div>
<div class="line"><span class="lineno">  115</span>      <span class="keywordflow">if</span> (!strstr(reader_ptr, wanted)) {</div>
<div class="line"><span class="lineno">  116</span>        <span class="keywordflow">if</span> (<a class="code hl_struct" href="structstate.html">state</a>-&gt;verbose) {</div>
<div class="line"><span class="lineno">  117</span>          fprintf(stderr, <span class="stringliteral">&quot;skipping reader &#39;%s&#39; since it doesn&#39;t match &#39;%s&#39;\n&quot;</span>,</div>
<div class="line"><span class="lineno">  118</span>                  reader_ptr, wanted);</div>
<div class="line"><span class="lineno">  119</span>        }</div>
<div class="line"><span class="lineno">  120</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  121</span>      }</div>
<div class="line"><span class="lineno">  122</span>    }</div>
<div class="line"><span class="lineno">  123</span> </div>
<div class="line"><span class="lineno">  124</span>    <span class="keywordflow">if</span> (<a class="code hl_struct" href="structstate.html">state</a>-&gt;verbose) {</div>
<div class="line"><span class="lineno">  125</span>      fprintf(stderr, <span class="stringliteral">&quot;trying to connect to reader &#39;%s&#39;\n&quot;</span>, reader_ptr);</div>
<div class="line"><span class="lineno">  126</span>    }</div>
<div class="line"><span class="lineno">  127</span> </div>
<div class="line"><span class="lineno">  128</span>    <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a97917e1d5a9fa5e8b7a4495dc9234ac7">rc</a> =</div>
<div class="line"><span class="lineno">  129</span>      SCardConnect(<a class="code hl_struct" href="structstate.html">state</a>-&gt;<a class="code hl_variable" href="structstate.html#a8d9e24fc2a15a8ea6b841006d9c1ec17">context</a>, reader_ptr, SCARD_SHARE_SHARED,</div>
<div class="line"><span class="lineno">  130</span>                   SCARD_PROTOCOL_T1, &amp;<a class="code hl_struct" href="structstate.html">state</a>-&gt;card, (LPDWORD) &amp;active_protocol);</div>
<div class="line"><span class="lineno">  131</span> </div>
<div class="line"><span class="lineno">  132</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a97917e1d5a9fa5e8b7a4495dc9234ac7">rc</a> != SCARD_S_SUCCESS) {</div>
<div class="line"><span class="lineno">  133</span>      <span class="keywordflow">if</span> (<a class="code hl_struct" href="structstate.html">state</a>-&gt;verbose) {</div>
<div class="line"><span class="lineno">  134</span>        fprintf(stderr, <span class="stringliteral">&quot;SCardConnect failed, rc=%08lx\n&quot;</span>, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a97917e1d5a9fa5e8b7a4495dc9234ac7">rc</a>);</div>
<div class="line"><span class="lineno">  135</span>      }</div>
<div class="line"><span class="lineno">  136</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  137</span>    }</div>
<div class="line"><span class="lineno">  138</span> </div>
<div class="line"><span class="lineno">  139</span>    <a class="code hl_union" href="unionu___a_p_d_u.html">APDU</a> apdu;</div>
<div class="line"><span class="lineno">  140</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> data[0xff];</div>
<div class="line"><span class="lineno">  141</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> recv_len = <span class="keyword">sizeof</span>(data);</div>
<div class="line"><span class="lineno">  142</span>    <span class="keywordtype">int</span> sw;</div>
<div class="line"><span class="lineno">  143</span>    <a class="code hl_enumeration" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112">ykyh_rc</a> res;</div>
<div class="line"><span class="lineno">  144</span> </div>
<div class="line"><span class="lineno">  145</span>    <a class="code hl_function" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105">memset</a>(apdu.<a class="code hl_variable" href="unionu___a_p_d_u.html#a864cd8b850ed1d88c60064c17b29fec9">raw</a>, 0, <span class="keyword">sizeof</span>(apdu));</div>
<div class="line"><span class="lineno">  146</span>    apdu.<a class="code hl_variable" href="unionu___a_p_d_u.html#abe564f763a61d62cb4de9b5cff4b2530">st</a>.ins = 0xa4;</div>
<div class="line"><span class="lineno">  147</span>    apdu.<a class="code hl_variable" href="unionu___a_p_d_u.html#abe564f763a61d62cb4de9b5cff4b2530">st</a>.p1 = 0x04;</div>
<div class="line"><span class="lineno">  148</span>    apdu.<a class="code hl_variable" href="unionu___a_p_d_u.html#abe564f763a61d62cb4de9b5cff4b2530">st</a>.lc = <span class="keyword">sizeof</span>(<a class="code hl_variable" href="ykyh_2internal_8h.html#ae9c5490e642a06846009f761174e7ca1">aid</a>);</div>
<div class="line"><span class="lineno">  149</span>    <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(apdu.<a class="code hl_variable" href="unionu___a_p_d_u.html#abe564f763a61d62cb4de9b5cff4b2530">st</a>.data, <a class="code hl_variable" href="ykyh_2internal_8h.html#ae9c5490e642a06846009f761174e7ca1">aid</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="ykyh_2internal_8h.html#ae9c5490e642a06846009f761174e7ca1">aid</a>));</div>
<div class="line"><span class="lineno">  150</span> </div>
<div class="line"><span class="lineno">  151</span>    <span class="keywordflow">if</span> ((res = send_data(<a class="code hl_struct" href="structstate.html">state</a>, &amp;apdu, data, &amp;recv_len, &amp;sw)) !=</div>
<div class="line"><span class="lineno">  152</span>        <a class="code hl_enumvalue" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112a40500f2b4bd15d31f1348475e35f2459">YKYHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno">  153</span>      <span class="keywordflow">if</span> (<a class="code hl_struct" href="structstate.html">state</a>-&gt;verbose) {</div>
<div class="line"><span class="lineno">  154</span>        fprintf(stderr, <span class="stringliteral">&quot;Failed communicating with card: &#39;%s&#39;\n&quot;</span>,</div>
<div class="line"><span class="lineno">  155</span>                <a class="code hl_function" href="ykyh_2error_8c.html#a4544a3e0741c078e01233bb1ab541805">ykyh_strerror</a>(res));</div>
<div class="line"><span class="lineno">  156</span>      }</div>
<div class="line"><span class="lineno">  157</span> </div>
<div class="line"><span class="lineno">  158</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  159</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sw == <a class="code hl_define" href="ykyh_8h.html#a3328a41be5837af4761365aafb108025">SW_SUCCESS</a>) {</div>
<div class="line"><span class="lineno">  160</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112a40500f2b4bd15d31f1348475e35f2459">YKYHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno">  161</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  162</span>      <span class="keywordflow">if</span> (<a class="code hl_struct" href="structstate.html">state</a>-&gt;verbose) {</div>
<div class="line"><span class="lineno">  163</span>        fprintf(stderr, <span class="stringliteral">&quot;Failed selecting application: %04x\n&quot;</span>, sw);</div>
<div class="line"><span class="lineno">  164</span>      }</div>
<div class="line"><span class="lineno">  165</span>    }</div>
<div class="line"><span class="lineno">  166</span>  }</div>
<div class="line"><span class="lineno">  167</span> </div>
<div class="line"><span class="lineno">  168</span>  <span class="keywordflow">if</span> (*reader_ptr == <span class="charliteral">&#39;\0&#39;</span>) {</div>
<div class="line"><span class="lineno">  169</span>    <span class="keywordflow">if</span> (<a class="code hl_struct" href="structstate.html">state</a>-&gt;verbose) {</div>
<div class="line"><span class="lineno">  170</span>      fprintf(stderr, <span class="stringliteral">&quot;error: no usable reader found\n&quot;</span>);</div>
<div class="line"><span class="lineno">  171</span>    }</div>
<div class="line"><span class="lineno">  172</span>    SCardReleaseContext(<a class="code hl_struct" href="structstate.html">state</a>-&gt;<a class="code hl_variable" href="structstate.html#a8d9e24fc2a15a8ea6b841006d9c1ec17">context</a>);</div>
<div class="line"><span class="lineno">  173</span>    <a class="code hl_struct" href="structstate.html">state</a>-&gt;<a class="code hl_variable" href="structstate.html#a8d9e24fc2a15a8ea6b841006d9c1ec17">context</a> = SCARD_E_INVALID_HANDLE;</div>
<div class="line"><span class="lineno">  174</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112aa66bb77f3c39144ec56d01e741a6d0b5">YKYHR_PCSC_ERROR</a>;</div>
<div class="line"><span class="lineno">  175</span>  }</div>
<div class="line"><span class="lineno">  176</span> </div>
<div class="line"><span class="lineno">  177</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112a3d10dec4a5d83d4227ea94c06efed2a3">YKYHR_GENERIC_ERROR</a>;</div>
<div class="line"><span class="lineno">  178</span>}</div>
<div class="ttc" id="astructstate_html_a8d9e24fc2a15a8ea6b841006d9c1ec17"><div class="ttname"><a href="structstate.html#a8d9e24fc2a15a8ea6b841006d9c1ec17">state::context</a></div><div class="ttdeci">struct context * context</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__winhttp_8c_source.html#l00063">yubihsm_winhttp.c:63</a></div></div>
<div class="ttc" id="aykyh_2error_8c_html_a4544a3e0741c078e01233bb1ab541805"><div class="ttname"><a href="ykyh_2error_8c.html#a4544a3e0741c078e01233bb1ab541805">ykyh_strerror</a></div><div class="ttdeci">const char * ykyh_strerror(ykyh_rc err)</div><div class="ttdef"><b>Definition</b> <a href="ykyh_2error_8c_source.html#l00040">error.c:40</a></div></div>
<div class="ttc" id="aykyh_2internal_8h_html_ae9c5490e642a06846009f761174e7ca1"><div class="ttname"><a href="ykyh_2internal_8h.html#ae9c5490e642a06846009f761174e7ca1">aid</a></div><div class="ttdeci">unsigned const char aid[]</div><div class="ttdef"><b>Definition</b> <a href="ykyh_2internal_8h_source.html#l00054">internal.h:54</a></div></div>
<div class="ttc" id="aykyh_8c_html_a9a87b4e80e8f980badba176c4b713e13"><div class="ttname"><a href="#a9a87b4e80e8f980badba176c4b713e13">ykyh_list_readers</a></div><div class="ttdeci">ykyh_rc ykyh_list_readers(ykyh_state *state, char *readers, size_t *len)</div><div class="ttdef"><b>Definition</b> <a href="ykyh_8c_source.html#l00180">ykyh.c:180</a></div></div>
<div class="ttc" id="aykyh_8h_html_a93aafaa60a79c75641302448631ea112a3d10dec4a5d83d4227ea94c06efed2a3"><div class="ttname"><a href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112a3d10dec4a5d83d4227ea94c06efed2a3">YKYHR_GENERIC_ERROR</a></div><div class="ttdeci">@ YKYHR_GENERIC_ERROR</div><div class="ttdef"><b>Definition</b> <a href="ykyh_8h_source.html#l00080">ykyh.h:80</a></div></div>
<div class="ttc" id="aykyh_8h_html_a93aafaa60a79c75641302448631ea112aa66bb77f3c39144ec56d01e741a6d0b5"><div class="ttname"><a href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112aa66bb77f3c39144ec56d01e741a6d0b5">YKYHR_PCSC_ERROR</a></div><div class="ttdeci">@ YKYHR_PCSC_ERROR</div><div class="ttdef"><b>Definition</b> <a href="ykyh_8h_source.html#l00079">ykyh.h:79</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a3d854b6efad16a16e4d7b4539d4fc71f"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a3d854b6efad16a16e4d7b4539d4fc71f">ret</a></div><div class="ttdeci">CK_RV ret</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l00973">yubihsm_pkcs11.c:973</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ykyh_8c_a6b53f9d9825a88a6a20352c9734e4a4d_cgraph.png" border="0" usemap="#aykyh_8c_a6b53f9d9825a88a6a20352c9734e4a4d_cgraph" alt=""/></div>
<map name="aykyh_8c_a6b53f9d9825a88a6a20352c9734e4a4d_cgraph" id="aykyh_8c_a6b53f9d9825a88a6a20352c9734e4a4d_cgraph">
<area shape="rect" title=" " alt="" coords="5,80,108,106"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="182,5,253,31"/>
<area shape="poly" title=" " alt="" coords="81,77,155,40,166,35,168,40,157,45,83,82"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="183,55,252,80"/>
<area shape="poly" title=" " alt="" coords="108,82,167,73,168,78,109,87"/>
<area shape="rect" href="ykyh_8c.html#a9a87b4e80e8f980badba176c4b713e13" title=" " alt="" coords="156,104,279,130"/>
<area shape="poly" title=" " alt="" coords="109,98,141,103,140,108,108,103"/>
<area shape="rect" href="ykyh_2error_8c.html#a4544a3e0741c078e01233bb1ab541805" title=" " alt="" coords="169,153,266,179"/>
<area shape="poly" title=" " alt="" coords="84,104,157,140,168,144,165,149,155,145,82,109"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ykyh_8c_a6b53f9d9825a88a6a20352c9734e4a4d_icgraph.png" border="0" usemap="#aykyh_8c_a6b53f9d9825a88a6a20352c9734e4a4d_icgraph" alt=""/></div>
<map name="aykyh_8c_a6b53f9d9825a88a6a20352c9734e4a4d_icgraph" id="aykyh_8c_a6b53f9d9825a88a6a20352c9734e4a4d_icgraph">
<area shape="rect" title=" " alt="" coords="498,31,601,56"/>
<area shape="rect" href="yhauth_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="348,5,398,31"/>
<area shape="poly" title=" " alt="" coords="482,37,398,24,399,19,483,31"/>
<area shape="rect" href="commands_8c.html#a22f22a25151b12c7573f80563a341368" title=" " alt="" coords="296,55,450,80"/>
<area shape="poly" title=" " alt="" coords="483,55,451,60,450,54,482,50"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,29,248,55"/>
<area shape="poly" title=" " alt="" coords="280,58,248,54,249,49,281,53"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,55,55,80"/>
<area shape="poly" title=" " alt="" coords="280,70,55,70,55,65,280,65"/>
<area shape="poly" title=" " alt="" coords="88,60,55,66,54,61,87,55"/>
</map>
</div>

</div>
</div>
<a id="acfb1affcb2e434d0cfdb9dd468ddbc8a" name="acfb1affcb2e434d0cfdb9dd468ddbc8a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acfb1affcb2e434d0cfdb9dd468ddbc8a">&#9670;&#160;</a></span>ykyh_delete()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112">ykyh_rc</a> ykyh_delete </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structykyh__state.html">ykyh_state</a> *</td>          <td class="paramname"><span class="paramname"><em>state</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *</td>          <td class="paramname"><span class="paramname"><em>name</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ykyh_8c_source.html#l00364">364</a> of file <a class="el" href="ykyh_8c_source.html">ykyh.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  364</span>                                                   {</div>
<div class="line"><span class="lineno">  365</span>  <a class="code hl_union" href="unionu___a_p_d_u.html">APDU</a> apdu;</div>
<div class="line"><span class="lineno">  366</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *ptr;</div>
<div class="line"><span class="lineno">  367</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> data[64];</div>
<div class="line"><span class="lineno">  368</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> recv_len = <span class="keyword">sizeof</span>(data);</div>
<div class="line"><span class="lineno">  369</span>  <span class="keywordtype">int</span> sw;</div>
<div class="line"><span class="lineno">  370</span>  <a class="code hl_enumeration" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112">ykyh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a97917e1d5a9fa5e8b7a4495dc9234ac7">rc</a>;</div>
<div class="line"><span class="lineno">  371</span> </div>
<div class="line"><span class="lineno">  372</span>  <span class="keywordflow">if</span> (<a class="code hl_struct" href="structstate.html">state</a> == NULL || <a class="code hl_variable" href="catch__reporter__console_8cpp.html#a9b45b3e13bd9167aab02e17e08916231">name</a> == NULL || strlen(<a class="code hl_variable" href="catch__reporter__console_8cpp.html#a9b45b3e13bd9167aab02e17e08916231">name</a>) &lt; <a class="code hl_define" href="ykyh_8h.html#ae8331a6f47276895ad08a1cbf3a6a508">YKYH_MIN_NAME_LEN</a> ||</div>
<div class="line"><span class="lineno">  373</span>      strlen(<a class="code hl_variable" href="catch__reporter__console_8cpp.html#a9b45b3e13bd9167aab02e17e08916231">name</a>) &gt; <a class="code hl_define" href="ykyh_8h.html#aba3c1d3e48c3662d8e58a87bc564cc82">YKYH_MAX_NAME_LEN</a>) {</div>
<div class="line"><span class="lineno">  374</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112a3616b15980deeeb94e24538ede829d84">YKYHR_INVALID_PARAMS</a>;</div>
<div class="line"><span class="lineno">  375</span>  }</div>
<div class="line"><span class="lineno">  376</span> </div>
<div class="line"><span class="lineno">  377</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105">memset</a>(apdu.<a class="code hl_variable" href="unionu___a_p_d_u.html#a864cd8b850ed1d88c60064c17b29fec9">raw</a>, 0, <span class="keyword">sizeof</span>(apdu));</div>
<div class="line"><span class="lineno">  378</span>  apdu.<a class="code hl_variable" href="unionu___a_p_d_u.html#abe564f763a61d62cb4de9b5cff4b2530">st</a>.ins = <a class="code hl_define" href="ykyh_8h.html#ae302e62b3add4c602ac23216dcec4d46">YKYH_INS_DELETE</a>;</div>
<div class="line"><span class="lineno">  379</span> </div>
<div class="line"><span class="lineno">  380</span>  ptr = apdu.<a class="code hl_variable" href="unionu___a_p_d_u.html#abe564f763a61d62cb4de9b5cff4b2530">st</a>.data;</div>
<div class="line"><span class="lineno">  381</span> </div>
<div class="line"><span class="lineno">  382</span>  *(ptr++) = <a class="code hl_define" href="ykyh_8h.html#a1d9d05d1211e99f0edff27bfa82df0b8">YKYH_TAG_NAME</a>;</div>
<div class="line"><span class="lineno">  383</span>  apdu.<a class="code hl_variable" href="unionu___a_p_d_u.html#abe564f763a61d62cb4de9b5cff4b2530">st</a>.lc++;</div>
<div class="line"><span class="lineno">  384</span>  *(ptr++) = strlen(<a class="code hl_variable" href="catch__reporter__console_8cpp.html#a9b45b3e13bd9167aab02e17e08916231">name</a>);</div>
<div class="line"><span class="lineno">  385</span>  apdu.<a class="code hl_variable" href="unionu___a_p_d_u.html#abe564f763a61d62cb4de9b5cff4b2530">st</a>.lc++;</div>
<div class="line"><span class="lineno">  386</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(ptr, <a class="code hl_variable" href="catch__reporter__console_8cpp.html#a9b45b3e13bd9167aab02e17e08916231">name</a>, strlen(<a class="code hl_variable" href="catch__reporter__console_8cpp.html#a9b45b3e13bd9167aab02e17e08916231">name</a>));</div>
<div class="line"><span class="lineno">  387</span>  ptr += strlen(<a class="code hl_variable" href="catch__reporter__console_8cpp.html#a9b45b3e13bd9167aab02e17e08916231">name</a>);</div>
<div class="line"><span class="lineno">  388</span>  apdu.<a class="code hl_variable" href="unionu___a_p_d_u.html#abe564f763a61d62cb4de9b5cff4b2530">st</a>.lc += strlen(<a class="code hl_variable" href="catch__reporter__console_8cpp.html#a9b45b3e13bd9167aab02e17e08916231">name</a>);</div>
<div class="line"><span class="lineno">  389</span> </div>
<div class="line"><span class="lineno">  390</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a97917e1d5a9fa5e8b7a4495dc9234ac7">rc</a> = send_data(<a class="code hl_struct" href="structstate.html">state</a>, &amp;apdu, data, &amp;recv_len, &amp;sw);</div>
<div class="line"><span class="lineno">  391</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a97917e1d5a9fa5e8b7a4495dc9234ac7">rc</a> != <a class="code hl_enumvalue" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112a40500f2b4bd15d31f1348475e35f2459">YKYHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno">  392</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a97917e1d5a9fa5e8b7a4495dc9234ac7">rc</a>;</div>
<div class="line"><span class="lineno">  393</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sw != <a class="code hl_define" href="ykyh_8h.html#a3328a41be5837af4761365aafb108025">SW_SUCCESS</a>) {</div>
<div class="line"><span class="lineno">  394</span>    <span class="keywordflow">if</span> (<a class="code hl_struct" href="structstate.html">state</a>-&gt;verbose) {</div>
<div class="line"><span class="lineno">  395</span>      fprintf(stderr, <span class="stringliteral">&quot;Unable to delete key: %04x\n&quot;</span>, sw);</div>
<div class="line"><span class="lineno">  396</span>    }</div>
<div class="line"><span class="lineno">  397</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112a3d10dec4a5d83d4227ea94c06efed2a3">YKYHR_GENERIC_ERROR</a>;</div>
<div class="line"><span class="lineno">  398</span>  }</div>
<div class="line"><span class="lineno">  399</span> </div>
<div class="line"><span class="lineno">  400</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112a40500f2b4bd15d31f1348475e35f2459">YKYHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno">  401</span>}</div>
<div class="ttc" id="aykyh_8h_html_ae302e62b3add4c602ac23216dcec4d46"><div class="ttname"><a href="ykyh_8h.html#ae302e62b3add4c602ac23216dcec4d46">YKYH_INS_DELETE</a></div><div class="ttdeci">#define YKYH_INS_DELETE</div><div class="ttdef"><b>Definition</b> <a href="ykyh_8h_source.html#l00031">ykyh.h:31</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ykyh_8c_acfb1affcb2e434d0cfdb9dd468ddbc8a_cgraph.png" border="0" usemap="#aykyh_8c_acfb1affcb2e434d0cfdb9dd468ddbc8a_cgraph" alt=""/></div>
<map name="aykyh_8c_acfb1affcb2e434d0cfdb9dd468ddbc8a_cgraph" id="aykyh_8c_acfb1affcb2e434d0cfdb9dd468ddbc8a_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,97,56"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="145,5,216,31"/>
<area shape="poly" title=" " alt="" coords="96,32,129,25,130,31,98,37"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="146,55,214,80"/>
<area shape="poly" title=" " alt="" coords="97,49,132,56,131,61,96,55"/>
</map>
</div>

</div>
</div>
<a id="af8e0c6bd9abb1282586aa040b8c03d45" name="af8e0c6bd9abb1282586aa040b8c03d45"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af8e0c6bd9abb1282586aa040b8c03d45">&#9670;&#160;</a></span>ykyh_disconnect()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112">ykyh_rc</a> ykyh_disconnect </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structykyh__state.html">ykyh_state</a> *</td>          <td class="paramname"><span class="paramname"><em>state</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ykyh_8c_source.html#l00074">74</a> of file <a class="el" href="ykyh_8c_source.html">ykyh.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   74</span>                                           {</div>
<div class="line"><span class="lineno">   75</span>  <span class="keywordflow">if</span> (<a class="code hl_struct" href="structstate.html">state</a> == NULL) {</div>
<div class="line"><span class="lineno">   76</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112a3616b15980deeeb94e24538ede829d84">YKYHR_INVALID_PARAMS</a>;</div>
<div class="line"><span class="lineno">   77</span>  }</div>
<div class="line"><span class="lineno">   78</span> </div>
<div class="line"><span class="lineno">   79</span>  <span class="keywordflow">if</span> (<a class="code hl_struct" href="structstate.html">state</a>-&gt;card) {</div>
<div class="line"><span class="lineno">   80</span>    SCardDisconnect(<a class="code hl_struct" href="structstate.html">state</a>-&gt;card, SCARD_RESET_CARD);</div>
<div class="line"><span class="lineno">   81</span>    <a class="code hl_struct" href="structstate.html">state</a>-&gt;card = 0;</div>
<div class="line"><span class="lineno">   82</span>  }</div>
<div class="line"><span class="lineno">   83</span> </div>
<div class="line"><span class="lineno">   84</span>  <span class="keywordflow">if</span> (SCardIsValidContext(<a class="code hl_struct" href="structstate.html">state</a>-&gt;<a class="code hl_variable" href="structstate.html#a8d9e24fc2a15a8ea6b841006d9c1ec17">context</a>) == SCARD_S_SUCCESS) {</div>
<div class="line"><span class="lineno">   85</span>    SCardReleaseContext(<a class="code hl_struct" href="structstate.html">state</a>-&gt;<a class="code hl_variable" href="structstate.html#a8d9e24fc2a15a8ea6b841006d9c1ec17">context</a>);</div>
<div class="line"><span class="lineno">   86</span>    <a class="code hl_struct" href="structstate.html">state</a>-&gt;<a class="code hl_variable" href="structstate.html#a8d9e24fc2a15a8ea6b841006d9c1ec17">context</a> = SCARD_E_INVALID_HANDLE;</div>
<div class="line"><span class="lineno">   87</span>  }</div>
<div class="line"><span class="lineno">   88</span> </div>
<div class="line"><span class="lineno">   89</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112a40500f2b4bd15d31f1348475e35f2459">YKYHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno">   90</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ykyh_8c_af8e0c6bd9abb1282586aa040b8c03d45_icgraph.png" border="0" usemap="#aykyh_8c_af8e0c6bd9abb1282586aa040b8c03d45_icgraph" alt=""/></div>
<map name="aykyh_8c_af8e0c6bd9abb1282586aa040b8c03d45_icgraph" id="aykyh_8c_af8e0c6bd9abb1282586aa040b8c03d45_icgraph">
<area shape="rect" title=" " alt="" coords="235,5,354,31"/>
<area shape="rect" href="ykyh_8c.html#a6833a1e74b0e7494cc904dc94cf276c0" title=" " alt="" coords="103,5,187,31"/>
<area shape="poly" title=" " alt="" coords="220,21,187,21,187,16,220,16"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,55,31"/>
<area shape="poly" title=" " alt="" coords="87,21,55,21,55,16,87,16"/>
</map>
</div>

</div>
</div>
<a id="a6833a1e74b0e7494cc904dc94cf276c0" name="a6833a1e74b0e7494cc904dc94cf276c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6833a1e74b0e7494cc904dc94cf276c0">&#9670;&#160;</a></span>ykyh_done()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112">ykyh_rc</a> ykyh_done </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structykyh__state.html">ykyh_state</a> *</td>          <td class="paramname"><span class="paramname"><em>state</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ykyh_8c_source.html#l00064">64</a> of file <a class="el" href="ykyh_8c_source.html">ykyh.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   64</span>                                     {</div>
<div class="line"><span class="lineno">   65</span>  <a class="code hl_function" href="#af8e0c6bd9abb1282586aa040b8c03d45">ykyh_disconnect</a>(<a class="code hl_struct" href="structstate.html">state</a>);</div>
<div class="line"><span class="lineno">   66</span> </div>
<div class="line"><span class="lineno">   67</span>  <span class="keywordflow">if</span> (<a class="code hl_struct" href="structstate.html">state</a> != NULL) {</div>
<div class="line"><span class="lineno">   68</span>    free(<a class="code hl_struct" href="structstate.html">state</a>);</div>
<div class="line"><span class="lineno">   69</span>  }</div>
<div class="line"><span class="lineno">   70</span> </div>
<div class="line"><span class="lineno">   71</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112a40500f2b4bd15d31f1348475e35f2459">YKYHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno">   72</span>}</div>
<div class="ttc" id="aykyh_8c_html_af8e0c6bd9abb1282586aa040b8c03d45"><div class="ttname"><a href="#af8e0c6bd9abb1282586aa040b8c03d45">ykyh_disconnect</a></div><div class="ttdeci">ykyh_rc ykyh_disconnect(ykyh_state *state)</div><div class="ttdef"><b>Definition</b> <a href="ykyh_8c_source.html#l00074">ykyh.c:74</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ykyh_8c_a6833a1e74b0e7494cc904dc94cf276c0_cgraph.png" border="0" usemap="#aykyh_8c_a6833a1e74b0e7494cc904dc94cf276c0_cgraph" alt=""/></div>
<map name="aykyh_8c_a6833a1e74b0e7494cc904dc94cf276c0_cgraph" id="aykyh_8c_a6833a1e74b0e7494cc904dc94cf276c0_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,90,31"/>
<area shape="rect" href="ykyh_8c.html#af8e0c6bd9abb1282586aa040b8c03d45" title=" " alt="" coords="138,5,257,31"/>
<area shape="poly" title=" " alt="" coords="90,16,122,16,122,21,90,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ykyh_8c_a6833a1e74b0e7494cc904dc94cf276c0_icgraph.png" border="0" usemap="#aykyh_8c_a6833a1e74b0e7494cc904dc94cf276c0_icgraph" alt=""/></div>
<map name="aykyh_8c_a6833a1e74b0e7494cc904dc94cf276c0_icgraph" id="aykyh_8c_a6833a1e74b0e7494cc904dc94cf276c0_icgraph">
<area shape="rect" title=" " alt="" coords="103,5,187,31"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,55,31"/>
<area shape="poly" title=" " alt="" coords="87,21,55,21,55,16,87,16"/>
</map>
</div>

</div>
</div>
<a id="a55f6b7523751ffb9d6b54f9088f4d90c" name="a55f6b7523751ffb9d6b54f9088f4d90c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55f6b7523751ffb9d6b54f9088f4d90c">&#9670;&#160;</a></span>ykyh_get_challenge()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112">ykyh_rc</a> ykyh_get_challenge </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structykyh__state.html">ykyh_state</a> *</td>          <td class="paramname"><span class="paramname"><em>state</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ykyh_8c_source.html#l00566">566</a> of file <a class="el" href="ykyh_8c_source.html">ykyh.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  566</span>                                              {</div>
<div class="line"><span class="lineno">  567</span> </div>
<div class="line"><span class="lineno">  568</span>  (void) <a class="code hl_struct" href="structstate.html">state</a>;</div>
<div class="line"><span class="lineno">  569</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112a40500f2b4bd15d31f1348475e35f2459">YKYHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno">  570</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a14f49c7ef8ee9ac66936346e7f21d6ce" name="a14f49c7ef8ee9ac66936346e7f21d6ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14f49c7ef8ee9ac66936346e7f21d6ce">&#9670;&#160;</a></span>ykyh_get_version()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112">ykyh_rc</a> ykyh_get_version </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structykyh__state.html">ykyh_state</a> *</td>          <td class="paramname"><span class="paramname"><em>state</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *</td>          <td class="paramname"><span class="paramname"><em>version</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>len</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ykyh_8c_source.html#l00260">260</a> of file <a class="el" href="ykyh_8c_source.html">ykyh.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  260</span>                                                                       {</div>
<div class="line"><span class="lineno">  261</span>  <a class="code hl_union" href="unionu___a_p_d_u.html">APDU</a> apdu;</div>
<div class="line"><span class="lineno">  262</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> data[261];</div>
<div class="line"><span class="lineno">  263</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> recv_len = <span class="keyword">sizeof</span>(data);</div>
<div class="line"><span class="lineno">  264</span>  <span class="keywordtype">int</span> sw;</div>
<div class="line"><span class="lineno">  265</span>  <a class="code hl_enumeration" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112">ykyh_rc</a> res;</div>
<div class="line"><span class="lineno">  266</span> </div>
<div class="line"><span class="lineno">  267</span>  <span class="keywordflow">if</span> (<a class="code hl_struct" href="structstate.html">state</a> == NULL || version == NULL) {</div>
<div class="line"><span class="lineno">  268</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112a3616b15980deeeb94e24538ede829d84">YKYHR_INVALID_PARAMS</a>;</div>
<div class="line"><span class="lineno">  269</span>  }</div>
<div class="line"><span class="lineno">  270</span> </div>
<div class="line"><span class="lineno">  271</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105">memset</a>(apdu.<a class="code hl_variable" href="unionu___a_p_d_u.html#a864cd8b850ed1d88c60064c17b29fec9">raw</a>, 0, <span class="keyword">sizeof</span>(apdu));</div>
<div class="line"><span class="lineno">  272</span>  apdu.<a class="code hl_variable" href="unionu___a_p_d_u.html#abe564f763a61d62cb4de9b5cff4b2530">st</a>.ins = <a class="code hl_define" href="ykyh_8h.html#a824ea775a85955b88cda9593b54b32a9">YKYH_INS_GET_VERSION</a>;</div>
<div class="line"><span class="lineno">  273</span>  <span class="keywordflow">if</span> ((res = send_data(<a class="code hl_struct" href="structstate.html">state</a>, &amp;apdu, data, &amp;recv_len, &amp;sw)) != <a class="code hl_enumvalue" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112a40500f2b4bd15d31f1348475e35f2459">YKYHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno">  274</span>    <span class="keywordflow">return</span> res;</div>
<div class="line"><span class="lineno">  275</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sw == <a class="code hl_define" href="ykyh_8h.html#a3328a41be5837af4761365aafb108025">SW_SUCCESS</a>) {</div>
<div class="line"><span class="lineno">  276</span>    <span class="keywordtype">int</span> result = snprintf(version, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>, <span class="stringliteral">&quot;%d.%d.%d&quot;</span>, data[0], data[1], data[2]);</div>
<div class="line"><span class="lineno">  277</span>    <span class="keywordflow">if</span> (result &lt; 0) {</div>
<div class="line"><span class="lineno">  278</span>      <span class="keywordflow">if</span> (<a class="code hl_struct" href="structstate.html">state</a>-&gt;verbose) {</div>
<div class="line"><span class="lineno">  279</span>        fprintf(stderr, <span class="stringliteral">&quot;Version buffer too small\n&quot;</span>);</div>
<div class="line"><span class="lineno">  280</span>      }</div>
<div class="line"><span class="lineno">  281</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112a3d10dec4a5d83d4227ea94c06efed2a3">YKYHR_GENERIC_ERROR</a>;</div>
<div class="line"><span class="lineno">  282</span>    }</div>
<div class="line"><span class="lineno">  283</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112a40500f2b4bd15d31f1348475e35f2459">YKYHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno">  284</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  285</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112a3d10dec4a5d83d4227ea94c06efed2a3">YKYHR_GENERIC_ERROR</a>;</div>
<div class="line"><span class="lineno">  286</span>  }</div>
<div class="line"><span class="lineno">  287</span>}</div>
<div class="ttc" id="aykyh_8h_html_a824ea775a85955b88cda9593b54b32a9"><div class="ttname"><a href="ykyh_8h.html#a824ea775a85955b88cda9593b54b32a9">YKYH_INS_GET_VERSION</a></div><div class="ttdeci">#define YKYH_INS_GET_VERSION</div><div class="ttdef"><b>Definition</b> <a href="ykyh_8h_source.html#l00036">ykyh.h:36</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a7360b55975153b822efc5217b7734e6a"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a></div><div class="ttdeci">size_t len</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l04771">yubihsm_pkcs11.c:4771</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ykyh_8c_a14f49c7ef8ee9ac66936346e7f21d6ce_cgraph.png" border="0" usemap="#aykyh_8c_a14f49c7ef8ee9ac66936346e7f21d6ce_cgraph" alt=""/></div>
<map name="aykyh_8c_a14f49c7ef8ee9ac66936346e7f21d6ce_cgraph" id="aykyh_8c_a14f49c7ef8ee9ac66936346e7f21d6ce_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,129,31"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="177,5,245,31"/>
<area shape="poly" title=" " alt="" coords="129,16,161,16,161,21,129,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ykyh_8c_a14f49c7ef8ee9ac66936346e7f21d6ce_icgraph.png" border="0" usemap="#aykyh_8c_a14f49c7ef8ee9ac66936346e7f21d6ce_icgraph" alt=""/></div>
<map name="aykyh_8c_a14f49c7ef8ee9ac66936346e7f21d6ce_icgraph" id="aykyh_8c_a14f49c7ef8ee9ac66936346e7f21d6ce_icgraph">
<area shape="rect" title=" " alt="" coords="239,5,362,31"/>
<area shape="rect" href="yhauth_2main_8c.html#a529cf891bd3db522b553c69e9d56d4a3" title=" " alt="" coords="103,5,191,31"/>
<area shape="poly" title=" " alt="" coords="223,21,192,21,192,16,223,16"/>
<area shape="rect" href="yhauth_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,55,31"/>
<area shape="poly" title=" " alt="" coords="87,21,55,21,55,16,87,16"/>
</map>
</div>

</div>
</div>
<a id="aaf8c4d6e022e4363c006d9066991776b" name="aaf8c4d6e022e4363c006d9066991776b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf8c4d6e022e4363c006d9066991776b">&#9670;&#160;</a></span>ykyh_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112">ykyh_rc</a> ykyh_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structykyh__state.html">ykyh_state</a> **</td>          <td class="paramname"><span class="paramname"><em>state</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>verbose</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ykyh_8c_source.html#l00035">35</a> of file <a class="el" href="ykyh_8c_source.html">ykyh.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   35</span>                                                   {</div>
<div class="line"><span class="lineno">   36</span>  <span class="keywordflow">if</span> (<a class="code hl_struct" href="structstate.html">state</a> == NULL) {</div>
<div class="line"><span class="lineno">   37</span>    <span class="keywordflow">if</span> (verbose) {</div>
<div class="line"><span class="lineno">   38</span>      fprintf(stderr, <span class="stringliteral">&quot;Unable to initialize: %s&quot;</span>,</div>
<div class="line"><span class="lineno">   39</span>              <a class="code hl_function" href="ykyh_2error_8c.html#a4544a3e0741c078e01233bb1ab541805">ykyh_strerror</a>(<a class="code hl_enumvalue" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112a3616b15980deeeb94e24538ede829d84">YKYHR_INVALID_PARAMS</a>));</div>
<div class="line"><span class="lineno">   40</span>    }</div>
<div class="line"><span class="lineno">   41</span> </div>
<div class="line"><span class="lineno">   42</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112a3616b15980deeeb94e24538ede829d84">YKYHR_INVALID_PARAMS</a>;</div>
<div class="line"><span class="lineno">   43</span>  }</div>
<div class="line"><span class="lineno">   44</span> </div>
<div class="line"><span class="lineno">   45</span>  <a class="code hl_struct" href="structykyh__state.html">ykyh_state</a> *<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a> = malloc(<span class="keyword">sizeof</span>(<a class="code hl_struct" href="structykyh__state.html">ykyh_state</a>));</div>
<div class="line"><span class="lineno">   46</span> </div>
<div class="line"><span class="lineno">   47</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a> == NULL) {</div>
<div class="line"><span class="lineno">   48</span>    <span class="keywordflow">if</span> (verbose) {</div>
<div class="line"><span class="lineno">   49</span>      fprintf(stderr, <span class="stringliteral">&quot;Unable to initialize: %s&quot;</span>,</div>
<div class="line"><span class="lineno">   50</span>              <a class="code hl_function" href="ykyh_2error_8c.html#a4544a3e0741c078e01233bb1ab541805">ykyh_strerror</a>(<a class="code hl_enumvalue" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112a734cac714da70c8a7853708acff0970f">YKYHR_MEMORY_ERROR</a>));</div>
<div class="line"><span class="lineno">   51</span>    }</div>
<div class="line"><span class="lineno">   52</span> </div>
<div class="line"><span class="lineno">   53</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112a734cac714da70c8a7853708acff0970f">YKYHR_MEMORY_ERROR</a>;</div>
<div class="line"><span class="lineno">   54</span>  }</div>
<div class="line"><span class="lineno">   55</span> </div>
<div class="line"><span class="lineno">   56</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105">memset</a>(<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a>, 0, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structykyh__state.html">ykyh_state</a>));</div>
<div class="line"><span class="lineno">   57</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a>-&gt;verbose = <a class="code hl_variable" href="programs_2clio_2main_8cpp.html#ab3f078684998b83967d507d0f453f454">verbose</a>;</div>
<div class="line"><span class="lineno">   58</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a>-&gt;context = SCARD_E_INVALID_HANDLE;</div>
<div class="line"><span class="lineno">   59</span>  *<a class="code hl_struct" href="structstate.html">state</a> = <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a>;</div>
<div class="line"><span class="lineno">   60</span> </div>
<div class="line"><span class="lineno">   61</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112a40500f2b4bd15d31f1348475e35f2459">YKYHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno">   62</span>}</div>
<div class="ttc" id="aprograms_2clio_2main_8cpp_html_ab3f078684998b83967d507d0f453f454"><div class="ttname"><a href="programs_2clio_2main_8cpp.html#ab3f078684998b83967d507d0f453f454">verbose</a></div><div class="ttdeci">bool verbose</div><div class="ttdef"><b>Definition</b> <a href="programs_2clio_2main_8cpp_source.html#l00190">main.cpp:190</a></div></div>
<div class="ttc" id="astructykyh__state_html"><div class="ttname"><a href="structykyh__state.html">ykyh_state</a></div><div class="ttdef"><b>Definition</b> <a href="ykyh_2internal_8h_source.html#l00034">internal.h:34</a></div></div>
<div class="ttc" id="aykyh_8h_html_a93aafaa60a79c75641302448631ea112a734cac714da70c8a7853708acff0970f"><div class="ttname"><a href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112a734cac714da70c8a7853708acff0970f">YKYHR_MEMORY_ERROR</a></div><div class="ttdeci">@ YKYHR_MEMORY_ERROR</div><div class="ttdef"><b>Definition</b> <a href="ykyh_8h_source.html#l00078">ykyh.h:78</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a506da415c9307c897ca9be93acfe1d0f"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a506da415c9307c897ca9be93acfe1d0f">s</a></div><div class="ttdeci">char * s</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l00524">yubihsm_pkcs11.c:524</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ykyh_8c_aaf8c4d6e022e4363c006d9066991776b_cgraph.png" border="0" usemap="#aykyh_8c_aaf8c4d6e022e4363c006d9066991776b_cgraph" alt=""/></div>
<map name="aykyh_8c_aaf8c4d6e022e4363c006d9066991776b_cgraph" id="aykyh_8c_aaf8c4d6e022e4363c006d9066991776b_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,79,56"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="141,5,210,31"/>
<area shape="poly" title=" " alt="" coords="79,34,125,25,126,30,80,39"/>
<area shape="rect" href="ykyh_2error_8c.html#a4544a3e0741c078e01233bb1ab541805" title=" " alt="" coords="127,55,224,80"/>
<area shape="poly" title=" " alt="" coords="80,47,112,53,111,59,79,53"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ykyh_8c_aaf8c4d6e022e4363c006d9066991776b_icgraph.png" border="0" usemap="#aykyh_8c_aaf8c4d6e022e4363c006d9066991776b_icgraph" alt=""/></div>
<map name="aykyh_8c_aaf8c4d6e022e4363c006d9066991776b_icgraph" id="aykyh_8c_aaf8c4d6e022e4363c006d9066991776b_icgraph">
<area shape="rect" title=" " alt="" coords="103,5,176,31"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,55,31"/>
<area shape="poly" title=" " alt="" coords="87,21,55,21,55,16,87,16"/>
</map>
</div>

</div>
</div>
<a id="a869199318f736641bf0779c5d2e90866" name="a869199318f736641bf0779c5d2e90866"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a869199318f736641bf0779c5d2e90866">&#9670;&#160;</a></span>ykyh_list_keys()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112">ykyh_rc</a> ykyh_list_keys </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structykyh__state.html">ykyh_state</a> *</td>          <td class="paramname"><span class="paramname"><em>state</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structykyh__list__entry.html">ykyh_list_entry</a> *</td>          <td class="paramname"><span class="paramname"><em>list</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *</td>          <td class="paramname"><span class="paramname"><em>list_items</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ykyh_8c_source.html#l00510">510</a> of file <a class="el" href="ykyh_8c_source.html">ykyh.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  511</span>                                           {</div>
<div class="line"><span class="lineno">  512</span> </div>
<div class="line"><span class="lineno">  513</span>  <a class="code hl_union" href="unionu___a_p_d_u.html">APDU</a> apdu;</div>
<div class="line"><span class="lineno">  514</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> data[1024];</div>
<div class="line"><span class="lineno">  515</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> recv_len = <span class="keyword">sizeof</span>(data);</div>
<div class="line"><span class="lineno">  516</span>  <span class="keywordtype">int</span> sw;</div>
<div class="line"><span class="lineno">  517</span>  <a class="code hl_enumeration" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112">ykyh_rc</a> res;</div>
<div class="line"><span class="lineno">  518</span> </div>
<div class="line"><span class="lineno">  519</span>  <span class="keywordflow">if</span> (<a class="code hl_struct" href="structstate.html">state</a> == NULL || list_items == NULL) {</div>
<div class="line"><span class="lineno">  520</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112a3616b15980deeeb94e24538ede829d84">YKYHR_INVALID_PARAMS</a>;</div>
<div class="line"><span class="lineno">  521</span>  }</div>
<div class="line"><span class="lineno">  522</span> </div>
<div class="line"><span class="lineno">  523</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105">memset</a>(apdu.<a class="code hl_variable" href="unionu___a_p_d_u.html#a864cd8b850ed1d88c60064c17b29fec9">raw</a>, 0, <span class="keyword">sizeof</span>(apdu));</div>
<div class="line"><span class="lineno">  524</span>  apdu.<a class="code hl_variable" href="unionu___a_p_d_u.html#abe564f763a61d62cb4de9b5cff4b2530">st</a>.ins = <a class="code hl_define" href="ykyh_8h.html#a7c53db94c23f5e592e8517c0fcd9f18e">YKYH_INS_LIST</a>;</div>
<div class="line"><span class="lineno">  525</span> </div>
<div class="line"><span class="lineno">  526</span>  res = send_data(<a class="code hl_struct" href="structstate.html">state</a>, &amp;apdu, data, &amp;recv_len, &amp;sw);</div>
<div class="line"><span class="lineno">  527</span>  <span class="keywordflow">if</span> (res != <a class="code hl_enumvalue" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112a40500f2b4bd15d31f1348475e35f2459">YKYHR_SUCCESS</a> || sw != <a class="code hl_define" href="ykyh_8h.html#a3328a41be5837af4761365aafb108025">SW_SUCCESS</a>) {</div>
<div class="line"><span class="lineno">  528</span>    <span class="keywordflow">if</span> (<a class="code hl_struct" href="structstate.html">state</a>-&gt;verbose) {</div>
<div class="line"><span class="lineno">  529</span>      fprintf(stderr, <span class="stringliteral">&quot;Unable to list keys: %s\n&quot;</span>, <a class="code hl_function" href="ykyh_2error_8c.html#a4544a3e0741c078e01233bb1ab541805">ykyh_strerror</a>(res));</div>
<div class="line"><span class="lineno">  530</span>    }</div>
<div class="line"><span class="lineno">  531</span>    <span class="keywordflow">return</span> res;</div>
<div class="line"><span class="lineno">  532</span>  }</div>
<div class="line"><span class="lineno">  533</span> </div>
<div class="line"><span class="lineno">  534</span>  <span class="keywordflow">if</span> (list == NULL) {</div>
<div class="line"><span class="lineno">  535</span>    *list_items = data[0];</div>
<div class="line"><span class="lineno">  536</span> </div>
<div class="line"><span class="lineno">  537</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112a40500f2b4bd15d31f1348475e35f2459">YKYHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno">  538</span>  }</div>
<div class="line"><span class="lineno">  539</span> </div>
<div class="line"><span class="lineno">  540</span>  <span class="keywordflow">if</span> (*list_items &lt; data[0]) {</div>
<div class="line"><span class="lineno">  541</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112a3d10dec4a5d83d4227ea94c06efed2a3">YKYHR_GENERIC_ERROR</a>; <span class="comment">// TODO(adma): not enough space, better error?</span></div>
<div class="line"><span class="lineno">  542</span>  }</div>
<div class="line"><span class="lineno">  543</span>  *list_items = data[0];</div>
<div class="line"><span class="lineno">  544</span> </div>
<div class="line"><span class="lineno">  545</span>  <span class="keywordtype">size_t</span> i = 1;</div>
<div class="line"><span class="lineno">  546</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a538d097420e725c4dad63c3caa9e55bd">j</a> = 0; <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a538d097420e725c4dad63c3caa9e55bd">j</a> &lt; *list_items; <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a538d097420e725c4dad63c3caa9e55bd">j</a>++) {</div>
<div class="line"><span class="lineno">  547</span>    <span class="keywordflow">if</span> (data[i++] == <a class="code hl_define" href="ykyh_8h.html#aea4750a6749dca19d059e06aaf75e74a">YKYH_TAG_NAME_LIST</a>) {</div>
<div class="line"><span class="lineno">  548</span>      <span class="keywordtype">size_t</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> = data[i++];</div>
<div class="line"><span class="lineno">  549</span>      list[<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a538d097420e725c4dad63c3caa9e55bd">j</a>].algo = data[i++];</div>
<div class="line"><span class="lineno">  550</span>      <a class="code hl_function" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105">memset</a>(list[<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a538d097420e725c4dad63c3caa9e55bd">j</a>].<a class="code hl_variable" href="catch__reporter__console_8cpp.html#a9b45b3e13bd9167aab02e17e08916231">name</a>, 0, <span class="keyword">sizeof</span>(list[<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a538d097420e725c4dad63c3caa9e55bd">j</a>].<a class="code hl_variable" href="catch__reporter__console_8cpp.html#a9b45b3e13bd9167aab02e17e08916231">name</a>));</div>
<div class="line"><span class="lineno">  551</span>      <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(list[<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a538d097420e725c4dad63c3caa9e55bd">j</a>].<a class="code hl_variable" href="catch__reporter__console_8cpp.html#a9b45b3e13bd9167aab02e17e08916231">name</a>, data + i, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> - 2);</div>
<div class="line"><span class="lineno">  552</span>      i += <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> - 2;</div>
<div class="line"><span class="lineno">  553</span>      list[<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a538d097420e725c4dad63c3caa9e55bd">j</a>].ctr = data[i++];</div>
<div class="line"><span class="lineno">  554</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  555</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112a3d10dec4a5d83d4227ea94c06efed2a3">YKYHR_GENERIC_ERROR</a>;</div>
<div class="line"><span class="lineno">  556</span>    }</div>
<div class="line"><span class="lineno">  557</span>  }</div>
<div class="line"><span class="lineno">  558</span> </div>
<div class="line"><span class="lineno">  559</span>  <span class="keywordflow">if</span> (i != recv_len - 2) {</div>
<div class="line"><span class="lineno">  560</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112a3d10dec4a5d83d4227ea94c06efed2a3">YKYHR_GENERIC_ERROR</a>;</div>
<div class="line"><span class="lineno">  561</span>  }</div>
<div class="line"><span class="lineno">  562</span> </div>
<div class="line"><span class="lineno">  563</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112a40500f2b4bd15d31f1348475e35f2459">YKYHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno">  564</span>}</div>
<div class="ttc" id="aykyh_8h_html_a7c53db94c23f5e592e8517c0fcd9f18e"><div class="ttname"><a href="ykyh_8h.html#a7c53db94c23f5e592e8517c0fcd9f18e">YKYH_INS_LIST</a></div><div class="ttdeci">#define YKYH_INS_LIST</div><div class="ttdef"><b>Definition</b> <a href="ykyh_8h_source.html#l00034">ykyh.h:34</a></div></div>
<div class="ttc" id="aykyh_8h_html_aea4750a6749dca19d059e06aaf75e74a"><div class="ttname"><a href="ykyh_8h.html#aea4750a6749dca19d059e06aaf75e74a">YKYH_TAG_NAME_LIST</a></div><div class="ttdeci">#define YKYH_TAG_NAME_LIST</div><div class="ttdef"><b>Definition</b> <a href="ykyh_8h_source.html#l00046">ykyh.h:46</a></div></div>
<div class="ttc" id="ayubihsm__pkcs11_8c_html_a538d097420e725c4dad63c3caa9e55bd"><div class="ttname"><a href="yubihsm__pkcs11_8c.html#a538d097420e725c4dad63c3caa9e55bd">j</a></div><div class="ttdeci">uint16_t j</div><div class="ttdef"><b>Definition</b> <a href="yubihsm__pkcs11_8c_source.html#l00465">yubihsm_pkcs11.c:465</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ykyh_8c_a869199318f736641bf0779c5d2e90866_cgraph.png" border="0" usemap="#aykyh_8c_a869199318f736641bf0779c5d2e90866_cgraph" alt=""/></div>
<map name="aykyh_8c_a869199318f736641bf0779c5d2e90866_cgraph" id="aykyh_8c_a869199318f736641bf0779c5d2e90866_cgraph">
<area shape="rect" title=" " alt="" coords="5,55,114,80"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="175,5,246,31"/>
<area shape="poly" title=" " alt="" coords="100,51,159,32,160,37,102,57"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="176,55,244,80"/>
<area shape="poly" title=" " alt="" coords="114,65,161,65,161,70,114,70"/>
<area shape="rect" href="ykyh_2error_8c.html#a4544a3e0741c078e01233bb1ab541805" title=" " alt="" coords="162,104,259,130"/>
<area shape="poly" title=" " alt="" coords="102,78,155,96,153,101,100,84"/>
</map>
</div>

</div>
</div>
<a id="a9a87b4e80e8f980badba176c4b713e13" name="a9a87b4e80e8f980badba176c4b713e13"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a87b4e80e8f980badba176c4b713e13">&#9670;&#160;</a></span>ykyh_list_readers()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112">ykyh_rc</a> ykyh_list_readers </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structykyh__state.html">ykyh_state</a> *</td>          <td class="paramname"><span class="paramname"><em>state</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *</td>          <td class="paramname"><span class="paramname"><em>readers</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *</td>          <td class="paramname"><span class="paramname"><em>len</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ykyh_8c_source.html#l00180">180</a> of file <a class="el" href="ykyh_8c_source.html">ykyh.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  180</span>                                                                         {</div>
<div class="line"><span class="lineno">  181</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> num_readers = 0;</div>
<div class="line"><span class="lineno">  182</span>  <span class="keywordtype">long</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a97917e1d5a9fa5e8b7a4495dc9234ac7">rc</a>;</div>
<div class="line"><span class="lineno">  183</span> </div>
<div class="line"><span class="lineno">  184</span>  <span class="keywordflow">if</span> (<a class="code hl_struct" href="structstate.html">state</a> == NULL || readers == NULL) {</div>
<div class="line"><span class="lineno">  185</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112a3616b15980deeeb94e24538ede829d84">YKYHR_INVALID_PARAMS</a>;</div>
<div class="line"><span class="lineno">  186</span>  }</div>
<div class="line"><span class="lineno">  187</span> </div>
<div class="line"><span class="lineno">  188</span>  <span class="keywordflow">if</span> (SCardIsValidContext(<a class="code hl_struct" href="structstate.html">state</a>-&gt;<a class="code hl_variable" href="structstate.html#a8d9e24fc2a15a8ea6b841006d9c1ec17">context</a>) != SCARD_S_SUCCESS) {</div>
<div class="line"><span class="lineno">  189</span>    <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a97917e1d5a9fa5e8b7a4495dc9234ac7">rc</a> = SCardEstablishContext(SCARD_SCOPE_SYSTEM, NULL, NULL, &amp;<a class="code hl_struct" href="structstate.html">state</a>-&gt;<a class="code hl_variable" href="structstate.html#a8d9e24fc2a15a8ea6b841006d9c1ec17">context</a>);</div>
<div class="line"><span class="lineno">  190</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a97917e1d5a9fa5e8b7a4495dc9234ac7">rc</a> != SCARD_S_SUCCESS) {</div>
<div class="line"><span class="lineno">  191</span>      <span class="keywordflow">if</span> (<a class="code hl_struct" href="structstate.html">state</a>-&gt;verbose) {</div>
<div class="line"><span class="lineno">  192</span>        fprintf(stderr, <span class="stringliteral">&quot;error: SCardEstablishContext failed, rc=%08lx\n&quot;</span>, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a97917e1d5a9fa5e8b7a4495dc9234ac7">rc</a>);</div>
<div class="line"><span class="lineno">  193</span>      }</div>
<div class="line"><span class="lineno">  194</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112aa66bb77f3c39144ec56d01e741a6d0b5">YKYHR_PCSC_ERROR</a>;</div>
<div class="line"><span class="lineno">  195</span>    }</div>
<div class="line"><span class="lineno">  196</span>  }</div>
<div class="line"><span class="lineno">  197</span> </div>
<div class="line"><span class="lineno">  198</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a97917e1d5a9fa5e8b7a4495dc9234ac7">rc</a> = SCardListReaders(<a class="code hl_struct" href="structstate.html">state</a>-&gt;<a class="code hl_variable" href="structstate.html#a8d9e24fc2a15a8ea6b841006d9c1ec17">context</a>, NULL, NULL, (LPDWORD) &amp;num_readers);</div>
<div class="line"><span class="lineno">  199</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a97917e1d5a9fa5e8b7a4495dc9234ac7">rc</a> != SCARD_S_SUCCESS) {</div>
<div class="line"><span class="lineno">  200</span>    <span class="keywordflow">if</span> (<a class="code hl_struct" href="structstate.html">state</a>-&gt;verbose) {</div>
<div class="line"><span class="lineno">  201</span>      fprintf(stderr, <span class="stringliteral">&quot;error: SCardListReaders failed, rc=%08lx\n&quot;</span>, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a97917e1d5a9fa5e8b7a4495dc9234ac7">rc</a>);</div>
<div class="line"><span class="lineno">  202</span>    }</div>
<div class="line"><span class="lineno">  203</span>    SCardReleaseContext(<a class="code hl_struct" href="structstate.html">state</a>-&gt;<a class="code hl_variable" href="structstate.html#a8d9e24fc2a15a8ea6b841006d9c1ec17">context</a>);</div>
<div class="line"><span class="lineno">  204</span>    <a class="code hl_struct" href="structstate.html">state</a>-&gt;<a class="code hl_variable" href="structstate.html#a8d9e24fc2a15a8ea6b841006d9c1ec17">context</a> = SCARD_E_INVALID_HANDLE;</div>
<div class="line"><span class="lineno">  205</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112aa66bb77f3c39144ec56d01e741a6d0b5">YKYHR_PCSC_ERROR</a>;</div>
<div class="line"><span class="lineno">  206</span>  }</div>
<div class="line"><span class="lineno">  207</span> </div>
<div class="line"><span class="lineno">  208</span>  <span class="keywordflow">if</span> (num_readers &gt; *<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>) {</div>
<div class="line"><span class="lineno">  209</span>    num_readers = *<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>;</div>
<div class="line"><span class="lineno">  210</span>  }</div>
<div class="line"><span class="lineno">  211</span> </div>
<div class="line"><span class="lineno">  212</span>  <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a97917e1d5a9fa5e8b7a4495dc9234ac7">rc</a> = SCardListReaders(<a class="code hl_struct" href="structstate.html">state</a>-&gt;<a class="code hl_variable" href="structstate.html#a8d9e24fc2a15a8ea6b841006d9c1ec17">context</a>, NULL, readers, (LPDWORD) &amp;num_readers);</div>
<div class="line"><span class="lineno">  213</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a97917e1d5a9fa5e8b7a4495dc9234ac7">rc</a> != SCARD_S_SUCCESS) {</div>
<div class="line"><span class="lineno">  214</span>    <span class="keywordflow">if</span> (<a class="code hl_struct" href="structstate.html">state</a>-&gt;verbose) {</div>
<div class="line"><span class="lineno">  215</span>      fprintf(stderr, <span class="stringliteral">&quot;error: SCardListReaders failed, rc=%08lx\n&quot;</span>, <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a97917e1d5a9fa5e8b7a4495dc9234ac7">rc</a>);</div>
<div class="line"><span class="lineno">  216</span>    }</div>
<div class="line"><span class="lineno">  217</span>    SCardReleaseContext(<a class="code hl_struct" href="structstate.html">state</a>-&gt;<a class="code hl_variable" href="structstate.html#a8d9e24fc2a15a8ea6b841006d9c1ec17">context</a>);</div>
<div class="line"><span class="lineno">  218</span>    <a class="code hl_struct" href="structstate.html">state</a>-&gt;<a class="code hl_variable" href="structstate.html#a8d9e24fc2a15a8ea6b841006d9c1ec17">context</a> = SCARD_E_INVALID_HANDLE;</div>
<div class="line"><span class="lineno">  219</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112aa66bb77f3c39144ec56d01e741a6d0b5">YKYHR_PCSC_ERROR</a>;</div>
<div class="line"><span class="lineno">  220</span>  }</div>
<div class="line"><span class="lineno">  221</span> </div>
<div class="line"><span class="lineno">  222</span>  *<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> = num_readers;</div>
<div class="line"><span class="lineno">  223</span> </div>
<div class="line"><span class="lineno">  224</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112a40500f2b4bd15d31f1348475e35f2459">YKYHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno">  225</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ykyh_8c_a9a87b4e80e8f980badba176c4b713e13_icgraph.png" border="0" usemap="#aykyh_8c_a9a87b4e80e8f980badba176c4b713e13_icgraph" alt=""/></div>
<map name="aykyh_8c_a9a87b4e80e8f980badba176c4b713e13_icgraph" id="aykyh_8c_a9a87b4e80e8f980badba176c4b713e13_icgraph">
<area shape="rect" title=" " alt="" coords="649,31,772,56"/>
<area shape="rect" href="ykyh_8c.html#a6b53f9d9825a88a6a20352c9734e4a4d" title=" " alt="" coords="498,31,601,56"/>
<area shape="poly" title=" " alt="" coords="633,46,601,46,601,41,633,41"/>
<area shape="rect" href="yhauth_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="348,5,398,31"/>
<area shape="poly" title=" " alt="" coords="482,37,398,24,399,19,483,31"/>
<area shape="rect" href="commands_8c.html#a22f22a25151b12c7573f80563a341368" title=" " alt="" coords="296,55,450,80"/>
<area shape="poly" title=" " alt="" coords="483,55,451,60,450,54,482,50"/>
<area shape="rect" href="src_2main_8c.html#a34a9e8c400dcf19e771e884636316060" title=" " alt="" coords="103,29,248,55"/>
<area shape="poly" title=" " alt="" coords="280,58,248,54,249,49,281,53"/>
<area shape="rect" href="src_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,55,55,80"/>
<area shape="poly" title=" " alt="" coords="280,70,55,70,55,65,280,65"/>
<area shape="poly" title=" " alt="" coords="88,60,55,66,54,61,87,55"/>
</map>
</div>

</div>
</div>
<a id="a0b123e6c68508162de189bcac06a3954" name="a0b123e6c68508162de189bcac06a3954"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b123e6c68508162de189bcac06a3954">&#9670;&#160;</a></span>ykyh_put()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112">ykyh_rc</a> ykyh_put </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structykyh__state.html">ykyh_state</a> *</td>          <td class="paramname"><span class="paramname"><em>state</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>name</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>key_enc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>key_enc_len</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *</td>          <td class="paramname"><span class="paramname"><em>key_mac</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>key_mac_len</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>pw</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a></td>          <td class="paramname"><span class="paramname"><em>touch_policy</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ykyh_8c_source.html#l00289">289</a> of file <a class="el" href="ykyh_8c_source.html">ykyh.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  291</span>                                                             {</div>
<div class="line"><span class="lineno">  292</span>  <a class="code hl_union" href="unionu___a_p_d_u.html">APDU</a> apdu;</div>
<div class="line"><span class="lineno">  293</span>  <a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *ptr = apdu.<a class="code hl_variable" href="unionu___a_p_d_u.html#abe564f763a61d62cb4de9b5cff4b2530">st</a>.data;</div>
<div class="line"><span class="lineno">  294</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> data[261];</div>
<div class="line"><span class="lineno">  295</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> recv_len = <span class="keyword">sizeof</span>(data);</div>
<div class="line"><span class="lineno">  296</span>  <span class="keywordtype">int</span> sw;</div>
<div class="line"><span class="lineno">  297</span> </div>
<div class="line"><span class="lineno">  298</span>  <span class="keywordflow">if</span> (<a class="code hl_struct" href="structstate.html">state</a> == NULL || <a class="code hl_variable" href="catch__reporter__console_8cpp.html#a9b45b3e13bd9167aab02e17e08916231">name</a> == NULL || strlen(<a class="code hl_variable" href="catch__reporter__console_8cpp.html#a9b45b3e13bd9167aab02e17e08916231">name</a>) &lt; <a class="code hl_define" href="ykyh_8h.html#ae8331a6f47276895ad08a1cbf3a6a508">YKYH_MIN_NAME_LEN</a> ||</div>
<div class="line"><span class="lineno">  299</span>      strlen(<a class="code hl_variable" href="catch__reporter__console_8cpp.html#a9b45b3e13bd9167aab02e17e08916231">name</a>) &gt; <a class="code hl_define" href="ykyh_8h.html#aba3c1d3e48c3662d8e58a87bc564cc82">YKYH_MAX_NAME_LEN</a> || key_enc == NULL ||</div>
<div class="line"><span class="lineno">  300</span>      key_enc_len != <a class="code hl_define" href="ykyh_8h.html#aa076fd48c09e4acec46eace24ad27a2f">YKYH_KEY_LEN</a> || key_mac == NULL ||</div>
<div class="line"><span class="lineno">  301</span>      key_mac_len != <a class="code hl_define" href="ykyh_8h.html#aa076fd48c09e4acec46eace24ad27a2f">YKYH_KEY_LEN</a> || pw == NULL || strlen(pw) != <a class="code hl_define" href="ykyh_8h.html#aa076fd48c09e4acec46eace24ad27a2f">YKYH_KEY_LEN</a>) {</div>
<div class="line"><span class="lineno">  302</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112a3616b15980deeeb94e24538ede829d84">YKYHR_INVALID_PARAMS</a>;</div>
<div class="line"><span class="lineno">  303</span>  }</div>
<div class="line"><span class="lineno">  304</span> </div>
<div class="line"><span class="lineno">  305</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105">memset</a>(apdu.<a class="code hl_variable" href="unionu___a_p_d_u.html#a864cd8b850ed1d88c60064c17b29fec9">raw</a>, 0, <span class="keyword">sizeof</span>(apdu));</div>
<div class="line"><span class="lineno">  306</span>  apdu.<a class="code hl_variable" href="unionu___a_p_d_u.html#abe564f763a61d62cb4de9b5cff4b2530">st</a>.ins = <a class="code hl_define" href="ykyh_8h.html#aaf3cacb408d5b3c4b30321a7ab046554">YKYH_INS_PUT</a>;</div>
<div class="line"><span class="lineno">  307</span> </div>
<div class="line"><span class="lineno">  308</span>  *(ptr++) = <a class="code hl_define" href="ykyh_8h.html#a1d9d05d1211e99f0edff27bfa82df0b8">YKYH_TAG_NAME</a>;</div>
<div class="line"><span class="lineno">  309</span>  apdu.<a class="code hl_variable" href="unionu___a_p_d_u.html#abe564f763a61d62cb4de9b5cff4b2530">st</a>.lc++;</div>
<div class="line"><span class="lineno">  310</span>  *(ptr++) = strlen(<a class="code hl_variable" href="catch__reporter__console_8cpp.html#a9b45b3e13bd9167aab02e17e08916231">name</a>);</div>
<div class="line"><span class="lineno">  311</span>  apdu.<a class="code hl_variable" href="unionu___a_p_d_u.html#abe564f763a61d62cb4de9b5cff4b2530">st</a>.lc++;</div>
<div class="line"><span class="lineno">  312</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(ptr, <a class="code hl_variable" href="catch__reporter__console_8cpp.html#a9b45b3e13bd9167aab02e17e08916231">name</a>, strlen(<a class="code hl_variable" href="catch__reporter__console_8cpp.html#a9b45b3e13bd9167aab02e17e08916231">name</a>));</div>
<div class="line"><span class="lineno">  313</span>  ptr += strlen(<a class="code hl_variable" href="catch__reporter__console_8cpp.html#a9b45b3e13bd9167aab02e17e08916231">name</a>);</div>
<div class="line"><span class="lineno">  314</span>  apdu.<a class="code hl_variable" href="unionu___a_p_d_u.html#abe564f763a61d62cb4de9b5cff4b2530">st</a>.lc += strlen(<a class="code hl_variable" href="catch__reporter__console_8cpp.html#a9b45b3e13bd9167aab02e17e08916231">name</a>);</div>
<div class="line"><span class="lineno">  315</span> </div>
<div class="line"><span class="lineno">  316</span>  *(ptr++) = <a class="code hl_define" href="ykyh_8h.html#a44933eda63818d2195aac0e007be30dc">YKYH_TAG_ALGO</a>;</div>
<div class="line"><span class="lineno">  317</span>  apdu.<a class="code hl_variable" href="unionu___a_p_d_u.html#abe564f763a61d62cb4de9b5cff4b2530">st</a>.lc++;</div>
<div class="line"><span class="lineno">  318</span>  *(ptr++) = 1;</div>
<div class="line"><span class="lineno">  319</span>  apdu.<a class="code hl_variable" href="unionu___a_p_d_u.html#abe564f763a61d62cb4de9b5cff4b2530">st</a>.lc++;</div>
<div class="line"><span class="lineno">  320</span>  *(ptr++) = <a class="code hl_define" href="ykyh_8h.html#a242db20335c7944a79a64147c2a7ba10">YKYH_SCP03_ALGO</a>;</div>
<div class="line"><span class="lineno">  321</span>  apdu.<a class="code hl_variable" href="unionu___a_p_d_u.html#abe564f763a61d62cb4de9b5cff4b2530">st</a>.lc++;</div>
<div class="line"><span class="lineno">  322</span> </div>
<div class="line"><span class="lineno">  323</span>  *(ptr++) = <a class="code hl_define" href="ykyh_8h.html#a72b145d0e689f9f70791c2332a3f944b">YKYH_TAG_KEY_ENC</a>;</div>
<div class="line"><span class="lineno">  324</span>  apdu.<a class="code hl_variable" href="unionu___a_p_d_u.html#abe564f763a61d62cb4de9b5cff4b2530">st</a>.lc++;</div>
<div class="line"><span class="lineno">  325</span>  *(ptr++) = 16;</div>
<div class="line"><span class="lineno">  326</span>  apdu.<a class="code hl_variable" href="unionu___a_p_d_u.html#abe564f763a61d62cb4de9b5cff4b2530">st</a>.lc++;</div>
<div class="line"><span class="lineno">  327</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(ptr, key_enc, 16);</div>
<div class="line"><span class="lineno">  328</span>  ptr += 16;</div>
<div class="line"><span class="lineno">  329</span>  apdu.<a class="code hl_variable" href="unionu___a_p_d_u.html#abe564f763a61d62cb4de9b5cff4b2530">st</a>.lc += 16;</div>
<div class="line"><span class="lineno">  330</span> </div>
<div class="line"><span class="lineno">  331</span>  *(ptr++) = <a class="code hl_define" href="ykyh_8h.html#a88992df18ab407b8afa214102ca29bbb">YKYH_TAG_KEY_MAC</a>;</div>
<div class="line"><span class="lineno">  332</span>  apdu.<a class="code hl_variable" href="unionu___a_p_d_u.html#abe564f763a61d62cb4de9b5cff4b2530">st</a>.lc++;</div>
<div class="line"><span class="lineno">  333</span>  *(ptr++) = 16;</div>
<div class="line"><span class="lineno">  334</span>  apdu.<a class="code hl_variable" href="unionu___a_p_d_u.html#abe564f763a61d62cb4de9b5cff4b2530">st</a>.lc++;</div>
<div class="line"><span class="lineno">  335</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(ptr, key_mac, 16);</div>
<div class="line"><span class="lineno">  336</span>  ptr += 16;</div>
<div class="line"><span class="lineno">  337</span>  apdu.<a class="code hl_variable" href="unionu___a_p_d_u.html#abe564f763a61d62cb4de9b5cff4b2530">st</a>.lc += 16;</div>
<div class="line"><span class="lineno">  338</span> </div>
<div class="line"><span class="lineno">  339</span>  *(ptr++) = <a class="code hl_define" href="ykyh_8h.html#a2df9aee745a0c8a8cd5d127c72dea523">YKYH_TAG_PW</a>;</div>
<div class="line"><span class="lineno">  340</span>  apdu.<a class="code hl_variable" href="unionu___a_p_d_u.html#abe564f763a61d62cb4de9b5cff4b2530">st</a>.lc++;</div>
<div class="line"><span class="lineno">  341</span>  *(ptr++) = <a class="code hl_define" href="ykyh_8h.html#a00e800150afe4404120c2090461fdf1a">YKYH_PW_LEN</a>;</div>
<div class="line"><span class="lineno">  342</span>  apdu.<a class="code hl_variable" href="unionu___a_p_d_u.html#abe564f763a61d62cb4de9b5cff4b2530">st</a>.lc++;</div>
<div class="line"><span class="lineno">  343</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1">memcpy</a>(ptr, pw, <a class="code hl_define" href="ykyh_8h.html#a00e800150afe4404120c2090461fdf1a">YKYH_PW_LEN</a>);</div>
<div class="line"><span class="lineno">  344</span>  ptr += <a class="code hl_define" href="ykyh_8h.html#a00e800150afe4404120c2090461fdf1a">YKYH_PW_LEN</a>;</div>
<div class="line"><span class="lineno">  345</span>  apdu.<a class="code hl_variable" href="unionu___a_p_d_u.html#abe564f763a61d62cb4de9b5cff4b2530">st</a>.lc += <a class="code hl_define" href="ykyh_8h.html#a00e800150afe4404120c2090461fdf1a">YKYH_PW_LEN</a>;</div>
<div class="line"><span class="lineno">  346</span> </div>
<div class="line"><span class="lineno">  347</span>  *(ptr++) = <a class="code hl_define" href="ykyh_8h.html#a121aacd54595ba241bfd40ed46fc1f04">YKYH_TAG_TOUCH</a>;</div>
<div class="line"><span class="lineno">  348</span>  apdu.<a class="code hl_variable" href="unionu___a_p_d_u.html#abe564f763a61d62cb4de9b5cff4b2530">st</a>.lc++;</div>
<div class="line"><span class="lineno">  349</span>  *(ptr++) = 1;</div>
<div class="line"><span class="lineno">  350</span>  apdu.<a class="code hl_variable" href="unionu___a_p_d_u.html#abe564f763a61d62cb4de9b5cff4b2530">st</a>.lc++;</div>
<div class="line"><span class="lineno">  351</span>  *(ptr++) = touch_policy ? 1 : 0;</div>
<div class="line"><span class="lineno">  352</span>  apdu.<a class="code hl_variable" href="unionu___a_p_d_u.html#abe564f763a61d62cb4de9b5cff4b2530">st</a>.lc++;</div>
<div class="line"><span class="lineno">  353</span> </div>
<div class="line"><span class="lineno">  354</span>  <a class="code hl_enumeration" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112">ykyh_rc</a> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a97917e1d5a9fa5e8b7a4495dc9234ac7">rc</a> = send_data(<a class="code hl_struct" href="structstate.html">state</a>, &amp;apdu, data, &amp;recv_len, &amp;sw);</div>
<div class="line"><span class="lineno">  355</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a97917e1d5a9fa5e8b7a4495dc9234ac7">rc</a> != <a class="code hl_enumvalue" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112a40500f2b4bd15d31f1348475e35f2459">YKYHR_SUCCESS</a>) {</div>
<div class="line"><span class="lineno">  356</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="yubihsm__pkcs11_8c.html#a97917e1d5a9fa5e8b7a4495dc9234ac7">rc</a>;</div>
<div class="line"><span class="lineno">  357</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sw != <a class="code hl_define" href="ykyh_8h.html#a3328a41be5837af4761365aafb108025">SW_SUCCESS</a>) {</div>
<div class="line"><span class="lineno">  358</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112a3d10dec4a5d83d4227ea94c06efed2a3">YKYHR_GENERIC_ERROR</a>; <span class="comment">// TODO(adma): better error</span></div>
<div class="line"><span class="lineno">  359</span>  }</div>
<div class="line"><span class="lineno">  360</span> </div>
<div class="line"><span class="lineno">  361</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112a40500f2b4bd15d31f1348475e35f2459">YKYHR_SUCCESS</a>;</div>
<div class="line"><span class="lineno">  362</span>}</div>
<div class="ttc" id="aykyh_8h_html_a121aacd54595ba241bfd40ed46fc1f04"><div class="ttname"><a href="ykyh_8h.html#a121aacd54595ba241bfd40ed46fc1f04">YKYH_TAG_TOUCH</a></div><div class="ttdeci">#define YKYH_TAG_TOUCH</div><div class="ttdef"><b>Definition</b> <a href="ykyh_8h_source.html#l00054">ykyh.h:54</a></div></div>
<div class="ttc" id="aykyh_8h_html_a242db20335c7944a79a64147c2a7ba10"><div class="ttname"><a href="ykyh_8h.html#a242db20335c7944a79a64147c2a7ba10">YKYH_SCP03_ALGO</a></div><div class="ttdeci">#define YKYH_SCP03_ALGO</div><div class="ttdef"><b>Definition</b> <a href="ykyh_8h_source.html#l00057">ykyh.h:57</a></div></div>
<div class="ttc" id="aykyh_8h_html_a44933eda63818d2195aac0e007be30dc"><div class="ttname"><a href="ykyh_8h.html#a44933eda63818d2195aac0e007be30dc">YKYH_TAG_ALGO</a></div><div class="ttdeci">#define YKYH_TAG_ALGO</div><div class="ttdef"><b>Definition</b> <a href="ykyh_8h_source.html#l00048">ykyh.h:48</a></div></div>
<div class="ttc" id="aykyh_8h_html_a72b145d0e689f9f70791c2332a3f944b"><div class="ttname"><a href="ykyh_8h.html#a72b145d0e689f9f70791c2332a3f944b">YKYH_TAG_KEY_ENC</a></div><div class="ttdeci">#define YKYH_TAG_KEY_ENC</div><div class="ttdef"><b>Definition</b> <a href="ykyh_8h_source.html#l00049">ykyh.h:49</a></div></div>
<div class="ttc" id="aykyh_8h_html_a88992df18ab407b8afa214102ca29bbb"><div class="ttname"><a href="ykyh_8h.html#a88992df18ab407b8afa214102ca29bbb">YKYH_TAG_KEY_MAC</a></div><div class="ttdeci">#define YKYH_TAG_KEY_MAC</div><div class="ttdef"><b>Definition</b> <a href="ykyh_8h_source.html#l00050">ykyh.h:50</a></div></div>
<div class="ttc" id="aykyh_8h_html_aaf3cacb408d5b3c4b30321a7ab046554"><div class="ttname"><a href="ykyh_8h.html#aaf3cacb408d5b3c4b30321a7ab046554">YKYH_INS_PUT</a></div><div class="ttdeci">#define YKYH_INS_PUT</div><div class="ttdef"><b>Definition</b> <a href="ykyh_8h_source.html#l00030">ykyh.h:30</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ykyh_8c_a0b123e6c68508162de189bcac06a3954_cgraph.png" border="0" usemap="#aykyh_8c_a0b123e6c68508162de189bcac06a3954_cgraph" alt=""/></div>
<map name="aykyh_8c_a0b123e6c68508162de189bcac06a3954_cgraph" id="aykyh_8c_a0b123e6c68508162de189bcac06a3954_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,80,56"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#ae785d5badbf1f08b491af31f32a135a1" title=" " alt="" coords="128,5,199,31"/>
<area shape="poly" title=" " alt="" coords="79,33,112,26,113,31,80,38"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="129,55,198,80"/>
<area shape="poly" title=" " alt="" coords="80,48,114,55,113,60,79,53"/>
</map>
</div>

</div>
</div>
<a id="a94ec07237ae4d03c38751f3d966194e3" name="a94ec07237ae4d03c38751f3d966194e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a94ec07237ae4d03c38751f3d966194e3">&#9670;&#160;</a></span>ykyh_reset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112">ykyh_rc</a> ykyh_reset </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structykyh__state.html">ykyh_state</a> *</td>          <td class="paramname"><span class="paramname"><em>state</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ykyh_8c_source.html#l00483">483</a> of file <a class="el" href="ykyh_8c_source.html">ykyh.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  483</span>                                      {</div>
<div class="line"><span class="lineno">  484</span> </div>
<div class="line"><span class="lineno">  485</span>  <a class="code hl_union" href="unionu___a_p_d_u.html">APDU</a> apdu;</div>
<div class="line"><span class="lineno">  486</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> data[8];</div>
<div class="line"><span class="lineno">  487</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> recv_len = <span class="keyword">sizeof</span>(data);</div>
<div class="line"><span class="lineno">  488</span>  <span class="keywordtype">int</span> sw;</div>
<div class="line"><span class="lineno">  489</span>  <a class="code hl_enumeration" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112">ykyh_rc</a> res;</div>
<div class="line"><span class="lineno">  490</span> </div>
<div class="line"><span class="lineno">  491</span>  <span class="keywordflow">if</span> (<a class="code hl_struct" href="structstate.html">state</a> == NULL) {</div>
<div class="line"><span class="lineno">  492</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="ykyh_8h.html#a93aafaa60a79c75641302448631ea112a3616b15980deeeb94e24538ede829d84">YKYHR_INVALID_PARAMS</a>;</div>
<div class="line"><span class="lineno">  493</span>  }</div>
<div class="line"><span class="lineno">  494</span> </div>
<div class="line"><span class="lineno">  495</span>  <a class="code hl_function" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105">memset</a>(apdu.<a class="code hl_variable" href="unionu___a_p_d_u.html#a864cd8b850ed1d88c60064c17b29fec9">raw</a>, 0, <span class="keyword">sizeof</span>(apdu));</div>
<div class="line"><span class="lineno">  496</span>  apdu.<a class="code hl_variable" href="unionu___a_p_d_u.html#abe564f763a61d62cb4de9b5cff4b2530">st</a>.ins = <a class="code hl_define" href="ykyh_8h.html#a42ae5fc5228a23e671d3cb707e493378">YKYH_INS_RESET</a>;</div>
<div class="line"><span class="lineno">  497</span>  apdu.<a class="code hl_variable" href="unionu___a_p_d_u.html#abe564f763a61d62cb4de9b5cff4b2530">st</a>.p1 = <a class="code hl_define" href="ykyh_8h.html#ab4bd17f6a1b0642c393b29e66d858070">YKYH_P1_RESET</a>;</div>
<div class="line"><span class="lineno">  498</span>  apdu.<a class="code hl_variable" href="unionu___a_p_d_u.html#abe564f763a61d62cb4de9b5cff4b2530">st</a>.p2 = <a class="code hl_define" href="ykyh_8h.html#ab135ab62c981c7deb83f5c74af68610d">YKYH_P2_RESET</a>;</div>
<div class="line"><span class="lineno">  499</span> </div>
<div class="line"><span class="lineno">  500</span>  res = send_data(<a class="code hl_struct" href="structstate.html">state</a>, &amp;apdu, data, &amp;recv_len, &amp;sw);</div>
<div class="line"><span class="lineno">  501</span>  <span class="keywordflow">if</span> (sw != <a class="code hl_define" href="ykyh_8h.html#a3328a41be5837af4761365aafb108025">SW_SUCCESS</a>) {</div>
<div class="line"><span class="lineno">  502</span>    <span class="keywordflow">if</span> (<a class="code hl_struct" href="structstate.html">state</a>-&gt;verbose) {</div>
<div class="line"><span class="lineno">  503</span>      fprintf(stderr, <span class="stringliteral">&quot;Unable to reset: %s\n&quot;</span>, <a class="code hl_function" href="ykyh_2error_8c.html#a4544a3e0741c078e01233bb1ab541805">ykyh_strerror</a>(res));</div>
<div class="line"><span class="lineno">  504</span>    }</div>
<div class="line"><span class="lineno">  505</span>  }</div>
<div class="line"><span class="lineno">  506</span> </div>
<div class="line"><span class="lineno">  507</span>  <span class="keywordflow">return</span> res;</div>
<div class="line"><span class="lineno">  508</span>}</div>
<div class="ttc" id="aykyh_8h_html_a42ae5fc5228a23e671d3cb707e493378"><div class="ttname"><a href="ykyh_8h.html#a42ae5fc5228a23e671d3cb707e493378">YKYH_INS_RESET</a></div><div class="ttdeci">#define YKYH_INS_RESET</div><div class="ttdef"><b>Definition</b> <a href="ykyh_8h_source.html#l00035">ykyh.h:35</a></div></div>
<div class="ttc" id="aykyh_8h_html_ab135ab62c981c7deb83f5c74af68610d"><div class="ttname"><a href="ykyh_8h.html#ab135ab62c981c7deb83f5c74af68610d">YKYH_P2_RESET</a></div><div class="ttdeci">#define YKYH_P2_RESET</div><div class="ttdef"><b>Definition</b> <a href="ykyh_8h_source.html#l00042">ykyh.h:42</a></div></div>
<div class="ttc" id="aykyh_8h_html_ab4bd17f6a1b0642c393b29e66d858070"><div class="ttname"><a href="ykyh_8h.html#ab4bd17f6a1b0642c393b29e66d858070">YKYH_P1_RESET</a></div><div class="ttdeci">#define YKYH_P1_RESET</div><div class="ttdef"><b>Definition</b> <a href="ykyh_8h_source.html#l00039">ykyh.h:39</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ykyh_8c_a94ec07237ae4d03c38751f3d966194e3_cgraph.png" border="0" usemap="#aykyh_8c_a94ec07237ae4d03c38751f3d966194e3_cgraph" alt=""/></div>
<map name="aykyh_8c_a94ec07237ae4d03c38751f3d966194e3_cgraph" id="aykyh_8c_a94ec07237ae4d03c38751f3d966194e3_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,91,56"/>
<area shape="rect" href="yubihsm__pkcs11_8c.html#adc4bd59a60361844aa0e852efa210105" title=" " alt="" coords="153,5,222,31"/>
<area shape="poly" title=" " alt="" coords="91,33,138,24,139,30,92,38"/>
<area shape="rect" href="ykyh_2error_8c.html#a4544a3e0741c078e01233bb1ab541805" title=" " alt="" coords="139,55,236,80"/>
<area shape="poly" title=" " alt="" coords="92,48,124,54,123,59,91,53"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ykyh_8c_a94ec07237ae4d03c38751f3d966194e3_icgraph.png" border="0" usemap="#aykyh_8c_a94ec07237ae4d03c38751f3d966194e3_icgraph" alt=""/></div>
<map name="aykyh_8c_a94ec07237ae4d03c38751f3d966194e3_icgraph" id="aykyh_8c_a94ec07237ae4d03c38751f3d966194e3_icgraph">
<area shape="rect" title=" " alt="" coords="246,5,331,31"/>
<area shape="rect" href="yhauth_2main_8c.html#a5826d7c243fd886232232814de1f7284" title=" " alt="" coords="103,5,198,31"/>
<area shape="poly" title=" " alt="" coords="230,21,198,21,198,16,230,16"/>
<area shape="rect" href="yhauth_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,55,31"/>
<area shape="poly" title=" " alt="" coords="87,21,55,21,55,16,87,16"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_428556e0652617aa37d2f7d8bcaf7fdf.html">libraries</a></li><li class="navelem"><a class="el" href="dir_63c6fe01b05f3098165849fc89c17214.html">yubihsm</a></li><li class="navelem"><a class="el" href="dir_f75e2d279a632a62a2c86b06d3e7e66a.html">ykyh</a></li><li class="navelem"><a class="el" href="ykyh_8c.html">ykyh.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0 </li>
  </ul>
</div>
</body>
</html>
