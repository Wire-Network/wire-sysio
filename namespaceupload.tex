\doxysection{upload Namespace Reference}
\hypertarget{namespaceupload}{}\label{namespaceupload}\index{upload@{upload}}
\doxysubsubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class \mbox{\hyperlink{classupload_1_1_abstract_rpc_server}{Abstract\+Rpc\+Server}}
\item 
class \mbox{\hyperlink{classupload_1_1_client_login_error}{Client\+Login\+Error}}
\item 
class \mbox{\hyperlink{classupload_1_1_git_v_c_s}{Git\+VCS}}
\item 
class \mbox{\hyperlink{classupload_1_1_http_rpc_server}{Http\+Rpc\+Server}}
\begin{DoxyCompactList}\small\item\em elif e.\+code \texorpdfstring{$>$}{>}= 500 and e.\+code \texorpdfstring{$<$}{<} 600\+: \end{DoxyCompactList}\item 
class \mbox{\hyperlink{classupload_1_1_mercurial_v_c_s}{Mercurial\+VCS}}
\item 
class \mbox{\hyperlink{classupload_1_1_subversion_v_c_s}{Subversion\+VCS}}
\item 
class \mbox{\hyperlink{classupload_1_1_version_control_system}{Version\+Control\+System}}
\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{namespaceupload_a9515ed0472d3989eb2b4ffb598bf4d38}{Get\+Email}} (prompt)
\item 
\mbox{\hyperlink{namespaceupload_ace7b6cbe630726762d0d876fc7e756a2}{Status\+Update}} (msg)
\item 
\mbox{\hyperlink{namespaceupload_aded00b2430ea094be3da97c21c1ec61f}{Error\+Exit}} (msg)
\item 
\mbox{\hyperlink{namespaceupload_a6846c039a4f0d019180b754a2f039e2f}{Get\+Rpc\+Server}} (options)
\item 
\mbox{\hyperlink{namespaceupload_ac1ee2f4e90998b7fbf29d894b6783ef8}{Encode\+Multipart\+Form\+Data}} (fields, files)
\item 
\mbox{\hyperlink{namespaceupload_acee77e89f7241bb7bad529b423123d0c}{Get\+Content\+Type}} (filename)
\item 
\mbox{\hyperlink{namespaceupload_aaf7f85c895770c6aba543e1bf57533ae}{Run\+Shell\+With\+Return\+Code}} (command, print\+\_\+output=False, universal\+\_\+newlines=True)
\item 
\mbox{\hyperlink{namespaceupload_adc4aea7c4a79d29dfab04f650c274fdb}{Run\+Shell}} (command, silent\+\_\+ok=False, universal\+\_\+newlines=True, print\+\_\+output=False)
\item 
\mbox{\hyperlink{namespaceupload_ad086545a31d32684cc46db8d911c5dd9}{Split\+Patch}} (data)
\item 
\mbox{\hyperlink{namespaceupload_a911c98a64378a566a42ed6758245ef22}{Upload\+Separate\+Patches}} (issue, rpc\+\_\+server, patchset, data, options)
\item 
\mbox{\hyperlink{namespaceupload_acd3e17a78f2b4786e3ff1423f6d3c123}{Guess\+VCS}} (options)
\item 
\mbox{\hyperlink{namespaceupload_ad57cf4d14059e0f18689efa2ea7c368b}{Real\+Main}} (\mbox{\hyperlink{hello__driver_8cpp_af2efa898e9eed6fe6715279cb1ec35b0}{argv}}, data=None)
\item 
\mbox{\hyperlink{namespaceupload_a08415e9cf2468e18c17471151ae8c26d}{main}} ()
\end{DoxyCompactItemize}
\doxysubsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
int \mbox{\hyperlink{namespaceupload_a79aff46409a98c4e5f608c8df1fd4612}{verbosity}} = 1
\item 
int \mbox{\hyperlink{namespaceupload_aad5b1a43823e2a710a2f78e33dde8901}{MAX\+\_\+\+UPLOAD\+\_\+\+SIZE}} = 900 \texorpdfstring{$\ast$}{*} 1024
\item 
\mbox{\hyperlink{namespaceupload_af9e508d19dc2dd9cdb7c642dde0bdd21}{parser}} = optparse.\+Option\+Parser(usage="{}\%prog \mbox{[}options\mbox{]} \mbox{[}-\/-\/ diff\+\_\+options\mbox{]}"{})
\item 
\mbox{\hyperlink{namespaceupload_a675d13c979f1c720866d22ed1736f580}{action}}
\item 
\mbox{\hyperlink{namespaceupload_a770d9c7b49b1fede80de6078d5e49af7}{dest}}
\item 
\mbox{\hyperlink{namespaceupload_af4be925d9a50d5ad134d86400509d0f2}{default}}
\item 
\mbox{\hyperlink{namespaceupload_abfc23c9aa2d9b777678da117a85929a5}{help}}
\item 
\mbox{\hyperlink{namespaceupload_a9d33d66de17175dced88ffe95f079226}{group}} = parser.\+add\+\_\+option\+\_\+group("{}Logging options"{})
\item 
\mbox{\hyperlink{namespaceupload_a985aa9a71de3eb507344df65700c696d}{const}}
\item 
\mbox{\hyperlink{namespaceupload_af1cea8af5389f0ab2d8b65b2c0fd2fe0}{metavar}}
\item 
\mbox{\hyperlink{namespaceupload_a4fc56f0dd6613be15c3c4dc3af3619ce}{type}}
\item 
\mbox{\hyperlink{namespaceupload_afa85ceef00a65cd276a856404eb5f310}{use\+\_\+shell}} = sys.\+platform.\+startswith("{}win"{})
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\begin{DoxyVerb}Tool for uploading diffs from a version control system to the codereview app.

Usage summary: upload.py [options] [-- diff_options]

Diff options are passed to the diff command of the underlying system.

Supported version control systems:
  Git
  Mercurial
  Subversion

It is important for Git/Mercurial users to specify a tree/node/branch to diff
against by using the '--rev' option.
\end{DoxyVerb}
 

\doxysubsection{Function Documentation}
\Hypertarget{namespaceupload_ac1ee2f4e90998b7fbf29d894b6783ef8}\index{upload@{upload}!EncodeMultipartFormData@{EncodeMultipartFormData}}
\index{EncodeMultipartFormData@{EncodeMultipartFormData}!upload@{upload}}
\doxysubsubsection{\texorpdfstring{EncodeMultipartFormData()}{EncodeMultipartFormData()}}
{\footnotesize\ttfamily \label{namespaceupload_ac1ee2f4e90998b7fbf29d894b6783ef8} 
upload.\+Encode\+Multipart\+Form\+Data (\begin{DoxyParamCaption}\item[{}]{fields}{, }\item[{}]{files}{}\end{DoxyParamCaption})}

\begin{DoxyVerb}Encode form fields for multipart/form-data.

Args:
  fields: A sequence of (name, value) elements for regular form fields.
  files: A sequence of (name, filename, value) elements for data to be
         uploaded as files.
Returns:
  (content_type, body) ready for httplib.HTTP instance.

Source:
  http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/146306
\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{googlemock_2scripts_2upload_8py_source_l00498}{498}} of file \mbox{\hyperlink{googlemock_2scripts_2upload_8py_source}{upload.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00498\ \textcolor{keyword}{def\ }EncodeMultipartFormData(fields,\ files):}
\DoxyCodeLine{00499\ \ \ \textcolor{stringliteral}{"{}"{}"{}Encode\ form\ fields\ for\ multipart/form-\/data.}}
\DoxyCodeLine{00500\ \textcolor{stringliteral}{}}
\DoxyCodeLine{00501\ \textcolor{stringliteral}{\ \ Args:}}
\DoxyCodeLine{00502\ \textcolor{stringliteral}{\ \ \ \ fields:\ A\ sequence\ of\ (name,\ value)\ elements\ for\ regular\ form\ fields.}}
\DoxyCodeLine{00503\ \textcolor{stringliteral}{\ \ \ \ files:\ A\ sequence\ of\ (name,\ filename,\ value)\ elements\ for\ data\ to\ be}}
\DoxyCodeLine{00504\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ uploaded\ as\ files.}}
\DoxyCodeLine{00505\ \textcolor{stringliteral}{\ \ Returns:}}
\DoxyCodeLine{00506\ \textcolor{stringliteral}{\ \ \ \ (content\_type,\ body)\ ready\ for\ httplib.HTTP\ instance.}}
\DoxyCodeLine{00507\ \textcolor{stringliteral}{}}
\DoxyCodeLine{00508\ \textcolor{stringliteral}{\ \ Source:}}
\DoxyCodeLine{00509\ \textcolor{stringliteral}{\ \ \ \ http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/146306}}
\DoxyCodeLine{00510\ \textcolor{stringliteral}{\ \ "{}"{}"{}}}
\DoxyCodeLine{00511\ \ \ BOUNDARY\ =\ \textcolor{stringliteral}{'-\/M-\/A-\/G-\/I-\/C-\/-\/-\/B-\/O-\/U-\/N-\/D-\/A-\/R-\/Y-\/'}}
\DoxyCodeLine{00512\ \ \ CRLF\ =\ \textcolor{stringliteral}{'\(\backslash\)r\(\backslash\)n'}}
\DoxyCodeLine{00513\ \ \ lines\ =\ []}
\DoxyCodeLine{00514\ \ \ \textcolor{keywordflow}{for}\ (key,\ value)\ \textcolor{keywordflow}{in}\ fields:}
\DoxyCodeLine{00515\ \ \ \ \ lines.append(\textcolor{stringliteral}{'-\/-\/'}\ +\ BOUNDARY)}
\DoxyCodeLine{00516\ \ \ \ \ lines.append(\textcolor{stringliteral}{'Content-\/Disposition:\ form-\/data;\ name="{}\%s"{}'}\ \%\ key)}
\DoxyCodeLine{00517\ \ \ \ \ lines.append(\textcolor{stringliteral}{''})}
\DoxyCodeLine{00518\ \ \ \ \ lines.append(value)}
\DoxyCodeLine{00519\ \ \ \textcolor{keywordflow}{for}\ (key,\ filename,\ value)\ \textcolor{keywordflow}{in}\ files:}
\DoxyCodeLine{00520\ \ \ \ \ lines.append(\textcolor{stringliteral}{'-\/-\/'}\ +\ BOUNDARY)}
\DoxyCodeLine{00521\ \ \ \ \ lines.append(\textcolor{stringliteral}{'Content-\/Disposition:\ form-\/data;\ name="{}\%s"{};\ filename="{}\%s"{}'}\ \%}
\DoxyCodeLine{00522\ \ \ \ \ \ \ \ \ \ \ \ \ \ (key,\ filename))}
\DoxyCodeLine{00523\ \ \ \ \ lines.append(\textcolor{stringliteral}{'Content-\/Type:\ \%s'}\ \%\ GetContentType(filename))}
\DoxyCodeLine{00524\ \ \ \ \ lines.append(\textcolor{stringliteral}{''})}
\DoxyCodeLine{00525\ \ \ \ \ lines.append(value)}
\DoxyCodeLine{00526\ \ \ lines.append(\textcolor{stringliteral}{'-\/-\/'}\ +\ BOUNDARY\ +\ \textcolor{stringliteral}{'-\/-\/'})}
\DoxyCodeLine{00527\ \ \ lines.append(\textcolor{stringliteral}{''})}
\DoxyCodeLine{00528\ \ \ body\ =\ CRLF.join(lines)}
\DoxyCodeLine{00529\ \ \ content\_type\ =\ \textcolor{stringliteral}{'multipart/form-\/data;\ boundary=\%s'}\ \%\ BOUNDARY}
\DoxyCodeLine{00530\ \ \ \textcolor{keywordflow}{return}\ content\_type,\ body}
\DoxyCodeLine{00531\ }
\DoxyCodeLine{00532\ }

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceupload_ac1ee2f4e90998b7fbf29d894b6783ef8_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceupload_ac1ee2f4e90998b7fbf29d894b6783ef8_icgraph}
\end{center}
\end{figure}
\Hypertarget{namespaceupload_aded00b2430ea094be3da97c21c1ec61f}\index{upload@{upload}!ErrorExit@{ErrorExit}}
\index{ErrorExit@{ErrorExit}!upload@{upload}}
\doxysubsubsection{\texorpdfstring{ErrorExit()}{ErrorExit()}}
{\footnotesize\ttfamily \label{namespaceupload_aded00b2430ea094be3da97c21c1ec61f} 
upload.\+Error\+Exit (\begin{DoxyParamCaption}\item[{}]{msg}{}\end{DoxyParamCaption})}

\begin{DoxyVerb}Print an error message to stderr and exit.\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{googlemock_2scripts_2upload_8py_source_l00109}{109}} of file \mbox{\hyperlink{googlemock_2scripts_2upload_8py_source}{upload.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00109\ \textcolor{keyword}{def\ }ErrorExit(msg):}
\DoxyCodeLine{00110\ \ \ \textcolor{stringliteral}{"{}"{}"{}Print\ an\ error\ message\ to\ stderr\ and\ exit."{}"{}"{}}}
\DoxyCodeLine{00111\ \ \ \textcolor{keywordflow}{print}\ >>sys.stderr,\ msg}
\DoxyCodeLine{00112\ \ \ sys.exit(1)}
\DoxyCodeLine{00113\ }
\DoxyCodeLine{00114\ }

\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceupload_aded00b2430ea094be3da97c21c1ec61f_icgraph}
\end{center}
\end{figure}
\Hypertarget{namespaceupload_acee77e89f7241bb7bad529b423123d0c}\index{upload@{upload}!GetContentType@{GetContentType}}
\index{GetContentType@{GetContentType}!upload@{upload}}
\doxysubsubsection{\texorpdfstring{GetContentType()}{GetContentType()}}
{\footnotesize\ttfamily \label{namespaceupload_acee77e89f7241bb7bad529b423123d0c} 
upload.\+Get\+Content\+Type (\begin{DoxyParamCaption}\item[{}]{filename}{}\end{DoxyParamCaption})}

\begin{DoxyVerb}Helper to guess the content-type from the filename.\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{googlemock_2scripts_2upload_8py_source_l00533}{533}} of file \mbox{\hyperlink{googlemock_2scripts_2upload_8py_source}{upload.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00533\ \textcolor{keyword}{def\ }GetContentType(filename):}
\DoxyCodeLine{00534\ \ \ \textcolor{stringliteral}{"{}"{}"{}Helper\ to\ guess\ the\ content-\/type\ from\ the\ filename."{}"{}"{}}}
\DoxyCodeLine{00535\ \ \ \textcolor{keywordflow}{return}\ mimetypes.guess\_type(filename)[0]\ \textcolor{keywordflow}{or}\ \textcolor{stringliteral}{'application/octet-\/stream'}}
\DoxyCodeLine{00536\ }
\DoxyCodeLine{00537\ }
\DoxyCodeLine{00538\ \textcolor{comment}{\#\ Use\ a\ shell\ for\ subcommands\ on\ Windows\ to\ get\ a\ PATH\ search.}}

\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceupload_acee77e89f7241bb7bad529b423123d0c_icgraph}
\end{center}
\end{figure}
\Hypertarget{namespaceupload_a9515ed0472d3989eb2b4ffb598bf4d38}\index{upload@{upload}!GetEmail@{GetEmail}}
\index{GetEmail@{GetEmail}!upload@{upload}}
\doxysubsubsection{\texorpdfstring{GetEmail()}{GetEmail()}}
{\footnotesize\ttfamily \label{namespaceupload_a9515ed0472d3989eb2b4ffb598bf4d38} 
upload.\+Get\+Email (\begin{DoxyParamCaption}\item[{}]{prompt}{}\end{DoxyParamCaption})}

\begin{DoxyVerb}Prompts the user for their email address and returns it.

The last used email address is saved to a file and offered up as a suggestion
to the user. If the user presses enter without typing in anything the last
used email address is used. If the user enters a new address, it is saved
for next time we prompt.\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{googlemock_2scripts_2upload_8py_source_l00065}{65}} of file \mbox{\hyperlink{googlemock_2scripts_2upload_8py_source}{upload.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00065\ \textcolor{keyword}{def\ }GetEmail(prompt):}
\DoxyCodeLine{00066\ \ \ \textcolor{stringliteral}{"{}"{}"{}Prompts\ the\ user\ for\ their\ email\ address\ and\ returns\ it.}}
\DoxyCodeLine{00067\ \textcolor{stringliteral}{}}
\DoxyCodeLine{00068\ \textcolor{stringliteral}{\ \ The\ last\ used\ email\ address\ is\ saved\ to\ a\ file\ and\ offered\ up\ as\ a\ suggestion}}
\DoxyCodeLine{00069\ \textcolor{stringliteral}{\ \ to\ the\ user.\ If\ the\ user\ presses\ enter\ without\ typing\ in\ anything\ the\ last}}
\DoxyCodeLine{00070\ \textcolor{stringliteral}{\ \ used\ email\ address\ is\ used.\ If\ the\ user\ enters\ a\ new\ address,\ it\ is\ saved}}
\DoxyCodeLine{00071\ \textcolor{stringliteral}{\ \ for\ next\ time\ we\ prompt.}}
\DoxyCodeLine{00072\ \textcolor{stringliteral}{}}
\DoxyCodeLine{00073\ \textcolor{stringliteral}{\ \ "{}"{}"{}}}
\DoxyCodeLine{00074\ \ \ last\_email\_file\_name\ =\ os.path.expanduser(\textcolor{stringliteral}{"{}\string~/.last\_codereview\_email\_address"{}})}
\DoxyCodeLine{00075\ \ \ last\_email\ =\ \textcolor{stringliteral}{"{}"{}}}
\DoxyCodeLine{00076\ \ \ \textcolor{keywordflow}{if}\ os.path.exists(last\_email\_file\_name):}
\DoxyCodeLine{00077\ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{00078\ \ \ \ \ \ \ last\_email\_file\ =\ open(last\_email\_file\_name,\ \textcolor{stringliteral}{"{}r"{}})}
\DoxyCodeLine{00079\ \ \ \ \ \ \ last\_email\ =\ last\_email\_file.readline().strip(\textcolor{stringliteral}{"{}\(\backslash\)n"{}})}
\DoxyCodeLine{00080\ \ \ \ \ \ \ last\_email\_file.close()}
\DoxyCodeLine{00081\ \ \ \ \ \ \ prompt\ +=\ \textcolor{stringliteral}{"{}\ [\%s]"{}}\ \%\ last\_email}
\DoxyCodeLine{00082\ \ \ \ \ \textcolor{keywordflow}{except}\ IOError,\ e:}
\DoxyCodeLine{00083\ \ \ \ \ \ \ \textcolor{keywordflow}{pass}}
\DoxyCodeLine{00084\ \ \ email\ =\ raw\_input(prompt\ +\ \textcolor{stringliteral}{"{}:\ "{}}).strip()}
\DoxyCodeLine{00085\ \ \ \textcolor{keywordflow}{if}\ email:}
\DoxyCodeLine{00086\ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{00087\ \ \ \ \ \ \ last\_email\_file\ =\ open(last\_email\_file\_name,\ \textcolor{stringliteral}{"{}w"{}})}
\DoxyCodeLine{00088\ \ \ \ \ \ \ last\_email\_file.write(email)}
\DoxyCodeLine{00089\ \ \ \ \ \ \ last\_email\_file.close()}
\DoxyCodeLine{00090\ \ \ \ \ \textcolor{keywordflow}{except}\ IOError,\ e:}
\DoxyCodeLine{00091\ \ \ \ \ \ \ \textcolor{keywordflow}{pass}}
\DoxyCodeLine{00092\ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{00093\ \ \ \ \ email\ =\ last\_email}
\DoxyCodeLine{00094\ \ \ \textcolor{keywordflow}{return}\ email}
\DoxyCodeLine{00095\ }
\DoxyCodeLine{00096\ }

\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceupload_a9515ed0472d3989eb2b4ffb598bf4d38_icgraph}
\end{center}
\end{figure}
\Hypertarget{namespaceupload_a6846c039a4f0d019180b754a2f039e2f}\index{upload@{upload}!GetRpcServer@{GetRpcServer}}
\index{GetRpcServer@{GetRpcServer}!upload@{upload}}
\doxysubsubsection{\texorpdfstring{GetRpcServer()}{GetRpcServer()}}
{\footnotesize\ttfamily \label{namespaceupload_a6846c039a4f0d019180b754a2f039e2f} 
upload.\+Get\+Rpc\+Server (\begin{DoxyParamCaption}\item[{}]{options}{}\end{DoxyParamCaption})}

\begin{DoxyVerb}Returns an instance of an AbstractRpcServer.

Returns:
  A new AbstractRpcServer, on which RPC calls can be made.
\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{googlemock_2scripts_2upload_8py_source_l00458}{458}} of file \mbox{\hyperlink{googlemock_2scripts_2upload_8py_source}{upload.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00458\ \textcolor{keyword}{def\ }GetRpcServer(options):}
\DoxyCodeLine{00459\ \ \ \textcolor{stringliteral}{"{}"{}"{}Returns\ an\ instance\ of\ an\ AbstractRpcServer.}}
\DoxyCodeLine{00460\ \textcolor{stringliteral}{}}
\DoxyCodeLine{00461\ \textcolor{stringliteral}{\ \ Returns:}}
\DoxyCodeLine{00462\ \textcolor{stringliteral}{\ \ \ \ A\ new\ AbstractRpcServer,\ on\ which\ RPC\ calls\ can\ be\ made.}}
\DoxyCodeLine{00463\ \textcolor{stringliteral}{\ \ "{}"{}"{}}}
\DoxyCodeLine{00464\ }
\DoxyCodeLine{00465\ \ \ rpc\_server\_class\ =\ HttpRpcServer}
\DoxyCodeLine{00466\ }
\DoxyCodeLine{00467\ \ \ \textcolor{keyword}{def\ }GetUserCredentials():}
\DoxyCodeLine{00468\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Prompts\ the\ user\ for\ a\ username\ and\ password."{}"{}"{}}}
\DoxyCodeLine{00469\ \ \ \ \ email\ =\ options.email}
\DoxyCodeLine{00470\ \ \ \ \ \textcolor{keywordflow}{if}\ email\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{00471\ \ \ \ \ \ \ email\ =\ GetEmail(\textcolor{stringliteral}{"{}Email\ (login\ for\ uploading\ to\ \%s)"{}}\ \%\ options.server)}
\DoxyCodeLine{00472\ \ \ \ \ password\ =\ getpass.getpass(\textcolor{stringliteral}{"{}Password\ for\ \%s:\ "{}}\ \%\ email)}
\DoxyCodeLine{00473\ \ \ \ \ \textcolor{keywordflow}{return}\ (email,\ password)}
\DoxyCodeLine{00474\ }
\DoxyCodeLine{00475\ \ \ \textcolor{comment}{\#\ If\ this\ is\ the\ dev\_appserver,\ use\ fake\ authentication.}}
\DoxyCodeLine{00476\ \ \ host\ =\ (options.host\ \textcolor{keywordflow}{or}\ options.server).lower()}
\DoxyCodeLine{00477\ \ \ \textcolor{keywordflow}{if}\ host\ ==\ \textcolor{stringliteral}{"{}localhost"{}}\ \textcolor{keywordflow}{or}\ host.startswith(\textcolor{stringliteral}{"{}localhost:"{}}):}
\DoxyCodeLine{00478\ \ \ \ \ email\ =\ options.email}
\DoxyCodeLine{00479\ \ \ \ \ \textcolor{keywordflow}{if}\ email\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{00480\ \ \ \ \ \ \ email\ =\ \textcolor{stringliteral}{"{}test@example.com"{}}}
\DoxyCodeLine{00481\ \ \ \ \ \ \ logging.info(\textcolor{stringliteral}{"{}Using\ debug\ user\ \%s.\ \ Override\ with\ -\/-\/email"{}}\ \%\ email)}
\DoxyCodeLine{00482\ \ \ \ \ server\ =\ rpc\_server\_class(}
\DoxyCodeLine{00483\ \ \ \ \ \ \ \ \ options.server,}
\DoxyCodeLine{00484\ \ \ \ \ \ \ \ \ \textcolor{keyword}{lambda}:\ (email,\ \textcolor{stringliteral}{"{}password"{}}),}
\DoxyCodeLine{00485\ \ \ \ \ \ \ \ \ host\_override=options.host,}
\DoxyCodeLine{00486\ \ \ \ \ \ \ \ \ extra\_headers=\{\textcolor{stringliteral}{"{}Cookie"{}}:}
\DoxyCodeLine{00487\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'dev\_appserver\_login="{}\%s:False"{}'}\ \%\ email\},}
\DoxyCodeLine{00488\ \ \ \ \ \ \ \ \ save\_cookies=options.save\_cookies)}
\DoxyCodeLine{00489\ \ \ \ \ \textcolor{comment}{\#\ Don't\ try\ to\ talk\ to\ ClientLogin.}}
\DoxyCodeLine{00490\ \ \ \ \ server.authenticated\ =\ \textcolor{keyword}{True}}
\DoxyCodeLine{00491\ \ \ \ \ \textcolor{keywordflow}{return}\ server}
\DoxyCodeLine{00492\ }
\DoxyCodeLine{00493\ \ \ \textcolor{keywordflow}{return}\ rpc\_server\_class(options.server,\ GetUserCredentials,}
\DoxyCodeLine{00494\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ host\_override=options.host,}
\DoxyCodeLine{00495\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ save\_cookies=options.save\_cookies)}
\DoxyCodeLine{00496\ }
\DoxyCodeLine{00497\ }

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=314pt]{namespaceupload_a6846c039a4f0d019180b754a2f039e2f_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceupload_a6846c039a4f0d019180b754a2f039e2f_icgraph}
\end{center}
\end{figure}
\Hypertarget{namespaceupload_acd3e17a78f2b4786e3ff1423f6d3c123}\index{upload@{upload}!GuessVCS@{GuessVCS}}
\index{GuessVCS@{GuessVCS}!upload@{upload}}
\doxysubsubsection{\texorpdfstring{GuessVCS()}{GuessVCS()}}
{\footnotesize\ttfamily \label{namespaceupload_acd3e17a78f2b4786e3ff1423f6d3c123} 
upload.\+Guess\+VCS (\begin{DoxyParamCaption}\item[{}]{options}{}\end{DoxyParamCaption})}

\begin{DoxyVerb}Helper to guess the version control system.

This examines the current directory, guesses which VersionControlSystem
we're using, and returns an instance of the appropriate class.  Exit with an
error if we can't figure it out.

Returns:
  A VersionControlSystem instance. Exits if the VCS can't be guessed.
\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{googlemock_2scripts_2upload_8py_source_l01209}{1209}} of file \mbox{\hyperlink{googlemock_2scripts_2upload_8py_source}{upload.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01209\ \textcolor{keyword}{def\ }GuessVCS(options):}
\DoxyCodeLine{01210\ \ \ \textcolor{stringliteral}{"{}"{}"{}Helper\ to\ guess\ the\ version\ control\ system.}}
\DoxyCodeLine{01211\ \textcolor{stringliteral}{}}
\DoxyCodeLine{01212\ \textcolor{stringliteral}{\ \ This\ examines\ the\ current\ directory,\ guesses\ which\ VersionControlSystem}}
\DoxyCodeLine{01213\ \textcolor{stringliteral}{\ \ we're\ using,\ and\ returns\ an\ instance\ of\ the\ appropriate\ class.\ \ Exit\ with\ an}}
\DoxyCodeLine{01214\ \textcolor{stringliteral}{\ \ error\ if\ we\ can't\ figure\ it\ out.}}
\DoxyCodeLine{01215\ \textcolor{stringliteral}{}}
\DoxyCodeLine{01216\ \textcolor{stringliteral}{\ \ Returns:}}
\DoxyCodeLine{01217\ \textcolor{stringliteral}{\ \ \ \ A\ VersionControlSystem\ instance.\ Exits\ if\ the\ VCS\ can't\ be\ guessed.}}
\DoxyCodeLine{01218\ \textcolor{stringliteral}{\ \ "{}"{}"{}}}
\DoxyCodeLine{01219\ \ \ \textcolor{comment}{\#\ Mercurial\ has\ a\ command\ to\ get\ the\ base\ directory\ of\ a\ repository}}
\DoxyCodeLine{01220\ \ \ \textcolor{comment}{\#\ Try\ running\ it,\ but\ don't\ die\ if\ we\ don't\ have\ hg\ installed.}}
\DoxyCodeLine{01221\ \ \ \textcolor{comment}{\#\ NOTE:\ we\ try\ Mercurial\ first\ as\ it\ can\ sit\ on\ top\ of\ an\ SVN\ working\ copy.}}
\DoxyCodeLine{01222\ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{01223\ \ \ \ \ out,\ returncode\ =\ RunShellWithReturnCode([\textcolor{stringliteral}{"{}hg"{}},\ \textcolor{stringliteral}{"{}root"{}}])}
\DoxyCodeLine{01224\ \ \ \ \ \textcolor{keywordflow}{if}\ returncode\ ==\ 0:}
\DoxyCodeLine{01225\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ MercurialVCS(options,\ out.strip())}
\DoxyCodeLine{01226\ \ \ \textcolor{keywordflow}{except}\ OSError,\ (errno,\ message):}
\DoxyCodeLine{01227\ \ \ \ \ \textcolor{keywordflow}{if}\ errno\ !=\ 2:\ \ \textcolor{comment}{\#\ ENOENT\ -\/-\/\ they\ don't\ have\ hg\ installed.}}
\DoxyCodeLine{01228\ \ \ \ \ \ \ \textcolor{keywordflow}{raise}}
\DoxyCodeLine{01229\ }
\DoxyCodeLine{01230\ \ \ \textcolor{comment}{\#\ Subversion\ has\ a\ .svn\ in\ all\ working\ directories.}}
\DoxyCodeLine{01231\ \ \ \textcolor{keywordflow}{if}\ os.path.isdir(\textcolor{stringliteral}{'.svn'}):}
\DoxyCodeLine{01232\ \ \ \ \ logging.info(\textcolor{stringliteral}{"{}Guessed\ VCS\ =\ Subversion"{}})}
\DoxyCodeLine{01233\ \ \ \ \ \textcolor{keywordflow}{return}\ SubversionVCS(options)}
\DoxyCodeLine{01234\ }
\DoxyCodeLine{01235\ \ \ \textcolor{comment}{\#\ Git\ has\ a\ command\ to\ test\ if\ you're\ in\ a\ git\ tree.}}
\DoxyCodeLine{01236\ \ \ \textcolor{comment}{\#\ Try\ running\ it,\ but\ don't\ die\ if\ we\ don't\ have\ git\ installed.}}
\DoxyCodeLine{01237\ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{01238\ \ \ \ \ out,\ returncode\ =\ RunShellWithReturnCode([\textcolor{stringliteral}{"{}git"{}},\ \textcolor{stringliteral}{"{}rev-\/parse"{}},}
\DoxyCodeLine{01239\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}-\/-\/is-\/inside-\/work-\/tree"{}}])}
\DoxyCodeLine{01240\ \ \ \ \ \textcolor{keywordflow}{if}\ returncode\ ==\ 0:}
\DoxyCodeLine{01241\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GitVCS(options)}
\DoxyCodeLine{01242\ \ \ \textcolor{keywordflow}{except}\ OSError,\ (errno,\ message):}
\DoxyCodeLine{01243\ \ \ \ \ \textcolor{keywordflow}{if}\ errno\ !=\ 2:\ \ \textcolor{comment}{\#\ ENOENT\ -\/-\/\ they\ don't\ have\ git\ installed.}}
\DoxyCodeLine{01244\ \ \ \ \ \ \ \textcolor{keywordflow}{raise}}
\DoxyCodeLine{01245\ }
\DoxyCodeLine{01246\ \ \ ErrorExit((\textcolor{stringliteral}{"{}Could\ not\ guess\ version\ control\ system.\ "{}}}
\DoxyCodeLine{01247\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Are\ you\ in\ a\ working\ copy\ directory?"{}}))}
\DoxyCodeLine{01248\ }
\DoxyCodeLine{01249\ }

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceupload_acd3e17a78f2b4786e3ff1423f6d3c123_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceupload_acd3e17a78f2b4786e3ff1423f6d3c123_icgraph}
\end{center}
\end{figure}
\Hypertarget{namespaceupload_a08415e9cf2468e18c17471151ae8c26d}\index{upload@{upload}!main@{main}}
\index{main@{main}!upload@{upload}}
\doxysubsubsection{\texorpdfstring{main()}{main()}}
{\footnotesize\ttfamily \label{namespaceupload_a08415e9cf2468e18c17471151ae8c26d} 
upload.\+main (\begin{DoxyParamCaption}\item[{void}]{}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{googlemock_2scripts_2upload_8py_source_l01377}{1377}} of file \mbox{\hyperlink{googlemock_2scripts_2upload_8py_source}{upload.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01377\ \textcolor{keyword}{def\ }\mbox{\hyperlink{platform__timer__posix__test_8c_ae66f6b31b5ad750f1fe042a706a4e3d4}{main}}():}
\DoxyCodeLine{01378\ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{01379\ \ \ \ \ RealMain(sys.argv)}
\DoxyCodeLine{01380\ \ \ \textcolor{keywordflow}{except}\ KeyboardInterrupt:}
\DoxyCodeLine{01381\ \ \ \ \ \textcolor{keywordflow}{print}}
\DoxyCodeLine{01382\ \ \ \ \ StatusUpdate(\textcolor{stringliteral}{"{}Interrupted."{}})}
\DoxyCodeLine{01383\ \ \ \ \ sys.exit(1)}
\DoxyCodeLine{01384\ }
\DoxyCodeLine{01385\ }

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceupload_a08415e9cf2468e18c17471151ae8c26d_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceupload_a08415e9cf2468e18c17471151ae8c26d_icgraph}
\end{center}
\end{figure}
\Hypertarget{namespaceupload_ad57cf4d14059e0f18689efa2ea7c368b}\index{upload@{upload}!RealMain@{RealMain}}
\index{RealMain@{RealMain}!upload@{upload}}
\doxysubsubsection{\texorpdfstring{RealMain()}{RealMain()}}
{\footnotesize\ttfamily \label{namespaceupload_ad57cf4d14059e0f18689efa2ea7c368b} 
upload.\+Real\+Main (\begin{DoxyParamCaption}\item[{}]{argv}{, }\item[{}]{data}{ = {\ttfamily None}}\end{DoxyParamCaption})}

\begin{DoxyVerb}The real main function.

Args:
  argv: Command line arguments.
  data: Diff contents. If None (default) the diff is generated by
    the VersionControlSystem implementation returned by GuessVCS().

Returns:
  A 2-tuple (issue id, patchset id).
  The patchset id is None if the base files are not uploaded by this
  script (applies only to SVN checkouts).
\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{googlemock_2scripts_2upload_8py_source_l01250}{1250}} of file \mbox{\hyperlink{googlemock_2scripts_2upload_8py_source}{upload.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01250\ \textcolor{keyword}{def\ }RealMain(argv,\ data=None):}
\DoxyCodeLine{01251\ \ \ \textcolor{stringliteral}{"{}"{}"{}The\ real\ main\ function.}}
\DoxyCodeLine{01252\ \textcolor{stringliteral}{}}
\DoxyCodeLine{01253\ \textcolor{stringliteral}{\ \ Args:}}
\DoxyCodeLine{01254\ \textcolor{stringliteral}{\ \ \ \ argv:\ Command\ line\ arguments.}}
\DoxyCodeLine{01255\ \textcolor{stringliteral}{\ \ \ \ data:\ Diff\ contents.\ If\ None\ (default)\ the\ diff\ is\ generated\ by}}
\DoxyCodeLine{01256\ \textcolor{stringliteral}{\ \ \ \ \ \ the\ VersionControlSystem\ implementation\ returned\ by\ GuessVCS().}}
\DoxyCodeLine{01257\ \textcolor{stringliteral}{}}
\DoxyCodeLine{01258\ \textcolor{stringliteral}{\ \ Returns:}}
\DoxyCodeLine{01259\ \textcolor{stringliteral}{\ \ \ \ A\ 2-\/tuple\ (issue\ id,\ patchset\ id).}}
\DoxyCodeLine{01260\ \textcolor{stringliteral}{\ \ \ \ The\ patchset\ id\ is\ None\ if\ the\ base\ files\ are\ not\ uploaded\ by\ this}}
\DoxyCodeLine{01261\ \textcolor{stringliteral}{\ \ \ \ script\ (applies\ only\ to\ SVN\ checkouts).}}
\DoxyCodeLine{01262\ \textcolor{stringliteral}{\ \ "{}"{}"{}}}
\DoxyCodeLine{01263\ \ \ logging.basicConfig(format=(\textcolor{stringliteral}{"{}\%(asctime).19s\ \%(levelname)s\ \%(filename)s:"{}}}
\DoxyCodeLine{01264\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\%(lineno)s\ \%(message)s\ "{}}))}
\DoxyCodeLine{01265\ \ \ os.environ[\textcolor{stringliteral}{'LC\_ALL'}]\ =\ \textcolor{stringliteral}{'C'}}
\DoxyCodeLine{01266\ \ \ options,\ args\ =\ parser.parse\_args(argv[1:])}
\DoxyCodeLine{01267\ \ \ \textcolor{keyword}{global}\ verbosity}
\DoxyCodeLine{01268\ \ \ verbosity\ =\ options.verbose}
\DoxyCodeLine{01269\ \ \ \textcolor{keywordflow}{if}\ verbosity\ >=\ 3:}
\DoxyCodeLine{01270\ \ \ \ \ logging.getLogger().setLevel(logging.DEBUG)}
\DoxyCodeLine{01271\ \ \ \textcolor{keywordflow}{elif}\ verbosity\ >=\ 2:}
\DoxyCodeLine{01272\ \ \ \ \ logging.getLogger().setLevel(logging.INFO)}
\DoxyCodeLine{01273\ \ \ vcs\ =\ GuessVCS(options)}
\DoxyCodeLine{01274\ \ \ \textcolor{keywordflow}{if}\ isinstance(vcs,\ SubversionVCS):}
\DoxyCodeLine{01275\ \ \ \ \ \textcolor{comment}{\#\ base\ field\ is\ only\ allowed\ for\ Subversion.}}
\DoxyCodeLine{01276\ \ \ \ \ \textcolor{comment}{\#\ Note:\ Fetching\ base\ files\ may\ become\ deprecated\ in\ future\ releases.}}
\DoxyCodeLine{01277\ \ \ \ \ base\ =\ vcs.GuessBase(options.download\_base)}
\DoxyCodeLine{01278\ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{01279\ \ \ \ \ base\ =\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{01280\ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ base\ \textcolor{keywordflow}{and}\ options.download\_base:}
\DoxyCodeLine{01281\ \ \ \ \ options.download\_base\ =\ \textcolor{keyword}{True}}
\DoxyCodeLine{01282\ \ \ \ \ logging.info(\textcolor{stringliteral}{"{}Enabled\ upload\ of\ base\ file"{}})}
\DoxyCodeLine{01283\ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ options.assume\_yes:}
\DoxyCodeLine{01284\ \ \ \ \ vcs.CheckForUnknownFiles()}
\DoxyCodeLine{01285\ \ \ \textcolor{keywordflow}{if}\ data\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{01286\ \ \ \ \ data\ =\ vcs.GenerateDiff(args)}
\DoxyCodeLine{01287\ \ \ files\ =\ vcs.GetBaseFiles(data)}
\DoxyCodeLine{01288\ \ \ \textcolor{keywordflow}{if}\ verbosity\ >=\ 1:}
\DoxyCodeLine{01289\ \ \ \ \ \textcolor{keywordflow}{print}\ \textcolor{stringliteral}{"{}Upload\ server:"{}},\ options.server,\ \textcolor{stringliteral}{"{}(change\ with\ -\/s/-\/-\/server)"{}}}
\DoxyCodeLine{01290\ \ \ \textcolor{keywordflow}{if}\ options.issue:}
\DoxyCodeLine{01291\ \ \ \ \ prompt\ =\ \textcolor{stringliteral}{"{}Message\ describing\ this\ patch\ set:\ "{}}}
\DoxyCodeLine{01292\ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{01293\ \ \ \ \ prompt\ =\ \textcolor{stringliteral}{"{}New\ issue\ subject:\ "{}}}
\DoxyCodeLine{01294\ \ \ message\ =\ options.message\ \textcolor{keywordflow}{or}\ raw\_input(prompt).strip()}
\DoxyCodeLine{01295\ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ message:}
\DoxyCodeLine{01296\ \ \ \ \ ErrorExit(\textcolor{stringliteral}{"{}A\ non-\/empty\ message\ is\ required"{}})}
\DoxyCodeLine{01297\ \ \ rpc\_server\ =\ GetRpcServer(options)}
\DoxyCodeLine{01298\ \ \ form\_fields\ =\ [(\textcolor{stringliteral}{"{}subject"{}},\ message)]}
\DoxyCodeLine{01299\ \ \ \textcolor{keywordflow}{if}\ base:}
\DoxyCodeLine{01300\ \ \ \ \ form\_fields.append((\textcolor{stringliteral}{"{}base"{}},\ base))}
\DoxyCodeLine{01301\ \ \ \textcolor{keywordflow}{if}\ options.issue:}
\DoxyCodeLine{01302\ \ \ \ \ form\_fields.append((\textcolor{stringliteral}{"{}issue"{}},\ str(options.issue)))}
\DoxyCodeLine{01303\ \ \ \textcolor{keywordflow}{if}\ options.email:}
\DoxyCodeLine{01304\ \ \ \ \ form\_fields.append((\textcolor{stringliteral}{"{}user"{}},\ options.email))}
\DoxyCodeLine{01305\ \ \ \textcolor{keywordflow}{if}\ options.reviewers:}
\DoxyCodeLine{01306\ \ \ \ \ \textcolor{keywordflow}{for}\ reviewer\ \textcolor{keywordflow}{in}\ options.reviewers.split(\textcolor{stringliteral}{','}):}
\DoxyCodeLine{01307\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{stringliteral}{"{}@"{}}\ \textcolor{keywordflow}{in}\ reviewer\ \textcolor{keywordflow}{and}\ \textcolor{keywordflow}{not}\ reviewer.split(\textcolor{stringliteral}{"{}@"{}})[1].\mbox{\hyperlink{gmock__stress__test_8cc_afd9db40e3361ae09188795e8cbe19752}{count}}(\textcolor{stringliteral}{"{}."{}})\ ==\ 1:}
\DoxyCodeLine{01308\ \ \ \ \ \ \ \ \ ErrorExit(\textcolor{stringliteral}{"{}Invalid\ email\ address:\ \%s"{}}\ \%\ reviewer)}
\DoxyCodeLine{01309\ \ \ \ \ form\_fields.append((\textcolor{stringliteral}{"{}reviewers"{}},\ options.reviewers))}
\DoxyCodeLine{01310\ \ \ \textcolor{keywordflow}{if}\ options.cc:}
\DoxyCodeLine{01311\ \ \ \ \ \textcolor{keywordflow}{for}\ cc\ \textcolor{keywordflow}{in}\ options.cc.split(\textcolor{stringliteral}{','}):}
\DoxyCodeLine{01312\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{stringliteral}{"{}@"{}}\ \textcolor{keywordflow}{in}\ cc\ \textcolor{keywordflow}{and}\ \textcolor{keywordflow}{not}\ cc.split(\textcolor{stringliteral}{"{}@"{}})[1].\mbox{\hyperlink{gmock__stress__test_8cc_afd9db40e3361ae09188795e8cbe19752}{count}}(\textcolor{stringliteral}{"{}."{}})\ ==\ 1:}
\DoxyCodeLine{01313\ \ \ \ \ \ \ \ \ ErrorExit(\textcolor{stringliteral}{"{}Invalid\ email\ address:\ \%s"{}}\ \%\ cc)}
\DoxyCodeLine{01314\ \ \ \ \ form\_fields.append((\textcolor{stringliteral}{"{}cc"{}},\ options.cc))}
\DoxyCodeLine{01315\ \ \ description\ =\ options.description}
\DoxyCodeLine{01316\ \ \ \textcolor{keywordflow}{if}\ options.description\_file:}
\DoxyCodeLine{01317\ \ \ \ \ \textcolor{keywordflow}{if}\ options.description:}
\DoxyCodeLine{01318\ \ \ \ \ \ \ ErrorExit(\textcolor{stringliteral}{"{}Can't\ specify\ description\ and\ description\_file"{}})}
\DoxyCodeLine{01319\ \ \ \ \ file\ =\ open(options.description\_file,\ \textcolor{stringliteral}{'r'})}
\DoxyCodeLine{01320\ \ \ \ \ description\ =\ file.read()}
\DoxyCodeLine{01321\ \ \ \ \ file.close()}
\DoxyCodeLine{01322\ \ \ \textcolor{keywordflow}{if}\ description:}
\DoxyCodeLine{01323\ \ \ \ \ form\_fields.append((\textcolor{stringliteral}{"{}description"{}},\ description))}
\DoxyCodeLine{01324\ \ \ \textcolor{comment}{\#\ Send\ a\ hash\ of\ all\ the\ base\ file\ so\ the\ server\ can\ determine\ if\ a\ copy}}
\DoxyCodeLine{01325\ \ \ \textcolor{comment}{\#\ already\ exists\ in\ an\ earlier\ patchset.}}
\DoxyCodeLine{01326\ \ \ base\_hashes\ =\ \textcolor{stringliteral}{"{}"{}}}
\DoxyCodeLine{01327\ \ \ \textcolor{keywordflow}{for}\ file,\ info\ \textcolor{keywordflow}{in}\ files.iteritems():}
\DoxyCodeLine{01328\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ info[0]\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{01329\ \ \ \ \ \ \ checksum\ =\ md5.new(info[0]).hexdigest()}
\DoxyCodeLine{01330\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ base\_hashes:}
\DoxyCodeLine{01331\ \ \ \ \ \ \ \ \ base\_hashes\ +=\ \textcolor{stringliteral}{"{}|"{}}}
\DoxyCodeLine{01332\ \ \ \ \ \ \ base\_hashes\ +=\ checksum\ +\ \textcolor{stringliteral}{"{}:"{}}\ +\ file}
\DoxyCodeLine{01333\ \ \ form\_fields.append((\textcolor{stringliteral}{"{}base\_hashes"{}},\ base\_hashes))}
\DoxyCodeLine{01334\ \ \ \textcolor{comment}{\#\ If\ we're\ uploading\ base\ files,\ don't\ send\ the\ email\ before\ the\ uploads,\ so}}
\DoxyCodeLine{01335\ \ \ \textcolor{comment}{\#\ that\ it\ contains\ the\ file\ status.}}
\DoxyCodeLine{01336\ \ \ \textcolor{keywordflow}{if}\ options.send\_mail\ \textcolor{keywordflow}{and}\ options.download\_base:}
\DoxyCodeLine{01337\ \ \ \ \ form\_fields.append((\textcolor{stringliteral}{"{}send\_mail"{}},\ \textcolor{stringliteral}{"{}1"{}}))}
\DoxyCodeLine{01338\ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ options.download\_base:}
\DoxyCodeLine{01339\ \ \ \ \ form\_fields.append((\textcolor{stringliteral}{"{}content\_upload"{}},\ \textcolor{stringliteral}{"{}1"{}}))}
\DoxyCodeLine{01340\ \ \ \textcolor{keywordflow}{if}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a7360b55975153b822efc5217b7734e6a}{len}}(data)\ >\ MAX\_UPLOAD\_SIZE:}
\DoxyCodeLine{01341\ \ \ \ \ \textcolor{keywordflow}{print}\ \textcolor{stringliteral}{"{}Patch\ is\ large,\ so\ uploading\ file\ patches\ separately."{}}}
\DoxyCodeLine{01342\ \ \ \ \ uploaded\_diff\_file\ =\ []}
\DoxyCodeLine{01343\ \ \ \ \ form\_fields.append((\textcolor{stringliteral}{"{}separate\_patches"{}},\ \textcolor{stringliteral}{"{}1"{}}))}
\DoxyCodeLine{01344\ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{01345\ \ \ \ \ uploaded\_diff\_file\ =\ [(\textcolor{stringliteral}{"{}data"{}},\ \textcolor{stringliteral}{"{}data.diff"{}},\ data)]}
\DoxyCodeLine{01346\ \ \ ctype,\ body\ =\ EncodeMultipartFormData(form\_fields,\ uploaded\_diff\_file)}
\DoxyCodeLine{01347\ \ \ response\_body\ =\ rpc\_server.Send(\textcolor{stringliteral}{"{}/upload"{}},\ body,\ content\_type=ctype)}
\DoxyCodeLine{01348\ \ \ patchset\ =\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{01349\ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ options.download\_base\ \textcolor{keywordflow}{or}\ \textcolor{keywordflow}{not}\ uploaded\_diff\_file:}
\DoxyCodeLine{01350\ \ \ \ \ lines\ =\ response\_body.splitlines()}
\DoxyCodeLine{01351\ \ \ \ \ \textcolor{keywordflow}{if}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a7360b55975153b822efc5217b7734e6a}{len}}(lines)\ >=\ 2:}
\DoxyCodeLine{01352\ \ \ \ \ \ \ msg\ =\ lines[0]}
\DoxyCodeLine{01353\ \ \ \ \ \ \ patchset\ =\ lines[1].strip()}
\DoxyCodeLine{01354\ \ \ \ \ \ \ patches\ =\ [x.split(\textcolor{stringliteral}{"{}\ "{}},\ 1)\ \textcolor{keywordflow}{for}\ x\ \textcolor{keywordflow}{in}\ lines[2:]]}
\DoxyCodeLine{01355\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{01356\ \ \ \ \ \ \ msg\ =\ response\_body}
\DoxyCodeLine{01357\ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{01358\ \ \ \ \ msg\ =\ response\_body}
\DoxyCodeLine{01359\ \ \ StatusUpdate(msg)}
\DoxyCodeLine{01360\ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ response\_body.startswith(\textcolor{stringliteral}{"{}Issue\ created."{}})\ \textcolor{keywordflow}{and}\ \(\backslash\)}
\DoxyCodeLine{01361\ \ \ \textcolor{keywordflow}{not}\ response\_body.startswith(\textcolor{stringliteral}{"{}Issue\ updated."{}}):}
\DoxyCodeLine{01362\ \ \ \ \ sys.exit(0)}
\DoxyCodeLine{01363\ \ \ issue\ =\ msg[msg.rfind(\textcolor{stringliteral}{"{}/"{}})+1:]}
\DoxyCodeLine{01364\ }
\DoxyCodeLine{01365\ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ uploaded\_diff\_file:}
\DoxyCodeLine{01366\ \ \ \ \ result\ =\ UploadSeparatePatches(issue,\ rpc\_server,\ patchset,\ data,\ options)}
\DoxyCodeLine{01367\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ options.download\_base:}
\DoxyCodeLine{01368\ \ \ \ \ \ \ patches\ =\ result}
\DoxyCodeLine{01369\ }
\DoxyCodeLine{01370\ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ options.download\_base:}
\DoxyCodeLine{01371\ \ \ \ \ vcs.UploadBaseFiles(issue,\ rpc\_server,\ patches,\ patchset,\ options,\ files)}
\DoxyCodeLine{01372\ \ \ \ \ \textcolor{keywordflow}{if}\ options.send\_mail:}
\DoxyCodeLine{01373\ \ \ \ \ \ \ rpc\_server.Send(\textcolor{stringliteral}{"{}/"{}}\ +\ issue\ +\ \textcolor{stringliteral}{"{}/mail"{}},\ payload=\textcolor{stringliteral}{"{}"{}})}
\DoxyCodeLine{01374\ \ \ \textcolor{keywordflow}{return}\ issue,\ patchset}
\DoxyCodeLine{01375\ }
\DoxyCodeLine{01376\ }

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceupload_ad57cf4d14059e0f18689efa2ea7c368b_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceupload_ad57cf4d14059e0f18689efa2ea7c368b_icgraph}
\end{center}
\end{figure}
\Hypertarget{namespaceupload_adc4aea7c4a79d29dfab04f650c274fdb}\index{upload@{upload}!RunShell@{RunShell}}
\index{RunShell@{RunShell}!upload@{upload}}
\doxysubsubsection{\texorpdfstring{RunShell()}{RunShell()}}
{\footnotesize\ttfamily \label{namespaceupload_adc4aea7c4a79d29dfab04f650c274fdb} 
upload.\+Run\+Shell (\begin{DoxyParamCaption}\item[{}]{command}{, }\item[{}]{silent\+\_\+ok}{ = {\ttfamily False}, }\item[{}]{universal\+\_\+newlines}{ = {\ttfamily True}, }\item[{}]{print\+\_\+output}{ = {\ttfamily False}}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{googlemock_2scripts_2upload_8py_source_l00577}{577}} of file \mbox{\hyperlink{googlemock_2scripts_2upload_8py_source}{upload.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00578\ \ \ \ \ \ \ \ \ \ \ \ \ \ print\_output=\textcolor{keyword}{False}):}
\DoxyCodeLine{00579\ \ \ data,\ retcode\ =\ RunShellWithReturnCode(command,\ print\_output,}
\DoxyCodeLine{00580\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ universal\_newlines)}
\DoxyCodeLine{00581\ \ \ \textcolor{keywordflow}{if}\ retcode:}
\DoxyCodeLine{00582\ \ \ \ \ ErrorExit(\textcolor{stringliteral}{"{}Got\ error\ status\ from\ \%s:\(\backslash\)n\%s"{}}\ \%\ (command,\ data))}
\DoxyCodeLine{00583\ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ silent\_ok\ \textcolor{keywordflow}{and}\ \textcolor{keywordflow}{not}\ data:}
\DoxyCodeLine{00584\ \ \ \ \ ErrorExit(\textcolor{stringliteral}{"{}No\ output\ from\ \%s"{}}\ \%\ command)}
\DoxyCodeLine{00585\ \ \ \textcolor{keywordflow}{return}\ data}
\DoxyCodeLine{00586\ }
\DoxyCodeLine{00587\ }

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceupload_adc4aea7c4a79d29dfab04f650c274fdb_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceupload_adc4aea7c4a79d29dfab04f650c274fdb_icgraph}
\end{center}
\end{figure}
\Hypertarget{namespaceupload_aaf7f85c895770c6aba543e1bf57533ae}\index{upload@{upload}!RunShellWithReturnCode@{RunShellWithReturnCode}}
\index{RunShellWithReturnCode@{RunShellWithReturnCode}!upload@{upload}}
\doxysubsubsection{\texorpdfstring{RunShellWithReturnCode()}{RunShellWithReturnCode()}}
{\footnotesize\ttfamily \label{namespaceupload_aaf7f85c895770c6aba543e1bf57533ae} 
upload.\+Run\+Shell\+With\+Return\+Code (\begin{DoxyParamCaption}\item[{}]{command}{, }\item[{}]{print\+\_\+output}{ = {\ttfamily False}, }\item[{}]{universal\+\_\+newlines}{ = {\ttfamily True}}\end{DoxyParamCaption})}

\begin{DoxyVerb}Executes a command and returns the output from stdout and the return code.

Args:
  command: Command to execute.
  print_output: If True, the output is printed to stdout.
                If False, both stdout and stderr are ignored.
  universal_newlines: Use universal_newlines flag (default: True).

Returns:
  Tuple (output, return code)
\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{googlemock_2scripts_2upload_8py_source_l00541}{541}} of file \mbox{\hyperlink{googlemock_2scripts_2upload_8py_source}{upload.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00542\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ universal\_newlines=\textcolor{keyword}{True}):}
\DoxyCodeLine{00543\ \ \ \textcolor{stringliteral}{"{}"{}"{}Executes\ a\ command\ and\ returns\ the\ output\ from\ stdout\ and\ the\ return\ code.}}
\DoxyCodeLine{00544\ \textcolor{stringliteral}{}}
\DoxyCodeLine{00545\ \textcolor{stringliteral}{\ \ Args:}}
\DoxyCodeLine{00546\ \textcolor{stringliteral}{\ \ \ \ command:\ Command\ to\ execute.}}
\DoxyCodeLine{00547\ \textcolor{stringliteral}{\ \ \ \ print\_output:\ If\ True,\ the\ output\ is\ printed\ to\ stdout.}}
\DoxyCodeLine{00548\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ If\ False,\ both\ stdout\ and\ stderr\ are\ ignored.}}
\DoxyCodeLine{00549\ \textcolor{stringliteral}{\ \ \ \ universal\_newlines:\ Use\ universal\_newlines\ flag\ (default:\ True).}}
\DoxyCodeLine{00550\ \textcolor{stringliteral}{}}
\DoxyCodeLine{00551\ \textcolor{stringliteral}{\ \ Returns:}}
\DoxyCodeLine{00552\ \textcolor{stringliteral}{\ \ \ \ Tuple\ (output,\ return\ code)}}
\DoxyCodeLine{00553\ \textcolor{stringliteral}{\ \ "{}"{}"{}}}
\DoxyCodeLine{00554\ \ \ logging.info(\textcolor{stringliteral}{"{}Running\ \%s"{}},\ command)}
\DoxyCodeLine{00555\ \ \ p\ =\ subprocess.Popen(command,\ stdout=subprocess.PIPE,\ stderr=subprocess.PIPE,}
\DoxyCodeLine{00556\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ shell=use\_shell,\ universal\_newlines=universal\_newlines)}
\DoxyCodeLine{00557\ \ \ \textcolor{keywordflow}{if}\ print\_output:}
\DoxyCodeLine{00558\ \ \ \ \ output\_array\ =\ []}
\DoxyCodeLine{00559\ \ \ \ \ \textcolor{keywordflow}{while}\ \textcolor{keyword}{True}:}
\DoxyCodeLine{00560\ \ \ \ \ \ \ line\ =\ p.stdout.readline()}
\DoxyCodeLine{00561\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ line:}
\DoxyCodeLine{00562\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break}}
\DoxyCodeLine{00563\ \ \ \ \ \ \ \textcolor{keywordflow}{print}\ line.strip(\textcolor{stringliteral}{"{}\(\backslash\)n"{}})}
\DoxyCodeLine{00564\ \ \ \ \ \ \ output\_array.append(line)}
\DoxyCodeLine{00565\ \ \ \ \ output\ =\ \textcolor{stringliteral}{"{}"{}}.join(output\_array)}
\DoxyCodeLine{00566\ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{00567\ \ \ \ \ output\ =\ p.stdout.read()}
\DoxyCodeLine{00568\ \ \ p.wait()}
\DoxyCodeLine{00569\ \ \ errout\ =\ p.stderr.read()}
\DoxyCodeLine{00570\ \ \ \textcolor{keywordflow}{if}\ print\_output\ \textcolor{keywordflow}{and}\ errout:}
\DoxyCodeLine{00571\ \ \ \ \ \textcolor{keywordflow}{print}\ >>sys.stderr,\ errout}
\DoxyCodeLine{00572\ \ \ p.stdout.close()}
\DoxyCodeLine{00573\ \ \ p.stderr.close()}
\DoxyCodeLine{00574\ \ \ \textcolor{keywordflow}{return}\ output,\ p.returncode}
\DoxyCodeLine{00575\ }
\DoxyCodeLine{00576\ }

\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceupload_aaf7f85c895770c6aba543e1bf57533ae_icgraph}
\end{center}
\end{figure}
\Hypertarget{namespaceupload_ad086545a31d32684cc46db8d911c5dd9}\index{upload@{upload}!SplitPatch@{SplitPatch}}
\index{SplitPatch@{SplitPatch}!upload@{upload}}
\doxysubsubsection{\texorpdfstring{SplitPatch()}{SplitPatch()}}
{\footnotesize\ttfamily \label{namespaceupload_ad086545a31d32684cc46db8d911c5dd9} 
upload.\+Split\+Patch (\begin{DoxyParamCaption}\item[{}]{data}{}\end{DoxyParamCaption})}

\begin{DoxyVerb}Splits a patch into separate pieces for each file.

Args:
  data: A string containing the output of svn diff.

Returns:
  A list of 2-tuple (filename, text) where text is the svn diff output
    pertaining to filename.
\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{googlemock_2scripts_2upload_8py_source_l01141}{1141}} of file \mbox{\hyperlink{googlemock_2scripts_2upload_8py_source}{upload.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01141\ \textcolor{keyword}{def\ }SplitPatch(data):}
\DoxyCodeLine{01142\ \ \ \textcolor{stringliteral}{"{}"{}"{}Splits\ a\ patch\ into\ separate\ pieces\ for\ each\ file.}}
\DoxyCodeLine{01143\ \textcolor{stringliteral}{}}
\DoxyCodeLine{01144\ \textcolor{stringliteral}{\ \ Args:}}
\DoxyCodeLine{01145\ \textcolor{stringliteral}{\ \ \ \ data:\ A\ string\ containing\ the\ output\ of\ svn\ diff.}}
\DoxyCodeLine{01146\ \textcolor{stringliteral}{}}
\DoxyCodeLine{01147\ \textcolor{stringliteral}{\ \ Returns:}}
\DoxyCodeLine{01148\ \textcolor{stringliteral}{\ \ \ \ A\ list\ of\ 2-\/tuple\ (filename,\ text)\ where\ text\ is\ the\ svn\ diff\ output}}
\DoxyCodeLine{01149\ \textcolor{stringliteral}{\ \ \ \ \ \ pertaining\ to\ filename.}}
\DoxyCodeLine{01150\ \textcolor{stringliteral}{\ \ "{}"{}"{}}}
\DoxyCodeLine{01151\ \ \ patches\ =\ []}
\DoxyCodeLine{01152\ \ \ filename\ =\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{01153\ \ \ diff\ =\ []}
\DoxyCodeLine{01154\ \ \ \textcolor{keywordflow}{for}\ line\ \textcolor{keywordflow}{in}\ data.splitlines(\textcolor{keyword}{True}):}
\DoxyCodeLine{01155\ \ \ \ \ new\_filename\ =\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{01156\ \ \ \ \ \textcolor{keywordflow}{if}\ line.startswith(\textcolor{stringliteral}{'Index:'}):}
\DoxyCodeLine{01157\ \ \ \ \ \ \ unused,\ new\_filename\ =\ line.split(\textcolor{stringliteral}{':'},\ 1)}
\DoxyCodeLine{01158\ \ \ \ \ \ \ new\_filename\ =\ new\_filename.strip()}
\DoxyCodeLine{01159\ \ \ \ \ \textcolor{keywordflow}{elif}\ line.startswith(\textcolor{stringliteral}{'Property\ changes\ on:'}):}
\DoxyCodeLine{01160\ \ \ \ \ \ \ unused,\ temp\_filename\ =\ line.split(\textcolor{stringliteral}{':'},\ 1)}
\DoxyCodeLine{01161\ \ \ \ \ \ \ \textcolor{comment}{\#\ When\ a\ file\ is\ modified,\ paths\ use\ '/'\ between\ directories,\ however}}
\DoxyCodeLine{01162\ \ \ \ \ \ \ \textcolor{comment}{\#\ when\ a\ property\ is\ modified\ '\(\backslash\)'\ is\ used\ on\ Windows.\ \ Make\ them\ the\ same}}
\DoxyCodeLine{01163\ \ \ \ \ \ \ \textcolor{comment}{\#\ otherwise\ the\ file\ shows\ up\ twice.}}
\DoxyCodeLine{01164\ \ \ \ \ \ \ temp\_filename\ =\ temp\_filename.strip().replace(\textcolor{stringliteral}{'\(\backslash\)\(\backslash\)'},\ \textcolor{stringliteral}{'/'})}
\DoxyCodeLine{01165\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ temp\_filename\ !=\ filename:}
\DoxyCodeLine{01166\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ File\ has\ property\ changes\ but\ no\ modifications,\ create\ a\ new\ diff.}}
\DoxyCodeLine{01167\ \ \ \ \ \ \ \ \ new\_filename\ =\ temp\_filename}
\DoxyCodeLine{01168\ \ \ \ \ \textcolor{keywordflow}{if}\ new\_filename:}
\DoxyCodeLine{01169\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ filename\ \textcolor{keywordflow}{and}\ diff:}
\DoxyCodeLine{01170\ \ \ \ \ \ \ \ \ patches.append((filename,\ \textcolor{stringliteral}{''}.join(diff)))}
\DoxyCodeLine{01171\ \ \ \ \ \ \ filename\ =\ new\_filename}
\DoxyCodeLine{01172\ \ \ \ \ \ \ diff\ =\ [line]}
\DoxyCodeLine{01173\ \ \ \ \ \ \ \textcolor{keywordflow}{continue}}
\DoxyCodeLine{01174\ \ \ \ \ \textcolor{keywordflow}{if}\ diff\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{01175\ \ \ \ \ \ \ diff.append(line)}
\DoxyCodeLine{01176\ \ \ \textcolor{keywordflow}{if}\ filename\ \textcolor{keywordflow}{and}\ diff:}
\DoxyCodeLine{01177\ \ \ \ \ patches.append((filename,\ \textcolor{stringliteral}{''}.join(diff)))}
\DoxyCodeLine{01178\ \ \ \textcolor{keywordflow}{return}\ patches}
\DoxyCodeLine{01179\ }
\DoxyCodeLine{01180\ }

\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceupload_ad086545a31d32684cc46db8d911c5dd9_icgraph}
\end{center}
\end{figure}
\Hypertarget{namespaceupload_ace7b6cbe630726762d0d876fc7e756a2}\index{upload@{upload}!StatusUpdate@{StatusUpdate}}
\index{StatusUpdate@{StatusUpdate}!upload@{upload}}
\doxysubsubsection{\texorpdfstring{StatusUpdate()}{StatusUpdate()}}
{\footnotesize\ttfamily \label{namespaceupload_ace7b6cbe630726762d0d876fc7e756a2} 
upload.\+Status\+Update (\begin{DoxyParamCaption}\item[{}]{msg}{}\end{DoxyParamCaption})}

\begin{DoxyVerb}Print a status message to stdout.

If 'verbosity' is greater than 0, print the message.

Args:
  msg: The string to print.
\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{googlemock_2scripts_2upload_8py_source_l00097}{97}} of file \mbox{\hyperlink{googlemock_2scripts_2upload_8py_source}{upload.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00097\ \textcolor{keyword}{def\ }StatusUpdate(msg):}
\DoxyCodeLine{00098\ \ \ \textcolor{stringliteral}{"{}"{}"{}Print\ a\ status\ message\ to\ stdout.}}
\DoxyCodeLine{00099\ \textcolor{stringliteral}{}}
\DoxyCodeLine{00100\ \textcolor{stringliteral}{\ \ If\ 'verbosity'\ is\ greater\ than\ 0,\ print\ the\ message.}}
\DoxyCodeLine{00101\ \textcolor{stringliteral}{}}
\DoxyCodeLine{00102\ \textcolor{stringliteral}{\ \ Args:}}
\DoxyCodeLine{00103\ \textcolor{stringliteral}{\ \ \ \ msg:\ The\ string\ to\ print.}}
\DoxyCodeLine{00104\ \textcolor{stringliteral}{\ \ "{}"{}"{}}}
\DoxyCodeLine{00105\ \ \ \textcolor{keywordflow}{if}\ verbosity\ >\ 0:}
\DoxyCodeLine{00106\ \ \ \ \ \textcolor{keywordflow}{print}\ msg}
\DoxyCodeLine{00107\ }
\DoxyCodeLine{00108\ }

\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceupload_ace7b6cbe630726762d0d876fc7e756a2_icgraph}
\end{center}
\end{figure}
\Hypertarget{namespaceupload_a911c98a64378a566a42ed6758245ef22}\index{upload@{upload}!UploadSeparatePatches@{UploadSeparatePatches}}
\index{UploadSeparatePatches@{UploadSeparatePatches}!upload@{upload}}
\doxysubsubsection{\texorpdfstring{UploadSeparatePatches()}{UploadSeparatePatches()}}
{\footnotesize\ttfamily \label{namespaceupload_a911c98a64378a566a42ed6758245ef22} 
upload.\+Upload\+Separate\+Patches (\begin{DoxyParamCaption}\item[{}]{issue}{, }\item[{}]{rpc\+\_\+server}{, }\item[{}]{patchset}{, }\item[{}]{data}{, }\item[{}]{options}{}\end{DoxyParamCaption})}

\begin{DoxyVerb}Uploads a separate patch for each file in the diff output.

Returns a list of [patch_key, filename] for each file.
\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{googlemock_2scripts_2upload_8py_source_l01181}{1181}} of file \mbox{\hyperlink{googlemock_2scripts_2upload_8py_source}{upload.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01181\ \textcolor{keyword}{def\ }UploadSeparatePatches(issue,\ rpc\_server,\ patchset,\ data,\ options):}
\DoxyCodeLine{01182\ \ \ \textcolor{stringliteral}{"{}"{}"{}Uploads\ a\ separate\ patch\ for\ each\ file\ in\ the\ diff\ output.}}
\DoxyCodeLine{01183\ \textcolor{stringliteral}{}}
\DoxyCodeLine{01184\ \textcolor{stringliteral}{\ \ Returns\ a\ list\ of\ [patch\_key,\ filename]\ for\ each\ file.}}
\DoxyCodeLine{01185\ \textcolor{stringliteral}{\ \ "{}"{}"{}}}
\DoxyCodeLine{01186\ \ \ patches\ =\ SplitPatch(data)}
\DoxyCodeLine{01187\ \ \ rv\ =\ []}
\DoxyCodeLine{01188\ \ \ \textcolor{keywordflow}{for}\ patch\ \textcolor{keywordflow}{in}\ patches:}
\DoxyCodeLine{01189\ \ \ \ \ \textcolor{keywordflow}{if}\ \mbox{\hyperlink{yubihsm__pkcs11_8c_a7360b55975153b822efc5217b7734e6a}{len}}(patch[1])\ >\ MAX\_UPLOAD\_SIZE:}
\DoxyCodeLine{01190\ \ \ \ \ \ \ \textcolor{keywordflow}{print}\ (\textcolor{stringliteral}{"{}Not\ uploading\ the\ patch\ for\ "{}}\ +\ patch[0]\ +}
\DoxyCodeLine{01191\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\ because\ the\ file\ is\ too\ large."{}})}
\DoxyCodeLine{01192\ \ \ \ \ \ \ \textcolor{keywordflow}{continue}}
\DoxyCodeLine{01193\ \ \ \ \ form\_fields\ =\ [(\textcolor{stringliteral}{"{}filename"{}},\ patch[0])]}
\DoxyCodeLine{01194\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ options.download\_base:}
\DoxyCodeLine{01195\ \ \ \ \ \ \ form\_fields.append((\textcolor{stringliteral}{"{}content\_upload"{}},\ \textcolor{stringliteral}{"{}1"{}}))}
\DoxyCodeLine{01196\ \ \ \ \ files\ =\ [(\textcolor{stringliteral}{"{}data"{}},\ \textcolor{stringliteral}{"{}data.diff"{}},\ patch[1])]}
\DoxyCodeLine{01197\ \ \ \ \ ctype,\ body\ =\ EncodeMultipartFormData(form\_fields,\ files)}
\DoxyCodeLine{01198\ \ \ \ \ url\ =\ \textcolor{stringliteral}{"{}/\%d/upload\_patch/\%d"{}}\ \%\ (int(issue),\ int(patchset))}
\DoxyCodeLine{01199\ \ \ \ \ \textcolor{keywordflow}{print}\ \textcolor{stringliteral}{"{}Uploading\ patch\ for\ "{}}\ +\ patch[0]}
\DoxyCodeLine{01200\ \ \ \ \ response\_body\ =\ rpc\_server.Send(url,\ body,\ content\_type=ctype)}
\DoxyCodeLine{01201\ \ \ \ \ lines\ =\ response\_body.splitlines()}
\DoxyCodeLine{01202\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ lines\ \textcolor{keywordflow}{or}\ lines[0]\ !=\ \textcolor{stringliteral}{"{}OK"{}}:}
\DoxyCodeLine{01203\ \ \ \ \ \ \ StatusUpdate(\textcolor{stringliteral}{"{}\ \ -\/-\/>\ \%s"{}}\ \%\ response\_body)}
\DoxyCodeLine{01204\ \ \ \ \ \ \ sys.exit(1)}
\DoxyCodeLine{01205\ \ \ \ \ rv.append([lines[1],\ patch[0]])}
\DoxyCodeLine{01206\ \ \ \textcolor{keywordflow}{return}\ rv}
\DoxyCodeLine{01207\ }
\DoxyCodeLine{01208\ }

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceupload_a911c98a64378a566a42ed6758245ef22_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceupload_a911c98a64378a566a42ed6758245ef22_icgraph}
\end{center}
\end{figure}


\doxysubsection{Variable Documentation}
\Hypertarget{namespaceupload_a675d13c979f1c720866d22ed1736f580}\index{upload@{upload}!action@{action}}
\index{action@{action}!upload@{upload}}
\doxysubsubsection{\texorpdfstring{action}{action}}
{\footnotesize\ttfamily \label{namespaceupload_a675d13c979f1c720866d22ed1736f580} 
upload.\+action}



Definition at line \mbox{\hyperlink{googlemock_2scripts_2upload_8py_source_l00393}{393}} of file \mbox{\hyperlink{googlemock_2scripts_2upload_8py_source}{upload.\+py}}.

\Hypertarget{namespaceupload_a985aa9a71de3eb507344df65700c696d}\index{upload@{upload}!const@{const}}
\index{const@{const}!upload@{upload}}
\doxysubsubsection{\texorpdfstring{const}{const}}
{\footnotesize\ttfamily \label{namespaceupload_a985aa9a71de3eb507344df65700c696d} 
upload.\+const}



Definition at line \mbox{\hyperlink{googlemock_2scripts_2upload_8py_source_l00398}{398}} of file \mbox{\hyperlink{googlemock_2scripts_2upload_8py_source}{upload.\+py}}.

\Hypertarget{namespaceupload_af4be925d9a50d5ad134d86400509d0f2}\index{upload@{upload}!default@{default}}
\index{default@{default}!upload@{upload}}
\doxysubsubsection{\texorpdfstring{default}{default}}
{\footnotesize\ttfamily \label{namespaceupload_af4be925d9a50d5ad134d86400509d0f2} 
upload.\+default}



Definition at line \mbox{\hyperlink{googlemock_2scripts_2upload_8py_source_l00394}{394}} of file \mbox{\hyperlink{googlemock_2scripts_2upload_8py_source}{upload.\+py}}.

\Hypertarget{namespaceupload_a770d9c7b49b1fede80de6078d5e49af7}\index{upload@{upload}!dest@{dest}}
\index{dest@{dest}!upload@{upload}}
\doxysubsubsection{\texorpdfstring{dest}{dest}}
{\footnotesize\ttfamily \label{namespaceupload_a770d9c7b49b1fede80de6078d5e49af7} 
upload.\+dest}



Definition at line \mbox{\hyperlink{googlemock_2scripts_2upload_8py_source_l00394}{394}} of file \mbox{\hyperlink{googlemock_2scripts_2upload_8py_source}{upload.\+py}}.

\Hypertarget{namespaceupload_a9d33d66de17175dced88ffe95f079226}\index{upload@{upload}!group@{group}}
\index{group@{group}!upload@{upload}}
\doxysubsubsection{\texorpdfstring{group}{group}}
{\footnotesize\ttfamily \label{namespaceupload_a9d33d66de17175dced88ffe95f079226} 
upload.\+group = parser.\+add\+\_\+option\+\_\+group("{}Logging options"{})}



Definition at line \mbox{\hyperlink{googlemock_2scripts_2upload_8py_source_l00397}{397}} of file \mbox{\hyperlink{googlemock_2scripts_2upload_8py_source}{upload.\+py}}.

\Hypertarget{namespaceupload_abfc23c9aa2d9b777678da117a85929a5}\index{upload@{upload}!help@{help}}
\index{help@{help}!upload@{upload}}
\doxysubsubsection{\texorpdfstring{help}{help}}
{\footnotesize\ttfamily \label{namespaceupload_abfc23c9aa2d9b777678da117a85929a5} 
upload.\+help}



Definition at line \mbox{\hyperlink{googlemock_2scripts_2upload_8py_source_l00395}{395}} of file \mbox{\hyperlink{googlemock_2scripts_2upload_8py_source}{upload.\+py}}.

\Hypertarget{namespaceupload_aad5b1a43823e2a710a2f78e33dde8901}\index{upload@{upload}!MAX\_UPLOAD\_SIZE@{MAX\_UPLOAD\_SIZE}}
\index{MAX\_UPLOAD\_SIZE@{MAX\_UPLOAD\_SIZE}!upload@{upload}}
\doxysubsubsection{\texorpdfstring{MAX\_UPLOAD\_SIZE}{MAX\_UPLOAD\_SIZE}}
{\footnotesize\ttfamily \label{namespaceupload_aad5b1a43823e2a710a2f78e33dde8901} 
int upload.\+MAX\+\_\+\+UPLOAD\+\_\+\+SIZE = 900 \texorpdfstring{$\ast$}{*} 1024}



Definition at line \mbox{\hyperlink{googlemock_2scripts_2upload_8py_source_l00062}{62}} of file \mbox{\hyperlink{googlemock_2scripts_2upload_8py_source}{upload.\+py}}.

\Hypertarget{namespaceupload_af1cea8af5389f0ab2d8b65b2c0fd2fe0}\index{upload@{upload}!metavar@{metavar}}
\index{metavar@{metavar}!upload@{upload}}
\doxysubsubsection{\texorpdfstring{metavar}{metavar}}
{\footnotesize\ttfamily \label{namespaceupload_af1cea8af5389f0ab2d8b65b2c0fd2fe0} 
upload.\+metavar}



Definition at line \mbox{\hyperlink{googlemock_2scripts_2upload_8py_source_l00409}{409}} of file \mbox{\hyperlink{googlemock_2scripts_2upload_8py_source}{upload.\+py}}.

\Hypertarget{namespaceupload_af9e508d19dc2dd9cdb7c642dde0bdd21}\index{upload@{upload}!parser@{parser}}
\index{parser@{parser}!upload@{upload}}
\doxysubsubsection{\texorpdfstring{parser}{parser}}
{\footnotesize\ttfamily \label{namespaceupload_af9e508d19dc2dd9cdb7c642dde0bdd21} 
upload.\+parser = optparse.\+Option\+Parser(usage="{}\%prog \mbox{[}options\mbox{]} \mbox{[}-\/-\/ diff\+\_\+options\mbox{]}"{})}



Definition at line \mbox{\hyperlink{googlemock_2scripts_2upload_8py_source_l00392}{392}} of file \mbox{\hyperlink{googlemock_2scripts_2upload_8py_source}{upload.\+py}}.

\Hypertarget{namespaceupload_a4fc56f0dd6613be15c3c4dc3af3619ce}\index{upload@{upload}!type@{type}}
\index{type@{type}!upload@{upload}}
\doxysubsubsection{\texorpdfstring{type}{type}}
{\footnotesize\ttfamily \label{namespaceupload_a4fc56f0dd6613be15c3c4dc3af3619ce} 
upload.\+type}



Definition at line \mbox{\hyperlink{googlemock_2scripts_2upload_8py_source_l00443}{443}} of file \mbox{\hyperlink{googlemock_2scripts_2upload_8py_source}{upload.\+py}}.

\Hypertarget{namespaceupload_afa85ceef00a65cd276a856404eb5f310}\index{upload@{upload}!use\_shell@{use\_shell}}
\index{use\_shell@{use\_shell}!upload@{upload}}
\doxysubsubsection{\texorpdfstring{use\_shell}{use\_shell}}
{\footnotesize\ttfamily \label{namespaceupload_afa85ceef00a65cd276a856404eb5f310} 
upload.\+use\+\_\+shell = sys.\+platform.\+startswith("{}win"{})}



Definition at line \mbox{\hyperlink{googlemock_2scripts_2upload_8py_source_l00539}{539}} of file \mbox{\hyperlink{googlemock_2scripts_2upload_8py_source}{upload.\+py}}.

\Hypertarget{namespaceupload_a79aff46409a98c4e5f608c8df1fd4612}\index{upload@{upload}!verbosity@{verbosity}}
\index{verbosity@{verbosity}!upload@{upload}}
\doxysubsubsection{\texorpdfstring{verbosity}{verbosity}}
{\footnotesize\ttfamily \label{namespaceupload_a79aff46409a98c4e5f608c8df1fd4612} 
int upload.\+verbosity = 1}



Definition at line \mbox{\hyperlink{googlemock_2scripts_2upload_8py_source_l00059}{59}} of file \mbox{\hyperlink{googlemock_2scripts_2upload_8py_source}{upload.\+py}}.

